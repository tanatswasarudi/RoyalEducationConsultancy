'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1027:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.method=this.api=0}}Object(G.a)(m,"Message",null,[])},1145:function(G,J,d){function m(U,O=self){O.addEventListener("message",function Q(Y){if(Y&&Y.data){var {id:S,type:P,path:T}=Object.assign({path:[]},Y.data),Z=(Y.data.zUh||[]).map(v);try{const aa=T.slice(0,-1).reduce((wa,ma)=>wa[ma],U),ia=T.reduce((wa,ma)=>wa[ma],U);switch(P){case "GET":var X=
ia;break;case "SET":aa[T.slice(-1)[0]]=v(Y.data.value);X=!0;break;case "APPLY":X=ia.apply(aa,Z);break;case "CONSTRUCT":const wa=new ia(...Z);X=Object.assign(wa,{[z]:!0});break;case "ENDPOINT":const {port1:ma,port2:na}=new MessageChannel;m(U,na);X=w(ma,[ma]);break;case "RELEASE":X=void 0;break;default:return}}catch(aa){X={value:aa,[F]:0}}Promise.resolve(X).catch(aa=>({value:aa,[F]:0})).then(aa=>{const [ia,wa]=y(aa);O.postMessage(Object.assign(Object.assign({},ia),{id:S}),wa);"RELEASE"===P&&(O.removeEventListener("message",
Q),"MessagePort"===O.constructor.name&&O.close())})}});O.start&&O.start()}function f(U){if(U)throw Error("Proxy has been released and is not useable");}function a(U,O=[],V=function(){}){let Y=!1;const Q=new Proxy(V,{get(S,P){f(Y);if(P===D)return()=>u(U,{type:"RELEASE",path:O.map(T=>T.toString())}).then(()=>{"MessagePort"===U.constructor.name&&U.close();Y=!0});if("then"===P){if(0===O.length)return{then:()=>Q};S=u(U,{type:"GET",path:O.map(T=>T.toString())}).then(v);return S.then.bind(S)}return a(U,
[...O,P])},set(S,P,T){f(Y);const [Z,X]=y(T);return u(U,{type:"SET",path:[...O,P].map(aa=>aa.toString()),value:Z},X).then(v)},apply(S,P,T){f(Y);S=O[O.length-1];if(S===A)return u(U,{type:"ENDPOINT"}).then(v);if("bind"===S)return a(U,O.slice(0,-1));const [Z,X]=l(T);return u(U,{type:"APPLY",path:O.map(aa=>aa.toString()),zUh:Z},X).then(v)},construct(S,P){f(Y);const [T,Z]=l(P);return u(U,{type:"CONSTRUCT",path:O.map(X=>X.toString()),zUh:T},Z).then(v)}});return Q}function l(U){U=U.map(y);return[U.map(O=>
O[0]),Array.prototype.concat.apply([],U.map(O=>O[1]))]}function w(U,O){N.set(U,O);return U}function y(U){for(const [O,V]of H)if(V.H_h(U)){const [Y,Q]=V.serialize(U);return[{type:"HANDLER",name:O,value:Y},Q]}return[{type:"RAW",value:U},N.get(U)||[]]}function v(U){switch(U.type){case "HANDLER":return H.get(U.name).deserialize(U.value);case "RAW":return U.value}}function u(U,O,V){return new Promise(Y=>{const Q=x();U.addEventListener("message",function T(P){P.data&&P.data.id&&P.data.id===Q&&(U.removeEventListener("message",
T),Y(P.data))});U.start&&U.start();U.postMessage(Object.assign({id:Q},O),V)})}function x(){return Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}G=d(0);const z=Symbol("Comlink.proxy"),A=Symbol("Comlink.endpoint"),D=Symbol("Comlink.releaseProxy"),F=Symbol("Comlink.thrown"),I=U=>"object"===typeof U&&null!==U||"function"===typeof U,H=new Map([["proxy",{H_h:U=>I(U)&&U[z],serialize(U){const {port1:O,port2:V}=new MessageChannel;m(U,O);return[V,[V]]},deserialize(U){U.start();
return a(U,[],void 0)}}],["throw",{H_h:U=>I(U)&&F in U,serialize({value:U}){return[U instanceof Error?{rXa:!0,value:{message:U.message,name:U.name,stack:U.stack}}:{rXa:!1,value:U},[]]},deserialize(U){if(U.rXa)throw Object.assign(Error(U.value.message),U.value);throw U.value;}}]]),N=new WeakMap;d.d(J,"a",function(){return M});class M{static Blk(U){M.hib=U;M.bTk=a(U,[],void 0)}static get Endpoint(){return M.hib}static get Clk(){return M.bTk}}Object(G.a)(M,"WorkerUtils",null,[])},1165:function(G,J,d){d.d(J,
"a",function(){return m});G=d(0);class m{}Object(G.a)(m,"WaterlineOverrideSettings",null,[])},1167:function(G,J,d){G=d(0);var m=d(451),f=d(431),a=d(621),l=d(273),w=d(477);class y extends l.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}lm(){return w.a.RGf}static Xea(D,F,I){const H=new y;H.FileId=D;H.HighWaterline=F;H.LowWaterline=I;return H}}Object(G.a)(y,"GetActivitiesRequest",l.a,[]);class v extends l.a{constructor(D,F,I){super();this.Settings=this.Waterline=this.FileId=
null;this.FileId=D;this.Waterline=F;this.Settings=I}lm(){return w.a.xNf}static Xea(D,F,I){return new v(D,F,I)}}Object(G.a)(v,"GetRelevantActivitiesRequest",l.a,[]);class u extends l.a{constructor(D,F){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=D;this.WaterlineOverrideSettings=F}lm(){return w.a.TRm}static Xea(D,F){return new u(D,F)}}Object(G.a)(u,"GetWywaActivitiesRequest",l.a,[]);class x{}Object(G.a)(x,"RelevantActivitiesSettings",null,[]);class z extends l.a{constructor(){super();
this.FileId=null}lm(){return w.a.Ttd}static Xea(D){const F=new z;F.FileId=D;return F}}Object(G.a)(z,"UpdateWaterlineRequest",l.a,[]);d.d(J,"a",function(){return A});class A{constructor(D,F,I,H,N){this.pFk=D;this.DLd=F;this.K6e=I;this.wDc=H;this.Lah=N}requestWYWAActivities(D){D=u.Xea(this.DLd(),D);return m.a.then(this.Laa(D,"wywa"),F=>F)}requestActivities(D,F){D=y.Xea(this.DLd(),D,F);return m.a.then(this.Laa(D,"activities"),I=>I)}REo(){const D=z.Xea(this.DLd());return m.a.then(this.Laa(D,"waterline"),
F=>F)}requestRelevantActivities(D,F){F=Object.assign(new x,{FirstDocumentOpen:F,MockDataEnabled:!1});D=v.Xea(this.DLd(),D,F);return m.a.then(this.Laa(D,"relevant"),I=>I)}updateActivityState(D){return m.a.Mrd(this.Lah,F=>F.Atp(D.itemIds,D.activityStatesToSet,D.activityStatesToReset,D.resetUnseenCount))}requestActivityFeed(){return m.a.Mrd(this.Lah,D=>D.SGf(null))}Laa(D,F){const I={"Content-Type":"application/json; charset=utf-8"};return m.a.then(m.a.Mrd(this.pFk,H=>H.pu(this.K6e,I,f.a.G6h(D,this.wDc),
F)),H=>{if(!(H&&H.args&&H.args.data&&H.args.data.De))return null;({group:H}=a.a.R4(H.args.data.De));return H&&H.Responses&&H.Responses.length?H.Responses[0]:null})}}Object(G.a)(A,"SharedActivityRepository",null,[])},1463:function(G,J,d){d.d(J,"a",function(){return f});var m;(function(a){a[a.Unknown=0]="Unknown";a[a.zNp=1]="Inference"})(m||(m={}));var f;(function(a){a[a.Unknown=0]="Unknown";a[a.pRp=1]="VoiceDictationBadge";a[a.qRp=2]="VoiceDictationPhrase"})(f||(f={}))},1636:function(G,J,d){d.d(J,
"a",function(){return a});G=d(0);var m=d(2),f=d(6);class a{static get Gzb(){return!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static Eqb(l,w=!1){const y=f.GraphIterator.eb(l);y.Jd();return(w?y.Ub(4):y.wla(4))?4:f.GraphIterator.eb(l).zb(36)?16:f.GraphIterator.eb(l).zb(14)?2:f.GraphIterator.eb(l).zb(38)?32:1}}Object(G.a)(a,"ConstructTypeHelper",null,[])},1656:function(G,J,d){d.d(J,"a",function(){return Y});G=d(0);var m=d(200),f=d(21),a=d(191),
l=d(2),w=d(250),y=d(5),v=d(77),u=d(11),x=d(242),z=d(13),A=d(272),D=d(3),F=d(88),I=d(67),H=d(44),N=d(480),M=d(172),U=d(23),O=d(256),V=d(8);class Y{static get mg(){return O.a.instance}static get Ec(){return m.a.instance}static wy(){return Y.Xn||(Y.Xn=f.a.instance.Qa("Box4.IExternalSelectionManager"))}static get iC(){return null!=Y.X2g?Y.X2g:Y.X2g=f.a.instance.resolve("Box4.IParagraphIndentationReader")}static vOm(){this.MQ||(this.MQ=new v.a,this.MQ.add(D.a.oC),this.MQ.add(D.a.font),this.MQ.add(D.a.vY),
this.MQ.add(D.a.Kza),this.MQ.add(D.a.bold),this.MQ.add(D.a.kA),this.MQ.add(D.a.superscript),this.MQ.add(D.a.subscript),this.MQ.add(D.a.K6a),this.MQ.add(D.a.Hza),this.MQ.add(D.a.NIa),this.MQ.add(D.a.rof),this.MQ.add(D.a.OIa),this.MQ.add(D.a.J6a),this.MQ.add(D.a.p3),this.MQ.add(D.a.C4),this.MQ.add(D.a.hE),this.MQ.add(D.a.nnb),this.MQ.add(D.a.DVc));return this.MQ}static Pnc(Q){return Y.vOm().contains(Q)?!0:!1}static vx(Q,S,P,T,Z){var X=!0;if(!S.view.te)return 2;var aa=S.view,ia=aa.lb;ia&&ia.gb.currentSelection||
(Y.Ec.$b(F.a.Te,{["Reason"]:I.a.oo}),X=!1);Object(M.a)().lJa(z.ImageReader.J9c,aa.lb.Og)&&(Y.Ec.$b(F.a.Te,{["Reason"]:I.a.Prf}),X=!1);if(Object(M.a)().lJa(z.ImageReader.M$a,aa.lb.Og))return Y.Ec.$b(F.a.Te,{["Reason"]:I.a.HWc}),8;var wa=!Y.Pnc(Q);Y.mg.Tnc(aa.lb.Og,wa)&&(Y.Ec.$b(F.a.Te,{["Reason"]:I.a.HG}),X=!1);Object(M.a)().lJa(z.ImageReader.pee,aa.lb.Og)&&(Y.Ec.$b(F.a.Te,{["Reason"]:I.a.Jrf}),X=!1);Object(M.a)().lJa(A.c,aa.lb.Og)&&(Y.Ec.$b(F.a.Te,{["Reason"]:I.a.Krf}),X=!1);Object(M.a)().lJa(x.a.eZf,
aa.lb.Og)&&(Y.Ec.$b(F.a.Te,{["Reason"]:I.a.Irf}),X=!1);Object(M.a)().pFa(V.ParagraphReader.BX,aa.lb.Og)&&(Y.Ec.$b(F.a.Te,{["Reason"]:I.a.WQ}),X=!1);Y.wy()&&Y.wy().instance&&Y.wy().instance.DX(aa.lb.Og)&&(Y.Ec.$b(F.a.Te,{["Reason"]:I.a.t8a}),X=!1);var ma=null;ia&&ia.gb.currentSelection&&(ma=ia.gb.currentSelection);if(1===P||!X||!ma)return X?32:8;X=Q===D.a.Dqc||Q===D.a.Kec||Q===D.a.bwc||Q===D.a.ljc;aa=Q===D.a.gYb||Q===D.a.pNb||Q===D.a.nvc;wa=Q===D.a.C_a||Q===D.a.D_a||Q===D.a.QE;const na=new H.GraphTransaction(15);
na.Ab(ma.Ra.node);ma=new v.a;let Fa=!1;if(X||aa||wa)a.a.mark(7121),S=Object(M.a)().ksi(S.Hk);else{a.a.mark(7119);S=N.OutlineElementGeneralizer.Wka(ia.gb,!0);if(!S)return Y.Ec.$b(F.a.usa,{["Reason"]:I.a.I2d}),na.dispose(),8;ia=Q===D.a.u$a||Q===D.a.psb;S.Ex&&ia&&(Fa=Y.cZm(ma,S))}(Q===D.a.Y7||Q===D.a.Dqc||Q===D.a.paa||Q===D.a.Kec||Q===D.a.I8||Q===D.a.bwc||Q===D.a.zKa||Q===D.a.ljc)&&S.Ex&&1<S.length&&Y.dZm(S)&&(Z||(Z={}),Object.getType(Z)===Object&&(Z.InContextSet=!0));l.AFrameworkApplication.va.lg(S,
Q,P,!0,T,Z);Fa&&Y.hRn(ma,S,Z);na.dispose();U.StaticActiveAppFrame.za().Ie();X||aa||wa?a.a.mark(7122):a.a.mark(7120);return 32}static cZm(Q,S){if(!S.Ex)return!1;let P=!1,T=!1;for(let X=0;X<S.length;X++)if(S.getContext(X).Gl){var Z=S.getContext(X).node;Z&&(Z=Y.iC.Rqb(Z),2===Z.specialIndentType?(P=!0,Q.add(X)):1!==Z.specialIndentType&&Z.specialIndentType||(T=!0))}return T&&P}static hRn(Q,S,P){if(S.Ex)for(let Z=0;Z<Q.count;Z++){var T=S.getContext(Q.J(Z));if(!T.Gl)continue;T=T.node;const X=Y.iC.Rqb(T);
2!==X.specialIndentType||w.a.pCa(P.value,X.oD)||T.setValue(y.a.fe,X.oD-X.Eha)}}static kCg(Q,S){let P=!0;S.contextId!==u.a.paragraph?P=!1:Y.mg.xab(S)?(Y.Ec.$b(F.a.Tn,{["Reason"]:I.a.HG}),P=!1):Y.wy()&&Y.wy().instance&&Y.wy().instance.DX(S)?(Y.Ec.$b(F.a.Tn,{["Reason"]:I.a.t8a}),P=!1):S.Gl&&(S=S.node,V.ParagraphReader.Xb(S)&&S.ZT&&(Y.Ec.$b(F.a.Tn,{["Reason"]:I.a.WQ}),P=!1));return{returnValue:1!==Q&&P,Pz:P?32:8}}static dZm(Q){if(!Q.Ex)return!1;let S=1;for(let T=0;T<Q.length;T++){var P=Q.getContext(T);
if(P&&P.Gl&&P.contextId===u.a.paragraph&&(P=P.node))if(P=V.ParagraphReader.ez(P),!T)S=P;else if(P!==S)return!0}return!1}}Y.Xn=null;Y.MQ=null;Object(G.a)(Y,"FormattingActionHelper",null,[])},1659:function(G,J,d){d.d(J,"a",function(){return f});d.d(J,"b",function(){return a});var m=d(2);const f=l=>{switch(l){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;
case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var l;return null===(l=m.AFrameworkApplication.K)||void 0===l?void 0:l.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1674:function(G,J,d){d.r(J);G=d(0);var m=d(7),f=d(1498),a=d(1687),l=d(981),w=d(1621);class y{constructor(ya){this.XEk=ya}initialize(){return Promise.resolve(0)}mie(){return Promise.resolve(0)}wV(){m.ULS.sendTraceTag(574239257,
3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new w.a,{IsSuccess:!0,Token:this.XEk}))}iEe(){return Promise.resolve(Object.assign(new w.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}PBe(){return!1}G4c(){return"MockAuthTokenStrategy"}}Object(G.a)(y,"MockAuthTokenStrategy",null,[290]);var v=d(1752);class u{static get(ya,ta,Aa){if(!Aa)return ya;
let oa=0;return Promise.race([ya,new Promise(za=>{oa=window.setTimeout(()=>{za(ta)},Aa)})]).then(za=>{window.clearTimeout(oa);return Promise.resolve(za)}).catch(()=>{window.clearTimeout(oa);return Promise.resolve(ta)})}}Object(G.a)(u,"PromiseWithTimeout",null,[]);var x=d(2),z=d(671);class A{constructor(ya,ta,Aa,oa,za){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=ya;this.scope=ta;this.silentLogin=Aa;this.options=oa;this.correlationId=za}}Object(G.a)(A,
"TokenRequestParameters",null,[302]);var D=d(20),F=d(21);class I{constructor(){this.$Kh=null;let ya=x.AFrameworkApplication.K.kb(x.AFrameworkApplication.mwa),ta=x.AFrameworkApplication.K.kb(x.AFrameworkApplication.vEe);this.Pac=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ya&&""!==ya?ya:"Unspecified",ta&&""!==ta?ta:"Unspecified")}initialize(){return new Promise(ya=>{F.a.instance.Qa("Common.App.WopiIdentity.IWopiIdentity").execute(ta=>{this.$Kh=ta;ya(0)})})}ge(ya){const ta=
["HTTPS:","API:"];let Aa=!1;const oa=ya.toLocaleUpperCase();for(const za of ta)if(oa.startsWith(za)){Aa=!0;break}return Aa||this.Sjn(ya)?ya+"/.default":ya}Sjn(ya){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ya)}mie(){return Promise.resolve(0)}wV(ya,ta,Aa,oa,za,ja,fa){if(D.a.RXa){za=z.a.MEp;if(!za)return ta=Object.assign(new w.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(ta);if(!Array.contains(za,
ya))return ta=Object.assign(new w.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ya}),Promise.resolve(ta)}ya=this.ge(Aa);Aa=new A(Aa,ya,!oa,null,x.AFrameworkApplication.userSessionId);return this.$Kh.getAccessToken(Aa,ta,fa).then(Ca=>Object.assign(new w.a,{IsSuccess:!0,Token:Ca.accessToken}),Ca=>Object.assign(new w.a,{IsSuccess:!1,ErrorCode:Ca}))}iEe(){return Promise.resolve(Object.assign(new w.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}PBe(){return!1}G4c(){return this.Pac}}
Object(G.a)(I,"ParentFrameTokenStrategy",null,[290]);var H=d(816),N=d(77);class M{constructor(){this.reject=this.resolve=null;this.startTime=0;this.uwj=this.$Vh=null}}Object(G.a)(M,"PromiseWrapper",null,[]);class U{constructor(ya=0){this.Dz=0;this.ANc=!1;this.Kz=new N.a;this._timeout=ya}enqueue(ya){return new Promise((ta,Aa)=>{this.Kz.add(Object.assign(new M,{uwj:ya,resolve:ta,reject:Aa}));this.process()})}process(){if(this.ANc||this.Dz===this.Kz.count)return!1;const ya=this.Kz.J(this.Dz++);try{this.ANc=
!0,ya.uwj().then(ta=>{this.ANc=!1;this.Yqf(ya,ta,null,!0)}).catch(ta=>{this.ANc=!1;this.Yqf(ya,null,ta,!1)})}catch(ta){this.ANc=!1,this.Yqf(ya,null,ta,!1)}return!0}Yqf(ya,ta,Aa,oa){if(oa){const za=()=>{ya.resolve(ta);this.process()};0<this._timeout?window.setTimeout(()=>{za()},this._timeout):za()}else{const za=()=>{ya.reject(Aa);this.process()};0<this._timeout?window.setTimeout(()=>{za()},this._timeout):za()}}}Object(G.a)(U,"PromiseQueue",null,[]);class O{constructor(){this.correlationId=this.resolve=
null}}Object(G.a)(O,"ResolveWithCorrelation",null,[]);var V=d(84),Y=d(182),Q=d(1024),S=d(97);class P extends Y.a{constructor(ya,ta,Aa,oa,za,ja){super(!1,!1,!0);this.Zeh=this.$Fa=null;this.J2n=()=>{this.gri()};this.QFl=()=>this.BJ;this.u0o=fa=>{0===fa&&(this.iRk.reject(Object.assign(new w.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.xEb(null))};this.vya=ya;this.CJk=Aa;this.Er=oa;this.iRk=za;this.xEb=ja;this.BJ=document.createElement("iframe");this.BJ.id=
"SharedAuthInteractiveFrame";this.BJ.setAttribute("name","SharedAuthInteractiveFrame");this.BJ.setAttribute("title","SharedAuthInteractiveFrame");this.BJ.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.BJ.style.border="0";this.BJ.style.height="48px";this.BJ.style.width="190px";$addHandler(this.BJ,"error",this.J2n);ya=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.vya,ta,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",
x.AFrameworkApplication.userType);this.BJ.src=ya;this.ttk=new Promise(fa=>{this.Zeh=fa});this.$eh=!1}L_a(){this.$Fa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.CJk,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:x.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:this.QFl,["resolveDialogStyles"]:this.Zeh}};this.Gd=5;this.pi(CommonUIStrings.l_SignIn,this.u0o,this.$Fa)}S8j(ya=!1,ta=5){this.$Fa&&this.$Fa.bodyControls&&(!0!==Object(V.a)(Object,this.$Fa.bodyControls).frameLoaded&&
(Object(V.a)(Object,this.$Fa.bodyControls).frameLoaded=!0),ya!==Object(V.a)(Object,this.$Fa.bodyControls).frameLoadSuccess&&(Object(V.a)(Object,this.$Fa.bodyControls).frameLoadSuccess=ya),ta!==this.$Fa.dialogButtonsOption&&(this.$Fa.dialogButtonsOption=null,this.Gd=ta),this.update(this.$Fa))}X7o(ya,ta){const Aa=new Q.a(S.a.y0o);Aa.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:x.AFrameworkApplication.isRtl,["messageCorrelationId"]:ya,["dialogStyles"]:ta};
this.Er.r_a(Aa,this.BJ.contentWindow,this.vya)}gri(){this.S8j(!1,6)}get zRj(){return this.BJ}get kTl(){return this.ttk.then(ya=>{this.$eh=!0;return ya})}get lTl(){return this.$eh}}Object(G.a)(P,"SharedAuthConsentDialog",Y.a,[303]);var T=d(1051),Z=d(92),X=d(156),aa=d(41),ia=d(123),wa=d(105);class ma{constructor(){this.BJ=null;this.pDd=0;this.j9b=this.xbc=this.tLe=this.xEb=this.qea=this.YIh=null;this.JYn=()=>{const ya=aa.a.Ee()-this.pDd;m.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",
ya)};this.Hvb=ya=>{const {OAuthManager:ta}=d(1674),Aa=aa.a.Ee()-this.pDd,oa=Object.assign(new wa.a,{durationMs:Aa});Z.Health.instance.recordKpiFailure(ta.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,oa);m.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",Aa,this.Fgh?JSON.stringify(ya):"")};this.l2n=ya=>{const {OAuthManager:ta}=d(1674),Aa=this.qkb.loadFrame;var oa=aa.a.Ee()-Aa.startTime,za=ya.Values.AuthLibrary.toString();ya=ya.Values.Success.toString();
m.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ya,za,oa);za&&(this.Pac="SharedAuthTokenStrategy "+za);za=Boolean.parse(ya);za||(ya=X.a.KG(),void 0!==ya&&null!==ya&&(ya.set("AuthLibrary",this.G4c()),oa=Object.assign(new wa.a,{durationMs:oa,extendedProperties:ya}),Z.Health.instance.recordKpiFailure(ta.kpiName,"SharedAuthStrategyInitFailed",!1,!0,oa)));Aa.resolve(za?0:1)};this.k2n=ya=>{if(ya.Values.interactive&&this.xbc&&this.xbc.Values.messageCorrelationId){const Aa=
this.xbc.Values.messageCorrelationId.toString();if(ya.Values.interactive&&this.qea){this.qea.kTl.then(oa=>{this.Er.r_a(this.xbc,this.qea.zRj.contentWindow,this.vya);this.qea.X7o(Aa,oa);this.qea.S8j(!0);this.xbc=null});return}}ya=this.qkb.initFrame;const ta=aa.a.Ee()-ya.startTime;m.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",ta);ya.resolve(0)};this.oYn=ya=>{if(ya.Values.messageCorrelationId&&ya.Values.messageCorrelationId.toString()){var ta=ya.Values.messageCorrelationId.toString(),
Aa=this.qkb[ta];if(Aa){var oa=aa.a.Ee()-Aa.startTime;m.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",oa);ya.Values.isSuccess&&ya.Values.isSuccess?Aa.resolve(ya.Values.response):Aa.reject(ya.Values.response);this.t4j(ta)}else m.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else m.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")};
this.lZn=()=>{if(this.qea.lTl)this.qea.gri();else if(this.tLe&&this.qea){const ya=new Q.a(S.a.CRj);ya.Values=this.GVh(this.tLe,!0);this.Er.r_a(ya,this.qea.zRj.contentWindow,this.vya)}};this.yYn=()=>{this.qea&&this.qea.Kae()};this.zeg=ya=>{ya.Values.cancelled&&ya.Values.cancelled&&ya.Values.messageCorrelationId&&this.t4j(ya.Values.messageCorrelationId.toString());this.qea&&this.qea.hide()};this.QZn=ya=>{if(ya.Values.messageCorrelationId&&ya.Values.messageCorrelationId.toString()){var ta=this.qkb[ya.Values.messageCorrelationId.toString()];
if(ta){var Aa=aa.a.Ee()-ta.startTime;m.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",Aa);ya.Values.isSuccess&&ya.Values.isSuccess?ta.resolve(ya.Values.response):ta.reject(ya.Values.response)}else m.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else m.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")};this.Er=
new T.a(null,null);this.Pac="SharedAuthTokenStrategy Unloaded";this.vya=z.a.w0o;this.UEh=z.a.v0o;this.Fgh=z.a.enableConsoleLogging;this.Cuk=x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.pOk=x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.cSk=x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.qkb={};this.Uzk=
new U(1500)}G4c(){return this.Pac}initialize(){var {OAuthManager:ya}=d(1674);if("loadFrame"in this.qkb)return this.qkb.loadFrame.$Vh;if(!this.vya)return Z.Health.instance.recordKpiFailure(ya.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),m.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);ya=this.rBe("loadFrame");this.pDd=aa.a.Ee();var ta=this.vya+this.UEh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+
x.AFrameworkApplication.userSessionId+"&WacUserType="+x.AFrameworkApplication.userType;this.cSk&&(ta+="&webworker=1");this.BJ=document.createElement("iframe");this.uVf(this.BJ);this.BJ.style.cssText="height:0;width:0;display:none;";this.BJ.id="SharedAuthFrame";this.BJ.setAttribute("name","SharedAuthFrame");this.BJ.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.BJ.setAttribute("title","SharedAuthFrame");this.BJ.src=ta;document.body.appendChild(this.BJ);ta=aa.a.Ee()-
this.pDd;m.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",ta,this.BJ.src);return ya}mie(ya){this.tLe=ya;const ta=new Q.a(S.a.CRj);ta.Values=this.GVh(ya);ya=this.rBe("initFrame");this.Er.r_a(ta,this.BJ.contentWindow,this.vya);m.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return ya}wV(ya,ta,Aa,oa,za,ja){const fa=new Q.a(S.a.z0o),Ca=this.eGi();fa.Values=this.W3j(ya,ta,
Aa,oa,za,ja,Ca);ya=this.rBe(Ca);oa&&x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.Uzk.enqueue(()=>new Promise(xa=>{this.lpp(ja,fa,xa,Ca)})):(this.Er.r_a(fa,this.BJ.contentWindow,this.vya),m.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",ta));return ya}lpp(ya,ta,Aa,oa){const za=this.qkb[oa];za&&(this.xbc=ta,this.xEb=Object.assign(new O,{resolve:Aa,correlationId:oa}),this.qea=
new P(this.vya,this.UEh,ya,this.Er,za,Aa),this.qea.L_a())}eGi(){return ia.a.create().toString()}W3j(ya,ta,Aa,oa,za,ja,fa){const Ca={};Ca.appName=ya;Ca.appId=ta;Ca.target=Aa;Ca.withPopup=oa;Ca.claims=za;Ca.promptMessage=ja;Ca.messageCorrelationId=fa;return Ca}uVf(ya){$addHandler(ya,"load",this.JYn);$addHandler(ya,"error",this.Hvb);this.Er.zea(this.vya);this.Er.Aw(S.a.FRj);this.Er.BD(S.a.FRj,this.l2n);this.Er.Aw(S.a.ERj);this.Er.BD(S.a.ERj,this.k2n);this.Er.Aw(S.a.ARj);this.Er.BD(S.a.ARj,this.oYn);
this.Er.Aw(S.a.GRj);this.Er.BD(S.a.GRj,this.QZn);this.Er.Aw(S.a.DRj);this.Er.BD(S.a.DRj,this.lZn);this.Er.Aw(S.a.BRj);this.Er.BD(S.a.BRj,this.yYn);this.Er.Aw(S.a.yRj);this.Er.BD(S.a.yRj,this.zeg)}rBe(ya){const ta=new M;ta.startTime=aa.a.Ee();const Aa=new Promise((oa,za)=>{ta.resolve=oa;ta.reject=za});ta.$Vh=Aa;this.qkb[ya]=ta;return Aa}GVh(ya,ta=!1){const Aa={};Aa.appIds=this.aim();Aa.upn=ya.loginHint;Aa.authority=ya.authority;Aa.authorityType=Object(f.a)(l.a,ya.authorityType);Aa.tenantId=ya.tenantId;
Aa.correlationId=x.AFrameworkApplication.userSessionId;Aa.enableConsoleLogging=this.Fgh;Aa.enablePopupFlash=this.Cuk;Aa.skipUpnCheck=this.pOk;Aa.interactive=ta;return Aa}aim(){const ya=[],ta=z.a.qif;for(const oa in ta){var Aa=ta[oa];Array.contains(ya,Aa)||Array.add(ya,Aa)}return ya}iEe(ya,ta,Aa,oa,za,ja){const fa=new Q.a(S.a.x0o),Ca=this.eGi();fa.Values=this.W3j(ya,ta,Aa,oa,za,ja,Ca);this.YIh=fa;ya=this.rBe(Ca);m.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",
ta);this.x5o();return ya}PBe(){return!0}x5o(){this.j9b||(this.j9b=new H.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.j9b.id=16,this.j9b.e$c=!1,this.j9b.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{m.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.Er.r_a(this.YIh,this.BJ.contentWindow,this.vya)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),x.AFrameworkApplication.ua.Ib.cza(this.j9b,
!0)||m.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}t4j(ya){this.xEb&&this.xEb.correlationId===ya&&(this.xEb.resolve(null),this.xEb=null)}}Object(G.a)(ma,"SharedAuthTokenStrategy",null,[290]);class na{constructor(ya){this.G$=ya;this.Pac="UnsupportedAuthTokenStrategy Reason="+a.a[this.G$]}initialize(){return Promise.resolve(0)}mie(){return Promise.resolve(0)}wV(){return Promise.resolve(Object.assign(new w.a,{IsSuccess:!1,ErrorCode:a.a[this.G$],
ErrorMessage:"Unable to get a token. Reason: ["+a.a[this.G$]+"]"}))}iEe(){return Promise.resolve(Object.assign(new w.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}PBe(){return!1}G4c(){return this.Pac}}Object(G.a)(na,"UnsupportedAuthTokenStrategy",null,[290]);var Fa=d(1573);d.d(J,"OAuthManager",function(){return Qa});class Qa{constructor(ya=null){this.m5=0;this.rda=null;this.BHb=0;this.gqh=
!!window.location.search.match(RegExp("wdpa=1","gi"));const ta=aa.a.Ee();this.Azk=this.lSl(ya).then(Aa=>Aa?this.W4m():(m.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.XJ(),Math.floor(aa.a.Ee()-ta)),Aa=X.a.KG(),void 0!==Aa&&null!==Aa&&(Aa.set("AuthLibrary",this.XJ()),Aa=Object.assign(new wa.a,{durationMs:Math.floor(aa.a.Ee()-ta),extendedProperties:Aa}),Z.Health.instance.recordKpiFailure(Qa.kpiName,"StrategyPickFailed",
!1,!0,Aa)),Promise.resolve(1))).then(Aa=>0!==Aa?Promise.resolve(Aa):this.Nzn())}mSl(){if(this.gqh)this.m5=5,this.rda=new na(this.m5);else{var ya=z.a.$Mn;ya&&0<ya.length?(this.m5=1,this.rda=new y(ya)):x.AFrameworkApplication.K.$("IsO365ConsumerHost")||x.AFrameworkApplication.K.$("IsO365CommercialHost")?x.AFrameworkApplication.K.$("IsAnonymousUser")?(this.m5=2,this.rda=new na(this.m5)):(ya=v.a.getAuthContext().loginHint)&&ya.length?z.a.E6c?(this.m5=1,this.rda=new I):(this.m5=1,this.rda=new ma):(this.m5=
3,this.rda=new na(this.m5)):(this.m5=4,this.rda=new na(this.m5))}}XJ(){return this.rda?this.rda.G4c()||"Unknown":"None"}lSl(ya=null){m.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const ta=aa.a.Ee();return x.AFrameworkApplication.K.Mtm().then(Aa=>{Aa?(this.mSl(),ya&&(this.rda=ya),m.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",z.a.clientVersion,z.a.appVersion,z.a.ZWl,this.XJ(),Math.floor(aa.a.Ee()-
ta))):m.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(aa.a.Ee()-ta));return Promise.resolve(Aa)},()=>{m.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(aa.a.Ee()-ta));return Promise.resolve(!1)})}W4m(){m.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.XJ());
const ya=aa.a.Ee();return u.get(this.rda.initialize(),2,z.a.Png).then(ta=>{if(0===ta)m.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.XJ(),Math.floor(aa.a.Ee()-ya));else if(1===ta){m.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.XJ(),Math.floor(aa.a.Ee()-ya));var Aa=X.a.KG();void 0!==Aa&&null!==Aa&&(Aa.set("AuthLibrary",this.XJ()),Aa=Object.assign(new wa.a,{durationMs:Math.floor(aa.a.Ee()-
ya),extendedProperties:Aa}),Z.Health.instance.recordKpiFailure(Qa.kpiName,"StrategyInitFailed",!1,!0,Aa))}else 2===ta&&(m.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.XJ(),Math.floor(aa.a.Ee()-ya)),Aa=X.a.KG(),void 0!==Aa&&null!==Aa&&(Aa.set("AuthLibrary",this.XJ()),Aa=Object.assign(new wa.a,{durationMs:Math.floor(aa.a.Ee()-ya),extendedProperties:Aa}),Z.Health.instance.recordKpiFailure(Qa.kpiName,"StrategyInitTimedOut",
!1,!0,Aa)));return Promise.resolve(ta)},()=>{m.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.XJ(),Math.floor(aa.a.Ee()-ya));return Promise.resolve(1)})}Nzn(){m.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.XJ());const ya=aa.a.Ee();return u.get(this.rda.mie(v.a.getAuthContext()),2,z.a.Png).then(ta=>{if(0===ta)m.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.XJ(),Math.floor(aa.a.Ee()-
ya));else if(1===ta){m.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.XJ(),Math.floor(aa.a.Ee()-ya));var Aa=X.a.KG();void 0!==Aa&&null!==Aa&&(Aa.set("AuthLibrary",this.XJ()),Aa=Object.assign(new wa.a,{durationMs:Math.floor(aa.a.Ee()-ya),extendedProperties:Aa}),Z.Health.instance.recordKpiFailure(Qa.kpiName,"StrategyLoadFailed",!1,!0,Aa))}else 2===ta&&(m.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.XJ(),Math.floor(aa.a.Ee()-ya)),Aa=X.a.KG(),void 0!==Aa&&null!==Aa&&(Aa.set("AuthLibrary",this.XJ()),Aa=Object.assign(new wa.a,{durationMs:Math.floor(aa.a.Ee()-ya),extendedProperties:Aa}),Z.Health.instance.recordKpiFailure(Qa.kpiName,"StrategyLoadTimedOut",!1,!0,Aa)));return Promise.resolve(ta)},()=>{m.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.XJ(),Math.floor(aa.a.Ee()-ya));return Promise.resolve(1)})}wV(ya,ta,Aa=null){return this.HAc(ya,
ta,!1,null,"",Aa)}X3j(ya,ta,Aa,oa,za=null){return this.HAc(ya,ta,!0,Aa,oa,za)}HAc(ya,ta,Aa,oa,za,ja,fa=0){fa+=1;m.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",ya,this.g_b(ya,ta),this.XJ(),fa);var Ca=X.a.KG();void 0!==Ca&&null!==Ca&&(Ca.set("AuthLibrary",this.XJ()),Ca.set("AppName",ya),Ca.set("Target",this.g_b(ya,ta)),Z.Health.instance.recordKpiUsage(Qa.kpiName,0,"WacOAuthFC",Ca));if(!z.a.isEnabled||this.gqh){var xa;
return this.p6f((xa=new w.a,xa.IsSuccess=!1,xa.Token=null,xa.ErrorCode="NotEnabled",xa.ErrorMessage="OAuthManager is disabled.",xa),ya)}const ua=z.a.qif[ya];if(void 0===ua||null===ua){m.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",ya);var sa;return this.p6f((sa=new w.a,sa.IsSuccess=!1,sa.Token=null,sa.ErrorCode="DisallowedApp",sa.ErrorMessage="Disallowed appName: "+ya,sa),ya)}const Ea=aa.a.Ee();let Ja=Ea;const nb=
this;Ca=this.Azk.then(Za=>{Ja=aa.a.Ee();return nb.Ocn(ya,ua,ta,Aa,oa,za,ja,Za)});xa=Aa?0:z.a.Png;let ub;sa=(ub=new w.a,ub.IsSuccess=!1,ub.Token=null,ub.ErrorCode="authTokenStrategy_timeout",ub.ErrorMessage="Auth Strategy timed out after ["+xa+"] ms when fetching token",ub);const Yb=this,yb=this;return u.get(Ca,sa,xa).then(Za=>fa<=Qa.lKn&&(Za.ErrorCode===Qa.Y0j||Za.ErrorCode===Qa.Fdp)?(m.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",fa,Math.floor(aa.a.Ee()-
Ea)),Yb.HAc(ya,ta,Aa,oa,za,ja,fa)):Za.ErrorCode===Qa.T4i&&!Aa&&(m.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",fa,Qa.Vji),Qa.K_l&&Yb.rda.PBe()&&Yb.rda.iEe(ya,ua,ta,Aa,oa,za).then(Ya=>Promise.resolve(Yb.Wie(Ya,ya,ta,ua,Ea,Ja))).catch(()=>{let Ya;const Pa=(Ya=new w.a,Ya.IsSuccess=!1,Ya.Token=null,Ya.ErrorCode="authTokenStrategy_failure",Ya.ErrorMessage="LoginPopup failed, GetToken could not be called",Ya);return Promise.resolve(Yb.Wie(Pa,
ya,ta,ua,Ea,Ja))}),Qa.Vji)?Yb.HAc(ya,ta,!0,oa,za,ja,fa):Promise.resolve(Yb.Wie(Za,ya,ta,ua,Ea,Ja))).catch(()=>{let Za;const Ya=(Za=new w.a,Za.IsSuccess=!1,Za.Token=null,Za.ErrorCode="authTokenStrategy_failure",Za.ErrorMessage="Auth Strategy failed with an unknown error",Za);return Promise.resolve(yb.Wie(Ya,ya,ta,ua,Ea,Ja))})}Ocn(ya,ta,Aa,oa,za,ja,fa,Ca){return 1===Ca||2===Ca?this.p6f(Object.assign(new w.a,{IsSuccess:!1,Token:null,ErrorCode:1===Ca?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),
ya):this.rda.wV(ya,ta,Aa,oa,za,ja,fa).then(xa=>Promise.resolve(this.Ehj(xa,!0,ya))).catch(xa=>Promise.resolve(this.Ehj(xa,!1,ya)))}Wie(ya,ta,Aa,oa,za,ja){const fa={},Ca=aa.a.Ee()-ja;fa.IsSuccess=ya.IsSuccess;fa.ErrorCode=ya.IsSuccess?"Success":ya.ErrorCode||"";fa.ErrorMessage=ya.IsSuccess?"Success":this.g_b(ta,ya.ErrorMessage||"");fa.Target=this.g_b(ta,Aa||"");fa.TimeInMS=Math.floor(Ca);fa.LoadTimeInMS=Math.floor(ja-za);fa.AuthLibrary=this.XJ();fa.AppName=ta;fa.AuthorityType=Object(f.a)(l.a,v.a.s5d());
fa.UserType=this.qQm(v.a.getAuthContext());fa.IsAuthSupportedInSession=a.a[this.m5];fa.RequestCount=++this.BHb;fa.AppId=oa;m.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(fa));ya.IsSuccess||(Aa=X.a.KG(),void 0!==Aa&&null!==Aa&&(Aa.set("AppName",ta),Aa.set("AuthLibrary",this.XJ()),Aa.set("ErrorCode",ya.ErrorCode),Aa.set("ErrorMessage",this.g_b(ta,ya.ErrorMessage)),ta=Object.assign(new wa.a,{durationMs:Ca,extendedProperties:Aa}),Z.Health.instance.recordKpiFailure(Qa.kpiName,"TryGetTokenFailure",
!1,!0,ta)));return ya}p6f(ya,ta){m.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",ta,this.g_b(ta,ya.ErrorMessage));const Aa=X.a.KG();void 0!==Aa&&null!==Aa&&(Aa.set("AppName",ta),Aa.set("AuthLibrary",this.XJ()),Aa.set("ErrorCode",ya.ErrorCode),Aa.set("ErrorMessage",this.g_b(ta,ya.ErrorMessage)),ta=Object.assign(new wa.a,{extendedProperties:Aa}),Z.Health.instance.recordKpiFailure(Qa.kpiName,"FailureBeforeGetToken",!1,!0,ta));return Promise.resolve(ya)}RYi(ya){return ya===
Fa.a.YCe}g_b(ya,ta){return this.RYi(ya)&&ta?"REDACTED":ta}qQm(ya){return x.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":!ya.loginHint||1>ya.loginHint.length?"empty":-1<ya.loginHint.indexOf("guest#")?"guest":-1<ya.loginHint.indexOf("ext#")?"external":0>ya.upn.indexOf("@")?"no-at":"supported"}aen(){return 1===this.m5}Ehj(ya,ta,Aa){let oa=null,za=null,ja=null,fa=null;ya?ya.ErrorCode||ya.ErrorMessage?(za=ya.ErrorCode?ya.ErrorCode:Qa.bmi,ja=ya.ErrorMessage?ya.ErrorMessage:"No message"):ya.Token?
ta?oa=ya.Token:(za=Qa.Ewo,ja="A rejected promise returned a token."):(za=Qa.bmi,ja=JSON.stringify(ya)):(za=Qa.CQn,ja="No result came from Auth Token Strategy");ya&&ya.Telemetry&&!this.RYi(Aa)&&(fa=ya.Telemetry,m.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(fa)));if(za===Qa.uNn||za===Qa.ilp)za=Qa.Y0j,ja="Auth Library Timed Out";za===Qa.ual&&-1<ja.indexOf(Qa.nTk)&&(za=Qa.T4i);if(za||ja)oa=null;return Object.assign(new w.a,{IsSuccess:!!oa,Token:oa,ErrorCode:za,ErrorMessage:ja,Telemetry:fa})}static get Vji(){return x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",
!1)}static get K_l(){return x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}Qa.ilp="token_renewal_error";Qa.bmi="Exception";Qa.CQn="NoResult";Qa.Ewo="RejectToken";Qa.uNn="monitor_window_timeout";Qa.Y0j="Timeout";Qa.Fdp="authTokenStrategy_timeout";Qa.ual="login_required";Qa.nTk="AADSTS50058";Qa.T4i="Cookies Disabled";Qa.kpiName="OAuthManager";Qa.lKn=2;Object(G.a)(Qa,"OAuthManager",null,[238])},1676:function(G,J,d){G=d(0);class m{constructor(y,
v,u,x){this.esk=y;this.uLk=v;this.sLk=u;this.vLk=x}get SXd(){return this.esk}get zve(){return this.uLk}get xve(){return this.sLk}get resultType(){return this.vLk}}Object(G.a)(m,"SearchContext",null,[1602]);class f{cZd(y,v,u,x){var z=u-v;let A;if(100<=z)z=v,A=u;else{z=Math.max(0,v+Math.ceil(z/2)-50);A=Math.min(y.length,z+100);z=Math.max(0,A-100);let F;if(z&&" "!==y.charAt(z-1)){F=Math.min(v,z+10);for(var D=z;D<F;++D)if(" "===y.charAt(D)){z=D+1;break}}if(A!==y.length&&" "!==y.charAt(A))for(F=Math.max(u,
A-10),D=A-1;D>=F;--D)if(" "===y.charAt(D)){A=D;break}}y=y.substring(z,A);return new m(y,v-z,u-z,x)}dZd(y){return this.cZd(y.EDi(),y.Fc,y.end,"")}}Object(G.a)(f,"SearchContextFactory",null,[1588]);var a=d(128),l=d(1659);d.d(J,"a",function(){return w});class w extends f{constructor(){super()}dZd(y){let v=y.Fc,u=y.end;const x=({Fc:v,end:u}=w.cEm(y,v,u)).returnValue;y=l.a(y.type);return this.cZd(x,v,u,y)}static get instance(){return null!=w.JZg?w.JZg:w.JZg=new w}static cEm(y,v,u){y=y.EDi();return w.fCj(y,
v,u)}static fCj(y,v,u){const x=a.AParagraphNode.iV(y);if(x.length<y.length){y=y.substring(0,v);const z=a.AParagraphNode.iV(y);y=y.length-z.length;v-=y;u-=y}return{returnValue:x,Fc:v,end:u}}}Object(G.a)(w,"EditorSearchContextFactory",f,[])},1679:function(G,J,d){G=d(0);var m=d(2),f=d(21),a=d(358),l=d(778),w=d(25),y=d(23),v=d(144),u=d(52),x=d(590),z=d(214),A=d(241),D=d(85),F=d(28),I=d(8),H=d(3),N=d(5),M=d(63),U=d(503),O=d(1138);class V{create(){return new O.a}}Object(G.a)(V,"FootnoteEndnoteContainerNodeFactory",
null,[296]);var Y=d(576);d.d(J,"a",function(){return Q});class Q{constructor(S,P,T,Z,X,aa,ia,wa,ma){this.wPd=null;Q.ga=S;this.lG=T;this.O3e=Z;this.Grk=aa;this.Zc=ia;this.hb=X;this.jFk=wa;this.Vsk=ma;Q.gi=P}Ske(S,P){this.m1l(S);S.Ub(7);this.lG.PYi(S,P)||S.Lf(7)}m1l(S){if(this.O3e.C0i(S)){var P=!1,T=!1;if(S.Ub(7)){do{const Z=S.currentNode;if(37===Z.type)switch(Z.getValue(N.a.n7)){case 0:T=!0;break;case 1:P=!0}}while(S.Cj(7))}T||this.iNh(S,0);P||this.iNh(S,1)}}iNh(S,P){const T=this.Grk.create(M.a.uKa);
T.setValue(N.a.n7,P);S.Uf(T,7)}XMo(S){S&&this.HKj(S.zsa)}HKj(S){S&&(S=w.SelectionFactory.se(S.Jb.paragraph,S.Jb.cp+1),this.hb.Ic(S))}wPn(S){let P=this.jFk(S);void 0!==P&&null!==P?this.lG.Eta(P)&&(P=this.lG.eEi(P)):P=S;return this.Vsk(P)}A8o(){this.wPd?Q.gi.nK.removeEntry(this.wPd):this.wPd=Q.gi.nK.nka(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);Q.gi.nK.Uy(this.wPd)}H7k(S,P){S=this.Zc.Ksa(S,37,37);let T=!1;if(S.Xd()){do{const Z=S.currentNode;this.lG.k1f(Z)?
this.rTh(Z,P):T=!0}while(S.Fk())}T&&this.A8o()}rTh(S,P){U.f(S,T=>{Q.Wcm(T,P);return!0},12)}KYm(S,P){S=this.lG.k3c(S,P);return S?(S=this.Zc.jg(S))?S.WA():!1:!1}Byi(S,P){S=this.lG.k3c(S,P);S=this.Zc.jg(S);if(S.Xd()){do if(P=S.currentNode,1===P.getValue(N.a.Asa))return P;while(S.Fk())}return null}static l3c(){return new Q(m.AFrameworkApplication.va,y.StaticActiveAppFrame.za(),Y.a.instance,v.PageReader.instance,u.a.instance,new V,new x.a,z.OutlineNavigator.rPn,A.WordSectionNavigator.owf)}static get instance(){return null!=
Q.TZg?Q.TZg:Q.TZg=Q.l3c()}static get rl(){return null!=Q.S2g?Q.S2g:Q.S2g=f.a.instance.resolve("Box4.IParagraphEditor")}static Wcm(S,P){P.Lrb?Q.rl.Sr.rha(S,D.OutlineReader.K_(S)):Q.rl.Sr.rha(S,0);S=F.a.createTextRange(S,0,I.ParagraphReader.textLength(S));Q.ga.lg(S,H.a.font,2,!0,new a.a,new l.a(P.fontName));Q.ga.lg(S,H.a.oC,2,!0,new a.a,new l.a(P.fontSize))}}Q.ga=null;Q.gi=null;Object(G.a)(Q,"FootnoteEndnoteEditor",null,[264])},1687:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);var m;(function(f){f[f.unknown=
0]="unknown";f[f.supported=1]="supported";f[f.mpq=2]="userUnsupportedAnonymous";f[f.npq=3]="userUnsupportedNoLoginHint";f[f.o3p=4]="hostUnsupported";f[f.Jfq=5]="perfAutomation"})(m||(m={}));Object(G.b)("SupportStatus",m)},1695:function(G,J,d){d.d(J,"a",function(){return I});G=d(0);var m=d(345),f=d(54),a=d(21),l=d(187),w=d(7),y=d(122),v=d(84),u=d(11),x=d(116),z=d(574),A=d(128),D=d(108),F=d(8);class I{constructor(H,N,M,U,O,V=null,Y="",Q=!0,S=!1){this.kKa=this.cBe=this.Gxb=this.Dwj=this.$ue=null;this.K9c=
!1;this.RUf=null;this.cdg=0;this.LCe=null;this.context=H;this.me=H.view;this.ux=N;this.rd=O;this.cV=M;this.Aca=U;this.zna=this.UB=!1;this.fpe=null;this.Z$a=this.Qoc=!1;this.v9o=I.osf(H);this.browserName=Y;this.t$j=Q;this.sad=S;this.Q0a=!1;this.Nfc=0;if(H=Object(y.a)(97,O)?O:null){this.Dwj=new m.DictionaryPropertySet;this.Dwj.Bv(H);M=H.ja(l.a.ghd,f.a.nil);this.SVc=M!=f.a.nil?M.toString():f.a.create().toString();if(H.ja(l.a.Dsj,!1)){this.Qoc=!0;this.Z$a=H.ja(l.a.Z$a,!1);this.fpe=V;for(V=this.me.lb.Og;V.Ex;)V=
V.getContext(0);if(O=Object(v.a)(A.AParagraphNode,V.node)){M=0;U=F.ParagraphReader.textLength(O);switch(V.contextId){case u.a.Bd:M=V.cpBegin;U=V.cpEnd;break;case u.a.Vc:M=U}this.$ue=x.FormattingReader.U6d(V.node,M,V.Fb);w.ULS.shipAssertTag(6305503,307,!!this.$ue);O=D.a.lkc(O);for(const P of O)P.cpEnd<=M||P.cpBegin>=U||I.Np.hV(V.node,P.hyperlink)}}this.zna=H.ja(l.a.zna,!1);this.Q0a=H.ja(l.a.Q0a,!1);this.Gxb=H.ja(l.a.Gxb,null)}else this.SVc=f.a.create().toString();N&64&&(this.zna=!0)}static get Np(){return null!=
I.CYg?I.CYg:I.CYg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static osf(H){if(H){if(H.Ex){for(let N=0;N<H.length;N++)if(I.osf(H.getContext(N)))return!0;return!1}if(Object(y.a)(z.a,H))return I.osf(H.Hk);if(F.ParagraphReader.Xb(H.node)&&H.node.XQ)return!0}return!1}}Object(G.a)(I,"ClipboardActionArguments",null,[])},1696:function(G,J,d){d.d(J,"a",function(){return M});G=d(0);var m=d(21),f=d(54),a=d(94),l=d(64),w=d(44),y=d(645),v=d(144),u=d(590),x=d(120),z=d(111),A=d(5),D=d(949),F=d(834),I=d(576),
H=d(1624),N=d(1679);class M{constructor(U,O,V,Y,Q,S){this.lG=U;this.tRa=V;this.O3e=Y;this.IPe=Q;this.Zc=S}static get ei(){return null!=M.P4g?M.P4g:M.P4g=m.a.instance.Oa("Box4.Styles.StyleSettings")}w$m(U,O,V){const Y=this.$Ai(O,U.node),Q=U.node.Lc;if(!Q)return null;const S=new w.GraphTransaction(15);S.Ab(U.node);S.yi=V;V=this.x$m(Y,O);M.y$m(V,Q,U,O);S.dispose();return V}$Ai(U,O){const V=this.Zc.Ql();V.set(O);V.zb(7);V.ld(7);this.tRa.Ske(V,U);return V}x$m(U,O){const V=F.a.createNode();V.properties.setValue(A.a.n7,
O);U.Uf(V,8);this.IPe.LEl(V,O);return V}static get rg(){return null!=M.tUg?M.tUg:M.tUg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get j1(){return M.BT||(M.BT=new y.WACStyleSet)}static set j1(U){M.BT=U}static l3c(){const {FootnoteEndnoteDefaultContentInserter:U}=d(1795);return new M(I.a.instance,H.a.instance,N.a.instance,v.PageReader.instance,U.instance,new u.a)}static get instance(){return null!=M.C_g?M.C_g:M.C_g=M.l3c()}static y$m(U,O,V,Y){a.StaticTheCoauthManager.ud().Jo&&a.StaticTheCoauthManager.ud().Ak.yG(V.node);
const Q=new x.a;Q.setValue(A.a.Xic,U.id);Q.setValue(A.a.n7,Y);const S=O.ou(Q,f.a.create());M.rg.Gla(V,P=>D.a.getInstance(P,S,U.id),M.fvi(V.node,Y,Object(z.a)()))}static fvi(U,O,V){let Y=null;if(U=V.Iu(U))if(U=M.j1.iba(U))O=O?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference,this.ei.qr?(O=U.uy().zBa(O),Y=U.gh(l.a.Vb.Ae(O))):Y=U.XKa(O);return Y}}M.BT=null;Object(G.a)(M,"FootnoteEndnoteInserter",null,[292])},1701:function(G,J,d){d.d(J,"a",function(){return m});
G=d(0);class m{static $Co(f,a){m.p3e=f;m.D6e=a}static XCo(f,a){m.A6e=f;m.w5a=a}static dGi(){return m.A6e===m.w5a?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,m.w5a,m.p3e,m.D6e):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,m.A6e,m.w5a,m.p3e,m.D6e)}}m.A6e=0;m.w5a=0;m.p3e=null;m.D6e=null;Object(G.a)(m,"ReplaceAllContext",null,[])},1744:function(G,J,d){d.r(J);G=d(0);var m=d(2178),f=d(54),a=d(2),l=d(327),w=d(21),y=d(2084),v=d(23),u=d(7),x=d(286),z=d(2180),
A=d(12),D=d(15),F=d(1676);class I{constructor(zb="",Vb="",rc=!1,pb=!1){this.Hmn=rc;this.tqn=pb;this.actionId=zb;this.HOa=Vb}}Object(G.a)(I,"SearchEntryPointContext",null,[]);class H{constructor(zb){this.jja=null;this.Wt=!1;this.mQ=zb}initialize(){this.H2();this.eB();this.qaa(0)}eB(){this.jja.eB()}dispose(){this.mQ=null}y4c(){return!1}get cI(){return this.jja?this.jja.cI:0}qaa(zb){this.jja.qaa(zb)}get isVisible(){return this.Wt}Iff(zb){this.jja&&this.jja.LSp(zb)}eDj(zb){this.jja&&this.jja.qhq(zb)}i9j(zb){this.jja&&
this.jja.Zoq(zb)}V2h(){this.jja&&this.jja.lVp()}Hwe(zb){this.jja&&this.jja.Hwe(zb)}}Object(G.a)(H,"FindReplacePane",null,[408,13]);var N=d(73),M=d(1456),U=d(1156),O=d(184),V=d(189),Y=d(1139),Q=d(96),S=d(119),P=d(92),T=d(47),Z=d(29),X=d(436),aa=d(1582),ia=d(360),wa=d(1118),ma=d(758),na=d(95),Fa=d(1179);class Qa{constructor(zb){this.XWk=(Vb,rc)=>{this.xPd.mb(Vb)?this.xPd.Z(Vb,rc):this.xPd.add(Vb,rc);(Vb=this.Mhm(Vb))&&this.WUi(rc,Vb,this.a8h(ia.a.getTypeName()))};this.xPd=new na.a;this.SY=new na.a;
this.annotationType=aa.RoleDetectionAnnotation.getTypeName();zb.zso(this.XWk)}lD(zb,Vb){let rc;const pb=zb.parentPath.substr(zb.parentPath.lastIndexOf("\\")+1),bb=zb.content;if(!bb||this.Zpn(bb))""!==pb&&({value:rc}=this.xPd.Dc(pb,rc)).returnValue&&this.WUi(rc,zb,this.a8h(Vb)),Vb===ia.a.getTypeName()?(Vb=null,({value:Vb}=this.SY.Dc(pb,Vb)).returnValue?this.SY.Z(pb,zb):this.SY.add(pb,zb)):Vb===wa.a.getTypeName()&&this.SY.remove(pb)}WUi(zb,Vb,rc){const pb=this.Vxm(Vb);Vb=this.Nhm(Vb);0<Vb&&zb(rc,pb,
Vb)}Nhm(zb){try{return Number.parseInvariant(zb.id.substr(2))}catch(Vb){u.ULS.sendTraceTag(554747009,367,10,Vb.toString())}return-1}Mhm(zb){let Vb;return({value:Vb}=this.SY.Dc(zb,Vb)).returnValue?Vb:null}Vhd(zb){if(zb)for(const Vb of zb)this.lD(Vb,"AugLoop_Core_AddOperation")}Vxm(zb){if(zb=zb.content)switch(zb.roleType){case aa.RoleType.Heading1:return 1;case aa.RoleType.Heading2:return 2;case aa.RoleType.Heading3:return 3;case aa.RoleType.Heading4:return 4;case aa.RoleType.Heading5:return 5;case aa.RoleType.Heading6:return 6;
case aa.RoleType.Heading7:return 7;case aa.RoleType.Heading8:return 8;case aa.RoleType.Heading9:return 9}return-1}Zpn(zb){zb=zb.roleType;return zb===aa.RoleType.Heading1||zb===aa.RoleType.Heading2||zb===aa.RoleType.Heading3||zb===aa.RoleType.Heading4||zb===aa.RoleType.Heading5||zb===aa.RoleType.Heading6||zb===aa.RoleType.Heading7||zb===aa.RoleType.Heading8||zb===aa.RoleType.Heading9}a8h(zb){if(zb===ia.a.getTypeName()||zb===ma.a.getTypeName())return Fa.a.iOh;if(zb===wa.a.getTypeName())return Fa.a.Lwf;
throw Error.create("Invalid operation type");}}Object(G.a)(Qa,"RoleDetectionAnnotationHandler",null,[223]);var ya=d(155),ta=d(66),Aa=d(1232),oa=d(52),za=d(77),ja=d(104);class fa{constructor(zb){this.SY=new na.a;this.Wwh=zb}lD(zb,Vb){Vb===ia.a.getTypeName()?(Vb=null,({value:Vb}=this.SY.Dc(zb.id,Vb)).returnValue?this.SY.Z(zb.id,zb):this.SY.add(zb.id,zb)):Vb===wa.a.getTypeName()&&this.SY.remove(zb.id);this.Wwh&&this.Wwh()}Vhd(zb){if(zb)for(const Vb of zb)this.lD(Vb,ia.a.getTypeName())}vjc(){var zb;const Vb=
[];if(0<(null===(zb=this.SY)||void 0===zb?void 0:zb.count))for(const rc of this.SY.values)Vb.push(rc);return Vb}}Object(G.a)(fa,"ContractEntityAnnotationHandler",null,[223]);var Ca=d(3),xa=d(1756);class ua{constructor(zb){this.ga=zb}KVn(){this.XUd()}MXn(zb){this.ga.Pb(D.a.x$d,2,zb)}X_n(){xa.a.Usd();this.XUd()}XUd(){this.ga.Ob(Ca.a.zec,2)}m2n(){this.ga.Ob(Ca.a.SDf,2)}onSearchQueryChanged(zb){this.ga.Pb(Ca.a.TDf,2,zb)}U3n(){this.ga.Ob(D.a.replace,2)}V3n(){this.ga.Ob(D.a.replaceAll,2)}Q3n(){this.ga.Ob(A.a.ODf,
2)}R3n(){this.ga.Ob(A.a.gEf,2)}T3n(){this.ga.Ob(Ca.a.Amg,2)}S3n(){this.ga.Ob(Ca.a.gcg,2)}Nuc(zb){this.ga.Pb(D.a.Nuc,2,zb)}}Object(G.a)(ua,"FindReplaceActions",null,[425]);var sa=d(147);class Ea{}Ea.wS=sa.a.Lpb;Ea.xtc=0;Ea.uAa="FindReplaceTaskPaneData";Ea.xS=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(G.a)(Ea,"FindReplaceConstants",null,[]);var Ja=d(824);class nb{Q3j(zb){var Vb,rc,pb;return X.a.Wqb(null===(pb=null===(rc=null===(Vb=v.StaticActiveAppFrame.za())||void 0===Vb?void 0:
Vb.ib)||void 0===rc?void 0:rc.$c)||void 0===pb?void 0:pb.td,zb)}clearSelection(){if(this.s_e){const zb=this.Q3j(this.s_e);zb&&zb.ora()}this.s_e=this.YDh=null}OMo(zb){this.clearSelection();if(zb){const Vb=this.Q3j(zb.parentPath);if(Vb){const rc=zb.content;rc&&(this.YDh=zb.id,Vb.w_a([new Ja.a(rc.range.start,rc.range.start+rc.range.length)]),Vb.b8f(0,1));this.s_e=zb.parentPath}}}}Object(G.a)(nb,"RangeAnnotationContentSelector",null,[]);var ub=d(1701);class Yb{constructor(zb){this.tDk=zb}get zk(){return this.tDk.value}yBm(zb){zb=
this.zk.z9a(zb);return this.djn(zb)?null:zb}djn(zb){return zb.id===this.zk.nKa.id}static get instance(){return null!=Yb.lZg?Yb.lZg:Yb.lZg=Yb.LG()}static LG(){const zb=new x.a(()=>y.FindManager.instance.zk);return new Yb(zb)}}Object(G.a)(Yb,"SearchResultOrder",null,[]);var yb=d(8),Za=d(287);class Ya{constructor(zb){this.P_e=zb}get NE(){return this.P_e.value}getSelectedText(){var zb=this.NE.Tka;if(zb){const Vb=zb.cpBegin,rc=zb.cpEnd-Vb;if(0<rc&&(zb=zb.node,yb.ParagraphReader.Xb(zb)))return zb.characterData.substr(Vb,
rc)}return null}static getInstance(){return Ya.Qm()}static Qm(){const zb=new x.a(()=>Za.a.instance);return new Ya(zb)}}Object(G.a)(Ya,"SelectionHelper",null,[]);var Pa=d(35),rb=d(105),tb=d(396),ob=d(935),Oa=d(262),Xa=d(416),ab=d(1977);sa=d(210);var cb=d(252),ib=d(362),Ub=d(111),lb=d(696);class Qb extends sa.a{constructor(zb,Vb,rc){super(zb,Vb,cb.a.$sa());this.GNa=rc;this.LNi=!1}get g2f(){return!0}get Lla(){return super.Lla|248}static wJl(zb){var Vb=v.StaticActiveAppFrame.za().ib.$c;const rc=ib.a.instance.Mc(3);
Vb&&(Vb=Object(Ub.a)().tU(Vb))&&(zb=new Qb(new lb.a,w.a.instance.resolve("Box4.IHtmlViewRootFactory"),zb),rc.Tod(zb.oc),zb.qF(Vb),rc.dispose(),zb.LNi=!0)}}Object(G.a)(Qb,"WordNavigationPaneReactHeadingsView",sa.a,[193,129,13]);class fc extends H{constructor(zb,Vb,rc,pb,bb,Pb,mb,Ua,vb,Ia,Ma,qb,Xb,Cc){var Ec,Wb;super(zb);this.yDb=Ea.wS;this.UPk="FindReplaceTaskPaneProps";this.Yb=N.FocusManager.instance();this.X1a=this.$Sa=this.X1=this.G$e=null;this.D4b=a.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");
this.Xnk=a.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");this.hFk=null===(Ec=a.AFrameworkApplication.K)||void 0===Ec?void 0:Ec.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",!1);this.YLc=null===(Wb=a.AFrameworkApplication.K)||void 0===Wb?void 0:Wb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneAutoFocusOnScroll",!1);this.P7j=()=>{this.isVisible&&this.AZd===z.a.intelligentPlaceholder&&this.Cn()};this.KC=new M.a;this.ckh=Vb;this.MQa=z.a.headings;this.KRc=
m.a.initial;this.qxa=new za.a;this.dT="";this.DHc={matchCase:!1,matchWholeWord:!1};this.C6e="";this.p8e=null;this.q6=rc;this.DFh=!1;this.Skb=pb;this.hb=bb;this.zFk=Pb;this.XHa=mb;this.VK=Ua;this.tId=!0;this.v$=this.u$=!1;this.Re=vb;this.gF=Ia;this.Gb=Ma;this.QY=qb;this.Mch=Xb;this.Bl=Cc;this.nLe&&this.XHa.owo(()=>{this.Cn()});this.YLc&&(this.Nne=this.Nne.bind(this))}get naf(){return 1}get nLe(){return this.D4b&&this.Xnk&&!!this.Re}get oLe(){return this.D4b&&this.hFk&&!!this.Re}get headingsReady(){return this.gF?
this.gF.headingsReady:!1}set headingsReady(zb){this.gF&&(this.gF.headingsReady=zb)}get AZd(){return this.MQa}sUj(){this.MQa=z.a.headings;this.Cn()}Q5o(){this.MQa=z.a.contracts;this.Cn()}jUj(){this.MQa=z.a.find;T.a("NavigationPaneFind");this.Cn()}bVj(){this.MQa=z.a.replace;this.Cn()}EUj(){this.MQa=z.a.intelligentPlaceholder;this.Cn()}Mpd(zb){this.DFh=zb;this.Cn()}y4c(){return this.AZd===z.a.replace}get cI(){return this.KRc}qaa(zb){this.KRc=zb;this.Cn()}Iff(zb){this.cZk(zb);this.Cn()}cZk(zb){const Vb=
this.zFk(zb[zb.length-1]);if(Vb){let rc=-1;for(let pb=0;pb<this.qxa.count;pb++)if(Vb.id===this.qxa.J(pb).id){rc=pb;break}-1===rc?u.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.qxa.pD(rc,this.y8h(zb))}else this.qxa.addRange(this.y8h(zb))}eDj(zb){for(const Vb of zb)for(zb=this.qxa.count-1;0<=zb;zb--)if(this.qxa.J(zb).id===Vb.id){this.qxa.removeAt(zb);break}this.Cn()}i9j(zb){for(const Vb of zb)for(zb=this.qxa.count-1;0<=zb;zb--)if(this.qxa.J(zb).id===Vb.id){this.qxa.Z(zb,
this.x8h(Vb));break}this.Cn()}V2h(){this.qxa.clear();this.p8e=null;this.Cn()}Hwe(zb){this.p8e=zb?zb.id:null;this.Cn()}y8h(zb){if(!zb)return new za.a;const Vb=new za.a;for(const rc of zb)Vb.add(this.x8h(rc));return Vb}x8h(zb){const Vb=this.Skb.dZd(zb);return{id:zb.id,searchBeginIndex:Vb.zve,searchEndIndex:Vb.xve,searchResult:Vb.SXd}}gFe(){}Xzp(){var zb={};this.mQ.Nuc(zb);zb=zb[U.a.Value];this.G$e=Z.c(zb)?"":zb;this.Cn()}ZVa(){return this.dT}yQb(){return this.C6e}Ezg(zb){this.dT=zb;this.Cn()}TIa(){}initialize(){this.YMd=
window.performance.now();const zb=this.Yb.ge(this.yDb);zb.parent=O.AFrame.mq;zb.iK=!0;this.H2();this.qaa(m.a.initial)}tS(){this.isVisible?(u.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),V.UISurfaces.Hv().then(zb=>{zb.setSelectedTaskPane(this.yDb,this.naf);this.Ica();this.tId&&this.EPj(!0);return null}).catch(zb=>{fc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],zb)})):(this.Upd(),this.tId&&this.EPj(!1))}EPj(zb){const Vb=
this.ckh();Vb?this.dT=Vb:zb&&this.dT||(this.dT="");this.mQ.onSearchQueryChanged(this.dT)}fta(){V.UISurfaces.Hv().then(zb=>{zb.hideTaskPane(this.yDb,this.naf);return null}).catch(zb=>{fc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],zb)})}H2(){this.q6.NUa();this.X1=this.q6.ggc(this.Yb);this.IWk()}Upd(){V.UISurfaces.Hv().then(zb=>{this.YMd=window.performance.now();zb.showTaskPane(this.yDb,this.MB());zb=[Object.assign(new Pa.a,{name:"Tab",string:this.MQa})];const Vb=window.performance.now()-
this.YMd;T.a("NavigationPaneOpen",!0,Vb,zb);return null}).catch(zb=>{fc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],zb)})}Cn(){V.UISurfaces.Hv().then(zb=>{zb.updateTaskPane(this.yDb,this.MB());return null}).catch(zb=>{fc.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],zb)})}MB(){var zb;const Vb={activeTab:z.a.initial};this.KC.tyb(Vb);a.AFrameworkApplication.Ld("ImprovedNavPaneDiscoverability;ImprovedNavPaneDiscoverabilityCf");const rc=null===(zb=
a.AFrameworkApplication.K)||void 0===zb?void 0:zb.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImprovedNavPaneDiscoverabilityIsEnabled",!1);return Object.assign(new Y.a,{title:Ea.xS,hideHeader:!1,width:320,location:this.naf,contentProps:Vb,onOpen:()=>{this.Wt=!0;this.Mvo();this.Nso();this.tId&&this.Ica();a.AFrameworkApplication.Ld("NavPaneAutoFocusOnScroll-tf;NavPaneAutoFocusOnScroll-cf");this.YLc&&this.Guo();v.StaticActiveAppFrame.za().Ie();v.StaticActiveAppFrame.za().$5a(this.P7j)},onClose:()=>
{try{const pb=window.performance.now();this.sha();this.Wt=!1;this.isp();this.Ksp();this.YLc&&this.Asp();this.mQ.X_n();this.G$e="";this.KRc=m.a.initial;v.StaticActiveAppFrame.za().vvc(this.P7j);v.StaticActiveAppFrame.za().Ie();const bb=window.performance.now()-pb;T.a("NavigationPaneClose",!0,bb)}catch(pb){fc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],pb)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0,isNonClosablePane:rc,showBackButton:rc,onManualClose:()=>
{rc&&T.a("NavPaneBackButtonPressed")}})}Mvo(){this.nLe&&!this.$Sa&&X.a.Pl().then(()=>{this.$Sa=new Qa(this.XHa);this.Re.nb(this.$Sa,this.$Sa.annotationType);this.Re.getAnnotationsByType(this.$Sa.annotationType).then(zb=>{this.$Sa.Vhd(zb)})})}Ksp(){this.nLe&&this.$Sa&&(this.Re.xc(this.$Sa,this.$Sa.annotationType),this.$Sa=null)}qnp(){if(this.oLe){var zb=new ab.ContractEntitySignal;zb=Object.assign(new ob.a,{parentPath:["Signal",Oa.a.getTypeNameFor(zb)],items:[Object.assign(new Xa.a,{body:zb})]});this.QY.getAugLoopRuntimeManager().submitOperation(Object.assign(new tb.a,
{operation:zb}))}}Nso(){this.oLe&&!this.X1a&&X.a.Pl().then(()=>{this.X1a=new fa(this.Cn);this.Re.nb(this.X1a,ab.ContractEntityAnnotation.getTypeName());this.qnp();this.Re.getAnnotationsByType(ab.ContractEntityAnnotation.getTypeName()).then(zb=>{this.X1a.Vhd(zb)})})}get Ui(){return this.Bl}Guo(){this.Ui.N_k(this.Nne)}Asp(){this.Ui.iAo(this.Nne)}isp(){this.oLe&&this.X1a&&(this.Re.xc(this.X1a,ab.ContractEntityAnnotation.getTypeName()),this.X1a=null)}IWk(){this.KC.ON(this.ism());this.KC.ON(this.ksm());
this.KC.ON(this.Pum());this.KC.ON(this.snm());this.KC.ON(this.Lwm());this.KC.ON(this.jgm());this.KC.ON(this.onLinkExecute());this.KC.ON(this.onPivotTabExecute());this.KC.ON(this.QKm());this.KC.ON(this.LNm());this.KC.ON(this.pwm());this.KC.ON(this.yOm());this.KC.ON(this.aIm())}yOm(){return zb=>{zb.autoDetectedHeadingsToggleDisabled=this.XHa?!this.XHa.Pal():!0}}LNm(){return zb=>{zb.type=this.UPk}}onLinkExecute(){return zb=>{zb.onLinkExecute=()=>{this.mQ.m2n()}}}Nne(){this.Ui.twc||(this.gVe&&this.Gb.vf(this.gVe),
this.gVe=new Q.a(0,1,0,()=>{this.gF.K0m(this.Ui.bfm());this.Cn()}),this.Gb.Zb(this.gVe))}onPivotTabExecute(){return zb=>{zb.onPivotTabExecute=Vb=>{switch(Vb){case z.a.headings:this.sUj();break;case z.a.replace:this.bVj();break;case z.a.contracts:this.Q5o();break;case z.a.intelligentPlaceholder:this.EUj();break;default:this.jUj()}Z.b(this.dT)&&(this.dT=this.ckh(),this.dT||(this.dT=""),Z.b(this.dT)||(this.mQ.onSearchQueryChanged(this.dT),this.Cn()))}}}QKm(){return zb=>{zb.showOutOfSyncNotification=
this.DFh}}ksm(){return zb=>{zb.findSearchBoxContent={onSearchQueryChanged:Vb=>{this.dT=Vb;this.Cn();this.mQ.onSearchQueryChanged(Vb)},findOptions:this.DHc,matchCase:this.u$,matchWholeWord:this.v$,findSearchText:this.dT,onClearButtonExecute:()=>{void 0!==this.dT&&null!==this.dT&&""!==this.dT&&(this.dT="",this.hb.Ic(null),this.mQ.KVn())},onMatchCaseExecute:()=>{this.DHc.matchCase=!this.DHc.matchCase;this.u$=!this.u$;this.Cn();this.mQ.Q3n()},onMatchWholeWordExecute:()=>{this.DHc.matchWholeWord=!this.DHc.matchWholeWord;
this.v$=!this.v$;this.Cn();this.mQ.R3n()},onMenuClose:()=>{if(this.X1)this.X1.onMenuClose()},onMenuOpen:()=>{if(this.X1)this.X1.onMenuOpen()}}}}jgm(){return zb=>{zb.activeTab=this.AZd}}pwm(){return zb=>{zb.autoDetectedHeadingsToggleState=this.XHa?this.XHa.Qal:!1;this.gF.a0c=zb.autoDetectedHeadingsToggleState;!zb.autoDetectedHeadingsToggleState&&this.XHa&&this.XHa.bsd(!1)}}ism(){return zb=>{const Vb={onReplaceAllExecute:()=>{this.mQ.V3n()},onReplaceExecute:()=>{this.mQ.U3n()},onReplaceQueryChanged:rc=>
{this.C6e=rc;this.Cn()},replaceSearchText:this.C6e};zb.findReplaceContent={searchResults:this.qxa.toArray(),replaceSearchBoxContent:Vb,onNextSearchResultExecute:()=>{this.mQ.S3n()},onPrevSearchResultExecute:()=>{this.mQ.T3n()},onSearchResultSelected:rc=>{const {FindReplaceUIManager:pb}=d(1744);this.mQ.MXn(rc);pb.waj(1)},selectedResultId:this.p8e,summaryLabel:this.G$e,explanationText:this.vrm(this.KRc),haveTooManySearchResults:this.KRc===m.a.Vha}}}vrm(zb){switch(zb){case m.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;
case m.a.JYa:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case m.a.zvc:return ub.a.dGi();case m.a.Vha:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}aIm(){return zb=>{zb.replaceFollowUpsWithCommentsIsEnabled=!0}}Lwm(){return zb=>{var Vb=this.VK.Zgm();const rc=[];for(const pb of Vb)Vb=this.VK.i5d(pb.Lc,pb.id),rc.push({id:pb.id.toString(),intelligentPlaceholderAnchorText:Vb});zb.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:rc,onIntelligentPlaceholderInputExecute:pb=>
{this.dT=pb;this.MQa=z.a.find;this.Cn();this.mQ.onSearchQueryChanged(pb)},onSearchResultSelected:pb=>{this.Cn();pb=f.a.Cf(pb);this.VK.YMo(pb)}}}}Pum(){return zb=>{let Vb=()=>{};this.XHa&&(Vb=Object(ja.a)(this.XHa,this.XHa.bsd,"toggleAutoDetectedHeadings"));zb.headingsContent={onHeaderInputExecute:rc=>{this.dT=rc;this.MQa=z.a.find;this.Cn();T.a("NavigationPaneFind");this.mQ.onSearchQueryChanged(rc)},renderHeadingContent:(rc,pb,bb)=>{this.Gb.Zb(new Q.a(0,1,100,()=>{var Pb=window.performance.now()-this.YMd,
mb=this.gF.z8;this.headingsReady=!0;this.Cn();bb.style.display="none";mb.first&&(rc.style.display="block");this.Gb.Zb(new Q.a(1,1,0,()=>{Qb.wJl(this)}));mb=window.performance.now()-this.YMd;T.a("NavigationPaneHeadingsLoaded",!0,mb,[Object.assign(new Pa.a,{name:"NavPaneReactHeadings",bool:!0})]);Pb=[Object.assign(new Pa.a,{name:"HeadingFetchStart",double:Pb}),Object.assign(new Pa.a,{name:"HeadingFetchFinished",double:mb})];T.a("NavigationPaneHeadingsLoadDetails",!0,void 0,Pb)}))},autoDetectedHeadingsToggle:Vb,
onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,headingsList:this.gF.z8,onHeadingChevronClick:rc=>{this.gF.f4l(rc);this.Cn()},onClickHeading:rc=>{this.Ui.twc=this.YLc;if(this.Gb.Rw){u.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",rc);const pb=window.performance.now();this.Gb.Zb(new Q.a(0,1,0,()=>{this.gF.onClickHeading(rc);this.Cn();const bb=window.performance.now()-pb;T.a("NavigationPaneAsyncOnClickHeadingItem",
!0,bb)}))}else this.gF.onClickHeading(rc),this.Cn()},onClickBookmark:rc=>{this.Ui.twc=this.YLc;if(this.Gb.Rw){u.ULS.sendTraceTag(512328289,312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",rc);const pb=window.performance.now();this.Gb.Zb(new Q.a(0,1,0,()=>{this.gF.onClickBookmark(rc);this.Cn();const bb=window.performance.now()-pb;T.a("NavigationPaneAsyncOnClickHeadingItem",!0,bb)}))}else this.gF.onClickBookmark(rc),this.Cn()},onShareHeadingClick:rc=>
{this.gF.onShareHeadingClick(rc)},bookmarkIconUrl:ya.a.ki("BookmarkDefault.png")}}}rnm(){var zb,Vb=null===(zb=this.X1a)||void 0===zb?void 0:zb.vjc();if(Vb){zb=Array(Vb.length);let rc=0;for(const pb of Vb)(Vb=pb.content)&&(zb[rc++]={id:pb.id,type:Vb.type,value:Vb.value});return zb}return null}snm(){return zb=>{zb.contractsContent={onHeaderInputExecute:Vb=>{this.dT=Vb;this.MQa=z.a.find;this.Cn();T.a("NavigationPaneFind");this.mQ.onSearchQueryChanged(Vb)},contractEntities:this.rnm(),selectedEntityId:this.Mch.YDh,
onEntitySelected:Vb=>{var rc;const pb=null===(rc=this.X1a)||void 0===rc?void 0:rc.vjc();if(pb)for(const bb of pb)if(bb.id===Vb){this.Mch.OMo(bb);break}this.Cn()}}}}WOj(zb){this.tId=zb}cyp(zb){this.Gb.Zb(new Q.a(0,1,0,()=>{this.gF.yMg(zb)&&this.Cn()}))}sMi(zb){this.Gb.Zb(new Q.a(0,1,0,()=>{const Vb=this.gF.jYb;this.gF.tQl(zb)?this.Cn():0===this.gF.jYb&&0<Vb&&this.Cn()}))}LLg(zb,Vb){this.Gb.Zb(new Q.a(0,1,0,()=>{const rc=this.gF.jYb;this.gF.LLg(zb,Vb)?this.Cn():0<this.gF.jYb&&0===rc&&this.Cn()}))}KPl(zb){this.Gb.Zb(new Q.a(0,
1,0,()=>{const Vb=this.gF.jYb;this.gF.LPl(zb)?this.Cn():0===this.gF.jYb&&0<Vb&&this.Cn()}))}kZo(zb){this.gF.Kkp(zb);this.Cn()}iMg(zb){this.gF.iMg(zb)&&this.Cn()}r_d(zb){this.gF.r_d(zb)&&this.Cn()}njo(){return 0<this.gF.jYb}Ica(){this.Yb.Bg(this.yDb);u.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}sha(){if(this.Oab()){var zb;(zb=Object(ta.a)().zd)?(zb=zb.xL,u.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(zb=this.Yb.RW,
u.ULS.sendTraceTag(40469192,312,50,"Taskpane now hidden with focus on default scope."));this.Yb.Bg(zb)}}Oab(){return!!this.Yb.currentScope&&this.Yb.currentScope.name===this.yDb}static getInstance(){return fc.Qm()}static Qm(){var zb,Vb;return new fc(new ua(a.AFrameworkApplication.va),Object(ja.a)(Ya.getInstance(),Ya.getInstance().getSelectedText,"getSelectedText"),Aa.a.instance,F.a.instance,oa.a.instance,Object(ja.a)(Yb.instance,Yb.instance.yBm,"getNextSearchResult"),w.a.instance.Oa("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),
w.a.instance.Oa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),w.a.instance.Oa("Box4.AugmentationLoop.IAnnotationStorage"),w.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),S.a.instance,w.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),new nb,null===(Vb=null===(zb=v.StaticActiveAppFrame.za())||void 0===zb?void 0:zb.ib)||void 0===Vb?void 0:Vb.sc)}static recordQosError(zb,Vb,rc){const pb=Object.assign(new rb.a,{extendedProperties:new Map});rc&&pb.extendedProperties.set("exception",
rc);P.Health.instance.recordQosError(zb,Vb,!1,!0,!1,!1,pb)}}Object(G.a)(fc,"ReactFindReplacePane",H,[407,408,13]);var Fc=d(1659);d.d(J,"FindReplaceUIManager",function(){return nc});class nc{constructor(zb,Vb,rc=null,pb=null,bb=null,Pb=null){this.rzd=this.Q5=0;this.v$=this.u$=this.PIb=!1;this.an=this.swh=this.Boa=null;this.TLa=this.HYe=!1;this.Nj=zb;this.Rp=rc;this.Skb=pb;this.eth=bb;this.Vd=Pb;nc.oec=new I}get C0f(){return this.HYe}set C0f(zb){zb!==this.HYe&&(this.HYe=zb,this.E1h())}Lye(zb){this.Q5=
zb;this.update();this.Q5||this.cI!==m.a.Rxb&&this.cI!==m.a.Vha?0<this.Q5&&this.cI===m.a.JYa?this.qaa(m.a.Rxb):this.Q5>nc.D1j&&this.cI!==m.a.Vha&&(u.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.qaa(m.a.Vha)):this.qaa(m.a.JYa)}hxe(zb){this.rzd=zb;this.TLa&&this.update();this.eth&&!this.eth.value.pld&&this.azg()}reset(){}eEf(){this.Vd&&(this.an=this.Vd.Vf("UserAction","Find"));if(this.TLa||!this.cI)this.TLa=!1,u.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.qaa(m.a.oKj)}Fic(){var zb;
this.TLa=!0;let Vb=this.Q5?m.a.Rxb:m.a.JYa;if(this.cI!==m.a.Vha&&y.FindManager.instance){const rc=y.FindManager.instance.zk;0<rc.doa&&(rc.doa>nc.D1j?Vb=m.a.Vha:this.gzp(rc))}this.qaa(Vb);this.update();this.an&&(this.an.stop(),this.an=null);nc.lKj=f.a.create().toString();nc.waj(0,this.xgc,this.ZVa().length,this.Q5);Object(Fc.b)()&&(null===(zb=this.Nj)||void 0===zb?0:zb.isVisible)&&(zb={},a.AFrameworkApplication.va.Pb(A.a.Tse,2,zb),zb[l.a.On]&&a.AFrameworkApplication.va.Pb(A.a.Yce,2,{CommandValueId:{query:this.ZVa(),
matchCase:this.u$,matchWholeWordOnly:this.v$,totalResultLimit:-1}}))}gzp(zb){const Vb=zb.nKa;let rc=Vb;const pb=[];do pb[pb.length]=rc,rc=zb.z9a(rc);while(Vb!==rc);this.Nj.Iff(pb);this.Boa&&this.Nj.Hwe(this.Boa)}update(){this.Nj&&this.Nj.Xzp()}get cI(){return this.Nj.cI}get xgc(){return this.Nj.AZd}vyb(zb){this.C0f=zb}E1h(){if(this.C0f)switch(this.cI){case m.a.Rxb:case m.a.JYa:case m.a.Vha:this.Nj.Mpd(!0)}else this.Nj.Mpd(!1)}qaa(zb){if(this.Nj.isVisible){switch(zb){case m.a.JYa:case m.a.Rxb:this.cI===
m.a.Vha&&(zb=m.a.Vha)}this.Nj&&(this.Nj.qaa(zb),this.E1h());this.update();this.azg()}}AVa(zb,Vb){const rc=this.TLa&&this.cI!==m.a.Vha;switch(zb){case 0:rc&&this.Nj.Iff(Vb);break;case 1:rc&&this.Nj.eDj(Vb);break;case 4:rc&&this.Nj.i9j(Vb);break;case 2:this.Nj.V2h();break;case 3:this.Boa=Vb[0],rc&&0<this.Q5&&this.Nj.Hwe(this.Boa)}}get matchCase(){return this.u$}set matchCase(zb){this.u$!==zb&&(this.u$=zb,this.l7j())}get matchWholeWord(){return this.v$}set matchWholeWord(zb){this.v$!==zb&&(this.v$=zb,
this.l7j())}l7j(){this.Nj.gFe()}ZVa(){return this.Nj.ZVa()}yQb(){return this.Nj.yQb()}Ezg(zb){this.Nj.Ezg(zb)}TIa(){this.Nj.TIa()}get cVj(){return 0<this.Q5&&this.cI!==m.a.Avc&&this.cI!==m.a.zvc}PQo(zb){let Vb="";zb?Vb=0<this.Q5?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.ZVa(),this.yQb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.ZVa(),this.yQb()):zb||0<this.Q5&&(Vb=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);
this.azg(Vb)}dispose(){this.Nj.dispose()}y4c(){return this.Nj.y4c()}LVo(zb,Vb=!0){zb!==this.xgc&&(zb===z.a.headings?(u.ULS.sendTraceTag(9056651,367,50,""),this.Nj.sUj()):zb===z.a.find?this.Nj.jUj():zb===z.a.replace?this.Nj.bVj():zb===z.a.intelligentPlaceholder&&(Vb||this.Nj.WOj(Vb),this.Nj.EUj()))}lA(zb,Vb=!0){this.Nj.WOj(Vb);zb?(this.PIb||this.EVf(),this.Nj.tS(),this.Q5||this.cI===m.a.JYa?a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.Nj.qaa(m.a.Rxb):
this.qaa(m.a.initial)):this.Nj.fta()}EVf(){this.PIb||(this.Nj.initialize(),this.PIb=!0)}azg(zb=""){var Vb=this.pIm();Vb&&(zb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,zb,Vb));this.Skb&&Vb&&this.Boa&&this.cI!==m.a.Vha&&this.cI!==m.a.Avc&&(Vb=this.Skb.dZd(this.Boa),zb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,zb,Vb.SXd));(Vb=this.urm())&&(zb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
zb,Vb));this.Rp&&zb&&this.swh!==zb&&(this.swh=zb,this.Rp.sendNotification(zb,!0))}pIm(){let zb="";switch(this.cI){case m.a.NXj:zb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case m.a.Rxb:zb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.rzd,this.Q5);break;case m.a.Vha:this.TLa&&(zb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.rzd,this.Q5));break;case m.a.JYa:zb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case m.a.Avc:zb=
WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case m.a.zvc:zb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return zb}urm(){let zb="";switch(this.cI){case m.a.initial:zb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,this.csm());break;case m.a.JYa:zb=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;case m.a.zvc:zb=ub.a.dGi();break;case m.a.Vha:zb=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return zb}csm(){let zb=
"";this.u$&&this.v$?zb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.u$?zb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchCase):this.v$&&(zb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return zb}static getInstance(zb){return nc.Qm(zb)}static Qm(zb){const Vb=
fc.getInstance();return new nc(Vb,zb,w.a.instance.resolve("Common.Utils.IAriaNotifier"),F.a.instance,new x.a(()=>y.FindManager.instance.zZb),v.StaticActiveAppFrame.za().hs)}static waj(zb,Vb=-1,rc=-1,pb=-1){u.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:zb,["SearchComplete.ResultsCount"]:pb,["SearchOpsCorrelation"]:nc.lKj,["ActionId"]:nc.oec.actionId,["SourceControlId"]:nc.oec.HOa,["IsNavPanOpenedAlready"]:nc.oec.Hmn,["IsSearchFromNavPane"]:nc.oec.tqn,["CurrentTab"]:Vb,["QueryLength"]:rc})}static Dil(zb,
Vb,rc){Vb=void 0!==Vb&&null!==Vb?void 0===Vb.SourceControlId||null===Vb.SourceControlId?"Unknown":Vb.SourceControlId:zb===D.a.Pyb?"FindKeyboardShorcut":zb===D.a.Qyb?"ReplaceKeyboardShorcut":"Unknown";switch(zb){case D.a.cyc:zb="ShowHeadingsPane";break;case D.a.Pyb:zb="ShowFindPane";break;case D.a.Qyb:zb="ShowReplacePane";break;case D.a.gyc:zb="ShowIntelligentPlaceholderPane";break;case D.a.t0a:zb="ToggleNavigationPane";break;default:zb="Unknown"}nc.oec=new I(zb,Vb,rc,!0)}}nc.D1j=100;nc.lKj=null;nc.oec=
null;Object(G.a)(nc,"FindReplaceUIManager",null,[361,241,13])},1745:function(G,J,d){d.r(J);G=d(0);var m=d(184),f=d(112),a=d(91),l=d(2),w=d(21),y=d(73),v=d(1182),u=d(71),x=d(23),z=d(7),A=d(15),D=d(508),F=d(1624),I=d(1938),H=d(33),N=d(361),M=d(10),U=d(483),O=d(17),V=d(282),Y=d(556),Q=d(52),S=d(147),P=d(576),T=d(1796);class Z{constructor(Za,Ya,Pa,rb,tb,ob,Oa){this.cwh=this.rAh=this.ejh=this.TK=this.tgb=this.X3b=this.hTe=this.bPe=this.KQe=this.kZ=this.Ria=this.bja=null;this.TEe=()=>{const Xa=this.kya.ekc(this.TK),
ab=this.kya.utm(this.TK);this.bPe.innerText=Xa.toString();this.hTe.innerText=ab.toString();I.a.C_b(this.bja,1===Xa?!1:!0);I.a.C_b(this.Ria,Xa===ab?!1:!0)};this.kTo=()=>{const Xa=this.Yb.getRegion(S.a.H8a);let ab;if(this.kZ&&!this.kZ.disabled)ab=this.kZ;else if(this.bja.disabled){if(this.Ria.disabled)return;ab=this.Ria}else ab=this.bja;ab.focus();Xa.Mk.mA(ab)};this.bva=(Xa,ab)=>{(Xa=ab.Gm.currentSelection)&&this.kZ&&I.a.C_b(this.kZ,O.SelectionEditor.Dm(Xa)?!0:!1)};this.Apf=()=>{if(!this.Ria.disabled){const Xa=
this.kya.ctb(this.TK)?A.a.gle:A.a.fle;this.ga.Ob(Xa,2)}return!0};this.Bpf=()=>{if(!this.bja.disabled){const Xa=this.kya.ctb(this.TK)?A.a.ile:A.a.hle;this.ga.Ob(Xa,2)}return!0};this.zpf=()=>{this.kZ&&!this.kZ.disabled&&this.ga.Ob(A.a.u6i,2);return!0};this.Yb=Za;this.ga=rb;this.Pg=tb;this.ne=ob;this.hb=Oa;this.kya=Pa;this.Caa=document.createElement("div");this.Caa.classList.add("FootnoteEndnoteActionBarControl");this.Caa.style.zIndex=String(V.a.W0d);this.Caa.style.position="relative";this.EGc=document.createElement("div");
this.EGc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.Caa.appendChild(this.EGc);this.aDl();this.Caa.appendChild(this.X3b);this.Caa.appendChild(this.tgb);this.N1=f.KeyInputManager.lc(a.a.Z4,0);this.Y6m();this.X6m()}Mka(Za){z.ULS.shipAssertTag(4520065,308,this.kya.Eta(Za));if(this.TK!==Za){this.TK=Za;this.TEe();Za=this.kya.ctb(this.TK);this.OFl(Za);this.TK.cQh(this.TEe);let Ya="",Pa="";const rb=this.kya.ekc(this.TK);-1!==rb&&(Ya=(rb-1).toString(),Pa=(rb+1).toString());Za?(this.Ria.title=
this.Ria.disabled?WordEditorIntl.WordEditorStrings.L_NextFootnote:String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,Pa),this.bja.title=this.bja.disabled?WordEditorIntl.WordEditorStrings.L_PrevFootnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,Ya)):(this.Ria.title=this.Ria.disabled?WordEditorIntl.WordEditorStrings.L_NextEndnote:String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,Pa),this.bja.title=this.bja.disabled?WordEditorIntl.WordEditorStrings.L_PrevEndnote:
String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,Ya));this.$wb()}}tNb(){this.TK&&(this.kZ&&this.kZ.parentNode===this.X3b&&this.X3b.removeChild(this.kZ),this.wPa(),this.TK.JAo(this.TEe),this.TK=null)}dispose(){this.Yb.ge(S.a.H8a).tt(this.N1)}OFl(Za){3===this.ga.mode&&(Za=Za?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.kZ=this.Xsf("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",Za,null),
H.a.Ls(this.kZ,H.a.Jja,Za),this.X3b.appendChild(this.kZ))}aDl(){this.X3b=document.createElement("div");this.X3b.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.tgb=document.createElement("div");this.tgb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.bja=this.Xsf("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.tgb.appendChild(this.bja);this.bPe=U.b("span",
"FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.tgb.appendChild(this.bPe);this.KQe=U.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.KQe.innerText=" / ";this.tgb.appendChild(this.KQe);this.hTe=U.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.tgb.appendChild(this.hTe);this.Ria=this.Xsf("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.tgb.appendChild(this.Ria)}Xsf(Za,
Ya,Pa,rb){Za=I.a.o7a(Za,Ya,Pa,rb,void 0===rb||null===rb);Za.setAttribute(H.a.Ph,H.a.eaa);return Za}Y6m(){const Za=this.Yb.ge(S.a.H8a);Za.parent=Y.a.mq;Za.bindAction(this.N1,A.a.Z6);Za.Bja(this.kTo)}X6m(){var Za=new N.DOMFocusListing(()=>this.Caa);Za.lna=!1;Za.Gn(2);Za.Gn(1);Za=this.Yb.Umb(this.Caa,this.Yb.ge(S.a.H8a),Za);Za.SZa();Za.aS=!0}$wb(){this.kZ&&(this.Pg.nb(M.a.click,this.kZ,this.zpf),this.ejh=this.ne.Zwb(this.kZ,this.zpf,a.a.Mu));this.Pg.nb(M.a.click,this.bja,this.Bpf);this.rAh=this.ne.Zwb(this.bja,
this.Bpf,a.a.Mu);this.Pg.nb(M.a.click,this.Ria,this.Apf);this.cwh=this.ne.Zwb(this.Ria,this.Apf,a.a.Mu);this.hb.Cw(this.bva)}wPa(){this.kZ&&(this.Pg.xc(M.a.click,this.kZ,this.zpf),this.ne.iAb(this.kZ,this.ejh));this.Pg.xc(M.a.click,this.bja,this.Bpf);this.ne.iAb(this.bja,this.rAh);this.Pg.xc(M.a.click,this.Ria,this.Apf);this.ne.iAb(this.Ria,this.cwh);this.hb.nY(this.bva)}static ptm(){return Z.qtm()}static qtm(){return new Z(y.FocusManager.instance(),T.a.instance,P.a.instance,l.AFrameworkApplication.va,
x.StaticActiveAppFrame.za().UE,x.StaticActiveAppFrame.za().VE,Q.a.instance)}}Object(G.a)(Z,"FootnoteEndnoteActionBarControl",null,[295]);var X=d(249),aa=d(12),ia=d(1679),wa=d(1892);class ma{constructor(Za,Ya,Pa,rb,tb,ob,Oa,Xa,ab,cb,ib,Ub){this.mG=null;this.bW=!1;this.ix=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.Z9b=Za;this.Chc=Ya;this.YCc=Pa;this.eHk=rb;this.D2e=tb;this.Zm=ob;this.Dib=Oa;this.Pg=Xa;this.Xyh=ab;this.Htk=ib;this.Ms=this.Z9b.ownerDocument.createElement("div");this.Ms.id=
"FootnoteEndnoteControlOverlay";this.Ms.className="EditingSurfaceOverlay";this.IK=this.tnm();this.u4(!1);this.Z9b.appendChild(this.Ms);this.Z9b.appendChild(this.IK);this.Chc.bind();this.zi=null;this.ga=Ub;this.tRa=cb}HFo(){const Za=this.Xyh();Za&&Za.nj&&(Za.Oxb=0,Za.fSd())}j6j(Za){if(this.NTc){const Ya=this.NTc.zsa;Ya&&(Ya.lZf=Za)}}get gK(){return this.bW}get NTc(){return this.mG}get dialog(){return this.zi}get jo(){return null!=this.hYg?this.hYg:this.hYg=w.a.instance.Qa("Common.IZoomManager")}Btf(){this.zi=
wa.a.ytm()}Pld(){this.zi=null}show(Za=!0){this.bW||(this.j6j(!0),this.Htk(),this.u4(!0),this.eB(),Za&&this.setFocus())}setFocus(){this.bW&&(this.Chc.gxc(),this.eHk())}update(){this.bW&&(this.mG.isConnected?this.YCc.TEe():this.dismiss())}dismiss(Za=!1,Ya=!1){this.bW&&(this.j6j(!1),this.fda(),this.HFo(),this.u4(!1),this.D2e(Ya),this.zi&&(this.ga.Ob(aa.a.cZc,2),this.zi=null),!Za&&this.mG&&this.mG.isConnected&&this.tRa.XMo(this.mG),this.tNb())}qEo(Za){const Ya=null!==this.jo.instance?this.jo.instance.Aj:
1;this.IK.style.width=Za.T6h*Ya+"px";this.ix.style.width=Za.SWc*Ya+"px";this.IK.style.marginLeft=Za.vfc*Ya+"px";this.Zm?this.ix.style.marginRight=Za.jsf*Ya+"px":this.ix.style.marginLeft=Za.Ffc*Ya+"px";if(Za=this.Xyh())Za=Za.RN,this.IK.style.bottom=Za.offsetHeight-Za.clientHeight+"px"}Mka(Za){z.ULS.shipAssertTag(4520073,308,this.Dib.Eta(Za));this.mG!==Za&&(this.mG=Za,this.Chc.Mka(Za),this.YCc.Mka(this.mG))}dispose(){this.dismiss();this.Chc.dispose();this.YCc.dispose()}eB(){this.Pg&&this.Pg.nb(M.a.click,
this.Ms,this.onClick)}fda(){this.Pg&&this.Pg.xc(M.a.click,this.Ms,this.onClick)}tnm(){let Za;Za=document.createElement("div");Za.classList.add("FootnoteEndnoteControl");this.ix=document.createElement("div");this.ix.classList.add("FootnoteEndnoteContent");this.ix.appendChild(this.Chc.Caa);this.ix.appendChild(this.YCc.Caa);Za.appendChild(this.ix);return Za}u4(Za){Za=(this.bW=Za)?"":"none";this.Ms.style.display=Za;this.IK.style.display=Za}tNb(){this.mG&&(this.Chc.tNb(),this.YCc.tNb(),this.mG=null)}static u8d(){const Za=
x.StaticActiveAppFrame.za().ib.sc;return Za&&Za.nj?Za:null}static ttm(Za,Ya,Pa,rb,tb){return new ma(Za,Ya,Pa,rb,tb,l.AFrameworkApplication.isRtl,P.a.instance,X.a.instance,ma.u8d,ia.a.instance,ma.gVl,l.AFrameworkApplication.va)}static gVl(){l.AFrameworkApplication.va.Pb(aa.a.Urb,2,!0)}}Object(G.a)(ma,"FootnoteEndnoteControl",null,[294]);var na=d(874),Fa=d(6),Qa=d(214),ya=d(37),ta=d(8),Aa=d(25),oa=d(82),za=d(1795),ja=d(377),fa=d(1049),Ca=d(627),xa=d(1517),ua=d(66),sa=d(122);class Ea extends ja.a{constructor(Za,
Ya,Pa,rb,tb,ob,Oa,Xa,ab,cb,ib,Ub,lb,Qb,fc,Fc,nc){super(S.a.Vka,Pa,rb,tb,Oa,Xa,ab,cb,ib,Ub,lb,Qb,fc,Fc,nc);this.Pch=Za;this.G4a=ob;this.G4a.xrd=this;Ya(this);this.features.HGg=!0}get QYi(){return!0}WPf(){const Za=this.Pch.rGf(this);return fa.ViewReference.UG(this,Za)}myf(Za){Object(sa.a)(Ea,Za)||this.Pch.jyf()}B4c(){return Ca.a.Hej}Pv(){super.Pv();this.G4a.kli()}qF(Za,Ya=null){super.qF(Za,Ya);this.G4a.Xki(this.jd.pk)}detach(){this.G4a.jli();super.detach()}F4d(){this.Pv()}static m7a(){const {FootnoteEndnoteControlManager:Za}=
d(1745);return new Ea(Za.instance,xa.a.srf,x.StaticActiveAppFrame.za().ib,Object(ua.a)(),()=>w.a.instance.resolve("Box4.IUndoManager"),w.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),l.AFrameworkApplication.va,w.a.instance.resolve("Box4.IHtmlViewRootFactory"),w.a.instance.resolve("Box4.IInteractiveEventNotifier"),w.a.instance.Qa("Box4.ITextMetricsAdapter"),w.a.instance.resolve("Box4.IRotatingCoordinateConverter"),w.a.instance.Qa("Common.IZoomManager"),w.a.instance.Oa("Box4.IContentControlViewElementManager"),
w.a.instance.Oa("Box4.CpConversionManagerImpl"),w.a.instance.Oa("Box4.ContentControlConfigSettings"),w.a.instance.Oa("Box4.IContentControlReader"),w.a.instance.Oa("Box4.IContentControlBoundaryNavigator"))}}Object(G.a)(Ea,"FootnoteEndnoteEditView",ja.a,[]);class Ja{constructor(Za,Ya,Pa,rb=!1){this.GDb=null;this.xXe=this.F$g=!1;this.hcm=()=>{const tb=String.format("{0} {1}",this.xXe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,
WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.Dw.sendNotification(tb,!0)};this.Yb=Za;this.kya=Ya;this.Bia=Pa();this.nEd=rb;this.Caa=document.createElement("div");this.Caa.classList.add("FootnoteEndnoteEditControl");this.EGc=document.createElement("div");this.EGc.classList.add("FootnoteEndnoteEditControlDividerElement");this.vJb=(new na.a(this.Caa,"WACViewPanel_FootnoteEndnoteEditControl")).BK;this.Caa.appendChild(this.EGc);this.Caa.appendChild(this.vJb)}get Dw(){return null!=
this.NTg?this.NTg:this.NTg=w.a.instance.resolve("Common.Utils.IAriaNotifier")}Mka(Za){z.ULS.shipAssertTag(4520077,308,this.kya.Eta(Za));this.GDb!==Za&&(this.GDb=Za,this.bkf(this.GDb),this.xXe=this.kya.ctb(this.GDb),this.nEd?(this.Bia.G_b(H.a.gTd),this.Yb.ge(S.a.Vka).y6(this.hcm)):this.Bia.GNj(this.xXe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,H.a.gTd))}tNb(){const Za=P.a.instance.ctb(this.GDb)?
"Footnote":"Endnote";z.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:Za,["CalloutHeight"]:this.Caa.scrollHeight});this.Bob();this.GDb=null}bind(){this.F$g||(this.Bia.Odc(this.vJb),this.F$g=!0)}gxc(){const Za=this.XJm();Za?this.Bia.Ic(Za):this.Bia.Dod()}dispose(){this.Bob()}bkf(Za){this.Bob();this.Bia.qF(Za,Za.pk)}Bob(){this.Bia.detach()}XJm(){let Za=0;var Ya=null,Pa=Fa.GraphIterator.eb(this.GDb);Qa.OutlineNavigator.Wba(Pa);if((Pa=ya.OutlineElementNavigator.Le(Pa))&&ta.ParagraphReader.Xb(Pa)){if(Ya=
Ja.wxm(Pa)){Za=Ya.Jb.cp+1;Ya=za.FootnoteEndnoteDefaultContentInserter.$di;const rb=Ya.length;Za+rb<=ta.ParagraphReader.textLength(Pa)&&Pa.characterData.substr(Za,rb)===Ya&&(Za+=rb)}Ya=Aa.SelectionFactory.se(Pa,Za)}return Ya}static vtm(){return Ja.wtm()}static wtm(){return new Ja(y.FocusManager.instance(),P.a.instance,()=>Ea.m7a(),l.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static wxm(Za){Za=oa.i(Za,10);return 0<Za.length?Za[Za.length-1]:null}}Object(G.a)(Ja,"FootnoteEndnoteEditControl",
null,[286]);var nb=d(1258);class ub{constructor(Za,Ya){this.qHa=Za;this.Zm=Ya}hlc(Za,Ya){Za=this.qHa.hlc(Za);var Pa=Ya.clientWidth;const rb=Ya.scrollLeft,tb=Za.T6h;let ob=Za.vfc,Oa=Za.vfc,Xa=ub.n9f,ab=ub.o9f,cb=tb,ib=Za.SWc;this.Zm?ab=Za.jsf-Oa:Xa=Za.Ffc-ob;Pa<tb&&(ob=Math.max(ob-rb,0),cb=Pa-ob,this.Zm?(Pa=Ya.scrollWidth-rb-Pa,Oa=Ya.scrollWidth-Za.vfc-tb,ab=Math.max(Za.jsf-Pa-Oa,ub.o9f),ib=cb-ab-ub.n9f):(Xa=Math.max(Za.Ffc-rb-ob,ub.n9f),ib=cb-Xa-ub.o9f));return new nb.a(ob,cb,Xa,ab,ib)}}ub.n9f=25;
ub.o9f=50;Object(G.a)(ub,"FootnoteEndnoteViewPositionProvider",null,[]);class Yb{constructor(Za,Ya=0,Pa=0){this.clientWidth=Za;this.scrollLeft=Ya;this.scrollWidth=Pa?Pa:Za}}Object(G.a)(Yb,"PageViewScrollContainerSizeInfo",null,[]);d.d(J,"FootnoteEndnoteControlManager",function(){return yb});class yb{constructor(Za,Ya,Pa,rb,tb,ob,Oa,Xa){this.hG=null;this.Ica=()=>{this.aq.bL(S.a.Vka);this.aq.bL(S.a.H8a);this.aq.ny(m.AFrame.Ho);this.Yb.eSc(S.a.Vka);this.Yb.Bg(S.a.Vka)};this.sTo=ab=>{this.aq.ny(S.a.Vka);
this.aq.ny(S.a.H8a);this.aq.bL(m.AFrame.Ho);this.Yb.yYc(S.a.Vka);(ab||this.Yb.currentScope&&(this.Yb.currentScope.name===S.a.Vka||this.Yb.currentScope.name===S.a.H8a))&&this.Yb.Bg(m.AFrame.Ho)};this.Yb=Za;this.aq=Ya;this.Rwk=Pa;this.Swk=rb;this.Qwk=tb;this.qHa=ob;this.uxa=Oa;this.a2=Xa;this.N1=f.KeyInputManager.lc(a.a.Z4,0);this.wVf();this.xW()}get control(){return this.hG}get dialog(){return this.control.dialog}get YWi(){return this.control.gK}Btf(){this.control.Btf()}Pld(){this.control.Pld()}bind(Za){this.Iyl(Za)}nDg(Za){if(this.control.NTc!==
Za.h7a)this.control.dismiss();else if(this.YWi)return;this.chc();this.control.Mka(Za.h7a);this.control.show(Za.dze)}chc(){if(this.a2){const Za=new v.a(!0);this.a2.ENa(Za)}}X0(){this.control.setFocus()}ttd(){this.control.update()}jyf(Za,Ya=!1){this.chc();this.control.dismiss(Za,Ya)}oEo(Za){const Ya=yb.u8d().RN;Za=this.qHa.hlc(Za,new Yb(Ya.clientWidth,Ya.scrollLeft,Ya.scrollWidth));this.control.qEo(Za)}dispose(){this.control.dispose();this.Yb.ge(S.a.Vka).tt(this.N1)}rGf(Za){z.ULS.shipAssertTag(4520074,
308,!!this.control);z.ULS.shipAssertTag(4520075,308,!!this.control.NTc);return this.sGf(this.control.NTc.id,Za)}Iyl(Za){const Ya=this.Swk(),Pa=this.Qwk();this.hG=this.Rwk(Za,Ya,Pa,this.Ica,this.sTo)}wVf(){const Za=this.Yb.ge(S.a.Vka);Za.parent=3===l.AFrameworkApplication.va.mode?u.a.zF:u.a.bvc;this.Yb.Uef(S.a.Vka);Za.bindAction(this.N1,A.a.Z6)}xW(){this.aq.xW(S.a.Vka);this.aq.xW(S.a.H8a)}sGf(Za,Ya){return()=>{const Pa=yb.u8d().jd.Lc.Eb(Za);this.uxa.cic();if(!Pa.isConnected)return z.ULS.sendTraceTag(4520076,
308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.nDg(new D.a(Pa,!0));return Ya}}static Qm(){const Za=new ub(w.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),l.AFrameworkApplication.isRtl);return new yb(y.FocusManager.instance(),x.StaticActiveAppFrame.za().Iy,ma.ttm,Ja.vtm,Z.ptm,Za,F.a.instance,w.a.instance.resolve("Box4.IPasteFloatieEventSource"),w.a.instance.resolve("Common.IAppSettingsManager"))}static u8d(){const Za=x.StaticActiveAppFrame.za().ib.sc;
return Za&&Za.nj?Za:null}static get instance(){return null!=yb.q_g?yb.q_g:yb.q_g=yb.Qm()}}Object(G.a)(yb,"FootnoteEndnoteControlManager",null,[265])},1756:function(G,J,d){G=d(0);var m=d(2),f=d(15),a=d(47),l=d(933),w={get interop(){var u=null===fishBowlUx||void 0===fishBowlUx?void 0:fishBowlUx.interop;if(!u)throw Error("fishBowlUx chunk is accessed before loading");return u}};d.d(J,"a",function(){return y});class y{static initialize(u,x){this.Qrj=x;this.Xmd=u;this.qNa=document.getElementById(this.Qrj);
try{this.Trc=document.createElement("div"),this.Trc.id=this.kPn,this.Trc.classList.add(this.P$l),this.qNa.append(this.Trc),this.K5f().then(()=>{this.interop=null===w||void 0===w?void 0:w.interop;this.controller=this.interop.renderFishBowlNavButton(this.Trc,{onclick:this.lPn});a.a("MicroNavIconShown")})}catch{a.a("MicroNavFloatieInitializationFailed")}}static async K5f(){return m.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("fishBowlUx"):(await Object(l.c)(this.Xmd)).xC.loadScript("fishBowlUx")}}
var v=y;y.Qrj="";y.kPn="FishBowlNavButton";y.P$l="FishBowlNavButton";y.controller=null;y.interop=null;y.Trc=null;y.qNa=null;y.lPn=()=>{m.AFrameworkApplication.va.Pb(f.a.t0a,2,null,void 0)};y.dispose=()=>{v.interop.dispose(v.Trc)};y.opp=()=>{v.controller&&v.controller.hide()};y.Usd=()=>{v.controller&&v.controller.show()};Object(G.a)(y,"NavButton",null,[])},1757:function(G,J,d){d.r(J);G=d(0);var m=d(19),f=d(2171),a=d(1939);class l extends a.a{constructor(){super();this.isCurrentUser=!1}}Object(G.a)(l,
"IsMeAtMentionOptionalAttributes",a.a,[]);var w=d(2172),y=d(1690),v=d(8),u=d(86),x=d(16),z=d(7),A=d(1775),D=d(1593);d.d(J,"ACommentFormatTranslator",function(){return F});class F{constructor(I,H){this.Ri=I;this.sJ=H}M6k(I,H){const N=v.ParagraphReader.text(H);let M=null,U=null,O=null,V=0;var Y=0,Q=!1;let S="";for(H.qa||N&&N.length&&"\n"!==N||z.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");V<H.qa.length;){const T=H.qa.J(V),Z=T.cp;var P=T.formatting?
T.formatting.uo:null;S+=m.a.substring(N,Q?Y+1:Y,Z);T.vn&&M&&(Y=new f.a,Y.fullName=S.startsWith("@")?S.substr(1):S,A.a(M,Y,this.Ri.jVh),Q=new l,A.c(M,Q,Y),I.RVf(S,Y,Q,!0),S="",M=null);T.vn&&U&&(Y=O||new w.a,Y.link=U.url,I.ZSi(S,Y),S="",U=null);M&&U||""===S||(O?(I.mWf(S,O),O=null):I.Ila(S),S="");T.hyperlink&&(Y=this.xmn(T),T.hyperlink.dw||this.Ri.jVh&&Y?M=T.hyperlink:T.hyperlink.url&&(U=T.hyperlink));P&&(O=new w.a,O.weight=P.ja(x.a.bold,!1)?y.a.Idd:0,O.italic=P.ja(x.a.italic,!1),O.underline=P.ja(x.a.underline,
!1),O.strikethrough=P.ja(x.a.strikethrough,!1),P.hasProperty(x.a.highlight)&&(Y=P.getValue(x.a.highlight),O.highlight=u.a.VC(Y)),P.hasProperty(x.a.fontColor)&&(P=P.getValue(x.a.fontColor),O.color=u.a.VC(P)));Y=Z;Q=!!T.blob;V++}}xmn(I){return I.hyperlink.url&&!I.hyperlink.dw&&I.hyperlink.url.startsWith("mailto:")?(z.ULS.sendTraceTag(508372955,327,15,"At Mention lost its Bookmark. Rendering it as normal Hyperlink or a fixup might be applied"),this.sJ.logKpiFailure(D.a.RLb,"AtMentionBookmarkLost",{isInternal:!0},
{name:D.a.QLb,isInternal:!0}),!0):!1}}F.U$k="_@_";F.kVh="Z";Object(G.a)(F,"ACommentFormatTranslator",null,[439])},1770:function(G,J,d){d.d(J,"a",function(){return u});G=d(0);var m=d(7),f=d(184),a=d(2),l=d(10),w=d(173),y=d(142),v=d(21);class u{constructor(x,z){this.Su=null;this.NKd=!1;this.Gjb=0;this.Lrh="";this.yMe={};this.Mwj=()=>{this.Yb&&this.Yb.NN(f.AFrame.dva,!0)};this.yne=()=>{this.tZc();this.Pgi();this.yeg();this.jyb();return!0};this.zne=()=>{this.tZc();this.Pgi();this.yeg();window.requestAnimationFrame(()=>
{window.setTimeout(()=>{this.jyb()},0)});return!0};this.kgg=A=>{A.stopPropagation()};this.k1e=x;this.Yb=z;this.rxh=this.kgg;this.Bqh=!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Ib.GCa;this.Zx=!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Ib.q0;this.Cqh=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)}onMenuOpen(){0<this.Gjb?this.Gjb++:(this.Gjb++,a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",
!1)?window.requestAnimationFrame(()=>{window.setTimeout(this.Mwj,0)}):this.Mwj(),this.showModal())}Psn(){const x=document.getElementById("WACToolbarContainer");return!!x&&"block"===x.style.display}getRibbonMode(){return this.Cqh&&this.Psn()?"Toolbar":y.f()}lkm(){const x=this.getRibbonMode(),z=appChrome.selectors.getShyState();return String.format("{0}{1}",x,this.Bqh&&z.isActive&&0!==z.state?"_ShyRibbon":"")}LOm(x){var z=0;if(this.Zx){if(this.yMe[x])return this.yMe[x];(z=document.getElementById("BusinessBar"))||
m.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");z=z?z.offsetTop:0;this.yMe[x]=z}return z}showModal(){if(!this.Su)if(this.Su=this.createElement("div"),this.Su.setAttribute("id","ReactModalDiv"),this.Su.style.position="absolute",this.Su.style.bottom="0px",this.Su.style.left="0px",this.Su.style.right="0px",this.Su.style.backgroundColor="white",this.Su.style.opacity="0.0",this.Zx){var x=document.getElementById("regionComposerRoot");
x&&x.appendChild(this.Su)}else this.k1e.appendChild(this.Su);x=this.lkm();if(x!==this.Lrh){const A=this.LOm(x);var z=appChrome.selectors.getShyState();this.Bqh&&z.isActive&&0!==z.state?(z=this.Cqh?appChrome.api.getRibbonHeight("Multiline")-appChrome.api.getRibbonHeight("SingleLine"):appChrome.api.getRibbonHeight(y.f()),this.Su.style.top=String.format("{0}px",A+z)):this.Su.style.top=String.format("{0}px",A);this.Lrh=x}this.Su.style.display="block";this.Su.style.visibility="visible";this.Su.style.zIndex=
"1000";this.NKd||(window.addEventListener("wheel",this.rxh,!0),this.mfe()?w.a.instance.nb(l.a.LP,this.Su,this.zne):w.a.instance.nb(l.a.nt,this.Su,this.yne),this.NKd=!0)}onMenuClose(){this.Gjb--;0<this.Gjb||(0>this.Gjb?this.Gjb=0:this.bPi())}yeg(){this.Gjb=0;this.iyf();this.bPi()}createElement(x){x=document.createElement(x);x.setAttribute("unselectable","on");return x}aPi(){this.Yb&&this.Yb.currentScope&&this.Yb.currentScope.name===f.AFrame.dva&&!a.AFrameworkApplication.mc.Rw&&this.Yb.fV(f.AFrame.dva,
!1);this.Su&&(this.Su.style.zIndex="-1",this.Su.style.visibility="hidden",this.Su.style.display="none");this.NKd&&(window.removeEventListener("wheel",this.rxh,!0),this.mfe()?w.a.instance.xc(l.a.LP,this.Su,this.zne):w.a.instance.xc(l.a.nt,this.Su,this.yne),this.NKd=!1)}bPi(){this.mfe()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.aPi()},0)}):this.aPi()}jyb(){4===a.AFrameworkApplication.ua.Ib.Tk&&a.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?a.AFrameworkApplication.ua.jyb():
this.Yb.Bg(f.AFrame.Ho)}tZc(){const x=v.a.instance.Oa("Common.IReactContextualUILauncher");x&&x.tZc()}iyf(){const x=v.a.instance.Oa("Common.IReactContextualUILauncher");x&&x.iyf()}Pgi(){a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Ib.LXa&&(this.mfe()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}mfe(){return a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(G.a)(u,"ReactModalDiv",null,[])},1775:function(G,J,d){d.d(J,"a",function(){return f});d.d(J,"b",function(){return a});d.d(J,"c",function(){return l});var m=d(2);const f=(w,y,v=!1)=>{var u;const x=RegExp("mailto:(.*)").exec(w.url);y.email=x&&2===x.length?x[1]:w.url;y.resolveState=v?(null===(u=w.dw)||void 0===u?void 0:u.charAt(35))===d(1757).ACommentFormatTranslator.kVh?1:0:w.dw.charAt(35)===d(1757).ACommentFormatTranslator.kVh?1:0},a=(w,y)=>{y.contentId=w.dw},l=(w,y,v)=>{y.contentId=w.dw;
y.isCurrentUser=v.email===m.AFrameworkApplication.K.kb("UserPrincipalName")}},1776:function(G,J,d){d.d(J,"a",function(){return a});G=d(0);var m=d(1131),f=d(5);class a{constructor(l,w){this.tQ=this.EMc=null;this.jb=l;this.ihb=w}get key(){return"COMMENT"}get Av(){return WordEditorIntl.WordEditorStrings.L_Comment}get eP(){return this.tQ}reset(l){this.tQ=l.node}$Ea(l){let w=null;if(this.EMc&&this.dXi(l,this.eP,this.EMc))return w=Object.assign(new m.a,{UF:this.key,contentObject:this.EMc}),{returnValue:!0,
zG:w};this.EMc=null;const y=this.ihb.Xtf(this.eP);if(this.ihb.TXf(y)){let v=y.Xd();for(;v;){if(this.dXi(l,this.eP,v))return this.EMc=v,w=Object.assign(new m.a,{UF:this.key,contentObject:v,description:this.RVa()}),{returnValue:!0,zG:w};v=y.Fk()}}return{returnValue:!1,zG:w}}dXi(l,w,y){if(this.wTj(y))return!1;const v=this.ihb.klc(y,!0),u=this.ihb.klc(y,!1);return v&&u&&this.jb.p$c(w,v,u)&&(w=this.ihb.hBa(v,y.id,!0))&&(v!==this.eP||w.Jb.cp<=l)&&(y=this.ihb.hBa(u,y.id,!1))&&(u!==this.eP||y.Jb.cp>l||y.Jb.cp>=
l)?!0:!1}wTj(l){return l.ja(f.a.yI,!1)}RVa(){return null}}Object(G.a)(a,"CommentDetailsProvider",null,[405,406])},1783:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);J=d(164);var m=d(113);class f extends J.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new m.a,{T_:f.getTypeName(),B_:f.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(G.a)(f,
"DocumentTypeClassifierAnnotation",J.a,[])},1789:function(G,J,d){d.d(J,"a",function(){return u});G=d(0);var m=d(2),f=d(317),a=d(7),l=d(104),w=d(88),y=d(67),v=d(402);class u{constructor(x,z,A,D,F,I){this.i4e=null;this.kAh=0;this.vd=D;this.ff=z;this.v1=F;this.qVe=A;this.BEc=m.AFrameworkApplication.$Cg();this.oNe=x.appSettings.ChromeClipboardAccessOperationTimeout;this.MK=0;this.Fqk=I;this.bvk=x.$("EnableExternalPasteSupportOnMobileIsEnabled");this.Fe=f.a.getInstance(v.a.H6a)}get qZa(){return this.v1.qZa}process(x,
z){if(!this.MK)return this.r$n(z);if(1===this.MK)return this.UXb(x,z);if(2===this.MK)return this.MK=3,this.i4e(x,z);3===this.MK&&this.v1.JAg(x,z);return!1}r$n(x){let z=!0;this.bvk&&(z=!(x.ux&1));this.ff.Q7&&z||x.ux&512?(this.i4e=x.ux&2?Object(l.a)(this.v1,this.v1.paste,"paste"):Object(l.a)(this.v1,this.v1.osj,"pasteInternal"),this.MK=2):(this.BEc?(this.MK=1,this.kAh=Date.now()):this.MK=2,this.i4e=Object(l.a)(this.v1,this.v1.paste,"paste"));v.a.DEn(x);return!0}UXb(x,z){x=!0;if(this.qVe.value.Guj())this.MK=
2;else{const A=Date.now()-this.kAh;A>this.oNe&&(a.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",A),this.vd.$b(w.a.usa,{["Reason"]:y.a.Zpj}),z.cV&&(z.cV.fail("Prepare for paste timed out",!1),this.Fe.logKpiFailure({kpiName:v.a.Gza,errorName:"PreparePasteTimedOut",optionalVeto:{name:v.a.gqe,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}})),z.UB=!0,x=!1,this.Fqk.YFo())}return x}}Object(G.a)(u,"ClipboardOperationPasteProcessor",null,[564])},1790:function(G,J,d){d.d(J,
"a",function(){return V});G=d(0);J=d(314);var m=d(317),f=d(2),a=d(47),l=d(187),w=d(7),y=d(122),v=d(84),u=d(1498),x=d(104),z=d(93),A=d(3),D=d(88),F=d(67),I=d(1184),H=d(17),N=d(52),M=d(1695),U=d(1791),O=d(402);class V extends J.a{constructor(Y,Q,S,P,T,Z,X,aa,ia,wa,ma,na,Fa,Qa,ya,ta,Aa,oa,za,ja,fa,Ca,xa,ua,sa,Ea,Ja,nb=!0){super();this.Loa=this.qx=null;this.yM=this.sA=0;this.ulb=this.q8e=this.Xda=this.Dh=null;this.p$=!1;this.mW=!0;this.Qkh=!1;this.init(Y);this.vm("ClipboardOperation");this.ssb(ia,Q,T,
Z,X);this.vd=wa;this.Oe=ma;this.ff=na;this.Pc=Fa;this.Gbh=Qa;this.Ibh=ya;this.Hbh=ta;this.ANe=Aa;this.l5b=oa;this.BNe=za;this.BEc=aa;this.pEc=ja;this.kTa=fa;this.aSk=nb;this.aL=Ca;this.Wd=xa;this.Fn=ua;this.a2=sa;this._context=P;this.pja=Ea;this.clb=Ja;this.Fe=m.a.getInstance(O.a.H6a);X&&Object(y.a)(97,X)&&(this.Xda=Object(v.a)(572,X.ja(l.a.Oza,null)));this.Xda||(this.Xda=this.pja.Fqd());this.fBb=void 0===S||null===S?"NotAvailable":Object(u.a)(U.a,S);this.Xda.L6k(this.fBb.split(", "));Y=this._context;
if(this.clb){if(!V.E_h(Y,this.ANe,this.vd,this.Xda,nb)){this.xs=8;this.finish();return}this.Dh=Y.view;this.p$=3===this.Dh.gUb;this.sA=0;this.yM=S;this.ulb=Aa.qZa}else{if(!Y.view.te){this.vd.$b(D.a.Te,{["Reason"]:F.a.ZVb});this.Xda.fail("Not in interactive view",!0);this.xs=8;this.finish();return}this.Dh=Y.view;if(!this.Dh.lb){this.vd.$b(D.a.Te,{["Reason"]:F.a.oo});this.Xda.fail("No selection manager",!0);this.xs=8;this.finish();return}this.p$=3===this.Dh.gUb;this.sA=0;this.yM=S;this.ulb=Aa.qZa;if(nb&&
!(this.ulb&&this.ulb.currentSelection&&this.ulb.length)){this.vd.$b(D.a.Te,{["Reason"]:F.a.oo});this.Xda.fail("No selection when one required",!0);this.xs=8;this.finish();return}}Aa=H.SelectionEditor.Dm(this.ulb.currentSelection);Aa=!(this.yM&16&&Aa);Aa=za.lfn(S,this.Og)&&Aa;1!==this.behavior&&Aa||(Aa||this.Xda.fail("Clipboard operation disabled for selection",!0),this.xs=Aa?32:8,this.Iva());!this.Qkh&&this.ff.Di&&(a.b("IPadCCP"),this.Qkh=!0)}get Og(){this.q8e||(this.q8e=N.a.gec(this.ulb));return this.q8e}cha(){super.cha();
this.ulb=null}run(){this.sA||this.setup();1===this.sA&&this.process();2===this.sA&&this.Rhp();3===this.sA&&this.Ohp();4===this.sA&&this.finish()}setup(){if(this.yM&256&&this.BEc){this.QC||this.l5b.Mpl(this,this.yM,this.fBb);this.QC.run();if(this.QC.Xfa)return;this.mW=this.QC.Mua;this.YVd();if(!this.mW){this.Xda.fail("No access to system clipboard",!0);this.xs=8;this.sA=4;this.Hie();return}}else w.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.yM,this.fBb,
this.ff.eE,this.actionId);this.yM&32&&!this.Oe.$de(this.Dh.lb.Og)?(w.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.vd.$b(D.a.Te,{["Reason"]:F.a.Svf}),this.Xda.fail("Cut not allowed",!0),this.pEc.show(),this.xs=8,this.sA=4):(this.yM&16||this.yM&32)&&z.a.instance.J(1)&&this.aL.fge(this.Dh.lb.gb.currentSelection)?(this.Xda.fail("Selected content deleted in coauthoring",!0),this.Wd.K0b(),this.xs=8,this.sA=4):(this.yM&4096&&(this.a2.Yuc(Object.assign(new I.a,{t9c:!0,K0:this.fBb})),this.Fn.undo()),
this.BNe.xeo(this.yM),this.Dh.jd?(this.qx=this.Pc.Mc(15),this.qx.yi=this.actionId,this.qx.Ab(this.Dh.jd),this.sA=1):(this.Xda.fail("Interactive view has null target node",!0),this.xs=8,this.sA=4))}process(){if(!this.QC){w.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.yM,this.fBb,this.ff.eE);w.ULS.shipAssertTag(6305507,307,!this.Loa);this.Loa=new M.a(this._context,this.yM,this.Xda,this.Aca,this.hO,void 0,this.ff.eE,this.aSk,this.p$);let Y;this.yM&65536?Y=
Object(x.a)(this.Gbh,this.Gbh.process,"process"):this.yM&64?Y=Object(x.a)(this.Ibh,this.Ibh.process,"process"):this.yM&1?(this.Fe.logKpiUsage({kpiName:O.a.Gza}),Y=Object(x.a)(this.ANe,this.ANe.process,"process")):Y=Object(x.a)(this.Hbh,this.Hbh.process,"process");this.yM&16&&this.Dh.lb.TEa.dri();this.kTa.create(this,Y,this.Loa).vm("ClipboardAction")}w.ULS.shipAssertTag(6305536,307,!!this.QC);this.QC.run();this.QC.Xfa||(this.YVd(),this.sA=this.ni?2:3)}Rhp(){this.Loa.Qoc&&(this.qx.yi=A.a.f1);this.Loa.K9c&&
this.qx.sMa(this.Loa.RUf,this.Loa.cdg);this.qx.dispose();this.xs=this.Loa.UB?8:32;this.sA=4}Ohp(){if(this.QC){if(this.QC.run(),this.QC.Xfa)return}else if(this.Loa.Qoc&&(this.qx.yi=A.a.f1),this.qx.lOa(this),this.Loa.K9c&&this.qx.sMa(this.Loa.RUf,this.Loa.cdg),this.qx.dispose(),this.kef)return;this.xs=this.Loa.UB?8:32;this.sA=4}finish(){this.a2.Yuc(Object.assign(new I.a,{t9c:!1}));this.Iva();32===this.response?(w.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",
+this.endTime-+this.startTime,this.yM,this.fBb,this.ff.eE),this.yM&1&&this.Fe.logKpiSuccess({kpiName:O.a.Gza})):w.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.yM,this.fBb,this.ff.eE);this.pja.Kka(this.Xda);V.Qoo&&this.sCn()}Hie(){const Y=!!(this.yM&1),Q=this._context.view;Q&&O.a.Hie(Y,Q.lb,this.ff.eE)}sCn(){if(!(this.yM&4||this.yM&64)){var Y=new Map;Y.set("isCopy",String.format("{0}",!!(this.yM&16)));Y.set("isIPad",
String.format("{0}",this.ff.Di));Y.set("SkipAria","false");Y.set("ErrorLevel","info");this.Fe.logKpiUsage({kpiName:O.a.M0h,kpiType:0,optionalProperties:{extendedProperties:Y},blockFutureEmissionDurationInMs:0});this.mW||(Y.set("SkipAria","false"),Y.set("ErrorLevel","info"),this.Fe.logKpiFailure({kpiName:O.a.M0h,errorName:O.a.Dml,optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:{extendedProperties:Y}},blockFutureEmissionDurationInMs:0}))}}static get Qoo(){null==V.j6e&&(V.j6e=!!f.AFrameworkApplication.K&&
f.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return V.j6e}static Bqg(Y,Q,S,P){Y&&Y.$b(D.a.Te,{["Reason"]:S});Q&&Q.fail(P,!0)}static E_h(Y,Q,S=null,P=null,T=!0){return Y.view.te?Y.view.lb?!T||Q.qZa&&Q.qZa.currentSelection&&Q.qZa.length?!0:(V.Bqg(S,P,F.a.oo,"Paste target is invalid"),!1):(V.Bqg(S,P,F.a.oo,"No selection manager"),!1):(V.Bqg(S,P,F.a.ZVb,"Not in interactive view"),!1)}}V.j6e=null;Object(G.a)(V,"ClipboardOperation",J.a,[])},1791:function(G,J,d){d.d(J,"a",function(){return m});
G=d(0);var m;(function(f){f[f.paste=1]="paste";f[f.knq=2]="textOnly";f[f.Bqj=4]="overtype";f[f.jE=16]="copy";f[f.wXp=32]="deleteSelection";f[f.move=64]="move";f[f.ipq=256]="useSystemClipboard";f[f.G0p=512]="forceInternalClipboard";f[f.LZa=4096]="reformatPastedContent";f[f.Efq=8192]="pasteAsPlainText";f[f.Spd=65536]="showPlaceholderGlossary";f[f.ehq=131072]="reformatPastedContentWithDesignerPaste";f[f.Qcq=262144]="noSpacesAdjustment";f[f.w7p=524288]="mergeAfterPasteForInsertHtmlAPI"})(m||(m={}));Object(G.b)("ClipboardActionFlags",
m)},1794:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,l,w,y){void 0===y&&(y=w);var v=Object.getOwnPropertyDescriptor(l,w);if(!v||("get"in v?!l.mJ:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,y,v)}:function(a,l,w,y){void 0===y&&(y=w);a[y]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1968),J);
f(d(1969),J)},1795:function(G,J,d){d.r(J);d.d(J,"FootnoteEndnoteDefaultContentInserter",function(){return H});G=d(0);var m=d(21),f=d(54),a=d(2),l=d(37),w=d(111),y=d(590),v=d(28),u=d(5),x=d(16),z=d(63),A=d(104),D=d(1276),F=d(960),I=d(1696);class H{constructor(N,M,U,O,V=null){this.Zc=N;this.vqk=M;this.Zm=U;H.Oh=O;this.qdh=V||H.LGl}get MN(){return null!=this.U1g?this.U1g:this.U1g=m.a.instance.resolve("Box4.IOutlineEditor")}LEl(N,M){var U=this.Zc.Ql();U.set(N);this.MN.kSb(U,null,!0);H.Oh.Y_b(U.currentNode,
this.Zm);N=l.OutlineElementNavigator.Le(U);H.e9.Iod(M?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,N);U=this.qdh(U.currentNode);H.rg.Ne(U,H.$di);this.z$m(N,M)}z$m(N,M){var U=this.vqk(z.a.Vma);U.setValue(u.a.mt,1===M?36:35);U.setValue(u.a.Xja,!0);U.setValue(x.a.ada,!0);const O=N.Lc.ou(U,f.a.create());U=this.qdh(N);H.rg.Gla(U,V=>F.a.getInstance(V,O,!0),I.a.fvi(N,M,Object(w.a)()))}static Qm(){return new H(new y.a,Object(A.a)(D.a.instance,D.a.instance.createInstance,
"createInstance"),a.AFrameworkApplication.isRtl,m.a.instance.resolve("Box4.IOutlineElementEditor"))}static get e9(){return null!=H.A4g?H.A4g:H.A4g=m.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get rg(){return null!=H.uUg?H.uUg:H.uUg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=H.D_g?H.D_g:H.D_g=H.Qm()}static LGl(N){return v.a.Tc(N,0)}}H.$di=" ";H.Oh=null;Object(G.a)(H,"FootnoteEndnoteDefaultContentInserter",null,[299])},1796:function(G,J,
d){d.d(J,"a",function(){return w});G=d(0);var m=d(590),f=d(576),a=d(1624),l=d(1696);class w{constructor(y,v){this.uxa=v}B$d(y,v,u){return(y=this.uxa.PCi(y.node,u?y.cpBegin:y.cpEnd,v))?y.x7():null}ELi(y,v){return(y=this.uxa.tGm(y.node,y.cpBegin,v))?y.x7():null}static l3c(){return new w(f.a.instance,a.a.instance,new m.a,l.a.instance)}static get instance(){return null!=w.b_g?w.b_g:w.b_g=w.l3c()}}Object(G.a)(w,"FootnoteEndnoteNavigator",null,[291])},1807:function(G,J,d){d.d(J,"a",function(){return w});
G=d(0);var m=d(1877),f=d(2),a=d(50),l=d(21);class w{constructor(y,v,u,x,z,A){this.Wxa=y;this.Xxa=v;this.uVe=u;this.s1=x;this.aAd=z;this.w4b=A}get tUj(){return!this.Xxa&&!this.uVe}get Gij(){return 2===this.w4b?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get Gli(){return CommonUIStrings.l_OICErrorMessageNoOffice}get $Pi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Rrb(){return CommonUIStrings.l_OICErrorHelpLink}get QOi(){return"OICFailure"}get icon(){return 3}get BQd(){return 2===
this.w4b?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}Gno(y){this.Sij(y)}yyn(y){this.Sij(y)}Sij(y){let v=10;1===y?(l.a.instance.resolve("Common.IOfficeTrialExperience").y3f(this.w4b),v=3):2===y&&((!this.uVe||this.uVe(this.s1))&&this.Xxa&&m.a.instance.aIl(this.Xxa,this.Wxa,this.s1),v=5);(0===y||1===y)&&this.Wxa&&this.Wxa(this.s1);f.AFrameworkApplication.Bld(a.a.Opj,this.aAd,v);this.dispose()}dispose(){this.s1=
this.Xxa=this.Wxa=null}}Object(G.a)(w,"AOICErrorDialogWithTrial",null,[13])},1877:function(G,J,d){G=d(0);var m=d(104),f=d(7),a=d(2),l=d(50),w=d(501),y=d(21);class v{constructor(M,U,O,V){this.y0e=null;this.aAd=V;this.Wxa=M;this.Xxa=U;this.s1=O;this.jFh=this.jVb.N2o;M=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.kEk=M[0];this.jEk=M[1]}get jVb(){return this.y0e||(this.y0e=y.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Rrb(){return CommonUIStrings.l_OICErrorHelpLink}get rpd(){return this.jFh}get icj(){return this.kEk}get hcj(){return this.jEk}get gcj(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.jFh?
3:2}get P_c(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get DXd(){return!!this.Xxa}get Q_c(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}gqg(M){this.Oed(M)}d4f(M){this.Oed(M)}Oed(M){let U=10;this.Xxa&&1===M&&(this.Xxa(this.s1),U=1);this.Wxa&&this.Wxa(this.s1);this.qS(U)}hWb(){w.Redirect.showHelp("OICFailure");this.qS(2)}udg(){this.jVb.v6i();this.qS(4)}qS(M){f.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.aAd,M);a.AFrameworkApplication.Bld(l.a.Mpj,this.aAd,M)}dispose(){this.s1=this.Wxa=this.Xxa=null}}Object(G.a)(v,"AOICErrorDialog",null,[13]);var u=d(42),x=d(188);class z extends v{constructor(M,U,O,V){super(M,U,O,V);this.Ejb=this.zH=null;M=document.createElement("span");M.id="errorMessageText";M.innerText=this.errorMessage;M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));this.zH=document.createElement("a");this.zH.href="#";this.zH.innerText=this.Rrb;M.appendChild(this.zH);
u.a.addHandler(this.zH,"click",Object(m.a)(this,this.hWb,"oicErrorHelpLinkHandler"));U=new x.StandardDialog;U.Qg=this.id;this.rpd?(O=document.createElement("span"),V=document.createElement("span"),O.innerText=this.icj,V.innerText=this.hcj,this.Ejb=document.createElement("a"),this.Ejb.href="#",this.Ejb.innerText=this.gcj,M.appendChild(document.createElement("br")),M.appendChild(O),M.appendChild(this.Ejb),M.appendChild(V),u.a.addHandler(this.Ejb,"click",Object(m.a)(this,this.udg,"oicErrorMacOfferLinkHandler"))):
this.DXd&&(M.appendChild(document.createElement("br")),M.appendChild(document.createElement("br")),O=document.createElement("span"),O.innerText=this.P_c,M.appendChild(O));this.DXd?(U.Gd=1,U.Pe(1,this.Q_c)):U.Gd=0;U.Ix(this.dialogTitle,null,this.icon,Object(m.a)(this,this.d4f,"legacyOICErrorDialogHandler"),M);U.L8("errorMessageText")}dispose(){this.zH&&(u.a.removeHandler(this.zH,"click",Object(m.a)(this,this.hWb,"oicErrorHelpLinkHandler")),this.zH=null);this.Ejb&&(u.a.removeHandler(this.Ejb,"click",
Object(m.a)(this,this.udg,"oicErrorMacOfferLinkHandler")),this.Ejb=null);super.dispose()}}Object(G.a)(z,"OICErrorDialog",v,[]);class A{constructor(M,U,O){this.Wxa=U;this.Xxa=M;this.s1=O}get id(){return"OICErrorDialogWithDownload"}get Hli(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Rrb(){return CommonUIStrings.l_OICErrorHelpLink}get P_c(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get Q_c(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}gqg(M){this.Oed(M)}d4f(M){this.Oed(M)}Oed(M){let U=
10;1===M&&(this.Xxa(this.s1),U=1);this.Wxa&&this.Wxa(this.s1);this.qS(U)}hWb(){w.Redirect.showHelp("OICFailure");this.qS(2)}qS(M){a.AFrameworkApplication.Bld(l.a.Npj,3,M)}dispose(){this.s1=this.Xxa=this.Wxa=null}}Object(G.a)(A,"AOICErrorDialogWithDownload",null,[13]);class D extends A{constructor(M,U,O){super(M,U,O);this.zH=null;M=document.createElement("span");M.id="errorMessageText";M.innerText=this.Hli;M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));this.zH=
document.createElement("a");this.zH.href="#";this.zH.innerText=this.Rrb;M.appendChild(this.zH);u.a.addHandler(this.zH,"click",Object(m.a)(this,this.hWb,"oicErrorHelpLinkHandler"));M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));U=document.createElement("span");U.innerText=this.P_c;M.appendChild(U);U=new x.StandardDialog;U.Qg=this.id;U.Gd=1;U.Pe(1,this.Q_c);U.Ix(this.dialogTitle,null,this.icon,Object(m.a)(this,this.d4f,"legacyOICErrorDialogHandler"),M);U.L8("errorMessageText")}dispose(){this.zH&&
(u.a.removeHandler(this.zH,"click",Object(m.a)(this,this.hWb,"oicErrorHelpLinkHandler")),this.zH=null);super.dispose()}}Object(G.a)(D,"OICErrorDialogWithDownload",A,[]);var F=d(182);class I extends v{constructor(M,U,O,V){super(M,U,O,V);U={["errorMessage"]:this.errorMessage};U.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Rrb,["onExecute"]:Y=>{this.hWb(Y)}};this.rpd?(U.macOfficePreLinkText=this.icj,U.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.gcj,
["onExecute"]:Y=>{this.udg(Y)}},U.macOfficePostText=this.hcj):this.DXd&&(U.errorFileDownloadOffer=this.P_c);M=new F.a(!1,!1,!0);this.DXd?(M.Gd=1,M.Pe(1,this.Q_c)):M.Gd=0;M.Qg=this.id;U={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:U};M.pi(this.dialogTitle,Object(m.a)(this,this.gqg,"reactOICErrorDialogHandler"),U)}}Object(G.a)(I,"ReactOICErrorDialog",v,[]);class H extends A{constructor(M,U,O){super(M,U,O);U={["errorMessage"]:this.Hli,["errorFileDownloadOffer"]:this.P_c};U.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.Rrb,["onExecute"]:V=>{this.hWb(V)}};M=new F.a(!1,!1,!0);M.Gd=1;M.Pe(1,this.Q_c);M.Qg=this.id;U={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:U};M.pi(this.dialogTitle,Object(m.a)(this,this.gqg,"reactOICErrorDialogHandler"),U)}}Object(G.a)(H,"ReactOICErrorDialogWithDownload",A,[]);d.d(J,"a",function(){return N});class N{constructor(){this.WRa=!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Ib.cH}$Hl(M,U,O){this.WRa?new I(M,U,null,O):new z(M,U,null,
O)}aIl(M,U,O){this.WRa?new H(M,U,O):new D(M,U,O)}bIl(M,U,O,V,Y){const {ReactOICErrorDialogWithTrial:Q}=d(1983),{OICErrorDialogWithTrial:S}=d(1984);this.WRa?new Q(M,U,O,null,V,Y):new S(M,U,O,null,V,Y)}static get instance(){return N._instance||(N._instance=new N)}}N._instance=null;Object(G.a)(N,"OICErrorDialogFactory",null,[1558])},1879:function(G,J,d){d.r(J);G=d(0);var m=d(327),f=d(1964),a=d(1025),l=d(345),w=d(2),y=d(54),v=d(317),u=d(21),x=d(53),z=d(127),A=d(112),D=d(91),F=d(1500),I=d(200),H=d(41),
N=d(20),M=d(284),U=d(187),O=d(7),V=d(286),Y=d(122),Q=d(84),S=d(322),P=d(11),T=d(28),Z=d(3),X=d(22),aa=d(71),ia=d(1437),wa=d(574),ma=d(52),na=d(1790),Fa=d(1789),Qa=d(402),ya=d(314);class ta extends ya.a{constructor(Ea,Ja,nb,ub,Yb,yb){super();this.init(Ea);this.vm("DummyClipboardOperation");this.ssb(w.AFrameworkApplication.va,Ja,ub,Yb,yb);this._context=nb;this.xs=8;this.Iva()}run(){this.djb=!0;this.Ond(this._context);this.Scb();this.xs=32}}Object(G.a)(ta,"DummyClipboardOperation",ya.a,[]);ya=d(1655);
class Aa extends ya.a{constructor(Ea,Ja,nb,ub,Yb){super(Ea,Ja,Yb);this.Pk=nb;this.X8e=ub}KAc(Ea){let Ja;if(this.xT&&!Ea)return O.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Cka:null};Ja=null;if(this.X8e&&!this.xT){const nb=this.properties.ja(U.a.vsj,"");nb&&(Ja=this.Pk.vwb(nb))}Ja||(Ja=this.Pk.vwb(Ea));return{returnValue:!0,Cka:Ja}}}Object(G.a)(Aa,"HtmlStringImportStrategy",ya.a,[]);var oa=d(1965);class za extends oa.a{constructor(Ea,Ja,nb,ub,
Yb){super(Ea,Ja,nb,ub,Yb)}AEi(){return this.properties.ja(U.a.wXb,"")}KAc(Ea){if(this.xFh){if(this.Pk)return Ea=this.Pk.Wjg(Ea,!0),{returnValue:!0,Cka:Ea};O.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.KAc(Ea)}Ibd(Ea){Ea=super.Ibd(Ea);return Ea.length&&" "!==Ea?Ea:"\u00a0"}}Object(G.a)(za,"MultiLinePlainTextImportStrategy",oa.a,[]);class ja extends ya.a{constructor(Ea,Ja,nb){super(Ea,Ja,nb)}KAc(Ea){if(!w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorPlainTextImportStrategy",
!1))return this.Rpp(Ea);let Ja;if(this.xT&&!Ea)return O.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,Cka:null};Ja=M.a.A4c("Box4PasteScratchPad");Ja.innerText=Ea;return{returnValue:!0,Cka:Ja}}Rpp(Ea){({ClipboardActor:Ja}=d(1879));if(this.xT&&!Ea)return O.ULS.sendTraceTag(508379359,307,10,"No htmlDomContent"),{returnValue:!1,Cka:null};var Ja=Ja.s$n;Ja.innerText=Ea;return{returnValue:!0,Cka:Ja}}}Object(G.a)(ja,"PlainTextImportStrategy",ya.a,[]);var fa=d(88),Ca=d(67);class xa{constructor(Ea){this.isReady=
this.c0f=!1;this.nja=Ea}Guj(){this.c0f||(this.c0f=!0,this.isReady=!1,this.nja.UXb(()=>{this.isReady=!0}));return this.isReady}J3j(){this.c0f=!1;const Ea=this.nja.paste();return Ea?Ea.hasChildNodes()?{returnValue:!0,KXd:Ea}:(O.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),xa.Ec.$b(fa.a.U4,{["Reason"]:Ca.a.ACf}),{returnValue:!1,KXd:Ea}):(O.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),xa.Ec.$b(fa.a.oOb,{["Reason"]:Ca.a.eHg}),{returnValue:!1,KXd:Ea})}static get Ec(){return I.a.instance}}
Object(G.a)(xa,"SystemClipboardImportStrategy",null,[570]);var ua=d(242);d.d(J,"ClipboardActor",function(){return sa});class sa{get J5i(){return this.bSa}set J5i(Ea){this.bSa=Ea}constructor(Ea,Ja,nb,ub,Yb,yb,Za,Ya,Pa,rb,tb,ob,Oa,Xa,ab,cb,ib,Ub,lb=null){this.B2d=lb;this.Lxd=null;this.bSa=0;this.HCd=this.xRc=!1;this.KBb=m.a.On;this.Rpd=()=>{const Qb=Array(1);Qb.push("PasteRecoveryFloatie");var fc=this.CIk.bWa();fc=Object.assign(new f.a,{x:fc.x,y:fc.y});this.kO.showFloatie(fc,Qb,1);return 32};this.xRb=
()=>{this.kO.D3&&this.kO.dismissFloatie();return 32};this.sxj=(Qb,fc,Fc,nc,zb)=>{if(1===Fc)return 32;zb[a.a.On]=!1;return 32};this.xYl=(Qb,fc,Fc,nc,zb,Vb)=>{O.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var rc=Vb.DataTransfer;Vb=rc.getData("text/html");rc=rc.getData("text/plain");let pb=!1;const bb=new l.DictionaryPropertySet;0<Vb.length?(O.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),bb.setValue(U.a.mS,Vb),pb=!0):0<rc.length&&(O.ULS.sendTraceTag(42530337,
307,50,"Drag and drop browser content with plain text"),bb.setValue(U.a.wXb,rc),pb=!0);if(pb){const Pb=this.Fz.J(fc);return this.rWd.create(Qb,fc,Pb,new V.a(()=>this.$Yc(Pb,bb)),Fc,nc,zb,bb)}return null};this.ipg=(Qb,fc,Fc,nc,zb)=>{if(fc="object"===typeof zb?zb:null)this.dlb?this.lRo(Qb,this.bSa,fc):Qb===Z.a.Ase?(Qb=this.bSa!==Z.a.LZa&&this.bSa!==Z.a.MZa&&this.bSa!==Z.a.SDa,fc[this.KBb]=this.bSa===Z.a.LZa||Qb):Qb===Z.a.Bse?fc[this.KBb]=this.bSa===Z.a.MZa:Qb===Z.a.dpg&&(fc[this.KBb]=this.bSa===Z.a.SDa);
return 32};this.n_=(Qb,fc,Fc,nc,zb,Vb)=>{if((w.AFrameworkApplication.O0||w.AFrameworkApplication.lH)&&!w.AFrameworkApplication.UNb||ua.a.Sla(Fc)&&ua.a.hoc())return new ta(Qb,fc,Fc,nc,zb,Vb);let rc=this.Fz.J(fc);1!==nc&&rc&1&&(this.bSa=fc);if(1!==nc){var pb=Object(Y.a)(97,Vb)?Vb:null;Vb?(rc&1&&(this.Lxd=pb),pb=pb?pb.ja(U.a.K0,0):0,fc===Z.a.paste&&pb===Z.a.IIa?rc=this.Fz.J(Z.a.G2):fc===Z.a.j4&&pb===Z.a.E6a&&(rc=this.Fz.J(Z.a.iqe))):!Vb&&rc&4096&&(Vb=this.Lxd,pb=Object(Y.a)(97,Vb)?Vb:null)&&(pb=pb.ja(U.a.ghd,
y.a.nil),O.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",pb))}return this.rWd.create(Qb,fc,rc,new V.a(()=>this.$Yc(rc,Vb)),Fc,nc,zb,Vb)};this.wgo=(Qb,fc,Fc,nc,zb)=>this.unf(Qb,fc,Fc,zb);this.vgo=(Qb,fc,Fc,nc,zb)=>this.unf(Qb,fc,Fc,zb);this.ugo=(Qb,fc,Fc,nc,zb)=>this.unf(Qb,fc,Fc,zb);this.Nke=(Qb,fc,Fc,nc,zb,Vb)=>{Vb=T.a.Tc(ma.a.instance.gb.currentSelection.Ra.node,Vb);return this.n_(Qb,fc,Fc,nc,zb,Vb)};this.Jqk=Ea;this.nja=Ja;this.vd=nb;this.Pk=ub;this.ga=
yb;this.jyd=rb;this.l5b=tb;this.Je=ob;this.ug=Oa;this.Yb=Pa;this.clb=Xa;this.dlb=ab;this.CIk=cb;this.kO=ib;this.uYe=Ub;this.Fe=v.a.getInstance(Qa.a.H6a);Ya&&(this.xRc=Ya.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.HCd=this.dlb&&Ya.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.Fz=new S.a;this.Fz.Z(Z.a.paste,257);this.Fz.Z(Z.a.j4,8449);this.Fz.Z(Z.a.G2,1);this.Fz.Z(Z.a.A$a,1);this.Fz.Z(Z.a.pKb,1);this.Fz.Z(Z.a.uIa,1);this.Fz.Z(Z.a.Lce,513);this.Fz.Z(Z.a.LZa,4097);this.Fz.Z(Z.a.MZa,
12289);this.Fz.Z(Z.a.SDa,131073);this.Fz.Z(Z.a.dkg,7);this.Fz.Z(Z.a.hqe,1);this.Fz.Z(Z.a.iqe,8193);this.Fz.Z(Z.a.jE,272);this.Fz.Z(Z.a.oUc,16);this.Fz.Z(Z.a.cut,304);this.Fz.Z(Z.a.mmf,48);this.Fz.Z(Z.a.Mke,64);this.Fz.Z(Z.a.Nke,64);this.Fz.Z(Z.a.Spd,327680);this.Fz.Z(Z.a.xzf,1);this.HCd&&this.Fz.Z(Z.a.ywb,this.Fz.J(Z.a.iqe))}get f0a(){return null!=this.d5g?this.d5g:this.d5g=u.a.instance.Oa("Box4.Clipboard.ISystemClipboardAccessManager")}get YHg(){return null!=this.w5g?this.w5g:this.w5g=u.a.instance.Oa("Common.Utils.Telemetry.ITelemetry")}get rWd(){return this.Jqk.value}get Ufp(){return this.nja}Wb(){if(w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisablePasteQueryAtBoot",!1)){this.B2d.addCommandToMaps(new x.a(ia.a.hhd,this.clb?Z.a.IIa.toString():Z.a.paste.toString()));let Ea;this.B2d.addCommandToMaps((Ea=new x.a(ia.a.bkg,this.dlb?Z.a.E6a.toString():Z.a.j4.toString()),Ea.legacyControlId="fseaNewPaste",Ea));this.B2d.addCommandToMaps(new x.a(ia.a.fhd,this.dlb?Z.a.E6a.toString():Z.a.j4.toString()));let Ja;this.B2d.addCommandToMaps((Ja=new x.a("PasteStandalone",this.clb?
Z.a.IIa.toString():Z.a.paste.toString()),Ja.legacyControlId="fseaPaste",Ja))}this.ga.fb(Z.a.eko,P.a.application,this.sxj,97);this.ga.fb(Z.a.fko,P.a.application,this.sxj,97);this.ga.fb(Z.a.Ase,P.a.application,this.ipg,97);this.ga.fb(Z.a.Bse,P.a.application,this.ipg,97);this.ga.fb(Z.a.dpg,P.a.application,this.ipg,97);this.ga.wW(Z.a.mmf,P.a.view,this.n_,1028);this.ga.Xlb(Z.a.oUc,P.a.view,this.n_);this.ga.wW(Z.a.xzf,P.a.view,this.xYl,1028);this.ga.wW(Z.a.G2,P.a.view,this.n_,1028);this.ga.wW(Z.a.A$a,P.a.view,
this.n_,1028);this.ga.wW(Z.a.pKb,P.a.view,this.n_,1028);this.ga.wW(Z.a.uIa,P.a.view,this.n_,1028);this.clb&&this.ga.fb(Z.a.IIa,P.a.view,this.ugo,1028);this.dlb&&this.ga.fb(Z.a.E6a,P.a.view,this.vgo,1028);this.ga.wW(Z.a.paste,P.a.view,this.n_,1028);this.ga.wW(Z.a.j4,P.a.view,this.n_,1028);this.ga.wW(Z.a.iqe,P.a.view,this.n_,1028);this.ga.wW(Z.a.hqe,P.a.view,this.n_,1028);this.ga.wW(Z.a.dkg,P.a.view,this.n_,1028);this.ga.wW(Z.a.LZa,P.a.view,this.n_,1028);this.ga.wW(Z.a.MZa,P.a.view,this.n_,1028);this.ga.ra(Z.a.FZb,
P.a.view,z.ActionManager.Zf);this.ga.ra(Z.a.Csj,P.a.view,z.ActionManager.Zf);this.ga.ra(Z.a.zsj,P.a.view,z.ActionManager.Zf);this.ga.ra(Z.a.Asj,P.a.view,z.ActionManager.Zf);this.ga.ra(Z.a.Bsj,P.a.view,z.ActionManager.Zf);this.ga.ra(Z.a.ysj,P.a.view,z.ActionManager.Zf);this.ga.Xlb(Z.a.Mke,P.a.view,this.n_);this.ga.Xlb(Z.a.Nke,P.a.view,this.Nke);this.ga.Xlb(Z.a.Lce,P.a.view,this.n_);this.ga.Xlb(Z.a.Spd,P.a.view,this.n_);this.HCd&&(this.ga.fb(Z.a.MUc,P.a.view,this.wgo,1028),this.ga.wW(Z.a.ywb,P.a.view,
this.n_,1028));this.ga.ra(Z.a.lci,P.a.view,z.ActionManager.Zf);this.ga.ra(Z.a.Pci,P.a.view,z.ActionManager.Zf);this.uYe&&(this.ga.fb(Z.a.Rpd,P.a.view,this.Rpd,96),this.ga.fb(Z.a.xRb,P.a.view,this.xRb,96))}E8(){if(this.Yb){const Ea=this.Yb.ge(aa.a.zF);this.HCd&&Ea.bindAction(A.KeyInputManager.lc(D.a.aBb,A.KeyInputManager.li|4),Z.a.MUc)}else O.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}lRo(Ea,Ja,nb){switch(Ja){case Z.a.MZa:case Z.a.j4:case Z.a.ywb:Ja=
Z.a.Bse;break;case Z.a.SDa:Ja=Z.a.dpg;break;default:Ja=Z.a.Ase}nb[this.KBb]=Ea===Ja}hFm(){const Ea=Object(Y.a)(97,this.Lxd)?this.Lxd:null;return Ea?Ea.ja(U.a.ghd,y.a.nil):y.a.nil}unf(Ea,Ja,nb,ub){if(1===nb){if(!Object(Y.a)(wa.a,Ja)||!this.jyd||ua.a.Sla(Ja)&&ua.a.hoc())return 8;nb=new V.a(()=>this.$Yc(this.Fz.J(Z.a.G2),ub));const Yb=this.jyd.create(nb,Object(Q.a)(97,ub));nb=new Fa.a(w.AFrameworkApplication.K,F.a.instance,nb,I.a.instance,Yb,this.l5b);return na.a.E_h(Ja,nb)?32:8}if(2===nb){if(this.N1o(X.App.N5a))return this.IIa(Ea);
X.App.hvc(()=>{this.IIa(Ea)});return 32}return 2}IIa(Ea){if(!this.Je)return O.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),8;var Ja=this.Je.Kqb();if(!Ja)return O.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;Ja=Ja.Io;if(!Ja)return O.ULS.sendTraceTag(592454659,307,10,"No document"),8;O.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",Ea);this.Fe.logKpiUsage({kpiName:Qa.a.Gza});this.ug.A_l(Ea);Ea=H.a.iOb(Ja,"paste");Ja=this.ug.XTl();O.ULS.sendTraceTag(573388233,
307,50,"PasteEventHandled: {0}",Ja);if(Ea)return O.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.Fe.logKpiSuccess({kpiName:Qa.a.Gza}),32;this.mVm();O.ULS.sendTraceTag(592454662,307,10,"execCommand failed");this.Fe.logKpiFailure({kpiName:Qa.a.Gza,errorName:"ExecCommandFailed"});return 8}mVm(){this.f0a&&(this.f0a.L0b(),Qa.a.Hie(!0,ma.a.instance,N.a.eE));if(this.YHg){const Ea=this.YHg.Fqd();Ea.qdc("CallExecCommandPasteOperation");Ea.fail("call to execCommand('paste') failed",!0);this.YHg.Kka(Ea)}}N1o(Ea){let Ja=
!1;this.Yb?this.Yb.currentScope?Ja=!this.Yb.GYf(this.Yb.currentScope.name):O.ULS.sendTraceTag(573388235,307,10,"No CurrentScope"):O.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(Ja){O.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Yb.currentScope.name);if(1>Ea)return O.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Yb.UEf();return!1}return!0}$Yc(Ea,Ja){return Ea&256?new xa(this.Ufp):Ea&2?Ea&4096?new Aa(Ja,this.vd,this.Pk,X.App.instance.G9c,X.App.instance.J_a):
new ja(Ja,this.vd,X.App.instance.J_a):Ja.hasProperty(U.a.wXb)?new za(Ja,this.vd,this.Pk,this.xRc,X.App.instance.J_a):new Aa(Ja,this.vd,this.Pk,X.App.instance.G9c,X.App.instance.J_a)}static get s$n(){return M.a.A4c("Box4PasteScratchPad")}D_h(Ea,Ja,nb,ub){return!w.AFrameworkApplication.O0&&!w.AFrameworkApplication.lH||w.AFrameworkApplication.UNb?(Ea=this.n_(null,Ea?Z.a.cut:Z.a.jE,Ja,1,nb,ub))?Ea.response:8:8}}Object(G.a)(sa,"ClipboardActor",null,[])},1892:function(G,J,d){G=d(0);var m=d(182),f=d(19),
a=d(33),l=d(21),w=d(2),y=d(240),v=d(748);class u{static get kh(){return m.a.az(u.Mn,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}u.Mn="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(G.a)(u,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var x=d(15),z=d(3);d.d(J,"a",function(){return A});class A extends m.a{constructor(D,F,I){super();this.Ikh=!1;this.jZ=null;this.ecm=H=>{switch(H){case 1:this.ga.Ob(x.a.Lqi,2);break;case 2:this.ga.Ob(x.a.Mqi,2);break;case 0:this.ga.Ob(x.a.Nqi,2)}};this.xv=F;this.UV=!1;this.j7b=A.Mbm;this.gi=D;this.ga=I;this.Qg="FootnoteEndnoteFormattingOptionsDialog";this.Gd=2;this.kh=u.kh;this.Pe(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.Pe(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.pi(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.ecm,null);this.Lrb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.jZ}set fontName(D){this.jZ=D;if(D=document.getElementById("FontSizeComboBox"))D.focus(),this.gi.Ie()}get fontSize(){return this.j7b}get Lrb(){return this.Ikh}set Lrb(D){this.Ikh=D;this.Gbo()}Zba(){this.lUd("FontStyleComboBox",
"FontPlaceholder",x.a.s4d.toString(),x.a.cxj.toString(),x.a.Jhd.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.lUd("FontSizeComboBox","FontPlaceholder",x.a.t4d.toString(),z.a.Qid.toString(),x.a.Khd.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const D=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
f.a.e0(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),F=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',f.a.e0(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.uUc("NoStyle","IndentPlaceholderStyles",
x.a.Pqi.toString(),x.a.dxj.toString(),D,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.uUc("FirstLineIndent","IndentPlaceholderStyles",x.a.Oqi.toString(),x.a.Gog.toString(),F,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}lUd(D,F,I,H,N,M,U){I=y.c(D,I,!0,!0,H,N,f.a.Hf(M),!0,U);this.IYd(D,F,I,"Medium")}uUc(D,F,I,H,N,M,U){I=y.f(D,I,H,f.a.Hf(N),f.a.Hf(M),U);this.IYd(D,F,I,"Large",M)}IYd(D,F,I,H,N=null){F=document.getElementById(F);
this.xv.S5a(D,I);I=this.xv.CPb(D,H);N&&a.a.KSd(I,String.format("{0}Label",D),N);F.appendChild(I);this.xv.Yua(D)}Gbo(){this.xv.Yua("NoStyle");this.xv.Yua("FirstLineIndent")}dispose(){this.UV||(this.xv.R0("FontStyleComboBox"),this.xv.R0("FontSizeComboBox"),this.xv.R0("NoStyle"),this.xv.R0("FirstLineIndent"),this.UV=!0);this.gi.Ie();super.dispose()}static get o0a(){return l.a.instance.resolve("Common.IStandaloneRootController").Bha}static ztm(){return new A(v.a.en,A.o0a,w.AFrameworkApplication.va)}static ytm(){return A.ztm()}}
A.Mbm=-1;Object(G.a)(A,"FootnoteEndnoteFormattingOptionsDialog",m.a,[])},1929:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a){this.ji=this.sGd=0;this.dkh=a;this.MPk=f}cvb(){return this.sGd-this.ji>=this.MPk}reset(){this.ji=this.sGd=this.dkh()}update(){this.sGd=this.dkh()}}Object(G.a)(m,"TimeBasedTaskYieldStrategy",null,[689])},1939:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.contentId=""}}Object(G.a)(m,"AtMentionOptionalAttributes",
null,[])},1941:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,l,w,y){void 0===y&&(y=w);var v=Object.getOwnPropertyDescriptor(l,w);if(!v||("get"in v?!l.mJ:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,y,v)}:function(a,l,w,y){void 0===y&&(y=w);a[y]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1942),
J);f(d(1943),J)},1942:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},1943:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.EndnoteSubDocument=J.FootnoteSubDocument=J.ShapeSubDocument=J.TextboxSubDocument=J.CommentSubDocument=J.HeaderFooterSubDocument=J.MainSubDocument=void 0;const m=d(277);class f{constructor(x){m.SchemaObject.assign(f,this,x)}static getTypeName(){return"AugLoop_Word_MainSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(x){return m.SchemaObject.matchesTypesFor(x,
[f.getTypeName()])}}J.MainSubDocument=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(x){m.SchemaObject.assign(a,this,x)}static getTypeName(){return"AugLoop_Word_HeaderFooterSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(x){return m.SchemaObject.matchesTypesFor(x,[a.getTypeName()])}}J.HeaderFooterSubDocument=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(x){m.SchemaObject.assign(l,this,x)}static getTypeName(){return"AugLoop_Word_CommentSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(x){return m.SchemaObject.matchesTypesFor(x,
[l.getTypeName()])}}J.CommentSubDocument=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class w{constructor(x){m.SchemaObject.assign(w,this,x)}static getTypeName(){return"AugLoop_Word_TextboxSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(x){return m.SchemaObject.matchesTypesFor(x,[w.getTypeName()])}}J.TextboxSubDocument=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class y{constructor(x){m.SchemaObject.assign(y,this,x)}static getTypeName(){return"AugLoop_Word_ShapeSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(x){return m.SchemaObject.matchesTypesFor(x,
[y.getTypeName()])}}J.ShapeSubDocument=y;y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class v{constructor(x){m.SchemaObject.assign(v,this,x)}static getTypeName(){return"AugLoop_Word_FootnoteSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(x){return m.SchemaObject.matchesTypesFor(x,[v.getTypeName()])}}J.FootnoteSubDocument=v;v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class u{constructor(x){m.SchemaObject.assign(u,this,x)}static getTypeName(){return"AugLoop_Word_EndnoteSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(x){return m.SchemaObject.matchesTypesFor(x,
[u.getTypeName()])}}J.EndnoteSubDocument=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},1968:function(G,J){Object.defineProperty(J,"__esModule",{value:!0});J.ObjectSchemaType=J.ObjectSemantic=J.SequenceType=J.IntentIds=void 0;(function(d){d.Logging="Logging";d.ZeroTermMenu="ZeroTermMenu";d.Floatie="Floatie"})(J.IntentIds||(J.IntentIds={}));(function(d){d.CommandId="CommandId";d.ControlId="ControlId"})(J.SequenceType||(J.SequenceType={}));(function(d){d.CommandIdHistory="CommandIdHistory";d.ControlIdHistory=
"ControlIdHistory";d.FilteredCommandIdHistory="FilteredCommandIdHistory";d.CanvasContext="CanvasContext";d.ApplicationContext="ApplicationContext";d.UserContext="UserContext";d.GenericSuggestions="GenericSuggestions"})(J.ObjectSemantic||(J.ObjectSemantic={}));(function(d){d.CommandExecutionSequence="CommandExecutionSequence";d.WordCanvasContext="WordCanvasContext";d.ApplicationContext="ApplicationContext";d.UserContext="UserContext";d.RankedSuggestion="RankedSuggestion"})(J.ObjectSchemaType||(J.ObjectSchemaType=
{}))},1969:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.SearchSuggestionAnnotation=J.SearchSuggestionSignal=void 0;const m=d(277);class f{constructor(l){m.SchemaObject.assign(f,this,l)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}J.SearchSuggestionSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,
this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}J.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1977:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,l,w,y){void 0===y&&(y=w);var v=Object.getOwnPropertyDescriptor(l,w);if(!v||
("get"in v?!l.mJ:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,y,v)}:function(a,l,w,y){void 0===y&&(y=w);a[y]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1978),J);f(d(1979),J);f(d(1980),J);f(d(1981),J)},1978:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},1979:function(G,J){Object.defineProperty(J,
"__esModule",{value:!0})},1980:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.ContractEntityAnnotation=void 0;const m=d(277);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}
J.ContractEntityAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1981:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.ContractEntitySignal=void 0;const m=d(277);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}J.ContractEntitySignal=f;f.H_={T_:f.getTypeName(),
B_:f.getBaseTypes()}},1983:function(G,J,d){d.r(J);d.d(J,"ReactOICErrorDialogWithTrial",function(){return l});G=d(0);var m=d(104);J=d(1807);var f=d(501),a=d(182);class l extends J.a{constructor(w,y,v,u,x,z){super(w,y,v,u,x,z);y={["errorMessage"]:this.Gli,["offerString"]:this.Gij};w=new a.a(!1,!1,!0);this.tUj?(w.Gd=1,y.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Rrb,["onExecute"]:()=>{f.Redirect.showHelp(this.QOi)}}):(w.Gd=4,w.Pe(2,this.$Pi));w.Pe(1,this.BQd);w.Qg=this.id;y={["id"]:this.id,
["dialogIcon"]:this.icon,["bodyControls"]:y};w.pi(this.dialogTitle,Object(m.a)(this,this.Gno,"reactOICErrorDialogWithTrialHandler"),y)}}Object(G.a)(l,"ReactOICErrorDialogWithTrial",J.a,[])},1984:function(G,J,d){d.r(J);d.d(J,"OICErrorDialogWithTrial",function(){return a});G=d(0);var m=d(104);J=d(1807);var f=d(188);class a extends J.a{constructor(l,w,y,v,u,x){super(l,w,y,v,u,x);l=document.createElement("span");l.innerText=this.Gli;l.appendChild(document.createElement("br"));l.appendChild(document.createElement("br"));
w=document.createElement("span");w.innerText=this.Gij;l.appendChild(w);w=new f.StandardDialog;this.tUj?(w.Gd=1,w.Zef(this.Rrb,this.QOi)):(w.Gd=4,w.Pe(2,this.$Pi));w.Pe(1,this.BQd);w.Qg=this.id;w.Ix(this.dialogTitle,null,this.icon,Object(m.a)(this,this.yyn,"legacyOICErrorDialogWithTrialHandler"),l)}}Object(G.a)(a,"OICErrorDialogWithTrial",J.a,[])},1986:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,l,w,y){void 0===y&&(y=w);Object.defineProperty(a,y,{enumerable:!0,get:function(){return l[w]}})}:
function(a,l,w,y){void 0===y&&(y=w);a[y]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1987),J);f(d(1988),J)},1987:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},1988:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.SearchProviderAnnotation=J.SearchProviderSignal=void 0;const m=d(277);class f{constructor(l){m.SchemaObject.assign(f,
this,l)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}J.SearchProviderSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,
[a.getTypeName()])}}J.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},2081:function(G,J,d){function m(ka){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");ka?M.hvo():M.main();Pi.main(ka);og.main(ka);x.a.instance.Jc(new Mm,0,ka);x.a.instance.Jc(new Jo,0,ka);rp(ka);Ig(ka)}var f=d(0),a=d(7),l=d(1674),w=d(1687),y=d(2),v=d(92),u=d(671),x=d(193),z=d(34),A=d(49),D=d(41),F=d(20),I=d(90),
H=d(21),N=d(105);class M{get name(){return"Common.App.OAuth.OAuthPackage"}wc(ka){ka.register(238,"Common.App.OAuth.IOAuthManager").ha().Rd(()=>new l.OAuthManager)}init(){const ka=H.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.pqp(ka);this.oqp(ka)}oqp(ka){if(y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthTokenWithCAEClaimTestEnabled",!1)){var $a=y.AFrameworkApplication.K.kb("FileSource");if(y.AFrameworkApplication.K.$("IsO365ConsumerHost")||
y.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===$a){var Db=u.a.qYd;if(Db&&Db.IsEnabled){var ec=Db.Application,sc=u.a.authority;if(void 0!==ec&&null!==ec&&ec.length&&void 0!==sc&&null!==sc&&sc.length){var ad=w.a[ka.m5],Xd=F.a.eE,ue=ka.XJ(),ae=D.a.Ee();ka.wV("CAETest",ec).then(Te=>{const sf=Math.floor(D.a.Ee()-ae);ad=w.a[ka.m5];Xd=F.a.eE;ue=ka.XJ();a.ULS.sendTraceTag(508950355,3E3,50,'OAuthManager attempted to get a CAE test token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
sf,Te.IsSuccess,ad,Te.ErrorCode,$a,Xd,ue);if(Te.IsSuccess){Te="Bearer "+Te.Token;y.AFrameworkApplication.Be.GBc=Te;var kg=Db.Endpoint;if(kg){var qf=D.a.Ee();Te={["Authorization"]:Te};kg=A.a.lp(kg,"ReturnRawToken","1");kg=A.a.lp(kg,"EnforceCAE","1");y.AFrameworkApplication.Be.XJb(kg,1,null,Te,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(fh=>{var Fi=Math.floor(D.a.Ee()-qf),Nj=null;fh.qp?fh="Canceled":fh.ij?fh="Faulted":(Nj=fh.result,fh=Nj.succeeded?"Completed":"Failed");Fi={["TaskResult"]:fh,
["BrowserTokenDurationMS"]:sf,["BrowserValidationDurationMS"]:Fi};Nj&&(Fi.HttpStatus=Nj.args.data.He,Nj.succeeded&&(Nj=z.a(Nj.args.data.De),Fi.ServerValidationDurationMS=Nj.ElapsedMilliseconds,Fi.ServerValidationResult=Nj.ValidatedToken,Fi.KMSI=Nj.KMSI,Fi.Scopes=Nj.Scopes,Fi.TokenExpirationS=Math.floor(parseInt(Nj.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(508950354,3E3,"Completed"===fh?50:15,I.a.toJSON(Fi))})}}else a.ULS.sendTraceTag(508950353,3E3,15,"ValidateAccess Failed: ErrorCode: {0}, ErrorMessage: {1}",
Te.ErrorCode,Te.ErrorMessage)}).catch(Te=>{const sf=Math.floor(D.a.Ee()-ae);a.ULS.sendTraceTag(508950352,3E3,15,"UNEXPECTED CATCH: {0}, duration: {1}",Te.toString(),sf)})}}}}}pqp(ka){const $a=y.AFrameworkApplication.K.kb("FileSource");if(y.AFrameworkApplication.K.$("IsO365ConsumerHost")||y.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===$a){var Db=u.a.qYd;if(Db&&Db.IsEnabled){var ec=Db.Application,sc=u.a.authority;if(void 0!==ec&&null!==ec&&ec.length&&void 0!==sc&&null!==sc&&sc.length){var ad=
w.a[ka.m5],Xd=F.a.eE,ue=ka.XJ();try{var ae=new Map;void 0!==ae&&null!==ae?(ae.set("SupportStatus",ad),ae.set("Browser",Xd),ae.set("AuthStrategy",ue)):ae=null}catch(sf){ae=null}v.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",ae);var Te=D.a.Ee();ka.wV("Core",ec).then(sf=>{const kg=Math.floor(D.a.Ee()-Te);ad=w.a[ka.m5];Xd=F.a.eE;ue=ka.XJ();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
kg,sf.IsSuccess,ad,sf.ErrorCode,$a,Xd,ue);ae&&(ae.set("SupportStatus",ad),ae.set("Browser",Xd),ae.set("AuthStrategy",ue));var qf=Object.assign(new N.a,{durationMs:kg,extendedProperties:ae});if(sf.IsSuccess){if(v.Health.instance.recordKpiSuccess("WacCorePFT",qf),sf="Bearer "+sf.Token,y.AFrameworkApplication.Be.GBc=sf,qf=Db.Endpoint){var fh=D.a.Ee();y.AFrameworkApplication.Be.XJb(qf,1,null,{["Authorization"]:sf},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Fi=>{var Nj=Math.floor(D.a.Ee()-
fh),Zh=null;Fi.qp?Fi="Canceled":Fi.ij?Fi="Faulted":(Zh=Fi.result,Fi=Zh.succeeded?"Completed":"Failed");Nj={["TaskResult"]:Fi,["BrowserTokenDurationMS"]:kg,["BrowserValidationDurationMS"]:Nj};Zh&&(Nj.HttpStatus=Zh.args.data.He,Zh.succeeded&&(Zh=z.a(Zh.args.data.De),Nj.ServerValidationDurationMS=Zh.ElapsedMilliseconds,Nj.ServerValidationResult=Zh.ValidatedToken,Nj.KMSI=Zh.KMSI,Nj.Scopes=Zh.Scopes,Nj.TokenExpirationS=Math.floor(parseInt(Zh.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,
3E3,"Completed"===Fi?50:15,I.a.toJSON(Nj))})}}else v.Health.instance.recordKpiFailure("WacCorePFT",sf.ErrorCode,!1,!1,qf)}).catch(sf=>{var kg=Math.floor(D.a.Ee()-Te);kg=Object.assign(new N.a,{durationMs:kg,extendedProperties:ae});v.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+sf.toString(),!1,!1,kg)})}}}}dispose(){}static main(){x.a.instance.Jc(new M)}static hvo(){x.a.instance.Jc(new M,0,!0)}}Object(f.a)(M,"OAuthPackage",null,[0,1]);var U=d(400),O=d(381),V=d(19);class Y{constructor(){new O.a}}
Object(f.a)(Y,"SdxPaneSuppressionManager",null,[]);var Q=d(286),S=d(258),P=d(22);class T{constructor(ka){this.V1e=0;this.LFk=ka}cvb(){return this.V1e>=this.LFk}reset(){this.V1e=0}update(){this.V1e++}}Object(f.a)(T,"NodeCountBasedTaskYieldStrategy",null,[689]);var Z=d(1929);class X{constructor(){this.Jnd=new Set}MNa(ka){this.Jnd.add(ka)}Bsp(ka){this.Jnd.delete(ka)}A2n(){return()=>{this.Jnd.forEach(ka=>{ka.onSessionClose()})}}B2n(){return()=>{this.Jnd.forEach(ka=>{ka.onSessionConnect()})}}C2n(){return()=>
{this.Jnd.forEach(ka=>{ka.onSessionDisconnect()})}}}Object(f.a)(X,"AlSessionLifeEventNotifier",null,[452]);var aa=d(1450),ia=d(89),wa=d(96),ma=d(54),na=d(5),Fa=d(1582),Qa=d(164),ya=d(360),ta=d(1118),Aa=d(758),oa=d(262),za=d(446),ja=d(722),fa=d(452),Ca=d(481);class xa{constructor(){this.token=null}}Object(f.a)(xa,"ReleaseAnnotationParameters",null,[]);class ua{constructor(){this.value=this.id=this.parentPath=null}}Object(f.a)(ua,"SetAnnotationMetadataParameters",null,[]);class sa{constructor(){this.id=
this.parentPath=null;this.value=0}}Object(f.a)(sa,"SetAnnotationStateParameters",null,[]);var Ea=d(636),Ja=d(298),nb=d(77),ub=d(95),Yb=d(503),yb=d(1300),Za=d(324),Ya=d(673),Pa=d(8),rb=d(436);class tb extends Sys.EventArgs{constructor(ka,$a){super();this.annotation=ka;this.UTa=$a}}Object(f.a)(tb,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var ob=d(1081);class Oa{constructor(ka){this.jif=this.annotations=null;if(!ka)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=
null;else if(ka.items&&0<ka.items.length){const $a=Oa.E8d(ka.parentPath);this.annotations=Array(ka.items.length);let Db=0;for(const ec of ka.items){const sc=Object.assign(new ob.a,{id:ec.id,parentPath:$a,content:ec.body,annotationType:oa.a.getTypeNameFor(ec.body),parentRevId:ka.parentRevId});this.annotations[Db++]=sc}this.jif=oa.a.getTypeNameFor(ka)}}static E8d(ka){return ka?ka.join("\\"):""}}Object(f.a)(Oa,"AnnotationOperation",null,[]);class Xa extends Sys.EventArgs{constructor(ka){super();this.annotationType=
ka}}Object(f.a)(Xa,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class ab extends Sys.EventArgs{constructor(ka,$a){super();this.annotation=ka;this.opType=$a}}Object(f.a)(ab,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class cb{constructor(){this.newState=this.oldState=0;this.handlers=new nb.a}}Object(f.a)(cb,"AnnotationResultStateUpdateData",null,[]);var ib=d(652),Ub=d(1080);class lb{constructor(){this.gif=this.y5k=this.hif=null}}Object(f.a)(lb,"AnnotationCallbacks",null,[]);class Qb{constructor(ka,
$a,Db,ec,sc,ad){this.Xbc=null;this.sNc=new O.a(0);this.SRc=new O.a;this.Zwd=new O.a;this.CJd=new ib.a;this.Ggg=null;this.jj=ka;this.TRa=$a;this.AH=Db;this.QD=ec;this.XK=sc;this.xd=ad}mFp(ka,$a,Db,ec){this.QD.Anc(ka)&&this.jj.Yd(()=>{if(!this.Xbc){this.Xbc=new O.a;var sc=Pa.ParagraphReader.Gv(rb.a.getRootNode(),!0,!0);for(const ad of sc)ad&&(sc=ad.ja(na.a.Yc,0))&&(this.Xbc.add(sc,ad.id),this.sNc.Z(ad.id.toString(),sc))}this.TRa.Fgg(ka,(ad,Xd)=>{if(ad){var ue=this.QD.XBi(ka);ad.contentDescriptor.Uw===
ue&&((ue=this.Xtm(ad))?ad.mmb?(ue=this.btf(ad,ue))&&(Xd?Db(Xd,ad.contentDescriptor):$a(ue,ad.contentDescriptor)):ec(ad.contentDescriptor):this.hPl(ad,Object.assign(new lb,{hif:$a,y5k:Db,gif:ec})))}})},"PAS:FEPAOT")}Xtm(ka){if(3===ka.contentDescriptor.Uw){let $a;return({value:$a}=this.Xbc.Dc(ka.contentDescriptor.paragraphId)).returnValue?$a:null}if(4===ka.contentDescriptor.Uw)return ma.a.nil;a.ULS.sendTraceTag(592525442,Qb.kj,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}Ojn(ka,
$a){if(3===ka.contentDescriptor.Uw)return $a=this.XK.value.Eb($a).getValue(na.a.Tj),ka.contentDescriptor.Tj===$a;if(4===ka.contentDescriptor.Uw&&$a===ma.a.nil)return!0;a.ULS.sendTraceTag(592525443,Qb.kj,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}hPl(ka,$a){if(3===ka.contentDescriptor.Uw){const Db=ka.contentDescriptor.paragraphId;this.SRc.mb(Db)||this.SRc.add(Db,new nb.a);this.SRc.J(Db).add(ec=>{12===ec.type&&this.Xbc.add(Db,ec.id);ka.mmb?(ec=this.btf(ka,ec.id))&&$a.hif(ec,
ka.contentDescriptor):$a.gif(ka.contentDescriptor)})}else if(4===ka.contentDescriptor.Uw)if(ka.mmb){const Db=this.btf(ka,ma.a.nil);Db&&$a.hif(Db,ka.contentDescriptor)}else $a.gif(ka.contentDescriptor);else a.ULS.sendTraceTag(592525444,Qb.kj,15,"DelayCallbackForAnnotation: Unsupported content type")}btf(ka,$a){if(this.Ojn(ka,$a)){if($a=this.QD.QQn(ka.mmb,ka.contentDescriptor,$a.toString()))return this.Zwd.Z($a.id,ka.jdb),$a}else this.xd.isFeatureEnabled(85)&&this.AH.ySc(ka);return null}J8j(ka,$a){const Db=
this.QD.d6d(ka);Db&&($a===ta.a.getTypeName()?this.xop(ka,Db):this.fop(ka,Db))}xop(ka,$a){this.QD.Anc(ka.annotationType)&&(this.AH.UZa(this.XK.value,$a,ka.annotationType),this.Zwd.remove(ka.id))}fop(ka,$a){if(this.QD.Anc(ka.annotationType)){$a=Object.assign(new Ub.a,{mmb:this.QD.C5k(ka),contentDescriptor:$a,annotationType:ka.annotationType});$a=this.AH.addAnnotation(this.XK.value,$a);this.Zwd.Z(ka.id,$a);const Db=this.QD.NKi(ka.annotationType);Db&&this.CJd.contains(Db)&&(this.jj.Yd(()=>{var ec=Pa.ParagraphReader.Gv(rb.a.getRootNode(),
!0,!0);if(ec&&0<ec.count){const sc=new nb.a;for(const ad of ec)(ec=Qb.A8d(ad))&&sc.add(ec);0<sc.count&&this.AH.jOh(this.XK.value,Db,sc.toArray())}},"PAS:TAOCPA"),this.CJd.remove(Db))}}Nvb(ka){if(this.Xbc)if(ka){var $a=ka.ja(na.a.Yc,0);if($a&&(this.sNc.Z(ka.id.toString(),$a),({value:$a}=this.SRc.Dc($a)).returnValue))for(const Db of $a)Db(ka)}else a.ULS.sendTraceTag(592525445,Qb.kj,10,"OnParagraphNodeConnected: Invalid node")}Hmj(ka,$a){if(ka){var Db=ka.id.toString();ka=ka.ja(na.a.Yc,0);var ec=0;({value:ec}=
this.sNc.Dc(Db)).returnValue&&(3===$a?(this.SRc.remove(ec),this.sNc.remove(Db)):2===$a?this.sNc.Z(Db,ka):a.ULS.sendTraceTag(592525447,Qb.kj,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,Qb.kj,10,"UpdatePersistedAnnotations: Invalid node")}VHm(ka){let $a;return({value:$a}=this.Zwd.Dc(ka)).returnValue?$a:ma.a.nil}OAp(ka,$a,Db){ka?$a?this.TRa.EEi(ka,ec=>{if(ec){const Xd=Qb.A8d($a,Db);if(Xd){var sc=Array(ec.length),ad=!1;for(let ue=
0;ue<ec.length;ue++)if(ad||Xd!==ec[ue])sc[ue]=ec[ue];else{const ae=Qb.A8d($a);if(!ae)return;ad=!0;sc[ue]=ae;ec[ue]=ae}ad&&this.AH.jOh(this.XK.value,ka,sc)}}}):a.ULS.sendTraceTag(588863697,Qb.kj,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,Qb.kj,10,"UpdateWorkflowParagraphVersion: null workflowType")}FWo(ka){ka?this.CJd.add(ka):a.ULS.sendTraceTag(588863698,Qb.kj,10,"SetPendingWorkflow: null workflowType")}Trl(ka){ka?this.CJd.remove(ka):a.ULS.sendTraceTag(588105731,
Qb.kj,10,"ClearPendingWorkflow: null workflowType")}static A8d(ka,$a=0){if(!ka)return null;$a||($a=ka.ja(na.a.Tj,0));ka=Pa.ParagraphReader.vU(ka);if($a&&ka)return String.format("{0}{1}{2}",ka,Qb.Z8n,$a);a.ULS.sendTraceTag(588091606,Qb.kj,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",$a?"valid":"0",ka?"valid":"0");return null}}Qb.kj=389;Qb.Z8n="-";Object(f.a)(Qb,"PersistedAnnotationStorage",null,[686]);class fc{constructor(){this.config=this.token=null}}Object(f.a)(fc,"UpdateAnnotationConfigParameters",
null,[]);var Fc=d(133),nc=d(852),zb=d(365),Vb=d(1454),rc=d(1504),pb=d(287),bb=d(1168),Pb=d(1539),mb=d(1932);class Ua{constructor(ka,$a,Db,ec,sc,ad,Xd,ue,ae,Te,sf,kg=null,qf){this.Ikb=qf;this.sa=new ia.a;this.DFa=new ub.a;this.C9=new ub.a;this.ZE=new ub.a;this.VKe=new ub.a;this.fGc=new Ea.a(Ja.a.th());this.r3e=new nb.a;this.r4b=new ub.a;this.RKe=new ub.a;this.axd=new ub.a;this.s4b=new ub.a;this.uDc=new ub.a;this.bxd=new ub.a;this.hzd=new ub.a;this.MHd=[];this.NHd=[];this.qLc=null;this.MFk=new Ea.a(Ja.a.th());
this.TKe=new Map;this.cGc=new Map;this.EEc=null;this.Doa=new ub.a;this.oYc=null;this.wzh=this.ynh=0;this.R4a=null;this.aMl=()=>{if(this.MHd.length||this.NHd.length)try{0<this.MHd.length&&this.IIn(),0<this.NHd.length&&this.Vrp()}finally{this.isl()}else this.Gb.vf(this.qLc),this.qLc=null};this.esl=()=>{const fh=new nb.a;for(const Fi of this.ZE.values)if(fh.add(Fi),fh.count===Ua.WFk)break;for(const Fi of fh)this.WUa(Fi),this.t_b(Fi,ta.a.getTypeName());this.ZE.count||(this.Gb.vf(this.EEc),this.EEc=null)};
this.jfd=(fh,Fi)=>{for(const Nj of Fi.xk)fh=Nj.intent,!fh.type&&this.t1o(fh.intent,Nj.cpBegin,Nj.cpEnd,Nj.xUb)&&this.WUa(fh.intent)};this.sAk=ka.$("AugLoopAnnotationsAttachingIsEnabled");this.xMk=ka.iD("SendReleaseMessageAnnotationList")||[];this.xd=Te;this.gQa=kg;this.TRa=ad;this.AH=Xd;this.Yn=Db;this.QD=ue;this.dea=ae;this.XK=ec;this.jj=$a;this.Gb=sc;H.a.instance.resolve("Box4.ICharacterPropertiesEditor").zgf(this.jfd);this.Yo=sf;this.ynk=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",
!1);this.iAk=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);this.ZBk=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",!1);this.Hph=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.Ikb&&this.yWm();this.uA=pb.a.instance}get oBj(){return this.s4b}set oBj(ka){this.s4b=ka}nb(ka,$a){a.ULS.sendTraceTag(41521862,Ua.kj,50,"New registration for annotation type: {0}.",$a);this.addHandler(ka,
$a);this.eef($a).catch(Db=>{a.ULS.sendTraceTag(594396739,Ua.kj,10,"Failed to activate annotation type {0}: {1}",$a,Db.toString())})}addHandler(ka,$a){if(ka&&$a&&""!==$a){var Db=null;({value:Db}=this.s4b.Dc($a,Db)).returnValue?Db.add(ka):(Db=new nb.a,Db.add(ka),this.s4b.add($a,Db))}else a.ULS.sendTraceTag(41521861,Ua.kj,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!ka,!$a,""===$a)}xc(ka,$a){a.ULS.sendTraceTag(41521863,Ua.kj,50,"Unregister handler for annotation type: {0}.",
$a);let Db=null;({value:Db}=this.s4b.Dc($a,Db)).returnValue&&(Db.remove(ka),Db.count||(a.ULS.sendTraceTag(41521864,Ua.kj,50,"Unregister all handlers for annotation type: {0}.",$a),this.s4b.remove($a),this.tUn($a)))}VPj(ka){this.oYc||(this.oYc=this.Yo.Mc(2),this.oYc.Ab(ka))}isl(){var ka;null===(ka=this.oYc)||void 0===ka?void 0:ka.dispose();this.oYc=null}K9h(){this.qLc||(this.qLc=new wa.a(4,2,100,this.aMl,141),this.Gb.Zb(this.qLc))}IIn(){let ka;ka=Array.dequeue(this.MHd);const $a=rb.a.iQb(this.XK.value,
ka);if($a)if($a.pk){this.VPj($a);var Db=null;if(({value:Db}=this.uDc.Dc(ka,Db)).returnValue){this.uDc.remove(ka);for(const ec of Db)this.JIn($a,ec)}else a.ULS.sendTraceTag(50663568,Ua.kj,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.MFk.add(ka);else a.ULS.sendTraceTag(50436127,Ua.kj,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}JIn(ka,$a){try{const Db=$a.content.range,ec=new yb.a(0,Db.start,Db.start+Db.length,ma.a.create(),$a,sc=>{this.VKe.Z($a.id,
sc.toString())});this.Yn.vMa(ka,ec);mb.a.mzb($a,2);this.sa.C7&&this.sa.raiseEvent(Ua.rsc,new ab($a,ya.a.getTypeName()))}catch(Db){mb.a.mcd(Db,[$a],!0)}}Hcj(ka){const $a=rb.a.Q9a(ka.parentPath);let Db=null;({value:Db}=this.uDc.Dc($a,Db)).returnValue||(Db=new nb.a,this.uDc.add($a,Db),this.MHd.push($a));Db.add(ka);this.K9h()}LIn(ka,$a){this.jj.Yd(()=>{let Db;if(({value:Db}=this.C9.Dc(ka,Db)).returnValue){var ec=this.fTj(ka);for(const sc of Db){let ad;({value:ad}=this.ZE.Dc(sc,ad)).returnValue&&$a(ad)&&
Ua.vSb(ad)&&(this.Hcj(ad),ec&&this.sa.raiseEvent(Ua.rsc,new ab(ad,ta.a.getTypeName())))}}},"AS:MIFAT")}Wrp(ka,$a){this.jj.Yd(()=>{let Db;if(({value:Db}=this.C9.Dc(ka,Db)).returnValue)for(const ec of Db){let sc;({value:sc}=this.ZE.Dc(ec,sc)).returnValue&&$a(sc)&&Ua.vSb(sc)&&(this.kLg(sc),mb.a.mzb(sc,4))}},"AS:UIFAT")}AUn(ka){var $a=rb.a.GL(ka);let Db=null;if(({value:Db}=this.DFa.Dc($a,Db)).returnValue){$a=0;for(var ec=new nb.a;Db.count>$a;){var sc=Db.J($a),ad=null;({value:ad}=this.ZE.Dc(sc,ad)).returnValue&&
Ua.vSb(ad)?this.QD.jpd(ka,ad)?this.WUa(ad,!this.xd.isFeatureEnabled(85)):(sc=ad.content.range,ad=new yb.a(0,sc.start,sc.start+sc.length,ma.a.create(),ad),ec.add(ad),$a++):$a++}0<ec.count&&this.Yn.l8f(ka,ec)}}Vrp(){let ka=null;try{let $a="";$a=Array.dequeue(this.NHd);const Db=rb.a.iQb(this.XK.value,$a);Db&&12===Db.type?(this.VPj(Db),({value:ka}=this.bxd.Dc($a,ka)).returnValue?(this.Yn.jtd(ec=>ka.contains(ec.intent),Db,0)&&ka.toArray().forEach(ec=>{mb.a.mzb(ec,4)}),this.bxd.remove($a)):a.ULS.sendTraceTag(50663570,
Ua.kj,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")):a.ULS.sendTraceTag(50436128,Ua.kj,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}catch($a){mb.a.mcd($a,ka.toArray(),!0)}}kLg(ka){let $a;({value:$a}=this.VKe.Dc(ka.id,$a)).returnValue||($a=rb.a.Q9a(ka.parentPath));this.VKe.remove(ka.id);var Db=null;({value:Db}=this.bxd.Dc($a,Db)).returnValue||(Db=new nb.a,this.bxd.add($a,Db),this.NHd.push($a));Db.add(ka);this.K9h();Db=null;({value:Db}=this.uDc.Dc($a,
Db)).returnValue&&Db.remove(ka)}LXk(ka){const $a=ka.id;var Db=ka.annotationType;const ec=ka.parentPath;if(this.QD.qtb(ka)){var sc=rb.a.Wqb(this.XK.value,ec);if(sc&&(sc=sc.ja(na.a.Tj,0).toString(),ka.parentRevId&&sc!==ka.parentRevId))return!1}sc=null;({value:sc}=this.C9.Dc(Db,sc)).returnValue||(sc=new nb.a,this.C9.add(Db,sc));sc.add($a);Db=null;({value:Db}=this.DFa.Dc(ec,Db)).returnValue||(Db=new nb.a,this.DFa.add(ec,Db));Db.add($a);this.ZE.add($a,ka);this.lFp(ka);return!0}lFp(ka){const $a=this.QD.sti(ka);
if(0===$a.length)this.Vgi(ka);else{let Db=!1;this.TRa.l0n($a,ka.annotationType,(ec,sc)=>{this.ZE.mb(ka.id)?(sc=this.QD.Ktb(ka,rb.a.Qhm(ka)),!ec&&sc?(y.AFrameworkApplication.Ld("3c7ef686;a13cd815"),this.wkn&&(Db=!1),this.uMg(ka,10,!1)):ec&&this.uMg(ka,ec),Db||(this.Vgi(ka),Db=!0)):sc.K_a=!0})}}get wkn(){if(null!=this.g0g)var ka=this.g0g;else{var $a;ka=this.g0g=null===($a=y.AFrameworkApplication.K)||void 0===$a?void 0:$a.getBooleanFeatureGate("Microsoft.Office.WordOnline.IgnoreAllFix",!1)}return ka}Vgi(ka){const $a=
Ua.vSb(ka);$a&&this.Hcj(ka);!$a&&this.sa.C7&&this.sa.raiseEvent(Ua.rsc,new ab(ka,ya.a.getTypeName()))}b6j(ka,$a,Db,ec){let sc=!0;this.jj.Yd(()=>{if(ec.startsWith(rb.a.ANb)){var ad=ka.id,Xd=null;if($a===ta.a.getTypeName())this.WUa(ka);else if(({value:Xd}=this.ZE.Dc(ad,Xd)).returnValue)a.ULS.sendTraceTag(41418891,Ua.kj,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",ad,ka.annotationType),this.ZE.Z(ad,ka);else if(!this.LXk(ka)){sc=!1;return}Db&&$a===ya.a.getTypeName()&&
ec!==rb.a.ANb&&this.r3e.add(ka.annotationType)}this.t_b(ka,$a)},"AS:UAS");return sc}SRo(ka){if(ka)for(const $a of ka)this.t_b($a,Aa.a.getTypeName()),ka=$a.content,this.hzd.mb(ka.categoryName)?this.hzd.Z(ka.categoryName,$a):this.hzd.add(ka.categoryName,$a);else a.ULS.sendTraceTag(592802119,Ua.kj,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}o0k(ka){this.sa.addHandler(Ua.rsc,ka)}MPh(ka){this.sa.addHandler(Ua.tjj,ka)}znc(ka){return this.r4b.mb(ka)}n0k(ka){this.sa.addHandler(Ua.mme,
ka)}wAo(ka){this.sa.removeHandler(Ua.mme,ka)}fTj(ka){return!rb.a.Tf(ka)&&Ya.a(ka)&&this.sa.C7}WUa(ka,$a=!0){if(this.ZE.mb(ka.id)){var Db=this.ZE.J(ka.id);this.ZE.remove(ka.id);var ec=null;({value:ec}=this.DFa.Dc(ka.parentPath,ec)).returnValue?(ec.remove(ka.id),Ua.vSb(Db)&&this.kLg(Db)):a.ULS.sendTraceTag(50734169,Ua.kj,15,"DeleteAnnotationFromStorage: No annotations in given parent path");ec=null;({value:ec}=this.C9.Dc(ka.annotationType,ec)).returnValue?ec.remove(ka.id):a.ULS.sendTraceTag(50734170,
Ua.kj,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.fTj(ka.annotationType)?this.sa.raiseEvent(Ua.rsc,new ab(Db,ta.a.getTypeName())):this.t_b(ka,ta.a.getTypeName());$a&&this.dea.J8j(Db,ta.a.getTypeName())}}jHf(ka,$a,Db=!1){const ec=new nb.a;var sc;if(!({value:sc}=this.C9.Dc(ka,sc)).returnValue)return ec;for(const ad of sc)this.ZE.mb(ad)?(ka=this.ZE.J(ad),(sc=this.QD.d6d(ka))&&($a.equals(sc)||Db&&$a.overlaps(sc))&&ec.add(ka)):a.ULS.sendTraceTag(577843217,
Ua.kj,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",ad);return ec}l_d(ka){let $a=null;if(({value:$a}=this.C9.Dc(ka,$a)).returnValue){ka=$a.toArray();for(const Db of ka){let ec;({value:ec}=this.ZE.Dc(Db,ec)).returnValue&&this.WUa(ec)}}}rgn(ka){return oa.a.getTypeNameFor(ka)===zb.a.getTypeName()}eXi(ka){var $a,Db;return(null===(Db=null===($a=this.Ikb)||void 0===$a?void 0:$a.TBi)||void 0===Db?void 0:Db.call($a))===nc.a.qCc&&ka&&0===ka.priority?this.Ikb.Erd(ka.context.substr(ka.startInContext,
ka.range.length)):!1}iwj(ka,$a){this.jj.Yd(()=>{a.ULS.A4(Ua.kj,100)&&a.ULS.sendTraceTag(41418894,Ua.kj,100,"Operation of type {0} with path {1} received",oa.a.getTypeNameFor(ka),ka.parentPath.join("\\"));try{const Db=new Oa(ka);for(const ec of Db.annotations)if(ec.annotationType===rc.b.getTypeName()){const sc=ec.content.results.map(ad=>{var Xd;const ue=null===(Xd=ad.M_)||void 0===Xd?void 0:Xd.seq;Xd=void 0===ue?ec.id:ec.id+"_"+ue;return{id:Xd,body:{...ad,id:Xd},source:"",revId:"",contextId:"",sourceTimestamp:Date.now()}});
this.iwj({items:sc,parentPath:ka.parentPath,parentRevId:ka.parentRevId,H_:ka.H_},$a)}else Db.jif===ya.a.getTypeName()&&this.h4o(ec)?(y.AFrameworkApplication.Ld("g8469255;j5hhe441"),this.Hph&&(this.R4a||(this.R4a=bb.a.r5d()),this.ynh++,this.R4a.VQd("AnnotationSkippedDueToInvalidContextCount",this.ynh.toString()))):this.z5c(ec,$a,Db.jif,!0)}catch(Db){a.ULS.sendTraceTag(41418898,Ua.kj,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",Db.message,Db.stack)}},"AS:PO")}h4o(ka){var $a;
y.AFrameworkApplication.Ld("01dfc961;05c12706");if(this.ZBk&&Ya.a(ka.annotationType)){var Db;let sc=Db=null;if(this.uA){Db=this.uA.Tka;var ec=null===Db||void 0===Db?void 0:Db.node;Db=rb.a.Q9a(ka.parentPath);if(rb.a.iQb(this.XK.value,Db)!==ec)return!1;ka=ka.content;Db=ka.context.substring(ka.startInContext,ka.startInContext+ka.range.length);sc=null===($a=null===ec||void 0===ec?void 0:ec.characterData)||void 0===$a?void 0:$a.substring(ka.range.start,ka.range.start+ka.range.length);this.Hph&&ka&&0===
ka.priority&&($a=0<ka.range.start?ec.characterData.charAt(ka.range.start-1):null,ec=ka.range.start+ka.range.length<ec.characterData.length?ec.characterData.charAt(ka.range.start+ka.range.length):null,"en-us"==ka.language.toLocaleLowerCase()&&sc&&Db&&sc===Db&&($a&&$a.match("[A-Za-z0-9]")||ec&&ec.match("[A-Za-z0-9]"))&&(this.R4a||(this.R4a=bb.a.r5d()),this.wzh++,this.R4a.VQd("partialWordAnnotationsCount",this.wzh.toString())))}return sc&&Db&&sc!==Db?!0:!1}return!1}z5c(ka,$a,Db,ec){if(this.rgn(ka.content)&&
this.eXi(ka.content))this.fFa(ka,70);else{var sc=ka.parentPath;Db!==ta.a.getTypeName()&&ec||this.$Bj(ka);ec&&Db===ya.a.getTypeName()&&Ya.a(ka.annotationType)&&ka.content.isHotCritique&&this.iAk?this.cGc.set(ka.id,{annotation:ka,time:Date.now()}):(ec=ka.annotationType,rb.a.Tf(ec)||ec!==za.a.getTypeName()?!rb.a.Tf(ec)&&Ya.a(ec)&&ka.content&&0==ka.content.priority&&Fc.a.S7?(ka=rb.a.Q9a(sc))&&ka==Fc.a.igm()&&a.ULS.sendTraceTag(539870169,Ua.kj,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):
Db!==ta.a.getTypeName()&&this.fGc.contains(sc)?a.ULS.sendTraceTag(41418897,Ua.kj,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",sc,ka.id):this.$5j(ka,sc,Db,$a):a.ULS.sendTraceTag(595342670,Ua.kj,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",sc))}}qxo(ka){if(ka&&ka.annotationType&&this.QD.Anc(ka.annotationType)){var $a;if(({value:$a}=this.C9.Dc(ka.annotationType,$a)).returnValue&&(ka=this.QD.d6d(ka)))for(const Db of $a){let ec;
({value:ec}=this.ZE.Dc(Db,ec)).returnValue&&($a=this.QD.d6d(ec))&&(ka.equals($a)||ka.overlaps($a))&&this.WUa(ec)}}}t_b(ka,$a){this.jj.Yd(()=>{let Db=null;if(({value:Db}=this.oBj.Dc(ka.annotationType,Db)).returnValue)for(const ec of Db)ec.lD(ka,$a)},"AS:SATH")}dsl(){a.ULS.sendTraceTag(50860999,Ua.kj,50,"ClearStorage: Initiated Clearing Storage");this.EEc||(this.EEc=new wa.a(4,2,100,this.esl,142),this.Gb.Zb(this.EEc))}activateAnnotation(ka,$a){let Db;if(({value:Db}=this.axd.Dc(ka,Db)).returnValue){if(Db.contains($a))return Promise.resolve(null);
Db.add($a)}else{let ec;this.axd.add(ka,(ec=new nb.a,ec.add($a),ec))}return this.eef(ka)}eef(ka){a.ULS.sendTraceTag(41521865,Ua.kj,50,"ActivateAnnotation: Activating annotation type {0}.",ka);if(this.r4b.mb(ka))return Promise.resolve(null);var $a=null;if(({value:$a}=this.RKe.Dc(ka,$a)).returnValue)return $a;this.qUk(ka);$a=null;this.gQa&&($a=this.gQa());if($a){const Db=new Ca.a;Db.annotationType=ka;this.ynk&&(this.Doa.mb(ka)||this.Doa.Z(ka,new cb),Db.stateUpdateHandler=(ec,sc)=>{this.Doa.J(ka).oldState=
ec;this.Doa.J(ka).newState=sc;for(const ad of this.Doa.J(ka).handlers)ad(ka,ec,sc)});$a=$a.activateAnnotation(Db);this.RKe.add(ka,$a);return $a.then(ec=>{this.RKe.remove(ka);this.r4b.add(ka,ec.token);this.a6j(ec.token,ka);this.sa.raiseEvent(Ua.mme,new Xa(ka,!0));this.wWm(ka);return ec})}return Promise.reject(Error.create("Error during annotation activation"))}wWm(ka){const $a=this.QD.NKi(ka);$a&&this.TRa.EEi($a,Db=>{if(this.dea.Ggg){var ec=Pa.ParagraphReader.Gv(rb.a.getRootNode(),!0,!0);if(ec&&0<
ec.count){let sc=0;for(const ad of ec){ec=Qb.A8d(ad);if(!ec)continue;let Xd=!1;for(;sc<Db.length;){if(ec===Db[sc]){Xd=!0;break}sc++}if(!Xd){this.dea.Ggg($a);break}sc++}}}})}qUk(ka){this.dea.mFp(ka,($a,Db)=>{0<this.jHf(ka,Db,!0).count||this.b6j($a,ya.a.getTypeName(),!0,$a.parentPath)},($a,Db)=>{if(3!==Db.Uw)a.ULS.sendTraceTag(591541786,Ua.kj,15,"Annotation moved to unsupported location type: {0}",Db.Uw);else if($a.Uw!==Db.Uw)a.ULS.sendTraceTag(591541787,Ua.kj,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",
$a.Uw,Db.Uw);else{$a=this.jHf(ka,$a);for(const sc of $a){const ad=sc.content;$a=rb.a.Wqb(this.XK.value,sc.parentPath);if(!$a){a.ULS.sendTraceTag(591541788,Ua.kj,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.Yn.jtd(Xd=>Xd.intent===ad,$a,0))break;var ec=Db.qza;ec=new yb.a(0,ec,ec+Db.pza,null,ad);this.Yn.vMa($a,ec)}}},$a=>{for(const Db of this.jHf(ka,$a))this.WUa(Db,!1)})}releaseAnnotation(ka,$a){let Db;if(({value:Db}=this.axd.Dc(ka,Db)).returnValue){Db.contains($a)&&
Db.remove($a);if(0<Db.count)return Promise.resolve(!1);this.axd.remove(ka)}a.ULS.sendTraceTag(593790408,Ua.kj,50,"ReleaseAnnotation: Releasing annotation type {0}.",ka);return this.OLj(ka)}tUn(ka){var $a=null;if(({value:$a}=this.C9.Dc(ka,$a)).returnValue){a.ULS.sendTraceTag(41418899,Ua.kj,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",ka);for(const Db of $a)if($a=null,({value:$a}=this.ZE.Dc(Db,$a)).returnValue){const ec=$a.parentPath;let sc=null;({value:sc}=this.DFa.Dc(ec,
sc)).returnValue&&(sc.remove(Db),sc.count||this.DFa.remove(ec));this.ZE.remove(Db);Ua.vSb($a)&&this.kLg($a)}this.C9.remove(ka)}Array.contains(this.xMk,ka)&&this.OLj(ka)}OLj(ka){let $a=null,Db=null;this.gQa&&(Db=this.gQa());if(Db){if(({value:$a}=this.r4b.Dc(ka,$a)).returnValue){const ec=new xa;ec.token=$a;this.r4b.remove(ka);this.sa.raiseEvent(Ua.mme,new Xa(ka,!1));return Db.releaseAnnotation(ec)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}f7i(){this.jj.Yd(()=>
{if(this.sAk){var ka=rb.a.getRootNode();if(ka){var $a=new ub.a;Yb.f(ka,Db=>{var ec=rb.a.GL(Db),sc=null;if(({value:sc}=this.DFa.Dc(ec,sc)).returnValue)for(const ad of sc)ec=null,({value:ec}=this.ZE.Dc(ad,ec)).returnValue&&(ec.parent=Db,ec.U9c=!0,ec.tXb=2,$a.mb(ec.annotationType)||$a.Z(ec.annotationType,new nb.a),$a.J(ec.annotationType).add(ad),sc=null,({value:sc}=this.C9.Dc(ec.annotationType,sc)).returnValue&&sc.remove(ec.id));return!0},12);for(const Db of this.C9.keys)if(ka=null,({value:ka}=this.C9.Dc(Db,
ka)).returnValue)for(const ec of ka)if(ka=null,({value:ka}=this.ZE.Dc(ec,ka)).returnValue){let sc=null;ka.parentPath===rb.a.ANb?(ka.tXb=1,ka.parent=null):({value:sc}=this.ZE.Dc(ka.parentPath,sc)).returnValue?(ka.tXb=3,ka.parent=sc):(ka.tXb=0,ka.parent=null,a.ULS.sendTraceTag(41554060,Ua.kj,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",ka.id));ka.U9c=!0;$a.mb(ka.annotationType)||$a.Z(ka.annotationType,new nb.a);$a.J(ka.annotationType).add(ec)}else a.ULS.sendTraceTag(41997840,
Ua.kj,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",ec);else a.ULS.sendTraceTag(41997841,Ua.kj,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",Db);this.C9=$a;this.r3e.clear()}else a.ULS.sendTraceTag(41554058,Ua.kj,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,Ua.kj,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}B5k(ka){this.iwj(ka,!0)}x3n(ka,
$a){this.jj.Yd(()=>{const Db=$a?$a+String.format("\\{0}",ka.id):rb.a.GL(ka);a.ULS.sendTraceTag(41418900,Ua.kj,50,"OnTileDeleted: Tile delete event received for tile {0}.",Db);this.fGc.contains(Db)||this.fGc.add(Db);var ec=null;if(({value:ec}=this.DFa.Dc(Db,ec)).returnValue){a.ULS.sendTraceTag(41418901,Ua.kj,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",ec.count,Db);for(const sc of ec)ec=null,({value:ec}=this.ZE.Dc(sc,ec)).returnValue&&(this.t_b(ec,ta.a.getTypeName()),this.sa.C7&&
this.sa.raiseEvent(Ua.rsc,new ab(ec,ta.a.getTypeName())),this.ZE.remove(sc));this.DFa.remove(Db)}},"AS:OTD")}w3n(ka){ka=rb.a.GL(ka);this.fGc.remove(ka)&&a.ULS.sendTraceTag(41418902,Ua.kj,50,"OnTileAdded: Deleted tile {0} was re-added.",ka)}Typ(ka){if(ka){a.ULS.sendTraceTag(50436131,Ua.kj,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",ka.count);var $a=new ub.a;for(var Db of ka)ka=null,({value:ka}=$a.Dc(Db.parentPath,ka)).returnValue||(ka=new ub.a,$a.add(Db.parentPath,ka)),ka.Z(Db.id,
Db);for(const ec of $a){$a=rb.a.Wqb(this.XK.value,ec.key);if(!$a){a.ULS.sendTraceTag(50436160,Ua.kj,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}Db=new Za.a([0]);for(let sc=0,ad=$a.qa.length;sc<ad;sc++)ka=$a.qa.J(sc),ka.xk&&Db.O0a(ka.xk,void 0,(Xd,ue)=>{if(ue){var ae=null,Te=ue.intent;Te&&({value:ae}=ec.value.Dc(Te.id,ae)).returnValue&&(Te=new ja.a,Te.start=ue.Jb.cp,Te.length=Xd.Jb.cp-Te.start,ae.content.range=Te,ae.zma=!1)}})}}else a.ULS.sendTraceTag(50436130,Ua.kj,
10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(ka){a.ULS.sendTraceTag(593049729,Ua.kj,50,"GetAnnotationsByType: Method called for type {0}.",ka);return this.eef(ka).then(()=>{const $a=new nb.a;this.jj.Yd(()=>{if(rb.a.Tf(ka)||ka!==za.a.getTypeName()){this.r3e.contains(ka)&&this.f7i();var Db=null;if(({value:Db}=this.C9.Dc(ka,Db)).returnValue){a.ULS.sendTraceTag(41418903,Ua.kj,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",ka);var ec=new nb.a;for(const sc of Db)Db=
null,({value:Db}=this.ZE.Dc(sc,Db)).returnValue&&(Db.zma&&ec.add(Db),$a.add(Db));ec&&0<ec.count&&Ua.vSb(ec.J(0))&&this.Typ(ec)}}else for(ec of this.hzd.values)$a.add(ec);$a.count||a.ULS.sendTraceTag(41418904,Ua.kj,50,"GetAnnotationsByType: No annotations found for type {0}!",ka)},"AS:GABT");return $a},$a=>{a.ULS.sendTraceTag(41418905,Ua.kj,10,"Exception occurred while fetching annotations of type {0}: {1}",ka,$a);return null})}Zka(ka){let $a=null;return({value:$a}=this.ZE.Dc(ka,$a)).returnValue?$a:
null}kHf(ka){let $a=null;if(this.DFa.mb(ka))for(const Db of this.DFa.J(ka))if(ka=this.Zka(Db))$a||($a=new nb.a),$a.add(ka);return $a}DUb(ka){return(ka=this.Zka(ka))?(ka.U9c||this.f7i(),ka):null}fFa(ka,$a){this.AYo(ka,$a);this.uMg(ka,$a);this.t_b(ka,Aa.a.getTypeName())}Ltp(ka,$a){this.Ixp(ka,$a);this.FVo(ka,rb.a.Phm(ka));this.t_b(ka,Aa.a.getTypeName())}Mtp(ka,$a){ka=this.QD.sti(ka);for(const Db of ka)this.AH.hMg(this.XK.value,Db,$a)}AYo(ka,$a){let Db=null;this.gQa&&(Db=this.gQa());Db&&(ka=this.Rhm(ka,
$a))&&Db.setAnnotationState(ka)}uMg(ka,$a,Db=!0){if(ka&&Ua.UVi(ka)){var ec=this.Zka(ka.id);!ka.content||ec&&ka.content===ec.content||rb.a.setAnnotationState(ka,$a);ec&&ec.content&&rb.a.setAnnotationState(ec,$a);Db&&this.sa.C7&&(70===$a||60===$a)&&this.sa.raiseEvent(Ua.tjj,new tb(ka,$a))}}Rhm(ka,$a){let Db=null;ka&&(Db=Object.assign(new sa,{id:ka.id,value:$a}),rb.a.Tf(ka.parentPath)||(Db.parentPath=ka.parentPath.split("\\")));return Db}FVo(ka,$a){const Db=this.gQa?this.gQa():null;Db&&(ka=this.Ohm(ka,
$a))&&Db.setAnnotationMetadata(ka)}Ixp(ka,$a){if(ka&&Ua.UVi(ka)){var Db=this.Zka(ka.id);!ka.content||Db&&ka.content==Db.content||rb.a.zMj(ka,$a);Db&&Db.content&&rb.a.zMj(Db,$a)}}Ohm(ka,$a){if(!ka)return null;const Db=new ua;Db.id=ka.id;Db.value=$a;rb.a.Tf(ka.parentPath)||(Db.parentPath=ka.parentPath.split("\\"));return Db}t1o(ka,$a,Db,ec){if(y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackCardRetentionEnabled",!1)&&(ka.annotationType===Pb.b.getTypeName()||
ka.annotationType===Pb.d.getTypeName()))return!1;const sc=ka.content;if(this.QD.qtb(ka)&&sc){const ad=sc.range.start+sc.range.length;if(0<ec&&ad<=Db||0>ec&&ad<=Db+ec)return!1;if(0<ec&&sc.range.start>=$a||0>ec&&sc.range.start>=Db)return sc.range.start+=ec,!1}return!this.xd.isFeatureEnabled(57)&&sc&&sc.M_?(ka=this.QD.Ktb(ka,60),!(60===sc.M_.state&&ka)):!0}SMh(ka,$a){this.Doa.mb($a)||this.Doa.Z($a,new cb);this.Doa.J($a).handlers.add(ka);ka($a,this.Doa.J($a).oldState,this.Doa.J($a).newState)}JBj(ka,$a){this.Doa.mb($a)&&
this.Doa.J($a).handlers.contains(ka)&&this.Doa.J($a).handlers.remove(ka)}static UVi(ka){ka=oa.a.getBaseTypesFor(ka.content);return Array.contains(ka,Qa.a.getTypeName())}static vSb(ka){if(void 0===ka.content||null===ka.content||""===rb.a.Q9a(ka.parentPath))return!1;const $a=oa.a.getBaseTypesFor(ka.content);return Array.contains($a,fa.a.getTypeName())&&ka.annotationType!==Fa.RoleDetectionAnnotation.getTypeName()}Ktp(ka){ka?(this.TKe.AugLoop_Text_Critique=ka,ka=this.znc("AugLoop_Text_Critique")?this.r4b.J("AugLoop_Text_Critique"):
null,this.a6j(ka,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,Ua.kj,50,"Annotation configuration could not be updated for annotation type: {0}.","AugLoop_Text_Critique")}a6j(ka,$a){if(ka&&this.TKe[$a]){const Db=new fc;Db.token=ka;Db.config=this.TKe[$a];this.gQa&&(this.gQa().updateAnnotationConfig(Db),a.ULS.sendTraceTag(540615553,Ua.kj,50,"Annotation configuration has been updated for annotation type: {0}.",$a))}}$Bj(ka){let $a=null;({value:$a}=this.ZE.Dc(ka.id,$a)).returnValue&&(ka.annotationType=
$a.annotationType);this.cGc.has(ka.id)&&this.cGc.delete(ka.id)}$5j(ka,$a,Db,ec){this.qxo(ka);this.b6j(ka,Db,ec,$a)&&this.dea.J8j(ka,Db)}UZa(ka){const $a=ka.parentPath,Db=ta.a.getTypeName();this.$Bj(ka);this.fFa(ka,70);this.fGc.contains($a)||this.$5j(ka,$a,Db,!0)}Vym(ka){const $a=new nb.a;ka=this.C9.Dc(ka).value;if(null===ka)return $a;for(const Db of ka)ka=this.ZE.Dc(Db).value,null!==ka&&$a.push(ka);return $a}async yWm(){await Object(Vb.b)();this.UBj()}UBj(){const ka=this.Vym(zb.a.getTypeName());for(const $a of ka)this.eXi($a.content)&&
this.UZa($a)}}Ua.kj=389;Ua.rsc="OnAnnotationOperation";Ua.tjj="OnAnnotationLocalStateChange";Ua.mme="OnAnnotationActivationChange";Ua.WFk=20;Object(f.a)(Ua,"AnnotationStorage",null,[687]);class vb{constructor(){this.Dwe=null;this.upd=!1}}Object(f.a)(vb,"AugmentationLoopStateManager",null,[685]);var Ia=d(194),Ma=d(621),qb=d(84),Xb=d(114),Cc=d(640),Ec=d(477),Wb=d(273);class Hb extends Wb.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=
null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=!1}lm(){return Ec.a.GMo}static construct(ka,$a,Db,ec,sc,ad){const Xd=new Hb;Xd.ExpectedEndRevisionId=ka;Xd.OriginString=$a;Xd.Authorization=Db;Xd.AugLoopSeedUrl=ec;Xd.FileId=sc;Xd.SeedBatchesInParallelIsEnabled=ad;Xd.AddDocumentKindTypeToPathIsEnabled=!0;Xd.CheckOnDemandNodeVersionEnabled=!0;Xd.AddSubDocumentKindTypeToPathIsEnabled=!0;return Xd}}
Object(f.a)(Hb,"FullFileAugLoopSeedingRequest",Wb.a,[]);class Sb{constructor(){this.authToken=this.url=this.fqj=null}}Object(f.a)(Sb,"ReseedingTaskInfo",null,[]);var cc=d(23);class Gc{constructor(ka,$a,Db,ec,sc,ad){this.$E=null;this.pjh=!1;this.i6b=null;this.U6e=0;this.qid=(Xd,ue)=>{Xd=ue.Kea;this.i6b&&Xb.AT(Xd,ae=>ae===this.i6b)&&(ue.httpStatusCode!==Ia.a.zz||ue.oK||2!==ue.Tkg?ue.httpStatusCode!==Ia.a.zz||ue.oK||1!==ue.Tkg?this.uHj(()=>{a.ULS.sendTraceTag(50861003,Gc.kj,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",
ue.httpStatusCode,ue.oK,ue.Tkg,ue.kr)}):(this.IQ.upd=!1,this.$E.tZb(this.qid),this.Re.dsl(),a.ULS.sendTraceTag(50861002,Gc.kj,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),Xd=Object(qb.a)(Sb,this.i6b),this.Gxj(ue.mIo,Xd.fqj,Xd.url,Xd.authToken)):this.uHj(()=>{a.ULS.sendTraceTag(50861001,Gc.kj,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.p7l=Xd=>{if(void 0===Xd||null===Xd||void 0===Xd.data||null===Xd.data||void 0===Xd.data.De||
null===Xd.data.De)a.ULS.sendTraceTag(41445393,Gc.kj,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Xd.data.He!==Ia.a.zz)a.ULS.sendTraceTag(41445394,Gc.kj,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",Xd.data.He);else try{let ue;({group:ue}=Ma.a.R4(Xd.data.De)).returnValue?ue.Responses&&ue.Responses.length?(Xd=null,ue&&ue.Responses&&ue.Responses.length&&(Xd=ue.Responses[0])?(this.DH.FPa(Xd),Xd.StatusCode?
a.ULS.sendTraceTag(41445398,Gc.kj,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",Xd.StatusCode):a.ULS.sendTraceTag(41445399,Gc.kj,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",Xd.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,Gc.kj,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):
a.ULS.sendTraceTag(41445396,Gc.kj,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):a.ULS.sendTraceTag(41445395,Gc.kj,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(ue){a.ULS.sendTraceTag(41445400,Gc.kj,10,"FileSeedingSuccessCallback: {0}",ue.message)}};this.o7l=Xd=>{void 0===Xd||null===Xd||void 0===Xd.data||null===Xd.data||void 0===Xd.data.De||null===Xd.data.De?a.ULS.sendTraceTag(41445401,Gc.kj,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):
a.ULS.sendTraceTag(41445402,Gc.kj,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",Xd.data.He)};this.yok=ka.$("AugLoopServerSideSeedingIsEnabled");this.wok=ka.$("AugLoopReseedingIsEnabled");this.xok=ka.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.Muh=ka.ic("MaxReseedingRetries",1);this.Af=$a;this.jDd=Db;this.IQ=ec;this.DH=sc;this.Re=ad;cc.StaticActiveAppFrame.za()&&cc.StaticActiveAppFrame.za().ib&&cc.StaticActiveAppFrame.za().ib.$c&&cc.StaticActiveAppFrame.za().ib.$c.yg&&
(this.$E=cc.StaticActiveAppFrame.za().ib.$c.yg)}y8m(ka,$a,Db){if(this.yok){var ec=this.IQ.Dwe;ec&&ec.trim().length?this.pjh?this.wok&&(a.ULS.sendTraceTag(50861E3,Gc.kj,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),this.U6e=0,this.$E?(this.IQ.upd=!0,this.$E.dKb(this.qid),this.i6b=Object.assign(new Sb,{fqj:ka,url:$a,authToken:Db}),this.$E.dD(null,null,this.i6b)):a.ULS.sendTraceTag(592814793,Gc.kj,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,
Gc.kj,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.Gxj(ec,ka,$a,Db),this.pjh=!0):a.ULS.sendTraceTag(41445391,Gc.kj,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,Gc.kj,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}uHj(ka){this.U6e<this.Muh?(a.ULS.sendTraceTag(594384E3,Gc.kj,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",
++this.U6e,this.Muh),this.$E.dD(null,null,this.i6b)):(this.IQ.upd=!1,this.$E.tZb(this.qid),ka())}Gxj(ka,$a,Db,ec){const sc=Hb.construct(ka,$a,ec,Db,y.AFrameworkApplication.rootQuerySignature,this.xok);a.ULS.sendTraceTag(595178454,Gc.kj,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.jDd.x$a.execute(()=>{this.dZk(sc)})}dZk(ka){a.ULS.sendTraceTag(595178453,Gc.kj,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");
this.Af.Ij(P.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,Cc.b(ka),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.p7l,this.o7l,ka);a.ULS.sendTraceTag(42016906,Gc.kj,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}Gc.kj=389;Object(f.a)(Gc,"FullFileAugLoopSeedingService",null,[]);class Oc{constructor(){}}Object(f.a)(Oc,"RuntimeManagerInitializationTracker",null,[]);var Zc=d(762);class kb{getAugLoopRuntimeManager(){return Zc.a.getAugLoopRuntimeManager()}}
Object(f.a)(kb,"AlFactoryWrapper",null,[684]);class wd{Pl(){return rb.a.Pl()}}Object(f.a)(wd,"UtilsWrapper",null,[683]);var qe=d(814),Qd=d(57),me=d(16),Ne=d(46),Cd=d(187),Pf=d(2169),cg=d(6),mg=d(116),ci=d(28),Dd=d(380),Xc=d(426),Jd=d(109),pf=d(62);class Ce{constructor(ka,$a,Db,ec,sc){this.Ga=ka;this.ig=Db;this.Vp=ec;this.xe=sc;this.Bta=this.Ga.$("WordDesignerCaptionDetectionEnabled")}ITo(ka,$a){ka.listType=this.Oym($a);ka.outlineLevel=Pa.ParagraphReader.C9a($a);ka.indentation=Ce.RKf(this.Vp.iX($a));
ka.alignment=Ce.WGf(Pa.ParagraphReader.ez($a));ka.isInsideTable=this.isInsideTable($a);ka.isInsideTOC=$a.Gs;ka.rightIndentation=Ce.RKf(this.Vp.K9a($a));var Db=this.Vp.jlc($a);ka.specialIndentType=Ce.mLm(Db);ka.specialIndentBy=Ce.RKf(Db);ka.listType!==Pf.e.NoList&&this.nVo($a,ka);this.uYo($a,ka);Db=[];this.Bta&&(Db=this.lgo($a));ka.formattedRanges=this.Gtm($a,Db);this.Bta&&null!=Db&&(ka.objectReferences=0<Db.length?Db:void 0)}Gtm(ka,$a){var Db=ka.qa?ka.qa.length:0,ec=mg.FormattingReader.Cs(ci.a.create(ka));
let sc=Jd.a.RJ,ad=0,Xd=Jd.a.gP/2;ec&&(Xd=mg.FormattingReader.Bj(ec,me.a.fontSize,Jd.a.gP)/2,sc=mg.FormattingReader.Bj(ec,me.a.font,Jd.a.RJ),ad=mg.FormattingReader.language(ec));ec="Normal";var ue=this.xe.Eq(ka);ue&&(ec=ue.getValue(Ne.a.la)||"Normal",ue.hasProperty(me.a.font)&&(sc=ue.getValue(me.a.font)));if(Db){--Db;ue=[];let Fi=null,Nj=void 0,Zh=null;this.Bta&&ka.hasProperty(me.a.Vn)&&(Zh=ka.getValue(me.a.Vn));const hk=ka.properties.ja(na.a.wka,null);for(let km=0;km<Db;km++){var ae=ka.qa.J(km),Te=
ka.Lc,sf=null;this.Bta&&(sf=Ce.bPf(ka,Zh,km));ae.kf&&(Fi=Ce.kvp(Te,ae.kf,Fi));ae.hyperlink&&ae.hyperlink.url?Nj=ae.hyperlink.url:ae.vn&&(Nj=void 0);var kg=ka.qa.J(km+1).cp-1;Te=ae.cp;kg=kg-ae.cp+1;let lm=!1,Rl=!1,Oj=!1,Fn=Xd,em=0,dn=0,Lo=ec,Gi=void 0,en=ad,uk=sc,pj;if(ae.formatting){var qf=ae.formatting;lm=mg.FormattingReader.Bj(qf,me.a.bold,!1);Rl=mg.FormattingReader.Bj(qf,me.a.italic,!1);Oj=mg.FormattingReader.Bj(qf,me.a.underline,!1);Fn=mg.FormattingReader.Bj(qf,me.a.fontSize,2*Xd)/2;em=mg.FormattingReader.Bj(qf,
Ne.a.capitalization,0);dn=mg.FormattingReader.Bj(qf,me.a.fontColor,0);en=mg.FormattingReader.language(qf)||ad;uk=mg.FormattingReader.Bj(qf,me.a.font,sc);Lo=ec;var fh=qf.uo;fh&&(fh=fh.ja(Ne.a.Gw,null))&&!fh.equals(ma.a.nil)&&qf.paragraph.Lc&&(qf=this.xe.ko().sla(fh,qf.paragraph.Lc))&&(Lo=qf.getValue(Ne.a.la))}this.Bta&&(pj=this.rMf(sf),null!=pj&&this.$Oh($a,sf,pj,ue.length,Pf.b.Inline));Fi&&(Gi=0<Fi.count);ae={isDeleted:this.Ugn(hk,ae,km,Nj),fontFamily:uk,fontWeight:lm?Pf.d.Bold:Pf.d.Normal,fontSize:Fn,
italic:Rl,underline:Oj?Pf.h.SingleLine:Pf.h.None,capitalization:Ce.u8h(em),color:dn,styleName:Lo,isFollowUp:Gi,languageId:Ce.l8h(en),start:Te,length:kg,link:Nj,isReference:Ce.isReference(ae)?!0:void 0,objectType:null!==pj&&void 0!==pj?pj:void 0};sf=0<ue.length?ue[ue.length-1]:void 0;Ce.ill(sf,ae)?sf.length+=ae.length:ue.push(ae)}return ue}return[{fontFamily:sc,fontWeight:Pf.d.Normal,fontSize:Xd,italic:!1,underline:Pf.h.None,capitalization:Ce.u8h(0),color:0,styleName:ec,isFollowUp:void 0,languageId:Ce.l8h(ad),
start:0,length:ka.characterData.length}]}Ugn(ka,$a,Db,ec){if(this.qD()){if($a.blob||$a.formatting&&$a.formatting.cache&&$a.formatting.cache.kTb||ec)return!0;if(ka&&Db<ka.length)return ka[Db]}return $a.KU?!0:$a.Uh?!0:!1}qD(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static ill(ka,$a){return!!ka&&!!$a&&ka.start+ka.length===$a.start&&ka.isDeleted===$a.isDeleted&&ka.fontFamily===$a.fontFamily&&ka.fontWeight===
$a.fontWeight&&ka.fontSize===$a.fontSize&&ka.italic===$a.italic&&ka.underline===$a.underline&&ka.capitalization===$a.capitalization&&ka.color===$a.color&&ka.highlightColor===$a.highlightColor&&ka.styleName===$a.styleName&&void 0===ka.link&&void 0===$a.link&&ka.languageId===$a.languageId&&!ka.isReference&&!$a.isReference&&!ka.isFollowUp&&!$a.isFollowUp&&void 0===ka.objectType&&void 0===$a.objectType}Oym(ka){const $a=new cg.GraphIterator;$a.set(ka);$a.zb(11);$a.ld(11);return(ka=this.ig.Nw($a))?Ce.GBl(ka.listType):
Pf.e.NoList}nVo(ka,$a){var Db=pf.ListItemReader.Of?ka:this.ig.Hfa(ka);if(pf.ListItemReader.isListItem(Db)){if(pf.ListItemReader.Of){if(Db=pf.ListItemReader.av(Db))$a.listId=Db.listId.toString()}else Db.hasProperty(na.a.listID)&&($a.listId=Db.getValue(na.a.listID).toString());Db=this.DBi(ka,me.a.font);ka=this.DBi(ka,me.a.fontSize);Db&&($a.bulletAndNumberFontFamily=Db);ka&&($a.bulletAndNumberFontSize=ka)}}isInsideTable(ka){const $a=new cg.GraphIterator;$a.set(ka);return $a.zb(14)}uYo(ka,$a){$a.spacingBeforeParagraph=
this.EHi(ka,na.a.y8,na.a.H0,na.a.wj);$a.spacingAfterParagraph=this.EHi(ka,na.a.x8,na.a.G0,na.a.ta);$a.lineSpacing=this.dQb(ka)}EHi(ka,$a,Db,ec){if(Pa.ParagraphReader.Bj(ka,$a,!1))return 0;$a=Pa.ParagraphReader.Bj(ka,Db,-1);if(0<=$a)return $a*Dd.a.kXb/100;ka=Pa.ParagraphReader.Bj(ka,ec,-1);return 0<=ka?ka/20:0}DBi(ka,$a){ka=this.uqm(ka);if(null!=ka&&null!=ka.cache)return ka.cache.getValue($a)}uqm(ka){var $a;ka=null===($a=ka.qa)||void 0===$a?void 0:$a.last;return null!=ka&&ka.mi?ka.formatting:(a.ULS.sendTraceTag(520680196,
389,50,"EOP for list item does not have any formatting applied."),null)}dQb(ka){const $a=Pa.ParagraphReader.Bj(ka,na.a.ya,Dd.a.ya);ka=Pa.ParagraphReader.Bj(ka,na.a.xa,Dd.a.lineSpacing);switch($a){case 0:return ka/240;case 1:return ka/20;default:return 0}}static kvp(ka,$a,Db){for(let ec=0;ec<$a.length;ec++){const sc=$a.J(ec),ad=sc.nk,Xd=ka.Eb(ad);Xd&&Xd.ja(na.a.yI,!1)&&(Db||(Db=new Ea.a(new Xc.a)),sc.Wc?Db.add(ad):Db.remove(ad))}return Db}static l8h(ka){return(ka=qe.a.Cg(ka))&&ka.name?ka.name.toLowerCase():
void 0}static RKf(ka){return ka?2===ka.unit?Math.floor(Qd.a.zLb(ka.value)/20):Math.floor(ka.value/20):0}static mLm(ka){if(!ka)return Pf.g.Initial;switch(ka.specialIndentType){case 1:return Pf.g.FirstLine;case 2:return Pf.g.Hanging;default:return Pf.g.Initial}}static u8h(ka){switch(ka){case 2:return Pf.c.AllCaps;case 1:return Pf.c.SmallCaps;default:return Pf.c.NoCaps}}static WGf(ka){switch(ka){case 1:return Pf.a.Left;case 3:return Pf.a.Right;case 2:return Pf.a.Center;case 6:return Pf.a.Justified;case 0:return Pf.a.None;
default:return Pf.a.Other}}static GBl(ka){switch(ka){case 15:return Pf.e.Any;case 1:return Pf.e.Bullet;case 42:return Pf.e.Invalid;case 13:return Pf.e.Lim;case 14:return Pf.e.Nil;case 16:return Pf.e.NoList;case 0:return Pf.e.Numbered;default:return Pf.e.Invalid}}static isReference(ka){return ka.blob&&(7===ka.blob.Jh||10===ka.blob.Jh)||ka.Zh&&0<ka.Zh.length||ka.kf&&0<ka.kf.length||ka.Hb&&0<ka.Hb.length?!0:!1}static bPf(ka,$a,Db){return null==$a?null:$a[Db]&&!$a[Db].equals(ma.a.nil)&&ka.Lc?ka.Lc.Eb($a[Db]):
null}rMf(ka){if(null==ka)return null;if(ka.hasProperty(na.a.mt)){var $a=ka.getValue(na.a.mt);if(Ce.utj.has($a))return Ce.utj.get($a)}if(ka.hasProperty(na.a.Xic)&&null!=ka.getValue(na.a.Xic))return Pf.f.FootnoteEndnote;if(ka.hasProperty(na.a.tcb)&&ka.getValue(na.a.tcb))return Pf.f.PageBreak;if(ka.hasProperty(na.a.ITb)&&ka.getValue(na.a.ITb))return Pf.f.Tab;$a=!1;ka.hasProperty(Cd.a.L7)?$a=ka.getValue(Cd.a.L7):ka.hasProperty(na.a.Tla)&&($a=ka.getValue(na.a.Tla));return $a&&ka.hasProperty(na.a.imageType)&&
1==ka.getValue(na.a.imageType)?Pf.f.Image:null}static Yjn(ka){return ka.hasProperty(na.a.bmc)&&0<=ka.getValue(na.a.bmc)?!0:!1}W2i(ka){return Ce.Sep.has(ka)}zai(ka,$a,Db,ec){return null==ka||null==$a?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),null):ec===Pf.b.Inline&&null==Db?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):ec===Pf.b.Floating&&
null!=Db?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>Db?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):Ce.Yjn(ka)?null:this.W2i($a)?{referencedPath:["session","doc","main",ka.id.toString()],formattedRangeIndex:Db,anchorMode:null!==ec&&void 0!==ec?ec:Pf.b.Unspecified,anchoredObjectType:ec==Pf.b.Floating?$a:void 0}:null}$Oh(ka,$a,Db,
ec,sc){$a=this.zai($a,Db,ec,sc);null!=$a&&null!=ka&&ka.push($a)}lgo(ka){const $a=[];if(null==ka)return a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),$a;let Db=null;ka.hasProperty(na.a.D6)&&(Db=ka.getValue(na.a.D6));if(null!=Db)for(let ec=0;ec<Db.length;++ec){const sc=Ce.bPf(ka,Db,ec),ad=this.rMf(sc);null!=ad&&this.$Oh($a,sc,ad,null,Pf.b.Floating)}return $a}d7h(ka){if(null==ka||!ka.hasProperty(me.a.Vn))return!1;const $a=ka.getValue(me.a.Vn);for(let ec=
0;ec<$a.length;ec++){var Db=Ce.bPf(ka,$a,ec);Db=this.rMf(Db);if(this.W2i(Db))return!0}return!1}}Ce.utj=new Map([[5,Pf.f.Image],[11,Pf.f.TextBox],[7,Pf.f.Chart],[6,Pf.f.SmartArt],[10,Pf.f.Drawing],[2,Pf.f.EquationObject],[4,Pf.f.Ink],[19,Pf.f.PageBreak],[23,Pf.f.FootnoteEndnote],[24,Pf.f.FootnoteEndnote],[35,Pf.f.FootnoteEndnoteReferenceMark],[36,Pf.f.FootnoteEndnoteReferenceMark],[0,Pf.f.Other]]);Ce.Sep=new Set([Pf.f.Image,Pf.f.TextBox,Pf.f.Chart,Pf.f.SmartArt,Pf.f.Drawing,Pf.f.Ink]);Object(f.a)(Ce,
"FormattingExtractor",null,[682]);var pc=d(1306);class $c extends Sys.EventArgs{constructor(ka){super();this.Ulc=ka}}Object(f.a)($c,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class id extends Sys.EventArgs{constructor(ka){super();this.zba=ka}}Object(f.a)(id,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class de{constructor(ka,$a,Db){this.ted=ka;this.graphNode=$a;this.fullPath=Db}}Object(f.a)(de,"NodeEvent",null,[697]);class Ae{constructor(){this.XWe=this.DUe=!1;this.jFb=null;this.sa=new ia.a;
this.Wda=new O.a(0);this.yib=new pc.a(Ja.a.th());this.ZFb=new pc.a(Ja.a.th());this.LHd=[]}CPh(ka){this.sa.addHandler("IsCollectingNodeEventsChangedKey",ka)}Irl(){this.Wda=new O.a(0);this.Ulc=!1}get Ulc(){return this.DUe}set Ulc(ka){this.DUe!==ka&&(this.DUe=ka,this.sa.raiseEvent("HasNodeEventsChangedKey",new $c(ka),this))}get zba(){return this.XWe}set zba(ka){this.XWe!==ka&&(this.XWe=ka,this.sa.raiseEvent("IsCollectingNodeEventsChangedKey",new id(ka),this))}j_b(ka,$a){this.yib.mb(ka)||this.yib.Z(ka,
$a)}OKo(ka,$a){this.ZFb.Z(ka,$a)}Ihm(ka){let $a=null;this.ZFb.mb(ka)&&($a=this.ZFb.J(ka),this.ZFb.remove(ka));return $a}Lte(ka,$a){if(ka)if(this.zba){var Db=3!==$a&&4!==$a&&5!==$a||!this.yib.mb(String.format("{0}",ka.id))?rb.a.GL(ka):this.yib.J(String.format("{0}",ka.id));if(({value:ec}=this.Wda.Dc(Db)).returnValue)if(ec||3!==$a)if(5===ec&&3===$a){if(ka=Db.split("\\").pop(),this.ZFb.mb(ka)){var ec=this.ZFb.J(ka);ec===Db?(this.g7f(Db,$a),this.Wda.add(Db,$a)):(this.ZFb.Z(ka,Db),this.yib.Z(ka,ec),this.Laj(Db),
this.Wda.remove(Db),this.g7f(Db,$a),this.Wda.add(ec,5))}}else ec&&(4!==ec||0!==$a&&3!==$a&&5!==$a)&&(this.g7f(Db,$a),this.Wda.add(Db,$a));else this.Laj(Db),this.Wda.remove(Db);else this.mGn(Db,$a),this.LHd.push(ka),this.Wda.add(Db,$a);this.Ulc=0<this.Wda.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,389,15,"node is null.")}mGn(ka,$a){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",
ka,$a)}g7f(ka,$a){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",ka,$a)}Laj(ka){a.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",ka)}Xyl(){let ka=null;var $a=!1;let Db=null;for(;this.LHd.length&&!$a;){Db=Array.dequeue(this.LHd);if(!Db)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),null;this.yib.mb(String.format("{0}",Db.id))?(ka=this.yib.J(String.format("{0}",Db.id)),this.yib.remove(String.format("{0}",
Db.id)),this.LHd.push(Db)):ka=rb.a.GL(Db);$a=this.Wda.mb(ka)}if(!$a)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.Irl(),null;$a=this.Wda.J(ka);this.Wda.remove(ka);this.Ulc=0<this.Wda.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",ka,$a);return new de($a,Db,ka)}Aqo(ka){this.jFb=ka}Zyl(){if(!this.jFb)return null;for(var ka=0;ka<this.jFb.length;ka++){var $a=this.jFb.J(ka);$a=rb.a.GL($a.node);if(this.Wda.mb($a))return null}ka=
this.jFb;this.jFb=null;return ka}bsl(){this.jFb=null}tbp(){this.zba=!0}win(ka){return this.Wda.mb(ka.id.toString())}}Object(f.a)(Ae,"NodeEventsCollection",null,[681]);var gf=d(1547),uf=d(1460),Lf=d(308),hg=d(102);class Vf extends uf.a{constructor(ka,$a,Db,ec,sc,ad,Xd,ue,ae,Te,sf){super();this.yDd=new gf.a;this.jib=!1;this.PGc=null;this.Hma=(kg,qf)=>{(kg=qf.node)&&this.teb(kg)&&(a.ULS.sendTraceTag(40253400,389,100,"New paragraph Connect event."),rb.a.e3o(kg,this.Vpa.zba,this.D4b,this.lMk)&&(this.Vpa.Lte(kg,
0),this.d7j(kg)));this.Vpa.zba&&this.dea.Nvb(kg)};this.Djj=(kg,qf)=>{kg=qf.node;this.Vpa.j_b(String.format("{0}",kg.id),rb.a.GL(kg))};this.XYa=(kg,qf)=>{(kg=qf.node)&&this.teb(kg)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.Vpa.zba&&this.Vpa.Lte(kg,3));this.Vpa.zba&&this.dea.Hmj(kg,3)};this.LN=(kg,qf)=>{kg=qf.node;qf=qf.property;kg&&this.Rnk.has(qf)&&this.teb(kg)&&(a.ULS.sendTraceTag(40253402,389,100,"New paragraph Modified event."),this.Vpa.zba&&(this.Vpa.Lte(kg,
2),qf===na.a.Tj&&this.d7j(kg)));this.Vpa.zba&&qf===na.a.Yc&&this.dea.Hmj(kg,2)};this.Ejj=(kg,qf)=>{(kg=qf.node)&&Pa.ParagraphReader.Xb(kg)&&!this.vGc.has(kg)&&!this.RRe.has(kg)&&(this.vGc.add(kg),this.D0())};this.Jmj=(kg,qf)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(kg=qf.node)&&this.Re.AUn(kg)};this.qcg=()=>{this.wpd()?this.QI():this.jib&&!this.Vpa.zba&&this.eFa()};this.$D=$a;this.Vpa=Db;this.lMk=hg.b(ec.Dwe);this.D4b=ka.$("AugLoopOperationsAreEnabled");this.Re=sc;this.dea=
ad;this.QD=Xd;this.Gb=ue;this.Yn=ae;this.AH=Te;this.vGc=new Set;this.RRe=new Set;sf.Ava(this,7);this.Rnk=new Set([me.a.Un,me.a.bold,me.a.italic,me.a.underline,me.a.font,me.a.fontSize,me.a.fontColor,Ne.a.capitalization,me.a.Rh,me.a.Vn,na.a.y8,na.a.H0,na.a.wj,na.a.x8,na.a.G0,na.a.ta,na.a.ya,na.a.xa,na.a.listID,na.a.IP,na.a.fe,na.a.Qma,na.a.mv,na.a.Tj])}get index(){return 7}get Rfd(){return this.PGc}set Rfd(ka){this.PGc=ka;this.dea.Ggg=ka?()=>{this.PGc()}:null}init(){this.wpd()&&this.QI();this.Vpa.CPh(this.qcg)}QI(){this.$D?
(this.jib=!0,this.$D.Zt(this.Hma),this.$D.DT(this.Djj),this.$D.Bw(this.XYa),this.$D.fo(this.LN),this.$D.jQh(this.Jmj),this.$D.A0k(this.Ejj)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}eFa(){this.$D?(this.jib=!1,this.$D.jV(this.Hma),this.$D.gha(this.Djj),this.$D.hha(this.XYa),this.$D.QN(this.LN),this.$D.XDj(this.Jmj),this.$D.CAo(this.Ejj)):a.ULS.sendTraceTag(39403913,389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}kbe(ka){ka&&
this.yDd.add(ka.id,ka.ja(na.a.Tj,0))}d7j(ka){this.yDd.mb(ka.id)?(this.dea.OAp(aa.a.yAe,ka,this.yDd.J(ka.id)),this.yDd.remove(ka.id)):(this.dea.Trl(aa.a.yAe),this.Rfd&&this.Rfd())}teb(ka){const $a=cc.StaticActiveAppFrame.za().ib.sc;return!!$a&&$a.lw&&!!$a.jd&&!!$a.jd.Lc&&!!ka&&!!ka.Lc&&ka.Lc.id===$a.jd.Lc.id}run(){if(0!==this.vGc.size){var ka=[];for(const $a of this.vGc)ka.push($a),this.RRe.add($a),100<=ka.length&&(this.yki(ka),ka=[]);0<ka.length&&this.yki(ka);this.vGc.clear()}}yki(ka){const $a=new wa.a(4,
1,500,()=>{for(const Db of ka)this.RRe.delete(Db),this.Otp(Db)},158);this.Gb.Zb($a)}Otp(ka){var $a=this.Yn.fWa(ka,0,ec=>this.M4o(ec.intent));if(0<$a.count)for(const ec of $a){$a=this.dea.VHm(ec.intent.id);var Db=ka.gsa;const sc=Pa.ParagraphReader.vU(ka);ec.end<ec.Fc||(Db=Lf.a.WXc(sc,Db,ec.Fc,ec.end-ec.Fc,ec.Fc,ec.end-ec.Fc,ka),this.AH.Yrg(ka.Lc,$a,Db))}}M4o(ka){return!!ka&&this.QD.qtb(ka)&&!!ka.content}wpd(){return!this.jib&&this.Vpa.zba}}Object(f.a)(Vf,"ParagraphNodeEventHandler",uf.a,[463]);var ic=
d(1069),yc=d(417),bd=d(490),sd=d(113);class ie extends bd.a{constructor(){super();this.H_=Object.assign(new sd.a,{T_:ie.getTypeName(),B_:ie.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(f.a)(ie,"DeltaUpdateOperation",bd.a,[]);var We=d(416);class Pe{constructor(){this.referencedPath=null}}Object(f.a)(Pe,"ItemReference",null,[]);class Re extends We.a{constructor(){super();this.op=this.deltas=this.delta=
this.parentPath=null}}Object(f.a)(Re,"ItemWithPath",We.a,[]);var Sf=d(1059);class vg extends Sf.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new sd.a,{T_:vg.getTypeName(),B_:vg.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(f.a)(vg,"MoveOperation",Sf.a,[]);var Yg=d(479);class ph extends Yg.a{constructor(){super();this.selectedRanges=null;this.H_=
Object.assign(new sd.a,{T_:ph.getTypeName(),B_:ph.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(f.a)(ph,"SelectionSignal",Yg.a,[]);class Di extends ph{constructor(){super();this.content=null;this.H_=Object.assign(new sd.a,{T_:Di.getTypeName(),B_:Di.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal","AugLoop_Signals_Signal"]}}
Object(f.a)(Di,"SelectionContentSignal",ph,[]);class bj{constructor(){this.range=this.tileReference=null}}Object(f.a)(bj,"TextTileRange",null,[]);var gi=d(1769),Zg=d(396),Bb=d(37),Nb=d(17);class Bc{constructor(ka,$a,Db,ec,sc,ad,Xd,ue){this._augLoopRuntimeManager=this.EBd=null;this.b9e=!1;this.lqa=this.u_e=this.mMd=null;this.veh=2E3;this.p$l=()=>{if(P.App.SU||yc.SessionStatusManager.instance&&yc.SessionStatusManager.instance.Ko)Zc.a.getAugLoopRuntimeManager().closeSession(),a.ULS.sendTraceTag(512623445,
389,15,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Gb.vf(this.EBd);this.jj.Yd(()=>{var ae;const Te=pb.a.instance.Tka;this.qD()&&this.XEo();for(this.NQc.reset();this.O3a.Ulc&&!this.NQc.cvb();){let qf;qf=this.O3a.Xyl();if(!qf||!qf.graphNode){a.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.NQc.update();continue}if(!this.L2o(qf)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",
qf.graphNode.id);this.NQc.update();continue}const fh=qf.graphNode.id.toString();var sf=-1,kg=!0;Te&&Nb.SelectionEditor.mf(Te)&&fh==Te.node.id.toString()&&(sf=Te.cpBegin,kg=!1);let Fi=null;if(this.UHb.contains(fh))switch(qf.ted){case 3:this.UHb.remove(fh);Fi=3;break;default:Fi=qf.ted}else switch(qf.ted){case 0:case 1:this.UHb.add(fh);Fi=0;break;case 2:this.UHb.add(fh);Fi=0;break;case 3:this.UHb.remove(fh);Fi=3;break;default:Fi=qf.ted}if(null!=Fi){sf=this.BDi(qf.graphNode,qf.fullPath,Fi,sf,kg);if(4==
Fi||5==Fi){if(sf.prevParentPath.join()!==sf.parentPath.join()){kg=Object.assign(new ta.a,{parentPath:sf.prevParentPath,items:sf.items});const Nj=Object.assign(new ya.a,{parentPath:sf.parentPath,items:sf.items,prevId:sf.prevId,nextId:sf.nextId});fh!==sf.prevId&&fh!==sf.nextId||a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",Fi,fh,sf.prevId,sf.nextId,qf.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new Zg.a,
{operation:kg}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Zg.a,{operation:Nj}));14===qf.graphNode.type&&this.zLj(qf.graphNode,sf.parentPath).forEach(Zh=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new Zg.a,{operation:Zh}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new Zg.a,{operation:sf}));if(this.wxd&&this.lqa&&this.lqa[0]==fh)switch(Fi){case 3:this.lqa=null;break;case 0:case 1:case 2:case 4:case 5:this.lqa[1]=null===(ae=this.aGb.kQb(qf.graphNode))||
void 0===ae?void 0:ae.C2c(qf.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",oa.a.getTypeNameFor(sf),fh);switch(Fi){case 0:case 4:case 5:this.Re.w3n(qf.graphNode);break;case 3:this.Re.x3n(qf.graphNode,sf.parentPath.join("\\"))}}this.NQc.update()}(ae=this.O3a.Zyl())&&this.zFj(ae)},"TV:FPEFO")};this.bva=(ae,Te)=>{var sf;if(Te.Gm&&Te.Gm.length){if(this.wxd)if(ae=rb.a.JBm(Te.Gm),!ae)this.lqa=null;else if(!this.lqa||this.lqa[0]!=
ae.id.toString()){const kg=this.O3a.win(ae)?null:null===(sf=this.aGb.kQb(ae))||void 0===sf?void 0:sf.C2c(ae);this.lqa=[ae.id.toString(),kg]}this.b9e&&this.O3a.Aqo(Te.Gm.currentSelection)}};this.Ga=ka;this.O3a=$a;this.Gb=Db;this.NQc=ec;this.vok=this.Ga.$("AugLoopOperationsAreEnabled");this.UHb=new Ea.a(Ja.a.th());this.Re=sc;this.jj=ad;this.aGb=Xd;this.hb=ue;this.wxd=this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.hb.Cw(this.bva);rb.a.Pl().then(()=>{this._augLoopRuntimeManager=
Zc.a.getAugLoopRuntimeManager();this.Ga.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new gi.a,{handler:ae=>{this.Re.B5k(ae)}}));this.vok&&this.O3a.tbp();this.ocp()}).catch(()=>{});this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.IncreasedIntervalForDelayedCritiquesIsEnabled",!1)&&(this.veh=5E3)}XEo(){const ka=this.Re.cGc.entries();for(let $a=0;$a<this.Re.cGc.size;$a++){const Db=ka.next();y.AFrameworkApplication.Ld("gi204158;ef1e2812");
Date.now()-Db.value[1].time>=this.veh&&this.Re.z5c(Db.value[1].annotation,!0,ya.a.getTypeName(),!1)}}L2o(ka){return 3===ka.ted||rb.a.ETj(ka.graphNode)}ocp(){!this.EBd&&this.O3a.zba&&(this.EBd=new wa.a(4,2,this.Ga.ic("NodeEventsFiringInterval",500),this.p$l,131),this.Gb.Zb(this.EBd))}zLj(ka,$a){var Db,ec=[];const sc=cg.GraphIterator.eb(ka),ad=sc.Dq();for(var Xd=0;Xd<ad;Xd++){let ue=sc.WG(Xd);11===ue.type&&(ue=Bb.OutlineElementNavigator.Le(sc));const ae=ue.id.toString(),Te=null===(Db=this.aGb.kQb(ue))||
void 0===Db?void 0:Db.kMb(ue);ec.push(Object.assign(new We.a,{body:Te,id:ae,revId:rb.a.lPf(ue)}));sc.ld(ka.type)}$a.push(ka.id.toString());Db=[];Db.push(Object.assign(new ya.a,{parentPath:$a.slice(),items:ec,prevId:null}));for(ec=0;ec<ad;ec++)Xd=sc.WG(ec),11===Xd.type&&(Xd=Bb.OutlineElementNavigator.Le(sc)),0<sc.Dq()&&(Db=Db.concat(this.zLj(Xd,$a))),sc.ld(ka.type);$a.pop();return Db}kWa(ka){return ka.split("\\").slice(0,-1)}BDi(ka,$a,Db,ec=-1,sc=!0){var ad;let Xd=null,ue=null;const ae=ka.id.toString();
var Te=null;3!==Db&&(Te=rb.a.zhl(ka));if(Te)for(let sf=0;sf<Te.length;sf++)if(Te[sf]===ae){ue=sf+1<Te.length?Te[sf+1]:null;Xd=sf?Te[sf-1]:null;break}ae!==Xd&&ae!==ue||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",Db,ae,Xd,ue,ka.type);Te=null===(ad=this.aGb.kQb(ka))||void 0===ad?void 0:ad.kMb(ka,ec,sc);ec=[Object.assign(new We.a,{body:Te,id:ae,revId:rb.a.lPf(ka)})];switch(Db){case 0:case 1:return Object.assign(new ya.a,
{parentPath:this.kWa($a),items:ec,prevId:Xd,nextId:ue});case 4:return Object.assign(new vg,{parentPath:this.kWa(rb.a.GL(ka)),prevParentPath:this.kWa($a),items:ec,prevId:Xd,nextId:ue});case 5:return Db=this.O3a.Ihm(ae),Object.assign(new vg,{parentPath:this.kWa(null!==Db&&void 0!==Db?Db:rb.a.GL(ka)),prevParentPath:this.kWa($a),items:ec,prevId:Xd,nextId:ue});case 2:return Object.assign(new Aa.a,{parentPath:this.kWa($a),items:ec});case 3:return Object.assign(new ta.a,{parentPath:this.kWa($a),items:ec});
default:return a.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",Db,ae),Object.assign(new Sf.a,{parentPath:this.kWa($a),items:ec,prevId:Xd,nextId:ue})}}$Om(ka){return this.lqa&&this.lqa[0]===ka?this.lqa[1]:null}oPo(ka){var $a;if(!this.wxd)return a.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!rb.a.ETj(ka))return!1;const Db=ka.id.toString();var ec=this.UHb.contains(Db)?2:0;ec=this.BDi(ka,rb.a.GL(ka),ec);this._augLoopRuntimeManager.submitOperation(Object.assign(new Zg.a,
{operation:ec}));this.UHb.add(Db);this.lqa=[Db,null===($a=this.aGb.kQb(ka))||void 0===$a?void 0:$a.C2c(ka)];return!0}fOo(ka,$a){var Db;if(this.wxd){var ec=ka.id.toString(),sc=this.kWa(rb.a.GL(ka));$a=[Object.assign(new Re,{id:ec,revId:rb.a.lPf(ka),parentPath:sc,delta:$a})];sc=Object.assign(new ie,{parentPath:sc,items:$a});this._augLoopRuntimeManager.submitOperation(Object.assign(new Zg.a,{operation:sc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",ec);this.lqa=[ec,null===
(Db=this.aGb.kQb(ka))||void 0===Db?void 0:Db.C2c(ka)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}e$k(ka,$a){if(ka.tileReference.referencedPath.length!==$a.tileReference.referencedPath.length||ka.range.start!==$a.range.start||ka.range.length!==$a.range.length||ka.range.isInsertionPoint!==$a.range.isInsertionPoint)return!1;for(let Db=0;Db<ka.tileReference.referencedPath.length;Db++)if(ka.tileReference.referencedPath[Db]!==$a.tileReference.referencedPath[Db])return!1;
return!0}$9k(ka,$a){if(ka.selectedRanges.length!==$a.selectedRanges.length||ka.content!==$a.content)return!1;for(let Db=0;Db<ka.selectedRanges.length;Db++)if(!this.e$k(ka.selectedRanges[Db],$a.selectedRanges[Db]))return!1;return!0}zFj(ka){ka=this.getSelection(ka);if(!this.u_e||!this.$9k(ka,this.u_e)){var $a=this.mMd?this.mMd:ma.a.create().toString(),Db=[Object.assign(new We.a,{body:ka,id:$a})];this.mMd?$a=Object.assign(new Aa.a,{parentPath:["session","doc"],items:Db}):(this.mMd=$a,$a=Object.assign(new ya.a,
{parentPath:["session","doc"],items:Db}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Zg.a,{operation:$a}));this.u_e=ka}}getSelection(ka){var $a;if(!ka)return null;const Db=new nb.a;let ec="";for(let Xd=0;Xd<ka.length;Xd++){var sc=ka.J(Xd),ad=(null===($a=this.aGb.kQb(sc.node))||void 0===$a?void 0:$a.kMb(sc.node)).content;ec+=ad;ad=sc.cpBegin<ad.length?sc.cpBegin:-1;ad=Object.assign(new ja.a,{start:ad,length:sc.cpEnd-sc.cpBegin});Object.assign(ad,{isInsertionPoint:Nb.SelectionEditor.mf(sc)||
Nb.SelectionEditor.gl(sc)});const ue=sc.node.id.toString();sc=this.kWa(rb.a.GL(sc.node));sc.push(ue);Db.add(Object.assign(new bj,{range:ad,tileReference:Object.assign(new Pe,{referencedPath:sc})}))}return Object.assign(new Di,{selectedRanges:Db.toArray(),content:ec})}mYo(ka){(this.b9e=ka)?this.kug():this.O3a.bsl()}kug(){this.zFj(this.hb.gb.currentSelection)}CR(){return this.getSelection(this.hb.gb.currentSelection)}qD(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1)}}Object(f.a)(Bc,"TileView",null,[465]);var td=d(43),Je=d(39);class Ef{constructor(ka){Je.a.assign(Ef,this,ka)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(ka){return Je.a.matchesTypesFor(ka,[Ef.getTypeName()])}}Ef.H_={T_:Ef.getTypeName(),B_:Ef.getBaseTypes()};class Ih{constructor(ka){Je.a.assign(Ih,this,ka)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(ka){return Je.a.matchesTypesFor(ka,
[Ih.getTypeName()])}}Ih.H_={T_:Ih.getTypeName(),B_:Ih.getBaseTypes()};class tg{constructor(ka){Je.a.assign(tg,this,ka)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(ka){return Je.a.matchesTypesFor(ka,[tg.getTypeName()])}}tg.H_={T_:tg.getTypeName(),B_:tg.getBaseTypes()};class Dh{constructor(ka){Je.a.assign(Dh,this,ka)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(ka){return Je.a.matchesTypesFor(ka,
[Dh.getTypeName()])}}Dh.H_={T_:Dh.getTypeName(),B_:Dh.getBaseTypes()};class Jh{constructor(ka){Je.a.assign(Jh,this,ka)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable","AugLoop_Table_Table"]}static typeGuard(ka){return Je.a.matchesTypesFor(ka,[Jh.getTypeName()])}}Jh.H_={T_:Jh.getTypeName(),B_:Jh.getBaseTypes()};var Xh;(function(ka){ka[ka.Top=0]="Top";ka[ka.Center=1]="Center";ka[ka.Bottom=2]="Bottom"})(Xh||(Xh={}));var Mf;(function(ka){ka[ka.none=
0]="none";ka[ka.firstRow=32]="firstRow";ka[ka.lastRow=64]="lastRow";ka[ka.firstCol=128]="firstCol";ka[ka.lastCol=256]="lastCol";ka[ka.Icq=512]="noHBand";ka[ka.Rcq=1024]="noVBand";ka[ka.nwCell=160]="nwCell";ka[ka.neCell=288]="neCell";ka[ka.swCell=192]="swCell";ka[ka.seCell=320]="seCell";ka[ka.oOl=1184]="defaultLook"})(Mf||(Mf={}));Object(f.b)("TableLookFlags",Mf);class Jg{kMb(ka){if(ka)switch(ka.type){case 14:return this.yKl(ka);case 15:return new Ef;case 16:return this.xKl(ka)}else a.ULS.sendTraceTag(524149331,
389,10,"ConvertNodeToTile: Node can't be null.")}yKl(ka){var $a=ka.WH||[];let Db=0;for(let ec=0;ec<$a.length;ec++)Db+=$a[ec];$a=$a.map((ec,sc)=>({columnId:sc.toString(),widthPercent:0!=Db?100*ec/Db:0}));return new Dh({columnDefs:$a,tableLook:ka.properties.ja(na.a.tableLook,Mf.oOl),complexTable:ka.properties.ja(na.a.complexTable,!1),floatingTable:ka.properties.ja(na.a.KYi,!1)})}xKl(ka){return new Ih({rowspan:ka.properties.ja(na.a.rowSpan,1),colspan:ka.properties.ja(na.a.colSpan,1),borderInfo:{topBorder:{color:ka.properties.ja(na.a.s1b,
0),size:ka.properties.ja(na.a.mzc,4),style:ka.properties.ja(na.a.zzb,"single")},leftBorder:{color:ka.properties.ja(na.a.q1b,0),size:ka.properties.ja(na.a.kzc,4),style:ka.properties.ja(na.a.xzb,"single")},rightBorder:{color:ka.properties.ja(na.a.r1b,0),size:ka.properties.ja(na.a.lzc,4),style:ka.properties.ja(na.a.yzb,"single")},bottomBorder:{color:ka.properties.ja(na.a.p1b,0),size:ka.properties.ja(na.a.jzc,4),style:ka.properties.ja(na.a.wzb,"single")}},verticalAlignment:ka.properties.ja(na.a.TOa,Xh.Top),
ghostCell:ka.properties.ja(na.a.ghostCell,!1),renderCell:ka.properties.ja(na.a.renderCell,!1),skippedCell:ka.properties.ja(na.a.skippedCell,!1),fillColor:ka.properties.ja(me.a.MJ,0),verticalMerge:ka.properties.ja(td.a.vMerge,null)})}C2c(ka){return null===ka||void 0===ka?void 0:ka.properties}}Object(f.a)(Jg,"TableElementNodeToTileConverter",null,[464]);class ug{constructor(ka,$a,Db){this.xo=$a;this.LEa=Db;this.d2d=!1;this.PGc=null;this.Koj=(ec,sc)=>{this.PDa(sc.node,0)};this.Goj=(ec,sc)=>{ec=sc.node;
this.LEa.j_b(ec.id.toString(),rb.a.GL(ec))};this.Loj=(ec,sc)=>{this.PDa(sc.node,3)};this.woe=(ec,sc)=>{this.PDa(sc.node,2)};this.Noj=(ec,sc)=>{this.PDa(sc.node,0)};this.Ooj=(ec,sc)=>{this.PDa(sc.node,3)};this.Moj=(ec,sc)=>{ec=sc.node;this.LEa.j_b(ec.id.toString(),rb.a.GL(ec))};this.xoe=(ec,sc)=>{this.PDa(sc.node,2)};this.Ioj=(ec,sc)=>{this.PDa(sc.node,0)};this.Hoj=(ec,sc)=>{ec=sc.node;this.LEa.j_b(ec.id.toString(),rb.a.GL(ec))};this.Joj=(ec,sc)=>{this.PDa(sc.node,3)};this.uoe=(ec,sc)=>{var ad;ec=
sc.node;if(sc.property===na.a.ghostCell){if(sc=ec.Wg?ec:null===(ad=ec.XCa)||void 0===ad?void 0:ad.ZO){ad=cg.GraphIterator.eb(sc);var Xd=ad.Dq();for(var ue=0;ue<Xd;ue++){ad.WG(ue);var ae=Bb.OutlineElementNavigator.Le(ad);this.LEa.j_b(ae.id.toString(),String.format("{0}\\{1}",rb.a.GL(sc),ae.id));this.PDa(ae,4);ad.ld(16)}}}else if(sc.property===me.a.wg){sc=cg.GraphIterator.eb(ec);ad=sc.Dq();let Te=null;Xd=[];for(ue=0;ue<ad;ue++){sc.WG(ue);ae=Bb.OutlineElementNavigator.Le(sc);this.LEa.OKo(ae.id.toString(),
String.format("{0}\\{1}",rb.a.GL(ec),ae.id));if(14!==ae.type){if(Te=rb.a.GL(ae))this.LEa.j_b(ae.id.toString(),Te),this.PDa(ae,5)}else Xd.push(ae);sc.ld(16)}Te&&Xd.forEach(sf=>{this.LEa.j_b(sf.id.toString(),String.format("{0}\\{1}",Te.split("\\").slice(0,-1).join("\\"),sf.id));this.PDa(sf,5)})}this.PDa(ec,2)};this.qcg=()=>{this.wpd()?this.QI():this.d2d&&!this.LEa.zba&&this.eFa()};this.D4b=ka.$("AugLoopOperationsAreEnabled")}get Rfd(){return this.PGc}init(){this.wpd()&&this.QI();this.LEa.CPh(this.qcg)}QI(){const {s_j:ka,
nCe:$a,g_j:Db}=this.ayi();if(ka&&$a&&Db){this.d2d=!0;var ec=this.Goj,sc=this.Loj,ad=this.woe;ka.Zt(this.Koj);ka.DT(ec);ka.Bw(sc);ka.fo(ad);ec=this.Moj;sc=this.Ooj;ad=this.xoe;$a.Zt(this.Noj);$a.DT(ec);$a.Bw(sc);$a.fo(ad);ec=this.Hoj;sc=this.Joj;ad=this.uoe;Db.Zt(this.Ioj);Db.DT(ec);Db.Bw(sc);Db.fo(ad)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}eFa(){const {s_j:ka,nCe:$a,g_j:Db}=this.ayi();if(ka&&$a&&Db){this.d2d=!1;var ec=this.Goj,sc=
this.Loj,ad=this.woe;ka.jV(this.Koj);ka.gha(ec);ka.hha(sc);ka.QN(ad);ec=this.Moj;sc=this.Ooj;ad=this.xoe;$a.jV(this.Noj);$a.gha(ec);$a.hha(sc);$a.QN(ad);ec=this.Hoj;sc=this.Joj;ad=this.uoe;Db.jV(this.Ioj);Db.gha(ec);Db.hha(sc);Db.QN(ad)}else a.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}PDa(ka,$a){ka&&this.teb(ka)&&this.LEa.zba&&this.D4b&&this.LEa.Lte(ka,$a)}ayi(){return{s_j:this.xo.Ve(14),nCe:this.xo.Ve(15),g_j:this.xo.Ve(16)}}teb(ka){const $a=
cc.StaticActiveAppFrame.za().ib.sc;return!!$a&&$a.lw&&!!$a.jd&&!!$a.jd.Lc&&!!ka&&!!ka.Lc&&ka.Lc.id===$a.jd.Lc.id}wpd(){return!this.d2d&&!!this.LEa.zba}}Object(f.a)(ug,"TableNodeEventHandler",null,[463]);class ze{constructor(ka,$a){this.Krj=ka;this.zgp=$a}kQb(ka){return ka?14===ka.type||15===ka.type||16===ka.type?this.zgp:12===ka.type?this.Krj:null:null}}Object(f.a)(ze,"NodeToTileConverterHolder",null,[462]);var pi=d(362);class og{get name(){return"Box4.AugmentationLoop"}wc(ka){this.W=ka;const $a=
this.W.resolve("Common.IAppSettingsManager"),Db=$a.$("AugLoopTaskUseTimeBasedYieldStrategy"),ec=new Ae,sc=Db?new Z.a($a.ic("AugLoopTaskAllowedRunTimeBeforeYielding",10),D.a.Ee):new T($a.ic("AugLoopTaskNodesToRunBeforeYielding",10));this.W.ia("Common.ICpuMeter",()=>U.a.instance).ha();this.W.ia("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new vb).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").ha();this.W.ia("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new Vf($a,P.App.jf.Il.Ve(12),
ec,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),y.AFrameworkApplication.mc,this.W.resolve("Box4.Intent.IIntentRangeEditor"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").ha();
rb.a.hze()&&this.W.ia("Box4.AugmentationLoop.TableNodeEventHandler",()=>new ug($a,P.App.jf.Il,ec)).ha();this.W.ia("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new Y).ha();this.W.ia("Box4.AugmentationLoop.IFormattingExtractor",()=>new Ce(this.W.resolve("Common.IAppSettingsManager"),this.W.Oa("Box4.IFeatureHelper"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).ha();this.W.ia("Box4.AugmentationLoop.IAnnotationPolicies",
()=>new aa.a(new Q.a(()=>cc.StaticActiveAppFrame.za().ib.$c.td),this.W.resolve("Box4.Intent.IIntentRangeEditor"))).ha();this.W.ia("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new Qb(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),new Q.a(()=>cc.StaticActiveAppFrame.za().ib.$c.td),ka.resolve("Box4.IFeatureHelper"))).ha();const ad=this.W.resolve("IRoamingDictionary");
this.W.ia("Box4.AugmentationLoop.IAnnotationStorage",()=>new Ua(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.Intent.IIntentRangeEditor"),new Q.a(()=>cc.StaticActiveAppFrame.za().ib.$c.td),y.AFrameworkApplication.mc,this.W.Oa("Box4.IIntelligenceReader"),this.W.Oa("Box4.IIntelligenceEditor"),this.W.Oa("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.Oa("Box4.AugmentationLoop.IPersistedAnnotationStorage"),ka.resolve("Box4.IFeatureHelper"),pi.a.instance,
()=>{try{return Zc.a.getAugLoopRuntimeManager()}catch(Xd){return a.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Xd),null}},ad)).ha();this.W.ia("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new ze(new ic.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new Jg)).ha();this.W.ia("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",()=>new Bc($a,ec,y.AFrameworkApplication.mc,
sc,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.W.resolve("Box4.ISelectionManager"))).ha();a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ia("Box4.AugmentationLoop.IUtilsWrapper",()=>new wd).ha();this.W.ia("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new kb).ha()}init(){if(y.AFrameworkApplication.QH.BootFailed)a.ULS.sendTraceTag(512624089,
389,15,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(y.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const ka=new Gc(this.W.resolve("Common.IAppSettingsManager"),y.AFrameworkApplication.Be,P.App.bda,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),S.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),$a=new X;this.W.register(452,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").ha().mCp(()=>
$a);y.AFrameworkApplication.Ld("b8afb343;bjdjj400");y.AFrameworkApplication.Ld("72af9564;82jf1647");const Db=rb.a.Lzn(this.W.resolve("Common.IDynamicScriptLoaderProvider").xC,this.W.resolve("Common.App.OAuth.IOAuthManager"),ka,this.W.resolve("Common.ISharedDependencyLoader"),$a);this.W.ia("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new Oc(Db)).ha();this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();rb.a.hze()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();
this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(ka){x.a.instance.Jc(new og,0,ka);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(f.a)(og,"Box4AugmentationLoopPackage",null,[0,1]);var Jk=d(651),zk=d(44),Xf=d(11),Gg=d(445),Lg=d(1227);class ak{constructor(ka,$a,Db,ec=null,sc=null,ad=null){this.$O=new Lg.a($a,ec,sc,ad);this.Jb=
ka;this.Wc=Db}get type(){return this.$O.type}get id(){return this.$O.id}get intent(){return this.$O.intent}Bf(ka){return new ak(ka,this.type,this.Wc,this.id,this.intent,this.$O.iDa)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.$O,this.Wc)}}Object(f.a)(ak,"IntentObject",null,[186]);var Rf=d(513),Bg=d(163),bk=d(270);class Kk{constructor(){this.CHc=new Bg.a}kRd(ka,$a,Db,ec,sc=null,ad=null,Xd=null){ka=ka.F_($a,ka.qa.qop($a));ka.xk||(ka.xk=new Rf.a(ka));ka.xk.add(new ak(ka,Db,ec,
sc,ad,Xd));ka.cab=!0}yCj(ka){return ka.Jb&&ka.Jb.xk&&ka.Jb.xk.Ykd($a=>$a===ka,[ka.type])?!0:!1}zCj(ka,$a){if(ka.type===$a.type&&ka.Wc&&!$a.Wc&&ka.Jb&&ka.Jb.xk&&ka.Jb.xk.contains(ka)&&$a.Jb&&$a.Jb.xk&&$a.Jb.xk.contains($a)){var Db=[ka.type];ka.Jb.xk.Ykd(ec=>ec===ka,Db);$a.Jb.xk.Ykd(ec=>ec===$a,Db)}}fDp(ka,$a,Db){if(!$a)return!1;Db=new Za.a([Db]);for(let ec=0;ec<ka.length;ec++){const sc=ka.J(ec);if(!sc.xk)continue;let ad=!0;Db.O0a(sc.xk,void 0,Xd=>{Xd.id&&$a.equals(Xd.id)&&(ad=!1)});if(!ad)return!1}return!0}teo(ka,
$a,Db,ec){let sc=null,ad=null;$a=new Za.a([$a]);const Xd=ka.qa;for(let ue=0;ue<Xd.length;ue++){const ae=Xd.J(ue);if(!ae.xk)continue;let Te=!0;$a.O0a(ae.xk,void 0,(sf,kg)=>{if(kg){var qf=kg.Jb.cp<Db,fh=sf.Jb.cp>ec;qf&&sf.Jb.cp<=Db||kg.Jb.cp>=ec&&fh||(qf&&fh?Te=!1:qf?sc=sf:fh?ad=kg:this.zCj(kg,sf))}});if(!Te)return!1}if(sc){if(!this.yCj(sc))return!1;this.kRd(ka,Db,sc.type,sc.Wc,sc.id,sc.intent,sc.$O.iDa)}if(ad){if(!this.yCj(ad))return!1;this.kRd(ka,ec,ad.type,ad.Wc,ad.id,ad.intent,ad.$O.iDa)}return!0}vCg(ka){let $a;
return y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:$a}=this.CHc.Dc(ka.type,$a)).returnValue?$a.vCg(ka):!0}KIn(ka,$a){if(this.vCg($a)){var Db=$a.id,ec=$a.type,sc=$a.Fc,ad=$a.end;if(({cpEnd:ad}=Kk.iak(ka,sc,ad)).returnValue){if(Gg.a(ec)){if(!this.fDp(ka.qa,Db,ec))return}else if(!this.teo(ka,ec,sc,ad))return;this.kRd(ka,sc,ec,!0,Db,$a.intent,$a.$O.iDa);this.kRd(ka,ad,ec,!1,Db,$a.intent,$a.$O.iDa)}}}shd(ka,$a){cc.StaticActiveAppFrame.za().dBf(ka,
()=>{const Db=new zk.GraphTransaction(2);try{Db.Ab(ka);const ec=ka.a1();try{const sc=ka.X2();try{$a()}finally{sc&&sc.dispose()}}finally{ec&&ec.dispose()}}finally{Db&&Db.dispose()}})}vMa(ka,$a){this.shd(ka,()=>{this.KIn(ka,$a)})}MIn(ka,$a){if($a.count){var Db=new ib.a,ec=new bk.a;for(var sc of $a){var ad=sc.value;Gg.a(sc.key)||ad.Sc((ue,ae)=>ue.Fc!==ae.Fc?ue.Fc-ae.Fc:ue.end-ae.end);if(Kk.kDp(ad))for(var Xd of ad)ad=Xd.end,({cpEnd:ad}=Kk.iak(ka,Xd.Fc,ad)).returnValue&&(ad=ad!==Xd.end?new yb.a(Xd.type,
Xd.Fc,ad,Xd.id,Xd.intent,Xd.$O.iDa):Xd,Db.add(ad.Fc),Db.add(ad.end),Kk.nXk(ec,ad))}ka.B1d(Db);ka=ka.qa;for(Db=0;Db<ka.length;Db++){sc=ka.J(Db);if(Xd=sc.xk)for(const ae of $a.keys)Xd.sDj(ae);let ue;({value:ue}=ec.Dc(sc.cp,ue)).returnValue||(ue=null);if(ue){Xd||(Xd=sc.xk=new Rf.a(sc));for(const ae of ue)Xd.add(ae.Bf(sc))}sc.cab=!0}}}l8f(ka,$a){const Db=new Bg.a;for(const ec of $a){let sc;({value:sc}=Db.Dc(ec.type,sc)).returnValue||(sc=new nb.a,Db.Z(ec.type,sc));sc.add(ec)}this.shd(ka,()=>{this.MIn(ka,
Db)})}Xrp(ka,$a,Db){ka=ka.qa;const ec=new Za.a([8]);$a===Db&&(Db+=1);for(let sc=0;sc<ka.length;sc++){const ad=ka.J(sc);ad.xk&&ec.O0a(ad.xk,void 0,(Xd,ue)=>{ue&&Math.max(ue.Jb.cp,$a)<Math.min(Xd.Jb.cp,Db)&&this.zCj(ue,Xd)})}}lLg(ka,$a,Db){this.shd(ka,()=>{this.Xrp(ka,$a,Db)})}Zrp(ka,$a){ka=ka.qa;for(let Db=0;Db<ka.length;Db++){const ec=ka.J(Db);ec.xk&&ec.xk.sDj($a)}}G0a(ka,$a){this.shd(ka,()=>{this.Zrp(ka,$a)})}Yrp(ka,$a,Db){let ec=!1;$a=$a.qa;Db=[Db];for(let sc=0;sc<$a.length;sc++){const ad=$a.J(sc);
ad.xk&&(ec=ad.xk.Ykd(ka,Db)||ec)}return ec}jtd(ka,$a,Db){let ec=!1;this.shd($a,()=>{ec=this.Yrp(ka,$a,Db)});return ec}qkc(ka,$a,Db,ec){return!ka||0>Db||ec>ka.characterData.length||Db>ec?new nb.a:this.fWa(ka,$a,sc=>Math.max(sc.Fc,Db)<=Math.min(sc.end,ec))}fWa(ka,$a,Db){return Kk.Owm(ka,$a,Db)}static Owm(ka,$a,Db){const ec=new nb.a;ka=ka.qa;$a=new Za.a([$a]);if(!ka)return ec;for(let sc=0;sc<ka.length;sc++){const ad=ka.J(sc);ad.xk&&$a.O0a(ad.xk,void 0,(Xd,ue)=>{ue&&(Xd=new yb.a(ue.type,ue.Jb.cp,Xd.Jb.cp,
ue.id,ue.intent,ue.$O.iDa),Db(Xd)&&ec.add(Xd))})}return ec}G3c(ka,$a){const Db=new nb.a;if(!Kk.utn(ka.contextId))return Db;let ec;const sc=ka.node;ka.contextId!==Xf.a.paragraph?(ec=ka.cpBegin,ka=ka.cpEnd):(ec=0,ka=sc.characterData.length);Db.addRange(this.qkc(sc,$a,ec,ka));return Db}wuo(ka){this.CHc.mb(0)||this.CHc.Z(0,ka)}static iak(ka,$a,Db){ka=Pa.ParagraphReader.textLength(ka);if($a>=ka)return{returnValue:!1,cpEnd:Db};Db>ka&&(Db=ka);return{returnValue:!0,cpEnd:Db}}static kDp(ka){if(!ka.count)return!0;
const $a=new Jk.a,Db=ka.J(0).type,ec=Gg.a(Db);let sc=-1;for(const ad of ka){if(ad.type!==Db||(Gg.c(ad.type)?ad.Fc>ad.end:ad.Fc>=ad.end))return!1;if(ec){ka=ad.id;if(!ka||ka.equals(ma.a.nil)||$a.contains(ka))return!1;$a.add(ka)}else if(-1===sc)sc=ad.end;else if(sc>ad.Fc)return!1}return!0}static nXk(ka,$a){let Db;({value:Db}=ka.Dc($a.Fc,Db)).returnValue||(Db=new nb.a,ka.Z($a.Fc,Db));Db.add(new ak(null,$a.type,!0,$a.id,$a.intent,$a.$O.iDa));({value:Db}=ka.Dc($a.end,Db)).returnValue||(Db=new nb.a,ka.Z($a.end,
Db));Db.add(new ak(null,$a.type,!1,$a.id,$a.intent,$a.$O.iDa))}static utn(ka){return ka===Xf.a.Bd||ka===Xf.a.Xc||ka===Xf.a.paragraph}}Object(f.a)(Kk,"IntentRangeEditor",null,[468]);class Pi{constructor(){this.W=null}get name(){return"Box4.Intent"}wc(ka){this.W=ka;this.W.ia("Box4.Intent.IntentRangeEditor",()=>new Kk).as("Box4.Intent.IIntentRangeEditor").ha()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(ka){x.a.instance.Jc(new Pi,0,ka);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}
Object(f.a)(Pi,"PackageManager",null,[0,1]);var Uj=d(1113),jk=d(122),Bj=d(1462);class Vj{constructor(ka){this.ZGn=ka;this.VGn=[]}get handler(){return this.ZGn}get ssa(){return this.VGn}}Object(f.a)(Vj,"RegisteredListener",null,[]);class Cl{constructor(ka,$a){this.type=0;this.payload=null;this.type=ka;this.payload=$a}}Object(f.a)(Cl,"OfficeSharedCommentsEvent",null,[1434]);class ah{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(f.a)(ah,"ViewContainerEvent",
null,[1434]);var zh=d(628);class Ql{constructor(ka){this.G7f=!1;this.sua=new nb.a;this.xje=ka}Qto(ka){ka=new Vj(ka);this.sua.add(ka)}u5j(ka){for(let $a=0;$a<this.sua.count;++$a)if(this.sua.J($a).handler===ka){this.sua.removeAt($a);break}}o_a(ka=!1){const $a=()=>{if(y.AFrameworkApplication.ol)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let sc=0;sc<this.sua.count;++sc){const ad=this.sua.J(sc);for(;0<ad.ssa.length;){var Db=Array.dequeue(ad.ssa);
if(Object(jk.a)(ah,Db)){var ec=ad.handler;ec(Db)}else Object(jk.a)(Cl,Db)&&(ec=ad.handler,ec(Db.type,Db.payload))}}};ka?$a():this.G7f||(this.G7f=!0,zh.a.z6(this.xje,()=>{$a();this.G7f=!1},Bj.a.$am))}}Object(f.a)(Ql,"GenericEventHost",null,[]);class al{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=
this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(f.a)(al,"BasicEventPayload",null,[1457]);class ji{constructor(ka){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ka}}Object(f.a)(ji,"CommentContextDetails",null,[]);class kh{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=
null}}Object(f.a)(kh,"ContextChangeWithSelectedThreadIndex",null,[1457]);class bh{constructor(){this.tasks=this.comments=null}}Object(f.a)(bh,"LoadCommentsNoVirtualization",null,[1457]);class hj extends Ql{constructor(ka){super(ka);this.YCh=0}yXo(){this.YCh=1656}Duo(ka,$a,Db,ec,sc,ad){ka=new Vj(ka);ad&&Array.enqueue(ka.ssa,this.XDl(ad,this.YCh));ad=$a?$a.length:0;Array.enqueue(ka.ssa,this.V9h(ad,Db,ec,0));ad&&Array.enqueue(ka.ssa,this.bai($a,sc));this.sua.add(ka);this.o_a()}n2b(ka){this.u5j(ka)}$No(ka,
$a,Db,ec=0){this.hSb(this.V9h(ka,$a,Db,ec));this.o_a()}aOo(ka,$a,Db){this.hSb(this.wEl(ka,$a,Db));this.o_a()}yOo(ka,$a){this.hSb(this.bai(ka,$a));this.o_a()}selectComment(ka){this.hSb(this.bbi(ka,6));this.o_a()}highlightComment(ka){this.hSb(this.bbi(ka,7));this.o_a()}zMg(ka,$a){this.hSb(this.RHl(ka,$a));this.o_a()}Jlg(ka,$a){this.hSb(this.$Jl(ka,$a));this.o_a()}XDl(ka,$a=0){const Db=new al;Db.modelCapabilityFlags=ka;Db.richTextCapabilityFlags=$a;return new Cl(12,Db)}V9h(ka,$a,Db,ec){const sc=new al;
sc.numberOfComments=ka;sc.numberOfThreads=$a;sc.contextDetails=Object.assign(new ji(Db),{nextPopulatedContextDetails:ec});sc.contextDrafts=null;sc.rehydrationDrafts=null;return new Cl(0,sc)}wEl(ka,$a,Db){const ec=new al;ec.comments=ka;ec.numberOfThreads=$a;ec.tasks=Db;return new Cl(2,ec)}bai(ka,$a){const Db=new bh;Db.comments=ka;Db.tasks=$a;return new Cl(1,Db)}bbi(ka,$a){const Db=new al;Db.commentId="";ka&&(Db.commentId=ka);return new Cl($a,Db)}RHl(ka,$a){const Db=new al;Db.changes=[];Db.contextDetails=
Object.assign(new ji($a),{nextPopulatedContextDetails:ka});return new Cl(10,Db)}$Jl(ka,$a){const Db=new al;Db.commentId=ka;Db.smartReplies=$a;return new Cl(15,Db)}hSb(ka){for(let $a=0;$a<this.sua.count;++$a)Array.enqueue(this.sua.J($a).ssa,ka)}}Object(f.a)(hj,"OfficeSharedCommentsEventHost",Ql,[1445]);var uj=d(249),wg=d(185),Ni=d(291);class Md{constructor(){this.O8e=this.x8g=!1;this.h6=this.vq=this.bnh=this.Eth=this.VPd=this.b$b=this.GHh=this.ech=this.xC=this.IPc=null}initialize(ka,$a,Db,ec=null,
sc=null,ad=null,Xd=null,ue=null,ae=null,Te=null){this.xC=ka;this.ech=$a;this.GHh=Db;this.b$b=ec;this.VPd=sc;this.Eth=ad;this.bnh=Xd;this.vq=ue;this.x8g=!0;this.h6=ae;this.IPc=Te}xce(ka=null,$a=null){if(!this.x8g)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((Db,ec)=>{ec(zh.a.wF(-2130915313))});if(this.O8e)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),
new Promise(()=>{});this.IPc||(y.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.IPc=appResourceLoader.loadChunk("sharedComments"):this.IPc=this.xC.loadScript("sharedComments"));return this.IPc.then(()=>{ka&&ka();this.O8e||(this.h6&&this.h6.execute(Db=>{Db.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),$a&&$a(),sharedComments.instantiate(this.ech,this.GHh,this.b$b,this.VPd,this.Eth,this.bnh,this.vq));this.O8e=!0})}}Object(f.a)(Md,
"CommentActivationManager",null,[1488]);class nf extends Ql{constructor(ka){super(ka)}swo(ka){this.Qto(ka)}Rsp(ka){this.u5j(ka)}GQj(ka){ka=this.tEl(ka);for(let $a=0;$a<this.sua.count;++$a)Array.enqueue(this.sua.J($a).ssa,ka);this.o_a(!0)}tEl(ka){const $a=new ah;$a.eventType=3;$a.viewContainerVisibilityState=ka;return $a}ybm(){const ka=this.gLl();for(let $a=0;$a<this.sua.count;++$a)Array.enqueue(this.sua.J($a).ssa,ka);this.o_a(!0)}gLl(){const ka=new ah;ka.eventType=2;return ka}}Object(f.a)(nf,"ViewContainerEventHost",
Ql,[1417]);class bn{constructor(){this.actionBehavior=this.actionType=0}}Object(f.a)(bn,"CommentUIActionPayload",null,[]);var Wi=d(322);class ee{constructor(ka,$a){this.mMh=(Db,ec,sc,ad,Xd)=>{if(this.aDc.mb(Db)){var ue=this.aDc.J(Db);if(!this.eBb.mb(ue))return 8;const ae=this.eBb.J(ue);if(ae.preCallback){const Te=ae.preCallback(Db,ec,sc,ad,Xd);if(2!==Te)return Te}if(!ae.registeredCallback)return 1===sc?8:2;ue=Object.assign(new bn,{actionType:ue});1===sc&&(ue.actionBehavior=1);ue=ae.registeredCallback(ue);
return ae.postCallback?ae.postCallback(ue,Db,ec,sc,ad,Xd):ue?32:8}return 2};this.ga=ka;this.eBb=$a;this.aDc=new Wi.a;for(const Db of this.eBb)this.aDc.Z(Db.value.canvasActionId,Db.key),ka=Db.value,ka.delayActionsUntilRegistration||this.ra(ka)}ra(ka){ka.withFlags?this.ga.fb(ka.canvasActionId,ka.canvasContextId,this.mMh,97):this.ga.ra(ka.canvasActionId,ka.canvasContextId,this.mMh)}OZa(ka,$a){this.eBb.mb(ka)&&(this.eBb.J(ka).delayActionsUntilRegistration&&this.ra(this.eBb.J(ka)),this.eBb.J(ka).registeredCallback=
$a)}}Object(f.a)(ee,"OfficeSharedCommentsActionHost",null,[1447]);var qd=d(1935),Il=d(73),Vg=d(140),oi=d(1536),Ah=d(12),ag=d(27),Cg=d(590),Sg=d(1232),ui=d(71),ck=d(326),Zf=d(52),ij=d(18),mj=d(1130),Jl=d(1122),Xi=d(1652),Sh=d(184),Vk=d(10),nj=d(38),dk=d(757),mm=d(441),Ai=d(15),nm=d(2175);class rm{constructor(ka){this.mZ=ka;this.Xtc=new O.a;this.j$a=new O.a;this.k7m();this.G0m=[new nm.a(nj.a.h5h,nj.a.Tvl),new nm.a(nj.a.WWd,nj.a.Svl),new nm.a(nj.a.$4h,nj.a.Gvl),new nm.a(nj.a.QWd,nj.a.Fvl),new nm.a(nj.a.i5h,
nj.a.Vvl),new nm.a(nj.a.XWd,nj.a.Uvl)]}TZa(ka){this.mZ.TZa(ka);this.Exo(ka)}K_f(ka,$a){return!!ka&&!!ka.objectId&&$a.contains(ma.a.Cf(ka.objectId))}TXa(ka){ka=Object(qb.a)(670,ka);return!!ka&&!!ka.objectId}Exo(ka){for(const $a of this.G0m)ka.classList.remove($a.className,$a.v5c);ka.classList.remove(nj.a.hlg,nj.a.ZWd,nj.a.zqf,nj.a.YWd,rm.hRg)}k7m(){const ka=new O.a,$a=new O.a;ka.add(0,null);ka.add(1,nj.a.WWd);ka.add(2,nj.a.h5h);ka.add(3,nj.a.ZWd);$a.add(0,null);$a.add(1,nj.a.QWd);$a.add(2,nj.a.$4h);
$a.add(3,nj.a.zqf);this.j$a.Z(1,ka);this.j$a.Z(2,$a);this.j$a.Z(3,$a);this.Xtc.add(0,null);this.Xtc.add(1,nj.a.XWd);this.Xtc.add(2,nj.a.i5h);this.Xtc.add(3,nj.a.YWd)}}rm.hRg="CommentImportant";Object(f.a)(rm,"CommentHighlightUtils",null,[]);class qi{constructor(){this.a1d=0;this.SLb=null}}Object(f.a)(qi,"CommentGuidsInElementInfo",null,[]);class Yi{constructor(){this.NNi=!1;this.xra=this.ZWb=null;this.tZa=this.BRb=0}}Object(f.a)(Yi,"HighlightInfoForElement",null,[]);class Zl{constructor(){this.qRi=
this.sRi=this.rRi=-1;this.lPi=[];this.ifc=[];this.z7c=this.A7c=-1;this.BWi=!1}}Object(f.a)(Zl,"HighlightInfoForElementsInPara",null,[]);class Qi{constructor(){this.hLg=this.lgg=null}}Object(f.a)(Qi,"OnAnchorMouseOutData",null,[]);var Oh=d(1570);class hb{constructor(ka,$a,Db,ec,sc,ad,Xd,ue){this.XNe=ka;this.xda=$a;this.Wl=Db;this.G5=ec;this.ga=sc;this.Gb=ad;this.Hj=Xd;this.U3a=this.Gj=null;this.XVn=ae=>{if(!this.Gj||this.G5.Nee)return!0;if(ae=ae.Mq){if(this.Gj.iB&&ae[0].toString()===this.Gj.iB.objectId)return!0;
this.U3a&&ae[0].equals(this.U3a.hLg[0])?this.Gb.vf(this.U3a.lgg):(this.U3a&&(this.Gb.vf(this.U3a.lgg),this.ga.Pb(Ah.a.$Wd,2,this.U3a.hLg)),this.Gj.Ip.CWi(ae[0])&&!this.Hj.kn||this.ga.Pb(Ah.a.Cqf,2,ae));this.U3a=null}return!0};this.WVn=ae=>{if(this.G5.Nee)return!0;const Te=ae.Mq;Te&&(ae=new wa.a(2,1,0,()=>{this.ga.Pb(Ah.a.$Wd,2,Te);this.U3a=null}),this.Gb.Zb(ae),this.U3a=Object.assign(new Qi,{lgg:ae,hLg:Te}));return!0};this.fkj=ae=>{const Te=new wa.a(2,1,0,()=>{if(this.Gj&&!this.Gj.Ip.hz){var sf=ae.Mq;
if(!sf)sf=cc.StaticActiveAppFrame.za().sq.currentScope,this.Gj.iB&&(!sf||sf.name!==Sh.AFrame.jP&&sf.name!==Sh.AFrame.Us)&&this.Gj.clearSelection();else if(!this.Gj.iB||sf.toString()!==this.Gj.iB.objectId)if(sf=this.Gj.Ip.e3(sf.toString()))sf=Object.assign(new oi.a,{commentId:sf.id,sS:!1,Gca:1}),this.ga.Pb(Ai.a.selectComment,2,sf)}});this.Gb.Zb(Te);return!1};ue.execute(ae=>{this.Gj=ae})}$Xh(ka,$a,Db,ec){const sc=new Zl,ad=[],Xd=this.xda.TXa($a)?$a.objectId:null;for(let Te=0,sf=ka.length;Te<sf;Te++){var ue=
ka[Te],ae=Oh.g(ue);const kg=Oh.d(ue);ue=new Jk.a;const qf=new Yi;if(ae){const fh=new mm.a(Oh.c);ae=this.foi(ae,Xd,fh);0<ae.length&&(this.Cwp(ae,Db,ue,qf,Xd,ec),ad.push(Object.assign(new qi,{a1d:Te,SLb:fh})))}kg&&(ae=this.foi(kg,Xd),0<ae.length&&(this.Ewp(ae,Db,ue,qf,sc,Xd,ec,Te),this.Rup(ad,ae,Te,qf)));0<Db.count&&this.Fwp($a,Db,qf,ec);this.Pup(ad,qf);sc.lPi.push(qf)}return sc}vTh(ka,$a,Db){let ec=!1;for(let sc=0,ad=ka.length;sc<ad;sc++){const Xd=ka[sc],ue=$a.lPi[sc],ae=dk.a(Xd);if(1!==ae&&2!==ae&&
3!==ae)continue;const Te=3===ae||2===ae&&-1!==Xd.className.indexOf(nj.a.SWa);this.xda.TZa(Xd);this.rYk(Xd,ue,Te,ec);this.$Wk(Xd,sc,ae,ue,$a,Db);this.aXk(Xd,sc,$a,ue);ec=Te}}foi(ka,$a,Db=null){const ec=[];for(let sc=0;sc<ka.length;sc++)this.XNe.dSj(ka[sc],ka[sc].toString()===$a)&&(ec.push(ka[sc]),Db&&Db.add(ka[sc]));return ec}Cwp(ka,$a,Db,ec,sc,ad){var Xd;let ue=!1,ae=!1;for(const sf of ka){$a.add(sf);Db.add(sf);var Te=sf.toString();Te===sc?(Te=ad?1:2,ec.tZa=Te,ec.BRb=Te):this.K_f(this.Gj.iB,$a)&&
(Te===(null===(Xd=this.Gj.iB)||void 0===Xd?void 0:Xd.objectId)&&(ae=!0),ue=!0)}0<ka.length&&!ec.tZa&&(ec.tZa=ae?1:3,ec.BRb=ue?1:3)}Ewp(ka,$a,Db,ec,sc,ad,Xd,ue){var ae,Te;const sf=new mm.a(Oh.c);Xd=Xd?1:2;let kg=!1;for(const qf of ka){const fh=qf.toString();$a.contains(qf)||(fh===ad?sc.qRi=ue:(sc.rRi=ue,ec.tZa=3,(null===(ae=this.Gj.iB)||void 0===ae?void 0:ae.objectId)===fh&&(sc.sRi=ue,ec.tZa=1)),sf.add(qf));fh===(null===(Te=this.Gj.iB)||void 0===Te?void 0:Te.objectId)&&(kg=!0);$a.remove(qf);Db.contains(qf)&&
this.Dwp(ec,qf,fh,ad,Xd);fh===ad&&(ec.tZa=Xd)}0<ka.length&&!ec.tZa&&(ec.tZa=kg?1:3);0<sf.count&&sc.ifc.push(Object.assign(new qi,{a1d:ue,SLb:sf}))}Rup(ka,$a,Db,ec){0!==ka.length&&($a.forEach(sc=>{for(let ad=ka.length-1;0<=ad;ad--){const Xd=ka[ad];if(Xd.SLb.contains(sc)){Xd.a1d===Db&&(ec.xra?ec.xra.push(sc):ec.xra=[sc]);Xd.SLb.remove(sc);break}}}),ka=ka.filter(sc=>0<sc.SLb.count))}Fwp(ka,$a,Db,ec){var sc,ad;this.K_f(ka,$a)?Db.BRb=ec?1:2:Db.BRb||(Db.BRb=null!=(null===(sc=this.Gj.iB)||void 0===sc?void 0:
sc.objectId)&&$a.contains(ma.a.Cf(null===(ad=this.Gj.iB)||void 0===ad?void 0:ad.objectId))?1:3);Db.ZWb||(Db.ZWb=[]);for(const Xd of $a)Db.ZWb.push(Xd)}Pup(ka,$a){if(0<ka.length){$a.xra||($a.xra=[]);for(const Db of ka[ka.length-1].SLb)$a.xra.push(Db)}}Dwp(ka,$a,Db,ec,sc){ka.NNi=!0;ka.ZWb||(ka.ZWb=[]);ka.ZWb.push($a);Db===ec&&(ka.BRb=sc)}K_f(ka,$a){return!!ka&&!!ka.objectId&&$a.contains(ma.a.Cf(ka.objectId))}rYk(ka,$a,Db,ec){!$a.tZa||Db||ec||((Db=this.xda.Xtc.J($a.tZa))&&ka.classList.add(Db),$a.NNi&&
ka.classList.add(nj.a.hlg))}$Wk(ka,$a,Db,ec,sc,ad){ec=this.xda.j$a.J(Db).J(ec.BRb);$a<sc.qRi?ec=ad?this.xda.j$a.J(Db).J(1):this.xda.j$a.J(Db).J(2):$a<sc.rRi&&!ec&&(ec=$a<sc.sRi?this.xda.j$a.J(Db).J(1):this.xda.j$a.J(Db).J(3));ec&&($a=sc.BWi,ka.classList.add(ec),$a&&ka.classList.add(rm.hRg))}aXk(ka,$a,Db,ec){ec.xra||(ec.xra=this.pmm($a,Db)||ec.ZWb);$a=null;ec.xra&&0<ec.xra.length&&(this.Wl.nb(Vk.a.X3,ka,this.XVn,ec.xra),this.Wl.nb(Vk.a.YCa,ka,this.WVn,ec.xra),$a=ec.xra[0]);this.Wl.nb(Vk.a.click,ka,
this.fkj,$a);this.Wl.nb(Vk.a.rM,ka,this.fkj,$a)}pmm(ka,$a){for(;0<$a.ifc.length&&$a.ifc[0].a1d===ka;)$a.ifc.splice(0,1);if(0<$a.ifc.length){ka=[];for(const Db of $a.ifc[0].SLb)ka.push(Db);return ka}return null}}Object(f.a)(hb,"AllMarkupModeHighlightChangeHandler",null,[664]);var wc=d(1542);class cd extends wc.a{constructor(ka){super(100,25);this.ZCc=new O.a(0);this.bnk=6E4;this.Vam=()=>{const $a=this.ZCc.keys;if($a.length){var Db="";for(let ec=0;ec<$a.length;ec++)Db+=$a.J(ec)+":"+this.ZCc.J($a.J(ec))+
";";this.fva(Db);this.ZCc=new O.a(0)}};this.oBb=new nb.a;this.oBb.add(1);this.oBb.add(6);this.oBb.add(2);this.oBb.add(4);this.oBb.add(10);this.oBb.add(11);this.Ri=ka;ka.Cqg&&window.setInterval(this.Vam,this.bnk)}INa(ka){this.Ri.Hqp&&this.Ri.Cqg&&(this.oBb.contains(ka)?this.Coo(ka):this.fva(ka+""))}Coo(ka){this.ZCc.Z(ka,this.ZCc.l3(ka,0)+1)}}Object(f.a)(cd,"CommentActionInTypingRecorder",wc.a,[675]);var Rd=d(1690),cf=d(250);class Ge{static Vyo(ka){ka&&ka.atmention&&delete ka.atmention.isCurrentUser;
return ka}}Object(f.a)(Ge,"DeltaFormatHelpers",null,[]);class Wg{constructor(){this.optional=this.attributes=null}}Object(f.a)(Wg,"Operation",null,[]);class ge extends Wg{constructor(){super();this.insert=null}}Object(f.a)(ge,"DeltaOperation",Wg,[]);class oj{constructor(){this.ops=null}}Object(f.a)(oj,"Delta",null,[]);var uh=d(123),Pj=d(1166),eh=d(771),xf=d(498),gh=d(179),Ue=d(157),gb=d(56),Mb=d(86),hc=d(108),Kc=d(530),Vc=d(63),od=d(1276),Od=d(1757);class Ld extends Od.ACommentFormatTranslator{constructor(ka,
$a,Db){super(ka,Db);this.xe=$a}dJg(ka){const $a=new Rd.a;for(let Db=0;Db<ka.length;Db++){const ec=ka[Db];ec.LSb=!0;this.M6k($a,ec);$a.Ila("\n")}return[$a.Ujc()]}wkp(ka,$a){ka=Rd.a.Iqb(ka[0]);ka=this.Ouj(ka);const Db=new nb.a;let ec=0,sc=null,ad=null;for(;ec<ka.ops.length;){const Xd=ka.ops[ec];sc||(sc=od.a.instance.createInstance(Vc.a.paragraphNode),sc.LSb=!0,sc.Kg(na.a.Yc,cf.a.VF()),$a(sc),sc.qa.clear(),sc.Dva(""));"\n"===Xd.insert?(ad=this.C5f(sc,ad),this.ZZo(sc),Db.add(sc),sc=null):ad=this.VAn(sc,
Xd,ad);ec++}return Db.toArray()}pkp(ka){ka=Rd.a.Iqb(ka[0]);ka=this.Ouj(ka);let $a=0;const Db=new Pj.a(new eh.a);for(;$a<ka.ops.length;){var ec=ka.ops[$a];if("\n"===ec.insert)ec={2:"para"},ec[na.a.Yc.toString()]=cf.a.VF(),Db.ASc(new Pj.b("para_"+$a,new xf.a(Db.getLength()),new eh.b(ec)));else{const sc=this.DIm(ec.attributes);Db.pD(new xf.a(Db.getLength()),ec.insert,new eh.b(sc))}$a++}return Db}ZZo(ka){const $a=ka.QZh();for(let Db=0;Db<$a;Db++)ka.qe.Kq.Z(Db,Ld.dQn),ka.qe.Nt.Z(Db,Ld.Ubg)}C5f(ka,$a){var Db=
ka.A1d();Db.cp===ka.characterData.length?Db.mi=!0:(Db=Object.assign(new gh.a(ka,ka.characterData.length),{mi:!0}),ka.qa.add(Db));Db=ka.qa.last;if($a){$a=!!$a.dw;const ec=this.F6h(ka,Db,!$a,$a,null);Db.formatting=ec;$a&&(ka=this.D6h(ka,Db),Db.tX=ka.Dk);Db.vn=!0;$a=null}Db.cp||Db.formatting||(Db.formatting=new Ue.a(Db,ma.a.nil));return $a}VAn(ka,$a,Db){const ec=ka.A1d(),sc=!!$a.attributes&&!!$a.attributes.link,ad=!!$a.attributes&&!!$a.attributes.atmention,Xd=this.F6h(ka,ec,sc,ad,$a);ec.formatting=Xd;
Db&&(Db.dw&&(Db=this.D6h(ka,ec),ec.tX=Db.Dk),ec.vn=!0,Db=null);if(sc||ad)this.qAn(ec,ka,$a),Db=ec.hyperlink;ka.Dva(ka.characterData+$a.insert);return Db}D6h(ka,$a){$a=new Ue.a($a,ma.a.create());let Db=this.YYd();Db.setValue(na.a.FTb,!0);Db=ka.Lc.QP(Db);$a.Dk=Db.id;return $a}F6h(ka,$a,Db,ec,sc){$a=new Ue.a($a,ma.a.create());let ad=od.a.instance.createInstance(Vc.a.H_a);if(Db||ec)ad.setValue(me.a.sD,!0),ad.setValue(me.a.O7,!0),Db&&this.xRo(ka,ad);sc&&sc.attributes&&this.zXo(sc.attributes,ad);ad=ka.Lc.QP(ad);
$a.Dk=ad.id;return $a}xRo(ka,$a){(ka=this.xe.EF(ka))&&(ka=ka.gh(gb.StyleReader.PBc))&&$a.setValue(Ne.a.Gw,ka.id)}zXo(ka,$a){this.S_b(ka.weight>=Rd.a.Idd,$a,me.a.bold,!0);this.S_b(ka.italic,$a,me.a.italic,!0);this.S_b(ka.underline,$a,me.a.underline,!0);this.S_b(ka.underline,$a,me.a.underlineType,Jd.a.fAb);this.S_b(ka.strikethrough,$a,me.a.strikethrough,!0);if(Mb.a.OTb(ka.highlight)){var Db=Mb.a.eta(ka.highlight);this.S_b(!!ka.highlight,$a,me.a.highlight,Mb.a.T0(Db))}Mb.a.OTb(ka.color)&&(Db=Mb.a.eta(ka.color),
this.S_b(!!ka.color,$a,me.a.fontColor,Mb.a.T0(Db)))}DIm(ka){const $a={};if(ka){ka.weight>=Rd.a.Idd&&($a["1436"]="1",$a["1438"]="1");ka.italic&&($a["1440"]="1",$a["1442"]="1");ka.underline&&($a["1484"]="single");ka.strikethrough&&($a["1448"]="1");if(Mb.a.OTb(ka.highlight)&&ka.highlight){const Db=Mb.a.eta(ka.highlight);$a["1482"]=Mb.a.T0(Db)}Mb.a.OTb(ka.color)&&ka.color&&(ka=Mb.a.eta(ka.color),$a["1466"]=Mb.a.T0(ka))}return $a}S_b(ka,$a,Db,ec){ka&&$a.setValue(Db,ec)}qAn(ka,$a,Db){if(Db.attributes&&
Db.attributes.atmention){var ec=hc.a.VKa(Db.attributes.atmention.email);Db=Db.optional&&Db.optional.atmention&&Db.optional.atmention.contentId?Db.optional.atmention.contentId:Ld.Sem(1===Db.attributes.atmention.resolveState);ec=new Kc.a(ka,ec,!0,void 0,void 0,void 0,Db);this.lDl(ec,$a.Lc);ka.hyperlink=ec}else $a=hc.a.VKa(Db.attributes.link),ec=this.jGl(ka.paragraph.qa.first),ka.hyperlink=new Kc.a(ka,$a,!1,ec.Dk)}jGl(ka){let $a=this.Sai();$a=ka.paragraph.Lc.QP($a);ka=new Ue.a(ka,ma.a.nil);ka.Dk=$a.id;
return ka}lDl(ka,$a){var Db=String.format(' HYPERLINK "{0}"',ka.url),ec=ka.dw;const sc=this.YYd();sc.setValue(na.a.mt,15);sc.setValue(na.a.dw,ec);sc.setValue(na.a.QXa,!0);sc.setValue(na.a.G_,Db);ka.fza($a.QP(sc).id);ec=this.YYd();ec.setValue(na.a.mt,47);ec.setValue(na.a.G_,Db);ka.fza($a.QP(ec).id);Db=this.YYd();Db.setValue(na.a.mt,16);ka.fza($a.QP(Db).id)}Sai(){const ka=od.a.instance.createInstance(Vc.a.H_a);ka.setValue(me.a.sD,!0);ka.setValue(me.a.O7,!0);ka.setValue(me.a.isHidden,!0);return ka}YYd(){const ka=
this.Sai();ka.setValue(me.a.ada,!0);return ka}Ouj(ka){const $a=new nb.a;for(let Db=0;Db<ka.ops.length;Db++){const ec=ka.ops[Db];ec.optional=Ge.Vyo(ec.optional);if(-1!==ec.insert.indexOf("\n")&&"\n"!==ec.insert){const sc=ec.insert.split("\n");for(let ad=0;ad<sc.length;ad++)if(Db!==ka.ops.length-1||ad!==sc.length-1||sc[ad])$a.add(Object.assign(new ge,{insert:sc[ad],attributes:ec.attributes,optional:ec.optional})),ad!==sc.length-1&&$a.add(Object.assign(new ge,{insert:"\n"}))}else $a.add(ec)}return Object.assign(new oj,
{ops:$a.toArray()})}static Sem(ka){return Od.ACommentFormatTranslator.U$k+uh.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(ka?"Z":"")}}Ld.dQn=0;Ld.Ubg=0;Object(f.a)(Ld,"CommentDeltaFormatTranslator",Od.ACommentFormatTranslator,[]);var Af=d(1776),Tb=d(1654);class Dg{get userPrincipalName(){return this.K.kb("UserPrincipalName")}constructor(ka,$a,Db,ec,sc){this.zj=ka;this.K=$a;this.XH=Db;this.Tg=ec;this.zY=sc}DF(ka){return this.zj.DF(ka)}Afn(ka){ka=this.zj.DF(ka);return ka?!ka.done:
(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}l9c(ka){return this.zj.l9c(ka)}isCurrentUserMentioned(ka){var $a,Db;ka=this.zj.emm(ka);for(const ec of ka){if(!ec.text||0===ec.text.length)continue;ka=Rd.a.Iqb(ec.text[0]);let sc=0;for(;ka.ops&&sc<ka.ops.length;){const ad=null===(Db=null===($a=ka.ops[sc])||void 0===$a?void 0:$a.attributes)||void 0===Db?void 0:Db.atmention;if(ad&&ad.email===this.userPrincipalName)return!0;sc++}}return!1}qfd(){this.XH.m4("OnContentFilterUpdate")}Wha(){var ka;
this.Tg.kn&&(null===(ka=this.zY)||void 0===ka?void 0:ka.execute($a=>$a.logActivity("WordWebCommentFilterActivity","CommentFilterFpsIsEnabled")))}}Object(f.a)(Dg,"CommentFilterActor",null,[674]);var Kh=d(112),rg=d(2170),ai=d(962),kl=d(642);class Fe{constructor(ka,$a,Db,ec,sc,ad,Xd,ue,ae){this.ti=ka;this.Gb=$a;this.jj=Db;this.u1a=ec;this.Hj=sc;this.A1=ad;this.Hh=Xd;this.JW=ue;this.aQ=ae;this.DDb=null;this.Qaf=0;this.EFd=!1;this.XJd=0;this.w2b=this.cqd=this.hbh=this.bKc=this.xJb=!1;this.iBc=()=>{this.JW.YCg()&&
this.Hh.iBc(this.EFd,this.Whg)};this.uvb=()=>{this.Hh.Mqa.Ota()&&(this.mkd(this.Hh.Mqa.sc),this.Hh.Mqa.uvc(this.uvb))};this.Whg=()=>{this.Jfb();this.JW.Vhg()};this.RFg=()=>{!this.xJb&&this.JW.lCg()&&(this.XJd=this.Scf.scrollTop,this.xJb=!0,this.u1a.INa(2))};this.Oqg=(Te,sf)=>{this.xJb&&(Te=this.Scf.scrollTop,Te-this.XJd?(this.bKc||sf.zGe||this.updatePosition(),this.bKc||1!==sf.zGe||this.Jfb(),this.vhf(Te),this.JW.Qgg()):this.bKc=this.xJb=!1)};this.Scf=this.Hh.cia;this.Tma=kl.a.kpe;this.ru=this.Hh.ru;
this.Hh.t6h()}get oee(){return this.JW.V0f()}get Tma(){return this.Hh.Tma}set Tma(ka){this.Hh.Tma=ka}get mUh(){return"1"===this.ru.hH.style.opacity}qRj(ka){this.cqd||(this.cqd=!0,this.Hh.huj(),this.DDb=ka(this.ru.Fla,this.Hh.hDj,()=>{this.updatePosition()}),this.Hh.N$i(this.DDb),this.JW.initialize(this.DDb,this),this.Hh.initialize(this.DDb,this.JW.wvb),this.Hh.HAj(),this.Hh.kRj(),this.Hh.lRj(),this.Hh.pRj(this.JW.Tkf,this.JW.coe,this.JW.boe),this.yrg())}Zod(){}cze(){return this.Hh.hSj()}setInitialActiveContainerId(ka,
$a,Db=null){this.Hh.setInitialActiveContainerId(ka,0,Db)}updatePosition(){if(!this.w2b&&this.oee&&this.ti.PBa()){var ka=D.a.Ee()-this.Qaf<kl.a.O8j;ka||this.EFd||this.Jfb(ka)}}Vjf(){this.Jfb()}p_a(ka,$a,Db){this.aQ.dpb&&this.A1.m4("OnFloatingCommentsVisibilityChange",!0);this.Hh.p_a(ka,$a,Db)}IJa(ka,$a,Db=!1){this.Hh.IJa(ka,$a,()=>{this.ti.U5c()||this.Hh.Mae();this.JW.Weg()},Db)}ucc(ka,$a,Db){this.Hh.ucc(ka,$a,Db,this.Hh.Ui,this.JW.Y3c,this.JW.Bdg)}Gsj(ka){this.w2b=!0;ka();this.w2b=!1}nld(ka,$a,Db){this.Hh.nld(ka,
$a,Db)}Vec(){this.Hh.Vec()}l9j(){const ka="1"===this.ru.hH.style.opacity;switch(!0){case ka&&!this.ti.U5c():this.Hh.Mae();break;case !ka&&this.ti.U5c():this.Hh.O0b()}}qJg(ka=!0){this.JW.SCg&&this.Hh.y1j(ka)}static xxi(ka,$a=null){const Db=new ub.a;for(const ec of ka)ec.Mf||ec.Nr!==rg.a.dE&&(!$a||$a(ec))&&Fe.LVk(Db,ec.objectId,ec);return Db}static LVk(ka,$a,Db){let ec;({value:ec}=ka.Dc($a,ec)).returnValue||(ec=[],ka.Z($a,ec));ec.push(Db)}mkd(ka){ka&&(ka.A6(()=>{this.iBc()}),this.XJd=this.Scf.scrollTop,
ka.wQh(this.RFg),ka.xQh(this.Oqg))}yrg(){this.Hh.Ui?this.mkd(this.Hh.Ui):this.Hh.Mqa?this.Hh.Mqa.Mcc(this.uvb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}vhf(ka){this.ru.hH.style.top=ka-this.XJd+"px";this.bKc=!1}Jfb(ka=!1){ka=new wa.a(0,1,0,()=>{this.Tyf()},129,void 0,!ka);this.Gb.Zb(ka);this.EFd=!0;this.bKc=this.xJb;this.u1a.INa(10)}VMf(ka){return this.Hh.MUa({contentAnchorPositions:ka.contentAnchorPositions})}Tyf(){this.EFd=!1;if(this.ru.Fla&&
this.DDb&&this.ti.PBa()){this.Hh.P1d();var ka=0;this.jj.Yd(()=>{ka=this.Hh.u6d()},"FCM:UP:GET");var $a=null,Db=null;this.jj.Yd(()=>{const ec=this.JW.Vvi(ka,this.Hh.Ui);$a=ec.Fwl;Db=this.VMf(ec)},"FCM:UP:GP");this.jj.Yd(()=>{this.xJb?(this.Hh.Eji(Db),this.xJb=!1):this.DDb.emitEvent(3,Db);this.A1.pte()},"FCM:UP:RC");this.DDb.setFirstCommentRenderDone();"0"===this.ru.hH.style.opacity&&0<$a.count&&!this.Hj.kn&&this.Hj.zOa&&this.jj.Yd(()=>{this.Hh.O0b()},"FCM:UP:SFC");!this.hbh&&0<$a.count&&(zh.a.z6(this.Gb,
this.Hh.kaj,Bj.a.jaj),this.hbh=!0);this.Qaf=D.a.Ee();this.u1a.INa(6)}else this.Qaf=D.a.Ee()}}Object(f.a)(Fe,"FloatingCommentManager",null,[8,655]);var vh=d(131),te=d(1543),jj;(function(ka){ka[ka.Ukq=0]="singleHint";ka[ka.ccq=1]="multiHint";ka[ka.eiq=2]="resolvedHint";ka[ka.dcq=3]="multiResolvedHint";ka[ka.entryPoint=4]="entryPoint";ka[ka.unknown=void 0]="unknown"})(jj||(jj={}));Object(f.b)("CommentIconType",jj);var ek=d(142),pg=d(1225);const Ak={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",
[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[jj.unknown]:""},Ri={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter","OfficeIconColors_mCommentMultiHintIconBorder"],[2]:["OfficeIconColors_mCommentResolvedHintIconCenter","OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter",
"OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[jj.unknown]:[]},wi=(ka,$a)=>{switch(ka){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch($a){case 3:return pg.a.o5h;case 2:return pg.a.p5h;case 1:return pg.a.q5h}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch($a){case 3:return pg.a.l5h;
case 2:return pg.a.m5h;case 1:return pg.a.n5h}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch($a){case 3:return pg.a.r5h;case 2:return pg.a.s5h;case 1:return pg.a.t5h}}},Bk=(ka,$a)=>{ek.a("renderIcon")&&appChrome.api.renderIcon(ka,$a)};class Ph{}Ph.nPi=16;Ph.U0m=1;Ph.WUf=20;Ph.Pck=2;Object(f.a)(Ph,"CommentIconConstants",null,[]);class po{constructor(){this.RWd=0;this.ATc=!1}}Object(f.a)(po,"CommentHintCensus",null,[]);class Lh{constructor(ka,
$a,Db,ec,sc){this.ich=ka;this.$bc=Db;this.Etk=ec;this.fka=sc;this.FTa=-1;this.WNe=new Set($a)}get y(){if(-1!==this.FTa)return this.FTa;const ka=Sys.UI.DomElement.getBounds(this.ich),$a=this.ich.getClientRects();return this.FTa=0<$a.length&&$a[0]?this.Etk?ka.y/this.$bc+Ph.Pck:Math.floor($a[0].height)/(2*this.$bc)+ka.y/this.$bc-Ph.nPi/2:0}get VWd(){return Array.from(this.WNe)}TZk(ka){this.WNe=new Set([...this.WNe,...ka])}}Object(f.a)(Lh,"HintInfo",null,[691]);class qa extends te.a{constructor(ka,$a,
Db,ec,sc,ad,Xd,ue,ae,Te,sf,kg,qf,fh){super();this.Ri=ka;this.Pg=$a;this.Wl=Db;this.gG=ec;this.ga=sc;this.ti=Te;this.Qwa=sf;this.u1a=kg;this.Hj=qf;this.brk=fh;this.wyd=new Map;this.dEb=this.WHb=null;this.hAc={Rzb:-1,kcg:-1}}qeb(ka){let $a=!1;P.App.bck&&ka.jc.nj?U.a.instance.Yd(()=>{$a=Oh.n(ka,!0)},"CHA:SCIVE"):U.a.instance.Yd(()=>{$a=Oh.m(ka.htmlElement,!0)},"CHA:SCI");return $a}t7a(ka){const $a=this.zoom,Db=ka.s8,ec=ka.aCa;let sc=0;for(let ue=0;ue<ka.E7.length;ue++)if(0<ka.E7[ue].width){sc=ue;break}const ad=
ka.D6a(1,Ph.WUf,$a,sc);this.u1a.INa(1);let Xd=[];ec.forEach((ue,ae)=>{const Te=ka.E7[ae].y/$a;ue=this.yGl(this.bvm(ue,ae),sf=>this.kGl(Db,sf,sf.y-Te,ad),()=>qa.mIl(Db));Xd=Xd.concat(ue)});return Xd}yGl(ka,$a,Db){Db=Db();const ec=[];for(const sc of ka){ka=$a(sc);for(const Xd of sc.VWd)this.wyd.set(Xd.toString(),ka);const ad=this.mDi(sc.VWd);this.A7j(ad,ka);null==Db.fka&&(Db.fka=sc.fka);Db.appendChild(ka);ec.push(ka)}this.jmc(this.dEb);this.Xrb(this.WHb);return[Db]}NXl(ka,$a){ka=null===ka||void 0===
ka?void 0:ka.querySelectorAll("."+qa.qqj);return 0<(null===ka||void 0===ka?void 0:ka.length)&&ka[0]&&(ka=Array.from(ka[0].querySelectorAll(qa.Wvl)))?this.hMo(ka,$a):!1}hMo(ka,$a){let Db=0,ec=ka.length-1,sc;for(;ec>=Db;){sc=Math.floor((ec-Db)/2+Db);const ad=ka[sc];if(ad.offsetTop>=$a-2&&ad.offsetTop<=$a+2)return!0;ad.offsetTop>$a+2?ec=sc-1:Db=sc+1}return!1}mDi(ka){var $a,Db;let ec=0,sc=0;for(const ad of ka)if(this.ti.U_f(ad)){if(this.Ri.contentFilterApiEnabled&&this.Hj.kn&&(ka=this.ti.e3(ad.toString()),
null===(Db=($a=this.brk).isContentInFilteredContent)||void 0===Db||!Db.call($a,ka.id)))continue;this.ti.CWi(ad)?sc+=1:ec+=1}$a=new po;$a.RWd=ec+sc;$a.ATc=0===ec;return $a}XAc(ka){if(ka=this.wyd.get(ka.objectId)){var $a=Oh.g(ka);$a=this.mDi($a);this.A7j($a,ka)}}A7j(ka,$a){let Db,ec;if(this.Ri.contentFilterApiEnabled&&0===ka.RWd)$a.style.display="none";else if(1===ka.RWd?(Db=ka.ATc?2:0,ec=ka.ATc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):
1<=ka.RWd&&(Db=ka.ATc?3:1,ec=ka.ATc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),$a.style.display="block",ka=$a.firstElementChild)this.dUo(ka,Db),ka.title=ec+". "+ka.title,Bk(Ak[Db],ka)}dUo(ka,$a){ka.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;vh.a.Hm(ka,qa.u5h,$a)}bvm(ka,$a){ka=this.lGl(ka,$a);ka.sort((Db,ec)=>Db.y-ec.y);return this.zLn(ka)}lGl(ka,$a){const Db=[],ec=this.Ri.Pr,
sc=this.zoom;ka=Oh.f(ka,!0);for(let ad=0,Xd=ka.length;ad<Xd;ad++){const ue=ka[ad],ae=Oh.g(ue);ae&&Db.push(new Lh(ue,ae,sc,ec,$a))}return Db}zLn(ka){let $a=null;const Db=[];for(let ec=0;ec<ka.length;ec++)$a&&Math.abs(ka[ec].y-$a.y)<Ph.nPi+Ph.U0m?$a.TZk(ka[ec].VWd):($a=ka[ec],Db.push($a));return Db}kGl(ka,$a,Db,ec){const sc=ka.uh.ownerDocument,ad=sc.createElement("div");ad.className=qa.j5h;ad.style.top=Db+"px";ad.style.left=ec+"px";ad.style.right="auto";ad.style.zIndex="40";vh.a.Hm(ad,nj.a.nWc,$a.VWd);
$a=sc.createElement("span");this.oMg($a,ad);Bk(Ak[0],$a);this.LE($a,ka);return ad}oMg(ka,$a){ka.title=CommonUIStrings.l_CommentHintTooltip;ka.setAttribute("role","button");$a.appendChild(ka)}LE(ka,$a){this.Pg.rK(Vk.a.click,ka,this.zYn.bind(this),$a);this.Pg.nb(Vk.a.$C,ka,this.CYn.bind(this));this.Wl.nb(Vk.a.X3,ka,this.EYn.bind(this));this.Wl.nb(Vk.a.yP,ka,this.DYn.bind(this));this.gG.nb(ka,this.BYn.bind(this))}static mIl(ka){ka=ka.uh.ownerDocument.createElement("div");ka.className=qa.qqj;return ka}BYn(){return!0}CYn(){return!0}zYn(ka){const $a=
Oh.g(ka.iy.parentNode);ka.eventName===Vk.a.rM&&(this.Qwa.kpf(),this.i3h());this.ga.Pb(Ah.a.k5h,2,$a);return!0}EYn(ka){this.KKa(this.dEb)!==ka.iy&&(ka=Oh.g(ka.iy.parentNode),this.ga.Pb(Ah.a.Cqf,2,ka));return!0}DYn(){this.ga.Ob(Ah.a.$Wd,2);return!0}jmc(ka){this.i3h();this.dEb=ka;this.J7k()}J7k(){this.K7k(this.KKa(this.dEb),this.KKa(this.WHb))}Xrb(ka){this.vrl();this.WHb=ka;if(ka=this.KKa(this.WHb)){const $a=this.j7d(ka);this.Nxe(ka,$a,1)}}KKa(ka){if(!ka)return null;let $a=null;if(ka=this.ti.e3(ka))if(ka=
ka.Mf?this.ti.DF(ka.Mf):ka)$a=ka.objectId;return $a&&this.wyd.has($a)?this.wyd.get($a).firstChild:null}i3h(){this.xrl(this.KKa(this.dEb),this.KKa(this.WHb))}xrl(ka,$a){if(ka){const Db=this.j7d(ka);this.Nxe(ka,Db,ka===$a?1:3);this.dEb=null}}K7k(ka,$a){ka&&(ka.title=0<this.hAc.kcg&&1<this.hAc.Rzb?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.hAc.kcg,this.hAc.Rzb):CommonUIStrings.l_CommentHintTooltip,$a!==ka&&($a=this.j7d(ka),this.Nxe(ka,$a,2)))}vrl(){const ka=
this.KKa(this.dEb),$a=this.KKa(this.WHb);if($a){const Db=this.j7d($a);this.Nxe($a,Db,ka===$a?2:3);this.WHb=null}}Nxe(ka,$a,Db){this.fkn()?this.VTo(ka,Db):this.TVo(ka,$a,Db)}VTo(ka,$a){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===ka||void 0===ka?void 0:ka.length)&&(ka[0].style.fill=2===$a||1===$a?"Highlight":"ButtonText")}TVo(ka,$a,Db){$a=Ri[$a];for(let sc=0;sc<$a.length;sc++){var ec=$a[sc];const ad=wi(ec,Db);if(!this.ygn(ad)){a.ULS.sendTraceTag(512262488,
327,15,`The following CSS variable is undefined: ${ad}.`);break}ec=null===ka||void 0===ka?void 0:ka.querySelectorAll("."+ec);0<(null===ec||void 0===ec?void 0:ec.length)&&(ec[0].style.fill=`var(${ad})`)}}fkn(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}j7d(ka){return vh.a.Eb(ka,qa.u5h)}ygn(ka){var $a;const Db=document.getElementById(ui.a.JZc);return!(null===($a=null===Db||void 0===Db?void 0:Db.style)||void 0===$a||!$a.getPropertyValue(ka))}}qa.j5h=
"clip16x16 HintContainer";qa.Wvl=".clip16x16.HintContainer";qa.qqj="OutlineElementHintMargin";qa.u5h="CommentIconType";Object(f.a)(qa,"CommentHintActor",te.a,[669]);var Jb=d(1088);class Rb extends Jb.a{get SCg(){return this.q3()}get Zyf(){return this.fJp.tHi()}constructor(ka,$a,Db,ec,sc,ad,Xd,ue,ae,Te,sf){super();this.Tg=ka;this.Vs=$a;this.zj=Db;this.Qi=ec;this.LQd=sc;this.XH=ad;this.Hh=Xd;this.getSelectedText=ue;this.fJp=ae;this.focusManager=Te;this.Z6a=sf;this.$ed=()=>{};this.Yme=()=>{};this.A9g=
!1;this.mnl={[0]:()=>this.Aei(),[1]:()=>this.oyc.Vjf(),[2]:()=>this.Aei()};this.Vhg=()=>{this.LQd.INa(11)};this.Tkf=kg=>{for(const qf of Oh.u)kg.bindAction(Kh.KeyInputManager.sI(qf),Ai.a.Rmf)};this.coe=()=>{this.Yme()};this.boe=(kg,qf)=>{if(kg.name!==Sh.AFrame.Us&&qf){var fh=this.zj.Pt?this.zj.Pt.id:"";this.Tg.pWb||(this.Tg.pWb=zh.a.z6(this.Qi,()=>{this.$ed(fh)}))}};this.qoj=()=>{};this.wvb=()=>{this.WTj()};this.Bdg=(kg,qf)=>{0===qf&&(this.XH.pte(),this.LQd.INa(0))};this.Weg=()=>{this.LQd.INa(5)};
this.Y3c=kg=>{let qf=0;const fh=this.zj.xR();for(let Fi=0;Fi<fh.length;Fi++){if(fh[Fi].Mf||fh[Fi].done)continue;if((fh[Fi].Nr===rg.a.dE?fh[Fi].KA.draftId:fh[Fi].id)===kg.contentId)break;const Nj=this.qy.getContentAnchorPosition(fh[Fi].id);!Nj||4<Math.abs(kg.anchorTop-Nj.anchorTop)||qf++}return qf};this.mjj=()=>{this.XH.pte()};this.Qgg=()=>{this.LQd.INa(2)};this.WTj=()=>{if(!this.A9g&&this.Hh.cia){const kg=this.Hh.cia.getElementsByClassName(qa.j5h);for(let qf=0;qf<kg.length;qf++)kg[qf].style.opacity=
"1";this.A9g=!0}}}initialize(ka,$a){this.qy=ka;this.oyc=$a;this.nkd();this.Vs.ribbonCommentFilteringEnabled&&this.Tuo();this.Vs.dpb&&this.Vuo()}tTo(ka,$a){this.Yme=ka;this.$ed=$a}gwi(ka,$a){return{e6a:this.Pmm(ka,$a),containerContentByType:{}}}Vvi(ka,$a){const Db=Fe.xxi(this.zj.xR(),this.zj.Cta),ec=[],sc=Oh.e(!0);var ad=this.zj.xR();$a=this.Vgo($a,ad,Db);!$a.wmg&&$a.contentAnchorPosition&&(ec.push($a.contentAnchorPosition),$a.contentAnchorPosition=null);for(ad=0;ad<sc.length;ad++){const Xd=sc[ad],
ue=Oh.g(Xd);if(ue)for(let ae=0;ae<ue.length;ae++){const Te=this.getContentAnchorPosition(ka,Db,Xd,ue[ae]);Te&&(ec.push(Te),$a.wmg&&$a.contentAnchorPosition&&Te.contentId===$a.wmg.id&&(ec.push($a.contentAnchorPosition),$a.contentAnchorPosition=null))}}$a.contentAnchorPosition&&ec.splice(0,0,$a.contentAnchorPosition);return{Fwl:Db,contentAnchorPositions:ec}}V0f(){var ka;return!(null===(ka=this.qy)||void 0===ka||!ka.getAreContainersEnabled())}q3(){return this.zj.PBa()}lCg(){return this.q3()}Cpd(){return this.q3()}YCg(){return this.qy&&
this.Hh.cia&&this.q3()}Wkp(){this.XH.m4("OnFloatingCommentsVisibilityChange",this.Tg.zOa);if(this.Tg.zOa)this.Hh.O0b();else{const ka=this.zj.uL;ka.iB&&ka.clearSelection();this.Hh.Mae()}}foj(ka){0!==ka&&this.$ed(this.zj.Pt?this.zj.Pt.id:"")}getContentAnchorPosition(ka,$a,Db,ec){let sc=null;return({value:sc}=$a.Dc(ec.toString(),sc)).returnValue?($a=sc[0])&&!$a.Mf?{...(new ai.a),anchorTop:(kl.a.X2c(Db)-ka)/this.Hh.dfa,anchorLeft:0,containerContentType:0,contentId:$a.id}:null:null}Vgo(ka,$a,Db){var ec,
sc;const ad={};"CREATE"===(null===(sc=null===(ec=this.zj.hz)||void 0===ec?void 0:ec.KA)||void 0===sc?void 0:sc.sessionType)&&(ec=this.Hh.cia.querySelectorAll(Oh.b),ka=this.Hh.Bti((0<ec.length?ec[0]:null)||this.getSelectedText(),this.zj.hz.KA.draftId,0,ka),ad.wmg=this.SEm($a,Db),ad.contentAnchorPosition=ka);return ad}SEm(ka,$a){var Db=Array.indexOf(ka,this.zj.hz);for(--Db;-1<Db;Db--)if($a.mb(ka[Db].objectId))return ka[Db]}Pmm(ka,$a){return this.Vvi(ka,$a).contentAnchorPositions}nkd(){this.XH.o4("OnAfterTrackChangeMarkupViewChange",
(ka,$a)=>{if($a)this.mnl[$a.qk]()})}Vuo(){this.XH.o4("OnFloatingCommentsToggle",this.Wkp.bind(this))}Aei(){const ka=Oh.i();if(0!==ka.length){var $a=Fe.xxi(this.zj.xR()),Db=this.zj.uL;for(let ec=0;ec<ka.length;ec++){const sc=Oh.g(ka[ec]);for(let ad=0;ad<sc.length;ad++){let Xd;({value:Xd}=$a.Dc(sc[ad].toString(),Xd)).returnValue&&(Xd.forEach(ue=>{var ae;ue&&!ue.Mf&&(this.oyc.IJa(ue.id,0,!1),(null===(ae=Db.iB)||void 0===ae?void 0:ae.id)===ue.id&&Db.clearSelection())}),this.focusManager.Bg(Sh.AFrame.Ho))}}}}Tuo(){this.XH.o4("OnContentFilterUpdate",
this.LXn.bind(this))}LXn(){var ka;let $a=[],Db=new Set;const ec=null===(ka=this.Z6a)||void 0===ka?void 0:ka.getAllContent().filter(sc=>{if(null===sc||void 0===sc?0:sc.contentId){const ad=sc.contentId;if(Db.has(ad))return!1;if(!this.$3m(sc))return $a.push(sc),!1;Db.add(ad);return!0}return!1});this.Hh.G7l(ec,$a)}$3m(ka){var $a,Db;const ec=this.Tg.filter;return ka.contentId&&(null===(Db=($a=this.Z6a).isDraftContent)||void 0===Db?0:Db.call($a,ka.contentId))?!0:ec.mentionsToCurrentUser&&!this.Z6a.isCurrentUserMentioned(ka)?
!1:!0}}Object(f.a)(Rb,"CommentFloatingContainerActor",Jb.a,[673]);var Tc=d(1545),vd=d(2176),Td=d(209);class Ed extends Tc.a{constructor(ka,$a,Db,ec,sc,ad,Xd,ue,ae){super();this.BDk=ka;this.ihb=$a;this.XNe=Db;this.jj=sc;this.xda=ue;this.A1=ae;this.Gj=null;this.qk=1;ec.execute(Te=>{this.Gj=Te});this.P5=[];this.XEc=new Td.ScriptSharpLegacyMap;this.Gso(ad,Xd);this.nkd()}get Ej(){return this.BDk.value}get Mvl(){return this.ihb}get Ufa(){return!!this.Gj}get Yrb(){return 0}get k$a(){return this.P5}get zlh(){return this.XEc.mb(this.qk)?
this.XEc.J(this.qk):this.XEc.J(0)}TXa(ka){return this.xda.TXa(ka)}E9a(ka,$a){if(ka=Object(qb.a)(670,ka))for(const Db of this.mho(ka))$a.add(Db)}bNa(ka,$a){this.Ufa&&this.jj.Yd(()=>{this.c0n(ka,$a)},"CHA:OPHC")}c0n(ka,$a){if(this.Gj.Ip.PBa()){var Db=this.Gq.vJa,ec=new Ea.a(new Xc.a),sc=$a.BNa("*"),ad=this.tmm(Db),Xd=!!Db&&!Db.action||!!ad&&ad===this.Gj.iB,ue;this.jj.Yd(()=>{this.XNe.JCm(ka.id,ec,null===ad||void 0===ad?void 0:ad.objectId)},"OPHC:GOI");this.jj.Yd(()=>{ue=this.zlh.$Xh(sc,ad,ec,Xd);ue.BWi=
this.zWi(Db)&&0===Db.action},"OPHC:BHI");this.jj.Yd(()=>{this.zlh.vTh(sc,ue,Xd)},"OPHC:AH")}}tmm(ka){let $a=null;!this.zWi(ka)||0!==ka.action&&2!==ka.action||($a=this.Gq.vJa.ZB);return $a||this.Gj.iB}mho(ka){if(!ka)return[];ka=this.Ej.Eb(ma.a.Cf(ka.objectId));return this.Mvl.y8d(ka,null)}GBj(){return!1}qH(ka,$a,Db){this.Ufa&&(ka=Object.assign(new vd.a,{action:ka,type:0,ZB:$a,dM:Db}),this.Gq.qH(ka))}kpf(){this.Ufa&&(this.qH(3,this.Gj.umc,this.Gj.umc),this.Gj.umc=null)}Gso(ka,$a){this.XEc.add(1,ka);
this.XEc.add(0,$a)}nkd(){this.A1.o4("OnBeforeTrackChangeMarkupViewChange",(ka,$a)=>{$a&&$a.Sbg!==this.qk&&(this.qk=$a.Sbg)})}zWi(ka){return ka&&0===ka.type}}Object(f.a)(Ed,"CommentHighlightActor",Tc.a,[672,438]);var lf=d(1116),Bf=d(350),vf=d(543),fd=d(1578);class Wc{constructor(ka,$a){this.swl=ka;this.vdg=$a}}Object(f.a)(Wc,"CommentEndParaIdBeforeChangeInfo",null,[]);var sg=d(1691);class Jf{constructor(ka,$a,Db,ec,sc,ad,Xd,ue){this.O3f=ka;this.Tg=$a;this.zj=Db;this.XH=ec;this.xo=sc;this.Wk=ad;this.Qvl=
Xd;this.Vs=ue;this.ZBb=null;this.aho=()=>{if(!this.zj.PBa()){var ae=Oh.l();[nj.a.zqf].forEach(Te=>{this.Zrl(ae,Te)})}};this.Wgo=(ae,Te)=>{(ae=Te.lL)&&!Oh.t(ae)&&(Te=this.zj.lIf(ae),ma.a.Bt(Te.Hqd,Te.t_c)||this.Y6j(Te,ae)||this.R1h(Te.$Ia,Te.zUa,ae)||this.AMg(ae))};this.NUn=(ae,Te)=>{Te.property===na.a.NAa&&(ae=Oh.h(Te.node,ma.a.nil),this.ZBb=new Wc(Te.node.id,ae))};this.ZVn=(ae,Te)=>{ae=Te.node;if(Te.property===na.a.NAa&&ae){var sf=Oh.k(ae,ma.a.nil);Te=Oh.h(ae,ma.a.nil);var kg=this.ZBb?this.td.Eb(this.ZBb.vdg):
null;!Oh.t(ae)&&sf&&!sf.equals(Te)&&this.ZBb&&ae.id.equals(this.ZBb.swl)&&!sf.equals(this.ZBb.vdg)&&kg&&kg.isConnected&&this.mff(this.ZBb.vdg,ae.id);Te&&this.Tg.rz.mb(Te)&&(sf=this.Tg.rz.J(Te),sf.d$a&&(a.ULS.shipAssertTag(572835481,327,!!sf.DP,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),sf.DP&&sf.DP.contains(ae.id)&&(sf.DP.remove(ae.id),sf.DP.count||(sf.d$a=!1),this.Tg.XX.mb(ae.id)?this.Tg.XX.J(ae.id).remove(Te):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};
this.Ifd=(ae,Te)=>{ae=Te.node.id;this.Tg.rz.mb(ae)&&this.$yo(ae)};this.xUn=(ae,Te)=>{Te&&Te.node&&this.N1a.mb(Te.node)&&(ae=this.N1a.J(Te.node).jpe,this.N1a.mb(ae)||(ae=this.N1a.J(Te.node),this.R1h(ae.yvf?ae.currentNode:ae.jpe,ae.yvf?ae.jpe:ae.currentNode,ae.lL)||this.AMg(ae.lL)),this.N1a.remove(Te.node))};this.bWn=(ae,Te)=>{const sf=ae.nk;if(!Te&&this.tkb.mb(sf)){var kg;(kg=this.tkb).Z(sf,kg.J(sf)&(ae.Wc?-2:-3));this.tkb.J(sf)||(this.AMg(this.td.Eb(sf)),this.tkb.remove(sf))}};this.N1a=new vf.a(new lf.a);
this.tkb=new pc.a(Oh.c);this.XH.o4("OnCommentNodeAdded",this.Wgo);this.XH.o4("OnCommentNodeDeleted",this.aho);this.Vs.contentFilterApiEnabled?(this.XH.o4("OnCommentPaneOpen",this.Zbn.bind(this)),this.XH.o4("OnCommentPaneClose",this.Ybn.bind(this)),this.XH.o4("OnContentFilterUpdate",this.qfd.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(ae=>{this.XH.o4(ae,this.Wbn.bind(this))});this.Vs.dpb&&this.XH.o4("OnFloatingCommentsVisibilityChange",this.Xbn.bind(this));ka=this.xo.Ve(12);ka.Bw(this.Ifd);
ka.Zt(this.xUn);this.xo.Ve(40).LSc(this.NUn);this.xo.Ve(40).fo(this.ZVn);Bf.a.PZa(this.bWn)}get lv(){return this.O3f.value}get td(){return this.lv.td}JCm(ka,$a,Db){if(this.N8n(ka))for(const ec of this.Tg.rz.J(ka).DP)!this.dSj(ec,Db===ec.toString())||$a.add(ec)}dSj(ka,$a){const Db=this.td.Eb(ka),ec=Oh.t(Db);if(!Db||ec)return!1;ka=this.zj.e3(ka.toString());return!ka||this.Vs.contentFilterApiEnabled&&this.Tg.kn&&!this.Qvl.isContentInFilteredContent(ka.id)||!this.Tg.kn&&!this.zj.Cta(ka)&&!$a?!1:!0}N8n(ka){return this.s8n(ka)}Zrl(ka,
$a){ka=ka.querySelectorAll(`.${$a}`);if(0!==ka.length)for(let Db=0;Db<ka.length;Db++)ka[Db].classList.remove($a)}AMg(ka){if(ka){var $a=fd.a.y8d(ka,null),Db=new ib.a;for(let ec=1;ec<$a.length-1;ec++)this.mff($a[ec].id,ka.id),Db.add($a[ec]);dk.b(Db)}}Xbn(){const ka=new ib.a;for(const $a of this.zj.xR())!$a.Mf&&$a.Nr!==rg.a.dE&&this.zj.Cta($a)&&this.zj.rFe($a,ka);dk.b(ka)}s8n(ka){if(!this.Tg.s0)return!1;let $a=null;if(({value:$a}=this.Tg.rz.Dc(ka,$a)).returnValue)return $a.d$a;let Db=!1;this.Wk.Yd(()=>
{const ec=Oh.e();for(let sc=0;sc<ec.length;sc++)Db=this.kyp(ec[sc],ka,Db);Db||(this.Tg.rz.add(ka,new sg.a),this.Tg.rz.J(ka).d$a=!1)},"CHORA:PHOC");return Db}kyp(ka,$a,Db){ka=Oh.g(ka);if(!ka)return Db;for(let ec=0;ec<ka.length;ec++){const sc=this.td.Eb(ka[ec]);sc&&!Oh.t(sc)&&(Db=Db||this.Nnl(sc,$a))}return Db}Nnl(ka,$a){var Db=this.zj.lIf(ka);if(this.Y6j(Db,ka))return!1;var ec=Db.Hqd;const sc=Db.t_c;Db=Db.$Ia;if(ec!==ma.a.nil&&(ec.equals(sc)||ec.equals($a)))return!1;for(ec=Pa.ParagraphReader.zg(Db,
!1);ec&&!ec.id.equals(sc);){if(ec.id.equals($a))return this.mff($a,ka.id),!0;ec=Pa.ParagraphReader.zg(ec,!1)}return!1}mff(ka,$a){this.Tg.XX.mb($a)||this.Tg.XX.add($a,new Ea.a(new Xc.a));this.Tg.XX.J($a).add(ka);this.Tg.rz.mb(ka)?this.Tg.rz.J(ka).DP||(this.Tg.rz.J(ka).DP=new Ea.a(new Xc.a)):this.Tg.rz.add(ka,new sg.a(!0));this.Tg.rz.J(ka).d$a=!0;this.Tg.rz.J(ka).DP.add($a)}$yo(ka){if(this.Tg.rz.J(ka).DP)for(const $a of this.Tg.rz.J(ka).DP)this.Tg.XX.mb($a)?this.Tg.XX.J($a).remove(ka):a.ULS.sendTraceTag(572835483,
327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.Tg.rz.remove(ka)}Wbn(){const ka=new ib.a;for(const $a of this.zj.xR())$a.Mf||$a.Nr===rg.a.dE||this.zj.Cta($a)||this.zj.rFe($a,ka);dk.b(ka)}Zbn(){this.$Wf("OnCommentPaneOpen")}qfd(){this.$Wf("OnContentFilterUpdate")}Ybn(){this.$Wf("OnCommentPaneClose")}$Wf(ka){const $a=new ib.a;for(const Db of this.zj.xR())Db.Mf||Db.Nr===rg.a.dE||this.zj.uL.C_h(ka,Db)||this.zj.rFe(Db,$a);dk.b($a)}Y6j(ka,$a){let Db=!1;if(!ka.bBe||!ka.r1d){Db=!0;
if(!ka.$Ia||!ka.zUa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!ka.$Ia,!ka.zUa),!0;ka.bBe||this.N1a.mb(ka.$Ia)||this.N1a.add(ka.$Ia,{lL:$a,currentNode:ka.$Ia,jpe:ka.zUa,yvf:!0});ka.r1d||this.N1a.mb(ka.zUa)||this.N1a.add(ka.zUa,{lL:$a,currentNode:ka.zUa,jpe:ka.$Ia,yvf:!1})}return Db}R1h(ka,$a,Db){ka=fd.a.hBa(ka,Db.id,!0);$a=fd.a.hBa($a,Db.id,!1);let ec;ka||({value:ec}=this.tkb.Dc(Db.id,ec),this.tkb.Z(Db.id,ec&1));$a||({value:ec}=this.tkb.Dc(Db.id,ec),
this.tkb.Z(Db.id,ec&2));return!ka||!$a}}Object(f.a)(Jf,"CommentHighlightOnRestActor",null,[671]);var Qk=d(588),$e=d(472),Ei=d(577);class ve{constructor(ka,$a){this.vJb=ka;this.jpa=$a}getViewContainer(){return this.vJb}registerForViewContainerEvents(ka){this.jpa.swo(ka)}unregisterForViewContainerEvents(ka){this.jpa.Rsp(ka)}}Object(f.a)(ve,"ViewContainerProvider",null,[1416]);class Ad{constructor(ka,$a,Db,ec){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=
ka;this.appLocale=$a;this.uiCulture=Db;this.dataCulture=ec}}Object(f.a)(Ad,"LocalizationDetails",null,[]);var re=d(1229),ea=d(1593),eb=d(515);class Ob{constructor(ka,$a,Db,ec,sc,ad,Xd,ue,ae,Te,sf,kg,qf,fh,Fi,Nj,Zh,hk,km,lm,Rl,Oj,Fn,em,dn,Lo,Gi,en,uk,pj,Jj){this.Mr=ka;this.zj=$a;this.TLb=Db;this.L2=ec;this.Vs=sc;this.Tg=ad;this.Y3d=Xd;this.kmc=ue;this.Pp=ae;this.Sb=Te;this.dynamicScriptLoader=sf;this.vIo=kg;this.focusManager=qf;this.Lqf=fh;this.Hqf=Fi;this.tMh=Nj;this.dEp=Zh;this.zY=hk;this.XH=km;
this.gKo=lm;this.Z4l=Rl;this.Lij=Oj;this.eEp=Fn;this.ULb=em;this.JW=dn;this.Hh=Lo;this.aQ=Gi;this.gsf=en;this.scb=uk;this.aXd=pj;this.Zzl=Jj;this.bEd=this.i4a=null;this.Xmh=!1;this.M2e=[];this.XCh=this.Ymh=!1;this.initialize=(Uo,Sn)=>{this.e6m(Sn)};this.$Ml=Uo=>Mb.a.XXd(Uo);this.cWn=()=>{this.nSi()};this.Usm=(Uo,Sn,Vo)=>{Uo={...(new re.a),containerPanel:Uo,paneOpenedCallback:Sn,paneClosedCallback:Vo,ulsLogger:new Qk.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:y.AFrameworkApplication.isRtl,
viewportInfo:this.Hh.aJf(),destroyAllContainersCallback:()=>{this.Tg.kn||a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.Vs.Z3d,synchronousContainerPositioningEnabled:!1,trackChangeInSidetrackEnabled:this.Vs.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.Vs.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.Vs.contentNavigationApiEnabled,
contentFilterApiEnabled:this.Vs.contentFilterApiEnabled,returnToDraftFixEnabled:!0,ribbonCommentFilteringEnabled:this.Vs.ribbonCommentFilteringEnabled}};this.Vs.contentNavigationApiEnabled&&(Uo.sidetrackContentNavigationApi=this.gsf,Uo.featureGateApiSettings=this.JW.Zyf,Uo.telemetryDetails=this.Lij,this.Vs.contentFilterApiEnabled&&(Uo.contentFilterAPI=this.Zzl));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(Uo)};this.SXn=Uo=>{2!==this.Mr.mode&&3!==this.Mr.mode&&this.zj.Pt&&Uo===
this.zj.Pt.id&&this.Mr.clearSelection();cc.StaticActiveAppFrame.za().Ie(!0)};this.hkj=(Uo,Sn)=>{this.Vy("onCSCStart",window.performance.now());this.Vlb&&!Uo&&(this.Z4n(),this.Vy("openInFishbowl",!0));this.TLb.Zlb&&this.Vs.lNb&&this.Sb.Ob(Ah.a.IMa,2);Sn&&Sn();this.Vy("onCSCEnd",window.performance.now())};this.XH.o4("OnCommentInit",this.initialize);this.XH.o4("OnCommentRenderedOnce",this.cWn);this.JW.tTo(()=>{},this.SXn);this.Vs.dpb&&eb.a.b6c&&(this.Tg.zOa=!1)}get aRa(){return this.Mr}get Vlb(){return this.Tg.Vlb}Vy(ka,
$a){this.scb.Vy(Uj.a.comments,ka,$a,!0)}e6m(ka){if(this.Tg.s0)ka&&ka.NMa&&ka.NMa();else if(this.Xmh)(null===ka||void 0===ka?0:ka.NMa)&&this.M2e.push(ka.NMa);else{var $a=this.Vs.Rlc;this.Vy("hasCommentOnBoot",$a);$a?(this.ULb.logKpiUsage(ea.a.RLb,0),y.AFrameworkApplication.yga("3f3e3317;d8ebf581")):$e.a.pSn();this.Xmh=!0;this.Vy("initInProgress",!0);this.zj.initialize(this.Mr);this.TLb.initialize(this.Mr,null);this.TLb.mRj(this.Mr);this.kmc.c7m(this.L2.fYo);this.Vy("InitAMSetup",window.performance.now());
Ei.a.$p(this.Z4l).continueWith(Db=>{(this.i4a=Db.result)||a.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.Lqf.initialize(this.i4a);this.aRa.xqf.initialize(this.aRa,this.zj,this.i4a,this.Lqf);this.tMh.initialize(this.dynamicScriptLoader,this.aRa.xqf,this.Lij,this.i4a,new ve(this.dEp,this.eEp),this.VBi(),"",this.Lqf.tHi(),this.zY,P.App.Uye);this.Vy("AMInitialized",window.performance.now());this.Vs.contentNavigationApiEnabled?(P.App.KOb?P.App.KOb:
this.Hh.K7i()).then(()=>{this.Vy("FCMLoaded",window.performance.now());this.Zod();this.xce(ka)}):this.xce(ka)})}}Ndo(){var ka;null===(ka=sharedComments.setDarkModeColorHandler)||void 0===ka?void 0:ka.call(sharedComments,this.$Ml)}xce(ka){this.bEd=this.tMh.xce(void 0,this.Ndo.bind(this));this.Q7c(ka);this.Tg.s0=!0;this.Vs.AEg&&this.Hqf.initialize()}Q7c(ka){if(!this.Tg.QRb){this.Vy("InitCSStart",window.performance.now());var $a=this.Pp.Vf("Task","InitiateCommentingSession");this.ULb.logKpiUsage(ea.a.v5h,
0);try{const Db=this.Pp.Vf("Task","InitiateCommentingSession-UpdateModel");this.aXd.x6m();Db.stop();this.Vy("initAtBoot",window.performance.now());this.Vs.Pr&&this.zj.PBa()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",D.a.Ee()));Vg.a.get_instance().vK(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.Tg.QRb=!0;this.bEd.then(()=>{this.Vy("SCLoaded",window.performance.now());this.Hh.T6m();this.Vy("FCMInitiated",
window.performance.now());if(this.Vs.Pr){let sc=!1;if(this.Vlb){var ec=this.L2.W5d(this.Vlb);ec?(y.AFrameworkApplication.Ld("3ge3g205;cha3g788"),ec=this.L2.X5d(ec,0),ec)?this.zj.Cta(ec)||(sc=!0,this.$4n(ec)):(sc=!0,this.Rbb()):sc=!0}ec=ka?ka.Ykj:null;this.Vs.contentNavigationApiEnabled?this.hkj(sc,ec):this.iAn(sc,ec)}ka&&ka.NMa&&ka.NMa();for(const sc of this.M2e)sc();this.Ymh&&this.nSi();this.M2e=[]})}catch(Db){a.ULS.$w(539567713,327,10,Db,`Comments Initialization Failed: ${Db}`),this.ULb.logKpiFailure(ea.a.v5h,
"CommentsInitializationFailed",{isInternal:!0},{name:ea.a.QLb,isInternal:!0})}finally{$a.stop(),this.Vy("InitCSEnd",window.performance.now())}this.Sb.Ob(Ah.a.Z4h,2)}}$4n(ka){this.Sb.Ob(Ah.a.EY,2);this.JW.WTj();zh.a.z6(y.AFrameworkApplication.mc,()=>{this.L2.selectComment(ka,{...(new oi.a),sS:!0,Gca:1});this.focusManager.Bg(Sh.AFrame.Us);a.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-y.AFrameworkApplication.D2)},Bj.a.TMo);
this.ULb.Vw(Ah.a.Bqf)}Rbb(){this.Sb.Ob(Ah.a.Rbb,2)}iAn(ka,$a){(P.App.KOb?P.App.KOb:this.Hh.K7i()).then(()=>{this.Vy("FCMLoaded",window.performance.now());this.Zod();this.hkj(ka,$a)}).catch(Db=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+Db.toString())})}Zod(){this.aQ.trackChangeInSidetrackEnabled?(this.Y3d.Zod(),this.Vy("STSet",window.performance.now())):this.Y3d.qRj(this.Usm)}nSi(){this.XCh||(this.Tg.s0&&this.bEd?(this.bEd.then(()=>{const ka=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();
this.gKo.execute($a=>{ka.registerSafelinksNavigator($a.JAc.bind($a))});this.vIo.execute($a=>{$a.Jso(ka)})}),this.XCh=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.Ymh=!0))}VBi(){return new Ad(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}Z4n(){this.L2.AKj(this.Vlb,{...(new oi.a),NCg:!1,f9c:!0});this.ULb.Vw(Ah.a.Bqf)}}Object(f.a)(Ob,"CommentInitActor",
null,[]);class Zb{constructor(ka,$a,Db,ec,sc,ad){this.Pg=ka;this.gG=$a;this.ga=Db;this.crk=ec;this.Vj=sc;this.Ri=ad;this.XFe=this.F2a=null}get zoom(){let ka=1;this.Vj&&this.Vj.instance&&(ka=this.Vj.instance.Aj);return 0<ka?ka:1}A6l(ka,$a){if(!this.XFe||!ka.aCa||$a>=ka.aCa.length)return null;const Db=this.zoom,ec=ka.s8,sc=ka.D6a(1,Ph.WUf,Db,$a);return this.qFl(ka.aCa[$a],ec,(this.XFe.y-ka.E7[$a].y)/Db+Ph.Pck,sc)}qFl(ka,$a,Db,ec){if(this.F2a)return($a=this.F2a.parentElement)&&$a.removeChild(this.F2a),
this.iNj(ka,this.F2a,Db,ec),this.F2a;const sc=$a.uh.ownerDocument,ad=sc.createElement("div");ad.className=Zb.Nvl;this.iNj(ka,ad,Db,ec);ka=sc.createElement("span");this.oMg(ka,ad);Bk(Ak[4],ka);this.Xto(ka,$a);return this.F2a=ad}oMg(ka,$a){ka.title=CommonUIStrings.l_CommentNewCommentButton;ka.setAttribute("role","button");$a.appendChild(ka)}Xto(ka,$a){this.Pg.rK(Vk.a.click,ka,this.xXn.bind(this),$a);this.Pg.nb(Vk.a.$C,ka,this.zXn.bind(this));this.gG.nb(ka,this.yXn.bind(this))}Gae(){if(this.F2a){const ka=
this.F2a.parentElement;ka&&ka.removeChild(this.F2a)}}iNj(ka,$a,Db,ec){this.Ri.IIo||this.crk.NXl(ka,Db)?$a.style.left=ec+Ph.WUf+"px":$a.style.left=ec+"px";$a.style.top=Db+"px";$a.style.right="auto";$a.style.display="block";$a.style.position="absolute";$a.style.overflow="hidden";$a.style.cursor="default";$a.style.zIndex="40"}zXn(){return!0}xXn(ka){this.ga.iE=30;this.ga.Ob(Ah.a.IMa,2);ka=ka.iy;Bk(Ak[4],ka);ka=ka.parentElement;(null===ka||void 0===ka?0:ka.parentElement)&&ka.parentElement.removeChild(ka);
return!0}yXn(){return!0}}Zb.Nvl="clip16x16 EntryPointContainer";Object(f.a)(Zb,"CommentMarginEntryPointActor",null,[]);var mc=d(454),Yc=d(87),ld=d(233),oe=d(36),Vd=d(125);class ce{constructor(ka,$a,Db,ec,sc,ad,Xd){this.O3f=ka;this.Vxn=$a;this.Ip=Db;this.Tg=ec;this.Vs=sc;this.Fqf=ad;this.ULb=Xd;this.swj=new Set;this.LUb=new Set;this.sgd=new ld.a;this.jfc=new Map;this.z5h=H.a.instance.rf("Box4.CommentParagraphMapping");this.VLb=new Set;this.cka=this.V5d()}get lv(){return this.O3f.value}get td(){return this.lv.td}get cJa(){return this.Vxn.value}V5d(){const ka=
new cg.GraphIterator;ka.set(this.lv);this.cJa.Kbb(ka);return ka}x6m(){this.Tg.QRb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",oe.Debug.O8a());this.Vs.contentNavigationApiEnabled||(this.Vs.Rlc&&this.v6m(),this.Ip.dmj())}eVn(){this.sHj();this.VLb.forEach(ka=>{this.XSg(ka)});this.VLb.clear();this.Ip.dmj()}XSg(ka){if(mc.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${ka}`);
var $a=this.jfc.get(ka).Fyc,Db=this.jfc.get(ka).Xhc;$a===ma.a.nil||Db===ma.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${$a} or end ${Db} has invalid value`):(this.z5h.value.$6a.set(ka,$a),this.z5h.value.Y6a.set(ka,Db),a.ULS.sendTraceTag(512235651,327,50,`Start ${$a} and End ${Db} mapping info for Comment ${ka} added on Comment Model load`))}}A9m(ka){const $a=[];for(const Db of ka)ka=Db.nk.toString(),this.E6j(ka,Db.paragraph.id,Db.Wc),Db.Wc&&(this.swj.has(ka)?a.ULS.sendTraceTag(523334301,327,
50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",Db.nk):(this.swj.add(ka),(ka=this.NVk(Db))&&$a.push(ka)));return $a}E6j(ka,$a,Db){mc.a.isEnabled&&(this.jfc.has(ka)||this.jfc.set(ka,{Fyc:ma.a.nil,Xhc:ma.a.nil}),Db?this.jfc.get(ka).Fyc=$a:this.jfc.get(ka).Xhc=$a)}NVk(ka){var $a=this.td.Eb(ka.nk);this.cka.Yj($a);if(40!==this.cka.lf||!$a)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",
!$a,!ka.nk),this.cka=39===this.cka.lf?this.cka:this.V5d(),null;$a=this.Ip.FYd(this.cka);let Db;if(({index:Db}=this.Ip.eEe($a)).returnValue)if(this.Ip.Ief($a,Db),this.LUb.add($a.objectId),Oh.q($a)||this.VLb.add($a.objectId),$a.Mf)this.wEf($a);else return{contentId:$a.id,containerContentType:0,sca:{Ad:ka.Jb.cp,zP:ka.paragraph.Uj}};else this.sgd.add($a);return null}wEf(ka){if(ka.Mf){var $a=this.Ip.DF(ka.Mf);if($a&&$a.Mf){const Db=this.Ip.DF($a.Mf);Db&&(Db.Mf?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):
(ka.Mf=$a.Mf,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${ka.objectId} parentObjectId: ${$a.objectId}`)))}}}v6m(){const ka=new O.a(0),$a=Yc.a.iq(this.Ip.d1a),Db=new Set;this.Vs.E6n&&!mc.a.isEnabled&&this.bYk($a,ka);const ec=this.V5d(),sc=new Set,ad=new Set,Xd=new zk.GraphTransaction(2);try{if(Xd.qu(ec),ec.fv(1)){for(;$a.moveNext();){if(!Pa.ParagraphReader.Bh($a.iterator))continue;const ae=$a.iterator.currentNode,Te=Pa.ParagraphReader.tPb(ae);mc.a.isEnabled&&
this.QIn(ae,Te,ka);Db.add(ae.id.toString());this.Lvj(Te,ad,ec,sc)}this.sHj();const ue=this.umm(Db);0<ue.length&&this.NHo(ue,Db,ec,ad);this.VLb.forEach(ae=>{this.XSg(ae)});this.VLb.clear()}}finally{Xd&&Xd.dispose()}0==this.LUb.size&&this.Vs.Rlc&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");Tb.a.nEn(sc,ad,this.td)}Lvj(ka,$a,Db,ec){for(const sc of ka){ka=this.Vs.Pr?!sc.Wc:sc.Wc;const ad=sc.nk.toString();this.E6j(ad,sc.paragraph.id,sc.Wc);ka?$a.has(ad)||
ec.add(ad):$a.has(ad)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",sc.nk):($a.add(ad),this.OVk(sc,Db))}}NHo(ka,$a,Db,ec){const sc=this.$Dm(ka);Tb.a.Wol(sc);const ad=new Set,Xd=new Set;sc.forEach(ae=>{$a.has(ae.id.toString())||Xd.has(ae.id.toString())||(Xd.add(ae.id.toString()),ae=Pa.ParagraphReader.tPb(ae),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${ae.length} CommentRangeObjects`),this.Lvj(ae,ec,Db,ad))});const ue=[];ka.forEach(ae=>{this.LUb.has(ae)||
ue.push(ae)});0<ue.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${ue.length} Failed To Load on Retry: ${ue.join(",")}`),this.ULb.logKpiFailure(ea.a.RLb,"CommentsFailedToLoadOnRetry",{isInternal:!0},{name:ea.a.QLb,isInternal:!0}))}$Dm(ka){const $a=[];ka.forEach(Db=>{if(Db=this.Fqf.Tvi(Db))Db=Oh.k(Db),(Db=this.td.Eb(Db))&&Db.pk&&$a.push(Db)});return $a}OVk(ka,$a){const Db=this.td.Eb(ka.nk);$a.Yj(Db);40===$a.lf&&Db?(ka=this.Ip.FYd($a),({index:$a}=this.Ip.eEe(ka)).returnValue?(this.Ip.Ief(ka,
$a),this.LUb.add(ka.objectId),Oh.q(ka)||this.VLb.add(ka.objectId),ka.Mf&&this.wEf(ka)):this.sgd.add(ka)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",!Db,!ka.nk),39===$a.lf||this.V5d())}umm(ka){const $a=[],Db=this.Fqf.omm();if(this.LUb.size===Db.length)return $a;Db.forEach(ec=>{!this.LUb.has(ec)&&Tb.a.Htn(ec,ka,this.Fqf,this.td)&&$a.push(ec)});return $a}sHj(){for(let ka=0;ka<this.sgd.length;ka++){const $a=this.sgd.J(ka);
let Db;({index:Db}=this.Ip.eEe($a)).returnValue?(this.Ip.Ief($a,Db),Oh.q($a)||this.VLb.add($a.objectId),this.LUb.add($a.objectId),$a.Mf&&this.wEf($a)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",$a.LBa,$a.a8a,$a.objectId,$a.Mf))}this.sgd.clear()}bYk(ka,$a){ka.vp(Db=>{if(11===Db.lf){var ec=Db.currentNode;const sc=ec.ja(Vd.a.Oqf,null),ad=ec.ja(Vd.a.Mqf,null);Db=!!sc&&0<sc.length;const Xd=
!!ad&&0<ad.length;Db&&sc.forEach(ae=>{const Te=this.td.Eb(ae);Te&&!Oh.t(Te)&&$a.add(ae,0)});Xd&&ad.forEach(ae=>{$a.mb(ae)&&$a.remove(ae)});(ec=ec.ja(me.a.$H,null))&&ec.forEach(ae=>{const Te=this.td.Eb(ae);Pa.ParagraphReader.Xb(Te)&&!this.Tg.rz.mb(ae)&&this.Tg.rz.add(ae,new sg.a)});const ue=$a.keys;for(let ae=0;ae<ue.length;ae++){ec&&0<$a.J(ue.J(ae))&&(this.Tg.XX.mb(ue.J(ae))||this.Tg.XX.add(ue.J(ae),new Ea.a(new Xc.a)),ec.forEach(sf=>{const kg=this.td.Eb(sf);Pa.ParagraphReader.Xb(kg)&&(this.Tg.rz.J(sf).DP||
(this.Tg.rz.J(sf).DP=new Ea.a(new Xc.a)),this.Tg.XX.J(ue.J(ae)).add(sf),this.Tg.rz.J(sf).d$a=!0,this.Tg.rz.J(sf).DP.add(ue.J(ae)))}));let Te;$a.Z(Te=$a.keys.J(ae),$a.J(Te)+1)}return Db||Xd}return!0},null)}QIn(ka,$a,Db){ka&&(this.nkk($a,Db),this.Tg.rz.mb(ka.id)||this.Tg.rz.add(ka.id,new sg.a),Db.forEach((ec,sc)=>{0<sc&&(this.Tg.XX.mb(ec)||this.Tg.XX.add(ec,new Ea.a(new Xc.a)),this.Tg.rz.J(ka.id).DP||(this.Tg.rz.J(ka.id).DP=new Ea.a(new Xc.a)),this.Tg.XX.J(ec).add(ka.id),this.Tg.rz.J(ka.id).d$a=!0,
this.Tg.rz.J(ka.id).DP.add(ec));Db.Z(ec,sc+1);return!0}))}nkk(ka,$a){ka.forEach(Db=>{if(Db.Wc){const ec=this.td.Eb(Db.nk);ec&&!Oh.t(ec)&&$a.Z(Db.nk,0)}else $a.mb(Db.nk)&&$a.remove(Db.nk)})}}Object(f.a)(ce,"CommentModelBootLoader",null,[668]);var pe=d(1127);class Sd{constructor(ka){this.w5h=ka;this.IHc=null;this.kvh=void 0;this.lvh=null;this.yMc=new Map;this.mRe=new Map}jwo(){pe.a.PZa(this.Oup.bind(this))}Oup(ka,$a){const Db=ka.id.toString();var ec=ka.getValue(na.a.MG).toString();$a?(this.yMc.delete(Db),
this.mRe.delete(ec)):(this.yMc.set(Db,ka),this.mRe.set(ec,ka));0===this.yMc.size&&this.IHc&&(ka=+new Date-+this.IHc,this.IHc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${ka}`));$a||this.kvh!==ec||($a=+new Date-+this.lvh,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${$a}`),ec=new N.a,ec.durationMs=$a,this.w5h.logKpiFailure(ea.a.TWd,"CommentFoundAfterDeeplinkAttempt",
{isInternal:!0,additionalValues:ec},{name:ea.a.d5h,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ec}));this.IHc||(this.IHc=new Date)}set YMn(ka){this.kvh=ka;this.lvh=new Date;if(ka=this.mmm(ka))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${ka.id} present but failed to load`),ka=new N.a,this.w5h.logKpiFailure(ea.a.TWd,"CommentPresentButFailedToLoad",{isInternal:!0},{name:ea.a.d5h,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ka})}omm(){return[...this.yMc.keys()]}mmm(ka){return this.mRe.get(ka)}Tvi(ka){return this.yMc.get(ka)}}
Object(f.a)(Sd,"CommentNodeTracker",null,[]);class Oe{get contentType(){return 0}constructor(ka,$a,Db,ec,sc){this.Xvg=ka;this.Ip=$a;this.L2=Db;this.uL=ec;this.Tg=sc;this.Xvg.fBj(this)}EKj(ka,$a,Db){0===$a?($a=this.Ip.l9c(ka),this.L2.selectComment($a?this.Ip.hz:this.Ip.DF(ka),Object.assign(new oi.a,{sS:Db||$a,Gca:1}))):this.uL.clearSelection()}ISj(ka){if(this.Tg.kn||this.Ip.l9c(ka.contentId))return!0;const $a=this.Ip.DF(ka.contentId);if($a)return this.Ip.Cta($a);a.ULS.sendTraceTag(508878870,327,10,
`Failed to find comment for contentId: ${ka.contentId}`);return!1}}Object(f.a)(Oe,"CommentReviewSuggestionContentActor",null,[667]);class ef{get sZj(){return this.BGg}constructor(ka,$a){this.aXd=ka;this.Vs=$a;this.BGg=new Set([12])}initialize(){}S7i(ka){if(!Pa.ParagraphReader.Xb(ka.node))return[];ka=Pa.ParagraphReader.tPb(ka.node);return this.aXd.A9m(ka)}Ljj(){this.aXd.eVn()}wNi(){return this.Vs.y9o?this.Vs.Rlc:!0}}Object(f.a)(ef,"CommentReviewSuggestionContentProvider",null,[666]);var Nd=d(327),
wb=d(75),ki=d(127),cj=d(242),Pd=d(1653);class Me{constructor(){this.commentId=null;this.T$c=!1}}Object(f.a)(Me,"CommentToSelectOnPaneLoadData",null,[]);class Eg{constructor(ka,$a,Db,ec,sc,ad,Xd,ue,ae,Te,sf,kg,qf,fh,Fi,Nj){this.Mr=ka;this.Ip=$a;this.bJa=Db;this.L2=ec;this.XH=sc;this.Tg=ad;this.Y3d=Xd;this.Vs=ue;this.TLb=ae;this.tUb=Te;this.Sb=sf;this.P3f=kg;this.focusManager=qf;this.Wk=fh;this.pwl=Fi;this.Z6a=Nj;this.pjd=(Zh,hk,km,lm,Rl)=>{if(1===km||!Rl)return 32;Rl[Nd.a.On]=eb.a.b6c?this.Tg.kn:this.Tg.zOa;
return 32};this.Sb.ra(Ah.a.I0b,wb.a.frame,this.Mr.I0b.bind(this.Mr));this.Sb.ra(Ah.a.C0d,wb.a.frame,this.C0d.bind(this));this.Sb.ra(Ah.a.yqf,wb.a.frame,this.VVn.bind(this));this.Sb.ra(Ah.a.zvl,wb.a.frame,this.UVn.bind(this));this.Sb.ra(Ah.a.Mgj,wb.a.frame,this.r_n.bind(this));this.Sb.ra(Ah.a.Rgi,wb.a.frame,this.dXn.bind(this));this.Sb.ra(Ah.a.k5h,wb.a.frame,this.AYn.bind(this));this.Sb.fb(Ah.a.Cqf,wb.a.frame,this.v7k.bind(this),64);this.Sb.fb(Ah.a.$Wd,wb.a.frame,this.Fxo.bind(this),64);this.Sb.ra(Ai.a.selectComment,
wb.a.frame,this.L2.QMo.bind(this.L2));this.Vs.Hyn&&this.Sb.ra(Ai.a.Xhe,wb.a.frame,this.Xhe.bind(this));this.nNh(Ai.a.NYc,!1);this.nNh(Ai.a.Gwf,!0);this.Sb.fb(Ai.a.bXd,wb.a.frame,this.bXd.bind(this),64);this.Vs.dpb&&(this.Sb.ra(Ai.a.mJg,wb.a.frame,this.G3n.bind(this)),this.Sb.fb(Ai.a.pjd,wb.a.frame,this.pjd.bind(this),96));this.Sb.ra(Ai.a.x$i,wb.a.frame,ki.ActionManager.Zf);this.Sb.ra(Ai.a.Rmf,wb.a.frame,this.eil.bind(this));this.Sb.ra(Ai.a.zei,wb.a.frame,(Zh,hk)=>cj.a.Sla(hk.Hk)&&cj.a.hoc()?8:32);
this.Vs.ribbonCommentFilteringEnabled&&(this.Sb.ra(Ai.a.l3d,wb.a.frame,this.l3d.bind(this)),this.Sb.ra(Ai.a.m3d,wb.a.frame,this.m3d.bind(this)),this.Sb.ra(Ai.a.n3d,wb.a.frame,this.n3d.bind(this)),this.Sb.ra(Ai.a.kve,wb.a.frame,this.kve.bind(this)))}get zj(){return this.Ip}get mode(){return this.Mr.mode}get iB(){return this.Mr.iB}get mE(){return this.Vs.Pr}get Ej(){return this.tUb.value}get lb(){return this.P3f.value}get uL(){return this.Mr}C0d(ka,$a,Db,ec,sc){return sc?sc?(ka=this.L2.W5d(sc.NavigationId))&&
this.L2.X5d(ka,1)?32:8:(a.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}VVn(ka,$a,Db,ec,sc){sc&&this.XH.m4("OnCommentInit",{...(new Pd.a),NMa:()=>{var ad=this.L2.W5d(sc.NavigationId);if(ad){var Xd=this.L2.X5d(ad,1);Xd?this.TLb.isVisible?(this.ind(Xd,1),this.focusManager.ME(Sh.AFrame.Us)):this.zj.Cta(Xd)?(ad=Oh.s(Xd),this.L2.selectComment(Xd,{...(new oi.a),sS:!ad,Gca:1}),this.focusManager.ME(Sh.AFrame.jP)):
(this.Tg.kn||this.Sb.Ob(Ah.a.EY,2),zh.a.z6(y.AFrameworkApplication.mc,()=>{this.ind(Xd,1)},Bj.a.ind)):this.Sb.Ob(Ah.a.Rbb,2)}}});return 32}UVn(ka,$a,Db,ec,sc){sc?(ka=this.zj.z2c(sc))?this.uL.vsc(ka.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.uL.vsc(null);return 32}r_n(ka,$a,Db,ec,sc){if(sc){if(this.Tg.QRb){for(ka=0;ka<sc.length;ka++)this.zj.dNj(sc[ka]);this.Mr.fZb()}else this.zj.ZZk(sc);this.vEn(sc)}return 32}dXn(ka,$a,Db,ec,
sc){if(sc)if(this.Tg.QRb){for(ka=0;ka<sc.length;ka++)this.zj.dNj(sc[ka],!0);this.Mr.fZb()}else this.zj.Hrl();return 32}AYn(ka,$a,Db,ec,sc){this.mE||this.Tg.kn||this.Sb.Ob(Ah.a.EY,2);if(sc){ka=null;if(!this.iB||2!==this.mode&&3!==this.mode){if(!sc)return 8;if(this.mE)ka=this.n8l(sc);else for($a=0;$a<sc.length&&(ka=this.zj.e3(sc[$a].toString()),this.Y3d.oee&&(!ka||ka.done));$a++);}else ka=this.iB;this.ind(ka,1);ka&&this.Tg.s0&&this.focusManager.Bg(this.mE&&!this.Tg.kn?Sh.AFrame.jP:Sh.AFrame.Us)}else a.ULS.sendTraceTag(5017933,
327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}v7k(ka,$a,Db,ec,sc){var ad;if(!sc)return 32;if(sc&&0<sc.length){$a=ka=Db=0;ec=!1;for(let Xd=0;Xd<sc.length;Xd++)sc[Xd].toString()===(null===(ad=this.iB)||void 0===ad?void 0:ad.objectId)?(ec=!0,ka++):this.Ip.U_f(sc[Xd])&&(ec&&0===Db&&(Db=Xd,$a=ka),ka++);(ad=this.Ip.e3(sc[Db].toString()))?(this.bJa.hAc.kcg=$a+1,this.bJa.hAc.Rzb=ka,this.uL.vsc(ad.id)):(sc=sc[Db],this.Ej.Eb(sc)?a.ULS.sendTraceTag(540148256,327,10,
`Comment Node with ObjectId ${sc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",sc.toString()))}return 32}Fxo(){this.uL.vsc(null);return 32}nNh(ka,$a){this.Sb.ra(ka,wb.a.frame,(Db,ec,sc)=>this.IWn(sc,$a))}G3n(ka,$a,Db){var ec;if(1===Db)return this.Ip.hz?8:32;if(2===Db){if(eb.a.b6c||this.Tg.kn)return this.Sb.Ob(Ah.a.EY,2),this.Tg.zOa=this.Tg.kn,32;if(!this.Ip.U5c())return 32;this.Tg.zOa=!this.Tg.zOa;
this.XH.m4("OnFloatingCommentsToggle");null===(ec=cc.StaticActiveAppFrame.za())||void 0===ec?void 0:ec.Ie(!0)}return 32}Xhe(ka,$a,Db){2===Db&&(ka=this.zj.Yo.Mc(7),ka.Ab(this.zj.d1a),$a=new Rd.a,$a.Ila(`${String.fromCodePoint(128077)} \n`),this.Ip.Wfc(Zf.a.instance.gb.currentSelection,void 0,$a),this.pwl.Gae(),ka.dispose());return 32}IWn(ka,$a=!1){if(2===ka)ka=this.zj.Yo.Mc(15),ka.Ab(this.zj.d1a),this.Wk.Yd(()=>{this.NYc($a)},"ECM:DAC"),ka.dispose();else if(1===ka&&!this.zj.PBa())return 2;return 32}NYc(ka=
!1){this.Mr.mode=1;const $a=this.zj.xR();for(const Db of $a)Db.Nr===rg.a.dE||ka&&!Db.done||Db.Mf||this.Mr.deleteComment(Db);this.focusManager.Bg(Sh.AFrame.Ho);0<(ka?this.zj.xR().filter(Db=>Db.done):this.zj.xR()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",ka):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",ka)}bXd(ka,$a,Db){if(2===Db)if(ka=this.focusManager.currentScope.name,ka!==Sh.AFrame.Us&&
ka!==Sh.AFrame.jP){!this.mE||this.Tg.kn?(this.Tg.kn||this.Sb.Ob(Ah.a.EY,2),this.focusManager.Bg(Sh.AFrame.Us)):this.focusManager.Bg(Sh.AFrame.jP);var ec=this.lb.gb.currentSelection;if(!ec||!ec.Ra)return 2;ka=ec.Ra.cpBegin;$a=ec.Ra.node;ec=!!this.iB&&(Nb.SelectionEditor.Dm(ec)||ec.PL)&&Oh.r(this.iB,$a,this.Ej,ka);ka=!!this.iB&&(2===this.mode||3===this.mode);if(ec||ka)return this.uL.GKj(this.iB.id,!0),32;ec=this.mE&&!this.Tg.kn?this.zj.Uvi(!0,!0):null;this.uL.ZMo(ec)}else this.zj.Pt&&(this.Mr.kmc.zKj(this.zj.Pt,
!0),this.Mr.kmc.Xrb(null===(ec=this.zj.Pt)||void 0===ec?void 0:ec.objectId)),this.focusManager.Bg(Sh.AFrame.Ho);return 32}eil(){return 4}vEn(ka){const $a=new Set;for(let Db=0;Db<ka.length;Db++){const ec=this.zj.z2c(ka[Db]);ec&&$a.add(ec.Mf?ec.Mf:ec.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",$a.size.toString())}ind(ka,$a){ka?this.TLb&&!this.Tg.s0?this.Tg.Bnb=Object.assign(new Me,{commentId:ka.id,T$c:!1}):this.L2.selectComment(ka,Object.assign(new oi.a,{sS:!!$a,Gca:$a})):
a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}n8l(ka){let $a=null,Db=!1;for(let ec=0;ec<ka.length;ec++){const sc=ka[ec].toString();if(this.zj.U_f(ka[ec])){$a||($a=sc);if(Db&&this.zj.Pt.objectId!==sc)return this.zj.e3(sc);Db=Db||!!this.zj.Pt&&this.zj.Pt.objectId===sc}}return $a?this.zj.e3($a):null}Xwe(ka){this.Tg.filter=ka;this.Z6a.onRibbonFilterChanged(ka);this.Sb.Ob(Ai.a.NHj,2);this.XH.m4("OnContentFilterUpdate")}l3d(ka,$a,Db){if(2===Db)this.Xwe({...this.Tg.filter,
resolutionStatus:2===this.Tg.filter.resolutionStatus?0:2});else if(1===Db&&!this.zj.PBa())return 2;return 32}m3d(ka,$a,Db){if(2===Db)this.Xwe({...this.Tg.filter,mentionsToCurrentUser:!this.Tg.filter.mentionsToCurrentUser});else if(1===Db&&!this.zj.PBa())return 2;return 32}n3d(ka,$a,Db){if(2===Db)this.Xwe({...this.Tg.filter,resolutionStatus:1===this.Tg.filter.resolutionStatus?0:1});else if(!(1!==Db||this.TLb.isVisible&&this.zj.PBa()))return 2;return 32}kve(ka,$a,Db){if(2===Db)this.Xwe({mentionsToCurrentUser:!1,
resolutionStatus:0});else if(1===Db&&!this.zj.PBa())return 2;return 32}}Object(f.a)(Eg,"CommentsActionManager",null,[]);var Hj=d(180),Ui=d(45),Wj=d(189),dj=d(1937),kk=d(563),Gb=d(35),Pc;(function(ka){ka[ka.FVp=0]="commentDeeplink";ka[ka.nml=1]="catchUpActivity"})(Pc||(Pc={}));Object(f.b)("DeeplinkSource",Pc);class xd{constructor(ka,$a,Db,ec,sc,ad,Xd,ue,ae,Te,sf,kg,qf){this.ga=ka;this.ti=$a;this.Ly=Db;this.YNe=ec;this.eT=sc;this.SEh=ad;this.Yb=Xd;this.Hj=ue;this.Ri=ae;this.pFb=Te;this.$Ne=sf;this.sJ=
kg;this.z9e=!1;this.fYo=fh=>{if(this.Ri.Pr&&!this.Hj.kn){const Fi=new wa.a(0,1,0,()=>{this.PMj(fh)},136,void 0,!0);y.AFrameworkApplication.mc.Zb(Fi)}else this.PMj(fh)};qf.execute(fh=>{this.qG=fh})}get Ip(){return this.ti}get lb(){return this.pFb.value}Fji(ka){let $a=ka.Nr===rg.a.dE?ka.KA.draftId:ka.id,Db=null;ka.Mf&&($a=ka.Mf,Db=()=>{this.SEh.selectComment(ka.id)});this.eT.setInitialActiveContainerId($a,0,Db)}QMo(ka,$a,Db,ec,sc){if(!sc.commentId)return 2;ka=this.ti.DF(sc.commentId);if(!ka)return 2;
this.Vxb(ka,sc);return 32}DKj(ka,$a){var Db,ec;if(ka){var sc=(null===(ec=null===(Db=this.ti.hz)||void 0===Db?void 0:Db.KA)||void 0===ec?void 0:ec.draftId)===ka?this.ti.hz:this.ti.DF(ka);this.selectComment(sc,$a)}}selectComment(ka,$a){ka&&this.Vxb(ka,$a)}AKj(ka,$a){var Db=this.W5d(ka);Db&&((Db=this.X5d(Db,0))?$a.NCg?(this.Hj.Bnb=Object.assign(new Me,{commentId:Db.id,T$c:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):(this.Vxb(Db,Object.assign(new oi.a,{commentId:Db.id,
Gca:1,sS:!0,f9c:!0})),this.Ri.Pr&&void 0!==ka&&null!==ka&&this.Fji(Db),zh.a.z6(y.AFrameworkApplication.mc,()=>{this.Yb.Bg(this.Ri.Pr&&!this.Hj.kn?Sh.AFrame.jP:Sh.AFrame.Us)},Bj.a.vTo),Hj.a.instance.uf(Ui.a.odi,(new Date).getTime()),ka=this.Ri.Pr?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",ka+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,ka,(new Date).getTime()-y.AFrameworkApplication.D2)):this.ga.Ob(Ah.a.Rbb,2))}W5d(ka){let $a=null;var Db=
null;if(V.a.Noc(ka))$a=ka;else if(({Zu:Db}=z.d(ka)).returnValue&&(ka=Db))return kk.a.comment in ka&&($a=ka[kk.a.comment]),$a;$a||(Db=Db?Object.keys(Db):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",Db?Db.join(","):"Not Json."));return $a?$a.toString():null}X5d(ka,$a){const Db=this.ti.z2c(ka),ec=0===$a;ec&&this.sJ.logKpiUsage(ea.a.TWd,0);if(!Db){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",ka,$a);const sc=new Gb.a;
sc.name="DeepLinkSource";sc.string=Pc[$a];this.sJ.logActivity("CommentDeeplinkNotFound",{dataFields:[sc]});ec&&($a=new N.a,$a.extendedProperties=new Map([["ErrorLevel","warning"]]),this.sJ.logKpiFailure(ea.a.TWd,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:$a}),this.$Ne.YMn=ka)}return Db}PMj(ka){this.z9e=!0;this.lb.Ic(ka);this.z9e=!1}Vxb(ka,$a){if(ka){this.Ri.dpb&&!this.Hj.zOa&&this.ga.Ob(Ai.a.mJg,2);this.Hj.pWb&&(y.AFrameworkApplication.mc.vf(this.Hj.pWb),this.Hj.pWb=null);
var Db=this.ti.Pt,ec=this.Ip.SMf(ka),sc=2===$a.Gca,ad={};sc&&(ad.TriggeredByFindReplace=!0);if(this.Hj.kn)sc&&(ad.PaneAlreadyOpen=!0),Wj.UISurfaces.Hv().then(Xd=>{Xd.setSelectedTaskPane(dj.a.cXd);return null});else if(ka.Nr!==rg.a.dE&&!this.Ip.Cta(ka))this.Hj.s0?this.ga.Ob(Ai.a.EY,2):this.Hj.Bnb=Object.assign(new Me,{commentId:ka.id,T$c:$a.f9c}),sc&&(ad.OpeningPaneToSelect=!0);else if(this.Ri.Pr){const Xd=ec.Nr===rg.a.dE;Xd?this.eT.p_a(ec.KA.draftId,0,$a.sS):this.eT.p_a(ec.id,0,$a.sS);!Xd&&sc&&(ad.SelectingDHC=
!0)}zh.a.z6(y.AFrameworkApplication.mc,()=>{this.Hj.s0&&($a.sS&&this.Yb.Bg(this.Ri.Pr&&!this.Hj.kn?Sh.AFrame.jP:Sh.AFrame.Us),$a.f9c&&this.Ip.Cta(ka)||!$a.sS&&!$a.Gca||this.SEh.selectComment(ka.id))},Bj.a.Gzg);sc=this.Ip.SMf(Db);this.qG&&sc&&sc.id!==ec.id&&this.qG.fireEvent(9,{comment:sc});this.ti.selectComment(ka);this.qG&&ka.Nr===rg.a.normal&&!ka.Mf&&this.qG.fireEvent(8,{comment:ka});this.YNe.highlightComment(ka,!0);this.Ly.qH(0,ec,Db);cc.StaticActiveAppFrame.za().Ie(!0);0<Object.keys(ad).length&&
this.sJ.Vw(Ai.a.selectComment,{Yl:ad})}}}Object(f.a)(xd,"CommentSelectionActor",null,[665]);class He extends Yg.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new sd.a,{T_:He.getTypeName(),B_:He.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(f.a)(He,"CommentSmartReplySignal",Yg.a,[]);class af extends Qa.a{constructor(){super();this.DomainName=this.CommentId=null;
this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new sd.a,{T_:af.getTypeName(),B_:af.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(f.a)(af,"SmartReply",Qa.a,[]);var mf=d(935);class dg{constructor(ka){this.Pwa=ka}Yfc(ka,$a){return Object.assign(new mf.a,{parentPath:["Signal",He.getTypeName()],items:[Object.assign(new We.a,{body:Object.assign(new He,{commentId:ka,comment:$a})})]})}Jlg(ka){const $a=
new nb.a;if(ka&&ka.CommentId&&ka.ResultSets&&0<ka.ResultSets.length&&ka.ResultSets[0].Documents&&0<ka.ResultSets[0].Documents.length){for(const Db of ka.ResultSets[0].Documents)$a.add(Db.Caption);0<$a.count&&this.Pwa.Jlg(ka.CommentId,$a.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return af.getTypeName()}}Object(f.a)(dg,"BaseCommentSmartReplyProvider",null,[1525]);class $f extends dg{constructor(ka,$a,Db,ec){super(ka);this.Re=$a;this.MC=
Db;this.zok=ec}initialize(){this.MC.Pl().then(()=>{this.Re.nb(this,dg.prototype.getTypeName.call(this))})}invoke(ka,$a){this.MC.Pl().then(()=>{this.zok.getAugLoopRuntimeManager().submitOperation(Object.assign(new Zg.a,{operation:this.Yfc(ka,$a)}))})}lD(ka,$a){ka&&oa.a.getTypeNameFor(ka.content)===this.getTypeName()&&$a===ya.a.getTypeName()?this.Jlg(ka.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(f.a)($f,"CommentSmartReplyProvider",dg,[223]);var ih=
d(42),bi=d(144),Hg=d(748);class Og{constructor(ka,$a,Db,ec,sc,ad){this.Ga=ka;this.xd=$a;this.Oy=Db;this.N_e=ec;this.$Ne=sc;this.aQ=ad;this.kEb=!1;this.$Ne.jwo();this.fch=this.hCm();this.Cqg&&(ih.a.addHandler(window.self,Vk.a.qRh,()=>{this.kEb=!0}),ih.a.addHandler(window.self,Vk.a.rRh,()=>{this.kEb=!1}));0<this.fch&&y.AFrameworkApplication.Ld("77dda873;fe8jd931")}get lv(){return this.Oy?this.Oy.value:null}get cJa(){return this.N_e.value}get Hqp(){return this.kEb}get Rlc(){return 0<this.fch}get Pr(){return this.aQ.Pr}get KUl(){return!0}get B1b(){return this.xd.isFeatureEnabled(110)&&
!Hg.a.j$c}get hOo(){return this.xd.isFeatureEnabled(33)&&this.Ga.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get Avl(){return this.Ga.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get Cqg(){return!1}get mhj(){return this.Ga.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get lNb(){return this.Pr&&!this.Rlc&&!this.Ga.kb("BootActivityNavigationId")&&F.a.ju}get V$k(){return this.Ga.$("AtMentionUserFloodGateCampaignIsEnabled")}get Rvl(){return this.Ga.$("CommentFriendlyTimestampsIsEnabled")}get AUl(){return this.Ga.kb("DisabledChangeGatesInSharedComments")}get Z3d(){return this.aQ.Z3d}get S0b(){return F.a.XR?
this.zAe:this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",!1)}get zAe(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.SimpleMarkupModeInSafari",!1)}get IIo(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightAlignedEntrypointIsEnabled",!1)}get AEg(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",!1)}get N0(){return this.Ga.kb("PresenceUserId")}get fha(){return Hg.a.eHe&&!!bi.PageReader.instance&&
bi.PageReader.instance.rBa(cc.StaticActiveAppFrame.za().ib.$c).fha}get epb(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",!1)}get whp(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1)}get dpb(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.HideCommentsByDefaultEnabled",!1)}get Hwl(){return this.Ga.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",
!1)}get Hyn(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.aQ.contentNavigationApiEnabled}get E6n(){return this.xd.isFeatureEnabled(83)}get contentFilterApiEnabled(){return this.aQ.contentFilterApiEnabled}get y9o(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipParaTraversalIfNoComments",!1)}get grl(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClearCommentHighlightsFix",
!1)}get ribbonCommentFilteringEnabled(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCommentFilteringEnabled",!1)}get jVh(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.AtMentionBookmarkFixup",!1)}hCm(){if(this.lv&&this.cJa){const ka=new cg.GraphIterator;ka.set(this.lv);this.cJa.Kbb(ka);let $a=0;39===ka.lf&&($a=ka.Dq());return $a}return-1}}Object(f.a)(Og,"CommentsSettings",null,[]);class zd{constructor(){this.E8g=null;this.s0=!1;this.pWb=this.Bnb=null;
this.rz=new vf.a(new Xc.a);this.XX=new vf.a(new Xc.a);this.bqg=this.QRb=!1;this.zOa=!0;this.filter={mentionsToCurrentUser:!1,resolutionStatus:0}}get kn(){return eb.a.kn}set kn(ka){eb.a.kn=ka}get Vlb(){return this.E8g}set Vlb(ka){this.E8g=ka}}zd.qk=1;Object(f.a)(zd,"CommentsState",null,[]);var Zd=d(1424);class df{constructor(ka){this.xda=ka}$Xh(ka,$a,Db){const ec=new Zl;$a=this.xda.TXa($a)?$a.objectId:null;if(!$a)return ec;$a=ma.a.Cf($a);if(Db.contains($a))return ec.A7c=0,ec.z7c=ka.length,ec;for(let ad=
0,Xd=ka.length;ad<Xd;ad++){var sc=ka[ad];Db=Oh.g(sc);sc=Oh.d(sc);Db&&Zd.a.W6h(Db,$a)&&(ec.A7c=ad);if(sc&&Zd.a.W6h(sc,$a)){ec.z7c=ad;break}}return ec}vTh(ka,$a,Db){const ec=-1===$a.A7c&&-1===$a.z7c,sc=-1<$a.A7c?$a.A7c:-1;$a=-1<$a.z7c?$a.z7c:ka.length;const ad=!ec&&sc===$a;var Xd=!1;for(let ue=0;ue<ka.length;ue++){const ae=ka[ue],Te=dk.a(ae);if(1!==Te&&2!==Te&&3!==Te)continue;this.xda.TZa(ae);if(ec||ue<sc||ue>$a)continue;const sf=3===Te||2===Te&&-1!==ae.className.indexOf(nj.a.SWa),kg=Db?1:2;this.s8k(ue,
sc,$a,kg,sf,Xd,ae,ad);if(ue!==$a||ad)(Xd=this.xda.j$a.J(Te).J(kg))&&ae.classList.add(Xd),Xd=sf}}s8k(ka,$a,Db,ec,sc,ad,Xd,ue){ka!==$a&&ka!==Db||sc||ad||((ka=this.xda.Xtc.J(ec))&&Xd.classList.add(ka),ue&&Xd.classList.add(nj.a.hlg))}}Object(f.a)(df,"DefaultHighlightChangeHandler",null,[664]);var An;(function(ka){ka[ka.success=0]="success";ka[ka.oo=1]="noSelection";ka[ka.F4p=2]="invalidContent"})(An||(An={}));Object(f.b)("AnchorCreationResult",An);var Fg=d(66),ym=d(25),dm=d(295),zm=d(256),Mh=d(1295);
class hi{}Object(f.a)(hi,"EditorAnchorInfo",null,[690]);class Lc{constructor(ka,$a,Db,ec,sc,ad,Xd,ue,ae){this.byn=ka;this.P3f=$a;this.zj=Db;this.bCa=ec;this.bJa=sc;this.lo=ad;this.XH=Xd;this.Vs=ue;this.DJg=ae;this.JEh=null;this.bCa.QZa(this.bJa);this.Vs.contentFilterApiEnabled&&(this.XH.o4("OnCommentPaneOpen",this.Mwp.bind(this)),this.XH.o4("OnCommentPaneClose",this.Lwp.bind(this)),this.XH.o4("OnContentFilterUpdate",this.qfd.bind(this)))}get lb(){return this.P3f.value}get Ej(){return this.byn.value}initialize(){}c7m(ka){this.JEh=
ka}dispose(){}Xrb(ka){this.bJa.Xrb(ka)}jmc(ka){this.bJa.jmc(ka)}highlightComment(ka){this.zKj(ka,!1);this.bJa.Xrb(ka.objectId)}XAc(ka){this.bJa.XAc(ka)}KKa(ka){return this.bJa.KKa(ka)}qfd(){this.fJe("OnContentFilterUpdate")}Mwp(){this.fJe("OnCommentPaneOpen")}Lwp(){this.fJe("OnCommentPaneClose")}fJe(ka){const $a=[],Db=new Set;for(const sc of this.zj.xR())if(!sc.Mf&&sc.Nr!==rg.a.dE&&!this.zj.uL.C_h(ka,sc)){var ec=this.lDm(sc);Db.has(ec.id.toString())||(Db.add(ec.id.toString()),(ec=ec.ue(Object(Fg.a)().zd.oc))&&
$a.push(ec))}$a.forEach(sc=>{this.bCa.YAc(sc)})}lDm(ka){var $a,Db,ec;const sc=null===($a=this.Ej)||void 0===$a?void 0:$a.Eb(ka.objectId);if(!sc)return null;ka=Oh.k(sc);$a=null===(Db=this.Ej)||void 0===Db?void 0:Db.Eb(ka);return null===(ec=this.DJg.instance)||void 0===ec?void 0:ec.OQb($a)}zKj(ka,$a){if(!ka.Nr){var Db=this.Ej.Eb(ma.a.Cf(ka.objectId)),ec=fd.a.Cfa(Db,this.Ej,!0);Db=fd.a.Cfa(Db,this.Ej,!1);if(ec&&Db){const sc=ec.Jb.paragraph;ec=ec.Jb.cp;if(this.Nqn(sc,ec))cc.StaticActiveAppFrame.za().Ie(!0);
else{ec=ym.SelectionFactory.se(sc,ec);Db=ci.a.Tc(Db.Jb.paragraph,Db.Jb.cp);if(Lc.mg.Bba(ec.Ra)||Lc.mg.Bba(Db))ka.CXa=!0,ka.Ibb();ka=$a?ym.SelectionFactory.$y(ec,Db):ec;this.JEh(ka)}}}}trl(){this.bJa.jmc(null);this.bJa.Xrb(null)}jDl(){const ka=new hi;return{returnValue:An.success,anchor:ka}}Nqn(ka,$a){if(ka&&Object(jk.a)(Mh.MainView,this.lo.zd)){var Db=ka.ue(this.lo.zd.oc);ka=document.getElementById(ui.a.c1a);if(Db&&ka){$a=dm.a.Jr(Db,$a);if(!$a)return!1;$a=$a.y;Db=Sys.UI.DomElement.getBounds(ka).y;
ka=ka.offsetHeight;if($a>=Db&&$a<=Db+ka)return!0}}return!1}static get mg(){return zm.a.instance}static getInstance(){return Lc.Qm()}static Qm(){return Lc._instance||(Lc._instance=new Lc(new Q.a(()=>cc.StaticActiveAppFrame.za().ib.$c.td),new Q.a(()=>Zf.a.instance),H.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),H.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,H.a.instance.resolve("WordEditor.Comments.CommentHintActor"),Object(Fg.a)(),H.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),
H.a.instance.resolve("WordEditor.Comments.CommentsSettings"),H.a.instance.Qa("WordEditor.Indicator.TopLevelOutlineElementCache")))}}Lc._instance=null;Object(f.a)(Lc,"EditorCommentHintManager",null,[662,663,13]);var wh=d(94),lg=d(2173),ii=d(379),Qh=d(1238);class fk extends qd.a{constructor(ka,$a,Db,ec,sc,ad,Xd,ue,ae,Te,sf,kg,qf,fh,Fi,Nj,Zh,hk,km,lm,Rl,Oj,Fn,em,dn,Lo){super(Xd);this.Ei=$a;this.pFb=ue;this.xqf=Te;this.Qwa=sf;this.ZEc=kg;this.eT=qf;this.Ri=fh;this.Rp=Fi;this.w5b=Nj;this.Hj=Zh;this.A1=
hk;this.Vd=lm;this.sJ=Rl;this.JW=Fn;this.Z6a=em;this.DJg=Lo;this.FOi=this.IGh=this.Y2a=null;this.uvb=()=>{this.ywa.Ota()&&(this.YAj(this.ywa.sc),this.ywa.uvc(this.uvb))};this.Mdd=Gi=>{2===Gi.mode?this.aF=1:1===Gi.mode&&(this.aF=0);this.ti.hz&&0===this.aF?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.ti.hz.KA.sessionType):this.Hj.s0&&(this.mE||this.w5.isVisible)&&this.fZb()};this.bUn=()=>{this.Hj.QRb?this.mode=0:this.aF=
0};this.eNa=(Gi,en)=>{var uk;Gi=en.Gm.currentSelection;if((this.mE||this.Tga&&this.Tga.isVisible)&&!this.w5b.z9e&&Gi){en=Nb.SelectionEditor.Dm(Gi);var pj=Gi.PL;null!==(uk=this.FOi)&&void 0!==uk&&uk.hfa||(this.Ip||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),uk=this.Ip&&this.Ip.Tsb(this.ga,!1),1!==this.mode||en&&!pj||!uk?this.ZEc.Gae():this.rHl(Gi));2!==this.mode&&3!==this.mode&&this.Ri.Avl&&this.Mop(Gi,en,pj)}};this.Rol=()=>{if(this.zj&&this.zj.hz&&!P.App.sXf){var Gi=
this.zj.hz;Gi.KA.sessionType!==lg.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${Gi.Nr} present on app shutdown`),(Gi=Tb.a.mqm(Gi))&&this.sJ.logKpiFailure(Gi,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:ea.a.QLb,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.lUn=()=>{if(this.Hj.s0){var Gi=()=>!0;this.mE&&!this.Hj.kn&&(Gi=en=>this.Ip.Cta(en));Gi=this.Ip.PHf(Gi);this.fZb(Gi)}};this.ga=Xd;this.aF=1===this.ga.mode?0:1;this.w5=sc;this.ti=ec;this.Nda=
ad;this.Yb=ae;this.jvo();Db.idb(this.Qwa);this.lb.Cw(this.eNa);ka.CWR(()=>ka.result.qC.hza(this.bUn));y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Z5a(this.Mdd);this.A1.o4("OnAfterTrackChangeMarkupViewChange",this.lUn);y.AFrameworkApplication.aJ&&y.AFrameworkApplication.aJ(this.Rol);dn.execute(Gi=>{this.qG=Gi});Oj.execute(Gi=>{Gi.FAl.execute(en=>{this.FOi=en})})}jvo(){this.ywa&&(this.ywa.Ota()?this.YAj(this.ywa.sc):this.ywa.Mcc(this.uvb))}YAj(ka){ka.A6(()=>{this.gcp()})}get ywa(){var ka;
return null===(ka=Hg.a.en)||void 0===ka?void 0:ka.ib}get lb(){return this.pFb.value}get zj(){return this.ti}get Ip(){return this.ti}get mE(){return this.Ri.Pr}get Ygj(){return!0}get sLj(){return!0}get umc(){return this.Y2a}set umc(ka){this.Y2a=ka}get mode(){return super.mode}set mode(ka){ka!==this.aF&&(super.mode=ka,this.Ibb())}get iB(){return this.model&&this.model.Pt?this.model.Pt.Mf?this.model.DF(this.model.Pt.Mf):this.model.Pt:null}get Ej(){return this.Ei.value}get XTj(){return!1}get fha(){return this.Ri.fha}fZb(ka=
null,$a=null){const Db=this.Ip,ec=!this.aF,sc=this.Tga.Ovl,ad=Db.j8d();sc.zMg(ad?5:1,ec);ka=this.Ri.S0b&&ka?ka:Db.nIf(this.Ri.S0b&&this.mE&&!this.Hj.kn);sc.aOo(ka,ad,Db.Q1a);this.dMg();$a&&a.ULS.sendTraceTag(572281362,327,50,$a)}rfd(ka,$a,Db=!1){this.Hj.kn?this.eT.l9j():$a?this.eT.IJa(ka.Nr===rg.a.dE?ka.KA.draftId:ka.id,0,Db):this.nno(ka)}nno(ka){const {tjp:$a}=this.ti.ewm(ka),Db=this.Nda.KKa(ka.objectId);Db&&this.eT.ucc(ka.id,Db.parentElement,0,$a)}JKj(ka){const $a=this.iB;this.knd();this.Qwa.qH(0,
this.ti.Pt,$a);this.mE&&this.ti.Pt&&!this.Hj.kn&&this.eT.p_a(this.ti.Pt.id,0,1===ka)}$Mo(){const ka=this.iB;this.lnd();this.Qwa.qH(0,this.ti.Pt,ka);this.mE&&this.ti.Pt&&!this.Hj.kn&&this.eT.p_a(this.ti.Pt.id,0,!1)}XAc(ka){this.Nda.XAc(ka)}j_l(ka,$a){this.eT.ucc(ka,null,0,$a)}H$n(ka){this.eT.Gsj(ka)}l_l(ka,$a){this.eT.nld(ka,$a,0)}Vvp(){this.eT.Vjf()}CKj(ka){if(ka&&(2!==this.mode||ka.Nr===rg.a.dE)){var $a=this.ti.Pt;$a!==ka&&(this.ti.selectComment(ka),this.w5.isVisible?this.Hj.s0?(this.w5.selectComment(ka,
1),this.jpa.selectComment(ka.id)):this.Hj.Bnb=Object.assign(new Me,{commentId:ka.id,T$c:!1}):this.mE&&!ka.done&&(this.GKj(ka.id,!1),this.jpa.selectComment(ka.id)),!this.w5.isVisible&&this.mE&&ka.done||(this.kmc.Xrb(ka.objectId),this.Qwa.qH(0,this.iB,$a)))}}Q7c(){}QAf(){this.Hj.QRb=!1}VJb(ka){this.Ri.mhj&&this.ti.Pt&&this.clearSelection();super.VJb(ka);this.sJ.logKpiUsage(ea.a.Kqf,0);this.dMg();if(this.mE){const $a=this.ti.oOm(ka.draftId);this.j_l(ka.draftId,$a)}}$lb(ka,$a){this.sJ.logKpiUsage(ea.a.eXd,
0);super.$lb(ka,$a)}Uza(ka){this.mE&&null!=ka.KA&&this.ti.bCj(ka.KA.draftId);super.Uza(ka);this.Nda.Xrb(ka.objectId);a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",Oh.a(ka));this.sJ.logKpiUsage(ea.a.b5h,0);this.Xol(ka);Tb.a.JDp(ka,this.Ej,this.sJ);this.sJ.Vw(Ai.a.a5h,{succeeded:!0,Yl:{actionType:ka.Mf?lg.a.reply:lg.a.create}})}Dnb(ka){super.Dnb(ka);this.sJ.Vw(Ai.a.a5h,{succeeded:!0,Yl:{actionType:lg.a.Oob}})}Xol(ka){if(ka.Mf){var $a=this.ti.SMf(ka);if($a.bTc&&$a.cTc){var Db=this.Ej.Eb(ma.a.Cf($a.cTc));
$a=$a.cTc===$a.bTc?null:this.Ej.Eb(ma.a.Cf($a.bTc));Tb.a.BRg(Db,ka,!0);Tb.a.BRg($a,ka,!1)}}}OYc(ka){super.OYc(ka);this.iB&&this.iB.id===ka.id&&(super.clearSelection(),this.mE&&this.eT.Vec());if(this.mE)if(Oh.s(ka)){var $a=[];let Db=null;for(const ec of this.model.xR())ec!==ka&&(ec.Mf===ka.Mf&&$a.push(ec),ec.id===ka.Mf&&(Db=ec));Db&&Db.id&&Db.objectId&&!Db.done&&this.Ip.yI(Db.objectId)&&!this.Ip.stj(Db.objectId)&&!$a.length&&this.rfd(Db,!0)}else $a=ka.Nr===rg.a.dE,ka.done||this.rfd(ka,!0),$a&&this.ti.bCj(ka.KA.draftId)}Pob(ka,
$a){1===this.mode&&ka&&(this.ti.XZc(ka,$a),lg.a.Oob===$a.sessionType&&this.sJ.logKpiUsage(ea.a.g5h,0),this.Ri.B1b&&3!==lg.a.WKf($a.sessionType)&&this.w5b.selectComment(ka,Object.assign(new oi.a,{sS:!1,Gca:0})))}Ewe(ka){this.mE&&!this.Hj.kn||super.Ewe(ka)}deleteComment(ka){ka.Nr!==rg.a.dE&&this.Ip.Nei(ma.a.Cf(ka.objectId));this.Y2a&&this.Y2a.id===ka.id&&(this.ti.Pt&&this.Y2a.id===this.ti.Pt.id?this.Y2a=null:this.Qwa.kpf());!this.ti.Pt||this.ti.Pt.id!==ka.id&&this.ti.Pt.Mf!==ka.id?this.ti.Pt&&this.Qwa.qH(0,
this.ti.Pt,null):void 0===ka.Mf||null===ka.Mf?this.clearSelection():this.ti.selectComment(this.ti.DF(ka.Mf));ka.CXa&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",Oh.a(ka));super.deleteComment(ka);a.ULS.sendTraceTag(50426377,327,50,`${Oh.a(ka)} deleted by user action. DurableId: ${ka.a8a}`)}xLb(ka,$a){super.xLb(ka,$a);this.mE&&!this.Hj.kn&&$a&&(this.ti.Pt&&this.ti.Pt.id===ka.id&&this.clearSelection(),this.umc&&this.umc.id===ka.id&&this.Qwa.kpf())}ZMo(ka=
null){(ka=this.Ip.kmm(ka))?this.w5b.selectComment(ka,Object.assign(new oi.a,{sS:!0,Gca:1})):this.JKj(1)}rHl(ka){var $a,Db=this.ywa.sc;if(Db){var ec=ka.Ra.node,sc=null===($a=this.DJg.instance)||void 0===$a?void 0:$a.OQb(ec);if(sc)for(const ad of Db.r7(sc))if(ad&&ad instanceof ii.a&&($a=ad,Db=Qh.a.Dai($a),this.ZEc.XFe=this.J6l(ec,ka),sc=this.sjl(Db),null!==sc)){if(ka=this.ZEc.A6l(Db,sc))Db.aCa[sc].appendChild(ka),$a.XF(ka);break}}}J6l(ka,$a){let Db;for(const ec of ka.jJ)if(ec&&ec){Db=ec;break}ka=$a.Ra.lk;
$a=!(null===Db||void 0===Db||!Db.Op)&&0<Db.Op.length;return 0>ka||!$a||null===Db||void 0===Db||!Db.NBf?null:dm.a.F2(ka,Db,!1,!1)}sjl(ka){var $a;const Db=null===($a=this.ZEc.XFe)||void 0===$a?void 0:$a.y;for(const [ec,sc]of ka.E7.entries())if(ka=Db-sc.y,-2<=ka&&ka<sc.height+2)return ec;return null}Ibb(){P.App.Hrb=2===this.mode||3===this.mode;1!==this.mode&&this.ZEc.Gae()}Mop(ka,$a,Db){const ec=this.Yb.currentScope;let sc=null;if($a||Db){$a=ka.Ra.cpBegin;ka=ka.Ra.node;if(this.iB&&Oh.r(this.iB,ka,this.Ej,
$a))return;sc=this.MAm(ka,$a)}sc?!this.mE||this.Hj.kn?zh.a.z6(y.AFrameworkApplication.mc,()=>{this.CKj(sc)},Bj.a.SMo):this.CKj(sc):!this.ti.Pt||ec&&ec.name===Sh.AFrame.jP||this.clearSelection()}MAm(ka,$a){let Db=null;const ec=this.model.xR();for(let sc=ec.length-1;0<=sc;sc--){const ad=ec[sc];if(ad.objectId&&!(ad.Mf||this.mE&&!this.Tga.isVisible&&ad.done)&&Oh.r(ad,ka,this.Ej,$a)){Db=ad;break}}return Db}selectComment(ka,$a=1){this.w5b.DKj(ka,Object.assign(new oi.a,{sS:1===$a,Gca:$a}))}GKj(ka,$a){const Db=
this.ti.DF(ka);Db?this.mE&&!Oh.s(Db)&&Db.Nr!==rg.a.dE&&this.eT.p_a(ka,0,$a):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const ka=this.model.Pt;this.qG&&ka&&this.qG.fireEvent(9,{comment:ka});super.clearSelection();this.Qwa.qH(1,ka,ka);this.mE&&ka&&this.eT.Vec()}oqn(){var ka;return 500>(null===(ka=this.IGh)||void 0===ka?void 0:ka.Fi)}vsc(ka,$a=1){if(!this.Ri.mhj||!this.ti.hz){var Db=this.ti.DF(ka),ec=null;Db||(ec=this.Y2a);var sc=this.oqn(),ad=!1;1===
$a&&this.jpa&&(sc?ad=!0:this.jpa.highlightComment(ka));ka?Db?sc?ad=!0:this.Nda.jmc(Db.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.Nda.jmc(null);Db?sc?ad=!0:(this.Y2a=Db,this.Qwa.qH(2,Db,ec)):(this.Y2a=null,this.Qwa.qH(3,null,ec));ad&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}gcp(){this.Vd&&(this.IGh=this.Vd.Vf("UserAction","StartScrollDetectionStopwatch"))}notify(ka,
$a){this.Rp.sendNotification(ka,$a)}dMg(){this.Z6a.onContentChanged()}C_h(ka,$a){var Db,ec;switch(ka){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.s9o($a);case "OnContentFilterUpdate":return!(null===(ec=(Db=this.Z6a).isContentInFilterUpdateDiff)||void 0===ec?0:ec.call(Db,$a.id));default:return!0}}s9o(ka){return!ka.done&&this.Ip.Cta(ka)===this.Z6a.isContentInFilteredContent(ka.id)}static getInstance(){return fk.Qm()}static Qm(){fk.ih||(fk.ih=new fk(wh.StaticTheCoauthManager.bta(),
new Q.a(()=>cc.StaticActiveAppFrame.za().ib.$c.td),H.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,H.a.instance.resolve("Common.Comments.ICommentModel"),H.a.instance.resolve("Common.Comments.ICommentPane"),Lc.getInstance(),y.AFrameworkApplication.va,new Q.a(()=>Zf.a.instance),Il.FocusManager.instance(),H.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),H.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),H.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),
H.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),H.a.instance.resolve("WordEditor.Comments.CommentsSettings"),H.a.instance.resolve("Common.Utils.IAriaNotifier"),H.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),H.a.instance.resolve("WordEditor.Comments.CommentsState"),H.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),Hg.a.en.ib.sc,cc.StaticActiveAppFrame.za().hs,H.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),H.a.instance.Qa("WordEditor.HeaderFooter.HeaderFooterControlOwner"),
H.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),H.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),H.a.instance.Qa("WordEditor.Extension.RichApiEventManager"),H.a.instance.Qa("WordEditor.Indicator.TopLevelOutlineElementCache")),fk.ih.m0b=!0);return fk.ih}}fk.ih=null;Object(f.a)(fk,"EditorCommentManager",qd.a,[659,660,661,13]);var bl=d(1873);class Ji{constructor(ka,$a,Db,ec){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=
ka;this.body=$a;this.confirmButton=Db;this.cancelButton=ec}}Object(f.a)(Ji,"ViewContainerModalDialogStrings",null,[]);d(1551);class yl{constructor(ka,$a){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=ka;this.canvasContextId=$a}}Object(f.a)(yl,"CommentUIAction",null,[]);var ej=d(1139);class ch{constructor(ka,$a,Db,ec,sc,ad,Xd,ue,ae,Te,sf,kg,qf,fh,Fi,Nj,Zh){this.ga=
ka;this.Pg=$a;this.ne=Db;this.Yb=ec;this.aq=sc;this.gi=ad;this.q6=Xd;this.Pwa=ue;this.VPd=ae;this.Qcf=Te;this.Gb=sf;this.eT=kg;this.Ri=qf;this.Hj=fh;this.w5b=Fi;this.A1=Nj;this.gpa=Zh;this.YNe=this.Gj=null;this.NEh=this.G8g=!1;this.hOc=null;this.K6o=(hk,km,lm)=>2!==lm||this.Hj.s0?1===lm?32:2:(this.A1.m4("OnCommentInit",Object.assign(new Pd.a,{NMa:()=>{this.ga.Ob(Ah.a.EY,2)}})),32);this.bVf=(hk,km,lm)=>1!==lm||this.Hj.s0?2:8;this.IUk=(hk,km,lm)=>{if(1===lm)return!this.Tsb()||this.Zlb?8:this.Hj.s0?
2:32;if(!this.Hj.s0)return this.Zlb=!0,this.A1.m4("OnCommentInit",Object.assign(new Pd.a,{NMa:()=>{this.Pr||this.Hj.kn||this.ga.Ob(Ah.a.EY,2)}})),32;this.Pr||this.Hj.kn||this.ga.Ob(Ah.a.EY,2);(this.Pr||this.Hj.kn)&&this.Yb.Bg(this.Hj.kn?Sh.AFrame.Us:Sh.AFrame.jP);return 2};this.CPl=(hk,km,lm)=>1===lm&&yc.SessionStatusManager.instance.Gk?8:2;this.gUl=(hk,km,lm,Rl)=>1!==Rl||(this.Pr||this.isVisible)&&this.Gj.model.Pt?hk||this.Gj.model.Pt?32:8:8;this.Urb=(hk,km,lm,Rl,Oj)=>{if(1===lm||!this.Hj.kn)return 32;
if(!this.Pr&&2===lm&&(2===this.Gj.mode||3===this.Gj.mode))return Oj=new Ji(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.VPd.invokeModalConfirmationDialog(()=>{this.jWn(hk,km,lm,Rl)},()=>{this.oVn()},Oj),32;this.Iae();if(this.Pr)return 32;Oj&&this.Dji();return 32};this.DYb=(hk,km,lm,Rl,Oj)=>{if(1===lm)return 32;Oj[Nd.a.On]=this.isVisible;return 32};this.aDc=this.cDl()}get isVisible(){return this.Hj.kn}get Zlb(){return this.G8g}set Zlb(ka){this.G8g=
ka}get A0o(){return"SharedCommentsTaskPaneProps"}get Ogd(){return null}get Ngj(){return null}get PG(){return this.aq}get Tga(){return null}get Ovl(){return this.Pwa}get Pr(){try{return this.Ri.Pr}catch(ka){return!1}}VBi(){return new Ad(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}cDl(){const ka=new Bg.a,$a=new yl(Ah.a.IMa,wb.a.frame);$a.preCallback=this.IUk;const Db=new yl(Ai.a.ecg,wb.a.frame),ec=new yl(Ai.a.zmg,
wb.a.frame),sc=new yl(Ai.a.deleteComment,wb.a.frame);sc.preCallback=this.CPl;sc.postCallback=this.gUl;const ad=new yl(Ai.a.NHj,wb.a.frame);this.Pr&&(Db.preCallback=this.bVf,ec.preCallback=this.bVf,ad.preCallback=this.bVf);const Xd=new yl(Ah.a.EY,wb.a.frame);Xd.preCallback=this.K6o;ka.Z(6,Xd);ka.Z(0,$a);ka.Z(1,Db);ka.Z(2,ec);ka.Z(3,sc);ka.Z(7,ad);return ka}mRj(ka){this.NEh||(this.SPk=this.c9d(),this.q6.NUa(),this.M_o(),this.G_o(ka),this.NEh=!0)}G_o(ka){this.Gj=ka;this.YNe=ka.kmc;this.Gj.Qli=this.Pwa}initialize(ka){this.mRj(ka);
this.Wb()}zVf(){this.hOc&&this.Yb.Bg(Sh.AFrame.Us);this.Zlb&&!this.Pr?(this.ga.Ob(Ah.a.IMa,2),this.Zlb=!1):this.Hj.Bnb&&zh.a.z6(y.AFrameworkApplication.mc,()=>{const ka=this.Hj.Bnb.commentId,$a=this.Hj.Bnb.T$c;this.ga.Pb(Ai.a.selectComment,2,Object.assign(new oi.a,{commentId:ka,Gca:1,sS:!0,f9c:$a}));$a&&(zh.a.z6(y.AFrameworkApplication.mc,()=>{this.Yb.Bg(Sh.AFrame.Us)},Bj.a.Gzg),Hj.a.instance.uf(Ui.a.odi,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",
(new Date).getTime()-y.AFrameworkApplication.D2);this.Hj.Bnb=null},Bj.a.RMo)}dispose(){}U8(){}selectComment(){this.isVisible||this.Pr||this.FUj();this.gi.Ie(!0)}Wb(){this.ga.ra(Ah.a.Urb,wb.a.frame,this.Urb);this.ga.fb(Ah.a.DYb,wb.a.frame,this.DYb,96)}Ibb(){-1!==this.Gj.mode&&(this.Gj.mode||this.Dji())}Dji(){const ka=this.Gj,$a=ka.Ip,Db=$a.j8d(),ec=$a.nIf(this.Ri.S0b&&this.Ri.Pr&&!this.Hj.kn);this.Pwa.$No(ec.length,Db,!ka.mode,Db?5:1);this.Pwa.yOo(ec,$a.Q1a)}M_o(){const ka=this.Yb.ge(Sh.AFrame.Us);
ka.parent=Sh.AFrame.mq;ka.iK=!0;ka.amd=!0;ka.P0a=!0;ka.KTa(($a,Db)=>{kl.a.B_h(Db.name)&&(this.Hj.pWb=zh.a.z6(this.Gb,()=>{Db.name!==Sh.AFrame.jP&&2!==this.Gj.mode&&3!==this.Gj.mode&&(this.Gj.clearSelection(),this.gi.Ie(!0));this.Hj.pWb=null},Bj.a.$Vn))});this.aq.xW(Sh.AFrame.Us);for(const $a of Oh.u)ka.bindAction(Kh.KeyInputManager.sI($a),Ai.a.Rmf)}iTo(){this.hOc&&this.Qcf.ybm()}C1h(){this.Zvk&&this.iTo()}jWn(ka,$a,Db,ec){const sc=this.Gj,ad=sc.Ip.hz;ad&&ad.KA?sc.xqf.endCommentSession(ad.KA.draftId):
a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.Urb(ka,$a,Db,ec,!0);zh.a.z6(this.Gb,()=>{this.gi.Ie(!0)},Bj.a.HIo)}oVn(){this.hOc&&this.Yb.Bg(Sh.AFrame.Us);this.gi.Ie(!0)}HNa(ka){ka.tt(this.Yb.MZ);ka.tt(this.Yb.NZ)}I0b(ka,$a,Db){if(1===Db)return 32;this.FUj();return 32}FUj(){this.isVisible||(this.Ri.dpb&&(this.Hj.zOa=!0),this.Hj.s0?(this.hVl(),this.Hj.kn=!0,this.A1.pte(),this.Yb.eSc(Sh.AFrame.Us),this.Pr&&this.Ri.S0b&&this.Gj.fZb(this.Gj.model.PHf(()=>
!0)),this.Zvk=!0,Wj.UISurfaces.Hv().then(ka=>{ka.showTaskPane(dj.a.cXd,this.SPk);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.Gj.vsc(null),this.gi.Ie(!0),this.HNa(this.Yb.ge(Sh.AFrame.Us)),this.A1.m4("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.A1.m4("OnCommentInit",Object.assign(new Pd.a,{NMa:()=>{this.Hj.kn||this.ga.Ob(Ah.a.EY,2)}})))}hVl(){this.ga.Pb(Ai.a.Z6,2,null);this.ga.Pb(Ai.a.VW,2,null)}Tsb(){return this.gpa.Tsb(this.ga,
!1)}VJb(){}show(){this.isVisible||this.ga.Ob(Ah.a.EY,2)}Pob(){return 2}Iae(){this.Gj.h8n();this.Hj.kn=!1;if(this.Pr&&this.Ri.S0b){const $a=this.Gj.model;this.Gj.fZb($a.PHf(Db=>$a.Cta(Db)))}var ka=Il.FocusManager.instance();ka.currentScope&&ka.currentScope.name===Sh.AFrame.Us&&ka.Bg(this.Pr&&(2===this.Gj.mode||3===this.Gj.mode||this.Gj.zj.Pt)?Sh.AFrame.jP:ka.RW);this.aq.ny(Sh.AFrame.Us);this.Yb.yYc(Sh.AFrame.Us);Wj.UISurfaces.Hv().then($a=>{$a.hideTaskPane(dj.a.cXd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,
327,10,"Error hiding Comment Pane.")});this.Pr&&(ka=this.Gj.model.Pt)&&this.Xup(ka);this.A1.m4("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}Xup(ka){ka.done?this.Gj.clearSelection():this.w5b.Fji(ka)}o3n(ka=null){this.Qcf.GQj(3);this.zVf();if(ka){this.C1h();ih.a.lrg(ka,[Vk.a.contextMenu]);const $a=this.Yb.ge(Sh.AFrame.Us);this.Pg.vcc(Sh.AFrame.Us,ka,$a.P0a)}}U0n(ka){this.aq.bL(Sh.AFrame.Us);1!==ka&&zh.a.z6(y.AFrameworkApplication.mc,()=>{this.Yb.ME(Sh.AFrame.Us)},
Bj.a.Gzg)}onTaskPaneClose(){this.Hj.s0&&this.Qcf.GQj(1)}c9d(){const ka={type:this.A0o,q0p:this.C1h};return Object.assign(new ej.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:ka,hideHeader:!1,width:300,location:2,onOpen:$a=>{this.hOc=$a;this.o3n($a);this.eT.qJg(!0)},onClose:()=>{this.hOc=null;this.ga.Pb(Ah.a.Urb,2,!0);this.gi.Ie(!0);this.onTaskPaneClose();const $a=this.Gj.Ip;this.Hj.zOa&&$a.U5c()&&this.eT.qJg(!1)},onShow:$a=>{this.U0n($a)}})}EY(){return 32}}Object(f.a)(ch,"OfficeSharedCommentPane",
null,[13,653,654]);var gk=d(1774),ri=d(188);class Hf{constructor(ka,$a){this.containerType="full-pane";this.identifier=null;this.ga=ka;this.identifier=$a}openView(){this.ga.Ob(Ah.a.I0b,2)}closeView(){this.ga.Pb(Ah.a.Urb,2,!0)}invokeModalConfirmationDialog(ka,$a,Db){const ec=new ri.StandardDialog;Db&&Db.title&&Db.body&&Db.confirmButton&&Db.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),Db=new Ji("","","",""));ec.Gd=1;ec.Pe(1,Db.confirmButton);
ec.Pe(0,Db.cancelButton);ec.Ix(Db.title,Db.body,1,sc=>{1===sc?ka():$a()})}}Object(f.a)(Hf,"ViewContainerAPI",null,[650,651]);class lk{constructor(ka,$a,Db){this.$lp=ka;this.Tg=$a;this.iPa=Db;this.ed=new ia.a;this.$lp.execute(ec=>{this.iPa.Zte("OnBeforeTrackChangeMarkupViewChange",(sc,ad)=>{ad&&ad.Sbg!==ec.qk&&this.ed.raiseEvent("OnBeforeTrackChangeMarkupViewChange",ad)});this.iPa.Zte("OnAfterTrackChangeMarkupViewChangeEventKey",(sc,ad)=>{ad&&ad.qk===ec.qk&&(zd.qk=ec.qk,this.ed.raiseEvent("OnAfterTrackChangeMarkupViewChange",
ad))})})}o4(ka,$a){this.ed.addHandler(ka,$a)}m4(ka,$a){this.ed.raiseEvent(ka,$a)}pte(){this.Tg.bqg||(this.Tg.bqg=!0,this.ed.raiseEvent("OnCommentRenderedOnce"))}}Object(f.a)(lk,"WordCommentEventsActor",null,[]);var fi=d(1934);class Ab{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(f.a)(Ab,"InitCommentSessionResult",null,[]);class jc extends Ab{constructor(){super();this.updatedDraftSessionConfiguration=null}}
Object(f.a)(jc,"BeginDraftingHostResult",Ab,[]);var Jc=d(2230),yd=d(2174),Be=d(1126);class we{constructor(ka,$a,Db,ec,sc,ad,Xd,ue,ae,Te,sf,kg,qf,fh,Fi){this.Qi=ka;this.Pwa=$a;this.vmk=Db;this.gnp=ec;this.Hqf=sc;this.Vs=ad;this.Wu=Xd;this.focusManager=ue;this.zY=ae;this.Sb=Te;this.Wk=sf;this.L2=kg;this.Tg=qf;this.qwl=fh;this.owl=Fi;this.b$b=this.x$=this.hp=null;this.jrk="WordWebCommitNewCommentActivity";this.krk="WordWebCommitTaskActivity";this.grk="WordWebCommentReactionActivity";this.kch=null}get gpa(){return this.x$}Ceo(ka){var $a;
const Db=this.gpa.hz,ec=this.x$.xR();if(ec&&Db){const sc=Be.a.zpb(null!==($a=Db.authorId)&&void 0!==$a?$a:"");$a=new fi.a(Db.authorId,Db.Idc,Db.author,null!==sc&&void 0!==sc?sc:"",!0);ka.author=$a;ka.insertIndex=Array.indexOf(ec,Db);ka.authorName=Db.author;ka.authorIdentity="";return null}return zh.a.wF(-2130915320)}initialize(ka,$a,Db,ec){this.hp=ka;this.x$=$a;this.b$b=Db;this.kch=ec}beginDraftingAsync(ka){if(!ka)return new Promise((ec,sc)=>{sc(zh.a.wF(-2130915327))});const $a=new jc,Db=lg.a.WKf(ka.sessionType);
return void 0===Db||null===Db?new Promise((ec,sc)=>{sc(zh.a.wF(-2130915317))}):new Promise((ec,sc)=>{zh.a.z6(this.Qi,()=>{if(1!==this.hp.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",this.hp.mode),sc(zh.a.wF(-2130915325));else{this.$0h();try{switch(Db){case 0:if(!this.hp.Tga.Tsb()){sc(zh.a.wF(-2130915326));return}this.qwl.Gae();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${ka.draftId}`);this.hp.VJb(ka);break;case 1:if(!ka.threadId||""===
ka.threadId){sc(zh.a.wF(-2130915324));return}if(this.Vs.AEg){const ue=this.x$.DF(ka.threadId);if(ue){const ae=this.x$.Pvi(ue,!1),Te=Jc.a.uPb(ue,ae,ue.authorId===this.Vs.N0);Te&&this.Hqf.invoke(ka.threadId,Te)}else a.ULS.sendTraceTag(579170962,327,10,"Smart reply provider not invoked since comment is null",this.hp.mode)}this.hp.$lb(ka.threadId,ka);break;case 3:if(!ka.threadId||""===ka.threadId){sc(zh.a.wF(-2130915324));return}var ad=this.x$.DF(ka.threadId);if(!ad){sc(zh.a.wF(-2130915323));return}this.hp.Pob(ad,
ka);break;case 2:if(!ka.commentId||""===ka.commentId){sc(zh.a.wF(-2130915324));return}const Xd=this.x$.DF(ka.commentId);if(!Xd){sc(zh.a.wF(-2130915323));return}this.hp.Pob(Xd,ka)}}catch(Xd){sc(Xd);this.mGj();a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Xd} on Session ${Db}`);return}(ad=this.Ceo($a))?sc(ad):ec($a);this.mGj()}},Bj.a.beginDraftingAsync)})}commit(ka,$a,Db){const ec=this.gpa.hz;if(!ec)throw zh.a.wF(-2130915320);var sc=ec.KA;if(!sc)throw zh.a.wF(-2130915320);const ad=lg.a.WKf(sc.sessionType);
if(void 0===ad||null===ad)throw zh.a.wF(-2130915317);if(ka!==sc.draftId)throw zh.a.wF(-2130915327);let Xd=!1,ue=!1;sc=!1;switch(ad){case 3:if(!Db)throw zh.a.wF(-2130915327);break;case 0:this.Wk.Yd(()=>{if(!this.hp.Tga.Tsb())throw zh.a.wF(-2130915326);ec.text=[$a];this.hp.mE&&!this.Tg.kn?this.hp.H$n(()=>{this.hp.Uza(ec);this.hp.l_l(ka,ec.id)}):this.hp.Uza(ec);ue=Db&&null!=Db.Task;Xd=!0;zh.a.z6(this.Qi,()=>{this.Vxb(ec.id)},Bj.a.Vxb)},"WESCA:C:C");break;case 1:this.Wk.Yd(()=>{ec.text=[$a];this.hp.Uza(ec);
ue=Db&&null!=Db.Task;Xd=!0},"WESCA:C:R");break;case 2:this.Wk.Yd(()=>{ec.text=[$a];this.hp.Dnb(ec);this.Pvj(Ai.a.lCn)},"WESCA:C:E");break;default:throw zh.a.wF(-2130915322);}Db&&(Db.Resolve&&(this.fNj(ec,Db.Resolve.isResolved),Db.Resolve.isResolved&&!this.Tg.kn&&this.hp.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),Db.Task&&this.hp.Qwl(ec,Db.Task),Db.Reaction&&(sc=!0,Db.Reaction.isActive?this.hp.aRd(ec,Db.Reaction.reactionType):this.hp.oue(ec,Db.Reaction.reactionType)));this.Vs.Hwl&&ue&&this.zY.execute(ae=>
ae.logActivity(this.krk,"CommentsTasksFpsIsEnabled"));Xd&&this.zY.execute(ae=>{ae.logActivity(this.jrk,"CommentsFpsIsEnabled")});sc&&this.zY.execute(ae=>{ae.logActivity(this.grk,"CommentReactionsFpsIsEnabled")});return ec.id}endCommentSession(ka){const $a=this.gpa.hz;if($a){if($a.KA&&$a.KA.draftId!==ka)throw zh.a.wF(-2130915327);if($a.Nr===rg.a.dE)this.hp.deleteComment($a),!this.hp.mE||$a.Mf||this.Tg.kn||this.focusManager.Bg(Sh.AFrame.Ho);else{if(3!==this.hp.mode){a.ULS.sendTraceTag(33621450,327,
50,"CommentingMode != EditingComment at the time of ending a comment session");return}$a.Nr=rg.a.normal;$a.n_a=yd.a.succeeded;$a.KA=null;this.hp.Tnf()}}this.Wu&&this.Wu.Ie(!0);this.gpa.j8d()||this.Pwa.zMg(1,!this.hp.mode)}deleteComment(ka){(ka=this.x$.DF(ka))?(this.hp.deleteComment(ka),this.hp.mE&&!this.Tg.kn?ka.Mf||this.focusManager.Bg(Sh.AFrame.Ho):this.focusManager.ME(Sh.AFrame.Us),this.gnp.ICg(ka)&&this.Pvj(Ai.a.x$i)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(ka){this.Vxb(ka,
0)}highlightComment(ka){this.hp.vsc(ka,0)}setThreadResolvedState(ka,$a){(ka=this.x$.DF(ka))&&this.fNj(ka,$a)}fNj(ka,$a){if(ka.Mf&&""!==ka.Mf)throw zh.a.wF(-2130915321);this.hp.xLb(ka,$a);$a&&!this.Tg.kn&&this.focusManager.Bg(Sh.AFrame.Ho)}presentLinkToComment(ka){var $a=this.x$.DF(ka);$a?($a=this.gpa.x6d($a))?(ka={["nav"]:btoa(`{"${kk.a.comment}":${$a}}`),["mode"]:"copy"},this.owl.Vw(Ai.a.presentLinkToComment),this.Sb.Pb(Ah.a.Uaa,2,ka,{["ControlId"]:"CopyLinkToComment"})):a.ULS.sendTraceTag(578058146,
327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",ka):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",ka)}selectFirstThreadInNextCommentContext(){this.hp.JKj(0)}selectLastThreadInPreviousCommentContext(){this.hp.$Mo()}registerForCommentEvents(ka){const $a=this.gpa.nIf(this.Vs.S0b&&this.Vs.Pr&&!this.Tg.kn),Db=this.gpa.Q1a,ec=this.gpa.j8d(),sc=!this.hp.mode;this.Pwa.yXo();this.kch.bAm().then(ad=>{this.Pwa.Duo(ka,$a,ec,sc,Db,ad);this.Pwa.zMg(ec?5:
1,sc);this.Wu&&this.Wu.Ie(!0)})}unregisterForCommentEvents(ka){this.Pwa.n2b(ka)}registerForAction(ka,$a){this.vmk.OZa(ka,$a)}unregisterForAction(){}checkAtMentionCapability(){return this.b$b?this.b$b.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(ka=>{ka(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}$0h(){const ka=this.hp.mE&&
!this.Tg.kn?Sh.AFrame.jP:Sh.AFrame.Us;if(ka===Sh.AFrame.Us){if(!this.Tg.kn)return;Wj.UISurfaces.Hv().then($a=>{$a.setSelectedTaskPane(dj.a.cXd);return null})}this.focusManager.ME(ka)}Vxb(ka,$a=1){this.$0h();this.L2.DKj(ka,Object.assign(new oi.a,{Gca:$a,sS:1===$a}))}mGj(){this.hp.Tga.Zlb&&(this.hp.Tga.Zlb=!1)}Pvj(ka){this.Sb.Ob(ka,2)}}Object(f.a)(we,"WordEditorSharedCommentAPI",null,[648,649]);class wf{constructor(ka,$a,Db,ec,sc,ad,Xd=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=
null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ka;this.parentId=$a;this.commentBody=Db;this.author=ec;this.date=sc;this.commentFlags=ad;this.usersByReactionType=Xd}}Object(f.a)(wf,"OfficeSharedCommentModel",null,[]);d(1753);class rf{constructor(ka,$a){this.Ga=ka;this.tUb=$a;this.KMh="AD";this.YEc=new O.a;this.Ccf=new O.a;this.yal=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.hch=new Jk.a}get userPrincipalName(){return this.Ga.kb("UserPrincipalName")}get Lcb(){return this.Ga.kb("PresenceProvider")}get N0(){return this.Ga.kb("PresenceUserId")}get Ej(){return this.tUb.value}Ahj(ka){const $a=
this.yal.exec(ka);return $a?$a[1]:ka}sHi(ka,$a=!1){let Db=0;ka.done&&(Db=ka.Mf&&""!==ka.Mf?Db|4:Db|8);ka.n7h&&(Db|=2);$a&&(Db|=1);this.ICg(ka)&&(Db|=16);ka.v_f&&(Db|=32);this.AZm(ka)||(Db|=128);return Db}AZm(ka){return ka?(ka=this.Ej.Eb(ka.objectId))?ka.hasProperty(na.a.WT):!1:!1}ICg(ka){if(!ka)return!1;if(void 0===ka.authorId||null===ka.authorId||""===ka.authorId)return this.O6f(ka.id,ka.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.N0||null===this.N0||""===this.N0)return this.O6f(ka.id,
ka.objectId,"PresenceUserId null or empty"),!1;if(this.N0==ka.authorId&&ka.Idc==this.Lcb)return!1;const $a=this.D2d(ka.authorId),Db=this.D2d(this.N0);if(this.Lcb===this.KMh&&$a&&Db&&$a[0]!=this.userPrincipalName&&$a[1]!=Db[1])return!0;this.O6f(ka.id,ka.objectId,"Unknown");return!1}isCurrentUser(ka){if(!ka||void 0===ka.authorId||null===ka.authorId||""===ka.authorId||void 0===this.N0||null===this.N0||""===this.N0)return!1;if(this.N0==ka.authorId&&ka.Idc==this.Lcb)return!0;ka=this.D2d(ka.authorId);const $a=
this.D2d(this.N0);return this.Lcb===this.KMh&&ka&&$a?ka[0]==this.userPrincipalName||ka[1]==$a[1]:!1}D2d(ka){if(void 0===ka||null===ka)return null;ka=ka.split("::");return 3===ka.length?ka.slice(1,3):null}O6f(ka,$a,Db){ka&&!this.hch.contains(ka)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${$a}; reason: ${Db}`),this.hch.add(ka))}Pri(ka,$a){var Db;if(!ka)return null;const ec=ka.age;let sc=!1;1===$a&&(sc=!0);$a=ka.author?this.Ahj(ka.author):"";const ad=Be.a.zpb(null!==
(Db=ka.authorId)&&void 0!==Db?Db:"");Db=new fi.a(ka.authorId?ka.authorId:"",ka.Idc,$a,null!==ad&&void 0!==ad?ad:"",this.isCurrentUser(ka));return new wf(ka.id?ka.id:"",ka.Mf?ka.Mf:"",ka.text&&ka.text.length?ka.text[0]:null,Db,ka.date||ec?ka.date:new Date,this.sHi(ka,sc),this.uHi(ka.usersByReactionType))}Pdm(ka,$a,Db){const ec=[],sc=new O.a;if(!ka)return ec;for(const ad of ka)ad.Nr!==rg.a.dE&&Db(ad)&&(ad.id&&this.YEc.mb(ad.id)?(ka=this.YEc.J(ad.id),ka=this.IHl(ad,ka,$a),ec.push(ka),sc.Z(ad.id,ka)):
ad.id?(ka=this.Pri(ad,$a),ec.push(ka),sc.Z(ad.id,ka)):a.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.YEc=sc;return ec}kkm(ka,$a,Db){const ec=[];for(const sc of ka)sc.Nr!==rg.a.dE&&Db(sc)&&(sc.id&&this.YEc.mb(sc.id)?ec.push(this.YEc.J(sc.id)):sc.id&&ec.push(this.Pri(sc,$a)));return ec}IHl(ka,$a,Db){var ec=ka.age,sc=1===Db;Db=ka.Mf?ka.Mf:"";const ad=ka.text&&ka.text.length?ka.text[0]:null,Xd=ka.author?this.Ahj(ka.author):"",ue=ka.authorId?ka.authorId:"",ae=ka.Idc?ka.Idc:"",
Te=Be.a.zpb(ue);ec=ka.date||ec?ka.date:new Date;sc=this.sHi(ka,sc);const sf=this.isCurrentUser(ka),kg=this.uHi(ka.usersByReactionType);return $a.parentId===Db&&$a.commentBody===ad&&$a.author.DisplayName===Xd&&$a.author.UserId===ue&&$a.author.Provider===ae&&$a.author.IsCurrentUser===sf&&$a.date===ec&&$a.commentFlags===sc&&this.W9k($a.usersByReactionType,kg)?$a:($a=new fi.a(ue,ae,Xd,null!==Te&&void 0!==Te?Te:"",sf),new wf(ka.id,Db,ad,$a,ec,sc,kg))}W9k(ka,$a){if(!ka&&!$a)return!0;if(!$a||!ka)return!1;
var Db=Object.keys(ka);if(Db.length!==Object.keys($a).length)return!1;for(const ec of Db){if(!(ec in $a))return!1;Db=ka[ec];const sc=$a[ec];if(Db.length!==sc.length)return!1;for(let ad=0;ad<Db.length;ad++)if(!this.L9k(Db[ad],sc[ad]))return!1}return!0}L9k(ka,$a){return ka||$a?ka&&$a&&ka.UserId===$a.UserId&&ka.Provider===$a.Provider&&ka.Email===$a.Email&&ka.DisplayName===$a.DisplayName&&ka.IsCurrentUser===$a.IsCurrentUser?!0:!1:!0}uHi(ka){if(!ka)return null;const $a={},Db=this.Ga.kb("PresenceUserId");
for(const sc of Object.keys(ka)){const ad=[];var ec=ka[sc];for(const Xd of ec){ec=Xd.UserId===Db;let ue;this.Ccf.mb(Xd.UserId)?(ue=this.Ccf.J(Xd.UserId),ue.IsCurrentUser=ec):(ue=new fi.a(Xd.UserId,Xd.Provider,Xd.DisplayName,Xd.Email,ec),this.Ccf.add(Xd.UserId,ue));ad.push(ue)}$a[sc]=ad}return $a}}Object(f.a)(rf,"WordEditorSharedCommentModelTranslator",null,[494]);class xg{constructor(){this.vq=null;this.pxd=this.pAh=this.J9g=this.FHh=this.BKh=this.awh=this.tCh=!1}tHi(){this.vq||(a.ULS.sendTraceTag(588292828,
327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.NPj());return this.vq}bAm(){return new Promise((ka,$a)=>{this.pxd?ka(this.BCi()):this.EMj().then(()=>{ka(this.BCi())}).catch(Db=>{$a(Db)})})}BCi(){this.pxd||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ka;ka=33;this.J9g&&(ka|=2);this.tCh&&(ka|=8);this.BKh&&(ka|=16);this.awh&&(ka|=4);this.FHh&&
(ka|=64);this.pAh&&(ka|=128);return ka}}Object(f.a)(xg,"OfficeSharedCommentsAppCapabilities",null,[1446]);class Nh extends xg{constructor(ka){super();this.i4a=null;this.Ri=ka;this.KYo();this.NPj()}KYo(){this.FHh=this.Ri.B1b;this.BKh=!1;this.pAh=this.awh=this.tCh=!0}initialize(ka){this.i4a=ka;this.EMj()}NPj(){this.vq={};this.vq.LivePersonaPicker="true";this.vq.PersonaColor="true";this.vq.DiscreteHostedComments=this.Ri.KUl.toString();this.vq.NewCommentButton="true";this.vq.DisabledChangeGates=this.Ri.AUl;
this.vq.CommentsFluentUI="true";this.vq.CommentTasks=this.Ri.B1b.toString();this.vq.CommentTasksFromReply=this.vq.CommentTasks;this.vq.CommentFriendlyTimestamps=this.Ri.Rvl.toString();this.vq.AtMentionFloodgateSurvey=this.Ri.V$k.toString();this.vq.HyperlinksInComments="true";this.vq.LogDraftCommentIdPair="true";this.vq.RichTextFormattingInWeb="true";this.vq.RichContentEditIntegration="true";this.vq.HyperlinksWithDisplayText="true";this.vq.SmartReplies=this.Ri.AEg.toString();this.vq.LinkToComment=
"true";this.vq.TaskPaneWithNewInfrastructure="true";this.vq.CommentReactions="true";this.vq.WebThemeIntegration="true";this.vq.NewSelectionInteractions="true";this.vq.HighlightsAndFontColorInWebComments="true";this.vq.TruncationUIWithReadMoreText="true";this.vq.CtrlEnterTip="true";this.vq.AtMentionHintMessage="true";this.vq.LivePersonaCardForWeb="true";this.vq.TaskHistoryRecordIDs=this.Ri.whp.toString();this.vq.ContentNavigation=this.Ri.contentNavigationApiEnabled.toString()}EMj(){return new Promise((ka,
$a)=>{this.i4a?this.i4a.atMentionsEnabledAsync().then(Db=>{this.J9g=Db;this.pxd=!0;ka(this.pxd)}):(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),$a(zh.a.wF(-2130915320)))})}}Object(f.a)(Nh,"WordSharedCommentsAppCapabilities",xg,[493]);class Rj{constructor(){this._initialized=!1;this.Gwl={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:ea.a.cDf,vetoPillar:7};
this.Ehp={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:gk.a.cDf,vetoPillar:7}}get scb(){return null!=this.p2g?this.p2g:this.p2g=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}v2(ka){this.scb.v2(Uj.a.comments,ka,!0)}get name(){return"WordEditor.Comments"}wc(ka){this.W=ka;this.v2("CPConfigStart");ka.ia("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new mj.a(v.Health.instance,new Jl.a,this.Gwl)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").ha();ka.ia("WordEditor.Comments.ITasksUsageAndHealthLogger",
()=>new mj.a(v.Health.instance,new Jl.a,this.Ehp)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").ha();ka.ia("WordEditor.Comments.CommentNodeTracker",()=>new Sd(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").ha();ka.ia("WordEditor.Comments.CommentsSettings",()=>new Og(y.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new Q.a(()=>cc.StaticActiveAppFrame.za().ib.$c),new Q.a(()=>Xi.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),
this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").ha();ka.ia("WordEditor.Comments.CommentsState",()=>new zd).ha();ka.ia("WordEditor.Comments.WordCommentEventsActor",()=>new lk(ka.Qa("Box4.TrackChange.ITrackChangeManager"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).ha();ka.ia("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new rf(y.AFrameworkApplication.K,new Q.a(()=>cc.StaticActiveAppFrame.za().ib.$c.td))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").ha();
ka.ia("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new Ld(ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("Box4.Styles.IWACStyleReader"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.ICommentFormatTranslator").ha();ka.ia("Common.Comments.OfficeSharedCommentsEventHost",()=>new hj(y.AFrameworkApplication.mc)).as("Common.Comments.IOfficeSharedCommentsEventHost").ha();ka.ia("WordEditor.Comments.CommentActionInTypingRecorder",()=>
new cd(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").ha();ka.ia("WordEditor.Comments.EditorCommentModel",bl.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").ha();ka.ia("WordEditor.Comments.ICommentModelBootLoader",()=>new ce(new Q.a(()=>cc.StaticActiveAppFrame.za().ib.$c),new Q.a(()=>Xi.a.instance),ka.resolve("WordEditor.Comments.IEditorCommentModel"),
ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));ka.ia("WordEditor.Comments.ICommentFilterActor",()=>new Dg(ka.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.K,ka.resolve("WordEditor.Comments.WordCommentEventsActor"),ka.resolve("WordEditor.Comments.CommentsState"),ka.Qa("Common.ISystemInitiatedFeedback"))).ha();
ka.resolve("WordEditor.Comments.ICommentFilterActor");ka.ia("WordEditor.Comments.CommentHighlightOnRestActor",()=>new Jf(new Q.a(()=>cc.StaticActiveAppFrame.za().ib.$c),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.WordCommentEventsActor"),ka.resolve("Box4.INotebookManager").Il,U.a.instance,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").ha();
ka.ia("WordEditor.Comments.CommentHighlightUtils",()=>new rm(ka.resolve("Box4.Highlight.IHighlightManager"))).ha();ka.ia("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new df(ka.resolve("WordEditor.Comments.CommentHighlightUtils"))).ha();ka.ia("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new hb(ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),ka.resolve("WordEditor.Comments.CommentHighlightUtils"),y.AFrameworkApplication.ua.i9,y.AFrameworkApplication.ua.aPa,
y.AFrameworkApplication.va,y.AFrameworkApplication.mc,ka.resolve("WordEditor.Comments.CommentsState"),ka.Qa("WordEditor.Comments.IEditorCommentManager"))).ha();ka.ia("WordEditor.Comments.CommentHighlightActor",()=>new Ed(new Q.a(()=>cc.StaticActiveAppFrame.za().ib.$c.td),ka.resolve("WordEditor.CommentsInteractive.ICommentEditor"),ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),ka.Qa("WordEditor.Comments.IEditorCommentManager"),U.a.instance,ka.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),
ka.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),ka.resolve("WordEditor.Comments.CommentHighlightUtils"),ka.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").ha();ka.ia("WordEditor.Comments.CommentHintActor",()=>new qa(ka.resolve("WordEditor.Comments.CommentsSettings"),uj.a.instance,wg.a.instance,Ni.a.instance,y.AFrameworkApplication.va,ag.TableCellReader.Iln,ij.moveToLastRenderedCellOfTheRow,new Cg.a,ka.Qa("Box4.ContentControlConfigSettings"),
ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.ICommentHighlightActor"),ka.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").ha();ka.ia("WordEditor.Comments.CommentMarginEntryPointActor",()=>new Zb(uj.a.instance,Ni.a.instance,y.AFrameworkApplication.va,ka.resolve("WordEditor.Comments.ICommentHintActor"),
ka.Qa("Common.IZoomManager"),ka.resolve("WordEditor.Comments.CommentsSettings"))).ha();ka.ia("WordEditor.Comments.ViewContainerAPI",()=>new Hf(y.AFrameworkApplication.va,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").ha();ka.ia("Common.Comments.CommentActivationManager",()=>new Md).as("Common.Comments.ICommentActivationManager").ha();ka.ia("Common.Comments.ViewContainerEventHost",()=>new nf(y.AFrameworkApplication.mc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").ha();
ka.ia("WordEditor.Comments.CommentSmartReplyProvider",()=>new $f(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").ha();ka.ia("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new Nh(ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").ha();
this.v2("CPConfigEnd")}init(){this.v2("CPInitStart");this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{try{this.Mo(),this.v2("CPInitEnd")}catch(ka){throw a.ULS.$w(524300632,327,10,ka,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",ka),this.scb.Vy(Uj.a.comments,"CPInitException",ka,!0),ka;}})}Mo(){const ka=this.W.resolve("WordEditor.Comments.CommentsSettings");this.v2("onAfterGFNLoadedStart");this.W.ia("WordEditor.Comments.OfficeSharedCommentPane",
()=>new ch(y.AFrameworkApplication.va,y.AFrameworkApplication.ua.UE,y.AFrameworkApplication.ua.VE,y.AFrameworkApplication.ua.sq,y.AFrameworkApplication.ua.Iy,cc.StaticActiveAppFrame.za(),Sg.a.instance,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.resolve("Common.Comments.IViewContainerEventHost"),y.AFrameworkApplication.mc,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),
this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").ha();this.W.ia("Common.Comments.OfficeSharedCommentsActionHost",()=>new ee(y.AFrameworkApplication.va,this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").aDc)).as("Common.Comments.IOfficeSharedCommentsActionHost").ha();this.W.ia("WordEditor.Comments.WordEditorSharedCommentAPI",
()=>new we(y.AFrameworkApplication.mc,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),ka,cc.StaticActiveAppFrame.za(),y.AFrameworkApplication.ua.sq,this.W.Qa("Common.ISystemInitiatedFeedback"),y.AFrameworkApplication.va,U.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),
this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").ha();qd.a.factory=fk.getInstance;this.W.ia("WordEditor.Comments.EditorCommentManager",fk.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").ha();this.W.ia("WordEditor.Comments.CommentFloatingContainerActor",
()=>new Rb(this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.mc,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),()=>document.querySelector(`#${ui.a.c1a} .${ck.a.Kgc}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),
y.AFrameworkApplication.ua.sq,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentFloatingContainerActor").ha();const $a=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),Db=$a.trackChangeInSidetrackEnabled;Db&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").LAj(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));this.W.ia("WordEditor.Comments.FloatingCommentManager",()=>new Fe(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),
y.AFrameworkApplication.mc,U.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),$a)).ha();this.W.ia("WordEditor.Comments.IFloatingCommentManager",()=>Db?this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").ha();
this.W.ia("WordEditor.Comments.CommentSelectionActor",()=>new xd(y.AFrameworkApplication.va,this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),Lc.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),y.AFrameworkApplication.ua.sq,this.W.resolve("WordEditor.Comments.CommentsState"),ka,new Q.a(()=>Zf.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),
this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.Qa("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").ha();this.W.ia("WordEditor.Comments.CommentInitActor",()=>new Ob(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),
this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),Lc.getInstance(),cc.StaticActiveAppFrame.za().hs,y.AFrameworkApplication.va,this.W.resolve("Common.IDynamicScriptLoaderProvider").xC,this.W.Qa("WordEditor.Comments.ICommentRibbonCommandHandler"),y.AFrameworkApplication.ua.sq,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),this.W.resolve("Common.Comments.ICommentActivationManager"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),
this.W.Qa("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.Qa("Common.App.SafeLinks.ISafeLinksManager"),this.W.Qa("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),
$a,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"),this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).ha();this.W.ia("WordEditor.Comments.CommentsActionManager",()=>new Eg(this.W.resolve("WordEditor.Comments.EditorCommentManager"),this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),
this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("Common.Comments.ICommentPane"),new Q.a(()=>cc.StaticActiveAppFrame.za().ib.$c.td),y.AFrameworkApplication.va,new Q.a(()=>Zf.a.instance),Il.FocusManager.instance(),U.a.instance,this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.CommentsActionManager").ha();
this.W.resolve("WordEditor.Comments.CommentInitActor");ka.contentNavigationApiEnabled&&(this.W.ia("WordEditor.Comments.CommentContentProvider",()=>new ef(this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.Comments.CommentsSettings"))).ha(),this.W.ia("WordEditor.Comments.CommentContentActor",()=>new Oe(this.W.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),
this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.CommentsState"))).ha(),this.W.resolve("WordEditor.Comments.CommentContentProvider"),this.W.resolve("WordEditor.Comments.CommentContentActor"));const ec=ka.Pr,sc=this.W.resolve("WordEditor.Comments.EditorCommentManager");this.W.resolve("WordEditor.Comments.CommentsActionManager");sc&&ec&&(this.W.resolve("WordEditor.Comments.CommentsState").Vlb=Rj.rui(),ka.lNb||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").m4("OnCommentInit"));
Tb.a.yEn();ka.Rlc&&cc.StaticActiveAppFrame.za().ib.Aki();qd.a.instance&&(ka.lNb||Vg.a.get_instance().Lk(4,()=>{this.aWn(ec)},11).continueWith(()=>{this.u6m()}),this._initialized=!0);this.Fso(this.W.Qa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}u6m(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").m4("OnCommentInit")}aWn(ka){ka||this.KSm()}KSm(){const ka=Rj.rui();ka&&(a.ULS.sendTraceTag(35149084,
327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.D2),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").m4("OnCommentInit",Object.assign(new Pd.a,{NMa:()=>{qd.a.instance.Tga.isVisible||y.AFrameworkApplication.va.Ob(Ah.a.EY,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").AKj(ka,Object.assign(new oi.a,{NCg:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").Vw(Ah.a.Bqf))}Fso(ka,$a,Db){ka&&ka.execute(ec=>
{ec.kY(new Af.a($a,Db))})}dispose(){this._initialized&&(qd.a.instance&&qd.a.instance.dispose(),this._initialized=!1)}static rui(){return y.AFrameworkApplication.K.kb("BootActivityNavigationId")}}Object(f.a)(Rj,"PackageManager",null,[0,1]);const Ig=ka=>{const $a=H.a.instance.Qa("Box4.IPackageBootPerfLogger"),Db=window.performance.now();$a.execute(ec=>{ec.Vy(Uj.a.comments,"CPMain",Db,!0)});x.a.instance.Jc(new Rj,0,ka)};var ll=d(1089);class mk{isComment(ka){return fd.a.isComment(ka)}Gde(ka){return fd.a.Gde(ka)}TXf(ka){return fd.a.TXf(ka)}Ieg(ka,
$a){fd.a.Ieg(ka,$a)}Meg(ka,$a){fd.a.Meg(ka,$a)}Xtf(ka){return fd.a.Xtf(ka)}Kbb(ka){return Xi.a.instance.Kbb(ka)}deleteComment(ka,$a){fd.a.deleteComment(ka,$a)}o_d(ka,$a){fd.a.o_d(ka,$a)}hxb(ka){fd.a.hxb(ka)}Cfa(ka,$a,Db){return fd.a.Cfa(ka,$a,Db)}hBa(ka,$a,Db){return fd.a.hBa(ka,$a,Db)}klc(ka,$a){return fd.a.klc(ka,$a)}y2c(ka,$a,Db,ec=null){return fd.a.y2c(ka,$a,Db,ec)}scc(ka,$a,Db,ec){fd.a.scc(ka,$a,Db,ec)}$Qd(ka,$a,Db,ec){return fd.a.$Qd(ka,$a,Db,ec)}get KSb(){return fd.a.KSb}set KSb(ka){fd.a.KSb=
ka}KWb(ka,$a){fd.a.KWb(ka,$a)}Gkd(ka){fd.a.Gkd(ka)}fsg(ka){fd.a.fsg(ka)}y8d(ka,$a){return fd.a.y8d(ka,$a)}Jeg(ka,$a){fd.a.Jeg(ka,$a)}Leg(ka,$a){fd.a.Leg(ka,$a)}Cme(ka,$a,Db,ec,sc,ad){fd.a.Cme(ka,$a,Db,ec,sc,ad)}jBf(ka,$a){fd.a.jBf(ka,$a)}iid(ka,$a,Db,ec){return fd.a.iid(ka,$a,Db,ec)}nid(ka,$a,Db,ec){return fd.a.nid(ka,$a,Db,ec)}}Object(f.a)(mk,"CommentEditorProxy",null,[492]);class Bh{constructor(){this.W=null}get t1b(){return null!=this.l5g?this.l5g:this.l5g=(()=>this.W.Qa("WordEditor.ITableEditor"))()}get scb(){return null!=
this.q2g?this.q2g:this.q2g=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}v2(ka){this.scb.v2(Uj.a.comments,ka,!0)}get name(){return"WordEditor.CommentsInteractive"}wc(ka){this.W=ka;this.v2("CIPConfigStart");ka.ia("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new mk).as("WordEditor.CommentsInteractive.ICommentEditor").ha();this.v2("CIPConfigEnd")}init(){this.v2("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo();this.v2("CIPInitEnd")})}Mo(){this.Z0m()}dispose(){}Z0m(){Bf.a.PZa(fd.a.Meg);
ll.a.PRd(fd.a.Jeg);ll.a.QRd(fd.a.Leg);ll.a.H0k(fd.a.YVn);this.t1b.execute($a=>{$a.Egf(fd.a.KWb)});const ka=P.App.jf.Il;ka.Ve(39).fo(fd.a.Ieg);ll.a.W_k(fd.a.bVn);ll.a.O_k(fd.a.mUn);mc.a.isEnabled&&ka.Ve(12).Bw(fd.a.fik)}}Object(f.a)(Bh,"PackageManager",null,[0,1]);const rp=ka=>{const $a=H.a.instance.Qa("Box4.IPackageBootPerfLogger"),Db=window.performance.now();$a.execute(ec=>{ec.Vy(Uj.a.comments,"CIPMain",Db,!0)});x.a.instance.Jc(new Bh,0,ka)};var Ck=d(2229),$l=d(111),sn=d(1773);class sk{constructor(ka,
$a,Db,ec,sc,ad,Xd){this.rTa=ka;this.uea=$a;this.N$=Db;this.Zc=ec;this.kxk=sc;this.Z1e=ad;this.AFb=Xd;sn.a.G0k((ue,ae)=>{this.JZk(ae.graphNode,ae.Bvl)});sn.a.m1k((ue,ae)=>{this.sCl(ae.graphNode,ae.ntl)})}A7d(){var ka=this.kxk();const $a=this.Zc.Ql();$a.set(ka);if(this.uea.uqp($a))return $a;$a.set(ka);Object($l.a)().dS($a);ka=this.N$.AKl($a.currentNode);$a.Yj(ka);return $a}R9d(ka){const $a=this.A7d();let Db=null;this.uea.B4d($a,ec=>{this.N$.TIi(ec)===ka&&(Db=ec);return!Db});return Db}PIi(ka){const $a=
this.A7d();let Db=null;this.uea.B4d($a,ec=>{this.N$.qlc(ec)===ka&&(Db=ec);return!Db});return Db}eaj(ka,$a,Db){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",ka,$a,Db)}UIi(){const ka=this.A7d(),$a=[];this.uea.B4d(ka,Db=>{$a.push(this.N$.TIi(Db));return!0});return $a}eob(ka,$a){if(!$a.length)return this.AFb&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const Db=this.A7d(),ec=
uh.a.create().toString(),sc=new ld.a;for(let ad of $a)sc.add(ad),this.eaj(ad.type,ec,ad.completion);$a=this.rTa.Fyg(sc);this.N$.eob(Db.currentNode,ec,ka,$a);this.Z1e();return ec}vf(ka){(ka=this.R9d(ka))?(this.N$.vf(ka),this.Z1e()):this.AFb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}qlc(ka){ka=this.R9d(ka);return ka?this.N$.qlc(ka):(this.AFb&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}QIi(ka){return this.N$.qlc(ka)}SIi(ka){ka=
this.R9d(ka);if(!ka)return this.AFb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;ka=this.N$.bOf(ka);return this.rTa.Tgc(ka).toArray()}W6k(ka,$a){if(!$a.length)return this.AFb&&a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const Db=this.R9d(ka);if(!Db)return this.AFb&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const ec=this.N$.bOf(Db),sc=this.rTa.Tgc(ec);
for(let ad of $a)sc.add(ad),this.eaj(ad.type,ka,ad.completion);ka=this.rTa.Fyg(sc);ka!==ec&&(this.N$.kYo(Db,ka),this.Z1e());return!0}JZk(ka,$a){if($a=this.PIi($a)){const Db=this.Zc.Ql();Db.set(ka);this.N$.Zb($a.clone(),this.N$.c2l($a,Db))}}uzj(ka,$a,Db){if($a.mb(ka))return $a.J(ka);const ec=uh.a.create().toString();$a.add(ka,ec);Db&&this.AFb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return ec}sCl(ka,$a){const Db=new bk.a;var ec=
this.Zc.Ql();ec.set(ka);ec.Ub(38)&&this.uea.B4d(ec,sc=>{const ad=this.N$.qlc(sc);void 0!==ad&&null!==ad&&Db.add(ad,sc);return!0});for(let sc of $a)if(ka=null,({value:ka}=Db.Dc(sc.key,ka)).returnValue)if(sc.value===sc.key)ka=this.PIi(sc.key),this.N$.XYo(ka,parseInt(sc.key));else{ka=this.N$.bOf(ka);if(!ka||""===ka){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}ka=this.rTa.Tgc(ka);ec=new ub.a;for(let ad=0;ad<ka.length;ad++){if(ka.J(ad).commentId){const Xd=
Number.parseInvariant(ka.J(ad).commentId);$a.mb(Xd)?ka.J(ad).commentId=$a.J(Xd).toString():ka.J(ad).commentId=null}ka.J(ad).recordId=this.uzj(ka.J(ad).recordId,ec,!1);-1===ka.J(ad).type&&(ka.J(ad).undoId=this.uzj(ka.J(ad).undoId,ec,!0))}this.eob(sc.value,ka.toArray())}}static Xs(){return new sk(H.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),H.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),H.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new Cg.a,()=>cc.StaticActiveAppFrame.za().ib.$c,
()=>{H.a.instance.Qa("Common.Interface.IEditNotificationManager").execute(ka=>{ka.editHappened()})},!0)}}Object(f.a)(sk,"TaskActor",null,[644]);var Bp=d(1199);class Hc{create(){return new Bp.a}}Object(f.a)(Hc,"TaskContentNodeFactory",null,[296]);var Dk=d(1151);class Tq{create(){return new Dk.a}}Object(f.a)(Tq,"TaskNodeFactory",null,[296]);class oc{constructor(ka,$a,Db,ec,sc,ad){this.uea=ka;this.Pc=$a;this.Zc=Db;this.NPk=ec;this.QPk=sc;this.G4b=ad}XIl(ka,$a,Db){const ec=this.QPk.create(Vc.a.zzc);ec.setValue(na.a.taskId,
ka);ec.setValue(na.a.y1b,$a);ec.setValue(na.a.QEa,Db);return ec}slc(ka){const $a=this.Pc.Mc(4);$a.Ab(ka);this.G4b();return $a}TIi(ka){return this.uea.JTb(ka)?ka.getValue(na.a.taskId):(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}qlc(ka){return this.uea.JTb(ka)?ka.hasProperty(na.a.y1b)?ka.getValue(na.a.y1b):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}bOf(ka){return this.uea.JTb(ka)?ka.getValue(na.a.QEa):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),
null)}AKl(ka){if(7!==ka.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const $a=this.slc(ka);try{const Db=this.NPk.create(Vc.a.XOa),ec=this.Zc.Ql();ec.set(ka);ec.w6(Db,38,oc.shp);return Db}finally{$a&&$a.dispose()}}eob(ka,$a,Db,ec){if(!this.uea.y1f(ka))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const sc=this.slc(ka);try{const ad=this.XIl($a,Db,ec),Xd=this.Zc.Ql();Xd.set(ka);Xd.w6(ad,1,new ma.a(uh.a.kAa(Db.toString()),1));return ad}finally{sc&&
sc.dispose()}}vf(ka){if(this.uea.JTb(ka))if(ka.anchor&&ka.anchor.Uq){var $a=ka.anchor.Uq.kt.node;if(this.uea.y1f($a)){var Db=this.slc($a);try{const ec=this.Zc.Ql();ec.set($a);ec.Yj(ka.anchor.node);ec.eh()}finally{Db&&Db.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}kYo(ka,$a){if(this.uea.JTb(ka)){var Db=
this.slc(ka);try{ka.setValue(na.a.QEa,$a)}finally{Db&&Db.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}XYo(ka,$a){if(this.uea.JTb(ka)){var Db=this.slc(ka);try{const ec=ka.hasProperty(na.a.y1b)?ka.getValue(na.a.y1b):null;void 0===ec||null===ec||ec===$a?ka.Kg(na.a.y1b,$a):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{Db&&Db.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}c2l(ka,$a){if(!$a.fv(38)){const Db=this.Zc.Ql();
Db.set(ka);Db.zb(71);Db.ld(71);ka=Yb.b(Db.currentNode,ka.Jj().Lc,!0);$a.Uf(ka,38)}return $a.Ub(38)}Zb(ka,$a){if(this.uea.y1f($a)){var Db=this.slc($a);try{const ec=this.Zc.Ql();ec.set($a);ec.Uf(ka,1)}finally{Db&&Db.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static Xs(){return new oc(H.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new pi.a,new Cg.a,new Hc,new Tq,()=>{Hg.a.en.ib.$c.YG.laa(10)})}}oc.shp=new ma.a(uh.a.Cf("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),
1);Object(f.a)(oc,"TaskEditor",null,[497]);class vc{constructor(ka,$a){this.Oy=ka;this.EGb=$a}JTb(ka){return!!ka&&72===ka.type}usn(ka){return!!ka&&71===ka.lf}y1f(ka){return!!ka&&71===ka.type}uqp(ka){ka.set(this.Oy.value);this.EGb.dS(ka);return!!ka.Ub(38)}B4d(ka,$a){if(ka&&$a)if(this.usn(ka))for(var Db=!0,ec=ka.Ub(1);Db&&ec;)this.JTb(ec)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",ec.type),Db=$a(ec),ec=ka.Lf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",
ka.lf);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static Xs(){return new vc(new Q.a(()=>cc.StaticActiveAppFrame.za().ib.$c),Object($l.a)())}}Object(f.a)(vc,"TaskNavigator",null,[496]);class Jo{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo()})}dispose(){}wc(ka){this.W=ka;ka.ia("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new Ck.a).as("WordEditor.Tasks.ITaskHistorySerialization").ha();
ka.ia("WordEditor.Tasks.TaskNavigator",()=>vc.Xs()).as("WordEditor.Tasks.ITaskNavigator").ha();ka.ia("WordEditor.Tasks.TaskEditor",()=>oc.Xs()).as("WordEditor.Tasks.ITaskEditor").ha();ka.ia("WordEditor.Tasks.TaskActor",()=>sk.Xs()).as("WordEditor.Tasks.ITaskActor").ha()}Mo(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(110)}}Object(f.a)(Jo,"TasksPackage",null,[0,1]);var Pm=d(91),Co=d(1770),jl=d(438),Kl=d(106);class fo{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=
this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(f.a)(fo,"TaskPaneGroupAppProps",null,[]);var cn=d(195);class Uq{static Vwl(ka,$a){Il.FocusManager.vM()&&(wg.a.instance.jIa(ka,$a,!1),cn.a.instance.jIa(ka,$a,!1),y.AFrameworkApplication.ua.Iy.xW(ka))}}Object(f.a)(Uq,"ReactTaskPaneManagerUtils",null,[]);var To=d(150),sm=d(361);class go{constructor(){this.type=null}}Object(f.a)(go,
"SampleTaskPaneProps",null,[]);var ml=d(1771),ul=d(104);class Ko{constructor(){this.entry=null;this.show=!1}}Object(f.a)(Ko,"AnimationBatchEntry",null,[]);var Dl=d(313),$g=d(1215),ep=d(141);class Lk{constructor(){this.bzh=[];this.czh=[];this.Bqa={};this.DQa=this.CQa=null;this.sOd=!1;this.X1=null;this.xLd=this.zGd=0;this.sDc=[];this.vYe=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.ztb;this.Zx=!1}initialize(){this.sOd=!1;(this.Zx=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.q0)&&
this.Juf()}Luf(ka,$a,Db,ec){$a=this.T9d($a);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.Juf();const sc=document.createElement("div");sc.id=$a;sc.className=Lk.TEp;sc.style.width="0";this.vYe||(this.xWk(Db,$a,sc),this.Bqa[$a]=ka.Luf($a,Db,ec,sc));return sc}Juf(){this.sOd||this.b0o()}xWk(ka,$a,Db){let ec=null,sc=null;0===ka?(ec=this.CQa,sc=this.bzh):1===ka&&(ec=this.DQa,sc=this.czh);if(ec){ka=!1;for(let ad=0;ad<sc.length;ad++)if(!ka)sc[ad]===$a&&(ka=!0);else if(sc[ad]in this.Bqa){this.xan(ec,
Db,this.Bqa[sc[ad]]);return}ec.appendChild(Db)}}xan(ka,$a,Db){ka.insertBefore($a,Db.element)}UVl(ka){ka=this.T9d(ka);if(ka in this.Bqa){const $a=this.Bqa[ka];$a.element.parentNode.removeChild($a.element);delete this.Bqa[ka]}}kVj(ka){ka=this.T9d(ka);ka in this.Bqa&&(ka=this.Bqa[ka])&&!ka.isVisible&&(this.vUj(ka,!0),this.WQh(ka.position,!0,this.OZh(ka,!0)),1===ka.position&&1<I.a.count(this.Bqa)&&this.gGn())}r0m(ka){ka=this.T9d(ka);ka in this.Bqa&&(ka=this.Bqa[ka])&&ka.isVisible&&(this.vUj(ka,!1),this.WQh(ka.position,
!1,this.OZh(ka,!1)))}ggc(ka){if(this.X1)return this.X1;const $a=document.createElement("div");document.body.appendChild($a);$a&&(this.X1=new Co.a($a,ka));return this.X1}vUj(ka,$a){ka.element&&(ka.isVisible=$a,this.sDc.push(Object.assign(new Ko,{entry:ka,show:$a})));0===ka.position?this.zGd+=$a?1:-1:this.xLd+=$a?1:-1;1===this.sDc.length&&window.setTimeout(Object(ul.a)(this,this.Vbp,"startPaneAnimation"),0);this.Zx&&ka.element&&ka.element.parentNode&&(0===ka.position&&!this.zGd||1===ka.position&&!this.xLd?
(ka.element.parentNode.style.minHeight="0px",ka.element.parentNode.style.height="0px",ka.element.parentNode.style.overflow="hidden"):(ka.element.parentNode.style.minHeight="",ka.element.parentNode.style.height="",ka.element.parentNode.style.overflow=""))}Vbp(){this.Cmj();var ka=Xb.where(Xb.asEnumerable(this.sDc),sc=>0===sc.entry.position),$a=Xb.where(ka,sc=>!sc.show);if(Xb.any($a)&&Xb.Ct($a)!==Xb.Ct(ka)){for(var Db of $a)Db.entry.element.style.width="0";ka=Xb.where(ka,sc=>sc.show)}$a=Xb.where(Xb.asEnumerable(this.sDc),
sc=>1===sc.entry.position);Db=Xb.where($a,sc=>!sc.show);if(Xb.any(Db)&&Xb.Ct(Db)!==Xb.Ct($a)){for(var ec of Db)ec.entry.element.style.width="0";$a=Xb.where($a,sc=>sc.show)}for(const sc of Xb.concat(ka,$a))ka=sc.entry,ep.WacAirSpace.sY(ka.element,Dl.a.EDg),ec=new $g.a(ka.element),sc.show?ec.cif(0,ka.width):ec.cif(ka.width,0),ep.WacAirSpace.animate(ec,null,null);this.sDc.length=0}Cmj(){}OZh(ka,$a){let Db=ka.width;ka=0===ka.position?this.zGd:this.xLd;if($a&&1===ka||!$a&&!ka)Db+=1;return Db}b0o(){this.sOd||
(this.CQa||(this.CQa=document.createElement("div"),this.CQa.id=Lk.REp,this.CQa.className=Lk.Xak,Sys.UI.DomElement.addCssClass(this.CQa,"alignLeft"),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.Fba&&Sys.UI.DomElement.addCssClass(this.CQa,"FlexBoxLayout"),this.vYe&&Sys.UI.DomElement.addCssClass(this.CQa,Lk.Uak),this.VOh(0,this.CQa)),this.DQa||(this.DQa=document.createElement("div"),this.DQa.id=Lk.SEp,this.DQa.className=Lk.Xak,Sys.UI.DomElement.addCssClass(this.DQa,"alignRight"),y.AFrameworkApplication.ua&&
y.AFrameworkApplication.ua.Ib.Fba&&Sys.UI.DomElement.addCssClass(this.DQa,"FlexBoxLayout"),this.vYe&&Sys.UI.DomElement.addCssClass(this.DQa,Lk.Uak),this.VOh(1,this.DQa)),this.Roj(this.CQa,this.DQa),this.sOd=!0)}Roj(){}lIa(ka,$a){Array.add(1===ka?this.czh:this.bzh,$a)}T9d(ka){return ka+"-Entry"}gGn(){let ka=0;for(const $a of I.a.FR(this.Bqa)){const Db=Object(qb.a)(1515,this.Bqa[$a]);Db&&Db.isVisible&&1===Db.position&&ka++}2===ka?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<ka&&
a.ULS.sendTraceTag(595179605,320,50,ka+" simultaneous panes open")}}Lk.REp="WACTaskPaneContainerLeft";Lk.SEp="WACTaskPaneContainerRight";Lk.Xak="WACTaskPaneContainer";Lk.TEp="WACTaskPaneEntry";Lk.Uak="WACReactTaskPaneContainer";Object(f.a)(Lk,"BaseTaskPaneManager",null,[1516]);var Kf=d(527),Yh=d(311);class ng extends Lk{constructor(ka,$a){super();this.dMc=this.cMc=this.Ucf=this.Tcf=0;this.ari=()=>{Object(Fg.a)().forEach(Db=>{Db.F4d()})};this.ga=ka;this.Pnh=$a}VOh(ka,$a){const Db=cc.StaticActiveAppFrame.za().aG;
Db.parentNode&&(ka?1===ka&&(this.Zx?((ka=Object(Yh.a)("FarPane"))&&ka.appendChild($a),$a.classList.add("regionComposer"),cc.StaticActiveAppFrame.za().cL.registerBoundingWindowRectsChanged("farPane",(ec,sc)=>{"DP"===sc||3===sc?$a.classList.add("DL"):$a.classList.remove("DL")})):Db.parentNode.insertBefore($a,Db.nextSibling)):this.Zx?((ka=Object(Yh.a)("NearPane"))&&ka.appendChild($a),$a.classList.add("regionComposer")):Db.parentNode.insertBefore($a,Db))}WQh(ka,$a,Db){this.Zx||($a=$a?Db:-Db,ka?this.dMc+=
$a:this.cMc+=$a)}Cmj(){if(!this.Zx){var ka=cc.StaticActiveAppFrame.za().aG;ep.WacAirSpace.sY(ka,Dl.a.EDg);if(this.Tcf!==this.cMc){const $a=new Kf.a(ka);$a.n5k(this.Tcf,this.cMc,this.Pnh);ep.WacAirSpace.animate($a,null,this.ari);this.Tcf=this.cMc}this.Ucf!==this.dMc&&(ka=new Kf.a(ka),ka.o5k(this.Ucf,this.dMc,this.Pnh),ep.WacAirSpace.animate(ka,null,this.ari),this.Ucf=this.dMc)}}}Object(f.a)(ng,"TaskPaneManager",Lk,[]);var kj=d(147);class tk extends ng{get qYi(){null==this.wJe&&(this.wJe=y.AFrameworkApplication.K?
y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",!1):!1);return this.wJe}constructor(ka,$a){super(ka,$a);this.MZ=Kh.KeyInputManager.lc(Pm.a.xz,0);this.NZ=Kh.KeyInputManager.lc(Pm.a.xz,4);this.Y6e=this.NLc=null;this.kth="AccCheckerTaskPane";this.sa=new ia.a;this.isPaneOpen=!1;this.wJe=this.mSe=null;this.lIa(0,"SampleTaskPane");this.lIa(0,kj.a.Lpb);this.lIa(1,kj.a.N$k);this.lIa(1,"CustomTaskPane");this.lIa(1,kj.a.yWf);this.lIa(1,Sh.AFrame.Us);
this.lIa(1,Sh.AFrame.HMh);this.lIa(1,Sh.AFrame.CMh);this.lIa(1,kj.a.L4d);this.lIa(1,kj.a.YYc);this.lIa(1,kj.a.O_c);this.PBk=(this.p9g=!!y.AFrameworkApplication.ua&&!!y.AFrameworkApplication.ua.Ib)&&y.AFrameworkApplication.ua.Ib.r0f;this.SAk=Hg.a.Qpc;this.YAk=this.p9g&&y.AFrameworkApplication.ua.Ib.I$c;this.initialize();ka.fb(Ai.a.XDg,Xf.a.application,tk.XDg,96)}get sve(){if(!cc.StaticActiveAppFrame.za()||!cc.StaticActiveAppFrame.za().aG)return null;this.Y6e||(this.Y6e=new Co.a(cc.StaticActiveAppFrame.za().aG,
Il.FocusManager.instance()));return this.Y6e}Wb(){}Roj(ka,$a){const Db=jl.a.instance,ec=Il.FocusManager.instance(),sc=Kl.EventHandlerManager.instance,ad=this;Wj.UISurfaces.Hv().then(Xd=>{ad.NLc=ad.ggc(ec);let ue;Xd.renderTaskPaneGroups(ka,$a,(ue=new fo,ue.middleContainer=cc.StaticActiveAppFrame.za().aG,ue.onTabStripFocus=()=>{ec.ME(kj.a.hzc)},ue.onOpen=(ae,Te)=>{ad.s0f(ae)&&Uq.Vwl(ae,Te);sc.Sef(Te,"focus",ad.LGi(ae,ec),!0);var sf=ad.d_i(ae),kg=Xd.selectors.getTabbedTaskPaneCount(sf?1:2);sf=sf?kj.a.bCe:
kj.a.hzc;1===kg&&(Db.Z$(sf),this.isPaneOpen=!0,this.eyj({isPaneOpen:this.isPaneOpen,A1b:Te}));Te=ad.iKf(ae);if(kg=ec.ge(Te))kg.GWc=sf,ad.L4o(ae)&&(kg.tt(ad.MZ),kg.tt(ad.NZ)),Db.MYi(Te)&&Db.ny(Te);this.qYi&&this.y2d&&this.y2d.dismissFloatie(!0)},ue.onClose=(ae,Te)=>{ad.s0f(ae);const sf=ad.d_i(ae),kg=sf?kj.a.bCe:kj.a.hzc;Xd.selectors.getTabbedTaskPaneCount(sf?1:2)||(Db.ny(kg),this.isPaneOpen=!1,this.eyj({isPaneOpen:this.isPaneOpen,A1b:Te}));sc.isg(Te,"focus",ad.LGi(ae,ec),!0);this.qYi&&this.y2d&&this.y2d.dismissFloatie(!0)},
ue.setFocusCallback=(ae,Te)=>{ad.s0f(ae)&&Te&&(ae=ec.ge(ad.iKf(ae)),ae.csl(),ae.Bja(Te))},ue.onOverflowMenuOpen=()=>{if(ad.NLc)ad.NLc.onMenuOpen()},ue.onOverflowMenuClose=()=>{if(ad.NLc)ad.NLc.onMenuClose()},ue.onShow=(ae,Te)=>{2===Te&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{ec.Bg(ae)},0)})},ue.onHide=(ae,Te,sf)=>{sf&&1!==Te&&ec.Bg(ec.RW)},ue.onResizeStart=()=>{if(cc.StaticActiveAppFrame.za()&&(cc.StaticActiveAppFrame.za().aG.className=ui.a.uOg,ad.sve))ad.sve.onMenuOpen()},ue.onResizeEnd=
()=>{if(cc.StaticActiveAppFrame.za()&&(To.a.E1i()||(cc.StaticActiveAppFrame.za().aG.className+=" "+cc.StaticActiveAppFrame.za().k0h),ad.sve))ad.sve.onMenuClose()},ue));this.Ina(kj.a.hzc,ec,$a,ad);this.Ina(kj.a.bCe,ec,ka,ad);return null})}Ina(ka,$a,Db,ec){const sc=$a.ge(ka);sc.parent=Sh.AFrame.mq;sc.iK=!0;wg.a.instance.jIa(ka,Db,!1);cn.a.instance.jIa(ka,Db,!1);ka=new sm.DOMFocusListing(()=>Db);ka.Gn(3);ka.Gn(2);ka.Gn(4);ka.Gn(1);$a.jra(()=>Db,sc,ka).aS=!0;sc.tt(ec.MZ);sc.tt(ec.NZ)}iKf(ka){return ka===
this.kth?kj.a.KLh:ka}LGi(ka,$a){return()=>{$a.ME(this.iKf(ka))}}L4o(ka){return ka===this.kth?!1:!0}Qin(ka){return ka===kj.a.Lpb}s0f(ka){return this.Qin(ka)||ka===kj.a.KLh||0<=ka.indexOf("AppForOfficePanel")||ka===kj.a.L4d||ka===kj.a.yWf&&this.PBk||ka===kj.a.YYc&&this.SAk||ka===kj.a.O_c&&this.YAk||ka===ml.a.SOb?!0:!1}d_i(ka){return ka===kj.a.Lpb||"SampleTaskPane"===ka}static KNm(){return new tk(y.AFrameworkApplication.va,y.AFrameworkApplication.isRtl)}static XDg(ka,$a,Db,ec,sc){if(1===Db)return 32;
Wj.UISurfaces.Hv().then(ad=>{ad.showTaskPane(sc,Object.assign(new ej.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new go,{type:"SampleTaskPaneProps"})}));return null});return 32}a6a(ka){this.sa.addHandler("onPaneToggle",ka)}dld(ka){this.sa.removeHandler("onPaneToggle",ka)}eyj(ka){this.sa.raiseEvent("onPaneToggle",ka)}get y2d(){this.mSe||(this.mSe=H.a.instance.Oa("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.mSe}}Object(f.a)(tk,"TaskPaneManager",
ng,[271]);class Mm{constructor(){this.sW=null}get name(){return"WordEditor.TaskPaneManager"}wc(){}init(){this.sW=tk.KNm();this.sW.Wb();cc.StaticActiveAppFrame.za().afb=this.sW}dispose(){}}Object(f.a)(Mm,"PackageManager",null,[0,1]);d.d(J,"a",function(){return m})},2094:function(G,J,d){G=d(0);var m=d(2),f=d(127),a=d(54),l=d(250),w=d(21),y=d(19),v=d(92),u=d(200),x=d(47),z=d(35),A=d(16),D=d(46),F=d(5),I=d(7),H=d(84),N=d(322),M=d(93),U=d(86),O=d(11),V=d(6),Y=d(116),Q=d(13),S=d(37),P=d(241),T=d(40),Z=
d(243),X=d(18),aa=d(82),ia=d(157),wa=d(952),ma=d(3),na=d(88),Fa=d(67),Qa=d(22),ya=d(109),ta=d(44),Aa=d(512),oa=d(480),za=d(17),ja=d(25),fa=d(52),Ca=d(172),xa=d(23),ua=d(32),sa=d(256),Ea=d(8),Ja=d(1128),nb=d(1636),ub=d(1656),Yb=d(314),yb=d(191),Za=d(73),Ya=d(148),Pa=d(549);class rb extends Yb.a{constructor(Xa,ab,cb,ib,Ub,lb,Qb,fc){super();this.dEh=this.qx=null;this.init(Xa);this.vm("FormattingViewOperation");this.ssb(m.AFrameworkApplication.va,ab,ib,Ub,lb);this._context=cb;this.qgb=0;this.Qs=!0;this.Kvk=
Qb;this.Xn=fc}get sfa(){return this.Xn.instance}run(){const Xa=this._context.view;var ab=null;Xa.te&&(ab=Xa.lb);if(ab){var cb=ab.gb.currentSelection,ib=!ub.a.Pnc(this.actionId);!cb||rb.mg.Q0f(cb,ib)?(rb.Ec.$b(na.a.Te,{["Reason"]:Fa.a.HG}),this.Qs=!1):this.sfa&&this.sfa.eoc(cb)?(rb.Ec.$b(na.a.Te,{["Reason"]:Fa.a.t8a}),this.Qs=!1):Object(Ca.a)().pFa(Ea.ParagraphReader.BX,ab.Og)&&(rb.Ec.$b(na.a.Te,{["Reason"]:Fa.a.WQ}),this.Qs=!1)}else rb.Ec.$b(na.a.Te,{["Reason"]:Fa.a.Gga}),this.Qs=!1;1!==this.behavior&&
this.Qs||(this.Qs&&(cb=ab.gb.currentSelection,1===ab.gb.length&&1===cb.length&&za.SelectionEditor.am(cb.Ra)&&aa.b(cb.Ra)&&(rb.Ec.$b(na.a.Te,{["Reason"]:Fa.a.JWc}),this.Qs=!1)),(cb=this.Qs)&&this.actionId===ma.a.N8&&((cb=Array.from(ab.gb.currentSelection).some(Y.FormattingReader.Lrf))||rb.Ec.$b(na.a.Te,{["Reason"]:Fa.a.lzf})),this.xs=cb?32:8,this.qgb=3);this.qgb||(yb.a.mark(5730),this.dEh=Pa.SelectionReferenceFactory.instance.GMb(),cb=ab.gb.currentSelection.Ra,this.qx=new ta.GraphTransaction(15),this.qx.Ab(cb.node),
this.qx.yi=this.actionId,this.qgb=1);if(1===this.qgb){this.QC||this.Ond(this._context.Hk);if(1===this.Scb())return;this.qgb=2}if(2===this.qgb){if(this.actionId===ma.a.N8)if(ab=ab.Og,ab.Ex)for(cb=0;cb<ab.length;cb++)ib=ab.getContext(cb),this.z4j(ib);else this.z4j(ab);Ya.a.asf&&this.kop(this.actionId,this.rd);this.dEh.pva(this.actionId===ma.a.vY||this.actionId===ma.a.Kza);(ab=Object(H.a)(267,this.rd))&&!ab.I_a||Za.FocusManager.instance().Bg(Xa.xL);this.qx.dispose();this.qx=null;xa.StaticActiveAppFrame.za().Ie();
yb.a.mark(5731);this.qgb=3;this.xs=32}3===this.qgb&&(this.Kvk.process(this.actionId,this._context,this.behavior,this.response),this.Iva())}kop(Xa,ab){const cb={};cb.FormattingActionId=Xa;cb.FormattingActionData=ab;8===this.ga.Pb(ma.a.SSd,2,cb)&&I.ULS.sendTraceTag(509110153,368,10,"Command applyFormattingToContentControls failed! ActionId '{0}', ActionData '{1}'",Xa,ab)}z4j(Xa){(za.SelectionEditor.mw(Xa)||za.SelectionEditor.gl(Xa))&&Qa.App.eQ.Fha(Xa.node)}static get mg(){return sa.a.instance}static get Ec(){return u.a.instance}}
Object(G.a)(rb,"FormattingViewOperation",Yb.a,[]);var tb=d(1119);d.d(J,"a",function(){return Oa});const ob=new Set([ma.a.p3,ma.a.C4,ma.a.hE,ma.a.NIa,ma.a.OIa,ma.a.J6a,ma.a.Hza,ma.a.K6a]);class Oa{constructor(Xa,ab,cb=null,ib,Ub,lb,Qb,fc,Fc,nc,zb,Vb,rc){this.kpiName="ChangeCaseCommandUsage";this.Saa="wwaengidc";this.aub=new Map;this.euh=new Set;this.bPb=()=>new wa.a(2);this.Xwj=(pb,bb,Pb,mb,Ua)=>{mb=!0;bb.contextId!==O.a.view&&(mb=!1);if(1===Pb&&!mb)return 8;if(pb===ma.a.Rid)pb=Ua.formatting,Ua=Ua.CEg;
else{if(!bb.view||!bb.view.te)return 2;bb=bb.view;if(!bb.lb||!bb.lb.gb.currentSelection)return 8;pb=Ua;Ua=bb.lb.gb}this.Ixl(Ua,pb);return 32};this.Lif=(pb,bb,Pb,mb,Ua,vb)=>new rb(pb,bb,Pb,mb,Ua,vb,this.pwk,Oa.wy());this.QSd=(pb,bb,Pb,mb,Ua)=>{var vb,Ia,Ma;let qb=!0,Xb=bb;const Cc=!ub.a.Pnc(pb);bb.contextId!==O.a.Bd&&bb.contextId!==O.a.Xc?qb=!1:(Oa.mg.Bba(Xb,!1,Cc)&&(Oa.Ec.$b(na.a.Tn,{["Reason"]:Fa.a.HG}),qb=!1),Oa.wy()&&Oa.wy().instance&&Oa.wy().instance.DX(Xb)&&(qb=!1),qb&&za.SelectionEditor.am(bb)&&
aa.b(Xb)&&(Oa.Ec.$b(na.a.Tn,{["Reason"]:Fa.a.JWc}),qb=!1),Ea.ParagraphReader.BX(bb)&&(Oa.Ec.$b(na.a.Te,{["Reason"]:Fa.a.WQ}),qb=!1));if(1===Pb||!qb)return qb?32:8;if(bb.contextId===O.a.Xc)return 2;(bb=null===(vb=this.Bp)||void 0===vb?void 0:vb.M8d(Xb))&&(Xb=bb);this.J4o(pb)&&(vb=za.SelectionEditor.c2b(Xb),za.SelectionEditor.mf(vb)||(Xb=vb));vb="boolean"===typeof Ua&&Ua;bb=!1;(null===(Ia=this.Jda)||void 0===Ia?0:Ia.annotateRange)&&(null===(Ma=this.Jda)||void 0===Ma?0:Ma.Woc(Xb.node))&&(bb=this.e_(Xb,
pb,Ua,vb));bb&&pb!==ma.a.N8||Oa.h9.e_(Xb,Ec=>{this.Zwc(Ec,pb,Ua,Xb.cpEnd)},vb);Xb.node.Gs&&(Ia=[Object.assign(new z.a,{name:"Source",string:"CharacterFormatting"})],x.a("TOCFormatting",!0,void 0,Ia));this.Zen(pb)&&this.rVd(Xb,pb);mb&&nb.a.Gzb&&(mb.Gt|=nb.a.Eqb(Xb.node));return 32};this.dsd=(pb,bb,Pb)=>1!==Pb&&2===Pb?(this.aub.set("Source","Shortcut"),pb=bb.node.characterData.substr(bb.cpBegin,bb.cpEnd-bb.cpBegin),Oa.i1f(pb,0,pb.length)?this.rVd(bb,ma.a.NIa):Oa.Lrn(pb,pb.length)?this.rVd(bb,ma.a.Hza):
this.rVd(bb,ma.a.OIa)):32;this.nnb=(pb,bb,Pb)=>{let mb=!0;pb=!ub.a.Pnc(pb);bb.contextId!==O.a.Bd&&bb.contextId!==O.a.Xc?mb=!1:(Oa.mg.Bba(bb,!1,pb)&&(Oa.Ec.$b(na.a.Tn,{["Reason"]:Fa.a.HG}),mb=!1),mb&&za.SelectionEditor.am(bb)&&aa.b(bb)&&(Oa.Ec.$b(na.a.Tn,{["Reason"]:Fa.a.JWc}),mb=!1),mb&&Ea.ParagraphReader.BX(bb)&&(Oa.Ec.$b(na.a.Te,{["Reason"]:Fa.a.WQ}),mb=!1));if(1===Pb||!mb)return mb?32:8;bb=bb.node;this.uv.ILb(bb,!1);bb.Gs&&(bb=[Object.assign(new z.a,{name:"Source",string:"ClearFormatting"})],x.a("TOCFormatting",
!0,void 0,bb));return 32};this.DVc=(pb,bb,Pb,mb,Ua)=>{pb={};pb[tb.a.RPa]=6168;pb[tb.a.QPa]=6169;const vb=bb.view;var Ia=null;vb.nj&&(Ia=vb);var Ma=!0;let qb=32;Ia&&(Ia=Ia.lb.gb.currentSelection)&&(Oa.mg.Q0f(Ia)?(Oa.Ec.$b(na.a.Te,{["Reason"]:Fa.a.HG}),qb=8,Ma=!1):1===Pb&&(qb=32,Ma=!1));Ma&&(Ma=new ta.GraphTransaction(1===Pb?3:15),Ma.Ab(vb.root),qb=tb.a.Tua(ma.a.nnb,bb,Pb,mb,Ua,pb,12),Ma.dispose());return qb};this.Tif=(pb,bb,Pb,mb,Ua)=>{var vb,Ia=!0,Ma=32;const qb=!ub.a.Pnc(pb);bb.contextId!==O.a.Xc?
Ia=!1:Oa.mg.Bba(bb,!1,qb)&&(Oa.Ec.$b(na.a.Tn,{["Reason"]:Fa.a.HG}),Ia=!1);if(1===Pb||!Ia)return Ia?32:8;Pb=bb.node;pb===ma.a.hE&&(Oa.rm.EVc(Pb),this.uv.B3h(Pb),Ia=this.fy.EF(Pb).gh(this.fy.wordStyleIdNormal),this.Zv.VN(Ia,Pb,!0));Pb=Oa.rk.$Nf(bb);!Pb&&(Ia=null===(vb=this.Bp)||void 0===vb?void 0:vb.M8d(bb))&&(bb=Ia,Pb=ja.SelectionFactory.Fo(bb));if(Pb)Ma=fa.a.CMb(Pb),Ma=m.AFrameworkApplication.va.lg(Ma,pb,2,!1,mb,Ua);else{mb=Object(H.a)(267,Ua);vb=Y.FormattingReader.Cs(bb);if(!vb)return 16;vb=vb.cache;
switch(pb){case ma.a.font:Oa.Xpi();if(mb&&mb.rd){const {fontName:Xb,Sha:Cc,bold:Ec,italic:Wb}=Oa.lKf(mb.rd);Oa.rk.Hxe(Xb);Oa.rk.$Ag(Cc);Object(Aa.a)()&&(pb=1==Ec,Ua=1==Wb,pb||Ua)&&(Oa.rk.SN(pb),Oa.rk.kA(Ua))}break;case ma.a.ax:I.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");Oa.rk.ax(Ua);break;case ma.a.Gva:Oa.rk.ax(Ua);this.iY.W5a(Ua)||I.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ma.a.$ja:Oa.rk.$ja();
break;case ma.a.vY:I.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");Oa.rk.uEa(Ua);break;case ma.a.Jca:Oa.rk.uEa(Ua);this.iY.W5a(Ua)||I.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ma.a.Kza:Oa.rk.bWd();break;case ma.a.oC:Oa.Xpi();Oa.rk.oC(mb.rd);break;case ma.a.p3:pb=Oa.rk.rI(A.a.fontSize,vb.fontSize);Oa.rk.oC(this.Ge.p3(pb));break;case ma.a.C4:pb=Oa.rk.rI(A.a.fontSize,vb.fontSize);Oa.rk.oC(this.Ge.C4(pb));
break;case ma.a.bold:pb=Oa.rk.rI(A.a.bold,vb.isBold);Oa.rk.SN(!pb);break;case ma.a.kA:pb=Oa.rk.rI(A.a.italic,vb.isItalic);Oa.rk.kA(!pb);break;case ma.a.underline:pb=Oa.rk.rI(A.a.underline,vb.isUnderline);Oa.rk.Q8(!pb);break;case ma.a.yha:Oa.rk.yha(Ua);break;case ma.a.superscript:pb=Oa.rk.rI(A.a.superscript,vb.isSuperscript);Oa.rk.Kva(!pb);break;case ma.a.subscript:pb=Oa.rk.rI(A.a.subscript,vb.isSubscript);Oa.rk.uOa(!pb);break;case ma.a.strikethrough:pb=Oa.rk.rI(A.a.strikethrough,vb.isStrikethrough);
Oa.rk.Gna(!pb);break;case ma.a.du:pb=Oa.rk.rI(D.a.du,vb.isDoubleStrikethrough);Oa.rk.Cxe(!pb);break;case ma.a.hE:Oa.rk.txb();break;case ma.a.N8:Ua.hasProperty(A.a.DN)&&Oa.rk.N8(Ua.getValue(A.a.DN));Ua.hasProperty(F.a.noProof)&&(pb=Ua.getValue(F.a.noProof),Oa.rk.SVo(pb));break;default:this.euh.has(pb)||(this.euh.add(pb),(Ua=f.ActionManager.U$(pb))&&Ua.length||(Ua="UnknownAction"),I.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${Ua} (${pb})`))}}xa.StaticActiveAppFrame.za().Ie();
return Ma};this.AW=(pb,bb,Pb,mb,Ua)=>{mb=Oa.Ec.rq(ma.a.JSo);var vb=!0;bb.contextId!==O.a.Vc&&(vb=!1);if(1===Pb||!vb)return vb?32:8;Pb=bb.node;vb=V.GraphIterator.eb(bb.node);vb.Jd();vb=vb.wla(4);if((vb=!!vb&&Oa.Nd.Jta(vb))&&!Qa.App.Hqc)return 8;var Ia=!Ea.ParagraphReader.textLength(Pb);mb.properties.Z("Action",pb.toString());mb.properties.Z("ListContext",vb.toString());mb.properties.Z("IsEmptyParagraph",Ia.toString());I.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",
pb,vb,Ia);vb=Pb.qa.last;this.uzo(Pb,pb);var Ma=!!vb.formatting;const qb=Pb.getValue(F.a.msa);Ia=this.Qd.m8a(Pb);Ma=!Ma&&qb&&qb.equals(a.a.nil)?new ia.a(vb,a.a.nil):Ia.Bf(Ia.Jb);this.Zwc(Ia,pb,Ua,vb.cp);M.a.instance.J(1)&&Oa.Lj.H_b(Pb,vb,bb.cpBegin,bb.cpEnd,Ma,Ia,Oa.Md.Mg);mb.end();return 32};this.Vqa=(pb,bb,Pb)=>{pb=!0;const mb=V.GraphIterator.eb(bb.node);mb.Jd();bb.contextId===O.a.Vc&&mb.wla(4)||(Oa.Ec.$b(na.a.Tn,{["Reason"]:Fa.a.v4f}),pb=!1);return Oa.Nd.Jta(mb.currentNode)?1!==Pb&&pb?32:pb?32:
8:8};this.cva=(pb,bb,Pb,mb,Ua)=>{pb=!0;bb.contextId!==O.a.paragraph&&(pb=!1);if(1===Pb&&!pb)return 8;Pb=bb.node;-1!==Ua.Rh?Ua.Rh!==Ea.ParagraphReader.ez(Pb)&&(Ua.Rh=0):Ua.Rh=Ea.ParagraphReader.ez(Pb);pb=this.Vp.Rqb(Pb);Ua.Eu?(!Ua.bZm&&this.eZm(Ua.Eu,pb)&&2===Ua.Eu.specialIndentType&&(Ua.Eu.specialIndentType=0),Ua.Eu.SRb===pb.SRb&&l.a.pCa(Ua.Eu.oD,pb.oD)||(Ua.Eu.oD=Number.MAX_VALUE),Ua.Eu.TRb===pb.TRb&&l.a.pCa(Ua.Eu.ota,pb.ota)||(Ua.Eu.ota=Number.MAX_VALUE)):Ua.Eu=pb;bb=Object(Ca.a)().sVh(bb.Hk);void 0!==
bb&&null!==bb&&(bb=bb.node,void 0!==bb&&null!==bb&&(bb=P.WordSectionNavigator.instance.FN(bb),void 0!==bb&&null!==bb&&(bb=Oa.Xf.ev(bb)-(Oa.Xf.$J(bb)+Oa.Xf.FL(bb)+Qa.App.uFa),pb.y7c=bb-pb.oD,pb.x7c=bb-pb.ota,Ua.Eu.x7c=Math.min(Ua.Eu.x7c,pb.x7c),Ua.Eu.y7c=Math.min(Ua.Eu.y7c,pb.y7c))));bb=this.qZ.jWa(Pb);Ua.spacing?(Ua.spacing.beforeSpacing=Oa.dRh(bb.beforeSpacing,Ua.spacing.beforeSpacing),Ua.spacing.afterSpacing=Oa.dRh(bb.afterSpacing,Ua.spacing.afterSpacing),Ua.spacing.lineSpacing.unit===bb.lineSpacing.unit&&
l.a.pCa(Ua.spacing.lineSpacing.value,bb.lineSpacing.value)||(Ua.spacing.lineSpacing.unit=0,Ua.spacing.lineSpacing.value=0)):Ua.spacing=bb;bb=new V.GraphIterator;bb.set(Pb);bb.zb(11);if(Pb=bb.ld(11))Ua.isRtl=T.OutlineElementReader.Lo(Pb);Pb=Oa.Nd.Nw(bb);bb=16;void 0!==Pb&&null!==Pb&&(bb=Pb.listType);Ua.listType=Oa.lom(Ua.listType,bb);Ua.lz=16===Ua.listType?null:Pb;return 32};this.bko=(pb,bb,Pb,mb,Ua)=>{Ua.isRtl=T.OutlineElementReader.Lo(S.OutlineElementNavigator.nm(bb.node));return 32};this.YTh=(pb,
bb,Pb)=>{if(pb===ma.a.g0b)pb=!0;else if(pb===ma.a.f0b)pb=!1;else return 2;pb&&this.vaj(bb);if(1===Pb)return 32;this.Oh.X_b(S.OutlineElementNavigator.nm(bb.node),pb);return 32};this.Sjo=(pb,bb,Pb,mb,Ua)=>{pb=bb.node;Ua.isRtl=T.OutlineElementReader.isRtl(S.OutlineElementNavigator.nm(pb));Ua.Rh=Q.ImageReader.ez(pb);return 32};this.clo=(pb,bb,Pb,mb,Ua)=>{pb=bb.node;Ua.isRtl=T.OutlineElementReader.isRtl(S.OutlineElementNavigator.nm(pb));Ua.Rh=ua.TableReader.ez(pb);-1!==Ua.Rh&&Ua.Rh||(Ua.Rh=Ua.isRtl?3:
1);return 32};this.tdc=(pb,bb,Pb,mb,Ua)=>{let vb;if(!({Pz:vb}=ub.a.kCg(Pb,bb)).returnValue)return vb;const Ia=bb.node;switch(pb){case ma.a.f0b:this.Oh.xxc(Ia,!1);break;case ma.a.g0b:this.vaj(bb);this.Oh.xxc(Ia,!0);break;case ma.a.N8:vb=m.AFrameworkApplication.va.lg(bb.Hk,pb,Pb,!0,mb,Ua),32===vb&&Ea.ParagraphReader.nn(bb)&&Oa.Aid&&Oa.Aid.Fha(Ia)}return 32};this.qrl=(pb,bb,Pb,mb,Ua)=>{const vb={};vb[tb.a.RPa]=6168;vb[tb.a.QPa]=6169;var Ia=bb.view;const Ma=new ta.GraphTransaction(1===Pb?3:15);Ma.Ab(Ia.root);
let qb=tb.a.Tua(pb,bb,Pb,mb,Ua,vb,0),Xb=null;Ia.nj&&(Xb=Ia);Ia=!0;let Cc=null;Xb&&(Cc=Xb.lb.gb.currentSelection)&&(pb=!ub.a.Pnc(pb),Oa.mg.Q0f(Cc,pb)?(Oa.Ec.$b(na.a.Te,{["Reason"]:Fa.a.HG}),qb=8,Ia=!1):1===Pb&&(qb=32,Ia=!1),Object(Ca.a)().pFa(Ea.ParagraphReader.BX,Xb.lb.Og)&&(Oa.Ec.$b(na.a.Te,{["Reason"]:Fa.a.WQ}),qb=8,Ia=!1));Ia&&this.Qrn(Cc)&&(qb=tb.a.Tua(ma.a.nnb,bb,Pb,mb,Ua,vb,12));Ma.dispose();return qb};this.prl=(pb,bb,Pb)=>{pb=!0;bb.contextId!==O.a.paragraph&&bb.contextId!==O.a.Xc?pb=!1:Oa.mg.xab(bb)&&
(Oa.Ec.$b(na.a.Tn,{["Reason"]:Fa.a.HG}),pb=!1);if(1===Pb||!pb)return pb?32:8;bb=bb.node;Pb=new ta.GraphTransaction(15);Pb.Ab(bb);Oa.rm.EVc(bb);this.uv.ILb(bb,!0);this.Zv.rpf(bb);Pb.dispose();return 2};this.uUm=(pb,bb,Pb)=>{pb=!0;bb.contextId!==O.a.view&&(pb=!1);if(1===Pb&&!pb)return 8;if(!bb.view||!bb.view.te)return 2;bb=bb.view;if(!bb.lb||!bb.lb.gb.currentSelection)return 8;if(Object(Ca.a)().pFa(Ea.ParagraphReader.BX,bb.lb.Og))return Oa.Ec.$b(na.a.Te,{["Reason"]:Fa.a.WQ}),8;bb=bb.lb.gb;for(const mb of bb)for(const Ua of mb)if(Ua&&
Ua.contextId!==O.a.Bd&&Ua.contextId!==O.a.Xc&&Ua.contextId!==O.a.paragraph&&Ua.contextId!==O.a.Vc)return 2;return 32};this.Zcb=(pb,bb,Pb,mb,Ua)=>{pb=!0;bb.contextId!==O.a.paragraph&&(pb=!1);if(1===Pb&&!pb)return 8;Ua.Eu||(bb=bb.node,Pb=this.Vp.Rqb(bb),Ua.Eu=Pb,bb=S.OutlineElementNavigator.nm(bb),Ua.isRtl=bb?T.OutlineElementReader.Lo(bb):!1);return 32};this.dlo=(pb,bb,Pb,mb,Ua)=>{bb=bb.node;pb=S.OutlineElementNavigator.nm(bb);Ua.Eu||(bb=this.vEm(bb),bb=this.Vp.Rqb(bb),Ua.Eu=bb,Ua.isRtl=T.OutlineElementReader.isRtl(pb));
return 32};this.pwk=Xa;this.Jda=ab;this.c$=cb;this.Bp=ib;this.Ge=Ub;this.Qd=lb;this.uv=Qb;this.qZ=fc;this.Zv=nc;this.fy=Fc;this.Oh=zb;this.Vp=rc}get iY(){return null!=this.s3g?this.s3g:this.s3g=w.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get o4d(){return!!this.c$&&this.c$.enabled}Wb(){const Xa=m.AFrameworkApplication.va,ab=this.bko;(Oa.rc?Oa.rc.vE(38):m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?(Xa.ra(ma.a.font,O.a.Vc,this.AW),Xa.ra(ma.a.oC,
O.a.Vc,this.AW),Xa.ra(ma.a.p3,O.a.Vc,this.AW),Xa.ra(ma.a.C4,O.a.Vc,this.AW),Xa.ra(ma.a.ax,O.a.Vc,this.AW),Xa.ra(ma.a.Gva,O.a.Vc,this.AW),Xa.ra(ma.a.$ja,O.a.Vc,this.AW),Xa.ra(ma.a.vY,O.a.Vc,this.AW),Xa.ra(ma.a.Jca,O.a.Vc,this.AW),Xa.ra(ma.a.Kza,O.a.Vc,this.AW),Xa.ra(ma.a.bold,O.a.Vc,this.AW),Xa.ra(ma.a.kA,O.a.Vc,this.AW),Xa.ra(ma.a.underline,O.a.Vc,this.AW),Xa.ra(ma.a.yha,O.a.Vc,this.AW),Xa.ra(ma.a.superscript,O.a.Vc,this.AW),Xa.ra(ma.a.subscript,O.a.Vc,this.AW),Xa.ra(ma.a.strikethrough,O.a.Vc,this.AW),
Xa.ra(ma.a.du,O.a.Vc,this.AW),Xa.ra(ma.a.N8,O.a.Vc,this.AW),Xa.ra(ma.a.hE,O.a.Vc,this.AW)):Qa.App.Hqc&&(Xa.ra(ma.a.font,O.a.Vc,this.Vqa),Xa.ra(ma.a.oC,O.a.Vc,this.Vqa),Xa.ra(ma.a.ax,O.a.Vc,this.Vqa),Xa.ra(ma.a.Gva,O.a.Vc,this.Vqa),Xa.ra(ma.a.$ja,O.a.Vc,this.Vqa),Xa.ra(ma.a.bold,O.a.Vc,this.Vqa),Xa.ra(ma.a.kA,O.a.Vc,this.Vqa),Xa.ra(ma.a.superscript,O.a.Vc,this.Vqa),Xa.ra(ma.a.subscript,O.a.Vc,this.Vqa),Xa.ra(ma.a.strikethrough,O.a.Vc,this.Vqa),Xa.ra(ma.a.du,O.a.Vc,this.Vqa),Xa.ra(ma.a.p3,O.a.Vc,this.Vqa),
Xa.ra(ma.a.C4,O.a.Vc,this.Vqa));const cb=Qa.App.n0a.zXc(ib=>oa.OutlineElementGeneralizer.Wka(ib.gb,!0));Xa.fb(ma.a.rof,O.a.view,this.uUm,100);Xa.fb(ma.a.dsd,O.a.Bd,this.dsd,1028);Xa.ra(ma.a.CZa,O.a.view,this.Xwj);Xa.ra(ma.a.Rid,O.a.view,this.Xwj);Xa.ra(ma.a.cva,O.a.view,cb);Xa.ra(ma.a.cva,O.a.paragraph,this.cva);Xa.ra(ma.a.cva,O.a.image,this.Sjo);Xa.ra(ma.a.cva,O.a.yPa,ab);Xa.ra(ma.a.cva,O.a.table,this.clo);Xa.ra(ma.a.Zcb,O.a.view,cb);Xa.ra(ma.a.Zcb,O.a.paragraph,this.Zcb);Xa.ra(ma.a.Zcb,O.a.table,
this.dlo);Xa.Rc(ma.a.CZa,99);Xa.Rc(ma.a.Rid,1127);Xa.Rc(ma.a.cva,97);Xa.Rc(ma.a.Zcb,97);this.IO(Xa,ma.a.font);this.IO(Xa,ma.a.oC);this.IO(Xa,ma.a.p3);this.IO(Xa,ma.a.C4);Xa.Xlb(ma.a.uqi,O.a.view,this.Lif);Xa.Rc(ma.a.uqi,1092);this.IO(Xa,ma.a.ax);this.IO(Xa,ma.a.Gva);this.IO(Xa,ma.a.$ja);this.IO(Xa,ma.a.vY);this.IO(Xa,ma.a.Jca);this.IO(Xa,ma.a.J6a);this.IO(Xa,ma.a.NIa);this.IO(Xa,ma.a.OIa);this.IO(Xa,ma.a.Hza);this.IO(Xa,ma.a.K6a);this.IO(Xa,ma.a.Kza);this.IO(Xa,ma.a.bold);Xa.z_b(ma.a.bold,this.bPb);
this.IO(Xa,ma.a.kA);Xa.z_b(ma.a.kA,this.bPb);this.IO(Xa,ma.a.underline);Xa.z_b(ma.a.underline,this.bPb);this.IO(Xa,ma.a.yha);this.IO(Xa,ma.a.superscript);Xa.z_b(ma.a.superscript,this.bPb);this.IO(Xa,ma.a.subscript);Xa.z_b(ma.a.subscript,this.bPb);this.IO(Xa,ma.a.strikethrough);Xa.z_b(ma.a.strikethrough,this.bPb);this.IO(Xa,ma.a.du);Xa.z_b(ma.a.du,this.bPb);Xa.fb(ma.a.jXa,O.a.Bd,this.QSd,96);Xa.Xlb(ma.a.N8,O.a.view,this.Lif);Xa.ra(ma.a.N8,O.a.paragraph,this.tdc);Xa.ra(ma.a.N8,O.a.Bd,this.QSd);Xa.ra(ma.a.N8,
O.a.Xc,this.Tif);Xa.ra(ma.a.hE,O.a.view,this.qrl);Xa.ra(ma.a.hE,O.a.paragraph,this.prl);Xa.ra(ma.a.hE,O.a.Bd,this.QSd);Xa.ra(ma.a.hE,O.a.Xc,this.Tif);Xa.Rc(ma.a.hE,1036);Xa.ra(ma.a.nnb,O.a.Bd,this.nnb);Xa.ra(ma.a.nnb,O.a.Xc,this.nnb);Xa.ra(ma.a.DVc,O.a.view,this.DVc);Xa.ra(ma.a.f0b,O.a.view,ub.a.vx);Xa.ra(ma.a.f0b,O.a.paragraph,this.tdc);Xa.ra(ma.a.f0b,O.a.yPa,this.YTh);Xa.Rc(ma.a.f0b,1028);Xa.ra(ma.a.g0b,O.a.view,ub.a.vx);Xa.ra(ma.a.g0b,O.a.paragraph,this.tdc);Xa.ra(ma.a.g0b,O.a.yPa,this.YTh);Xa.Rc(ma.a.g0b,
1028)}IO(Xa,ab){Xa.Xlb(ab,O.a.view,this.Lif);Xa.ra(ab,O.a.Bd,this.QSd);Xa.ra(ab,O.a.Xc,this.Tif);Xa.Rc(ab,1036)}Ixl(Xa,ab){for(const fc of Xa)for(const Fc of fc){Xa=null;if(Fc.contextId===O.a.Bd){if(aa.b(Fc))continue;Xa=[];var cb=Fc.node.qa;if(cb){var ib=cb.length-1;const nc=Fc.cpBegin,zb=Fc.cpEnd;let Vb=!1;const rc=Fc.node.characterData;if(rc&&""!==rc){var Ub=rc.substr(nc,zb-nc);Ub&&""!==Ub&&y.a.Urf(Ub,0,Ub.length)&&(Vb=!0)}Ub=!1;for(let pb=0;pb<ib;pb++){var lb=cb.J(pb).cp,Qb=cb.J(pb+1).cp;if(cb.J(pb).formatting&&
Math.max(lb,nc)<Math.min(Qb,zb)){if(rc&&""!==rc&&(lb=lb<nc?nc:lb,Qb=rc.substr(lb,(Qb<zb?Qb:zb)-lb),!Vb&&y.a.Urf(Qb,0,Qb.length)))continue;Ub=!0;Xa.push(cb.J(pb).formatting)}else if(Ub)break}cb.J(ib).formatting&&Fc.cpEnd>cb.J(ib).cp&&Xa.push(cb.J(ib).formatting)}}else if(Fc.contextId===O.a.paragraph&&!Ea.ParagraphReader.BX(Fc)){if(Xa=[],cb=Fc.node.qa)for(ib=0;ib<cb.length;ib++)cb.J(ib).formatting&&Xa.push(cb.J(ib).formatting)}else if(Fc.contextId===O.a.Vc)Xa=[Y.FormattingReader.Cs(Fc)];else if(Fc.contextId===
O.a.Xc){this.Ajo(Fc,ab);return}if(Xa&&0<Xa.length)for(const nc of Xa)if(Y.FormattingReader.PLg(ab,nc.cache,Fc))return}}Ajo(Xa,ab){if(Xa=Y.FormattingReader.Cs(Xa)){Xa=Xa.cache;var cb=Oa.rk.rI(A.a.bold,Xa.isBold);ab.bold=cb?1:0;cb=Oa.rk.rI(A.a.italic,Xa.isItalic);ab.italic=cb?1:0;cb=Oa.rk.rI(A.a.underline,Xa.isUnderline);ab.underline=cb?1:0;ab.underlineType=Oa.rk.rI(A.a.underlineType,Xa.underlineType);cb=Oa.rk.rI(A.a.superscript,Xa.isSuperscript);ab.superscript=cb?1:0;cb=Oa.rk.rI(A.a.subscript,Xa.isSubscript);
ab.subscript=cb?1:0;cb=Oa.rk.rI(A.a.strikethrough,Xa.isStrikethrough);ab.strikethrough=cb?1:0;cb=Oa.rk.rI(D.a.du,Xa.isDoubleStrikethrough);ab.du=cb?1:0;cb=Oa.rk.rI(A.a.font,Xa.mI);ab.fontName=ya.a.h9a(cb);ab.Sha=Xa.Qe;ab.fontSize=Oa.rk.rI(A.a.fontSize,Xa.fontSize);ab.fontColor=Oa.rk.rI(A.a.fontColor,Xa.fontColor);ab.highlight=Oa.rk.rI(A.a.highlight,Xa.highlight)}}J4o(Xa){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.isUnderlineButtonSelectionBugFixEnabled",!1)?
Xa===ma.a.yha||Xa===ma.a.strikethrough||Xa===ma.a.du||Xa===ma.a.vY:Xa===ma.a.underline||Xa===ma.a.yha||Xa===ma.a.strikethrough||Xa===ma.a.du||Xa===ma.a.vY}static lKf(Xa){return"string"===typeof Xa?{fontName:Xa,Sha:-1,bold:2,italic:2}:Xa}e_(Xa,ab,cb,ib){var Ub;const lb=Xa.cpBegin,Qb=Xa.cpEnd,fc=Xa.node;var Fc=Y.FormattingReader.Cs(Xa);let nc=lb;const zb=null===(Ub=m.AFrameworkApplication.K)||void 0===Ub?void 0:Ub.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);Ub=Oa.Md.Mg;
if(zb&&(Ub||fc.gv))return!1;if(ob.has(ab))for(const Vb of fc.qa)if(!(Vb.cp<=lb)){if(Vb.cp>=Qb)break;Vb.formatting&&Vb.formatting.cache.fontSize!=Fc.cache.fontSize&&(Fc=this.qKf(Xa.node,Fc,ab,cb,zb?null:ib),this.Jda.annotateRange(Xa.node,zb?fc.qa.Y7a(nc):nc,zb?fc.qa.Y7a(Vb.cp):Vb.cp,Fc),nc=Vb.cp,Fc=Vb.formatting)}ab=this.qKf(Xa.node,Fc,ab,cb,zb?null:ib);this.Jda.annotateRange(Xa.node,zb?fc.qa.Y7a(nc):nc,zb?fc.qa.Y7a(Qb):Qb,ab);return!0}qKf(Xa,ab,cb,ib,Ub){const lb={},Qb=Object(H.a)(267,ib),fc=ab.cache;
switch(cb){case ma.a.bold:2===ib.value&&(ib.value=fc.isBold?0:1);lb[A.a.bold.id]=1===ib.value;break;case ma.a.kA:2===ib.value&&(ib.value=fc.isItalic?0:1);lb[A.a.italic.id]=1===ib.value;break;case ma.a.underline:2===ib.value&&(ib.value=fc.isUnderline?0:1);ib=1===ib.value;lb[A.a.underline.id]=ib;lb[A.a.underlineType.id]=ib?ya.a.fAb:ya.a.HS;break;case ma.a.yha:lb[A.a.underlineType.id]=ib.number;lb[A.a.underline.id]=ib.number!==ya.a.HS;break;case ma.a.superscript:2===ib.value&&(ib.value=fc.isSuperscript?
0:1);lb[A.a.superscript.id]=1===ib.value;1===ib.value&&(lb[A.a.subscript.id]=!1);break;case ma.a.subscript:2===ib.value&&(ib.value=fc.isSubscript?0:1);lb[A.a.subscript.id]=1===ib.value;1===ib.value&&(lb[A.a.superscript.id]=!1);break;case ma.a.strikethrough:6!==m.AFrameworkApplication.va.iE?I.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):I.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===ib.value&&(ib.value=fc.isStrikethrough?0:1);lb[A.a.strikethrough.id]=
1===ib.value;break;case ma.a.du:2===ib.value&&(ib.value=fc.isDoubleStrikethrough?0:1);lb[D.a.du.id]=1===ib.value;break;case ma.a.font:if(Qb&&Qb.rd){const {fontName:nc,Sha:zb,bold:Vb,italic:rc}=Oa.lKf(Qb.rd);ib=nc.substr(0,Oa.cdj);this.o4d&&(lb[F.a.DW.id]=ib,lb[F.a.nE.id]=ib,lb[F.a.M2.id]=ib,lb[F.a.r3.id]=ib,lb[F.a.Ue.id]=zb,lb[F.a.pf.id]=zb,lb[F.a.Se.id]=zb,lb[F.a.We.id]=zb);lb[A.a.font.id]=ib;lb[F.a.Qe.id]=zb;if(Object(Aa.a)()){ib=1==Vb;var Fc=1==rc;if(ib||Fc)lb[A.a.bold.id]=ib,lb[A.a.italic.id]=
Fc}}break;case ma.a.ax:ib=Ja.a.instance.sra(Xa,ib);lb[A.a.fontColor.id]=ib;break;case ma.a.Gva:Fc=Ja.a.instance.sra(Xa,ib);lb[A.a.fontColor.id]=Fc;this.iY.W5a(ib)||I.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ma.a.$ja:lb[A.a.fontColor.id]=U.a.auto;break;case ma.a.vY:lb[A.a.highlight.id]=parseInt(ib,16);break;case ma.a.Jca:lb[A.a.highlight.id]=parseInt(ib,16);this.iY.W5a(ib)||I.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");
break;case ma.a.Kza:lb[A.a.highlight.id]=U.a.auto;break;case ma.a.oC:lb[A.a.fontSize.id]=this.Ge.tfc(Qb.rd);break;case ma.a.p3:fc&&fc.fontSize&&(lb[A.a.fontSize.id]=this.$vm(fc.fontSize));break;case ma.a.C4:fc&&fc.fontSize&&(lb[A.a.fontSize.id]=this.Yom(fc.fontSize));break;case ma.a.jXa:if(ib=null===(Fc=Oa.uB)||void 0===Fc?void 0:Fc.jXa)for(const nc of ib.fk())lb[nc.id]=ib.wf(nc);break;case ma.a.hE:if(ib=ab.uo)for(const nc of ib.fk())lb[nc.id]=null;lb[F.a.HLb.id]=!0;break;case ma.a.NIa:case ma.a.OIa:case ma.a.J6a:case ma.a.Hza:case ma.a.K6a:fc.AWa&&
2===fc.capitalization&&(lb[D.a.capitalization.id]=0)}null!=Ub&&(lb[m.AFrameworkApplication.VFf]=Ub);return lb}$vm(Xa){Xa=this.Ge.p3(Xa);return this.Ge.tfc(Xa)}Yom(Xa){Xa=this.Ge.C4(Xa);return this.Ge.tfc(Xa)}Zwc(Xa,ab,cb,ib){var Ub=Xa.cache;const lb=Object(H.a)(267,cb);switch(ab){case ma.a.bold:2===cb.value&&(cb.value=Ub.isBold?0:1);this.Ge.SN(Xa,1===cb.value);break;case ma.a.kA:2===cb.value&&(cb.value=Ub.isItalic?0:1);this.Ge.kA(Xa,1===cb.value);break;case ma.a.underline:2===cb.value&&(cb.value=
Ub.isUnderline?0:1);this.Ge.Q8(Xa,1===cb.value);break;case ma.a.yha:this.Ge.yha(Xa,cb);break;case ma.a.superscript:2===cb.value&&(cb.value=Ub.isSuperscript?0:1);this.Ge.Kva(Xa,1===cb.value);break;case ma.a.subscript:2===cb.value&&(cb.value=Ub.isSubscript?0:1);this.Ge.uOa(Xa,1===cb.value);break;case ma.a.strikethrough:6!==m.AFrameworkApplication.va.iE?I.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):I.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");
2===cb.value&&(cb.value=Ub.isStrikethrough?0:1);this.Ge.Gna(Xa,1===cb.value);break;case ma.a.du:2===cb.value&&(cb.value=Ub.isDoubleStrikethrough?0:1);this.Ge.Cxe(Xa,1===cb.value);break;case ma.a.font:if(lb&&lb.rd){const {fontName:Qb,Sha:fc,bold:Fc,italic:nc}=Oa.lKf(lb.rd);this.Ge.tha(Xa,Qb.substr(0,Oa.cdj));this.Ge.$Ag(Xa,fc);Object(Aa.a)()&&(cb=1==Fc,ib=1==nc,cb||ib)&&(this.Ge.SN(Xa,cb),this.Ge.kA(Xa,ib))}break;case ma.a.ax:I.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");
this.Ge.ax(Xa,cb,null);break;case ma.a.Gva:this.Ge.ax(Xa,cb,null);this.iY.W5a(cb)||I.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ma.a.$ja:this.Ge.$ja(Xa);break;case ma.a.vY:I.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");this.Ge.uEa(Xa,cb);break;case ma.a.Jca:this.Ge.uEa(Xa,cb);this.iY.W5a(cb)||I.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");
break;case ma.a.Kza:this.Ge.bWd(Xa);break;case ma.a.oC:this.Ge.oC(Xa,lb.rd);break;case ma.a.p3:this.Ge.hMi(Xa);break;case ma.a.C4:this.Ge.vVj(Xa);break;case ma.a.N8:Ub=cb.ja(F.a.noProof,!1);this.Ge.Yxe(Xa,cb.getValue(A.a.DN),ib,Ub);break;case ma.a.jXa:this.Ge.Jxe(Xa);break;case ma.a.hE:this.Ge.Zja(Xa);break;case ma.a.NIa:case ma.a.OIa:case ma.a.J6a:case ma.a.Hza:case ma.a.K6a:Ub.AWa&&2===Ub.capitalization&&this.Ge.brl(Xa)}}uzo(Xa,ab){ma.a.hE===ab&&S.OutlineElementNavigator.nm(Xa).properties.removeProperty(A.a.d4)}eZm(Xa,
ab){return this.qUh(Xa,ab)||this.qUh(ab,Xa)}qUh(Xa,ab){return(1===Xa.specialIndentType||!Xa.specialIndentType)&&2===ab.specialIndentType}vEm(Xa){Xa=V.GraphIterator.eb(Xa);Xa.zb(11);X.moveToCell(Xa,0,0);Xa.Xd();Xa.S_();return Xa.currentNode}Qrn(Xa){return!Xa||za.SelectionEditor.Dm(Xa)||1===Xa.length&&za.SelectionEditor.am(Xa.Ra)&&!za.SelectionEditor.atb(Xa.Ra)?!1:!0}vaj(Xa){Oa.qDh.mb(Xa.contextId)||(I.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",Xa.contextId),Oa.qDh.Z(Xa.contextId,!0))}Zen(Xa){return Xa===
ma.a.J6a||Xa===ma.a.NIa||Xa===ma.a.OIa||Xa===ma.a.Hza||Xa===ma.a.K6a}rVd(Xa,ab){const cb=Xa.node,ib=cb.characterData.substr(Xa.cpBegin,Xa.cpEnd-Xa.cpBegin);this.aub.set("Command",ab.toString());v.Health.instance.recordKpiUsage(this.kpiName,1,this.Saa,this.aub);ab=Oa.Aip(ib,ab);cb.Dva(cb.characterData.substr(0,Xa.cpBegin)+ab+cb.characterData.substr(Xa.cpEnd));return 32}static get rk(){return Oa.uB||(Oa.uB=w.a.instance.resolve("Box4.IInsertionPointFormatting"))}static wy(){return Oa.Xn||(Oa.Xn=w.a.instance.Qa("Box4.IExternalSelectionManager"))}static get mg(){return sa.a.instance}static get Ec(){return u.a.instance}static get rc(){return null!=
Oa.PWg?Oa.PWg:Oa.PWg=w.a.instance.Oa("Box4.IFeatureHelper")}static get Aid(){return Qa.App.eQ}static get Md(){return null!=Oa.x6g?Oa.x6g:Oa.x6g=w.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Lj(){return null!=Oa.Z5g?Oa.Z5g:Oa.Z5g=w.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get h9(){return null!=Oa.C5g?Oa.C5g:Oa.C5g=w.a.instance.resolve("Box4.TextFormattingHelper")}static get Nd(){return null!=Oa.x1g?Oa.x1g:Oa.x1g=w.a.instance.resolve("Box4.List.IListReader")}static get rm(){return null!=
Oa.j1g?Oa.j1g:Oa.j1g=w.a.instance.resolve("Box4.List.IListEditor")}static get Xf(){return Z.a.instance}static lom(Xa,ab){return 42===Xa?ab:Xa!==ab||16===Xa?16:Xa}static dRh(Xa,ab){Xa.XWi||(ab.XWi?ab=Xa:ab.unit===Xa.unit&&l.a.pCa(ab.value,Xa.value)||(ab.value=-1));return ab}static Aip(Xa,ab){switch(ab){case ma.a.NIa:return Xa.toLowerCase();case ma.a.OIa:return 6!==m.AFrameworkApplication.va.iE?I.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):I.ULS.sendTraceTag(539305616,340,
50,"User changed the case from keyboard shortcut"),Xa.toUpperCase();case ma.a.J6a:case ma.a.Hza:return Oa.Bnl(Xa,ab===ma.a.Hza);case ma.a.K6a:return Oa.$kp(Xa);default:return Xa}}static $kp(Xa){let ab="";for(let cb=0;cb<Xa.length;cb++)ab=Xa.charAt(cb)===Xa.charAt(cb).toUpperCase()?ab+Xa.charAt(cb).toLowerCase():ab+Xa.charAt(cb).toUpperCase();return ab}static Bnl(Xa,ab){let cb,ib,Ub=!0,lb=Xa.length,Qb=0,fc=Oa.i1f(Xa,Qb,lb);for(;0<lb;){ib=cb=!1;var Fc=lb;let zb;var nc=void 0;for(nc=0;0<Fc&&Oa.iql(Xa.charAt(Qb+
nc));nc++,Fc--)ib=Oa.ige(Xa.charAt(Qb+nc));for(zb=nc;0<Fc&&!(cb=Oa.ige(Xa.charAt(Qb+nc)))&&" "!==Xa.charAt(Qb+nc)&&"/"!==Xa.charAt(Qb+nc);nc++,Fc--);Fc=nc-zb;if(0>=Fc)break;Qb+=zb;nc=Xa.substr(Qb,Fc);nc=nc===nc.toUpperCase();if(fc||!nc)Xa=Ub||ib||ab?Xa.substr(0,Qb)+Xa.charAt(Qb).toUpperCase()+Xa.substr(Qb+1,Fc-1).toLowerCase()+Xa.substr(Qb+Fc):Xa.substr(0,Qb)+Xa.substr(Qb,Fc).toLowerCase()+Xa.substr(Qb+Fc);lb-=Fc+zb;Qb+=Fc;if(Ub=cb)Qb++,lb--,fc=Oa.i1f(Xa,Qb,lb)}return Xa}static i1f(Xa,ab,cb){for(;0<
cb&&!Oa.ige(Xa.charAt(ab));){if(Xa.charAt(ab)!==Xa.charAt(ab).toUpperCase())return!1;ab++;cb--}return!0}static Lrn(Xa,ab){for(var cb=0;0<ab&&!Oa.ige(Xa.charAt(cb));){if(Xa.charAt(cb)!==Xa.charAt(cb).toLowerCase())return!1;cb++;ab--}return!0}static ige(Xa){return"."===Xa||"!"===Xa||"?"===Xa?!0:!1}static iql(Xa){return-1==="0123456789".indexOf(Xa)&&Xa.toUpperCase()===Xa.toLowerCase()}static Xpi(){const Xa=w.a.instance.Qa("Common.ISystemInitiatedFeedback");Xa&&Xa.execute(ab=>{ab.logActivity("FontsSurveyActivity",
"FontsFloodgateSurvey")})}}Oa.qDh=new N.a;Oa.uB=null;Oa.Xn=null;Oa.cdj=31;Object(G.a)(Oa,"TextFormattingActor",null,[])},2171:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(G.a)(m,"AtMentionAttributes",null,[])},2178:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);var m;(function(f){f[f.initial=0]="initial";f[f.NXj=1]="startSearch";f[f.oKj=2]="searching";f[f.Rxb=3]="searchComplete";f[f.Avc=4]="replaceAllInProgress";
f[f.zvc=5]="replaceAllComplete";f[f.Vha=6]="tooManyResults";f[f.JYa=7]="noMatchesFound"})(m||(m={}));Object(G.b)("FindReplaceViewType",m)},2180:function(G,J,d){d.d(J,"a",function(){return m});var m;(function(f){f[f.initial=0]="initial";f[f.headings=1]="headings";f[f.find=2]="find";f[f.replace=3]="replace";f[f.intelligentPlaceholder=4]="intelligentPlaceholder";f[f.contracts=5]="contracts"})(m||(m={}))},2209:function(G,J,d){function m(b,h){h=Object.assign(new ia.a,{name:"LinkType",string:h});f(wb.a.c$m,
b,[h])}function f(b,h,n,B=!0){h&&h.UILocation&&Object(Pe.d)(b,B,Pe.e,0,h.UILocation,0,n)}function a(b,h){const n=Ya.a.instance;return new Vv(b,h,n.rf("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value,n.rf("WordEditor.Bookmark.FullBookmarkManager").value,n.resolve("Box4.IHyperlinkStrategy"),n.resolve("Box4.IHyperlinkEditor"),n.resolve("Box4.ICharacterPropertiesEditor"),n.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,n.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
Rn.a.instance,n.Oa("Box4.IInternalLinkManager"))}function l(b,h){var n;return b===st.none?"none":null===(n=yE[b])||void 0===n?void 0:n[h]}function w(){const b=Ya.a.instance.Oa("WordEditor.Gc2Inline.IWordEditHostFactory");void 0===b&&x.ULS.sendTraceTag(509694672,322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}function y(){const b=Ya.a.instance.Oa("WordEditor.Gc2Inline.IGc2ClassFactory");void 0===b&&x.ULS.sendTraceTag(509224267,322,10,"getGC2ClassFactory: Failed to resolve GC2 class factory from container.");
return b}function v(b){b.Qa("Box4.AugmentationLoop.IUtilsWrapper").execute(async h=>{var n,B,L,ba;await h.Pl();h=da.a.getAugLoopRuntimeManager();const la=await h.getSession();null!==(ba=null===(L=null===(B=null===(n=null===la||void 0===la?void 0:la.sessionManager)||void 0===n?void 0:n.networkWorkerManager)||void 0===B?void 0:B.globalUrl)||void 0===L?void 0:L.startsWith)&&void 0!==ba&&ba.call(L,"ws://localhost")&&(n={message:new va.w({seq:0,ops:[new Kq.a({parentPath:["session"],items:[{id:"doc",body:new Ra.d({isReadonly:!1})}]}),
new Kq.a({parentPath:["session","doc"],items:[{id:"headerfooters",body:new db.HeaderFooterSubDocument},{id:"comments",body:new db.CommentSubDocument},{id:"main",body:new db.MainSubDocument}]})]})},h.submitCustomMessage(n))})}d.r(J);var u=d(0),x=d(7),z=d(104),A=d(2),D=d(34),F=d(19),I=d(175),H=d(97);class N{constructor(b){this.YIg=0;this.DRb=this.wuc=this.IEa=null;this.pV=A.AFrameworkApplication.ua.hs;this.c0=b;this.c0.Aw(H.a.uNj);this.c0.BD(H.a.uNj,Object(z.a)(this,this.a1n,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.DRb)return x.ULS.sendTraceTag(589050652,
344,100,"Returning existing promise"),this.DRb;this.IEa=this.pV.Vf("ComponentAttach","getCustomAuthConfig");return this.DRb=new Promise((b,h)=>{const n={};let B=!1,L=!1,ba=0;this.YIg=window.setInterval(()=>{4>ba?(ba++,this.c0.sendMessage(H.a.getCustomAuthConfig,n)):(window.clearInterval(this.YIg),B=!0,x.ULS.sendTraceTag(588087303,344,10,D.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.wuc=(la,La)=>{window.clearInterval(this.YIg);B||L||(L=!0,la?(x.ULS.sendTraceTag(589050653,
344,50,"Resolving Promise with authConfig"),b(la)):(x.ULS.sendTraceTag(589050654,369,10,D.c({["error"]:La.toString()})),h(La)))};this.c0.sendMessage(H.a.getCustomAuthConfig,n)})}a1n(b){try{const h=D.a(b.Values[I.a.til]);let n=A.AFrameworkApplication.K.kb("Application")||"";n=F.a.xh(n);h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+n+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+n+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+
n+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+n+"%3Facctsw%3D1";this.IEa&&(this.IEa.stop(),this.IEa=null);this.wuc(h,"")}catch(h){x.ULS.sendTraceTag(589050655,344,10,D.c({["error"]:h.message,["stack"]:h.stack})),this.wuc(null,h.message)}}}Object(u.a)(N,"AccountSwitchingManager",null,[170]);var M=d(193);class U{get name(){return"Common.App.AccountSwitching"}wc(b){b.register(N,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ha().Rd(()=>
new N(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){M.a.instance.Jc(new U)}}Object(u.a)(U,"AccountSwitchingPackage",null,[0,1]);var O;(function(b){b[b.N8a=0]="generalException";b[b.Nce=1]="invalidArgument";b[b.xcg=2]="notAllowed";b[b.kif=3]="apiNotAvailable";b[b.Xsp=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.xef=6]="adalTimeout";b[b.H$j=7]="userNotSignedIn";b[b.iud=8]="userAborted";b[b.FVj=9]="silentSignInFailed";b[b.v8c=10]="invalidResourceUrl";b[b.MWf=
11]="invalidGrant";b[b.B6h=12]="connectionLost";b[b.Dpf=13]="clientError";b[b.Lyg=14]="serverError"})(O||(O={}));Object(u.b)("ErrorCodes",O);d(1927);class V{constructor(b,h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(u.a)(V,"OutstandingRequest",null,[]);class Y{}Y.IQn="AADSTS50058";Y.v8c="AADSTS50001";Y.BQn="AADSTS65001";Y.sRn="AADSTS70011";Y.iud="13002";Y.Pco="Popup Window is null";Y.Oco="Popup Window closed";Y.xef="Token renewal operation failed due to timeout";
Y.jlp="tokenRevoked";Object(u.a)(Y,"WopiHostErrorType",null,[]);var Q=d(671),S=d(54),P=d(1926);class T{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(u.a)(T,"WopiIdentityInfo",null,[781]);class Z{constructor(b,h,n){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=n}}Object(u.a)(Z,"WopiIdentityToken",null,[780]);var X=d(20),aa=d(198),ia=d(35),wa=d(167);class ma{constructor(b){this._initialized=
!1;this.$0n=h=>{let n=null;try{const L=h.Values[I.a.jFg],ba=h.Values[I.a.$ap],la=h.Values[I.a.kXj],La=h.Values[I.a.hbp];let fb=null,Cb=null;const Lb=this.qtc[L];if("undefined"!==typeof Lb&&Lb){var B=[];Array.add(B,Object.assign(new ia.a,{name:I.a.iFg,string:Lb.requestParameters.correlationId}));aa.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:B}));n=Lb.requestCallback;delete this.qtc[L];"undefined"!==typeof ba&&ba&&ba.length?
Cb=new Z(ba,la,La):fb=O[this.gIn(h)];B="getAccessToken_"+L;B in this.oBe&&(this.oBe[B].stop(),delete this.oBe[B]);n(Cb,fb)}else x.ULS.sendTraceTag(37856066,344,10,D.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:L}))}catch(L){h=h.Values[I.a.jFg],h in this.qtc&&delete this.qtc[h],this.zie(),x.ULS.sendTraceTag(37856067,344,10,D.c({["error"]:L.message,["stack"]:L.stack})),n&&n(null,"generalException")}};this.qtc={};this.oBe={};this.pV=A.AFrameworkApplication.ua.hs;this.JTf=
b}kpb(b){this._initialized||(b.Aw(H.a.muc),b.BD(H.a.muc,this.$0n),this._initialized=!0)}getAccessToken(b,h,n=null){this.OX(b,h);return new Promise((B,L)=>{if(this.xXf(h))if(h in this.qtc)L("unresolvedPendingRequest");else{var ba=window.setTimeout(()=>{x.ULS.sendTraceTag(37856032,344,10,D.c({["error"]:"Request timeout.",["callerId"]:h}));L("timeout")},12E4);this.MGf(b,h,n,(la,La)=>{window.clearTimeout(ba);la?B(la):(x.ULS.sendTraceTag(37856033,369,15,D.c({["error"]:O[La]})),L(La))})}else x.ULS.sendTraceTag(37856034,
344,10,D.c({["error"]:"Caller is not allowed."})),L("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,n)=>{this.xXf(b)?this.GGm((B,L)=>{B?h(B):(x.ULS.sendTraceTag(37856064,369,10,D.c({["error"]:L.toString()})),n(L))}):(x.ULS.sendTraceTag(37856065,344,10,D.c({["error"]:"Caller is not allowed."})),n("notAllowed"))})}getAuthContext(b){return new Promise((h,n)=>{const B=this.getAuthContextSync(b);B?h(B):n("notAllowed")})}getAuthContextSync(b){if(this.xXf(b)){const h=new P.a;h.upn=A.AFrameworkApplication.K.kb("UserPrincipalName");
h.userId=A.AFrameworkApplication.K.kb("LoggableUserId");h.authority=A.AFrameworkApplication.K.kb("HostAuthAuthority");h.tenantId=A.AFrameworkApplication.K.kb("TenantId");h.isAnonymous=A.AFrameworkApplication.K.$("IsAnonymousUser");h.supportsAuthToken=this.v1m(b);b=A.AFrameworkApplication.K.kb("HostAuthType");h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return h}x.ULS.sendTraceTag(40751647,344,10,D.c({["error"]:"Caller is not allowed."}));return null}v1m(b){const h=Q.a.E6c;
return X.a.RXa?h&&Q.a.O_j?Array.contains(Q.a.O_j,b.toLowerCase()):!1:h}MGf(b,h,n,B){var L=[];Array.add(L,Object.assign(new ia.a,{name:"CallerId",string:h}));Array.add(L,Object.assign(new ia.a,{name:I.a.iFg,string:b.correlationId}));aa.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:L}));L=S.a.create().toString();const ba="getAccessToken_"+L,la=this.pV.Vf("ComponentAttach",ba);this.oBe[ba]=la;const La={};La[I.a.jFg]=L;La[I.a.ebp]=
b.resource;La[I.a.fbp]=b.scope;La[I.a.kXj]=A.AFrameworkApplication.K.kb("HostAuthType");La[I.a.ibp]=A.AFrameworkApplication.K.kb("UserPrincipalName");La[I.a.gbp]=b.silentLogin;La[I.a.bbp]=b.options;La[I.a.iFg]=b.correlationId;La[I.a.cbp]=h;n&&(La[I.a.addinName]=n.AddinName,La[I.a.abp]=n.AddinTrustId);this.JTf.execute(fb=>{this.kpb(fb);fb.sendMessage(H.a.getAuthToken,La)});this.qtc[L]=new V(b,B)}GGm(b){const h=A.AFrameworkApplication.K.kb("UserName"),n=A.AFrameworkApplication.K.kb("UserPrincipalName"),
B=A.AFrameworkApplication.K.kb("LoggableUserIdSpace"),L=new T;L.email=n;L.displayName=h;switch(B){case "OrgIdPuid":L.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":L.authority="MicrosoftAccount";break;default:L.authority=B}b(L,null)}xXf(b){var h=A.AFrameworkApplication.ySm();b=b.toLowerCase();for(const n of h)if(b===n.toLowerCase())return!0;h=Q.a.qif;for(const n in h)if(b===h[n].toLowerCase())return!0;return!1}gIn(b){b=b.Values[I.a.dbp];this.zie();x.ULS.sendTraceTag(39068821,
344,15,D.c({["error"]:b}));return b?-1<b.indexOf(Y.IQn)?9:-1<b.indexOf(Y.Pco)||-1<b.indexOf(Y.Oco)?12:-1<b.indexOf(Y.v8c)?10:-1<b.indexOf(Y.iud)?8:-1<b.indexOf(Y.sRn)||-1<b.indexOf(Y.BQn)||b===Y.jlp?11:-1<b.indexOf(Y.xef)?6:0:13}OX(b,h){b=this.Ero(b.resource);x.ULS.sendTraceTag(39921882,344,50,D.c({["callerId"]:h,["resource"]:b}))}zie(){x.ULS.sendTraceTag(39068822,344,50,D.c({["userAgent"]:window.navigator.userAgent}))}Ero(b){return(b?b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/",
"\\")}}Object(u.a)(ma,"WopiIdentityManager",null,[759]);class na{constructor(){this.W=null;this.pz=()=>{try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){x.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}}get name(){return"Common.App.WopiIdentity"}wc(b){this.W=b;b.register(ma,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ha().Rd(()=>new ma(b.Qa("Postmessage.IHostPostmessenger")))}init(){A.AFrameworkApplication.K&&
A.AFrameworkApplication.K.Rn(this.pz)}dispose(){}static main(){M.a.instance.Jc(new na)}}Object(u.a)(na,"WopiIdentityPackage",null,[0,1]);var Fa=d(543),Qa=d(298),ya=d(84),ta;(function(b){b[b.qTp=0]="applicationFeatureHelperHandler";b[b.wVp=1]="cloudPolicySettings";b[b.YSp=2]="alternateAuthToken"})(ta||(ta={}));Object(u.b)("ApplicationFeatureHelperRequestType",ta);class Aa{constructor(){this.message=null;this.httpStatusCode=0}}Object(u.a)(Aa,"HttpRequstToPromiseRejectData",null,[]);var oa=d(92),za=
d(49),ja=d(194),fa=d(583);class Ca{constructor(b,h){this.Ga=b;this.Af=h}xMb(b,h,n,B=null,L=null,ba=null,la=null,La=null){const fb=ta[n],Cb=fb+"RequestFailure";oa.Health.instance.recordKpiUsage(Cb,0,"jpittsdirects",null);return new Promise((Lb,$b)=>{x.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",fb);const tc=null!=la?la:this.Ga.ic("ApplicationFeatureHelperRequestQueueTimeout",15E3),Nc=null!=La?La:this.Ga.ic("ApplicationFeatureHelperRequestSentTimeout",
3E4);this.Af.X5a(b,1,null,this.x3c(n,B),ba,1,dd=>{x.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",fb);try{if(void 0===dd||null===dd||void 0===dd.data||null===dd.data||void 0===dd.data.De||null===dd.data.De){oa.Health.instance.recordKpiFailure(Cb,"Invalid RequestSucceededEventArgs",!1,!0,null);const xe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
fb);$b(this.A7(xe,dd))}else if(dd.data.He!==ja.a.zz){oa.Health.instance.recordKpiFailure(Cb,"HttpStatusCode_"+dd.data.He.toString(),!1,!0,null);const xe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",dd.data.He,fb);$b(this.A7(xe,dd))}else{void 0!==L&&null!==L&&void 0!==dd.data.vi&&null!==dd.data.vi&&L(dd.data.vi);var Hd=h(dd.data.De);if(Hd)x.ULS.sendTraceTag(50622690,3004,50,
"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",fb),Lb(Hd);else{oa.Health.instance.recordKpiFailure(Cb,"Parse Failure",!1,!0,null);const xe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",fb);$b(this.A7(xe,dd))}}}catch(xe){oa.Health.instance.recordKpiFailure(Cb,"Unexpected Failure",!1,!0,null),Hd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
xe,fb),$b(this.A7(Hd,dd))}},dd=>{if(dd.data){oa.Health.instance.recordKpiFailure(Cb,"HttpStatusCode_"+dd.data.He.toString(),!1,!0,null);var Hd=fa.a.DQb(dd.data.De||"No Data");Hd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",dd.data.He,Hd,fb)}else oa.Health.instance.recordKpiFailure(Cb,"Invalid RequestFailedEventArgs",!1,!0,null),Hd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
fb);$b(this.A7(Hd,dd))},void 0,void 0,tc,Nc)})}A7(b,h){const n=new Aa;n.message=b;n.httpStatusCode=h&&h.data?h.data.He:-1;return n}x3c(b,h){const n={};n["x-UserDataSignature"]=this.Ga.kb("UserDataSignature");n["x-LicensingIsEnabled"]=this.Ga.$("LicensingIsEnabled").toString();n["x-CacheIsEnabled"]=this.Ga.$("LicensingRedisIsEnabled").toString();n["x-OcpsIsEnabled"]=this.Ga.$("OcpsIsEnabled").toString();n["x-LicensingAADIdIsEnabled"]=this.Ga.$("LicensingAadIdIsEnabled").toString();0===b&&(n["x-LicenseCheckOnTenantEnabled"]=
"true",n["x-SupportUserConsentDependentFeatures"]="true",n["x-AFHUserConsentGroupValue"]="0",n["x-UseShellServiceForUserConsentGroup"]="true",n["x-SMBUserLicensingEnabled"]="true",n["x-AFHPIPLComplianceEnabled"]=za.a.HL(window.location.href,"wd_afhpipl")||"false",n["x-ConsumerLicensingSNICertIsEnabled"]=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),n["x-MSGraphInLicensingIsEnabled"]=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",
!1).toString());if(h)for(const B of h.keys)n[B]=h.J(B);return n}}Object(u.a)(Ca,"HttpRequestToPromiseUtility",null,[]);var xa;(function(b){b[b.wGn=0]="loki";b[b.ATp=1]="augloopACLP"})(xa||(xa={}));Object(u.b)("AlternateAuthSupportApp",xa);class ua{constructor(){this.Token=null;this.ExpirationTime=0}}Object(u.a)(ua,"WacAlternateAuthToken",null,[]);class sa{constructor(b,h){this.hlp=3E5;this.h9n=n=>{let B=null;({Zu:B}=D.d(n));return B};if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Ga=b;this.Twd=new Fa.a(Qa.a.th());this.LIc=new Ca(b,h);void 0!==Q.a.j7f&&null!==Q.a.j7f&&void 0!==Q.a.cje&&null!==Q.a.cje&&0<Q.a.cje&&(b=new ua,b.Token=Q.a.j7f,b.ExpirationTime=Q.a.cje,this.Twd.Z("loki",b))}yhm(){let b=null;this.Twd.mb(xa[0])&&(b=this.Twd.J(xa[0]));return void 0===b||null===b||this.Lge(b)?this.D6l():Promise.resolve(b.Token)}Lge(b){return b.ExpirationTime-Date.now()<this.hlp}D6l(){const b=new Fa.a(Qa.a.th());b.Z("X-AlternateAuthApp",xa[0]);return this.LIc.xMb(this.YVa("/afhs/AlternateAuthHelperHandler.ashx"),
this.h9n,2,b).then(h=>{x.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",xa[0]);this.Twd.Z(xa[0],h);return h.Token},h=>{h=Object(ya.a)(Aa,h);x.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",h.message,h.httpStatusCode);return null})}YVa(b){const h=this.Ga.$("SuiteOriginForAFHSIsEnabled")?this.Ga.kb("SuiteOrigin"):this.Ga.kb("WebServiceBase");return String.format("{0}{1}?{2}",
h,b,A.AFrameworkApplication.jm)}}Object(u.a)(sa,"AlternateAuthHelper",null,[737]);var Ea=d(652);class Ja{constructor(b,h,n){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=n}}Object(u.a)(Ja,"FeatureStateChangeArgs",null,[]);var nb=d(156),ub=d(205),Yb=d(90),yb=d(123),Za;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(Za||(Za={}));Object(u.b)("FeatureState",Za);var Ya=d(21),Pa=d(12),rb=d(105);class tb{constructor(b,h,n=null,
B=null,L=null){this.Fpb=this.gqa=this.kCh=this.xjb=this.BNd=null;this.m9n=ba=>{(ba=D.b(ba))?(x.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),x.ULS.sendTraceTag(50938594,3004,50,"{0}",ba)):x.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return ba.Features};this.ZUm=()=>{x.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");
this.Fpb.then(ba=>{this.gAj(ba)}).catch(()=>{this.gAj({})})};this.ngo=ba=>{try{ba&&"Date"in ba&&(this.gqa=new Date(ba.Date),x.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.gqa.toString()))}catch(la){x.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",la)}};this.LIc=new Ca(b,h);this.Ga=b;this.FDk=b.ic("LicensingMaxRetryAttempts",0);this.eFd=b.$("IsO365ConsumerHost");this.eYe=b.$("IsO365CommercialHost");
this.zXe=b.$("PremiumUpsellIsEnabled");this.f8b=!1;this.E_e=0;this.Nbh=n;this.lKh=B;this.ga=L;this.wjb=b.$("LicensingIsEnabled");this.gGb=b.$("OcpsIsEnabled")&&this.eYe;this.Dcf=b.$("ShowPrivacyDialog")&&!!B;this.V7b=b.$("IsAnonymousUser");this.L2d=new Promise(ba=>{ba(!1)});this.aAb=new Promise(ba=>{ba(!0)});this.Epb=new Fa.a(Qa.a.th());this.QPd=!0;this.nth=this.bym();this.wab()&&!this.V7b?(void 0!==A.AFrameworkApplication.ua&&null!==A.AFrameworkApplication.ua&&(this.BNd=A.AFrameworkApplication.ua.hs,
void 0!==this.BNd&&null!==this.BNd&&(this.xjb=this.BNd.vYa("WebServiceCall","ApplicationFeatureHelperService"))),this.Fpb=this.GKg()):this.Fpb=new Promise(ba=>{ba({})});this.Fpb.catch(ba=>{ba=Object(ya.a)(Aa,ba);x.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",ba?ba.httpStatusCode.toString():"Unknown")});this.QPd&&this.isFeatureEnabled("FreemiumUpsell",!0).then(ba=>{this.f8b=ba;return null})}bym(){const b=this.Ga.jy("AllLicensedFeatures")?this.Ga.iD("AllLicensedFeatures"):
[],h=new Ea.a;for(let n=0;n<b.length;n++)h.add(b[n]);return h}wab(){return this.eYe||this.eFd}GKg(b=0,h=!1){x.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const n=nb.a.KG();n&&(n.set("retryAttempt",b.toString()),n.set("forceRefresh",h.toString()),n.set("isO365ConsumerHost",this.eFd.toString()),n.set("isO365CommercialHost",this.eYe.toString()),n.set("isFreemiumUpsellSettingEnabled",this.zXe.toString()));oa.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",n);oa.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",n);void 0!==this.xjb&&null!==this.xjb&&this.xjb.start();let B=null;h&&(B=new Fa.a(Qa.a.th()),B.Z("x-LicensingForceRefresh","true"));this.kCh=new Date;return(this.wjb?this.LIc.xMb(this.YVa("/afhs/ApplicationFeatureHelperHandler.ashx"),this.m9n,0,B,this.ngo,["Date"]):Promise.resolve({})).then(L=>{const ba=Object.assign(new rb.a,{durationMs:this.gYj()});ba.extendedProperties=n;ba.extendedProperties&&
L&&(ba.extendedProperties.set("featureCount",Yb.a.count(L).toString()),ba.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in L).toString()),ba.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in L).toString()),"FreemiumUpsell"in L&&ba.extendedProperties.set("isFreemiumUpsellEnabled",L.FreemiumUpsell.toString()),this.gqa&&ba.extendedProperties.set("fromCache",(this.gqa<this.kCh).toString()));oa.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",
ba);return L},L=>{const ba=Object.assign(new rb.a,{durationMs:this.gYj()}),la=Object(ya.a)(Aa,L);if(!la)return x.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),oa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ba),new Promise((La,fb)=>{fb(L)});ba.extendedProperties=n;ba.extendedProperties&&ba.extendedProperties.set("status",la.httpStatusCode.toString());
oa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ba);return 408===la.httpStatusCode&&++b<=this.FDk?this.GKg(b):new Promise((La,fb)=>{fb(la)})})}YVa(b){var h=this.Ga.$("SuiteOriginForAFHSIsEnabled")?this.Ga.kb("SuiteOrigin"):this.Ga.kb("WebServiceBase");h=String.format("{0}{1}",h,b);this.Ga.jy("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ga.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=tb.X7d(this.Ga))&&0<b.length&&(this.QPd&&(b+="ucbf"),h=new ub.QueryStringBuilder(h),
h.ze("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.gGb&&!this.Dcf&&!this.wjb)return this.aAb;x.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",b);if("ConnectedServices"===b){var n=this.gGb?this.Nbh.AL("ControllerConnectedServicesEnabled"):this.aAb;const ba=this.Dcf?this.lKh.getSettings().then(la=>2!==la.nL,()=>h):this.aAb;return n.then(la=>la?ba:this.L2d)}if("FreemiumUpsell"===b&&(!this.zXe||!this.eFd||
this.V7b))return this.L2d;n=null;n=this.gGb?this.Nbh.isFeatureEnabled(b):this.aAb;let B=null;B=this.wjb?this.Gin(b,h):this.aAb;let L=null;L=this.Dcf?this.lKh.isFeatureEnabled(b):this.aAb;return n.then(ba=>ba?L.then(la=>la?B:this.L2d):this.L2d).then(ba=>{this.G$i(b,ba,!0);return ba},()=>{this.G$i(b,h,!1);return h})}G$i(b,h,n){x.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,n)}getFeatureTier(b,h){if(!this.wjb)return new Promise(n=>{n(2)});x.ULS.sendTraceTag(42804871,
3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.Fpb.then(n=>this.Z9d(b,n,h),()=>h)}isFreemiumUpsellEnabled(){if(this.zXe&&this.eFd&&!this.V7b){if(this.f8b&&2!==this.E_e||!this.f8b&&1!==this.E_e)x.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.f8b.toString()),this.E_e=this.f8b?2:1;return this.f8b}return!1}launchUpsellExperience(b,h=null){x.ULS.sendTraceTag(594564814,3004,
50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var n=nb.a.KG();n&&(n.set("experienceId",b),h&&n.set("campaignId",h));oa.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",n);(n=Ya.a.instance.Oa("Common.IInProductMessagingUIManager"))?n.p6i(b,this.ZUm,h):(x.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),oa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",
!1,!0,null),this.ga.Pb(Pa.a.S4d,2,{["experience"]:b}))}hva(b,h){if(!this.wjb)return null;if(!b||!h)return x.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const n=yb.a.create().toString();this.Epb.mb(b)||this.Epb.Z(b,new Fa.a(Qa.a.th()));this.Epb.J(b).add(n,h);x.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",n,b));return n}rZb(b,
h){this.wjb&&(b&&this.Epb.mb(b)?h&&yb.a.isValid(h)?this.Epb.J(b).mb(h)?(x.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",h,b)),this.Epb.J(b).remove(h)):x.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):x.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
h,b)):x.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",b)))}Z9d(b,h,n){return this.QPd?b in h?h[b].LicenseTier:n:b in h?this.Y9n(h[b],n):n}Y9n(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}gAj(b){x.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.GKg(0,!0);
h.then(n=>{this.Fpb=h;Yb.a.count(n)>Yb.a.count(b)?oa.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):oa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(const B of this.Epb.keys)if(B in n){const L=this.Z9d(B,n,0);B in b?this.Z9d(B,b,0)!==L&&this.Ncg(B,!0,L):this.Ncg(B,!0,L)}else B in b&&this.Ncg(B,!1,this.Z9d(B,b,0))}).catch(n=>{oa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);x.ULS.sendTraceTag(594051086,
3004,10,JSON.stringify(n))})}Ncg(b,h,n){x.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,h,n);h=new Ja(b,h,n);n=this.Epb.J(b);for(const B of n)try{B.value(h)}catch(L){x.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",b,B.key,L.message))}}Fin(b,h){if(this.wjb){const n=
this.nth.contains(b);let B=!0,L="",ba=!1;return this.Fpb.then(la=>{b in la?(la=la[b],L=Za[la.FeatureState],B=1!==la.FeatureState):B=!n;this.W$i(b,n,L,ba,h,B);return B},()=>{ba=!0;n&&(B=h);this.W$i(b,n,L,ba,h,B);return B})}return this.aAb}W$i(b,h,n,B,L,ba){x.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,B,n,L,ba)}Gin(b,h){if(this.QPd)return this.Fin(b,h);if(this.wjb){if(this.nth.contains(b))return this.Fpb.then(n=>
b in n,()=>h);x.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.aAb}gYj(){if(void 0!==this.xjb&&null!==this.xjb){const b=this.xjb.Fi;this.xjb.stop();return b}return null}static X7d(b){try{if(X.a.QBe){const h=b.kb("UserDataSignature").split(".");if(1<h.length){const n=window.self.atob(h[1]),B=JSON.parse(n).LocalStorageKey;if(void 0!==B&&null!==B&&0<B.length)return B}}}catch(h){x.ULS.sendTraceTag(578863816,
3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(u.a)(tb,"ApplicationFeatureHelper",null,[738]);var ob=d(77);class Oa{constructor(b,h){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(u.a)(Oa,"CloudPolicySettingsCacheData",null,[]);var Xa=d(1425),ab=d(639),cb=d(310);class ib{static BVj(){return A.AFrameworkApplication.K.$("SideCarIsEnabled")?ib.wwe&&
ib.k9c?new Promise(b=>{b(!0)}):new Promise((b,h)=>{ib.wwe=cb.a.create(A.AFrameworkApplication.K.kb("SideCarUrl"));ab.a.D_(ib.wwe);ib.wwe.w2((n,B)=>{(ib.k9c=B.succeeded)?b(B.succeeded):h(B.succeeded)})}):new Promise(b=>{b(!1)})}}ib.k9c=!1;ib.wwe=null;Object(u.a)(ib,"SideCarLoader",null,[]);class Ub{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(u.a)(Ub,"CloudPolicySettingsData",null,[]);class lb{constructor(b,h){this.ZMe=0;this.yWd=null;this.q9n=n=>{let B=
null;({Zu:B}=D.d(n));n=!!B;x.ULS.sendTraceTag(50622687,3004,n?50:10,"ParseCloudPolicySettingsResponse: Success={0}",n);return B};this.Ago=n=>{try{if(void 0!==n&&null!==n&&"CheckIn-Interval"in n){const B=parseInt(n["CheckIn-Interval"]);void 0!==B&&null!==B&&0<B&&(this.ZMe=B)}}catch(B){x.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",B)}};this.LIc=new Ca(b,h);this.Ga=b;h=b.kb("HostAuthType");this.gGb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===
h||null===h)&&"aad"===h.toLowerCase();this.Iwh=D.b(b.kb("OcpsDefaultSettings")||"{}");this.ZKc=this.X7d();h=this.Ga.jy("ServicesControlsMicrosoftControllerServicesList")?this.Ga.iD("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.bzd=new Ea.a;for(let n=0;n<h.length;n++)this.bzd.add(h[n]);this.gGb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.yWd=this.qpp():this.yWd=this.FKg(this.gGb,this.YVa("/afhs/CloudPolicySettings.ashx"),this.q9n);this.yWd.then(()=>null).catch(n=>{n=Object(ya.a)(Aa,
n);x.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",n?n.httpStatusCode.toString():"Unknown")})}AL(b,h=!0,n=!0){if(!this.gGb){const la=this;return new Promise(La=>{La(la.b4c(b))})}const B=this,L=this,ba=this.yWd.then(la=>{try{let La=null;la.PolicySettings&&"unknown"in la.PolicySettings&&(La=la.PolicySettings.unknown);if(La){if(b in La&&void 0!==La[b]&&null!==La[b])return new Promise(Cb=>{Cb("0"!==La[b])});const fb=b.toLowerCase();if(fb in La&&void 0!==
La[fb]&&null!==La[fb])return new Promise(Cb=>{Cb("0"!==La[fb])});if(n)return x.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default"),new Promise(Cb=>{Cb(B.b4c(b))});x.ULS.sendTraceTag(508395746,3004,50,"Policy"+b+" not found, returning PolicyNotConfigured error");return new Promise((Cb,Lb)=>{Lb("PolicyNotConfigured")})}return new Promise(fb=>{fb(B.b4c(b))})}catch(La){return x.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",La.message),B.handleError(La.toString(),
h,B.b4c(b))}},la=>L.handleError(la,h,L.b4c(b)));ba.then(la=>{x.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,la);return null});return ba}isFeatureEnabled(b,h=!0){if(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.Iin(b,h);let n=new Promise(L=>{L(!0)}),B="";this.bzd.contains(b)&&(B="ControllerConnectedServicesEnabled",n=this.AL(B,h));n.then(L=>{x.ULS.sendTraceTag(50651668,
3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,L,B);return null});return n}Iin(b,h=!0){let n=new Promise(L=>{L(!0)}),B="";"mso_sendASmile"===b?B="Enabled":"Survey"===b||"FloodgateSurvey"===b?B="SurveyEnabled":this.bzd.contains(b)&&(B="ControllerConnectedServicesEnabled");""!==B&&(n=this.AL(B,h));n.then(L=>{x.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",
b,L,B);return null});return n}handleError(b,h,n){return h?new Promise(B=>{B(n)}):new Promise((B,L)=>{L(b)})}FKg(b,h,n){if(!b)return Promise.resolve(new Ub);let B=!1,L=null;oa.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let ba=this.atf("GetCloudPolicySettings");return(new Promise((la,La)=>{if(void 0!==this.ZKc&&null!==this.ZKc&&0<this.ZKc.length){const fb=this.Rop();if(void 0!==fb&&null!==fb){B=!0;la(fb);return}}this.LIc.xMb(h,n,1,null,this.Ago,["CheckIn-Interval"],
this.Ga.ic("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ga.ic("CloudPolicySettingsRequestSentTimeout",3E4)).then(fb=>{x.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.hqp(fb);la(fb);return fb},fb=>{La(fb);return null})})).then(la=>{({vz:ba,returnValue:L}=this.lBe(ba));var La=nb.a.KG();La&&La.set("FromCache",B.toString());La=Object.assign(new rb.a,{durationMs:L,extendedProperties:La});oa.Health.instance.recordKpiSuccess("GetCloudPolicySettings",La);return la})}qpp(){return ib.BVj().then(()=>
{x.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}YVa(b){const h=this.Ga.$("SuiteOriginForAFHSIsEnabled")?this.Ga.kb("SuiteOrigin"):this.Ga.kb("WebServiceBase");return String.format("{0}{1}",h,b)}b4c(b){return b in this.Iwh?"0"!==this.Iwh[b]:!0}Rop(){try{const b=Xa.a.instance.getItem(this.ZKc);if(void 0===b||null===b)return x.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),
null;x.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return x.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return x.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;
if((new Date(h.ExpirationTime)).getTime()<Date.now())return x.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const n=new Ub;n.PolicySettings=h.PolicySettings;n.ControllerConnectedServicesFeatureNames=new ob.a;this.Ga.jy("ServicesControlsMicrosoftControllerServicesList")&&this.Ga.iD("ServicesControlsMicrosoftControllerServicesList");for(const B of this.bzd)n.ControllerConnectedServicesFeatureNames.add(B);x.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");
return n}catch(b){return x.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}hqp(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)x.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.ZMe)x.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const h=new Oa(b,this.ZMe),n=JSON.stringify(h);
x.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",n);Xa.a.instance.setItem(this.ZKc,n);x.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){x.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}X7d(){const b=tb.X7d(this.Ga);return b&&0<b.length?"OCPS"+b:null}atf(b){const h=Ya.a.instance.Oa("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==
h&&null!==h?h.Vf("WebServiceCall",b):null}lBe(b){if(void 0!==b&&null!==b){const h=b.Fi;b.stop();return{returnValue:h,vz:null}}return{returnValue:null,vz:b}}}Object(u.a)(lb,"CloudPolicySettingsHelper",null,[735]);class Qb{constructor(){this.Aii=this.B$j=this.nL=0;this.Bii=this.C$j=this.iMb="";this.S9e=this.S0a=2}clone(){const b=new Qb;b.nL=this.nL;b.B$j=this.B$j;b.Aii=this.Aii;b.iMb=this.iMb;b.C$j=this.C$j;b.Bii=this.Bii;b.S0a=this.S0a;b.S9e=this.src;return b}get src(){return this.S9e}serialize(b=
null){const h={};if(!b||b.contains(Qb.fWb))h[Qb.fWb]=this.nL;if(!b||b.contains(Qb.Med))h[Qb.Med]=this.iMb;if(!b||b.contains(Qb.Ned))h[Qb.Ned]=this.S0a;return JSON.stringify(h)}static create(b,h=null){const n=new Qb;n.S9e=b;void 0!==h&&null!==h&&(Qb.fWb in h&&(n.nL=h[Qb.fWb]),Qb.Med in h&&(n.iMb=h[Qb.Med]),Qb.Ned in h&&(n.S0a=h[Qb.Ned]));return n}static deserialize(b,h){try{const n=JSON.parse(b);if(void 0!==n&&null!==n)return Qb.create(h,n);x.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",
b);throw Error.argument("settingsData");}catch(n){throw x.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",n.toString()),n;}}}Qb.fWb="CCS";Qb.Med="CCSTime";Qb.Ned="OfficePrivacyRoamedNoticeShown";Object(u.a)(Qb,"UserPrivacySettings",null,[]);var fc=d(149);class Fc{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ga=b;this.Af=h;this.M8e=this.Me=null}YVa(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",
this.Ga.appSettings.RoamingServiceHandlerWebServiceBase||"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");h.append(A.AFrameworkApplication.jm);return h.toString()}executeRequest(b,h,n,B=null){return this.Af.XJb(b,h,B,null,n,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,n)=>{try{if(void 0===this.Me||null===this.Me||void 0===b||null===b)x.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),n("Can't determine setting changes to save");
else{var B=this.Me.nL!==b.nL;if(2===this.Me.src&&B)this.ZKo(b),h(!0);else{var L=this.UPo(b);if(void 0===L||null===L||!L.length)x.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),n("No changes to save");else if(1===this.Me.src)h(this.v4j(L));else if(0===this.Me.src){x.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",L);const ba=this.executeRequest(this.YVa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
L);ba.continueWith(()=>{if(ba.qp||ba.ij)x.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),h(!1);else{var la=ba.result;void 0!==la.args&&null!==la.args&&void 0!==la.args.data&&null!==la.args.data&&la.args.data.He===ja.a.zz?(x.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(x.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(ba){x.ULS.sendTraceTag(50860930,
3004,10,"SaveUserPrivacySettings: Exception = {0}",ba.toString()),h(!1)}})}UPo(b){if(void 0===this.Me||null===this.Me||void 0===b||null===b)throw Error.invalidOperation("User Privacy settings have not been initialized");const h=new ob.a;0===b.src?(this.Me.nL!==b.nL&&(h.add(Qb.fWb),h.add(Qb.Med)),this.Me.S0a!==b.S0a&&h.add(Qb.Ned)):1===b.src&&this.Me.nL!==b.nL&&h.add(Qb.fWb);return h.count?b.serialize(h):(x.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.M8e){const b=this;this.M8e=new Promise(h=>{try{b.Me?h(b.Me.clone()):b.jpp().then(n=>{b.Me=n;h(b.Me.clone());return null},()=>{b.hpp().then(n=>{b.Me=n;h(b.Me.clone());return null},()=>{b.ipp().then(n=>{b.Me=n;h(b.Me.clone());return null},()=>{x.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Me=new Qb;h(b.Me.clone());return null});return null});return null})}catch(n){x.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
n.toString()),b.Me=new Qb,h(b.Me.clone())}})}return this.M8e}jpp(){return new Promise((b,h)=>{try{const B=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ga.$("PrivacyDialogShouldCheckRoaming")||B){var n=this.executeRequest(this.YVa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");n.continueWith(()=>{try{if(n.qp||n.ij)x.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const L=n.result;if(L&&L.args&&L.args.data)if(L.args.data.He!==
ja.a.zz)x.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",L.args.data.He);else{if(L.args.data.De){b(Fc.parse(L.args.data.De,0));x.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",L.args.data.De);return}x.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else x.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");
h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(L){x.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",L.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else x.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(B){x.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",
B.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}hpp(){return new Promise((b,h)=>{try{const n=fc.a.get("WacUPToggleState");let B=null;void 0!==n&&null!==n&&0<n.length&&(B=decodeURIComponent(n));if(void 0!==B&&null!==B&&0<B.length){const L=Fc.parse(B,1);x.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",L.toString());b(L)}else{const L=Qb.create(1),ba=new ob.a;ba.add(Qb.fWb);const la=L.serialize(ba);this.v4j(la)?
(x.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",la),b(L)):(x.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",la),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(n){x.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",n.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}ipp(){return new Promise(b=>
{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");const n=Qb.create(2);h?(n.nL=2,A.AFrameworkApplication.xgi(),x.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",n.toString())):(n.nL=1,x.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",n.toString()));b(n)}catch(n){x.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",n.toString()),
h=Qb.create(2),h.nL=1,b(h)}})}ZKo(b){x.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===b.nL?A.AFrameworkApplication.xgi():A.AFrameworkApplication.E_l();x.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}v4j(b){try{x.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Ga.kb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");
x.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return fc.a.KQj("WacUPToggleState",b,fc.a.xMa,h)}catch(h){return x.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const n=this.Ga.jy("ServicesControlsMicrosoftControllerServicesList")?this.Ga.iD("ServicesControlsMicrosoftControllerServicesList"):[],B=new Ea.a;for(let L=0;L<n.length;L++)B.add(n[L]);return B.contains(b)?
2!==h.nL:!0},()=>{x.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);return!0})}static parse(b,h){try{return x.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",b,h),Qb.deserialize(b,h)}catch(n){throw x.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",n.toString()),n;}}}Object(u.a)(Fc,"UserPrivacySettingsHelper",null,[736]);class nc{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}wc(b){this.W=
b;this.W.register(735,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ha().Rd(()=>new lb(A.AFrameworkApplication.K,A.AFrameworkApplication.Be));this.W.register(736,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ha().Rd(()=>new Fc(A.AFrameworkApplication.K,A.AFrameworkApplication.Be));this.W.register(737,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ha().Rd(()=>new sa(A.AFrameworkApplication.K,A.AFrameworkApplication.Be));this.W.register(738,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ha().Rd(()=>
new tb(A.AFrameworkApplication.K,A.AFrameworkApplication.Be,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),A.AFrameworkApplication.va))}init(){A.AFrameworkApplication.K.Rn(()=>{const b=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");A.AFrameworkApplication.K.$("LicensingIsEnabled")&&(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{x.ULS.sendTraceTag(42513092,
3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",h,A.AFrameworkApplication.K.kb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{x.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,A.AFrameworkApplication.K.kb("IsAnonymousUser"));return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");
this.iip()})}dispose(){}iip(){try{A.AFrameworkApplication.K.$("SideCarIsEnabled")&&ib.BVj().then(b=>{x.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){M.a.instance.Jc(new nc)}}Object(u.a)(nc,"ApplicationFeatureHelperPackage",null,[0,1]);var zb=d(183);class Vb{b8d(b,h){let n;const B=[];for(;n=h.exec(b);){const L=n.index;B.push(new zb.a(L,L+n[0].length))}return B}isEndPuncSpecialCase(b){const h=this.b8d(b,
Vb.O$o);for(const n of h)if(n.end===b.length)return!0;return!1}d0c(b){for(const h of Vb.k4l){const n=this.b8d(b,h);if(0<n.length&&!n[0].Fc)return n[0].end-1}return 0}findBeginBoundary(b,h,n){var B=b.substring(n,h);b=this.b8d(B,Vb.qki);for(h=b.length-1;0<=h;h--){const L=B.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(L))return B=B.substring(b[h].Fc,B.length),n+b[h].end+this.d0c(B)}return n}findEndBoundary(b,h,n){var B=b.substring(h,n);b=this.b8d(B,Vb.qki);for(n=0;n<b.length;n++){const L=B.substring(0,
b[n].end);if(!this.isEndPuncSpecialCase(L))return B=B.substring(b[n].Fc,B.length),h+b[n].end+this.d0c(B)}return-1}}Vb.wCf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";Vb.xCf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";
Vb.yCf="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";Vb.k4l=[new RegExp(Vb.wCf,"ig"),new RegExp(Vb.xCf,"ig"),new RegExp(Vb.yCf,"ig")];Vb.KEg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Vb.NEg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";Vb.MEg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
Vb.LEg=Vb.NEg+"|"+Vb.MEg;Vb.OEg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Vb.PEg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";Vb.QEg="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
Vb.REg="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";Vb.Dyg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
Vb.LEg+"|"+Vb.OEg+"|"+Vb.PEg+")";Vb.Cyg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
Vb.QEg+")";Vb.ncg=Vb.KEg+"|"+Vb.REg;Vb.JEg=Vb.ncg+"|"+Vb.Dyg+"|"+Vb.Cyg;Vb.qki=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");Vb.O$o=new RegExp(Vb.JEg,"g");Object(u.a)(Vb,"ProofingSentenceSeparatorScriptSharp",null,[722]);class rc{Ivd(b,h){const n=[];let B;for(;null!=(B=h.exec(b));){const L=B.index;n.push({Fc:L,end:L+B[0].length})}return n}isEndPuncSpecialCase(b){return this.Ivd(b,rc.qjk).some(h=>
h.end==b.length)}d0c(b){for(const h of rc.Ofk){const n=this.Ivd(b,h);if(0<n.length&&0==n[0].Fc)return n[0].end-1}return 0}findBeginBoundary(b,h,n){var B=b.substring(n,h);b=this.Ivd(B,rc.NQg);for(h=b.length-1;0<=h;h--){const L=B.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(L))return B=B.substring(b[h].Fc,B.length),n+b[h].end+this.d0c(B)}return n}findEndBoundary(b,h,n){var B=b.substring(h,n);b=this.Ivd(B,rc.NQg);for(n=0;n<b.length;n++){const L=B.substring(0,b[n].end);if(!this.isEndPuncSpecialCase(L))return B=
B.substring(b[n].Fc,B.length),h+b[n].end+this.d0c(B)}return-1}}rc.sek="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";rc.ljk="[\u2639\u263a\u263b]";rc.QRg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";rc.vfk="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
rc.hik="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";rc.XRg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
rc.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
rc.PRg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";rc.chk="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";rc.bhk="[\uff21-\uff3a\uff41-\uff5a]";rc.$gk="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
rc.Zgk="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";rc.ahk="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";rc.RHe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";rc.MQg="[\u3002\uff61]";rc.dwd="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";rc.Vfk="[\u00bb\u2019\u201d\u203a\"']";rc.pIe=rc.sek+"|"+rc.ljk;rc.dhk="[\u2028\u2029\n\r]";rc.Ygk="("+rc.dwd+"|"+rc.QRg+"|"+rc.XRg+"|"+rc.PRg+
")";rc.Xgk="("+rc.dwd+"|"+rc.QRg+"|"+rc.XRg+"|"+rc.Symbol+"|"+rc.PRg+"|"+rc.vfk+"|"+rc.hik+")";rc.wCf="("+rc.RHe+"("+rc.pIe+"|"+rc.Vfk+"|"+rc.dwd+")*"+rc.dhk+")";rc.xCf="("+rc.RHe+"("+rc.pIe+")*("+rc.dwd+")+)";rc.yCf="("+rc.MQg+"("+rc.pIe+")*)";rc.Ofk=[new RegExp(rc.wCf,"ig"),new RegExp(rc.xCf,"ig"),new RegExp(rc.yCf,"ig")];rc.KEg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";rc.NEg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
rc.MEg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";rc.LEg=rc.NEg+"|"+rc.MEg;rc.OEg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";rc.PEg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
rc.QEg="(("+rc.chk+"|"+rc.$gk+"|"+rc.ahk+")[.])+|(("+rc.Zgk+")[.\ufe52\uff0e])+";rc.REg="("+rc.bhk+")[.\ufe52\uff0e]";rc.Dyg=rc.Ygk+"("+rc.LEg+"|"+rc.OEg+"|"+rc.PEg+")";rc.Cyg=rc.Xgk+"("+rc.QEg+")";rc.ncg=rc.KEg+"|"+rc.REg;rc.JEg=rc.ncg+"|"+rc.Dyg+"|"+rc.Cyg;rc.NQg=new RegExp(rc.RHe+"|"+rc.MQg,"ig");rc.qjk=new RegExp(rc.JEg,"g");Object(u.a)(rc,"ProofingSentenceSeparator",null,[722]);class pb{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}wc(b){this.W=b;A.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ia("Box4.Proofing.IProofingSentenceSeparator",()=>new rc).ha():b.ia("Box4.Proofing.IProofingSentenceSeparator",()=>new Vb).ha()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){M.a.instance.Jc(new pb)}}Object(u.a)(pb,"Box4GrammarCheckPackage",null,[0,1]);var bb=d(112),Pb=d(66),mb=d(1940),Ua=d(23);class vb{constructor(){this.W=null}get name(){return"Box4.AtMentions"}wc(b){this.W=b;this.W.ia("Box4.AtMentions.IAtMentionsListener",()=>new mb.a(this.W.resolve("Box4.IEditingDomManager"),
this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),Object(Pb.a)(),"@",["@","/"])).ha()}init(){A.AFrameworkApplication.K.Rn(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").Mdc(Ua.StaticActiveAppFrame.za().ib,bb.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){M.a.instance.Jc(new vb)}}Object(u.a)(vb,"Box4AtMentionsPackage",null,[0,1]);class Ia{get name(){return"Box4.Workers"}wc(){}init(){}dispose(){}static main(){M.a.instance.Jc(new Ia)}}
Object(u.a)(Ia,"Box4WorkersPackage",null,[0,1]);var Ma=d(322),qb=d(95);class Xb{constructor(){this.dQa=new qb.a}K8(b,h){this.dQa.Z(b,h)}VGf(b){({value:b}=this.dQa.Dc(b));return b}}Object(u.a)(Xb,"AggregationMethodsForActivityName",null,[]);var Cc=d(271);class Ec{constructor(){this.gKd=new Ma.a;this.dQa=new Ma.a}K8(b,h,n){this.dQa.mb(b)&&this.dQa.J(b)||this.dQa.Z(b,new Xb);this.dQa.J(b).K8(h,n)}VGf(b,h){return this.dQa.mb(b)&&this.dQa.J(b)?this.dQa.J(b).VGf(h):null}s4c(b){this.gKd.mb(b)&&this.gKd.J(b)||
this.gKd.Z(b,new Cc.a);return this.gKd.J(b)}edi(b,h){this.s4c(b).add(h)}}Object(u.a)(Ec,"ActivityAggregationInfo",null,[799]);var Wb=d(122),Hb=d(1068),Sb=d(1092);class cc extends Hb.a{constructor(b,h){super(b);this.Zbf=(this.Emk=h)?h.Msm():Sb.a.DGf()}get hIa(){return this.Emk}get activityName(){return this.hIa.name}get startTime(){return this.hIa.startTime}get endTime(){return this.hIa.endTime}end(){}cancel(){}pFf(){}hwp(){this.gjc.Z("AM",this.hIa.mode.toString());this.gjc.Z("C",this.hIa.count.toString());
this.gjc.Z("DA",this.hIa.Nii.toFixed(2));this.gjc.Z("DV",this.hIa.JYl.toFixed(2))}kNf(b){return this.hIa.kNf(b)}TNf(){return this.hIa.TNf()}Kcc(){for(const b of this.hIa.iIa)b.Kcc()}}Object(u.a)(cc,"AggregatedActivity",Hb.a,[]);class Gc{constructor(b,h){this.zKe=0;this.AFa=b;this.v1a=h}W3k(b,h){this.zKe=h;for(h=0;h<b.count;h++){const n=b.J(h);this.X3k(n)}}X3k(b){const h=Object(ya.a)(cc,b);if(h)if(1===this.zKe)this.V3k(h);else if(2===this.zKe){this.Y3k(h);for(const n of this.v1a.s4c(this.AFa)){const B=
h.hIa.iIa.J(0);B.properties.mb(n)&&b.properties.Z(n,B.properties.J(n))}}}V3k(b){for(const h of this.v1a.s4c(this.AFa))this.GIj(b,h)}Y3k(b){for(const h of b.TNf())this.GIj(b,h)}GIj(b,h){const n=this.v1a.VGf(this.AFa,h);if(n){const B=b.kNf(h);b.properties.Z(h,n(B))}}}Object(u.a)(Gc,"PropertyAggregationHelper",null,[]);var Oc=d(1175);class Zc{constructor(b,h,n,B,L){this.m4b=b;this.v1a=h;this.och=L;this.hKe=B;this.aDk=n}get AMh(){return this.aDk.value}pWc(b){if(Object(Wb.a)(Oc.a,b))b.pWc();else if(Object(Wb.a)(cc,
b)&&this.hKe.K_h(b.activityName.toString())){b=Object(ya.a)(cc,b);b.hwp();b=b.pcj();var h=[];Array.add(h,b);b=D.c(h);x.ULS.sendTraceTag(6907266,213,50,b)}}rIa(b,h){const n=(new Date).getTime();var B=this.och.list.J(b);const L=({$3k:B}=this.Jgm(B)).returnValue;this.och.list.Z(b,new ob.a);h&&(B=this.DCl(B,n,this.m4b.GLi));0<B.count&&(new Gc(b,this.v1a)).W3k(B,L)}DCl(b,h,n){const B=new ob.a;for(let L=0;L<b.count;L++){const ba=b.J(L);ba.startTime>h-n?ba.Kcc():B.add(ba)}return B}Jgm(b){const h=this.AMh.U0j(b);
b=this.AMh.Ojp(b);const n=this.a4k(h,b);return{returnValue:n,$3k:1===n?h:b}}a4k(b,h){return b.count*this.m4b.Lej<h.count?1:2}get enabled(){return this.m4b.enabled}Kcc(){}}Object(u.a)(Zc,"ActivityAggregationManager",null,[800]);class kb{constructor(b){this.enabled=!1;this.gdj=500;this.rej=2;this.Lej=5;this.GLi=3E4;this.l0c(b.appSettings)}l0c(b){this.enabled=Boolean.parse(b[kb.KAf]||"false");this.gdj=parseInt(b[kb.TJn]||"500");this.rej=parseInt(b[kb.CMn]||"2");this.Lej=parseInt(b[kb.bNn]||"5");this.GLi=
parseInt(b[kb.SSm]||"30000")}}kb.KAf="ActivityAggregationEnabled";kb.TJn="ActivityAggregationMaxInterval";kb.CMn="ActivityAggregationMinChain";kb.bNn="ActivityAggregationModeFactor";kb.SSm="ActivityAggregationGraceWindow";Object(u.a)(kb,"ActivityAggregationParams",null,[]);class wd{constructor(b,h){this.v1a=b;this.D8g=h}U0j(b,h=1){if(!b||!b.count)return b;const n=new ob.a;var B=null;for(let L=0;L<b.count;L++){const ba=b.J(L);if(!ba)continue;const la=ba.activityName;B?B.nun(ba)?B.add(ba):(B=B.process(),
n.addRange(B),B=this.D8g(la,h),B.add(ba)):(B=this.D8g(la,h),B.add(ba))}B&&(b=B.process(),n.addRange(b));return n}Ojp(b){if(!b||!b.count)return b;const h={};var n=null;for(let L=0;L<b.count;L++){const ba=b.J(L);if(ba){if(!n){n=new ob.a;var B=this.v1a.s4c(ba.activityName);for(const la of B)n.add(la)}B=this.eHm(ba,n);null!==B&&(B in h&&h[B]||(h[B]=new ob.a),h[B].add(ba))}}b=new ob.a;for(const L of Yb.a.FR(h))n=this.U0j(h[L],2),b.addRange(n);return b}eHm(b,h){let n="";for(const B of h)n+=B,n=b.properties.mb(B)&&
void 0!==b.properties.J(B)&&null!==b.properties.J(B)?n+b.properties.J(B):n+"null";return n}}Object(u.a)(wd,"ActivityAggregationSchemes",null,[796]);class qe{constructor(b,h,n,B,L){this.xt=this.ji=0;this.m4b=n;this.hDc=B;this.v1a=L;this.name=b;this.mx=h;this.iIa=new ob.a}get mode(){return this.mx}get count(){return this.iIa.count}get startTime(){return this.ji}get endTime(){return this.xt}get Nii(){if(!this.count)return 0;let b=0;for(const h of this.iIa)b+=h.endTime-h.startTime;return b/this.count}get JYl(){if(!this.count)return 0;
let b=0;const h=this.Nii;for(const n of this.iIa){const B=n.endTime-n.startTime;b+=(B-h)*(B-h)}return b/this.count}add(b){this.count?this.xt=b.endTime>this.endTime?b.endTime:this.endTime:(this.ji=b.startTime,this.xt=b.endTime);this.iIa.add(b)}nun(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.m4b.gdj}process(){if(this.count>=this.m4b.rej){const b=new ob.a,h=this.hDc(this);b.add(h);return b}return this.iIa}kNf(b){const h=new ob.a;for(const n of this.iIa)if(n.properties.mb(b)){const B=n.properties.J(b);
h.add(B)}else h.add(null);return h}TNf(){const b=this.v1a.s4c(this.name),h=new Cc.a;for(const n of this.lhm())b.contains(n)||h.add(n);return h}lhm(){const b=new Cc.a;if(!this.iIa)return b;for(const h of this.iIa)for(const n of h.properties.keys)b.add(n);return b}Msm(){return this.iIa.J(0).uniqueID}}Object(u.a)(qe,"ActivityCollection",null,[794]);class Qd{constructor(){this.bCb=new Ma.a}get list(){return this.bCb}add(b){const h=b.activityName;if(this.bCb.mb(h)&&this.bCb.J(h)){const n=this.bwm(this.bCb.J(h),
b);this.bCb.J(h).insert(n,b)}else this.bCb.Z(h,new ob.a),this.bCb.J(h).add(b)}bwm(b,h){for(let n=b.count-1;0<=n;n--)if(h.startTime>b.J(n).startTime)return n+1;return 0}}Object(u.a)(Qd,"CompletedActivitiesHelper",null,[757]);class me{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){A.AFrameworkApplication.aJ(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}wc(b){this.W=b;const h=B=>new cc(()=>b.Oa("Common.App.Activities.IActivityAggregationManager"),
B),n=(B,L)=>new qe(B,L,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),h,b.resolve("Common.IActivityAggregationInfo"));b.register(Zc,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ha().Rd(()=>new Zc(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.rf("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),
b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(kb,"Common.App.ActivityAggregator.ActivityAggregationParams").ha().Rd(()=>new kb(A.AFrameworkApplication.K));b.register(Ec,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ha().Rd(()=>new Ec);b.register(wd,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ha().Rd(()=>new wd(b.resolve("Common.IActivityAggregationInfo"),
n));b.register(Qd,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ha().Rd(()=>new Qd)}static main(){M.a.instance.Jc(new me)}}Object(u.a)(me,"ActivityAggregatorPackage",null,[0,1]);var Ne=d(575),Cd=d(10),Pf=d(1446);class cg{constructor(b){this.DAh=0;this.VMe=null;this.gvc=()=>{x.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(h=>{h.getChatsContainer(this.BVn)}).catch(h=>{x.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",
h)}),this.chat.getChatsCounter().then(h=>{h.onChatsCountChange(this.Lnl)}).catch(h=>{x.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",h)}),this.chat.getKeyboard().then(h=>{h.onKeyDown(this.EVn)}).catch(h=>{x.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",h)}))}catch(h){x.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",h)}};this.Lnl=h=>{x.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",h);if(!h)this.NBg.AVn();
else if(1===h&&!this.DAh){const n=document.getElementById(this.VMe?this.VMe:Pf.a.ALb);n?this.NBg.FVn(n,this.Lmp):x.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.DAh=h};this.BVn=h=>{this.VMe=h};this.EVn=h=>{h.ctrlKey&&"f6"===h.key.toLowerCase()&&this.Kmp(h.shiftKey)};this.Lmp=()=>{x.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(h=>{h.focusConversationInput()}).catch(h=>{x.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",
h)})}catch(h){x.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",h)}};this.iKk=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get NBg(){return this.iKk.value}Wb(){this.isInitialized?this.gvc():this.Quo(this.gvc)}Quo(b){Ne.a.instance.nb(Cd.a.wfp,window.self,()=>{b();return!0})}Kmp(b){x.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.NBg.CVn(b)}}Object(u.a)(cg,"ChatManager",null,[755]);var mg=d(89);class ci{constructor(){this.sa=new mg.a;
this.QQk=!1}L1k(b){this.sa.addHandler("OnTopRowControlsCreatedEvent",b)}u1k(b){this.sa.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get Clp(){return this.QQk}hyj(b){this.sa.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(u.a)(ci,"HeaderEventSource",null,[]);var Dd=d(184),Xc=d(361),Jd=d(91);class pf{constructor(b,h,n,B,L){this.gPd=null;this.DVn=()=>{this.gPd&&this.gPd()};this.Yb=b;this.aq=h;this.Wl=n;this.TQk=B;this.ga=L}JAj(b,h,n,B=null){const L=this.Yb.ge(h);L.parent=
n;L.iK=!0;B&&L.y6(B);this.Wl.jIa(h,b,!1);this.TQk.jIa(h,b,!1);h=new Xc.DOMFocusListing(()=>b);h.Gn(2);h.Gn(1);h.Gn(8);h.Gn(5);h.Gn(3);h.Gn(6);this.Yb.jra(()=>b,L,h).aS=!0;h=bb.KeyInputManager.lc(Jd.a.xz,0);n=bb.KeyInputManager.lc(Jd.a.xz,4);L.tt(h);L.tt(n)}onFlexPaneOpen(b){this.JAj(b,Pf.a.Crc,Pf.a.IWa);this.Yb.Bg(Pf.a.Crc);this.aq.Z$(Pf.a.Crc)}onFlexPaneClose(){this.aq.ny(Pf.a.Crc);this.Yb.Bg(Pf.a.IWa)}FVn(b,h){this.gPd||(this.gPd=h,this.JAj(b,Pf.a.ALb,Dd.AFrame.NO,this.DVn));this.Yb.Bg(Pf.a.ALb);
this.aq.Z$(Pf.a.ALb)}AVn(){this.aq.ny(Pf.a.ALb);this.Yb.G4d(Dd.AFrame.Ho)}CVn(b){this.ga.Ob(b?Pa.a.UCf:Pa.a.E2d,2)}}Object(u.a)(pf,"ReactSharedHeaderFocusManager",null,[749]);var Ce=d(127),pc=d(1136),$c=d(41),id=d(75);class de{constructor(b){this.wgj=(h,n,B,L,ba)=>{if(1===B)return 32;h=8;2===B&&(B=this.iIf(ba,"experience","gopremiumribbon"),ba=za.a.eba("2116536"),ba=za.a.Fp(ba,"ocid",pc.b(A.AFrameworkApplication.ua.Ib.Tk,A.AFrameworkApplication.ua.Ib.Dma,B)),$c.a.yn(ba,"_blank",void 0,"NavigateToUpsellPage"),
h=32,this.ga.Ob(Pa.a.sFj,2),x.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return h};this.launchUpsellExperience=(h,n,B,L,ba)=>{if(1===B)return 32;var la=8;2===B&&(x.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(la=Ya.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(h=this.iIf(ba,"experience","gopremium"),ba=this.iIf(ba,"dimeCampaignId",null),la.launchUpsellExperience(h,ba),la=32):(x.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),
la=this.wgj(h,n,B,L,ba)));return la};this.ga=b}Wb(){this.ga.ra(Pa.a.S4d,id.a.frame,this.wgj);this.ga.ra(Pa.a.Nri,id.a.frame,this.launchUpsellExperience);this.ga.ra(Pa.a.bEo,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.sFj,id.a.frame,Ce.ActionManager.Zf)}iIf(b,h,n){b&&b[h]&&(n=Object(ya.a)(String,b[h]));return n}}Object(u.a)(de,"UpsellActor",null,[748]);class Ae{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Ya.a.instance.resolve("Common.App.Header.IUpsellActor").Wb();Ya.a.instance.resolve("Common.App.Header.IChatManager").Wb()}dispose(){}wc(b){this.W=
b;this.W.register(ci,"Common.App.Header.HeaderEventSource").ha();this.W.register(de,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ha().Rd(()=>new de(A.AFrameworkApplication.va));this.W.register(pf,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ha().Rd(()=>new pf(A.AFrameworkApplication.ua.sq,A.AFrameworkApplication.ua.Iy,A.AFrameworkApplication.ua.i9,A.AFrameworkApplication.ua.PCe,A.AFrameworkApplication.va));this.W.register(cg,
"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ha().Rd(()=>new cg(this.W.rf("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){M.a.instance.Jc(new Ae)}}Object(u.a)(Ae,"CommonAppHeaderPackage",null,[0,1]);var gf=d(816);class uf{static Rti(b,h){switch(b){case 3:return uf.NRm(h);case 2:return uf.zDm(h);case 1:return uf.rrm(h)}return""}static NRm(b){switch(b){case 1:return A.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return A.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static zDm(b){switch(b){case 1:return A.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return A.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static rrm(b){switch(b){case 1:return A.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return A.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static YX(b,h,n){if(X.a.Di||X.a.vI)window.setTimeout(()=>{uf.Uzj(n,uf.n$d())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(uf.wSh(n),b,0,!1)}static Gsl(b,h,n,B){h&&B&&B();
uf.YX(b,h,n)}static n$d(){return X.a.Di?1:X.a.vI?2:X.a.Sab?3:X.a.$l?4:0}static uRm(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static vRm(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get g_f(){return"zh-CN"===window.navigator.language}static Uzj(b,h){1===h?(x.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=uf.Rti(b,h),8<X.a.l$a?$c.a.yn(b,void 0,void 0,"RedirectToAppStore"):$c.a.Wpb(b)):document.hidden||(uf.g_f?(b=A.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?(x.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),$c.a.Wpb(b)):x.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(x.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(uf.Rti(b,
h),null,null)))}static wSh(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get Bze(){return(X.a.Sab||X.a.$l)&&X.a.Vr}static get g4o(){return X.a.Di||X.a.vI}static kui(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static o_i(b){return(b=uf.Xwm(b))&&""!==b?Boolean.parse(b):!1}static hBg(b){uf.FUo(b)}static Xwm(b){try{return localStorage.getItem(b)}catch(h){return x.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static FUo(b){try{localStorage.setItem(b,"true")}catch(h){x.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}uf.x2h="ChromeExtensionBarDismiss";Object(u.a)(uf,"WildFireUtilities",null,[]);var Lf=d(381);class hg{constructor(){this.QKe=new Lf.a;this.OKe=new Lf.a;this.NKe=new Lf.a;this.ifl(this.QKe);this.hfl(this.OKe);this.gfl(this.NKe);this.xVe=new Lf.a;
this.wVe=new Lf.a;this.vVe=new Lf.a;this.Ihl(this.xVe);this.Hhl(this.wVe);this.Ghl(this.vVe);this.pNe=new Lf.a;this.tfl(this.pNe);this.SJb(this.pNe);this.SJb(this.NKe);this.SJb(this.OKe);this.SJb(this.QKe);this.SJb(this.wVe);this.SJb(this.xVe);this.SJb(this.vVe)}C9d(b,h){switch(b){case 1:return this.DSm(h);case 2:return this.Khm(h)}return uf.Bze?this.pNe:null}ifl(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}hfl(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}gfl(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}Ihl(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}tfl(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}Hhl(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}Ghl(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}SJb(b){b.add("Corporation","Microsoft Corporation")}DSm(b){switch(b){case 3:return this.xVe;case 2:return this.wVe;case 1:return this.vVe}return null}Khm(b){switch(b){case 3:return this.QKe;case 2:return this.OKe;case 1:return this.NKe}return null}static get instance(){hg._instance||
(hg._instance=new hg);return hg._instance}}hg._instance=null;Object(u.a)(hg,"WildFireStringFactory",null,[]);class Vf{constructor(b,h,n,B,L=null,ba=null){this.f3e=null;this._id=b;this.J4e=h;this.Axk=L;this.CJc=B;this.ePc=ba;this.Hgb=null;this.CRc=n;this.vQc=hg.instance.C9d(h,b)}VDl(){this.Hgb=new gf.a(this.title,this.message,null);this.Hgb.addButton(this.Yhl,Object(z.a)(this,this.hVn,"onButtonOneClick"),"");this.CRc&&this.Hgb.LOh(this.dil,Object(z.a)(this,this.mVn,"onButtonTwoClick"));this.Hgb.aka=
Object(z.a)(this,this.MUl,"dismissBar");this.Hgb.image=3;this.Hgb.id=16;this.Hgb.closeable=!0}get title(){return this.vQc.J("Headline")}get message(){return this.vQc.J("CallToAction")}get Yhl(){return this.CRc?this.vQc.J("InstallButton"):this.vQc.J("UseAppButton")}get dil(){return this.CRc?this.vQc.J("OpenAppButton"):""}hVn(){this.CRc?this.Nan():this.BBp()}mVn(){this.CRc&&this.S4n()}get IYh(){return this.Hgb}get Lua(){this.f3e||(this.f3e=this.Axk());return this.f3e}Nan(){x.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.CJc&&this.ePc&&this.ePc();uf.Uzj(this._id,this.J4e)}S4n(){this.Lua&&(x.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.CJc&&this.ePc&&this.ePc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(uf.wSh(this._id),this.Lua,0,!1))}BBp(){uf.Bze?this.Uhl():(x.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),uf.hBg("BizBarClicked"),1!==this.J4e&&2!==this.J4e||uf.Gsl(this.Lua,this.CJc,this._id,this.ePc))}Uhl(){this.CJc?
x.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):x.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");$c.a.Wpb(A.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}NUl(){this.CJc?x.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):x.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");uf.hBg(uf.x2h)}MUl(){uf.Bze?this.NUl():(uf.hBg(uf.kui(this._id)),x.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static Ruf(){const b=A.AFrameworkApplication.ua.Ib;
new Vf(b.Tk,uf.n$d(),8<X.a.l$a,1===b.Dma,()=>b.HW,b.Owg());x.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(u.a)(Vf,"WildFireBusinessBar",null,[]);class ic{get name(){return"Common.App.WildFire"}Fef(b){const h=A.AFrameworkApplication.ua.Ib;let n=!1;b&&(b.VDl(),b.IYh&&(n=h.cza(b.IYh,!0)));return n}aEl(){var b=A.AFrameworkApplication.ua.Ib;b=new Vf(b.Tk,uf.n$d(),!1,1===b.Dma);this.Fef(b)&&x.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}Ruf(b,h,n,B,L,ba){b=new Vf(b,
n,B,h,L,ba);this.Fef(b)&&x.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}nLl(){const b=A.AFrameworkApplication.ua.Ib;var h=A.AFrameworkApplication.K;const n=b.Tk,B=1===b.Dma;if(h.$(uf.uRm(n))){var L=uf.n$d(),ba=8<X.a.l$a;if(2!==n||2!==L||!B){h=h.$(uf.vRm(n));var la=b.Owg(),La=()=>b.HW;h&&!uf.o_i(uf.kui(n))&&this.Ruf(n,B,L,ba,La,la)}}}init(){var b=A.AFrameworkApplication.K;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;uf.Bze&&b&&!uf.o_i(uf.x2h)?this.aEl():
(document.body&&uf.g4o&&this.nLl(),A.AFrameworkApplication.va.ra(Pa.a.C3f,id.a.frame,Object(z.a)(this,this.C3f,"launchWildFireBusinessBar")))}C3f(b,h,n,B,L){if(1===n)return 32;if(!L)return 8;this.Ruf(L.app,L.mode,L.platform,L.useTwoButton,null,null);return 32}dispose(){}wc(){}static main(){M.a.instance.Jc(new ic)}}Object(u.a)(ic,"PackageManager",null,[0,1]);class yc{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(u.a)(yc,"BrowserInfo",null,[]);class bd{constructor(){this.Version=
this.Name=null}}Object(u.a)(bd,"PluginInfo",null,[]);class sd{static Z7(){if(A.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var b=sd.iem();try{const h=JSON.stringify(b);x.ULS.sendTraceTag(6903563,102,50,h)}catch(h){x.ULS.sendTraceTag(6903564,102,15,h.message)}}else x.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static MFm(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let n=0;n<b.length;n++){const B=b[n].name,L=b[n].version;
Array.add(h,Object.assign(new bd,{Name:B,Version:L}))}return h}static iem(){const b=new yc,h=new Sys.StringBuilder;sd.ZJ(n=>{b.DocElemClientHeight=n},()=>document.documentElement.clientHeight,h);sd.ZJ(n=>{b.DocElemClientWidth=n},()=>document.documentElement.clientWidth,h);sd.ZJ(n=>{b.DocElemOffsetHeight=n},()=>document.documentElement.offsetHeight,h);sd.ZJ(n=>{b.DocElemOffsetWidth=n},()=>document.documentElement.offsetWidth,h);sd.ZJ(n=>{b.ScreenAvailHeight=n},()=>window.screen.availHeight,h);sd.ZJ(n=>
{b.ScreenAvailWidth=n},()=>window.screen.availWidth,h);sd.ZJ(n=>{b.ScreenWidth=n},()=>window.screen.width,h);sd.ZJ(n=>{b.ScreenHeight=n},()=>window.screen.height,h);sd.ZJ(n=>{b.ScreenLogicalXdpi=n},()=>window.screen.logicalXDPI,h);sd.ZJ(n=>{b.ScreenLogicalYdpi=n},()=>window.screen.logicalYDPI,h);sd.ZJ(n=>{b.ScreenDeviceXdpi=n},()=>window.screen.deviceXDPI,h);sd.ZJ(n=>{b.ScreenDeviceYdpi=n},()=>window.screen.deviceYDPI,h);sd.ZJ(n=>{b.WinInnerHeight=n},()=>window.self.innerHeight,h);sd.ZJ(n=>{b.WinInnerWidth=
n},()=>window.self.innerWidth,h);sd.ZJ(n=>{b.WinOuterHeight=n},()=>window.self.outerHeight,h);sd.ZJ(n=>{b.WinOuterWidth=n},()=>window.self.outerWidth,h);sd.ZJ(n=>{b.WinOrientation=n},()=>window.self.orientation,h);sd.ZJ(n=>{b.WinDevicePixelRatio=n},()=>window.self.devicePixelRatio,h);sd.ZJ(n=>{b.SupportsTouch=n},()=>X.a.grd,h);sd.ZJ(n=>{b.NavAppName=n},()=>window.navigator.appName,h);sd.ZJ(n=>{b.NavAppVersion=n},()=>window.navigator.appVersion,h);sd.ZJ(n=>{b.NavLanguage=n},()=>window.navigator.browserLanguage||
window.navigator.language,h);sd.ZJ(n=>{b.NavUserAgent=n},()=>window.navigator.userAgent,h);sd.ZJ(n=>{b.NavPlatform=n},()=>window.navigator.platform,h);sd.ZJ(n=>{b.NavPlugins=n},sd.MFm,h);sd.ZJ(n=>{b.CalculatedDevicePixelRatio=n},()=>sd.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static ZJ(b,h,n){try{const B=h();b(B)}catch(B){n.isEmpty()||n.append(" | "),n.append(B.message||
"null")}}}Object(u.a)(sd,"BrowserInfoLogger",null,[]);class ie{get name(){return"Common.App.BrowserInfoLogger"}wc(){}init(){sd.Z7()}dispose(){}static main(){M.a.instance.Jc(new ie)}}Object(u.a)(ie,"BrowserInfoLoggerPackage",null,[0,1]);class We{constructor(){this.sa=new mg.a}emb(b){this.sa.addHandler("OnEditHappenedEvent",b)}ald(b){this.sa.removeHandler("OnEditHappenedEvent",b)}$lo(){this.sa.raiseEvent("OnEditHappenedEvent")}}Object(u.a)(We,"EditNotificationEventSource",null,[]);var Pe=d(47),Re=d(96);
class Sf{constructor(b,h,n,B,L,ba,la=0){this.rRe=!1;this.qRe=this.cGb=null;this.hKh=!1;this.znd=()=>{this.rRe&&(this.Oib.CWR(()=>this.Oib.result.sendMessage(H.a.gZl,null)),x.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.rRe=!1)};this.WDo=()=>{try{this.JCd&&(Pe.c(Pa.a.Pzf),this.JCd=!1)}catch(La){this.JCd=!1,x.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+La)}};this.Gb=h;this.SHd=b;this.Oib=
n;this.via=B;this.fKh=L;this.huk=ba;this.BAd=0;this.JCd=!1;try{0<la&&(this.BAd=la,3E5>this.BAd&&(this.BAd=3E5),this.Gb&&!this.qRe&&(this.qRe=new Re.a(3,2,this.BAd,this.WDo),this.Gb.Zb(this.qRe)))}catch(La){x.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+La)}}get WFe(){return this.hKh}editHappened(){this.WFe?this.JCd=!0:(this.hKh=!0,oa.Health.instance.addQosPillar("Save"),oa.Health.instance.addQosPillar("ContentCreation"),
Pe.c(Pa.a.Pzf));this.rRe=!0;this.fKh&&this.fKh.DMh();this.via&&this.via.$lo();A.AFrameworkApplication.Ug&&A.AFrameworkApplication.Ug.uIn();this.huk&&!this.cGb&&(this.znd(null),this.cGb=new Re.a(3,2,this.SHd,this.znd,113),this.Gb.Zb(this.cGb))}}Object(u.a)(Sf,"EditNotificationManager",null,[754]);class vg{constructor(b,h,n,B,L){this.sUe=this.cGb=null;this.w7b=this.dKe=!1;this.QAj=()=>{const ba=document.getElementById(A.AFrameworkApplication.oTc);!this.w7b&&this.Wl&&ba&&(this.Wl.nb(Cd.a.X3,ba,this.G9f,
null),this.w7b=!0);this.y2e(()=>{this.dispose()})};this.G9f=()=>{this.w7b&&(this.Wl.xc(Cd.a.X3,document.getElementById(A.AFrameworkApplication.oTc),this.G9f),this.w7b=!1);this.DMh();return!1};this.znd=()=>{this.dKe&&(this.Oib.CWR(()=>this.Oib.result.sendMessage(H.a.ZBp,null)),x.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.dKe=!1)};this.Gb=h;this.SHd=b;this.Oib=n;this.Wl=B;this.y2e=L;this.QAj(null)}DMh(){this.dKe=!0;this.sUe||(this.sUe=
new Re.a(3,2,this.SHd,this.QAj,112),this.Gb.Zb(this.sUe));this.cGb||(this.znd(null),this.cGb=new Re.a(3,2,this.SHd,this.znd,111),this.Gb.Zb(this.cGb))}dispose(){this.w7b&&(this.Wl.xc(Cd.a.X3,document.getElementById(A.AFrameworkApplication.oTc),this.G9f),this.w7b=!1)}}Object(u.a)(vg,"UserActivityHostNotificationManager",null,[753,13]);var Yg=d(185),ph=d(119),Di=d(577);class bj{constructor(){this.W=null;this.pz=()=>{bj.hZl&&0<bj.Szf&&(this.W.register(We,"Common.App.HostNotification.EditNotificationEventSource").ha(),
this.W.register(vg,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ha().Rd(()=>new vg(6E4,ph.a.instance,Di.a.$p(this.W.Qa("Postmessage.IHostPostmessenger")),Yg.a.instance,A.AFrameworkApplication.aJ)),this.W.register(Sf,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ha().Rd(()=>new Sf(bj.Szf,ph.a.instance,Di.a.$p(this.W.Qa("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.W.Oa("Common.Interface.IUserActivityHostNotificationManager"),bj.iZl,bj.aZl)),this.W.resolve("Common.Interface.IEditNotificationManager"),x.ULS.shipAssertTag(38086291,209,0<bj.Szf,"EditNotification Interval is less than or equal to 0."))}}get name(){return"Common.App.EditNotification"}init(){A.AFrameworkApplication.K&&A.AFrameworkApplication.K.Rn(this.pz)}wc(b){this.W=b}dispose(){}static get Szf(){return A.AFrameworkApplication.K?parseInt(A.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||
"300000"):3E5}static get aZl(){return A.AFrameworkApplication.K?parseInt(A.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get hZl(){return!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get iZl(){return!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){M.a.instance.Jc(new bj)}}Object(u.a)(bj,"CommonHostNotificationPackage",null,
[0,1]);class gi{constructor(b,h,n){this.nIb=null;this.Lze=()=>{this.nIb=null;x.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.Fih.display()};this.w6o=(B,L,ba,la,La)=>B!==Pa.a.Lze?2:1===ba?32:2===ba&&La?(x.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",La),La?this.cxb():(this.nIb?(x.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.Gb.vf(this.nIb)):(x.ULS.sendTraceTag(23674915,
207,50,"Hide float pane immediately!"),this.Fih.remove(null)),this.nIb=null),32):8;this.Gb=b;this.ga=h;this.Fih=n.create()}cxb(){this.nIb?x.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(x.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.nIb=new Re.a(2,1,3E4,this.Lze,67),this.Gb.Zb(this.nIb))}OZa(){this.ga.ra(Pa.a.Lze,id.a.frame,this.w6o)}}Object(u.a)(gi,"FloatPaneActor",null,[752]);var Zg=d(103),Bb=d(101),Nb=d(42),Bc=d(33);
class td{constructor(b,h,n,B,L){this.a0e=this.BIc=this.PKd=this.C4a=this.Yia=this.M1a=this.gMe=this.bea=this.nNc=this.UKc=this.VKc=this.$Se=null;this.OZn=()=>{const ba=this.Ga.ic("O365AdPaneShowingDuration",60);this.X9h();this.bea.style.display="block";this.bea.style.height=this.Yia.height+"px";this.BIc=new Re.a(2,1,1E3*ba,Object(z.a)(this,this.hide,"hide"),67);this.Gb.Zb(this.BIc);this.vCj()};this.NZn=()=>{x.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");
this.vCj();this.Yia=null};this.pnj=()=>{x.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1};this.onClose=()=>{this.BIc&&this.Gb.vf(this.BIc);this.hide();return!0};this.Gb=h;this.Ga=b;this.Pg=n;this.W=L;this.EFa=B}X9h(){this.bea=document.createElement("div");this.bea.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.bea.style.width=this.Yia.width+"px";(this.a0e=this.jCm(this.EFa))?(this.C4a=document.createElement("a"),
this.C4a.setAttribute(Bc.a.Ph,Bc.a.BA),this.Pg.nb(Cd.a.click,this.C4a,this.pnj),this.C4a.href=this.a0e,this.C4a.target="_blank",this.C4a.appendChild(this.Yia),this.bea.appendChild(this.C4a)):this.bea.appendChild(this.Yia);this.M1a=document.createElement("a");this.M1a.setAttribute(Bc.a.Ph,Bc.a.eaa);this.M1a.className="StandardButton WACFloatPaneCloseButton";this.M1a.title=CommonUIStrings.l_Close;this.M1a.tabIndex=-1;this.gMe=Bb.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",
!0,null);this.gMe.setAttribute(Bc.a.Ph,Bc.a.BA);this.M1a.appendChild(this.gMe);this.Pg.nb(Cd.a.click,this.M1a,this.onClose);this.bea.appendChild(this.M1a);this.nNc.appendChild(this.bea)}Ovm(b){const h=this.Ga.$("O365PromotionHasStarted");switch(b){case 2:return Zg.a.Tea(String.format("adppt{0}.png",h?"sale":""));case 1:return Zg.a.Tea(String.format("adxls{0}.png",h?"sale":""));case 3:return Zg.a.Tea(String.format("addoc{0}.png",h?"sale":""))}return null}jCm(b){const h=this.Ga.kb("O365AdPaneRedirectedURL");
switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.BIc=null;this.bea&&!this.PKd&&(b?x.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):x.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.bea.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.bea.style.height="0px",this.PKd=new Re.a(2,1,1E3,Object(z.a)(this,
this.remove,"remove"),67),this.Gb.Zb(this.PKd))}remove(){this.bea&&this.nNc&&(this.C4a&&this.Pg.xc(Cd.a.click,this.C4a,this.pnj),this.Pg.xc(Cd.a.click,this.M1a,this.onClose),this.nNc.removeChild(this.bea),this.bea=null);this.PKd=null}display(){if(this.$Se=this.W.Oa("Common.IFloatPaneContainer"))if(this.nNc=this.$Se.container){var b=this.Ovm(this.EFa);b?(x.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.Yia=document.createElement("img"),this.Yia.className="WACFloatPaneImage",
this.VKc=this.OZn,Nb.a.addHandler(this.Yia,Cd.a.load,this.VKc),this.UKc=this.NZn,Nb.a.addHandler(this.Yia,Cd.a.error,this.UKc),this.Yia.src=b):x.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else x.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else x.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}vCj(){this.VKc&&this.Yia&&Nb.a.removeHandler(this.Yia,
Cd.a.load,this.VKc);this.VKc=null;this.UKc&&this.Yia&&Nb.a.removeHandler(this.Yia,Cd.a.error,this.UKc);this.UKc=null}dispose(){this.hide()}}Object(u.a)(td,"FloatPane",null,[778]);class Je{constructor(b,h,n,B,L){this.Gb=h;this.Ga=b;this.Pg=n;this.W=L;this.EFa=B}create(){return new td(this.Ga,this.Gb,this.Pg,this.EFa,this.W)}}Object(u.a)(Je,"FloatPaneFactory",null,[750]);var Ef=d(249);class Ih{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get HYi(){return A.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&
A.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.HYi&&(x.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").cxb(),x.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").OZa())}wc(b){this.W=b;this.HYi&&(this.W.register(Je,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Rd(()=>new Je(A.AFrameworkApplication.K,
A.AFrameworkApplication.mc,Ef.a.instance,A.AFrameworkApplication.ua.Ib.Tk,this.W)).ha(),this.W.register(gi,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Rd(()=>new gi(A.AFrameworkApplication.mc,A.AFrameworkApplication.va,this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ha())}dispose(){}static main(){M.a.instance.Jc(new Ih)}}Object(u.a)(Ih,"FloatPanePackage",null,[0,1]);var tg=d(1752);class Dh{}Object(u.a)(Dh,"LokiTokenResult",null,[]);class Jh{constructor(b){this.ZHd=
b}JLf(){const b=this.ezm();return b?Jh.wab?new Promise((h,n)=>{this.ZHd.continueWith(()=>{this.ZHd.qp||this.ZHd.ij?n(Error.create("Error downloading auth library")):this.ZHd.result.wV("Loki",b).then(B=>{B=A.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.hzm():B.IsSuccess&&B.Token?Object.assign(new Dh,{isSuccess:!0,token:B.Token,errorMessage:null}):Object.assign(new Dh,{isSuccess:!1,token:null,errorMessage:JSON.stringify(B)});h(B);return B})})}):Promise.resolve(Object.assign(new Dh,
{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new Dh,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",tg.a.$ti())}))}hzm(){const b=A.AFrameworkApplication.K.kb("LokiUserDataSignature")||"";return Object.assign(new Dh,{isSuccess:!0,token:b,errorMessage:null})}ezm(){let b=null;const h=tg.a.s5d();2===h?b=A.AFrameworkApplication.K.kb("LokiAADAppId"):1===
h&&(b=A.AFrameworkApplication.K.kb("LokiMSAAppId"));return b}static get wab(){return A.AFrameworkApplication.K.$("IsO365CommercialHost")||A.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(u.a)(Jh,"LokiTokenManager",null,[751]);class Xh{get name(){return"Common.App.LivePersonaUtils"}init(){Ya.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}wc(b){b.register(Jh,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ha().Rd(()=>new Jh(Di.a.$p(b.Qa("Common.App.OAuth.IOAuthManager"))))}static main(){M.a.instance.Jc(new Xh)}}
Object(u.a)(Xh,"LivePersonaUtilsPackage",null,[0,1]);class Mf{constructor(b){this.JKe=b}MXi(b){if(!this.JKe)return!0;b=za.a.GKf(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.JKe.length;h++)if(b.endsWith(this.JKe[h]))return!0;return!1}}Object(u.a)(Mf,"DomainAllowListManager",null,[]);class Jg{constructor(b,h){this.Ovf=null;this.$af=b;this.url=h}get sNg(){return za.a.xca(this.url)}get rt(){return this.$af}gJg(){const b={},h=this.rt;b.a=this.sNg;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);
b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);
b.s=this.round(h.domContentLoadedEventEnd);b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.Ovf;return b}round(b){return Math.round(1E3*b)/1E3}}Object(u.a)(Jg,"PerformanceTimingEntry",null,[]);const ug=(b,h)=>{var n,B;const L={};let ba=null;switch(b){case 0:ba="ResourceTiming";b=h.a;null!=b&&(L.Url=b);b=h.b;null!=b&&(L.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(L.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(L.RedirectEnd=
b);b=null==h.e?null:h.e.toString();null!=b&&(L.FetchStart=b);b=null==h.f?null:h.f.toString();null!=b&&(L.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(L.DomainLookupEnd=b);b=null==h.h?null:h.h.toString();null!=b&&(L.ConnectStart=b);b=null==h.i?null:h.i.toString();null!=b&&(L.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(L.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(L.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(L.ResponseStart=b);b=null==
h.m?null:h.m.toString();null!=b&&(L.ResponseEnd=b);b=h.n;null!=b&&(L.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(L.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&(L.EncodedBodySize=b);b=null==h.q?null:h.q.toString();null!=b&&(L.TransferSize=b);h=null!==(B=null===(n=h.r)||void 0===n?void 0:n.toString())&&void 0!==B?B:null;null!=h&&(L.responseStatus=h);break;case 1:ba="PerformanceTiming",n=h.a,null!=n&&(L.Url=n),n=null==h.b?null:h.b.toString(),null!=n&&(L.NavigationStart=n),
n=null==h.c?null:h.c.toString(),null!=n&&(L.UnloadEventStart=n),n=null==h.d?null:h.d.toString(),null!=n&&(L.UnloadEventEnd=n),n=null==h.e?null:h.e.toString(),null!=n&&(L.RedirectStart=n),n=null==h.f?null:h.f.toString(),null!=n&&(L.RedirectEnd=n),n=null==h.g?null:h.g.toString(),null!=n&&(L.FetchStart=n),n=null==h.h?null:h.h.toString(),null!=n&&(L.DomainLookupStart=n),n=null==h.i?null:h.i.toString(),null!=n&&(L.DomainLookupEnd=n),n=null==h.j?null:h.j.toString(),null!=n&&(L.ConnectStart=n),n=null==h.k?
null:h.k.toString(),null!=n&&(L.ConnectEnd=n),n=null==h.l?null:h.l.toString(),null!=n&&(L.SecureConnectionStart=n),n=null==h.m?null:h.m.toString(),null!=n&&(L.RequestStart=n),n=null==h.n?null:h.n.toString(),null!=n&&(L.ResponseStart=n),n=null==h.o?null:h.o.toString(),null!=n&&(L.ResponseEnd=n),n=null==h.p?null:h.p.toString(),null!=n&&(L.DomLoading=n),n=null==h.q?null:h.q.toString(),null!=n&&(L.DomInteractive=n),n=null==h.r?null:h.r.toString(),null!=n&&(L.DomContentLoadedEventStart=n),n=null==h.s?
null:h.s.toString(),null!=n&&(L.DomContentLoadedEventEnd=n),n=null==h.t?null:h.t.toString(),null!=n&&(L.DomComplete=n),n=null==h.u?null:h.u.toString(),null!=n&&(L.LoadEventStart=n),n=null==h.v?null:h.v.toString(),null!=n&&(L.LoadEventEnd=n),h=h.w,null!=h&&(L.CustomText=h)}L.Table=ba;return Sys.Serialization.JavaScriptSerializer.serialize(L)};var ze=d(45),pi=d(180),og=d(168);class Jk{constructor(b,h=null,n=null){this.og=b;this.rNg=this;this.Gwk=h||(()=>window.location.href);this.YQe=new Mf(n)}run(){if(Jk.$Kb(window.performance))try{const L=
this.Gwk();if(Jk.bRk.exec(L)&&this.YQe.MXi(L)){var b=new Jg(window.performance.timing,L);og.a.instance.Noo(b.rt.fetchStart);og.a.instance.Ooo(b.rt.navigationStart);og.a.instance.B0(ze.a.udm,"connectStart","requestStart");og.a.instance.B0(ze.a.Cdm,"requestStart","responseStart");og.a.instance.B0(ze.a.Fdm,"responseStart","responseEnd");this.rNg.mbb(1,b.gJg());this.og.uf(ze.a.yKa,b.rt.fetchStart);this.og.uf(ze.a.zdm,b.rt.domainLookupStart);this.og.uf(ze.a.ydm,b.rt.domainLookupEnd);this.og.uf(ze.a.wdm,
b.rt.connectStart);this.og.uf(ze.a.Hdm,b.rt.secureConnectionStart);this.og.uf(ze.a.vdm,b.rt.connectEnd);this.og.uf(ze.a.Ddm,b.rt.requestStart);this.og.uf(ze.a.fjc,b.rt.responseStart);this.og.uf(ze.a.Adm,b.rt.responseEnd-b.rt.responseStart);this.og.uf(ze.a.Edm,b.rt.responseStart-b.rt.requestStart);var h=0,n=0,B=0;({transferSize:h,MAf:n,kwf:B}=this.Lpp(L)).returnValue&&(this.og.uf(ze.a.Jdm,h),this.og.uf(ze.a.xdm,B),this.og.uf(ze.a.Bdm,n));this.og.uf(ze.a.y1c,b.rt.navigationStart)}}catch(L){x.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",L)}}Lpp(b){let h,n,B;B=n=h=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,MAf:n,kwf:B};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,MAf:n,kwf:B};b=b[0];var L=b.transferSize;void 0!==h&&null!==h&&(h=L);L=b.decodedBodySize;void 0!==L&&null!==L&&(B=L);b=b.encodedBodySize;void 0!==
b&&null!==b&&(n=b);return{returnValue:!0,transferSize:h,MAf:n,kwf:B}}mbb(b,h){x.ULS.sendTraceTag(4551815,306,50,ug(b,h))}static get instance(){return Jk._instance||(Jk._instance=new Jk(pi.a.instance,null,A.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?A.AFrameworkApplication.K.iD("ResourceLoggerDomainAllowList"):null))}static $Kb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}Jk._instance=null;Jk.bRk=RegExp("^https?://.*","i");Object(u.a)(Jk,"PerformanceTimingLogger",
null,[747]);class zk{constructor(b,h){this.Ovf=null;this.$af=b;this.behavior=h;this.url=this.rt.name}get sNg(){return 2===this.behavior?this.url:za.a.xca(this.url)}get rt(){return this.$af}gJg(){const b={},h=this.rt;b.a=this.sNg;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&
null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);b.o=this.round(zk.H9a(h,"decodedBodySize"));b.p=this.round(zk.H9a(h,"encodedBodySize"));b.q=this.round(zk.H9a(h,"transferSize"));b.n=this.Ovf;b.r=zk.H9a(h,"responseStatus")||0;return b}round(b){return Math.round(1E3*b)/1E3}static H9a(b,h){return b[h]}}Object(u.a)(zk,"ResourceTimingEntry",null,[777]);class Xf{constructor(b,h=null,n=100){this.s9g=
b;this.yNd=h;this.Egb={};this.Spk=n}hop(b){var h=b.name.toLowerCase();const n=za.a.tQb(h);this.RGj(n,h)&&(n in this.Egb?x.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",n):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.A3i(b),h.encodedsize=zk.H9a(b,"encodedBodySize"),h.decodedsize=zk.H9a(b,"decodedBodySize"),this.Egb[n]=h))}iop(b){var h=b.name.toLowerCase();const n=za.a.tQb(h);this.MGo(n,h)&&(n in this.Egb?x.ULS.sendTraceTag(508925201,
306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",n):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.A3i(b),h.encodedsize=zk.H9a(b,"encodedBodySize"),h.decodedsize=zk.H9a(b,"decodedBodySize"),h.it=b.initiatorType,h.ress=b.responseStart,h.cs=b.connectStart,h.ce=b.connectEnd,h.dls=b.domainLookupStart,h.dle=b.domainLookupEnd,h.rs=b.redirectStart,h.re=b.redirectEnd,h.reqs=b.requestStart,h.scs=b.secureConnectionStart,this.Egb[n]=h))}RGj(b,h){if(this.s9g)return Array.contains(this.s9g,
b);if(this.yNd)for(b=za.a.rU(h),h=0;h<this.yNd.length;h++)if(this.yNd[h]&&b.endsWith(this.yNd[h]))return!0;return!1}MGo(b,h){return this.RGj(b,h)?b.endsWith(".js")||b.endsWith(".css"):!1}A3i(b){try{const h=zk.H9a(b,"transferSize");if(void 0!==h&&null!==h)return!h;x.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return b.responseEnd-b.fetchStart<this.Spk}catch(h){x.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",
h.message)}return!1}iro(){if(Yb.a.Tf(this.Egb))x.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var b=A.AFrameworkApplication.flightId?A.AFrameworkApplication.flightId.split(";"):[],h=Object.assign(new rb.a,{extendedProperties:nb.a.KG()});h.extendedProperties.set("Flights",D.c(b));this.aaj(h,this.Egb,oa.Health.instance)}}UGf(b){let h=0,n=0,B=0,L=0;const ba=this.Egb;for(const La in ba){var la=ba[La];La.endsWith(".js")&&(la=Object(ya.a)(Object,
la),la.responseend<b&&(h+=1,n+=la.decodedsize,L+=la.encodedsize,B+=la.iscached?0:la.encodedsize))}b={};b.filesLoaded=h;b.decodedBytes=n;b.transferredBytes=B;b.encodedBytes=L;return b}aaj(b,h,n){if(h){var B=0,L=0,ba=0,la=0,La=0,fb=0,Cb=0,Lb=0,$b=0,tc=0,Nc=0;for(const Hd in h){var dd=h[Hd];try{const xe=Object(ya.a)(Object,dd);if(!xe)continue;const je=xe.iscached?Boolean.parse(xe.iscached.toString()):!1,he=xe.fetchstart?this.parseFloat(xe.fetchstart.toString()):0,fe=(xe.responseend?this.parseFloat(xe.responseend.toString()):
0)-he,De=xe.encodedsize?this.parseFloat(xe.encodedsize.toString()):0,gg=xe.decodedsize?this.parseFloat(xe.decodedsize.toString()):0;B+=fe;la+=De;Cb+=gg;tc++;je?(ba+=fe,fb+=De,$b+=gg,Nc++):(L+=fe,La+=De,Lb+=gg)}catch(xe){x.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",xe.message)}}b.extendedProperties.set("StaticResources",D.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",B.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",
L.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ba.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",la.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",La.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",fb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Cb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Lb.toString());
b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",$b.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",tc.toString());b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Nc.toString());n.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);n.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(u.a)(Xf,"AppStaticResourceManager",
null,[]);class Gg extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(u.a)(Gg,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Lg{constructor(b,h,n=null,B=null,L=100,ba=!1){this.hZe=!1;this.kp=null;this.zFc=0;this.sa=new mg.a;this.vBb=null;this.U1=!1;this.qIh=0;this.Gb=b;this.heh=0;this.rNg=this;this.YQe=new Mf(n);this.SM=h;B&&(this.vBb=new Xf(null,B,L));this.ank=ba}get NXh(){try{return!(void 0===this.SM||null===this.SM)&&!(void 0===this.SM.getEntriesByType||null===this.SM.getEntriesByType)}catch(b){return x.ULS.sendTraceTag(50873240,
306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get MNl(){return this.heh}get isActive(){return this.U1}get ZIg(){return this.qIh}zPh(b){this.sa.addHandler(Lg.LBf,b)}BDj(b){this.sa.removeHandler(Lg.LBf,b)}wc(b,h){const n=this.ZIg!==b;this.qIh=b;this.isActive&&this.Gb&&n&&(this.vf(),this.Zb());this.heh=h}activate(){!this.isActive&&this.NXh&&(this.Zb(),this.U1=!0)}deactivate(b){this.isActive&&(this.vf(),b&&this.flush(),this.U1=!1)}flush(){if(this.isActive&&
this.NXh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.zFc&&x.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",b.length-this.zFc);const h=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.zFc=0);const n=[];for(let B=this.zFc;B<b.length;B++)this.YQe.MXi(b[B].name)&&(this.vBb&&(this.ank?this.vBb.iop(b[B]):
this.vBb.hop(b[B])),n.push(new zk(b[B],this.MNl)));h||(this.zFc=b.length);this.sa.raiseEvent(Lg.LBf,new Gg(n));for(b=0;b<n.length;b++)0!==n[b].behavior&&2!==n[b].behavior||this.rNg.mbb(0,n[b].gJg());0<n.length&&x.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",n.length)}catch(h){x.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}mbb(b,h){x.ULS.sendTraceTag(4310804,306,50,ug(b,h))}Ioo(){this.vBb.iro()}UGf(b){return this.vBb.UGf(b)}Zb(){this.Gb&&
0<this.ZIg&&(this.kp=new Re.a(3,2,1E3*this.ZIg,()=>{this.flush()},5),this.Gb.Zb(this.kp),this.hZe=!0)}vf(){this.hZe&&(this.Gb.vf(this.kp),this.kp=null,this.hZe=!1)}}Lg.LBf="EntriesAvailable";Object(u.a)(Lg,"ResourceTimingLogger",null,[714,747]);class ak{constructor(){this.W=null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");Jk.instance.run()}dispose(){}wc(b){this.W=b;let h=null;if(A.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=
A.AFrameworkApplication.K.iD("ResourceLoggerDomainAllowList")}catch(ba){x.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const n=[];n.push(za.a.rU(Zg.a.E4).toLowerCase());n.push(za.a.rU(Zg.a.dpd).toLowerCase());const B=A.AFrameworkApplication.K.ic("AppStaticResourceMonitorCacheThresholdInMs",100),L=A.AFrameworkApplication.K.$("PPTAggregateResourceTimingV2Enabled");b.register(714,"Common.NetworkTiming.IResourceTimingLogger").ha().Rd(()=>new Lg(A.AFrameworkApplication.mc,
window.performance,h,n,B,L))}static main(){M.a.instance.Jc(new ak)}}Object(u.a)(ak,"ResourceTimingPackage",null,[0,1]);var Rf=d(286);class Bg{constructor(){this.$Je={}}mUk(b){this.$Je[b.id.toString()]=b}PRn(b){const h=this.$Je;for(const n in h)h[n].notify(b,!1);this.$Je={}}Ljo(b,h){h&&this.mUk(h);return this.Fnj(b,h)}vAf(b){this.PRn(b)}Cji(b,h){b.notify(h,!0)}}Object(u.a)(Bg,"AEventEmitter",null,[636]);var bk;(function(b){b[b.zcg=0]="notStarted";b[b.waiting=1]="waiting";b[b.rze=2]="shouldRetry";b[b.complete=
3]="complete"})(bk||(bk={}));Object(u.b)("EventResultState",bk);class Kk{constructor(){this._state=0}get state(){return this._state}set state(b){x.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:bk[this._state],["NewState"]:bk[b]},"ResultType",this.kGi());this._state=b}}Object(u.a)(Kk,"AEventResult",null,[635]);class Pi extends Kk{constructor(){super();this.u$e=this.HNc=null;this.state=0;this.JWe=this.rnh=!1}get Wga(){return this.HNc}get Oeb(){return this.u$e}get Wan(){return this.rnh}kGi(){return"GetMoreInfo Result"}}
Object(u.a)(Pi,"GetMoreInfoResult",Kk,[791,635]);var Uj=d(1429),jk=d(1633),Bj=d(1137);class Vj{constructor(b,h,n,B,L,ba,la,La){this.itc=(fb,Cb,Lb,$b,tc)=>{tc&&tc.MenuItemId&&(x.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:tc.SourceControlId,["AppType"]:Bj.a[this.Fga]}),$c.a.yn(tc.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};this.jig=(fb,Cb,Lb,$b,tc)=>{if(tc&&tc.MenuItemId){const Nc=A.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),
dd=A.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");x.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Nc,dd);if(Nc&&dd){x.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:tc.SourceControlId,["AppType"]:Bj.a[this.Fga]});fb=tc.MenuItemId.toString();const Hd={};Hd[I.a.cvc]="1";Hd[I.a.documentUrl]=fb;Hd[I.a.reason]=jk.a.open;x.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");
A.AFrameworkApplication.IR().execute(xe=>{xe.sendMessage(H.a.BNb,Hd)})}else this.itc(fb,Cb,Lb,$b,tc)}return 32};this.t0d=()=>{this.daj();return 32};this.ga=b;this.Af=h;this.gi=n;this.EFa=B;this.Gb=L;this.dF=ba;this.$xk=la;this.VNd=La}Hso(){this.Vrc.ra(Pa.a.itc,id.a.frame,this.itc);this.Vrc.ra(Pa.a.jig,id.a.frame,this.jig);A.AFrameworkApplication.Aka?this.daj():this.Vrc.fb(Pa.a.t0d,id.a.frame,this.t0d,96)}mYa(b,h,n=""){if(h&&h.bH){const B=Uj.a[h.status];h=h.bH.getTime();const L=this.Yp()-h;x.ULS.sendTraceTag(5849679,
202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:B,["ElapsedMs"]:L,["StartTime"]:h,["Notes"]:n})}else x.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}daj(){var b=A.AFrameworkApplication.K.$("QPGVCI"),h=za.a.HL(document.URL,"wdNewAndOpenCt",b);if(h){h=parseInt(h);var n=za.a.HL(document.URL,"wdPreviousSession",b);b=za.a.HL(document.URL,"wdPreviousCorrelation",b);var B=A.AFrameworkApplication.K.$("NAOPLP");
if(A.AFrameworkApplication.Aka){var L=A.AFrameworkApplication.Aka.getTime();!h||h>L?x.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:L,["SessionId"]:n,["Correlation"]:b}):x.ULS.sendTraceTag(5849683,202,B?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:L-h,["ClickTimestamp"]:h,["SessionId"]:n,["Correlation"]:b})}else x.ULS.sendTraceTag(5849681,202,
B?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:h,["SessionId"]:n,["Correlation"]:b})}}get Vrc(){return this.ga.value}get jed(){return this.Af.value}get Jgj(){return this.gi.value}get Fga(){return this.EFa.value}get ole(){return this.Gb.value}get Yp(){return this.dF}get HYa(){return this.$xk.value}get c0a(){return this.VNd.value}static get instance(){return Vj._instance||(Vj._instance=Vj.Xs())}static Xs(){return new Vj(new Rf.a(()=>
A.AFrameworkApplication.va),new Rf.a(()=>A.AFrameworkApplication.Be),new Rf.a(()=>A.AFrameworkApplication.ua),new Rf.a(()=>A.AFrameworkApplication.ua.Ib.Tk),new Rf.a(()=>A.AFrameworkApplication.mc),()=>(new Date).getTime(),new Rf.a(()=>A.AFrameworkApplication.ua.Ib.HYa),new Rf.a(()=>A.AFrameworkApplication.c0a))}}Vj._instance=null;Object(u.a)(Vj,"NewAndOpenCommonHelpers",null,[633]);class Cl{constructor(b,h,n){this.sMd=this.kp=null;this.i7e=0;this.FMk=b;this.Gb=h;this.Keh=n}H3k(){this.i7e=this.Qvc+
1}fvg(b){this.kp&&(this.Gb.vf(this.kp),this.kp=null);b&&(this.i7e=0)}Sbp(b){const h=this.Zjp;0<=h?(this.H3k(),this.fvg(!1),this.kp=new Re.a(4,1,h,b,107),this.Gb.Zb(this.kp)):(this.fvg(!0),x.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.Keh}))}get Qvc(){return this.i7e}get Zjp(){return this.Qvc>=this.hMj.length?-1:this.hMj[this.Qvc]}get hMj(){if(!this.sMd){const b=(this.FMk.value||"0").split(",");this.sMd=[];for(let h=0;h<b.length;h++){const n=parseInt(b[h]);isNaN(n)?x.ULS.sendTraceTag(5849677,
202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.Keh,["Entry"]:b[h]}):Array.add(this.sMd,n)}}return this.sMd}}Object(u.a)(Cl,"RetryHelper",null,[]);class ah extends Bg{constructor(b,h){super();this.aHa=b;this.MOc=new Cl(h,this.Pdd.ole,"GetMoreInfo");this.Xp=new Pi}CHn(){this.a8f("Document opened")}pHl(b){return()=>{this.a8f(b,!0)}}Fnj(b,h=null){x.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:b});3===this.Xp.state?(h&&this.Cji(h,
this.Xp),x.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):this.a8f(b);return this.Xp}a8f(b,h=!1){this.MOc.fvg(!h);1===this.Xp.state?x.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.MOc.Qvc}):(x.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.MOc.Qvc}),this.Xp.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.Pdd.HYa,
A.AFrameworkApplication.jm),this.Pdd.jed.X5a(h,1,null,null,[ah.Pzh,ah.JGh],5,this.aGl(),this.$Fl(b)))}aGl(){return b=>{var h=!1;let n=!1;var B=!1,L;A.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(b.data.De?({Zu:L}=D.d(b.data.De)).returnValue?L?(B=!0,this.Xp.u$e=L.StorageServiceDisplayName,this.Xp.HNc=ah.r4i(L.PersonalFileStorageUrl)?L.PersonalFileStorageUrl:"",""===this.Xp.Wga&&"SharePointOnlineConsumer"===A.AFrameworkApplication.K.kb("FileSource")&&(this.Xp.HNc=za.a.xca(A.AFrameworkApplication.breadcrumbFolderUrl)),
h=""===this.Xp.Wga&&""!==this.Xp.Oeb):x.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):x.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):x.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));B||((L=b.data.vi)?(this.Xp.u$e=
(L[ah.JGh]||"").toString(),h=(L[ah.Pzh]||"").toString(),this.Xp.HNc=ah.r4i(h)?h:"",""===this.Xp.Wga&&"SharePointOnlineConsumer"===A.AFrameworkApplication.K.kb("FileSource")?(this.Xp.HNc=za.a.xca(A.AFrameworkApplication.breadcrumbFolderUrl),h=""===this.Xp.Wga&&""!==this.Xp.Oeb):h=""===h&&""!==this.Xp.Oeb):(x.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),n=!0));B=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.MOc.Qvc,n,h,B);this.Pdd.mYa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,B);this.yMj(3,h,n)}}$Fl(b){return h=>{this.Pdd.mYa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");this.yMj(2);this.MOc.Sbp(this.pHl(b))}}yMj(b,h=!1,n=!1){this.Xp.state=b;this.Xp.rnh=h;this.Xp.JWe=n;this.vAf(this.Xp)}get Pdd(){return this.aHa.value}static get instance(){return ah._instance||(ah._instance=ah.Xs())}static Xs(){return new ah(new Rf.a(()=>Vj.instance),
new Rf.a(()=>A.AFrameworkApplication.rAm))}static r4i(b){if(!b)return x.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(F.a.xh(b).startsWith("https://"))return!0;x.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}ah.Pzh="PersonalFileStorageUrl";ah.JGh="StorageServiceDisplayName";ah._instance=null;Object(u.a)(ah,"GetMoreInfoActor",Bg,[]);class zh{constructor(b,h,n,B,L){this.mzk=6E4;this.XQi="inactive";this.uMh="active";
this.U1=!0;this.Gb=b;this.exk=h;this.dF=n;this.POd=B;this.sa=new mg.a;L&&this.Kbp();this.Jrh=this.rBi()}UMh(b){this.sa.addHandler(this.uMh,b)}WXk(b){this.sa.addHandler(this.XQi,b)}Kbp(){const b=new Re.a(5,2,this.mzk,Object(z.a)(this,this.Q3m,"inactiveLoop"),108);this.R3m.Zb(b)}Q3m(){const b=this.rBi(),h=this.Yp()-b;h>this.hDe&&this.U1&&(x.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.U1=!1,this.sa.raiseEvent(this.XQi));b-this.Jrh>this.hDe&&(this.U1=!0,
this.sa.raiseEvent(this.uMh));this.Jrh=b}get R3m(){return this.Gb.value}get rBi(){return this.exk}get Yp(){return this.dF}get hDe(){return this.POd.value}static get instance(){return zh._instance||(zh._instance=zh.Xs())}static Xs(){return new zh(new Rf.a(()=>ph.a.instance),()=>A.AFrameworkApplication.p3f.getTime(),()=>(new Date).getTime(),new Rf.a(()=>A.AFrameworkApplication.hDe),!0)}}zh._instance=null;Object(u.a)(zh,"InactivityManager",null,[]);var Ql=d(1777);class al extends Kk{constructor(){super();
this.cFk=this.Hvh=this.Gvh=null;this.state=this.rIh=0;this.JWe=!1}get f$f(){return this.Gvh}get Cfj(){return this.Hvh}get ekp(){return this.rIh}kGi(){return"MruActor Result"}}Object(u.a)(al,"MruResult",Kk,[634,635]);class ji{constructor(b,h,n){this.task=null;this.WRb=b;this.maxRetries=h;this.Qi=n;this.retryCount=this.t8c=0;this.q5e=this.Vad=null}von(b,h){return b===ja.a.Zic||20===h||18===h||3===h}Spn(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===b||16===
b||23===b||26===b||27===b||28===b}get kre(){return this.q5e}reset(){this.t8c=this.retryCount=0;this.q5e=this.Vad=null;this.task&&(this.Qi.vf(this.task),this.task=null)}D8m(b,h,n,B){this.q5e=String.format("{0}_{1}",n,B);if(this.retryCount>=this.maxRetries)return x.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.von(n,B))return x.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.Spn(B)&&1<=this.t8c)return this.Vad=n,!1;h=Math.max(h,this.WRb*
Math.pow(2,this.t8c));if(26===B)h=Math.max(h,3E4);else if(27===B||28===B)h=Math.max(h,6E4);9===B||412===n&&(null==this.Vad||412!==this.Vad)?h=500:this.t8c+=1;this.Vad=n;this.retryCount+=1;this.task&&this.Qi.vf(this.task);x.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",h);this.task=new Re.a(2,1,h,b,107);this.Qi.Zb(this.task);return!0}}Object(u.a)(ji,"RetryManager",null,[]);var kh=d(142);class bh{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=
this.documentUrl=null}}Object(u.a)(bh,"WriteOptions",null,[]);var hj=d(814);class uj extends Bg{constructor(b,h,n,B,L,ba,la){super();this.MJp=La=>{this.KMi(La.data)};this.tLl=La=>{if(La.data.He===ja.a.jgc)this.KMi(La.data);else{var fb=La.data.He===ja.a.A8,Cb=nb.a.KG();this.VMi(this.Qlb,La,this.bLl(),Cb);Cb&&(Cb.set("StatusCode",La.data.He.toString()),fb||this.Qef(La.data,Cb));oa.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",La.data.He),fb,!1,Object.assign(new rb.a,
{extendedProperties:Cb}))}};this.CAm=La=>{this.GCi(La)};this.BAm=La=>{this.GCi(La,!0)};this.yAm=La=>{this.FCi(La)};this.wAm=La=>{this.FCi(La,!0)};this.aHa=b;this.TDk=h;this.ykb=new ji(A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.EP.ole);this.Qlb=new ji(A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",
15E3),A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.EP.ole);this.lKk=n;this.rLh=B;this.cTk={};this.Qpa=new al;this.Cwk=L;this.AHd="";this.mO=ba;this.Kgh=la;this.HKd="";this.qKk=A.AFrameworkApplication.K.ic("WordRecentLinksCount",25)}get qHe(){return this.cTk}vwo(){this.EP.Vrc.ra(Pa.a.kEj,id.a.frame,Object(z.a)(this,this.yBo,"renameMruEntry"))}yBo(){return this.HPg("Rename")}UHn(){this.rcj("File Opened")}VHn(){this.rcj("IntervalUpdate")}rcj(b){x.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.HPg(b)}fla(b){(b=F.a.fla(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}n5d(){switch(this.EP.Fga){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}wQm(b){var h=this.Cwk();if(!h)return null;const n=new bh;n.documentUrl=this.Kgh.value?encodeURI(h):h;n.mruItemId=this.AHd;n.app=this.n5d();if(h=this.mO())n.folderName=h.breadcrumbFolderName,
h=h.FA,n.documentName=F.a.BL(h),n.documentExt=this.fla(h);b&&(n.documentName?n.documentName.length?255<=n.documentName.length?b.set("DocumentNameLength","Long"):2084<=n.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength","Null"));return JSON.stringify(n)}HPg(b,h=!1){if(4===this.EP.Fga&&!A.AFrameworkApplication.q0d)return 2;var n=nb.a.KG();n&&(n.set("Trigger",b),n.set("IsRetry",h?"true":"false"),n.set("MruIdSent",this.AHd?"true":"false"),
n.set("URLEncoded",this.Kgh.value?"true":"false"));oa.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",n);b=this.wQm(n);if(!b)return h=!A.AFrameworkApplication.k3b,n&&(n.set("WebEditingIsEnabled",A.AFrameworkApplication.k3b?"true":"false"),n.set("ProtectedFile",A.AFrameworkApplication.O0?"true":"false")),oa.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new rb.a,{extendedProperties:n})),2;this.Qlb&&!h&&this.Qlb.reset();n=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",
this.EP.HYa,this.X5f);this.rLh?this.qHe["X-FileId"]=A.AFrameworkApplication.jm:n+=String.format("&{0}",A.AFrameworkApplication.jm);A.AFrameworkApplication.sessionStartInfoSettings&&(this.qHe["X-Office-AudienceGroup"]=Object(ya.a)(String,A.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");this.qHe["X-Timeout"]=15E3;return this.EP.jed.Ij(n,2,b,this.qHe,!0,5,this.MJp,this.tLl,null,void 0,void 0,void 0,void 0,"4")}KMi(b){const h=nb.a.KG();this.Qlb&&(h&&this.Qlb.kre&&(h.set("LastError",
this.Qlb.kre),h.set("NumRetries",this.Qlb.retryCount.toString())),this.Qlb.reset());const n=Ql.c(b.De);n&&n.diagnostics_data&&(this.AHd=n.diagnostics_data.mru_id);b=+b.YO-+b.bH;h&&h.set("RequestDuration",b.toString());oa.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new rb.a,{extendedProperties:h}))}bLl(){return()=>{this.HPg("Retry",!0)}}AAm(){this.Mcd("Polling")}zAm(){this.Mcd("Retry",!0)}FHn(){this.Mcd("Open")}EHn(){this.Mcd("Activity")}DHn(){this.Mcd("ActivityRecentLinks",!1,!0)}Mcd(b,
h=!1,n=!1){x.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const B=nb.a.KG();B&&(B.set("Trigger",b),B.set("IsRetry",h?"true":"false"),n&&B.set("RecentLinks","true"));oa.Health.instance.recordKpiUsage("GetMru",0,"smartfio",B);this.ykb&&!h&&this.ykb.reset();n?this.E$h(this.BAm,this.wAm,!0):this.E$h(this.CAm,this.yAm)}Qef(b,h){b&&b.vi&&(b=b.vi["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}nDn(b,h){b&&(h&&h.set("RequestDuration",(+b.YO-+b.bH).toString()),oa.Health.instance.recordKpiSuccess("GetMru",
Object.assign(new rb.a,{extendedProperties:h})))}GCi(b,h=!1){var n="";let B=null,L=null,ba=null;const la=Ql.c(b.data.De);la&&(B=la.places?la.places.items:[],L=la.documents?la.documents.items:[],(ba=Ql.a(la,h))&&(n=D.c(ba)));A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.LXa&&kh.c()&&(h?this.HKd=n:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(n,!0)));n=nb.a.KG();this.ykb&&(n&&this.ykb.kre&&(n.set("LastError",this.ykb.kre),n.set("NumRetries",this.ykb.retryCount.toString())),
this.ykb.reset());h&&n&&n.set("RecentLinks","true");ba||B||L?(h?this.EP.mYa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Success"):this.EP.mYa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.pFe(3,ba,B,L),this.nDn(b.data,n)):(h?this.EP.mYa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.EP.mYa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),n&&this.Qef(b.data,n),oa.Health.instance.recordKpiFailure("GetMru",
"JsonParseFailed",!1,!1,Object.assign(new rb.a,{extendedProperties:n})),this.pFe(3,null,null,null,!0));this.vAf(this.Qpa)}VMi(b,h,n,B){let L=0,ba=0;const la=Ql.c(h.data.De);la&&(null!=la.response_code&&(L=la.response_code,B&&B.set("MruResponseCode",L.toString()),9===L&&(this.AHd="")),la.error_data&&null!=la.error_data.retry_after_ms&&(ba=la.error_data.retry_after_ms,B&&B.set("ExpectedRetryAfter",ba.toString())));b&&(h=b.D8m(n,ba,h.data.He,L),B&&(B.set("CurrentRetryCount",b.retryCount.toString()),
B.set("RetryScheduled",h?"true":"false")))}FCi(b,h=!1){const n=b.data.He===ja.a.A8,B=nb.a.KG();B&&(B.set("StatusCode",b.data.He.toString()),h&&B.set("RecentLinks","true"),n||this.Qef(b.data,B));h?this.EP.mYa("MruActor.GetMruForRecentLinksFromServerFailureCallback",b.data,"Failure"):this.EP.mYa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.pFe(2);this.VMi(this.ykb,b,Object(z.a)(this,this.zAm,"getMruFromServerRetryTask"),B);oa.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",
b.data.He),n,!1,Object.assign(new rb.a,{extendedProperties:B}));this.vAf(this.Qpa);A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.LXa&&kh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.HKd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}pFe(b,h=null,n=null,B=null,L=!1){if(3!==this.Qpa.state||3===b)this.Qpa.Gvh=h,this.Qpa.Hvh=n,this.Qpa.cFk=B,this.Qpa.state=b,this.Qpa.JWe=L,this.Qpa.rIh=this.EP.Yp()}Fnj(b,h){x.ULS.sendTraceTag(6029918,
202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.Qpa.state});h&&3===this.Qpa.state&&this.Cji(h,this.Qpa);return this.Qpa}E$h(b,h,n=!1){this.pFe(1);let B;const L={};B=n?String.format(this.EP.HYa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.qKk,"OfficeSuite",this.X5f,"ClassicMru"):String.format(this.EP.HYa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.n5d(),this.X5f);this.lKk.value||(B+="&entity=docs");A.AFrameworkApplication.sessionStartInfoSettings&&
(L["X-Office-AudienceGroup"]=Object(ya.a)(String,A.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");n&&(L["X-Office-Application"]="147");this.rLh?L["X-FileId"]=A.AFrameworkApplication.jm:B+=String.format("&{0}",A.AFrameworkApplication.jm);this.EP.jed.Ij(B,1,null,L,!0,5,b,h,null)}get EP(){return this.aHa.value}get X5f(){return this.TDk.value}static get instance(){return uj._instance||(uj._instance=uj.Xs())}static Xs(){return new uj(new Rf.a(()=>Vj.instance),new Rf.a(()=>hj.a.Cg(A.AFrameworkApplication.lcid).name),
new Rf.a(()=>A.AFrameworkApplication.ua.Ib.cH),A.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),()=>A.AFrameworkApplication.ua.Ib.HW,()=>A.AFrameworkApplication.It,new Rf.a(()=>A.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}uj._instance=null;Object(u.a)(uj,"MruActor",Bg,[]);class wg{constructor(){this.vRc=this.mBh=this.W=null;this.ii=!1;this.mQl=()=>{ph.a.instance.vf(this.Efj)};this.HNh=()=>{ph.a.instance.Zb(this.Efj)}}get name(){return"Common.App.NewAndOpen.Core"}wc(b){this.W=b;b.register(633,
"Common.INewAndOpenCommonHelpers").ha().Rd(()=>Vj.instance);b.register(636,"Common.IEventEmitter<Common.IGetMoreInfoResult>").ha().Rd(()=>ah.instance);b.register(636,"Common.IEventEmitter<Common.IMruResult>").ha().Rd(()=>uj.instance)}init(){A.AFrameworkApplication.K.Rn(()=>{this.w$a()})}w$a(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;Vj.instance.Hso();A.AFrameworkApplication.JMa&&
(b=!0);A.AFrameworkApplication.kqg&&(uj.instance.FHn(),0<A.AFrameworkApplication.Dfj&&this.HNh(),this.U_o(),b=!0);A.AFrameworkApplication.c0a&&b&&ah.instance.CHn();A.AFrameworkApplication.$xp&&(b=uj.instance,b.vwo(),b.UHn(),ph.a.instance.Zb(this.ayp))}U_o(){zh.instance.UMh(Object(z.a)(uj.instance,uj.instance.EHn,"makeGetMruRequestActivityTrigger"));zh.instance.UMh(this.HNh);zh.instance.WXk(this.mQl)}get Efj(){return this.mBh||(this.mBh=new Re.a(5,2,A.AFrameworkApplication.Dfj,Object(z.a)(uj.instance,
uj.instance.AAm,"getMruFromServerTask"),109))}get ayp(){return this.vRc||(this.vRc=new Re.a(2,2,6E4*A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(z.a)(uj.instance,uj.instance.VHn,"makeUpdateMruTask"),197))}dispose(){this.ii||(this.ii=!0,this.vRc&&(ph.a.instance.vf(this.vRc),this.vRc=null))}}Object(u.a)(wg,"CorePackageManager",null,[0,1,13]);var Ni=d(1630),Md=d(160);class nf{static X_l(b){return nf.xYh("New",b)}static Y_l(b){return nf.xYh("Open",
b)}static cYh(b,h){return nf.A6a("LoadingMenuSection",nf.cBn,b,nf.wUc("lblLoading",h))}static xUc(b,h,n=null,B=null){return nf.A6a("MessageMenuSection",nf.Bfj,h,nf.wUc("lblMessage",b,n,B))}static ygl(b){return nf.cYh(b,CommonUIStrings.l_VoicedLoadingText)}static zgl(b,h){return nf.xUc(CommonUIStrings.l_NewCreationLocationMessage,b.labelText,h.Wga,h.Oeb)}static xgl(b,h){return nf.xUc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.Oeb,"\n\n"),b.labelText)}static gYh(b){return nf.xUc(CommonUIStrings.l_NewGenericErrorMessage,
b.labelText)}static vgl(b,h,n){return nf.A6a("menuNewBlank",nf.l_m,n?b.labelText:null,nf.sUc(b.xOi,b.yOi,b.zOi,null,b.m$a,b.X6c,h,"blank"))}static qhl(){return nf.wUc("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static vYh(){return nf.wUc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static rhl(b,h){return nf.A6a("menuNewTemplates",b,null,h)}static tgl(b,h){return nf.A6a("menuNewMoreTemplates",nf.Hqi,null,nf.sUc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,
CommonUIStrings.l_NewMoreTemplates,null,null,null,b,h))}static mfl(b,h,n){let B="";n&&h&&(B=nf.A6a("BrowseMoreMenuSection",nf.Hqi,null,nf.sUc("btnBrowseMore",h,h,null,null,null,b||"1959943459",n)));return B}static wUc(b,h,n=null,B=null){let L=B;h&&0<h.length&&(L=nf.Ugj.Bwb(h).trimEnd(),L=0<=L.indexOf("{0}")?String.format(L,B):String.format("{0} {1}",L,B));n=n&&B?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',F.a.Hf(n),F.a.Hf(B),F.a.Hf(L)):
"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',F.a.Hf(b||""),nf.Ugj.Bwb(F.a.Hf(h||"")),n)}static sUc(b,h,n,B,L,ba,la,La){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',F.a.Hf(b||""),F.a.Hf(h||""),F.a.Hf(n||""),B||"32by32",F.a.Hf(L||""),
F.a.Hf(ba||""),la,F.a.Hf(La||""))}static xYh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',b,h)}static A6a(b,h,n,B){n=n?String.format('Title="{0}"',F.a.Hf(n)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',F.a.Hf(b||""),F.a.Hf(h||""),n,B)}}nf.Bfj="MenuMru";nf.cBn=
"MenuLoading";nf.l_m="MenuHeader";nf.Hqi="MenuFooter";nf.Ugj=Md.a.kE("\n","&#10;");Object(u.a)(nf,"NewAndOpenXmlUtilities",null,[]);class bn{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(u.a)(bn,"HostInformation",null,[]);class Wi{constructor(b,h,n,B,L,ba){this.PQc=this.hx=this.Nxd=null;this.ZMd=this.p9e=!1;this.Xuh=0;this.zYe=!1;this.Mqe=(la,La,fb,Cb,Lb)=>{if(1===fb)return 32;2!==fb||this.zYe||(this.Xuh=(new Date).getTime(),x.ULS.sendTraceTag(5849602,202,50,
"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.xze,["CachedNewMenuXmlExists"]:!!this.Nxd,["ShouldCallGetMoreInfo"]:this.eS.c0a}));return this.Bco(Lb)};this.aHa=b;this.yHc=h;this.S2a=new Rf.a(()=>new Ni.a(n.value,Object(z.a)(this,this.gQb,"getMoreInfoEventReceived")));this.aFk=B;this.Ojb=L;this.MNk=ba;this.PPc=this.xze;this.BFd=!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("GateTemplateRenderingByGetMoreInfoResponse");this.pCk=!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment1",
!1);this.Vqh=!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment2",!1)}get E6(){switch(this.eS.Fga){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Wb(){const b=this.eS.Vrc;b.ra(Pa.a.qle,id.a.frame,Object(z.a)(this,this.qle,"newDocument"));b.ra(Pa.a.Mqe,id.a.frame,this.Mqe)}qle(b,h,n,B,L){if(1===n)return 32;if(2===n&&L){if(A.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&
L.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),A.AFrameworkApplication.va.Ob(Pa.a.feo,2);if(L.MenuItemId&&L.SourceControlId)return"NewDocumentHome"===L.SourceControlId&&Pe.a("NewDocumentFromHomeTab"),this.SXc(L.MenuItemId,L.SourceControlId)}return 8}SXc(b,h){var n=this.tle.mai;if(null===n)return 8;var B=A.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const L=A.AFrameworkApplication.Rtb;"blank"===b&&this.Mmn()&&(x.ULS.sendTraceTag(508687196,
202,50,"Updating blank document id with new template id for appId={0}",this.E6),b="blankNew");if(L&&B){x.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const ba={};ba[I.a.template]=b;ba[I.a.E6]=this.E6;ba[I.a.lcid]=A.AFrameworkApplication.lcid.toString();ba[I.a.reason]=jk.a.huf;ba[I.a.uiCulture]=A.AFrameworkApplication.uiCulture;ba[I.a.dataCulture]=A.AFrameworkApplication.dataCulture;A.AFrameworkApplication.IR().execute(la=>{la.sendMessage(H.a.SXc,
ba)})}else B=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",n,F.a.ej(this.JMa),F.a.ej(b),F.a.ej(this.E6),F.a.ej(A.AFrameworkApplication.lcid.toString()),F.a.ej(B.toString()),F.a.ej(h),F.a.ej(A.AFrameworkApplication.bN),A.AFrameworkApplication.jm),(n=A.AFrameworkApplication.K.kb("ScenarioId"))&&""!==n&&(h+="&wdscenarioid="+F.a.ej(n)),h+="&"+A.AFrameworkApplication.u9d(),A.AFrameworkApplication.DXa&&
(h+="&"+A.AFrameworkApplication.Z7d()),(n=this.hx?this.hx.Wga:null)?h+="&DestinationUrl="+F.a.ej(n):3===this.eS.Fga&&this.eS.c0a&&x.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),$c.a.yn(h,"_blank",void 0,"CreateNewDocument");2!==this.eS.Fga&&3!==this.eS.Fga||x.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Bj.a[this.eS.Fga],["Template"]:b});A.AFrameworkApplication.K&&A.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&
1===this.eS.Fga&&("blank"===b||"blankNew"===b?Pe.b("ConsumerTemplateNewBlank"):(b=[Object.assign(new ia.a,{name:"TemplateId",string:b})],Pe.b("ConsumerTemplateNew",null,0,!0,0,b)));return 32}Mmn(){let b=!1;switch(this.eS.Fga){case 3:b=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultsUpdate",!1);break;case 2:b=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTODefaultThemeChange",!1);break;case 1:b=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",
!1)}return b}HFn(b){let h=Number.MAX_VALUE,n=Number.MIN_VALUE;const B=window.performance;if(B&&"undefined"!==typeof B.getEntriesByName){for(let ba=0;ba<b.length;ba++){var L=B.getEntriesByName(b[ba]);L&&0<L.length&&(L=L[0],h=Math.min(parseInt(String(L.fetchStart)),h),n=Math.max(parseInt(String(L.responseEnd)),n))}n>h&&x.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:n-h,["MinFetchStart"]:h,["MaxResponseEnd"]:n})}}Bco(b){b&&(this.Nxd?b.PopulationXML=
this.Nxd:(this.eS.c0a&&!this.hx&&this.aQn.HR("Opened New menu",!0),b.PopulationXML=this.Bfm(this.$Ii())));return 32}C1i(){return!this.eS.c0a||!!this.hx&&3===this.hx.state&&!!this.hx.Oeb&&!!this.hx.Wga}t0f(){return A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.LXa&&!this.BFd?!0:this.C1i()}$Ii(){if(!this.xze&&!this.BFd&&!this.t0f())return null;if(this.PPc&&!this.ZMd){let h=!1;var b="9";const n=A.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in n&&(b=n.NumberOfTemplatesInBackstage);
let B=this.E6;"TemplateCollectionId"in n&&(B=n.TemplateCollectionId);this.pCk&&(B="WordConsumerWAC",b="10");this.Vqh&&(B="WordConsumerWAC",b="10",h=!0);b=String.format(this.eS.HYa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",F.a.ej(A.AFrameworkApplication.lcid.toString()),F.a.ej(B),b);Boolean.parse(n.AppendOriginQueryParam||"false")&&(b+="&org=backstage");Boolean.parse(n.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in n&&(b+="&templateTier="+n.TemplateTier);this.Vqh&&
(b+="&col=officetemplateswordonlinestartexp2");b=h?b+"&p=1":b+"&p=0";b+="&"+A.AFrameworkApplication.u9d();A.AFrameworkApplication.DXa&&(b+="&"+A.AFrameworkApplication.Z7d());this.eS.jed.Ij(b,1,null,null,!1,2,L=>{this.eS.mYa("CreateNewActor.GetTemplateListJson",L.data);this.hip(L.data.De)},L=>{this.eS.mYa("CreateNewActor.GetTemplateListJson",L.data);this.gip()},null,void 0,void 0,void 0,void 0,"5");this.PPc=!1}return this.PQc}hip(b){this.PQc=b;this.PPc=!1;this.ekd();this.BFd?this.t0f()?this.uyf():
this.hx&&(x.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),this.tyf()):this.uyf()}uyf(){if(A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.LXa&&kh.c()){const b=A.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),h=A.AFrameworkApplication.Rtb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.PQc,!0,b&&h));3===this.eS.Fga&&x.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}gip(){this.ZMd=
this.PPc=!0;this.ekd();this.tyf();oa.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}tyf(){A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.LXa&&kh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.eS.Fga&&x.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}jPf(b){var h=0;for(var n=0;n<b.length;n++)if("ST"===b[n].ImageType){h=n;break}const B=b.length?b[h]:null;b=B?B.Url||
"":"";var L;let ba=n=h=!1;if(B&&(L=B.AspectRatio))L=parseFloat(L),1>L?h=!0:1.5<L?n=!0:1===L&&(ba=!0);else switch(x.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),this.eS.Fga){case 3:h=!0;break;case 2:n=!0;break;case 5:ba=!0}return{returnValue:b,u3m:h?"95by123":n?"123by69":ba?"100by100":"123by95"}}Bfm(b){b=({bze:h}=this.wgl(b,this.tle,this.tle.AUc||"1056925771")).returnValue;if(h){this.Nxd=b;var h=(new Date).getTime()-this.Xuh;x.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",
{["ElapsedMsSinceMenuOpened"]:h})}return b}gQb(b,h){x.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.hx||3!==b.state?2===b.state&&(x.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.p9e=!0,this.ekd()):(this.hx=b,h||this.ekd(),A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.LXa&&kh.c()&&kh.d("setFileMenuHostInformation")&&(b=Object.assign(new bn,{hostUrl:this.hx.Wga,hostName:this.hx.Oeb,folderUrl:A.AFrameworkApplication.breadcrumbFolderUrl,
folderName:A.AFrameworkApplication.breadcrumbFolderName}),x.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b)),this.BFd&&this.PQc&&this.PQc.length&&(this.t0f()?this.uyf():this.tyf(),x.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}wgl(b,h,n){let B;B=!1;const L=this.C1i();let ba="";this.eS.c0a&&(this.p9e?(ba=nf.gYh(h),this.p9e=!1,x.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):
this.hx?L?ba=nf.zgl(h,this.hx):this.hx.Wan?(B=!0,this.PPc=!1,ba=nf.xgl(h,this.hx),x.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(B=!0,ba=nf.gYh(h),x.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.hx.Wga,["StorageServiceDisplayNameIsSet"]:!!this.hx.Oeb})):(ba=nf.ygl(h.labelText),x.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));
L&&(ba+=nf.vgl(h,n,!ba)+({bze:B}=this.phl(b,n)).returnValue);return{returnValue:nf.X_l(ba),bze:B}}phl(b,h){let n;n=!1;if(!this.xze)return n=!0,x.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",bze:n};let B="",L="",ba="MenuTemplate";if(this.ZMd)B=nf.vYh(),this.ZMd=!1,x.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const la=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);B=this.ohl(la,
h);x.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");A.AFrameworkApplication.Vgj&&"OneDrive"===this.JMa&&(L=nf.tgl(this.bQn,A.AFrameworkApplication.Vgj))}catch(la){x.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),B=nf.vYh()}n=!0}else ba="MenuLoading",B=nf.qhl(),x.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:nf.rhl(ba,B)+L,bze:n}}ohl(b,h){let n="";
const B=[];for(let ba=0;ba<b.length;ba++){var L=b[ba];let la="";if(L){const La=L.Title,fb=L.AssetId;L=L.Thumbnails;fb&&La&&L&&({u3m:L,returnValue:la}=this.jPf(L),n+=nf.sUc("jbtnNewTemplate"+ba,La,null,L,null,la,h,fb))}B[ba]=la}b=new Re.a(4,1,5E3,()=>{this.HFn(B)},106);this.eS.ole.Zb(b);return n}ekd(){this.zYe=!0;this.eS.Jgj.GPa(this.tle.j1c);this.zYe=!1}get eS(){return this.aHa.value}get tle(){return this.yHc.value}get aQn(){return this.S2a.value}get bQn(){return this.aFk.value}get JMa(){return this.Ojb.value}get xze(){return this.MNk.value}}
Object(u.a)(Wi,"CreateNewActor",null,[]);class ee{constructor(){this._initialized=!1;this.x$e={}}kD(b){this.nli();return this.get(b)}contains(b){this.nli();return b.toString()in this.x$e}nli(){this._initialized||(this.yZk(),this._initialized=!0)}amb(b,h){this.x$e[b.toString()]=h}get(b){return this.x$e[b.toString()]}}Object(u.a)(ee,"AIntlHelper",null,[]);class qd extends ee{constructor(){super()}yZk(){this.amb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.amb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.amb(2,CommonUIStrings.l_Open);this.amb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.amb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.amb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return qd._instance||(qd._instance=new qd)}static z5n(b){return qd.instance.kD(b)}}qd._instance=null;Object(u.a)(qd,"MruActorIntlHelper",ee,[]);var Il;(function(b){b[b.success=0]="success";b[b.Zj=1]="failure";b[b.V0b=2]="spinner";b[b.none=3]="none"})(Il||(Il={}));Object(u.b)("DisplayState",Il);
class Vg{constructor(b,h,n,B,L,ba,la,La){this.rMe=null;this.edf=!0;this.Mxd="";this.LQk=0;this.T8b=null;this.d_e=3;this.Hlg=(fb,Cb,Lb,$b,tc)=>1!==Lb&&tc?this.zco(tc):32;this.Ga=La;this.aHa=b;this.Dya=h;this.uvk=n;this.wpk=B;this.vpk=L;this.S2a=new Rf.a(()=>new Ni.a(ba.value,null));this.hxk=new Rf.a(()=>new Ni.a(la.value,Object(z.a)(this,this.vOn,"mruEventResultReceived")));this.Ga.$("WacInTabOpenMRUIsEnabledForUiHost");this.Ga.$("UiHostSupportsDocRebootFeatures")}vOn(b,h){this.T8b=b;h||this.lAj()}xvo(){this.EP.Vrc.fb(Pa.a.Hlg,
id.a.frame,this.Hlg,96)}zco(b){this.I0l();this.H0l();b.PopulationXML=nf.Y_l(this.Mxd+this.rMe);return 32}I0l(){var b=3;let h=!1;if(this.Mxd&&this.LQk===this.T8b.ekp)x.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.d_e;else{x.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var n=this.EP.Yp();this.T8b=this.uOn.HR("File Open opened",!0);this.Mxd&&2!==
this.d_e&&3!==this.T8b.state?h=!0:(b=this.uKm(this.T8b),A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.LXa&&kh.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.Mxd=({TPn:b}=this.Dfm(this.T8b)).returnValue);n=this.EP.Yp()-n;x.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:n})}2!==b&&(n={["DisplayState"]:Il[b]},1!==b&&(n.IsStale=h),x.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",
n));this.d_e=b}uKm(b){let h;try{h=D.c(b.f$f)}catch(n){h=null,x.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",n)}return h}H0l(){this.edf?(x.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.rMe=({dFp:this.edf}=this.zHn()).returnValue):x.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");x.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.edf,
["NotDisplayingLink"]:!this.rMe})}Dfm(b){let h;1===b.state||0===b.state?(x.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,h=nf.cYh(this.S9a(2),this.S9a(5))):3===b.state&&b.f$f?(h=this.ugl(b.f$f),b=0):(x.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=nf.xUc(this.S9a(1),this.S9a(2)),b=1);return{returnValue:h,TPn:b}}ugl(b){let h;const n=this.xdd.AUc||"2155708348";if(b.length){h=nf.wUc("lblRecentDocuments",this.S9a(3));
let B=0;for(let L=0;L<b.length;L++){const ba=b[L];"FileName"in ba&&"DocumentUrl"in ba&&"Path"in ba&&(h+=nf.sUc("MruButton"+L,ba.FileName.toString(),ba.Path.toString(),null,this.xdd.m$a,this.xdd.X6c,n,ba.DocumentUrl.toString()),ba.IsPinned&&B++)}h=nf.A6a("RecentDocumentsMenuSection",nf.Bfj,this.S9a(2),h);x.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:B})}else h=nf.xUc(this.S9a(0),this.S9a(2)),x.ULS.sendTraceTag(5849664,
202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}zHn(){let b;b=!0;let h=this.Fel;var n=this.Eel;if(h&&n||!this.EP.c0a)b=!1;else{const B=this.c8d.HR("File Open",!1);3===B.state&&(h=B.Wga,n=B.Oeb,b=!1)}n=n?String.format(this.S9a(4),n):null;return{returnValue:nf.mfl(this.xdd.AUc,n,h),dFp:b}}lAj(){this.EP.Jgj.GPa(this.xdd.j1c)}get EP(){return this.aHa.value}get S9a(){return this.Dya.value}get xdd(){return this.uvk.value}get Fel(){return this.wpk.value}get Eel(){return this.vpk.value}get c8d(){return this.S2a.value}get uOn(){return this.hxk.value}}
Object(u.a)(Vg,"MruRenderer",null,[]);var oi=d(1634);class Ah{constructor(b,h,n,B,L,ba,la){this.hx=null;this.ODh=!1;this.pxa=this.r5=0;this.gQb=La=>{if(!this.hx&&3===La.state)this.hx=La;else if(2===La.state){this.ODh?x.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.c8d.HR("NewDocumentFromStream",!0),this.ODh=!0);return}this.kuf()};this.WPn=La=>{if(La&&La.data&&La.data.De)if(({Zu:fb}=D.d(La.data.De)).returnValue)if(La=fb,La.StatusCode!==ja.a.zz&&La.StatusCode!==
ja.a.jgc)x.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.E6,this.pxa,La.StatusCode),this.v9b(null);else if(La.NewDocumentUrl&&""!==La.NewDocumentUrl){var fb=(new Date).getTime()-this.r5;x.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.E6,this.pxa,fb);this.rFk(La.NewDocumentUrl)}else x.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",
this.E6,this.pxa),this.v9b(null);else x.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.E6,this.pxa,{["ResponseData"]:oi.a.Isd(La.data.De)}),this.v9b(null);else x.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.E6,this.pxa),this.v9b(null)};this.VPn=La=>{La&&La.data&&x.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",
this.E6,this.pxa,La.data.status);this.v9b(null)};this.rFk=b;this.v9b=h;this.FHd=n;this.yHc=B;this.Ojb=L;this.aHa=ba;this.S2a=new Rf.a(()=>new Ni.a(la.value,this.gQb))}SXc(){!this.hx&&this.Jbg.c0a?this.c8d.HR("NewDocumentFromStream",!0):this.kuf()}kuf(){this.r5=(new Date).getTime();var b=this.i7l.mai;if(null===b)this.v9b(null);else{var h=this.FHd.menuItemId,n=this.FHd.HOa,B=this.FHd.Gdp,L=this.FHd.q7l;this.pxa="streamBase64"===B?L.length/1024:0;x.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",
this.E6,this.pxa);var ba=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",b,F.a.ej(this.JMa),F.a.ej(h),F.a.ej(this.E6),F.a.ej(A.AFrameworkApplication.lcid.toString()),F.a.ej(ba.toString()),F.a.ej(n),F.a.ej(A.AFrameworkApplication.bN),A.AFrameworkApplication.jm,F.a.ej(B));b+="&"+A.AFrameworkApplication.u9d();A.AFrameworkApplication.DXa&&(b+="&"+A.AFrameworkApplication.Z7d());(h=this.hx?this.hx.Wga:null)&&(b+=
"&DestinationUrl="+F.a.ej(h));this.Jbg.jed.Ij(b,2,L,{"Content-Type":"application/json; charset=utf-8"},!0,2,this.WPn,this.VPn,null,void 0,void 0,void 0,void 0,"31")}}get E6(){switch(this.Jbg.Fga){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get i7l(){return this.yHc.value}get JMa(){return this.Ojb.value}get Jbg(){return this.aHa.value}get c8d(){return this.S2a.value}}Object(u.a)(Ah,"NewDocumentFromStreamOperation",null,[]);class ag{constructor(b,
h,n,B){this.yHc=b;this.Ojb=h;this.aHa=n;this.gxk=B}create(b,h,n){return new Ah(b,h,n,this.yHc,this.Ojb,this.aHa,this.gxk)}}Object(u.a)(ag,"NewDocumentFromStreamOperationFactory",null,[773]);var Cg=d(143);class Sg{get name(){return"Common.App.NewAndOpen.UX"}wc(b){b.register(ag,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ha().Rd(()=>new ag(new Rf.a(()=>A.AFrameworkApplication.ua.Ib.UJf()),new Rf.a(()=>A.AFrameworkApplication.JMa),
new Rf.a(()=>b.Oa("Common.INewAndOpenCommonHelpers")),new Rf.a(()=>b.Oa("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){A.AFrameworkApplication.K.Rn(()=>{this.w$a()})}w$a(){const b=Di.a.$p(Ya.a.instance.Qa("Common.INewAndOpenCommonHelpers")),h=Di.a.$p(Ya.a.instance.Qa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));A.AFrameworkApplication.JMa&&Cg.Task.WAA.call(null,b,h).continueWith(()=>{const n=new Wi(new Rf.a(()=>b.result),new Rf.a(()=>A.AFrameworkApplication.ua.Ib.UJf()),new Rf.a(()=>
h.result),new Rf.a(()=>A.AFrameworkApplication.ua.Ib.VJf().AUc||"1959943459"),new Rf.a(()=>A.AFrameworkApplication.JMa),new Rf.a(()=>A.AFrameworkApplication.Nmn));n.Wb();n.ekd()});if(A.AFrameworkApplication.kqg){const n=Di.a.$p(Ya.a.instance.Qa("Common.IEventEmitter<Common.IMruResult>"));Cg.Task.WAA.call(null,b,h,n).continueWith(()=>{const B=new Vg(new Rf.a(()=>b.result),new Rf.a(()=>qd.z5n),new Rf.a(()=>A.AFrameworkApplication.ua.Ib.VJf()),new Rf.a(()=>A.AFrameworkApplication.y5n),new Rf.a(()=>A.AFrameworkApplication.x5n),
new Rf.a(()=>h.result),new Rf.a(()=>n.result),A.AFrameworkApplication.K);B.xvo();B.lAj()})}}dispose(){}}Object(u.a)(Sg,"UXPackageManager",null,[0,1,13]);var ui=d(188);class ck extends ui.StandardDialog{constructor(){super();this.Gd=0;this.Pe(1,CommonUIStrings.l_DialogClose)}jR(b){this.Gy(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}Cyf(b){this.Gy(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(u.a)(ck,"ErrorDialog",
ui.StandardDialog,[756]);var Zf=d(356);class ij{Jti(){x.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new Zf.a;b.gg("api.onedrive.com");return b.task}}Object(u.a)(ij,"OneDriveConsumerEndpointHelper",null,[713]);var mj=d(50);class Jl{constructor(b,h,n,B){this.nGb=this.UMa=null;this.L8e=this.N8e=!1;this.I9b=null;this.Ga=b;this.u4b=h;this.rFb=n;this.vJ=B}get eSh(){return this.u4b}get K(){return this.Ga}Gkc(){this.I9b||(this.I9b=this.gtc?cb.a.create(this.gtc,null,null,null,!1):
null);return this.I9b}setup(b){this.nGb=b;this.N8e||this.L8e?this.N8e&&this.nGb&&this.nGb(!0):(b=this.Gkc())?(this.L8e=!0,b.jbb.continueWith(h=>{this.E_n(h)}),ab.a.D_(b)):(x.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.nGb(!1))}Vfg(b){x.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.vk?b.vk.toString():"No error detail.")}E_n(b){this.L8e=!1;if(b.ij)this.Vfg(b),this.nGb(!1);else try{this.N8e=!0,x.ULS.sendTraceTag(17909022,
352,50,"Initializing OneDrive API"),this.mVf(),x.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.nGb(!0)}catch(h){x.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.nGb(!1)}}Iqd(b){this.UMa=b;this.rFb?x.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(x.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,this.Sdg,"onApiReady")))}Sdg(b){b?this.Ihe():
this.qq()}qq(){this.vJ().jR(mj.a.C4n)}BE(b){x.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.UMa&&this.UMa(!0,b)}dispose(){this.I9b&&this.I9b.dispose()}}Object(u.a)(Jl,"AOneDriveFilePickerApiManager",null,[779,13]);class Xi extends Jl{constructor(b,h,n,B,L,ba){super(h,n,B,ba);this.zh=null;this.xya=b;this.UNk=L}get gtc(){return this.K.kb("OneDriveApiUrl")}start(b,h){this.zh=b;this.Iqd(h)}mVf(){WL.init(1===this.eSh||2===this.eSh?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:
{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}Iqd(b){this.UMa=b;!this.rFb&&this.xya.I8c?(x.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(z.a)(this,this.Sdg,"onApiReady"))):(x.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.UNk())}Ihe(){try{x.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.zh).then(Object(z.a)(this,this.BE,"onSuccess"),Object(z.a)(this,
this.onFailure,"onFailure"))}catch(b){x.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.qq()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){x.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}x.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,b.error.message)}else x.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.UMa&&this.UMa(!1,
b);this.qq()}}Object(u.a)(Xi,"OneDriveFilePickerApiManagerV5",Jl,[]);class Sh extends Jl{constructor(b,h,n,B,L){super(b,h,n,B);this.eDd=this.Wxh=null;this.sDe=()=>{this.eDd.style.visibility="hidden"===this.eDd.style.visibility?"":"hidden"};this.Fuk=L;this.options={};this.options.clientId=this.K.kb("OneDriveApiV7ClientId");this.options.cancel=this.sDe}get gtc(){return this.K.kb("OneDriveApiV72Url")}start(b,h){this.eDd=h;const n=this.Fuk.Jti();n.continueWith(()=>{x.ULS.sendTraceTag(24134241,352,50,
"Fetch endpoint task completed, attempting to start OneDrive picker");this.Wxh=n.result;this.Iqd((B,L)=>{this.sDe();b(B,L)})},3);n.continueWith(()=>{x.ULS.sendTraceTag(24134242,352,15,n.vk.message);this.sDe()},5)}mVf(){this.options.success=b=>{const h={};h.data=b;this.BE(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Wxh;this.options.advanced.iframeParentDiv=this.eDd}Ihe(){try{x.ULS.sendTraceTag(22090007,
352,50,"Launching OneDrive file picker dialog"),this.sDe(),OneDrive.open(this.options)}catch(b){x.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.qq()}}onFailure(b){this.UMa&&this.UMa(!1,b);this.qq()}}Object(u.a)(Sh,"OneDriveFilePickerApiManagerV7",Jl,[]);class Vk extends Jl{constructor(b,h,n,B){super(b,h,n,B);this.Qnk=b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.kb("OneDriveApiV72ClientId");
this.options.advanced.trapFocus=!0}get gtc(){return this.K.kb("OneDriveApiV72Url")}start(b,h,n,B){this.options.advanced.iframeParentDiv=n;this.options.advanced.endpointHint=B;this.options.cancel=h;this.Qnk.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.Iqd(b)}Iqd(b){this.UMa=b;this.rFb?x.ULS.sendTraceTag(24391838,
216,50,"In limited edit mode, will not show Picker."):(x.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,this.Sdg,"onApiReady")))}mVf(){this.options.success=b=>{const h={};h.data=b;this.BE(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}Ihe(){try{x.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){x.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",
b.message,b.stack),this.qq()}}Vfg(b){x.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.vk?b.vk.toString():"No error detail.");ab.a.vzo(this.gtc);this.I9b=null}qq(){this.vJ().Cyf(mj.a.tKo)}onFailure(b){this.UMa&&this.UMa(!1,b)}}Object(u.a)(Vk,"OneDriveFilePickerApiManagerV72",Jl,[]);class nj{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(u.a)(nj,"IExtraData",null,[]);class dk extends Vk{constructor(b,h,n,B){super(b,h,n,B);this.options.advanced.filter=
b.kb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=A.AFrameworkApplication.qSh;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.kb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new nj(A.AFrameworkApplication.userSessionId))}get gtc(){return this.K.kb("OneDriveApiV72Url")}Ihe(){try{x.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",
this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",A.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){x.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.qq()}}}Object(u.a)(dk,"OneDriveFilePickerApiOpenManagerV72",Vk,[]);class mm{constructor(b){this.Sq=null;this.qAm=h=>{if(h.data.He===ja.a.A8&&"X-NewKey"in h.data.vi){x.ULS.sendTraceTag(24134236,
352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const n={};n["X-Key"]=h.data.vi["X-NewKey"];this.byg(n)}else 0<this.g7e?(x.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.g7e),this.g7e--,this.byg()):(x.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Sq.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};
this.sAm=h=>{"PersonalFileStorageUrl"in h.data.vi&&""!==h.data.vi.PersonalFileStorageUrl?(x.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Sq.gg(h.data.vi.PersonalFileStorageUrl)):(x.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Sq.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};this.Af=b;this.g7e=3}Jti(){this.Sq=new Zf.a;x.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");
this.byg();return this.Sq.task}byg(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",A.AFrameworkApplication.QMb);this.Af.X5a(h,1,null,b,["PersonalFileStorageUrl","X-NewKey"],2,this.sAm,this.qAm,void 0,void 0,void 0,void 0,"21")}}Object(u.a)(mm,"OneDriveForBusinessEndpointHelper",null,[713]);var Ai=d(815);class nm{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}wc(b){this.W=b;this.W.register(Xi,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ha().Rd(()=>
new Xi(Ai.a.instance,A.AFrameworkApplication.K,A.AFrameworkApplication.Paa,A.AFrameworkApplication.iua,A.AFrameworkApplication.$Dg,()=>new ck));A.AFrameworkApplication.Htb?this.W.register(713,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().Rd(()=>new ij):this.W.register(713,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().Rd(()=>new mm(A.AFrameworkApplication.Be));this.W.register(Sh,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ha().Rd(()=>
new Sh(A.AFrameworkApplication.K,A.AFrameworkApplication.Paa,A.AFrameworkApplication.iua,()=>new ck,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(Vk,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ha().Rd(()=>new Vk(A.AFrameworkApplication.K,A.AFrameworkApplication.Paa,A.AFrameworkApplication.iua,()=>new ck));this.W.register(dk,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ha().Rd(()=>new dk(A.AFrameworkApplication.K,
A.AFrameworkApplication.Paa,A.AFrameworkApplication.iua,()=>new ck))}static main(){M.a.instance.Jc(new nm)}}Object(u.a)(nm,"PackageManager",null,[0,1]);class rm{constructor(b,h,n,B,L,ba){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=n;this.PolicyCookieTTL=B;this.WasServiceDown=L;this.AffinitizedUrl=ba}}Object(u.a)(rm,"SafeLinksData",null,
[]);class qi{constructor(b,h){this.uCe=b;this.vz=h}}Object(u.a)(qi,"SafeLinksGetUrlReputationRequestData",null,[]);class Yi{constructor(b,h,n,B){this.qYn=L=>{let ba="OnGetUrlReputationSuccessCallback: ",la=10;const La=L.data.state;try{const fb=D.b(L.data.De).reputationResults[0],Cb=fb.navigateUrl.length,Lb=La.uCe.length,$b=fb.navigateUrl===La.uCe;fb.navigateUrl&&0<fb.navigateUrl.length&&(La.uCe=fb.navigateUrl);ba+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",
L.data.He,fb.verdict,Lb.toString(),Cb.toString(),$b.toString());la=50}catch(fb){ba+=String.format("Exception {0}",fb.message)}this.CMi(La,ba,la)};this.pYn=L=>{let ba="OnGetUrlReputationFailureCallback: ";const la=L.data.state;try{ba+=String.format("HttpStatus {0}",L.data.He)}catch(La){ba+=String.format("Exception {0}",La.message)}this.CMi(la,ba,10)};this.Ga=b;this.Af=h;this.Bxk=n;Yi.Vd=B}JAc(b,h,n){try{var B=null;Yi.Vd&&(B=Yi.Vd.Vf("WebServiceCall","SafeLinksGetUrlReputation"));const L=new qi(h,B);
B={};B.AffinitizedUrl=b;B.TargetUrl=h;B.PolicyCookie=n;const ba=D.c(B);this.Af.Ij(this.Bxk,2,ba,null,!1,2,this.qYn,this.pYn,L,void 0,void 0,3E3,3E3,"36");return!0}catch(L){x.ULS.sendTraceTag(588788033,378,10,L.message)}return!1}CMi(b,h,n){b.vz&&(b.vz.stop(),b.vz=null);x.ULS.sendTraceTag(588788034,378,n,h);$c.a.yn(b.uCe,void 0,"noopener,noreferrer","SafeLinksNav")}}Yi.Vd=null;Object(u.a)(Yi,"SafeLinksNavigationHelper",null,[]);var Zl;(function(b){b[b.aZp=0]="enabledByPolicy";b[b.wUl=1]="disabledByPolicy";
b[b.SXp=2]="disabled_GetPolicyFailure";b[b.TXp=3]="disabled_PendingGetPolicyRequest"})(Zl||(Zl={}));Object(u.b)("SafeLinksNavigationState",Zl);class Qi{constructor(b,h,n,B=!1,L=null,ba=null){this.TDb=this.SDb=0;this.B9c=this.yCd=!1;this.hkb=null;this.A8b=!0;this.tMd=null;this.lJm=fb=>{let Cb=ja.a.qRn,Lb="";try{this.yCd=this.B9c=!1;var $b=fb.data.state;const De=({vz:$b}=this.lBe($b)).returnValue,gg=Object.assign(new rb.a,{durationMs:De});oa.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",
gg);x.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",fb.data.He,fb.data.De.length,De);if(fb.data.He!==ja.a.zz)Lb="Unexpected httpStatus: "+fb.data.He.toString();else{$b=null;try{$b=D.b(fb.data.De)}catch(eg){Lb="Exception:"+eg.toString()+" deserializing response";return}if($b){var tc=$b.IsSafeLinksEnabled;if(void 0===tc||null===tc||0>=tc.length)Lb="Invalid isSafeLinksEnabledString";else{x.ULS.sendTraceTag(594830613,378,
50,"Retrieved isSafeLinksEnabledString {0}",tc);var Nc=Qi.Zjg(tc);if(void 0===$b.WebAffinitizedUrl||null===$b.WebAffinitizedUrl||0>=$b.WebAffinitizedUrl.length)Lb="Invalid WebAffinitizedUrl";else if(void 0===$b.PolicyCookie||null===$b.PolicyCookie||0>=$b.PolicyCookie.length)Lb="Invalid PolicyCookie";else if(void 0===$b.PolicyCookieTTL||null===$b.PolicyCookieTTL)Lb="Invalid PolicyCookieTTL";else{var dd=$b.WebAffinitizedUrl,Hd=$b.PolicyCookie,xe=$b.AffinitizedUrl,je=new Date;je.setMinutes(je.getMinutes()+
(5<$b.PolicyCookieTTL?$b.PolicyCookieTTL-5:0));var he=je.getTime(),fe=new rm(tc,dd,Hd,he,!1,xe);this.OMj(fe);Cb=fb.data.He;this.hkb&&(Nc?(this.i4j(this.hkb),this.TDb=this.SDb=0):(x.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),oa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),$c.a.Wpb(this.hkb)),this.hkb=null)}}}else Lb="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(De){Lb=
"GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+De.toString()}finally{Cb!==ja.a.zz&&this.BMi(Cb,Lb)}};this.kJm=fb=>{this.yCd=!1;let Cb=500,Lb="";try{let $b=fb.data.state;const tc=({vz:$b}=this.lBe($b)).returnValue,Nc=Object.assign(new rb.a,{durationMs:tc});Cb=fb.data.He;oa.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+Cb.toString(),!1,!0,Nc);Lb="Request Failed, Status="+Uj.a[fb.data.status]+" Duration: "+tc}catch($b){Lb="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+
$b.toString()}finally{this.BMi(Cb,Lb)}};x.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.Ga=b;this.Af=h;this.eQa=n;Qi.Vd=ba;this.KSk=B?this.Ga.kb("SafeLinksHandlerWebServiceBase"):this.Ga.kb("WebServiceBase");this.gSk=this.Ga.kb("SafeLinksHashedUserId");this.zJp=this.Ga.kb("SafeLinksWorkloadIdHeaderValue");this.TGd=this.Ga.ic("SafeLinksMaxGetPolicyBootRetries",2);this.UGd=this.Ga.ic("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.JEd=this.jqn();this.IEd=this.iqn();Qi.kKh=
this.Ga.kb("UserPrincipalName")||"";Qi.QQc=this.Ga.kb("TenantId")||"";x.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.JEd,this.IEd);if(this.JEd&&this.IEd){h=(b=this.zqb())?b.IsSafeLinksEnabled.toLowerCase():"";n=this.Z_f();x.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,n);var la=!b||"unknown"===h||b.WasServiceDown||n,La=nb.a.KG();La&&(La.set("shouldGetSafeLinksDataFromServer",
la.toString()),La.set("isSafeLinksEnabledCacheValue",h.toString()));L?(this.A8b=!1,L.execute(fb=>{fb.isFeatureEnabled("MsoUrlreputation",!0).then(Cb=>{this.A8b=Cb;La.set("isUserLicensedForSafeLinks",this.A8b.toString());oa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",La);this.A8b&&la&&this.o9d(!0);return null})})):(oa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",La),la&&this.o9d(!0))}}get appName(){return this.eQa}get MGe(){return this.KSk}get userId(){return this.gSk}get fKi(){try{if(""===
Qi.aUe){const b={};b["X-AppName"]=this.appName;b["X-AppVersion"]=A.AFrameworkApplication.buildVersion;b.OS=this.Ga.kb("PlatformNameAndVersion")||"";const h=JSON.stringify(b);Qi.aUe=window.self.btoa(h)}}catch(b){x.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",b.message)}return Qi.aUe}get OFm(){const b=this.MGe?this.MGe+"/":"",h=new ub.QueryStringBuilder("SafeLinksHandler.ashx");h.ze("app",this.appName);this.Ga.$("SafeLinksUseDebugHeader")&&h.ze("action","debug");
this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.ze("s2satpop","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.ze("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),A.AFrameworkApplication.jm)}get ZPm(){const b=this.MGe?this.MGe+"/":"",h=new ub.QueryStringBuilder("SafeLinksHandler.ashx");h.ze("app",this.appName);this.Ga.$("SafeLinksUseDebugHeader")&&h.ze("action","debug");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",
!1)&&h.ze("s2satpop","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.ze("s2saat","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.ze("s2se03","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&h.ze("sladpar",this.fKi);h.ze("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,h.toString(),A.AFrameworkApplication.jm)}get yPn(){Qi.L7e||(Qi.L7e=new Yi(this.Ga,
this.Af,this.ZPm,Qi.Vd));return Qi.L7e}JAc(b){if(!b)return x.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var h=this.nkn(b);x.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",h,this.JEd,this.IEd,this.A8b);if(!(h&&this.JEd&&this.IEd&&this.A8b))return!1;h=0;const n=({state:h}=this.K4o()).returnValue;x.ULS.sendTraceTag(595079385,378,
50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",Zl[h]);const B=nb.a.KG();B&&B.set("SafeLinksNavigationState",Zl[h]);oa.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",B);if(!n)return 2!==h&&3!==h||oa.Health.instance.recordKpiFailure("SafeLinksNavigations",Zl[h],!1,!0,null),!1;x.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");if(this.h5o())return this.Z_f()?!1:this.yPn.JAc(this.Igm(),b,this.UEi());if(!this.Z_f())return this.i4j(b),
!0;this.hkb=b;x.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.B9c=!1;this.o9d();return!0}nkn(b){b=b.toLowerCase();const h=this.Ga.iD("SafeLinksUnsupportedProtocols");if(h)for(let n=0;n<h.length;n++)if(b.startsWith(h[n]))return!1;return!0}o9d(b=!1){var h=nb.a.KG();h&&h.set("isOnBootRequest",b.toString());oa.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",h);oa.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",
0,"jpittsdirects",h);h=this.atf("SafeLinksGetPolicy");this.Af.Ij(this.OFm,1,null,null,!0,2,this.lJm,this.kJm,h,void 0,void 0,void 0,void 0,"23");this.B9c=b;this.yCd=!0;b?this.SDb++:this.TDb++}BMi(b,h=""){try{if(x.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.SDb<this.TGd&&this.TDb<this.UGd)this.o9d(this.B9c);else{this.B9c=!1;x.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.SDb,this.TDb,b,h);h=null;const n=nb.a.KG();n&&(n.set("HttpStatus",b.toString()),h=Object.assign(new rb.a,{extendedProperties:n}));oa.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const B=new rm("false","","",0,!0,"");this.OMj(B);this.hkb&&(x.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),oa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),$c.a.Wpb(this.hkb),this.hkb=null)}}catch(n){x.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",n.toString())}}i4j(b){const h=this.UEi(),n=this.nRm(),B={};B.Url=b;B.SafeLinksCookie=h;B.CorrelationId=yb.a.create().toString();B.WorkloadId=this.zJp;B.UserAgentInfo=X.a.eE+"|"+this.appName;this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&(B.User=Qi.kKh,B.TenantId=Qi.QQc,B.AdditionalProperties=this.fKi);x.ULS.sendTraceTag(23900187,
378,50,"Validating hyperlink with request correlation: {0}",B.CorrelationId);$c.a.Ulg($c.a.wwa(4),n,B)}jqn(){const b=this.Ga.kb("IsSafeLinksEnabledForUser");return b?Qi.Zjg(b):!1}iqn(){const b=this.Ga.iD("SafeLinksDisabledBrowsers");if(X.a.K7){if(this.Ga.jy("SafeLinksForTeamsIsEnabled")&&this.Ga.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,X.a.eE))return!1;return"officecomhwa"===(this.Ga.kb(A.AFrameworkApplication.mwa)||"").toLowerCase()?
!1:!0}h5o(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&X.a.b$c?!0:X.a.K7}K4o(){let b;b=0;const h=this.zqb(),n=h?h.IsSafeLinksEnabled:"";if(""!==n)return h.WasServiceDown?(x.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===n.toLowerCase()?(x.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):
{returnValue:Qi.Zjg(n),state:b};if(this.yCd)return b=3,x.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.SDb>=this.TGd||this.TDb>=this.UGd)return b=2,x.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.SDb,this.TGd,this.TDb,this.UGd),{returnValue:!1,state:b};x.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",
this.TGd+this.UGd-(this.SDb+this.TDb));return{returnValue:!0,state:b}}UEi(){const b=this.zqb();return b?b.PolicyCookie:""}nRm(){const b=this.zqb();return b?b.WebAffinitizedUrl:""}Igm(){const b=this.zqb();return b?b.AffinitizedUrl:""}trm(){const b=new Date;try{const h=this.zqb();b.setTime(h?h.PolicyCookieTTL:0)}catch(h){x.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}Z_f(){const b=this.trm();return!!b&&b.getTime()<Date.now()}zqb(){if(!this.tMd){const b=
Xa.a.instance.getItem(this.userId);if(!b||""===b)return null;this.tMd=JSON.parse(b)}return this.tMd}OMj(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.tMd=b;b.WasServiceDown||this.PJp(b)}PJp(b){b=JSON.stringify(b);Xa.a.instance.setItem(this.userId,b)}atf(b){return void 0!==Qi.Vd&&null!==Qi.Vd?Qi.Vd.Vf("WebServiceCall",
b):null}lBe(b){if(void 0!==b&&null!==b){const h=b.Fi;b.stop();return{returnValue:h,vz:null}}return{returnValue:null,vz:b}}static Zjg(b){return"false"!==b.toLowerCase()?!0:!1}}Qi.Vd=null;Qi.L7e=null;Qi.QQc="";Qi.kKh="";Qi.aUe="";Object(u.a)(Qi,"SafeLinksManager",null,[746]);const Oh=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},hb=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";
default:return"Unknown"}};class wc{constructor(){this.W=null;this.pz=()=>{A.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&(this.W.register(Qi,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ha().Rd(()=>new Qi(A.AFrameworkApplication.K,A.AFrameworkApplication.Be,String.format("{0}-{1}",Oh(A.AFrameworkApplication.ua.Ib.Tk),hb(A.AFrameworkApplication.ua.Ib.Dma)),!1,this.W.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),A.AFrameworkApplication.ua.hs)),
this.W.Oa("Common.App.SafeLinks.ISafeLinksManager"))}}get name(){return"Common.App.SafeLinks"}wc(b){this.W=b}init(){A.AFrameworkApplication.K&&A.AFrameworkApplication.K.Rn(this.pz)}dispose(){}static main(){M.a.instance.Jc(new wc)}}Object(u.a)(wc,"SafeLinksPackage",null,[0,1]);var cd=d(231);class Rd{constructor(b){this.sa=new mg.a;this.gi=b}fmb(b){this.sa.addHandler(Rd.sEa,b)}cld(b){this.sa.removeHandler(Rd.sEa,b)}OTa(b){this.sa.addHandler(Rd.v0a,b)}wZb(b){this.sa.removeHandler(Rd.v0a,b)}Hgf(b){this.sa.addHandler(Rd.fAc,
b)}rDg(){this.sa.raiseEvent(Rd.sEa)}MSf(){return cd.a.instance.NXa(A.AFrameworkApplication.Ty)}}Rd.sEa="SE";Rd.Ind="SEP";Rd.v0a="SER";Rd.fAc="TRP";Object(u.a)(Rd,"NullSessionExpirationManager",null,[711,712]);class cf{constructor(){this.HPc=this.Wkb=!1;this.Ysc=()=>{cd.a.instance.gEj(this.Ysc);x.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.bSf()};this.Yfd=()=>{cd.a.instance.mBo(this.Yfd);this.HPc||this.Wkb||(x.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),
this.HPc=!0,this.bEg())};const b=A.AFrameworkApplication.Ty;0>=b||(this.Ty=b,x.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Ty,["NowGetTime"]:(new Date).getTime(),["BootTime"]:A.AFrameworkApplication.D2}),cd.a.instance.DQh(this.Ysc),cd.a.instance.CQh(this.Yfd))}bSf(){this.Wkb||(A.AFrameworkApplication.qS(mj.a.Hnd),this.Wkb=!0,this.fAe())}}Object(u.a)(cf,"ASessionExpirationManager",null,[]);var Ge=d(182),Wg=d(293);class ge{constructor(b,h,n,
B){this.GIg="";this.wwd=b;this.zEh=n;this.vEh=B;this.Loh=h;b=(new Date(this.wwd)).format(A.AFrameworkApplication.cSj);this.GIg=this.Loh?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}Qwc(b){1===b?this.zEh&&this.zEh(this.Loh):0===b&&A.AFrameworkApplication.va.Pb(Pa.a.close,2,Wg.g)}dispose(){this.vEh&&this.vEh()}}ge.id="SessionExpirationDialog";Object(u.a)(ge,"SessionExpirationDialogSharedProperties",null,[]);class oj{}oj.kh="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";
Object(u.a)(oj,"SessionExpirationDialogHtml",null,[]);class uh extends Ge.a{constructor(b,h,n,B){super(h);const L={};this.b5a=new ge(b,h,n,B);this.Qg=ge.id;A.AFrameworkApplication.G_h?(this.Gd=1,this.Pe(0,CommonUIStrings.l_DialogClose)):(this.Gd=0,this.Du=!1);h||1===A.AFrameworkApplication.ua.mode?this.Pe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Pe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.kh=oj.kh;L.WACSessionExpirationText=this.b5a.GIg;this.pi(CommonUIStrings.l_DefaultDialogTitle,
Object(z.a)(this,this.Qwc,"sessionExpirationDialogHandler"),L);this.L8(this.Sj("WACSessionExpirationText"))}Qwc(b){this.b5a.Qwc(b)}jTf(){this.hide()}dispose(){super.dispose();this.b5a&&this.b5a.dispose()}}Object(u.a)(uh,"LegacySessionExpirationDialog",Ge.a,[797]);class Pj extends ui.StandardDialog{constructor(b,h,n,B){super(h);this.b5a=new ge(b,h,n,B);this.Qg=ge.id;A.AFrameworkApplication.G_h?(this.Gd=1,this.Pe(0,CommonUIStrings.l_DialogClose)):(this.Gd=0,this.Du=!1);h||1===A.AFrameworkApplication.ua.mode?
this.Pe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Pe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Ix(CommonUIStrings.l_DefaultDialogTitle,this.b5a.GIg,0,Object(z.a)(this,this.Qwc,"sessionExpirationDialogHandler"))}Qwc(b){this.b5a.Qwc(b)}jTf(){this.hide()}dispose(){super.dispose();this.b5a&&this.b5a.dispose()}}Object(u.a)(Pj,"SessionExpirationDialog",ui.StandardDialog,[797]);const eh=(b,h,n,B)=>A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.cH&&A.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?
new Pj(b,h,n,B):new uh(b,h,n,B);var xf=d(211);class gh extends cf{constructor(b){super();this.XMd=this.yac=!0;this.f2=null;this.sa=new mg.a;this.fhc=()=>{this.f2=null};this.Rwc=h=>{(h||this.gi.GTd())&&this.gi.D8(null)};this.gi=b}fmb(b){this.sa.addHandler(gh.sEa,b)}cld(b){this.sa.removeHandler(gh.sEa,b)}OTa(b){this.sa.addHandler(gh.v0a,b)}wZb(b){this.sa.removeHandler(gh.v0a,b)}Hgf(b){this.sa.addHandler(gh.fAc,b)}MSf(){return cd.a.instance.NXa(A.AFrameworkApplication.Ty)}rDg(b){this.yac=b}bEg(){this.f2||
xf.a.cP||(this.XMd&&(this.f2=eh(this.Ty,!1,this.Rwc,this.fhc)),this.sa.raiseEvent(gh.Ind))}fAe(){this.f2&&(this.f2.ema&&this.f2.jTf(),this.f2=null);this.yac&&(this.f2=eh(this.Ty,!0,this.Rwc,this.fhc));this.sa.raiseEvent(gh.sEa)}}gh.sEa="SE";gh.Ind="SEP";gh.v0a="SER";gh.fAc="TRP";Object(u.a)(gh,"SessionExpirationManager",cf,[711,712]);class Ue{}Ue.rTk="Aborting";Ue.SQd="ActivityDuration";Ue.error="Error";Ue.WBf="Errors";Ue.UB="Failed";Ue.DOb="FirstActivity";Ue.initialized="Initialized";Ue.k5i="KickedOut";
Ue.twn="LastActivity";Ue.tHj="RetryOverride";Ue.gve="RequestGroups";Ue.sxb="Requests";Ue.tve="Responses";Ue.cxe="SessionDuration";Ue.status="Status";Ue.success="Success";Ue.Eep="Successful";Ue.tokens="Tokens";Ue.rlg="PollingDuration";Object(u.a)(Ue,"SessionExpirationStrings",null,[]);class gb{constructor(b){this.RD={};this.Coa={};this.j4a={};this.V$i=15;this.Kqh=!1;this.HMk=new Date;this.TFd=new Date;this.Kck=()=>{x.ULS.sendTraceTag(41964821,217,50,x.ULS.Nad({["Aggregate"]:this.Coa,["Current"]:this.RD}))};
this.Gb=b;this.JQ=new Re.a(2,2,6E4*this.V$i,this.Kck,135,"SL",!1);this.Gb.Zb(this.JQ);this.v7m()}v7m(){this.Coa[Ue.gve]=0;this.Coa[Ue.sxb]=0;this.Coa[Ue.tve]=0;this.Coa[Ue.status]=Ue.initialized;this.Coa[Ue.DOb]=new Date;this.Coa[Ue.cxe]=0;this.Coa[Ue.SQd]=0;this.Coa[Ue.cxe]=0;this.RD[Ue.cxe]=0;this.Coa[Ue.SQd]=0;this.RD[Ue.SQd]=0}get Obo(){this.j4a[Ue.rlg]=+new Date-+this.j4a[Ue.DOb];return this.j4a}QUf(b,h){var n=b[h];n=n?n:0;n++;b[h]=n;this.cAg(b)}cAg(b){const h=new Date;b[Ue.SQd]=+h-+this.TFd;
this.TFd=h;b[Ue.cxe]=+this.TFd-+this.HMk;b[Ue.twn]=this.TFd}Lca(b,h){this.RD[b]=h;this.cAg(this.RD)}szg(b,h){this.RD[b]=h;this.cAg(this.RD)}Rmc(b){this.QUf(this.RD,b);this.QUf(this.Coa,b);this.QUf(this.j4a,b)}flush(){this.Kqh||(this.Coa[Ue.status]=this.RD[Ue.status],this.Kck(this.JQ),this.Gb.q4(this.JQ,6E4*this.V$i))}uFo(){const b=this.RD[Ue.status];b&&(this.Coa[Ue.status]=b);this.RD={}}JFo(){this.j4a={};this.j4a[Ue.rlg]=0;this.j4a[Ue.DOb]=new Date}stop(){x.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");
this.flush();this.Kqh=!0;this.Gb.vf(this.JQ)}}Object(u.a)(gb,"SessionLogger",null,[707]);class Mb{constructor(b,h){this.UOd=b;this.rGa=h}get tokens(){return this.UOd}get errors(){return this.rGa}}Object(u.a)(Mb,"TokenRefreshArgs",null,[744]);var hc=d(417);class Kc extends Sys.EventArgs{constructor(b,h,n,B,L,ba,la){super();this.j4a=b;this.Ebo=h;this.gve=B;this.UB=L;this.sxb=ba;this.tve=la}}Object(u.a)(Kc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Vc=d(26);class od{constructor(b,h=null,
n=null){this.HPc=this.Wkb=!1;this.XMd=this.yac=!0;this.sa=new mg.a;this.KPc=this.rKc=this.KKd=!1;this.UGb=null;this.Zzh=10;this.lFd=!1;this.Fro=()=>{this.N5c(!1);return!cd.a.instance.NXa(A.AFrameworkApplication.Ty)};this.jTk=(B,L)=>{cd.a.instance.oge?this.Ysc(B,L):this.iZe?(this.rKc=!1,this.N5c(!1)):(this.Wkb||x.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.Ysc(B,L))};this.kTk=(B,L)=>{cd.a.instance.nge?this.Yfd(B,L):(Vc.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),
this.rKc=!1,this.N5c(!0))};this.Mdf=(B,L)=>{cd.a.instance.nge?this.Yfd(B,L):this.N5c(!0)};this.Ysc=()=>{this.iZe||cd.a.instance.gEj(this.Ysc);x.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.bSf(cd.a.instance.oge)};this.glp=()=>{const B=this.Kc.Obo;x.ULS.sendTraceTag(555255521,217,50,"{0}",D.c(B));this.sa.raiseEvent(od.fAc,new Kc(B,B[Ue.rlg],B[Ue.DOb],B[Ue.gve],B[Ue.UB],B[Ue.sxb],B[Ue.tve]))};this.Qdo=()=>{3E5<+new Date-+this.ish?(x.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),
this.N5c(!1)):x.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")};this.hbf=b;this.iZe=A.AFrameworkApplication.pun;this.Gb=ph.a.instance;x.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:A.AFrameworkApplication.Ty,["NowGetTime"]:(new Date).getTime(),["BootTime"]:A.AFrameworkApplication.D2});this.Kc=h||new gb(ph.a.instance);this.mja=n;cd.a.instance.DQh(this.jTk);cd.a.instance.CQh(this.Mdf);
hc.SessionStatusManager.instance.Ggf(this.Mdf);hc.SessionStatusManager.instance.$1k(this.Qdo);this.ish=new Date;A.AFrameworkApplication.oun&&(cd.a.instance.Znf=this.Fro);b=!1;A.AFrameworkApplication.K&&(A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.Zzh=A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1),b=A.AFrameworkApplication.K.$("WopiTokenRefreshWhenNetworkResumed"));b?hc.SessionStatusManager.instance.Ggf(this.kTk):hc.SessionStatusManager.instance.Ggf(this.Mdf)}fmb(b){this.sa.addHandler(od.sEa,b)}cld(b){this.sa.removeHandler(od.sEa,b)}OTa(b){this.sa.addHandler(od.v0a,b)}wZb(b){this.sa.removeHandler(od.v0a,b)}Hgf(b){this.sa.addHandler(od.fAc,b)}MSf(){return cd.a.instance.NXa(A.AFrameworkApplication.Ty)}N5c(b){if(!this.KKd&&!this.rKc)if(this.mja&&this.mja.Ko)this.KPc=!0,this.Kc.Lca(Ue.status,
Ue.k5i),this.Kc.flush(),this.Kc.stop();else if(x.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.KPc),this.KPc)this.fAe();else{this.Kc.flush();this.Kc.uFo();this.Kc.Rmc(Ue.gve);this.KKd=!0;this.lFd||(this.Kc.JFo(),this.lFd=!0,this.wDl());const h=this.hbf.Yro(b);h.continueWith(()=>{if(this.hbf.aio(h))this.Kc.Rmc(Ue.Eep),this.Kc.Lca(Ue.status,Ue.success),this.XMd=!1,this.iZe&&(this.yac=!1),this.rKc=!1,this.ish=new Date,this.gdp(),this.sa.raiseEvent(od.v0a,
new Mb(h.result.tokens,null));else{const n=h.result.errors;this.Kc.Rmc(Ue.UB);this.Kc.Lca(Ue.status,Ue.UB);b||(this.KPc=this.hbf.u$c(n));this.KPc&&(this.Kc.Lca(Ue.rTk,JSON.stringify(n)),x.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.rKc=!0;this.sa.raiseEvent(od.v0a,new Mb(null,n))}this.Kc.flush();this.KKd=!1})}}Yfd(){this.HPc||this.Wkb||(x.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.HPc=!0,this.bEg(cd.a.instance.nge))}bSf(b){if(!this.Wkb){var h=
b?mj.a.fQo:mj.a.Hnd;const n=Object.assign(new rb.a,{extendedProperties:new Map});n.extendedProperties.set("ErrorCode",String.format("{0}",h));A.AFrameworkApplication.qS(h,void 0,["SessionExpired"],n);b||(b=new Date,h=new Date(A.AFrameworkApplication.D2),x.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&oa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,n),2592E5>+b-+h&&
oa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,n));this.Wkb=!0;this.fAe()}}gdp(){this.lFd&&(this.Gb.vf(this.UGb),this.lFd=!1)}wDl(){this.UGb=new Re.a(2,2,1E3*this.Zzh,this.glp,135);this.Gb.Zb(this.UGb)}}od.sEa="SE";od.Ind="SEP";od.v0a="SER";od.fAc="TRP";Object(u.a)(od,"ASessionExpirationManagerWithRefresh",null,[]);class Od extends od{constructor(b,h,n=null,B=null){super(h,n,B);this.f2=null;this.fhc=()=>{this.f2=null};this.Rwc=L=>{(L||
this.gi.GTd())&&this.gi.D8(null)};this.gi=b}rDg(b){this.yac=b}bEg(b){if(!this.f2&&!xf.a.cP){if(b)this.f2=eh(A.AFrameworkApplication.cOa,!1,this.Rwc,this.fhc);else if(this.XMd){if(this.KKd)return;this.f2=eh(A.AFrameworkApplication.Ty,!1,this.Rwc,this.fhc)}x.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",od.Ind,b);this.sa.raiseEvent(od.Ind)}}fAe(){this.f2&&(this.f2.ema&&this.f2.jTf(),this.f2=null);if(this.yac){this.Kc.stop();if(this.mja&&this.mja.Ko)return;this.f2=
eh(A.AFrameworkApplication.Ty,!0,this.Rwc,this.fhc)}x.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",od.sEa);this.sa.raiseEvent(od.sEa)}}Object(u.a)(Od,"SessionExpirationManagerWithRefresh",od,[711,712]);class Ld{constructor(b,h,n=null,B=null){this.TJh=!1;this._instance=null;this._frame=b;this.hp=h;this.Kc=n||new gb(ph.a.instance);this.mja=B}create(){this.TJh=A.AFrameworkApplication.Uab;if(!this.TJh)return new gh(this._frame);x.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");
if(!this._instance)switch(A.AFrameworkApplication.ZFp){case 1:x.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this._instance=new Rd(this._frame);break;case 2:x.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new Od(this._frame,this.hp,this.Kc,this.mja);break;default:x.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new gh(this._frame)}x.ULS.sendTraceTag(39408089,217,
50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());return this._instance}}Object(u.a)(Ld,"SessionExpirationManagerFactory",null,[710]);class Af{}Object(u.a)(Af,"Error",null,[]);class Tb{}Object(u.a)(Tb,"NamedResult",null,[]);class Dg extends Tb{}Object(u.a)(Dg,"ErrorInfo",Tb,[]);var Kh=d(1169);class rg{constructor(b,h,n,B=null,L=!1,ba=null,la=!1,La=!1,fb=!1,Cb=!1,Lb=!1){this.wHa=0;this.sTa=this.kp=null;this.UOd=new ob.a;this.rGa=new ob.a;this.Sq=null;
this.aKc=!1;this.ZQc=this.$Qc=null;this.OEo=()=>{this.cGj()};this.Gb=b;this.dAh=h;this.dAh.execute($b=>{$b.BD(H.a.LTf,Object(z.a)(this,this.FYn,"onHostResponseReceived"))});this.d6=n;this.yIh=new Kh.a("WebServiceCall","TokenRefresh");this.Kc=B||new gb(b);this.zMk=L;this.tf=ba?ba:hc.SessionStatusManager.instance;this.Hgh=la;this.UAd=La;this.UMk=fb;this.VMk=Cb;this.WEh=Lb}FYn(b){if(b.MessageId!==H.a.LTf)Vc.b(39408099,306,15,"Unexpected message.");else{var h=new ob.a,n=new ob.a;this.Kc.Rmc(Ue.tve);var B=
b.Values[I.a.oMj];if(!B||0>=B.length)Vc.b(40122317,306,15,"Found no tokens in the dictionary"),B=b.Values;Vc.b(40122318,306,100,"The Tokens array contains {0} tokens",B.length);this.Kc.Lca("Correlation",b.CorrelationId);var L="";for(let La=0;La<B.length;La++){this.Kc.szg(Ue.tokens,B.length);var ba=B[La],la=ba;if(!la||!la.Name)continue;this.Kc.Rmc(la.Name);const fb=ba;if(fb&&fb.Value)Vc.b(39408128,306,100,"Received token with name: {0}",fb.Name),h.add(fb),this.UOd.add(fb),this.UAd||this.Kc.Lca(Ue.status,
Ue.success),this.Hgh&&this.tf&&this.tf.aGo();else if(ba=this.vJm(ba),Vc.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",la.Name,JSON.stringify(ba),this.sTa),n.add(ba),this.UAd||(this.rGa.add(ba),L=JSON.stringify(ba),this.Kc.Lca(Ue.error,JSON.stringify(ba)),this.Kc.Lca(Ue.status,Ue.UB)),this.Hgh)for(const Cb of ba.Errors)la=this.grm(Cb),this.tf&&this.tf.g_k(la)}this.UAd?(0<n.count?this.ZQc?this.ZQc(new Mb(h,n)):Vc.b(512267295,306,15,"Received errors but the promise has completed"):
this.$Qc?this.$Qc(new Mb(h,n)):Vc.b(512267294,306,15,"Received valid tokens but the promise has completed"),Vc.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,n.count,b.CorrelationId,this.sTa)):(0<n.count&&""!==L?(B=Object.assign(new rb.a,{extendedProperties:new Map}),B.extendedProperties.set("Errors",L),B.extendedProperties.set("RetryCount",this.wHa.toString()),B.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),
B.extendedProperties.set("IsTokenExpiring",this.aKc.toString()),this.B0f()&&B.extendedProperties.set("IsAppShuttingDown",A.AFrameworkApplication.ol.toString()),oa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,B)):oa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Vc.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,n.count,b.CorrelationId,this.sTa),0<n.count&&!this.u$c(n)?(b=this.d6.mGi(n),b!==
this.d6.Rvc&&(this.Kc.szg(Ue.tHj,b),this.Gb.q4(this.kp,b))):(this.Kc.flush(),this.kp&&(Vc.b(39408131,306,100,"Deleting task {0} from task manager",this.kp.name),this.Gb.vf(this.kp)),this.Sq&&!this.Sq.task.isCompleted?this.Sq.gg(new Mb(h,n)):Vc.b(512267293,306,15,"Received results but the task has completed")))}}vJm(b){if(!b)return null;const h=Object.assign(new Dg,{Name:b.Name,Errors:[]});for(const n of b.Errors)b=new Af,b.Id=n.Id,b.Details=fa.a.DQb(n.Details,500),h.Errors.push(b);return h}cGj(){A.AFrameworkApplication.Ld("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");
this.wHa>=this.d6.Uje?(Vc.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.sTa),this.sFl(this.Sq)):(oa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.vLj())}vLj(){const b={};b[I.a.oMj]=this.d6.tokens;this.UMk&&(b[I.a.kQo]=this.VMk);const h=yb.a.create().toString();Vc.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.d6.tokens),this.wHa+1,h,this.sTa);this.dAh.execute(n=>{n.sendMessage(H.a.vif,
b,h)});this.wHa++;this.Kc.Rmc(Ue.sxb)}sFl(b){const h=new ob.a;for(let n=0;n<this.d6.tokens.length;n++){const B=Object.assign(new Dg,{Name:this.d6.tokens[n],Errors:[Object.assign(new Af,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});h.add(B);this.rGa.add(B)}this.Gb.vf(this.kp);this.Kc.Lca(Ue.WBf,JSON.stringify(this.rGa));this.Kc.Lca(Ue.status,Ue.UB);b&&!b.task.isCompleted&&b.gg(new Mb(new ob.a,this.rGa))}B0f(){return A.AFrameworkApplication.K&&
A.AFrameworkApplication.K.isChangeGateEnabled("SkipSessionExpiredVetoForShutdown")}Yro(b){A.AFrameworkApplication.Ld("ej4if276;fheca743");A.AFrameworkApplication.Ld("5d4fi128;abe10395");this.yIh.start();this.B0f()&&this.Gb.Qrb&&(Vc.b(508351137,306,15,"Restarting taskmanager, is shutting down {0}",A.AFrameworkApplication.ol),this.Gb.restart());this.aKc=b;this.sTa=yb.a.create().toString();Vc.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.sTa,this.aKc);this.wHa=
0;this.rGa.clear();this.UOd.clear();this.Sq=new Zf.a;this.UAd?this.dGj(this.d6.Uje).then(h=>{this.Sq&&!this.Sq.task.isCompleted&&this.Sq.gg(h);this.ZQc=this.$Qc=null;this.Kc.Lca(Ue.WBf,JSON.stringify(this.rGa));this.Kc.Lca(Ue.status,Ue.success);this.Kc.flush()}).catch(h=>{this.Sq&&!this.Sq.task.isCompleted&&this.Sq.gg(Object(ya.a)(744,h));this.ZQc=this.$Qc=null;this.Kc.Lca(Ue.WBf,JSON.stringify(this.rGa));this.Kc.Lca(Ue.status,Ue.UB);this.Kc.flush()}):(this.kp=new Re.a(this.d6.priority,2,this.d6.Rvc,
this.OEo,98,H.a.vif,!0),this.zMk&&this.cGj(),this.Gb.Zb(this.kp));return this.Sq.task}dGj(b){const h=this,n=new Promise((La,fb)=>{h.$Qc=La;h.ZQc=fb;oa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);h.vLj()}),B=this,L=new Promise((La,fb)=>{window.setTimeout(()=>{fb(B.t$h("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},B.d6.Rvc)});let ba=b;const la=this;return new Promise((La,fb)=>{ba--;Promise.race([n,L]).then(Cb=>{oa.Health.instance.recordKpiSuccess("WACTokenRefresh",
null);La(Cb)}).catch(Cb=>{var Lb=la.d6.Rvc;if(Object(Wb.a)(744,Cb)&&(Cb=Object(ya.a)(744,Cb),0<Cb.errors.count)){la.LCn(Cb.errors);la.tNh(Cb.errors);if(la.u$c(Cb.errors)){fb(Cb);return}const $b=la.d6.mGi(Cb.errors);$b!==la.d6.Rvc?(la.Kc.szg(Ue.tHj,$b),Lb=$b):la.Ksn(Cb.errors)&&(Lb=0)}ba?window.setTimeout(()=>{la.dGj(ba).then(La).catch(fb)},Lb):(Lb=la.t$h("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),la.tNh(Lb.errors),fb(Lb),Vc.b(512267292,
306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",la.sTa))})})}tNh(b){for(const h of b)this.rGa.add(h)}Ksn(b){if(!b.count)return!1;b=b.J(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}t$h(b,h){const n=new ob.a;for(let B=0;B<this.d6.tokens.length;B++){const L=this.tFl(this.d6.tokens[B],b,h);n.add(L)}return new Mb(new ob.a,n)}tFl(b,h,n){return Object.assign(new Dg,{Name:b,Errors:[Object.assign(new Af,{Id:h,Details:n})]})}LCn(b){if(b.count){b=b.J(b.count-1);b=JSON.stringify(b);
var h=Object.assign(new rb.a,{extendedProperties:new Map});h.extendedProperties.set("Errors",b);h.extendedProperties.set("RetryCount",this.wHa.toString());h.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());h.extendedProperties.set("IsTokenExpiring",this.aKc.toString());this.B0f()&&h.extendedProperties.set("IsAppShuttingDown",A.AFrameworkApplication.ol.toString());oa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,h);this.Kc.Lca(Ue.error,b);
this.Kc.Lca(Ue.status,Ue.UB)}}aio(b){this.yIh.stop();const h=this.EYm(b.result.errors);x.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!h,this.sTa,this.aKc,this.wHa,this.rGa.count,0<b.result.errors.count?b.result.errors.J(0).Name:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Id:"",0<b.result.errors.count&&
0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Details:"");return h?!1:this.$ho(b.result.tokens)}u$c(b){return this.d6.u$c(b)}$ho(b){for(let h=0;h<b.count;h++){const n=b.J(h);if(n.Name===I.a.accessToken){const B=(new Date).getTime();n.Expiry>A.AFrameworkApplication.Ty?(x.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:n.Expiry,["NowGetTime"]:B,["BootTime"]:A.AFrameworkApplication.D2},"PreviousAccessTokenTtl",A.AFrameworkApplication.Ty),A.AFrameworkApplication.accessToken=
n.Value,A.AFrameworkApplication.Ty=Math.floor(n.Expiry),A.AFrameworkApplication.bPg=B,A.AFrameworkApplication.GTa=Math.floor(n.Expiry)):x.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:n.Expiry,["NowGetTime"]:B,["BootTime"]:A.AFrameworkApplication.D2},"PreviousAccessTokenTtl",A.AFrameworkApplication.Ty)}}return!0}EYm(b){let h=!1;for(let n=0;n<b.count;n++){h=!0;const B=b.J(n);x.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",
B.Name,JSON.stringify(B.Errors),this.sTa)}return h}E3i(b){return b.includes("aadInteractionRequired")||b.includes("sessionRevocation")||b.includes("blockAccessForTenantRestrictions")||b.includes("revoked")||b.includes("Due to organizational policies, you can't access these resources from this network location")?!0:!1}grm(b){let h=mj.a.Hnd;const n=parseInt(b.Id);b=b.Details;if(isNaN(n))h=mj.a.Kbk;else{switch(n){case 401:h=mj.a.TGe;this.WEh&&this.E3i(b)&&(h=mj.a.Lud);break;case 403:h=mj.a.Ibk;this.WEh&&
this.E3i(b)&&(h=mj.a.Lud);break;case 500:h=mj.a.Jbk;break;case 503:h=mj.a.Mbk}h===mj.a.Hnd&&(h=500<n?mj.a.Lbk:mj.a.Hbk)}return h}}Object(u.a)(rg,"TokenRefreshManager",null,[709]);class ai{constructor(){this.Rvc=A.AFrameworkApplication.bGp;this.Uje=A.AFrameworkApplication.$Fp;this.tokens=A.AFrameworkApplication.ASm();this.priority=A.AFrameworkApplication.cGp;this.DCh=this.uXo();this.sdf=A.AFrameworkApplication.zSm()}u$c(b){b=JSON.stringify(b);if(this.sdf&&0<this.sdf.length)for(const h of this.sdf)if(0<
h.length&&0<=b.indexOf(h))return!0;return!1}mGi(b){try{if(b)for(const h of b)if(h.Errors)for(const n of h.Errors)if(n.Id in this.DCh)return Number.parseInvariant(this.DCh[n.Id].toString())}catch(h){x.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.Rvc}uXo(){const b={};try{if(!A.AFrameworkApplication.v$d()||0>=A.AFrameworkApplication.v$d().length||""===A.AFrameworkApplication.v$d()[0])return b;for(const h of A.AFrameworkApplication.v$d())0<
h.length&&(b[h]=A.AFrameworkApplication.aGp)}catch(h){x.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",h.toString())}return b}}Object(u.a)(ai,"TokenRefreshPolicy",null,[708]);class kl{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){A.AFrameworkApplication.K.Rn(()=>{this.w$a()})}w$a(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}wc(b){this.W=
b;b.register(707,"Common.App.SessionExpiration.ISessionLogger").ha().Rd(()=>new gb(ph.a.instance));b.register(708,"Common.App.SessionExpiration.ITokenRefreshPolicy").ha().Rd(()=>new ai);b.register(709,"Common.App.SessionExpiration.ITokenRefreshManager").ha().Rd(()=>new rg(ph.a.instance,A.AFrameworkApplication.IR(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),A.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),
b.Oa("Common.ISessionStatus"),A.AFrameworkApplication.K.$("WopiAllowTokenRefreshErrorTracking"),A.AFrameworkApplication.K.$("WopiTokenRefreshSyncMessageWithTimeout"),A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAddAllowAADPopupInPostMessage",!1),A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAllowAADPopupForTokenRefresh",!1),A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RevokedTokenExperiment",
!1)&&A.AFrameworkApplication.K.$("ShowTokenRevocationErrorMessage")));b.register(710,"Common.ISessionExpirationManagerFactory").ha().Rd(()=>new Ld(A.AFrameworkApplication.ua,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Oa("Common.ISessionStatus")));b.register(711,"Common.ISessionExpirationManagerWithDialog").ha().Rd(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(712,"Common.ISessionExpirationManager").ha().Rd(()=>
b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){M.a.instance.Jc(new kl)}}Object(u.a)(kl,"SessionExpirationPackage",null,[0,1]);var Fe=d(818),vh=d(439),te=d(366),jj=d(218);class ek extends jj.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(u.a)(ek,"PersonaButtonProps",jj.a,[]);class pg{bgc(b,h){if(b&&!(1>b.length)&&h){var n=Object.assign(new te.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.JFl(b,n.ControlList);
h.push(n)}}JFl(b,h){const n=Object.assign(new Fe.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new vh.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,n);h=Object.assign(new te.a,{Title:"",ControlList:[]});Array.add(n.Menu.MenuSectionList,h);this.GIl(b,h.ControlList)}GIl(b,h){for(let n=0;n<b.length;n++){const B=Object.assign(new ek,{ExternalId:String.format("CoauthorPersona_{0}",n),
Command:"336231556",DisplayName:b[n].userName,LabelText:b[n].userName,ImageBackColor:b[n].color,PersonaId:b[n].email,IsAnonymous:b[n].isAnonymous});Array.add(h,B)}}}Object(u.a)(pg,"PresenceContextMenuSectionBuilder",null,[885]);var Ak=d(110);class Ri{constructor(b,h,n,B){this.Lwa=this.St=this.kp=this.zi=this.lQa=null;this.wal=()=>{this.bNd.IVh()};this.Zra=L=>{1===L?(Ai.a.qqe(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),A.AFrameworkApplication.va.Ob(Pa.a.A3f,2)):(this.w5o(),
A.AFrameworkApplication.va.Ob(Pa.a.f0h,2))};this.Phl=()=>{this.pUl();A.AFrameworkApplication.va.Ob(Pa.a.e0h,2)};this.bNd=b;this.RNk=B;this.bNd.I8c&&(this.kp=new Re.a(3,2,5E3,this.wal,2),A.AFrameworkApplication.mc.Zb(this.kp),this.Wb(h,n));this.bNd.R_k(()=>{this.lWb()});this.bNd.tPh(()=>{this.mWb()})}get $M(){return this.St||(this.St=Ya.a.instance.Oa("CommonUI.IBusinessBar"))}get JYh(){return this.Lwa||(this.Lwa=Ya.a.instance.Oa("CommonUI.IBusinessBarEntryFactory"))}Wb(b,h){const n=A.AFrameworkApplication.va;
n.fb(Pa.a.JVh,id.a.frame,b,96);n.fb(Pa.a.KVh,id.a.frame,h,96);n.ra(Pa.a.e0h,id.a.frame,Ce.ActionManager.gU);n.ra(Pa.a.f0h,id.a.frame,Ce.ActionManager.gU);n.ra(Pa.a.A3f,id.a.frame,Ce.ActionManager.gU)}lWb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);A.AFrameworkApplication.va.Ob(Pa.a.JVh,2)}mWb(){this.Shp();A.AFrameworkApplication.va.Ob(Pa.a.KVh,2)}Shp(){this.zi&&(this.zi.hide(),this.zi.dispose(),this.zi=null);this.lQa&&this.$M&&(A.AFrameworkApplication.ol||this.$M.removeEntry(this.lQa),
this.lQa.dispose(),this.lQa=null)}showDialog(b){Ak.a.JD(this.zi);this.zi=new ui.StandardDialog;this.RNk||(this.zi.Du=!1,this.zi.Gd=0);this.zi.Pe(1,CommonUIStrings.l_SignIn);this.zi.yY(CommonUIStrings.l_DefaultDialogTitle,b,this.Zra)}w5o(){this.$M&&this.JYh&&(this.lQa=this.JYh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.lQa.closeable=!0,this.lQa.addButton(CommonUIStrings.l_SignIn,Ri.B6a,""),this.lQa.aka=this.Phl,this.$M.Uy(this.lQa,!1))}pUl(){this.kp&&
(A.AFrameworkApplication.mc.vf(this.kp),this.kp=null)}dispose(){this.kp=this.zi=this.lQa=null}static B6a(){Ai.a.qqe();A.AFrameworkApplication.va.Ob(Pa.a.A3f,2)}}Object(u.a)(Ri,"SignOutResponseUI",null,[13]);class wi{get name(){return"Common.App.UI"}wc(b){b.register(pg,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ha()}init(){}dispose(){Ak.a.JD(wi.xya);wi.xya=null}static main(){M.a.instance.Jc(new wi)}static G5m(b,h,n){wi.i5o()&&(wi.xya=new Ri(Ai.a.instance,
b,h,n))}static i5o(){return A.AFrameworkApplication.lle&&!A.AFrameworkApplication.Ola}}wi.xya=null;Object(u.a)(wi,"CommonAppUIPackage",null,[0,1]);class Bk{get name(){return"Common.App.DialogWithLinkToResource"}wc(){}init(){}dispose(){}static main(){M.a.instance.Jc(new Bk)}}Object(u.a)(Bk,"CommonAppDialogWithLinkToResourcePackage",null,[0,1]);var Ph=d(73);class po{constructor(b){this.Nz=b;this.Dz=Array.indexOf(this.Nz,this.Uka)}dispose(){this.Nz=null}get Ora(){return this.Nz[this.Dz]}mA(b){this.Nnd(b,
!1);return!0}bjc(b){this.Nnd(b,!0)}Nnd(b,h){b&&(this.Ora!==b||h)&&(b.tabIndex=0,Ph.FocusManager.ZN(b));Array.contains(this.Nz,b)&&(this.Dz=Array.indexOf(this.Nz,b))}get jvj(){let b=this.Dz;do if(b)if(0<b&&b<this.Nz.length)b--;else break;else b=this.Nz.length-1;while(!Xc.DOMFocusListing.d8a(this.Nz[b])&&b!==this.Dz);return this.Nz[b]}get ahj(){let b=this.Dz;do if(b===this.Nz.length-1)b=0;else if(0<=b&&b<this.Nz.length-1)b++;else break;while(!Xc.DOMFocusListing.d8a(this.Nz[b])&&b!==this.Dz);return this.Nz[b]}get Uka(){let b=
0;for(;!Xc.DOMFocusListing.d8a(this.Nz[b])&&b<this.Nz.length;)b++;return Xc.DOMFocusListing.d8a(this.Nz[b])?this.Nz[b]:null}get lqc(){let b=this.Nz.length-1;for(;!Xc.DOMFocusListing.d8a(this.Nz[b])&&0<b;)b--;return Xc.DOMFocusListing.d8a(this.Nz[b])?this.Nz[b]:null}}Object(u.a)(po,"DialogFocusListing",null,[110]);var Lh=d(60);class qa extends ui.StandardDialog{constructor(b,h,n,B=null){super();this.$ia=this.$x=this.nib=null;this.Nz=[];this.c3n=L=>{this.$x&&(this.$x.target="_blank",this.$x.submit());
L.preventDefault()};this.Fii=()=>{x.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};this.Lfo=()=>{x.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.an&&this.an.stop()};this.tJd=h;this.Wl=b;this.ryk=n;this.pMd=B;this.an=new Kh.a("LoadResource","LoadPrintablePdf")}SJa(){this.Gd=5;this.width=40;const b=document.createElement("span");b.id=this.Sj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;
Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.$ia=document.createElement("iframe");this.$ia.name="pdfObjectFrame";this.$ia.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.$ia.onload=this.Lfo;if(this.pMd&&0<this.pMd.count){var n=za.a.PMf(this.tJd,this.pMd);const B=za.a.zsg(this.tJd,this.pMd);this.$x=document.createElement("form");this.$x.id="printPreviewPostForm";this.$x.method="POST";this.$x.target=this.$ia.name;this.$x.action=B;for(const L of n)n=document.createElement("input"),
n.type="hidden",n.name=L.key,n.value=L.value,this.$x.appendChild(n)}else this.$ia.setAttribute("src",this.tJd);Sys.UI.DomElement.addCssClass(this.$ia,xf.a.Gwh);this.ryk?(Sys.UI.DomElement.addCssClass(this.$ia,"DirectPrintPdfObjectHidden"),h.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Bc.a.Ls(this.$ia,Bc.a.JB,Bc.a.hq)):(Sys.UI.DomElement.addCssClass(this.$ia,"DirectPrintPdfObject"),this.Nz.push(this.$ia));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.$ia);
this.$x&&b.appendChild(this.$x);b.appendChild(document.createElement("br"));b.appendChild(this.Fyl(this.$x?"#":this.tJd));this.an.start();this.Qub(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.L8(this.Sj("DirectPrintHeaderContent"));this.$x&&this.$x.submit();this.KFl();x.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}Fyl(b){const h=document.createElement("span");var n=document.createElement("span");n.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(n);
A.AFrameworkApplication.K&&(2===A.AFrameworkApplication.ua.Ib.Tk&&A.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||1===A.AFrameworkApplication.ua.Ib.Tk&&A.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===A.AFrameworkApplication.ua.Ib.Tk?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===A.AFrameworkApplication.ua.Ib.Tk&&(b.innerText=CommonUIStrings.l_InternalError_Directive,x.ULS.sendTraceTag(573691527,
328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.nib=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(n=document.createElement("a"),n.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,n.href=b,n.target="_blank",n.id="PrintPDFLink",n.className="AllowBrowserClick",this.nib=n,h.appendChild(document.createElement("br")),h.appendChild(n),this.$x&&Nb.a.addHandler(n,"click",this.c3n),this.Wl.nb(Cd.a.click,this.nib,this.Fii,null));this.Nz.push(this.nib);return h}KFl(){if(0<
this.Nz.length){const b=new po(this.Nz),h=Ph.FocusManager.instance().gu();h&&(this.nib.focus(),h.Mk=b,h.aS=!0)}}kcd(){x.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}dispose(){this.nib&&(this.Wl.xc(Cd.a.click,this.nib,this.Fii),this.nib=null);Lh.a.Dy(this.$ia);this.$ia=null;super.dispose()}}Object(u.a)(qa,"DirectPrintDialog",ui.StandardDialog,[790]);class Jb{constructor(b){this.Wl=b}Mpm(b,h,n=null){return new qa(this.Wl,b,h,n)}}Object(u.a)(Jb,"DirectPrintDialogFactory",
null,[772]);class Rb{constructor(b,h){this._url=b;this.BHk=h}uhi(){this.BHk?$c.a.fYl(this._url):$c.a.yn(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(u.a)(Rb,"OpenUrlInTabDialogDownloadBehavior",null,[795,13]);class Tc extends ui.StandardDialog{constructor(b,h=!0,n=!1,B=null,L=null,ba=!1,la=null){super();this.n7b=this.m7b=this.$x=this.Y5=null;this.ITn=$b=>{this.hmi($b);return!0};this.JTn=$b=>this.Qad($b,this.hmi);this.hmi=$b=>{this.$x&&this.$x.submit();
this.hOb($b.Nf)};this.Zra=$b=>{1===$b?(this.kcd(),this.$x?Tc.bO&&this.Gyj():this.dRe.uhi()):2===$b&&(this.Vde?this.O8h():this.fee&&this.$Zl());this.dispose()};var La=this.cJg?this.cJg:CommonUIStrings.l_DefaultDialogTitle;Tc.fmc=ba;this.Xpk=la;this.dRe=B||new Rb(b,!0);const fb=[],Cb=[];Tc.bO&&(this.cSd&&this.cSd.forEach($b=>{Array.add(fb,$b)}),this.UQh&&this.UQh.forEach($b=>{Array.add(Cb,$b)}));h?n?this.Vde?(this.Gd=12,this.Pe(1,this.buttonText),this.Pe(2,CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkButton),
this.Pe(3,CommonUIStrings.l_DialogClose)):this.fee?(this.Gd=12,this.Pe(1,this.buttonText),this.Pe(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),this.Pe(3,CommonUIStrings.l_DialogClose)):(this.Gd=4,this.Pe(1,this.buttonText),this.Pe(2,CommonUIStrings.l_DialogClose)):(this.Gd=6,this.Pe(0,CommonUIStrings.l_DialogClose)):this.Gd=5;ba=document.createElement("span");this.gYc&&(ba.className=this.gYc);B=document.createElement("a");B.innerText=this.Gqc;B.href=b;B.target="_blank";B.id=this.Nbd;
B.className=Dd.AFrame.Thf;if(la=!X.a.K7&&!!L&&0<L.count){const $b=za.a.PMf(b,L);L=za.a.zsg(b,L);B.href="#";B.target="_self";this.$x=document.createElement("form");this.$x.id="printPreviewPostForm1";this.$x.method="post";this.$x.target="_blank";this.$x.action=L;for(var Lb of $b)L=document.createElement("input"),L.type="hidden",L.name=Lb.key,L.value=Lb.value,this.$x.appendChild(L)}else this.$x=null;this.$x||Tc.fmc?Tc.fmc||Array.add(Cb,{["type"]:"AppLinkProps",["id"]:this.Nbd,["text"]:this.Gqc,["onExecute"]:()=>
{this.Gyj()}}):Array.add(Cb,{["type"]:"AppLinkProps",["id"]:this.Nbd,["text"]:this.Gqc,["handler"]:{["href"]:la?"#":b,["target"]:la?"_self":"_blank"}});this.Hbb&&Array.add(fb,this.Hbb);n?(b=document.createElement("span"),b.innerText=this.Hbb.replace("{0}",""),ba.appendChild(b)):this.iej?(b=document.createElement("span"),b.id=this.Sj("message"),Lb=document.createElement("span"),L=document.createElement("span"),la=this.Hbb.split("{0}"),Lb.innerText=la[0],L.innerText=la[1],b.appendChild(Lb),b.appendChild(B),
b.appendChild(L),ba.appendChild(b)):(b=document.createElement("span"),b.innerText=this.Hbb,ba.appendChild(b),ba.appendChild(document.createElement("br")),ba.appendChild(document.createElement("br")),ba.appendChild(B),Tc.fmc||Array.add(fb,"{0}"));this.$x&&ba.appendChild(this.$x);Tc.bO&&(this.oub&&(this.tbd?this.wNh(this.oub,this.tbd):(Array.add(fb,"{0}"),Array.add(Cb,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.oub,["onExecute"]:()=>{}}))),this.WQd(fb,Cb));this.Qub(La,null,this.ZTf,
null,this.Zra,Tc.bO?null:ba);this.L8(this.Sj("message"));!Tc.bO&&this.tbd&&this.oub&&(La=document.createElement("div"),La.className="WACDialogLearnMoreLinkContainer",this.Y5=document.createElement("a"),this.Y5.innerText=this.oub,this.Y5.href=this.tbd,this.Y5.target="_blank",this.Y5.id=this.Sj("LearnMoreLinkId"),this.Y5.className=Dd.AFrame.Thf,La.appendChild(this.Y5),h?this.Oc.insertBefore(La,this.Oc.lastChild):this.Oc.appendChild(La),this.L8(String.format("{0} {1}",this.Sj("message"),this.Sj("LearnMoreLinkId"))));
this.KGc=B;n?this.v4(this.oJ):this.v4(this.KGc);this.Jie();A.AFrameworkApplication.ua.i9.nb(Cd.a.click,this.KGc,Object(z.a)(this,this.Eii,"downloadLinkClicked"),null);this.Y5&&A.AFrameworkApplication.ua.i9.nb(Cd.a.click,this.Y5,Object(z.a)(this,this.O6i,"learnMoreLinkClicked"),null);this.eZ=!1}get ZTf(){return null}get cJg(){return null}get Hbb(){return null}get r_h(){return this.Xpk}get tbd(){return null}get oub(){return null}get iej(){return!1}get buttonText(){return CommonUIStrings.l_Open}get gYc(){return null}get cSd(){return null}get UQh(){return null}get Vde(){return!1}get fee(){return!1}O8h(){this.Uaa({SourceControlId:"CopyLink"},
{ControlId:"CopyLink"})}$Zl(){this.Uaa({SourceControlId:"Share"},{ControlId:"Share"})}Uaa(b,h){const n=A.AFrameworkApplication.va;n.iE=8;n.Pb(Pa.a.Uaa,2,b,h)}cra(){this.$x&&(this.m7b||(this.m7b=this.ITn,this.Cr.nb(Cd.a.click,this.oJ,this.m7b)),this.n7b||(this.n7b=this.JTn,this.ne.nb(Cd.a.oi,this.oJ,this.n7b)));super.cra()}kcd(){}Eii(){this.o6f();this.$x?this.$x.submit():this.dRe.uhi();return!0}O6i(){return!1}dispose(){this.dRe.dispose();this.KGc&&(A.AFrameworkApplication.ua.i9.xc(Cd.a.click,this.KGc,
Object(z.a)(this,this.Eii,"downloadLinkClicked")),this.KGc=null);this.Y5&&(A.AFrameworkApplication.ua.i9.xc(Cd.a.click,this.Y5,Object(z.a)(this,this.O6i,"learnMoreLinkClicked")),this.Y5=null);this.Cr&&this.m7b&&(this.Cr.xc(Cd.a.click,this.oJ,this.m7b),this.m7b=null);this.ne&&this.n7b&&(this.ne.xc(Cd.a.oi,this.oJ,this.n7b),this.n7b=null);super.dispose()}Gyj(){this.$x&&(document.body.appendChild(this.$x),this.$x.submit(),document.body.removeChild(this.$x))}static get bO(){return A.AFrameworkApplication.ua.Ib.cH&&
A.AFrameworkApplication.ua.Ib.y1i}static get fmc(){return Tc.qlh}static set fmc(b){Tc.qlh=b}}Tc.qlh=!1;Object(u.a)(Tc,"ADialogWithLinkToResource",ui.StandardDialog,[]);class vd extends Tc{constructor(b,h,n=null,B=!0,L=!1,ba=null){super(b,!0,!(vd.uAb&&B),new Rb(b,h),n,L,ba);vd.uAb=vd.uAb&&B;if(vd.uAb){h=document.createElement("iframe");B=null;L=this.Rfi;h.name="pdfObjectFrame";h.id="pdfObjectIFrame";if(n&&0<n.count){ba=za.a.PMf(b,n);b=za.a.zsg(b,n);B=document.createElement("form");B.id="printPreviewPostForm";
B.method="POST";B.target=h.name;B.action=b;for(const la of ba)b=document.createElement("input"),b.type="hidden",b.name=la.key,b.value=la.value,B.appendChild(b)}else h.src=b;L.appendChild(h);B&&(L.appendChild(B),B.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");Bc.a.Ls(h,Bc.a.JB,Bc.a.hq)}}get ZTf(){return"Print_32x32x32"}get cJg(){return vd.uAb?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get Hbb(){return vd.uAb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get cSd(){const b=
[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Tc.fmc){let h=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==A.AFrameworkApplication.ua.Ib.Ici&&(h=A.AFrameworkApplication.ua.Ib.Ici);Array.add(b,h)}return vd.uAb?b:null}get Gqc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get Nbd(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get gYc(){return A.AFrameworkApplication.O7a?"UIFontDialogTextLarge":null}Jie(){x.ULS.sendTraceTag(7690390,
324,50,"Legacy print dialog displayed")}o6f(){A.AFrameworkApplication.wm.s$a(9540);x.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}kcd(){x.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get uAb(){return!!A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.cH&&A.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(X.a.K7||X.a.Mt||X.a.uj||X.a.XR)&&!A.AFrameworkApplication.xad&&A.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")&&
vd.XJh}static set uAb(b){vd.XJh=b}}vd.XJh=!1;Object(u.a)(vd,"PrintDialogWithLinkToPdf",Tc,[]);class Td{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");this.Uon=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.lln=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.i1b=(b.DirectPrintSupportedMimeTypes||"").split(Td.Wxf);this.kzb=(b.DirectPrintSupportedPlugins||"").split(Td.Wxf);this.F3m=(b.DirectPrintImmersivePreviewPlugins||"").split(Td.Wxf);this.UXi=
Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.ffn=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.nql=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.q9f=14;this.tej=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.q9f=parseInt(h[0]),this.tej=parseInt(h[1])):x.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else x.ULS.sendTraceTag(20734113,208,
15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}Td.Wxf=",";Object(u.a)(Td,"DirectPrintBrsSettings",null,[]);class Ed{constructor(b,h){this.CGg=b;this.kzb=h}}Object(u.a)(Ed,"DirectPrintProbeResults",null,[]);var lf=d(202);class Bf{constructor(b,h,n,B,L,ba,la,La,fb,Cb){this.OPd=null;this.LGm=()=>{var Lb=this.wMm();const $b=this.$ko(),tc={},Nc={};for(let dd=0;dd<this.fU.i1b.length;dd++)tc[this.fU.i1b[dd]]=Lb[dd];for(Lb=0;Lb<this.fU.kzb.length;Lb++)Nc[this.fU.kzb[Lb]]=
$b[Lb];return new Ed(tc,Nc)};this.ztk=b;this.ZLc=h;this.D1e=n;this.XAk=B;this.fCk=L;this.ZNc=new Rf.a(this.LGm);this.nGc=ba;this.lth=fb;this.qW=la;this.ZJc=La;this.ACk=Cb}get fU(){return this.ztk}start(){}hgo(){this.fU.Uon&&this.QEn()}Zko(){const b=Array(this.fU.i1b.length);if(void 0!==this.ZLc&&null!==this.ZLc)for(let h=0;h<this.fU.i1b.length;h++)b[h]=this.fU.i1b[h]in this.ZLc&&this.XAk(this.ZLc[this.fU.i1b[h]]);return b}$ko(){const b=Array(this.fU.kzb.length),h=!(void 0===this.D1e||null===this.D1e);
for(let n=0;n<this.fU.kzb.length;n++){const B=this.fU.kzb[n];b[n]=h&&B in this.D1e?!0:this.fCk(B)}return b}wMm(){const b=this.Zko(),h=Array(b.length);for(let n=0;n<b.length;n++)h[n]=b[n]?this.q5l(this.ZLc[this.fU.i1b[n]]):null;return h}q5l(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}QEn(){x.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.ZNc.value.CGg,this.ZNc.value.kzb)}a5o(){return this.ACk||!this.fU.isEnabled||A.AFrameworkApplication.xad?
!1:this.Oep()}g5o(){if(null!=this.OPd)return this.OPd;const b=Bf.TXi(this.fU);return this.OPd=this.fU.UXi&&b||this.dfn()}dfn(){return X.a.Vr&&this.fU.ffn&&X.a.mql>=this.fU.nql?!0:!1}Oep(){if(!this.ZJc(this.fU))return!1;var b=Yb.a.U9a(this.ZNc.value.CGg);for(const h of b)if(void 0!==h&&null!==h)return!0;b=Yb.a.U9a(this.ZNc.value.kzb);for(const h of b)if(h)return!0;return!1}PYm(){const b=Yb.a.U9a(this.ZNc.value.CGg);for(const h of b)if(lf.a.contains(this.fU.F3m,h))return!0;return!1}D7o(b,h=null){A.AFrameworkApplication.ua&&
A.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?this.lth(b,h):this.a5o()?this.xVl(b,this.PYm()&&!0,h):this.lth(b,h)}xVl(b,h,n=null){const B=this.qW.Vf("UserAction","OpenDirectPrintDialog");this.nGc.Mpm(b,h,n).SJa();B.stop()}static Rrn(b){try{return new ActiveXObject(b),!0}catch(h){x.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static gin(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=
new Td(A.AFrameworkApplication.K.appSettings);let n=null;try{n=window.navigator.mimeTypes}catch(Cb){x.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let B=null;try{B=window.navigator.plugins}catch(Cb){x.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const L=Bf.gin,ba=Bf.Rrn;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const la=A.AFrameworkApplication.ua.hs,La=Bf.Srn,fb=!!A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.cH&&
!A.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");return new Bf(h,n,B,L,ba,b,la,La,(Cb,Lb)=>new vd(Cb,!1,Lb,!0,fb),A.AFrameworkApplication.Ola)}static Srn(b){return X.a.Vr||X.a.Mt&&b.lln||b.UXi&&Bf.TXi(b)?!0:!1}static TXi(b){var h=X.a.Bhc;if(h){var n=h.split(".");if(2===n.length)return h=parseInt(n[0]),n=parseInt(n[1]),h>b.q9f||h===b.q9f&&n>=b.tej}return!1}}Object(u.a)(Bf,"DirectPrintManager",null,[743]);class vf{constructor(){this.SCb=this.W=null}get name(){return"Common.App.DirectPrint"}wc(b){this.W=
b;b.register(Jb,"Common.App.DirectPrint.DirectPrintDialogFactory").ha().Rd(()=>new Jb(A.AFrameworkApplication.ua.i9));b.register(743,"Common.App.DirectPrint.IDirectPrintManager").ha().Rd(()=>Bf.create(this.W))}init(){this.SCb=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.SCb.start()}dispose(){}}Object(u.a)(vf,"PackageManager",null,[0,1]);class fd{constructor(b,h=3E4){this.tJg=9E5;this.vJg=1E4;this.vbj=this.orc=null;this.B7f=0;this.qob=Date.now;this.AOm=b;this.jfb=h;this.k5d()}zJi(b=
!0){const h=this.qob();if(h<this.B7f+this.tJg)return h>this.B7f+this.vJg&&this.k5d(),this.vbj;b&&this.k5d();return null}getToken(b=!0){return(b=this.zJi(b))?Promise.resolve(b):this.k5d()}k5d(){return this.orc=this.orc||new Promise(b=>{this.AOm().then(h=>{this.orc=null;""!==h&&h&&(this.vbj=h,this.B7f=this.qob(),b(h));b(null)}).catch(()=>{this.orc=null;b(null)});window.setTimeout(()=>{this.orc=null;b(null)},this.jfb)})}}Object(u.a)(fd,"OAuthCacheManager",null,[]);var Wc=d(129),sg=d(309);class Jf{constructor(){this.Tba=
null;this.Pgh={};this.u0a=new Fa.a(Qa.a.th())}getToken(b,h){if(this.u0a.mb(h))return this.u0a.J(h).getToken();const n=new fd(()=>this.AJi(b,h));this.u0a.Z(h,n);return n.getToken()}zOm(b,h){if(this.u0a.mb(h))return this.u0a.J(h).zJi();const n=new fd(()=>this.AJi(b,h));this.u0a.Z(h,n);return null}AJi(b,h){if(!this.Tba)try{this.Tba=Ya.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(n){x.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+n)}return this.Tba?new Promise(n=>
{const B=Date.now();this.Tba.wV(b,h).then(L=>{const ba=L.Token;!L.IsSuccess||this.Nsn(ba)?(this.Ewc("GetTokenInternalImplicitJS",!1,Date.now()-B,b,L.ErrorCode,L.ErrorMessage,h),n(null)):(this.Ewc("GetTokenInternalImplicitJS",!0,Date.now()-B,b,L.ErrorCode,L.ErrorMessage,h),n(ba))}).catch(L=>{L=L?D.c(L):"";this.Ewc("GetTokenInternalImplicitJS",!1,Date.now()-B,b,"Caught Exception",L,h);n(null)})}):new Promise(n=>{this.Ewc("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");
n(null)})}Ewc(b,h,n,B,L="",ba="",la=""){var La="Search"===B;const fb=[];b=Wc.a.bba(La?"Event":"EventName",b,2);B=Wc.a.bba("AppName",B,2);Array.add(fb,b);Array.add(fb,B);La&&(B=Wc.a.bba("LatencyType","FetchToken",2),Array.add(fb,B));L&&""!==L&&(L=Wc.a.bba("ErrorCode",L,2),Array.add(fb,L));ba&&""!==ba&&(ba=Wc.a.bba("ErrorMessage",ba,2),Array.add(fb,ba));la&&""!==la&&(ba=!(la in this.Pgh),this.Pgh[la]=ba,ba=Wc.a.bba("WarmUpCall",ba.toString(),1),Array.add(fb,ba),la=Wc.a.bba("Service",this.yKm(la),2),
Array.add(fb,la));La=La?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";h=Object.assign(new sg.a,{name:La,samplingPolicy:2,dataFields:fb,succeeded:h,durationMs:n});aa.a.sendActivityEvent(h)}yKm(b){return b===A.AFrameworkApplication.k7f?"Loki":b===A.AFrameworkApplication.uGg?"Substrate":A.AFrameworkApplication.K&&b===A.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}Nsn(b){return!b||!b.length}}Object(u.a)(Jf,"SearchOAuthManager",null,
[706]);class Qk{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}wc(b){this.W=b;this.W.register(706,"Common.App.SearchCommon.ISearchOAuthManager").ha().Rd(()=>new Jf)}init(){}dispose(){}static main(){M.a.instance.Jc(new Qk)}}Object(u.a)(Qk,"SearchOAuthPackage",null,[0,1]);var $e=d(22),Ei=d(233),ve=d(6),Ad=d(13),re=d(17),ea=d(8);class eb{constructor(b,h,n){this.u2e=this.vHb=this.r2e=this.uHb=this.t_e=null;this.dVm=B=>{try{this.cVm(B)}catch(L){B=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",
L.message,L.stack),x.ULS.sendTraceTag(5285580,334,10,B)}};this.Rp=b;this.luk=h;this.hb=n;this.init()}init(){this.luk.nb(this.dVm);this.uHb=new Lf.a;this.r2e=new Lf.a;this.vHb=new Lf.a;this.u2e=new Ei.a}kY(b){this.uHb.add(b.key,b)}iZb(b){this.vHb.add(b.key,b)}cVm(b){let h;const n=this.hb.gb.currentSelection;({Cvf:h}=eb.mpp(n)).returnValue&&(b=eb.pnm(b,this.t_e,h),this.Bgo(b,h,n),this.t_e=h)}Bgo(b,h,n){b=this.Mgm(b,h,n);let B;({notification:B}=eb.cpp(b)).returnValue&&this.Rp.sendNotification(B,!1)}Mgm(b,
h,n){const B=new Lf.a;B.Z(1,new Ei.a);B.Z(0,new Ei.a);b.forEach(L=>{3===L?(eb.BCg(h.node)||this.cFo(h,n),this.rEm(B,h)):L||this.Onm(B,h);return!0});return B}cFo(b,h){this.uHb.forEach((n,B)=>{B.reset(b,h);return!0})}Onm(b,h){let n=new Lf.a;eb.BCg(h.node)||(n=this.Mnm(h.cpBegin));this.Nnm(b,this.r2e,n,eb.fLj(this.t_e,h));this.r2e=n}Mnm(b){const h=new Lf.a;this.uHb.forEach((n,B)=>{n=null;({zG:n}=B.$Ea(b)).returnValue&&h.Z(B.key,n);return!0});return h}Nnm(b,h,n,B){const L=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;
h.forEach((ba,la)=>{const La=this.uHb.J(ba).Av||la.title;let fb;({value:fb}=n.Dc(ba)).returnValue?B&&fb.contentObject!==la.contentObject&&(La&&b.J(1).add(La),ba=this.uHb.J(ba).Av,ba=String.format(L,fb.title,ba),fb.description&&(ba+=", "+fb.description),b.J(0).add(ba)):La&&b.J(1).add(La);return!0});n.forEach((ba,la)=>{h.mb(ba)||(ba=this.uHb.J(ba).Av,ba=String.format(L,la.title,ba),la.description&&(ba+=", "+la.description),b.J(0).add(ba));return!0})}rEm(b,h){h=this.SLm(h.node);h=this.iul(h);this.TLm(b,
this.u2e,h);this.u2e=h}SLm(b){const h=new ve.GraphIterator;h.set(b);if(!h.zb(1))return null;const n=new Ei.a;for(;1!==h.lf;)this.vHb.forEach((B,L)=>{let ba;({Zea:ba}=L.f2b(h)).returnValue&&n.add(ba);return!0}),h.uc();n.reverse();return n}iul(b){b=b.toArray();let h=0;for(;h<b.length-1;){var n=b[h];if(n.UF===b[h+1].UF&&(this.vHb.J(n.UF),({mul:n}={returnValue:!1,mul:null}).returnValue)){b.splice(h,2,n);continue}h++}return new Ei.a(b)}TLm(b,h,n){var B;for(B=0;B<Math.min(n.length,h.length)&&n.J(B).contentId.equals(h.J(B).contentId);B++){var L=
this.vHb.J(n.J(B).UF).Fqb(n.J(B),h.J(B));L&&(n.J(B).description&&(L+=", "+n.J(B).description),b.J(0).add(L))}for(L=B;L<n.length;L++){let ba=this.vHb.J(n.J(L).UF).Fqb(n.J(L),null);ba&&(n.J(L).description&&(ba+=", "+n.J(L).description),b.J(0).add(ba))}for(n=B;n<h.length;n++)(B=this.vHb.J(h.J(n).UF).Av)&&b.J(1).add(B)}static pnm(b,h,n){const B=new Ei.a;(b=b||eb.FNo(h,n))?(B.add(3),B.add(0)):eb.fLj(h,n)&&B.add(0);return B}static FNo(b,h){return!b||!b.node.id.equals(h.node.id)}static fLj(b,h){return!b||
!b.equals(h)}static mpp(b){let h=null;if(!b||!(re.SelectionEditor.Dm(b)||(b=re.SelectionEditor.Wj(b,!0,!1),re.SelectionEditor.Dm(b)||b.Ra&&eb.BCg(b.Ra.node))))return{returnValue:!1,Cvf:h};h=b.Ra;return{returnValue:!!h,Cvf:h}}static cpp(b){const h=new Ei.a;b.J(1).forEach(n=>{n=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,n);h.add(n);return!0});b.J(0).forEach(n=>{n=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,n);h.add(n);return!0});b=h.toArray().join(" ");
return{returnValue:0<h.length,notification:b}}static BCg(b){return Ad.ImageReader.Lt(b)||ea.ParagraphReader.Wza(b)}}Object(u.a)(eb,"AccessibilityContextManager",null,[705]);class Ob{constructor(b,h){this.pqh=!1;this.kPc=null;this.lMd=this.EPd=!1;this.kgh=null;this.jSd=(n,B)=>{(B.hQ||B.zva)&&this.YRn(B.hQ,B.zva)};this.Gb=b;this.rQ=h}get IZm(){return!!this.kPc}nb(b){this.pqh||(this.rQ.LPh(this.jSd),this.pqh=!0);this.kgh=b}YRn(b,h){this.IZm&&this.Gb.vf(this.kPc);this.EPd=this.EPd||b;this.lMd=this.lMd||
h;this.kPc=new Re.a(5,1,Ob.c3l,()=>{this.kgh(this.EPd,this.lMd);this.reset()},126);this.Gb.Zb(this.kPc)}reset(){this.kPc=null;this.lMd=this.EPd=!1}}Ob.c3l=100;Object(u.a)(Ob,"EditingViewOnAfterValidateEventsConsolidator",null,[704]);var Zb=d(52);class mc{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){$e.App.KUh&&this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}wc(b){this.W=b;b.ia("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",
()=>new Ob(A.AFrameworkApplication.mc,b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ha();b.ia("Box4.Accessibility.AccessibilityContextManager",()=>new eb(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),Zb.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").ha()}static main(){M.a.instance.Jc(new mc)}}Object(u.a)(mc,"Box4AccessibilityPackage",
null,[0,1]);var Yc=d(200),ld=d(1147),oe=d(1741),Vd=d(968),ce=d(191),pe=d(1607),Sd=d(44),Oe=d(25),ef=d(108),Nd=d(28),wb=d(3);class ki extends pe.a{get iCa(){return null!=this.G_g?this.G_g:this.G_g=Ya.a.instance.Oa("Box4.IInternalLinkManager")}get kuj(){return null!=this.m3g?this.m3g:this.m3g=Ya.a.instance.Oa("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get wE(){return!0}get commandId(){return wb.a.Fal}csa(b){ce.a.mark(7012);const h=new Sd.GraphTransaction(15);h.Ab(b);var n=this.HI,B=this.U3,
L=ea.ParagraphReader.text(b),ba=L.substring(n,B);const la=({acg:La}=F.a.bGg(ba)).returnValue;ba!==la&&(n+=La,B=n+la.length);ba=Nd.a.createTextRange(b,n,B);var La=L.substring(n,B);ki.fln(L,n,B)&&(this.Qd.Ne(Nd.a.createTextRange(b,n-1,B+1),La,!0,!1),--n,--B,ba=Nd.a.createTextRange(b,n,B),n=Oe.SelectionFactory.se(b,B),Zb.a.instance.Ic(n));n=ef.a.VKa(La);ki.Np.vF(ba,n,!1);L=La="";B=!1;this.iCa&&({Rrg:La,ZOb:L}=this.iCa.wKg(n)).returnValue&&(n=La,B=!0,La=ef.a.QA(ba,!1),ki.Np.hV(La[0].paragraph,La[0].hyperlink),
""!==L&&(this.Qd.Ne(ba,L,!0,!1),ba=Nd.a.createTextRange(b,this.HI,this.HI+L.length),b=Oe.SelectionFactory.se(b,this.HI+this.HI+L.length),Zb.a.instance.Ic(b)),ki.Np.vF(ba,n,!1));h.dispose();!B&&this.kuj&&this.kuj.gdo(ba,n);ce.a.mark(7013)}set wE(b){super.wE=b}static get Np(){return null!=ki.IYg?ki.IYg:ki.IYg=Ya.a.instance.resolve("Box4.IHyperlinkEditor")}static fln(b,h,n){n=n!==b.length&&('"'===b.charAt(n)||"\u201d"===b.charAt(n));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&n}}Object(u.a)(ki,
"HyperlinkAction",pe.a,[]);class cj{constructor(b){this.Qd=b}oGl(b,h,n){return new ki(null,b,h,n,this.Qd)}}Object(u.a)(cj,"HyperlinkActionFactory",null,[701]);var Pd=d(256);class Me{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}wc(b){this.W=b;b.ia("Box4.AutoCorrect.AutoCorrectRules",()=>new oe.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),Pd.a.instance,A.AFrameworkApplication.va,A.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),
b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").ha();b.ia("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>new ld.a(b.resolve("Box4.IRoamingServiceRequestManager"),A.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").ha();b.ia("Box4.AutoCorrect.AutoCorrectScheduler",()=>new Vd.a(b.resolve("Box4.IAutoCorrectRules"),Zb.a.instance,Yc.a.instance,A.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),
b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").ha();b.ia("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new cj(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").ha()}init(){this.W.resolve("Box4.IAutoCorrectRules").Xzn();const b=A.AFrameworkApplication.K;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").tim()}dispose(){}static main(){M.a.instance.Jc(new Me)}}
Object(u.a)(Me,"Box4AutoCorrectPackage",null,[0,1]);class Eg{get name(){return"Box4.Clipboard"}init(){}dispose(){}wc(){}static main(){M.a.instance.Jc(new Eg)}}Object(u.a)(Eg,"Box4ClipboardPackage",null,[0,1]);class Hj{get name(){return"Box4.ImageEditors"}wc(){}init(){}dispose(){}static main(){M.a.instance.Jc(new Hj)}}Object(u.a)(Hj,"Box4ImageEditorsPackage",null,[0,1]);var Ui=d(660),Wj=d(769),dj=d(723),kk=d(693),Gb=d(1235);class Pc{constructor(){this.ChangeStateList=this.Revision=null}static construct(b,
h,n,B,L){const ba=new Pc;ba.DocumentId=L;ba.UserId=n;ba.WACSessionId=B;ba.Revision=b;ba.ChangeStateList=Gb.a.cMj(h);return ba}}Object(u.a)(Pc,"LocalUnsavedChange",null,[]);class xd{constructor(){this.uie=null}nFe(b){return new Promise((h,n)=>{this.Z9h().then(B=>{const L=B.transaction(xd.dcd,"readwrite");L.objectStore(xd.dcd).put(b);L.oncomplete=()=>h();L.onerror=()=>n(L.error.message)}).catch(n)})}fWd(b,h,n){return new Promise((B,L)=>{this.Z9h().then(ba=>{const la=ba.transaction(xd.dcd,"readwrite");
la.objectStore(xd.dcd).delete([b,h,n]);la.oncomplete=()=>B();la.onerror=()=>L(la.error.message)}).catch(L)})}static isSupported(){return"indexedDB"in window}Z9h(){return new Promise((b,h)=>{if(xd.isSupported())if(this.uie)b(this.uie);else{var n=window.indexedDB.open(xd.hBn,xd.iBn);n.onsuccess=()=>{this.uie=n.result;b(n.result)};n.onerror=()=>{h(n.error.message)};n.onupgradeneeded=()=>{const B=n.result,L=B.createObjectStore(xd.dcd,{keyPath:["DocumentId","UserId","WACSessionId"]});L.createIndex("DocumentId, UserId",
["DocumentId","UserId"],{unique:!1});L.createIndex("UserId",["UserId"],{unique:!1});this.uie=B;b(B)}}else h("This browser does not support IndexedDB.")})}}xd.hBn="LocalUnsavedChangeDatabase";xd.iBn=1;xd.dcd="LocalUnsavedChange";Object(u.a)(xd,"LocalUnsavedChangeStore",null,[]);class He{constructor(b,h,n,B,L,ba){this.$9i=b;this.Ddb=h;this.mCm=n;this.t3c=B;this.Anl=L;this.gEa=ba}initialize(){const b=Wj.a.GNf(this.mCm());this.zZd=this.jYc=b;this.gEa.y1k(this.Knj.bind(this));this.gEa.z1k(this.Lnj.bind(this))}dispose(){this.gEa.TAo(this.Knj.bind(this));
this.gEa.UAo(this.Lnj.bind(this))}Knj(b,h){this.rxp(h.GD)}Lnj(b,h){this.Xtp(h.GD)}Xtp(b){b.equals(this.jYc)||(this.jYc=b,b.equals(this.zZd)?this.fWd():this.nFe())}rxp(b){b.equals(this.zZd)||(this.zZd=b,b.equals(this.jYc)?this.fWd():this.nFe())}hHl(){const b=Object(kk.b)({GD:this.zZd,zm:this.jYc,fileId:this.t3c().kq,dha:this.t3c().dha,contextId:this.t3c().contextId,w2d:this.jYc.id,Ddb:this.Ddb,ree:dj.a.VSb(this.t3c()),Hbe:!1,cellId:this.t3c().td.id},!1);return Pc.construct(b,this.Anl.N2c(),He.userId,
He.sessionId,He.documentId)}nFe(){const b=this.hHl();this.$9i.nFe(b).then(()=>{x.ULS.sendTraceTag(509366736,306,50,"Successfully updated local unsaved change with LatestRevision: {0}",b.Revision.Id)}).catch(h=>{x.ULS.sendTraceTag(509366735,306,10,"Failed to update local unsaved change because {0}",h)})}fWd(){this.$9i.fWd(He.documentId,He.userId,He.sessionId).then(()=>{x.ULS.sendTraceTag(509366734,306,50,"Successfully clear local unsaved change.")}).catch(b=>{x.ULS.sendTraceTag(509366733,306,10,"Failed to clear local unsaved change because {0}",
b)})}static isSupported(){return xd.isSupported()&&null!=this.documentId&&null!=this.userId&&null!=this.sessionId}static get documentId(){return null!=He.KVg?He.KVg:He.KVg=A.AFrameworkApplication.sessionStartInfoSettings.ServerDocId}static get userId(){return null!=He.W6g?He.W6g:He.W6g=A.AFrameworkApplication.K.kb("LoggableUserId")}static get sessionId(){return null!=He.Y3g?He.Y3g:He.Y3g=A.AFrameworkApplication.K.kb("SessionId")}}Object(u.a)(He,"LocalUnsavedChangeManager",null,[645]);class af{get name(){return"Box4.LocalUnsavedChange"}init(){this.EXi()&&
He.isSupported()&&(this.W5f=this.container.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeManager"),this.W5f.initialize())}dispose(){this.W5f&&this.W5f.dispose()}wc(b){this.container=b;if(this.EXi()){b.ia("Box4.LocalUnsavedChange.LocalUnsavedChangeStore",()=>new xd).ha();var h=(n,B,L)=>new Ui.a(n,B,L);b.ia("Box4.LocalUnsavedChange.LocalUnsavedChangeManager",()=>new He(b.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeStore"),h,()=>Ua.StaticActiveAppFrame.za().ib.$c.td,()=>Ua.StaticActiveAppFrame.za().ib.$c,
b.resolve("Box4.CatchUpActivity.IChangeStateManager"),b.resolve("Box4.Revision.RevisionSequenceNumberManager"))).ha()}}static main(){M.a.instance.Jc(new af)}EXi(){return A.AFrameworkApplication.K.$("DisconnectedScenarioIsEnabled")}}Object(u.a)(af,"LocalUnsavedChangePackage",null,[0,1]);class mf{get name(){return"Box4.NotebookLevelEditors"}wc(){}init(){}dispose(){}static main(){M.a.instance.Jc(new mf)}}Object(u.a)(mf,"Box4NotebookLevelEditorsPackage",null,[0,1]);var dg=d(1622);class $f{get name(){return"Box4.Search"}wc(b){b.ia("Box4.Search.FindManagerHelper",
()=>dg.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").ha()}init(){}dispose(){}}Object(u.a)($f,"PackageManager",null,[0,1]);class ih{get name(){return"Box4.TableEditors"}wc(){}init(){}dispose(){}static main(){M.a.instance.Jc(new ih)}}Object(u.a)(ih,"Box4TableEditorsPackage",null,[0,1]);class bi{get name(){return"Box4.TextLevelEditors"}wc(){}init(){}dispose(){}static main(){M.a.instance.Jc(new bi)}}Object(u.a)(bi,"Box4TextLevelEditorsPackage",null,[0,1]);var Hg=d(131),Og=d(345),zd=
d(187),Zd=d(453),df=d(323);class An{constructor(b,h,n){this.nx=this.eRa=this.mTa=null;this.cG=this.uPe=this.tQa=0;this.Ipa=this.UEd=this.O2a=this.N2a=!1;this.HDd=this.umh=this.xmh=0;this.IGa=b;this.ga=h;this.eo=n}VR(b){return!Ua.StaticActiveAppFrame.za().ib.isEditingAllowed||hc.SessionStatusManager.instance.Gk?!1:""!==this.u3c(b.Nf)}KN(b){if(!this.VR(b))return!1;this.rUo(b);this.cG=this.IGa.Tjc();this.oXo(b);this.pXo();({poc:this.UEd,Npc:this.Ipa}=this.sPj(this.uPe));this.qXo();this.mTa=b.uK;this.nx=
new Sys.UI.Point(0,0);[this.xmh,this.umh]=this.IGa.getDimensions();x.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}VX(b){this.eRa=b.uK;this.Jil();this.HDd=df.d(this.nx.x,this.nx.y,this.xmh,this.umh,this.UEd,this.Ipa,this.HDd,A.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));this.IGa.JMg(this.HDd,this.UEd,this.Ipa);return!0}LF(){this.setSize();x.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}E0(){this.IGa.evg();x.ULS.sendTraceTag(16802337,
322,50,"Image resize drag canceled")}rUo(b){this.IGa=Hg.a.Eb(b.Nf,Zd.a)}pXo(){this.uPe=(Math.floor((this.cG+22)/45)%8+this.tQa)%8}sPj(b){let h,n;if(this.cG&&90!==this.cG&&180!==this.cG&&270!==this.cG&&360!==this.cG||this.iln(b))return{poc:!0,Npc:!0};h=n=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:n=!0}return{poc:n,Npc:h}}qXo(){this.O2a=this.N2a=!1;switch(this.uPe){case 0:this.O2a=this.N2a=!0;break;case 1:case 2:this.O2a=!0;break;case 7:case 6:this.N2a=!0}}iln(b){return!(b%2)}u3c(b){var h=
b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const n=b[h].toString();if(n.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==n)return n}return""}oXo(b){switch(this.u3c(b.Nf)){case "WACImageResizeHandleNW":this.tQa=0;break;case "WACImageResizeHandleN":this.tQa=1;break;case "WACImageResizeHandleNE":this.tQa=2;break;case "WACImageResizeHandleE":this.tQa=3;break;case "WACImageResizeHandleSE":this.tQa=
4;break;case "WACImageResizeHandleS":this.tQa=5;break;case "WACImageResizeHandleSW":this.tQa=6;break;case "WACImageResizeHandleW":this.tQa=7}}Jil(){var b=1;this.eo.instance&&(b=this.eo.instance.Aj);const h=(this.eRa.x-this.mTa.x)/b;b=(this.eRa.y-this.mTa.y)/b;this.nx.x=this.N2a?-h:h;this.nx.y=this.O2a?-b:b}setSize(){const b=new Og.DictionaryPropertySet;b.setValue(zd.a.q7c,100*this.HDd);b.setValue(zd.a.GQi,!0);if(90===this.cG||270===this.cG){let h,n;({poc:h,Npc:n}=this.sPj(this.tQa));b.setValue(zd.a.vUf,
h);b.setValue(zd.a.wUf,n)}else b.setValue(zd.a.vUf,this.UEd),b.setValue(zd.a.wUf,this.Ipa);this.ga.Pb(wb.a.Imc,2,b)}}Object(u.a)(An,"ImageResizeDragAdapter",null,[111]);var Fg=d(138),ym=d(687);class dm{constructor(b,h,n,B){this.aWe=this.eRa=this.mTa=this.GLd=null;this.JId=this.kQd=0;this.Db=null;this.ga=b;this.hb=h;this.eo=n;this.zth=this.zHa=0;this.nd=B}VR(b){return Ua.StaticActiveAppFrame.za().ib.isEditingAllowed&&!hc.SessionStatusManager.instance.Gk&&b&&this.bqn(b.Nf)?(this.GLd=this.hb.Og)?!0:
!1:!1}X3d(){}HNf(){return null}KN(b){if(!this.VR(b))return!1;this.IGa=Hg.a.Eb(b.Nf,Zd.a);if(!this.IGa)return!1;this.dMd=this.IGa.Fca;if(!this.dMd)return!1;this.GLd=this.hb.Og;this.Db=Ad.ImageReader.Qn(this.GLd);if(!this.Db)return!1;this.mTa=this.OVa(b);this.aWe=Sys.UI.DomElement.getBounds(this.dMd);this.kQd=0<Ad.ImageReader.n7d(this.Db)?Ad.ImageReader.n7d(this.Db):0;this.JId=Ad.ImageReader.PKf(this.Db);return!0}VX(b){this.eRa=this.OVa(b);this.Sil();if(this.IGa)return this.IGa.yFe(this.zHa,this.zth),
!0;x.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}LF(){this.kQd=this.zHa=df.e(this.zHa);this.P8()}E0(){this.IGa.yFe(this.JId,0)}bqn(b){return b.classList.contains(ym.c)||b.classList.contains(ym.b)||b.classList.contains(ym.a)||!!b.parentElement&&b.parentElement.classList.contains(ym.a)}OVa(b){return this.nd.zd.U8a(b)}Sil(){var b=1;this.eo&&this.eo.instance&&(b=this.eo.instance.Aj);var h=new Sys.UI.Point(this.aWe.x+this.dMd.clientWidth/
2*b,this.aWe.y+this.dMd.clientHeight/2*b);b=df.a(this.mTa,h);h=df.a(this.eRa,h);this.zHa=Math.round(Fg.a.Elo(h-b));0<this.kQd&&(this.zHa+=this.kQd-this.JId);this.zth=this.zHa;this.zHa+=this.JId}P8(){const b=new Og.DictionaryPropertySet;b.setValue(zd.a.n7c,0);b.setValue(zd.a.vX,this.zHa);this.ga.Pb(wb.a.qba,2,b)}}Object(u.a)(dm,"ImageRotateDragAdapterSimplified",null,[488,111]);class zm{constructor(){this.W=null}get name(){return"Box4.Images"}wc(b){this.W=b;this.W.ia("Box4.Images.ImageResizeDragAdapter",
()=>new An(null,A.AFrameworkApplication.va,Ya.a.instance.Qa("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").ha();this.W.ia("Box4.Images.ImageRotateDragAdapterUpdated",()=>new dm(A.AFrameworkApplication.va,Zb.a.instance,Ya.a.instance.Qa("Common.IZoomManager"),Object(Pb.a)())).as("Box4.Images.IImageRotateDragAdapter").ha()}init(){this.W.resolve("Box4.Images.IImageResizeDragAdapter");this.W.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){M.a.instance.Jc(new zm)}}
Object(u.a)(zm,"Box4ImagesPackage",null,[0,1]);var Mh=d(72),hi=d(125),Lc=d(5),wh=d(538),lg=d(492),ii=d(621),Qh=d(258),fk=d(266),bl=d(1885),Ji=d(1778),yl=d(1294);class ej extends Ji.a{constructor(b,h,n){super(b,h,n);this.HJd=this.Dlb=null}get pV(){return A.AFrameworkApplication.ua.hs}I6d(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}hGe(b){return ej.qoa(b,this.iKi())}iKi(){return ej.Hcf}qoa(b,
h=null){b=this.hGe(b);return 0!==b?(h&&h.gRd(),2===b&&(h=this.I6d(b),this.qq(this.Xxi(b),h)),!1):!0}WAa(b,h){x.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.Rhg=h;ce.a.mark(5576);this.HJd=this.pV.Vf("LoadResource","PictureUploadTime");this.rce()?this.tld(b):this.dtc()}qq(b,h){const n=new ui.StandardDialog;n.Gd=0;n.Gy(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}dtc(){x.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.dtc();this.HJd&&(this.HJd.stop(),
this.HJd=null)}Aeb(){this.Dlb=(new yl.a).create();this.Dlb.message=CommonUIStrings.l_ImageUploadWait;this.Dlb.Gd=5;this.Dlb.Du=!1;this.Dlb.lM(null,null,null)}bfc(){this.Dlb&&(this.Dlb.close(),this.Dlb=null)}static YZm(b,h){b=F.a.xh(b);for(let n=0;n<h.length;++n)if(b.endsWith(h[n]))return!0;return!1}static qoa(b,h=null){h||(h=ej.Hcf);return b?ej.YZm(b,h)?0:2:1}}ej.Hcf=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(u.a)(ej,"PictureUploader",Ji.a,[]);var ch=d(317),gk;(function(b){b[b.eGe=0]=
"validPicture";b[b.oed=1]="noPictureSpecified";b[b.BUi=2]="invalidExtension";b[b.uqe=3]="pictureTooLarge"})(gk||(gk={}));Object(u.b)("PictureValidationResult",gk);var ri=d(57),Hf=d(16),lk=d(46),fi=d(1097);class Ab{constructor(){this.qR=null}}Object(u.a)(Ab,"ImageData",null,[]);var jc=d(146),Jc=d(204),yd=d(51),Be=d(347),we=d(94),wf=d(925),rf=d(1692),xg=d(1751);class Nh extends Ge.a{constructor(b,h=!0){super(!1,!1,Nh.bO);this.v$b=null;this.aih=!1;this.Nz=[];this.er=null;this.cYn=n=>{this.PMk&&(this.er=
this.tQj(n,this.Flb))};this.c4n=()=>{this.er&&this.er.qR&&(this.aih||(this.er.Suo(this.hfg),this.aih=!0),this.er.Tni())};this.hfg=n=>{this.v$b.uploadStatusLabel=n;this.t9(this.titleText,Object(z.a)(this,this.ice,"insertDialogHandler"),this.v$b)};this.Shg=()=>{this.Tvj()};this.onKeyDown=n=>{4!==Ph.FocusManager.instance().Yvj(n)&&n.preventDefault()};this.Flb=b;this.PMk=h;this.Lda=this.qHh=!1;this.G5a=null;this.JSe=!1;this.kh=this.fTl;this.Qg="InsertFileDialog";this.Pe(1,this.BQd);Nh.bO?(this.v$b={["id"]:this.Qg,
["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:this.c4n}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:this.cYn},this.pi(this.titleText,Object(z.a)(this,this.ice,"insertDialogHandler"),this.v$b),this.eZ=!0):(this.showDialog(this.titleText,Object(z.a)(this,this.ice,"insertDialogHandler")),h&&this.DZo(),(b=this.w5d(1))&&this.Nz.push(b),(b=this.w5d(0))&&this.Nz.push(b),this.f8j(),this.eZ=!1)}get e$j(){return this.Flb}validate(){this.er.qR||
x.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.er.qR.value?!0:(Nh.Gy(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}ice(b){1===b&&this.isEnabled()?Nh.bO&&this.er.qR&&!this.er.qR.value?(this.v$b.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.t9(this.titleText,Object(z.a)(this,this.ice,"insertDialogHandler"),this.v$b)):(this.Kae(),this.Flb.WAa(this.er,Object(z.a)(this,this.dispose,"dispose"))):0===b&&this.hide()}DZo(){this.JSe=!1;this.er=
this.tQj(document.getElementById("uploadFrameContainer"),this.Flb);A.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.G5a=this.Shg,Nb.a.addHandler(this.er.dK,"load",this.G5a));this.er.qR||x.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.Tvj()}Tvj(){if(this.er&&!this.JSe){var b=this.er.qR;b&&(Nb.a.addHandler(b,Cd.a.Ti,this.onKeyDown),b=[b],this.Nz=b.concat.apply(b,this.Nz),this.f8j(),this.JSe=!0)}}dispose(){if(this.er&&!Nh.bO){const b=this.er.qR;
b&&Nb.a.removeHandler(b,Cd.a.Ti,this.onKeyDown);this.G5a&&Nb.a.removeHandler(this.er.dK,"load",this.G5a)}this.er=null;super.dispose()}f8j(){if(0<this.Nz.length){const b=new po(this.Nz),h=Ph.FocusManager.instance().gu();h&&(this.Nz[0].focus(),h.Mk=b,h.aS=!0)}}static get bO(){return A.AFrameworkApplication.ua.Ib.cH&&A.AFrameworkApplication.ua.Ib.A1i}static Gy(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}Object(u.a)(Nh,"InsertFileDialog",Ge.a,[]);class Rj{static get kh(){return Ge.a.az(Rj.Mn,
CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}Rj.Mn="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(u.a)(Rj,"InsertImageDialogHtml",null,[]);class Ig extends Nh{constructor(b,h=!0){super(b,h)}get BQd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get fTl(){return Rj.kh}validate(){this.er.qR||
x.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(ya.a)(ej,this.e$j);const h=b.hGe(this.er.qR.value);return 0!==h?(b=b.I6d(h),Nh.Gy(b),!1):!0}}Object(u.a)(Ig,"InsertImageDialog",Nh,[]);class ll extends Ig{constructor(b){super(b)}tQj(b,h){const n=A.AFrameworkApplication.ua.Ib.cH&&A.AFrameworkApplication.ua.Ib.A1i;return new xg.a(b,Object(z.a)(h,h.Yvb,"onUploadFrameInitialized"),Object(z.a)(h,h.ooa,"uploadResponseReceived"),A.AFrameworkApplication.K,!n)}isEnabled(){return ll.KR.Vja(this.e$j.context)}static get KR(){return null!=
ll.TYg?ll.TYg:ll.TYg=Ya.a.instance.resolve("Box4.Images.IImageEditor")}}Object(u.a)(ll,"Box4InsertImageDialog",Ig,[]);class mk{SAl(b){return new Promise((h,n)=>{this.TAl(b).then(B=>{h(B)},B=>{n(B)})})}b8h(b){return new Promise((h,n)=>{const B=new FileReader;B.addEventListener("load",()=>{h(B.result)},!1);B.addEventListener("error",()=>{n("FileReader exception ("+B.error.name+")")});B.readAsDataURL(b)})}TAl(b){return new Promise((h,n)=>{this.b8h(b).then(B=>{this.Asf(B,"image/jpeg").then(L=>{h(L)},
L=>{n(L)})},B=>{n(B)})})}Asf(b,h){return new Promise((n,B)=>{const L=new Image;L.addEventListener("load",()=>{const ba=document.createElement("canvas"),la=ba.getContext("2d");ba.width=L.width;ba.height=L.height;la.drawImage(L,0,0);n(ba.toDataURL(h))});L.addEventListener("error",()=>{B("Image failed to load")});L.src=b})}}Object(u.a)(mk,"ImageFormatConverter",null,[]);var Bh=d(247),rp=d(1143);const Ck=["ImageInsertFailed"];class $l extends ej{constructor(b,h,n,B,L,ba,la,La=!0){var fb;super(b,h,n);
this.Oo=la;this.FGa=this.Km=this.nJ=this.Qf=null;this.R2d="wwpicturesfc";this.kpiName="ImageFileExtension";this.nKc="LocalDeviceUpload";this.X7=new Map;this.Zni=0;this.Elb=null;this.HSe="";this.pxa=0;this.Rp=null;this.dJc="";this.yuh=50;this.Bjh=this.nHc=this.dQc=this.sMc=!1;this.rEk=19922944;this.Ewh=0;this.LSe=[];this.$hh=[];this.Fwh=0;this.o0n=()=>{Jc.a.oV&&this.Oo.fM([25],this.Fe)};this.Lgg=Cb=>{x.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(Cb){var Lb={},
$b=this.nJ?this.nJ.properties.yc.toString():this.Qf.yc.toString();Lb[lg.a.nodeId]=this.nJ?this.nJ.id.toString():this.Qf.id.toString();Lb[lg.a.classId]=$b;this.Rf.hasProperty(Lc.a.imageType)&&(Lb[wh.a.imageType]=this.Rf.getValue(Lc.a.imageType));this.Rf.hasProperty(Lc.a.uX)&&(Lb[wh.a.uX]=this.Rf.getValue(Lc.a.uX));this.Rf.hasProperty(hi.a.Dka)&&(Lb[wh.a.Dka]=this.Rf.getValue(hi.a.Dka));this.Rf.hasProperty(Lc.a.Bub)&&(Lb[wh.a.Bub]=this.Rf.getValue(Lc.a.Bub));rf.d(Cb,this.Qf,this.Km,Lb)&&(this.Zqd(Cb),
$l.jsc++)}else x.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")};this.KXn=Cb=>{if(!this.aWf){var Lb=this.uyi(this.er);Lb&&(this.HSe=Lb.name,this.pxa=Lb.size);if(!this.qoa(Cb,this.er)||!this.bOg(Lb,this.er)){Lb=Object.assign(new rb.a,{extendedProperties:new Map});Lb.extendedProperties.set("type",this.qoa(Cb,this.er)?"Image too large":"FileType invalid");this.Pie(Lb);this.Kie();return}}this.WAa(this.er,null)};this.Rf=B;this.Fn=L;this.ga=ba;this.Fe=Jc.a.pq||Jc.a.oV?ch.a.getInstance(jc.a):
ch.a.getInstance(Bh.a);this.Bth=n.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.Quh=n.ic("ImageUploadMaxByteSize",Number.MAX_VALUE);La&&this.showDialog();null===(fb=Be.StaticSaveItems.P9a())||void 0===fb?void 0:fb.addHandler(this);rp.a.prg(this.o0n)}get UZi(){return this.K.$("JfifImageInsertIsEnabled")}get YR(){return this.nKc}get fileExtension(){return this.HSe}get fileSize(){return this.pxa}get d$j(){return this.Elb}get Dw(){return this.Rp||(this.Rp=Ya.a.instance.resolve("Common.Utils.IAriaNotifier"))}get aWf(){return this.YR===
this.nKc}showDialog(){rf.a(this.K)?(this.Dob=!1,this.er=new xg.a(document.body,Object(z.a)(this,this.Yvb,"onUploadFrameInitialized"),Object(z.a)(this,this.ooa,"uploadResponseReceived"),this.K,!1,void 0,!0)):rf.b()||this.avb&&X.a.HF?(this.Dob=!1,this.er=new xg.a(document.body,Object(z.a)(this,this.Yvb,"onUploadFrameInitialized"),Object(z.a)(this,this.ooa,"uploadResponseReceived"),this.K,!1)):(this.Dob=!0,this.er=(new ll(this)).er)}Xxi(b){switch(b){case gk.oed:return yd.a.oed;case gk.BUi:return yd.a.Y$m;
case gk.uqe:return yd.a.N5f}return mj.a.unknown}tld(b){this.aWf||(this.Qf.Jj()?(x.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),wf.a.instance.oNg(this.Qf.Jj()),this.Qf.Jj().yg.CF(this.Lgg,Object(z.a)(this,this.bYb,"processFailure"),b)):this.bYb(b,157))}Fon(){return rf.c(this.Qf)}Zqd(b){b.Zqd();this.Elb=b.Elb}ooa(b){this.Zni=+new Date-+this.d$j;this.Kie();x.ULS.sendTraceTag(36783364,322,50,"Box4PictureUploader.UploadResponseReceived");rf.e(this,b,this.Qf)}kNg(){x.ULS.sendTraceTag(36783365,
322,50,"Box4PictureUploader.UploadComplete");this.dtc();$l.jsc--;this.ga.Ob(Pa.a.Lfb,2);this.Qf?wf.a.instance.jBc(this.Qf.Jj(),0):x.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.Dw.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}bYb(b,h){var n;if(this.QHo(b))x.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",this.retryCount,h.toLocaleString());else{b=Object.assign(new rb.a,{extendedProperties:new Map});b.extendedProperties.set("result",
h.toLocaleString());Jc.a.pq?this.Fe.logKpiFailure({kpiName:jc.d.$Ka,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:Object(df.c)(jc.d.Llc,b,null,!1)}):(null===(n=A.AFrameworkApplication.K)||void 0===n?0:n.$("ShouldLogPicturesExtendedHealthKpis"))?this.Fe.logKpiFailure({kpiName:Bh.c.oLa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:{name:Bh.c.Gmc,
errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b}}):oa.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",Ck,!1,!0,!1,!1,b);n=this.VBf(h);x.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());b=this.Qf.CL();var B=new Sd.GraphTransaction(15,wb.a.xX);B.Ab(this.Qf);$l.KR.x_a(this.Rf,n);$l.KR.Asg(this.Qf,this.nJ);Ad.ImageReader.mOj(this.Rf,fi.a.UB);B.dispose();
this.GUj(n);this.Fn.Yec(b,!1);this.dtc();$l.jsc--;wf.a.instance.jBc(this.Qf.Jj(),h)}}GUj(b){const h=new ui.StandardDialog;h.Gd=0;h.Gy(yd.a.DUi,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}VBf(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}ugk(){if(this.dJc&&0<this.dJc.length){const b=new Og.DictionaryPropertySet;b.setValue(zd.a.mS,this.dJc);b.setValue(zd.a.L7,!0);this.ga.Pb(wb.a.G2,2,b)}this.m6o()}m6o(){let b=
"";this.Bjh?b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.sMc&&this.nHc&&this.dQc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.sMc&&this.nHc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.sMc&&this.dQc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.dQc&&this.nHc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.dQc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:
this.nHc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.sMc&&(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.GUj(b),this.nhk())}WZk(b){this.dJc+=String.format('<img src="{0}"></img>',b);this.Fwh++}IDn(){this.dQc=!0;x.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new rb.a,{extendedProperties:new Map});b.extendedProperties.set("type","Image too large");this.Pie(b)}GDn(){this.nHc=!0;x.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");
const b=Object.assign(new rb.a,{extendedProperties:new Map});b.extendedProperties.set("type","Filetype invalid");this.Pie(b)}J$i(b){this.Bjh=!0;x.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}ubp(b){const h=new mk;if(this.hGe(b.name)===gk.eGe)return h.b8h(b);if(ej.qoa(b.name,xg.a.Icf)===gk.eGe)return h.SAl(b)}cBl(b){return new Promise(h=>{const n=this.ubp(b);void 0===n&&(this.J$i("Failed starting conversion work"),h());n.then(B=>{B.length>this.rEk?
this.IDn():this.WZk(B);h()},B=>{this.J$i(B);h()})})}ytn(b){return this.hGe(b.name)===gk.eGe||ej.qoa(b.name,xg.a.Icf)===gk.eGe}i$m(){const b=[];if(this.er.qR.files){this.Ewh=this.er.qR.files.length;this.er.qR.files.length>this.yuh&&(this.sMc=!0);this.Aeb();for(let h=0;h<this.er.qR.files.length&&this.yuh;h++){const n=this.er.qR.files[h];this.LSe.push(n.name);this.$hh.push(n.size);n&&(this.ytn(n)?b.push(this.cBl(n)):this.GDn())}}Promise.all(b).then(()=>{this.bfc();this.ugk()});return!0}$$m(){this.Km=
yb.a.create();this.Rf||(this.Rf=new Og.DictionaryPropertySet);this.Bth&&this.FGa&&this.Rf.setValue(hi.a.W9i,this.FGa);var b=480;let h=320;const n=this.context.view.Kh.editingElement.clientWidth;0<n&&n<b&&(h=Math.floor(1*n/b*h),b=n,this.Rf.setValue(hi.a.Dka,n));this.Rf.setValue(Hf.a.lma,ri.a.em(b,0));this.Rf.setValue(Hf.a.kma,ri.a.em(h,1));this.Rf.setValue(lk.a.h0,fi.a.KPa);this.Rf.setValue(zd.a.L7,!0);this.Rf.setValue(Lc.a.Bub,Box4Intl.Box4Strings.l_Picture);b=$l.KR.xhi(this.context,this.Rf,this.Km);
if(!b)return!1;this.Qf=b.node;this.Rf=(this.nJ=b.blob)?this.nJ.properties:this.Qf.properties;we.StaticTheCoauthManager.ud().Jo&&we.StaticTheCoauthManager.ud().Ak.yG(this.Qf);return!0}rce(){return this.aWf?this.i$m():this.$$m()}nhk(){this.X7.set("FileExtensions",this.Cmm());this.X7.set("FileSizeInBytes",this.$hh.toString());this.X7.set("Source",this.YR);this.X7.set("NumberOfImagesAttemptedToInsert",this.Ewh.toString());this.X7.set("NumberOfImagesPasted",this.Fwh.toString());if(Jc.a.pq){this.X7.set("ErrorLevel",
"warning");var b=Object.assign(new rb.a,{extendedProperties:this.X7});this.Fe.logKpiFailure({kpiName:jc.d.$Ka,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})}else(null===(b=A.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?(this.X7.set("ErrorLevel","warning"),b=Object.assign(new rb.a,{extendedProperties:this.X7}),this.Fe.logKpiFailure({kpiName:Bh.c.oLa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})):
oa.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.R2d,this.X7)}Cmm(){let b="";for(let h=0;h<this.LSe.length;++h)b=b+this.tyi(this.LSe[h])+",";return b}WAa(b,h){Jc.a.oV&&this.Oo.jY([25]);this.Bth&&(this.FGa=new Ab,this.FGa.qR=b.qR);super.WAa(b,h)}Yvb(b){this.er=b;if(!this.Dob){if(this.$td){if(rf.a(this.K)||this.avb&&X.a.HF){b.BZc(this.KXn);return}const h=b.BZc(null),n=this.uyi(b);n&&(this.HSe=n.name,this.pxa=n.size);if(!this.qoa(h,b)||!this.bOg(n,b)){b=Object.assign(new rb.a,{extendedProperties:new Map});
b.extendedProperties.set("type",this.qoa(h,this.er)?"Image too large":"FileType invalid");this.Pie(b);this.Kie();return}}this.WAa(b,null)}}zae(){return!!$l.jsc}Kie(){var b;this.X7.set("FileExtension",this.tyi(this.fileExtension));this.X7.set("Source",this.YR);this.X7.set("FileSizeInBytes",this.fileSize.toString());this.X7.set("RequestTimeInMs",this.Zni.toString());Jc.a.pq?this.Fe.logKpiUsage({kpiName:jc.d.$Ka,kpiType:0,optionalProperties:{extendedProperties:this.X7}}):(null===(b=A.AFrameworkApplication.K)||
void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?this.Fe.logKpiUsage({kpiName:Bh.c.oLa,kpiType:0,optionalProperties:{extendedProperties:this.X7}}):oa.Health.instance.recordKpiUsage(this.kpiName,0,this.R2d,this.X7)}tyi(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}iKi(){return this.UZi?xg.a.oKh:ej.Hcf}uyi(b){return(b=b.qR)?b.files[0]:null}bOg(b,h){return b&&b.size>this.Quh?(h&&h.gRd(),b=this.I6d(gk.uqe),this.qq(this.Xxi(gk.uqe),b),!1):!0}I6d(b){switch(b){case gk.oed:return CommonUIStrings.l_ImageUploadNoFileSpecified;
case gk.BUi:return this.UZi?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case gk.uqe:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.Quh/1E6));default:return""}}Pie(b){var h;Jc.a.pq?(b.extendedProperties.set("ErrorLevel","info"),this.Fe.logKpiFailure({kpiName:jc.d.$Ka,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:Object(df.c)(jc.d.Llc,
b)})):(null===(h=A.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Bh.c.Gmc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.Fe.logKpiFailure({kpiName:Bh.c.oLa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:h})):oa.Health.instance.recordQosError("PictureFromLocalInvalid",
Ck,!0,!0,!1,!1,b)}static get KR(){return null!=$l.SYg?$l.SYg:$l.SYg=Ya.a.instance.resolve("Box4.Images.IImageEditor")}}$l.jsc=0;Object(u.a)($l,"Box4PictureUploader",ej,[580,427]);var sn=d(1066),sk=d(155);class Bp{constructor(){this.Ps=this.zq=this.aHb=this.fIh=this.z4b=this.Dqk=null;this.Z6e=0;this.gxa=this.f2e=this.oHb=null;this.Fch=0;this.mLe=this.hya=this.PZe=null;this.Wnh=!1;this.vKe=this.qKe=this.wKe=null}get assetId(){return this.z4b}get thumbnailUrl(){return this.fIh}get Bfo(){return this.aHb}get displayName(){return this.gxa}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.zq,this.Ps)}get U2k(){if(this.qKe&&this.vKe&&this.wKe){const b=document.createElement("a");b.setAttribute("href",this.wKe);b.setAttribute("target","_blank");b.innerText=this.vKe;return b}return null}get TQh(){return this.qKe}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.Fch)}get ino(){const b=document.createElement("span");var h=0;if(this.oHb&&0<this.oHb.length){var n=this.oHb.indexOf("."),B=0>n?this.oHb:this.oHb.substring(0,n);for(B=Number.parseInvariant(B);h<
B&&5>h;h++)b.appendChild(Bb.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",sk.a.ki("box42.png"),"","",!0,""));0<n&&(n=Number.parseInvariant(this.oHb.substr(n+1)),3>n?b.appendChild(Bb.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",sk.a.ki("box42.png"),"","",!0,"")):8>n?b.appendChild(Bb.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",sk.a.ki("box42.png"),"","",!0,"")):b.appendChild(Bb.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",sk.a.ki("box42.png"),
"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(Bb.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",sk.a.ki("box42.png"),"","",!0,""));this.f2e&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.f2e),b.appendChild(h));return b}get pGo(){return 0<this.Z6e?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.Z6e):""}get qal(){if(this.Wnh){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.mLe&&this.hya)return Bp.YGl(this.mLe,this.hya);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.PZe){const h=this.PZe.split(",");b=Array(h.length);for(let n=0;n<h.length;n++)b[n]=h[n].trim()}else b=[];return b}static Udm(b){const h=new Bp;for(let n=0;n<b.childNodes.length;n++){const B=b.childNodes[n];if(1===B.nodeType)try{const L=B.firstChild.nodeValue;switch(B.nodeName){case "src":h.Dqk=L;break;case "assetid":h.z4b=
L;break;case "thumb":"64x64"===B.attributes.getNamedItem("size").nodeValue?h.fIh=Bp.h3j(L):"192x192"===B.attributes.getNamedItem("size").nodeValue&&(h.aHb=Bp.h3j(L));break;case "imagedim":if(L){const la=L.indexOf("x");0<la&&la<L.length&&(h.zq=L.substr(0,la),h.Ps=L.substr(la+1))}break;case "resolution":h.Z6e=Number.parseInvariant(L);break;case "rating":h.oHb=L;break;case "numofratings":h.f2e=L;break;case "displayname":h.gxa=L;break;case "contentlength":h.Fch=Number.parseInvariant(L)/1024;break;case "subject":h.PZe=
L;break;case "provider":h.hya=L;break;case "attributionlink":h.mLe=L;break;case "iscsc":h.Wnh=1===Number.parseInvariant(L);break;case "additional":const ba=B.firstChild;if(B.hasChildNodes()&&ba&&"id"===ba.nodeName&&1===Number.parseInvariant(ba.text))for(let la=0;la<B.childNodes.length;la++){const La=B.childNodes[la];switch(La.nodeName){case "caption":h.qKe=La.text;break;case "value":h.wKe=La.text;break;case "string":h.vKe=La.text}}}}catch(L){}}return h}static YGl(b,h){const n=document.createElement("a");
n.setAttribute("href",b);n.setAttribute("target","_blank");n.innerText=h;return n}static h3j(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(u.a)(Bp,"ClipArtSearchResult",null,[]);class Hc{static get kh(){return Ge.a.az(Hc.Mn,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}Hc.Mn="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(u.a)(Hc,"InsertClipartDialogHtml",null,[]);class Dk extends Ge.a{constructor(b){super();this.DGa=this.gEb=0;this.tAh=null;this.j5e=!1;this.i$b=this.r4a=this.CQ=null;this.boj=h=>{const n=this.PZ.value;n&&0<n.trim().length&&(this.search(this.PZ.value),this.Bva(1,!1));h.preventDefault();h.stopPropagation()};this.p2n=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.boj(h),h.preventDefault(),h.stopPropagation())};this.coj=h=>{100<=this.PZ.value.length&&(h.preventDefault(),h.stopPropagation())};
this.K0n=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.fvj(h);this.Fzg(h)};this.F0=()=>{if(this.Rs&&this.Rs.children&&!(2>this.Rs.children.length)){var h=this.Rs.children[0].children[0],n=this.Rs.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.Rs.scrollTop,B=h.clientHeight+2,L=parseInt(String(this.Rs.scrollTop/B));h=parseInt(String(n/B));var ba=parseInt(String(this.Rs.clientWidth/B));h<n/B&&h<parseInt(String(this.CQ.length/ba))&&h++;for(n=L;n<h;n++)for(B=0;B<ba;B++){var la=
n*ba+B;L=this.CQ[la];(la=document.getElementById("clip"+la))&&!la.childNodes.length&&(L=this.Gbi(L),la.appendChild(L))}}};this.v3n=h=>{h.target.setAttribute("src",sk.a.ki("phthumb.64x64x32.png"))};this.L0n=h=>{h.target.setAttribute("src",sk.a.ki("phpreview.96x96x32.png"))};this.qlj=h=>{$c.a.yn(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.IYn=h=>{(h?h.keyCode:window.event.keyCode)===
Sys.UI.Key.enter&&this.qlj(h)};this.Klj=h=>{const n=h.target.innerText;this.PZ&&(this.PZ.value=n);this.search(n);h.stopPropagation();h.preventDefault();this.Bva(1,!1)};this.vZn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.Klj(h)};this.eoj=h=>{this.CQ&&(this.rMo(this.CQ[this.gEb]),h.stopPropagation(),h.preventDefault(),this.PZ.value="",this.Bva(1,!1))};this.q2n=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.eoj(h)};this.onKeyDown=h=>{if(h.keyCode>=Sys.UI.Key.left&&
h.keyCode<=Sys.UI.Key.down){let n=0;switch(h.keyCode){case Sys.UI.Key.up:n=-5;break;case Sys.UI.Key.down:n=5;break;case Sys.UI.Key.left:n=-1;break;case Sys.UI.Key.right:n=1}this.DGa=this.DGa+n<this.Rs.children.length-1?0>this.DGa+n?0:this.DGa+n:this.Rs.children.length-1;this.Fzg(this.DGa);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.Rs.children.length&&this.MKj(h)):h.keyCode===Sys.UI.Key.tab&&(this.DGa=h.shiftKey?
Math.max(0,this.DGa-1):Math.min(this.DGa+1,this.Rs.children.length-1))};this.onError=()=>{this.Rs&&(this.Rs.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.nwj=h=>{if(this.Rs)if(h.data.rna){var n=h.data.rna.lastChild.childNodes;this.CQ||(this.CQ=[]);for(h=0;h<n.length&&100>this.CQ.length;h++){var B=n[h];1===B.nodeType&&"image"===B.nodeName&&(B=Bp.Udm(B),this.CQ.push(B))}this.ehi();this.CQ.length||(this.Rs.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.De){h=F.a.NYj(h.data.De);
try{n=parseInt(h)}catch(L){n=14}this.Rs.innerText=26===n?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.ehi=()=>{if(this.CQ){Lh.a.PT(this.Rs);this.r4a&&(this.r4a.dispose(),this.r4a=null);this.Rs.focus();this.Rs.classList.remove("ClipartSearchInProgress");for(let n=0;n<this.CQ.length;n++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+n;const B=document.createElement("span");B.id="clip"+n;B.classList.add("ClipartImageContainer");
h.appendChild(B);this.Rs.appendChild(h);n<parseInt(String(this.Rs.clientHeight/B.clientHeight))*parseInt(String(this.Rs.clientWidth/B.clientWidth))&&(h=this.Gbi(this.CQ[n]),B.appendChild(h))}this.j5e&&(this.MKj(this.gEb),this.Fzg(this.gEb))}};this.v9m=h=>{1===h&&this.CQ&&Dk.KR.Vja(this.Dbh.context)&&(h=this.CQ[this.gEb])&&this.Dbh.HEa(h)};this.Dbh=b;this.kh=Hc.kh;this.Qg="InsertClipartDialog";this.Pe(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.v9m);this.Rs=document.getElementById("clipartsearchresults");this.ZLd=this.onKeyDown;Nb.a.addHandler(this.Rs,"keydown",this.ZLd);this.YLd=this.F0;Nb.a.addHandler(this.Rs,"scroll",this.YLd);this.PZ=document.getElementById("textInput");this.zOd=this.p2n;Nb.a.addHandler(this.PZ,"keydown",this.zOd);this.AOd=this.coj;Nb.a.addHandler(this.PZ,"keypress",this.AOd);this.BOd=this.coj;Nb.a.addHandler(this.PZ,"paste",this.BOd);this.XDc=document.getElementById("btnSearch");this.XDc.setAttribute("src",sk.a.ki("search.16x16x32.png"));
this.XLd=this.boj;Nb.a.addHandler(this.XDc,"click",this.XLd);this.s6b=document.getElementById("clipartpreviewimage");this.HQe=document.getElementById("clipartattributedisplayname");this.Xhb=document.getElementById("clipartseesimilar");this.GQe=document.getElementById("clipartdimensions");this.AGc=document.getElementById("clipartadditionalvalue");this.IQe=document.getElementById("clipartratingvalue");this.s2a=document.getElementById("clipartattributionvalue");this.t2a=document.getElementById("clipartkeywords");
this.EQe=document.getElementById("clipartadditionalname");this.JQe=document.getElementById("clipartratingname");this.FQe=document.getElementById("clipartattributionname");this.l5e=this.K0n;this.Oaf=this.v3n;this.nDd=this.qlj;this.oDd=this.IYn;this.NZe=this.Klj;this.OZe=this.vZn;this.aMd=this.eoj;this.bMd=this.q2n;this.PZ.focus();this.Bva(1,!1)}dispose(){this.Rs&&this.Q2h();this.Rs&&this.ZLd&&(Nb.a.removeHandler(this.Rs,"keydown",this.ZLd),this.ZLd=null);this.Rs&&this.YLd&&(Nb.a.removeHandler(this.Rs,
"scroll",this.YLd),this.YLd=null);this.Rs=null;this.PZ&&this.zOd&&(Nb.a.removeHandler(this.PZ,"keydown",this.zOd),this.zOd=null);this.PZ&&this.AOd&&(Nb.a.removeHandler(this.PZ,"keypress",this.AOd),this.AOd=null);this.PZ&&this.BOd&&(Nb.a.removeHandler(this.PZ,"paste",this.BOd),this.BOd=null);this.PZ=null;this.XDc&&this.XLd&&(Nb.a.removeHandler(this.XDc,"click",this.XLd),this.XDc=this.XLd=null);this.FQe=this.JQe=this.EQe=this.t2a=this.s2a=this.IQe=this.AGc=this.GQe=this.Xhb=this.HQe=this.s6b=this.bMd=
this.aMd=this.OZe=this.NZe=this.oDd=this.nDd=this.i$b=this.Oaf=this.l5e=null;this.r4a&&(this.r4a.dispose(),this.r4a=null);super.dispose()}WN(){super.WN();document.getElementById(this.Sj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.v_b(b,!1,this.nwj)}v_b(b,h,n){this.DGa=this.gEb=0;this.Q2h();if(this.CQ&&b===this.tAh&&this.j5e===h)window.setTimeout(this.ehi,500);else{this.CQ&&(Array.clear(this.CQ),this.CQ=null);this.tAh=b;this.j5e=h;var B=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');
B.append("<query>");B.append(F.a.Hf(b));B.append("</query>");B.append("<mediatype>Illustration</mediatype>");B.append("<mediatype>Photo</mediatype>");B.append("<filetype>jpg</filetype>");B.append("<filetype>jpeg</filetype>");B.append("<filetype>gif</filetype>");B.append("<filetype>bmp</filetype>");B.append("<filetype>tif</filetype>");B.append("<filetype>tiff</filetype>");B.append("<filetype>png</filetype>");B.append("</search>");b=A.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let L=
b.length;4>L;L++)b="0"+b;A.AFrameworkApplication.Be.Ij(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",$e.App.webServiceBase,b,wh.a.W8o,h.toString()),2,B.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,n,this.onError,null)}}rMo(b){this.v_b(b.assetId,!0,this.nwj);this.CQ||(this.CQ=[],this.CQ.push(b))}Gbi(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;
h.setAttribute("title",b);h.setAttribute("alt",b);Nb.a.addHandler(h,"click",this.l5e);Nb.a.addHandler(h,"error",this.Oaf);return h}WQl(b){1===b.childNodes.length&&(b=b.childNodes[0],Nb.a.removeHandler(b,"click",this.l5e),Nb.a.removeHandler(b,"error",this.Oaf))}fvj(b){const h=this.CQ[b];var n=h.Bfo;this.O2h();this.i$b=this.L0n;var B=document.createElement("img");B.setAttribute("src",n);if(h.displayName)n=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{n=new Sys.StringBuilder;
for(let L=0;L<h.keywords.length&&5>L;L++)L&&n.append(", "),n.append(h.keywords[L]);n=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,n.toString())}B.setAttribute("title",n);B.setAttribute("alt",n);Nb.a.addHandler(B,"error",this.i$b);this.s6b.appendChild(B);B=document.getElementById("clip"+this.gEb);B.classList.remove("ClipartSelectedImage");B=document.getElementById("clip"+b);B.classList.add("ClipartSelectedImage");this.gEb=b;h.displayName&&(this.HQe.innerText=h.displayName);b=document.createElement("a");
b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');Nb.a.addHandler(b,"click",this.aMd);Nb.a.addHandler(b,"keydown",this.bMd);this.Xhb.appendChild(b);this.GQe.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.pGo,h.fileSize);(b=h.U2k)&&h.TQh?(this.AGc.parentNode.style.display="block",this.EQe.innerText=h.TQh,this.AGc.appendChild(b)):this.AGc.parentNode.style.display="none";this.IQe.appendChild(h.ino);Lh.a.PT(this.s2a);if(b=h.qal)this.s2a.appendChild(b),"a"===
b.nodeName.toLowerCase()&&(Nb.a.addHandler(b,"click",this.nDd),Nb.a.addHandler(b,"keydown",this.oDd));this.t2a.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)B=h.keywords[b],n=document.createElement("a"),n.innerText=B,n.setAttribute("href",'""'),Nb.a.addHandler(n,"click",this.NZe),Nb.a.addHandler(n,"keydown",this.OZe),this.t2a.appendChild(n),b<h.keywords.length-1&&(B=document.createElement("span"),B.innerText=", ",this.t2a.appendChild(B));this.JQe.innerText=Box4Intl.Box4Strings.l_ClipartRating;
this.FQe.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.Bva(1,!0)}O2h(){this.s6b&&1===this.s6b.childNodes.length&&(this.i$b&&(Nb.a.removeHandler(this.s6b.childNodes[0],"error",this.i$b),this.i$b=null),Lh.a.PT(this.s6b));this.s2a&&0<this.s2a.childNodes.length&&"a"===this.s2a.childNodes[0].nodeName.toLowerCase()&&(this.nDd&&Nb.a.removeHandler(this.s2a.childNodes[0],"click",this.nDd),this.oDd&&Nb.a.removeHandler(this.s2a.childNodes[0],"keydown",this.oDd));this.Xhb&&0<this.Xhb.children.length&&
"a"===this.Xhb.children[0].nodeName.toLowerCase()&&(this.aMd&&Nb.a.removeHandler(this.Xhb.children[0],"click",this.aMd),this.bMd&&Nb.a.removeHandler(this.Xhb.children[0],"keydown",this.bMd),Lh.a.PT(this.Xhb));if(this.t2a){for(let b=0;b<this.t2a.childNodes.length;b++){const h=this.t2a.childNodes[b];"a"===h.nodeName.toLowerCase()&&(Nb.a.removeHandler(h,"click",this.NZe),Nb.a.removeHandler(h,"keydown",this.OZe))}Lh.a.PT(this.t2a)}this.HQe.innerText="";this.GQe.innerText="";Lh.a.PT(this.AGc);Lh.a.PT(this.IQe);
Lh.a.PT(this.s2a);this.t2a.innerText="";this.EQe.innerText="";this.JQe.innerText="";this.FQe.innerText=""}MKj(b){if(!(this.Rs.children.length<=b||0>b)){var h=this.Rs.children[b],n=this.Rs.children[0];n=n.clientHeight-n.children[0].clientHeight+2;this.Rs.scrollTop+this.Rs.clientHeight<h.offsetTop+h.clientHeight?this.Rs.scrollTop=h.offsetTop-3*h.clientHeight-n:this.Rs.scrollTop>h.offsetTop&&(this.Rs.scrollTop=h.offsetTop-n/2);this.fvj(b)}}validate(){return!0}Q2h(){if(Ph.FocusManager.vM()){var b=Ph.FocusManager.instance().getRegion(this.kN);
b&&b.Mk.mA(this.PZ)}else this.PZ.focus();for(b=0;b<this.Rs.childNodes.length;b++){const h=this.Rs.childNodes[b];1===h.childNodes.length&&this.WQl(h.childNodes[0])}Lh.a.PT(this.Rs);this.O2h();this.Bva(1,!1);this.r4a=new sn.a(Box4Intl.Box4Strings.l_ClipartSearching);this.r4a.z2i=!1;this.Rs.appendChild(this.r4a.element);this.Rs.classList.add("ClipartSearchInProgress")}Fzg(b){this.DGa=b;b=this.Rs.children[this.DGa];Ph.FocusManager.vM()?Ph.FocusManager.instance().getRegion(this.kN).Mk.mA(b):b.focus()}static get KR(){return Dk.Ck=
Dk.Ck||Ya.a.instance.resolve("Box4.Images.IImageEditor")}}Dk.Ck=null;Object(u.a)(Dk,"InsertClipartDialog",Ge.a,[]);class Tq extends $l{constructor(b,h,n,B,L,ba,la){super(b,h,n,B,L,ba,la,!1);this.r0n=La=>{if(this.Fon()){var fb=this.Qf.Jj(),Cb=fb.yg.Is.toString(),Lb=new Sys.Net.WebRequest;Lb.set_url("ClipArtUpload.ashx");Lb=new Sys.StringBuilder(Lb.getResolvedUrl());this.$Z(Lb,wh.a.assetId,La.assetId,!0);this.$Z(Lb,lg.a.lcid,A.AFrameworkApplication.lcid.toString());this.$Z(Lb,lg.a.nodeId,this.nJ?this.nJ.id.toString():
this.Qf.id.toString());this.$Z(Lb,lg.a.cellId,fb.pl.toString());this.$Z(Lb,lg.a.fileId,fb.kq);this.$Z(Lb,lg.a.zza,Cb);this.$Z(Lb,lg.a.v_,this.Km.toString());La=this.Qf.ja(hi.a.lK,fk.a.Hu);this.$Z(Lb,lg.a.lK,La.toString());this.$Z(Lb,lg.a.FAb,"1");fb.NG&&this.$Z(Lb,lg.a.NG,fb.NG);this.$Z(Lb,lg.a.classId,this.nJ?this.nJ.properties.yc.toString():this.Qf.yc.toString());this.Rf.hasProperty(Lc.a.imageType)&&this.$Z(Lb,wh.a.imageType,this.Rf.getValue(Lc.a.imageType).toString());Qh.a.instance.e_k(Lb);A.AFrameworkApplication.Be.Ij(Lb.toString(),
2,"",{},!1,2,this.YAp,this.b$j,null);$l.jsc++}};this.YAp=La=>{if(({group:fb}=ii.a.R4(La.data.De)).returnValue){var fb=fb.Responses[0];fb.oxb=La.data.bH;fb.kr=La.data.vi?La.data.vi[Mh.a.S2]:"";this.ooa(fb)}else this.b$j(null)};this.b$j=()=>{const La=new bl.a;La.StatusCode=14;this.ooa(La)};new Dk(this)}HEa(b){this.rce()&&this.Qf.Jj().yg.CF(this.r0n,null,b)}$Z(b,h,n,B){b.append(B?"?":"&");b.append(F.a.ej(h));b.append("=");b.append(F.a.ej(n))}VBf(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;
case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.VBf(b)}}ooa(b){super.ooa(b);$l.jsc--}}Object(u.a)(Tq,"ClipartUploader",$l,[]);var oc=d(11),vc=d(435);class Jo{constructor(b,h,n){this.w9m=(B,L,ba,la,La)=>{if(!this.Ck||!this.Ck.value)return x.ULS.sendTraceTag(524109267,306,15,"ImageEditor not available"),8;B=this.Ck.value.Vja(L);return 2===ba&&B?(new Tq(L,ph.a.instance,A.AFrameworkApplication.K,La,this.Fn,this.ga,new vc.b),32):1===ba?B&&$e.App.K3h?32:8:2};this.Ck=b;this.Fn=
h;this.ga=n}Wb(){this.ga.fb(wb.a.PSi,oc.a.view,this.w9m,260)}}Object(u.a)(Jo,"ClipArtActor",null,[]);class Pm{constructor(){this.W=null}get name(){return"Box4.ClipArt"}wc(b){this.W=b;b.ia("Box4.ClipArt.ClipArtActor",()=>new Jo(b.rf("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),A.AFrameworkApplication.va)).ha()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").Wb();const b=Ua.StaticActiveAppFrame.za();b&&b.Ie()}dispose(){}}Object(u.a)(Pm,"ClipartPackage",null,[0,1]);class Co{constructor(b){this.P4a=
this.z4a=this.V4a=this.U4a=null;this.Tkh=this.sfh=this.Ukh=this.bsh=this.ui=this.Ixa=!1;this.N6e=this.Jsh=null;this.rsh=0;this.Ga=this.Esh=null;this.via=b;this.nQ=3;this.Z7b=!0}initialize(b,h,n){this.U4a=this.QNf(b,h);this.V4a=CommonUIStrings.l_SavingStatus;this.z4a=CommonUIStrings.l_ReadOnlyStatus;this.P4a=CommonUIStrings.l_ReviewModeStatus;this.via&&this.via.execute(B=>{B.emb(Object(z.a)(this,this.Qtd,"updateToSavingStatus"))});this.ui=!0;this.Ga=n;this.sfh=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",
!1);return!0}rAb(b,h){this.Ixa=b;this.nQ=h;this.L0a(this.Z7b)}L0a(b){!this.Z7b&&b&&(this.Esh=new Date);this.Z7b=b;this.Tkh=!1;b=null;3===this.nQ&&(b=this.Z7b?this.U4a:this.V4a);this.oVl(b)}QNf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}Qtd(){this.L0a(!1)}aAm(){switch(this.nQ){case 1:return this.z4a;case 2:return this.P4a;default:return null}}$zm(){if(3!==this.nQ)switch(this.nQ){case 1:return"ReadOnly";
case 2:return"ReviewOnly";default:return null}return this.Tkh?"FailedToSave":this.Z7b?"Saved":"Saving"}qhn(b){return this.bsh===this.Ixa&&this.rsh===this.nQ&&this.Jsh===b}pyf(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.Ixa,b,this.aAm(),this.Esh,this.Z7b,this.sfh?h.getHeaderSaveStatusIconProps(this.$zm()):null);this.Ukh=!0;return null});this.N6e=null}oVl(b){this.ui&&kh.c()&&!this.qhn(b)&&(!this.Ukh&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",
!1)?this.pyf(b):$c.a.hve()?(this.N6e&&x.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.N6e=window.requestIdleCallback(()=>{this.pyf(b)})):window.requestAnimationFrame(()=>{this.pyf(b)}),this.bsh=this.Ixa,this.Jsh=b,this.rsh=this.nQ)}}Object(u.a)(Co,"ReactSaveStatusUIHandler",null,[552]);class jl{constructor(b,h){this.c0=null;this.U4a=CommonUIStrings.l_SavedStatus;this.V4a=CommonUIStrings.l_SavingStatus;this.z4a=CommonUIStrings.l_ReadOnlyStatus;
this.P4a=CommonUIStrings.l_ReviewModeStatus;this.Nib=h;this.via=b;this.nQ=3;this.Okb=!0}LE(){this.via&&this.via.execute(b=>{b.emb(Object(z.a)(this,this.Qtd,"updateToSavingStatus"))});this.Nib.execute(b=>{this.c0=b})}rAb(b,h){this.nQ=h;3===h?this.L0a(this.Okb):2===h?this.SKg(this.P4a):this.SKg(this.z4a)}Qtd(){this.L0a(!1)}L0a(b){this.Okb=b;this.SKg(this.Okb?this.U4a:this.V4a)}SKg(b){this.c0&&this.c0.sendMessage(H.a.Mqp,this.Qyl(b))}Qyl(b){const h={};h.StatusText=b;return h}}Object(u.a)(jl,"SaveStatusPostMessageHandler",
null,[552]);var Kl=d(255),fo=d(150);class cn{constructor(b,h,n,B){this.P4a=this.z4a=this.V4a=this.U4a=null;this.HFb=0;this.e2=this.R7e=this.uBb=this.$Ke=this.abf=null;this.Eg=b;this.Iib=h;this.via=n;this.Zm=B;this.Voh=!0;this.Ixa=!1;this.nQ=3;this.Okb=!0}initialize(b,h){if(!this.Eg)return!1;this.U4a=this.QNf(b,h);this.V4a=CommonUIStrings.l_SavingStatus;this.z4a=CommonUIStrings.l_ReadOnlyStatus;this.P4a=CommonUIStrings.l_ReviewModeStatus;this.LE();return!0}QNf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,
CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}LE(){this.Iib&&this.Iib.execute(b=>{b.L1k(Object(z.a)(this,this.lbi,"createStatusAndModeElements"));b.u1k(Object(z.a)(this,this.N6o,"showHideSaveStatusElement"));b.Clp&&this.lbi(null,null)});this.via&&this.via.execute(b=>{b.emb(Object(z.a)(this,this.Qtd,"updateToSavingStatus"))})}IY(){this.e2&&this.Eg&&this.Eg.dFa(this.e2)}N6o(b,h){this.rAb("true"===h,this.nQ)}rAb(b,h){this.Ixa=
b;this.nQ=h;this.$Ke&&(this.$Ke.style.display=this.Ixa||3===this.nQ||!this.abf?"none":"");this.uBb&&(this.uBb.style.display=this.Ixa||3===this.nQ?"none":"",this.uBb.innerText=1===this.nQ?this.z4a:this.P4a,this.uBb.title=1===this.nQ?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.R7e&&(this.R7e.style.display=this.Ixa||1===this.nQ||!this.abf&&!this.uBb?"none":"");this.e2&&(this.e2.style.display=this.Ixa||1===this.nQ?"none":"",this.L0a(this.Okb),this.e2.title=
CommonUIStrings.l_SaveStatusTooltip)}lbi(b,h){b=document.getElementById(Kl.a.m_m);h&&h.TFp||!b||""===this.U4a||""===this.V4a||""===this.z4a||""===this.P4a||(this.abf=document.getElementById(Kl.a.jmf),this.$Ke=Kl.a.DYd(b,"BreadcrumbAppModeDash","-"),this.uBb=Kl.a.DYd(b,"BreadcrumbAppModeStatus",1===this.nQ?this.z4a:this.P4a),this.g7j(this.uBb),this.R7e=Kl.a.DYd(b,"BreadcrumbSaveStatusDash","-"),this.e2=Kl.a.DYd(b,"BreadcrumbSaveStatus",this.U4a),this.g7j(this.e2),this.rAb(this.Ixa,this.nQ))}Qtd(){this.L0a(!1)}L0a(b){this.Okb=
b;this.pzp(this.Okb?this.U4a:this.V4a)}pzp(b){!this.e2||3!==this.nQ&&2!==this.nQ||(this.Voh&&!this.Okb?(this.HFb=this.e2.offsetWidth<this.HFb?this.HFb:this.e2.offsetWidth,this.Itp(this.V4a),this.Voh=!1):this.e2.innerText=b)}g7j(b){b.style.direction=this.Zm?"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.Zm?"right":"left";b.style.display=this.Ixa?"none":"";b.setAttribute("Unselectable","on")}Itp(b){this.e2&&(this.e2.style.width="",this.e2.innerText=b,this.HFb=this.e2.offsetWidth<this.HFb?this.HFb:
this.e2.offsetWidth,b=fo.a.WB(this.e2),this.e2.style.width=this.HFb-Lh.a.KP(b.paddingLeft)-Lh.a.KP(b.paddingRight)+1+"px")}}Object(u.a)(cn,"SaveStatusUIHandler",null,[552]);var Uq=d(106);class To{constructor(){this.S7e=this.Y5e=this.eTa=this.W=null;this.pz=()=>{const b=A.AFrameworkApplication.K,h=!!A.AFrameworkApplication.ua.Ib&&4===A.AFrameworkApplication.ua.Ib.Tk;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||
b.$("ExcelSaveStatusInHeaderEnabled")||b.$("VisioSaveStatusInHeaderEnabled"))A.AFrameworkApplication.K.$("PostMessageEmbedded")&&A.AFrameworkApplication.a0?(this.S7e=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.S7e.LE():A.AFrameworkApplication.ua.Ib.o1f||A.AFrameworkApplication.hideHeader||(A.AFrameworkApplication.ua.Ib.BN?(this.Y5e=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.Y5e.initialize(b.$("IsSkyDrive"),b.kb("HostNameToIncludeInSavedStatus"),
A.AFrameworkApplication.K):(this.eTa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.eTa.initialize(b.$("IsSkyDrive"),b.kb("HostNameToIncludeInSavedStatus")))}}get name(){return"Common.App.SaveStatus"}wc(b){this.W=b;A.AFrameworkApplication.K.$("PostMessageEmbedded")&&A.AFrameworkApplication.a0?this.W.register(jl,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Rd(()=>new jl(this.W.Qa("Common.App.HostNotification.EditNotificationEventSource"),
this.W.Qa("Postmessage.IHostPostmessenger"))):A.AFrameworkApplication.ua.Ib.o1f||(A.AFrameworkApplication.ua.Ib.BN?this.W.register(Co,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Rd(()=>new Co(this.W.Qa("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register(cn,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Rd(()=>new cn(Uq.EventHandlerManager.instance,this.W.Qa("Common.App.Header.HeaderEventSource"),
this.W.Qa("Common.App.HostNotification.EditNotificationEventSource"),A.AFrameworkApplication.isRtl)))}init(){A.AFrameworkApplication.K.Rn(this.pz)}dispose(){this.eTa&&this.eTa.IY()}}Object(u.a)(To,"PackageManager",null,[0,1]);var sm=d(1748);class go{get name(){return"Common.App.EventsCachePackage"}wc(){}init(){sm.a.instance.init()}dispose(){}static main(){M.a.instance.Jc(new go)}}Object(u.a)(go,"EventsCachePackage",null,[0,1]);var ml=d(140),ul=d(173),Ko=d(98),Dl=d(663),$g=d(327),ep=d(482),Lk=d(305),
Kf=d(29),Yh=d(267),ng=d(24);class kj{constructor(b){this.coh=!1;this.Bwd=this.rn=null;this.ZJe=!1;this.hG=b}get control(){return this.hG}get Sd(){return this.control.Sd}get root(){return this.control.root}get qK(){return this.control.qK}get O5a(){return this.control.O5a}get Xk(){return this.control.Xk}get IG(){return this.control.IG}fL(){}initialize(){}oy(b,h,n){this.control.jWl(b,h,n)}wn(){Kf.c(this.control.$h.Command)||this.nv(this.control.$h.Command,null,null)}nv(b,h,n){let B=0;this.root&&(B=this.root.Xua(b,
h,n));this.control.enabled=0<(B&1);return B}Nfb(){let b=this.control.visible;this.root.d0a&&(b=this.Sd[Yh.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.Urc=!0));return b}sMg(){const b=ng.a.swa(this.Sd[Yh.a.labelText],this.control.$h.LabelText);this.Wxe(b)}Wxe(b){this.control.labelText!==b&&(this.IG.forEach(h=>{h.Wxe(b)}),this.control.labelText=b,this.root.Mbb=!0)}B2b(){const b=ng.a.swa(this.Sd[Yh.a.alt],this.control.$h.Alt);this.yxc(b)}yxc(b){this.control.tooltip!==b&&(this.IG.forEach(h=>
{h.yxc(b)}),this.control.tooltip=b)}moa(){const b=ng.a.swa(this.Sd[Dl.a.Image16by16Class],this.control.$h.Image16by16Class),h=ng.a.swa(this.Sd[Dl.a.Image32by32Class],this.control.$h.Image32by32Class);var n=ng.a.swa(this.Sd[Dl.a.Image48by48Class],this.control.$h.Image48by48Class);n=Kf.b(n)?h:n;this.sTc(this.IG.small,b);this.sTc(this.IG.Js,b);this.sTc(this.IG.LX,h);this.sTc(this.IG.Z9o,b);this.sTc(this.IG.jqc,n)}sTc(b,h){!b||Kf.c(b.hU)||Kf.c(h)||b.hU.className===h||(b.hU.className=h)}yvp(b){if(!Kf.b(b)&&
this.root.FGg){for(const h of this.control.drf){const n=h.WW===b;n&&(this.control.lef=h);this.control.visible&&(h.tC=n)}this.control.visible&&(this.root.Mbb=!0)}}k3k(){if(this.IG.jqc&&this.IG.jqc.mR&&this.IG.jqc.Yob){const b=this.IG.jqc.mR,h=ng.a.swa(this.Sd[$g.a.Description],this.control.$h.Description);Kf.b(h)&&(b.style.position="relative",b.style.top=(b.parentNode.offsetHeight-b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.Xk;Object(Wb.a)(ep.a,b)?this.qK.lAb(b):this.root.hMb=
this.control;return!1}onBlur(){const b=this.Xk;this.control.DTb()&&ng.a.Nx(b.Qc,"cui-ctl-menu-hovered-without-focus");this.root.hMb=null;return!1}hS(b){if(this.control.DTb()){var h=this.qK.Tva;const n=h===this.root.xVb-1;h=n?null:this.root.xE[h+1];this.Spf(!1);n||this.control===h||ng.a.Nx(h.rUb,Lk.MenuLauncher.vdd);this.control.enabled&&this.control.Ev?n?this.control.X0():(ng.a.pg(this.Xk.Qc,"cui-ctl-menu-hovered-without-focus"),h.Eka=this.control.Ev):n?this.qK.setFocus(b.Ag):(h.Eka=this.qK.Qc,this.qK.ova())}return!1}ZL(){this.control.DTb()&&
ng.a.Nx(this.Xk.Qc,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(b){let h=!1;if(!Kf.c(b.Kb)&&!Kf.c(b.Kb.rawEvent)){const n=b.Kb.keyCode;b=b.Kb.rawEvent.shiftKey;n===Sys.UI.Key.enter&&(h=!0);if(Object(Wb.a)(ep.a,this.Xk)){const B=this.qK;if(!Kf.c(B)){const L=B.Tva,ba=0===this.root.L4,la=!Kf.c(this.control.c9n);if(n!==Sys.UI.Key.tab&&n!==Sys.UI.Key.left&&n!==Sys.UI.Key.right&&n!==Sys.UI.Key.up&&n!==Sys.UI.Key.down&&n!==Sys.UI.Key.esc)return h;$c.a.opf();n!==Sys.UI.Key.tab||b?n===Sys.UI.Key.tab&&
b?(B.iN(1),h=!0):n===Sys.UI.Key.left&&ba||n===Sys.UI.Key.right&&!ba?(la?B.iN(2):0<L&&this.root.V6a(L,!0,!1),h=!0):n===Sys.UI.Key.right&&ba||n===Sys.UI.Key.left&&!ba?(la&&B.iN(4),h=!0):n===Sys.UI.Key.up?(B.iN(5),h=!0):n===Sys.UI.Key.down?(B.iN(6),h=!0):n===Sys.UI.Key.esc&&(this.root.V6a(L,!0,!1),h=!0):(B.iN(0),h=!0)}}}return h}fA(b){let h=!1;if(!Kf.c(b.Kb)&&!Kf.c(b.Kb.rawEvent)){const n=b.Kb.keyCode;bb.KeyInputManager.ONi(b)||n!==Sys.UI.Key.enter&&n!==Sys.UI.Key.space||(h=this.NRf(b),h||(this.oy(b.Nf,
1,b.Kb),h=!0))}return h}zE(b){this.Rqf();if(this.O5a){let h=!0;2===b.Ag&&(h=b.Cga===Sys.UI.MouseButton.leftButton);h&&this.Xk&&this.NQd(this.Xk.Qc)}(b.Kb.type.toLowerCase()!==Cd.a.ES||this.O5a)&&b.Kb.preventDefault();return!1}get UXf(){return this.coh}C_l(){this.coh=!0}Rqf(){this.UXf&&this.control.root.Cnb()}pDa(b){Object(Wb.a)(ep.a,this.Xk)&&!this.O5a&&2===b.Ag&&b.Cga===Sys.UI.MouseButton.leftButton?(this.oy(b.Nf,b.Ag,b.Kb),b=!0):b=this.control.vAa(b);return b}onClick(b){let h=!1;Object(Wb.a)(ep.a,
this.Xk)&&!this.O5a&&3===b.Ag&&(this.oy(b.Nf,b.Ag,b.Kb),h=!0);return X.a.Di?!1:h}Wvb(b){return this.jme(b)}hNa(b){this.vAa(b);return!1}jme(b){return Kf.c(this.rn)?!1:(this.Tyg($c.a.Lfe(this.xMh,b.clientPoint)),!0)}Isc(b){let h=!1;this.vAa(b)&&(h=!0);3!==b.Ag&&(b=!0,!this.root&&kj.Vcg&&(x.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),b&&this.root.P6(),h=!0);return h}Lsc(b){return this.vAa(b)}Jsc(b){return this.jme(b)}Ksc(b){return this.vAa(b)}Gsc(b){return 3===b.Ag?(this.root.P6(),!0):!1}Hsc(){return!1}get xMh(){!Kf.c(this.rn)&&
Kf.c(this.Bwd)&&(this.Bwd=$c.a.getElementBounds(this.rn));return this.Bwd}Tyg(b){this.ZJe!==b&&(this.ZJe=b,this.mef(this.ZJe))}mef(b){Kf.c(this.rn)||ng.a.n9(this.rn,Ko.a.QQd,b)}NQd(b){this.control.enabled&&(this.rn=b,this.root.iSc=this.control,this.Tyg(!0),this.root.Oja(this.control,!1))}vAa(b){if(!Kf.c(this.rn)){this.Tyg(!1);let h=!!this.root;if(kj.Vcg){const n=Ce.ActionManager.U$(parseInt(this.control.$h.Command))||"";x.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",h,n)}h&&
this.root.ofa(this.control,!1);Kf.c(b)||$c.a.Lfe(this.xMh,b.clientPoint)&&this.oy(this.rn,b.Ag,b.Kb);h=!!this.root;kj.Vcg&&x.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.iSc=null);this.Bwd=this.rn=null;return!0}return!1}iN(b){return Object(Wb.a)(ep.a,this.Xk)&&2!==b&&4!==b&&!$c.a.vnc(this.control.Ev)?this.X0():!1}X0(){try{if(this.control.visible){const b=this.control.Ev;if(!Kf.c(b))return b.focus(),!0}}catch(b){}return!1}Spf(b){const h=this.qK;Kf.c(h)||this.root.V6a(h.Tva+
1,b)}Iua(){}NRf(){return!1}mX(b){let h=null;b&&b.rawEvent&&(h={},h[kj.triggerTime]=b.rawEvent.timeStamp);return h}static get Vcg(){null==kj.a2e&&(kj.a2e=!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return kj.a2e}}kj.triggerTime="TriggerTime";kj.a2e=null;Object(u.a)(kj,"ControlBehavior",null,[562]);var tk=d(195);class Mm extends kj{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.$h}fL(b){const h=
b.Nn;b=b.WW;Kf.c(h)||(Ne.a.instance.nb(Cd.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus")),Ne.a.instance.nb(Cd.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur")),ul.a.instance.nb(Cd.a.cM,h,Object(z.a)(this,this.hS,"onPointerOver")),ul.a.instance.nb(Cd.a.kH,h,Object(z.a)(this,this.ZL,"onPointerOut")),bb.KeyInputManager.instance.rK(Cd.a.Ti,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"),b),bb.KeyInputManager.instance.rK(Cd.a.jv,h,Object(z.a)(this,this.LI,"onKeyPress"),b),bb.KeyInputManager.instance.rK(Cd.a.oi,
h,Object(z.a)(this,this.fA,"onKeyUp"),b),ul.a.instance.nb(Cd.a.nt,h,Object(z.a)(this,this.zE,"onPointerDown")),ul.a.instance.nb(Cd.a.LP,h,Object(z.a)(this,this.pDa,"onPointerUp")),Ef.a.instance.nb(Cd.a.click,h,Object(z.a)(this,this.onClick,"onClick")),tk.a.instance.nb(Cd.a.CS,h,Object(z.a)(this,this.Wvb,"onTouchMove")),tk.a.instance.nb(Cd.a.rM,h,Object(z.a)(this,this.hNa,"onTouchEnd")))}oy(b,h,n){this.control.enabled&&(b=null,this.Xk&&this.Xk.Z9c()&&this.qK&&(b=this.root.xE[this.qK.Tva])&&!this.UXf&&
(b.q_a(this.button),b=null),this.executeCommand(this.control.$h.Command,h,!0,n),b&&b.q_a(this.button))}executeCommand(b,h,n,B){if(!Kf.c(b)){const L=this.Sd;L.CommandValueId=this.button.rPb();L.MenuItemId=this.button.$h.MenuItemId;L.SourceControlId=this.control.id;this.root.executeCommand(b,L,this.Xk,h,n,null,this.mX(B))}}wn(){Kf.c(this.control.$h.Command)||0<(this.nv(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)&&this.Nfb()&&this.J0a()}J0a(){this.sMg();this.B2b();this.moa()}onFocus(b){super.onFocus(b);
this.vFg();return!1}onBlur(b){super.onBlur(b);this.TAf();return!1}onKeyDown(b){let h=super.onKeyDown(b);Kf.c(b.Kb)||this.fCg(b.Mq,b.Kb.keyCode)&&(h=!1);return h}LI(b){let h=!1;Kf.c(b.Kb)||Kf.c(b.Kb.rawEvent)||(this.fCg(b.Mq,b.Kb.rawEvent.keyCode)?(this.oy(b.Nf,b.Ag,b.Kb),h=!0):b.Kb.preventDefault());return h}fCg(b,h){if(X.a.Mt&&h===Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}fA(b){let h=!1;Kf.c(b.Kb)||this.fCg(b.Mq,b.Kb.keyCode)||
(h=super.fA(b));return h}vFg(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}TAf(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(u.a)(Mm,"ButtonBehavior",kj,[]);var ka=d(1055);class $a{}$a.Color="Color";$a.IndexColorSelected="ColorSelected";Object(u.a)($a,"ColorPickerCommandProperties",null,[]);var Db=d(1155);class ec extends kj{constructor(b){super(b);this.sPc=this.zw=-1}get MLb(){return this.control}get wUa(){return this.MLb.Mul.wUa}get properties(){return this.MLb.$h}oy(b,
h,n){if(this.control.enabled){const B=this.Sd;B.Color=ec.f8d(b)[ka.ColorPicker.KWd];b=null;ng.a.at(this.properties.Stateful)&&this.Xk&&this.Xk.Z9c()&&this.qK&&(b=this.root.xE[this.qK.Tva]);this.root.executeCommand(this.properties.Command,B,this.Xk,h,!0,null,this.mX(n));b&&b.q_a(this.MLb)}}wn(){var b=this.Sd;b.SourceControlId=this.properties.Id;if(0<(this.nv(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,$a.IndexColorSelected in this.Sd&&(b=this.Sd[$a.IndexColorSelected]),b!==this.sPc)){const h=
this.wUa;0<=b&&b<h.length&&this.v6j(h[b],!0);0<=this.sPc&&this.sPc<h.length&&this.v6j(h[this.sPc],!1);this.sPc=b}}v6j(b,h){h?ng.a.pg(b,"cui-colorpicker-selected"):ng.a.Nx(b,"cui-colorpicker-selected")}fL(b){for(let h=0;h<b.Ndf.length;++h){const n=b.Ndf[h];Ne.a.instance.nb(Cd.a.focus,n,Object(z.a)(this,this.reg,"onCellFocus"));Ne.a.instance.nb(Cd.a.blur,n,Object(z.a)(this,this.wVn,"onCellBlur"));bb.KeyInputManager.instance.nb(Cd.a.Ti,n,Object(z.a)(this,this.onKeyDown,"onKeyDown"));bb.KeyInputManager.instance.nb(Cd.a.oi,
n,Object(z.a)(this,this.fA,"onKeyUp"));Ef.a.instance.nb(Cd.a.click,n,Object(z.a)(this,this.xVn,"onCellClick"));ul.a.instance.nb(Cd.a.LP,n,Object(z.a)(this,this.ueg,"onCellPointerUp"));ul.a.instance.nb(Cd.a.cM,n,Object(z.a)(this,this.teg,"onCellPointerOver"));ul.a.instance.nb(Cd.a.nt,n,Object(z.a)(this,this.yVn,"onCellPointerDown"))}}reg(b){b=ec.f8d(b.Nf);this.qK.lAb(this.Xk);this.XEe(b,!0);return!0}wVn(b){this.XEe(ec.f8d(b.Nf),!1);return!0}XEe(b,h){h?(this.zw=parseInt(b.getAttribute("arrayPosition")),
ng.a.pg(b,"cui-colorpicker-hoveredOver"),this.vFg(b)):(this.zw=-1,this.TAf(b),ng.a.Nx(b,"cui-colorpicker-hoveredOver"))}xVn(b){3===b.Ag&&this.oy(b.Nf,b.Ag,b.Kb);return!0}ueg(b){3!==b.Ag&&this.oy(b.Nf,b.Ag,b.Kb);return!0}teg(b){this.Spf(!1);b=parseInt(ec.f8d(b.Nf).getAttribute("arrayPosition"));this.Tnd(b);return!0}yVn(){return!1}vFg(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!Kf.b(h)){const n=this.Sd;n.Color=b[ka.ColorPicker.KWd];this.root.executeCommand(h,n,this.Xk,0,!1)}}}TAf(b){if(this.control.enabled){const h=
this.properties.CommandRevert;if(!Kf.b(h)){const n=this.Sd;n.Color=b[ka.ColorPicker.KWd];this.root.executeCommand(h,n,this.Xk,0,!1)}}}iN(b){b=Db.a.WEf(this.zw,this.MLb.width,this.wUa.length,b);if(b!==this.zw&&this.Tnd(b))return!0;this.XEe(this.wUa[this.zw],!1);return!1}X0(){return this.Tnd(0)}Tnd(b){return this.wUa&&this.wUa.length>b&&(b=this.wUa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}Iua(){-1!==this.zw&&this.XEe(this.wUa[this.zw],!1)}static f8d(b){return ec.KAm(b)}static KAm(b){var h=["td"];
const n=h.length;if(!b)return null;for(var B=0;B<n;B++)if(b.tagName.toLowerCase()===h[B].toLowerCase())return b;for(b=b.parentNode;b;){for(B=0;B<n;B++)if(b.tagName.toLowerCase()===h[B].toLowerCase())return b;b=b.parentNode}return null}}Object(u.a)(ec,"ColorPickerBehavior",kj,[]);var sc=d(367),ad=d(313),Xd=d(1779),ue=d(743),ae=d(399),Te=d(1206);class sf{constructor(b,h){this.iQk=b;this.Nnh=h}Fxe(b,h,n,B){if(Kf.c(b)||Kf.c(h))return null;const L=new Te.a;const ba=B.x,la=B.y,La=B.width;var fb=B.height;
let Cb;sf.Xgc(h,"flyoutWidth");B=sf.Xgc(h,"flyoutRealHeight");const Lb=sf.Xgc(h,"viewportWidth"),$b=sf.Xgc(h,"viewportHeight"),tc=sf.Xgc(h,"viewableLeft"),Nc=sf.Xgc(h,"viewableTop"),dd=this.iQk;let Hd=!1,xe=!1;const je=1===n,he=4===n,fe=this.Nnh;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Cb=this.Adj(b);L.Kak=$b;L.vOg=Lb;if(je)dd?h=ba+La:(h=ba-Cb,L.lub=!0),fb=la;else{var De="";La>Cb&&(Cb=La,De=(Cb-2*ae.Menu.ake).toString());dd?h=ba:(h=ba+La-Cb,L.lub=
!0);fb=la+fb;""!==De&&(b.style.minWidth=De+"px")}fe&&(fb+=Nc,h+=tc);b.style.top=fb+"px";b.style.left=h+"px";let gg=De=!1;Cb<=Lb?h+Cb>tc+Lb?(je&&dd&&ba-Cb>tc||he&&ba-Cb>tc?(h=ba-Cb,fe&&(h+=tc),gg=L.lub=!0):(h=tc+Lb-Cb,Hd=!0),De=!0):h<tc&&(je&&!dd&&ba+La+Cb<tc+Lb?(h=ba+La,fe&&(h+=tc),L.lub=!1,gg=!0):(h=tc,xe=!0,L.lub=!0),De=!0):dd?(h=tc,De=!0,L.lub=!0):(h=tc+Lb-Cb,De=!0,L.lub=!1);De&&(b.style.left=h+"px");L.Sic=fb;if(!(fb+B<=Nc+$b)||3===n){L.E3f=!0;const {YPn:eg,hbm:vl,fjn:wl,rqn:Sm}=this.tEf(n,fb,
B,la,Nc,$b);fb!==eg&&(b.style.top=eg+"px",L.Sic=eg);-1<vl&&(b.style.maxHeight=vl+"px");wl&&(b.style.bottom="0px",b.style.height="auto");Sm&&this.BHn(b,dd,je,gg,xe,Hd,Lb,ba,La)}L.k1c=h;L.SEf=Cb;L.OEf=B;return L}tEf(b,h,n,B,L,ba){let la,La,fb;la=-1;fb=La=!1;const Cb=h,Lb=L+ba-h;h=B-n;const $b=this.Nnh;let tc=!1;0>h&&(h=L);$b||(B-=L);n<=B&&1!==b||(4===b||1===b?n<ba?(h=ba-n,La=!0):(h=L,tc=fb=La=!0):(B<Lb&&3!==b?(h=Cb,La=!0):la=B,fb=!0));$b&&(La=!1,tc?la=ba:h+=L);return{YPn:h,hbm:la,fjn:La,rqn:fb}}BHn(b,
h,n,B,L,ba,la,La,fb){b.style.overflowY="scroll";b.style.width="auto";if(h){if(ba||B)b.style.left="",b.style.right=(ba?0:la-La)+"px"}else L||B||(b.style.left="",b.style.right=(n?la-La:la-La-fb)+"px")}Kpm(b){const h={};if(Kf.c(b))return h;h.viewportWidth=Lh.a.srb();h.viewportHeight=Lh.a.nX();Kf.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);Kf.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=
document.body.clientHeight);h.viewableTop=window.pageYOffset;h.viewableLeft=window.pageXOffset;Kf.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);Kf.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*ae.Menu.ake:b.scrollHeight;const n=b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.Adj(b);b.style.overflowY=
n;return h}Adj(b){return b.offsetWidth}static Xgc(b,h){return Kf.c(b)?0:b[h]}}Object(u.a)(sf,"MenuPositioner",null,[]);var kg=d(552),qf=d(650),fh=d(1208),Fi=d(1207),Nj=d(1204),Zh=d(1205),hk=d(1210),km=d(419),lm=d(1053);class Rl extends kj{constructor(b){super(b);this.Y0e=0;this.Xrh=null;this.r4e=-1;this.EAd=null;this.qlg=this.Bkh=!1;this.OUk=()=>{this.Ig&&this.Ig.Qc&&(document.body.appendChild(this.XVh),this.Rco())};this.Ahf=h=>{h.element&&(h.element.style.filter="",h.element.style.opacity="",this.Ig&&
this.Ig.Qc===h.element&&Object(Wb.a)(Nj.a,this.Ig)&&ad.a.i5k(this.nvi()))};this.LEk=new sf(0===this.root.L4,ng.a.at(this.root.properties.DivSyndicated))}get Rdj(){return this.LEk}get Mv(){return this.control}get properties(){return this.control.$h}get Ig(){return this.Mv.Ig}set Ig(b){this.Mv.Ig=b}get EN(){return this.Mv.EN}set EN(b){this.Mv.EN=b}get XVh(){Kf.c(this.EAd)&&(this.EAd=Rl.Mtf());return this.EAd}get jTj(){let b=!this.root.GUf;Object(Wb.a)(243,this.root)&&1===this.root.xVb&&(b=!0);return b}oy(b,
h){Object(Wb.a)(243,this.root)&&this.root.kBf();this.Mv.L3(h)}L3(b){if(this.Mv.enabled&&!this.EN){var h=Yc.a.instance.rq(Pa.a.L3);h.properties.add("Id",this.Mv.$h.Id);h.properties.add("InputMethod",sc.a[b]);h.end();ce.a.mark(10326);$c.a.Zje(this.Mv.$h.Id,"MenuOpen");this.Mv.Ev&&(this.Mv.Eka=$c.a.kqb(this.Mv.Ev.ownerDocument));this.Y0e=b;this.Ptj(b);this.Vwe();this.Mv.Efb(this.Mv.Ev,!0)}}Vwe(){Kf.c(this.properties.PopulateAsyncTriggerCommand)||this.Bkh||(this.QRn(),this.Bkh=!0)}QRn(){const b={};b[Xd.a.Callback]=
Object(z.a)(this,this.jAj,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.Xk,0,!1)}jAj(){this.Mv.NZa()}NZa(){this.EN&&this.Ptj(this.Y0e,!0)}Ptj(b,h=!1){var n=!0;if(ng.a.at(this.properties.PopulateDynamically)){n=!1;const B=this.Chd(b);B!==this.Xrh&&(n=this.Glg(B,h));n=n||!this.EN}n&&(h=A.AFrameworkApplication.ua.hs,n=null,h&&(n=h.Vf("LoadResource","Menu Initialization")),this.pta(b),n&&n.stop(),this.wne())}pta(b){if(!Kf.c(this.Ig)){if(this.Mv.Ccb){var h=
this.Mv.Xk;if(h&&h.keytip){var n=h.keytip.key.toLocaleLowerCase();this.Ig.yWo(String.format("{0} {1}",this.Mv.Ccb,h.keytip.lAf),this.Mv.pZa&&""!==this.Mv.pZa?String.format("{0}-{1}",this.Mv.pZa,n):n)}}this.Ig.psa();ng.a.pg(this.Ig.Qc,this.Mv.phf);ng.a.n9(this.Ig.Qc,"cui-touch",3===b||this.root.IDe);if(this.Ig.hasItems()){this.Ig.fL();h=this.Xk;h.Mki();h.T6c=!0;h.Uf(this.Ig);h.T6c=!1;this.Ig.Itj();n=Object(Wb.a)(lm.a,this.root);var B=null,L=!1;n&&(B=this.root,L=B.reb,B.reb=!1);var ba=this.Ig.Qc;ba.style.visibility=
"hidden";ba.style.position="absolute";ba.style.top="0px";ba.style.left="0px";X.a.Mt&&!X.a.ktb&&(ba.style.maxHeight="100px",ba.style.overflowY="scroll");document.body.appendChild(ba);this.n3k();this.Wco(ba);Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.NUk();ng.a.pg(this.Mv.rUb,Lk.MenuLauncher.vdd);var la=this.root.xVb;this.l2o&&this.root.Oja(this.control,!0);ba.style.zIndex=String(A.AFrameworkApplication.ua.Zya);this.root.zXk(this.Mv);this.Ig.Tva=la;ba.style.visibility="visible";la=this.nvi();
if(Object(Wb.a)(Zh.a,this.Ig)){ba.style.position="fixed";const La=this.root.xE[0];La&&La.Ig&&La.Ig.Qc?100!==$c.a.c4c(this.root.xE[0].Ig.Qc)&&ad.a.LDg(ba,la,this.Ahf):ad.a.LDg(ba,la,this.Ahf)}else ad.a.LDg(ba,la,this.Ahf);this.EN=!0;this.Ig.D3f=!0;!X.a.Di&&this.Mv.mOo&&this.Ig.setFocus(b);n&&(B.reb=L);n=this.properties.CommandMenuOpen;Kf.b(n)||this.root.executeCommand(n,null,h,b,!1)}}ce.a.mark(10327)}wne(){}NUk(){this.r4e=ng.a.sLb(this.r4e);this.r4e=window.setTimeout(this.OUk,50)}Rco(){const b=this.XVh;
var h=this.Ig.Qc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let n=h.offsetWidth;h=h.offsetHeight;X.a.ktb&&(n-=4,h-=4);b.style.width=n.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get l2o(){return this.root.xVb?!1:!0}nvi(){const b=this.Ig.children,h=[];if(Object(Wb.a)(Nj.a,this.Ig))for(let n=0;n<b.count;n++){const B=b.J(n);Array.add(h,B.separator);
for(let L=0;L<B.children.count;L++){const ba=B.children.J(L);Array.add(h,ba.Qc)}}return h}n3k(){var b=this.Ig.children;for(let n=0;n<b.count;n++){const B=b.J(n).children;for(let L=0;L<B.count;L++){var h=B.J(L);if(Object(Wb.a)(ep.a,h)){const ba=h;if("Menu32"===ba.WW||"Menu48"===ba.WW)h=h.control,h.behavior&&(Object(Wb.a)(qf.a,h)||Object(Wb.a)(Fi.a,h))&&h.behavior.k3k()}}}0<b.count&&(b=b.J(0),Kf.c(b.separator)||(b.separator.style.display="none"),Kf.c(b.kDe)||ng.a.pg(b.kDe,"cui-menusection-titleAtTop"))}Wco(b){if(!Kf.c(b)){b.style.top=
"0px";b.style.left="0px";b.style.bottom="";b.style.right="";b.style.width="";b.style.minWidth="";var h=ue.a.create();try{const n=this.Rdj.Kpm(b),B=this.K3c();let L=this.root.Fxe(b,n,this.Mv.bke,B);L||(L=this.Rdj.Fxe(b,n,this.Mv.bke,B));this.root.Sdj=L}finally{h&&h.dispose()}}}K3c(){const b=$c.a.getElementBounds(this.Mv.rUb);var h=this.qK;Kf.c(h)||Kf.c(h.Qc)||(h=$c.a.getElementBounds(h.Qc),b.x=h.x+ae.Menu.ake,b.width=h.width-2*ae.Menu.ake);Object(Wb.a)(km.a,this.Mv.Mhe)&&(b.height=0);return b}Qza(){if(this.Mv.EN){x.ULS.sendTraceTag(6688860,
207,50,"Menu closing {0}",{["Id"]:this.Mv.$h.Id});this.Ig.Iua();this.ICj();this.EN=!1;this.Ig.D3f=!1;this.root.ofa(this.control,!0);this.jTj?A.AFrameworkApplication.ua.$ld(this.Mv.Eka,this.Y0e):this.ZGo();this.Mv.Eka=null;var b=this.Mv.rUb;ng.a.Nx(b,Lk.MenuLauncher.vdd);this.Mv.Efb(this.Mv.Ev,!1);ng.a.Nx(b,"cui-ctl-menu-hovered-without-focus");this.Ig.ova();Kf.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.Xk,0,!1);this.HCj()}}ZGo(){const b=
this.Mv.Eka;if(b)try{b.focus()}catch(h){}}HCj(){Lh.a.Dy(this.Ig.Qc);Lh.a.Dy(this.EAd);ng.a.dFa(this.Ig.Qc)}Chd(b){if(this.qlg&&ng.a.at(this.properties.PopulateOnlyOnce)||Kf.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.Mv.jIf();return 0<(this.root.Xua(this.properties.PopulateQueryCommand,this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}Glg(b,h=!1){if(this.qlg&&ng.a.at(this.properties.PopulateOnlyOnce))return!0;let n=null;this.Xrh=b;Kf.c(b)||
(n=this.tHl(b));Kf.c(n)||(this.qlg=!0);if(h){this.root.Frl(this.Mv);if(Kf.c(n)||!n.hasItems())return this.Qza(),!1;this.ICj();this.HCj()}this.AVo(n);return!0}Mkj(){}tHl(b){b=kg.Builder.z8h(b);if(!Kf.c(b)){const h=new hk.a;h.S3h=!0;h.parentId=this.control.id;let n;n=Object(Wb.a)(fh.a,this.control);return this.root.TQ.z6a(b,h,n)}return null}AVo(b){Kf.c(b)||(Kf.c(this.Ig)||this.Ig.dispose(),this.Ig=b,this.Mkj())}ICj(){const b=this.Ig.parent;b?(b.T6c=!0,b.removeChild(this.Ig.id),b.T6c=!1):x.ULS.sendTraceTag(572330335,
207,10,"Parent not found for the Menu component {0}",this.Ig.id)}onKeyDown(b){let h=!1;Kf.c(b.Kb)||Kf.c(b.Kb.rawEvent)||Object(Wb.a)(ep.a,this.Xk)||!b.Kb.rawEvent.altKey||b.Kb.keyCode!==Sys.UI.Key.down||(this.oy(b.Nf,1,b.Kb),h=!0);h||(h=super.onKeyDown(b));return h}zE(b){this.Rqf();2===b.Ag&&b.Cga!==Sys.UI.MouseButton.leftButton||this.oy(b.Nf,b.Ag,b.Kb);b.Kb.preventDefault();return!1}NRf(b){if(!this.qK||!this.qK.inKeytipMode||!this.Mv.Ulj)return!1;this.Mv.Ulj(this.Xk,b);return!0}static Mtf(){const b=
ng.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(u.a)(Rl,"MenuLauncherBehavior",kj,[587,562]);var Oj=d(990);class Fn extends Rl{constructor(b){super(b)}get nu(){return this.TZc.properties}get TZc(){return this.control}get eVa(){return this.TZc.eVa}fL(){ul.a.instance.nb(Cd.a.nt,this.eVa.Nn,Object(z.a)(this,this.zE,"onPointerDown"));bb.KeyInputManager.instance.nb(Cd.a.Ti,this.eVa.Nn,Object(z.a)(this,this.onKeyDown,"onKeyDown"));
bb.KeyInputManager.instance.nb(Cd.a.oi,this.eVa.Nn,Object(z.a)(this,this.fA,"onKeyUp"))}wn(){const b=this.Sd[Oj.a.SelectedItemId];if(0<(this.nv(this.nu.Command,this.nu.QueryCommand,this.Sd)&2)){const h=this.Sd[Oj.a.SelectedItemId];Kf.c(h)||b===h||this.TZc.jnd(h)||(this.Sd[Oj.a.SelectedItemId]=null)}}}Object(u.a)(Fn,"DropDownBehavior",Rl,[]);var em=d(568),dn=d(819);class Lo extends Fn{constructor(b){super(b);this.C2a=null;this.E1e=this.uEb=this.ZGa=!1;this.zNc=null;this.xNc=-1;this.fgg=h=>{let n=!1;
if(2!==h.Ag||h.Cga===Sys.UI.MouseButton.leftButton)this.oy(h.Nf,h.Ag,h.Kb),this.jxe(),n=!0;n&&h.Kb.preventDefault();return!1};this.bZn=h=>{let n=!1;if(!Kf.c(h.Kb)&&!Kf.c(h.Kb.rawEvent)){const B=h.Kb.keyCode;h=h.Kb.rawEvent.shiftKey;ng.a.at(this.LJ.AutoComplete);if(B===Sys.UI.Key.enter)this.KW(),this.tvg(),Object(Wb.a)(dn.Ribbon,this.root)&&this.root.Y2(),n=!0;else if(B===Sys.UI.Key.tab){if(this.KW(),this.tvg(),Object(Wb.a)(dn.Ribbon,this.root)&&(n=this.root.jHe(this.Xk.Qc,!h)),Object(Wb.a)(243,this.root))return!0}else B===
Sys.UI.Key.backspace||B===Sys.UI.Key.del?this.control.enabled?(this.Wnf(),this.zNc=null):n=!0:B===Sys.UI.Key.esc?(this.xvg(),this.tvg(),Object(Wb.a)(dn.Ribbon,this.root)&&this.root.Y2(),n=!0):B===Sys.UI.Key.down&&(this.L3(1),this.jxe(),n=!0)}return n};this.cZn=h=>{if(!this.control.enabled)return!0;!Kf.c(h.Kb)&&h.Kb.charCode&&this.gPl();return!1};this.Ifg=()=>this.ZGa?!1:this.ZGa=!0}get Q6(){return this.control}get UT(){return this.Q6.UT}get LJ(){return this.Q6.LJ}get wee(){return this.Sd[em.a.IsFreeForm]}set wee(b){this.Sd[em.a.IsFreeForm]=
b}fL(b){ul.a.instance.nb(Cd.a.nt,b.Nn,Object(z.a)(this,this.zE,"onPointerDown"));const h=b.Bs;Ne.a.instance.nb(Cd.a.focus,h,Object(z.a)(this,this.Jvb,"onInputFocus"));Ne.a.instance.nb(Cd.a.blur,h,Object(z.a)(this,this.lDa,"onInputBlur"));bb.KeyInputManager.instance.nb(Cd.a.Ti,h,this.bZn);bb.KeyInputManager.instance.nb(Cd.a.jv,h,this.cZn);Yg.a.instance.nb(Cd.a.Dga,h,this.Ifg);ul.a.instance.nb(Cd.a.nt,h,Object(z.a)(this,this.eZn,"onInputPointerDown"));ul.a.instance.nb(Cd.a.nt,b.nji,this.fgg)}wn(){0<
(this.nv(this.LJ.Command,this.LJ.QueryCommand,this.Sd)&2)&&(this.uEb||this.P9j(),this.awp())}Mkj(){this.Q6.menuItems=null;var b;var h=b=null;if(!Kf.c(this.Ig)){this.jxe();for(const B of this.Ig.children)for(const L of B.children)if(Object(Wb.a)(ep.a,L)){var n=L;n=n.control;Object(Wb.a)(575,n)&&(b=n,b=b.$h.MenuItemId);Object(Wb.a)(559,n)&&(h=n,h=h.O9a());Kf.c(b)||Kf.c(h)||(this.Q6.menuItems[h]=b,b=h=null)}}}eZn(b){Object(Wb.a)(243,this.root)&&2===b.Ag&&(this.C2a=$c.a.kqb(this.control.Ev.ownerDocument),
this.control.Ev.focus());return!1}zE(b){this.Rqf();let h=!1;3===b.Ag&&(h=super.zE(b),this.jxe());h&&b.Kb.preventDefault();return!1}o3l(){this.xNc=-1;const b=this.UT.Bs,h=b.value,n=this.wsm(h);if(n){b.value=n.key;if(b.setSelectionRange)b.setSelectionRange(h.length,b.value.length);else if(b.createTextRange){const B=b.createTextRange();B.moveStart("character",h.length);B.moveEnd("character",b.value.length);B.select()}this.zNc=n.value}else this.zNc=null}wsm(b){const h=this.Q6.menuItems;for(const n in h){const B=
{key:n,value:h[n]};if(B.key.toLowerCase().startsWith(b.toLowerCase()))return B}return null}gPl(){ng.a.at(this.LJ.AutoComplete)&&-1===this.xNc&&(this.E1e&&(this.Chd(0),this.E1e=!1),this.xNc=window.setTimeout(Object(z.a)(this,this.o3l,"executeAutoComplete"),this.Q6.Aal))}Wnf(){ng.a.at(this.LJ.AutoComplete)&&(this.xNc=ng.a.sLb(this.xNc))}Jvb(b){if(this.EN)return this.Ig.setFocus(0),!0;Object(Wb.a)(243,this.root)&&(Ph.FocusManager.instance().ME("ribbon"),this.root.g6c=!1);this.onFocus(b);this.uEb=!0;
ng.a.pg(this.UT.Nn,"cui-cb-focus");ng.a.at(this.LJ.PopulateDynamically)&&(this.E1e=!0);$c.a.fnd(this.UT.Bs);Kf.c(this.Ig)||this.Ig.xn();return this.ZGa=!1}lDa(){this.uEb=!1;this.KW();ng.a.Nx(this.UT.Nn,"cui-cb-focus");return!1}tvg(){Object(Wb.a)(243,this.root)&&(void 0!==this.C2a&&null!==this.C2a&&A.AFrameworkApplication.ua.$ld(this.C2a,2),this.C2a=null)}KW(){if(this.control.enabled){this.Wnf();var b=this.UT.Bs;if(void 0===this.Sd[em.a.Value]||null===this.Sd[em.a.Value]||b.value!==this.Sd[em.a.Value].toString())if(this.Q6.jnd(this.zNc))this.wee=
!1,this.Sd[em.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.Q6.ond.rPb(),["MenuItemId"]:this.Q6.ond.$h.MenuItemId},this.root.executeCommand(this.LJ.Command,b,this.Xk,0,!1);else{if(!ng.a.at(this.LJ.AutoComplete)){var h=this.Q6.menuItems[b.value];if(!Kf.b(h)&&this.Q6.jnd(h)){this.wee=!1;this.Sd[em.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.Q6.ond.rPb(),["MenuItemId"]:h};this.root.executeCommand(this.LJ.Command,b,this.Xk,0,!1);return}}h=!Kf.b(b.value)&&""!==F.a.XDa(b.value);
this.Q6.FRh&&h?(this.wee=!0,this.Sd[em.a.Value]=b.value,this.root.executeCommand(this.LJ.Command,{["IsFreeForm"]:!0,["Value"]:b.value},this.Xk,0,!1)):this.xvg()}}else this.xvg()}xvg(){this.Wnf();this.zNc=null;this.P9j()}P9j(){const b=this.Sd[em.a.Value]||"";b!==this.UT.Bs.value&&(this.UT.Bs.value=b);this.Q6.jnd(this.Q6.menuItems[b])}awp(){const b=this.Sd[em.a.FontStyle]||"normal";b!==this.UT.Bs.style.fontStyle&&(this.UT.Bs.style.fontStyle=b)}jxe(){this.control.Ev&&this.Ig&&this.control.Ev.setAttribute(Bc.a.MUh,
this.Ig.id)}}Object(u.a)(Lo,"ComboBoxBehavior",Fn,[]);class Gi extends Rl{constructor(b){super(b)}get QXd(){return this.control}K3c(){let b=0;this.Ig&&this.Ig.Qc&&2===this.Ig.horizontalAlignment&&(b=this.Ig.Qc.clientWidth);return new Sys.UI.Bounds(this.QXd.x-b,this.QXd.y,this.QXd.G3f,this.QXd.F3f)}}Object(u.a)(Gi,"ContextMenuLauncherBehavior",Rl,[]);class en extends Rl{constructor(b){super(b)}get K_d(){return this.control}K3c(){return new Sys.UI.Bounds(this.K_d.x,this.K_d.y,this.K_d.G3f,this.K_d.F3f)}}
Object(u.a)(en,"DialogMenuLauncherBehavior",Rl,[]);var uk=d(649);class pj extends Rl{constructor(b){super(b);this.H1e=!1;this.INk=!ng.a.Pla(this.nu.ShouldRefreshWhenDropped)}get pKa(){return this.control}get nu(){return this.control.$h}fL(b){b=b.Nn;Kf.c(b)||(Ne.a.instance.nb(Cd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus")),Ne.a.instance.nb(Cd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur")),ul.a.instance.nb(Cd.a.cM,b,Object(z.a)(this,this.hS,"onPointerOver")),bb.KeyInputManager.instance.nb(Cd.a.Ti,
b,Object(z.a)(this,this.onKeyDown,"onKeyDown")),bb.KeyInputManager.instance.nb(Cd.a.oi,b,Object(z.a)(this,this.fA,"onKeyUp")),ul.a.instance.nb(Cd.a.nt,b,Object(z.a)(this,this.zE,"onPointerDown")))}wn(){Kf.c(this.control.$h.Command)||(this.pKa.EN&&!this.INk?this.H1e=!0:(0<(this.nv(this.nu.Command,this.nu.QueryCommand,this.Sd)&2)&&this.Nfb()&&this.J0a(),ng.a.at(this.nu.RefreshableMenu)&&this.EN&&this.Ig.Ibo()))}J0a(){this.Yvp();this.moa();this.Nwp();this.pKa.pUf=this.Sd[uk.a.ImageIsVisible]}Yvp(){const b=
ng.a.swa(this.Sd[uk.a.LabelText],this.nu.LabelText),h=this.Sd[uk.a.LabelTextUserGeneratedPlaceholderReplacements];if(this.control.labelText!==b||this.nu.LabelTextUserGeneratedPlaceholderReplacements!==h)this.IG.Js&&this.Zvp(this.IG.Js.mR,b,h),this.root.Mbb=!0,this.control.labelText=b,this.nu.LabelTextUserGeneratedPlaceholderReplacements=h}Zvp(b,h,n){const B=b.lastChild;ng.a.nNj(b,h+" ",n);h=Kf.c(B);x.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",
h?"":B.nodeType.toString());h||b.appendChild(B)}Nwp(){const b=this.Sd[uk.a.ImageBackColor];this.IG.forEach(h=>{pj.t7k(h.hU,b)})}L3(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&A.AFrameworkApplication.va.Ob(Pa.a.O_d,2);"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||A.AFrameworkApplication.va.Ob(Pa.a.O_d,2);Object(Wb.a)(ep.a,this.Xk)&&(this.EN||this.Spf(!0),this.control.enabled&&this.X0());
super.L3(b)}Qza(){super.Qza();this.H1e&&(this.H1e=!1,this.wn())}hS(b){return this.control.DTb()?(this.pKa.EN?(this.root.$_h(),ng.a.pg(this.pKa.rUb,Lk.MenuLauncher.vdd),this.pKa.Eka=this.control.Ev):(super.hS(b),this.oy(b.Nf,b.Ag,b.Kb)),!1):super.hS(b)}onKeyDown(b){let h=!1;if(!Kf.c(b.Kb)&&!Kf.c(b.Kb.rawEvent)){if(Object(Wb.a)(ep.a,this.Xk)){const n=b.Kb.rawEvent,B=b.Kb.keyCode,L=0===this.root.L4;n.shiftKey||n.ctrlKey||!(B===Sys.UI.Key.right&&L||B===Sys.UI.Key.left&&!L)||(h=this.NRf(b),h||(this.oy(b.Nf,
1,b.Kb),h=!0))}h||(h=super.onKeyDown(b))}return h}static t7k(b,h){Kf.c(b)||Kf.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(u.a)(pj,"FlyoutAnchorBehavior",Rl,[]);var Jj=d(1025);class Uo extends kj{constructor(b){super(b)}get mjc(){return this.control}get properties(){return this.mjc.properties}get eka(){return this.mjc.eka}fL(b){b=b.ONb;Ne.a.instance.nb(Cd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Ne.a.instance.nb(Cd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));
ul.a.instance.nb(Cd.a.cM,b,Object(z.a)(this,this.hS,"onPointerOver"));ul.a.instance.nb(Cd.a.kH,b,Object(z.a)(this,this.ZL,"onPointerOut"));bb.KeyInputManager.instance.nb(Cd.a.Ti,b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));bb.KeyInputManager.instance.nb(Cd.a.oi,b,Object(z.a)(this,this.fA,"onKeyUp"));ul.a.instance.nb(Cd.a.nt,b,Object(z.a)(this,this.zE,"onPointerDown"));ul.a.instance.nb(Cd.a.LP,b,Object(z.a)(this,this.pDa,"onPointerUp"));tk.a.instance.nb(Cd.a.CS,b,Object(z.a)(this,this.Wvb,"onTouchMove"));
tk.a.instance.nb(Cd.a.rM,b,Object(z.a)(this,this.hNa,"onTouchEnd"))}wn(){const b=this.Sd[Jj.a.On],h=this.Sd[Jj.a.IsRtl];this.s9j();if(0<(this.nv(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)){var n=!Kf.c(this.Sd[Jj.a.InnerHTML])||!Kf.c(this.properties.InnerHTML),B=!Kf.c(this.properties.Image);n||B||(this.control.enabled=!1);B=this.eka.ONb;if(!Kf.c(B)){if(n){n=ng.a.swa(this.Sd[Jj.a.InnerHTML],this.properties.InnerHTML);if(null===B.innerHTML||null===n||F.a.xh(B.innerHTML)!==F.a.xh(n))B.innerHTML=
n;""===n&&(this.control.enabled=!1)}n=B.title;const L=ng.a.swa(this.Sd[Jj.a.Alt],this.properties.Alt);L===n||this.control.qCg||(B.title=L)}B=this.Sd[Jj.a.IsRtl];b===this.Sd[Jj.a.On]&&h===B||this.control.RWb()}}s9j(){const b=this.Sd;b[Jj.a.CommandValueId]=this.control.rPb();b.MenuItemId=this.control.$h.MenuItemId;b.SourceControlId=this.properties.Id}oy(b,h,n){if((b=this.Xk)&&this.control.enabled){const B=this.root;if(A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&
b.Z9c()&&this.qK){const L=B.xE[this.qK.Tva];L?L.q_a(this.mjc):x.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.s9j();this.Sd[Jj.a.On]||(this.Sd[Jj.a.On]=!0,this.control.RWb());"Menu"===b.WW&&ng.a.Nx(this.eka.Nn,"cui-gallerybutton-focused");B.executeCommand(this.properties.Command,this.Sd,b,h,!0,null,this.mX(n))}}onFocus(b){super.onFocus(b);ng.a.pg(this.eka.Nn,"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);
ng.a.Nx(this.eka.Nn,"cui-gallerybutton-focused");return!1}}Object(u.a)(Uo,"GalleryButtonBehavior",kj,[]);var Sn=d(1211),Vo=d(1443),Tn=d(679);class Qm extends kj{constructor(b){super(b);this.T3a=-1}get enc(){return this.control}get properties(){return this.enc.$h}get hWc(){return this.enc.hWc}get HTf(){var b=null;if(this.Xk&&(b=this.Xk.parent,!Object(Wb.a)(Tn.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get $Rb(){return this.enc.uce.$Rb}get vgd(){return this.enc.uce.vgd}oy(b,
h,n){if(this.control.enabled){b=this.TKf(this.Ejc(b));const B=this.M5d(b);this.hWc[Vo.a.Rows]=this.l9d(b)+1;this.hWc[Vo.a.Columns]=B+1;this.root.executeCommand(this.properties.Command,this.hWc,this.Xk,h,!0,null,this.mX(n))}}fL(b){var h=b.Nn;const n=b.O0h;b=b.cells;ul.a.instance.nb(Cd.a.kH,h,Object(z.a)(this,this.wWn,"onControlPointerOut"));tk.a.instance.nb(Cd.a.CS,h,Object(z.a)(this,this.yWn,"onControlTouchMove"));tk.a.instance.nb(Cd.a.rM,h,Object(z.a)(this,this.xWn,"onControlTouchEnd"));for(h=0;h<
b.length;++h)this.X$k(n[h],b[h])}X$k(b,h){Ne.a.instance.nb(Cd.a.focus,b,Object(z.a)(this,this.reg,"onCellFocus"));ul.a.instance.nb(Cd.a.cM,h,Object(z.a)(this,this.teg,"onCellPointerOver"));ul.a.instance.nb(Cd.a.LP,h,Object(z.a)(this,this.ueg,"onCellPointerUp"));bb.KeyInputManager.instance.nb(Cd.a.Ti,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));bb.KeyInputManager.instance.nb(Cd.a.oi,h,Object(z.a)(this,this.fA,"onKeyUp"));tk.a.instance.nb(Cd.a.ES,h,Object(z.a)(this,this.zVn,"onCellTouchStart"))}TKf(b){return parseInt(b.id.substr(this.enc.id.length+
1))}EMi(b){this.DMi(this.TKf(b))}l9d(b){return Math.floor(b/Sn.a.Aed)}M5d(b){return b%Sn.a.Aed}DMi(b){if(b!==this.T3a){var h=this.M5d(b),n=this.l9d(b),B=-1;let L=-1;-1!==this.T3a&&(B=this.l9d(this.T3a),L=this.M5d(this.T3a));for(;B!==n||L!==h;)B<n?this.xPj(++B,L,!0):B>n?(this.xPj(B,L,!1),B--):L<h?this.aNj(++L,B,!0):L>h&&(this.aNj(L,B,!1),L--);this.HTf?this.HTf.lQj(this.Wui(n+1,h+1)):(n=(h=this.control.drf)&&0<h.length?h[0]:null,B=this.Xk,x.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",
{["CtrlComps"]:!!h,["FirstComp"]:!!n,["FirstCompPar"]:!!n&&!!n.parent,["DispComp"]:!!B,["DispCompPar"]:!!B&&!!B.parent}));this.T3a=b}}xPj(b,h,n){for(let B=0;B<=h;B++)this.SMj(b,B,n)}aNj(b,h,n){for(let B=0;B<=h;B++)this.SMj(B,b,n)}SMj(b,h,n){h=b*Sn.a.Aed+h;b=this.$Rb[h];h=this.vgd[h];n?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}ueg(b){this.oy(b.Nf,b.Ag,b.Kb);return!0}Ejc(b){for(;b.hasChildNodes();)b=
b.childNodes[0];return Kf.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}mQj(b){const h=this.TKf(b);b.childNodes[0].childNodes[0].title=this.Wui(this.l9d(h)+1,this.M5d(h)+1)}Wui(b,h){let n=this.properties.Alt;Kf.c(n)&&(n=this.properties.MenuSectionTitle);return n=String.format(n,h.toString(),b.toString())}Fvc(){if(this.Xk){for(var b=0;b<Sn.a.gsc;b++)this.$Rb[b].className="cui-it-inactiveCell",this.vgd[b].className="cui-it-inactiveCellOuter";this.T3a=-1;b=this.properties.MenuSectionInitialTitle;
Kf.c(b)&&(b="");this.HTf.lQj(b)}}teg(b){this.control.enabled&&(b=this.Ejc(b.Nf),this.Tnd(b),this.Kyf(b));return!1}Kyf(b){this.mQj(b);this.EMi(b)}reg(b){if(!this.control.enabled)return!1;b=this.Ejc(b.Nf);this.mQj(b);this.EMi(b);return!1}wWn(b){$c.a.Y_f(this.enc.uce.Nn,b.clientPoint)||this.Fvc();return!1}zVn(b){if(!this.control.enabled)return!1;b=this.Ejc(b.Nf);this.Kyf(b);return!0}yWn(b){if(!this.control.enabled)return!1;b=$c.a.C6d(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=
this.Ejc(b))?this.Kyf(b):this.Fvc();return!0}xWn(b){if(!this.control.enabled)return!1;var h=$c.a.C6d(b.clientPoint);if(!h||"table"===h.tagName.toLowerCase())return this.Fvc(),!0;(h=this.Ejc(h))?this.oy(h,3,b.Kb):this.Fvc();return!0}iN(b){b=Db.a.WEf(this.T3a,Sn.a.Aed,Sn.a.gsc,b);if(b!==this.T3a)return this.$Rb[b].firstChild.focus(),this.DMi(b),!0;this.Fvc();this.T3a=-1;return!1}X0(){const b=this.$Rb[0];if(Kf.c(b))return!1;b.firstChild.focus();return!0}Tnd(b){if(Kf.c(b))return!1;b.firstChild.firstChild.focus();
return!0}Iua(){this.Fvc()}}Object(u.a)(Qm,"InsertTableBehavior",kj,[]);class Bn extends Rl{constructor(b){super(b)}wn(){this.control.enabled=!!this.Ig}oy(b,h,n){A.AFrameworkApplication.va.Pb(Pa.a.gYa,2,h,this.mX(n))}}Object(u.a)(Bn,"JewelMenuLauncherBehavior",Rl,[]);var Am=d(1156);class Mo extends kj{constructor(b){super(b)}get properties(){return this.control.$h}wn(){0<(this.nv(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)&&this.Nfb()&&this.J0a()}J0a(){this.kAp();this.moa();this.B2b()}kAp(){const b=
this.control.labelText;let h=this.Sd[Am.a.Value];Kf.c(h)&&(h=this.properties.LabelText,Kf.c(h)&&(h=""));h!==b&&this.Wxe(h)}fL(b){b=b.Nn;Kf.c(b)||(ul.a.instance.nb(Cd.a.nt,b,Object(z.a)(this,this.zE,"onPointerDown")),ul.a.instance.nb(Cd.a.cM,b,Object(z.a)(this,this.hS,"onPointerOver")),ul.a.instance.nb(Cd.a.kH,b,Object(z.a)(this,this.ZL,"onPointerOut")))}}Object(u.a)(Mo,"LabelBehavior",kj,[]);var lr=d(945),Gn=d(226),vn=d(319);class Vq extends Rl{constructor(b){super(b);this.bWe=this.FNe=!1;this.K7b=
this.e4b=null;if(this.m8b=A.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.e4b=this.ov.vna.LightImage16by16Class,this.K7b=this.ov.vna.DarkImage16by16Class}get ov(){return this.control}Kle(b,h,n,B){h&&(this.ov.Eka=n,A.AFrameworkApplication.ua.jyb());if(Object(Wb.a)(Gn.a,b)&&B){n=new lr.a;n.CommandLocation=this.root.Cca;n.InvocationMethod=0;const L={};(b=b.control)&&b.$h&&(L.CommandId=b.$h.Command,L.ControlId=b.$h.Id,L.CloseAllMenus=h,b.qK&&b.qK.parent&&b.qK.parent.id&&(L.ParentControlId=
b.qK.parent.id.split("-")[0]),this.root.oH&&this.root.oH.rVa(B,L,n))}}Qza(){this.ov.Eka||(this.ov.Eka=this.ov.Zz);!this.ov.ANn&&this.m8b&&(ng.a.Nx(this.ov.Zz,"cui-sb-focus"),ng.a.Nx(this.ov.Q4,"cui-sb-focus"),ng.a.Nx(this.ov.mEa,this.e4b),ng.a.pg(this.ov.mEa,this.K7b));this.FNe=!0;super.Qza();this.FNe=!1;this.Mpg()}get jTj(){return!this.ov.wZa}wne(){this.ov.wne()}rte(){this.bWe||this.FNe||(this.bWe=!0,this.ov.raiseEvent(vn.a.J$a,null))}Mpg(){this.EN||this.ov.NVf||(this.bWe=!1,this.ov.raiseEvent(vn.a.wSb,
null))}Gfg(b){ng.a.Nx(this.ov.Zz,"cui-sb-focus");ng.a.Nx(this.ov.Q4,"cui-sb-focus");this.m8b&&!this.ov.EN&&(ng.a.Nx(this.ov.mEa,this.e4b),ng.a.pg(this.ov.mEa,this.K7b));this.ov.raiseEvent(vn.a.blur,b);this.Mpg();this.ov.Eka=this.ov.Zz;return!1}Hfg(b){ng.a.pg(this.ov.Zz,"cui-sb-focus");ng.a.pg(this.ov.Q4,"cui-sb-focus");this.m8b&&(ng.a.Nx(this.ov.mEa,this.K7b),ng.a.pg(this.ov.mEa,this.e4b));this.ov.raiseEvent(vn.a.focus,b);this.rte();return!1}ihg(){this.m8b&&(ng.a.pg(this.ov.Q4,"cui-sb-hover"),ng.a.pg(this.ov.Zz,
"cui-sb-hover"),ng.a.Nx(this.ov.mEa,this.K7b),ng.a.pg(this.ov.mEa,this.e4b));return!1}hhg(){this.m8b&&(ng.a.Nx(this.ov.Q4,"cui-sb-hover"),ng.a.Nx(this.ov.Zz,"cui-sb-hover"),this.ov.EN||this.ov.NVf||(ng.a.Nx(this.ov.mEa,this.e4b),ng.a.pg(this.ov.mEa,this.K7b)));return!1}}Object(u.a)(Vq,"SearchBoxBehavior",Rl,[573,562]);class ho{}ho.Value="value";ho.MinValue="MinValue";ho.MaxValue="MaxValue";ho.Text="Text";Object(u.a)(ho,"SliderCommandProperties",null,[]);class Er extends kj{constructor(b){super(b);
this.Jga=()=>{this.Swl(this.W8.Bs.value);return!0}}get zEg(){return this.control}get W8(){return this.zEg.W8}get properties(){return this.control.$h}initialize(){}oy(){}fL(b){b=b.Bs;Ne.a.instance.nb(Cd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Ne.a.instance.nb(Cd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Ne.a.instance.nb(Cd.a.fVc,b,this.Jga);Ne.a.instance.nb(Cd.a.input,b,this.Jga)}onFocus(b){this.W8.Nn&&Sys.UI.DomElement.addCssClass(this.W8.Nn,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.W8.Nn&&
Sys.UI.DomElement.removeCssClass(this.W8.Nn,"cui-sldr-onfocus");return super.onBlur(b)}Swl(b){this.Sd[ho.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Sd,this.Xk,0,!1)}wn(){const b=this.Sd[ho.Value],h=this.Sd[ho.MaxValue],n=this.Sd[ho.Text];var B=this.nv(this.properties.Command,this.properties.QueryCommand,this.Sd);this.W8&&this.W8.Bs&&(this.W8.Bs.disabled=!this.control.enabled);if(0<(B&2)){B=this.Sd[ho.Value];const L=this.Sd[ho.MaxValue],ba=this.Sd[ho.Text];(L!==h||B!==
b||n!==ba)&&this.W8&&this.W8.Bs&&(this.W8.Bs.setAttribute(Bc.a.kTd,String.format("{0}",L)),this.W8.Bs.setAttribute("max",String.format("{0}",L)),this.W8.Bs.value=B,this.W8.mR.innerText=this.Sd[ho.Text])}}}Object(u.a)(Er,"SliderBehavior",kj,[]);var Ki=d(1435);class Bs extends kj{constructor(b){super(b);this.YHd=0;this.Blb=null;this.yFd=!1;this.qKh=null;this.Q9e=!1;this.YKd=this.vJd=-1;this.ZGa=!1;this.LI=()=>!this.control.enabled;this.Jga=()=>{this.KW();return!1};this.Ifg=()=>this.ZGa?!1:this.ZGa=
!0;this.vjj=h=>{var n=!1;let B=!0;2===h.Ag&&(B=h.Cga===Sys.UI.MouseButton.leftButton);B&&(n=h.Nf,this.PXj(n===this.YI.Ohc||n===this.YI.yji||n===this.YI.xji,h.Ag),n=!0);return n};this.wjj=h=>this.vAa(h);this.WCo=()=>{this.a0h();-1===this.YKd&&(this.RAe(),this.YKd=window.setInterval(Object(z.a)(this,this.RAe,"spin"),50))}}get V0b(){return this.control}get YI(){return this.V0b.YI}get properties(){return this.control.$h}initialize(){const b=this.V0b.WNg;this.qKh=this.Qrp(b);this.YHd=b[0].min;this.Blb=
b[0];this.yFd=!1}oy(){}fL(b){const h=b.Bs,n=b.Ohc;b=b.f_c;Ne.a.instance.nb(Cd.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));Ne.a.instance.nb(Cd.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur"));bb.KeyInputManager.instance.nb(Cd.a.Ti,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));bb.KeyInputManager.instance.nb(Cd.a.jv,h,this.LI);bb.KeyInputManager.instance.nb(Cd.a.oi,h,Object(z.a)(this,this.fA,"onKeyUp"));Ne.a.instance.nb(Cd.a.fVc,h,this.Jga);Yg.a.instance.nb(Cd.a.Dga,h,this.Ifg);ul.a.instance.nb(Cd.a.nt,
n,this.vjj);ul.a.instance.nb(Cd.a.nt,b,this.vjj);ul.a.instance.nb(Cd.a.LP,n,this.wjj);ul.a.instance.nb(Cd.a.LP,b,this.wjj);tk.a.instance.nb(Cd.a.CS,n,Object(z.a)(this,this.yjj,"onArrowTouchMove"));tk.a.instance.nb(Cd.a.CS,b,Object(z.a)(this,this.yjj,"onArrowTouchMove"));tk.a.instance.nb(Cd.a.rM,n,Object(z.a)(this,this.xjj,"onArrowTouchEnd"));tk.a.instance.nb(Cd.a.rM,b,Object(z.a)(this,this.xjj,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);ng.a.pg(this.YI.Nn,"cui-spn-focus");this.control.enabled&&
$c.a.fnd(this.YI.Bs);return this.ZGa=!1}onBlur(b){super.onBlur(b);ng.a.Nx(this.YI.Nn,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!Kf.c(b.Kb)&&!Kf.c(b.Kb.rawEvent)){const n=b.Kb.keyCode,B=b.Kb.rawEvent.shiftKey;if(n===Sys.UI.Key.up||n===Sys.UI.Key.down)this.root.oYf(this.control)||this.PXj(n===Sys.UI.Key.up,b.Ag),h=!0;else if(n===Sys.UI.Key.enter)this.KW(),Object(Wb.a)(dn.Ribbon,this.root)&&this.root.Y2(),h=!0;else if(n===Sys.UI.Key.tab)this.KW(),Object(Wb.a)(dn.Ribbon,this.root)&&(h=this.root.jHe(this.Xk.Qc,
!B));else if(n===Sys.UI.Key.esc)this.Hvc(),Object(Wb.a)(dn.Ribbon,this.root)&&this.root.Y2(),h=!0;else if(n===Sys.UI.Key.backspace||n===Sys.UI.Key.del)h=!this.control.enabled}return h}fA(){this.nNl();return!1}yjj(b){return this.jme(b)}xjj(b){return this.vAa(b)}X3m(b){if(this.control.enabled){var h=!1;if(!this.yFd){var n=this.Zvm(b);n=b?n+this.Blb.step:n-this.Blb.step;n=Math.min(n,this.Blb.max);n=Math.max(n,this.Blb.min);n!==this.YHd&&(this.Qqf(n,this.Blb),this.root.executeCommand(this.properties.Command,
this.Sd,this.Xk,0,!1),h=!0)}h||(h=this.properties.SpinCommand,n=this.Sd,n.Increment=b,Kf.c(h)||this.root.executeCommand(h,n,this.Xk,0,!1))}}Zvm(b){const h=Math.pow(10,A.AFrameworkApplication.numberFormat.Tle),n=Math.round(this.Blb.step*h);let B=Math.round(this.YHd*h)/n;B=b?Math.floor(B):Math.ceil(B);return B*n/h}PXj(b,h){if(this.control.enabled){this.KW();const n=b?this.YI.Ohc:this.YI.f_c;switch(h){case 2:case 3:this.Q9e=b;this.NQd(n);break;case 1:this.Q9e=b,this.lUk(n)}}}wYj(){this.a0h();this.Sll()}oei(){-1===
this.vJd&&(this.vJd=window.setTimeout(this.WCo,500))}a0h(){this.vJd=ng.a.sLb(this.vJd)}Sll(){this.YKd=ng.a.Oll(this.YKd)}RAe(){this.X3m(this.Q9e)}lUk(b){this.root.Oja(this.control,!1);ng.a.pg(b,Ko.a.QQd);this.RAe();this.oei()}nNl(){this.root.ofa(this.control,!1);this.wYj();ng.a.Nx(this.YI.Ohc,Ko.a.QQd);ng.a.Nx(this.YI.f_c,Ko.a.QQd)}hxc(b){this.YI.Bs.value!==b&&(this.YI.Bs.value=b)}Hvc(){this.hxc(this.Sd[Ki.a.Text])}rNj(b){this.hxc(b);this.Sd[Ki.a.Text]=b;this.yFd=!0}aSo(b,h,n){this.hxc(n);this.Sd[Ki.a.Text]=
n;this.Sd[Ki.a.Number]=b;this.Sd[Ki.a.UnitType]=h.type;this.YHd=b;this.Blb=h;this.YI.Bs.setAttribute(Bc.a.Pjf,n);this.YI.Bs.setAttribute(Bc.a.TUh,String.format("{0}",h.min));this.YI.Bs.setAttribute(Bc.a.kTd,String.format("{0}",h.max));this.yFd=!1}G5h(b){var h;if(({pRn:h}=this.urn(b)).returnValue)this.rNj(h);else{({number:b,Afb:h}=F.a.$rj(b,this.qKh,A.AFrameworkApplication.numberFormat));let n=this.IEe(h);0===h&&Kf.c(n)&&(n=this.IEe(this.Sd[Ki.a.UnitType]));this.Qqf(b,n)}}Qqf(b,h){b=this.vcg(b,h);
if(isNaN(b)||Kf.c(h))this.Hvc();else{const n=A.AFrameworkApplication.numberFormat;let B;B=F.a.xKa(b,h.type,n);B=B.replace(6===h.type?n.Ule:n.Bkg,"");this.aSo(b,h,B)}}urn(b){let h,n=!1;h="";b=b.trim();const B=this.V0b.X$j;if(!Kf.c(B))for(let L=0;L<B.length;L++)if(B[L].toLowerCase()===b.toLowerCase()){h=B[L];n=!0;break}return{returnValue:n,pRn:h}}vcg(b,h){return isNaN(b)||Kf.c(h)?Number.NaN:h.vcg(b)}IEe(b){let h=null;const n=this.V0b.WNg;for(let B=0;B<n.length;B++)if(n[B].type===b){h=n[B];break}return h}Qrp(b){const h=
b.length,n=Array(h);for(let B=0;B<h;B++)n[B]=b[B].type;return n}KW(){if(this.control.enabled){const b=this.Sd[Ki.a.Text],h=this.YI.Bs.value;h!==b&&(this.G5h(h),this.Sd[Ki.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Sd,this.Xk,0,!1))}else this.Hvc()}wn(){var b=this.Sd[Ki.a.Text],h=this.Sd[Ki.a.Number];const n=this.Sd[Ki.a.UnitType],B=this.Sd[Ki.a.MaxValue];if(0<(this.nv(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)){const L=this.Sd[Ki.a.Text],ba=this.Sd[Ki.a.Number],
la=this.Sd[Ki.a.UnitType],La=this.Sd[Ki.a.MaxValue];La!==B&&(this.IEe(la).max=La,this.YI.Bs.setAttribute(Bc.a.kTd,String.format("{0}",La)));L!==b?""===L?this.rNj(L):this.G5h(L):isNaN(ba)||ba===h&&la===n||this.Qqf(ba,this.IEe(la));b=this.YI.Nn.title;h=ng.a.swa(this.Sd[Ki.a.Alt],this.properties.Alt);h!==b&&(this.YI.Bs.title=h,this.YI.Ohc.title=h,this.YI.f_c.title=h)}}mef(b){super.mef(b);b?(this.RAe(),this.oei()):this.wYj()}}Object(u.a)(Bs,"SpinnerBehavior",kj,[563,562]);var Wo=d(444),If=d(955);class Wq extends Rl{constructor(b){super(b);
this.o9b=!0;this.MBb=!1}get Z8(){return this.control}get nu(){return this.Z8.properties}fL(b){const h=b.Nn,n=b.Xob;b=b.h_c;Ne.a.instance.nb(Cd.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));Ne.a.instance.nb(Cd.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur"));bb.KeyInputManager.instance.nb(Cd.a.Ti,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));bb.KeyInputManager.instance.nb(Cd.a.oi,h,Object(z.a)(this,this.fA,"onKeyUp"));X.a.ju&&16>this.wqm()&&(ul.a.instance.nb(Cd.a.nt,h,Object(z.a)(this,this.zoj,
"onSplitbuttonPointerDownPointerUp")),ul.a.instance.nb(Cd.a.LP,h,Object(z.a)(this,this.zoj,"onSplitbuttonPointerDownPointerUp")));ul.a.instance.nb(Cd.a.cM,n,Object(z.a)(this,this.jVn,"onButtonPointerOver"));ul.a.instance.nb(Cd.a.kH,n,Object(z.a)(this,this.iVn,"onButtonPointerOut"));ul.a.instance.nb(Cd.a.nt,n,Object(z.a)(this,this.Njj,"onButtonPointerDown"));ul.a.instance.nb(Cd.a.LP,n,Object(z.a)(this,this.Ojj,"onButtonPointerUp"));tk.a.instance.nb(Cd.a.CS,n,Object(z.a)(this,this.lVn,"onButtonTouchMove"));
tk.a.instance.nb(Cd.a.rM,n,Object(z.a)(this,this.kVn,"onButtonTouchEnd"));ul.a.instance.nb(Cd.a.nt,b,Object(z.a)(this,this.fgg,"onMenuButtonPointerDown"));ul.a.instance.nb(Cd.a.cM,b,Object(z.a)(this,this.a_n,"onMenuButtonPointerOver"));ul.a.instance.nb(Cd.a.kH,b,Object(z.a)(this,this.$Zn,"onMenuButtonPointerOut"))}oy(b,h,n){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.MBb&&(this.Z8.on=!this.Z8.on,b=this.Sd,b.CommandValueId=this.control.rPb(),this.root.executeCommand(this.nu.Command,b,this.Xk,
h,!0,null,this.mX(n))):this.o9b&&super.oy(b,h,n)}fA(b){const h=b.Kb.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Sd,b.CommandValueId=this.control.rPb(),this.root.executeCommand(this.nu.Command,b,this.Xk,1,!0),!0):super.fA(b)}wn(){const b=this.root.Xua(this.nu.Command,this.nu.QueryCommand,this.Sd),h=0<(b&1);let n=!0;n=Kf.c(this.nu.CommandMenuOpen)?h:0<(this.root.Xua(this.nu.CommandMenuOpen,null,null)&1);if(n!==this.o9b||h!==this.MBb||(n||h)!==this.control.enabled)this.control.enabled=
n||h,h!==this.MBb&&this.tXn(h),n!==this.o9b&&this.uXn(n),this.o9b=n,this.MBb=h;if(0<(b&2)){this.moa();const B=ng.a.swa(this.Sd[If.a.LabelText],this.nu.LabelText);this.Sd[If.a.ApplyLabelTextToControlOnly]?this.Z8.Yic(L=>{L.Nn.title=B;L.Xob.removeAttribute("title");L.h_c.removeAttribute("title")}):this.Z8.Yic(L=>{L.Xob.title=B});this.Sd[If.a.EnsureControlRoleIsButton]&&this.Z8.Yic(L=>{Bc.a.Ls(L.Nn,Bc.a.Ph,Bc.a.eaa)});Kf.c(this.Sd[If.a.Visible])||this.Nfb()&&this.J0a()}this.Z8.setState(this.Z8.on&&h)}J0a(){this.sMg();
this.B2b();this.moa()}uXn(b){this.Z8.Yic(h=>{ng.a.iyb(h.h_c,b)});this.Jkd();this.o9b=b}tXn(b){this.Z8.Yic(h=>{ng.a.iyb(h.Xob,b)});this.Jkd();this.MBb=b}Jkd(){const b=this.Z8.Jqb();Kf.c(b)||(ng.a.Nx(b.childNodes[0],"cui-ctl-split-hovered-primary"),ng.a.Nx(b.childNodes[0],"cui-ctl-split-hovered-secondary"),ng.a.Nx(b.childNodes[1],"cui-ctl-split-hovered-primary"),ng.a.Nx(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}zoj(b){if(0!==Wo.a(b.Kb))return!1;let h=!1;b.eventName===Cd.a.nt?h=this.Njj(b):
b.eventName===Cd.a.LP&&(h=this.Ojj(b));return h}Njj(b){let h=!1;const n=b.Ag;switch(n){case 3:this.d5o()?this.oy(this.Xk.Qc,n,b.Kb):this.NQd(this.Z8.hhi);h=!0;break;case 2:b.Cga===Sys.UI.MouseButton.leftButton&&(this.NQd(this.Z8.hhi),h=!0)}h&&b.Kb.preventDefault();return!1}d5o(){const b=this.Xk.WW;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}Ojj(b){return this.vAa(b)}lVn(b){return this.jme(b)}kVn(b){return this.vAa(b)}onFocus(b){super.onFocus(b);this.vTf(!0,!0);return!1}onBlur(b){super.onFocus(b);
this.Jkd();return!1}jVn(){this.control.enabled&&this.MBb&&this.vTf(!0,this.Z8.on);return!1}iVn(){this.control.enabled&&this.MBb&&this.Jkd();return!1}fgg(b){let h=!1;if(2!==b.Ag||b.Cga===Sys.UI.MouseButton.leftButton)this.oy(b.Nf,b.Ag,b.Kb),h=!0;h&&b.Kb.preventDefault();return!1}a_n(){this.control.enabled&&this.o9b&&this.vTf(this.Z8.on,!0);return!1}$Zn(){this.Jkd();return!1}vTf(b,h){const n=this.control.Jqb();Kf.c(n)||(ng.a.pg(n.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),
ng.a.pg(n.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}wqm(){var b=X.a.Bhc;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(u.a)(Wq,"SplitButtonBehavior",Rl,[]);var Mn=d(1442);class Rk extends kj{constructor(b){super(b);this.uEb=this.ZGa=!1;this.Tuk=!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("ExcelTableRenameEnabled");this.LI=()=>!this.control.enabled;this.Jga=()=>{this.KW();return!1};this.WYa=()=>this.Qha.isEditable?this.ZGa?!1:
this.ZGa=!0:($c.a.fnd(this.Qha.Bs),!0)}get Frd(){return this.control}get Qha(){return this.Frd.Qha}get THg(){return this.Frd.$h}fL(b){b=b.Bs;Ne.a.instance.nb(Cd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Ne.a.instance.nb(Cd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));bb.KeyInputManager.instance.nb(Cd.a.Ti,b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));bb.KeyInputManager.instance.nb(Cd.a.jv,b,this.LI);bb.KeyInputManager.instance.nb(Cd.a.oi,b,Object(z.a)(this,this.fA,"onKeyUp"));Ne.a.instance.nb(Cd.a.fVc,
b,this.Jga);Yg.a.instance.nb(Cd.a.Dga,b,this.WYa)}onFocus(b){super.onFocus(b);this.uEb=!0;ng.a.pg(this.Qha.Nn,"cui-tb-focus");this.control.enabled&&$c.a.fnd(this.Qha.Bs);return this.ZGa=!1}onBlur(b){this.uEb=!1;super.onBlur(b);ng.a.Nx(this.Qha.Nn,"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!Kf.c(b.Kb)&&!Kf.c(b.Kb.rawEvent)){const n=b.Kb.keyCode,B=b.Kb.rawEvent.shiftKey;n===Sys.UI.Key.tab?(this.KW(),Object(Wb.a)(dn.Ribbon,this.root)&&(h=this.root.jHe(this.Xk.Qc,!B))):n===Sys.UI.Key.enter?
this.Tuk&&(this.KW(),Object(Wb.a)(dn.Ribbon,this.root)&&this.root.Y2(),h=!0):n===Sys.UI.Key.esc?(this.Hvc(),Object(Wb.a)(dn.Ribbon,this.root)&&this.root.Y2(),h=!0):n===Sys.UI.Key.backspace||n===Sys.UI.Key.del?h=!this.control.enabled:b.Rza&&(Nb.a.Y_h(b.Kb),h=!1)}return h}fA(){return!1}hxc(b){this.Qha.Bs.value!==b&&(this.Qha.Bs.value=b)}Hvc(){this.hxc(this.Sd[Mn.a.Text])}KW(){if(this.control.enabled&&this.Qha.isEditable){const b=this.Qha.Bs.value;b!==this.Sd[Mn.a.Text]&&(this.Sd[Mn.a.Text]=b,this.root.executeCommand(this.THg.Command,
this.Sd,this.Xk,0,!1))}else this.Hvc()}wn(){const b=this.Sd[Mn.a.Text];if(0<(this.nv(this.THg.Command,this.THg.QueryCommand,this.Sd)&2)&&!this.uEb){const h=this.Sd[Mn.a.Text];h!==b&&this.hxc(h)}}}Object(u.a)(Rk,"TextBoxBehavior",kj,[561,562]);var qo=d(420);class vj extends kj{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.$h}oy(b,h,n){this.control.enabled&&(ng.a.Pla(this.properties.TogglesWhenExecuted)||this.toggle(),this.Sd.CommandValueId=this.toggleButton.rPb(),
this.Sd.MenuItemId=this.toggleButton.$h.MenuItemId,this.Sd.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Sd,this.Xk,h,!ng.a.Pla(this.properties.CloseMenuWhenExecuted),B=>{ng.a.at(this.properties.UpdateHtmlPostToggle)&&(32===B?this.B1j():this.z1j())},this.mX(n)))}z1j(){this.Sd[$g.a.On]=!this.Sd[$g.a.On]}B1j(){this.toggleButton.setState(this.Sd[$g.a.On]);(this.toggleButton.kFa&&this.toggleButton.RFe||ng.a.at(this.properties.UpdateHtmlPostToggle))&&this.J0a()}toggle(){this.z1j();
ng.a.at(this.properties.UpdateHtmlPostToggle)||this.B1j()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!Kf.c(b.Kb)&&this.qK){const n=b.Kb.keyCode;n!==Sys.UI.Key.enter&&n!==Sys.UI.Key.space||b.Kb.preventDefault()}return h}wn(){Kf.c(this.properties.MenuItemId)||(this.Sd.MenuItemId=this.properties.MenuItemId);0<(this.nv(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)&&this.Nfb()&&this.J0a()}J0a(){this.toggleButton.setState(this.Sd[$g.a.On]);this.yvp(ng.a.swa(this.Sd[$g.a.DisplayMode],
""));this.sMg();this.moa();this.lxp();$g.a.Alt in this.Sd&&this.B2b()}lxp(){const b=this.IG.jqc;if(b&&b.Yob){var h=ng.a.swa(this.Sd[$g.a.Description],this.properties.Description);h!==b.Yob.innerText&&(b.Yob.innerText=h,b.mR&&!Object(Wb.a)(qo.Jewel,this.root)&&(h=!Kf.b(h),ng.a.n9(b.mR,"UIFontBold",h),ng.a.n9(b.mR,"cui-ctl-mediumlabel-nodescription",!h)))}}fL(b){b=b.Nn;Ne.a.instance.nb(Cd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Ne.a.instance.nb(Cd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));
ul.a.instance.nb(Cd.a.cM,b,Object(z.a)(this,this.hS,"onPointerOver"));ul.a.instance.nb(Cd.a.kH,b,Object(z.a)(this,this.ZL,"onPointerOut"));bb.KeyInputManager.instance.nb(Cd.a.Ti,b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));bb.KeyInputManager.instance.nb(Cd.a.oi,b,Object(z.a)(this,this.fA,"onKeyUp"));ul.a.instance.nb(Cd.a.nt,b,Object(z.a)(this,this.zE,"onPointerDown"));ul.a.instance.nb(Cd.a.LP,b,Object(z.a)(this,this.pDa,"onPointerUp"));Ef.a.instance.nb(Cd.a.click,b,Object(z.a)(this,this.onClick,
"onClick"));tk.a.instance.nb(Cd.a.CS,b,Object(z.a)(this,this.Wvb,"onTouchMove"));tk.a.instance.nb(Cd.a.rM,b,Object(z.a)(this,this.hNa,"onTouchEnd"))}}Object(u.a)(vj,"ToggleButtonBehavior",kj,[]);class Cp{constructor(b){this.irk=b;this.tSe={["Button"]:h=>new Mm(h),["FileMenuButton"]:h=>new Mm(h),["ColorPicker"]:h=>new ec(h),["ComboBox"]:h=>new Lo(h),["ContextMenuControl"]:h=>new Gi(h),["ContextMenuLauncher"]:h=>new Gi(h),["DialogMenuLauncher"]:h=>new en(h),["DropDown"]:h=>new Fn(h),["FlyoutAnchor"]:h=>
new pj(h),["GalleryButton"]:h=>new Uo(h),["StatefulColorFlyoutAnchor"]:h=>new pj(h),["JewelMenuLauncher"]:h=>new Bn(h),["Label"]:h=>new Mo(h),["Placeholder"]:h=>new kj(h),["SearchBox"]:h=>new Vq(h),["Separator"]:h=>new kj(h),["SplitButton"]:h=>new Wq(h),["StatefulColorSplitButton"]:h=>new Wq(h),["StatefulImageSplitButton"]:h=>new Wq(h),["TextBox"]:h=>new Rk(h),["ToggleButton"]:h=>new vj(h)}}Uji(){this.tSe[Ko.a.yTi]=b=>new Qm(b)}IAf(){this.tSe[Ko.a.MWj]=b=>new Bs(b)}Jim(b){const h=this.tSe[b.controlType];
(b=h?h(b):null)&&this.irk&&b.C_l();return b}static get instance(){return Cp._instance||(Cp._instance=new Cp(!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}Cp._instance=null;Object(u.a)(Cp,"ControlBehaviorFactory",null,[531]);var fp=d(1054),Zp=d(162);class Bm extends Lk.MenuLauncher{constructor(b,h,n,B){super(b,h,n,B);this.ath=null;this.FTa=this.TRc=0;this.oH=null;this.LKc=this.KKc=0;this.Ah("Menu");this.enabled=!0}get x(){return this.TRc}get y(){return this.FTa}get F3f(){return this.KKc}get G3f(){return this.LKc}get controlType(){return"DialogMenuLauncher"}aeb(){}Efb(){}jIf(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.nu.DialogMoveCommand;b.DialogCloseCommand=this.nu.DialogCloseCommand;return b}fxn(b,h){this.TRc=b.x;this.FTa=b.y;this.KKc=b.height;this.LKc=b.width;this.L3(h)}aU(b){this.ath=ng.a.createElement("span");return new Zp.a(b,this.ath)}get nu(){return this.$h}Vza(b,h,n){return new Bm(b,this.id,h,n)}}Object(u.a)(Bm,"DialogMenuLauncher",Lk.MenuLauncher,[]);var $p=d(890);class lh extends fp.a{constructor(b,h){super(b,h);this.Agb=null}get pef(){return this.Agb}get Qfi(){return this.properties}get Cca(){return 20}xn(){super.xn();
Kf.c(this.Qc)&&this.pE();this.Qc=ng.a.WZa(this.Qc);this.d_(this.Qc);this.dirty=!1}oR(b){if(!Object(Wb.a)($p.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}utf(b,h,n,B){n=new ae.Menu(this,h,n,B,null);b||(b={});b.CommandMenuOpen=this.Qfi.CommandMenuOpen;b.CommandMenuClose=this.Qfi.CommandMenuClose;b=new Bm(this,h,b,n);this.igc[h]=b;h=new $p.a(this,"dock"+h);h.Uf(b.PW("Menu"));this.Uf(h);this.refresh()}qDg(b,h,n,B){const L=this.igc[b];if(Kf.c(L))throw Error.create('The dialog menu "'+
b+'" does not exist');L.fxn(new Sys.UI.Bounds(h,n,0,0),B);this.Agb=L.Ig}Upf(b){b=this.igc[b];Kf.c(b)||(b.Qza(),this.Agb=null)}xne(){this.Agb=null}dispose(){const b=this.igc;for(const h in b)b[h].dispose();super.dispose()}}Object(u.a)(lh,"DialogMenuRoot",fp.a,[]);class Fr{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(u.a)(Fr,"RootProperties",null,[]);class Zi extends Fr{constructor(){super()}}Object(u.a)(Zi,"StandaloneRootProperties",Fr,[]);class Xj extends Zi{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(u.a)(Xj,"DialogMenuRootProperties",Zi,[]);class Us{constructor(){this.ylg=(h,n,B,L,ba)=>{if(1===B)return 32;h=new Sys.StringBuilder;h.append('<Menu Id="dialogMenu">');h.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');h.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',ba.DialogMoveCommand,CommonUIStrings.l_DialogMove));h.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',ba.DialogCloseCommand,
CommonUIStrings.l_DialogClose));h.append("</Controls></MenuSection>");h.append("</Menu>");ba.PopulationXML=h.toString();return 32};const b=new Xj;b.ImageSideArrow=A.AFrameworkApplication.Ys;b.ImageSideArrowClass=Bb.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=A.AFrameworkApplication.isRtl?"rtl":"ltr";this.Ed=new lh("DialogMenuRootId",b);this.Ed.oH=this;this.Ed.refresh();A.AFrameworkApplication.va.fb(Pa.a.ylg,id.a.frame,this.ylg,96)}get j9(){return this.Ed}rVa(b,h,n,B,L=null){b=parseInt(b);
B=A.AFrameworkApplication.va;n&&(B.iE=n.CommandLocation,B.y3=n.InvocationMethod);h=B.Pb(b,2,h,L);this.Ed.refresh();return 32===h}$La(b){return b?32===A.AFrameworkApplication.va.Ob(parseInt(b),1):!0}nv(){this.j9.root.wn()}utf(b,h,n){const B={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};B.DialogMoveCommand=h;B.DialogCloseCommand=n;this.j9.utf(B,b,"","")}qDg(b,h,n,B){this.j9.qDg(b,h,n,B)}Upf(b){this.j9.Upf(b)}dispose(){this.Ed&&(this.Ed.dispose(),
this.Ed=null)}}Object(u.a)(Us,"DialogMenuRootUser",null,[205,13,489]);class Si{constructor(b,h,n){this.xCb=this.tNd=this.TLc=this.El=null;this.gWe=this.IMd=!1;this.$tc=B=>{if(!this.HUf)return!1;B.Kb.preventDefault();this.tCf();return!0};this.XHc=b;this.ne=h;this.ox=n;this.l8b=A.AFrameworkApplication.isRtl}get HUf(){return this.gWe}s2l(b){b?(this.El=b,this.gWe=!0,this.IMd=!1,this.ne.capture(Object(z.a)(this,this.Fvn,"keyEventHandler"),null),this.ox.nb(Cd.a.nt,this.XHc,this.$tc),this.TLc||this.DHl(),
this.El.appendChild(this.TLc),this.E6m()):x.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}tCf(){this.gWe=!1;this.tNd=this.xCb=null;this.Uyo();this.Trg();this.El=null}Trg(){this.ne.releaseCapture();this.ox.xc(Cd.a.nt,this.XHc,this.$tc)}E6m(){if(this.El.style.left.endsWith("px")&&this.El.style.right.endsWith("px"))this.xCb=new Sys.UI.Point(fo.a.J0(this.l8b?this.El.style.right:this.El.style.left),fo.a.J0(this.El.style.top));else{const b=this.l8b?this.XHc.offsetWidth-(this.El.offsetLeft+
this.El.offsetWidth+fo.a.J0(this.El.style.marginRight)):this.El.offsetLeft-fo.a.J0(this.El.style.marginLeft),h=this.El.offsetTop-fo.a.J0(this.El.style.marginTop);this.UPj(b,h);this.xCb=new Sys.UI.Point(b,h)}this.tNd=this.xCb}DHl(){this.TLc=Bb.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}Uyo(){this.TLc.parentNode===this.El&&this.El.removeChild(this.TLc)}Fvn(b){if(!this.HUf)return!1;b.Kb.preventDefault();if(b.eventName===Cd.a.Ti){const h=b.Kb.ctrlKey?1:10;let n;switch(b.Kb.keyCode){case Jd.a.y9:this.Lrc(0,
-1*h);break;case Jd.a.aia:this.Lrc(0,1*h);break;case Jd.a.sBc:n=this.l8b?1:-1;this.Lrc(n*h,0);break;case Jd.a.zAb:n=this.l8b?-1:1;this.Lrc(n*h,0);break;case Jd.a.Sfb:this.bfj(this.tNd.x,this.tNd.y);this.IMd=!0;break;case Jd.a.Mu:this.IMd=!0}}b.eventName===Cd.a.oi&&this.IMd&&this.tCf();return!0}Lrc(b,h){this.bfj(this.xCb.x+b,this.xCb.y+h)}bfj(b,h){b=this.p3k(b,h);this.UPj(b.x,b.y);this.xCb=b}UPj(b,h){this.l8b?this.El.style.right=b+"px":this.El.style.left=b+"px";this.El.style.top=h+"px"}p3k(b,h){const n=
this.l8b?fo.a.J0(this.El.style.marginRight):fo.a.J0(this.El.style.marginLeft),B=fo.a.J0(this.El.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-n,b),this.XHc.offsetWidth-this.El.offsetWidth-n),Math.min(Math.max(-B,h),this.XHc.offsetHeight-this.El.offsetHeight-B))}}Object(u.a)(Si,"KeyMoveAdapter",null,[490]);var Un=d(1200),mr=d(611);class fn{get name(){return"CUI.Behavior"}wc(b){A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(b.register(489,"Common.UI.IDialogMenuRootUser").ha().Rd(()=>
new Us),b.register(490,"Common.IKeyMoveAdapter").ha().Rd(()=>new Si(A.AFrameworkApplication.ua.Gsa(),bb.KeyInputManager.instance,ul.a.instance)));b.register(mr.a,"CommandUI.RootManager").as("Common.IRootManager").ha().Rd(()=>mr.a.instance)}init(){Un.a.usf=Cp.instance;const b=mr.a.instance.Rve;for(let h=0;h<b.length;++h){const n=Object(ya.a)(491,b[h]);n&&n.lVa()}ml.a.get_instance().vK(6)}dispose(){}static main(){M.a.instance.Jc(new fn,5)}}Object(u.a)(fn,"CuiBehaviorPackage",null,[0,1]);class aq{constructor(b){const h=
new Zi;h.ImageUpArrow=h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=Bb.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=Bb.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=Bb.getImageClass("RibbonUpArrow_8x8x32");h.ImageDownArrow8by8Class=Bb.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=Bb.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=Bb.getImageClass("CheckboxChecked_16x16x32");
h.ImageUncheckMarkClass=Bb.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=A.AFrameworkApplication.isRtl?"rtl":"ltr";this.jlb=fp.a.fKl(h);this.jlb.refresh()}get Bha(){return this.jlb}dispose(){this.jlb.dispose()}}Object(u.a)(aq,"StandaloneRootController",null,[1424,13]);var Hq=d(1232),cl=d(240);class Iq{constructor(b){this.COc=b}create(b,h){const n=new Sys.StringBuilder;this.$Xc(n,b,h);this.Ttf(n,b);return n.toString()}BMb(b,h){const n=[];this.Euf(n,b,h);this.Utf(n,b);return n}$Xc(b,h,
n){switch(h.errorType){case 0:b.append(this.COc.build());break;case 1:case 2:b.append(this.zmf(h,n))}}Euf(b,h,n){switch(h.errorType){case 0:b.push(this.COc.nYh());break;case 1:case 2:b.push(this.Dfl(h,n))}}Ttf(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');b.append(cl.a("btnIgrnoreSpellingError",(2===h.errorType?wb.a.xPa:wb.a.WBa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));b.append("</Controls></MenuSection>")}Utf(b,h){const n=Object.assign(new te.a,
{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";n.ControlList.push(Object.assign(new jj.a,{ExternalId:h}));b.push(n)}zmf(b,h){b=this.lfm(b.suggestions,h);return 0<b.length?cl.g("msUnknownWord",cl.d(null,b),"Menu16"):cl.g("msUnknownWord",cl.d(null,[cl.a("btnNoSuggestions",wb.a.xPa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}lfm(b,h){const n=[];if(b){const B=Math.min(h.length,b.length);for(let L=0;L<B;++L)b[L]&&n.push(cl.a("btnCorrectWord"+L,h[L].toString(),
b[L]))}return n}Dfl(b,h){const n=Object.assign(new te.a,{Id:"Suggestions",ControlList:[]});this.kfm(b.suggestions,h,n.ControlList);0>=n.ControlList.length&&(b=Object.assign(new jj.a,{ExternalId:"NoSuggestions"}),n.ControlList.push(b));return n}kfm(b,h,n){if(b){const B=Math.min(h.length,b.length);for(let L=0;L<B;++L){if(!b[L])continue;const ba=Object.assign(new jj.a,{ExternalId:"btnCorrectWord"+L,Command:h[L].toString(),LabelText:b[L]});n.push(ba)}}}}Object(u.a)(Iq,"DefaultProofingContextMenuCreator",
null,[]);var pq=d(766);class Xq{constructor(b,h){this.ieh=b;this.ngh=h;this.vqa=[wb.a.Dzb,wb.a.Ezb,wb.a.Fzb,wb.a.v1b,wb.a.w1b]}create(b,h){return h?Object(Wb.a)(pq.a,h)?this.ngh.create(b,h,this.vqa):this.ieh.create(h,this.vqa):""}bgc(b,h){return h?Object(Wb.a)(pq.a,h)?this.ngh.BMb(b,h,this.vqa):this.ieh.BMb(h,this.vqa):null}}Object(u.a)(Xq,"ProofingContextMenuSectionFactory",null,[678]);class Dp{build(){const b=[cl.a("btnDeleteRepeatedWord",wb.a.JJa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,
null)];return cl.g("msRepeatedWord",cl.d(null,b),"Menu16")}nYh(){const b=Object.assign(new te.a,{ControlList:[]}),h=Object.assign(new jj.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(u.a)(Dp,"ProofingRepeatedWordSectionBuilder",null,[677]);class io{static get kh(){return Ge.a.az(io.Mn,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,
Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}io.Mn="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(u.a)(io,"AutoCorrectOptionsDialogHTML",null,[]);class dl{static get kh(){return Ge.a.az(dl.Mn,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}dl.Mn="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(u.a)(dl,"AutoCorrectOptionsDialogHTML2",null,[]);class Nn extends Ge.a{constructor(b,h){super();this.TQo=(n,B)=>{1!==n?x.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):B.ReplaceTextAsYouType!==this.TY.b_a||B.CapitalizeFirstLetterOfSentences!==this.TY.YUd||B.ReplaceOrdianalsWithSuperscript!==this.TY.Xue||B.ReplaceHyphensWithDash!==this.TY.old||B.ReplaceFractionsWithFractionCharacter!==this.TY.Wue||this.eja&&B.ReplaceQuoteWithSmartQuote!==
this.TY.eug?(n={},n.ReplaceTextAsYouType=B.ReplaceTextAsYouType,n.CapitalizeFirstLetterOfSentences=B.CapitalizeFirstLetterOfSentences,n.ReplaceOrdianalsWithSuperscript=B.ReplaceOrdianalsWithSuperscript,n.ReplaceHyphensWithDash=B.ReplaceHyphensWithDash,n.ReplaceFractionsWithFractionCharacter=B.ReplaceFractionsWithFractionCharacter,this.eja&&(n.ReplaceQuoteWithSmartQuote=B.ReplaceQuoteWithSmartQuote),this.TY.yKo(n),x.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:B.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:B.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:B.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:B.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:B.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.eja,["ReplaceQuoteWithSmartQuote"]:this.eja&&B.ReplaceQuoteWithSmartQuote}),Ua.StaticActiveAppFrame.za().Ie(!0)):x.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.TY=b;this.eja=h;this.Qg="AutoCorrectOptionsDialog"}KDg(){x.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.kh=this.eja?dl.kh:io.kh;const b={};b.ReplaceTextAsYouType=this.TY.b_a;b.CapitalizeFirstLetterOfSentences=this.TY.YUd;b.ReplaceOrdianalsWithSuperscript=this.TY.Xue;b.ReplaceHyphensWithDash=this.TY.old;b.ReplaceFractionsWithFractionCharacter=this.TY.Wue;this.eja&&(b.ReplaceQuoteWithSmartQuote=
this.TY.eug);this.pi(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.TQo,b)}}Object(u.a)(Nn,"AutoCorrectOptionsDialog",Ge.a,[676]);class sj{static get kh(){return Ge.a.az(sj.Mn,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}sj.Mn="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(u.a)(sj,"AltTextDialogWithDescriptionHtml",null,[]);class ig{static get kh(){return Ge.a.az(ig.Mn,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}ig.Mn="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(u.a)(ig,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class om extends Ge.a{constructor(b=!1,h=!1){super(!1,!1,b);this.ePi=!1;h?(this.ePi=!0,this.kh=ig.kh):this.kh=sj.kh;this.Qg=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}$sf(b){this.pi(CommonUIStrings.l_AlternativeTextDialogTitle,Object(z.a)(this,this.V4k,"altTextDialogHandler"),this.oJf(b));b=document.getElementById(om.Xhf)||document.getElementById(om.vSd);b.focus();b.select()}oJf(b){const h={};this.ePi?h[om.t0m]=!0:h[om.Xhf]=
this.eHf(b);h[om.vSd]=this.tpm(b)||"";return h}zAa(b){return b.Nf.id===om.vSd?!1:super.zAa(b)}}om.Xhf="titleText";om.vSd="descriptionText";om.t0m="hideTitleField";Object(u.a)(om,"BaseAltTextDialogWithDescription",Ge.a,[]);var xh=d(32);class sl extends om{constructor(b,h,n,B,L){super();this.hk=h;this.Om=n;this.Yo=B;this.Md=L;this.Bzb=this.MW=null;this.$sf(b)}tpm(b){this.MW=b.node;this.Bzb=xh.TableReader.CIi(b);return xh.TableReader.HOf(this.Bzb)}eHf(b){this.MW=b.node;this.Bzb=xh.TableReader.CIi(b);
return xh.TableReader.IOf(this.Bzb)}V4k(b,h){if(1===b){b=xh.TableReader.IOf(this.Bzb);const n=xh.TableReader.HOf(this.Bzb),B=h[om.Xhf];h=h[om.vSd];this.hide();const L=this.Yo.Mc(15);try{L.Ab(this.MW),this.hk.TAg(this.Bzb,B),this.hk.ZPj(this.Bzb,h)}finally{L&&L.dispose()}B===b&&h===n||this.Md.$t(16)}this.Om.Jo&&this.Om.Ak.yG(this.MW)}}Object(u.a)(sl,"TableAltTextDialog",om,[]);class zg{constructor(b,h,n){this.vG=b;this.Pc=h;this.Wd=n}create(b){return new sl(b,this.vG,we.StaticTheCoauthManager.ud(),
this.Pc,this.Wd)}}Object(u.a)(zg,"TableAltTextDialogFactory",null,[]);const Gr=()=>{$e.App.HRh=!0;return 32},yh=(b,h,n,B,L)=>{if(1===n)return 32;if(!({JE:b,iz:h}=fm(L)).returnValue)return 16;Ua.StaticActiveAppFrame.za().Xxc(b,h);return 32},qq=(b,h,n,B,L)=>{if(1===n)return 32;if(!({JE:b,iz:h}=fm(L)).returnValue)return 16;Ua.StaticActiveAppFrame.za().Mna(b,h);return 32},fm=b=>{let h=null,n=0;if(!b)return{returnValue:!1,JE:h,iz:n};b=b.split(",");if(3>b.length)return{returnValue:!1,JE:h,iz:n};h=new Sys.UI.Point(parseInt(b[0]),
parseInt(b[1]));n=parseInt(b[2]);return{returnValue:!0,JE:h,iz:n}};var nl=d(1947);class kn extends Sys.EventArgs{constructor(b,h,n,B,L,ba=0,la=0,La=null){super();this.controlId=b;this.Htc=n;this.commandId=B;this.time=L;this.commandSurface=ba;this.iz=la;this.contentType=La}}Object(u.a)(kn,"CommandClickEventArgs",Sys.EventArgs,[]);class fs{constructor(b,h){this.zxa=b.WIf();this.uFc=b;this.ugb=h}rVa(b,h,n,B=null,L=null){n&&(this.ugb.iE=n.CommandLocation,this.ugb.y3=n.InvocationMethod,this.ugb.yUa=n.CommandTabName);
b=parseInt(b);let ba=this.uFc.byi(b,h,n);ba.qbg&&(ba=this.uFc.byi(ba.FO,h,n));if(void 0!==ba.b8a&&null!==ba.b8a)return ba.b8a;if(ba.nRb)L=32;else{var la=null;this.zxa&&this.zxa.Wlg&&(la=this.zxa.Wlg(ba,L));ba.$la||ba.E$c?ba.iKa?L=16:(L=this.ugb.Pb(ba.FO,ba.$oc?2:1,ba.rd,L),2===L&&(L=32)):ba.iKa?L=this.ugb.ava(null,ba.FO,ba.rd,La=>{B&&B(La.response)},L):(L=this.ugb.Pb(ba.FO,2,ba.rd,L),B&&B(L));this.zxa&&this.zxa.Plg&&this.zxa.Plg(ba,L,la);if(h&&n&&-1!==n.InvocationMethod&&n.InvocationMethod){n=h.LegacyId;
if(void 0===n||null===n)n="";la=h.ParentMenuId;void 0!==la&&null!==la||!h.MenuId||(la=h.MenuId);let La=h.SqmControlId;void 0!==La&&null!==La||!h.SourceControlId||(La=h.SourceControlId);(void 0!==La&&null!==La||void 0!==la&&null!==la)&&nl.a.Tlo(new kn(La,n,la,Ce.ActionManager.U$(b),Date.now()))}}ba.$la&&32===L&&this.zxa&&this.zxa.xIa&&this.zxa.xIa(ba,h);ba.E$c&&32===L&&this.zxa&&this.zxa.g6a&&this.zxa.g6a(ba,h);return 32===L||1===L}$La(b,h=null){if(A.AFrameworkApplication.ol||ph.a.instance.Rw)return!1;
null!=h&&null!=h.UILocation&&(this.ugb.iE=h.UILocation);const n=parseInt(b);if(!b||n===Ce.ActionManager.xAf)return!0;b=this.uFc.Rxi(n,h);b.qbg&&(b=this.uFc.Rxi(b.FO,h));if(void 0!==b.b8a&&null!==b.b8a)return b.b8a;n===Pa.a.zcc&&h&&(b.rd=h);return 32===this.ugb.Pb(b.FO,1,b.rd)}clearCache(){this.uFc.clearCache()}}Object(u.a)(fs,"GeneralCuiUser",null,[204,205]);var vk=d(209),ok=d(64),ln=d(56),mn=d(767);class On{get kJ(){return null!=this.g7g?this.g7g:this.g7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor")}constructor(b,
h,n,B){this.Cfh="DocumentProofingFailed";this.Gaf=b;this.LHh=h;this.txd=n;this.WK=B}GJm(){const b=this.WK.RGm(this.Gaf);return{returnValue:this.WK.oBa(this.Gaf),xio:b}}kxp(b,h){const n=ok.a.Mp();if(n){var B=new vk.ScriptSharpLegacyMap;B.add(Hf.a.DN,b);B.add(Lc.a.noProof,h);b=new Sd.GraphTransaction(15);b.Ab(n);this.kJ.DYa(ln.StyleReader.wordStyleIdNormal,B,n)?mn.a.P2j():(x.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),mn.a.recordQosError(this.Cfh,[mn.a.dOc],"Style could not be modified"));
b.dispose()}else x.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),mn.a.recordQosError(this.Cfh,[mn.a.dOc],"PageContentNode not found")}wSo(b,h){this.kxp(b,h)}RXo(b,h){if(this.LHh){var n=new Og.DictionaryPropertySet;this.txd.execute(B=>{B.A_c(b)});n.setValue(Hf.a.DN,b);n.setValue(Lc.a.noProof,h);h=new Sd.GraphTransaction(15);h.set($e.App.jf.Il);this.LHh.N8(n);h.dispose()}}mf(){return re.SelectionEditor.mf(this.Gaf)}}Object(u.a)(On,"LanguageEditor",null,[486]);var Vn=d(651),gp=d(270),
Sl=d(114);class No{constructor(b=!1,h=0){this.languages=No.CHi(hj.a.kom());this.uGd=new gp.a;this.HZa=[];this.y$b=new Vn.a;this.azj=b;this.tBh=0>=h?7:h;this.sBh=this.g6e=0;this.Mkh=!1;b&&(this.R7m(),A.AFrameworkApplication.aJ(()=>{this.XEn()}))}R7m(){for(var b of this.languages)this.uGd.Z(b.LCID,b);b=[];try{const B=fc.a.get("RecentlyUsedLcids");if(B&&""!==B){const L=decodeURIComponent(B).split(",").slice(0,this.tBh);for(const ba of L){let la;({value:la}=this.uGd.Dc(parseInt(ba),la)).returnValue&&
b.push(la)}}}catch(B){x.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",B.message),Array.clear(b)}if(b.length)for(var h of b){var n=h.LCID;this.y$b.contains(n)||(this.HZa.push(h),this.y$b.add(n))}else h=A.AFrameworkApplication.lcid,({value:n}=this.uGd.Dc(h,n)).returnValue&&(this.HZa.push(n),this.y$b.add(h));this.oJj()}oJj(){const b=Sl.toArray(Sl.select(Sl.asEnumerable(this.HZa),h=>h.LCID)).join(",");fc.a.vOa("RecentlyUsedLcids",
b,180)}rxm(b){let h,n=-1,B=null;var L=No.CHi(this.HZa);this.azj&&0<L.length&&(B=Sl.toArray(Sl.Si(Sl.asEnumerable(L),(La,fb)=>{b===La.LCID&&-1===n&&(n=fb);return{["key"]:fb,["text"]:La.displayName,["value"]:La.LCID.toString()}})));let ba=0;B&&(ba=B.length);L=ba;const la=Sl.toArray(Sl.Si(Sl.asEnumerable(this.languages),(La,fb)=>{b===La.LCID&&-1===n&&(n=ba+fb);return{["key"]:ba+fb,["text"]:La.displayName,["value"]:La.LCID.toString()}}));h=n;return 0<ba?{returnValue:B.concat.apply(B,la),selectedIndex:h,
yyc:L}:{returnValue:la,selectedIndex:h,yyc:L}}IUo(b,h){if(this.azj&&({value:n}=this.uGd.Dc(b,n)).returnValue){h=b!==h;if(this.y$b.contains(b))b=Array.indexOf(this.HZa,n),0<=b&&(Array.removeAt(this.HZa,b),this.HZa.push(n)),h&&this.g6e++;else{this.y$b.add(b);this.HZa.push(n);if(this.HZa.length>this.tBh){var n=this.HZa.shift();this.y$b.remove(n.LCID)}h&&this.sBh++}this.oJj()}}XEn(){const b=this.g6e+this.sBh;!this.Mkh&&0<b&&(x.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",
100*this.g6e/b),this.Mkh=!0)}static CHi(b){b=Array.clone(b);b.sort((h,n)=>h.displayName.localeCompare(n.displayName));return b}}Object(u.a)(No,"LanguageListHelper",null,[485]);var hp=d(203);class ro extends hp.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(u.a)(ro,"NumberButtonProps",hp.a,[]);var el=d(172);class tm{static get X8(){return null!=tm.r4g?tm.r4g:tm.r4g=Ya.a.instance.Oa("Box4.ISpacingCommands")}static get ebb(){return null!=tm.X0g?tm.X0g:tm.X0g=Ya.a.instance.Oa("Box4.ILineSpacingHelper")}static get YSj(){return!!tm.X8}static Wb(){const b=
A.AFrameworkApplication.va;b.ra(wb.a.guc,oc.a.view,tm.guc);b.Rc(wb.a.guc,1124);b.ra(wb.a.guc,oc.a.paragraph,tm.sxp)}static guc(b,h,n,B,L){if(1===n||!tm.YSj)return tm.YSj?32:8;if(!tm.E_i){var ba=[];ba.push(Object.assign(new ro,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));ba.push(Object.assign(new ro,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));ba.push(Object.assign(new ro,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));ba.push(Object.assign(new ro,{ExternalId:"LineSpacing2_00",Number:2,
Type:0}));ba.push(Object.assign(new ro,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));ba.push(Object.assign(new ro,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));L.MenuItems=cl.e(ba);tm.E_i=!0}x.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.lb;ba=null;h&&h.gb.currentSelection&&(ba=h.gb.currentSelection);h=Object(el.a)().ksi(ba.Ra);A.AFrameworkApplication.va.lg(h,b,n,!0,B,L);return 32}static sxp(b,h){let n=b=!0;h=tm.ebb.jWa(h.node);var B=h.beforeSpacing;let L=!1;1===
B.unit&&(L=!0);if(L||0<B.value)b=!1;h=h.afterSpacing;B=!1;1===h.unit&&(B=!0);if(B||0<h.value)n=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(tm.uZk,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(tm.Izo,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(tm.tZk,!n));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(tm.Hzo,n));return 32}}tm.uZk="AddSpaceBeforeParagraph";tm.tZk="AddSpaceAfterParagraph";tm.Izo="RemoveSpaceBeforeParagraph";
tm.Hzo="RemoveSpaceAfterParagraph";tm.E_i=!1;Object(u.a)(tm,"LineSpacingRibbonMenu",null,[]);var Wk=d(189),nr=d(1784),ip=d(1430),Mk=d(71);const or=(b,h,n)=>{if(1===n)return 32;b=Ua.StaticActiveAppFrame.za().nK.nka("Automation test",!1);b.image=3;Ua.StaticActiveAppFrame.za().nK.Uy(b);return 32},rq=(b,h,n,B,L)=>{let ba;if(!({u$j:ba}=Rm(L)).returnValue)return 16;Wk.UISurfaces.kP().then(la=>{let La=null;var fb=Object.assign(new nr.a,{label:"OK",onExecute:()=>{La&&la.removeNotification(La)}});fb=Object.assign(new ip.a,
{target:"#"+Mk.a.jwg,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:fb,useTeachingStyles:ba});fb=la.callout(fb);La=la.addNotification(fb);return null},la=>{x.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",la);return null});return 32},Rm=b=>{let h=!1;if(!b)return{returnValue:!1,u$j:h};h=Boolean.parse(b);return{returnValue:!0,u$j:h}};class gm{constructor(){this.Alt=this.DisplayColor=this.Color=null;this.Disabled=!1}}Object(u.a)(gm,"ColorCellProps",
null,[]);let so,Xo,Tl,Tg,um;class Cm{constructor(){this.H$=new ob.a;this.oqh=!1}W5a(b){const h=this.H$.indexOf(b);let n=!0;if(-1!==h){n=!1;if(!h)return n;this.H$.removeAt(h)}this.H$.insert(0,b);x.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.H$.count&&(x.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.H$.J(10)),this.H$.removeAt(10));this.Wyp();return n}Mtd(b){let h="#";for(let B=0;B<this.H$.count;B++){var n="#"+this.H$.J(B).substring(4,
6)+this.H$.J(B).substring(2,4)+this.H$.J(B).substring(0,2);n=Object.assign(new gm,{Color:this.H$.J(B),Alt:n,DisplayColor:n});if(n.DisplayColor.toLowerCase()===b.toLowerCase()){h=n.Color;break}}for(const B of Cm.pBh)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(B,h))}Wyp(){x.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let n=0;n<this.H$.count;n++){var h="#"+this.H$.J(n).substring(4,6)+this.H$.J(n).substring(2,
4)+this.H$.J(n).substring(0,2);h=Object.assign(new gm,{Color:this.H$.J(n),Alt:h,DisplayColor:h});b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const n of Cm.pBh)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(n,b));this.oqh||this.Rxp();this.oqh=!0}Rxp(){for(const b of Object.keys(Cm.Yuh)){x.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=Cm.Yuh[b],n=[];for(const B of h)n.push(appChrome.api.menuSection([B],B in
Cm.$0e?Cm.$0e[B].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,n,Cm.$0e[b].toString()))}}}Cm.Yuh={["FontColor"]:(um=new ob.a,um.add("AutomaticFontColor"),um.add("ThemeFontColorPickerMCU"),um.add("ThemeFontColorPicker"),um.add("StandardFontColorPicker"),um.add("RecentFontColorPicker"),um.add("MoreFontColors"),um),["CellShading"]:(Tg=new ob.a,Tg.add("ThemeShadingColorPickerMCU"),Tg.add("ThemeShadingColorPicker"),Tg.add("StandardShadingColorPicker"),Tg.add("RecentCellShadingColorPicker"),
Tg.add("ClearShadingColor"),Tg.add("MoreCellShadingColors"),Tg),["PictureBorders"]:(Tl=new ob.a,Tl.add("ThemePictureBorderColorPickerMCU"),Tl.add("ThemePictureBorderColorPicker"),Tl.add("StandardPictureBorderColorPicker"),Tl.add("RecentPictureBorderColorPicker"),Tl.add("MorePictureBorderColors"),Tl.add("NoPictureBorder"),Tl.add("PictureBorderWeightOptions"),Tl.add("PictureBorderStyleOptions"),Tl),["PageColor"]:(Xo=new ob.a,Xo.add("ThemePageColorPickerMCU"),Xo.add("ThemePageColorPicker"),Xo.add("StandardPageColorPicker"),
Xo.add("RecentPageColorPicker"),Xo.add("NoPageColor"),Xo.add("MorePageColors"),Xo)};Cm.$0e={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardPageColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPageColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:Box4Intl.Box4Strings.L_PictureBorderColor,["PageColor"]:Box4Intl.Box4Strings.L_PageColor};Cm.pBh=(so=new ob.a,so.add("RecentFontColorPicker"),so.add("RecentCellShadingColorPicker"),so.add("RecentPictureBorderColorPicker"),
so.add("RecentPageColorPicker"),so);Object(u.a)(Cm,"RecentColorsSectionHandler",null,[]);var pr=d(1456),jp=d(1139);class wn{constructor(b){this.rIk=b}l8(){}j8(b){this.rIk.MRn(b)}}Object(u.a)(wn,"DataBuddyActionListener",null,[65]);class Ep{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(u.a)(Ep,"DataBuddyTaskPaneProps",null,[]);class Ul{constructor(b){this.isVisible=!1;this.m1=new ob.a;this.UJe=null;this.q6=b;this.KC=new pr.a;this.Yb=
Ph.FocusManager.instance()}initialize(){this.UJe=new wn(this);this.q6.NUa();this.KC.ON(this.DYk());this.KC.ON(this.wVk())}toggle(){this.isVisible?this.hide():this.show()}MRn(b){if(2===b.behavior){const h=Ce.ActionManager.U$(b.actionId)||b.actionId.toString();h.startsWith("Query")||(this.m1.add(h+": "+Ul.agm(b.response)),this.Cn())}}hide(){Wk.UISurfaces.Hv().then(b=>{b.hideTaskPane(Ul.MD,2);return null})}show(){Wk.UISurfaces.Hv().then(b=>{b.showTaskPane(Ul.MD,this.MB());return null});this.isVisible&&
Wk.UISurfaces.Hv().then(b=>{b.setSelectedTaskPane(Ul.MD);return null})}DYk(){return b=>{b.actions=this.m1.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}wVk(){return b=>{b.onClearClick=()=>{this.m1.clear();this.Cn()}}}Wb(){A.AFrameworkApplication.va.P0(this.UJe)}Bfb(){A.AFrameworkApplication.va.n2b(this.UJe)}MB(){const b=new Ep;this.KC.tyb(b);return Object.assign(new jp.a,{title:"Data Buddy",hideHeader:!1,width:Ul.width,location:2,contentProps:b,onOpen:()=>{this.Ica();
this.Wb();this.isVisible=!0;A.AFrameworkApplication.ua.Ie()},onClose:()=>{this.sha();this.Bfb();this.isVisible=!1;this.Cn();A.AFrameworkApplication.ua.Ie()},isModernPane:!0})}Cn(){Wk.UISurfaces.Hv().then(b=>{b.updateTaskPane(Ul.MD,this.MB());return null})}Ica(){this.Yb.Bg(Ul.MD)}sha(){this.Oab()&&this.Yb.Bg(this.Yb.RW)}Oab(){return!!this.Yb.currentScope&&this.Yb.currentScope.name===Ul.MD}static agm(b){switch(b){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";
case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}Ul.MD="DataBuddyTaskPane";Ul.width=300;Object(u.a)(Ul,"Box4DataBuddyTaskPane",null,[487]);class to{constructor(b){this.gi=b}BPa(b){this.gi&&this.gi.hJ(b)}ttd(){this.gi&&this.gi.Ktd(void 0)}}Object(u.a)(to,"RibbonButtonUpdater",null,[483]);var vm=d(362);class bq{constructor(){this.U9e=this.W=null}get name(){return"Box4.UI"}wc(b){this.W=b;b.ia("Box4.IGeneralCuiUser",()=>new fs(b.resolve("Box4.UI.CuiActionBridge"),
A.AFrameworkApplication.va)).ha();b.ia("Box4.UI.TableAltTextDialogFactory",()=>new zg(b.resolve("Box4.ITableEditor"),new vm.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).ha();b.ia("Box4.UI.ILanguageEditor",()=>new On(Zb.a.instance.Og,b.Oa("Box4.ITextFormattingCommands"),b.Qa("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ia("CommandUI.StandaloneRootController",()=>new aq(A.AFrameworkApplication.Ys)).as("Common.IStandaloneRootController").ha();b.ia("Box4.UI.IAutoCorrectOptionsDialog",
()=>new Nn(b.resolve("Box4.IAutoCorrectOptionsInfo"),A.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ia("Box4.UI.LanguageListHelper",()=>new No(A.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").ha();b.register(Dp,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ha();b.ia("Box4.UI.DefaultProofingContextMenuCreator",()=>new Iq(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).ha();
b.ia("Box4.UI.ProofingContextMenuSectionFactory",()=>new Xq(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").ha();b.ia("Box4.RibbonButtonUpdater",()=>new to(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").ha();b.ia("Box4.UI.RecentColorsSectionHandler",()=>new Cm).ha();b.ia("Common.IDataBuddyTaskPane",()=>new Ul(Hq.a.instance)).ha()}init(){var b=Ua.StaticActiveAppFrame.za();
const h=b.Ib;wi.G5m(Object(z.a)(h,h.lWb,"onAuthenticationLost"),Object(z.a)(h,h.mWb,"onAuthenticationRestored"),b.Dll);b=A.AFrameworkApplication.va;b.ra(wb.a.pfo,oc.a.application,Gr);b.fb(wb.a.O5o,oc.a.application,yh,96);b.fb(wb.a.x6o,oc.a.application,qq,96);b=A.AFrameworkApplication.va;b.fb(wb.a.n8o,oc.a.application,or,96);b.fb(wb.a.E5o,oc.a.application,rq,96);tm.Wb();this.Z7m();this.U9e=this.W.resolve("Common.IStandaloneRootController")}Z7m(){this.W.Qa("Box4.IGeneralCuiUser").execute(b=>{this.W.Qa("Common.IStandaloneRootController").execute(h=>
{h.Bha.oH=b})})}dispose(){this.U9e.dispose();this.U9e=null}static main(){M.a.instance.Jc(new bq,6)}}Object(u.a)(bq,"Box4UIPackage",null,[0,1]);var uo=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},ca=d(1962);class ra{get name(){return"Box4.Insights"}init(){}dispose(){}wc(b){b.ia("Box4.Insights.Box4InsightsSelection",
()=>new ca.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha()}}Object(u.a)(ra,"Box4InsightsPackage",null,[0,1]);const Eb=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var kc=d(438),zc=d(588),ed=d(755),rd=d(1929);class Wd{cvb(){return!1}reset(){}update(){}}Object(u.a)(Wd,"NullTaskYieldStrategy",null,[689]);var Ze=d(1448);class jg{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=
this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(u.a)(jg,"CatchUpConfiguration",null,[]);class Ag{constructor(){this.recentChangesManager=this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=
this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(u.a)(Ag,"SharedControllerFactoryParameters",null,[]);var Eh=d(748),Dc=d(15);class yg{constructor(b,h,n,B){this.E3n=(L,ba)=>{(this.oEd=!this.oEd)&&ba.Hk&&ba.Hk.contextId===oc.a.Xc&&this.V1h(ba.Hk.node,ba.Hk.lk);return 32};this.Cz=b;this.Rp=h;this.ga=n;this.Yb=B;this.UFd=this.VFd=null;this.oEd=!1;this.ga.ra(Dc.a.j1j,oc.a.view,this.E3n);this.Yb.ge(Dd.AFrame.mq).bindAction(bb.KeyInputManager.lc(Jd.a.OCc,
6),Dc.a.j1j)}BP(b,h){this.oEd&&this.Rp&&h&&h.Gm&&h.Gm.currentSelection&&h.Gm.currentSelection.Ra&&h.Gm.currentSelection.Ra.node&&h.Gm.currentSelection.Ra.contextId===oc.a.Xc&&this.V1h(h.Gm.currentSelection.Ra.node,h.Gm.currentSelection.Ra.lk)}V1h(b,h){b&&(this.shj(b)?(this.VFd&&this.VFd.id.equals(b.id)||(this.Rp.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.VFd=b),this.yHn(b,h)):this.UFd=this.VFd=null)}shj(b){return 0<this.Cz.hQb(b).count}yHn(b,
h){if(b){var n=-1,B=null,L=null;for(let ba=0;ba<b.qa.length;ba++){const la=b.qa.J(ba);if(!(null==L||la.changeStart&&la.changeStart.equals(B))&&h>=n&&h<=la.cp&&!B.equals(this.UFd))if(this.Cz.iTb(B)){(b=this.Cz.R1c(B,b.id))&&0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Rp.sendNotification(b,!1),this.UFd=B);break}else this.UFd=null;la.changeStart&&
!la.changeStart.equals(B)&&(n=la.cp,B=la.changeStart);L=la.changeStart}}}}Object(u.a)(yg,"ActivityAnnouncementManager",null,[]);var qj=d(1431),Mi=d(580),jh=d(833),mi=d(636);class Sj{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(u.a)(Sj,"Activity",null,[]);var wj=d(426);class pm extends Sj{constructor(){super();this.Fw=this.objectId=null}static BS(b){const h=new mi.a(new wj.a);if(b.Fw)for(const n of b.Fw)h.add(n);
return h}}Object(u.a)(pm,"RevisionSetActivity",Sj,[]);class jo{constructor(b,h,n,B=!1){this.rOe=null;this.dismiss=()=>{this.Shj.then(L=>{L.removeNotification(this.rOe);return this.rOe=null})};this.k_=b;this.Sb=h;this.Shj=n;this.Joc=B}Mpp(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.Sb.Pb(Pa.a.Rbb,2,null);break;default:this.RRn()}else x.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}RRn(){this.Shj.then(b=>
{var h=Object.assign(new ip.a,{target:'[data-unique-id~="CatchUpWithChanges"]',showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new qj.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const n=Object.assign(new Mi.a,{expirationOptions:Object.assign(new jh.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.rOe=b.addNotification(h,n)})}doesContentExist(b){if(!b)return x.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),
!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!b.navigationId)return x.ULS.sendTraceTag(593049025,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.Sb.Pb(Pa.a.C0d,2,h))return!1;break;case 1:return this.IWl(b)}return!0}IWl(b){b=pm.BS(b);return b?0<this.k_.f7d(b).count:(x.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(u.a)(jo,"ActivityContentManager",
null,[639]);var Oi=d(1545),Fp=d(2175),Ek=d(425),Yq=d(757);class vo{constructor(){this.Fw=this.b0=null}compare(b){if(!b)return!1;if(this.b0&&b.b0){if(this.b0.count!==b.b0.count)return!1;for(const h of this.b0)if(!b.b0.contains(h))return!1}else if(!b.b0&&this.b0||!this.b0&&b.b0)return!1;if(b.Fw&&this.Fw){if(b.Fw.count!==this.Fw.count)return!1;for(const h of this.Fw)if(!b.Fw.contains(h))return!1}else if(!this.Fw&&b.Fw||!b.Fw&&this.Fw)return!1;return!0}}Object(u.a)(vo,"ActivityHighlightableObject",null,
[]);class xn extends Oi.a{constructor(b,h){super();this.o5e=this.l$b=null;this.Gwd=b;this.Cz=h;this.P5=[new Fp.a(Ek.a.z0h,Ek.a.y0h),new Fp.a(Ek.a.w0h,Ek.a.v0h),new Fp.a(Ek.a.cVd,Ek.a.dVd),new Fp.a(Ek.a.eVd,Ek.a.gof)]}get Yrb(){return 1}get k$a(){return this.P5}get Ufa(){return!0}E9a(b,h){if(b=Object(ya.a)(vo,b))if(b.b0)for(const n of b.b0)h.add(n);else x.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}bNa(b,h){if(this.Gq.vJa){var n=this.Gwd.Rdb,B=this.Gwd.$rb,
L=!!n&&n.compare(B),ba=this.Gq.vJa,la=ba.action,La=this.p2o(ba,b),fb=!1;2!==la&&la&&(fb=(fb=this.Gq.dbd)?1===fb.type:!!n||!!B);h=h.BNa("*");for(let Cb=0,Lb=h.length;Cb<Lb;Cb++){const $b=h[Cb],tc=this.Lqm($b,Ek.a.YUc);if(tc&&tc.Xu)if(this.uyo($b),1===ba.type)switch(la){case 0:La&&n.Fw.contains(tc.Xu)&&this.TSd($b,2,tc,!1);break;case 2:La&&B.Fw.contains(tc.Xu)&&this.TSd($b,L?2:1,tc,!1);break;default:this.imc(b,$b,tc,!1)}else fb?this.imc(b,$b,tc,!1):this.imc(b,$b,tc,!0)}this.l$b&&(this.l$b.classList.add(Ek.a.eVd),
this.o5e=this.l$b=null)}}Lqm(b,h){return Hg.a.Eb(b,h)}p2o(b,h){if(b&&b.ZB){const n=b.ZB,B=b.action;if(1===b.type&&(2===B||!B)&&n.b0)return n.b0.contains(h);if(n.Fw)for(const L of n.Fw){b=this.Cz.r3c(L);for(const ba of b)if(ba===h)return!0}}return!1}imc(b,h,n,B){const L=this.Gwd.Rdb,ba=this.Gwd.$rb;L&&L.Fw.contains(n.Xu)&&(!L.b0||L.b0.contains(b))?this.TSd(h,2,n,B):ba&&ba.Fw.contains(n.Xu)&&(!ba.b0||ba.b0.contains(b))&&this.TSd(h,1,n,B)}TSd(b,h,n,B){b&&Yq.a(b)&&(b.classList.add(this.Yum(2===h,B)),
this.WTo(b,n,B))}WTo(b,h,n){this.l$b?-1!==h.cpEnd&&this.o5e.cpEnd!==h.cpBegin&&(this.l$b.classList.add(n?Ek.a.gof:Ek.a.eVd),b.classList.add(n?Ek.a.dVd:Ek.a.cVd)):b.classList.add(n?Ek.a.dVd:Ek.a.cVd);b.classList.add(Ek.a.x0h);this.l$b=b;this.o5e=h}uyo(b){this.Gq.TZa(b);this.lxo(b)}lxo(b){b.classList.remove(Ek.a.cVd,Ek.a.dVd,Ek.a.x0h,Ek.a.eVd,Ek.a.gof)}Yum(b,h){return h?b?Ek.a.v0h:Ek.a.y0h:b?Ek.a.w0h:Ek.a.z0h}}Object(u.a)(xn,"ActivityHighlightActor",Oi.a,[]);var qr=d(2176),gn=d(178);class Cs{constructor(b,
h,n,B,L,ba,la,La){this.mZ=b;this.IQ=h;this.Cz=n;this.nIk=L;this.hb=ba;this.Rp=La;this.Yb=la;this.IQ.Pfe=!1}goj(b,h,n){b?this.D0m(b,h,n):this.IQ.Rdb&&(b=Object.assign(new qr.a,{action:1,type:1,ZB:null,dM:this.IQ.Rdb}),this.IQ.Rdb=null,this.mZ.qH(b))}D0m(b,h,n){if(h){b=new mi.a(new wj.a);for(L of h){var B=this.Cz.r2c(L);for(let ba=0;ba<B.length;ba++){const la=B[ba];this.Cz.iTb(la)&&b.add(la)}}var L=this.Cz.f7d(b);L=this.t9h(L,b);B=this.IQ.Rdb;this.IQ.Rdb=L;L=Object.assign(new qr.a,{action:0,type:1,
ZB:this.IQ.Rdb,dM:B});this.mZ.qH(L);n&&!this.aMo(h.J(0),b)||this.SNo(h.J(0),b)}else x.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",b.activityId)}aMo(b,h){if(!b)return x.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return x.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;h=this.Qnm(b,h);return this.nIk.Pxb(b.id,h)?this.Ic(b,h)?!0:!1:(x.ULS.sendTraceTag(587239563,
377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}SNo(b,h){b=this.Zum(b,h);h=new Sys.StringBuilder;for(let n=0;n<b.count;n++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,n+1,b.count,b.J(n)));this.Rp.sendNotification(h.toString(),!0)}Ic(b,h){if(!b||!ea.ParagraphReader.Xb(b))return x.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return x.ULS.sendTraceTag(579396807,377,10,
"SetSelection: Invalid cp provided"),!1;this.IQ.Pfe=!0;b=Nd.a.Tc(b,h);b=new gn.Selection([b],!0);this.hb.Ic(b);Ph.FocusManager.vM()&&this.Yb.Bg(Dd.AFrame.Ho);return!0}Qnm(b,h){if(h&&0<h.count)for(let n=0;n<b.qa.length;n++){const B=b.qa.J(n);if(B.changeStart&&h.contains(B.changeStart))return B.cp}x.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}Zum(b,h){const n=new ob.a;if(h&&0<h.count&&b){let B=-1;for(let L=0;L<b.qa.length;L++){const ba=
b.qa.J(L);if(-1!==B&&ba.Fs)if(ba.changeStart&&h.contains(ba.changeStart))continue;else n.add(b.characterData.substring(B,ba.cp)),B=-1;ba.changeStart&&h.contains(ba.changeStart)&&(B=ba.cp)}}return n}cnj(b,h){if(b)switch(b.type){case 1:if(h){b=new mi.a(new wj.a);for(var n of h){h=this.Cz.r2c(n);for(let B=0;B<h.length;B++){const L=h[B];this.Cz.iTb(L)&&b.add(L)}}}else b=pm.BS(b);h=this.Cz.f7d(b);this.IQ.$rb=this.t9h(h,b);n=Object.assign(new qr.a,{action:2,type:1,ZB:this.IQ.$rb,dM:null});this.mZ.qH(n)}else this.IQ.$rb&&
(n=Object.assign(new qr.a,{action:3,type:1,ZB:null,dM:this.IQ.$rb}),this.IQ.$rb=null,this.mZ.qH(n))}t9h(b,h){var n=null;if(b){n=new Ea.a;for(const B of b)12===B.type&&n.add(B)}b=new vo;b.b0=n;b.Fw=h?h:this.RAm(n);return b}RAm(b){const h=new mi.a(new wj.a);if(!b)return h;for(const n of b)for(const B of this.Cz.hQb(n))h.add(B);return h}}Object(u.a)(Cs,"ActivityHighlightManager",null,[]);var Hi=d(929),Tm=d(753),gs=d(1543),pk=d(63),Yo=d(102),Hr=d(58);class Wn{constructor(){this.activityIds=this.container=
this.target=null;this.isSticky=!1;this.dirHint=0}}Object(u.a)(Wn,"CreateIndicatorTooltipParameters",null,[]);class Fq{constructor(){this.clearSticky=!1}}Object(u.a)(Fq,"DismissIndicatorTooltipParameters",null,[]);class Vs{constructor(){this.target=null;this.isSticky=!1}}Object(u.a)(Vs,"UpdateIndicatorTooltipParameters",null,[]);class kp extends Sys.EventArgs{constructor(b,h,n){super();this.DOb=b;this.vRi=h;this.w3o=n}}Object(u.a)(kp,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class xl{constructor(){this.wRi=
new Map;this.xRi=new Set}wmp(b,h){this.xRi.add(b);this.wRi.set(b,h)}Skn(b){return $c.a.aYi(b.htmlElement)}cRm(){const b=new Set;for(const h of this.xRi){const n=this.wRi.get(h);n&&this.Rkn(n)&&b.add(h)}return b}Rkn(b){return b.parentElement&&$c.a.aYi(b.parentElement)}}Object(u.a)(xl,"IndicatorVisibilityTracker",null,[]);class Um extends gs.a{constructor(b,h,n,B,L,ba,la,La,fb,Cb){super();this.sa=new mg.a;this.rEb=this.Rda=null;this.dXm=(Lb,$b,tc,Nc,dd)=>{if(!dd)return x.ULS.sendTraceTag(592540299,
377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;$b=pm.BS(dd.Activity);Lb=null;if(dd.NodeId&&(dd=Yo.b(dd.NodeId),!S.a.Bt(dd,S.a.nil)&&(dd=this.Cz.qzi(dd),this.LKg(dd,!1))))return 32;for(const Hd of $b)if(this.Cz.iTb(Hd)){dd=this.Cz.bkc(Hd);if(this.LKg(dd,!0))return 32;dd&&!Lb&&(Lb=dd)}if(this.LKg(Lb,!1))return 32;x.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.bXm=(Lb,$b,tc,Nc,dd)=>{x.ULS.sendTraceTag(595126290,377,
50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");dd&&$b&&$b.Gl&&(Lb=$b.node)&&((Lb=this.iDc.r7d(Lb))?this.MQd(Lb,!1,!1):x.ULS.sendTraceTag(595126289,377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.p8o=Lb=>{(Lb=this.iDc.r7d(Lb.Yl))&&this.MQd(Lb,!1,!1)};this.ZMa=Lb=>this.gmj(Lb.iy,!0);this.$Ma=Lb=>{Lb=Lb.iy;if(Lb===this.Rda)return!0;this.eCj(Lb);return!0};this.SMa=Lb=>{this.rEb=null;return this.gmj(Lb.iy,!1)};
this.a4=()=>{this.nEg();this.dWd(!0);return!1};this.kv=()=>{this.drj()};this.Dpe=()=>{this.Rda&&this.N7j(this.Rda);this.rEb&&this.eCj(this.rEb);this.WYn()};this.drj=()=>{this.Rda?this.N7j(this.Rda):this.hpf()};this.Cz=b;this.eKe=h;this.Qmh=n;this.xzk=B;this.DSa=L;this.b$=null;this.Gb=la;this.iDc=La;this.kWe=new xl;this.My=fb;this.OM=Cb;this.ql&&(this.ql.A6(this.Dpe),this.ql.iQh(this.drj));ba&&ba.execute(Lb=>{Lb.Q0(this.kv)})}get ql(){return this.DSa&&this.DSa.nj?this.DSa:(x.ULS.sendTraceTag(579396804,
377,15,"Could not obtain valid PageView."),null)}Ira(b,h,n){if(this.Rda){var B=Hr.a(this.Rda);if(b===B)return this.Rda}const L=b.uh.ownerDocument;B=Hi.a.createElement(L,Tm.a.div);B.className=Ek.a.fVd;B.style.left=h+"px";B.style.top=n+"px";h=Hi.a.createElement(L,Tm.a.div);h.className=this.My?Ek.a.F0h:Ek.a.A0h;B.style.cursor="pointer";h.style.cursor="pointer";h.style.backgroundColor=this.OM.xkm();h.style.outlineWidth="1px";h.style.outlineStyle="solid";h.style.outlineColor=this.OM.ykm();B.appendChild(h);
Yg.a.instance.nb(Cd.a.QX,B,this.ZMa);Yg.a.instance.nb(Cd.a.yP,B,this.$Ma);Ef.a.instance.nb(Cd.a.click,B,this.SMa);Yg.a.instance.nb(Cd.a.contextMenu,B,this.a4);x.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.LDn(b);h=this.MBm(b);this.kWe.wmp(h,B);this.kWe.Skn(b)&&this.wlj(h);return B}qeb(b){return this.k1o(b)}t7a(b){const h=this.tjl(b),n=[];n.push(this.Ira(b.s8,h,b.CBc[0].y-b.E7[0].y));return n}tjl(b){let h=Ek.a.M4m+(0>b.ubd?-b.ubd:0);const n=ri.a.qj(b.Mba,0)/2;1>=
n&&x.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>n?n:h;h=h<Ek.a.B0h?Ek.a.B0h:h;return A.AFrameworkApplication.isRtl?b.E7[0].width/this.zoom+h:-h}lSj(b){if(b&&b.yc===pk.a.paragraphNode||b.yc===pk.a.Yna){const h=this.Cz.hQb(b);if(h)for(const n of h)if(b===this.Cz.bkc(n))return!0}return!1}k1o(b){for(const h of ea.ParagraphReader.Gv(b.Cb,!0,!1))if(this.lSj(h))return!0;return!1}Wb(b){b.ra(Dc.a.TTj,oc.a.Xc,this.bXm);b.ra(Dc.a.GDg,oc.a.Xc,this.dXm)}LKg(b,h){if(!b)return!1;
const n=this.iDc.r7d(b);if(n)return this.MQd(n,!1,!0),!0;if(!h){let B;this.xjd((B=new ob.a,B.add(b),B),!1,!0,!0);h=new Re.a(3,1,0,this.p8o,181);h.Yl=b;this.Gb.Zb(h);return!0}return!1}xGl(b,h=!1){h&&this.dWd(!0);if(b&&b.parentNode){var n=this.SOf(b);n=this.ngm(n);this.b$||(this.b$=document.createElement("Div"),document.getElementById(A.AFrameworkApplication.oTc).appendChild(this.b$));this.eKe.createActivityIndicatorTooltip(Object.assign(new Wn,{target:b,container:this.b$,activityIds:n,isSticky:h,dirHint:9}));
h&&(this.Rda=b)}else x.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}w0l(b){b&&b.classList.add(Ek.a.gVd)}gmj(b,h){return this.MQd(b,h,!1)}MQd(b,h,n){if(h&&b===this.Rda)return!0;const B=this.SOf(b);h||this.nEg();this.xGl(b,!h);this.w0l(b.getElementsByClassName(this.My?Ek.a.F0h:Ek.a.A0h)[0]);this.xjd(B,h,!0,n);this.Q$i(B,h?1:2);this.xzk.Zie();h&&(this.rEb=b);return!0}dWd(b=!1){this.eKe.dismissActivityIndicatorTooltips(Object.assign(new Fq,
{clearSticky:b}));this.rEb=null;b&&(this.Rda=null)}wVj(b){b&&b.classList.remove(Ek.a.gVd)}nEg(){this.Rda&&this.wVj(this.Rda.getElementsByClassName(Ek.a.gVd)[0])}eCj(b){const h=this.SOf(b);this.xjd(h,!0,!1,!1);this.wVj(b.getElementsByClassName(Ek.a.gVd)[0]);this.dWd(!1);this.rEb=null}SOf(b){let h=null;(b=(b=Hr.a(b))?b.Cb:null)&&11===b.type&&(h=ea.ParagraphReader.Gv(b,!0,!1));return h}hpf(){const b=!!this.rEb;if(this.Rda||b)this.nEg(),this.dWd(!0),this.xjd(null,!1,!1,!1),this.xjd(null,!0,!1,!1)}F_k(b){this.sa.addHandler(Um.FMh,
b)}G_k(b){this.sa.addHandler(Um.GMh,b)}xjd(b,h,n,B){let L=null;if(n&&b){for(const ba of b)if(n=this.Cz.r2c(ba))for(let la=0;la<n.length;la++){const La=n[la];if(this.Cz.iTb(La)){L=this.Cz.R1c(La,ba.id);break}}if(!L){x.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.sa.raiseEvent(Um.FMh,new kp(L,b,!1)):this.sa.raiseEvent(Um.GMh,new kp(L,b,B))}ngm(b){const h=[];if(b)for(const B of b){var n=this.Cz.hQb(B);for(const L of n)(n=
this.Cz.R1c(L,B.id))&&h.push(n.activityId)}!h.length&&b&&b.count&&x.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");return h}N7j(b){b&&b.parentNode?(this.eKe.updateActivityIndicatorTooltip(Object.assign(new Vs,{target:b,isSticky:!0})),this.Rda=b):x.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}WYn(){const b=this.kWe.cRm();
for(const h of b)this.wlj(h)}wlj(b){this.Qmh.P$i(b,3)}MBm(b){return(b=ea.ParagraphReader.Gv(b.Cb,!0,!1))&&b.count?b.J(0).id:null}LDn(b){b=ea.ParagraphReader.Gv(b.Cb,!0,!1);this.Q$i(b,0)}Q$i(b,h){b&&b.count&&this.KDn(b.J(0).id,h)}KDn(b,h){this.Qmh.P$i(b,h)}}Um.FMh="ActivityIndicatorPreviewed";Um.GMh="ActivityIndicatorSelected";Object(u.a)(Um,"ActivityIndicatorActor",gs.a,[]);var Ga=d(37);class Ib{constructor(b,h,n){this.Cz=b;this.ROd=h;this.DSa=n}get ql(){return this.DSa&&this.DSa.nj?this.DSa:(x.ULS.sendTraceTag(555356833,
377,15,"Could not obtain valid PageView."),null)}r7d(b){x.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");const h=this.vAi(b);if(!h){x.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.Cz.hQb(b);for(const n of b)if(b=this.Cz.bkc(n),b=this.vAi(b))return b}return h}vAi(b){if(!b||12!==b.type)return x.ULS.sendTraceTag(539779146,377,100,
"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return x.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),null;var h=this.ROd.OQb(b);if(!h||11!==h.type)return x.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.ue(this.ql.oc);if(!h||!h.htmlElement)return x.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),
null;var n=Lh.a.s2c(h.htmlElement,Ib.EMh);if(n)return n;h=h.z3d();if(!h)return x.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),null;h=Lh.a.olm(h,Ib.EMh);if(!h)return x.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(n=0;n<h.length;n++){const B=Hr.a(h[n]),L=Ga.OutlineElementNavigator.nm(b);if(B&&B.Cb&&L&&B.Cb.id.equals(L.id))return h[n]}x.ULS.sendTraceTag(539779152,
377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}kwm(b){b=this.Cz.qzi(b);if(!b||12!==b.type)return x.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),S.a.nil;b=this.r7d(b);if(!b)return x.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),S.a.nil;b=Hr.a(b);return b?b.Cb.id:(x.ULS.sendTraceTag(555356865,
377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),S.a.nil)}}Ib.EMh="CatchUpActivityIndicatorContainer";Object(u.a)(Ib,"ActivityIndicatorHelper",null,[]);var lc=d(1786);class Mc{constructor(b,h,n,B,L,ba,la){this.bCa=b;this.Sh=h;this.vef=n;this.Sb=B;this.k_=L;this.ef=ba;this.zde=la;this.w4i=!1;this.vIn=(La,fb,Cb)=>{if(1===Cb)return this.ISf?32:8;2===Cb&&(this.ISf&&(this.vef.hpf(),this.Pql()),x.ULS.sendTraceTag(38138719,377,50,D.c({["MarkAsRead invoked"]:!0})));
Ua.StaticActiveAppFrame.za().Ie();return 8};this.bCa.QZa(this.vef)}initialize(){this.Sb.ra(Dc.a.Bcj,id.a.frame,this.vIn)}get ISf(){return!!this.k_.WU&&0<this.k_.WU.count||!!this.k_.Wrc&&0<this.k_.Wrc.count}get yun(){return this.w4i}Zhg(b){const h=b&&b.wywaActivities?b.wywaActivities.length:0;if(!this.zde||0<h||!b){const n=new Map;n.set("activityCount",h.toString());this.ef.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:n})}b?(this.MTn(b.wywaActivities),this.w4i=!0):(x.ULS.shipAssertTag(36538305,
377,!1),this.zde||Object(lc.a)(),this.ef.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}MTn(b){b?(x.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),this.C_o(b),b=this.k_.YZk(b),this.D_o(b)):x.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}C_o(b){if(b){var h=new ob.a;for(const n of b)switch(n.type){case 2:case 3:case 4:case 10:b=4===n.type?n.Rrj:
n.contentId,h.add(b),this.k_.Wrc.add(b)}0<h.count&&(x.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.Sb.Pb(Pa.a.Mgj,2,h.toArray()))}}D_o(b){const h=new mi.a(new wj.a),n=new Sd.GraphTransaction(3);try{n.Ab(this.Sh);for(const B of b){const L=this.k_.bkc(B);L&&this.vef.lSj(L)&&(h.add(L.id),this.bCa.ySb(L,!0))}}finally{n&&n.dispose()}0<b.count&&Ua.StaticActiveAppFrame.za().Ie();b={};b.highlightedNodeCount=h.count;x.ULS.sendTraceTag(36509257,377,50,"{0}",D.c(b))}Pql(){x.ULS.sendTraceTag(36509258,
377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.k_.Wrc.count&&(this.Sb.Pb(Pa.a.Rgi,2,this.k_.Wrc.toArray()),this.k_.Wrc.clear());const b=this.Vsl(this.k_.WU);this.exo(b)}exo(b){x.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");const h=new Sd.GraphTransaction(3);try{h.Ab(this.Sh);for(const n of b){this.k_.WU.remove(n);for(const B of this.k_.r3c(n))this.bCa.ySb(B,!0)}this.k_.H2h()}finally{h&&h.dispose()}}Vsl(b){const h=new mi.a(new wj.a);
for(const n of b)h.add(n);return h}}Object(u.a)(Mc,"ActivityIndicatorManager",null,[]);class Bd{constructor(){this.$rb=this.Rdb=null;this.isFirstDocumentOpen=this.Pfe=!1}}Object(u.a)(Bd,"ActivityStateManager",null,[638]);class Ie{constructor(b,h){this.$xd={};this.Z4b=b;this.QM=h;this.Wrc=new ob.a}get WU(){return this.Z4b.WU}hQb(b){const h=new mi.a(new wj.a);if(!b)return h;b=this.Z4b.B5d(b);for(let n=0;n<b.length;n++){const B=b[n];this.iTb(B)&&h.add(B)}return h}r3c(b){return this.Z4b.r3c(b)}f7d(b){const h=
new ob.a;if(b)for(const n of b)h.addRange(this.r3c(n));return h}YZk(b){const h=new mi.a(new wj.a);if(b)for(const n of b)if(1===n.type&&(b=n))for(const B of b.Fw){h.add(B);this.WU.add(B);const L=B.toString();this.$xd[L]||(this.$xd[L]=new ob.a);this.$xd[L].add(b)}this.H2h();return h}iTb(b){return this.WU&&b?this.WU.contains(b):!1}R1c(b,h){if(b&&(b=this.$xd[b.toString()])&&0<b.count){for(const n of b)if(n.objectId.equals(h))return n;return b.J(0)}return null}bkc(b){return this.Z4b.bkc(b)}H2h(){this.Z4b.Bql()}r2c(b){return this.Z4b.r2c(b)}qzi(b){if(!this.QM)return null;
const h=this.QM.Lc;return h?h.Eb(b):null}}Object(u.a)(Ie,"ChangeIdCache",null,[]);var zf=d(164),Qe=d(113);class bg extends zf.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=null;this.H_=Object.assign(new Qe.a,{T_:bg.getTypeName(),B_:bg.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(u.a)(bg,"ChangeSummariesResponse",zf.a,[]);var Rg=d(479);class di extends Rg.a{constructor(){super();
this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new Qe.a,{T_:di.getTypeName(),B_:di.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(u.a)(di,"ChangeSummariesRequest",Rg.a,[]);var mh=d(360),Fk=d(416),Cj=d(262),Na=d(396);class Wa{constructor(){this.kvc=this.Tld=null}}Object(u.a)(Wa,"ActionPair",null,[]);class Fb{constructor(b,h,n,B){this.o0l=L=>{L=L.Yl;const ba=
this.EBj(L);ba&&(x.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.XLf(L)),ba.kvc("Request timeout"))};this.MC=b;this.QY=h;this.Re=n;this.Gb=B;this.mWe=null;this.y5e=new qb.a;this.lCh=new qb.a}xep(b){const h=Object.assign(new mh.a,{parentPath:["Signal",di.getTypeName()],items:[Object.assign(new Fk.a,{body:b})]});return this.initialize().then(()=>{const n=new Promise((B,L)=>{this.y5e.Z(b.requestId,Object.assign(new Wa,
{Tld:B,kvc:L}))});this.lCh.Z(b.requestId,new Date);x.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",Fb.requestTimeoutMs);this.QY.getAugLoopRuntimeManager().submitOperation(Object.assign(new Na.a,{operation:h}));this.mXo(b.requestId);return n})}initialize(){this.mWe||(this.mWe=this.MC.Pl().then(()=>{this.Re.nb(this,bg.getTypeName())}));return this.mWe}lD(b,h){if(b&&Cj.a.getTypeNameFor(b.content)===bg.getTypeName())if(b=
b.content){var n=this.EBj(b.correspondingRequest);n?h!==mh.a.getTypeName()?n.kvc("Invalid operation type"):(x.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.XLf(b.correspondingRequest)),n.Tld(b)):x.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.XLf(b.correspondingRequest))}else x.ULS.sendTraceTag(589083080,
377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else x.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}mXo(b){const h=new Re.a(3,1,Fb.requestTimeoutMs,this.o0l,176);h.zQd=0;h.Yl=b;this.Gb.Zb(h)}EBj(b){if(!b)return null;let h;if(!({value:h}=this.y5e.Dc(b,h)).returnValue)return null;this.y5e.remove(b);return h}XLf(b){if(!b)return-1;let h;return({value:h}=this.lCh.Dc(b,h)).returnValue?
(new Date).getTime()-h.getTime():-1}static get requestTimeoutMs(){return A.AFrameworkApplication.K.ic("ChangeSummariesRequestTimeoutMs",5E3)}}Object(u.a)(Fb,"ChangeSummariesAugloopProvider",null,[223]);class uc{constructor(){this.activityGroups=null}}Object(u.a)(uc,"FeaturedActivityGroupPayload",null,[]);class Sc{constructor(b,h,n,B,L){this.eLk=b;this.Dok=h;this.pqk=n;this.Ytk=B;this.hBb=L}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.Ytk.fHb.then(()=>this.Mrm(b)):
Sc.yAf}vUm(b,h,n){if(!h)return x.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;Eb("TranslateFeaturedActivityGroups");n=this.pqk.fnp(b,h,n.wywaActivities);x.ULS.sendTraceTag(542942800,377,50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<b.activityChanges.length,0<h.inferences.length,0<n.length);this.hBb.set(h.correspondingRequest,
n);return Object.assign(new uc,{activityGroups:n})}Mrm(b){Eb("BuildFeaturedActivityGroupRequest");const h=this.eLk.sfl();if(!h||!h.documentContent||!h.activityChanges)return x.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),Sc.yAf;if(!h.documentContent.length||!h.activityChanges.length)return Sc.yAf;x.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+
h.requestId);Eb("SubmitFeaturedActivityGroupRequest");return this.Dok.xep(h).then(n=>this.vUm(h,n,b))}}Sc.yAf=Promise.resolve(Object.assign(new uc,{activityGroups:[]}));Object(u.a)(Sc,"ChangeSummariesDataProvider",null,[629]);class hd{constructor(b,h){this.Cz=b;this.VPk=h}sfl(){const b=new ob.a,h=new ob.a,n=new mi.a(new wj.a);var B=this.Cz.WU;if(!B||!B.count)return hd.BAf;B=this.Cz.f7d(B);if(!B||!B.count)return x.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),
hd.BAf;for(const L of B)n.contains(L.id)||(n.add(L.id),this.nho(L,b,h));return h.count&&b.count?Object.assign(new di,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:Yo.a(S.a.create())}):hd.BAf}nho(b,h,n){if(ea.ParagraphReader.Xb(b)){var B=ea.ParagraphReader.rca(b);if(B&&B.length){h.add(B);B=this.Cz.hQb(b);B=this.DTm(B);for(const L of B){B=new ob.a;const ba=this.getTextRanges(b,L);for(const la of ba)B.add({changeEnd:la.endIndex,changeSpanId:la.WPo,changeStart:la.startIndex,contentIndex:h.count-
1,locationId:Yo.a(b.id)});(B=this.dDl(L,B.toArray()))&&n.add(B)}}else x.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else x.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}DTm(b){const h=new qb.a;for(const n of b)(b=this.FEi(n))?(h.mb(b)||h.Z(b,new mi.a(new wj.a)),h.J(b).add(n)):x.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");
return h.values}dDl(b,h){const n=[];let B=null;for(const L of b)if(b=this.Cz.R1c(L,S.a.nil)){if(!B){const ba=this.FEi(L);if(!ba||!ba.length){x.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}B=ba}n.push(b)}else x.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return n.length?B?h.length?{activityId:n[0].activityId,changes:h,personId:B,
timestamp:n[0].displayTimestamp.toISOString()}:(x.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(x.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),null):(x.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}FEi(b){b=this.Cz.R1c(b,S.a.nil);if(!b)return x.ULS.sendTraceTag(579712274,
377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return x.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const n=new ob.a;if(!h||!h.count||!b)return n;let B=-1,L=new mi.a(new wj.a);for(let ba=0;ba<
b.qa.length;ba++){const la=b.qa.J(ba);if(-1!==B&&la.Fs){if(la.changeStart&&h.contains(la.changeStart)){L.add(la.changeStart);continue}n.add({startIndex:B,endIndex:la.cp,WPo:this.VPk.bMj(L)});B=-1;L=new mi.a(new wj.a)}la.changeStart&&h.contains(la.changeStart)&&(B=la.cp,L.add(la.changeStart))}return n}}hd.BAf=Object.assign(new di,{activityChanges:[],documentContent:[],requestId:Yo.a(S.a.nil)});Object(u.a)(hd,"ChangeSummariesRequestBuilder",null,[]);class Gd{constructor(){this.changes=this.content=
null}}Object(u.a)(Gd,"ContentChange",null,[]);class ke{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(u.a)(ke,"FeaturedActivityGroup",null,[]);class Ye{constructor(){this.end=this.start=0}}Object(u.a)(Ye,"TextRange",null,[]);class Nf{constructor(b){this.iDc=b}fnp(b,h,n){if(!h)return x.ULS.sendTraceTag(588379906,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),Nf.h1d;if(!h.inferences)return x.ULS.sendTraceTag(588379907,
377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),Nf.h1d;if(!h.activityClassifications)return x.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),Nf.h1d;if(!h.inferences.length||!h.activityClassifications.length)return x.ULS.sendTraceTag(561111455,377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),Nf.h1d;
const B=[],L=new Fa.a(new wj.a);for(const ba of h.inferences){const la=this.enp(ba,b,h,n);if(!la)continue;const La=this.iDc.kwm(Yo.b(la.locationId));La.equals(S.a.nil)?B.push(la):L.mb(La)?L.J(La).ranking>la.ranking&&L.Z(La,la):L.add(La,la)}b=[...Array.from(L.values),...B];b.sort((ba,la)=>ba.ranking-la.ranking);return b.slice(0,Nf.PJn)}enp(b,h,n,B){if(!b||lf.a.Tf(b.activitiesInGroup))return x.ULS.sendTraceTag(588379909,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),
null;const L=new ob.a,ba=new qb.a;let la=null;for(const fb of b.activitiesInGroup){if(!fb){x.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>fb.activityIndex||fb.activityIndex>=n.activityClassifications.length){x.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");continue}const Cb=n.activityClassifications[fb.activityIndex];if(!Cb||
lf.a.Tf(Cb.contents))x.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var La=this.b8l(B,Cb.activityId);if(La){L.add(La);for(const Lb of fb.changes){if(!Lb){x.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}La=Lb.value;if(0>La||La>=Cb.contents.length){x.ULS.sendTraceTag(576251592,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");
continue}La=Cb.contents[La];if(!La){x.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const $b=h.documentContent[La.contentIndex],tc=Object.assign(new Ye,{start:La.changeStart,end:La.changeEnd});if(ba.mb($b))ba.J($b).add(tc);else{let Nc;ba.Z($b,(Nc=new ob.a,Nc.add(tc),Nc))}la||(la=La.locationId)}}else x.ULS.sendTraceTag(588379913,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!L.count)return x.ULS.sendTraceTag(588379914,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.oPm(ba);return h.count?Object.assign(new ke,{ranking:b.ranking.value,reasons:[1],activities:L.toArray(),contentChanges:h.toArray(),locationId:la}):(x.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),null)}b8l(b,h){for(const n of b)if(n&&n.activityId&&n.activityId===h)return n;return null}oPm(b){const h=
new ob.a;for(const B of b){b=B.key;const L=B.value;L.Sc((ba,la)=>ba.start-la.start);var n=L.J(0).start;if(n>Nf.hdj){n-=Nf.hdj;b=b.substring(n,b.length);for(const ba of L)ba.start-=n,ba.end-=n}h.add(Object.assign(new Gd,{content:b,changes:L.toArray()}))}return h}}Nf.h1d=[];Nf.hdj=10;Nf.PJn=4;Object(u.a)(Nf,"ChangeSummariesResponseTranslator",null,[]);class Bi{constructor(){this.hBb=new qb.a;this.M6e=new qb.a}set(b,h){if(h.length&&b){this.hBb.Z(b,h);for(const n of h)if(n.activities)for(const B of n.activities)B&&
B.activityId?this.M6e.Z(B.activityId,b):x.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else x.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.hBb.mb(b)?this.hBb.J(b):null}AGn(b){return b&&this.M6e.mb(b)?this.M6e.J(b):null}}Object(u.a)(Bi,"FeaturedActivityGroupCache",null,[]);class Sk{constructor(b){this.wie=(h,n,B,L,ba)=>{if(!ba)return x.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),
8;h=ba.Activity;if(!h)return x.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;n=this.hBb.AGn(h.activityId);if(!n)return x.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),8;B=pm.BS(h);x.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",n,h.activityId,
this.bMj(B));return 32};this.hBb=b;this.Tah=new Map}Wb(b){b.ra(Dc.a.wie,id.a.frame,this.wie)}bMj(b){let h=0;const n=Array(b.count);for(const B of b)b=this.RCm(B),n[h]=Yo.a(b),h++;return n.join(",")}RCm(b){let h=this.Tah.get(b);if(h&&h!=S.a.nil)return h;h=S.a.create();this.Tah.set(b,h);return h}}Object(u.a)(Sk,"FeaturedActivityGroupTelemetryActor",null,[]);var Ff=d(87);class Th extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(u.a)(Th,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class Tk{constructor(b,
h,n){this.rT=null;this.inp=B=>{this.K5a.reset();B=this.fPm(B.Yl);let L=null;for(;B.moveNext();){const ba=B.currentNode;if(ba&&(ea.ParagraphReader.Xb(ba)&&this.sa.raiseEvent("OPV",new Th(ba)),this.K5a.update(),this.K5a.cvb())){L=ba;break}}L?this.iPh(L):this.rT(!0)};this.Gb=b;this.K5a=h;this.QM=n;this.sa=new mg.a;this.fHb=new Promise(B=>{this.rT=B})}l1k(b){this.sa.addHandler("OPV",b)}dcl(){this.iPh(null)}iPh(b){const h=new Re.a(3,1,0,this.inp,182);h.Yl=b;this.Gb.Zb(h)}fPm(b){if(!b)return Ff.a.iq(this.QM);
b=ve.GraphIterator.eb(b);b.zb(7);return Ff.a.Ft(b,this.QM)}}Object(u.a)(Tk,"DocumentTraverser",null,[]);class Nk{constructor(b){this.Sb=b}shouldShowEmptyExperienceButton(){return A.AFrameworkApplication.$ge()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.Sb.Pb(Pa.a.mAe,2,null)}onInviteOthersButtonClick(){this.Sb.Pb(Pa.a.Uaa,2,null)}}Object(u.a)(Nk,"EmptyCatchUpBehaviorManager",null,[513]);class Of{constructor(b,h){this.tbm=
()=>{const n=document.getElementById("flyoutItem0");n&&(x.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),n.focus())};this.aq=b;this.Yb=h}initialize(){const b=this.Yb.ge(Dd.AFrame.Dec);b.iK=!0;b.parent=Dd.AFrame.mq;b.Bja(this.tbm);this.aq.xW(Dd.AFrame.Dec)}enableF6Focus(){this.aq.bL(Dd.AFrame.Dec)}disableF6Focus(){this.aq.ny(Dd.AFrame.Dec)}}Object(u.a)(Of,"FlyoutFocus",null,[508]);class bf{constructor(b,h,n){this.U$g=this.Dkh=this.IJc=this.PEd=!1;this.cTe=this.Jxd=
null;this.Q0n=(B,L,ba,la,La)=>{La[$g.a.Visible]=!0;La[$g.a.On]=this.IJc&&this.PEd;return 32};this.F3n=(B,L,ba)=>{if(1===ba)return this.PEd?(this.Dkh||(this.Dkh=!0,x.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.Jxd)return x.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),8;this.U$g=!0;this.Jxd();return 32};this.ga=b;this.Hih=h;this.Yb=n}get QEf(){return this.cTe?this.cTe:(x.ULS.sendTraceTag(578401728,
3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set QEf(b){this.cTe=b}initialize(){this.Wb()}registerButtonClickedEvent(b){this.Jxd&&x.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.Jxd=b.buttonClickedCallback}onFlyoutInitialized(){this.PEd&&x.ULS.sendTraceTag(588129367,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const b=(new Date).getTime()-this.QEf.getTime();
x.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",b);this.PEd=!0;Pe.c(Pa.a.sml,!0,void 0,void 0,void 0,b)}onFlyoutVisibilityChanged(b){this.IJc!==b.flyoutIsVisible&&(this.IJc=b.flyoutIsVisible,Ua.StaticActiveAppFrame.za()&&Ua.StaticActiveAppFrame.za().Ie(!0),this.IJc&&this.U$g&&this.Yb.Bg(Dd.AFrame.Dec),this.IJc||this.Hih&&this.Hih.aCn())}logFlightTriggers(b){b.hasFlyoutData&&A.AFrameworkApplication.Ld("WoCha187;WoCha187cf")}Wb(){this.ga.ra(Pa.a.n1j,id.a.frame,
this.F3n);this.ga.fb(Pa.a.xxj,id.a.frame,this.Q0n,96)}}Object(u.a)(bf,"FlyoutRibbonButton",null,[507]);var Cf=d(163);class Pg{constructor(b,h){this.WU=null;this.hde=this.Q0i=!1;this.k_=b;this.ef=h;this.Gsb=new Cf.a;this.Jce=new Map;this.Gsb.Z(1,new mi.a(new wj.a));this.Gsb.Z(0,new mi.a(new wj.a));this.Gsb.Z(2,new mi.a(new wj.a));this.Gsb.Z(3,new mi.a(new wj.a));this.Jce.set(3,"CatchUpIndicatorVisible");this.Jce.set(1,"CatchUpIndicatorPreviewed");this.Jce.set(2,"CatchUpIndicatorSelected");this.Que=
0}P$i(b,h){if(this.Gsb.J(h).add(b)){this.MDn(h);switch(h){case 0:x.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:x.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");break;case 2:x.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:x.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.Q1h()}}e0n(b){this.D1l();b=this.k_.hQb(b);for(const h of b)if(this.WU.remove(h)){this.Que++;
break}}D1l(){if(!this.WU){this.WU=new mi.a(new wj.a);for(const b of this.k_.WU)this.WU.add(b)}}y4k(){x.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.Que);this.Q1h()}Q1h(){this.Que&&(this.Hol(),this.nol())}Hol(){!this.Q0i&&.5<=this.Gsb.J(0).count/this.Que&&(this.Q0i=!0,Pe.c(Pa.a.uml),x.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}nol(){if(!this.hde){var b="";1<=this.Gsb.J(1).count&&(this.hde=!0,b="previews");1<=this.Gsb.J(2).count&&
(this.hde=!0,b="selections");this.hde&&(Pe.c(Pa.a.lml),x.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}MDn(b){(b=this.Jce.get(b))&&this.ef.logKpiUsage(b,0)}}Object(u.a)(Pg,"IndicatorTelemetryActor",null,[]);var Ug=d(520);d(1165);class Gk{constructor(b,h){this.cpd=b;this.ZUc=h}fRm(){return this.ZUc.promise.then(b=>b.getWywaActivitiesResponse)}RGf(b,h){return Ug.b(this.cpd.requestActivities(b,h))}xNf(b,h){return this.ZUc.promise.then(n=>n.getWywaActivitiesResponse.WywaWaterline===
b?Promise.resolve(n.getRelevantActivitiesResponse):Ug.b(this.cpd.requestRelevantActivities(b,h)))}updateActivityState(b){return Ug.b(this.cpd.updateActivityState(b))}SGf(){return this.ZUc.promise.then(b=>void 0!==b.activityFeed?Promise.resolve(b.activityFeed):Ug.b(this.cpd.requestActivityFeed()))}Ttd(){return Ug.b(this.cpd.REo())}}Object(u.a)(Gk,"ActivityRepository",null,[]);var $i=d(1167),ol=d(1785);class wm{constructor(b,h,n,B,L,ba=!1){this.activityContentManager=b;this.Sb=h;this.BXl=n;this.ef=
B;this.N4m=L;this.Joc=ba}d7f(b){const h=new Map;h.set("activityType",b.type.toString());this.ef.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}q6f(b){this.ef.logKpiFailure("CatchUpNavigateToActivity",b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}oPn(b){try{const h=b.activity;this.d7f(b.activity);1==h.type&&this.N4m.Zie();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.Mpp(h),this.q6f("Content does not exist"),
Promise.resolve(2);const n={};let B=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:n.ActivityId=h.activityId;n.NavigationId=atob(h.navigationId);B=this.Sb.Pb(Pa.a.yqf,2,n);break;case 1:n.Activity=h,n.NodeId=b.locationId,B=this.Sb.Pb(Dc.a.GDg,2,n),n.NodeId&&this.Sb.Pb(Dc.a.wie,2,n)}8==B&&this.q6f("Action failed")}catch(h){return x.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.q6f("Exception was thrown"),Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.BXl.fHb.then(()=>
this.oPn(b))}}Object(u.a)(wm,"WordActivityNavigationManager",null,[505]);var Ll;(function(b){b[b.default=0]="default";b[b.XLp=1]="D48X48";b[b.$Lp=2]="D64X64";b[b.aMp=3]="D96X96";b[b.TLp=4]="D120X120";b[b.ULp=5]="D240X240";b[b.VLp=6]="D360X360";b[b.WLp=7]="D432X432";b[b.YLp=8]="D504X504";b[b.ZLp=9]="D648X648"})(Ll||(Ll={}));Object(u.b)("ProfilePhotoDimension",Ll);var Ir=d(845),$t=d(1544);class wu{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=
null}}Object(u.a)(wu,"ActivityFeedEntry",null,[]);const Bv=(b,h)=>h.Dad?Sl.toArray(Sl.select(Sl.asEnumerable(b),n=>{if(!n||!n.activityFeedItemPayload)return n;const B=JSON.parse(n.activityFeedItemPayload);var L=B.actor;if(!L||L.pictureUrl)return n;const ba=L.userPrincipalName||L.email;if(!ba)return n;L=h.KMb(ba,L.provider,A.AFrameworkApplication.jm,0);if(!L)return n;B.actor.pictureUrl=L;return Object.assign(new wu,{id:n.id,type:n.type,collectionId:n.collectionId,activityState:n.activityState,activityFeedItemPayload:JSON.stringify(B),
timestamp:n.timestamp})})):b,xu=(b,h)=>{const n=new Map,B=new Map;for(const L of b){if(!L||!L.activityFeedItemPayload)continue;b=JSON.parse(L.activityFeedItemPayload).actor;if(!b)continue;const ba=b.email||b.userPrincipalName;ba&&!B.has(ba)&&B.set(ba,new Ir.a(ba,null,b.name))}B.forEach(L=>{const ba=h.zlc(L,6);n.set(L.UserId,ba)});return n};var Op=d(548);class rr{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=
null}}Object(u.a)(rr,"ActivityRequestPayload",null,[]);class Jr{constructor(){this.color=this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(u.a)(Jr,"Person",null,[]);class sp extends Sj{constructor(){super();this.relationship=0}}Object(u.a)(sp,"TaskActivity",Sj,[]);class Ws extends Sj{constructor(){super();this.contentId=null}}Object(u.a)(Ws,"CommentActivity",Sj,[]);class yw extends Ws{constructor(){super()}}Object(u.a)(yw,"CommentReplyActivity",Ws,[]);class Kr extends Ws{constructor(){super();
this.Rrj=null}}Object(u.a)(Kr,"MentionActivity",Ws,[]);class Et{constructor(b,h,n,B){this.iBb=b;this.ISa=h;this.aOc=n;this.IQ=B;this.IQ.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.iBb.fRm().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.guf("GetWYWAActivities",b);155===b.StatusCode&&(x.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.IQ.isFirstDocumentOpen=!0);const h=this.gKg(b.People);return Object.assign(new rr,{activities:this.NDe(b.Activities,
h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.iBb.RGf(b,h).then(n=>{if(!n||n.StatusCode)throw this.guf("GetActivities",n);const B=this.gKg(n.People);return Object.assign(new rr,{activities:this.NDe(n.Activities,B),actors:B,hasMore:!n.RequestedRetrieved,highWaterline:n.HighWaterline,lowWaterline:n.LowWaterline})})}requestRelevantActivities(b){return this.iBb.xNf(b,
this.IQ.isFirstDocumentOpen).then(h=>{if(!h||h.StatusCode)throw this.guf("GetRelevantActivities",h);const n=this.gKg(h.People),B=this.NDe(h.NewActivities,n,2);h=this.NDe(h.OutstandingActivities,n,3);for(const L of h)B.push(L);return Object.assign(new rr,{activities:B,actors:n})})}updateActivityState(b){return this.iBb.updateActivityState(b)}requestActivityFeed(){return this.iBb.SGf().then(b=>({activityFeedItems:this.F8m(b),personaColorMap:this.Jgl(b)}))}NDe(b,h,n=1){const B=[];if(!b)return B;for(const la of b){var L=
null;b=[];b.push(h[la.CreatorIndex]);switch(la.ActivityType){case 1:L=la;var ba=new pm;ba.Fw=new ob.a;for(const La of L.ChangeIds)ba.Fw.add(Yo.b(La));ba.objectId=Yo.b(L.ObjectId);L=ba;break;case 2:L=la;ba=new Ws;ba.contentId=L.ContentId;ba.navigationId=L.NavigationId;L=ba;break;case 4:L=la;ba=new Kr;b.push(h[L.MentioneeIndex]);ba.Rrj=L.ParentContentId;ba.navigationId=L.NavigationId;L=ba;break;case 3:case 10:L=la;ba=new yw;b.push(h[L.RepliedIndex]);ba.contentId=L.ContentId;ba.navigationId=L.NavigationId;
L=ba;break;case 6:case 7:case 8:case 9:L=la,ba=new sp,b.push(h[L.MentioneeIndex]),ba.navigationId=L.NavigationId,ba.relationship=L.Relationship,L=ba}L&&(L.actors=b,L.displayTimestamp=new Date(la.DisplayTimestamp),L.activityId=Yo.b(la.ActivityId).toString(),L.type=la.ActivityType,1!==n&&(L.relevancy=n),B.push(L))}return B}zHo(b,h,n){return this.aOc&&this.aOc.Dad?this.aOc.KMb(h,n,A.AFrameworkApplication.jm,Ll.default):b}gKg(b){if(!b)return null;const h=Array(b.length);for(let n=0;n<b.length;n++){if(!b[n])continue;
const B=new Jr;B.id=b[n].Id;B.provider=b[n].Provider;B.displayName=b[n].DisplayName;B.email=b[n].Email;B.imageUrl=this.zHo(b[n].PictureUrl,b[n].Email,b[n].Provider);this.ISa&&(B.color=this.ISa.zlc(new Ir.a(B.email,void 0,B.displayName),$t.a.rml));h[n]=B}return h}guf(b,h){let n="null";h&&(n=Op.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,n))}F8m(b){return this.aOc?Bv(b,this.aOc):b}Jgl(b){return this.ISa?xu(b,this.ISa):new Map}}Object(u.a)(Et,"WordActivityRequestManager",
null,[506]);class rx{constructor(b,h,n){this.EHd=0;this.kOc=!1;this.csh=null;this.Ttd=()=>{if($e.App.SU)x.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.kOc||3>=this.EHd){this.kOc?this.kOc=!1:this.EHd++;const B=Math.max(this.Ga.ic("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.csh),0);x.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",B);Cg.Task.delay(B).continueWith(()=>{this.iBb.Ttd().then(()=>
{this.qwe();return null}).catch(()=>{this.qwe();this.kOc=!0;this.EHd=0})})}else this.qwe()};this.Ga=b;this.iBb=n;h.RRd(()=>{this.kOc=!0;this.csh=new Date;this.EHd=0})}start(){this.qwe()}qwe(){window.setTimeout(this.Ttd,6E4)}}Object(u.a)(rx,"WordEditorActivityScheduler",null,[]);class nt{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}nRo(b){this.resolve(b)}}Object(u.a)(nt,"CatchUpNetworkRequestWorkerCache",null,[]);class zw{constructor(b,h,n){this.vMl=b;this.K=h;this.ef=
n}Zhg(b){b&&b.authors&&this.FDn(b.authors)}FDn(b){for(const h of b)h&&h.displayName===this.vMl&&(this.ef.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),x.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",h.id===this.K.kb("PresenceUserId"),h.email===this.K.kb("UserPrincipalName")))}}Object(u.a)(zw,"WywaAuthorComparator",null,
[]);class yi{constructor(b){this.zY=b}Zie(){this.zY&&this.zY.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(u.a)(yi,"IndicatorSurveyActor",null,[]);var Vm=d(1130),Xk=d(1122);class Ds{constructor(){}shouldShowDisplayChangesCheckbox(){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayRecentChangesEnabled",!1)}toggleShowingChanges(){return Promise.resolve(!0)}}Object(u.a)(Ds,"WordRecentChangesManager",null,[504]);class Cv{constructor(){this.vml=
{crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get oml(){return A.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get PXi(){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get iXi(){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",!1)}get jde(){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)}get zde(){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCatchUpActivitiesReadyTelemetryFixV2Enabled",!1)}get mtn(){return A.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}get Joc(){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1)}wc(b){Eb("Configure");this.container=b;b.ia("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new nt).ha()}init(){Eb("Init");this.oml&&
(M.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,4,A.AFrameworkApplication.rootQuerySignature,$e.App.webServiceBase+"OneNote.ashx",ed.a.word,this.jde)}),Eb("HotStore"),$e.App.bda.x$a.execute(()=>{Eb("ChromeReady");ml.a.get_instance().Lk(7,()=>{Eb("ScriptDownload");(A.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").xC.loadScript("catchUpActivity")).catch(b=>
{x.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",b)}).then(()=>this.vVn()).catch(b=>{x.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}vVn(){Eb("CreateObjectsAndInitializeState");this.VCn();this.sDl();return this.Q6m()}VCn(){x.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");x.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");
x.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.PXi&&x.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.iXi&&x.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");x.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.mtn);this.jde&&x.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}Q6m(){this.x7m();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").QEf=new Date;
Eb("InitializeCatchUpApp");return this.Cec.initialize(Object.assign(new jg,{featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.PXi,customDynamicEntryPointEnabled:this.iXi,activityFeedDataEnabled:this.jde})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}sDl(){this.container.ia("WordEditor.CatchUpActivity.ChangeIdCache",()=>new Ie(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),Eh.a.en.ib.sc.jd)).ha();
this.container.ia("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",()=>new Vm.a(oa.Health.instance,new Xk.a,this.vml)).ha();this.container.ia("WordEditor.CatchUpActivity.IActivityStateManager",()=>new Bd).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityContentManager",()=>new jo(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),A.AFrameworkApplication.va,Wk.UISurfaces.kP(),this.Joc)).as("Common.App.CatchUpActivity.IActivityContentManager").ha();this.container.ia("WordEditor.CatchUpActivity.Network.ActivityRepository",
()=>new Gk(new $i.a(Di.a.i1j(this.container.Qa("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>A.AFrameworkApplication.rootQuerySignature,$e.App.webServiceBase+"OneNote.ashx",ed.a.word,Di.a.i1j(this.container.Qa("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).ha();this.container.ia("Common.App.CatchUpActivity.IActivityRequestManager",()=>new Et(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),
this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.Joc)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new Cs(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
Eh.a.en.ib.sc,new ol.a(Eh.a.en.ib.sc),Zb.a.instance,Ph.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).ha();this.container.ia("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new rd.a(50,$c.a.Ee):new Wd;return new Tk(A.AFrameworkApplication.mc,b,Eh.a.en.ib.sc.jd)}).ha();this.container.ia("WordEditor.CatchUpActivity.IndicatorSurveyActor",
()=>new yi(this.container.Qa("Common.ISystemInitiatedFeedback"))).ha();this.container.ia("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new wm(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),A.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),this.Joc)).ha();
this.container.ia("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new bf(A.AFrameworkApplication.va,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),Ph.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ha();this.container.ia("WordEditor.CatchUpActivity.FlyoutFocus",()=>new Of(kc.a.instance,Ph.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").ha();this.container.ia("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",
()=>new Bi).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new Ib(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),Eh.a.en.ib.sc)).ha();this.container.ia("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new Sk(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).ha();this.container.ia("Common.App.CatchUpActivity.IChangeSummariesDataProvider",
()=>new Sc(new hd(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new Fb(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),A.AFrameworkApplication.mc),new Nf(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),
this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),this.Joc)).ha();this.container.ia("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new Nk(A.AFrameworkApplication.va)).as("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ha();this.container.ia("WordEditor.CatchUpActivity.RecentChangesManager",()=>new Ds).as("Common.App.CatchUpActivity.IRecentChangesManager").ha();this.Cec=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new Ag,
{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:A.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:A.AFrameworkApplication.dataCulture,
emptyCatchUpBehaviorManager:this.jde?this.container.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:A.AFrameworkApplication.uiCulture,ulsLogger:new zc.a,recentChangesManager:this.container.resolve("Common.App.CatchUpActivity.IRecentChangesManager")}));this.Cec.setWebpackPublicPath(A.AFrameworkApplication.c9);
this.container.ia("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new xn(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).ha();this.container.ia("WordEditor.CatchUpActivity.WordEditorActivityScheduler",()=>new rx(A.AFrameworkApplication.K,Ze.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).ha();this.container.ia("WordEditor.CatchUpActivity.IndicatorTelemetryActor",
()=>new Pg(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorActor",()=>new Um(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.Cec.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),
Eh.a.en.ib.sc,this.container.Qa("Common.IZoomManager"),A.AFrameworkApplication.mc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!$e.App.instance&&$e.App.instance.Qta,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"))).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new Mc(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,Eh.a.en.ib.sc.jd,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),
A.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.zde)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityAnnouncementManager",()=>new yg(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),A.AFrameworkApplication.va,Ph.FocusManager.instance())).ha();this.container.ia("WordEditor.CatchUpActivity.WywaAuthorComparator",
()=>new zw(A.AFrameworkApplication.userName,A.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha()}x7m(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");b.idb(h);const n=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const B=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");
h=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const L=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),ba=Zb.a.instance,la=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");ba.Cw(()=>{L.Pfe?L.Pfe=!1:(L.Rdb&&n.goj(null,null,!1),L.$rb&&n.cnj(null,null),B.hpf())});ba.Cw(Object(z.a)(h,h.BP,"onSelectionChanged"));this.Cec.getWywaEvent().addListener(Object(z.a)(b,b.Zhg,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");
this.Cec.getWywaEvent().addListener(Object(z.a)(b,b.Zhg,"onWywaActivityReady"));const La=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");la.l1k((fb,Cb)=>{Cb&&La.e0n(Cb.node)});la.fHb.then(()=>{La.y4k()});this.Cec.getWywaEvent().addListener(()=>{la.dcl()});B.F_k((fb,Cb)=>{Cb&&n.cnj(Cb.DOb,Cb.vRi)});B.G_k((fb,Cb)=>{Cb&&n.goj(Cb.DOb,Cb.vRi,Cb.w3o)});B.Wb(A.AFrameworkApplication.va);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();
this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();this.P7o()}P7o(){kh.c()&&(x.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(u.a)(Cv,"WordEditorCatchUpActivityPackageManager",null,[0,1]);var Jq=d(196),Es=d(436),yu=d(1575),Hn=d(491),Xs=d(1693),Pn=d(1582),Oo=d(1780),am=d(1781),sq=d(680),au=d(1782),
Pp=d(935),sr=d(151),Nm=d(1586);class Lr{constructor(){this.operationType=this.annotation=null}}Object(u.a)(Lr,"AnnotationChangedData",null,[]);class Dv{constructor(b,h,n,B,L,ba,la,La=!1,fb){this.annotationType=b;this.yA=h;this.Pp=n;this.Tyc=B;this.lud=L;this.oCp=ba;this.ib=la;this.iSj=La;this.K=fb;this.vz=null;this.T0i=!1;this.ed=new mg.a;this.Eed=0}MH(b){this.ed.addHandler("AnnotationChangedEvent",b)}sK(b){this.ed.removeHandler("AnnotationChangedEvent",b)}register(){return this.lud().then(()=>{0===
this.Eed&&(this.iSj&&(this.vz=this.Pp.Vf("WebServiceCall",this.annotationType)),this.yA.nb(this,this.annotationType));this.Eed++})}unregister(){return this.lud().then(()=>(new Promise(b=>setTimeout(b,this.K.ic(sr.a.cSl,3E3)))).then(()=>{0<this.Eed&&(this.Eed--,0===this.Eed&&this.yA.xc(this,this.annotationType))}))}vjc(){return this.lud().then(()=>this.yA.getAnnotationsByType(this.annotationType))}Gti(b){b=Es.a.GL(b);return(b=this.yA.kHf(b))&&0<b.count?b.toArray().filter(h=>Cj.a.matchesTypesFor(h.content,
[this.annotationType])):[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.oCp(this.ib.$c.td,b.parentPath):null:(x.ULS.shipAssertTag(575930380,3016,!1),null)}JAa(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new Pp.a,{parentPath:["Signal",Cj.a.getTypeNameFor(b)],items:[Object.assign(new Fk.a,{body:b})]});this.Tyc.submitOperation(b)}m_l(b,h){b=Object.assign(new mh.a,{parentPath:["Signal",h],items:b});this.Tyc.submitOperation(b)}lD(b,h){b?h?(this.iSj&&!this.T0i&&(this.vz.stop(),
this.T0i=!0),this.ed.C7&&(b=new Nm.a(Object.assign(new Lr,{annotation:b,operationType:h})),this.ed.raiseEvent("AnnotationChangedEvent",b))):x.ULS.shipAssertTag(575930382,3016,!1):x.ULS.shipAssertTag(575930381,3016,!1)}}Object(u.a)(Dv,"AnnotationManager",null,[641,223]);class lp{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb){this.sL=b;this.Qve=h;this.XOb=n;this.L8a=B;this.Naa=L;this.x0j=ba;this.O4=la;this.G1b=La;this.ohc=fb;this.hYb=Cb;this.dhp=Lb}}Object(u.a)(lp,"AnnotationManagerHolder",null,[642]);class Aw{constructor(b,
h){this.Cea=b;this.lud=h}submitOperation(b){return this.lud().then(()=>{this.Cea.getAugLoopRuntimeManager().submitOperation(Object.assign(new Na.a,{operation:b}))})}}Object(u.a)(Aw,"SubmitOperationHelper",null,[]);var Df=d(1158),bm=d(1783),Ev=d(1163),Gf=d(62),Cn=d(128),tn=d(82),Kq=d(828);class Do{constructor(b,h,n){this.Naa=b;this.hn=h;this.gXb=n;this.UJa={};this.Nhi=!1;this.Avb=(B,L)=>{var ba;L.data.operationType!==mh.a.getTypeName()&&L.data.operationType!==Kq.n.getTypeName()||!L.data.annotation||
L.data.annotation.annotationType!==bm.a.getTypeName()||(B=L.data.annotation.content)&&null!==(ba=B.documentTypeConfidences)&&void 0!==ba&&ba.length&&(this.Mhi=B.documentTypeConfidences[0].documentTypeLabel,x.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.Mhi))};this.Naa.MH(this.Avb);this.Naa.register();this.UJa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,
["currentPage"]:null}}s7d(){this.Nhi||(this.Naa.JAa(new Ev.a),x.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.Nhi=!0);this.Pyf();this.UJa.docType=this.Mhi;this.UJa.characterCount=this.characterCount;this.UJa.paragraphCount=this.dV;this.UJa.imageCount=this.LL;this.UJa.tableCount=this.Zca;this.UJa.listElementsCount=this.j7i;this.UJa.blobsCount=this.YTc;this.UJa.pageCount=this.gXb.getTotalPageCount();this.UJa.currentPage=this.gXb.VDi();return this.UJa}Pyf(){this.dV=
this.YTc=this.j7i=this.Zca=this.LL=this.characterCount=0;var b=this.hn.Ksa(Eh.a.en.ib.sc.jd,7,7).currentNode,h=ve.GraphIterator.eb(b);for(b=Ff.a.Ft(h,b);b.moveNext();)if(h=b.currentNode)if(Ad.ImageReader.Lt(h))this.LL++;else if(xh.TableReader.HU(h))this.Zca++;else if(Gf.ListItemReader.Hg(h))this.j7i++;else if(ea.ParagraphReader.Xb(h)){var n=tn.e(h);for(let B=0;B<n.length;B++)5===n[B].Jh?this.LL++:this.YTc++;n=Cn.AParagraphNode.iV(h.characterData);n=n.trim();this.characterCount+=n.length;0<n.length&&
!ea.ParagraphReader.E3(h)&&!ea.ParagraphReader.GX(h)&&this.dV++}}}Object(u.a)(Do,"LoggingDocumentInfo",null,[501]);class Mr{constructor(){this.sa=new mg.a}H1k(b){this.sa.addHandler("OnTaskPaneReviewStateChanged",b)}ZAo(b){this.sa.removeHandler("OnTaskPaneReviewStateChanged",b)}C0k(b){this.sa.addHandler("BlueDotClickedEvent",b)}EAo(b){this.sa.removeHandler("BlueDotClickedEvent",b)}Q0k(b){this.sa.addHandler("OnFormattingMarkedForReview",b)}S0k(b){this.sa.addHandler("OnFormattingReviewCompleted",b)}P0k(b){this.sa.addHandler("OnFormattingAccept",
b)}R0k(b){this.sa.addHandler("OnFormattingReject",b)}x1k(b){this.sa.addHandler("OnReviewInvalidated",b)}sQh(b){this.sa.addHandler("OnTraigeAction",b)}Fgf(b){this.sa.addHandler("OnReviewVisibilityChanged",b)}SAo(b){this.sa.removeHandler("OnReviewVisibilityChanged",b)}z0k(b){this.sa.addHandler("OnBeforeReviewNavigation",b)}t1k(b){this.sa.addHandler("OnRegisterEnhancement",b)}K1k(b){this.sa.addHandler("onTooltipVisibilityChanged",b)}$Ao(b){this.sa.removeHandler("onTooltipVisibilityChanged",b)}Ajd(b){b?
this.sa.raiseEvent("OnTaskPaneReviewStateChanged",new Nm.a(b)):x.ULS.shipAssertTag(575930374,3016,!1)}smo(b){b?this.sa.raiseEvent("BlueDotClickedEvent",new Nm.a(b)):x.ULS.shipAssertTag(575930375,3016,!1)}vmo(b){b?this.sa.raiseEvent("OnFormattingMarkedForReview",new Nm.a(b)):x.ULS.shipAssertTag(575930376,3016,!1)}Zxj(b){b?this.sa.raiseEvent("OnFormattingReviewCompleted",new Nm.a(b)):x.ULS.shipAssertTag(573850377,3016,!1)}umo(b){b?this.sa.raiseEvent("OnFormattingAccept",new Nm.a(b)):x.ULS.shipAssertTag(575930377,
3016,!1)}wmo(b){b?this.sa.raiseEvent("OnFormattingReject",new Nm.a(b)):x.ULS.shipAssertTag(575930378,3016,!1)}xmo(b){b?this.sa.raiseEvent("OnReviewInvalidated",new Nm.a(b)):x.ULS.shipAssertTag(575930379,3016,!1)}Qpg(b){b?this.sa.raiseEvent("OnTraigeAction",new Nm.a(b)):x.ULS.shipAssertTag(573850378,3016,!1)}$xj(b){b?this.sa.raiseEvent("OnReviewVisibilityChanged",new Nm.a(b)):x.ULS.shipAssertTag(573850379,3016,!1)}rmo(b){b?this.sa.raiseEvent("OnBeforeReviewNavigation",new Nm.a(b)):x.ULS.shipAssertTag(573687395,
3016,!1)}Xuc(b){b?this.sa.raiseEvent("OnRegisterEnhancement",new Nm.a(b)):x.ULS.shipAssertTag(555055117,3016,!1)}oyj(b){b?this.sa.raiseEvent("onTooltipVisibilityChanged",new Nm.a(b)):x.ULS.shipAssertTag(540587343,3016,!1)}}Object(u.a)(Mr,"ReviewEvents",null,[500]);class zu{constructor(b){this.Sy=b;if(!b)throw Jq.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}wc(b){this.W=b;b.ia("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new Aw(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),
Es.a.Pl)).ha();b.ia("WordEditor.Designer.IDesignerControl",()=>new Df.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),A.AFrameworkApplication.uiCulture)).ha();b.ia("WordEditor.Designer.Common.Review.IReviewEvents",()=>new Mr).ha();b.ia("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new lp(this.pJa(Pn.DocumentRoleDetectionAnnotation.getTypeName()),this.pJa(Pn.RoleDetectionAnnotation.getTypeName()),this.pJa(yu.FormattingSuggestionsSummaryAnnotation.getTypeName(),
!0),this.pJa(yu.FormattingSuggestionsAnnotation.getTypeName()),this.pJa(Hn.DocumentTypeClassifierAnnotation.getTypeName()),this.pJa(am.ThemeExtractorAnnotation.getTypeName()),this.pJa(sq.ThemeGeneratorAnnotation.getTypeName()),this.pJa(Oo.TextToImageAnnotation.getTypeName()),this.pJa(Xs.DocumentPullQuoteAnnotation.getTypeName()),this.pJa(Xs.PullQuoteAnnotation.getTypeName()),this.pJa(au.TableTypeAnnotation.getTypeName()))).ha();b.ia("WordEditor.Designer.DocumentInfo",()=>new Do(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Naa,
b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).ha()}dispose(){}pJa(b,h=!1){return new Dv(b,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),Es.a.Pl,Es.a.Wqb,this.Sy,h,this.W.resolve("Common.IAppSettingsManager"))}}Object(u.a)(zu,"PackageManager",null,[0,1]);var Au=d(1118),Fv=d(1568),Ft=d(1788);class mp extends Sys.EventArgs{constructor(b,
h){super();this.node=b;this.Zbg=h}}Object(u.a)(mp,"RoleChangeArgs",Sys.EventArgs,[]);class Zo{constructor(b){this.ii=!1;this.J$=b;this.J$.mEd++}dispose(){this.ii||(this.ii=!0,this.J$.mEd--)}}Object(u.a)(Zo,"InvalidationSuspension",null,[13]);class Bw{constructor(){this.krd=null;this.role=this.wke=0;this.vKb=this.Xfe=this.Ula=this.Hpc=!1;this.Bje=this.Pcd=this.FVa=null;this.kxb=this.placeholder=!1;this.PSd=this.Vuf=null;this.OSd=0}get bab(){return!this.role||!this.FVa||!this.FVa.length}Sbn(){this.vKb=
this.Xfe=!0}Btn(){return!!this.role||!!this.FVa||!!this.krd}}Object(u.a)(Bw,"RoleState",null,[547]);class Nr{constructor(b,h,n,B,L){this.ui=!1;this.Tce=null;this.e8f=new Lf.a;this.vlh=0;this.VIo=(ba,la)=>{la.data.operationType===mh.a.getTypeName()&&(la=la.data.annotation,(ba=la.content)?(la=this.Q$b.getParent(la))&&this.jod(la,Fv.f(ba.roleType),!1,void 0,null!=ba.listID?ba.listID:0,ba.listItemlevel,ba.listItemPrefix):x.ULS.shipAssertTag(575813856,3016,!1))};this.mXl=(ba,la)=>{if(la.data.operationType===
mh.a.getTypeName())if(ba=la.data.annotation.content)for(x.ULS.sendTraceTag(556074199,3016,50,ba.confidence.toString()),this.e8f=new Lf.a,la=0;ba.listInfos&&la<ba.listInfos.length;la++){const La=ba.listInfos[la];this.e8f.Z(La.listID,La)}else x.ULS.shipAssertTag(556323522,3016,!1)};this.A_i=(ba,la)=>{ba=ba.iQ;if(!ba||ba.ja(Lc.a.XC,!1))return!1;ba=ba.getValue(Lc.a.ma);if(!ba)return!1;ba=Fv.g(ba);return 1!=ba&&ba!=la.role};this.mdm=(ba,la)=>{ba=la.data.annotation;const La=this.eCd.getParent(ba);if(La)if(la.data.operationType===
mh.a.getTypeName()){const fb=la.data.annotation.content;fb?this.uha(La,Cb=>{this.Tce&&Cb.Vuf&&this.Tce>Cb.Vuf&&!Cb.vKb||Cb.role!==Cb.wke||this.A_i(La,Cb)?(x.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",this.Tce,Cb.vKb,Cb.role===Cb.wke),Cb.krd=fb.suggestions):(Cb.FVa=fb.suggestions,Cb.vKb=!1)}):x.ULS.shipAssertTag(575813859,3016,!1)}else la.data.operationType===Au.a.getTypeName()&&this.uha(La,fb=>{fb.FVa=null;fb.krd=null});else x.ULS.shipAssertTag(575813858,
3016,!1,`Parent not found for annotation id: ${ba.id} parentPath: ${ba.parentPath}`)};this.ZXn=(ba,la)=>{(ba=la.data.paragraphNode)?this.uha(ba,La=>{la.data.J$j?(La.PSd=La.FVa,La.OSd=La.role):(La.PSd=null,La.OSd=0);La.Ula=!0}):x.ULS.shipAssertTag(575930368,3016,!1)};this.aYn=(ba,la)=>{(ba=la.data.paragraphNode)?this.uha(ba,La=>{La.Ula=!1;La.PSd=null;La.OSd=0;5!==la.data.state&&(La.FVa=null)}):x.ULS.shipAssertTag(573850380,3016,!1)};this.XXn=(ba,la)=>{(ba=la.data.paragraphNode)?this.uha(ba,La=>{La.Ula=
!0}):x.ULS.shipAssertTag(575930369,3016,!1)};this.$Xn=(ba,la)=>{(ba=la.data.paragraphNode)?this.jod(ba,1,!0,!0):x.ULS.shipAssertTag(575930370,3016,!1)};this.Ihg=(ba,la)=>{(ba=la.data.paragraphNode)?this.jod(ba,la.data.Zbg,!0,!0):x.ULS.shipAssertTag(575484484,3016,!1)};this.cTm=(ba,la)=>{if(la.node){var La=la.node;ba=this.YB(La);27==ba.role&&x.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ba.Ula&&27!==ba.role&&28!==ba.role&&this.eRj(this.WZb-1);ba.bab||27===ba.role||28===ba.role||
this.YQj(this.inconsistenciesCount-1);this.uha(La,fb=>{fb.kxb=!0});setTimeout(()=>this.removeNode(La),1E4)}else x.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ba=>{let la;({value:la}=this.Wv.Dc(ba.id));(null===la||void 0===la?0:la.kxb)&&this.Wv.remove(ba.id)};this.bTm=(ba,la)=>{la.node?(ba=la.node,this.R_f(ba)?this.uha(ba,La=>{La.kxb=!1}):this.uha(ba,La=>{La.vKb=!1})):x.ULS.shipAssertTag(540672206,3016,!1)};this.dTm=(ba,la)=>{la.node?this.y0b(la.property,la.node)&&(ba=la.node,this.mEd||ba.dre?
this.uha(ba,La=>{La.vKb=!1}):this.uha(ba,La=>{La.Sbn();La.krd&&(La.FVa=La.krd,La.role=La.wke)}).Ula&&this.O4a.xmo(new Ft.a(la.node))):x.ULS.shipAssertTag(575930372,3016,!1)};this.h1n=(ba,la)=>{switch(la.data.role){case 27:const La=la.data;this.uha(la.data.paragraphNode,Cb=>{Cb.role=27;Cb.Hpc=!0;Cb.placeholder=La.placeholder});break;case 28:const fb=la.data;this.uha(la.data.paragraphNode,Cb=>{Cb.role=28;Cb.Hpc=!0;Cb.placeholder=fb.placeholder;Cb.ita=fb.ita});break;case 2:this.uha(la.data.paragraphNode,
Cb=>{Cb.role=2})}};this.eCd=b;this.Q$b=h;this.RQe=n;this.Oq=B;this.O4a=L;this.Wv=new Lf.a;this.sa=new mg.a;this.mEd=this.zLd=this.RDd=0}get ncn(){return this.mEd}V0k(b){this.sa.addHandler(Nr.vlj,b)}B1k(b){this.sa.addHandler(Nr.Pnj,b)}A1k(b){this.sa.addHandler(Nr.Onj,b)}get inconsistenciesCount(){return this.RDd}YQj(b){this.RDd!==b&&(this.RDd=b,this.sa.raiseEvent(Nr.vlj,new Nm.a(this.RDd)))}get WZb(){return this.zLd}eRj(b){this.zLd!==b&&(this.zLd=b,this.sa.raiseEvent(Nr.Pnj,new Nm.a(this.zLd)))}get tTf(){return this.vlh}R_f(b){return this.Wv.mb(b.id)}qzm(b){var h,
n;return null===(n=null===(h=this.e8f)||void 0===h?void 0:h.Dc(b))||void 0===n?void 0:n.value}nEi(b,h){var n,B,L;const ba=new Map;for(const la of h)if(h=la){const La=null!==(L=null===(B=null===(n=this.Wv.Dc(h.id))||void 0===n?void 0:n.value)||void 0===B?void 0:B.role)&&void 0!==L?L:1;b.has(La)&&(ba.has(La)?ba.get(La).add(h):ba.set(La,new ob.a([h])))}return ba}YB(b){if(!b)return x.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.Wv.Dc(b.id)).returnValue?h:Object.assign(new Bw,
{role:1,Hpc:!1})}AEo(){this.Tce=new Date;return new Zo(this)}register(){this.eCd.register();this.Q$b.register();this.RQe.register()}unregister(){this.eCd.unregister();this.Q$b.unregister();this.RQe.unregister()}initialize(){if(!this.ui){const b=this.Oq.Ve(12);b.Bw(this.cTm);b.Zt(this.bTm);b.fo(this.dTm);this.eCd.MH(this.mdm);this.Q$b.MH(this.VIo);this.RQe.MH(this.mXl);this.O4a.R0k(this.$Xn);this.O4a.P0k(this.XXn);this.O4a.Q0k(this.ZXn);this.O4a.S0k(this.aYn);this.O4a.sQh(this.Ihg);this.O4a.t1k(this.h1n);
this.ui=!0}}Pd(){}jod(b,h,n,B=!1,L=0,ba=0,la){let La=0,fb=!1;this.uha(b,Cb=>{const Lb=Cb.Xfe||!Cb.role||1==Cb.role;n||(Cb.wke=h);if(B||Lb)fb=Cb.role!==h,La=Cb.role,Cb.role=h,Cb.Hpc=n,Cb.Xfe=!1,Cb.Pcd=L,Cb.Bje=ba,Cb.listItemPrefix=la,Cb.Vuf=new Date});if(fb){const Cb=h-4;Cb>this.tTf&&8>Cb&&(this.vlh=Cb);1===h&&this.uha(b,Lb=>{Lb.FVa=null});this.sa.raiseEvent(Nr.Onj,new Nm.a(new mp(b,h,La)))}}uha(b,h){let n;if(({value:n}=this.Wv.Dc(b.id)).returnValue){b=n.bab;const B=n.Ula;h(n);if(27!==n.role&&28!==
n.role){if(n.kxb)return n;b!==n.bab&&this.YQj(this.inconsistenciesCount+(b?1:-1));B!==n.Ula&&this.eRj(this.WZb+(B?-1:1))}}else h(n=new Bw),n.Btn()&&this.Wv.add(b.id,n);return n}y0b(b,h){({value:h}=this.Wv.Dc(h.id));return 28===(null===h||void 0===h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===Hf.a.Un:!(null===h||void 0===h?0:h.placeholder)&&(b===Hf.a.Un||b===Hf.a.Vn||Array.contains(Cn.AParagraphNode.Pfa(),b))}}Nr.vlj="OnInconsistenciesChanged";Nr.Pnj="OnRoleReviewCount";Nr.Onj="OnRoleChanged";
Object(u.a)(Nr,"RoleLifecycleManager",null,[510,511,512]);class sx{constructor(b,h,n,B,L){this.O4a=b;this.Q$b=h;this.Re=n;this.Oq=B;this.J$=L;this.ui=!1;this.Ihg=(ba,la)=>{(ba=la.data.paragraphNode)?this.W6j(ba,()=>!0,La=>La.userSetRole=Fv.e(la.data.Zbg)):x.ULS.shipAssertTag(557057378,3016,!1)};this.$_n=(ba,la)=>{0<this.J$.ncn||this.y0b(la.property)&&this.W6j(la.node,La=>!(La&&La.isInvalidated),La=>La.isInvalidated=!0)}}initialize(){this.ui||(this.O4a.sQh(this.Ihg),this.Oq.Ve(12).fo(this.$_n),this.ui=
!0)}Pd(){}W6j(b,h,n){if(b=(b=this.Q$b.Gti(b))&&1===b.length&&b[0]){var B=b.content;B=B&&B.M_&&B.M_.customMetadata;h(B)&&(h=new Pn.RoleDetectionCustomMetadata,h.isInvalidated=B&&B.isInvalidated,h.userSetRole=B&&B.userSetRole,n(h),this.Re.Ltp(b,h))}}y0b(b){return b===Hf.a.Un||b===Hf.a.Vn||Array.contains(Cn.AParagraphNode.Pfa(),b)}}Object(u.a)(sx,"RoleDetectionMetadataUpdater",null,[509]);class Bu{constructor(b,h){this.Tyc=b;this.CNb=h;this.ffd=(n,B)=>{n=B.data;if(n.operationType==Kq.a.getTypeName()||
n.operationType==Kq.n.getTypeName())if(n=n.annotation&&n.annotation.content)this.runId=n.runId};this.revisionId=0}initialize(){this.CNb.MH(this.ffd)}Pd(){this.CNb.sK(this.ffd)}GUn(){if(void 0===this.runId)Promise.resolve();else{var b=new Pn.RoleDetectionSettings({acceptedRunId:this.runId});b=new Kq.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.Tyc.submitOperation(b)}}}Object(u.a)(Bu,"RoleDetectionSettingsUpdater",null,
[]);class Zu{constructor(b,h,n){this.Tan=b;this.yA=h;this.$d=n;this.JTi=this.initialized=!1;this.sjj=()=>{this.JSj()&&(this.jSi(),this.yA.wAo(this.sjj))}}initialize(){this.initialized||(this.zVf(),this.initialized=!0)}Pd(){}zVf(){this.JSj()?this.jSi():this.yA.n0k(this.sjj)}JSj(){return!this.JTi&&(this.$d.xXi()||this.yA.znc(Pn.DocumentRoleDetectionAnnotation.getTypeName())||this.yA.znc(Pn.RoleDetectionAnnotation.getTypeName()))}jSi(){for(const b of this.Tan)b.initialize();this.JTi=!0}}Object(u.a)(Zu,
"RLMInitializer",null,[]);class Gv{constructor(b,h,n){this.n1=b;this.Sy=h;this.ixd=n;this.W=null;this.a9=()=>{this.r8c();this.Sy.pdb(this.a9)};if(!b)throw Jq.a.argument("AppLifecycleManager is null");if(!h)throw Jq.a.argument("Workspace is null");if(!n)throw Jq.a.argument("ApplicationInstance is null");}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>this.Mo())}wc(b){this.W=b;b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",
()=>new Bu(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").sL)).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new sx(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Qve,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();
b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new Nr(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").L8a,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Qve,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").sL,b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).ha();
b.ia("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new Zu([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("WordEditor.Designer.IDesignerControl"))).ha()}dispose(){}Mo(){this.ixd.BN?this.n1.Lk(16,()=>this.J7c()):this.J7c()}J7c(){this.Sy.lCa?this.r8c():this.Sy.Eja(this.a9)}r8c(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();
this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(u.a)(Gv,"PackageManager",null,[0,1]);class tr{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,h){const n=new tr;n.ContractVersion=b;n.FileName=h;n.Paragraphs=[];return n}}Object(u.a)(tr,"DocumentSwayPreviewContent",null,[]);class Cu{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static OAl(b,h,n,B){const L=
new Cu;L.RawText=b;L.ParagraphFormatting=h;L.TextRuns=n;L.IsRTL=B;L.ParagraphIndex=0;return L}}Object(u.a)(Cu,"ParagraphContent",null,[]);var Qn=d(109),Da=d(1287);class Sa{constructor(){this.Name=null;this.Size=0}static construct(b,h){const n=new Sa;n.Name=b;n.Size=h;return n}}Object(u.a)(Sa,"FontData",null,[]);class Ha{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,n,B,L,ba){const la=new Ha;la.IsBold=b;la.IsUnderline=
h;la.IsUppercase=n;la.Font=B;la.Alignment=L;la.LeftIndent=ba;return la}}Object(u.a)(Ha,"TextFormatting",null,[]);class Ba{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const n=new Ba;n.RawText=b;n.RunFormatting=h;return n}}Object(u.a)(Ba,"TextRunContent",null,[]);var Va=d(116),xb=d(40);class ac{constructor(b,h){this.Chb=null;this.pDk=b;this.yQ=h||""}get O7n(){return this.pDk.value}h5l(){var b=Date.now();const h=tr.construct(2,this.yQ);h.Paragraphs=this.ghm();b=Date.now()-
b;const n={};n.ExtractionDurationInMs=b.toString();x.ULS.sendTraceTag(25268374,382,50,"{0}",n);return h}ghm(){const b=new ob.a;var h=0;let n=0,B=!1;var L=new ve.GraphIterator;L.set(this.O7n);L=Ff.a.iq(L.currentNode);const ba=new Lf.a(0);for(;L.moveNext()&&2100>n&&25>h;){var la=L.currentNode;if(ea.ParagraphReader.Xb(la)&&!ea.ParagraphReader.E3(la)){!B&&ea.ParagraphReader.GX(la)&&(B=!0);let La=Cn.AParagraphNode.iV(la.characterData);La=La.trim();if(0<La.length){const fb=this.uU(la);fb.ParagraphIndex=
h;h++;n+=La.length;b.add(fb);this.jxp(ba,ea.ParagraphReader.language(la))}}}this.Chb=this.jom(ba);h={};h.documentHasList=B;x.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}jom(b){let h=-1,n=1033;for(const B of b.keys.toArray())B&&b.J(B)>h&&(h=b.J(B),n=B);return hj.a.Cg(n)}jxp(b,h){b.mb(h)?b.Z(h,b.J(h)+1):b.Z(h,1)}uU(b){const h=Cn.AParagraphNode.iV(b.characterData),n=this.mEm(b),B=this.cOm(b);b=this.bon(b);return Cu.OAl(h,n,B,b)}mEm(b){const h=ea.ParagraphReader.Bj(b,Hf.a.bold,!1),n=
ea.ParagraphReader.Bj(b,Hf.a.underline,!1);var B=ea.ParagraphReader.Bj(b,Hf.a.fontSize,Qn.a.gP);const L=ea.ParagraphReader.Bj(b,Hf.a.font,Qn.a.RJ);var ba=ea.ParagraphReader.ez(b);ba=this.WGf(ba);const la=!!ea.ParagraphReader.Bj(b,lk.a.capitalization,0);b=(new Da.a).iX(b).value/20;B=Sa.construct(L,B);return Ha.construct(h,n,la,B,ba,b)}cOm(b){const h=new ob.a;for(let L=0;L<b.qa.length-1;L++){var n=b.qa.J(L),B=b.qa.J(L+1);n.formatting&&(B=Cn.AParagraphNode.iV(b.characterData.substr(n.cp,B.cp-n.cp)),
n=this.dOm(n.formatting),n=Ba.construct(B,n),h.add(n))}return h.toArray()}dOm(b){const h=Va.FormattingReader.I4c(b,Hf.a.bold,!1),n=Va.FormattingReader.I4c(b,Hf.a.underline,!1);var B=Va.FormattingReader.I4c(b,Hf.a.fontSize,Qn.a.gP);const L=Va.FormattingReader.I4c(b,Hf.a.font,Qn.a.RJ);B=Sa.construct(L,B);b=!!Va.FormattingReader.I4c(b,lk.a.capitalization,0);return Ha.construct(h,n,b,B,5,0)}WGf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}bon(b){const h=
new ve.GraphIterator;h.set(b);h.zb(11);return(b=h.ld(11))?xb.OutlineElementReader.Lo(b):!1}}Object(u.a)(ac,"DocumentContentExtractor",null,[480]);class qc{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}wc(b){b.ia("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new ac(new Rf.a(()=>Eh.a.en.ib.sc.jd),A.AFrameworkApplication.It.FA)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").ha()}static main(){M.a.instance.Jc(new qc)}}Object(u.a)(qc,"DocumentContentExtractorPackage",
null,[0,1]);class Qc{}Qc.kh="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(u.a)(Qc,"EmbedDialogHtml",null,[]);class K{constructor(b,h,n,B){this.ktc=b;this.o$a=h;this.dpe=n;this.value=B}}Object(u.a)(K,"OptionInfo",null,[]);class pa{constructor(b,h,n){this.wxg=b;this.Fmc=h;this.o$a=n}}Object(u.a)(pa,"SectionInfo",null,[]);var Ta=d(291);class jb extends Ge.a{constructor(b,
h=!1){super(!1,!1,h);this.QAd=476;this.J6b=288;this.iQe=798;this.tJk=476;this.sJk=288;this.Ygd={};this.Txb=[];this.hZ=this.m4a=this.tGb=this.RCb=this.HId=this.j$b=null;this.B$k=n=>{this.Y0h(n);return!0};this.C$k=n=>this.Qad(n,this.Y0h);this.Y0h=n=>{n=n.Mq;"visible"===n.wxg.style.visibility?(n.wxg.style.visibility="hidden",n.o$a.className=Bb.getImageClass(jb.Lfh),n.o$a.title=CommonUIStrings.l_Expand,n.Fmc.title=CommonUIStrings.l_Expand):(n.wxg.style.visibility="visible",n.o$a.className=Bb.getImageClass(jb.BRk),
n.o$a.title=CommonUIStrings.l_Collapse,n.Fmc.title=CommonUIStrings.l_Collapse)};this.V5n=n=>{this.cqj(n);return!0};this.W5n=n=>this.Qad(n,this.cqj);this.cqj=n=>{const B=this.Ygd[n.Mq.toString()];B.value?(B.value=0,B.o$a.className=Bb.getImageClass(jb.Tbf),B.dpe.setAttribute(Bc.a.AIa,Bc.a.PO)):(B.value=1,B.o$a.className=Bb.getImageClass(jb.cNe),B.dpe.setAttribute(Bc.a.AIa,Bc.a.hq));this.fFe(n.Mq.toString(),B.value.toString())};this.wip=()=>{this.hZ.select()};this.VGc=A.AFrameworkApplication.D6c;this.aHb=
b;this.k3e=this.V5n;this.WMc=this.W5n;this.iLe=this.B$k;this.y4b=this.C$k;this.yOd=this.wip;this.NBk=h;this.kh=Qc.kh;this.Gd=0;this.Qg="EmbedDialog"}get Ps(){return this.J6b}set Ps(b){this.J6b=b}$Uj(b){const h={["id"]:this.Qg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:za.a.lp(this.aHb,
"wdPreview","1"),["initialEmbedUrl"]:this.VGc,["getEmbedCode"]:jb.Pxi,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const n of Object.keys(b))h[n]=b[n];this.Gd=1;this.Pe(1,CommonUIStrings.l_CopyAction);this.Pe(0,CommonUIStrings.l_Close);this.pi(CommonUIStrings.l_Embed,null,h)}$xc(){if(this.NBk)this.$Uj({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.j$b=document.getElementById("embedpreviewpane");this.HId=document.getElementById("embedoptionpane");this.j$b.style.width=String.format("{0}px",
this.tJk);this.m4a=document.createElement("iframe");this.m4a.className=jb.rJk;this.m4a.frameBorder="0";this.m4a.style.height=String.format("{0}px",this.sJk);this.m4a.tabIndex=-1;this.j$b.appendChild(this.eZd(CommonUIStrings.l_Preview,this.m4a,jb.wAh,jb.vAh,jb.wAh,!0));this.hZ=document.createElement("textarea");this.hZ.className=jb.ruk;Sys.UI.DomElement.addCssClass(this.hZ,Ta.a.Uhf);this.hZ.id=jb.xgh;X.a.Di||(this.hZ.readOnly=!0);this.hZ.rows=4;this.hZ.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;
this.hZ.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.hZ.setAttribute(Bc.a.Kja,String.format("{0} {1}",jb.wgh,jb.vgh));this.j$b.appendChild(this.eZd(CommonUIStrings.l_EmbedCode,this.hZ,jb.wgh));Nb.a.addHandler(this.hZ,"focus",this.yOd);var b=document.createElement("span");b.className=jb.fwk;b.innerText=CommonUIStrings.l_CopyText;b.id=jb.vgh;this.j$b.appendChild(b);this.RCb=document.createElement("div");this.RCb.className=jb.ytk;this.HId.appendChild(this.eZd(CommonUIStrings.l_Dimensions,
this.RCb));this.tGb=document.createElement("div");this.HId.appendChild(this.iEl(jb.gyh,this.tGb));this.Gd=0;this.Pe(1,CommonUIStrings.l_Close);this.XLg();this.R8j();X.a.Di||this.hZ.focus()}}dispose(){if(this.Ygd){var b=this.Ygd;for(const h in b){const n=b[h];this.Cr.xc(Cd.a.click,n.ktc,this.k3e);this.ne.xc(Cd.a.Ti,n.ktc,this.WMc);this.ne.xc(Cd.a.oi,n.ktc,this.WMc)}this.WMc=this.k3e=this.Ygd=null}if(this.Txb){for(b=0;b<this.Txb.length;++b)this.Cr.xc(Cd.a.click,this.Txb[b].Fmc,this.iLe),this.ne.xc(Cd.a.Ti,
this.Txb[b].Fmc,this.y4b),this.ne.xc(Cd.a.jv,this.Txb[b].Fmc,this.y4b),this.ne.xc(Cd.a.oi,this.Txb[b].Fmc,this.y4b);this.ne=this.iLe=this.Txb=null}this.yOd&&this.hZ&&(Nb.a.removeHandler(this.hZ,"focus",this.yOd),this.yOd=null);this.hZ=this.m4a=this.tGb=this.RCb=this.HId=this.j$b=null;super.dispose()}$ga(){super.$ga();this.Oc.style.width=String.format("{0}px",this.iQe);this.MIa()}Hvp(b,h){const n=za.a.lp(this.VGc,b,h);return this.VGc!==n?(this.VGc=n,this.aHb=za.a.lp(this.aHb,b,h),!0):!1}XLg(){this.hZ&&
(this.hZ.innerText=jb.Pxi(this.VGc,this.QAd,this.J6b))}R8j(){this.m4a&&this.m4a.contentWindow.location.replace(za.a.lp(this.aHb,"wdPreview","1"))}fFe(b,h){this.Hvp(b,h)&&(this.XLg(),this.R8j())}eZd(b,h,n=null,B=null,L=null,ba=!1){const la=document.createElement("div");la.className=jb.iMk;B&&(la.id=B);L&&la.setAttribute(Bc.a.Kja,L);ba&&(la.tabIndex=0);B=document.createElement("span");B.className=jb.jMk;B.innerText=b;n&&(B.id=n);la.appendChild(B);la.appendChild(h);return la}iEl(b,h){const n=this.eZd(CommonUIStrings.l_Interaction,
h),B=this.Mj.createElement("div");B.className=jb.hok;B.id=jb.E9g+b;B.setAttribute(Bc.a.Ph,Bc.a.eaa);B.tabIndex=0;n.insertBefore(B,h);b=Bb.createClusteredImage(16,16,jb.iok,jb.jok,!0,"");B.appendChild(b);b=b.childNodes[0];b.className=Bb.getImageClass(jb.Lfh);b.title=CommonUIStrings.l_Expand;B.title=CommonUIStrings.l_Expand;h.style.visibility="hidden";h=new pa(h,B,b);Array.add(this.Txb,h);this.Cr.rK(Cd.a.click,B,this.iLe,h);this.ne.rK(Cd.a.Ti,B,this.y4b,h);this.ne.rK(Cd.a.jv,B,this.y4b,h);this.ne.rK(Cd.a.oi,
B,this.y4b,h);return n}O9h(b,h){const n=document.createElement("div");n.className=jb.dyh;n.id=b+jb.eyh;var B=this.Mj.createElement("div");B.tabIndex=0;B.className=jb.Yah;B.id=b+jb.zEc;B.setAttribute(Bc.a.Ph,Bc.a.Fjf);B.setAttribute(Bc.a.AIa,Bc.a.hq);B.setAttribute(Bc.a.Kja,b+jb.g6b);n.appendChild(B);n.setAttribute(Bc.a.Ph,Bc.a.BA);var L=Bb.createClusteredImage(16,16,jb.ebh,jb.dbh,!0,"");B.appendChild(L);L=L.childNodes[0];L.id=b+jb.fyh;L.className=Bb.getImageClass(jb.cNe);B=new K(n,L,B,1);this.Ygd[b]=
B;this.Cr.rK(Cd.a.click,n,this.k3e,b);B=document.createElement("span");B.className=jb.g6b;B.innerText=h;B.id=b+jb.g6b;n.appendChild(B);this.ne.rK(Cd.a.Ti,n,this.WMc,b);this.ne.rK(Cd.a.oi,n,this.WMc,b);return n}static Pxi(b,h,n){if(!jb.R1e){const B=String.format('<a target="_blank" href="{0}">{1}</a>',F.a.vmc("https://office.com"),CommonUIStrings.l_Office),L=String.format('<a target="_blank" href="{0}">{1}</a>',F.a.vmc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);jb.R1e=String.format(CommonUIStrings.l_NoFrames,
B,L)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',F.a.vmc(b),h,n,jb.R1e)}}jb.R1e=null;jb.cNe="CheckboxChecked_16x16x32";jb.Tbf="CheckboxUnchecked_16x16x32";jb.BRk="OutlookSearchChevronUp_16x16x32";jb.Lfh="OutlookSearchChevronDown_16x16x32";jb.ebh="CommentChecked";jb.iok="UpArrowServer";jb.g6b="EmbedDescription";jb.iMk="EmbedSectionHeader";jb.jMk="EmbedSectionName UIFontBold";jb.fwk="EmbedCodeFooter";jb.dbh="EmbedOptionImage";jb.rJk="EmbedPreviewFrame";
jb.ruk="EmbedCodeTextArea";jb.dyh="EmbedOption";jb.ytk="EmbedDimensionSection";jb.jok="EmbedArrowIcon";jb.hok="WACGlyph EmbedArrowHolder";jb.Yah="EmbedCheckBoxHolder";jb.eyh="Option";jb.fyh="OptionImage";jb.xgh="EmbedCode";jb.wgh="EmbedCodeHeader";jb.wAh="Preview";jb.vAh="PreviewHeader";jb.gyh="Options";jb.E9g="Arrow";jb.zEc="Check";jb.vgh="EmbedCodeFooter";Object(u.a)(jb,"EmbedDialog",Ge.a,[]);class bc extends K{constructor(b,h,n,B,L){super(b,h,n,B);this.y$a=L}}Object(u.a)(bc,"OptionInputInfo",K,
[]);class Ic extends jb{constructor(b,h){super(b,Ic.bO);this.rea=null;this.sGc=[];this.sNd=Object(z.a)(this,this.Tbp,"startOnOptionClickHandler");this.Jac=Object(z.a)(this,this.Ubp,"startOnOptionKeyHandler");this.ZId=Object(z.a)(this,this.Q_n,"onPageNumberChanged");this.uQe=Object(z.a)(this,this.aXn,"onDimensionChanged");this.tJ=h}$xc(){if(Ic.bO){var b=Ic.Pno,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.tJ.ovj,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",
["checkboxInitialValue"]:!0,["checkboxLabel"]:this.tJ.Wzj,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.tJ.FXj,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.tJ.HXj}});this.$Uj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.QAd,["defaultHeight"]:this.J6b,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.tJ.ybk,["heightLabel"]:this.tJ.OOi},["interactionOptions"]:h})}else super.$xc(),this.oNh(this.tJ.ybk,
"EmbedWidthInput",this.QAd),this.oNh(this.tJ.OOi,"EmbedHeightInput",this.J6b),this.tGb.appendChild(this.O9h("wdPrint",this.tJ.ovj)),this.tGb.appendChild(this.O9h("wdEmbedCode",this.tJ.Wzj)),this.rVk(this.tJ.FXj),this.MIa(),Ph.FocusManager.vM()&&(b=Ph.FocusManager.instance(),h=[document.getElementById(jb.xgh),document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(jb.E9g+jb.gyh),document.getElementById("wdPrint"+jb.zEc),document.getElementById("wdEmbedCode"+
jb.zEc),document.getElementById("wdStartOn"+jb.zEc),document.getElementById("wdStartOnText"),document.getElementById(xf.a.zwd),document.getElementById(jb.vAh)],h=new po(h),b.gu().Mk=h,X.a.Di?this.v4(document.getElementById(xf.a.zwd)):this.hZ.select())}dispose(){if(!Ic.bO){if(this.sGc){for(let b=0;b<this.sGc.length;++b)Nb.a.removeHandler(this.sGc[b],"change",this.uQe);this.sGc=this.uQe=null}this.ZId&&(Nb.a.removeHandler(this.rea.y$a,"change",this.ZId),this.ZId=null);this.sNd&&(this.Cr.xc(Cd.a.click,
this.rea.ktc,this.sNd),this.sNd=null);this.Jac&&(this.ne.xc(Cd.a.Ti,this.rea.ktc,this.Jac),this.ne.xc(Cd.a.oi,this.rea.ktc,this.Jac),this.Jac=null);this.rea=null}super.dispose()}oNh(b,h,n){const B=document.createElement("label");B.className="EmbedInputPrefix";B.innerText=b;this.RCb.appendChild(B);b=document.createElement("input");b.className=h;b.id=h;b.value=n.toString();b.type="text";b.setAttribute("data-lpignore","true");B.setAttribute("for",h);this.RCb.appendChild(b);this.sGc.push(b);Nb.a.addHandler(b,
"change",this.uQe);this.RCb.appendChild(document.createElement("br"))}aXn(b){"EmbedWidthInput"===b.target.id?this.QAd=this.J1d(b.target,375):this.J6b=this.J1d(b.target,250);this.XLg()}J1d(b,h){let n=parseInt(b.value);if(isNaN(n)||n<h)n=h;b.value=n.toString();return n}Q_n(b){b=this.J1d(b.target,1);1===this.rea.value&&this.fFe("wdStartOn",b.toString())}rVk(b){const h=document.createElement("div");h.className=jb.dyh+" EmbedInlineOption";h.id="wdStartOn"+jb.eyh;const n=this.Mj.createElement("div");n.tabIndex=
0;n.className=jb.Yah;n.id="wdStartOn"+jb.zEc;n.setAttribute(Bc.a.Ph,Bc.a.Fjf);n.setAttribute(Bc.a.AIa,Bc.a.PO);n.setAttribute(Bc.a.Kja,"wdStartOn"+jb.g6b);h.appendChild(n);h.setAttribute(Bc.a.Ph,Bc.a.BA);var B=Bb.createClusteredImage(16,16,jb.ebh,jb.dbh,!0,"");n.appendChild(B);B=B.childNodes[0];B.id="wdStartOn"+jb.fyh;B.className=Bb.getImageClass(jb.Tbf);const L=document.createElement("span");L.className=jb.g6b;L.innerText=b;L.id="wdStartOn"+jb.g6b;h.appendChild(L);this.tGb.appendChild(h);b=document.createElement("input");
b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.tJ.HXj;b.setAttribute("data-lpignore","true");this.tGb.appendChild(b);Nb.a.addHandler(b,"change",this.ZId);this.rea=new bc(h,B,n,0,b);this.fFe("wdStartOn","1");this.Cr.nb(Cd.a.click,h,this.sNd);this.ne.nb(Cd.a.Ti,h,this.Jac);this.ne.nb(Cd.a.oi,h,this.Jac)}Tbp(b){this.DXj(b);return!0}Ubp(b){return this.Qad(b,Object(z.a)(this,this.DXj,"startOnOptionHandler"))}DXj(){let b=1;this.rea.value?(this.rea.value=0,this.rea.o$a.className=
Bb.getImageClass(jb.Tbf),this.rea.dpe.setAttribute(Bc.a.AIa,Bc.a.PO)):(this.rea.value=1,this.rea.o$a.className=Bb.getImageClass(jb.cNe),b=this.J1d(this.rea.y$a,1),this.rea.dpe.setAttribute(Bc.a.AIa,Bc.a.hq));this.fFe("wdStartOn",b.toString())}static get bO(){return A.AFrameworkApplication.ua.Ib.cH}static Pno(b,h,n,B=null){if("wdPrint"===h||"wdEmbedCode"===h)return za.a.lp(b,h,n?"1":"0");if("wdStartOn"===h){let L="1";n&&B&&(B=parseInt(B),!isNaN(B)&&1<=B&&(L=B.toString()));return za.a.lp(b,h,n?L:"1")}return b}}
Object(u.a)(Ic,"WordEmbedDialog",jb,[]);class Uc{constructor(b,h,n,B,L){this.Hia=null;this.ga=b;this.Nib=h;this.US=n;this.tJ=B;this.fia=L}Wb(){this.ga.ra(this.US,id.a.frame,Object(z.a)(this,this.g6o,"showEmbedCode"));this.Nib.execute(Object(z.a)(this,this.Afg,"onHostPostmessengerCreated"))}Afg(b){x.ULS.shipAssertTag(4994850,332,!!b);this.Hia=b;A.AFrameworkApplication.Ola||(this.Hia.Aw(H.a.F_h),this.Hia.BD(H.a.F_h,Object(z.a)(this,this.$xc,"showEmbedDialog")))}$xc(b){b=b.Values.HostEmbeddedViewUrl.toString();
A.AFrameworkApplication.D6c=b;this.fia.tAf=b;(new Ic(b,this.tJ)).$xc()}g6o(b,h,n){if(2===n)if(A.AFrameworkApplication.D6c)(new Ic(this.fia.tAf,this.tJ)).$xc();else return A.AFrameworkApplication.wm.s$a(Uc.kfk),A.AFrameworkApplication.wNg&&this.Hia.sendMessage(H.a.e7l,null)?32:A.AFrameworkApplication.ua.UX(!0,A.AFrameworkApplication.rDf);return 32}}Uc.kfk=10381;Object(u.a)(Uc,"EmbedActor",null,[]);class kd{}Object(u.a)(kd,"WordEmbedDialogStrings",null,[]);var pd=d(245);class Fd extends Uc{constructor(b,
h){super(b,h,Dc.a.xDg,Object.assign(new kd,{ybk:WordEditorIntl.WordEditorStrings.l_Width,OOi:WordEditorIntl.WordEditorStrings.l_Height,ovj:WordEditorIntl.WordEditorStrings.l_PrintOption,Wzj:WordEditorIntl.WordEditorStrings.l_ReembedOption,FXj:WordEditorIntl.WordEditorStrings.l_StartOnOption,HXj:WordEditorIntl.WordEditorStrings.l_StartPage}),pd.WoncaApp.instance)}}Object(u.a)(Fd,"EmbedActor",Uc,[]);class le{constructor(){this.W=null}get name(){return"WordEditor.Embed"}wc(b){this.W=b;b.ia("WordEditor.Embed.EmbedActor",
()=>new Fd(A.AFrameworkApplication.va,b.Qa("Postmessage.IHostPostmessenger"))).ha()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").Wb()}dispose(){}}Object(u.a)(le,"EmbedPackage",null,[0,1]);class jf{constructor(b,h,n){this.nx=this.eRa=this.mTa=null;this.UQa=0;this.p8b=this.i8b=this.W7b=this.x8b=this.O2a=this.N2a=!1;this.Ck=b;this.eo=n}VR(b){return Ua.StaticActiveAppFrame.za().ib.isEditingAllowed?""!==this.u3c(b.Nf):!1}KN(b){if(!this.VR(b))return!1;this.VRo(b);this.WRo();this.XRo();this.mTa=
b.uK;this.nx=new Sys.UI.Point(0,0);x.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}VX(b){this.eRa=b.uK;this.ajl();this.Ck.K7j(this.nx.x,this.nx.y,this.x8b,this.W7b,this.i8b,this.p8b,!1);return!0}LF(){this.Ck.K7j(this.nx.x,this.nx.y,this.x8b,this.W7b,this.i8b,this.p8b,!0);x.ULS.sendTraceTag(22381024,322,50,"Image Crop drag succeeded")}E0(){this.Ck.Tll();x.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}WRo(){this.p8b=this.i8b=this.W7b=this.x8b=!1;switch(this.UQa){case 1:this.x8b=
!0;break;case 5:this.W7b=!0;break;case 3:this.p8b=!0;break;case 7:this.i8b=!0;break;case 0:this.i8b=this.x8b=!0;break;case 2:this.p8b=this.x8b=!0;break;case 6:this.i8b=this.W7b=!0;break;case 4:this.p8b=this.W7b=!0}}XRo(){this.O2a=this.N2a=!1;switch(this.UQa){case 0:this.O2a=this.N2a=!0;break;case 1:case 2:this.O2a=!0;break;case 7:case 6:this.N2a=!0}}u3c(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const n=
b[h].toString();if(n.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==n)return n}return""}VRo(b){switch(this.u3c(b.Nf)){case "WACImageCropHandleNW":this.UQa=0;break;case "WACImageCropHandleN":this.UQa=1;break;case "WACImageCropHandleNE":this.UQa=2;break;case "WACImageCropHandleE":this.UQa=3;break;case "WACImageCropHandleSE":this.UQa=4;break;case "WACImageCropHandleS":this.UQa=5;break;case "WACImageCropHandleSW":this.UQa=6;break;case "WACImageCropHandleW":this.UQa=7}}ajl(){var b=1;this.eo.instance&&
(b=this.eo.instance.Aj);const h=(this.eRa.x-this.mTa.x)/b;b=(this.eRa.y-this.mTa.y)/b;this.nx.x=this.N2a?-h:h;this.nx.y=this.O2a?-b:b}}Object(u.a)(jf,"ImageCropDragAdapter",null,[111]);class of{constructor(b,h){this.ga=b;this.eo=h}Evm(b){return new jf(b,this.ga,this.eo)}}Object(u.a)(of,"ImageCropDragAdapterFactory",null,[481]);var tf=d(316),Se=d(250),ye=d(43),Uf=d(432),sh=d(754),Tf=d(88),hf=d(67),zi=d(197),El=d(440),Yk=d(1056),lj=d(558),In=d(977),Gm=d(144),Wm=d(388),Ve=d(242),Yj=d(692),Zj=d(214),
pl=d(85),qh=d(18),Ok=d(272),Gp=d(842),cq=d(401),Ml=d(126);class $o{constructor(b,h,n,B,L,ba,la,La){this.k8c=null;this.pT=b;this.Oh=h;this.Pc=n;this.uv=B;this.Qd=L;this.hb=ba;this.Xn=la;this.tG=La}get l_(){return null!=this.iUg?this.iUg:this.iUg=Ya.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get Vb(){return null!=this.C7g?this.C7g:this.C7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get $i(){return Gm.PageReader.instance}jUo(b,h,n){const B=this.Pc.Mc(15);B.Ab(h.node);this.x_a(b,
n);B.dispose()}iUo(b,h,n){const B=this.Pc.Mc(15);B.Ab(h.node);this.I_b(b,n);B.dispose()}x_a(b,h){b.setValue(Hf.a.imageAltText,h)}I_b(b,h){b.setValue(Lc.a.f0,h)}qUo(b,h){b.setValue(Hf.a.csb,h)}lOj(b,h){if(Object(zi.d)(b)){const n=b.ja(ye.a.ame,null);h=Gp.a.kIl(h,n);b.setValue(ye.a.ame,h)}else b.setValue(Lc.a.g0,h)}mUo(b,h,n,B,L){let ba=0;var la=0;({width:ba,height:la}=Ad.ImageReader.o9a(b));la-=(h+n)/1E5*la;this.pOa(b,ba-(B+L)/1E5*ba);this.oOa(b,la);this.COj(b);b.setValue(Lc.a.e7c,h);b.setValue(Lc.a.b7c,
n);b.setValue(Lc.a.c7c,B);b.setValue(Lc.a.d7c,L)}pYo(b,h,n,B){const L=this.Pc.Mc(15);L.Ab(h.node);this.zxe(b,n,B);L.dispose()}zxe(b,h,n){this.pOa(b,h);this.oOa(b,n);this.COj(b);b.removeProperty(zd.a.Aqe);b.removeProperty(zd.a.zqe)}pOa(b,h){b.setValue(Hf.a.lma,h);b.setValue(zd.a.nLa,-1)}oOa(b,h){b.setValue(Hf.a.kma,h);b.setValue(zd.a.mLa,-1)}rH(b,h){b.setValue(Lc.a.mmc,h);b.setValue(Hf.a.Rh,h);b.setValue(Hf.a.sr,h)}dZo(b,h){b.setValue(Lc.a.Kzb,h)}XQo(b,h){b.setValue(Lc.a.KTd,h)}iZo(b){if(!Ad.ImageReader.M7(b)&&
b.Gl){var h=b.node;if(Ad.ImageReader.vba(h)){const L=this.Pc.Mc(15);L.Ab(b.node);b=ve.GraphIterator.eb(h);b.zb(12);b=b.parentNode;var n=b.properties.wf(Lc.a.Kq),B=h.properties.getValue(Lc.a.runId);h.ja(Lc.a.Yc,fk.a.DV);const ba=b.qa;if(!A.AFrameworkApplication.K||!A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveAnchoredProperties",!1)){const la=[Lc.a.mmc,Hf.a.Rh,Hf.a.sr,Lc.a.KTd,Lc.a.Kzb,Lc.a.TTa];Object(zi.d)(h)&&la.push(ye.a.L$d,ye.a.K$d);h.qg.apply(h,la)}n=this.PIf(B,
n,ba);B=Nd.a.Tc(b,n);this.uv.$7h(h,B);(h=this.tG.eN(b,n,n+1))&&this.hb.Ic(h);this.l_.Cva(b,n,n+1);L.dispose()}}}Yyg(b,h){if(b.properties.hasProperty(Lc.a.D6)){const n=b.properties.wf(Lc.a.D6);n.push(h);b.properties.setValue(Lc.a.D6,Array.clone(n))}else b.properties.setValue(Lc.a.D6,[h])}Jye(b,h,n=0,B=!1){if(b.Gl){var L=this.Pc.Mc(15),ba=b.node;L.Ab(ba);if(Ad.ImageReader.M7(b)){const Cb=Object(zi.c)()?new In.a:new lj.a;Cb.Bv(Ad.ImageReader.Qn(b));var la=ba.qa,La=this.V8l(b.cpBegin,la);this.M9k(b.cpEnd,
la,La)&&x.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");la=la.J(La).blob;La=la.oe;var fb=ba.properties.wf(Lc.a.Kq);fb=this.ono(fb);La=fb[La];fb=ba.ja(Lc.a.Yc,fk.a.DV);if(la=Object(ya.a)(Yk.ImageBlobObject,la))la.o0b=!1;this.Qd.Ne(b,"");la&&(la.o0b=!0);Cb.properties.setValue(Lc.a.runId,La);Cb.properties.setValue(Lc.a.Yc,fb);b=ve.GraphIterator.eb(ba);b.zb(12);b.Uf(Cb,6);this.Yyg(b.currentNode,Cb.anchor.node.id);ba=Cb}n&&this.rH(ba.properties,n);this.XQo(ba.properties,
B);this.dZo(ba.properties,h);this.l_.Ywc(ba);(h=this.tG.lr(ba))&&this.hb.Ic(h);L.dispose()}}bxg(b,h){if(!(0>=h)){var n=ri.a.em(h,0),B=Ad.ImageReader.XB(b),L=Ad.ImageReader.fD(b);B>n&&(L*=n/B,this.pOa(b,n),this.oOa(b,L),x.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",h))}}M9k(b,h,n){const B=h.length;if(n>=B||!h.J(n).kf)return!1;const L=new Vn.a;for(;n<B;n++){const ba=h.J(n);if(ba.cp>b||!ba.kf)break;for(let la=0;la<ba.kf.length;la++){if(L.contains(ba.kf.J(la).nk))return!0;
L.add(ba.kf.J(la).nk)}}return!1}ono(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var n=0;n<b.length;)b[n]=n+1,n++;else{var B=b[h];n=h-1;for(var L=B-1;0<=n;)b[n]=L,n--,L--;L=0;for(n=h+1;n<b.length;)(h=b[n])?h<B?(B=h+L,b[n]=B):B=h:(L+=2,B++,b[n]=B),n++}return b}bEf(b,h){let n=0;for(;n<h.length&&!(b<h[n]);)n++;return n}PIf(b,h,n){let B=0;const L=this.bEf(b,h);let ba=0;if(L===h.length)ba=n.length-1;else for(;ba<n.length;){h=n.J(ba);if(h.formatting&&h.formatting.oe===L)break;ba++}ba<n.length?
B=n.J(ba).cp:x.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:ba,["RunId"]:b,["CharacterPropertiesArrayLength"]:n.length});return B}V8l(b,h){let n=0;for(;n<h.length&&h.J(n).cp!==b;)n++;n===h.length&&x.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",{["Index"]:n,["CharacterPropertiesArrayLength"]:h.length});return n}COj(b){b.setValue(Hf.a.xCa,!0)}are(b,h,n,B=!1){h&&n?(h=Math.max(h,sh.a.vej),n=Math.max(n,sh.a.vej)):
n=h=sh.a.Fdi;b.setValue(Hf.a.lma,ri.a.em(h,0));b.setValue(Hf.a.kma,ri.a.em(n,1));b.setValue(Hf.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(lk.a.h0,fi.a.KPa);b.setValue(Lc.a.Tla,B)}qce(){return null}xhi(b,h,n){let B=null;h=({UVb:B}=this.yhi(b,h,n)).returnValue;B&&b.view.lb.Ic(B);return h}yhi(b,h,n){var B=null;if(!this.Vja(b))return{returnValue:null,UVb:B};var L=b.view;const ba=this.Pc.Mc(15,wb.a.lSb);ba.Ab(L.jd);h||(h=new Og.DictionaryPropertySet);h.setValue(zd.a.$Xl,!0);let la=
L.lb.Og;var La=new Yj.a;if(!re.SelectionEditor.mf(la)){if(2===A.AFrameworkApplication.va.Ob(wb.a.Wra,2))return ba.dispose(),{returnValue:null,UVb:B};la=L.lb.Og}else if(la.Gl&&ea.ParagraphReader.Xb(la.node)){we.StaticTheCoauthManager.ud().Jo&&we.StaticTheCoauthManager.ud().Ak.yG(la.node);L=Va.FormattingReader.Cs(la);if(!L)return ba.dispose(),{returnValue:null,UVb:B};L.cache.sD&&(L=L.Bf(null),$o.km.F8(L));La.formatting=L.Dk;La.languageId=Va.FormattingReader.language(L);La.uoa=this.Vb.Eq(la.node)}if(!la.Gl)return ba.dispose(),
{returnValue:null,UVb:B};if(!this.kWf(b.Hk,h))return ba.dispose(),this.k8c=null,{returnValue:null,UVb:B};b=this.k8c;this.k8c=null;1===b.location?(B=b.node,h=cq.a.instance.APf(B),Ga.OutlineElementNavigator.ht(h,!1,!1)||(Zj.OutlineNavigator.Fve(h),this.pT.Hja(h,!0,La)),Ga.OutlineElementNavigator.Le(h),xh.TableReader.isTable(h)&&(Object(Wb.a)(Ml.a,h)||Object(Wb.a)(Wm.a,h)?(La=new ve.GraphIterator,La.set(h.currentNode),qh.moveToCellContent(La,0,0),h.set(La.currentNode)):qh.moveToCellContent(h,0,0),xb.OutlineElementReader.Mh(h)?
Ga.OutlineElementNavigator.Le(h):h=cq.a.instance.APf(B)),B=ea.ParagraphReader.zu(h.currentNode)?this.tG.se(h.currentNode,0):this.tG.lr(h.currentNode)):b.location||(La=b.blob.Jb.cp+1,B=this.tG.eN(b.node,La-1,La));ba.sMa(n,1);ba.yi=wb.a.lSb;ba.dispose();return{returnValue:b,UVb:B}}kWf(){return!1}Vja(b){b.contextId===oc.a.view&&b.view.te&&b.view.lb&&(b=b.view.lb.Og);if(!b)return $o.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.oo}),!1;if($o.mg.Q2(b))return $o.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.HG}),!1;if($o.mg.Vla(b))return $o.Ec.$b(Tf.a.Te,
{["Reason"]:hf.a.dTi}),!1;if(this.Xn&&this.Xn.instance&&this.Xn.instance.DX(b))return $o.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.t8a}),!1;if(this.$i.I7)return $o.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.compatMode}),!1;if(b.Gl)return pl.OutlineReader.xfe(b)?($o.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.Rrf}),!1):Ad.ImageReader.pee(b)?($o.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.Jrf}),!1):Ok.c(b)?($o.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.Krf}),!1):Ve.a.eZf(b)?($o.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.Irf}),!1):ea.ParagraphReader.BX(b)||Ad.ImageReader.Idn(b)?
($o.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.WQ}),!1):!0;if(El.a.r_f(b)){let h=!0;for(let n=0;n<b.length;++n){const B=b.getContext(n);if(!B.Gl)return!1;h&&!ea.ParagraphReader.BX(B)&&(h=!1)}return h?($o.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.WQ}),!1):!0}return!1}Asg(b,h){const n=this.Pc.Mc(7);n.Ab(b);if(12===b.type){h=h.Jb.cp;var B=ea.ParagraphReader.textLength(b);B=Nd.a.bU(h,h+1,h+1===B?!0:!1,b);this.Qd.Ne(B,"");b=Nd.a.Tc(b,h);this.hb.Ic(Oe.SelectionFactory.Fo(b))}else this.Oh.YDa(b);n.dispose()}static get km(){return null!=
$o.XXg?$o.XXg:$o.XXg=Ya.a.instance.resolve("Box4.IFormattingEditor")}static get mg(){return Pd.a.instance}static get Ec(){return Yc.a.instance}}Object(u.a)($o,"ImageEditor",null,[479]);class dq{constructor(b,h,n,B=0){this.node=b;this.blob=h;this.location=n;this.uX=B}}Object(u.a)(dq,"InsertPictureResult",null,[]);var Eo=d(894),ap=d(306),Fs=d(605),nn=d(115),hs=d(544),Zq;(function(b){b[b.other=0]="other";b[b.ptj=1]="picture"})(Zq||(Zq={}));Object(u.b)("ImageType",Zq);var $k=d(1263);class Du extends $o{constructor(b,
h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc){var Nc,dd;super(b,h,n,B,L,ba,la,La);this.zsk="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");this.yhb="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");
this.CM=this.LRa=this.iGa=null;this.Toa=Array(8);this.EDd=this.HGa=null;this.MRa=!1;this.DDd=this.UVe=null;this.kzd=this.vAd=!1;this.fW=this.eW=this.dW=this.gW=this.cZ=this.bZ=this.aZ=this.dZ=this.yZ=this.zZ=0;this.BP=()=>{this.MRa&&this.RAf()};this.hDa=Hd=>{this.MRa&&Hd.Kb.keyCode!==Jd.a.Mu&&this.RAf(!0);return!1};this.rmh=tc;ba.Cw(this.BP);this.ne=$b;this.G5=tf.a.instance;this.ga=A.AFrameworkApplication.va;this.Wd=Cb;this.hr=fb;this.uXf=null!==(dd=null===(Nc=A.AFrameworkApplication.K)||void 0===
Nc?void 0:Nc.getBooleanFeatureGate("Microsoft.Office.WordOnline.AppendSpacersToDataUrlForSafari",!1))&&void 0!==dd?dd:!1}Qxe(b,h,n,B,L){b.hasProperty(zd.a.lYa)&&b.removeProperty(zd.a.lYa);const ba=Array(4);ba[nn.a.left]=h;ba[nn.a.right]=n;ba[nn.a.top]=B;ba[nn.a.bottom]=L;b.setValue(Lc.a.Xga,ba)}ayo(b){b.setValue(Lc.a.pLa,hs.a.ycg);b.setValue(Lc.a.CXb,"");this.Qxe(b,0,0,0,0)}Tzg(b,h,n,B,L){b.setValue(Lc.a.e7c,h);b.setValue(Lc.a.b7c,n);b.setValue(Lc.a.c7c,B);b.setValue(Lc.a.d7c,L)}Sxe(b,h,n,B){b.setValue(Lc.a.vX,
h);b.setValue(Lc.a.zSf,n);b.setValue(Lc.a.VSf,B);b.setValue(zd.a.vX,-1)}oce(b,h){b=b.node;const n=ve.GraphIterator.eb(b);if(ea.ParagraphReader.Xb(b)&&ea.ParagraphReader.isEmpty(n)){var B=b.properties.wf(Lc.a.Yc);h.setValue(Lc.a.Yc,B);h.setValue(Lc.a.runId,1);B=new $k.a;h&&B.Bv(h);n.Uf(B,6);this.Yyg(b,B.anchor.node.id);this.l_.Ywc(B);return new dq(B,null,3)}return null}qce(b,h){var n=Eo.a.instance.Nvd;h&&n.Bv(h);n.setValue(Lc.a.imageType,Zq.ptj);let B=0;B=Se.a.VF();n.setValue(Lc.a.uX,B);const L=b.node.Lc.ou(n,
n.id);n=this.Qd.Gla(b,ba=>new Yk.ImageBlobObject(ba,L));ap.GraphTransactionManager.instance.ifg(b.node);if(this.Wd.Mg){const ba=new Sd.GraphTransaction(15);ba.Ab(b.node);this.hr.Hna(b.node,b.cpBegin,b.cpBegin+1,1,null);ba.dispose()}this.l_.kUa&&!h.ja(Lc.a.Tla,!1)&&this.l_.Cva(b.node,b.cpBegin,b.cpBegin+1);return new dq(b.node,n,0,B)}kWf(b,h){if(!this.Vja(b))return!1;const n=this.Pc.Mc(7);n.Ab(b.node);A.AFrameworkApplication.K.$("ContentAppIsEnabled")&&h.ja(Lc.a.tVi,!1)?this.k8c=this.oce(b,h):this.k8c=
this.qce(b,h);n.dispose();return!0}ovc(b,h,n,B){if(!n.Xb(b))return!1;n=this.Pc.Mc(7,wb.a.tTm);n.Ab(b);var L=b.properties.ja(Hf.a.zn,[]);L.push(0);for(const ba of L)if((L=B.zHf(b,ba))&&5===L.Jh&&L.id.equals(h))return this.Qd.Ne(Nd.a.createTextRange(b,ba,ba+1),""),n.dispose(),!0;n.dispose();x.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}oxo(b,h,n,B){if(!Ad.ImageReader.vba(b))return!1;h.set(b);h.zb(12);const L=h.yp(12);if(!L)return x.ULS.sendTraceTag(588817114,
3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(n.o$c(L))return x.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),!1;B(b);n=this.Pc.Mc(7);n.Ab(b);h.eh();n.dispose();return!0}nDo(b,h,n,B){return Ad.ImageReader.M$a(b)?this.aDo(b,n):Ad.ImageReader.M7(b)?this.qDo(b,h,n,B):null}qDo(b,h,n,B){const L=Eo.a.instance.Nvd;n&&L.Bv(n);n=0;n=Se.a.VF();L.setValue(Lc.a.uX,n);
n=b.node.Lc;b=b.node;B=B.g2c(b,5);for(const ba of B)if(ba.id.equals(h)){this.Qd.Ne(Nd.a.createTextRange(b,ba.Jb.cp,ba.Jb.cp+1),"");const la=n.ou(L,L.id);h=Nd.a.Tc(b,ba.Jb.cp);this.Qd.Gla(h,La=>new Yk.ImageBlobObject(La,la));return L}return null}aDo(b,h){if(!Ad.ImageReader.M$a(b))return null;h.setValue(Lc.a.uX,Se.a.VF());b=b.node;var n=b.anchor.node.id;b=ve.GraphIterator.eb(b);b.zb(12);const B=b.parentNode;let L;B.properties.hasProperty(Lc.a.D6)?(L=B.properties.wf(Lc.a.D6),n=S.a.indexOf(L,n),-1!==
n&&Array.removeAt(L,n)):L=[];B.properties.setValue(Lc.a.D6,Array.clone(L));b.eh();n=Object(zi.c)()?new In.a:new lj.a;n.Bv(h);b.Uf(n,6);this.Yyg(B,n.anchor.node.id);return n}esd(b,h){this.MRa?this.RAf():this.xbp(b,h)}sUo(b,h){b.setValue(zd.a.vX,h)}Ivm(b){let h=null,n=null;if(!b)return x.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:h,Ej:n};if(!Object(Pb.a)().zd)return x.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),
{returnValue:null,view:h,Ej:n};const B=b.node;if(!B)return x.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),{returnValue:null,view:h,Ej:n};n=B.Lc;var L=Object(Pb.a)().zd.oc;L=B.ue(L);if(!L)return x.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:h,Ej:n};h=L.uh;if(b.Gl&&Ad.ImageReader.M7(b)){b=Ad.ImageReader.MKa(b);if(!b)return x.ULS.sendTraceTag(22381057,
322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:h,Ej:n};b=b.Tsa(h,L);if(!b)return x.ULS.sendTraceTag(22381058,322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:h,Ej:n};b=b.element}else if(Ad.ImageReader.Lt(B))b=L.htmlElement;else return x.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),
{returnValue:null,view:h,Ej:n};return{returnValue:b,view:h,Ej:n}}H_o(b){for(let B=0;B<this.Toa.length;B++){this.Toa[B]=b.ml(Tm.a.span);this.Toa[B].className="WACImageCropHandles "+this.zsk[B];if(2>=B){var h=b.ml(Tm.a.span);h.className=this.yhb[0];var n=b.ml(Tm.a.span);n.className=this.yhb[1];this.Toa[B].appendChild(h);this.Toa[B].appendChild(n)}else 4<B&&(h=b.ml(Tm.a.span),h.className=this.yhb[2],n=b.ml(Tm.a.span),n.className=this.yhb[3],this.Toa[B].appendChild(h),this.Toa[B].appendChild(n));if(!B||
3===B||5===B)h=b.ml(Tm.a.span),h.className=this.yhb[4],n=b.ml(Tm.a.span),n.className=this.yhb[5],this.Toa[B].appendChild(h),this.Toa[B].appendChild(n);else if(2===B||4===B||7===B)h=b.ml(Tm.a.span),h.className=this.yhb[6],n=b.ml(Tm.a.span),n.className=this.yhb[7],this.Toa[B].appendChild(h),this.Toa[B].appendChild(n)}}xbp(b,h){x.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.MRa)x.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var n=
null,B=null;if((this.HGa=({view:n,Ej:B}=this.Ivm(h)).returnValue)&&n){this.HGa.classList.add("ImageCropMode");this.iGa=n.ml(Tm.a.div);this.iGa.className="WACImageCropMode";this.LRa=n.ml(Tm.a.lsb);this.LRa.className="WACImageCropBase";this.CM=n.ml(Tm.a.span);this.CM.className="WACImageCropSrcRect";this.H_o(n);this.iGa.appendChild(this.CM);for(n=0;n<this.Toa.length;n++)this.CM.appendChild(this.Toa[n]);this.iGa.appendChild(this.LRa);this.LRa.style.visibility="";this.LRa.style.display="";this.HGa.appendChild(this.iGa);
this.Vco(b);B=Ad.ImageReader.uBa(b,B);n=Ad.ImageReader.q9(b,zd.a.q8,null);this.LRa.src=n?this.uXf&&X.a.Uta?Object(Fs.a)(n):n:Ad.ImageReader.q9a(B);this.rmh&&this.rmh.execute(L=>{this.EDd||(this.EDd=L.Evm(this))});this.vAd||(this.G5.pS(this.HGa,this.EDd),this.vAd=!0);this.ne&&this.ne.nb(Cd.a.gL,Object(Pb.a)().Ke.editingElement,this.hDa);this.MRa=!0;this.UVe=b;this.DDd=h;this.kzd=!1;b=new Sd.GraphTransaction(4);b.Ab(this.DDd.node);this.UVe.setValue(zd.a.rCa,this.MRa);b.dispose()}else x.ULS.sendTraceTag(22381062,
322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}Vco(b){const h=ri.a.nf(Ad.ImageReader.XB(b),0),n=ri.a.nf(Ad.ImageReader.fD(b),1);var B=Ad.ImageReader.Gfa(b);const L=Math.max(B.top,0),ba=Math.max(B.bottom,0),la=Math.max(B.left,0);B=Math.max(B.right,0);this.zZ=1E5*h/(1E5-(la+B));this.yZ=1E5*n/(1E5-(L+ba));this.dZ=Math.floor(L*this.yZ/1E5);this.aZ=Math.floor(ba*this.yZ/1E5);this.bZ=Math.floor(la*this.zZ/1E5);this.cZ=Math.floor(B*this.zZ/1E5);
this.CM.style.top=this.dZ+"px";this.CM.style.bottom=this.aZ+"px";this.CM.style.left=this.bZ+"px";this.CM.style.right=this.cZ+"px";this.LRa.style.width=this.zZ+"px";this.LRa.style.height=this.yZ+"px";Ad.ImageReader.aA(b)&&(this.iGa.style.width=this.zZ+"px",this.iGa.style.height=this.yZ+"px");this.gW=this.dZ;this.dW=this.aZ;this.eW=this.bZ;this.fW=this.cZ}RAf(b=!1){x.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.MRa?(b||this.Nwl(),this.LRa?Lh.a.rF(this.LRa):x.ULS.sendTraceTag(23961793,
322,15,"Unable to clear imageCropBase dom element because it was already null."),this.HGa?(this.iGa?this.iGa.parentNode===this.HGa?this.HGa.removeChild(this.iGa):x.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):x.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.HGa.classList.remove("ImageCropMode"),this.MRa=!1,b=new Sd.GraphTransaction(4),b.Ab(this.DDd.node),
this.UVe.setValue(zd.a.rCa,this.MRa),b.dispose(),this.vAd&&(this.G5.IS(this.HGa,this.EDd),this.vAd=!1),this.ne&&this.ne.xc(Cd.a.gL,Object(Pb.a)().Ke.editingElement,this.hDa),this.HGa=this.iGa=null):x.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):x.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}K7j(b,h,n,B,L,ba,la){if(n){n=Math.max(this.dZ-h,0);const La=Math.floor(this.yZ)-
this.aZ-n;5<=La?(this.gW=n,this.dW=this.aZ):5>La&&0<=La||0>La&&!this.aZ?(this.gW=n-(5-La),this.dW=this.aZ):0>La&&5>=Math.abs(La)?(this.gW=Math.floor(this.yZ)-this.aZ,this.dW=Math.max(this.aZ-(n-(this.yZ-this.aZ))-(5-Math.abs(La)),0)):(this.gW=Math.floor(this.yZ)-this.aZ,this.dW=Math.max(this.aZ-(n-(this.yZ-this.aZ)),0));this.CM.style.top=this.gW+"px";this.CM.style.bottom=this.dW+"px";la&&(this.dZ=this.gW,this.aZ=this.dW)}B&&(h=Math.max(this.aZ-h,0),B=Math.floor(this.yZ)-this.dZ-h,5<=B?(this.dW=h,
this.gW=this.dZ):5>B&&0<=B||0>B&&!this.dZ?(this.dW=h-(5-B),this.gW=this.dZ):0>B&&5>=Math.abs(B)?(this.dW=Math.floor(this.yZ)-this.dZ,this.gW=Math.max(this.dZ-(h-(this.yZ-this.dZ))-(5-Math.abs(B)),0)):(this.dW=Math.floor(this.yZ)-this.dZ,this.gW=Math.max(this.dZ-(h-(this.yZ-this.dZ)),0)),this.CM.style.top=this.gW+"px",this.CM.style.bottom=this.dW+"px",la&&(this.dZ=this.gW,this.aZ=this.dW));L&&(L=Math.max(this.bZ-b,0),h=Math.floor(this.zZ)-this.cZ-L,5<=h?(this.eW=L,this.fW=this.cZ):5>h&&0<=h||0>h&&
!this.cZ?(this.eW=L-(5-h),this.fW=this.cZ):0>h&&5>=Math.abs(h)?(this.eW=Math.floor(this.zZ)-this.cZ,this.fW=Math.max(this.cZ-(L-(this.zZ-this.cZ))-(5-Math.abs(h)),0)):(this.eW=Math.floor(this.zZ)-this.cZ,this.fW=Math.max(this.cZ-(L-(this.zZ-this.cZ)),0)),this.CM.style.left=this.eW+"px",this.CM.style.right=this.fW+"px",la&&(this.bZ=this.eW,this.cZ=this.fW));ba&&(b=Math.max(this.cZ-b,0),ba=Math.floor(this.zZ)-this.bZ-b,5<=ba?(this.fW=b,this.eW=this.bZ):5>ba&&0<=ba||0>ba&&!this.bZ?(this.fW=b-(5-ba),
this.eW=this.bZ):0>ba&&5>=Math.abs(ba)?(this.fW=Math.floor(this.zZ)-this.bZ,this.eW=Math.max(this.bZ-(b-(this.zZ-this.bZ))-(5-Math.abs(ba)),0)):(this.fW=Math.floor(this.zZ)-this.bZ,this.eW=Math.max(this.bZ-(b-(this.zZ-this.bZ)),0)),this.CM.style.left=this.eW+"px",this.CM.style.right=this.fW+"px",la&&(this.bZ=this.eW,this.cZ=this.fW));la&&(this.kzd=!0,Ua.StaticActiveAppFrame.za().Ie())}Tll(){this.gW=this.dZ;this.dW=this.aZ;this.eW=this.bZ;this.fW=this.cZ;this.CM.style.top=this.gW+"px";this.CM.style.bottom=
this.dW+"px";this.CM.style.left=this.eW+"px";this.CM.style.right=this.fW+"px"}Nwl(){if(this.kzd){x.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");var b=Math.floor(1E5*this.dZ/this.yZ),h=Math.floor(1E5*this.aZ/this.yZ),n=Math.floor(1E5*this.bZ/this.zZ),B=Math.floor(1E5*this.cZ/this.zZ),L=new Og.DictionaryPropertySet;L.setValue(zd.a.ksb,b);L.setValue(zd.a.hsb,h);L.setValue(zd.a.isb,n);L.setValue(zd.a.jsb,B);this.ga.lg(this.DDd,Dc.a.tQi,2,!1,null,L)}else x.ULS.sendTraceTag(23070481,
322,50,"No New Cropping Properties To Commit.")}rCa(){return this.MRa}oom(){return{top:this.gW,bottom:this.dW,left:this.eW,right:this.fW}}Pwp(b,h){if(0>b)x.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.dZ=this.gW=Math.min(Math.floor(this.yZ)-this.dW-5,b);this.CM.style.top=this.gW+"px";break;case 1:this.aZ=this.dW=Math.min(Math.floor(this.yZ)-this.gW-5,b);this.CM.style.bottom=this.dW+"px";break;case 2:this.bZ=this.eW=Math.min(Math.floor(this.zZ)-
this.fW-5,b);this.CM.style.left=this.eW+"px";break;case 3:this.cZ=this.fW=Math.min(Math.floor(this.zZ)-this.eW-5,b),this.CM.style.right=this.fW+"px"}this.kzd=!0}}}Object(u.a)(Du,"ImageEditor",$o,[478,479]);class Gt{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}wc(b){this.W=b;this.W.ia("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new of(A.AFrameworkApplication.va,Ya.a.instance.Qa("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").ha();this.W.ia("WordEditor.ImageEditors.ImageEditor",
()=>new Du(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Qa("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),
bb.KeyInputManager.instance,b.Qa("WordEditor.IImageCropDragAdapterFactory"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").ha()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){M.a.instance.Jc(new Gt)}}Object(u.a)(Gt,"WordEditorImageEditorsPackage",null,[0,1]);class ot{}Object(u.a)(ot,"FolderContentEditor",null,[1628]);class is{}Object(u.a)(is,"PageEditor",null,[1775]);class $u extends is{constructor(){super()}}Object(u.a)($u,"PageEditor",is,
[]);class Eu{get name(){return"WordEditor.NotebookLevelEditors"}wc(b){b.ia("Box4.NotebookLevelEditors.FolderContentEditor",()=>new ot).as("Box4.Folder.IFolderContentEditor").ha();b.ia("WordEditor.NotebookLevelEditors.PageEditor",()=>new $u).as("Box4.Pages.IPageEditor").ha()}init(){}dispose(){}static main(){M.a.instance.Jc(new Eu)}}Object(u.a)(Eu,"WordEditorNotebookLevelEditorsPackage",null,[0,1]);class Or{get ZXb(){return A.AFrameworkApplication.privacyUrl}Lza(){x.ULS.sendTraceTag(37034014,342,50,
"User clicked on the Privacy statement.");$c.a.yn(this.ZXb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(u.a)(Or,"PrivacyLinkHandler",null,[107]);class js{constructor(b,h){this.E2e=null;this.BMk=b;this.AMk=h}showDialog(b){this.E2e=b;this.AMk.create().pi(Object(z.a)(this,this.YUm,"handleDialog"))}YUm(b){1===b&&this.BMk.PLj();this.E2e();this.E2e.prototype}}Object(u.a)(js,"SendUsYourFileController",null,[82]);class Zk extends ui.StandardDialog{constructor(b,h,n){super();this.o$b=
null;this.Pg=b;this.YNc=h;this.tJ=n}pi(b){this.Gd=1;this.Pe(1,this.tJ.send);this.Pe(0,this.tJ.HQn);x.ULS.shipAssertTag(37034013,342,!this.o$b,"privacy anchor should be null before initializing it.");const h=this.dialogContent();this.Qub(this.tJ.r6k,null,"CancelRequest_32x32x32",null,b,h);this.L8(this.Sj(Zk.XLj))}dialogContent(){const b=document.createElement("span");b.innerText=this.tJ.igo;const h=document.createElement("span");h.innerText=this.tJ.eip;h.style.fontWeight=this.tJ.gCp;const n=document.createElement("span");
n.innerText=this.tJ.BPo;const B=this.Ryl(),L=document.createElement("span");L.id=this.Sj(Zk.XLj);L.appendChild(b);L.appendChild(document.createElement("br"));L.appendChild(document.createElement("br"));L.appendChild(h);L.appendChild(document.createElement("br"));L.appendChild(n);L.appendChild(document.createElement("br"));L.appendChild(document.createElement("br"));L.appendChild(document.createElement("br"));L.appendChild(B);return L}Ryl(){const b=document.createElement("span"),h=document.createElement("a");
h.innerText=this.tJ.Rfo;h.href=this.YNc.ZXb||"";b.appendChild(h);this.o$b=h;this.Pg.nb(Cd.a.click,this.o$b,Object(z.a)(this.YNc,this.YNc.Lza,"clickHandler"));return b}dispose(){this.o$b&&(this.Pg.xc(Cd.a.click,this.o$b,Object(z.a)(this.YNc,this.YNc.Lza,"clickHandler")),this.o$b=null);super.dispose()}}Zk.XLj="sendUsYourFileId";Object(u.a)(Zk,"SendUsYourFileDialog",ui.StandardDialog,[108]);class nh{create(){return Ya.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(u.a)(nh,
"Factory",null,[106]);var Ys=d(540);class Ii extends Ys.a{constructor(){super();this.FileId=null}lm(){return 38}static construct(b){const h=new Ii;h.FileId=b;return h}}Object(u.a)(Ii,"CreateSendUsYourFileRequest",Ys.a,[]);var Dm=d(906);class tl{constructor(b,h,n){this.q1=b;this.gT=h;this.aEk=n}PLj(b=!1){if(this.gT){const h=Ii.construct(this.gT()),n=new Dm.a;n.ar=h;n.status=1;n.GE="BootErrorReport";b=b?this.q1(null):this.q1(B=>{this.Xld(n,B)});b.CG(n);b.w_();this.aEk()}}Xld(b){5===b.statusCode&&this.PLj(!0)}}
Object(u.a)(tl,"SendUsYourFileManager",null,[81]);class ur{constructor(b,h){this.W=null;this.tJ=b;this.gT=h}wc(b){this.W=b;this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.tJ).ha();this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new Zk(Ef.a.instance,new Or,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new tl(h=>this.Yaa(0,h),this.gT,()=>{x.ULS.sendTraceTag(42022664,
342,50,"send us your file request is now sent.")}));this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const h=new nh;return new js(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),h)}).ha()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(u.a)(ur,"SendUsYourFilePackageManager",null,[]);var tq=d(555),wy=d(1117);class aj{get r6k(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get HQn(){return CommonUIStrings.l_NoThanks}get igo(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get eip(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get gCp(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get BPo(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get Rfo(){return CommonUIStrings.l_PrivacyStatement}}
Object(u.a)(aj,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class hm extends ur{constructor(){super(new aj,()=>A.AFrameworkApplication.rootQuerySignature)}Yaa(b,h){return new wy.a(b,h,"SendUsYourFile.ashx",ed.a.word,$e.App.webServiceBase,tq.a.Aq,tq.a.Zld,tq.a.Ild)}get name(){return"WordEditor.SendUsYourFile"}static main(){M.a.instance.Jc(new hm)}}Object(u.a)(hm,"PackageManager",ur,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);
var Vl=d(590),fl=d(683),Lq=d(1963),Hm=d(130),Ng=d(27),Xm=d(169),Nl=d(86),tp=d(1128),vi=d(181);class ko{constructor(){this.color=0;this.weight=vi.a.vlf;this.style=vi.a.UKb}}Object(u.a)(ko,"BorderPropertyValue",null,[]);class ks{constructor(b,h,n,B,L,ba){this.T4d=b;this.gallerySectionId=h;this.QCf=n;this.Qhf=B;this.commandId=L;this.queryCommandId=ba}}Object(u.a)(ks,"BorderStyleMenuPropsArguments",null,[]);class Qp{constructor(b,h,n,B,L,ba,la){this.s6a=b;this.Qqd=h;this.width=n;this.Ded=B;this.height=
L;this.Hbd=ba;this.altText=la}}Object(u.a)(Qp,"TableBorderStyleProperties",null,[]);class Xg{constructor(){this.WTd=[new Qp(Xg.Xyb,"","2",1,8,0,"Solid Line"),new Qp(Xg.eNb,"5,3","1",1,8,0,"Dashed Line"),new Qp(Xg.FNb,"1,1","1",1,8,0,"Dotted Line"),new Qp(Xg.HNb,"","1",2,8,3,"Double Line")];this.XTd=[new Qp(Xg.NKb,"","1",1,8,0,"0.25pt"),new Qp(Xg.MKb,"","1",1,8,0,"0.5pt"),new Qp(Xg.QKb,"","2",1,8,0,"0.75pt"),new Qp(Xg.Nmb,"","2",1,8,0,"1pt"),new Qp(Xg.LKb,"","3",1,8,0,"1.5pt"),new Qp(Xg.RKb,"","4",
1,8,0,"2.25pt"),new Qp(Xg.PKb,"","4",1,8,0,"3pt"),new Qp(Xg.KKb,"","5",1,8,0,"4.5pt"),new Qp(Xg.OKb,"","6",1,8,0,"6pt")]}initialize(){this.lkd()}tGf(){const b=new ks("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.WTd,wb.a.leb,wb.a.spg);return this.pjc(b)}uGf(){const b=new ks("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",this.XTd,wb.a.meb,wb.a.tpg);return this.pjc(b)}tui(b){switch(b){case Xg.Xyb:return vi.a.UKb;case Xg.eNb:return vi.a.Omb;
case Xg.FNb:return vi.a.jUc;case Xg.HNb:return vi.a.J6;default:return vi.a.Cza}}uui(b){switch(b){case Xg.NKb:return vi.a.hUc;case Xg.MKb:return vi.a.vlf;case Xg.QKb:return vi.a.q6a;case Xg.Nmb:return vi.a.fra;case Xg.LKb:return vi.a.maa;case Xg.RKb:return vi.a.Qja;case Xg.PKb:return vi.a.I6;case Xg.KKb:return vi.a.Bza;case Xg.OKb:return vi.a.Pja;default:return vi.a.TH}}pjc(b){const h=new vh.a,n=new te.a,B=Object.assign(new fl.a,{Id:b.T4d,ExternalId:b.gallerySectionId,ExternalGalleryId:b.QCf,Type:4,
Width:1,GalleryItems:[]});for(const ba of b.Qhf){var L={};const la={};la.width=Xg.Tyn;la.height=Xg.Syn;L.root=la;L=Object.assign(new Lq.a,{Id:ba.s6a,ExternalId:String.format("{0}_GalleryButton",ba.s6a),Icon:ba.s6a,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:ba.s6a,FullIconStyle:L,ShouldSetTitle:"true",Alt:ba.altText});B.GalleryItems.push(L)}n.ControlList=[];h.MenuSectionList=[];n.ControlList.push(B);h.MenuSectionList.push(n);h.UpdateDynamically=!0;return h}lkd(){const b=
{};for(const h of this.WTd)b[h.s6a]=appChrome.buildBorderStyleIcon(h.Qqd,h.width,h.Ded,h.height,h.Hbd);for(const h of this.XTd)b[h.s6a]=appChrome.buildBorderStyleIcon(h.Qqd,h.width,h.Ded,h.height,h.Hbd);appChrome.api.registerIconProvider(()=>b)}hRo(b,h,n){if(!b)return x.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==oc.a.H4)return x.ULS.sendTraceTag(577910617,306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),
!1;switch(b.border){case 2:this.y4(Hm.a.hX(b),b.node,5,n,h);break;case 0:this.y4(Hm.a.hX(b),b.node,3,n,h);break;case 1:this.y4(Hm.a.hX(b),b.node,4,n,h);break;case 3:this.y4(Hm.a.hX(b),b.node,0,n,h);break;case 7:this.y4(Hm.a.hX(b),b.node,1,n,h);break;case 8:this.y4(Hm.a.hX(b),b.node,2,n,h);break;case 6:this.y4(Hm.a.hX(b),b.node,1,n,h);this.y4(Hm.a.hX(b),b.node,2,n,h);break;case 5:this.y4(Hm.a.hX(b),b.node,3,n,h);this.y4(Hm.a.hX(b),b.node,5,n,h);this.y4(Hm.a.hX(b),b.node,4,n,h);this.y4(Hm.a.hX(b),b.node,
0,n,h);break;case 4:this.y4(Hm.a.hX(b),b.node,3,n,h),this.y4(Hm.a.hX(b),b.node,5,n,h),this.y4(Hm.a.hX(b),b.node,4,n,h),this.y4(Hm.a.hX(b),b.node,0,n,h),this.y4(Hm.a.hX(b),b.node,1,n,h),this.y4(Hm.a.hX(b),b.node,2,n,h)}return!0}gzg(b,h,n,B){if(!h)return x.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==oc.a.b1)return x.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",h.contextId),!1;var L=h.node;
const ba=new ve.GraphIterator;ba.set(L);ba.zb(14);L=Ng.TableCellReader.NVa(ba);switch(h.border){case 2:this.t_a(b,h.node,5,B,n,L);this.iye(h.node,5,n);this.ixe(b,h.Q8a(),3,n,B,L);break;case 0:this.t_a(b,h.node,3,B,n,L);this.iye(h.node,3,n);this.ixe(b,h.Q8a(),1,n,B,L);break;case 1:this.t_a(b,h.node,4,B,n,L);this.iye(h.node,4,n);this.ixe(b,h.Q8a(),0,n,B,L);break;case 3:this.t_a(b,h.node,0,B,n,L),this.iye(h.node,0,n),this.ixe(b,h.Q8a(),2,n,B,L)}return!0}alo(b,h){if(re.SelectionEditor.jad(b)&&h)switch(b=
Object(ya.a)(Xm.TableNodeBorderContext,b),b.border){case 2:this.GR(b.node,Xg.Gp.mP(5),h);break;case 0:this.GR(b.node,Xg.Gp.mP(3),h);break;case 3:this.GR(b.node,Xg.Gp.mP(0),h);break;case 1:this.GR(b.node,Xg.Gp.mP(4),h);break;case 7:this.GR(b.node,Xg.Gp.mP(1),h);break;case 8:this.GR(b.node,Xg.Gp.mP(2),h);break;case 5:h=this.GR(b.node,Xg.Gp.mP(5),h);h=this.GR(b.node,Xg.Gp.mP(3),h);h=this.GR(b.node,Xg.Gp.mP(0),h);this.GR(b.node,Xg.Gp.mP(4),h);break;case 6:h=this.GR(b.node,Xg.Gp.mP(1),h);this.GR(b.node,
Xg.Gp.mP(2),h);break;case 4:h=this.GR(b.node,Xg.Gp.mP(5),h),h=this.GR(b.node,Xg.Gp.mP(3),h),h=this.GR(b.node,Xg.Gp.mP(0),h),h=this.GR(b.node,Xg.Gp.mP(4),h),h=this.GR(b.node,Xg.Gp.mP(1),h),this.GR(b.node,Xg.Gp.mP(2),h)}}yjo(b,h){if(re.SelectionEditor.kad(b)&&h)switch(b=Object(ya.a)(Xm.TableNodeBorderContext,b),b.border){case 2:this.GR(b.node,Xg.Gp.zR(5),h);break;case 0:this.GR(b.node,Xg.Gp.zR(3),h);break;case 3:this.GR(b.node,Xg.Gp.zR(0),h);break;case 1:this.GR(b.node,Xg.Gp.zR(4),h)}}GHf(b,h,n){n=
null;if(!b)return x.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),n;b.properties.hasProperty(h.size)&&(n=new ko,n.weight=b.properties.ja(h.size,vi.a.TH),n.style=b.properties.ja(h.style,vi.a.Cza),n.color=b.properties.ja(h.color,0));return n}fzg(b,h,n){b?n?(b.properties.setValue(h.size,n.weight),b.properties.setValue(h.style,n.style),b.properties.setValue(h.color,n.color)):x.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):x.ULS.sendTraceTag(575980877,306,
15,"Node should not be null")}pZb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),b.properties.removeProperty(h.color)):x.ULS.sendTraceTag(575980879,306,15,"Node should not be null")}y4(b,h,n,B,L){L=this.$zp(b,h,n,B,L);this.Twc(h,Xg.Gp.mP(n),L);switch(n){case 5:this.gxb(h,2,B,L);break;case 4:this.gxb(h,1,B,L);break;case 0:this.gxb(h,3,B,L);break;case 3:this.gxb(h,0,B,L);break;case 1:this.gxb(h,7,B,L);break;case 2:this.gxb(h,8,B,L)}}$zp(b,h,n,B,L){if(3!==B){var ba=
Xg.Zg.A6d(b,h,n,3);void 0!==ba&&null!==ba&&ba!==vi.a.E2&&(ba=Nl.a.$vc(ba),L.color=Xg.bPa.sra(h,ba))}1!==B&&(ba=Xg.Zg.A6d(b,h,n,1),void 0!==ba&&null!==ba&&ba!==vi.a.RH&&(L.weight=parseFloat(ba)*vi.a.iUc));2!==B&&(b=Xg.Zg.A6d(b,h,n,2),void 0!==b&&null!==b&&b!==vi.a.RH&&(L.style=b));return L}t_a(b,h,n,B,L,ba){B&&(L=this.uup(b,h,ba,n,B,L));this.Twc(h,Xg.Gp.zR(n),L)}uup(b,h,n,B,L,ba){if(3!==L){var la="",La=Xg.Zg.FPb(b,h,B,!1,!0,n,3);La&&(la=La.TKb);void 0!==la&&null!==la&&la!==vi.a.E2&&(la=Nl.a.$vc(la),
ba.color=Xg.bPa.sra(h,la))}if(1!==L){la="";if(La=Xg.Zg.FPb(b,h,B,!1,!0,n,1))la=La.TKb;void 0!==la&&null!==la&&la!==vi.a.RH&&(ba.weight=parseFloat(la)*vi.a.iUc)}if(2!==L){L="";if(b=Xg.Zg.FPb(b,h,B,!1,!0,n,2))L=b.TKb;void 0!==L&&null!==L&&L!==vi.a.RH&&(ba.style=L)}return ba}rNn(b){let h=0,n=0;({SMn:h,pKn:n}=this.Wzm(b.style,h,n));b.weight<h&&(b.weight=h);b.weight>n&&(b.weight=n);return b}Wzm(b,h,n){switch(b){case vi.a.UKb:case vi.a.Omb:case vi.a.jUc:h=2;n=48;break;case vi.a.J6:h=2;n=24;break;default:h=
2,n=48}return{SMn:h,pKn:n}}ixe(b,h,n,B,L,ba){if(h)if(B)for(let la=0;la<h.length;la++)switch(n){case 2:this.t_a(b,h[la],5,L,B,ba);break;case 0:this.t_a(b,h[la],3,L,B,ba);break;case 1:this.t_a(b,h[la],4,L,B,ba);break;case 3:this.t_a(b,h[la],0,L,B,ba)}else x.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else x.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}iye(b,h,n){const B=new ve.GraphIterator;B.set(b);B.zb(14);const L=Ng.TableCellReader.Xsa(b);
b=Ng.TableCellReader.AR(b);qh.forEachCell(B,L,b,(ba,la,La)=>{ba=ba.currentNode;Ng.TableCellReader.$s(ba)&&0==La&&0<la&&this.Twc(ba,Xg.Gp.zR(h),n)})}Twc(b,h,n){b?(n=this.rNn(n),b.properties.setValue(h.color,n.color),b.properties.setValue(h.size,n.weight),b.properties.setValue(h.style,n.style)):x.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}gxb(b,h,n,B){if(b){var L=xh.TableReader.xg(b),ba=xh.TableReader.Fh(b),la=new ve.GraphIterator,La=[];for(let fb=0;fb<L;fb++)for(let Cb=0;Cb<
ba;Cb++)if(la.set(b),qh.moveToCell(la,fb,Cb),la&&la.currentNode&&!Ng.TableCellReader.Wg(la))switch(h){case 2:Ng.TableCellReader.Qla(la)&&La.push(Xm.TableNodeBorderContext.Eaa(la.currentNode,2));break;case 0:Ng.TableCellReader.Rla(la)&&La.push(Xm.TableNodeBorderContext.Eaa(la.currentNode,0));break;case 3:Ng.TableCellReader.UZf(b,la.currentNode)&&La.push(Xm.TableNodeBorderContext.Eaa(la.currentNode,3));break;case 1:Ng.TableCellReader.VZf(b,la.currentNode)&&La.push(Xm.TableNodeBorderContext.Eaa(la.currentNode,
1));break;case 7:Ng.TableCellReader.VZf(b,la.currentNode)||La.push(Xm.TableNodeBorderContext.Eaa(la.currentNode,1));break;case 8:Ng.TableCellReader.UZf(b,la.currentNode)||La.push(Xm.TableNodeBorderContext.Eaa(la.currentNode,3))}for(b=0;b<La.length;b++)switch(h=La[b],h.border){case 2:this.Fkd(h.node,Xg.Gp.zR(5),n,B);this.iue(h.Q8a(),Xg.Gp.zR(0),n,B);break;case 0:this.Fkd(h.node,Xg.Gp.zR(3),n,B);this.iue(h.Q8a(),Xg.Gp.zR(4),n,B);break;case 1:this.Fkd(h.node,Xg.Gp.zR(4),n,B);this.iue(h.Q8a(),Xg.Gp.zR(3),
n,B);break;case 3:this.Fkd(h.node,Xg.Gp.zR(0),n,B),this.iue(h.Q8a(),Xg.Gp.zR(5),n,B)}}else x.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}iue(b,h,n,B){if(b)for(let L=0;L<b.length;L++)this.Fkd(b[L],h,n,B);else x.ULS.sendTraceTag(578062292,306,15,"Adjacent cell array should not be null")}Fkd(b,h,n,B){if(b){var L=b.ja(h.color,Xg.DYc),ba=b.ja(h.size,Xg.Fgc),la=b.ja(h.style,Xg.Egc),La=new ko;La.weight=B.weight;La.style=B.style;La.color=B.color;2!==n||L===Xg.DYc&&ba===Xg.Fgc?3!==n||
la===Xg.Egc&&ba===Xg.Fgc?1!==n||L===Xg.DYc&&la===Xg.Egc?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(La.color=L,La.style=la,this.Twc(b,h,La)):(La.style=la,La.weight=ba,this.Twc(b,h,La)):(La.color=L,La.weight=ba,this.Twc(b,h,La))}else x.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}GR(b,h,n){var B=b.properties.ja(h.style,vi.a.RH);B!==vi.a.RH&&(n.lineStyle!==vi.a.RH?n.lineStyle!==B&&(n.lineStyle=vi.a.ael):n.lineStyle=
B);B=b.properties.ja(h.size,vi.a.TH);B!==vi.a.TH&&(n.Jbd!==vi.a.TH?n.Jbd!==B&&(n.Jbd=vi.a.Pdl):n.Jbd=B);b=b.properties.ja(h.color,0);b=Nl.a.VC(b);b!==vi.a.E2&&(n.borderColor!==vi.a.E2?n.borderColor!==b&&(n.borderColor=vi.a.Hdl):n.borderColor=b);return n}static get Gp(){return null!=Xg.bUg?Xg.bUg:Xg.bUg=vi.a.instance}static get Zg(){return null!=Xg.W7g?Xg.W7g:Xg.W7g=Ya.a.instance.Oa("WordEditor.IWACTableStyleReader")}static get bPa(){return null!=Xg.L5g?Xg.L5g:Xg.L5g=tp.a.instance}}Xg.Tyn="110px";
Xg.Syn="20px";Xg.Xyb="SolidLineStyle";Xg.eNb="DashedLineStyle";Xg.FNb="DottedLineStyle";Xg.HNb="DoubleLineStyle";Xg.NKb="BorderPointSizeOneQuarter";Xg.MKb="BorderPointSizeOneHalf";Xg.QKb="BorderPointSizeThreeQuarters";Xg.Nmb="BorderPointSizeOne";Xg.LKb="BorderPointSizeOneAndHalf";Xg.RKb="BorderPointSizeTwoAndQuarter";Xg.PKb="BorderPointSizeThree";Xg.KKb="BorderPointSizeFourAndHalf";Xg.OKb="BorderPointSizeSix";Xg.Egc="single";Xg.Fgc=4;Xg.DYc=0;Object(u.a)(Xg,"TableBorderManager",null,[477]);var wo=
d(926),Le=d(55),Ht=d(219);class up{constructor(b,h){this.ABh=this.pwh=null;this.lUa=b;this.Dyh=h}get rqj(){return this.Dyh}get Fua(){return this.pwh}get Tqg(){return this.ABh}pPj(b,h){this.ABh=b;this.pwh=h}jWo(b){this.Dyh=b}}Object(u.a)(up,"CellNodeAndOutlineElementInfoForInsertion",null,[]);var Uk=d(70),It=d(207),vr=d(390),uq=d(154),Po=d(243),Gs=d(503),tx=d(83),bu=d(514),wr=d(1140);class on extends wo.a{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb=null,$b=null){super(b,h,n,$b,Lb);this.khb=wr.a.instance;
this.sa=new mg.a;this.P0h=[Lc.a.mzc,Lc.a.zzb,Lc.a.s1b,Lc.a.kzc,Lc.a.xzb,Lc.a.q1b,Lc.a.jzc,Lc.a.wzb,Lc.a.p1b,Lc.a.lzc,Lc.a.yzb,Lc.a.r1b];this.nqk=[Lc.a.ya,Lc.a.xa,Hf.a.Rh,Hf.a.sr];this.Ei=B;this.HIb=L;this.Zc=ba;this.hb=la;this.a$=La;this.Wm=fb;this.bIc=Cb;this.LIh=Lb;this.UQk=$b;this.nio=this.Rng.bind(this)}get Ej(){return this.Ei.value}get fu(){return this.a$?this.a$.instance:null}Egf(b){this.sa.addHandler("OnParagraphDelete",b)}get vh(){return!!this.bIc.instance&&this.bIc.instance.vh}g8c(b,h,n,
B,L){h.setValue(Lc.a.Yc,Se.a.VF());h.setValue(Lc.a.Ifn,L);Gs.c(B,h,[Lc.a.I4]);super.g8c(b,h,n,B,L)}ece(b,h,n,B,L){const ba=this.E5c(h,n,B,L);this.eYd(ba,h,!1);return super.ece(b,h,n,B,L)}YQd(b,h,n,B,L){const ba=this.E5c(h,n,B,L);this.eYd(ba,h,!0);super.YQd(b,h,n,B,L);return ba}Jsf(b,h,n,B){h=this.E5c(b,h,n,B);this.eYd(h,b,!0);return h}insertRows(b,h,n,B){const L=Le.a.Jt(b),ba=new ve.GraphIterator;ba.hd(b);const la=ba.currentNode;ba.Ub(1);let La;La=h?b.oP(1):b.currentNode;const fb=b.uc();if(!fb)throw Error.create("table row insertion cannot be performed on a null tableNode");
const Cb=xh.TableReader.xg(fb),Lb=fb.N2.Zg;let $b=!1;try{fb.fEa=1;const tc=this.khb.Bqb(fb,Lb.VG(fb));this.E_a(b.currentNode);this.pwa(b);this.OXk(n,b,La,ba,la,h,B);const Nc=this.khb.Bqb(fb,Lb.VG(fb));this.keb(fb,xh.TableReader.xg(fb)+n);$b=!0;this.Rce(fb,tc,Nc)}finally{fb.fEa=0,$b||this.keb(fb,xh.TableReader.xg(fb)+n)}L+1!==Cb||h?!L&&h&&on.RWf(fb,n):on.RWf(fb,L);h=L+n+(h?0:1);h<Cb+n&&this.QUi(fb,h);return b.currentNode}OXk(b,h,n,B,L,ba,la){let La=null,fb=null;for(var Cb=0;Cb<b;++Cb){var Lb=Ht.a.instance.createInstance(pk.a.Yna);
fb||(fb=Lb);La=Lb;this.g8c(h,Lb,n,L,ba)}b=xh.TableReader.Fh(h.currentNode);n=!0;do{n?(h.Yj(La),n=!1):h.Lf(1);L=Array(b);for(Cb=0;Cb<b;++Cb){Lb=this.QUa();const $b=this.Jsf(Lb,B.currentNode,ba,!0);let tc=null;$b.Wg||(tc=la($b));L[Cb]=new up(Lb,tc);L[Cb].pPj($b,null);B.Lf(1)}for(Cb=0;Cb<b;++Cb)Lb=L[Cb].lUa,h.w6(Lb,1,wo.a.zRa?wo.a.zRa():null),Ng.TableCellReader.$s(Lb)||(this.oKb(h,Lb,L[Cb].rqj),this.J8h(L[Cb].Tqg,Lb,!0));B.wla(1)}while(h.currentNode!==fb)}insertColumns(b,h,n,B,L){let ba=b.currentNode,
la=!1,La=xh.TableReader.Fh(b.currentNode);const fb=La;try{this.E_a(b.currentNode);this.pwa(b);const Cb=ba.N2.Zg;ba.fEa=1;const Lb=this.khb.Bqb(ba,Cb.VG(ba));La=xh.TableReader.Fh(b.currentNode);-1===h&&(h=La);this.MXk(b,B,n,h,L);ba=b.currentNode;La+=B;this.yqg(b,La,B,h);la=!0;const $b=this.khb.Bqb(ba,Cb.VG(ba));this.Rce(ba,Lb,$b)}finally{ba.fEa=0,la||this.yqg(b,La,B,h)}h!==fb||n?!h&&n&&on.QWf(ba,B):on.QWf(ba,h-1)}MXk(b,h,n,B,L){var ba=b.currentNode;B=n?B:B-1;b.Ub(1);var la=new ob.a;do{var La=b.XG(B,
1);b.uc();var fb=Array(h);for(let Lb=0;Lb<h;++Lb){var Cb=this.QUa();const $b=this.OBm(b,La,n),tc=this.Jsf(Cb,La,n,!1);Cb=new up(Cb,null);Cb.pPj(tc,$b);fb[Lb]=Cb}la.add(fb)}while(b.Cj(1));n=la.toArray();for(B=0;B<n.length;B++)for(la=0;la<h;la++)La=n[B][la],fb=La.Tqg,fb.Wg||La.jWo(L(fb));b.set(ba);b.Ub(1);L=0;do{for(ba=0;ba<h;++ba)B=n[L][ba],la=B.lUa,b.fSb(la,B.Fua,1,wo.a.zRa?wo.a.zRa():null),Ng.TableCellReader.$s(la)||(this.oKb(b,la,B.rqj),this.J8h(B.Tqg,la,!1));L++}while(b.Cj(1))}Rce(b,h,n){if(h){var B=
2===b.fEa,L=[],ba=new ve.GraphIterator;ba.set(b);for(var la=ba.Ub(1);la;){for(la=ba.Ub(1);la;){const La=la.id.toString();La in h&&h[La]===n[La]&&(!B||!Ng.TableCellReader.Rla(ba)&&!Ng.TableCellReader.Qla(ba))||L.push(la);la=ba.Cj(1)}la=ba.Cj(1)}if(0<L.length){h=new Sd.GraphTransaction(3);try{h.set(b.pk);for(const La of L)La.TWf()}finally{h&&h.dispose()}}}}deleteRows(b,h){const n=Le.a.Jt(b),B=n+h;let L=b.uc();const ba=L.N2.Zg;let la=!1;x.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",
L.id.toString(),L.type,n,h);const La=xh.TableReader.xg(L);try{L.fEa=2;const fb=this.khb.Bqb(L,ba.VG(L));this.E_a(b.currentNode);this.pwa(b);for(let Lb=B-1;Lb>=n;--Lb){b.XG(Lb,1);let $b=b.Ub(1);for(;$b;)this.bfd($b,!0),$b=b.Cj(1);this.yWa(b);x.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.lf);b.eh()}L=b.currentNode;const Cb=this.khb.Bqb(L,ba.VG(L));this.keb(L,xh.TableReader.xg(L)-h);this.Jme(b);la=!0;this.Rce(L,fb,Cb)}finally{L.fEa=0,la||
(this.keb(b.currentNode,xh.TableReader.xg(b.currentNode)-h),this.Jme(b))}La===B&&0<=n-1&&on.RWf(L,n-1);n<La-h&&this.QUi(L,n)}deleteColumns(b,h,n){b=Object(ya.a)(ve.GraphIterator,b);let B=Object(ya.a)(bu.a,b.currentNode),L=xh.TableReader.Fh(b.currentNode);const ba=B.N2.Zg;let la=!1;x.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",B.id.toString(),B.type,h,n);const La=L;try{B.fEa=2;const fb=this.khb.Bqb(B,
ba.VG(B));this.E_a(b.currentNode);this.pwa(b);-1===h&&(h=L-n);b.Ub(1);do for(let Lb=h+n-1;Lb>=h;--Lb)b.XG(Lb,1),this.bfd(b.currentNode,!1),this.yWa(b),b.eh();while(b.Cj(1));L-=n;this.xqg(b,L,h,n);la=!0;B=Object(ya.a)(bu.a,b.currentNode);const Cb=this.khb.Bqb(B,ba.VG(B));this.Rce(B,fb,Cb);this.Ime(b)}finally{B&&(B.fEa=0),la||(this.xqg(b,L,h,n),this.Ime(b))}La===h+n&&0<=h-1&&on.QWf(B,h-1)}mergeCells(b,h,n){if(b&&(1!==h||1!==n)){var B=new ve.GraphIterator;B.hd(b);B.zb(14);this.fuf(B,h,n);this.aup(B,
h,n);B.uc();B.uc();this.Vlj(B)}}YWj(b,h,n){if(b&&(1!==h||1!==n)){var B=new ve.GraphIterator;B.hd(b);B.zb(14);this.dKl(B,h,n);B.uc();B.uc();this.yoj(B)}}bfd(b,h){x.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.QUm(b,h,this.nio)}Rng(b,h){const n=b.currentNode;n.Wg=!1;this.eYd(h.currentNode,b.currentNode,!0);n.removeProperty(Lc.a.skippedCell);n.removeProperty(Lc.a.renderCell);1===n.colSpan&&1===n.rowSpan&&n.CVc();wo.a.pT.Hja(b,!0,wo.a.IDi(h.currentNode));
qh.returnToCell(b);this.jCl(h,b)}PRf(b,h,n){super.PRf(b,h,n);1===h.ZO.colSpan&&1===h.ZO.rowSpan?h.ZO.CVc():!n&&h.Uve&&(b.BWa?1<b.colSpan&&(h=new ve.GraphIterator,h.set(b),h.zb(15),qh.moveToNextColumn(h),h.currentNode.colSpan=b.colSpan-1):(n=new ve.GraphIterator,n.set(h.ZO),n.zb(15),h=tx.a(n),n=new ve.GraphIterator,n.set(b),n.zb(15),qh.moveToColumnByIndex(n,h),--n.currentNode.colSpan))}E5c(b,h,n,B){const L=super.E5c(b,h,n,B);if(b.Wg&&!B){var ba=h.XCa;ba.Uve&&(B=wo.a.Fjc(ba.ZO,B),!ba.DWd&&n||ba.DWd===
B-1&&!n?b.colSpan=1:(n=new ve.GraphIterator,n.set(ba.ZO),n.zb(15),ba=tx.a(n),n=new ve.GraphIterator,n.set(h),n.zb(15),qh.moveToColumnByIndex(n,ba),n.currentNode.colSpan+=1))}L.ja(Lc.a.skippedCell,!1)&&(b.Wg=!0,b.T7=!0,b.Myb=!0);return L}Jme(b){this.v2b(b,Lc.a.complexTable)}Ime(b){this.v2b(b,Lc.a.complexTable)}Vlj(b){this.v2b(b,Lc.a.complexTable)}yoj(b){this.v2b(b,Lc.a.complexTable)}jCl(b,h){if(b&&h){let n;b=ve.GraphIterator.eb(b.currentNode);Zj.OutlineNavigator.Wba(b)&&(b.Ub(2),b=b.currentNode,12==
b.type&&(n=b.wf(Hf.a.Rh)));n&&(b=new ve.GraphIterator,b.hd(h),Zj.OutlineNavigator.Wba(b)&&b.Ub(2)&&(h=b.currentNode,12==h.type&&h.Kg(Hf.a.Rh,n)))}}eYd(b,h,n){b&&(Gs.c(b,h,this.P0h),Gs.c(b,h,[Hf.a.MJ]),n&&Gs.c(b,h,[Lc.a.sV,Lc.a.CY,Lc.a.i0a,Lc.a.h0a,Lc.a.TOa,Lc.a.skippedCell,Lc.a.renderCell]))}J8h(b,h,n){b&&(b=ve.GraphIterator.eb(b),b.Jd(),b.Xd(),h=ve.GraphIterator.eb(h),h.Jd(),h.Xd(),xb.OutlineElementReader.Mh(b)&&Ga.OutlineElementNavigator.Le(b)&&xb.OutlineElementReader.Mh(h)&&Ga.OutlineElementNavigator.Le(h)&&
Gs.c(b.currentNode,h.currentNode,this.nqk),n&&(Ga.OutlineElementNavigator.he(b),Ga.OutlineElementNavigator.he(h),Gf.ListItemReader.Hg(b)&&(n=on.Ezn.Nw(b),n.ED=Uk.a.Ik,{cCa:n}=on.rm.Tqa(n.qf,h,n))))}yWa(b){this.vh&&this.Wm.Pwo(b.currentNode);for(b=It.a.Bq(b);b.moveNext();)if(ea.ParagraphReader.Xb(b.currentNode)){const h=tn.e(b.currentNode);for(const n of h)n.Lga();this.sa.raiseEvent("OnParagraphDelete",b.currentNode)}else Gf.ListItemReader.Hg(b.iterator)&&this.fu&&this.fu.eha(b.iterator)}rH(b,h){let n=
null;if(this.LIh.Mg){const B=Object(ya.a)(bu.a,b);B&&(n=B.gY())}xh.TableReader.Lo(b)&&(1===h?h=3:3===h&&(h=1));super.rH(b,h);this.LIh.Mg&&this.UQk.F_a(b,n);Object(Wb.a)(bu.a,b)&&wo.a.Oh.cQj(Object(ya.a)(bu.a,b),(new vr.a(1,0)).Nu)}oAg(b,h){const n=Array(h),B=this.JIi(b)/h;for(let L=0;L<h;L++)n[L]=Math.max(ri.a.em(uq.a.Mha,0),B);b.setValue(Hf.a.lB,n)}TOj(b){b.setValue(Lc.a.tableLayout,0)}bRh(b,h,n,B,L){const ba=Array(n);for(var la=0,La=0;la<B;++la)ba[la]=h[la],La+=ba[la];for(;la<n;++la)ba[la]=0>la-
L?h[0]:h[la-L],La+=ba[la];la=this.JIi(b.currentNode);if(La>la)for(La=la/La,la=0;la<n;++la)ba[la]=Math.max(ri.a.em(uq.a.Mha,0),ba[la]*La);return ba}JIi(b){var h=ve.GraphIterator.eb(b);b=ri.a.em(ri.a.qj(xh.TableReader.wIi(h),0),0);if(h.zb(16))return qh.returnToCell(h),h=uq.a.kAc(h.currentNode),ri.a.em(ri.a.qj(h,0),0)-b;h=Po.a.nsd(h);return ri.a.em(ri.a.qj(h,0),0)-b}AR(b,h,n){const B=new ve.GraphIterator;B.set(b);qh.moveToCell(B,h,n);return B.currentNode.ja(Lc.a.colSpan,1)}$wc(b){var h=Ua.StaticActiveAppFrame.za().ib.Vu;
if(h.te&&(h=b.ue(h.oc))){var n=!1,B=xh.TableReader.Fh(b),L=b.ja(Hf.a.lB,Array(B));for(var ba of L)if(!ba){n=!0;break}if(n){L=lf.a.clone(L);ba=b.ja(Lc.a.complexTable,!1);x.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",B,L,ba);n=1;var la=0;for(let fb=0;fb<B;)if(ba&&(n=this.AR(b,0,fb)),1<n){for(var La=0;La<n;La++)L[fb]||(L[fb]=this.jCi(0)),fb++;la+=n-1}else(La=h.nom(fb-la))||x.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",
fb,la),L[fb]||(L[fb]=this.jCi(La)),fb++;b.setValue(Hf.a.lB,L)}}}jCi(b){return ri.a.em(Math.max(b,uq.a.Mha),0)}E_a(b){b=ve.GraphIterator.eb(b);this.$wc(b.currentNode);b.zb(14)&&(qh.returnToContainingTable(b),this.$wc(b.currentNode))}ZPj(b,h){h&&b.setValue(Lc.a.$ca,h)}TAg(b,h){h&&b.setValue(Lc.a.izc,h)}c3h(b,h){const n=xh.TableReader.Fh(b);wo.a.frl(b,h,n)}hSo(b,h,n){let B;if(!({xp:B}=this.zpc(b)).returnValue)return!1;if(h&&n&&h.length===n.length){if(!this.cWl(B,h))return!1;for(let L=0;L<h.length;++L){const ba=
this.HIb.Qnd(b,h[L],n[L]);if(ba)return x.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",ba),!1}this.Hke(B);return!0}return!1}R6k(b,h){let n;if(!({xp:n}=this.zpc(b)).returnValue||xh.TableReader.rD(n))return!1;var B=Object(ya.a)(ve.GraphIterator,this.Zc.jg(n));qh.moveToLastRow(B);var L=xh.TableReader.xg(n);if(h&&0<h.length){this.insertRows(B,!1,h.length,()=>null);B=xh.TableReader.xg(n);var ba=this.Zc.jg(n);L=this.sIi(ba,L,B-1);for(B=
0;B<L.length;++B){ba=L[B];const la=h[B];for(let La=0;La<ba.length;++La){let fb;if(fb=la&&la[La]?this.HIb.Qnd(b,ba[La],la[La].toString()):this.HIb.Qnd(b,ba[La],""))return x.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",fb),!1}}}this.Hke(n);return!0}z6k(b,h){let n;if(!({xp:n}=this.zpc(b)).returnValue||xh.TableReader.rD(n))return!1;var B=this.Zc.jg(n),L=xh.TableReader.Fh(n);if(h&&0<h.length){this.insertColumns(Object(ya.a)(ve.GraphIterator,
B),L,!1,h[1].length,()=>null);var ba=xh.TableReader.Fh(n);B=this.SMm(B,L,ba-1);for(L=0;L<B.length;++L){ba=h[L];const la=B[L];for(let La=0;La<la.length;++La){let fb;if(fb=ba&&ba[La]?this.HIb.Qnd(b,la[La],ba[La].toString()):this.HIb.Qnd(b,la[La],""))return x.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",fb),!1}}}this.Hke(n);return!0}DPl(b){let h;if(!({xp:h}=this.zpc(b)).returnValue)return!1;let n=this.m9a(h);const B=xh.TableReader.xg(h);
var L=this.Zc.jg(h);L=this.sIi(L,n,B-1);for(let ba=0;ba<L.length;++ba){const la=L[ba];for(let La=0;La<la.length;++La){const fb=this.HIb.tBj(b,la[La]);if(fb)return x.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",fb),!1}}n=n?n:1;b=this.Zc.jg(h);b.WG(n)&&15===b.lf&&this.deleteRows(Object(ya.a)(ve.GraphIterator,b),B-n);this.Hke(h);return!0}m9a(b){let h=0;const n=this.Zc.jg(b);let B=n.Xd();for(;B&&B.ja(Lc.a.Ntb,!1);)h++,B=n.Cu();return!h&&
wo.a.Ry.k3(b)&32?1:h}aup(b,h,n){var B,L;const ba=b.currentNode,la=new ve.GraphIterator;la.hd(b);let La=null,fb=null,Cb=null;const Lb=vi.a.instance.zR(3),$b=vi.a.instance.zR(4),tc=vi.a.instance.zR(5),Nc=vi.a.instance.zR(0);qh.forEachCell(la,h,n,(dd,Hd,xe)=>{dd=dd.currentNode;Hd||xe||(La=on.kB.GHf(dd,Lb,La));Hd||xe!==n-1||(fb=on.kB.GHf(dd,$b,fb));0<Hd&&!xe&&(La?on.kB.fzg(dd,Lb,La):on.kB.pZb(dd,Lb),fb?on.kB.fzg(dd,$b,fb):on.kB.pZb(dd,$b),on.kB.pZb(dd,tc),Hd!==h-1&&on.kB.pZb(dd,Nc));xe||Hd!==h-1||(Cb=
on.kB.GHf(dd,Nc,Cb))});b=null===(L=null===(B=Ua.StaticActiveAppFrame.za())||void 0===B?void 0:B.ib)||void 0===L?void 0:L.Vu;fb?(B=Xm.TableNodeBorderContext.Eaa(ba,1),on.kB.gzg(Hm.a.Vq(b),B,fb,0)):on.kB.pZb(ba,$b);B=Xm.TableNodeBorderContext.Eaa(ba,0);if(La)on.kB.gzg(Hm.a.Vq(b),B,La,0);else for(B=Object(ya.a)(Xm.TableNodeBorderContext,B).Q8a(),L=0;L<B.length;L++)on.kB.pZb(B[L],$b);Cb?on.kB.fzg(ba,Nc,Cb):on.kB.pZb(ba,Nc)}cWl(b,h){for(let B=0;B<h.length;++B){var n=this.Zc.jg(h[B]);if(n.zb(14)&&(n=n.ld(14),
b.id===n.id))continue;return!1}return!0}zpc(b){let h=null;if(b&&b.pv.toString()!==b.MA.toString())return{returnValue:!1,xp:h};h=this.Ej.Eb(b.pv);return 14===h.type&&this.HIb.zpc(b)?{returnValue:!0,xp:h}:{returnValue:!1,xp:h}}sIi(b,h,n){const B=[];qh.forEachCellInTable(Object(ya.a)(ve.GraphIterator,b),(L,ba,la)=>{if(ba>=h&&ba<=n)la||B.push([]),Ng.TableCellReader.Wg(L)||Array.add(B[ba-h],L.currentNode);else if(ba>n)return!1;return!0});return B}SMm(b,h,n){const B=[];qh.forEachCellInTable(Object(ya.a)(ve.GraphIterator,
b),(L,ba,la)=>{la>=h&&la<=n&&(la===h&&B.push([]),Ng.TableCellReader.Wg(L)||Array.add(B[ba],L.currentNode));return!0});return B}Hke(b){if(b&&14===b.type){b=Object(ya.a)(ve.GraphIterator,this.Zc.jg(b));const h=new ob.a;ea.ParagraphReader.vQb(b,!0,!1,h);b=Oe.SelectionFactory.se(h.J(h.count-1),0);this.hb.Ic(b)}}static get kB(){on.Hya||(on.Hya=Ya.a.instance.Oa("WordEditor.ITableBorderManager"));return on.Hya}static get Ezn(){return null!=on.k1g?on.k1g:on.k1g=Ya.a.instance.resolve("Box4.List.IListReader")}static get rm(){return null!=
on.d1g?on.d1g:on.d1g=Ya.a.instance.resolve("Box4.List.IListEditor")}QUi(b,h){const n=new ve.GraphIterator;n.set(b);qh.moveToFirstRow(n);qh.moveToRowByIndex(n,h);do n.currentNode.om(4,!0);while(qh.moveToNextRow(n))}static RWf(b,h){if(b){var n=xh.TableReader.xg(b),B=xh.TableReader.Fh(b);if(!(!Ua.StaticActiveAppFrame.za().ib.Vu.te||0>h||h>=n))for(n=new ve.GraphIterator,n.set(b),b=0;b<B;b++){b?qh.moveToNextColumn(n):qh.moveToCell(n,h,b);if(!n||!n.currentNode||16!==n.currentNode.type)continue;let L=n.currentNode;
Ng.TableCellReader.$s(L)&&(L=Ng.TableCellReader.Ska(L));L&&L.om(4,!0)}}else x.ULS.sendTraceTag(577868247,306,15,"Can not invalidate row when there is no table node")}static QWf(b,h){if(b){var n=xh.TableReader.xg(b),B=xh.TableReader.Fh(b),L=new ve.GraphIterator;if(!(!Ua.StaticActiveAppFrame.za().ib.Vu.te||0>h||h>=B))for(B=0;B<n;B++){L.set(b);qh.moveToCell(L,B,h);if(!L||!L.currentNode)continue;let ba=L.currentNode;Ng.TableCellReader.$s(ba)&&(ba=Ng.TableCellReader.Ska(ba));ba&&ba.om(4,!0)}}else x.ULS.sendTraceTag(577868248,
306,15,"Can not invalidate column when there is no table node")}}on.Hya=null;Object(u.a)(on,"TableEditor",wo.a,[475,476]);class Pr{get name(){return"WordEditor.TableEditors"}wc(b){A.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&(b.ia("WordEditor.TableEditors.TableEditor",()=>new on(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c.td),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),
new Vl.a,Zb.a.instance,b.Qa("WordEditor.IFlatListEditor"),b.resolve("Box4.ContentControl.IContentControlOperator"),b.Qa("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").ha(),b.ia("WordEditor.TableEditors.TableBorderManager",()=>new Xg).as("WordEditor.ITableBorderManager").ha())}init(){}dispose(){}static main(){M.a.instance.Jc(new Pr)}}
Object(u.a)(Pr,"WordEditorTableEditorsPackage",null,[0,1]);class sz{get name(){return"WordEditor.TextLevelEditors"}wc(){}init(){}dispose(){}static main(){M.a.instance.Jc(new sz)}}Object(u.a)(sz,"WordEditorTextLevelEditorsPackage",null,[0,1]);var ux=d(2085),tz=d(404),Fu=d(831),Cw=d(223),Ym=d(241);class vq{constructor(b){this.THk=b}pIl(){const b=Ht.a.instance.createInstance(pk.a.OF);b.setValue(Hf.a.aM,Cw.a.first);b.setValue(Hf.a.HWh,0);b.setValue(Hf.a.lma,pl.OutlineReader.zOl);(new Fu.OutlineIndentInfo(!0)).xJj(b);
return b}Hja(b,h,n=null){const B=b.currentNode;if(!b.IL(1))return this.kSb(b,null,h,n);xb.OutlineElementReader.zN(b)&&Ga.OutlineElementNavigator.d$f(b,!0);return xb.OutlineElementReader.Mh(b)?vq.Kf.$z(b,!1,h,n):(b.fmd(B),null)}cll(b){return pl.OutlineReader.N_f(b.currentNode)||xb.OutlineElementReader.Mh(b)||xb.OutlineElementReader.zN(b)||Ng.TableCellReader.isTableCell(b)}kSb(b,h=null,n=!1,B=null){if(!this.cll(b))return null;const L=vq.Kf.dob();this.IXo(L,b);b.fSb(L,h,1,null);b.Yj(L);n&&(vq.Kf.QJ(b,
B),Ga.OutlineElementNavigator.he(b));return L}IXo(b,h){if(h=this.YIm(h))switch(h.type){case 11:vq.Kf.Izf(h,b,!0);break;case 8:h=vq.$i.isRtl(h),vq.Kf.Y_b(b,h)}}YIm(b){return this.THk.ZIm(b)}X_b(b,h){b.setValue(Hf.a.sr,h?11:9)}pSo(b,h){const n=Ym.WordSectionNavigator.instance.FN(b);return n?pl.OutlineReader.K_(b)!==h?(n.setValue(Lc.a.swf,h),!0):!1:null}static get $i(){return Gm.PageReader.instance}static get Kf(){return vq.Oh||(vq.Oh=Ya.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Kf(b){vq.Oh=
b}}vq.Oh=null;vq.Ge=null;Object(u.a)(vq,"OutlineEditor",null,[640]);const uz=b=>{b.ia("Box4.OutlineLevelEditors.OutlineEditor",()=>new vq(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").ha();b.ia("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new ux.a(b.rf("Box4.IOutlineEditor"),b.rf("Box4.List.IListEditor"),b.rf("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),
b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IOutlineElementEditor").ha()};class vx{SSj(){return{RSj:!0,Abk:!1}}}Object(u.a)(vx,"CursorMovementValidator",null,[474]);class xy{get name(){return"Box4.OutlineLevelEditors"}wc(b){b.ia("Box4.ListEditors.CursorMovementValidator",()=>new vx).as("Box4.List.ICursorMovementValidator").ha();uz(b)}init(){}dispose(){}static main(){M.a.instance.Jc(new xy)}}Object(u.a)(xy,
"Box4OutlineLevelEditorsPackage",null,[0,1]);class yy{constructor(b){this.HZd=null;this.Kij=b.kb("OfficeOnlineChromeExtensionId");this.Vij=b.kb("ChromeClipboardAccessExtensionId");this.Ken=b.$("OfficeOnlineChromeExtensionIsEnabled");this.YEh=!this.onn();this.HZd=this.q0b?this.Vij:this.Kij}qFo(){this.HZd===this.Kij&&this.n_i&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.HZd=this.Vij;this.YEh=!0}get q0b(){return this.YEh}onn(){if(this.Ken&&
this.n_i){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get n_i(){let b=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){x.ULS.sendTraceTag(19452045,307,50,h.toString())}return b}}Object(u.a)(yy,
"ChromeExtensionHelper",null,[36]);var wx=d(1500),ik=d(727),Hs=d(1451);class xx{create(b){return new Hs.a(b)}}Object(u.a)(xx,"Factory",null,[626]);var Em=d(1426),Hv=d(1120),vz=d(418),Im=d(386),wq=d(1001);class qm extends wq.a{constructor(b,h,n,B,L,ba,la=null,La=null){super(b,ba,la,La);this._formatting=null;this.wxa=!1;this.EDb=A.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.XFb=0;this.IQc=new ob.a;Vc.a(8128527,307,xb.OutlineElementReader.Mh(b));this.BO=h;this.BO.Pdc(this);
this.Sr=n;this.rm=B;this.Nd=L;this.cmf=La;this.o4e=Gf.ListItemReader.Hg(this.Bc)}get rl(){return null!=this.P2g?this.P2g:this.P2g=Ya.a.instance.resolve("Box4.IParagraphEditor")}get xZd(){return null}get Jfc(){return this.o4e&&!this.BO.BJa}get ZMb(){return 0<this.XFb}Pga(b,h){if(!this.r1.DKg(this.Bc,h,!0)){Vc.a(8701077,307,ea.ParagraphReader.Bh(this.Bc));var n=this.Bc.currentNode,B=Nd.a.zx(n);this.EDb&&this._formatting.uR&&(n=n.qa.last,this.wxa&&(n.formatting=this._formatting.uR.Bf(n),this.wxa=!1),
b=this.r1.YRf(b,h),this.r1.Mca(this.Bc.currentNode,this._formatting.Vga,h));this.rg.Ne(B,b)}}$ba(){Vc.a(8701078,307,ea.ParagraphReader.Bh(this.Bc));const b=Nd.a.zx(this.Bc.currentNode);this.rg.Gla(b,h=>new Im.a(h))}Tvb(){this.r1.dSf(this.Bc)}VMa(){this.EDb&&(this.wxa=!0)}RYa(){Vc.a(8701079,307,ea.ParagraphReader.Bh(this.Bc))}QYa(){Vc.a(8701080,307,ea.ParagraphReader.Bh(this.Bc))}MF(b){this.BO.BJa||(this.EDb?(this.Bif(b),this._formatting.Ksd(this.Bc.currentNode),b&&"P"===b.jca.Xae&&this.cmf.vha(this.Bc.currentNode,
this._formatting.JP),this.r1.Mca(this.Bc.currentNode,this._formatting.Vga,b)):this.fcl(b))}fH(){this.BO.BJa||this.eKa()}VYa(){}fcb(){}oDa(){Vc.a(8701081,307,xb.OutlineElementReader.Mh(this.Bc)||pl.OutlineReader.zy(this.Bc)||ea.ParagraphReader.Bh(this.Bc)&&this.BO.BJa);let b=!1;this.ZMb||(b=this.Jfc||!0);b||(this.fY+=1);this.XFb++}mDa(){this.XFb--;let b=!1;this.ZMb||(b=this.Jfc||!0,this.rm.FCj(this.IQc));b||--this.fY}YMa(b){Vc.a(8701082,307,xb.OutlineElementReader.Mh(this.Bc)||pl.OutlineReader.zy(this.Bc)||
ea.ParagraphReader.Bh(this.Bc)&&this.BO.BJa);Vc.a(8701083,307,!!b.listStyleType)}nDa(){Vc.a(8701084,307,xb.OutlineElementReader.Mh(this.Bc)||ea.ParagraphReader.Bh(this.Bc)&&this.BO.BJa);this.BO.BJa||Vc.a(8701085,307,this.Bc.fv(2))}fca(b){this.BO.fca(b)}dca(){this.BO.dca()}xsd(b){this.IQc.add(b)}p8(b){this.BO.p8(b)}eca(){this.BO.eca()}cca(b){this.BO.cca(b)}bca(){this.BO.bca()}fcl(b){this.Orc(!1);(new ve.GraphIterator).hd(this.Bc);b=wq.a.Kf.QJ(this.Bc,this.U3c(b));Vc.a(8128534,307,b===this.Bc.currentNode);
Vc.a(8128535,307,ea.ParagraphReader.Xb(b))}eKa(){Vc.a(8128536,307,ea.ParagraphReader.Bh(this.Bc));Ga.OutlineElementNavigator.he(this.Bc)}reset(){this.EDb&&(super.reset(),this._formatting=this.hJf(!0))}Bif(b){this.Orc(!1);(new ve.GraphIterator).hd(this.Bc);b=wq.a.Kf.QJ(this.Bc,this.U3c(b));Vc.a(36577367,307,b===this.Bc.currentNode);Vc.a(36577368,307,ea.ParagraphReader.Xb(b));-1!==this._formatting.Fx&&this.rl.rH(b,this._formatting.Fx);this._formatting.lineSpacing&&this.cmf.QE(b,this._formatting.lineSpacing);
this._formatting.Y8&&this.cmf.Aye(b,this._formatting.Y8);this.wxa=!0;this._formatting.paragraph=b}static Fsf(b,h){let n=0;switch(h){case 3:n=Fg.a.Ow(b);break;case 7:n=ri.a.gA(b,0);break;case 1:n=Fg.a.pof(b);break;case 5:n=Fg.a.Ow(Fg.a.jlg(b));break;default:x.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,h)}return n}}Object(u.a)(qm,"TextOnlyBox4PasteSteward",wq.a,[]);class Xn extends qm{constructor(b,h,n,B,L,ba,la,La=null,
fb=null){super(h,n,B,L,ba,la,La,fb);this.NJc=!1;this.yEb=[];this.PHh=b;h={};h.textOnlyPasteFlags=b;x.ULS.sendTraceTag(509088282,307,50,D.c(h))}reset(){super.reset();this.NJc=!1;this.yEb.length=0;this.pEd=!1}MF(b){this.NJc||(super.MF(b),this.NJc=!0)}fH(){this.pEd?this.pEd=!1:this.$ba(null)}$ba(b){this.PHh&2||super.$ba(b)}oDa(){}mDa(){}YMa(){}nDa(){}fca(){}dca(){}p8(b){this.NJc||(super.p8(b),this.NJc=!0);this.yEb.push(!1)}eca(){this.PHh&1&&this.$ba(null);0<this.yEb.length?this.yEb.pop():Vc.a(509088281,
307,!1)}cca(){var b=this.yEb.length-1;0<=b?this.yEb[b]?(b=Nd.a.zx(this.Bc.currentNode),this.rg.Ne(b,", ")):this.yEb[b]=!0:Vc.a(509088280,307,!1);this.pEd=!0}bca(){this.pEd=!1}xsd(){}}Object(u.a)(Xn,"StrictTextOnlyBox4PasteSteward",qm,[]);class lo{constructor(b,h,n,B){this.w3e=b;this.MM=h;this.ig=n;this.r1=B}create(b,h,n,B,L=null,ba=null,la=null,La=null){return 1===b?null!==La&&0!==La?new Xn(La,h,B,this.w3e,this.MM,this.ig,L,ba,this.r1):new qm(h,B,this.w3e,this.MM,this.ig,L,ba,this.r1):new vz.Box4PasteSteward(h,
n,B,this.w3e,this.MM,this.ig,L,new vc.b,ba,this.r1,la)}}Object(u.a)(lo,"Box4PasteStewardFactory",null,[624]);var im=d(190),NA=d(398),Kg=d(1144);class ww{constructor(b,h,n){this.oA=null;this.YFb=0;this.Bc=b;this.hk=n}Pdc(b){this.oA=b}get BJa(){return 0<this.YFb}fca(b){Vc.a(7869459,307,!!this.oA);Vc.a(7869460,307,xb.OutlineElementReader.Mh(this.Bc)||pl.OutlineReader.zy(this.Bc));Vc.b(38563978,307,50,"Table pasting started");this.oA.Orc(!0);const h=new ve.GraphIterator;h.hd(this.Bc);var n=Kg.a.H1m[b.styleId];
n||(A.AFrameworkApplication.Ld("gdea6103;0df65435"),b.HXf?(x.ULS.sendTraceTag(509125329,3022,50,"onTableStart: Fixed default table style"),n=Kg.a.aRn):n=Kg.a.aei);n=this.hk.wro(this.Bc,b.rowCount,b.wnb,n,b.tableLook,this.oA.U3c(b),b.HXf);b.iHg&&(Vc.b(573691298,3022,100,"Applying table border properties"),Kg.a.gTh(b.iHg,this.Bc,!1,!0));b.Obe&&(Vc.b(573691299,3022,100,"Applying indentation properties"),Kg.a.L7k(this.Bc,b.Obe.spaceBefore,b.Obe.spaceAfter));b.EWd&&(Vc.b(573691328,3022,100,"Applying column widths"),
Kg.a.u7k(b.EWd,this.Bc,Object(ya.a)(NA.TableNode,n),b.Cab));this.oA.WSd(h,!1);this.YFb++;Gf.ListItemReader.Hg(h)&&this.oA.xsd(h.currentNode);Vc.a(7869461,307,xh.TableReader.isTable(this.Bc))}dca(){Vc.a(7869462,307,!!this.oA);Vc.a(7869463,307,Le.a.isTableRow(this.Bc));Vc.b(38563979,307,50,"Table pasting finished");this.Bc.qt(14)&&Kg.a.CJj(this.Bc.io);Ga.OutlineElementNavigator.he(this.Bc);this.YFb--}p8(b){Vc.a(7869464,307,!!this.oA);Vc.b(573691329,3022,100,"Table row pasting started");xh.TableReader.isTable(this.Bc)?
qh.moveToFirstRow(this.Bc):Le.a.isTableRow(this.Bc)&&qh.moveToNextRow(this.Bc);b.height&&(Vc.b(573691330,3022,100,"Applying table row height"),Kg.a.C8k(this.Bc,b.height));Vc.a(7869465,307,Le.a.isTableRow(this.Bc))}eca(){Vc.a(7869466,307,!!this.oA);Vc.a(7869467,307,Ng.TableCellReader.isTableCell(this.Bc));qh.returnToContainingRow(this.Bc)}cca(b){Vc.a(7869468,307,!!this.oA);Vc.a(7869469,307,!this.oA.fY);Le.a.isTableRow(this.Bc)?qh.moveToFirstColumn(this.Bc):Ng.TableCellReader.isTableCell(this.Bc)?qh.moveToNextColumn(this.Bc):
Vc.a(7869471,307,!1);if(this.Bc.currentNode){Vc.b(573691331,3022,100,"Table cell pasting started");var h=Object(ya.a)(im.TableCellNode,this.Bc.currentNode);Vc.a(50689760,307,!h&&16!==this.Bc.currentNode.type||!!h&&16===this.Bc.currentNode.type);if(h){var n=new ve.GraphIterator;n.hd(this.Bc);if(b.tpc)Vc.b(573691332,3022,100,"Processing skipped cell"),Kg.a.Nho(n,b);else{if(1<b.colSpan||1<b.rowSpan){const B=qh.returnToContainingTable(n);if(!B)return;B.setValue(Lc.a.complexTable,!0);n.hd(this.Bc);Vc.b(573691333,
3022,100,"Processing merged cell");Kg.a.dho(n,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}Kg.a.H8k(this.Bc,b.shadingColor);Kg.a.y9k(this.Bc,b.verticalAlignment);Kg.a.i7k(this.Bc,b.eCe);Kg.a.gTh(b.Una,this.Bc,!b.colSpan&&!b.rowSpan,!1);(new ve.GraphIterator).hd(this.Bc);qh.forEachCell(n,b.rowSpan,b.colSpan,(B,L,ba)=>{Vc.b(573691334,3022,100,"Setting ghost cell borders");Kg.a.$Nj(B,b.Una,L,ba,b.rowSpan,b.colSpan)});Kg.a.A9k(this.Bc,b.width,b.Cab);Vc.a(7869472,307,pl.OutlineReader.zy(this.Bc))}}}}bca(){Vc.a(7869473,
307,!!this.oA);Vc.a(7869474,307,xb.OutlineElementReader.Mh(this.Bc)||Ng.TableCellReader.isTableCell(this.Bc));qh.returnToCell(this.Bc);Vc.a(7869475,307,0>=this.oA.fY);this.oA.mpf()}}Object(u.a)(ww,"Box4TableSteward",null,[632,307]);class px{constructor(b,h,n){this.oA=null;this.YFb=0;this.Bc=b;this.hk=n}Pdc(b){this.oA=b}get BJa(){return 0<this.YFb}fca(){this.BJa&&(Vc.a(8787101,307,ea.ParagraphReader.Bh(this.Bc)),Ga.OutlineElementNavigator.he(this.Bc));Vc.a(8701086,307,!!this.oA);Vc.a(8701087,307,xb.OutlineElementReader.Mh(this.Bc)||
pl.OutlineReader.zy(this.Bc));this.YFb++}dca(){Vc.a(8701088,307,!!this.oA);Ga.OutlineElementNavigator.he(this.Bc);this.YFb--;if(this.BJa){this.oA.Orc(!0);const b=px.Kf.QJ(this.Bc);Vc.a(8787102,307,b===this.Bc.currentNode);Vc.a(8787103,307,ea.ParagraphReader.Bh(this.Bc))}}p8(b){Vc.a(8701089,307,!!this.oA);this.oA.Orc(!0);const h=new ve.GraphIterator;h.hd(this.Bc);this.oA.WSd(h,!1);Gf.ListItemReader.Hg(h)&&this.oA.xsd(h.currentNode);b=px.Kf.QJ(this.Bc,this.oA.U3c(b));Vc.a(8701090,307,b===this.Bc.currentNode);
Vc.a(8701091,307,ea.ParagraphReader.Bh(this.Bc))}eca(){Vc.a(8701120,307,!!this.oA);Vc.a(8701121,307,ea.ParagraphReader.Bh(this.Bc));Ga.OutlineElementNavigator.he(this.Bc)}cca(){Vc.a(8701122,307,!!this.oA);Vc.a(8701123,307,ea.ParagraphReader.Bh(this.Bc));Vc.a(8701124,307,!this.oA.fY);var b=this.Bc.currentNode;ea.ParagraphReader.textLength(b)&&(b=Nd.a.zx(b),this.oA.rg.Ne(b,", "))}bca(){Vc.a(8701125,307,!!this.oA);Vc.a(8701126,307,ea.ParagraphReader.Bh(this.Bc));Vc.a(8701127,307,0>=this.oA.fY);this.oA.mpf()}static get Kf(){return null!=
px.d2g?px.d2g:px.d2g=Ya.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(u.a)(px,"TextOnlyBox4TableSteward",null,[632,307]);class wz{constructor(b,h,n=!1,B=!1){this.MM=b;this.vG=h;this.AIk=n;this.HIk=B}create(b,h){return 1===b?new px(h,this.MM,this.vG):new ww(h,this.MM,this.vG,this.AIk,this.HIk)}}Object(u.a)(wz,"Box4TableStewardFactory",null,[625]);class qC{create(){return new Ml.a}}Object(u.a)(qC,"Factory",null,[623]);class xz{constructor(){this.tlh=!1}get Oae(){return this.tlh}set Oae(b){this.tlh=
b}}Object(u.a)(xz,"HighContrastColorPickerState",null,[622]);class Jt{constructor(b){this.ga=b}get Sb(){return this.ga}Nhl(b,h,n=null){const B=new Og.DictionaryPropertySet;B.setValue(zd.a.cC,b);B.setValue(zd.a.jYa,h);n&&B.Bv(n);B.CommandSource="autobulleting";this.Sb.Pb(wb.a.WE,2,B)}USn(b,h,n,B,L){const ba=new Og.DictionaryPropertySet;ba.setValue(zd.a.cC,b);ba.setValue(zd.a.jYa,h);ba.setValue(zd.a.hbb,n);L&&ba.setValue(hi.a.JT,L);B&&ba.setValue(Lc.a.Tw,B);ba.setValue(hi.a.jua,"autocorrect");L&&ba.setValue(hi.a.nma,
L);ba.CommandSource="autonumbering";return 32===this.Sb.Pb(wb.a.XN,2,ba)}}Object(u.a)(Jt,"ListCommands",null,[621]);var Mq=d(120);class aE{constructor(b,h,n,B,L){this.rm=b;this.fTn=h;this.Lj=n;this.Md=B;this.rg=L}get Bij(){return this.fTn.value}execute(b,h,n,B){const L=Yc.a.instance.rq(wb.a.hVo);xb.OutlineElementReader.isEmpty(b,!1)?this.T3l(b):this.U3l(b,h,n,B);L.end()}T3l(b){this.Bij.Hnf(b,-1)?this.Bij.xZa(b,-1,0):this.rm.ona(b,{wCj:!0})}U3l(b,h,n,B){h=B(b,h,n);b=ea.ParagraphReader.Zl(b.currentNode);
!this.rm.T0b&&this.Usn(b)&&this.h_k(h);this.rm.u9();(null===b||void 0===b?0:b.qa)&&!b.qa.last.formatting&&this.rg.m8a(b)}Usn(b){return b.Yi&&!b.Kx.hasProperty(Lc.a.listID)}h_k(b){Ga.OutlineElementNavigator.Le(b);b=b.currentNode;const h=new Mq.a;b.Lc.ou(h);this.Lj.wY(b,h,this.Md.Mg)}}Object(u.a)(aE,"ListNewLineStrategy",null,[]);var zy=d(551);class Dw{constructor(b){this.ga=b}KNn(b){if(4===b)b=wb.a.iMa;else if(2===b)b=wb.a.tna;else if(1===b)b=wb.a.p2b;else if(3===b)b=wb.a.Z7a;else return;this.ga.Ob(b,
2)}s8a(){this.ga.Ob(wb.a.s8a,2)}}Object(u.a)(Dw,"SelectionCommands",null,[620]);var Ay=d(244),rC=d(1185),yz=d(152),bE=d(516);class zz{constructor(){this.Iad=!1;this.yEp=A.AFrameworkApplication.K.kb("WordEditorVisiFontFileUri");this.AEp=A.AFrameworkApplication.K.kb("WordEditorVisiRtlFontFileUri");this.zEp=A.AFrameworkApplication.K.kb("WordEditorVisiPilcrowFontFileUri");this.vEp=A.AFrameworkApplication.K.kb("WordEditorVisiCarriageReturnFontFileUri");this.xEp=A.AFrameworkApplication.K.kb("WordEditorVisiCarriageReturnRtlFontFileUri")}clp(){this.Iad=
!this.Iad}blp(b){this.clp();let h=b.getElementsByClassName("VisiFontStyle")[0],n=b.getElementsByClassName("VisiFontRtlStyle")[0],B=b.getElementsByClassName("VisiFontPilcrowStyle")[0],L=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],ba=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),h.className="VisiFontStyle",Lh.a.Ox(h,""),b.appendChild(h));n||(n=document.createElement("Style"),n.className="VisiFontRtlStyle",Lh.a.Ox(n,""),b.appendChild(n));
B||(B=document.createElement("Style"),B.className="VisiFontPilcrowStyle",Lh.a.Ox(B,""),b.appendChild(B));L||(L=document.createElement("Style"),L.className="VisiFontCarriageReturnStyle",Lh.a.Ox(L,""),b.appendChild(L));ba||(ba=document.createElement("Style"),ba.className="VisiFontCarriageReturnRtlStyle",Lh.a.Ox(ba,""),b.appendChild(ba));if(this.Iad)return x.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.wTc(h)&&this.wTc(n)&&this.wTc(B)&&this.wTc(L)&&this.wTc(ba);x.ULS.sendTraceTag(593294046,
324,50,"Formatting markers are removed");return this.Xkd(h)&&this.Xkd(n)&&this.Xkd(B)&&this.Xkd(L)&&this.Xkd(ba)}wTc(b){return""===Lh.a.Vz(b)?("VisiFontStyle"===b.className?Lh.a.Ox(b,this.h3c("WordVisi_MSFontService",this.yEp)):"VisiFontRtlStyle"===b.className?Lh.a.Ox(b,this.h3c("WordVisiRtl_MSFontService",this.AEp)):"VisiFontPilcrowStyle"===b.className?Lh.a.Ox(b,this.h3c("WordVisiPilcrow_MSFontService",this.zEp)):"VisiFontCarriageReturnStyle"===b.className?Lh.a.Ox(b,this.h3c("WordVisiCarriageReturn_MSFontService",
this.vEp)):"VisiFontCarriageReturnRtlStyle"===b.className&&Lh.a.Ox(b,this.h3c("WordVisiCarriageReturnRtl_MSFontService",this.xEp)),!0):!1}Xkd(b){return""!==Lh.a.Vz(b)?(Lh.a.Ox(b,""),!0):!1}h3c(b,h){return"@font-face { font-family: "+b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(u.a)(zz,"VisiMarkersOperation",null,[618]);var sC=d(486),Zs=d(403);class Rp extends sC.a{constructor(b,h){super(b,h);this.oWe=-1;this.CDb=0;this.aTe=null;this.Fmh=!1;
this.mUe=[];this.fFd=!1;this.Tvh=!0;this.J2e=this.$Cd=null;this.preventDismissOnScroll=this.fre=this.suc=!1;this.Baa=null;this.dPd=!1;this.g6c=!0;this.Wt=!1;this.Yoh=A.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");Rp.GBh||(A.AFrameworkApplication.va.ra(Pa.a.showFloatie,id.a.frame,Ce.ActionManager.Zf),Rp.GBh=!0)}get Ppi(){return this.TQ}set Ppi(b){this.TQ=b}get X1j(){return this.dPd}get s7c(){return this.Fmh}set s7c(b){this.Fmh=b;this.CDb=0}get tC(){return!0}get cssClass(){return A.AFrameworkApplication.ua&&
A.AFrameworkApplication.ua.Ib.Gba?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.Wt}v_a(){for(const b of this.children)if(b.v_a())return!0;return!1}get Cca(){return 9}Uf(b){this.mUe[this.mUe.length]=b;super.Uf(b)}xn(){super.xn();Kf.c(this.Qc)&&this.pE();this.Qc=ng.a.WZa(this.Qc);this.d_(this.Qc);this.dirty=!1}Isc(b){3===b.Ag||this.fre||this.dismissFloatie(b);return!1}Lsc(){return!1}Jsc(b){3!==b.Ag&&this.g6c&&!this.suc&&this.jyp(b);return!1}Ksc(){return!1}Gsc(b){3===b.Ag&&
this.dismissFloatie(b);return!1}Hsc(b){void 0!==this.Baa&&null!==this.Baa||this.preventDismissOnScroll||this.dismissFloatie(b);return!1}zE(){this.kBf();return!1}xne(){this.s7c=!0}jyp(b){if(b=Se.a.hhc(b.clientPoint,this.aTe)){if(this.s7c){if(!this.CDb||b<this.CDb)this.CDb=b;b-=this.CDb}b-=this.oWe;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.dismissFloatie():X.a.setOpacity(this.Qc,Math.max(h/255,0))}else this.s7c=!1,this.CDb=0,X.a.setOpacity(this.Qc,1)}ywp(b){let h=null;void 0!==this.$Cd&&null!==
this.$Cd&&(h=this.$Cd(b));b=null;for(const n of this.mUe){let B=!this.X1j&&n.H3i;if(!B&&void 0!==h&&null!==h)for(let L=0;L<h.length;L++)if(n.id===h[L]){B=!0;break}n.Qc.style.display=B?"none":"";n.ehc=!B;B||(b=n)}b&&(b.ehc=!1)}Qyi(){const b=this.Qc.style.top,h=this.Qc.style.left;this.Qc.style.top="0px";this.Qc.style.left="0px";const n=this.KPb();this.Qc.style.top=b;this.Qc.style.left=h;return n}KPb(){const b=this.Qc.style.visibility,h=this.Qc.style.display;this.Qc.style.visibility="hidden";this.Qc.style.display=
"";const n=$c.a.getElementBounds(this.Qc);this.Qc.style.display=h;this.Qc.style.visibility=b;return n}eAj(b){3===b||this.IDe?(Sys.UI.DomElement.addCssClass(this.Qc,Zs.a.U1b),this.dPd=!0):(Sys.UI.DomElement.removeCssClass(this.Qc,Zs.a.U1b),this.dPd=!1);this.ywp(b)}xeb(b,h,n,B=!1){this.isVisible||(this.Baa||!this.Tvh&&this.preventDismissOnScroll||(this.Tvh=!1,$c.a.Zje("ShowLegacyFloatie",""),A.AFrameworkApplication.va.Ob(Pa.a.showFloatie,2)),this.eAj(n),this.g6c=!0,this.CDb=0,this.s7c=!1,!this.Yoh||
void 0!==this.Baa&&null!==this.Baa?(this.fFd=!1,this.Oja(this,!1)):(this.fFd=!0,this.ecl(this)),h=B?b:this.Sco(b,h),this.Qc.style.top=h.y.toString()+"px",this.Qc.style.left=h.x.toString()+"px",this.nv(),this.aTe=this.KPb(),this.oWe=Se.a.hhc(b,this.aTe),X.a.setOpacity(this.Qc,1),this.Qc.style.zIndex=String(A.AFrameworkApplication.ua.Zya),this.Qc.style.display="",this.Wt=!0)}Sco(b,h){const n=this.X1j?30:17,B=this.Qyi(),L=Lh.a.srb(),ba=Lh.a.nX();b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=B.height:3===h?
(b.y-=B.height,b.x-=B.width):2===h&&(b.x-=B.width);b.x+B.width>L&&(b.x=Math.floor(L-B.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-n:b.y+n;0>b.y&&(b.y=0);b.y+B.height>ba&&(b.y=ba-B.height);return b}Tco(b,h){const n=b.Sdj;if(n){this.eAj(h);var B=this.Qyi();this.Baa=b;b=n.vOg-n.k1c>B.width;var L=n.k1c+n.SEf>B.width,ba=n.Sic>B.height+17,la=n.Kak-(n.Sic+n.OEf)>B.height+17;B=new Sys.UI.Point(n.k1c,n.Sic);L||b||(L=!0,B.x=n.vOg);b=n.lub?n.E3f?la?L?2:0:L?3:1:ba?L?3:1:L?2:0:n.E3f?la?b?0:2:b?1:3:ba?b?1:3:b?
0:2;if(3===b||2===b)B.x=n.k1c+n.SEf;if(2===b||0===b)B.y=n.Sic+n.OEf;this.xeb(B,b,h);this.g6c=!1;h=this.Baa.pef.Qc;void 0!==h&&null!==h&&(h.style.zIndex=String(A.AFrameworkApplication.ua.Zya))}}Y6(){let b=super.Y6();this.dismissFloatie()&&(b=!0);return b}dismissFloatie(b=null){if(!this.isVisible)return!1;void 0!==this.iSc&&null!==this.iSc&&this.iSc.vAa(null);void 0!==this.Baa&&null!==this.Baa&&this.Baa.P6();this.P6();this.Yoh&&this.fFd?this.h0l(this):this.ofa(this,!1);this.fFd=!1;this.oWe=-1;this.Baa=
null;this.Qc.style.display="none";this.Wt=!1;this.J2e&&this.J2e(b);return!0}kBf(){void 0!==this.Baa&&null!==this.Baa&&(this.Baa.P5a=null,this.Baa.P6(),this.Baa=null,this.uke.style.zIndex=String(A.AFrameworkApplication.ua.fIa),this.Qc.style.zIndex=String(A.AFrameworkApplication.ua.Zya))}cuo(b){this.$Cd=b}Uuo(b){this.J2e=b}set tC(b){super.tC=b}}Rp.GBh=!1;Object(u.a)(Rp,"Floatie",sC.a,[557,243,244]);class OA{constructor(b,h){this.yw=this.rRa=null;this.ebj=b;this.CIj=h}get Rpi(){return this.rRa}h_o(b){this.rRa=
b}KPb(){return this.yw.KPb()}D3(){return this.yw?this.yw.isVisible:!1}qWh(b){this.h_o(b)}showFloatie(b,h){this.xeb(h.location,h.iz,h.isRtl)}xeb(b,h,n){n=n?this.CIj:this.ebj;this.I1d();this.yw&&this.yw.xeb(b,n,h)}dismissFloatie(){this.yw&&this.yw.dismissFloatie()}I1d(){this.rRa&&!this.yw&&(this.yw=Object(ya.a)(Rp,this.rRa()))}v2d(){}}Object(u.a)(OA,"AFloatieManager",null,[631]);class av extends OA{constructor(){super(1,3);this.d0j=!1;this.wfi=""}xeb(b,h,n){n=n?this.CIj:this.ebj;this.I1d();this.yw&&
(this.yw.isVisible&&this.yw.dismissFloatie(),this.d0j||this.yw.wn(),this.yw.xeb(b,n,h,!0))}I1d(){this.Rpi&&!this.yw&&(this.yw=this.rRa())}v2d(){if(this.yw&&this.yw.isVisible){const b=Object(ya.a)(Ko.a,this.yw.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.oy(b.Jqb(),1,null)}}MAg(b){this.wfi=b}JBo(b){b=b.eJf("Menu16",null);kh.a("renderIcon")&&b&&appChrome.api.renderIcon(av.ntk,b.firstElementChild)}eBc(b,h,n){if(this.yw){const B=this.yw.controls[this.wfi];B&&(av.voh||(this.JBo(B),av.voh=!0),B.Sd[Yh.a.labelText]=
b,B.Sd[Yh.a.alt]=h,n&&B.behavior.wn())}}}av.voh=!1;av.ntk="Designer_20";Object(u.a)(av,"PasteFloatieManager",OA,[]);var By=d(1131);class Cy{constructor(){this.Od=null}get Av(){return null}getTitle(){return null}qxi(){return null}reset(b){this.Od=b.node}$Ea(b){b=tn.d(this.Od,b);let h=null;if(!b||b.Jh!==this.Jh)return{returnValue:!1,zG:h};h=Object.assign(new By.a,{UF:this.key,contentObject:b,title:this.getTitle(b),description:this.qxi(b)});return{returnValue:!0,zG:h}}}Object(u.a)(Cy,"BlobDetailsProvider",
null,[405,406]);class Iv extends Cy{constructor(){super()}get key(){return"EQUATION"}get Jh(){return 11}get Av(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(u.a)(Iv,"EquationDetailsProvider",Cy,[]);class cE{constructor(){this.fmh=null}get key(){return"LINK"}get Av(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.fmh=ef.a.lkc(b.node)}$Ea(b){let h=null;for(const n of this.fmh)if(n.cpBegin<=b&&b<n.cpEnd)return h=Object.assign(new By.a,{UF:this.key,contentObject:n.hyperlink}),
{returnValue:!0,zG:h};return{returnValue:!1,zG:h}}}Object(u.a)(cE,"HyperlinkDetailsProvider",null,[405,406]);var Kt=d(1427),yx=d(979);class dE{constructor(){this.lrh=!1}get key(){return"IFRAMENODE"}get Av(){return this.lrh?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}f2b(b){let h=null;b=b?ea.ParagraphReader.LKa(b.currentNode):null;if(!b)return{returnValue:!1,Zea:h};h=Object.assign(new Kt.a,{UF:this.key,contentId:b.id,contentObject:b});return{returnValue:!0,
Zea:h}}Fqb(b,h){b=b?Object(ya.a)(yx.a,b.contentObject):null;h=h?Object(ya.a)(yx.a,h.contentObject):null;let n="";h&&b.id===h.id||(this.lrh=b.Qab,n=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,b.Av,this.Av));return n}}Object(u.a)(dE,"IFrameDetailsProvider",null,[630,406]);class eE extends Cy{constructor(){super()}get key(){return"IMAGE"}get Jh(){return 5}reset(b,h){super.reset(b,h);this.MBk=!re.SelectionEditor.Dm(h)}get Av(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return Ad.ImageReader.O_(b.properties)}qxi(b){b=
Ad.ImageReader.eWa(b.properties);return this.MBk&&(A.AFrameworkApplication.Ld("51a6c128;f7eb8687"),A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImageSelectionAnnouncement",!1))?String.format(Box4Intl.Box4Strings.l_ContentSelectedNotificationFormat,b):b}}Object(u.a)(eE,"ImageDetailsProvider",Cy,[]);class fE{get key(){return"IMAGENODE"}get Av(){return Box4Intl.Box4Strings.l_ImageContentTitle}f2b(b){let h=null;if(!b||!Ad.ImageReader.Lt(b.currentNode))return{returnValue:!1,
Zea:h};h=Object.assign(new Kt.a,{UF:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,Zea:h}}Fqb(b,h){b=b.contentObject;const n=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let B="";h&&b.id===h.contentObject.id||(B=String.format(n,Ad.ImageReader.O_(b.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return B}}Object(u.a)(fE,"ImageNodeDetailsProvider",null,[630,406]);var tG=d(1168);let Jv,Ew;class cu{constructor(b,h){this.Ygh=null;this.so=h;this.E5e=
b;this.key=cu.keys.J(b);this.Av=cu.ksf.J(b)}reset(b){this.Ygh=this.so.u7(b.node);tG.a.S1e++}$Ea(b){var h=cu.pEf(this.Ygh||[],n=>this.pgn(b,n));h=this.AEl(h);return{returnValue:!!h,zG:h}}pgn(b,h){return h.Fc<=b&&b<h.end&&(!h.errorDetails||this.E5e===h.errorDetails.proofingType)}AEl(b){return b?Object.assign(new By.a,{UF:this.key,contentObject:b.errorDetails,description:this.RVa()}):null}RVa(){return mn.a.ULa?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static pEf(b,h){for(const n of b)if(h(n))return n;
return null}}cu.keys=(Ew=new Cf.a,Ew.add(1,"SPELLINGERROR"),Ew.add(2,"GRAMMATICALERROR"),Ew.add(3,"ADVANCEDERROR"),Ew);cu.ksf=(Jv=new Cf.a,Jv.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Jv.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),Jv.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),Jv);Object(u.a)(cu,"ProofingDetailsProvider",null,[405,406]);class uG{constructor(){this.xp=null;this.CWd=this.Sve=this.columns=this.rows=0}}Object(u.a)(uG,"TableInfo",null,[]);
class zx{get key(){return"TABLE"}get Av(){return Box4Intl.Box4Strings.l_TableContentTitle}f2b(b){var h=null;if(!Ng.TableCellReader.isTableCell(b))return{returnValue:!1,Zea:h};h=new ve.GraphIterator;h.hd(b);b=new uG;b.Sve=Le.a.Jt(h)+1;b.CWd=tx.a(h)+1;qh.returnToContainingTable(h);b.xp=h.currentNode;b.columns=xh.TableReader.Fh(b.xp);b.rows=xh.TableReader.xg(b.xp);h=Object.assign(new Kt.a,{UF:this.key,contentId:b.xp.id,contentObject:b});return{returnValue:!0,Zea:h}}Fqb(b,h){b=b.contentObject;const n=
new Ei.a;h||n.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));h&&h.contentObject.CWd===b.CWd||n.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.CWd));h&&h.contentObject.Sve===b.Sve||n.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.Sve));return n.toArray().join(" ")}}Object(u.a)(zx,"TableDetailsProvider",null,[630,406]);class Kv{constructor(b,h){this.vRa=b;this.so=h}get F2b(){return null!=this.R6g?this.R6g:this.R6g=
A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}irg(){this.vRa.execute(b=>{b.kY(new cE);mn.a.wXf()||(this.F2b||(b.kY(new cu(1,this.so)),b.kY(new cu(2,this.so))),b.kY(new cu(3,this.so)));b.kY(new Iv);b.kY(new eE);b.iZb(new zx);b.iZb(new fE);b.iZb(new dE)})}}Object(u.a)(Kv,"AccessibilityActor",null,[]);class Az{constructor(b,h,n){this.T4n=(B,L,ba)=>{if(1===ba)return 32;this.Mok().KDg();return 32};this.t5a=b;this.Mok=n}Wb(){this.t5a.fb(wb.a.Cpj,
oc.a.view,this.T4n,1028)}}Object(u.a)(Az,"AutoCorrectActor",null,[]);class Bz{constructor(){this.Tje=!0}kDa(){}jcb(){}Pdc(){}Egg(){}Rxe(){}get Vtc(){return!1}get qvb(){return 0}get kdj(){return!1}get v_(){return yb.a.nil}}Object(u.a)(Bz,"TextOnlyBox4ImageSteward",null,[443]);class Cz{constructor(b,h,n,B,L,ba,la=!1){this.KR=b;this.Qi=h;this.tg=n;this.w3m=B;this.nK=L;this.rc=ba;this.BBn=la}create(b,h,n,B){return 1===b?new Bz:new rp.a(h,this.KR,this.Qi,this.tg,this.rc,this.w3m,this.nK,this.BBn,n,B)}}
Object(u.a)(Cz,"Box4ImageStewardFactory",null,[617]);var mo=d(38);class Lv{constructor(b){this.Hfe=b}Nnn(b){if(!b||!b.mD||1>b.mD.count)return!1;const h=[mo.a.dci,mo.a.cci];return!!this.L5d(b.mD,1,n=>this.AXd(n,h))}QXi(b){return!b||!b.mD||1>b.mD.count?!1:!!this.L5d(b.mD,1,h=>this.AXd(h,[mo.a.jI]))}Kkn(b){return!b||!b.mD||1>b.mD.count?!1:!!this.L5d(b.mD,2,h=>this.AXd(h,[mo.a.Ebd]))}Bh(b){return!b||!b.mD||1>b.mD.count?!1:!!this.L5d(b.mD,1,h=>this.AXd(h,[mo.a.Sma]))}vee(b){if(!b||!b.mD)return!1;b=b.mD;
for(let h=0;h<b.count;++h)if(!b.J(h)||0<b.J(h).pal)return!1;return!0}Q2l(b,h){return this.QXi(h)||this.Kkn(h)?"":b}L5d(b,h,n){if(b&&0<b.count)for(let B=b.count-1;0<=B;--B){if(n(b.J(B)))return b.J(B);if(b.count-B>=h)break}return null}AXd(b,h){b=b&&b.NPi?b.NPi.split(" "):null;if(!b)return!1;for(const n of h)if(0<=Array.indexOf(b,n))return!0;return!1}}Object(u.a)(Lv,"Box4PasteStewardUtils",null,[616]);var Mv=d(789);class tC{constructor(){this.RAc=0;this.Lqc=Array(9)}}Object(u.a)(tC,"FullListMetadata",
null,[]);class PA{constructor(b,h,n){this.RAc=this.level=0;this.jni=null;this.Ktc=!1;this.level=b;this.dHe=h;this.b6n=n}}Object(u.a)(PA,"ListItemMetadata",null,[]);var Dz=d(1428);class vG{constructor(){this.level=0;this.tagName="UL";this.Uub=null;this.hUf=!1;this.KSn=0;this.listStyle="BulletListStyle1";this.xub=new Dz.a;this.font=this.levelText=""}}Object(u.a)(vG,"ListLevelMetadata",null,[]);class wG{constructor(){}}Object(u.a)(wG,"LevelLists",null,[]);class Qr{constructor(b){this.nodes=b;this.RUa=
0;this.lists={};this.xub=[];this.L5i=null;this.mMl=[];this.mMl[0]=new wG}}Object(u.a)(Qr,"WordConverterArguments",null,[]);var Rn=d(400),Gu=d(752);class gl{}gl.fNl="data-ccp-timestamp";gl.RZd="data-clipservice-ccpid";gl.iNl="data-shapeids";gl.QSm="docs-internal-guid-";gl.E4n="SCXO";gl.tdo="SCXP";gl.RGp="SCXW";gl.FOn="MsoListParagraphCxSpFirst";gl.GOn="MsoListParagraphCxSpLast";gl.awf="data-pkey";gl.bwf="data-clipservice-type";gl.Zvf="data-clipservice-count";gl.$vf="data-clipservice-dc";gl.vYc="data-clipservice-client";
gl.cwf="data-clipservice-version";Object(u.a)(gl,"HtmlContentMetadataConstants",null,[]);class Dy{constructor(){this.y=this.x=0;this.top=this.left=null}}Object(u.a)(Dy,"AbsolutePosition",null,[]);var du=d(934);class bv{constructor(b,h,n="",B=0){this.Ny=!1;this.Tlh=this.Ulh=null;let L=!1;bv.Tjn(b)&&(L=!0,this.Ulh=b);bv.lkn(h)&&(this.Tlh=h);this.Fyk=n;this.tok=B;this.Ny=L&&this.Xae?!0:!1}get isValid(){return this.Ny}get QPi(){return this.Ulh}get Xae(){return this.Tlh}get NPi(){return this.Fyk}get pal(){return this.tok}static Tjn(b){return b?
-1===b.indexOf(" ")&&0<b.length:!0}static lkn(b){return b?-1===b.indexOf(" ")&&0<b.length:!1}}Object(u.a)(bv,"HtmlElementInfo",null,[]);class LI{constructor(b){this.next=null;this.data=b}}Object(u.a)(LI,"StackNode",null,[]);class uC{constructor(){this.Ir=null;this.Jk=0}get count(){return this.Jk}get isEmpty(){return!this.count||!this.Ir}push(b){b=new LI(b);b.next=this.Ir;this.Ir=b;this.Jk=this.count+1}L0(){return this.count&&this.Ir?this.Ir.data:null}pop(){if(!this.count||!this.Ir)return null;const b=
this.Ir;this.Ir=b.next;this.Jk=this.count-1;return b.data}clear(){this.Ir=null;this.Jk=0}toArray(){const b=Array(this.count);let h=this.Ir;for(let n=this.count-1;0<=n&&h;n--)b[n]=h.data,h=h.next;return b}}Object(u.a)(uC,"Stack",null,[]);class wk{constructor(b){this.Dj=b;this.VHc=this.gId=null;this.DAd=!1}get xZd(){return this.VHc.L0()}reset(){this.Dj.reset();this.gId=new uC;this.VHc=new uC;this.VHc.push(this.Dj.HYc);this.DAd=!1}pme(){this.DAd=!1}hM(b){this.DAd||(this.gId.push(null),this.DAd=!0);this.gId.push(b)}onClose(){for(;;){const b=
this.gId.pop();if(!b)break;b()}}YNj(){return!1}dSn(){this.jw(()=>!0)}jw(b){const h=this.xZd.clone();return b(h)?(this.VHc.push(h),this.Dj.VMa(h),this.hM(Object(z.a)(this,this.YXn,"onFormattingEnd")),!0):!1}LRf(b){if(Em.a.utb){let h=2;Rn.a.instance.Yd(()=>{h=this.oMi(b)},"AHT:HCA");return h}return this.oMi(b)}oMi(b){return b.style?this.jw(h=>this.YNj(h,b))?1:2:2}YXn(){this.VHc.pop();this.Dj.VMa(this.xZd)}Pga(){}hme(){return 2}ydg(){return 2}zdg(){return 2}Edg(){return 2}Tdg(){return 3}Vdg(){}ome(){return 2}Wdg(){}Xdg(){}Ydg(){return 2}rme(){return 2}sme(){return 2}meg(){return 2}tme(){}peg(){return 2}ume(){return 2}vme(){return 2}yme(){return 2}zme(){return 2}Ceg(){}Deg(){return 2}Gme(){return 2}Hme(){return 2}Kme(){return 2}Lme(){return 2}Nme(){return 2}Ome(){return 2}Pme(){return 2}Sme(){return 2}gfg(){return 2}Zme(){return 2}nfg(){return 2}pfg(){}qfg(){return 2}bne(){return 2}cne(){return 2}dne(){return 2}ene(){return 2}fne(){return 2}gne(){return 2}wfg(){return 3}hne(){}Cfg(){return 2}ine(){return 2}Efg(){return 3}lne(){}Jfg(){}mne(){return 2}Pfg(){return 3}one(){return 2}qne(){return 2}sne(){return 2}tne(){return 2}$fg(){}dgg(){return 3}vne(){return 2}onMenuOpen(){return 2}jgg(){}rgg(){return 2}sgg(){return 2}ugg(){return 3}Fne(){return 2}wgg(){return 2}Gne(){return 2}Kne(){return 2}Dgg(){}Sne(){return 2}Pgg(){return 2}Zne(){return 2}$ne(){return 2}fhg(){return 3}lhg(){return 2}koe(){return 2}loe(){return 2}ooe(){return 2}poe(){return 2}phg(){return 3}qoe(){return 2}toe(){return 2}voe(){return 2}thg(){return 2}agd(){return 2}xhg(){return 2}yhg(){return 2}yoe(){return 2}zhg(){return 2}Chg(){return 3}Doe(){return 2}Eoe(){return 2}Foe(){return 2}Goe(){return 2}Loe(){return 2}Ioe(){return 2}static nla(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(F.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static BFi(b){if(!b||""===b)return-1;const h=F.a.xh(b);if(-1!==h.indexOf("pt")){if(b=parseFloat(F.a.substring(b,0,h.indexOf("pt"))),!isNaN(b))return b}else if(-1!==h.indexOf("px")&&(b=parseFloat(F.a.substring(b,0,h.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static iCi(b){const h=wk.BFi(b);return-1===h?(x.ULS.sendTraceTag(508678240,307,50,`Unhandled unit or blank string , is blankstring => ${!b}`),-1):0>h?(x.ULS.sendTraceTag(508925786,
307,50,"Negative margin in px or pt"),-1):h}static bLm(b){return wk.BFi(b)}static YEi(b){return b&&""!==b?wk.nla(b):null}static QF(b){let h=null,n=null,B=null,L=null;b&&b.Df&&(h=wk.qU(b.Df,"id"),n=wk.qU(b.Df,"lang"),B=b.Df.tagName,b.f7k&&(L=Object.assign(new Dy,{x:wk.nla(b.Df.style.left),y:wk.nla(b.Df.style.top),left:wk.YEi(b.Df.style.left),top:wk.YEi(b.Df.style.top)})),void 0===h&&(h=""),void 0===n&&(n=""));return new du.a(new bv(h,B),b.mD,null,n,L)}static qU(b,h){return b[h]}}Object(u.a)(wk,"AHtmlTranslator",
null,[315]);class gE extends du.a{constructor(b,h,n,B=0,L=0,ba=null){super(ba?ba.jca:null,ba?ba.mD:null,ba?ba.xDa:null,ba?ba.cultureName:null,ba?ba.dIa:null);this.width=B;this.height=L}}Object(u.a)(gE,"AugmentationSemanticArgs",du.a,[]);var xG=d(1440);class Zm{constructor(){this.stop=this.color=null}}Object(u.a)(Zm,"ColorStopPair",null,[]);var vp=d(2092);class Yn{constructor(){this.direction=null;this.cWc=new Dz.a}ENi(){return!!this.direction&&0<this.direction.length}}Object(u.a)(Yn,"LinearGradient",
null,[]);class pt{constructor(){this.Unc=!1}}Object(u.a)(pt,"HtmlTranslatorContext",null,[]);var Ax=d(1966);class MI{constructor(b,h){this.spaceBefore=b;this.spaceAfter=h}}Object(u.a)(MI,"IndentationProperties",null,[]);var Is=d(1436);class Hu extends du.a{constructor(b,h,n,B,L=null,ba=0,la=null,La=null,fb=!1,Cb=!1,Lb=69905,$b=null){super($b?$b.jca:null,$b?$b.mD:null,$b?$b.xDa:null,$b?$b.cultureName:null,$b?$b.dIa:null);this.colSpan=b;this.rowSpan=h;this.width=n;this.tpc=Cb;this.height=B;this.Cab=
fb;this.shadingColor=L;this.verticalAlignment=ba;this.Una=la;this.eCe=La;this.oaa=Lb}}Object(u.a)(Hu,"TableCellSemanticArgs",du.a,[]);class hE extends du.a{constructor(b,h=null){super(h?h.jca:null,h?h.mD:null,h?h.xDa:null,h?h.cultureName:null,h?h.dIa:null);this.height=b}}Object(u.a)(hE,"TableRowSemanticArgs",du.a,[]);class Nv extends du.a{constructor(b,h,n,B,L,ba,la,La,fb,Cb=null,Lb=-1,$b=null){super($b?$b.jca:null,$b?$b.mD:null,$b?$b.xDa:null,$b?$b.cultureName:null,$b?$b.dIa:null);this.EWd=null;
this.rowCount=b;this.wnb=h;this.width=n;if(L)for(this.EWd=Array(L.length),b=0;b<L.length;++b)this.EWd[b]=L[b];this.HXf=ba;this.iHg=La;this.Cen=la;this.Cab=B;this.Obe=fb;this.styleId=Cb;this.tableLook=Lb}}Object(u.a)(Nv,"TableSemanticArgs",du.a,[]);var Vi=d(1452);let Nq;class Jm extends wk{constructor(b,h,n=new pt,B=null,L=null){super(b);this.settings=h;this.context=n;this.Wbd=B;this.vRb=L;this.vFb=null;this.NDk=Yb.a.l9("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",
7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.UOj=new Set(["DIV","P"])}get A7i(){return this.NDk}QBi(b,h){var n;if((n=b.style?b.style.listStyleType:"")&&""!==n&&(n=this.A7i[F.a.xh(n)])||(n=wk.qU(b,"type"))&&""!==n&&(n=this.A7i[n]))return n;if((n=b.tagName.toLowerCase())&&("ol"===n||"ul"===n)&&(b=b.className))if("ul"===n)switch(b=Jm.g$d(b,"BulletListStyle"),b){case "BulletListStyle1":return 3;
case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===n)switch(b=Jm.g$d(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return h}HBi(b){let h=-1,n=b.tagName.toLowerCase();if("ol"===n||"ul"===n){b=Lh.a.zyi(b,"li");if(!b)return h;n="li"}if("li"===n){h=(h=this.q5d(b,"data-aria-level",0))?h:-1;if(0<h)return h-1;if(b=Lh.a.zyi(b,"p"))return Jm.vym(b)-
1}return h}q5d(b,h,n){b=b.getAttribute(h);b=parseInt(b);return isNaN(b)||0>b?n:b}JZn(){this.vFb.pop();this.Dj.mDa()}H5c(b,h){this.jw(L=>L.vha(0,0));const n=this.QBi(b.Df,h?6:2);let B=1;h&&(B=this.q5d(b.Df,"start",1));h=!1;h=b.Df.getAttribute("data-pasteFromRc");(h=!!h&&"true"===h)&&b.Df.removeAttribute("data-pasteFromRc");(X.a.N7||X.a.uj)&&Jm.gWd(b.Df);b=new Is.a(n,B,wk.QF(b),0,-1,h);this.vFb.push(b);this.Dj.oDa(b);this.hM(Object(z.a)(this,this.JZn,"onListElementClose"));return 1}kKl(b,h,n){return(h=
h.getAttribute(n))?b.Guf(h):!1}reset(){super.reset();this.vFb=new uC}YNj(b,h){if(Em.a.utb){let n=!1;Rn.a.instance.Yd(()=>{n=this.ZNj(b,h)},"DHT:SFFA");return n}return this.ZNj(b,h)}ZNj(b,h){var n,B,L,ba,la,La;let fb=!1;try{var Cb=h.getAttribute("xml:lang")||wk.qU(h,"lang")}catch(tc){Cb=null}Cb&&""!==Cb&&(fb=b.bAg(Cb)||fb);(Cb=wk.qU(h,"dir"))&&(fb=b.xxc(Cb)||fb);if(this.settings.e2o(this.context)&&h.getAttribute)for(Cb=0;Cb<Jm.PYj.length;Cb++)fb=this.kKl(b,h,Jm.PYj[Cb])||fb;Cb=h.style;const Lb=window.performance.now();
var $b;Em.a.Gta?$b=null===(n=this.vRb)||void 0===n?void 0:n.x6l(h):Em.a.Xoc&&($b=getComputedStyle(h));Vi.a.FDe+=window.performance.now()-Lb;Vi.a.Ale+=1;Em.a.Bgk&&(Cb=getComputedStyle(h));if(Cb){if(Cb.fontWeight||h instanceof HTMLHeadingElement&&Em.a.Lee&&Em.a.Gta)n=F.a.sC(null!==(B=null===$b||void 0===$b?void 0:$b.fontWeight)&&void 0!==B?B:Cb.fontWeight),B=parseInt(n),isNaN(B)?"BOLD"===n?fb=b.SN(!0)||fb:"NORMAL"===n&&(fb=b.SN(!1)||fb):fb=600<=B?b.SN(!0)||fb:b.SN(!1)||fb;if(this.settings.ySj&&Cb.fontSize||
h instanceof HTMLHeadingElement&&Em.a.Lee&&Em.a.Gta)B=null!==(L=null===$b||void 0===$b?void 0:$b.fontSize)&&void 0!==L?L:Cb.fontSize,L=wk.bLm(B),0<L&&(fb=b.Ixe(Math.floor(2*L))||fb);if((null===(ba=A.AFrameworkApplication.K)||void 0===ba?0:ba.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&this.UOj.has(h.tagName)||h instanceof HTMLHeadingElement&&Em.a.Lee&&Em.a.Gta)if(ba=wk.iCi(null!==(la=null===$b||void 0===$b?void 0:$b.marginTop)&&void 0!==la?la:Cb.marginTop),
la=wk.iCi(null!==(La=null===$b||void 0===$b?void 0:$b.marginBottom)&&void 0!==La?La:Cb.marginBottom),-1!==ba||-1!==la)fb=b.vha(ba,la)||fb;this.settings.i2o(this.context)&&(this.settings.CSj&&h.getAttribute?(La=h.getAttribute("data-indent"))&&0<La.length&&(La=ri.a.qj(parseInt(La),0)+"px",fb=b.Hye(La)||fb):Cb.textIndent&&(fb=b.Hye(Cb.textIndent)||fb));this.settings.d2o(this.context)&&Cb.marginLeft&&(this.settings.CSj&&h.getAttribute?(La=h.getAttribute("data-margin"))&&0<La.length&&(fb=b.Ena(Cb.marginLeft)||
fb):"TABLE"!==h.tagName&&(fb=b.Ena(Cb.marginLeft)||fb));if(this.settings.g2o(this.context)&&(La=h.getAttribute("style"))&&""!==La)for(La=La.split(";"),la=0;la<La.length;la++)$b=La[la].trim(),$b.startsWith("tab-stops")&&(fb=b.SAg($b.replace("tab-stops:",""))||fb);this.settings.c2o(this.context)&&Cb.lineHeight&&(fb=b.QE(Cb.lineHeight)||fb);this.settings.$1o&&(La=Cb.textTransform?F.a.xh(Cb.textTransform):null,la=Cb,la=la.fontVariantCaps?F.a.xh(la.fontVariantCaps):null,$b=Cb.fontVariant?F.a.xh(Cb.fontVariant):
null,"uppercase"===La?fb=b.Mod("uppercase")||fb:"small-caps"===la||$b&&0<=$b.indexOf("small-caps")?fb=b.Mod("small-caps")||fb:this.settings.bml&&"none"===La&&(fb=b.Mod("none")||fb));this.settings.h2o(this.context)&&Cb.textAlign&&(fb=b.e0b(F.a.xh(Cb.textAlign))||fb);Cb.fontStyle&&(La=F.a.sC(Cb.fontStyle),"ITALIC"===La||"OBLIQUE"===La?fb=b.nyb(!0)||fb:"NORMAL"===La&&(fb=b.nyb(!1)||fb));La=Jm.XNm(h);if(Cb.textDecoration||La)la=F.a.xh(Cb.textDecoration||""),La=F.a.xh(La||""),h.parentNode&&h.parentNode.tagName&&
"a"===F.a.xh(h.parentNode.tagName)?($b=(h.querySelector(".TextRun")||h).className)&&-1<$b.indexOf("Underlined")&&(fb=b.Q8(!0)||fb):Cb.hnq||Jm.isUnderline(la)||Jm.isUnderline(La)?fb=b.Q8(!0)||fb:this.settings.ITj&&(fb=b.Q8(!1)||fb),Cb.gnq||Jm.e_i(la)||Jm.e_i(La)?fb=b.Gna(!0)||fb:this.settings.ITj&&(fb=b.Gna(!1)||fb);if(Cb.verticalAlign){La=F.a.sC(Cb.verticalAlign);la=this.foo(La);if("SUB"===La||this.settings.BSj(this.context)&&h.className&&-1<h.className.indexOf("Subscript")||0>la&&this.settings.gTj)fb=
b.uOa(!0)||fb;else if("SUPER"===La||this.settings.BSj(this.context)&&h.className&&-1<h.className.indexOf("Superscript")||0<la&&this.settings.gTj)fb=b.Kva(!0)||fb;this.settings.ySj&&("SUB"===La||"SUPER"===La)&&h.getAttribute&&(La=parseFloat(h.getAttribute("data-fontsize")),isNaN(La)||(fb=b.Ixe(Math.floor(2*La))||fb))}La=!1;A.AFrameworkApplication.K&&(La=A.AFrameworkApplication.K.$("CopyAndPasteFontTelemetryIsEnabled"));this.settings.b2o&&Cb.fontFamily&&(this.settings.k2o&&h.getAttribute?(la=h.getAttribute("data-usefontface"))&&
"true"===la&&(La&&x.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),fb=this.WNj(b,Cb.fontFamily,fb)):fb=this.WNj(b,Cb.fontFamily,fb));la=null;this.settings.a2o&&Cb.color&&(la=vp.a.Era(Cb.color));$b=!!la;this.settings.j2o(this.context)&&h.getAttribute&&(la=h.getAttribute("data-scheme-color"),la=null!==la?la:"",$b=""!==la||!this.context.Unc||Jm.Fsn(h));$b&&(fb=b.ax(la)||fb);!this.settings.Y1o||!Cb.backgroundColor||h.tagName&&Jm.chp.contains(F.a.sC(h.tagName))||(la=Cb.backgroundColor,fb=Em.a.Pen&&
this.UOj.has(h.tagName)?b.vod(vp.a.Era(la))||fb:b.uEa(vp.a.Era(la))||fb);if(this.settings.Z1o&&Cb.backgroundImage&&h.className&&-1<h.className.indexOf("Highlight")&&(Cb=Jm.GQm(Cb.backgroundImage))&&0<Cb.cWc.count){la=Cb.cWc.J(0).color;$b=!0;for(ba=0;ba<Cb.cWc.count&&($b=$b&&la===Cb.cWc.J(ba).color,$b);ba++);$b&&(La&&x.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),fb=b.uEa(vp.a.Era(la))||fb)}}this.settings.ASj(this.context)&&h.getAttribute&&(Cb=h.getAttribute("data-ccp-props"))&&(fb=
b.Mca(Cb)||fb);h.getAttribute&&((Cb=h.getAttribute("data-ccp-charstyle"))&&this.settings.Kyb&&(fb=b.pxe(Cb)||fb),(h=h.getAttribute("data-ccp-parastyle"))&&this.settings.Kyb&&(fb=b.pye(h)||fb));return fb}i4o(b){if(this.settings.j4o)for(b=b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<F.a.sC(b.className).indexOf("MSOCOM"))return!0;if("DIV"===F.a.sC(b.tagName))break;b=b.parentNode}return!1}WNj(b,h,n){h=Jm.Xgm(h);let B=!1,L=0;if(!h)return n;for(const ba of h){if(B=
b.$db(ba,this.settings.Nep))break;L++}1<h.length&&(B?x.ULS.sendTraceTag(508889217,307,50,"Secondary font matched from font-family at : {0} out of {1}",L+1,h.length):x.ULS.sendTraceTag(508889216,307,50,"Secondary fonts {0} available in font-family but no match found",h.length));return B||n}foo(b){let h=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(h=b));return h}Pga(b,h){"\u200b"===b&&(b="\u00a0");h&&h.Df&&this.i4o(h.Df)&&(b="");this.Dj.Pga(b,wk.QF(h))}hme(b){const h=wk.qU(b.Df,"href");return h&&""!==h?
(this.Dj.RYa(h,wk.QF(b)),this.hM(Object(z.a)(this.Dj,this.Dj.QYa,"onAnchorEnd")),1):2}ome(){return this.jw(b=>b.SN(!0))?1:2}rme(){return this.jw(b=>b.FRf())?1:2}sme(b){this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));return 1}tme(b){this.Dj.$ba(wk.QF(b))}ume(b){this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));return 1}yme(){return this.jw(b=>b.nyb(!0))?1:2}vme(b){this.jw(h=>h.e0b("center"));this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,
this.Dj.fH,"onParagraphEnd"));return 1}zme(){return this.jw(b=>b.$db("consolas"))?1:2}Hme(){return this.jw(b=>b.Gna(!0))?1:2}Gme(b){return this.H5c(b,!1)}Kme(){return this.jw(b=>b.nyb(!0))?1:2}Lme(b){return this.H5c(b,!1)}Nme(b){var h=b.Df.getAttribute("data-render-src");const n=b.Df.getAttribute("data-render-method");if(h&&""!==h&&n&&""!==n){const la=b.Df.getAttribute("data-render-fallback");let La=0,fb=0;if(b.Df.currentStyle){var B=b.Df.currentStyle.width,L=b.Df.currentStyle.height;B&&-1!==B.indexOf("px")&&
(B=parseInt(F.a.substring(B,0,B.indexOf("px"))),isNaN(B)||(La=B));L&&-1!==L.indexOf("px")&&(L=parseInt(F.a.substring(L,0,L.indexOf("px"))),isNaN(L)||(fb=L))}b=new gE(h,n,la,La,fb,wk.QF(b));this.Dj.jcb(b);return 2}(X.a.N7||X.a.uj)&&(h=b.Df.className.match(RegExp("^SCX[0-9a-zA-Z]+$")))&&h.length&&Jm.gWd(b.Df);const ba=b.Df.getAttribute("align");this.jw(la=>la.e0b(ba));this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));return 1}Ome(b){this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,
this.Dj.fH,"onParagraphEnd"));return 1}Pme(b){this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));return 1}Sme(){return this.jw(b=>b.nyb(!0))?1:2}Zme(b){return this.jw(h=>{var n=Jm.ftm(b.Df.getAttribute("face"));n=h.$db(n);h=h.ax(vp.a.Era(b.Df.getAttribute("color")));return n||h})?1:2}bne(b){this.jw(h=>this.settings.Kyb?h.pyb(1):h.ryb(1));this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));return 1}cne(b){this.jw(h=>this.settings.Kyb?h.pyb(2):
h.ryb(2));this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));return 1}dne(b){this.jw(h=>this.settings.Kyb?h.pyb(3):h.ryb(3));this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));return 1}ene(b){this.jw(h=>this.settings.Kyb?h.pyb(4):h.ryb(4));this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));return 1}fne(b){this.jw(h=>this.settings.Kyb?h.pyb(5):h.ryb(5));this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));
return 1}gne(b){this.jw(h=>this.settings.Kyb?h.pyb(6):h.ryb(6));this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));return 1}hne(b){this.Dj.$ba(wk.QF(b))}lne(b){var h=b.Df;const n=h.src,B=h.alt,L=h.N6p,ba=h.getAttribute("data-external-content-url");let la=0,La=0;h.style&&(la=wk.nla(h.style.width),La=wk.nla(h.style.height));la&&La||(la=h.width,La=h.height);let fb=0,Cb=0;b.Df.currentStyle&&(la||La||(la=wk.nla(b.Df.currentStyle.width),La=wk.nla(b.Df.currentStyle.height)),fb=
wk.nla(b.Df.currentStyle.maxWidth),Cb=wk.nla(b.Df.currentStyle.maxHeight));!Em.a.ukn||la&&La||(La=la=0);let Lb=null;const $b=h.getAttribute(gl.RZd);if($b&&(x.ULS.sendTraceTag(524038492,307,50,"Chart paste from xlo"),A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("ChartsPasteFromXLOIsEnabled"))){const tc=h.getAttribute(gl.awf),Nc=h.getAttribute(gl.bwf),dd=h.getAttribute(gl.Zvf),Hd=h.getAttribute(gl.$vf),xe=h.getAttribute(gl.vYc);h=h.getAttribute(gl.cwf);tc&&Hd&&(Lb=new xG.a($b,tc,Nc,dd,Hd,
xe,h))}b=new Ax.a(n,B,la,La,wk.QF(b),fb,Cb,L,null,ba,Lb);this.Dj.kDa(b)}ine(){return this.jw(b=>b.nyb(!0))?1:2}mne(){return this.jw(b=>b.Q8(!0))?1:2}one(){return this.jw(b=>b.$db("consolas"))?1:2}qne(b){this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));return 1}sne(b){this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));return 1}tne(b){let h;const n=this.QBi(b.Df,0);let B=this.q5d(b.Df,"value",0);0<this.vFb.count?h=this.vFb.L0():(h=new Is.a(2,
1,wk.QF(b)),B||(B=1));var L=Jm.Fym(b.Df,Is.a.Q4j);3!==L&&(h.gt=L);L=h.listLevel;let ba=h.listId;this.settings.zSj?(L=this.HBi(b.Df),L=0>L&&0>h.listLevel&&0<this.vFb.count?h.listLevel=this.vFb.count-1:h.listLevel=0<=L?L:h.listLevel,this.Wbd&&this.Wbd.b<L&&(this.Wbd.b=L)):0>L&&(L=h.listLevel=this.HBi(b.Df));1>ba&&(ba=h.listId=this.q5d(b.Df,Is.a.Qbd,0));b.Df.getAttribute(Is.a.fie)&&(h.levelText=b.Df.getAttribute(Is.a.fie));var la=b.Df.getAttribute(Is.a.r4f);la&&(h.font=la);la=!1;A.AFrameworkApplication.K&&
(la=A.AFrameworkApplication.K.$("FollowDestinationThemePasteIsEnabled"));if(la){var La=b.Df.getAttribute("data-charcodes");la=[];if(La&&""!==La)if(-1<La.indexOf(",")){La=La.split(",");for(var fb=0;fb<La.length;fb++)la.push(parseInt(La[fb]))}else la.push(parseInt(La));if(la&&0<la.length){La=Array(la.length);for(fb=0;fb<la.length;fb++)La[fb]=la[fb];h.Bof=La}(la=b.Df.getAttribute("data-buAutoNum"))&&0<la.length&&(h.buAutoNum=parseInt(la))}(L=0<=L&&0<ba)&&Jm.gWd(b.Df);h.d8k(n,B,L);h.p4f=this.jym(b.Df);
this.Dj.YMa(h.clone());this.hM(Object(z.a)(this.Dj,this.Dj.nDa,"onListItemEnd"));return 1}jym(b){var h=b.getAttribute(Is.a.k7i);if(!h)return null;b=void 0;try{b=JSON.parse(h)}catch{x.ULS.sendTraceTag(524038493,307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;h=new Og.DictionaryPropertySet;for(const n in b)h.mBg(+n,b[n]);return h}onMenuOpen(b){return this.H5c(b,!1)}vne(b){if(this.jw(h=>h.kxc(!0))){const h=b.Df.getAttribute("OuterHtml");
this.Dj.VYa(h,wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fcb,"onMathEnd"))}return 1}Fne(b){return this.H5c(b,!0)}Gne(b){this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));return 1}Kne(b){const h=b.Df.getAttribute("align");this.jw(B=>B.e0b(h));const n=b.Df.parentNode;n&&n.tagName.toLowerCase().startsWith("li")&&Jm.gWd(b.Df,X.a.N7||X.a.uj);this.Dj.MF(wk.QF(b));this.hM(Object(z.a)(this.Dj,this.Dj.fH,"onParagraphEnd"));return 1}Sne(){this.jw(b=>b.$db("consolas"));this.Dj.Pvb();
this.hM(Object(z.a)(this.Dj,this.Dj.Ovb,"onPreFormattedTextEnd"));return 1}Zne(){return this.jw(b=>b.Gna(!0))?1:2}$ne(){return this.jw(b=>b.$db("consolas"))?1:2}koe(){return this.jw(b=>b.lEg())?1:2}loe(b){var h=b.Df.attributes.getNamedItem("style"),n="";h&&h.value&&(n=h.value);h=vp.a.K9n(n);if(0<h&&this.settings.Z8m){for(n=0;n<h;n++)this.Dj.Tvb(wk.QF(b));return 3}return 2}ooe(){return this.jw(b=>b.Gna(!0))?1:2}poe(){return this.jw(b=>b.SN(!0))?1:2}qoe(){return this.jw(b=>b.uOa(!0))?1:2}toe(){return this.jw(b=>
b.Kva(!0))?1:2}voe(b){this.jw(Lb=>Lb.hE()&&Lb.avg());vp.a.S$d(b.Df,this);const h=vp.a.zKi(b.Df),n=vp.a.Sui(b.Df),B=vp.a.$J(b.Df),L=vp.a.FL(b.Df),ba=!parseInt(wk.qU(b.Df,"border")),la=vp.a.gsn(b.Df);let La=-1,fb="";var Cb=-1;b.Df.attributes.hasOwnProperty("style")&&-1!==(Cb=b.Df.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?La=parseInt(b.Df.attributes.getNamedItem("style").value.substr(Cb+17)):b.Df.attributes.hasOwnProperty(Gu.a.SZd.toString())&&(La=parseInt(b.Df.attributes.getNamedItem(Gu.a.SZd.toString()).value));
Cb=-1;b.Df.attributes.hasOwnProperty("class")&&-1!==(Cb=b.Df.attributes.getNamedItem("class").value.indexOf("Mso"))?fb=b.Df.attributes.getNamedItem("class").value.substr(Cb).split(" ")[0]:b.Df.attributes.hasOwnProperty(Gu.a.wYc.toString())&&(fb=b.Df.attributes.getNamedItem(Gu.a.wYc.toString()).value);this.Dj.fca(new Nv(0,0,h.value,h.G1i,null,ba,la,n,new MI(B.value,L.value),fb,La,wk.QF(b)));this.hM(Object(z.a)(this.Dj,this.Dj.dca,"onTableEnd"));return 1}agd(b){const h=vp.a.Kzi(b.Df),n=vp.a.zKi(b.Df);
if(!n.value&&n.yee&&this.settings.isj)return 3;let B=parseInt(wk.qU(b.Df,"colSpan"));if(void 0===B||null===B||""===B+"")B=n.value?1:0;let L=parseInt(wk.qU(b.Df,"rowSpan"));if(void 0===L||null===L||""===L+"")L=h.value?1:0;let ba=!1;b.Df.attributes.hasOwnProperty("style")&&(ba=-1!==b.Df.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==b.Df.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!ba&&b.Df.attributes.hasOwnProperty("class")&&
(ba=-1!==b.Df.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let la=69905;if(b.Df.attributes.hasOwnProperty(Gu.a.Yvf.toString())){var La=parseInt(b.Df.attributes.getNamedItem(Gu.a.Yvf.toString()).value);isNaN(La)||(la=La)}La=vp.a.Era(b.Df.style.backgroundColor);const fb=vp.a.LQm(b.Df);this.jw($b=>$b.vha(0,0));vp.a.S$d(b.Df,this);const Cb=vp.a.Sui(b.Df),Lb=this.settings.v$n?vp.a.Dkm(b.Df):null;b=new Hu(B,L,n.value,h.value,La,fb,Cb,Lb,n.G1i,ba,la,wk.QF(b));this.Dj.cca(b);this.hM(Object(z.a)(this.Dj,
this.Dj.bca,"onTableCellEnd"));this.dSn();return 1}yoe(b){const h=this.agd(b);if(3===h)return h;this.jw(n=>{const B=n.SN(!0);n=n.e0b("center");return B||n});vp.a.S$d(b.Df,this);return 1}Doe(b){vp.a.S$d(b.Df,this);const h=vp.a.Kzi(b.Df);if(h.yee&&!h.value&&this.settings.isj)return 3;this.Dj.p8(new hE(h.value,wk.QF(b)));this.hM(Object(z.a)(this.Dj,this.Dj.eca,"onTableRowEnd"));return 1}Eoe(){return this.jw(b=>b.$db("consolas"))?1:2}Foe(){return this.jw(b=>b.Q8(!0))?1:2}Goe(b){return this.H5c(b,!1)}Ioe(){return 2}Loe(){return this.jw(b=>
b.Q8(!0))?1:2}static Cqm(b){if(!b)return null;b=b.split(",");1<b.length&&x.ULS.sendTraceTag(508889187,307,50,"Secondary fonts available in font-family");return b[0]}static Vgm(b){return b?b.split(","):null}static e3j(b){if(!b)return null;b=F.a.Psg(b.trim(),'"');return b=F.a.Psg(b,"'")}static ftm(b){if(!b)return null;b=Jm.Cqm(b);return b=Jm.e3j(b)}static Xgm(b){var h;if(!b)return null;b=null===(h=Jm.Vgm(b))||void 0===h?void 0:h.map(n=>Jm.e3j(n));h=null===b||void 0===b?void 0:b.filter(n=>!!n);return null!==
h&&void 0!==h?h:null}static SOh(b,h){h=h.trim();var n=h.match(RegExp("^-?[0-9]+deg$"));if(n&&0<n.length){if(b.ENi())return!1;b.direction=h;return!0}if((n=h.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<n.length){if(b.ENi())return!1;b.direction=h;return!0}var B=(n=h.match(RegExp("^rgb\\(.*\\)")))&&0<n.length?h.indexOf(")")+1:h.indexOf(" ");n=-1===B?h:vp.a.Era(h.substr(0,B).trim());if(!n||""===n)return!1;h=-1===B?"":h.substr(B).trim();B=new Zm;B.color=n;
B.stop=h;b.cWc.add(B);return!0}static GQm(b){try{if(!b)return null;b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let h=b.substr(16);h=h.substr(0,h.lastIndexOf(")"));const n=new Yn;for(;0<h.trim().length;){let B=h.indexOf(",");const L=h.indexOf("(");if(0<L&&L<B){const ba=h.indexOf(")");if(ba<L)return null;B=h.indexOf(",",ba)}if(-1===B){if(!Jm.SOh(n,h))return null;h=""}else{const ba=h.substr(0,B);h=h.substr(B+1);if(!Jm.SOh(n,ba))return null}}return n}catch(h){return null}}static g$d(b,
h){b=b.split(" ");if(0<b.length)for(let n=0;n<b.length;n++)if(0<=b[n].indexOf(h))return b[n];return""}static gWd(b,h=!1){b&&3!==b.nodeType&&(b.style.margin="",h&&Jm.b3h(b,h))}static b3h(b,h){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&(b.style.margin=""),h&&Jm.b3h(b,h)),b=b.nextSibling}static vym(b){if("p"!==b.tagName.toLowerCase())return-1;if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let n=0;n<b.length;n++){var h=b[n].split(":");if(2===h.length&&
"mso-list"===h[0].trim()&&(h=h[1].trim().split(" "),3===h.length))return Number.parseInvariant(h[1].substr(5))}}return-1}static Fym(b,h){if(!b)return 3;switch(b.getAttribute(h)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;default:return 3}}static Fsn(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}static XNm(b){b=b.style.textDecorationLine;return void 0===b||null===b?null:b}static e_i(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=
b.indexOf("underline")}}Jm.chp=(Nq=new ob.a,Nq.add("TABLE"),Nq.add("THEAD"),Nq.add("TBODY"),Nq.add("TFOOT"),Nq.add("TR"),Nq.add("TH"),Nq.add("TD"),Nq);Jm.PYj=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn","data-ccp-parastyle-linked-defn"];Object(u.a)(Jm,"DefaultHtmlTranslator",wk,[]);var $q=d(1123);class Fl{constructor(b=null){this.t6=b||$q.a.DKi("");this.gwh=Number.parseInvariant((new Date).format("HHmmss"))}get Nc(){return this.t6}process(b,h){if(b&&b.querySelectorAll){const ba=
b.querySelectorAll("p");if(ba&&0<ba.length){for(var n=0,B=!1,L=ba[0].parentNode;5>n&&L&&L!==b;){n++;const la=L.id.toLowerCase();if(la&&la.length&&-1!==la.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(L,"WACEditing")&&Sys.UI.DomElement.containsCssClass(L,"EditingSurfaceBody")){B=!0;break}L=L.parentNode}if(B&&L!==b){n=b.firstChild;for(B=!1;0<L.children.length&&L.children[0]!==n;)b.insertBefore(L.children[0],n),B=!0;if(B)for(;n;)L=n.nextSibling,b.removeChild(n),n=L}b=new Mv.a(h,Object(z.a)(this,
this.gho,"processNodesDiscovery"),new Qr(ba));b.vm("Word Converter Operation");b.ni=!h||h.ni;b.run()}}}gho(b,h){const n=h.nodes[h.RUa];var B=Fl.pym(n);if(B){let ba=B.dHe.replace(RegExp("level[0-9]"),"").trim();ba=ba&&ba.length?ba:B.dHe;let la=h.lists[ba];la||(la=new tC,la.RAc=this.gwh++);let La=la.Lqc[B.level-1];La||(La=new vG,La.level=B.level);var L=n.parentNode;if(L&&"li"===L.tagName.toLowerCase()){if(L=L.parentNode)!(L=L.tagName.toUpperCase())||"OL"!==L&&"UL"!==L||(La.tagName=L)}else La.Uub=Fl.kyi(n,
5),La.Uub&&La.Uub.length||(La.Uub=Fl.DOf(n,5)),La.hUf=!La.Uub||!La.Uub.length,La.tagName=Fl.jyi(La.Uub),"UL"===La.tagName&&(La.font=this.Wyi(n,5));B.RAc=la.RAc;La.KSn++;La.hUf||"li"===n.parentNode.tagName.toLowerCase()||(L=(L=Fl.DOf(n,5))?L:La.Uub)&&L.length&&(B.jni=L,(L=Fl.qVo(n,L,La.listStyle,B.level-1))&&L.length&&(La.listStyle=L));h.xub[h.xub.length]=B;La.xub.contains(B)||La.xub.add(B);if(void 0===la.Lqc[B.level-1]||null===la.Lqc[B.level-1]||la.Lqc[B.level-1]!==La)la.Lqc[B.level-1]=La;h.lists[ba]&&
h.lists[ba]===la||(h.lists[ba]=la);h.L5i=n}else if((B=h.L5i)&&Fl.EHm(n)===B&&n.tagName===B.tagName&&n.className===B.className){B.appendChild(B.ownerDocument.createElement("BR"));for(B.appendChild(B.ownerDocument.createElement("BR"));n.firstChild;)B.appendChild(n.firstChild);n.parentNode.removeChild(n)}h.RUa++;if(h.nodes.length<=h.RUa){if(!h.xub.length)return!1;h.RUa=0;b.Ni(Object(z.a)(this,this.fho,"processNodeConvert"))}return!0}fho(b,h){b=h.xub[h.RUa];var n=b.b6n,B=b.dHe.replace(RegExp("level[0-9]"),
"").trim();B=B&&B.length?B:b.dHe;B=h.lists[B];var L=B.Lqc[b.level-1],ba=n.parentNode.tagName.toLowerCase();if(!L.hUf&&n.parentNode&&"li"!==ba){if(ba=Fl.aHl(n,L)){Fl.N2h(n,5);const la=n.ownerDocument.createElement("LI");la.setAttribute("data-aria-level",String.format("{0}",b.level));la.setAttribute(Is.a.Qbd,String.format("{0}",B.RAc));"UL"===L.tagName&&(la.setAttribute(Is.a.fie,String.format("{0}",b.jni)),la.setAttribute(Is.a.r4f,String.format("{0}",L.font)));for(;n.firstChild;)la.appendChild(n.firstChild);
ba.appendChild(la);n.parentNode.removeChild(n);"UL"===L.tagName?this.Nc.b++:this.Nc.c++}}else"li"===ba&&(L=L.tagName,n=n.parentNode,b.Ktc&&(b=n.parentNode)&&b.tagName.toUpperCase()===L&&b.setAttribute("data-pasteFromRc","true"),n.setAttribute(Is.a.Qbd,String.format("{0}",B.RAc)),"UL"===L?this.Nc.b++:this.Nc.c++);h.RUa++;return h.RUa<h.xub.length}Wyi(b,h){let n=null;for(let B=0;!n&&B<b.childNodes.length;B++){const L=b.childNodes[B];n=Fl.gtm(L);!n&&1===L.nodeType&&1<h&&(n=this.Wyi(L,h-1))}return n}static aHl(b,
h){b=Fl.$Gl(b,h.tagName);return Fl.sBl(b,h)}static sBl(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static $Gl(b,h){h=b.ownerDocument.createElement(h?h:"UL");var n=b.getAttribute("start");n&&0<n.length&&(h.setAttribute("start",n),b.removeAttribute("start"));Em.a.Oen&&(n=b.getAttribute("align")||b.style.textAlign)&&(h.style.textAlign=n);(n=b.className)&&
0<n.length&&(n="OL"===h.tagName?Jm.g$d(n,"NumberListStyle"):Jm.g$d(n,"BulletListStyle"),0<n.length&&(Sys.UI.DomElement.addCssClass(h,n),Sys.UI.DomElement.removeCssClass(b,n)));b.parentNode.insertBefore(h,b);return h}static N2h(b,h){for(let n=0;n<b.childNodes.length;n++){const B=b.childNodes[n];1===B.nodeType&&1<h&&Fl.N2h(B,h-1);if(Fl.Zhn(B)||Fl.pZi(B))b.removeChild(B),n--}}static pym(b){if(1===b.nodeType){var h=Fl.yOf(b,"mso-list");if(h&&0<h.length)try{var n=h.split(" ");if(3===n.length){const B=
Number.parseInvariant(n[1].substr(5)),L=new PA(B,h,b);L.Ktc=!0;return L}}catch(B){}else if((n=b.parentNode)&&"li"===n.tagName.toLocaleLowerCase()&&(h=n.getAttribute("data-"+Bc.a.Kjf),n=n.getAttribute(Is.a.Qbd),h&&n&&0<h.length&&0<n.length))return b=new PA(Number.parseInvariant(h),n+" level"+h,b),b.Ktc=!1,b}return null}static qVo(b,h,n,B){if("p"===b.tagName.toLowerCase()&&h&&h.length){if("UL"===Fl.jyi(h))return n=Fl.Ujm(h),Sys.UI.DomElement.addCssClass(b,n),n;var L=h.match(RegExp("^[0-9]+"));return L&&
L.length?(n="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,n),b.setAttribute("start",L[0]),n):(L=h.match(RegExp("^[a-zA-Z]+")))&&L.length&&(L=L[0],B=(h=L.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?Fl.IIm(n,B):1,1!==B&&((n=Fl.WXd(b,L,RegExp("^[ivxlcdm]+"),F.a.i8h,"NumberListStyle3"))||(n=Fl.WXd(b,L,RegExp("^[IVXLCDM]+"),F.a.i8h,"NumberListStyle5")))||B&&((n=Fl.WXd(b,L,RegExp("^[a-z]+"),F.a.g8h,"NumberListStyle2"))||(n=Fl.WXd(b,L,RegExp("^[A-Z]+"),F.a.g8h,"NumberListStyle4"))))?n:"NumberListStyle1"}return null}static Ujm(b){switch(b){case "o":return"BulletListStyle2";
case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static IIm(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static WXd(b,h,n,B,L){return(h=h.match(n))&&h.length?(B=B(h[0]),B=1>B?1:B,Sys.UI.DomElement.addCssClass(b,L),b.setAttribute("start",B+""),L):null}static jyi(b){return Fl.Len(b)?
"UL":"OL"}static Len(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static DOf(b,h){let n=null;var B;let L,ba;for(let la=-1;!n&&la<b.childNodes.length;la++){const La=-1===la?b:b.childNodes[la];if(La)if((B=La.innerHTML)&&0<B.length){if(L=B.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=L&&(ba=B.indexOf("\x3c!--[endif]--\x3e"),0<=ba)){B=B.substring(L,ba+14);La.innerHTML=La.innerHTML.replace(B,"");if(B.length){b=b.ownerDocument.createElement("span");
b.innerHTML=B;n=b.innerText.trim();break}n&&n.length||(n="o")}}else 0<=la&&1===La.nodeType&&1<h&&(n=Fl.DOf(La,h-1))}return n}static gtm(b){let h=null;1===b.nodeType&&((h=Fl.Vyi(b,"font-family"))||(h=Fl.Vyi(b,"mso-ascii-font-family")));return h}static Vyi(b,h){return(b=Fl.yOf(b,h))&&0<b.length?b.trim():null}static kyi(b,h){let n=null;for(let B=0;!n&&B<b.childNodes.length;B++){const L=b.childNodes[B];Fl.pZi(L)?(n="string"===typeof L.innerText?L.innerText.trim():L.textContent.trim(),n.length||(n="o"),
L.parentNode.removeChild(L)):1===L.nodeType&&1<h&&(n=Fl.kyi(L,h-1))}return n}static pZi(b){return 1===b.nodeType&&(b=Fl.yOf(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static Zhn(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static yOf(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let n=0;n<b.length;n++){const B=b[n].split(":");if(2===B.length&&B[0].trim()===h)return B[1].trim()}}return null}static EHm(b){do b=
b.previousSibling;while(b&&Fl.eYi(b));return b}static eYi(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(Fl.GDk,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:Fl.eYi(b.firstChild):!0}}Fl.GDk=RegExp("[\n|\r]","gi");Object(u.a)(Fl,"WacAndRichClientWordConverter",null,[309]);class QA{constructor(){}create(b=null){return new Fl(b)}}Object(u.a)(QA,"Box4WordConverterFactory",null,[543]);var NI=d(1879);class yG{constructor(b,h,n,B,L){this.Rgh=
0;this.cFp=ba=>{let la=!0;const La=this.nja.G1l;null!=La?(ba.Mua=La,la=!1):Date.now()-this.Rgh>this.oNe&&(x.ULS.sendTraceTag(18354843,307,50,null),this.vd.$b(Tf.a.usa,{["Reason"]:hf.a.Zpj}),la=ba.Mua=!1);return la};this.vd=b;this.ff=h;this.oNe=L;this.nja=n;this.kTa=B}Mpl(b,h,n){x.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,n,this.ff.eE);b.ni&&this.ff.Vr&&window.chrome&&x.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",
h);this.nja.I_c(!!(h&16));this.kTa.create(b,this.cFp,null).vm("ClipboardPreProcess");this.Rgh=Date.now()}YFo(){this.nja.reset()}}Object(u.a)(yG,"ClipboardOperationClipboardAccessHelper",null,[542]);var Js=d(402);class zG{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd,Hd){this.i3a=null;this.ga=b;this.vd=h;this.wB=n;this.Oh=B;this.hb=L;this.nja=ba;this.jb=la;this.Oe=La;this.Bo=fb;this.Zc=Cb;this.$jb=Lb;this.w6e=$b;this.tG=tc;this.Pk=dd;this.J7b=Nc?Nc.$("ImageDataURLSkippedForSafari12IsEnabled"):
!1;this.kFd=Nc?Nc.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.xd=Hd;this.Fe=ch.a.getInstance(Js.a.H6a)}get Kf(){return this.Oh}get Ec(){return this.vd}get d9c(){if(null==this.i3a)if(this.xd)if(this.xd.Ds.isCompleted)this.i3a=this.xd.isFeatureEnabled(2);else return!1;else this.i3a=!1;return this.i3a}WEp(b){b.lJ();return!0}M8h(b,h){b=h.ux;x.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let B=!1,L;this.d9c&&h.me&&h.me.Kh&&(B=this.Pk.QNh(h.me.Kh.editingElement));L=this.Pk.gSf(h.me.Kh.editingElement,
!1);var n=h.me.Kh.editingElement;this.Pk.fXf(n,!1,1);this.J7b&&X.a.Uta?(n=h.me.Kh.editingElement,this.Pk.bug(n,"data-src","data-srcurl"),b=this.nja.jE(),this.Pk.bug(n,"data-srcurl","data-src")):this.kFd&&h.me&&h.me.Kh?(n=this.Pk.tof(h.me.Kh.editingElement,h.me.ZC,!0),b=this.nja.jE(),n&&this.Pk.tof(h.me.Kh.editingElement,h.me.ZC,!1)):(this.Pk.xDj(h.me.Kh.editingElement),b=this.nja.jE());this.d9c&&B&&this.Pk.Kzo(h.me.Kh.editingElement);L&&this.Pk.gSf(h.me.Kh.editingElement,!0);n=h.me.Kh.editingElement;
this.Pk.fXf(n,!1,0);if(!b)return x.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,b.set("ErrorLevel","info"),this.Fe.logKpiFailure({kpiName:Js.a.lVd,errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),this.Ec.$b(Tf.a.oOb,{["Reason"]:hf.a.eHg}),h.cV&&h.cV.fail("SystemClipboard did not copy",!1),h.UB=!0,!1}return!0}Ksf(b,h){const n=h.me;x.ULS.shipAssertTag(18130961,307,!!(h.ux&16));h.v9o?this.wB.j3h():this.wB.oYd(n,b);return!0}Kei(b,
h){var n=h.context,B=h.rd;const L=h.Aca;var ba=!1;b=this.hb.gb.currentSelection.Uc;if(this.jb.nn(b)||this.Oe.gl(b)){const la=this.Zc.jg(b.node),La=la.Jd();x.ULS.shipAssertTag(18130962,307,La);this.Bo.he(la);this.$jb.ltb(la)&&(ba=!0)}B=h.ux&64?new Og.DictionaryPropertySet:B||new Og.DictionaryPropertySet;B.setValue(zd.a.EZc,!1);this.Fe.logKpiUsage({kpiName:Js.a.mVd});n=this.ga.lg(n,wb.a.SJ,2,!0,L,B);8===n&&(x.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Ec.$b(Tf.a.usa,{["Reason"]:hf.a.Jei}),
h.cV&&h.cV.fail("DeleteKey failed",!1),this.Fe.logKpiFailure({kpiName:Js.a.mVd,errorName:"DeleteForCutFailed"}),h.UB=!0);32===n&&this.Fe.logKpiSuccess({kpiName:Js.a.mVd});32===n&&ba&&(h=this.hb.gb.currentSelection,this.Oe.Dm(h)&&h.Ra.node===b.node&&!this.jb.textLength(h.Ra.node)&&(h=this.Zc.jg(h.Ra.node),b=this.Oe.rv(h),x.ULS.shipAssertTag(18130964,307,b),this.Bo.he(h),this.$jb.lee(h)||(b=this.w6e.create(),b.hd(h),this.Bo.Y3(b,!1,!1),ba=this.Bo.Le(b),this.jb.Xb(ba)&&(this.Bo.he(b),this.Kf.merge(b,
h,!1,!1),this.hb.Ic(this.tG.se(ba,this.jb.textLength(ba)))))));return!0}}Object(u.a)(zG,"ClipboardOperationCutCopy",null,[569]);class RA{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd,Hd){this.ga=b;this.vd=h;this.wB=n;this.nja=ba;this.hb=L;this.Oh=B;this.jb=la;this.Oe=La;this.Bo=fb;this.Zc=Cb;this.$jb=Lb;this.w6e=$b;this.tG=tc;this.Ga=Nc;this.Pk=dd;this.xd=Hd}create(){return new zG(this.ga,this.vd,this.wB,this.Oh,this.hb,this.nja,this.jb,this.Oe,this.Bo,this.Zc,this.$jb,this.w6e,this.tG,this.Ga,
this.Pk,this.xd)}}Object(u.a)(RA,"Factory",null,[541]);var iE=d(1790),hn=d(148);class jE{constructor(b,h){this.jFc=null;this.dCl=(n,B)=>{let L;if(hn.a.pga){if(!B.rd)return!1;L=B.rd.i5c;if(!L)return!1}else{if(!Object(Wb.a)(97,B.rd))return!1;const La=Object(ya.a)(97,B.rd);if(!La.hasProperty(zd.a.i5c))return!1;L=La.getValue(zd.a.i5c)}const ba=B.me,la=ba.lb;this.wB.w$j();la.d_b(()=>{la.Ic(L,void 0,!0);this.wB.oYd(ba,n)},!0);return!0};this.wB=b;this.v1=h;this.MK=0}process(b,h){this.MK||(this.jFc=[this.dCl,
Object(z.a)(this.v1,this.v1.o$n,"pasteGlossaryPlaceholder")],hn.a.pga&&this.jFc.push(Object(z.a)(this.v1,this.v1.JAg,"setSelectionAfterPaste")));let n=!0;this.MK<this.jFc.length&&(n=this.jFc[this.MK++](b,h));return n?this.MK<this.jFc.length:!1}}Object(u.a)(jE,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[568]);class Iu{constructor(b){this.DCb=null;this.t5=b;this.MK=-1}process(b,h){-1===this.MK&&(this.QMl(b,h),this.MK=0);let n=!1;this.MK<this.DCb.length&&(n=this.DCb[this.MK++](b,
h));return n?this.MK<this.DCb.length:!1}QMl(b,h){X.a.Q7||h.ux&512?(this.DCb=[Object(z.a)(this.t5,this.t5.Ksf,"copyInternal")],x.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.ni&&h.ux&256?(this.DCb=[Object(z.a)(this.t5,this.t5.WEp,"waitBeforeCopy"),Object(z.a)(this.t5,this.t5.M8h,"copyExternal"),Object(z.a)(this.t5,this.t5.Ksf,"copyInternal")],x.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):
(this.DCb=[Object(z.a)(this.t5,this.t5.M8h,"copyExternal"),Object(z.a)(this.t5,this.t5.Ksf,"copyInternal")],x.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));h.ux&32&&(b=Object(z.a)(this.t5,this.t5.Kei,"deleteForCut"),this.DCb.push(b),x.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));Js.a.rCn(h)}}Object(u.a)(Iu,"ClipboardOperationCutCopyProcessor",null,[567]);class AG{constructor(b,
h,n,B){this.xHd=null;this.gCl=(L,ba)=>{ba=ba.me;this.wB.DBp();this.wB.oYd(ba,L);return!0};this.Qdd=(L,ba)=>{ba=new gn.Selection([ba.rd],!0);this.hb.Ic(ba,L);return!0};this.wB=b;this.hb=h;this.t5=n;this.v1=B;this.MK=0}process(b,h){this.MK||(this.xHd=[this.gCl,Object(z.a)(this.t5,this.t5.Kei,"deleteForCut"),this.Qdd,Object(z.a)(this.v1,this.v1.osj,"pasteInternal"),Object(z.a)(this.v1,this.v1.JAg,"setSelectionAfterPaste")]);let n=!0;this.MK<this.xHd.length&&(n=this.xHd[this.MK++](b,h));return n?this.MK<
this.xHd.length:!1}}Object(u.a)(AG,"ClipboardOperationMoveProcessor",null,[566]);var Fw=d(1789);class Bx{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd,Hd,xe,je){this.wB=b;this.ga=h;this.BEc=n;this.vd=B;this.Oe=L;this.ff=ba;this.Pc=la;this.jyd=La;this.Iqk=fb;this.l5b=Cb;this.BNe=Lb;this.pEc=$b;this.kTa=tc;this.aL=Nc;this.Wd=dd;this.Fn=Hd;this.a2=xe;this.pja=je}create(b,h,n,B,L,ba,la,La,fb=!0){const Cb=this.jyd.create(B,Object(ya.a)(97,La));var Lb=this.Iqk.create();const $b=new jE(this.wB,Cb),
tc=new AG(this.wB,Zb.a.instance,Lb,Cb);Lb=new Iu(Lb);B=new Fw.a(A.AFrameworkApplication.K,wx.a.instance,B,Yc.a.instance,Cb,this.l5b);return new iE.a(b,h,n,L,ba,la,La,this.BEc,this.ga,this.vd,this.Oe,this.ff,this.Pc,$b,tc,Lb,B,this.l5b,this.BNe,this.pEc,this.kTa,this.aL,this.Wd,this.Fn,this.a2,this.pja,A.AFrameworkApplication.dDg(),fb)}}Object(u.a)(Bx,"Factory",null,[535]);var Rr=d(236);class Ez{constructor(b,h){this.YQb=b.xKf(h);this.Vsf=b.Snm(h);this.DLb=b.aIf(h);this.Gmb=b.AHf(h)}static UG(b){return Ez.Xs(b)}static Xs(b){return new Ez(bE.a.instance,
b)}}Object(u.a)(Ez,"CpUsageHelper",null,[]);class $s{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b){this.vd=b;this.wB=h;this.vNc=n;this.Rya=B;this.hb=L;this.ga=ba;this.qVe=la;this.Ubf=fb;this.l4e=La;this.UQe=Cb;this.zNe=Lb;this.Wd=$b;this.Fe=ch.a.getInstance(Js.a.H6a)}get tg(){return this.Ubf.value}get qwa(){return this.Rya}get Ec(){return this.vd}get qZa(){return this.l4e.qZa}paste(b,h){let n=!1;return Em.a.utb?(Rn.a.instance.Yd(()=>{n=this.lsj(b,h)},"COP:P"),n):this.lsj(b,h)}lsj(b,h){const n=this.Wd.p6a();
try{const B=h.me,L=h.ux;this.hb&&this.hb.gb&&this.hb.gb.currentSelection&&Rr.TableBorderSelectionCache.k_o(this.hb.gb.currentSelection.Pw||this.hb.gb.currentSelection.Nab);Kg.a.cYo(this.hb);x.ULS.shipAssertTag(18131010,307,!!(L&1));Object(Wb.a)(97,h.rd)&&h.rd.setValue(hi.a.Dka,B.Kh.editingElement.clientWidth);this.zNe.kqp(b,h);let ba;if(!({KXd:ba}=this.qVe.value.J3j()).returnValue)return this.ocd(h,"HTML import strategy failed",!1),this.Fe.logKpiFailure({kpiName:Js.a.Gza,errorName:"HtmlImportStrategyFailed",
optionalVeto:{name:Js.a.gqe,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}),!1;this.tg.$G();let la=!0,La=null;const fb=this.UQe.create(ba),Cb=h.t$j;if(!B||!B.lb)return this.ocd(h,"Fail to set selection.",!1),this.Fe.logKpiFailure({kpiName:Js.a.Gza,errorName:"SetSelectionFailed",optionalVeto:{name:Js.a.gqe,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}),!1;B.lb.d_b(()=>{Cb&&2===this.ga.Ob(wb.a.Wra,2)?la=!1:(La=Cb?this.hb&&this.hb.gb&&this.hb.gb.currentSelection?
this.hb.gb.currentSelection.Ra:null:h.rd)?(x.ULS.shipAssertTag(18158338,307,re.SelectionEditor.mf(La)),this.baj(La,"paste")):x.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Cb)},this.l4e.S0i);if(!la)return this.ocd(h,"fail to deleteForReplace.",!0),!1;if(!La)return this.ocd(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!La.node||!La.node.isConnected)return this.ocd(h,"node is null or not connected in ip context.",!0),!1;B.Ke.disable(!0,25);fb.restore();
this.vNc.i$n(ba,La,b);return!0}finally{n&&n.dispose()}}ocd(b,h,n){b.UB=!0;b.cV&&b.cV.fail(h,n)}o$n(b,h){var n,B;let L;if(hn.a.pga){L=h.rd;var ba=L.w$d}else ba=Object(ya.a)(97,h.rd).getValue(zd.a.w$d);x.ULS.shipAssertTag(20492440,307,re.SelectionEditor.mf(ba));if(!this.m2h(ba,h))return!1;this.tg.$G();const la=(new vm.a).Mc(15);la.Ab(this.wB.coa);const La=hn.a.pga?this.hb.gb.currentSelection:null;this.vNc.qUi(ba,b);hn.a.pga&&(b=null!==(B=null===(n=L.placeholderText)||void 0===n?void 0:n.length)&&void 0!==
B?B:0,n=h.kKa,ba=La&&re.SelectionEditor.mf(La.Ra)&&n&&re.SelectionEditor.mf(n.Ra)&&La.Ra.node===n.Ra.node&&La.Ra.cpBegin>ba.cpBegin?Oe.SelectionFactory.se(La.Ra.node,La.Ra.cpBegin+b):La,h.kKa=ba);this.wB.j3h();la.dispose();return!0}osj(b,h){const n=this.hb.gb.currentSelection.Ra;if(!this.m2h(n,h))return!1;this.tg.$G();this.ga.Ob(wb.a.Wra,2);this.baj(n,"intPaste");this.vNc.qUi(n,b);return!0}m2h(b,h){if(A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!b||
!b.isValid)return x.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!h&&h.sad),h.cV&&(h.cV.fail("Invalid ipContext before InternalPasteAtIp",!0),h.UB=!0),h=new Map,h.set("ErrorLevel","warning"),this.Fe.logKpiFailure({kpiName:Js.a.Gza,errorName:"InvalidIpContextBeforeInternalPasteAtIp",optionalProperties:{additionalValues:{extendedProperties:h}}}),!1;if(!re.SelectionEditor.mf(b))return x.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",
!!h&&h.sad,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),b=new Map,b.set("ErrorLevel","warning"),this.Fe.logKpiFailure({kpiName:Js.a.Gza,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:b}}}),h.cV&&(h.cV.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.UB=!0),!1}return!0}baj(b,h){h=Ez.UG(h);this.qwa.fpo(h,b.node,b.cpBegin);this.qwa.tCn(h.Vsf);this.qwa.y6f(h.YQb);this.qwa.k6f(h.DLb);this.qwa.h6f(h.Gmb)}JAg(b,h){if(!h.t$j)return!1;
h.ux&64&&this.wB.v$j();if(!h.kKa)return x.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Ec.$b(Tf.a.U4,{["Reason"]:hf.a.Isb}),h.cV&&h.cV.fail("No selection after paste",!1),h.UB=!0,!1;this.l4e.UAp(h);this.tg.$G();return!1}}Object(u.a)($s,"ClipboardOperationPaste",null,[565]);class Gw{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb){this.vd=b;this.wB=h;this.vNc=n;this.Rya=B;this.hb=L;this.ga=ba;this.Ubf=La;this.FIk=la;this.UQe=fb;this.zNe=Cb;this.Wd=Lb}create(b,h){h=this.FIk.create(this.hb,
h);return new $s(this.vd,this.wB,this.vNc,this.Rya,this.hb,this.ga,b,h,this.Ubf,this.UQe,this.zNe,this.Wd)}}Object(u.a)(Gw,"Factory",null,[536]);var Fz=d(1695);class kE{constructor(b,h){this.bep=b;this.f9n=h}}Object(u.a)(kE,"ParagraphFormatStore",null,[]);class BG{constructor(b,h,n){this.hb=b;this.jb=h;this.xe=n}kqp(b,h){if(h.Qoc){h=b.Mua;var n=this.hb.gb.currentSelection.Ra.node,B=null;this.jb.Xb(n)&&(B=this.xe.Eq(n),n=this.jb.D9a(n),B=new kE(B,n));h=new Fz.a(h.context,h.ux,h.cV,h.Aca,h.rd,B);b.Mua=
h}}}Object(u.a)(BG,"ClipboardOperationPasteOvertypeStrategy",null,[533]);class SA{constructor(b){this.f0e=null;this.hb=b;b.d_b(h=>{this.f0e=h},!1)}get S0i(){return!1}UAp(b){b=this.xhf(b);this.Ic(this.hb,b)}xhf(b){let h=b.kKa;(b.Q0a||b.zna)&&b.cBe&&(h=Oe.SelectionFactory.$y(b.cBe,h.Ra));return h}Ic(b,h){b.Ic(h)}}Object(u.a)(SA,"AClipboardOperationPasteStrategy",null,[582]);class CG extends SA{constructor(b){super(b)}get qZa(){return this.f0e}}Object(u.a)(CG,"ClipboardOperationPasteToLiveSelectionStrategy",
SA,[]);class Gz extends SA{constructor(b,h){super(b);this.Ycf=null;this.PEk=h;b.d_b(n=>{this.Ycf=n},!0)}get S0i(){return!0}get qZa(){return this.Ycf}xhf(b){let h=super.xhf(b);b.rd.setValue(zd.a.tsj,h);return h=this.PEk.xCi(this.f0e.currentSelection,this.Ycf.currentSelection,h)}}Object(u.a)(Gz,"ClipboardOperationPasteToVirtualSelectionStrategy",SA,[]);class Zn{constructor(b){this.Xcf=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&h.ja(zd.a.Q0a,!1)&&this.Xcf?new Gz(b,this.sEp):
new CG(b)}get sEp(){return null!=this.e7g?this.e7g:this.e7g=Ya.a.instance.Oa("Box4.Actors.IVirtualSelectionMerger")}}Object(u.a)(Zn,"ClipboardOperationPasteStrategyFactory",null,[534]);class ls{constructor(b,h,n,B){this.Ec=b;this.lb=h;this.Om=n;this.mg=B}xeo(b){(b&1||b&32)&&this.Om.Jo&&this.lb.fcc()}lfn(b,h){return b&1&&this.mg.Q2(h,!0)?(this.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.HG}),!1):!0}}Object(u.a)(ls,"ClipboardOperationWordStrategy",null,[]);class TA{constructor(){}BBl(b,h){if(h)if(h=h.sheet)if(h=
h.cssRules){var n=Array.clone(h);n.reverse();var B=h=0,L=0,ba=0;for(const La of n){n=La.style;var la=La.selectorText;n=n?n.cssText:null;la=la?la.split(","):null;if(n&&la&&La.type===La.STYLE_RULE){ba+=la.length;for(const fb of la){0<=fb.indexOf("#")&&h++;0<=fb.indexOf(".")&&B++;0>fb.indexOf("#")&&0>fb.indexOf(".")&&L++;la=null;try{la=b.querySelectorAll(fb)}catch(Cb){x.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",fb,Cb.message)}if(la)for(let Cb=
0;Cb<la.length;Cb++)la[Cb].setAttribute("style",n+(la[Cb].getAttribute("style")||""))}}}x.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",ba,h,B,L)}else this.Aaj();else this.Aaj()}Aaj(){x.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",X.a.eE)}}Object(u.a)(TA,"ExternalPasteCssConverter",null,[532]);class DG{constructor(b){this.RUa=
0;this.J3h=null;this.node=b}}Object(u.a)(DG,"ChartConverterArguments",null,[]);class lE{constructor(b=null){this._imgNodesConverted=0;this.t6=b||$q.a.hvi("")}get Nc(){return this.t6}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new Mv.a(h,this.d5l.bind(this),new DG(b[0])),b.vm("Chart Converter Operation"),b.ni=!h||h.ni,b.run())))}d5l(b,h){var n=h.node;if(1<h.RUa)return!1;if(1===n.nodeType&&"DIV"===n.tagName){const B=n.getAttribute(gl.RZd);
if(B){const L=n.getAttribute(gl.awf),ba=n.getAttribute(gl.bwf),la=n.getAttribute(gl.Zvf),La=n.getAttribute(gl.$vf),fb=n.getAttribute(gl.vYc);n=n.getAttribute(gl.cwf);L&&La&&ba&&"chart"===ba&&fb&&"XLO"===fb&&(h.J3h=new xG.a(B,L,ba,la,La,fb,n))}}b.Ni(this.kNn.bind(this));return!0}kNn(b,h){var n=h.node;if(b=h.J3h)1===n.childElementCount&&1===n.firstChild.nodeType&&"IMG"===n.firstChild.tagName?(n=n.firstChild,n.setAttribute(gl.RZd,b.ccpId),n.setAttribute(gl.awf,b.pKey),n.setAttribute(gl.bwf,b.type),n.setAttribute(gl.$vf,
b.dc),n.setAttribute(gl.vYc,b.client),b.version&&n.setAttribute(gl.cwf,b.version),b.count&&n.setAttribute(gl.Zvf,b.count),this._imgNodesConverted++):x.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.t6._imgNodesConverted=this._imgNodesConverted;h.RUa++;return!1}}Object(u.a)(lE,"ChartConverter",null,[]);class ei{constructor(b,h=null,n=null){this.yf=b;this.t6=h||$q.a.dHi("");this.HPk=n||$q.a.eHi("")}get Nc(){return this.t6}get FHg(){return this.HPk}fca(b){this.FHg.b++;this.yf.fca(b)}dca(){this.yf.dca()}p8(b){this.FHg.c++;
this.yf.p8(b)}eca(){this.yf.eca()}cca(b){this.FHg.d++;this.yf.cca(b)}bca(){this.yf.bca()}reset(){this.yf.reset()}get HYc(){return this.yf.HYc}Pga(b,h){this.Nc.b++;this.yf.Pga(b,h)}$ba(b){this.Nc.c++;this.yf.$ba(b)}Tvb(b){this.Nc.b++;this.yf.Tvb(b)}kDa(b){this.Nc.d++;this.yf.kDa(b)}VMa(b){this.Nc.f++;this.yf.VMa(b)}RYa(b,h){this.Nc.g++;this.yf.RYa(b,h)}QYa(){this.yf.QYa()}MF(b){this.Nc.h++;this.yf.MF(b)}fH(){this.yf.fH()}Pvb(){this.yf.Pvb()}Ovb(){this.yf.Ovb()}VYa(b,h){this.Nc.i++;this.yf.VYa(b,h)}fcb(){this.yf.fcb()}oDa(b){this.Nc.j++;
this.yf.oDa(b)}mDa(){this.yf.mDa()}YMa(b){this.Nc.k++;this.yf.YMa(b)}nDa(){this.yf.nDa()}jcb(b){this.Nc.l++;this.yf.jcb(b)}}Object(u.a)(ei,"SemanticEventUsageCollector",null,[306,307]);class mE{constructor(b=null){this.Am=b}Bul(b,h){var n;if(this.Am&&(h=h.match(/[0-9]+[a-zA-Z%]+/g)))for(const B of h){h=B.replace(/[0-9]+/,"");this.Am.yBe.has(b)||this.Am.yBe.set(b,new Map);const L=this.Am.yBe.get(b);null===L||void 0===L?void 0:L.set(h,(null!==(n=L.get(h))&&void 0!==n?n:0)+1)}}Hi(b){const h=b.Df;if(h&&
this.Am&&("font"===h.tagName.toLowerCase()&&this.W9n(b),b=h.style)){0===b.length&&this.Am.w7c(h.tagName,"no style present");for(let n=0;n<b.length;n++){const B=b[n];B&&0<B.length&&(this.Am.w7c(h.tagName,B),this.Bul(B,b.getPropertyValue(B)))}}}W9n(b){if((b=b.Df)&&"font"===b.tagName.toLowerCase()&&this.Am){var h=b.getAttribute("face");h&&0<h.length&&this.Am.w7c(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.Am.w7c(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<
h.length&&this.Am.w7c(b.tagName,"font-attr-size")}}}Object(u.a)(mE,"HtmlEventUsageCollectorHelper",null,[]);class hh{constructor(b,h,n=null,B=null){this.Gi=h;this.nrk="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");this.yf=b;this.t6=n||$q.a.Vzi(X.a.WKb,"");this.xw=B;this.ork=new mi.a(Qa.a.th());for(const L of this.nrk)this.ork.add(L)}get Nc(){return this.t6}get Am(){return this.xw}Qh(b){return b?b+1:1}reset(){this.yf.reset()}pme(){this.yf.pme()}LRf(b){if(b&&
this.Am&&(b.getAttribute&&(b.getAttribute(gl.fNl)&&(this.Am.Dri=!0),b.getAttribute(gl.RZd)&&(this.Am.odm=!0),b.getAttribute(gl.vYc)&&(this.Am.Ipf=b.getAttribute(gl.vYc)),b.getAttribute(gl.iNl)&&(this.Am.Eri=!0)),b.id&&b.id.startsWith&&b.id.startsWith(gl.QSm)&&(this.Am.Fri=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(gl.E4n)&&(this.Am.Jri=!0);h.startsWith(gl.tdo)&&(this.Am.Kri=!0);h.startsWith(gl.RGp)&&(this.Am.Lri=!0);if(h.startsWith(X.a.lmf)&&h.length===
X.a.lmf.length+1){const n=parseInt(F.a.substring(h,h.length-1,h.length));isNaN(n)||(this.Am.hXc=n)}if(h===gl.FOn||h===gl.GOn)this.Am.v1c=!0}return this.yf.LRf(b)}onClose(){this.yf.onClose()}dnn(b){for(const h of b)if("\n"!==h)return!0;return!1}Pga(b,h){this.Am&&(this.Am.qdm=!0);this.Am&&!this.Am.OFf&&b&&(this.Am.OFf=this.dnn(b));this.Nc.d=this.Qh(this.Nc.d);this.yf.Pga(b,h)}hme(b){this.Am&&(this.Am.Hri=!0);this.Nc.e=this.Qh(this.Nc.e);this.Gi.Hi(b);return this.yf.hme(b)}ydg(b){this.Nc.f=this.Qh(this.Nc.f);
this.Gi.Hi(b);return this.yf.ydg(b)}zdg(b){this.Nc.g=this.Qh(this.Nc.g);this.Gi.Hi(b);return this.yf.zdg(b)}Edg(b){this.Nc.h=this.Qh(this.Nc.h);this.Gi.Hi(b);return this.yf.Edg(b)}Tdg(b){this.Nc.i=this.Qh(this.Nc.i);this.Gi.Hi(b);return this.yf.Tdg(b)}Vdg(b){this.Nc.j=this.Qh(this.Nc.j);this.Gi.Hi(b);this.yf.Vdg(b)}ome(b){this.Nc.k=this.Qh(this.Nc.k);this.Gi.Hi(b);return this.yf.ome(b)}Wdg(b){this.Nc.l=this.Qh(this.Nc.l);this.Gi.Hi(b);this.yf.Wdg(b)}Xdg(b){this.Nc.m=this.Qh(this.Nc.m);this.Gi.Hi(b);
this.yf.Xdg(b)}Ydg(b){this.Nc.n=this.Qh(this.Nc.n);this.Gi.Hi(b);return this.yf.Ydg(b)}rme(b){this.Nc.o=this.Qh(this.Nc.o);this.Gi.Hi(b);return this.yf.rme(b)}sme(b){this.Nc.p=this.Qh(this.Nc.p);this.Gi.Hi(b);return this.yf.sme(b)}meg(b){this.Nc.q=this.Qh(this.Nc.q);this.Gi.Hi(b);return this.yf.meg(b)}tme(b){this.Nc.r=this.Qh(this.Nc.r);this.Gi.Hi(b);this.yf.tme(b)}peg(b){this.Nc.s=this.Qh(this.Nc.s);this.Gi.Hi(b);return this.yf.peg(b)}ume(b){this.Nc.t=this.Qh(this.Nc.t);this.Gi.Hi(b);return this.yf.ume(b)}vme(b){this.Nc.u=
this.Qh(this.Nc.u);this.Gi.Hi(b);return this.yf.vme(b)}yme(b){this.Nc.v=this.Qh(this.Nc.v);this.Gi.Hi(b);return this.yf.yme(b)}zme(b){this.Nc.w=this.Qh(this.Nc.w);this.Gi.Hi(b);return this.yf.zme(b)}Ceg(b){this.Nc.x=this.Qh(this.Nc.x);this.Gi.Hi(b);this.yf.Ceg(b)}Deg(b){this.Nc.y=this.Qh(this.Nc.y);this.Gi.Hi(b);return this.yf.Deg(b)}Gme(b){this.Nc.z=this.Qh(this.Nc.z);this.Gi.Hi(b);return this.yf.Gme(b)}Hme(b){this.Nc.ba=this.Qh(this.Nc.ba);this.Gi.Hi(b);return this.yf.Hme(b)}Kme(b){this.Nc.bb=this.Qh(this.Nc.bb);
this.Gi.Hi(b);return this.yf.Kme(b)}Lme(b){this.Nc.bc=this.Qh(this.Nc.bc);this.Gi.Hi(b);return this.yf.Lme(b)}Nme(b){this.Nc.bd=this.Qh(this.Nc.bd);this.Gi.Hi(b);return this.yf.Nme(b)}Ome(b){this.Nc.be=this.Qh(this.Nc.be);this.Gi.Hi(b);return this.yf.Ome(b)}Pme(b){this.Nc.bf=this.Qh(this.Nc.bf);this.Gi.Hi(b);return this.yf.Pme(b)}Sme(b){this.Nc.bg=this.Qh(this.Nc.bg);this.Gi.Hi(b);return this.yf.Sme(b)}gfg(b){this.Nc.bh=this.Qh(this.Nc.bh);this.Gi.Hi(b);return this.yf.gfg(b)}Zme(b){this.Nc.bi=this.Qh(this.Nc.bi);
this.Gi.Hi(b);return this.yf.Zme(b)}nfg(b){this.Nc.bj=this.Qh(this.Nc.bj);this.Gi.Hi(b);return this.yf.nfg(b)}pfg(b){this.Nc.bk=this.Qh(this.Nc.bk);this.Gi.Hi(b);this.yf.pfg(b)}qfg(b){this.Nc.bl=this.Qh(this.Nc.bl);this.Gi.Hi(b);return this.yf.qfg(b)}bne(b){this.Nc.bm=this.Qh(this.Nc.bm);this.Gi.Hi(b);return this.yf.bne(b)}cne(b){this.Nc.bm=this.Qh(this.Nc.bm);this.Gi.Hi(b);return this.yf.cne(b)}dne(b){this.Nc.bm=this.Qh(this.Nc.bm);this.Gi.Hi(b);return this.yf.dne(b)}ene(b){this.Nc.bm=this.Qh(this.Nc.bm);
this.Gi.Hi(b);return this.yf.ene(b)}fne(b){this.Nc.bm=this.Qh(this.Nc.bm);this.Gi.Hi(b);return this.yf.fne(b)}gne(b){this.Nc.bm=this.Qh(this.Nc.bm);this.Gi.Hi(b);return this.yf.gne(b)}wfg(b){this.Nc.bn=this.Qh(this.Nc.bn);return this.yf.wfg(b)}hne(b){this.Nc.bo=this.Qh(this.Nc.bo);this.Gi.Hi(b);this.yf.hne(b)}Cfg(b){this.Nc.bp=this.Qh(this.Nc.bp);return this.yf.Cfg(b)}ine(b){this.Nc.bq=this.Qh(this.Nc.bq);this.Gi.Hi(b);return this.yf.ine(b)}Efg(b){this.Nc.br=this.Qh(this.Nc.br);this.Gi.Hi(b);return this.yf.Efg(b)}lne(b){this.Am&&
(this.Am.Gri=!0);this.Gi.Hi(b);this.Nc.bs=this.Qh(this.Nc.bs);this.yf.lne(b)}Jfg(b){this.Nc.bt=this.Qh(this.Nc.bt);this.Gi.Hi(b);this.yf.Jfg(b)}mne(b){this.Nc.bu=this.Qh(this.Nc.bu);this.Gi.Hi(b);return this.yf.mne(b)}Pfg(b){this.Nc.bv=this.Qh(this.Nc.bv);this.Gi.Hi(b);return this.yf.Pfg(b)}one(b){this.Nc.bw=this.Qh(this.Nc.bw);this.Gi.Hi(b);return this.yf.one(b)}qne(b){this.Nc.bx=this.Qh(this.Nc.bx);this.Gi.Hi(b);return this.yf.qne(b)}sne(b){this.Nc.by=this.Qh(this.Nc.by);this.Gi.Hi(b);return this.yf.sne(b)}tne(b){this.Am&&
(this.Am.v1c=!0);this.Nc.bz=this.Qh(this.Nc.bz);this.Gi.Hi(b);return this.yf.tne(b)}$fg(b){this.Nc.ca=this.Qh(this.Nc.ca);this.Gi.Hi(b);this.yf.$fg(b)}dgg(b){this.Nc.cb=this.Qh(this.Nc.cb);this.Gi.Hi(b);return this.yf.dgg(b)}vne(b){this.Am&&(this.Am.pdm=!0);this.Nc.cc=this.Qh(this.Nc.cc);this.Gi.Hi(b);return this.yf.vne(b)}onMenuOpen(b){this.Nc.cd=this.Qh(this.Nc.cd);this.Gi.Hi(b);return this.yf.onMenuOpen(b)}jgg(b){this.Nc.ce=this.Qh(this.Nc.ce);this.yf.jgg(b)}rgg(b){this.Nc.cf=this.Qh(this.Nc.cf);
this.Gi.Hi(b);return this.yf.rgg(b)}sgg(b){this.Nc.cg=this.Qh(this.Nc.cg);this.Gi.Hi(b);return this.yf.sgg(b)}ugg(b){this.Nc.ch=this.Qh(this.Nc.ch);this.Gi.Hi(b);return this.yf.ugg(b)}Fne(b){this.Am&&(this.Am.v1c=!0);this.Nc.ci=this.Qh(this.Nc.ci);this.Gi.Hi(b);return this.yf.Fne(b)}wgg(b){this.Nc.cj=this.Qh(this.Nc.cj);this.Gi.Hi(b);return this.yf.wgg(b)}Gne(b){this.Nc.ck=this.Qh(this.Nc.ck);this.Gi.Hi(b);return this.yf.Gne(b)}Kne(b){this.Nc.cl=this.Qh(this.Nc.cl);this.Gi.Hi(b);return this.yf.Kne(b)}Dgg(b){this.Nc.cm=
this.Qh(this.Nc.cm);this.Gi.Hi(b);this.yf.Dgg(b)}Sne(b){this.Nc.cn=this.Qh(this.Nc.cn);this.Gi.Hi(b);return this.yf.Sne(b)}Pgg(b){this.Nc.co=this.Qh(this.Nc.co);this.Gi.Hi(b);return this.yf.Pgg(b)}Zne(b){this.Nc.cp=this.Qh(this.Nc.cp);this.Gi.Hi(b);return this.yf.Zne(b)}$ne(b){this.Nc.cq=this.Qh(this.Nc.cq);this.Gi.Hi(b);return this.yf.$ne(b)}fhg(b){this.Nc.cr=this.Qh(this.Nc.cr);return this.yf.fhg(b)}lhg(b){this.Nc.cs=this.Qh(this.Nc.cs);this.Gi.Hi(b);return this.yf.lhg(b)}koe(b){this.Nc.ct=this.Qh(this.Nc.ct);
this.Gi.Hi(b);return this.yf.koe(b)}loe(b){this.Nc.cu=this.Qh(this.Nc.cu);this.Gi.Hi(b);return this.yf.loe(b)}ooe(b){this.Nc.cv=this.Qh(this.Nc.cv);this.Gi.Hi(b);return this.yf.ooe(b)}poe(b){this.Nc.cw=this.Qh(this.Nc.cw);this.Gi.Hi(b);return this.yf.poe(b)}phg(b){this.Nc.cx=this.Qh(this.Nc.cx);return this.yf.phg(b)}qoe(b){this.Nc.cy=this.Qh(this.Nc.cy);this.Gi.Hi(b);return this.yf.qoe(b)}toe(b){this.Nc.cz=this.Qh(this.Nc.cz);this.Gi.Hi(b);return this.yf.toe(b)}voe(b){this.Am&&(this.Am.Csa=!0);this.Nc.da=
this.Qh(this.Nc.da);this.Gi.Hi(b);return this.yf.voe(b)}thg(b){this.Am&&(this.Am.Csa=!0);this.Nc.db=this.Qh(this.Nc.db);this.Gi.Hi(b);return this.yf.thg(b)}agd(b){this.Am&&(this.Am.Csa=!0);this.Nc.dc=this.Qh(this.Nc.dc);this.Gi.Hi(b);return this.yf.agd(b)}xhg(b){this.Nc.dd=this.Qh(this.Nc.dd);this.Gi.Hi(b);return this.yf.xhg(b)}yhg(b){this.Nc.de=this.Qh(this.Nc.de);this.Gi.Hi(b);return this.yf.yhg(b)}yoe(b){this.Am&&(this.Am.Csa=!0);this.Nc.df=this.Qh(this.Nc.df);this.Gi.Hi(b);return this.yf.yoe(b)}zhg(b){this.Am&&
(this.Am.Csa=!0);this.Nc.dg=this.Qh(this.Nc.dg);this.Gi.Hi(b);return this.yf.zhg(b)}Chg(b){this.Nc.dh=this.Qh(this.Nc.dh);this.Gi.Hi(b);return this.yf.Chg(b)}Doe(b){this.Am&&(this.Am.Csa=!0);this.Nc.di=this.Qh(this.Nc.di);this.Gi.Hi(b);return this.yf.Doe(b)}Eoe(b){this.Nc.dj=this.Qh(this.Nc.dj);this.Gi.Hi(b);return this.yf.Eoe(b)}Foe(b){this.Nc.dk=this.Qh(this.Nc.dk);this.Gi.Hi(b);return this.yf.Foe(b)}Goe(b){this.Am&&(this.Am.v1c=!0);this.Nc.dl=this.Qh(this.Nc.dl);this.Gi.Hi(b);return this.yf.Goe(b)}Loe(b){this.Nc.dm=
this.Qh(this.Nc.dm);this.Gi.Hi(b);return this.yf.Loe(b)}Ioe(b){this.Nc.dn=this.Qh(this.Nc.dn);this.Gi.Hi(b);return this.yf.Ioe(b)}}Object(u.a)(hh,"HtmlEventUsageCollector",null,[315]);class Cx{constructor(b,h,n=!1){this.Df=b;this.mD=h;this.f7k=n}}Object(u.a)(Cx,"TagEventParam",null,[]);class rz{constructor(b,h=null){this.qAd=this._prunedElements=this.Ibf=this._voidElements=null;this.yd=b;this.t6=h||$q.a.Wzi("");this.CZo()}get Nc(){return this.t6}rSn(b,h,n){this.Ibf[h]?this.fij():(this.Nc.e++,(h=this.qAd[h])&&
h(new Cx(b,n,!1)),this.Nc.b++)}fij(){this.Nc.d++}lSn(){this.Nc.c++}ZRn(b,h,n){if(this.Ibf[h])this.fij();else{if(h=this.qAd[h])return this.Nc.b++,h(new Cx(b,n,!1));this.Nc.f++;return this.yd.Ioe(new Cx(b,null))}return 2}CZo(){this._voidElements=Yb.a.l9("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.Ibf=Yb.a.l9("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",
!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=Yb.a.l9("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.yd,h=this.yd,n=this.yd,B=this.yd,L=this.yd,ba=this.yd,la=this.yd,La=this.yd,fb=this.yd,Cb=this.yd,Lb=this.yd,$b=this.yd,tc=this.yd,Nc=this.yd,dd=this.yd,Hd=this.yd,xe=this.yd,je=this.yd,he=this.yd,
fe=this.yd;this.qAd=Yb.a.l9("A",Object(z.a)(this.yd,this.yd.hme,"onAOpen"),"ABBR",Object(z.a)(this.yd,this.yd.ydg,"onAbbrOpen"),"ACRONYM",Object(z.a)(this.yd,this.yd.zdg,"onAcronymOpen"),"ADDRESS",Object(z.a)(this.yd,this.yd.Edg,"onAddressOpen"),"APPLET",Object(z.a)(this.yd,this.yd.Tdg,"onAppletOpen"),"AREA",Object(z.a)(this.yd,this.yd.Vdg,"onAreaTag"),"B",Object(z.a)(this.yd,this.yd.ome,"onBOpen"),"BASE",Object(z.a)(this.yd,this.yd.Wdg,"onBaseTag"),"BASEFONT",Object(z.a)(this.yd,this.yd.Xdg,"onBasefontTag"),
"BDO",Object(z.a)(this.yd,this.yd.Ydg,"onBdoOpen"),"BIG",Object(z.a)(this.yd,this.yd.rme,"onBigOpen"),"BLOCKQUOTE",Object(z.a)(this.yd,this.yd.sme,"onBlockquoteOpen"),"BODY",Object(z.a)(this.yd,this.yd.meg,"onBodyOpen"),"BR",Object(z.a)(this.yd,this.yd.tme,"onBrTag"),"BUTTON",Object(z.a)(this.yd,this.yd.peg,"onButtonOpen"),"CAPTION",Object(z.a)(this.yd,this.yd.ume,"onCaptionOpen"),"CENTER",Object(z.a)(this.yd,this.yd.vme,"onCenterOpen"),"CITE",Object(z.a)(this.yd,this.yd.yme,"onCiteOpen"),"CODE",
Object(z.a)(this.yd,this.yd.zme,"onCodeOpen"),"COL",Object(z.a)(this.yd,this.yd.Ceg,"onColTag"),"COLGROUP",Object(z.a)(this.yd,this.yd.Deg,"onColgroupOpen"),"DD",Object(z.a)(this.yd,this.yd.Gme,"onDdOpen"),"DEL",Object(z.a)(this.yd,this.yd.Hme,"onDelOpen"),"DFN",Object(z.a)(this.yd,this.yd.Kme,"onDfnOpen"),"DIR",Object(z.a)(this.yd,this.yd.Lme,"onDirOpen"),"DIV",Object(z.a)(this.yd,this.yd.Nme,"onDivOpen"),"DL",Object(z.a)(this.yd,this.yd.Ome,"onDlOpen"),"DT",Object(z.a)(this.yd,this.yd.Pme,"onDtOpen"),
"EM",Object(z.a)(this.yd,this.yd.Sme,"onEmOpen"),"FIELDSET",Object(z.a)(this.yd,this.yd.gfg,"onFieldsetOpen"),"FONT",Object(z.a)(this.yd,this.yd.Zme,"onFontOpen"),"FORM",Object(z.a)(this.yd,this.yd.nfg,"onFormOpen"),"FRAME",Object(z.a)(this.yd,this.yd.pfg,"onFrameTag"),"FRAMESET",Object(z.a)(this.yd,this.yd.qfg,"onFramesetOpen"),"H1",Object(z.a)(this.yd,this.yd.bne,"onH1Open"),"H2",Object(z.a)(this.yd,this.yd.cne,"onH2Open"),"H3",Object(z.a)(this.yd,this.yd.dne,"onH3Open"),"H4",Object(z.a)(this.yd,
this.yd.ene,"onH4Open"),"H5",Object(z.a)(this.yd,this.yd.fne,"onH5Open"),"H6",Object(z.a)(this.yd,this.yd.gne,"onH6Open"),"HEAD",Object(z.a)(this.yd,this.yd.wfg,"onHeadOpen"),"HR",Object(z.a)(this.yd,this.yd.hne,"onHrTag"),"HTML",Object(z.a)(this.yd,this.yd.Cfg,"onHtmlOpen"),"I",Object(z.a)(this.yd,this.yd.ine,"onIOpen"),"IFRAME",Object(z.a)(this.yd,this.yd.Efg,"onIframeOpen"),"IMG",Object(z.a)(this.yd,this.yd.lne,"onImgTag"),"INPUT",Object(z.a)(this.yd,this.yd.Jfg,"onInputTag"),"INS",Object(z.a)(this.yd,
this.yd.mne,"onInsOpen"),"ISINDEX",Object(z.a)(this.yd,this.yd.Pfg,"onIsindexOpen"),"KBD",Object(z.a)(this.yd,this.yd.one,"onKbdOpen"),"LABEL",Object(z.a)(this.yd,this.yd.qne,"onLabelOpen"),"LEGEND",Object(z.a)(this.yd,this.yd.sne,"onLegendOpen"),"LI",Object(z.a)(this.yd,this.yd.tne,"onLiOpen"),"LINK",Object(z.a)(this.yd,this.yd.$fg,"onLinkTag"),"MAP",Object(z.a)(this.yd,this.yd.dgg,"onMapOpen"),"MATH",Object(z.a)(this.yd,this.yd.vne,"onMathOpen"),"MENU",Object(z.a)(this.yd,this.yd.onMenuOpen,"onMenuOpen"),
"META",Object(z.a)(this.yd,this.yd.jgg,"onMetaTag"),"NOFRAMES",Object(z.a)(this.yd,this.yd.rgg,"onNoframesOpen"),"NOSCRIPT",Object(z.a)(this.yd,this.yd.sgg,"onNoscriptOpen"),"OBJECT",Object(z.a)(this.yd,this.yd.ugg,"onObjectOpen"),"OL",Object(z.a)(this.yd,this.yd.Fne,"onOlOpen"),"OPTGROUP",Object(z.a)(this.yd,this.yd.wgg,"onOptgroupOpen"),"OPTION",Object(z.a)(this.yd,this.yd.Gne,"onOptionOpen"),"P",Object(z.a)(this.yd,this.yd.Kne,"onPOpen"),"PARAM",Object(z.a)(this.yd,this.yd.Dgg,"onParamTag"),"PRE",
Object(z.a)(this.yd,this.yd.Sne,"onPreOpen"),"Q",Object(z.a)(this.yd,this.yd.Pgg,"onQOpen"),"S",Object(z.a)(this.yd,this.yd.Zne,"onSOpen"),"SAMP",Object(z.a)(this.yd,this.yd.$ne,"onSampOpen"),"SCRIPT",Object(z.a)(this.yd,this.yd.fhg,"onScriptOpen"),"SELECT",Object(z.a)(this.yd,this.yd.lhg,"onSelectOpen"),"SMALL",Object(z.a)(b,b.koe,"onSmallOpen"),"SPAN",Object(z.a)(h,h.loe,"onSpanOpen"),"STRIKE",Object(z.a)(n,n.ooe,"onStrikeOpen"),"STRONG",Object(z.a)(B,B.poe,"onStrongOpen"),"STYLE",Object(z.a)(L,
L.phg,"onStyleOpen"),"SUB",Object(z.a)(ba,ba.qoe,"onSubOpen"),"SUP",Object(z.a)(la,la.toe,"onSupOpen"),"TABLE",Object(z.a)(La,La.voe,"onTableOpen"),"TBODY",Object(z.a)(fb,fb.thg,"onTbodyOpen"),"TD",Object(z.a)(Cb,Cb.agd,"onTdOpen"),"TEXTAREA",Object(z.a)(Lb,Lb.xhg,"onTextareaOpen"),"TFOOT",Object(z.a)($b,$b.yhg,"onTfootOpen"),"TH",Object(z.a)(tc,tc.yoe,"onThOpen"),"THEAD",Object(z.a)(Nc,Nc.zhg,"onTheadOpen"),"TITLE",Object(z.a)(dd,dd.Chg,"onTitleOpen"),"TR",Object(z.a)(Hd,Hd.Doe,"onTrOpen"),"TT",
Object(z.a)(xe,xe.Eoe,"onTtOpen"),"U",Object(z.a)(je,je.Foe,"onUOpen"),"UL",Object(z.a)(he,he.Goe,"onUlOpen"),"VAR",Object(z.a)(fe,fe.Loe,"onVarOpen"))}}Object(u.a)(rz,"AHtmlProcessor",null,[]);class nE{constructor(b,h){this.childNodes=b.childNodes;this.mD=h;this.ovf=0;this.Xde=!1}}Object(u.a)(nE,"HtmlProcessorArguments",null,[]);class cv extends rz{constructor(b,h=null){super(b,h);this.mYe=null}get oon(){null==this.mYe&&(this.mYe=A.AFrameworkApplication.K?A.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):
!1);return this.mYe}process(b,h=null){b&&(this.yd.reset(),this.Ivj(new nE(b,new Dz.a),h))}Ivj(b,h){b.childNodes.length&&(b=new Mv.a(h,Object(z.a)(this,this.zgo,"processChild"),b),b.vm("HTML Processing Operation"),h||(b.ni=!0),b.run())}zgo(b,h){const n=h.childNodes[h.ovf];if(3===n.nodeType)return this.yd.pme(),this.yd.Pga(n.nodeValue,new Cx(n,h.mD.Cwi())),cv.MAc(h);if(1!==n.nodeType)return cv.MAc(h);if(!h.Xde){const L=F.a.sC(n.tagName);if(!cv.jYm(n))if(this._prunedElements[L])this.lSn();else{cv.sIn(n);
this.yd.pme();var B=n.id;const ba=n.tagName,la=h.mD.Cwi(),La=n.getAttribute?n.getAttribute("class"):null;B=new bv(B,ba,La?La:"",n.attributes?n.attributes.length:0);B.isValid&&la.add(B);if(this._voidElements[L])return this.rSn(n,L,la),cv.MAc(h);B=!1;switch(this.ZRn(n,L,la)){case 1:B=!0;break;case 3:return cv.MAc(h)}switch(this.yd.LRf(n)){case 1:B=!0}h.Xde=B;this.Ivj(new nE(n,la),b);if(!b.ni)return!0}}if(h.Xde){if(this.oon&&!this.qAd[F.a.sC(n.tagName)])return cv.MAc(h);this.yd.onClose()}return cv.MAc(h)}static sIn(b){3!==
b.nodeType&&Hg.a.Hm(b,"alreadyPasted",!0)}static jYm(b){return 3!==b.nodeType&&Hg.a.Eb(b,"alreadyPasted")}static MAc(b){b.ovf++;b.Xde=!1;return b.ovf<b.childNodes.length}}Object(u.a)(cv,"HtmlProcessor",rz,[]);var EG=d(586);const oE={["font-size"]:0,["box-sizing"]:1,["font-family"]:2,["color"]:3,["padding"]:4,["margin"]:5,["border-bottom-width"]:6,["border-left-width"]:7,["border-top-width"]:8,["border-right-width"]:9,["border-bottom-style"]:10,["border-left-style"]:11,["border-top-style"]:12,["border-right-style"]:13,
["line-height"]:14,["border-bottom-color"]:15,["border-left-color"]:16,["border-top-color"]:17,["border-right-color"]:18,["border-image-repeat"]:19,["border-image-source"]:20,["border-image-width"]:21,["border-image-outset"]:22,["border-image-slice"]:23,["margin-bottom"]:24,["font-weight"]:25,["background-color"]:26,["font-style"]:27,["margin-top"]:28,["padding-top"]:29,["padding-right"]:30,["padding-left"]:31,["padding-bottom"]:32,["vertical-align"]:33,["margin-left"]:34,["margin-right"]:35,["white-space"]:36,
["width"]:37,["position"]:38,["text-align"]:39,["display"]:40,["font-variant-ligatures"]:41,["font-variant-caps"]:42,["outline-style"]:43,["outline-width"]:44,["outline-color"]:45,["font-variant-numeric"]:46,["font-stretch"]:47,["font-variant-east-asian"]:48,["height"]:49,["background-clip"]:50,["background-repeat-x"]:51,["background-repeat-y"]:52,["background-position-y"]:53,["background-position-x"]:54,["background-image"]:55,["background-size"]:56,["background-origin"]:57,["background-attachment"]:58,
["text-indent"]:59,["overflow-x"]:60,["overflow-y"]:61,["text-decoration-color"]:62,["text-decoration-style"]:63,["letter-spacing"]:64,["text-transform"]:65,["overflow-wrap"]:66,["float"]:67,["-webkit-text-stroke-width"]:68,["word-spacing"]:69,["orphans"]:70,["widows"]:71,["top"]:72,["border-top-right-radius"]:73,["border-top-left-radius"]:74,["border-bottom-right-radius"]:75,["border-bottom-left-radius"]:76,["text-decoration-line"]:77,["left"]:78,["unicode-bidi"]:79,["clear"]:80,["max-width"]:81,
["list-style-type"]:82,["min-height"]:83,["text-shadow"]:84,["bottom"]:85,["list-style-position"]:86,["list-style-image"]:87,["right"]:88,["-webkit-font-smoothing"]:89,["visibility"]:90,["cursor"]:91,["resize"]:92,["max-height"]:93,["word-break"]:94,["font-attr-size"]:95,["font-attr-face"]:96,["user-select"]:97,["min-width"]:98,["transition-duration"]:99,["transition-property"]:100,["transition-timing-function"]:101,["transition-delay"]:102,["clip"]:103,["transform"]:104,["opacity"]:105,["-webkit-tap-highlight-color"]:106,
["align-items"]:107,["flex-direction"]:108,["font-attr-color"]:109,["direction"]:110,["flex-shrink"]:111,["box-shadow"]:112,["text-rendering"]:113,["z-index"]:114,["flex-grow"]:115,["text-size-adjust"]:116,["flex-basis"]:117,["transform-origin"]:118,["quotes"]:119,["caption-side"]:120,["border-collapse"]:121,["counter-reset"]:122,["font-kerning"]:123,["text-overflow"]:124,["-webkit-text-stroke-color"]:125,["-webkit-user-drag"]:126,["-webkit-box-flex"]:127,["font-variant"]:128,["font-feature-settings"]:129,
["-webkit-border-horizontal-spacing"]:130,["-webkit-border-vertical-spacing"]:131,["justify-content"]:132,["margin-inline-start"]:133,["speak"]:134,["caret-color"]:135,["flex-wrap"]:136,["animation-duration"]:137,["animation-name"]:138,["animation-timing-function"]:139,["animation-fill-mode"]:140,["animation-delay"]:141,["animation-iteration-count"]:142,["animation-direction"]:143,["animation-play-state"]:144,["pointer-events"]:145,["grid-column-end"]:146,["grid-column-start"]:147,["break-inside"]:148,
["counter-increment"]:149,["touch-action"]:150,["word-wrap"]:151,["hyphens"]:152,["zoom"]:153,["break-after"]:154,["content"]:155,["break-before"]:156,["margin-block-start"]:157,["margin-block-end"]:158,["padding-inline-start"]:159,["-webkit-box-align"]:160,["tab-size"]:161,["-webkit-appearance"]:162,["table-layout"]:163,["transform-style"]:164,["-webkit-box-orient"]:165,["writing-mode"]:166,["-webkit-box-pack"]:167,["-webkit-box-direction"]:168,["order"]:169,["text-decoration"]:170,["--darkreader-inline-color"]:171,
["empty-cells"]:172,["backface-visibility"]:173,["object-fit"]:174,["--transition-duration"]:175,["clip-path"]:176,["margin-inline-end"]:177,["grid-template-columns"]:178,["--darkreader-inline-bgcolor"]:179,["-webkit-print-color-adjust"]:180,["-webkit-box-decoration-break"]:181,["filter"]:182,["perspective-origin"]:183,["fill"]:184,["align-content"]:185,["align-self"]:186,["column-count"]:187,["outline-offset"]:188,["--czi-counter-name"]:189,["--czi-counter-reset"]:190,["--czi-list-style-type"]:191,
["-webkit-line-clamp"]:192,["--darkreader-inline-border-bottom"]:193,["--darkreader-inline-border-left"]:194,["--darkreader-inline-border-right"]:195,["--darkreader-inline-border-top"]:196,["--saf-0"]:197,["will-change"]:198,["grid-row-start"]:199,["padding-inline-end"]:200,["padding-block-end"]:201,["padding-block-start"]:202,["grid-row-end"]:203,["-webkit-box-ordinal-group"]:204,["column-gap"]:205,["object-position"]:206,["image-rendering"]:207,["-webkit-user-modify"]:208,["column-width"]:209,["text-decoration-skip-ink"]:210,
["line-break"]:211,["grid-template-rows"]:212,["perspective"]:213,["justify-self"]:214,["page"]:215,["--language-font-face"]:216,["mix-blend-mode"]:217,["-webkit-text-fill-color"]:218,["grid-template-areas"]:219,["--darkreader-inline-bgimage"]:220,["--darkreader-inline-outline"]:221,["-webkit-hyphenate-character"]:222,["row-gap"]:223,["scroll-behavior"]:224,["text-align-last"]:225,["stroke"]:226,["column-fill"]:227,["--chat-message-background-color"]:228,["--message-border-radius-bottom-left"]:229,
["--message-border-radius-bottom-right"]:230,["--message-border-radius-top-left"]:231,["--message-border-radius-top-right"]:232,["-webkit-mask-image"]:233,["--ehixd-mediumheight"]:234,["--ehixd-mediumpadding"]:235,["--czi-content-line-height"]:236,["--chat-default-message-background-color"]:237,["overscroll-behavior-x"]:238,["overscroll-behavior-y"]:239,["contain"]:240,["-webkit-user-select"]:241,["border"]:242,["justify-items"]:243,["-webkit-border-image"]:244,["column-rule-color"]:245,["column-rule-style"]:246,
["column-rule-width"]:247,["--avatar-size"]:248,["--chat-message-align"]:249,["--chat-message-link-color"]:250,["--chat-message-max-width"]:251,["--black"]:252,["--blacktranslucent40"]:253,["--flaggedmessage"]:254,["--headerbackground"]:255,["--headerbackgroundsearch"]:256,["--headerbadgebackground"]:257,["--headerbadgetext"]:258,["--headerbrandtext"]:259,["--headerbuttonsbackground"]:260,["--headerbuttonsbackgroundhover"]:261,["--headerbuttonsbackgroundsearch"]:262,["--headerbuttonsbackgroundsearchhover"]:263,
["--headersearchboxbackground"]:264,["--headersearchboxicon"]:265,["--headersearchbuttonbackground"]:266,["--headersearchbuttonbackgroundhover"]:267,["--headersearchbuttonicon"]:268,["--headersearchfilters"]:269,["--headersearchfiltershover"]:270,["--headersearchicon"]:271,["--headersearchplaceholdertext"]:272,["--headertexticons"]:273,["--neutraldark"]:274,["--neutrallight"]:275,["--neutrallighter"]:276,["--neutrallighteralt"]:277,["--neutralprimary"]:278,["--neutralprimaryalt"]:279,["--neutralquaternary"]:280,
["--neutralquaternaryalt"]:281,["--neutralsecondary"]:282,["--neutraltertiary"]:283,["--neutraltertiaryalt"]:284,["--reddark"]:285,["--richusercontentbackground"]:286,["--searchboxbackground"]:287,["--themedark"]:288,["--themedarkalt"]:289,["--themedarker"]:290,["--themelight"]:291,["--themelighter"]:292,["--themelighteralt"]:293,["--themeprimary"]:294,["--themesecondary"]:295,["--themetertiary"]:296,["--white"]:297,["--whitetranslucent40"]:298,["--whitetranslucent90"]:299,["--button-width"]:300,
["fill-opacity"]:301,["--mousedown-x"]:302,["--mousedown-y"]:303,["--height"]:304,["--purple"]:305,["-webkit-line-break"]:306,["grid-auto-flow"]:307,["overflow-anchor"]:308,["backdrop-filter"]:309,["--spritesheet-position"]:310,["-webkit-mask-position-x"]:311,["-webkit-mask-position-y"]:312,["no style present"]:313,["OTHERS"]:314,["animation"]:315,["background"]:316,["background-blur"]:317,["background-position"]:318,["background-repeat"]:319,["border-bottom"]:320,["border-color"]:321,["border-image"]:322,
["border-left"]:323,["border-radius"]:324,["border-right"]:325,["border-spacing"]:326,["border-style"]:327,["border-top"]:328,["border-width"]:329,["column-rule"]:330,["column-span"]:331,["columns"]:332,["flex"]:333,["flex-flow"]:334,["font"]:335,["font-size-adjust"]:336,["gap"]:337,["grid"]:338,["grid-area"]:339,["grid-auto-columns"]:340,["grid-auto-rows"]:341,["grid-column"]:342,["grid-column-gap"]:343,["grid-gap"]:344,["grid-row"]:345,["grid-row-gap"]:346,["grid-template"]:347,["isolation"]:348,
["list-style"]:349,["outline"]:350,["overflow"]:351,["page-break-after"]:352,["page-break-before"]:353,["page-break-inside"]:354,["place-content"]:355,["place-items"]:356,["place-self"]:357,["scroll-snap-align"]:358,["scroll-snap-stop"]:359,["scroll-snap-type"]:360,["shape-image-threshold"]:361,["shape-margin"]:362,["shape-outside"]:363,["text-combine-upright"]:364,["text-justify"]:365,["text-orientation"]:366,["text-underline-position"]:367,["transition"]:368,["perspective-origin-x"]:369,["perspective-origin-y"]:370,
["scrollbar-width"]:371,["scroll-snap-coordinate"]:372,["scroll-snap-destination"]:373,["scroll-snap-points-x"]:374,["scroll-snap-points-y"]:375,["scroll-snap-type-x"]:376,["scroll-snap-type-y"]:377,["text-emphasis"]:378,["text-underline-offset"]:379,["transform-box"]:380},UA={["a"]:1,["b"]:2,["big"]:3,["blockquote"]:4,["br"]:5,["caption"]:6,["center"]:7,["cite"]:8,["code"]:9,["col"]:10,["colgroup"]:11,["dd"]:12,["del"]:13,["dfn"]:14,["area"]:15,["base"]:16,["basefont"]:17,["frame"]:18,["hr"]:19,
["img"]:20,["input"]:21,["link"]:22,["meta"]:23,["param"]:24,["abbr"]:25,["acronym"]:26,["address"]:27,["bdo"]:28,["body"]:29,["button"]:30,["fieldset"]:31,["form"]:32,["frameset"]:33,["html"]:34,["noframes"]:35,["noscript"]:36,["optgroup"]:37,["q"]:38,["select"]:39,["textarea"]:40,["applet"]:41,["head"]:42,["iframe"]:43,["isindex"]:44,["map"]:45,["object"]:46,["script"]:47,["style"]:48,["title"]:49,["dir"]:50,["div"]:51,["dl"]:52,["dt"]:53,["em"]:54,["font"]:55,["h"]:56,["i"]:57,["ins"]:58,["kbd"]:59,
["label"]:60,["legend"]:61,["li"]:62,["math"]:63,["menu"]:64,["ol"]:65,["option"]:66,["p"]:67,["pre"]:68,["s"]:69,["samp"]:70,["small"]:71,["span"]:72,["strike"]:73,["strong"]:74,["sub"]:75,["sup"]:76,["tables"]:77,["tbody"]:78,["td"]:79,["text"]:80,["tfoot"]:81,["th"]:82,["thead"]:83,["tr"]:84,["tt"]:85,["u"]:86,["ul"]:87,["var"]:88,["OTHERS"]:89,["article"]:90,["aside"]:91,["audio"]:92,["bb"]:93,["canvas"]:94,["command"]:95,["datagrid"]:96,["datalist"]:97,["details"]:98,["dialog"]:99,["embed"]:100,
["eventsource"]:101,["figcaption"]:102,["figure"]:103,["footer"]:104,["h1"]:105,["h2"]:106,["h3"]:107,["h4"]:108,["h5"]:109,["h6"]:110,["header"]:111,["hgroup"]:112,["keygen"]:113,["mark"]:114,["meter"]:115,["nav"]:116,["output"]:117,["progress"]:118,["rp"]:119,["rt"]:120,["ruby"]:121,["section"]:122,["source"]:123,["table"]:124,["time"]:125,["track"]:126,["video"]:127,["wbr"]:128};class FG{constructor(){this.ux=0;this.hXc=6;this.odm=this.Dri=!1;this.Ipf=null;this.Lri=this.Kri=this.Jri=this.Fri=this.Eri=
!1;this.progId=null;this.OFf=this.Hri=this.Gri=this.Csa=this.v1c=this.pdm=this.qdm=!1;this.wsj=this.Jtc=0;this.Xpj=this.platform=null;this.XVi=this.Uge=!1;this.yBe=new Map;this.yOk={["Excel Online"]:1,["Word Online"]:2,["PowerPoint Online"]:3,["OneNote Online"]:4,["Google Docs"]:5,["Excel"]:6,["Word"]:7,["PowerPoint"]:8,["OneNote"]:9,["Other"]:10};this.Iyf=[1,3,4,2,5];this.eEb={}}get BEg(){if(null!==this.Ipf)switch(this.Ipf){case "XLO":return"Excel Online"}if(this.Lri)return"Word Online";if(this.Kri||
this.Eri)return"PowerPoint Online";if(this.Dri)return"Excel Online";if(this.Fri)return"Google Docs";if(this.Jri)return"OneNote Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}bP(b,h){const n=new ia.a;n.name=b;"number"===typeof h?n.int64=h:"boolean"===typeof h?n.bool=h:"string"===typeof h&&(n.string=h);return n}vnd(b,h,n){const B=new EG.a;B.name=b;B.dataFields=
h;B.dnmInterval=n;B.dnmAllowedPartA=this.Iyf;aa.a.sendDirectNumericEvent(B)}vFn(){for(const [b,h]of this.yBe)for(const [n,B]of h){const L=[this.bP("style",b),this.bP("unit",n),this.bP("frequency",B)];Object(Pe.a)("StylesAndUnitsFrequency",!0,0,L)}}xDn(){const b=this.fgl(),h=[],n=[this.bP("isUserConsumer",this.Uge),this.bP("isDocumentBlank",this.XVi),this.bP("FoundText",this.OFf),this.bP("FoundTable",this.Csa),this.bP("FoundImage",this.Gri),this.bP("FoundList",this.v1c),this.bP("FoundLink",this.Hri),
this.bP("Browser",this.Jtc),this.bP("SourceApp",this.yOk[this.BEg])];for(const B of n)h.push(B);this.vnd("Office.DNM.Word.Online.ExternalPasteEvent2",h,2);x.ULS.sendTraceTag(51406241,307,50,JSON.stringify(b))}GEl(b,h){var n,B;const L=[];b=this.bP("tag",null!==(n=UA[b])&&void 0!==n?n:UA.OTHERS);h=this.bP("style",null!==(B=oE[h])&&void 0!==B?B:oE.OTHERS);B=this.bP("IsUserConsumer",this.Uge);L.push(b);L.push(h);L.push(B);this.vnd("Office.DNM.Word.Online.ExternalPasteEvent1",L,2)}HEl(b){var h;const n=
[];b=this.bP("tag",null!==(h=UA[b])&&void 0!==h?h:UA.OTHERS);h=this.bP("IsUserConsumer",this.Uge);n.push(b);n.push(h);this.vnd("Office.DNM.Word.Online.ExternalPasteEvent3",n,2)}yDn(){const b=this.eEb;for(const B in b){var h=B,n=b[B];this.HEl(h);for(const L of Object.keys(n))this.GEl(h,L)}}w7c(b,h){b&&b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.eEb||(this.eEb[b]={}),this.eEb[b][h]=this.XLm(b,h)+1)}XLm(b,h){if(!(b&&b.length&&h&&h.length&&this.eEb&&b in this.eEb))return 0;b=
b.toLowerCase();h=h.toLowerCase();return(b=this.eEb[b])&&h in b?b[h]:0}fgl(){const b={};b.ActionIdFlags=this.ux;b.SourceApp=this.BEg;b.CopySourceBrowser=this.hXc;b.PasteBrowser=this.Jtc;b.IsSameBrowserPaste=this.kqn(this.hXc,this.Jtc);b.IsCrossBrowserPaste=this.wgn(this.hXc,this.Jtc);b.IsUncategorizedBrowserPaste=this.$sn(this.hXc,this.Jtc);b.Platform=this.platform;b.OperationId=this.Xpj;return b}kqn(b,h){return 5===b||6===b?!1:b===h}wgn(b,h){return 6===b?!1:b!==h}$sn(b,h){return 5===b&&5===h}}Object(u.a)(FG,
"HtmlContentMetadata",null,[]);var Dx=d(246),vC=d(1498),wC=d(1148),ms=d(369),hl=d(61),pE=d(1791),Oq=d(79),at;(function(b){b[b.Gfk=0]="EmptyPara";b[b.tjk=1]="StartingOfPara";b[b.Jhk=2]="MiddleOfPara";b[b.Ifk=3]="EndOfPara"})(at||(at={}));Object(u.b)("PasteContext",at);class pn{constructor(b,h,n,B,L,ba,la){this.Cic=la;this.ZYe=!1;this.K1j=this.uXe=null;this.m$n=La=>{let fb=!1;return Em.a.utb?(Rn.a.instance.Yd(()=>{fb=this.jsj(La)},"APEM:PE"),fb):this.jsj(La)};this.jsj=La=>{ce.a.mark(5568);this.nmi(La);
let fb=this.TKn;if(this.F_i){const Cb=this.xTj();Cb&&(fb=this.xwb);x.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",Cb)}La.Ni(fb);return!0};this.TKn=La=>{ce.a.mark(5569);var fb=new ve.GraphIterator;this.Kcb.restore(fb);var Cb=new ve.GraphIterator;this.bFf.restore(Cb);this.bFf=null;x.ULS.shipAssertTag(6305489,307,xb.OutlineElementReader.Mh(fb));x.ULS.shipAssertTag(6305490,307,xb.OutlineElementReader.Mh(Cb));Ga.OutlineElementNavigator.Le(fb);const Lb=ea.ParagraphReader.Bh(fb)?
ea.ParagraphReader.textLength(fb.currentNode):0;Ga.OutlineElementNavigator.he(fb);Ga.OutlineElementNavigator.Le(Cb);x.ULS.shipAssertTag(6305491,307,ea.ParagraphReader.Bh(Cb));const $b=ea.ParagraphReader.textLength(Cb.currentNode);Ga.OutlineElementNavigator.he(Cb);var tc=A.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_8111697_MergeParagraphsAfterCCPlaceholderPaste")&&this.$Yi();let Nc=this.qpd||tc;var dd=new Ml.a;dd.hd(fb);Ga.OutlineElementNavigator.ht(dd,
!1,!1);var Hd=dd.currentNode===Cb.currentNode,xe=!!this.Vi&&!!(this.Vi.ux&8192);let je=!1;!xe&&this.Vi.rd&&Object(Wb.a)(Og.DictionaryPropertySet,this.Vi.rd)&&(xe=(tc=this.Vi.rd.wf(zd.a.wXb))&&""!==tc?!0:!1);tc=!1;this.Vi.rd instanceof Dx.APropertySet&&(tc=this.Vi.rd.ja(zd.a.L7,!1));if(Hd){dd=ve.GraphIterator.eb(fb.currentNode);ea.ParagraphReader.zu(Ga.OutlineElementNavigator.Le(dd))||(fb=Cb);fb.currentNode.id!==Cb.currentNode.id&&(x.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",
Gf.ListItemReader.Hg(fb),Gf.ListItemReader.Hg(Cb)),xe=pn.Kf.merge(fb,Cb,!0,xe),x.ULS.shipAssertTag(6305492,307,xe));Cb=fb;var he=!0}else{Hd=!!(this.Vi.ux&4);he=this.Md.Mg&&Hd&&this.Vi.Z$a;var fe=!!(this.Vi.ux&262144);this.kkg&&this.Vi&&!Hd&&!fe&&(this.kkg.$Mi(fb,!1),this.kkg.$Mi(Cb,!0));Ga.OutlineElementNavigator.Le(dd);Hd=ea.ParagraphReader.Bh(dd)?ea.ParagraphReader.textLength(dd.currentNode):0;Ga.OutlineElementNavigator.he(dd);hn.a.As&&this.$Yi()||this.s9k(dd,fb,Cb);fe=new Ml.a;fe.hd(dd);Ga.OutlineElementNavigator.ht(fe,
!1,!1);fe.currentNode.id===Cb.currentNode.id&&(this.ZYe=!0);if(this.l_.kUa||this.f2o)if(fe.io.id!==Cb.io.id){for(;dd.currentNode.id!==Cb.currentNode.id;)Ga.OutlineElementNavigator.Le(dd,!1),this.l_.mOa(Nd.a.create(dd.currentNode)),dd.uc(),Ga.OutlineElementNavigator.ht(dd,!1,!1);dd.hd(fb);Ga.OutlineElementNavigator.ht(dd,!1,!1)}else je=!0;this.B1&&({qpd:Nc,ZAa:dd}=this.B1.tng(fb,Cb,Nc,dd));Oq.a.kI&&this.Cic&&(dd=this.Cic.tng(fb,Cb,dd));if(this.Vi.$ue&&(x.ULS.shipAssertTag(6305493,307,this.Vi.Qoc),
fe=new ve.GraphIterator,fe.hd(dd),fe=Ga.OutlineElementNavigator.Le(fe))){var De=this.Vi.$ue.Bf(fe.qa.J(0));fe.qa.J(0).formatting=De}fe=0;xe&&this.m4e&&(fe=1);De=this.I2o(fb,dd,fe);this.Vi.cBe=null;if(this.Vi.zna||this.Vi.Q0a)this.Vi.cBe=this.DLm(De?fb.currentNode:dd.currentNode,De);var gg=!1;De&&(gg=Gf.ListItemReader.Hg(fb),x.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",gg,Gf.ListItemReader.Hg(Cb)),this.uXe=gg=pn.Kf.merge(fb,
dd,!0,xe,Cb,void 0,je,he,this.m4e),this.J2o(fb,fe)&&this.qLn(fb,Cb,fe,xe));fe=pn.B$n.H7m(fb,dd,Cb,Lb,gg,this.SSb);var eg=!1;if(Nc){const vl=new Ml.a;vl.hd(Cb);Ga.OutlineElementNavigator.Y3(vl,!1,!1);eg=Gf.ListItemReader.Hg(vl);const wl=Gf.ListItemReader.Hg(Cb),Sm=tc;x.ULS.sendTraceTag(509661707,307,50,"preserve EOP formatting : {0}",Sm);const qp=!!(this.Vi.ux&524288);he=pn.Kf.merge(vl,Cb,!0,xe,void 0,!0,void 0,he,this.m4e,Sm,!qp,!qp);x.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",
eg,wl,he?"True":"False, will cause IP to reset to zero.");Cb=(eg=he)?vl:Cb}else he=!1,x.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.l_.kUa&&je&&(De&&!this.cjn(fe,gg)?(dd=new ve.GraphIterator,dd.hd(fb),fb=Ga.OutlineElementNavigator.Le(dd),this.l_.Cva(fb,Lb,Lb+Hd)):Nc&&!this.Hln(fe,eg)?(fb=new ve.GraphIterator,fb.hd(dd),fb=Ga.OutlineElementNavigator.Le(fb),this.l_.Cva(fb,0,Hd)):(fb=new ve.GraphIterator,fb.hd(dd),fb=Ga.OutlineElementNavigator.Le(fb),this.l_.mOa(Nd.a.create(fb))));
this.jdo(fe);xe||this.cD.vho(fe)}x.ULS.shipAssertTag(6305494,307,Cb.isValid);xe=Ga.OutlineElementNavigator.Le(Cb);fb=he?ea.ParagraphReader.textLength(xe)-$b:0;this.Vi.kKa=tc?Oe.SelectionFactory.eN(xe,fb-1,fb):Oe.SelectionFactory.se(xe,fb);this.Vi&&this.Vi.Qoc&&ea.ParagraphReader.Xb(xe)&&this.Vi.fpe&&((tc=this.Vi.fpe.bep)&&this.kJ.VN(tc,xe,!0),(tc=this.Vi.fpe.f9n)&&this.rl.LTh(xe,tc));Em.a.Agk&&this.VVk(this.gFm(Lb,$b));La.Ni(this.xwb);return!0};this.aYo=La=>{const fb=ve.GraphIterator.eb(this.K1j);
fb.IL(1);this.Vi.kKa=Oe.SelectionFactory.pp(fb.currentNode,!1);La.Ni(this.xwb);return!0};this.xwb=()=>{var La=void 0===this.Vi.ux||null===this.Vi.ux?"not available":Object(vC.a)(pE.a,this.Vi.ux);x.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.Vi.ux,La);x.ULS.shipAssertTag(6305497,307,!!this.Vi.kKa);this.SSb?Object(Pe.a)("ExternalPasteAction",!0):Object(Pe.a)("InternalPasteAction",!0);this.Kcb&&(La=new ve.GraphIterator,this.Kcb.restore(La),this.Kcb=null,this.vXm(La));this.transaction.dispose();
this.SSb&&Vi.a.EEn();La=this.Sy.Vu;if(!La.te||!La.Ke.ek)return!1;La.Ke.Nhp();return!1};this.HLa=b;this.bFf=this.Kcb=null;this.Vi=h;this.transaction=n;this.B1=B;this.Sy=L;this.e$=ba}get K(){return A.AFrameworkApplication.K}get m4e(){return!!this.K&&this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get cD(){return null!=this.CXg?this.CXg:this.CXg=Ya.a.instance.resolve("Box4.IFontStylesGalleryCache")}get kJ(){return null!=this.j7g?this.j7g:this.j7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get Vb(){return null!=
this.I7g?this.I7g:this.I7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get rl(){return null!=this.W2g?this.W2g:this.W2g=Ya.a.instance.resolve("Box4.IParagraphEditor")}get Nd(){return null!=this.w1g?this.w1g:this.w1g=Ya.a.instance.resolve("Box4.List.IListReader")}get rm(){return null!=this.i1g?this.i1g:this.i1g=Ya.a.instance.resolve("Box4.List.IListEditor")}get cK(){return null!=this.tYg?this.tYg:this.tYg=Ya.a.instance.resolve("Box4.IBox4GraphWriter")}get fqd(){return null!=this.m4g?this.m4g:
this.m4g=Ya.a.instance.Oa("Box4.List.ISingleLevelListEditor")}get Lj(){return null!=this.b6g?this.b6g:this.b6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Vh(){return null!=this.G6g?this.G6g:this.G6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Md(){return null!=this.l6g?this.l6g:this.l6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get l_(){return null!=this.jUg?this.jUg:this.jUg=Ya.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get kkg(){return null!=
this.h3g?this.h3g:this.h3g=Ya.a.instance.Oa("Box4.IPastedParagraphSpaceHandler")}get Esj(){return!1}pmi(){}get SSb(){return!1}rsj(b){let h=!1;return Em.a.utb?(Rn.a.instance.Yd(()=>{h=this.ssj(b)},"APEM:PS"),h):this.ssj(b)}ssj(b){var h=void 0===this.Vi.ux||null===this.Vi.ux?"not available":Object(vC.a)(pE.a,this.Vi.ux);x.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.Vi.ux,h);x.ULS.shipAssertTag(6305487,307,re.SelectionEditor.mf(this.HLa));if(this.Jle)return x.ULS.sendTraceTag(6305488,
307,50,"NothingToPaste"),this.Vi.kKa=Oe.SelectionFactory.Fo(this.HLa),b.Ni(this.xwb),!0;if(!this.HLa.node)return x.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;h=new ve.GraphIterator;h.set(this.HLa.node);re.SelectionEditor.rv(h);Ga.OutlineElementNavigator.he(h);this.K1j=h.origin;if(this.Esj)return h.qt(10),this.pmi(h,b),b.Ni(this.aYo),!0;this.B1&&this.B1.YUn(this.HLa);if(!this.Pap(this.HLa))return this.Vi.cV&&(this.Vi.cV.fail("SplitLine Failed",
!0),this.Vi.UB=!0),this.Vi.kKa=Oe.SelectionFactory.Fo(this.HLa),b.Ni(this.xwb),!0;const n=new Ml.a;n.hd(h);Ga.OutlineElementNavigator.ht(n,!1,!1);this.Kcb=new wC.a(h);this.bFf=new wC.a(n);b.Ni(this.m$n);return!0}xTj(){return!1}get F_i(){return this.K.$("PptCcpFix2IsEnabled")}get f2o(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}gFm(b,h){if(0==b&&0==h)return at.Gfk;if(0==b&&0!=h)return at.tjk;if(0!=b&&0!=h)return at.Jhk;if(0==h&&0!=b)return at.Ifk}VVk(b){b=[Object.assign(new ia.a,
{name:"isExternalPaste",bool:this.SSb}),Object.assign(new ia.a,{name:"Single OE",bool:this.ZYe}),Object.assign(new ia.a,{name:"Context",string:b})];Object(Pe.a)("ContextualTelemetryForPaste",!0,void 0,b)}cjn(b,h){return!h&&!!b&&xb.OutlineElementReader.Mh(b.ZAa)&&xb.OutlineElementReader.Inb(b.ZAa)}Hln(b,h){return!h&&!!b&&xb.OutlineElementReader.Mh(b.eub)&&xb.OutlineElementReader.Inb(b.eub)}jdo(b){pn.suj&&b&&pn.suj.rho(b)}I2o(b,h,n){var B;Gf.ListItemReader.Hg(b)?(null===(B=this.fqd)||void 0===B?void 0:
B.XUf(b),h=Gf.ListItemReader.Hg(h)?this.QSj:!0):xb.OutlineElementReader.isEmpty(b,!0)&&!n?(pn.Kf.T7a(b),h=!1):h=!0;this.B1&&(h=this.B1.Epl(b,h));return h}J2o(b,h){return Gf.ListItemReader.Hg(b)||1===h?!0:!1}qLn(b,h,n,B){const L=Gf.ListItemReader.Hg(b);if(L){if(B=new Ml.a,B.hd(b),Ga.OutlineElementNavigator.ht(B,!1,!1),B.io.id!==h.io.id){n=this.Nd.Nw(b);if(Gf.ListItemReader.Of)({listId:ba}=Gf.ListItemReader.Osa(b,{vka:0}));else{this.Nd.RX(b);var ba=b.currentNode.ja(Lc.a.listID,0);b.uc()}var la=this.Nd.bWj,
La=!0;for(n.ED=Uk.a.Ik;B.currentNode.id!==h.currentNode.id;){if(!la||!xb.OutlineElementReader.p4o(B))if(!Gf.ListItemReader.Hg(B))hl.a.getInstance().Fu?(xb.OutlineElementReader.$lc(B)||({cCa:n}=this.rm.Tqa(n.qf,B,n)),this.rm.u9()):{cCa:n}=this.rm.Tqa(n.qf,B,n),La=!1;else if(L){La=Gf.ListItemReader.Of?Gf.ListItemReader.Osa(B,{HJa:-1}).listLevel:this.Nd.zLf(B);var fb=this.Nd.fz(b.currentNode,ba,La);fb=fb?ms.a.Faa(fb,null):n;La=ms.a.s_(fb.listType,n.listStyle,null,0,La,"","");La.tvb=b.currentNode;this.rm.EWo(La);
this.rm.$xe(B,!0);La=!1}Ga.OutlineElementNavigator.ht(B,!1,!1)}la&&La&&this.rm.Hal()}}else if(1===n)for(n=new Ml.a,n.hd(b),Ga.OutlineElementNavigator.Le(n),b=ea.ParagraphReader.Bh(n)?n.currentNode:null,ba=this.Vb.tOf(n),Ga.OutlineElementNavigator.he(n),Ga.OutlineElementNavigator.ht(n,!1,!1);n.currentNode.id!==h.currentNode.id;)Ga.OutlineElementNavigator.Le(n),la=ea.ParagraphReader.Bh(n)?n.currentNode:null,Ga.OutlineElementNavigator.he(n),la&&b&&B&&(ba&&this.kJ.VN(ba,la,!0),this.e$.dej(b,la,L),this.e$.yua(b,
la,1,!0)),Ga.OutlineElementNavigator.ht(n,!1,!1)}s9k(b,h,n){var B=!1;if(this.Md.Mg)if(hn.a.As)B=!0;else{var L=!1;this.B1&&(L=h.currentNode,L=this.B1.ron(L)||this.B1.V_f(L));L?this.Md.Gcb=4:B=!0}if(B){for(;b.currentNode!==n.currentNode;){Ga.OutlineElementNavigator.Le(b,!1);B=this.Vh.sqd(Nd.a.create(b.currentNode));let ba;({type:ba}=B.i$d()).returnValue&&this.Md.$t(ba);for(L=0;L<B.length;L++){let la;const La=({Oge:la}=B.getContext(L)).returnValue;la&&(pn.Np.lvb(La,1),this.Lj.Ayb(La,1,null,!0))}b.uc();
Ga.OutlineElementNavigator.ht(b,!1,!1)}b.hd(h);Ga.OutlineElementNavigator.ht(b,!1,!1)}}DLm(b,h){b=ve.GraphIterator.eb(b);Ga.OutlineElementNavigator.Le(b);return ea.ParagraphReader.Xb(b.currentNode)?(h=h?ea.ParagraphReader.textLength(b.currentNode):0,Oe.SelectionFactory.se(b.currentNode,h)):xh.TableReader.HU(b.currentNode)?Oe.SelectionFactory.lr(b.currentNode):null}vXm(b){if(b){if(this.SSb&&xh.TableReader.yy(b)&&this.ZYe){if(null!=this.uXe&&0==this.uXe){var h=new Ml.a;h.hd(b);Ga.OutlineElementNavigator.ht(h,
!1,!1);b.hd(h)}h=Kg.a.xDo(b);const n=ea.ParagraphReader.Zl(h);h&&n&&(this.Vi.kKa=Oe.SelectionFactory.se(n,0),b=ve.GraphIterator.eb(h))}else pn.non&&Kg.a.u$n(b);b&&xh.TableReader.yy(b)&&qh.returnToContainingCell(b)&&Kg.a.e3k(b.currentNode)}else x.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}f1o(b,h){const n=new ve.GraphIterator;n.hd(b);b=Ga.OutlineElementNavigator.Le(n);h=ea.ParagraphReader.Xb(b)&&h===ea.ParagraphReader.textLength(b);x.ULS.sendTraceTag(50384992,307,
50,"IsPasteAtEndofParagraph: {0}",h);return h}Pap(b){var h;x.ULS.shipAssertTag(6305498,307,re.SelectionEditor.mf(b));if(null===(h=this.cK)||void 0===h?0:h.U_a)return!!this.cK.U_a(b.node,b.cpBegin,{Sdm:!0,Fb:b.Fb,Tb:b.Tb});h=ve.GraphIterator.eb(b.node);var n=h.Jd();Ga.OutlineElementNavigator.he(h);n&&b.isValid||x.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:n,["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.isValid});if(!xb.OutlineElementReader.Mh(h)&&
(x.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;n=pn.Kf.tta(h,!0);const B=this.f1o(h,b.cpBegin);pn.Kf.Tca(h,n,b,!1,!1,!0,B);return!0}$Yi(){return!!(this.Vi.ux&65536)}static get Np(){return null!=pn.DYg?pn.DYg:pn.DYg=Ya.a.instance.resolve("Box4.IHyperlinkEditor")}static get $i(){return Gm.PageReader.instance}static get Kf(){return null!=pn.h2g?pn.h2g:pn.h2g=Ya.a.instance.resolve("Box4.IOutlineElementEditor")}static get Xr(){return hl.a.getInstance()}static get rc(){return null!=
pn.MWg?pn.MWg:pn.MWg=Ya.a.instance.Oa("Box4.IFeatureHelper")}static get suj(){return null!=pn.n3g?pn.n3g:pn.n3g=Ya.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get B$n(){return null!=pn.g3g?pn.g3g:pn.g3g=Ya.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}static get non(){null==this.lYe&&(A.AFrameworkApplication.Ld("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),this.lYe=A.AFrameworkApplication.K?A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",
!1):!1);return this.lYe}}pn.lYe=null;Object(u.a)(pn,"APasteExecutionManager",null,[]);class VA{constructor(b){this.sk=b}reset(){this.sk.reset()}get HYc(){return this.sk.HYc}Pga(b,h){this.sk.Pga(b,h)}$ba(b){this.sk.$ba(b)}Tvb(b){this.sk.Tvb(b)}kDa(b){this.sk.kDa(b)}VMa(b){this.sk.VMa(b)}RYa(b,h){this.sk.RYa(b,h)}QYa(){this.sk.QYa()}MF(b){this.sk.MF(b)}fH(){this.sk.fH()}Pvb(){this.sk.Pvb()}Ovb(){this.sk.Ovb()}oDa(b){this.sk.oDa(b)}mDa(){this.sk.mDa()}YMa(b){this.sk.YMa(b)}nDa(){this.sk.nDa()}jcb(b){this.sk.jcb(b)}fca(b){this.sk.fca(b)}dca(){this.sk.dca()}p8(b){this.sk.p8(b)}eca(){this.sk.eca()}cca(b){this.sk.cca(b)}bca(){this.sk.bca()}VYa(b,
h){this.sk.VYa(b,h)}fcb(){this.sk.fcb()}}Object(u.a)(VA,"AHtmlNormalizer",null,[306,307]);class xC extends VA{constructor(b){super(b);this.eM=!1}Pga(b,h){this.eM?this.PP.iP(()=>{this.Gng(b,h)}):this.Gng(b,h)}Gng(b,h){this.sk.Pga(b,h)}$ba(b){this.eM?this.PP.iP(()=>{this.jng(b)}):this.jng(b)}jng(b){this.sk.$ba(b)}kDa(b){this.eM?this.PP.iP(()=>{this.kid(b)}):this.kid(b)}kid(b){this.sk.kDa(b)}VMa(b){this.eM?this.PP.iP(()=>{this.hng(b)}):this.hng(b)}hng(b){this.sk.VMa(b)}RYa(b,h){this.eM?this.PP.iP(()=>
{this.bng(b,h)}):this.bng(b,h)}bng(b,h){this.sk.RYa(b,h)}QYa(){this.eM?this.PP.iP(Object(z.a)(this,this.$mg,"processAnchorEnd")):this.$mg()}$mg(){this.sk.QYa()}MF(b){this.eM?this.PP.iP(()=>{this.sng(b)}):this.sng(b)}sng(b){this.sk.MF(b)}fH(){this.eM?this.PP.iP(Object(z.a)(this,this.rng,"processParagraphEnd")):this.rng()}rng(){this.sk.fH()}Pvb(){this.eM?this.PP.iP(Object(z.a)(this,this.vng,"processPreFormattedTextStart")):this.vng()}vng(){this.sk.Pvb()}Ovb(){this.eM?this.PP.iP(Object(z.a)(this,this.ung,
"processPreFormattedTextEnd")):this.ung()}ung(){this.sk.Ovb()}oDa(b){this.eM?this.PP.iP(()=>{this.nng(b)}):this.nng(b)}nng(b){this.sk.oDa(b)}mDa(){this.eM?this.PP.iP(Object(z.a)(this,this.kng,"processListEnd")):this.kng()}kng(){this.sk.mDa()}YMa(b){this.eM?this.PP.iP(()=>{this.mng(b)}):this.mng(b)}mng(b){this.sk.YMa(b)}nDa(){this.eM?this.PP.iP(Object(z.a)(this,this.lng,"processListItemEnd")):this.lng()}lng(){this.sk.nDa()}fca(b){this.eM?this.PP.iP(()=>{this.Fng(b)}):this.Fng(b)}Fng(b){this.sk.fca(b)}dca(){this.eM?
this.PP.iP(Object(z.a)(this,this.Cng,"processTableEnd")):this.Cng()}Cng(){this.sk.dca()}p8(b){this.eM?this.PP.iP(()=>{this.Eng(b)}):this.Eng(b)}Eng(b){this.sk.p8(b)}eca(){this.eM?this.PP.iP(Object(z.a)(this,this.Dng,"processTableRowEnd")):this.Dng()}Dng(){this.sk.eca()}cca(b){this.eM?this.PP.iP(()=>{this.Bng(b)}):this.Bng(b)}Bng(b){this.sk.cca(b)}bca(){this.eM?this.PP.iP(Object(z.a)(this,this.Ang,"processTableCellEnd")):this.Ang()}Ang(){this.sk.bca()}VYa(b,h){this.eM?this.PP.iP(()=>{this.png(b,h)}):
this.png(b,h)}png(b,h){this.sk.VYa(b,h)}fcb(){this.eM?this.PP.iP(Object(z.a)(this,this.cwj,"processMathEnd")):this.cwj()}cwj(){this.sk.fcb()}}Object(u.a)(xC,"AQueuingHtmlNormalizer",VA,[]);var OI=d(2097);class Hz{constructor(){this.Q5e=new OI.a}iP(b){this.Q5e.enqueue(b)}flush(b=!1){for(b&&this.vxe();!this.Q5e.isEmpty;)this.Q5e.dequeue()();b&&this.mve()}vxe(){}mve(){}}Object(u.a)(Hz,"QueuedEventManager",null,[]);class $m extends Hz{constructor(b){super();this.id=void 0;this.Avf=null;this.M9c=!1;this.Pua=
"";this.Tee=this.Nfe=!1;this.rvf=this.ogc=null;this.hed=0;this.W9c=this.vad=this.M1f=!1;this.table=null;this.Gbg=0;this.Y1=b}get aTc(){return!!this.table}vxe(){this.Y1.otc.push(this.Y1.currentState);this.Y1.currentState=this}mve(){this.Y1.currentState=this.Y1.otc.pop()}}$m.nextId=void 0;Object(u.a)($m,"ContentState",Hz,[]);class bt{constructor(b,h,n){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.Cab=b.Cab;this.shadingColor=b.shadingColor;this.verticalAlignment=
b.verticalAlignment;this.Una=b.Una;this.eCe=b.eCe;this.tpc=b.tpc;this.oaa=b.oaa;this.contents=n;this.GSm=h}}Object(u.a)(bt,"TableCell",null,[]);var GG=d(1792),qE=d(1793);class qt extends Hz{constructor(b,h){super();this.Y1=b;this.yHh=new Dz.a;this.Poa=new Dz.a;this.a1e=[];this.HLd=[];this.NQa=-1;this.a2a=0;this.BAk=h.HXf;this.AAk=h.Cen;this.xPk=h.iHg;this.zq=h.width;this.qqh=h.Cab;this.Ixk=new du.a(new bv(h.jca.QPi,h.jca.Xae),h.mD,h.xDa,h.cultureName,h.dIa);this.tzk=h.Obe;this.lOd=h.styleId;this.CPk=
h.tableLook}get sk(){return this.Y1.sk}Oeo(b){this.NQa++;this.yHh.add(b);this.HLd[this.NQa]=b.height;this.a2a=0}get dMl(){for(;this.a2a>=this.Poa.count;)this.Poa.add(Array(this.NQa+1));return this.Poa.J(this.a2a)}nVk(b,h,n,B,L,ba,la){if(0>this.NQa)return!1;for(;this.a1e[this.a2a]>=this.NQa;)this.a2a++;b=new bt(b,new du.a(h,n,B,L,ba),la);this.dMl[this.NQa]=b;if(1<b.rowSpan)for(h=this.NQa+b.rowSpan-1,B=this.a2a,n=this.a2a+b.colSpan-1;B<=n;B++)this.a1e[B]>=h||(this.a1e[B]=h);this.a2a+=b.colSpan;this.HLd[this.NQa]<
b.height&&(this.HLd[this.NQa]=b.height);return!0}vxe(){this.Y1.currentState.table=this}mve(){this.Y1.currentState.table=null}bqi(){A.AFrameworkApplication.Ld("fd8b6402;j6e17681");this.flush(!0);const b=this.NQa+1;var h=Array(b);for(var n=0;n<b;n++)h[n]=Array(this.Poa.count);n=!0;var B=0;for(var L=0;L<this.Poa.count;L++){var ba=this.Poa.J(L),la=!0;for(var La=0;La<b;La++){var fb=ba[La];fb&&(la=!1,h[La][L+B]=new Hu(fb.colSpan,fb.rowSpan,fb.width,fb.height,void 0,void 0,void 0,void 0,fb.Cab,fb.tpc))}la?
(this.Poa.removeAt(L),L--,++B):n=!1}if(!n){(h=this.qqh?this.Y1.j_h(h,this.zq/100):this.Y1.j_h(h,1,this.zq))&&h.length!==this.Poa.count&&(h=null);this.Y1.jpb(!0);this.Y1.wWd();this.sk.fca(new Nv(b,this.Poa.count,this.zq,this.qqh,h,this.BAk,this.AAk,this.xPk,this.tzk,this.lOd,this.CPk,this.Ixk));for(h=0;h<b;h++){n=this.yHh.J(h);this.sk.p8(new hE(this.HLd[h],new du.a(n.jca,n.mD,n.xDa,n.cultureName,n.dIa)));for(n=0;n<this.Poa.count;n++){B=this.Poa.J(n)[h];var Cb=!!this.lOd&&""!==this.lOd&&"Custom"!==
this.lOd;L=B?B.colSpan:0;ba=B?B.rowSpan:0;B&&(L=Math.min(B.colSpan,this.Poa.count-n),ba=Math.min(B.rowSpan,b-h));la=B?B.width:0;La=B?B.height:0;fb=B?B.oaa:0;const Lb=B?B.Cab:!1,$b=B&&(65536&fb||!Cb)?B.shadingColor:"",tc=B?B.verticalAlignment:0,Nc=B?B.tpc:!1;Cb=B?this.Y1.YBm(B.Una,n,h,this.Poa,Cb,B.oaa):new GG.a;const dd=B?B.eCe:new qE.a,Hd=B?B.GSm:null;this.sk.cca(new Hu(L,ba,la,La,$b,tc,Cb,dd,Lb,Nc,fb,new du.a(Hd?Hd.jca:null,Hd?Hd.mD:null,Hd?Hd.xDa:null,Hd?Hd.cultureName:null,Hd?Hd.dIa:null)));B&&
!B.tpc&&(B.contents.vxe(),B.contents.flush(),this.Y1.jpb(!1),this.Y1.wWd(),B.contents.mve());this.sk.bca()}this.sk.eca()}this.sk.dca();this.Y1.currentState.W9c=!1;this.Y1.eli(!1)}}}Object(u.a)(qt,"NormalizedTable",Hz,[]);class Ov{constructor(b=!1,h=!1){this.nBk=b;this.pqa=h}get Wkn(){return this.nBk}get Jeb(){return this.pqa}}Object(u.a)(Ov,"HtmlNormalizerSettings",null,[317]);class Hw extends xC{constructor(b,h=null){super(b);this.otc=new uC;this.G7b=h||new Ov}reset(){super.reset();this.currentState=
new $m(this);this.otc.clear();this.eM=!1}get PP(){return this.currentState&&this.currentState.aTc?this.currentState.table:this.currentState}H_c(b=!1){this.currentState.M9c||(this.wWd(),this.sk.MF(this.currentState.Avf),this.currentState.M9c=!0,this.currentState.W9c=!1);b||!this.currentState.ogc||this.currentState.Tee||(this.sk.RYa(this.currentState.ogc,this.currentState.rvf),this.currentState.Tee=!0)}G_c(){this.currentState.Tee&&(this.sk.QYa(),this.currentState.Tee=!1)}fli(){this.currentState.M9c&&
(this.sk.fH(),this.currentState.M9c=!1,this.currentState.Pua="")}eli(b){this.currentState.vad&&(this.currentState.W9c?b||(this.sk.MF(null),this.sk.fH(),this.sk.nDa(),this.currentState.vad=!1):(this.sk.nDa(),this.currentState.vad=!1,this.currentState.W9c=!0))}jpb(b){this.G_c();this.fli();this.eli(b)}A5n(b){this.sk.oDa(new Is.a(2,1,b));this.currentState.hed++;this.currentState.M1f=!0}wWd(){!this.currentState.vad&&this.currentState.M1f&&(this.sk.mDa(),this.currentState.hed--,this.currentState.M1f=!1)}Gng(b,
h){b=this.nRn(b);if(""!==b)if(this.H_c(),this.currentState.Nfe)this.Hng(b,h);else{b=b.split(Hw.pil);for(let n=0;n<b.length-1;n++)this.Hng(b[n],h),this.sk.Tvb(h);this.Hng(b[b.length-1],h)}}png(b,h){""!==b&&(this.H_c(),this.sk.VYa(b,h))}jng(b){this.G7b.Jeb||this.G_c();if(Em.a.Rmn){const h=this.currentState.M9c;this.H_c(!0);h?this.sk.$ba(b):this.fli()}else this.H_c(!0),this.sk.$ba(b)}hng(b){this.currentState.aTc||this.sk.VMa(b)}kid(b){this.currentState.ogc&&(b.href=this.currentState.ogc);super.kid(b)}bng(b,
h){this.G_c();this.currentState.ogc=b;this.currentState.rvf=h}$mg(){this.G_c();this.currentState.ogc=null;this.currentState.rvf=null}sng(b){this.currentState.Avf=b;this.jpb(!0)}rng(){this.currentState.Avf=null;this.jpb(!0)}vng(){this.currentState.Nfe=!0}ung(){this.currentState.Nfe=!1}nng(b){this.jpb(!1);this.wWd();this.sk.oDa(b);this.currentState.hed++}kng(){this.jpb(!1);this.sk.mDa();this.currentState.hed--}mng(b){this.jpb(!1);this.currentState.hed||this.A5n(b);this.sk.YMa(b);this.currentState.vad=
!0;this.currentState.W9c=!0}lng(){this.jpb(!1)}fca(b){this.currentState.aTc||(this.eM=!0,this.currentState.table=new qt(this,b))}Fng(){}dca(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=null;this.otc.isEmpty?(this.eM=!1,b.bqi()):this.PP.iP(Object(z.a)(b,b.bqi,"flushTable"))}}Cng(){}p8(b){this.currentState.aTc&&this.currentState.table.Oeo(b)}Eng(){}eca(){}Dng(){}cca(b){let h=!1;if(this.currentState.aTc){const n=new $m(this);this.currentState.table.nVk(b,new bv(b.jca.QPi,
b.jca.Xae),b.mD,b.xDa,b.cultureName,b.dIa,n)?(this.otc.push(this.currentState),this.currentState=n):h=!0}else h=!0;h&&this.currentState.Gbg++}Bng(){}bca(){0<this.currentState.Gbg?this.currentState.Gbg--:this.currentState=this.otc.pop()}Ang(){}j_h(b,h=1,n=0){if(!b)return null;const B=b.length;if(!B)return null;const L=b[0].length;for(var ba=1;ba<B;ba++)if(b[ba].length!==L)return null;ba=Array(L+1);ba[0]=0;const la=Array(L+1);for(var La=0;La<la.length;La++)la[La]=!1;La=new ob.a;for(let Cb=0;Cb<L;Cb++){for(var fb=
0;fb<B;fb++){const Lb=b[fb][Cb];if(Lb&&0<Lb.width){const $b=Math.min(Cb+Lb.colSpan,L);ba[$b]=ba[Cb]+Lb.width*(Lb.Cab?h:1);la[$b]=!0}}if(la[Cb+1]){fb=ba[Cb+1]-ba[Cb];if(0>=fb)return null;La.add(fb)}else ba[Cb+1]=ba[Cb]}return Em.a.s1f&&ba[L]<n?null:La.toArray()}bJn(b,h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}YBm(b,h,n,B,L,ba){if(!b)return null;L&&(b=this.bJn(b,ba));if(0>n||0>h||h>B.count-1)return b;0<=h-1&&n<=
B.J(h-1).length-1&&1===b.borderLeftStyle&&(L=B.J(h-1)[n])&&1!==L.Una.borderRightStyle&&(b.borderLeftStyle=L.Una.borderRightStyle,b.borderLeftColor=L.Una.borderRightColor,b.borderLeftWidth=L.Una.borderRightWidth);0<=n-1&&n<=B.J(h).length-1&&1===b.borderTopStyle&&(h=B.J(h)[n-1])&&1!==h.Una.borderBottomStyle&&(b.borderTopStyle=h.Una.borderBottomStyle,b.borderTopColor=h.Una.borderBottomColor,b.borderTopWidth=h.Una.borderBottomWidth);return b}nRn(b){this.currentState.Nfe||(b=this.G7b.Wkn?b.replace(Hw.T1m,
" "):b.replace(Hw.S1m," "));b.startsWith(" ")&&(this.currentState.Pua.endsWith(" ")||""===this.currentState.Pua)&&(b=F.a.substring(b,1,b.length));return b}Hng(b,h){""!==b&&(this.sk.Pga(b,h),this.currentState.Pua+=b)}}Hw.S1m=RegExp("[ \t\f\u200b\r\n]+","g");Hw.T1m=RegExp("[ \f\u200b\r\n]+","g");Hw.pil="\t";Object(u.a)(Hw,"DefaultHtmlNormalizer",xC,[]);class Pv extends Hw{constructor(b,h,n){super(b,n);this.elh=!1;this.jEb=h}static ahn(b){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",
!1)&&b?(b=Pv.JRl.exec(b))&&0<b.length:!1}kid(b){this.jEb.Vtc&&(A.AFrameworkApplication.iua?this.elh||(b=new ui.StandardDialog,b.Gd=0,b.Pe(1,CommonUIStrings.l_DialogClose),b.Ix(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.elh=!0):this.jEb.kdj?this.jEb.Tje=!0:b.src&&""!==b.src?za.a.getOrigin(b.src)!==za.a.getOrigin(window.location.href)||Pv.ahn(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?A.AFrameworkApplication.va.Ob(wb.a.zsj,2):b.src.startsWith("webkit-fake-url")?
A.AFrameworkApplication.va.Ob(wb.a.ysj,2):(this.G_c(),this.H_c(!0),this.sk.kDa(b)):A.AFrameworkApplication.va.Ob(wb.a.Bsj,2):A.AFrameworkApplication.va.Ob(wb.a.Asj,2))}}Pv.JRl=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");Object(u.a)(Pv,"Box4HtmlNormalizer",Hw,[]);class rE{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb){this.RPi=b;this.xUf=h;this.Jnl=n;this.Rbk=B;this.ldm=L;this.LNo=ba;this.MNo=la;this.H6c=La;this.K1m=fb;this.N1m=Cb;this.Wbd=Lb}}Object(u.a)(rE,"ExecutePasteArguments",null,
[]);class tj extends pn{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd,Hd,xe,je=null){super(h,n,B,Cb,$b,dd,xe);this.vRb=je;this.T5=null;this.gRn=he=>{this.JNk&&this.rVe.Ynp(this.C$);he.Ni(this.Seo);return!0};this.Seo=he=>{if(this.YMk){const fe=this.C$.getElementsByTagName("style");if(fe&&0<fe.length){x.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let De=0;De<fe.length;De++)this.nSe.BBl(this.C$,fe[De]),fe[De]&&(fe[De].parentNode.removeChild(fe[De]),
De--)}}he.Ni(this.OBl);return!0};this.OBl=(he,fe)=>{this.tdf.value.create(fe.Rbk).process(this.C$,he);(fe=Ya.a.instance.Oa("Box4.IFeatureHelper"))&&fe.isFeatureEnabled(8)?he.Ni(this.VAl):he.Ni(this.Wvj);return!0};this.VAl=(he,fe)=>{(new lE(fe.Jnl)).process(this.C$,he);he.Ni(this.Wvj);return!0};this.Wvj=(he,fe)=>{var De;if(Em.a.Gta){var gg=window.performance.now();this.C$=this.vRb.N6k(this.C$);Vi.a.Uue=window.performance.now()-gg}else if(Em.a.Xoc&&!document.getElementById("FrameContainingPastedDOM")){gg=
window.performance.now();var eg=document.createElement("iframe");Em.a.Ytn?(eg.style.visibility="hidden",eg.style.zIndex="-100",eg.style.position="absolute",eg.style.width=window.screen.width+"px",eg.style.height=window.screen.height+"px"):eg.style.display="none";eg.style.contain="strict";eg.setAttribute("sandbox","allow-same-origin");eg.id="FrameContainingPastedDOM";document.body.appendChild(eg);(eg=eg.contentDocument)&&Em.a.brn&&(eg.documentElement.style.fontSize="62.5%",eg.body.style.fontSize="1.6rem");
Vi.a.kZd=window.performance.now()-gg}eg=null;!Em.a.Gta&&Em.a.Xoc&&(eg=document.getElementById("FrameContainingPastedDOM"));!Em.a.Gta&&Em.a.Xoc&&eg instanceof HTMLIFrameElement?(gg=window.performance.now(),eg=null===(De=eg.contentDocument)||void 0===De?void 0:De.querySelector("body"),null===eg||void 0===eg?void 0:eg.appendChild(this.C$),Vi.a.Uue=window.performance.now()-gg,De=null===eg||void 0===eg?void 0:eg.children,1!==(null===De||void 0===De?void 0:De.length)&&x.ULS.sendTraceTag(508913473,307,15,
"Found Multiple Pasted Container in iframe element"),fe.RPi.process(1===(null===De||void 0===De?void 0:De.length)?De[0]:this.C$,he)):fe.RPi.process(this.C$,he);he.Ni(fe.xUf&&fe.xUf.Vtc?this.FZb:this.oki);return!0};this.FZb=(he,fe)=>{if(fe=fe.xUf){let gg=!1,eg=!1,vl=!1,wl=!1;var De=-1;const Sm=new Og.DictionaryPropertySet,qp=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');Object(Wb.a)(97,this.Vi.rd)?(gg=this.Vi.rd.ja(Lc.a.Tla,!1),De=this.Vi.rd.ja(zd.a.mS,""),vl=this.Vi.rd.ja(zd.a.L7,!1),
wl=this.Vi.rd.ja(Hf.a.xCa,!1),qp.test(De)&&(eg=!0),De=this.Vi.rd.ja(hi.a.Dka,-1)):this.Vi.ux&256&&this.C$&&(gg=!0,qp.test(this.C$.innerHTML)&&(eg=!0));Sm.setValue(Lc.a.Tla,gg);Sm.setValue(zd.a.Aad,eg);Sm.setValue(zd.a.L7,vl);Sm.setValue(hi.a.Dka,De);Sm.setValue(Hf.a.xCa,wl);fe.Rxe(Sm);fe.Egg();fe.qvb&&(this.Vi.K9c=!0,this.Vi.RUf=fe.v_,this.Vi.cdg=fe.qvb,gg&&!vl&&Pe.c(wb.a.Y4l),A.AFrameworkApplication.va.Ob(wb.a.FZb,2))}he.Ni(this.oki);return!0};this.oki=(he,fe)=>{var De;he=window.performance.now();
if(Em.a.Gta)this.vRb.lzo();else if(Em.a.Xoc){var gg=document.getElementById("FrameContainingPastedDOM");gg instanceof HTMLIFrameElement&&(gg=null===(De=gg.contentDocument)||void 0===De?void 0:De.querySelector("body"),(null===gg||void 0===gg?0:gg.firstElementChild)?(x.ULS.sendTraceTag(508858444,307,50,"iframe body first element child was not null"),null===gg||void 0===gg?void 0:gg.removeChild(null===gg||void 0===gg?void 0:gg.firstElementChild)):x.ULS.sendTraceTag(508858443,307,15,"iframe body first element child was null"))}Vi.a.ytg=
window.performance.now()-he;$q.a.kGn(fe.Rbk);$q.a.ADn(fe.N1m);$q.a.hFn(fe.LNo);$q.a.iFn(fe.MNo);$q.a.ZDn(fe.Wbd);De="Others";fe.H6c&&(fe.H6c.xDn(),fe.H6c.yDn(),fe.H6c.vFn(),De=fe.H6c.BEg);$q.a.zDn(fe.K1m,De);$q.a.iDn(fe.ldm,De);return!1};this.C$=b;this.aMe=L;this.ZVe=ba;this.haf=la;this.tdf=La;this.KIc=fb;this.G7b=Nc;this.Ga=Lb;this.Xlh=Object.assign(new pt,{Unc:2===this.Vi.Nfc||3===this.Vi.Nfc});this.nSe=tc;this.rVe=Hd;this.vac=Lb.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.YMk=
Lb.$("ParseStyleFromRawHtmlHeadIsEnabled");this.JNk=Lb.$("RemoveSpacesAfterEndFragmentIsEnabled")}get Jle(){return!1}get SSb(){return!0}nmi(b){Em.a.utb?Rn.a.instance.Yd(()=>{this.omi(b)},"EPEM:EP"):this.omi(b)}omi(b){this.T5=new ve.GraphIterator;this.Kcb.restore(this.T5);x.ULS.shipAssertTag(6305550,307,xb.OutlineElementReader.Mh(this.T5));this.Vi.cV&&this.Vi.cV.qdc("external");var h=this.Vi.ux&8192?1:0,n=this.ZVe.value.create(h,this.T5,this.Vi.SVc,this.Vi.Gxb),B=this.haf.value.create(h,this.T5);const L=
$q.a.hvi(A.AFrameworkApplication.userSessionId),ba=$q.a.DKi(A.AFrameworkApplication.userSessionId),la=$q.a.rKf(X.a.WKb,this.Vi.SVc),La=$q.a.dHi(A.AFrameworkApplication.userSessionId),fb=$q.a.eHi(A.AFrameworkApplication.userSessionId),Cb=this.vac?this.l7m():null,Lb=$q.a.Vzi(X.a.WKb,this.Vi.SVc),$b=$q.a.Wzi(A.AFrameworkApplication.userSessionId),tc=this.KIc.zSj?$q.a.Qym(A.AFrameworkApplication.userSessionId):null;h=this.aMe.value.create(h,this.T5,n,B,null,la,this.f5k,this.Vi.LCe);h=new ei(h,La,fb);
h=new Pv(h,n,this.G7b);h=new Jm(h,this.KIc,this.Xlh,tc,Em.a.Gta?this.vRb:null);B=new mE(Cb);h=new hh(h,B,Lb,Cb,this.Ga);h=new cv(h,$b);n=new rE(h,n,L,ba,la,La,fb,Cb,Lb,$b,tc);n=new Mv.a(b,this.gRn,n);n.vm("paste and request pictures");n.ni=!b||b.ni;n.run()}get f5k(){return this.C$.getElementsByTagName("a").length}l7m(){const b=new FG;b.Jtc=X.a.WKb;this.Vi&&(b.ux=this.Vi.ux,b.Xpj=this.Vi.SVc,this.Vi.rd&&(b.progId=this.Vi.rd.ja(zd.a.xsj,"")));this.C$&&this.C$.innerHTML&&(b.wsj=this.C$.innerHTML.length,
Vi.a.hkg=b.wsj);A.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=A.AFrameworkApplication.sessionStartInfoSettings.Platform,b.Uge=A.AFrameworkApplication.K.$("IsO365ConsumerHost"),b.XVi=ea.ParagraphReader.Fea(Ua.StaticActiveAppFrame.za().ib.sc.jd));return b}get QSj(){return!0}get qpd(){x.ULS.shipAssertTag(6305551,307,!!this.T5);if(this.KIc.ASj(this.Xlh)){var b=!1;xb.OutlineElementReader.Mh(this.T5)&&(this.T5.S_(),b=!0);var h=ea.ParagraphReader.Bh(this.T5)&&!this.T5.currentNode.ja(zd.a.iYi,
!1);b&&this.T5.uc();return h}return this.Vi.ux&524288?(b=!1,xb.OutlineElementReader.Mh(this.T5)&&(this.T5.S_(),b=!0),h=ea.ParagraphReader.Bh(this.T5),b&&this.T5.uc(),h):ea.ParagraphReader.Bh(this.T5)}}Object(u.a)(tj,"ExternalPasteExecutionManager",pn,[]);class dv{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc=null){this.Cic=$b;this.vRb=tc;this.aMe=b;this.ZVe=h;this.haf=n;this.tdf=B;this.KIc=L;this.B1=ba;this.Ga=la;this.nSe=La;this.G7b=fb;this.e$=Cb;this.rVe=Lb}create(b,h,n,B){return new tj(b,h,n,B,
this.aMe,this.ZVe,this.haf,this.tdf,this.KIc.value,this.B1,this.Ga,Ua.StaticActiveAppFrame.za().ib,this.nSe,this.G7b,this.e$,this.rVe,this.Cic,Em.a.Gta?this.vRb.value:null)}}Object(u.a)(dv,"Factory",null,[530]);class eu{constructor(b=null){var h;this.LD=b;b=window.performance.now();Em.a.gWi&&(null===(h=this.LD)||void 0===h?void 0:h.execute(n=>{n.logActivity("CCPUsage","CCPFloodgateSurvey")}));this.Mtf();Vi.a.kZd=window.performance.now()-b}N6k(b){if(this.Tfa.contentDocument){const h=this.Tfa.contentDocument.body;
b=h.appendChild(b);1!==h.children.length&&x.ULS.sendTraceTag(508624975,307,15,`Found Non-One Pasted Containers ${h.children.length}`);return b}x.ULS.sendTraceTag(508624974,307,15,"iframe not loaded when append method was called");return b}lzo(){if(this.Tfa.contentDocument){var b=this.Tfa.contentDocument.body;b.lastElementChild?(x.ULS.sendTraceTag(508624930,307,50,"iframe body first element child was not null"),b.removeChild(b.lastElementChild)):x.ULS.sendTraceTag(508624929,307,15,"iframe body first element child was null")}}x6l(b){var h;
const n=null===(h=this.Tfa.contentDocument)||void 0===h?void 0:h.body;return(null===n||void 0===n?0:n.contains(b))?getComputedStyle(b):b.style}Mtf(){var b=document.getElementById(Mk.a.DBc);this.Tfa=document.createElement("iframe");this.Tfa.style.visibility="hidden";this.Tfa.style.zIndex="-100";this.Tfa.style.position="absolute";this.Tfa.style.contain="strict";Em.a.arn&&(this.Tfa.style.width=window.screen.width+"px",this.Tfa.style.height=window.screen.height+"px");this.Tfa.setAttribute("sandbox","allow-same-origin");
this.Tfa.id="FrameContainingPastedDOM";b?(b.appendChild(this.Tfa),b=this.Tfa.contentDocument,Em.a.r2i&&b?(b.documentElement.style.fontSize="62.5%",b.body.style.fontSize="1.6rem"):Em.a.r2i&&x.ULS.sendTraceTag(508441186,307,15,"Iframe not loaded when setting root fontSize")):x.ULS.sendTraceTag(508624973,307,15,"View Panel not found")}}Object(u.a)(eu,"HiddenExternalPasteView",null,[529]);class HG{uwn(b){if(!b||!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.iin(b.childNodes[h-2])&&
this.jun(b.childNodes[h-1])}Ynp(b){this.uwn(b)&&(b.removeChild(b.lastChild),x.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}Cfn(b){return!!b&&8===b.nodeType}Bsn(b){return!!b&&3===b.nodeType}iin(b){return this.Cfn(b)&&"EndFragment"===b.nodeValue}jun(b){if(!this.Bsn(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(u.a)(HG,"HtmlNormalizerHelper",null,[528]);var ev=d(1089),ns=d(678);class xq extends pn{constructor(b,h,n,B,L,ba,la,La,fb){super(b,h,n,L,ba,La,fb);this.wB=
B;this.YK=la}get Bl(){return this.YK.value}get Jle(){return this.wB.Jle()}get Esj(){const b=this.wB;return b.Srf&&!b.jUi()}pmi(b,h){x.ULS.shipAssertTag(6305616,307,pl.OutlineReader.zy(b));const n=ns.a(b.currentNode);if(pl.OutlineReader.isEmpty(b)){var B=Nd.a.create(b.currentNode);b.qt(8);A.AFrameworkApplication.va.lg(B,wb.a.SJ,2,!0,null,null)}else b.qt(8);(B=b.IL(1))&&b.uc();this.wB.msj(this.Vi.me,b.currentNode,B,-1,n,h)}nmi(b){const h=new ve.GraphIterator;this.Kcb.restore(h);x.ULS.shipAssertTag(6305618,
307,xb.OutlineElementReader.Mh(h));this.Vi.cV&&this.Vi.cV.qdc("internal");let n=-1;if(Object(Wb.a)(97,this.Vi.rd))n=this.Vi.rd.ja(hi.a.Dka,-1);else{const B=this.Nom(h.currentNode);n=B?B.clientWidth:n}this.wB.msj(this.Vi.me,h.parentNode,h.currentNode,n,null,b);this.F_i&&(this.Kcb.restore(h),xb.OutlineElementReader.Mh(h)&&this.wB.$2i(h)&&(b=Ga.OutlineElementNavigator.Le(h)))&&(this.Vi.kKa=Oe.SelectionFactory.se(b,0))}Nom(b){return b?(b=b?b.ue(this.Bl.oc):null)?b.htmlElement:null:null}xTj(){const b=
new ve.GraphIterator;this.Kcb.restore(b);return this.wB.$2i(b)}get QSj(){return!0}get qpd(){return!this.wB.OAa&&!this.wB.Srf}}Object(u.a)(xq,"InternalPasteExecutionManager",pn,[]);class IG{constructor(b,h,n,B,L){this.Cic=L;this.wB=b;this.B1=h;this.YK=n;this.e$=B}create(b,h,n){return new xq(b,h,n,this.wB,this.B1,Ua.StaticActiveAppFrame.za().ib,this.YK,this.e$,this.Cic)}}Object(u.a)(IG,"Factory",null,[527]);var WA;(function(b){b[b.unknown=0]="unknown";b[b.MXp=1]="differentBox4App";b[b.Siq=2]="sameBox4AppDifferentSession";
b[b.Tiq=3]="sameBox4AppSameSession"})(WA||(WA={}));Object(u.b)("CopySource",WA);class Qv{constructor(b,h,n,B){this.wB=b;this.vnh=h;this.avk=n;this.ul=B}i$n(b,h,n){x.ULS.shipAssertTag(6305620,307,!!b);x.ULS.shipAssertTag(6305621,307,re.SelectionEditor.mf(h));x.ULS.shipAssertTag(6305622,307,!!n);x.ULS.shipAssertTag(6305623,307,Object(Wb.a)(Fz.a,n.Mua));const B=n.Mua;B.Nfc=this.wB.Ewi(b);this.NDn(b,B);let L=!1;this.ul.Vla(h,La=>L=La)&&(B.ux|=8192,hn.a.JXd&&(B.LCe=1,L||(B.LCe|=2)));const ba=this.kln(B);
var la=new Sd.GraphTransaction(7,wb.a.paste);la.Ab(h.node);h.node.CL().YG.laa(8);ba?(x.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",B.ux,B.browserName),b=this.vnh.create(h,B,la)):(x.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",B.ux,B.Nfc,B.browserName),Qv.DDn(b),b=this.avk.create(b,h,B,la));n=new Mv.a(n,Object(z.a)(b,b.rsj,"pasteSetup"),null);n.vm("Paste");n.run()}kln(b){return!this.pon(b)&&3===b.Nfc}pon(b){return 1===(b.ux&8192?
1:0)}qUi(b,h){x.ULS.shipAssertTag(6305624,307,re.SelectionEditor.mf(b));x.ULS.shipAssertTag(6305625,307,!!h);x.ULS.shipAssertTag(6305626,307,Object(Wb.a)(Fz.a,h.Mua));const n=new Sd.GraphTransaction(7,wb.a.Lce);n.Ab(b.node);b=this.vnh.create(b,h.Mua,n);h=new Mv.a(h,Object(z.a)(b,b.rsj,"pasteSetup"),null);h.vm("InternalPasteAtIp");h.run()}NDn(b,h){if(b){let n=!1,B=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?B=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(n=!0);(n||B)&&x.ULS.sendTraceTag(42471960,
307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",WA[h.Nfc],n,B)}}static DDn(b){b&&Qv.LSk.test(b.innerText)&&x.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}Qv.LSk=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(u.a)(Qv,"PasteCoordinator",null,[]);var xr=d(856),Iw=d(1182),Jw=d(1181);class zs{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc=null){this.Qua=
b;this.mca=h;this.lo=n;this.$uj=B;this.ua=L;this.Dcb=ba;this.K=la;this.n$n=La;this.Uga=fb;this.Y9a=Cb;this.Zza=Lb;this.lb=$b;this.ama=tc;this.cdi=100;this.Fpc=!1;this.ePe=null;this.VXe=!1;this.qJd=null;this.IFd=this.VRa=!1;this.Ham=(Nc,dd)=>{this.dismissFloatie(dd.Y7l)};this.y6o=(Nc,dd)=>{this.GFl(Nc,dd)};this.LN=(Nc,dd)=>{dd.property===Hf.a.lastModifiedTime?(x.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.Y9a.xvf.contains(wb.a.IMg)||this.Ipg(dd)):x.ULS.sendTraceTag(520734532,
307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")};this.XYa=(Nc,dd)=>{this.Ipg(dd)};this.Hma=(Nc,dd)=>{dd.aee||this.Ipg(dd)};this.pmj=()=>{xr.a.instance.keyCode===Jd.a.oFa&&this.mca.Uxj()};this.Ebp()}Ebp(){this.mca.oQh(this.y6o);this.mca.WPh(this.Ham)}GFl(b,h){var n,B,L;(null===(B=null===(n=this.lb.gb)||void 0===n?void 0:n.currentSelection)||void 0===B?0:B.u9c)?x.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):
(this.Dcb.OWf(),1===this.n$n.WFl(h.ihd)?x.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId):this.showFloatie(b,h)?(this.VRa?this.VRa=!1:this.rwo(),this.ikd(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",wb.a.jX(h.K0)||"Unknown",h.correlationId),x.ULS.sendTraceTag(40379588,307,50,b),Pe.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new ia.a,{name:"PasteCommand",int64:wb.a.jX(h.K0)||"Unknown"}),Object.assign(new ia.a,
{name:"CorrelationId",string:null===(L=h.correlationId)||void 0===L?void 0:L.toString()})]),this.s2b()):x.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId))}dismissFloatie(b){var h;!this.VXe&&(this.VRa||(this.ama?null===(h=this.Zza)||void 0===h?0:h.D3:this.Qua.D3()))&&(b&&(this.Dcb.OWf(),this.y5j(),x.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.qJd)),this.VRa=!b,this.MEe(),this.ama?
A.AFrameworkApplication.va.Ob(wb.a.xRb,2):this.Qua.dismissFloatie())}rwo(){this.IFd||(this.ePe=this.lo.zd,Nb.a.addHandler(this.ePe.container,"scroll",Object(z.a)(this,this.m_b,"scrollHandler")),this.ua.z2(Object(z.a)(this,this.qna,"resizeHandler")),this.IFd=!0)}y5j(){this.IFd&&(Nb.a.removeHandler(this.ePe.container,"scroll",Object(z.a)(this,this.m_b,"scrollHandler")),this.ua.iha(Object(z.a)(this,this.qna,"resizeHandler")),this.IFd=!1)}s2b(){if(this.ama)this.Zza.D3&&A.AFrameworkApplication.va.Ob(wb.a.xRb,
2),A.AFrameworkApplication.va.Ob(wb.a.Rpd,2),this.Fpc=!1;else{const b=new Jw.a(0,A.AFrameworkApplication.isRtl);b.location=this.Dcb.bWa();this.Dcb.gjn(b.location)?this.showFloatie(null,b):this.mca.ENa(new Iw.a(!1))}}qna(){this.ama?(A.AFrameworkApplication.va.Ob(wb.a.xRb,2),this.zYc()):this.s2b()}m_b(){this.ama?(A.AFrameworkApplication.va.Ob(wb.a.xRb,2),this.zYc()):this.s2b()}ikd(){this.$uj.X0k(this.pmj);this.mca.bQh(Object(z.a)(this.Qua,this.Qua.v2d,"expandFloatie"));this.mca.kQh(Object(z.a)(this,
this.usj,"pastedFloatieStatusChange"));this.Uga.Zt(this.Hma);this.Uga.Bw(this.XYa);this.Uga.fo(this.LN)}MEe(){this.$uj.MAo(this.pmj);this.mca.TDj(Object(z.a)(this.Qua,this.Qua.v2d,"expandFloatie"));this.mca.aEj(Object(z.a)(this,this.usj,"pastedFloatieStatusChange"));this.Uga.jV(this.Hma);this.Uga.hha(this.XYa);this.Uga.QN(this.LN)}usj(b,h){this.VXe=h.t9c;h.K0&&(this.qJd=h.K0);h.XCg&&this.Qua.D3()&&this.s2b()}Ipg(b){b.node.EI||this.mca.ENa(new Iw.a(!0))}showFloatie(b,h){h||(h=new Jw.a(0,A.AFrameworkApplication.isRtl));
h.location||(h.location=this.Dcb.bWa());if(!h.location)return!1;this.VRa&&(this.VRa=!1,this.ikd());this.ama?A.AFrameworkApplication.va.Ob(wb.a.Rpd,2):this.Qua.showFloatie(b,h);return!0}zYc(){if(!this.Fpc){const b=new Re.a(3,1,this.cdi,()=>{this.s2b()},215);ph.a.instance.Zb(b);this.Fpc=!0}}}Object(u.a)(zs,"PasteFloatieEventManager",null,[]);class Ey{constructor(b,h){this.Pk=b;this.HK=h}WFl(b){return Sl.any(Sl.where(Sl.asEnumerable(Ey.Pep),h=>this.HK.P$c(h)))?(b=this.Pk.vwb(b))&&(b=b.innerText)&&0<
b.trim().length?0:1:1}}Ey.Pep=[wb.a.LZa.toString(),wb.a.MZa.toString(),wb.a.SDa.toString()];Object(u.a)(Ey,"PasteFloatieFeatureSetBuilder",null,[]);class XA{constructor(){this.BDa=null;this.Ntc=0}}Object(u.a)(XA,"PasteFloatieAnchorData",null,[]);class Rv{constructor(b,h,n,B,L,ba=!1){this.MGb=null;this.hb=b;this.Kya=h;this.nd=n;this.Lwk=B;this.j4e=L;this.uYe=ba}OWf(){this.MGb=null}bWa(){const b=this.gKf(this.MGb)||this.UZh();if(!b){let h="null",n="null";if(this.MGb&&this.MGb.BDa){if(!this.nd.zd)return x.ULS.sendTraceTag(51143187,
307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.MGb.BDa).getName();const B=this.nd.zd.nl(this.MGb.BDa);B&&(n=Object.getType(B).getName())}x.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,n)}return b}gjn(b){if(!b)return!1;const h=this.j4e.KPb(),n=this.Lwk(this.nd.zd.container);b=new Sys.UI.Bounds(b.x,b.y,h.width,h.height);return b.y>=n.y&&b.y+b.height<=n.y+n.height}UZh(){if(!this.hb||
!this.hb.gb||!this.hb.gb.currentSelection)return x.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var b=this.hb.gb.currentSelection.Ra,h=!b.cpBegin&&!b.cpEnd;let n=b.node;if(n&&h){do n=this.hFi(n);while(n&&Object(Wb.a)(Cn.AParagraphNode,n)&&!n.characterData.trim().length)}let B="";const L=Object(ya.a)(Cn.AParagraphNode,n);L&&(B=L.characterData.length===b.cpBegin||h?L.characterData.trimEnd():L.characterData.substring(0,b.cpBegin).trimEnd());h=L?
B.length:b.cpBegin;b=Object.assign(new XA,{BDa:Object(ya.a)(120,(L?Object(ya.a)(120,L):Object(ya.a)(120,n))||b.node),Ntc:h});return this.gKf(b)}hFi(b){const h=new ve.GraphIterator;if(!b.anchor)return null;h.set(b);if(!h.Jd())return null;h.ld(11);return h.bK()?h.Ub(2):null}gKf(b){if(!b||!b.BDa)return null;this.MGb=b;const h=this.nd.zd;if(!h)return x.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.Xzi(b,h);if(!b)return null;A.AFrameworkApplication.isRtl&&
this.j4e.D3()&&(b.x-=this.j4e.KPb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}Xzi(b,h){h=h.ue(b.BDa);if(!h)return null;let n=null;if(Object(Wb.a)(Cn.AParagraphNode,b.BDa)){const B=Object(ya.a)(88,h);if(!B)return null;try{n=this.Kya.F2(b.Ntc,B,0<b.Ntc,!1,!1,!1),n.height+=this.uYe?Rv.Ano:Rv.Kam}catch(L){x.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",L),n=null}}else Object(Wb.a)(NA.TableNode,b.BDa)&&(n=Object(ya.a)(526,h).NOf());
n||(n=h.getBounds());return n}}Rv.Kam=2;Rv.Ano=60;Object(u.a)(Rv,"PasteFloatiePositionProvider",null,[]);class Iz{constructor(b,h,n,B,L){this.ZAa=b;this.eub=h;this.A$n=n;this.z$n=B;this.SSb=L}}Object(u.a)(Iz,"PastedContentsPostProcessorParams",null,[]);class yC{H7m(b,h,n,B,L,ba){b=this.Ism(b,h,L);n=this.Exm(n);if(!b||!n)return null;B=this.mFm(b,B,L);L=this.lFm(n);return new Iz(b,n,B,L,ba)}Ism(b,h,n){b=n?b:h;if(!xb.OutlineElementReader.Mh(b))return null;h=new Ml.a;h.hd(b);return h}Exm(b){if(!xb.OutlineElementReader.Mh(b))return null;
const h=new Ml.a;h.hd(b);Ga.OutlineElementNavigator.Y3(h,!1,!1);return h}mFm(b,h,n){Ga.OutlineElementNavigator.Le(b);let B=-1;ea.ParagraphReader.Bh(b)&&(B=n?h:0);Ga.OutlineElementNavigator.he(b);return B}lFm(b){Ga.OutlineElementNavigator.Le(b);const h=ea.ParagraphReader.Bh(b)?ea.ParagraphReader.textLength(b.currentNode):-1;Ga.OutlineElementNavigator.he(b);return h}}Object(u.a)(yC,"PastedContentsPostProcessorHelper",null,[]);class Sr{constructor(b,h){this.oGc=b;this.Eqk=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get Bri(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get Tvf(){return CommonUIStrings.l_ClipboardCut}get Y7f(){return CommonUIStrings.l_ClipboardCut_Mac}get Msf(){return CommonUIStrings.l_ClipboardCopy}get X7f(){return CommonUIStrings.l_ClipboardCopy_Mac}get Mtc(){return CommonUIStrings.l_ClipboardPaste}get Z7f(){return CommonUIStrings.l_ClipboardPaste_Mac}get j4(){return CommonUIStrings.l_ClipboardPasteText}get $7f(){return CommonUIStrings.l_ClipboardPasteText_Mac}get Jpf(){return this.Eqk}get L3h(){return CommonUIStrings.l_ClipboardExtensionLink}get snb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}Imi(){x.ULS.sendTraceTag(8716421,
307,50,null);$c.a.yn(this.Jpf,"_blank",void 0,"ClipboardAccessExtensionLink")}kha(b,h){let n=X.a.$l;A.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(n=X.a.Di||n);return n?String.format(h,"\u2318"):b}dispose(){this.oGc=null}fqg(b){this.T8h(b)}syn(b){this.T8h(b)}T8h(b){this.oGc&&this.oGc(b)}}Sr.id="CopyPasteShortcutDialog";Sr.g0j="CopyPasteText";Object(u.a)(Sr,"ACopyPasteShortcutDialog",null,[13]);class YA extends Sr{constructor(b,h,n){super(b,h);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=Sr.g0j;var B=document.createElement("span");B.innerText=this.Bri;var L=document.createElement("span");L.className="UIFontBold";L.innerText=this.kha(this.Tvf,this.Y7f);const ba=document.createElement("span");ba.className="UIFontBold";ba.innerText=this.kha(this.Msf,this.X7f);const la=document.createElement("span");la.className="UIFontBold";la.innerText=this.kha(this.Mtc,this.Z7f);h.appendChild(B);h.appendChild(document.createElement("br"));
h.appendChild(L);h.appendChild(ba);h.appendChild(la);n.$("PasteTextOnlyShortcutDialogIsEnabled")&&(X.a.Vr||X.a.uj)&&(n=document.createElement("span"),n.className="UIFontBold",n.innerText=this.kha(this.j4,this.$7f),h.appendChild(n));b.appendChild(h);this.Jpf?(x.ULS.sendTraceTag(8716420,307,50,null),n=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.L3h,Nb.a.addHandler(h,"click",Object(z.a)(this,this.Imi,"extensionLinkHandler")),n.appendChild(h),L=this.snb.indexOf("{0}"),
-1!==L&&(B=this.snb.substring(0,L),L=this.snb.substring(L+3,this.snb.length),B=document.createTextNode(B),L=document.createTextNode(L),n.insertBefore(B,h),n.appendChild(L)),b.appendChild(document.createElement("br")),b.appendChild(n)):x.ULS.sendTraceTag(8716422,307,50,null);n=new ui.StandardDialog;n.Gd=0;n.Qg=Sr.id;n.Ix(this.titleText,null,0,Object(z.a)(this,this.syn,"legacyCopyPasteShortcutDialogHandler"),b);n.L8(Sr.g0j)}}Object(u.a)(YA,"CopyPasteShortcutDialog",Sr,[]);class zC extends Sr{constructor(b,
h){super(b,h);h={};b=this.Ran;h.extensionStartText=this.L4l;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.O0o;h.cutText=this.kha(this.Tvf,this.Y7f);h.copyText=this.kha(this.Msf,this.X7f);h.pasteText=this.kha(this.Mtc,this.Z7f);4!==A.AFrameworkApplication.ua.Ib.Tk&&(h.pasteTextOnly=this.kha(this.j4,this.$7f));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const n=new Ge.a(!1,!1,!0);n.Qg="CopyPasteInstallDialog";n.Gd=0;n.Pe(1,this.Qan);n.uY(1);n.pi(b,Object(z.a)(this,
this.fqg,"reactCopyPasteShortcutDialogHandler"),h)}get O0o(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get Qan(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get Ran(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get L4l(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static e5o(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(u.a)(zC,"ReactCopyPasteInstallDialog",Sr,[]);class PI extends Sr{constructor(b){super(b,null);this.N6i="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.wQn;var n="";let B="";this.messageText&&(n=this.messageText.split(" {")[0],B=this.messageText.split("} ")[1]);h.startText=n;h.endText=B;h.cutText=this.RMl;h.copyText=this.fCl;h.pasteText=this.q$n;
h.cutShortcutText=this.kha(this.SMl,this.nHn);h.copyShortcutText=this.kha(this.pCl,this.mHn);h.pasteShortcutText=this.kha(this.t$n,this.pHn);h.imageSrc=Zg.a.Tea("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.Hfo;this.N6i&&(x.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.oub,["onExecute"]:()=>{this.iyn()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
n=new Ge.a(!1,!1,!0);n.Gd=0;n.Qg="CopyPasteNoClipboardAccessDialog";n.pi(b,Object(z.a)(this,this.fqg,"reactCopyPasteShortcutDialogHandler"),h)}get wQn(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get oub(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get Hfo(){return CommonUIStrings.l_DialogOk}get RMl(){return CommonUIStrings.l_CutString}get SMl(){return CommonUIStrings.l_CutShortcut}get nHn(){return CommonUIStrings.l_CutShortcut_Mac}get fCl(){return CommonUIStrings.l_CopyString}get pCl(){return CommonUIStrings.l_CopyShortcut}get mHn(){return CommonUIStrings.l_CopyShortcut_Mac}get q$n(){return CommonUIStrings.l_PasteString}get t$n(){return CommonUIStrings.l_PasteShortcut}get pHn(){return CommonUIStrings.l_PasteShortcut_Mac}iyn(){x.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");$c.a.yn(this.N6i,"_blank",void 0,"learnMoreLink")}}Object(u.a)(PI,"ReactCopyPasteNoClipboardAccessDialog",Sr,[]);class Fy extends Sr{constructor(b,h,n){super(b,h);b={};b.forwardElementText=this.Bri;b.cutText=this.kha(this.Tvf,this.Y7f);b.copyText=this.kha(this.Msf,this.X7f);b.pasteText=this.kha(this.Mtc,this.Z7f);n.$("PasteTextOnlyShortcutDialogIsEnabled")&&(X.a.Vr||X.a.uj)&&(b.pasteTextOnly=this.kha(this.j4,this.$7f));this.Jpf?(x.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.L3h,["onExecute"]:B=>{this.Imi(B)}},n=this.snb.indexOf("{0}"),-1!==n&&(b.suggestionPrefixElement=this.snb.substring(0,n),b.suggestionSuffixElement=this.snb.substring(n+3,this.snb.length))):x.ULS.sendTraceTag(40726915,307,50,null);n={["id"]:Sr.id,["bodyControls"]:b};b=new Ge.a(!1,!1,!0);b.Gd=0;b.Qg=Sr.id;b.pi(this.titleText,Object(z.a)(this,this.fqg,"reactCopyPasteShortcutDialogHandler"),n)}}Object(u.a)(Fy,"ReactCopyPasteShortcutDialog",
Sr,[]);class fu{constructor(){this.WRa=!!A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.cH}ptf(b,h,n=!1){x.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.WRa,n));this.WRa?n?new zC(b,h):new Fy(b,h,A.AFrameworkApplication.K):new YA(b,h,A.AFrameworkApplication.K)}static get instance(){return fu._instance||(fu._instance=new fu)}}fu._instance=null;Object(u.a)(fu,"CopyPasteShortcutDialogFactory",null,[1363]);class Jz{constructor(b,h,n,B,
L,ba,la,La){this.gFh=this.qph=this.n$e=!1;this.qPk=b;this.nd=h;this.Sy=n;this.Yb=B;this.Je=L;this.ug=ba;this.ff=la;La&&(this.gFh=La.$("ShouldLogExecCommandCopySuccess"))}get f0a(){return this.qPk}get oab(){return this.qph}set oab(b){this.qph=b;this.ug.iUf=b}I_c(b){this.f0a.I_c(b);b||this.Drd(!0)}get G1l(){return this.f0a.zvg}UXb(b){this.oab=!0;this.f0a.UXb(b,this.KHg)}reset(){this.oab=!1}paste(){var b=null;let h=null;if(!this.f0a.m3b){(b=this.nd.zd)&&this.Yb.Bg(b.xL);var n=this.Sy.Vu;if(!n.te||!n.Ke.ek)return null;
h=n.Ke;b=this.Je.Cx();this.oab=!0;n.Ufb()}n=null;try{h&&h.ueo(),n=b=this.f0a.Z_c(this.KHg,b)}catch(B){x.ULS.shipAssertTag(6305672,307,!1),this.mMi()}this.oab=!1;return n}jE(){var b=this.nd.zd;b&&this.Yb.Bg(b.xL);b=this.Sy.Vu;if(!b.te||1!==b.Ke.mode)return!1;this.oab=!0;let h;try{const n=new Map;n.set("View","ContentEditableView");oa.Health.instance.recordKpiUsage(Js.a.kVd,0,Js.a.N0h,n);const B=this.f0a.lCf(this.KHg);h=!0;this.gFh&&x.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",
B,this.ff.eE);if(!B){const L=Object.assign(new rb.a,{extendedProperties:n});oa.Health.instance.recordKpiFailure(Js.a.kVd,Js.a.L0h,!0,!0,L)}}catch(n){x.ULS.shipAssertTag(6305673,307,X.a.uj),x.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",X.a.eE),h=!1}this.oab=!1;return h?!0:!1}Drd(){if(this.n$e)return!0;var b=this.Sy.Vu;if(!b.te||!b.Ke.ek)return!1;const h=b.Ke;b=this.Je.Cx();this.oab=!0;const n=new Hs.a(b);let B=!1;try{B=this.f0a.Drd(b,()=>{h.iWd()},
()=>{h.fOa()})}catch(L){}n.restore();this.oab=!1;B?this.n$e=!0:(x.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",X.a.eE),this.mMi());return B}mMi(){this.n$e=!1;if(A.AFrameworkApplication.LEp)fu.instance.ptf(null,null);else{const b=new ui.StandardDialog;b.Gd=0;b.yY(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get KHg(){const b=this.Je.Kqb();return b?b.Io:null}}Object(u.a)(Jz,"SystemClipboard",null,
[525]);class ct{constructor(b,h,n){this.NPd=!1;this.lQd=this.mW=this.qsh=this.yNe=this.iyd=null;this.Mco=B=>{1===B?(x.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.nNe)),this.Nbc&&(x.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.Nbc)),$c.a.yn(this.fUe+this.p2e,"_blank",void 0,"ChromeCCPInstallDialog"))):B||x.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.nNe))};this.nNe=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");
this.fUe=b.kb("ChromeClipboardAccessExtensionLink");this.kib=h;this.Pk=n;this.p2e=b.kb("ChromeClipboardAccessExtensionId");this.WRk=b.$("UseGetClipboardDataIsEnabled");this.wBh=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.Nbc=!1;b.$("CcpInstallDialogIsEnabled")&&A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.cH&&(this.Nbc=zC.e5o()||b.$("IgnoreDomainCheckCcpInstallDialog"),x.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.Nbc));this.mHc=null}I_c(b){b?this.mW=!0:(this.mW=
null,chrome.runtime&&chrome.runtime.sendMessage?(this.mHc=this.kib.HZd,this.kib.q0b?(this.NPd=this.WRk,this.N1h()):(this.NPd=!0,this.N1h(),x.ULS.sendTraceTag(19256732,307,50,S.a.create().toString()))):(this.L0b(),this.mW=!1))}get zvg(){return this.mW}get m3b(){return this.lQd}Drd(){return!0}lCf(b){x.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=$c.a.iOb(b,"copy"))||x.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,
2)));return b}cIf(b){if(!b)return null;var h=b.img;const n=b.text;b=b.html;const B=this.Pk.FKj(!!h,!!n,b);let L=null;if(3===B){if(!b)return null;h=this.Pk.Smi(b);(h=this.Pk.Zmi(h))&&(b+=h);L=this.Pk.vwb(b)}else 2===B?L=this.Pk.Wjg(n,!0):1===B&&(L=this.Pk.vwb(h));return L}Z_c(b,h){if(this.m3b)h=this.cIf(this.yNe),this.yNe=null;else{if(!this.iyd)return h;b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=this.iyd;h=b.body;this.iyd=null}return h}UXb(b){const h=S.a.create();this.qsh=
h;this.kib.q0b?x.ULS.sendTraceTag(7377737,307,50,h.toString()):x.ULS.sendTraceTag(19256735,307,50,h.toString());const n={};n.command=this.m3b?"getClipboardData":"paste";chrome.runtime.sendMessage(this.mHc,n,B=>{h.equals(this.qsh)?this.m3b?this.yNe=B:this.iyd=B:x.ULS.sendTraceTag(7385868,307,50,null);x.ULS.sendTraceTag(7377738,307,50,h.toString());chrome.runtime.lastError&&(this.zYl(),this.kib.q0b?x.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):x.ULS.sendTraceTag(19256737,307,10,
chrome.runtime.lastError.message));b()})}L0b(){x.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.Nbc?b=this.fUe+this.p2e:this.nNe&&(b=this.fUe+this.mHc);fu.instance.ptf(this.Mco,b,this.Nbc)}zYl(){this.kib.qFo();this.L0b()}VLj(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}Wnl(){const b=S.a.create();this.kib.q0b?x.ULS.sendTraceTag(592491466,307,50,b.toString()):x.ULS.sendTraceTag(591984031,307,50,b.toString());chrome.runtime.sendMessage(this.mHc,{command:"getAvailableCommands"},
h=>{x.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(Wb.a)(Array,h)?(x.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.lQd=-1!==Array.indexOf(h,"getClipboardData")):(x.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.lQd=!1):(x.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.lQd=!1)})}N1h(){const b=S.a.create();this.kib.q0b?x.ULS.sendTraceTag(7726105,
307,50,b.toString()):x.ULS.sendTraceTag(591984032,307,50,b.toString());this.NPd&&this.Wnl();this.VLj(this.mHc,h=>{x.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.mW=!0:(h?"ping"!==h&&x.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):x.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),
this.L0b(),this.mW=!1);this.NPd&&!this.m3b&&x.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}U$i(b,h){const n={};n.OfficeOnlineExtensionInstallationStatus=b;n.OfficeClipboardExtensionInstallationStatus=h;x.ULS.sendTraceTag(51144839,307,50,JSON.stringify(n));this.wBh&&(b&&oa.Health.instance.recordKpiSuccess(ct.Owh,null),h&&oa.Health.instance.recordKpiSuccess(ct.Lwh,null))}QCn(){this.wBh&&(oa.Health.instance.recordKpiUsage(ct.Owh,1,ct.nhh,null),oa.Health.instance.recordKpiUsage(ct.Lwh,
1,ct.nhh,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.kib.q0b;this.VLj(this.p2e,h=>{this.U$i(b,!!h)})}else this.U$i(!1,!1)}}ct.Owh="OfficeOnlineExtensionInstallationStatus";ct.Lwh="OfficeClipboardExtensionInstallationStatus";ct.nhh="wwccp";Object(u.a)(ct,"ChromeSystemClipboardAccessManager",null,[551]);class QI{constructor(b,h){this.mW=null;this.ff=b;this.Ga=h;this.dpk=!this.Ga.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.Ga.$("BlockCopyCutOnFirefoxIsEnabled");this.OMk=
h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}I_c(b){this.dpk&&b&&this.ff.uj?(this.L0b(),this.mW=!1):this.mW=!0}get zvg(){return this.mW}get m3b(){return!1}lCf(b){return $c.a.iOb(b,"copy")}Z_c(b,h){$c.a.iOb(b,"paste");return h}UXb(b){b()}Drd(b,h,n){if(this.ff.K7)return this.OMk&&(this.mW=!1),!1;h();n();b=this.Z_c(b.ownerDocument,b);h=b.innerHTML;b.innerHTML=yb.a.create().toString();n();b=this.Z_c(b.ownerDocument,b);return this.mW=b=h===b.innerHTML}L0b(){fu.instance.ptf(null,null)}}
Object(u.a)(QI,"DefaultSystemClipboardAccessManager",null,[551]);class ZA{constructor(b,h,n){this.mW=this.Pda=this.a$b=this.Xpa=this.g4a=this.eyd=null;this.Pk=h;this.q4a=n;this.vEk=b.ic("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.uNk=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}I_c(b){this.uNk&&b&&(this.mW=!0)}get zvg(){return this.mW}get m3b(){return!1}lCf(b){return b?$c.a.iOb(b,Cd.a.jE):!1}Z_c(b,h){this.g4a&&(h=this.g4a,this.g4a=
null);return h}UXb(b,h=null){if(b&&h){this.eyd=b;this.a$b=h;$addHandler(this.a$b,Cd.a.paste,Object(z.a)(this,this.Lmj,"onPasteEvent"));this.Pda=this.Xpa=null;if(this.p4j(this.a$b)){if(this.Pda&&0<this.Pda.length&&(!this.Xpa||this.Pk.PFe(this.Xpa))){this.q4a.j8h(this.Pda,Object(z.a)(this,this.LYn,"onImageConverted"));this.g4a&&!this.g4a.hasChildNodes()&&x.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.Xpa&&this.Xpa.innerHTML&&((this.g4a=this.SPi(this.Xpa.innerHTML))&&
!this.g4a.hasChildNodes()&&x.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),Lh.a.rF(this.Xpa))}this.kpi()}else b&&b()}Drd(b){return this.mW=b=this.p4j(b.ownerDocument)}Lmj(b){try{b&&b.rawEvent&&((this.Xpa=b.rawEvent.target)&&this.Xpa.id&&-1<this.Xpa.id.indexOf("Paste")?(x.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.Xpa.id),this.Xpa=null):this.Pda=this.Bvm(b.rawEvent))}catch(h){x.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+
h.toString())}}LYn(b){b&&(this.q4a.XSj&&(b=String.format('<img src="{0}">',b)),this.g4a=this.SPi(b));this.kpi()}kpi(){this.a$b&&($removeHandler(this.a$b,Cd.a.paste,Object(z.a)(this,this.Lmj,"onPasteEvent")),this.a$b=null);this.eyd&&(this.eyd(),this.eyd=null)}Bvm(b){let h=null;(b=this.Pk.zvi(b))&&({mUf:h}=this.Pk.R3j(b,this.vEk,this.q4a.edj));return h}p4j(b){return $c.a.iOb(b,Cd.a.paste)}SPi(b){const h=document.implementation.createHTMLDocument("doc");h.body.innerHTML=b;return h.body}L0b(){}}Object(u.a)(ZA,
"EdgeSystemClipboardAccessManager",null,[551]);class Gy{constructor(b,h,n,B){this.Ga=b;this.sqk=h;this.Pk=n;this.ff=B}create(){let b=null;A.AFrameworkApplication.$Cg()&&this.ff.Vr&&window.chrome?(x.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new ct(this.Ga,this.sqk,this.Pk),this.Ga.$("LogChromeExtensionInstallationStatusIsEnabled")&&b.QCn()):this.Ga.$("EdgeContextMenuPasteFixIsEnabled")&&this.ff.ju?(x.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),
b=new ZA(this.Ga,Ya.a.instance.resolve("Box4.IClipboardDataHelper"),Ya.a.instance.resolve("Box4.IProcessImageStrategy"),Ya.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(x.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new QI(this.ff,this.Ga));return b}}Object(u.a)(Gy,"SystemClipboardAccessManagerFactory",null,[524]);var Sv=d(837),gu;(function(b){b[b.automatic=1]="automatic";b[b.clear=2]="clear";b[b.cfb=3]="themeColors";b[b.imq=4]="standardColors";
b[b.iY=5]="recentColors";b[b.Q7p=6]="moreColors";b[b.JWa=7]="highContrastColors"})(gu||(gu={}));Object(u.b)("ColorMenuControls",gu);var Kw=d(1129);class Tr{constructor(b){this.BLc=null;this.syd={};this.ASb=()=>{this.BLc=null};this.vO=b;this.m8e=""}get Ana(){return this.m8e}set Ana(b){b=b||"";this.m8e!==b&&(this.m8e=b,this.ASb())}cPb(b,h){if(this.BLc)return this.BLc;if(!b)return null;const n=Object.assign(new vh.a,{Id:String.format("menu{0}Color",this.vO),ExternalId:String.format("{0}Color",this.vO)});
n.MenuSectionList=[];Object(Kw.a)()&&n.MenuSectionList.push(this.ZWk());n.MenuSectionList.push(this.VUk());n.MenuSectionList.push(this.vVk());n.MenuSectionList.push(this.PZk(b,h));n.MenuSectionList.push(this.wZk());return this.BLc=n}PQ(b,h){gu[b]in this.syd||(this.syd[gu[b]]=h)}bmb(b,h){b.Gef(this.ASb,h)}ZWk(){if(!({actionId:h}=this.Osd(7)).returnValue)return null;const b=Object.assign(new te.a,{Id:String.format("{0}Color",this.vO),ControlsId:String.format("{0}.Color.Menu.Controls",this.vO),DisplayMode:"Menu16",
ControlList:[]});var h=Object.assign(new jj.a,{Command:h.toString(),LabelText:F.a.Hf(Box4Intl.Box4Strings.L_HighContrastColorPicker),Image16by16:A.AFrameworkApplication.Ys,Image16by16Class:Bb.getImageClass("Automatic_16x16x32"),Id:String.format("HighContrast{0}ColorPicker",this.vO),ExternalId:String.format("HighContrast{0}ColorPicker",this.vO),KeyTip:CommonUIStrings.l_HighContrastColorPickerKeytip,QueryCommand:wb.a.Tid.toString()});b.ControlList.push(h);return b}VUk(){if(!({actionId:h}=this.Osd(1)).returnValue)return null;
const b=Object.assign(new te.a,{Id:String.format("{0}Color",this.vO),ControlsId:String.format("{0}.Color.Menu.Controls",this.vO),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new jj.a,{Command:h.toString(),LabelText:F.a.Hf(Box4Intl.Box4Strings.L_Automatic),Image16by16:A.AFrameworkApplication.Ys,Image16by16Class:Bb.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});b.ControlList.push(h);return b}vVk(){if(!({actionId:h}=this.Osd(2)).returnValue)return null;
const b=Object.assign(new te.a,{Id:String.format("{0}Color",this.vO),ControlsId:String.format("{0}.Color.Menu.Controls",this.vO),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new jj.a,{Command:h.toString(),LabelText:F.a.Hf(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:A.AFrameworkApplication.Ys,Image16by16Class:Bb.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});b.ControlList.push(h);return b}PZk(b,h){if(!({actionId:B}=this.Osd(3)).returnValue)return null;
const n=Object.assign(new te.a,{Id:"Colors",ControlsId:String.format("{0}.Color.Menu.Controls",this.vO),ControlList:[]});var B=Object.assign(new Sv.a,{Id:String.format("Theme{0}ColorPicker",this.vO),ExternalId:String.format("Theme{0}ColorPicker",this.vO),McuExternalId:String.format("Theme{0}ColorPickerMCU",this.vO),McuLayout:!0,Command:B.toString(),Width:10});const {Gul:L,fjp:ba}=Tr.iOm(b,h);B.Colors=L;this.GPj(B,ba);n.ControlList.push(B);return n}wZk(){if(!({actionId:h}=this.Osd(4)).returnValue)return null;
const b=Object.assign(new te.a,{Id:String.format("{0}Colors",this.vO),ControlsId:String.format("{0}.Color.Menu.Controls",this.vO),Title:F.a.Hf(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]});var h=Object.assign(new Sv.a,{Id:String.format("Standard{0}ColorPicker",this.vO),ExternalId:String.format("Standard{0}ColorPicker",this.vO),Command:h.toString(),Width:10,Colors:[]});h.Colors=Tr.zLm();this.GPj(h);b.ControlList.push(h);return b}GPj(b,h){if(b){var n="";"object"===typeof this.Ana?void 0!==
h&&(n=this.WJm(h,this.Ana)):n=this.FJm(b.Colors,this.Ana);b.Stateful=!0;b.SelectedColorId=""!==n?n:"NoColor"}}WJm(b,h){var n,B;let L="";for(const ba of b)if(ba.UCe===h.quc&&ba.Cxc===(null===(n=h.ZIa)||void 0===n?void 0:n.Cxc)&&ba.gfb===(null===(B=h.ZIa)||void 0===B?void 0:B.gfb)){L=ba.Hul;break}return L}FJm(b,h){let n="";if(!b)return n;for(let B=0;B<b.length;B++)if(b[B].DisplayColor.toLowerCase()===h.toLowerCase()){n=b[B].Color;break}return n}Osd(b){b=gu[b];return b in this.syd?{returnValue:!0,actionId:this.syd[b]}:
{returnValue:!1,actionId:0}}static zLm(){const b=[];b.push(Object.assign(new gm,{Color:"0000C0",Alt:F.a.Hf(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"}));b.push(Object.assign(new gm,{Color:"0000FF",Alt:F.a.Hf(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"}));b.push(Object.assign(new gm,{Color:"00C0FF",Alt:F.a.Hf(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"}));b.push(Object.assign(new gm,{Color:"00FFFF",Alt:F.a.Hf(Box4Intl.Box4Strings.L_FontColorYellow),
DisplayColor:"#FFFF00"}));b.push(Object.assign(new gm,{Color:"50D092",Alt:F.a.Hf(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"}));b.push(Object.assign(new gm,{Color:"50B000",Alt:F.a.Hf(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));b.push(Object.assign(new gm,{Color:"F0B000",Alt:F.a.Hf(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"}));b.push(Object.assign(new gm,{Color:"C07000",Alt:F.a.Hf(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));
b.push(Object.assign(new gm,{Color:"602000",Alt:F.a.Hf(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));b.push(Object.assign(new gm,{Color:"A03070",Alt:F.a.Hf(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return b}static iOm(b,h){const n=b.properties.ja(Lc.a.cfb,null);b=b.properties.getValue(Lc.a.XCe).split(" ");const B=[],L=[];for(let fb=0;6>fb;fb++)for(let Cb=0;10>Cb;Cb++){var ba=10*fb+Cb,la=n[ba];la=la&4278190080|(la&255)<<16|la&65280|(la&16711680)>>>16;ba=
F.a.PJ(ba+1<<24,8);var La=h[b[Cb]];const Lb=this.Psi(fb,Cb,n[Cb]);Lb.Hul=ba;L.push(Lb);La=Tr.nlp(La,Lb);B.push(Object.assign(new gm,{Color:ba,DisplayColor:"#"+F.a.PJ(la,6),Alt:F.a.Hf(La)}))}return{Gul:B,fjp:L}}static nlp(b,h){if(void 0===h.Cxc&&void 0===h.gfb)return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,b,h.LIg);const n=void 0!==h.gfb;return String.format(n?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,b,h.LIg,n?h.gfb:h.Cxc)}static Psi(b,
h,n){if(b){var B=n&255,L=(n&65280)>>>8;n=(n&16711680)>>>16;L=Math.floor((Math.min(Math.min(B,L),n)+Math.max(Math.max(B,L),n))/2);B=b-1;L?255===L?(b=!1,B=[242,217,191,166,128][B]):204<L?(b=!1,B=[230,191,128,64,26][B]):51>L?(b=!0,B=[26,64,128,191,230][B]):(L=[51,102,153],n=[191,128],B=(b=B<L.length)?L[B]:n[B-L.length]):(b=!0,B=[128,166,191,217,242][B]);B=255-B;h={UCe:Tr.TCe[h].name,LIg:Tr.TCe[h].label};b?h.gfb=Math.round(100*B/255):h.Cxc=Math.round(100*B/255);return h}return{UCe:Tr.TCe[h].name,LIg:Tr.TCe[h].label}}static kpp(b,
h){if((h=h.properties.ja(Lc.a.cfb,null))&&0<=b&&b<h.length){const n=b%10;return Tr.Psi(Math.floor(b/10),n,h[n])}}}Tr.TCe={0:{name:"background1",label:Box4Intl.Box4Strings.l_ThemeLabel1},1:{name:"text1",label:Box4Intl.Box4Strings.l_ThemeLabel2},2:{name:"background2",label:Box4Intl.Box4Strings.l_ThemeLabel3},3:{name:"text2",label:Box4Intl.Box4Strings.l_ThemeLabel4},4:{name:"accent1",label:Box4Intl.Box4Strings.l_ThemeLabel5},5:{name:"accent2",label:Box4Intl.Box4Strings.l_ThemeLabel6},6:{name:"accent3",
label:Box4Intl.Box4Strings.l_ThemeLabel7},7:{name:"accent4",label:Box4Intl.Box4Strings.l_ThemeLabel8},8:{name:"accent5",label:Box4Intl.Box4Strings.l_ThemeLabel9},9:{name:"accent6",label:Box4Intl.Box4Strings.l_ThemeLabel10}};Object(u.a)(Tr,"ColorMenu",null,[514]);class AC{k3l(b){return b}}Object(u.a)(AC,"DeleteTableSegmentStrategy",null,[523]);var Hy=d(480),Ks=d(1119);class jn{get Sr(){return Hv.a.oQb}get rl(){return null!=this.O2g?this.O2g:this.O2g=Ya.a.instance.resolve("Box4.IParagraphEditor")}get h4(){return this.rl.Sr}get Ec(){return Yc.a.instance}get iC(){return null!=
this.Z2g?this.Z2g:this.Z2g=Ya.a.instance.resolve("Box4.IParagraphIndentationReader")}uTc(b,h,n,B,L,ba,la){let La=2;if(!b.te)return 2;const fb=b.lb;if(!fb)return this.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.Gga}),8;if(A.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){b=this.M_h(h===wb.a.OI,n,!0);if(1===B)return b?32:8;b&&(La=Ks.a.Stc(h,n,B,L,ba,la))}else La=Ks.a.Stc(h,n,1,L,ba,la),1!==B&&32===La?(b.lb.doe(),b=new Sd.GraphTransaction(15),b.Ab(n.view.jd),La=this.M_h(h===wb.a.OI,n,!1)?Ks.a.Stc(h,
n,B,L,ba,la):8,b.dispose()):1!==B&&8===La&&(b.lb.doe(),this.sxl(h,n,fb));return La}M_h(b,h,n){h=h.view.lb;if(!h||!h.gb.currentSelection)return this.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.ZVb}),!1;if(h.gb.QL)return this.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.Rrf}),!1;h=Hy.OutlineElementGeneralizer.Wka(h.gb,!1);if(!h)return this.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.I2d}),!1;let B=!1;for(let L=0;L<h.length;L++){const ba=h.getContext(L),la=new ve.GraphIterator;la.set(ba.node);re.SelectionEditor.rv(la);if(!xb.OutlineElementReader.Mh(la))if(n)continue;
else return this.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.DNb}),!1;if(b?!this.Sr.pLb(la):!this.Sr.tec(la))if(n)continue;else return this.Ec.$b(Tf.a.jhc,{["Reason"]:hf.a.$nf}),!1;B=!0}return n?B:!0}sxl(b,h,n){const B=new Sd.GraphTransaction(15);try{B.Ab(h.view.jd);h=!0;const L=Hy.OutlineElementGeneralizer.Wka(n.gb,!1);for(let ba=0;ba<L.length;ba++){const la=L.getContext(ba),La=new ve.GraphIterator;La.set(la.node);re.SelectionEditor.rv(La);if(!xb.OutlineElementReader.Mh(La))h=!1;else if(b===wb.a.OI?this.Sr.pLb(La):
this.Sr.tec(La))switch(h=!1,b){case wb.a.OI:this.Sr.xZa(La,-1,0);break;case wb.a.fR:this.Sr.VYc(La,1)}}if(h){const ba=n.gb.currentSelection;for(n=0;n<ba.length;n++){const la=ba.J(n);if(la.Gl){const La=this.iC.Rqb(la.node),fb=La.Eha;if(b===wb.a.OI?La.oD>fb:La.oD<18*fb){const Cb=new ve.GraphIterator;Cb.set(la.node);this.h4.wEa(Cb,1,b===wb.a.OI?La.oD>=2.5*fb?La.oD-2*fb:fb:La.oD<16*fb?La.oD+2*fb:18*fb)}}}}}finally{B&&B.dispose()}}}Object(u.a)(jn,"IndentationActorExtension",null,[522]);var RI=d(810),Hh=
d(1305);class mC{constructor(b,h){this.So=new Og.DictionaryPropertySet;this.dKd=new Og.DictionaryPropertySet;this.EEb=!1;this.oHa=this.lhb=null;this.c$=b;this.Rih=h}get Izb(){return null!=this.z5g?this.z5g:this.z5g=Ya.a.instance.Oa("Box4.ITextFormattingCommands")}get km(){return null!=this.UXg?this.UXg:this.UXg=Ya.a.instance.resolve("Box4.IFormattingEditor")}get Vb(){return null!=this.F7g?this.F7g:this.F7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}txb(){this.EEb||(0<this.jXa.oL()&&(this.dKd=
this.So.clone()),this.So.lue(),this.lhb=null,this.Gyo())}oCl(b){var h;const n=null!==(h=Va.FormattingReader.Cs(b))&&void 0!==h?h:Va.FormattingReader.U6d(b.node,b.cpBegin,-1);!n.cache.sD&&(b=n.uo)&&(h=new Og.DictionaryPropertySet,h.Bv(b),h.Bv(this.So),h.hasProperty(lk.a.Gw)&&(this.lhb=n.paragraph.Lc),this.So=h)}hasProperty(b){return this.So.hasProperty(b)}d6c(){return 0<this.So.oL()}get jXa(){return this.So}freeze(){this.EEb=!0}ZOa(){this.EEb=!1}rI(b,h){return this.jXa.ja(b,h)}oC(b){this.So.setValue(Hf.a.fontSize,
this.km.tfc(b));this.w4();Qn.a.Gqg(this.dKd,this.So)}fontSize(){return this.So.ja(Hf.a.fontSize,Qn.a.gP)}Hxe(b){this.So.setValue(Hf.a.font,b);this.Rih&&this.Rih.execute(h=>{null==h?x.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):h.Hxe(this.So)});this.c$&&this.c$.enabled&&(Vc.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.c$.DTo(this.So,b));this.w4();Qn.a.Gqg(this.dKd,this.So)}$Ag(b){this.So.setValue(Lc.a.Qe,b);this.c$&&this.c$.enabled&&
(Vc.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.c$.fZo(this.So,b));this.w4()}ax(b){b=tp.a.instance.sra(Zb.a.instance.gb.currentSelection.Ra.node,b);this.So.setValue(Hf.a.fontColor,b);this.w4();Qn.a.Gqg(this.dKd,this.So)}$ja(){this.So.setValue(Hf.a.fontColor,Nl.a.auto);this.w4()}fontColor(){return this.So.ja(Hf.a.fontColor,Nl.a.nil)}uEa(b){this.So.setValue(Hf.a.highlight,parseInt(b,16));this.w4()}bWd(){this.So.setValue(Hf.a.highlight,Nl.a.auto);this.w4()}isBold(){return this.So.ja(Hf.a.bold,
!1)}SN(b){this.So.setValue(Hf.a.bold,b);this.w4()}isItalic(){return this.So.ja(Hf.a.italic,!1)}kA(b){this.So.setValue(Hf.a.italic,b);this.w4()}isUnderline(){return this.So.ja(Hf.a.underline,!1)}Q8(b){this.So.setValue(Hf.a.underline,b);this.So.setValue(Hf.a.underlineType,b?Qn.a.fAb:Qn.a.HS);this.w4()}underlineType(){return this.So.ja(Hf.a.underlineType,Qn.a.HS)}yha(b){b<Qn.a.fAb||b>Qn.a.HS||(this.So.setValue(Hf.a.underline,b!==Qn.a.HS),this.So.setValue(Hf.a.underlineType,b),this.w4())}isSuperscript(){return this.So.ja(Hf.a.superscript,
!1)}Kva(b){this.So.setValue(Hf.a.superscript,b);b&&this.isSuperscript()&&this.So.setValue(Hf.a.subscript,!1);this.w4()}isSubscript(){return this.So.ja(Hf.a.subscript,!1)}uOa(b){this.So.setValue(Hf.a.subscript,b);b&&this.isSubscript()&&this.So.setValue(Hf.a.superscript,!1);this.w4()}isStrikethrough(){return this.So.ja(Hf.a.strikethrough,!1)}Gna(b){this.So.setValue(Hf.a.strikethrough,b);this.w4()}isDoubleStrikethrough(){return this.So.ja(lk.a.du,!1)}Cxe(b){this.So.setValue(lk.a.du,b);this.w4()}gvi(){return this.So.ja(lk.a.Gw,
null)}oeb(b,h){this.So.lue();this.So.setValue(lk.a.Gw,b.id);this.lhb=h.Lc;this.w4()}N8(b){let h=Hf.a.DN;const n=RI.a.Uhe(b);switch(n){case 1:h=Lc.a.hqc;break;case 2:h=Lc.a.iqc}this.So.setValue(Lc.a.Xab,n);this.So.setValue(h,b);this.w4()}language(){let b=Hf.a.DN;switch(this.So.ja(Lc.a.Xab,0)){case 1:b=Lc.a.hqc;break;case 2:b=Lc.a.iqc}return this.So.ja(b,0)}SVo(b){this.So.setValue(Lc.a.noProof,b);this.w4()}kTb(){return this.So.ja(Lc.a.noProof,!1)}Zmn(){return this.So.hasProperty(Lc.a.noProof)}Dln(){return this.So.hasProperty(Hf.a.DN)||
this.So.hasProperty(Lc.a.hqc)||this.So.hasProperty(Lc.a.iqc)}w4(){if(X.a.bzc){Object(Pb.a)();var b=Zb.a.instance.gb.currentSelection.Ra,h=b.node;if(h===this.oHa)this.oHa.om(16,!0);else{this.oHa=h;h=this.oHa.a1();try{this.oHa.F_(b.cpBegin).tCa=!0}finally{h&&h.dispose()}}}}Gyo(){if(X.a.bzc&&this.oHa){var b=0,h=this.oHa.a1();try{for(let n=this.oHa.qa.length-1;0<=n;n--){const B=this.oHa.qa.J(n);B.tCa&&(B.tCa=!1,b++,B.isEmpty&&this.oHa.qa.removeAt(n))}}finally{h&&h.dispose()}this.oHa=null}}lAl(b){if(b.cpBegin!==
b.cpEnd)return!1;b=b.node.qa.sh(b.cpBegin);return!!b&&b.tCa}Vif(b){if(this.Izb){this.freeze();var h=new Sd.GraphTransaction(7);h.Ab(b.node);this.Izb.Jxe(b);this.ZOa();this.txb();h.dispose()}}$Nf(b){const h=ea.ParagraphReader.text(b.node);return b.cpBegin&&b.cpBegin!==h.length&&!F.a.Qw(h.charCodeAt(b.cpBegin))&&Hh.a.instance.j9a(h,b.cpBegin-1)!==b.cpBegin&&re.SelectionEditor.Ftb(b)?(b=re.SelectionEditor.i7(b,!1))?1<b.length||re.SelectionEditor.am(b.Ra)?b:null:null:null}}Object(u.a)(mC,"InsertionPointFormatting",
null,[521]);class Tv extends Ge.a{constructor(b,h){super(!1,!1,!0);this.Nul=(n,B)=>{1===n?(n=B.selectedColorText,6!==n.length?x.ULS.sendTraceTag(595345436,340,10,"Color picker dialog did not return the color in expected format RRGGBB. Color returned: {0}, Menu: {1}",n,this.vO):(n=n.substring(4,6)+n.substring(2,4)+n.substring(0,2),A.AFrameworkApplication.va.Pb(this.ONe,2,n),x.ULS.sendTraceTag(595345435,340,50,"Color selected from color picker dialog. Menu: {0}",this.vO))):x.ULS.sendTraceTag(595345434,
340,50,"Color picker dialog closed without selecting any color. Menu: {0}",this.vO)};this.vO=b;this.ONe=h}H0b(b=0){const h={};h.initColor=Nl.a.VC(b);h.redLabel=Box4Intl.Box4Strings.L_FontColorRed;h.blueLabel=Box4Intl.Box4Strings.L_FontColorBlue;h.greenLabel=Box4Intl.Box4Strings.L_FontColorGreen;h.hexLabel=Box4Intl.Box4Strings.L_FontColorHex;this.pi(Box4Intl.Box4Strings.L_MenuCustomColors,this.Nul,{["id"]:"ColorPickerDialog",["bodyControls"]:h});x.ULS.sendTraceTag(595345437,340,50,"Color picker dialog is opened. Menu: {0}",
this.vO)}}Object(u.a)(Tv,"ColorPickerDialog",Ge.a,[]);class Uv{constructor(b,h,n,B,L,ba){this.GKn=b;this.Oua=h;this.bPa=n;this.Yo=B;this.iY=L;this.Tig=ba;this.y0i=!1;this.mgd=(la,La,fb)=>{if(1===fb)return 32;la=this.Sh.ja(Hf.a.kS,Nl.a.vH);(new Tv(Uv.xnb,wb.a.oxc)).H0b(la);return 32};this.kuc=(la,La,fb,Cb,Lb)=>{if(1===fb)return 32;la=this.Sh.ja(Hf.a.kS,Nl.a.vH);la=Nl.a.VC(la);this.pta(this.Tig);this.Tig.Ana=la;this.iY.Mtd(la);la=this.Tig.cPb(this.Sh,$e.App.W6a);if(!la)return 8;Lb.MenuItems=la;x.ULS.sendTraceTag(509109712,
340,50,"Page color dropdown menu is opened.");return 32};this.bjf=(la,La,fb,Cb,Lb)=>{if(1===fb)return 32;La=this.Yo.Mc(15);La.Ab(this.Sh);switch(la){case wb.a.hWd:this.Sh.hasProperty(Hf.a.kS)&&this.Sh.setValue(Hf.a.kS,Nl.a.vH);break;case wb.a.y_a:Lb=this.bPa.sra(this.Sh,Lb);this.Sh.setValue(Hf.a.kS,Lb);break;case wb.a.oxc:la=this.bPa.sra(this.Sh,Lb),this.Sh.setValue(Hf.a.kS,la),this.iY.W5a(Lb)}La.dispose();return 32}}pta(b){this.y0i||(b.PQ(2,wb.a.hWd),b.PQ(3,wb.a.y_a),b.PQ(4,wb.a.y_a),b.PQ(5,wb.a.oxc),
b.PQ(6,wb.a.mgd),b.bmb(this.GKn,1),this.y0i=!0)}Wb(){const b=A.AFrameworkApplication.va;b.ra(wb.a.mgd,oc.a.view,this.mgd);b.ra(wb.a.kuc,oc.a.view,this.kuc);b.ra(wb.a.y_a,oc.a.view,this.bjf);b.ra(wb.a.hWd,oc.a.view,this.bjf);b.ra(wb.a.oxc,oc.a.view,this.bjf);b.Rc(wb.a.kuc,1127)}get Sh(){return this.Oua.value}}Uv.xnb="Page";Object(u.a)(Uv,"PageColorActor",null,[]);var kG=d(585),Bo=d(321),Iy=d(314);class $A extends Iy.a{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb){super();this.s$b=this.ao=this.LQa=null;
this.Fgo=($b,tc)=>{tc=this.gya.rre(this.LQa,tc);$b.Ni(this.Rdm);return tc};this.Rdm=($b,tc)=>{if(this.ao.moveNext())return $b=this.ao.currentNode,12!==$b.type||$b===this.LQa.node?!0:this.gya.lid($b,tc);this.fhl();$b.Ni(this.Tdm);return!0};this.Tdm=($b,tc)=>{if(this.ao.moveNext()){const Nc=this.ao.currentNode;return 12!==Nc.type?!0:Nc===this.LQa.node?($b.Ni(this.Ggo),!0):this.gya.lid(Nc,tc)}return!1};this.Ggo=($b,tc)=>{this.gya.sre(this.LQa,tc);return!1};this.init(b);this.vm(Lb);this.ssb(La,h,B,L,
ba);this.hO=ba;this._context=n;this.hb=fb;this.Oe=Cb;this.gya=la;this.sA=0}run(){this.Kof();this.sA||this.Z_o();1===this.sA&&this.Oho();2===this.sA&&this.Qhp();3===this.sA&&this.m$l()}Kof(){this.hb.gb&&this.hb.gb.currentSelection?1===this.behavior&&(this.gya.Kof(this._context)?this.xs=32:this.xs=2,this.sA=3):(x.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.xs=2,this.sA=3)}Z_o(){this.Lgl();this.gya.CBg(this.LQa)?(this.dgl(),this.sA=1):(this.xs=8,this.sA=3)}Oho(){this.QC||new Mv.a(this,
this.Fgo,this.hO);do if(this.QC.run(),this.QC.Xfa&&!this.ni)return;while(this.QC.Xfa);this.YVd();this.sA=2}Qhp(){this.gya.WHg(this)?this.xs=32:this.xs=8;this.sA=3}m$l(){this.Iva()}Lgl(){let b=this.hb.gb.currentSelection;if(b=this.Oe.Wj(b,!0,!1))this.LQa=b.Ra;this.LQa&&this.LQa.node&&(this.s$b=this.gya.yFi(this.LQa.node))}dgl(){if(!this.s$b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Ml.a;b.set(this.LQa.node);b.zb(this.s$b.type);this.ao=It.a.Ft(b,this.s$b);this.ao.vp(Object(z.a)(this.gya,
this.gya.wyc,"spellErrorFilter"),null)}fhl(){if(!this.s$b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Ml.a;b.set(this.s$b);this.ao=It.a.Bq(b);this.ao.vp(Object(z.a)(this.gya,this.gya.wyc,"spellErrorFilter"),null)}}Object(u.a)($A,"ProofingWholeDocumentOperation",Iy.a,[]);var Jy=d(295);class BC extends Zi{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(u.a)(BC,"ContextMenuRootProperties",Zi,[]);var yv=d(1409);class JG{constructor(b){const h=new BC;
h.ImageSideArrow=A.AFrameworkApplication.Ys;h.ImageSideArrowClass=Bb.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=wb.a.Oqe.toString();this.XHh=new yv.ContextMenuRoot("ContextMenuRootName",h);b.execute(n=>{this.j9.oH=n});this.j9.refresh();A.AFrameworkApplication.va.ra(Pa.a.showContextMenu,id.a.frame,Ce.ActionManager.Zf);A.AFrameworkApplication.va.ra(Pa.a.Yxc,id.a.frame,Ce.ActionManager.Zf)}get j9(){return this.XHh}dispose(){this.j9&&
(this.j9.dispose(),this.XHh=null)}showContextMenu(b,h){this.J0b(b,h.clientPoint,h.Ag)}ueb(b,h,n){$c.a.Zje(this.j9.P5a?"ShowLegacyContextMenuAndFloatie":"ShowLegacyContextMenu","");Ua.StaticActiveAppFrame.za().Lcm();this.nv();this.j9.ueb(b,h,n);this.j9.P5a?A.AFrameworkApplication.va.Ob(Pa.a.Yxc,2):A.AFrameworkApplication.va.Ob(Pa.a.showContextMenu,2)}J0b(b,h,n){this.ueb(b,new Sys.UI.Bounds(h.x,h.y,0,0),n)}nv(){this.j9.root.wn()}Y6(){return this.j9.Y6()}Yxc(b,h,n,B){const L=this.j9;let ba=!1;n=Object(ya.a)(Rp,
n);L.P5a=n;B.BEa(b,h);L.pef?n&&(n.Tco(L,h),ba=!0):(x.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",B.rMl()),L.P5a=null);return ba}}Object(u.a)(JG,"AContextMenuController",null,[549,13]);class aB{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=aB.u_l;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=
this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}aB.u_l=[];Object(u.a)(aB,"Critique",null,[]);class KG{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(u.a)(KG,"Suggestion",null,[]);var SI=d(647);class sE extends Sys.EventArgs{constructor(b,h,n,B,L,ba){super();this.Oxk=b;this.Qzk=h;this.Rzk=n;this.TJe=B;this.pB=L;this.vgb=ba}}Object(u.a)(sE,"AugloopProofingContextMenuArgs",
Sys.EventArgs,[]);var oK=d(365);class Ju{constructor(b,h,n){this.WRe=b;this.Yn=h;this.sa=n}k8h(b){const [h,n,B]=this.jKi(b);return this.Yxi(h,n,B)}sgn(b){return Cj.a.getTypeNameFor(b.content)===oK.a.getTypeName()}Yxi(b,h,n){if(n&&this.sgn(n)){if(this.ddc(n.content))return null;const L=n.content;var B=new aB;B.ExplanationTitle=L.explanationTitle;B.Suggestions=this.rMm(n);B.CategoryTitle=L.categoryName;B.TypeId=L.typeId;B.CritiqueActions=L.critiqueActions;B.Priority=L.priority;n=this.WRe.create(B);
B=L.context;n.token=B.substring(L.range.start,L.range.start+L.range.length);n.lcid=hj.a.Cg(L.language).LCID;n.originalText=B;return new SI.a(b,h,n)}return null}rMm(b){var h=b.content.suggestions;b=[];for(const n of h)h=new KG,h.Action=n.suggestionActions,h.Text=n.text,h.Description=n.description,b.push(h);return b}ddc(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}jKi(b){const h=this.Yn.G3c(b,0),n=b.cpBegin,B=b.cpEnd,L=re.SelectionEditor.mf(b);b=ea.ParagraphReader.text(b.node,
0);for(const ba of h)if(L){if(ba.Fc<=n&&ba.end>=B)return[ba.Fc,ba.end,ba.intent]}else if(ba.Fc<=n&&ba.end>=n&&F.a.h7h(b,ba.end,B))return[ba.Fc,ba.end,ba.intent];return[null,null,null]}static qD(){return!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}MRf(b,h,n){const [B,L,ba]=this.jKi(b);ba&&this.sa.raiseEvent(Ju.EVh,new sE(b,B,L,h,ba,n))}r0k(b){this.sa.addHandler(Ju.EVh,b)}E6l(b,h,n){b=this.Yn.qkc(b,0,0,b.characterData.length);
for(let B=0;B<b.count;B++){const L=b.J(B);if(L.intent){const ba=L.intent;if(ba.content&&(0==ba.content.priority||1==ba.content.priority)&&L.Fc>=h&&(!n||n(L.intent)))return this.Yxi(L.Fc,L.end,L.intent)}}return null}}Ju.EVh="augloopProofingContextMenuActionEventKey";Object(u.a)(Ju,"AugLoopProofingErrorDetailHelper",null,[]);class Ku{}Ku.xuc="faProofing";Ku.aji="EditorMenuSection";Object(u.a)(Ku,"ContextMenuControlId",null,[]);var bB=d(574);class Ex{constructor(b){this.Oe=b}Kof(b){b=Object(ya.a)(bB.a,
b);return!!b&&!!b.view&&b.view.te}CBg(){return!0}rre(){return!0}lid(){return!0}sre(){}WHg(){return!0}wyc(b){if(b.Es)return!0;b=b.role;return 1===b||2===b||3===b||4===b||5===b}yFi(b){if(!b||!this.Oe)return b;const h=new Ml.a;h.set(b);if(this.Oe.rv(h)){for(;!h.Es;)h.uc();return h.currentNode}return b}}Object(u.a)(Ex,"SimpleProofingWholeDocumentCallBacks",null,[539]);class LG{constructor(b){this.value=b}}Object(u.a)(LG,"RefBool",null,[]);class Kz{constructor(){this.R_c=this.WVb=null;this.b5j=new LG(!1)}}
Object(u.a)(Kz,"FindNextErrorOperationParam",null,[]);class MG extends Ex{constructor(b,h,n,B){super(h);this.so=b;this.NPc=n;this.Bok=B}rre(b,h){return!this.Y5f(b.node,b.cpBegin,h)}lid(b,h){return!this.Y5f(b,0,h)}sre(b,h){this.Y5f(b.node,0,h);Object(ya.a)(Kz,h)}Y5f(b,h,n){n=Object(ya.a)(Kz,n);if(ea.ParagraphReader.Xb(b)&&!b.NL)if(Va.FormattingReader.Cs(Nd.a.Tc(b,h)).cache.kTb)n.b5j.value=!0;else{if(Ju.qD())return h=this.Bok.E6l(b,h,this.NPc),null!=h?(n.WVb=h,n.R_c=b,!0):!1;const B=this.so.u7(b);for(let L=
0;L<B.length;L++){const ba=B[L];if(ba.Fc>=h&&!ba.errorDetails.jab()&&(!this.NPc||this.NPc(ba.errorDetails)))return n.WVb=ba,n.R_c=b,!0}return!1}}}Object(u.a)(MG,"FindNextErrorCallbackSteps",Ex,[]);class si{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd,Hd){this.hul=(xe,je,he,fe,De)=>{je=this.hb.gb.currentSelection;if(!je)return this.vd.$b(Tf.a.Te,{["Reason"]:hf.a.oo}),2;je=this.Oe.Wj(je,!0,!1);return this.ga.lg(je.Ra,xe,he,!1,fe,De)};this.u5n=(xe,je,he)=>{if(1===he)return this.ga.Ob(wb.a.N8,
1);this.TCk().KDg();return 32};this.JJa=(xe,je,he)=>{if(1===he)return 32;ce.a.mark(4670);he=this.so.Isa(je);if(this.gEe(he))return 8;je=je.node;const fe=this.Pc.Mc(15);let De=he.Fc;" "===ea.ParagraphReader.text(je).charAt(De-1)&&De--;fe.Ab(je);const gg=this.Qd.Ne(Nd.a.createTextRange(je,0<he.Fc?he.Fc-1:0,he.end),"",!0,!1);this.hb.Ic(Oe.SelectionFactory.se(je,gg+De));fe.dispose();he.errorDetails.Vzb(xe);ce.a.mark(4671);return 32};this.WBa=(xe,je,he)=>{if(1===he)return 32;x.ULS.sendTraceTag(7660830,
324,50,"Ignore spelling error triggerred");if(Ju.qD())return this.Mgb.MRf(je,null,Bo.b.IgnoreOnce),32;ce.a.mark(4670);he=this.so.Isa(je);if(this.gEe(he))return 8;je=je.node;const fe=this.Pc.Mc(15);fe.Ab(je);this.so.ixb(je,[he],!0);je.setValue(Hf.a.Orf,!0);fe.dispose();he.errorDetails.Vzb(xe);ce.a.mark(4671);x.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.ZEn(he);this.v4a.oQi(he,je,!0);return 32};this.CCl=(xe,je,he)=>{var fe,De=!this.ul.Bba(je);this.Xn&&this.Xn.instance&&
this.Xn.instance.DX(je)&&(De=!1);if(1===he||!De)return De?32:8;this.ga.Ob(wb.a.dwa,2);ce.a.mark(4670);De=this.Inm(xe);if(0>De)return 8;if(Ju.qD())return this.Mgb.MRf(je,De,Bo.b.Apply),32;he=this.so.Isa(je);if(this.gEe(he))return 8;je=je.node;var gg=he.errorDetails.suggestions;if(!gg)return this.vd.$b(Tf.a.oOb,{["Reason"]:"NoSuggestionsFound"}),ce.a.mark(4671),8;De=De<gg.length?gg[De]:null;if(!De)return this.vd.$b(Tf.a.oOb,{["Reason"]:"RequestedSuggestionIsNull"}),ce.a.mark(4671),8;(null===(fe=we.StaticTheCoauthManager.ud())||
void 0===fe?0:fe.Jo)&&we.StaticTheCoauthManager.ud().Ak.yG(je);De=De.replace("  "," \u00a0");fe=this.Pc.Mc(15);fe.Ab(je);gg=this.Qd.Ne(Nd.a.createTextRange(je,he.Fc,he.end),De,!0,!1,wb.a.dwa);this.hb.Ic(Oe.SelectionFactory.se(je,he.Fc+De.length+gg));fe.dispose();he.errorDetails.Vzb(xe);ce.a.mark(4671);this.yBn(he);return 32};this.VNo=(xe,je)=>{je=this.so.Isa(je);if(this.gEe(je))return 8;je.errorDetails.Vzb(xe);return 32};this.p9l=(xe,je,he,fe,De)=>{if(!je.view.te)return 2;const gg=je.view;if(!this.hb.gb.currentSelection)return this.vd.$b(Tf.a.Te,
{["Reason"]:hf.a.oo}),2;if(1===he)return 32;const eg=new Kz,vl=new MG(this.so,this.Oe,this.NPc,this.Mgb);je=new $A(null,xe,je,he,fe,eg,vl,this.ga,this.hb,this.Oe,null);je.ni=!0;je.run();if(je.isCompleted&&eg.WVb){if(je=Oe.SelectionFactory.se(eg.R_c,eg.WVb.Fc),je=Oe.SelectionFactory.$y(je,Nd.a.Tc(eg.R_c,eg.WVb.end)),!this.QAh.instance||!this.QAh.instance.afo(eg.WVb,je,gg)){this.hb.Ic(je);let wl=0;De&&(wl=De.iz);gg.sze=!1;ph.a.instance.Zb(new Re.a(1,1,1,()=>{this.YLo(gg,wl,eg.R_c,eg.WVb)}))}}else{const wl=
new ui.StandardDialog;wl.Gd=0;$e.App.eQ.aad?wl.Nna(CommonUIStrings.l_DefaultDialogTitle,eg.b5j.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(wl.Nna(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),$e.App.eQ.uRd(()=>{wl.ema&&(wl.hide(),this.ga.Ob(xe,2))}))}return 32};this.Oqe=(xe,je,he)=>{if(1===he)return 32;this.qia&&this.qia.j9&&(xe=this.qia.j9.NPf(Ku.xuc))&&!xe.EN&&(xe.L3(0),xe.Ig.iN(0));
return 32};this.ga=h;this.so=b;this.TCk=n;this.Qd=B;this.Pc=L;this.hb=ba;this.Xn=la;this.Oe=La;this.sMk=fb;this.ul=Cb;this.vd=Lb;this.Mgb=Hd;this.qia=Object(ya.a)(JG,$b);this.k8b=tc.C$c;this.QAh=Nc;this.v4a=dd;this.UCc=new Map;this.UCc.set(1,wb.a.YEg);this.UCc.set(2,wb.a.rQf);this.UCc.set(3,wb.a.cGg);this.wOc=new Map;this.wOc.set(1,wb.a.ZEg);this.wOc.set(2,wb.a.sQf);this.wOc.set(3,wb.a.dGg)}Wb(){const b=this.ga,h=this.CCl,n=this.hul;b.fb(wb.a.Uoe,oc.a.view,this.u5n,1028);b.ra(wb.a.JJa,oc.a.Xc,this.JJa);
b.ra(wb.a.WBa,oc.a.Xc,this.WBa);b.ra(wb.a.Dzb,oc.a.Xc,h);b.ra(wb.a.Ezb,oc.a.Xc,h);b.ra(wb.a.Fzb,oc.a.Xc,h);b.ra(wb.a.v1b,oc.a.Xc,h);b.ra(wb.a.w1b,oc.a.Xc,h);b.ra(wb.a.JJa,oc.a.view,n);b.ra(wb.a.WBa,oc.a.view,n);b.ra(wb.a.Dzb,oc.a.view,n);b.ra(wb.a.Ezb,oc.a.view,n);b.ra(wb.a.Fzb,oc.a.view,n);b.ra(wb.a.v1b,oc.a.view,n);b.ra(wb.a.w1b,oc.a.view,n);b.Rc(wb.a.JJa,1028);b.Rc(wb.a.WBa,1028);b.Rc(wb.a.Dzb,1028);b.Rc(wb.a.Ezb,1028);b.Rc(wb.a.Fzb,1028);b.Rc(wb.a.v1b,1028);b.Rc(wb.a.w1b,1028);b.ra(wb.a.dwa,id.a.frame,
Ce.ActionManager.Zf);this.k8b&&b.fb(wb.a.Oqe,oc.a.view,this.Oqe,1124);b.fb(wb.a.led,oc.a.view,this.p9l,1028);b.fb(wb.a.Ung,oc.a.Bd,this.VNo,1124);this.Euo([wb.a.QAe,wb.a.YEg,wb.a.ZEg,wb.a.C$d,wb.a.rQf,wb.a.sQf,wb.a.uBe,wb.a.cGg,wb.a.dGg,wb.a.ywj,wb.a.dPn,wb.a.KWj])}Euo(b){for(let h=0;h<b.length;h++)this.ga.fb(b[h],oc.a.view,Ce.ActionManager.gU,1028)}Tvo(b){this.NPc=b}gEe(b){return b?b.errorDetails?!1:(x.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.vd.$b(Tf.a.oOb,
{["Reason"]:"ErrorRangeMissingErrorDetails"}),ce.a.mark(4671),!0):(x.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.vd.$b(Tf.a.oOb,{["Reason"]:"RequestedErrorRangeNotFound"}),ce.a.mark(4671),!0)}ZEn(b){b=b.errorDetails.proofingType;if(this.wOc.has(b)){const h=this.wOc.get(b);this.ga.Ob(h,2);x.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}Inm(b){switch(b){case wb.a.Dzb:return 0;case wb.a.Ezb:return 1;case wb.a.Fzb:return 2;
case wb.a.v1b:return 3;case wb.a.w1b:return 4;default:return-1}}yBn(b){b=b.errorDetails.proofingType;if(this.UCc.has(b)){const h=this.UCc.get(b);this.ga.Ob(h,2);x.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}YLo(b,h,n,B){b.V0();(b=n.ue(b.oc))?(B=Jy.a.Jr(b,A.AFrameworkApplication.isRtl?B.Fc:B.end),this.sMk.BEa(new Sys.UI.Point(B.x,B.y+B.height),h)):x.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(u.a)(si,"ProofingActor",
null,[]);var Fx=d(333),no=d(1636),NG=d(1967);class cB{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb){this.Syc=null;this.Ram="StyleUsageActivity";this.Sam="StylesFloodgateSurveyIsEnabled";this.XTa=($b,tc,Nc,dd)=>{$b=this.WLm($b);return 0>$b||$b>this.Syc.length?2:($b=this.Syc[$b])?A.AFrameworkApplication.va.lg(tc,wb.a.HT,Nc,!0,dd,$b):2};this.LXb=($b,tc,Nc,dd,Hd)=>{$b=!0;tc.contextId!==oc.a.paragraph&&tc.contextId!==oc.a.Bd&&tc.contextId!==oc.a.Xc&&($b=!1);if(1===Nc||!$b)return $b?32:8;if(2===Nc&&!Hd)return 8;
tc=this.Vb.EF(tc.node);Hd.MenuItems=Fx.a.uAm(tc);return 32};this.Wko=($b,tc,Nc,dd,Hd)=>{$b=!0;tc.contextId!==oc.a.paragraph&&($b=!1);if(1===Nc&&!$b)return 8;tc=tc.node;Nc=this.Vb.Eq(tc);if(!Nc||!Hd)return x.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",Hd,tc,Nc),8;Hd.$_a.Bv(Nc.Qj());return 32};this.S8k=($b,tc,Nc,dd,Hd)=>{if(tc.contextId!==oc.a.paragraph)return 8;if(this.mg.xab(tc,!1))return this.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.HG}),8;if(1===Nc)return 32;const xe=
tc.node;if(ea.ParagraphReader.Wza(xe)||!Hd)return 8;const je=this.xOf(Hd,xe);if(!je)return this.Ec.$b(Tf.a.U4,{["Reason"]:hf.a.pOb}),8;if(2!==this.Vb.FF(je))return 2;Nc=new Sd.GraphTransaction(15);this.cD.iyc(Hd);Nc.Ab(xe);this.rk.txb();const he=[];$b!=wb.a.hE&&he.push(ye.a.X0a);this.e9.VN(je,xe,!1,void 0,void 0,void 0,new NG.a(he,!1,!0));($b=this.Vb.EF(xe))&&this.Vb.ke(je,$b)&&Vc.b(593078098,3017,50,"Custom linked style applied by user");xe.Gs&&($b=[Object.assign(new ia.a,{name:"Source",string:"ApplyStyle"})],
Pe.a("TOCFormatting",!0,void 0,$b));Nc.dispose();Hd=F.a.MT(Hd);dd.Gt=Hd>>>16^Hd&65535;dd&&no.a.Gzb&&(dd.lE|=no.a.Eqb(tc.node));return 32};this.Xko=($b,tc,Nc,dd,Hd)=>{$b=!0;tc.contextId!==oc.a.Bd&&($b=!1);if(1===Nc&&!$b)return 2;tc=Va.FormattingReader.Cs(tc);tc=Va.FormattingReader.DBa(tc);if(!tc)return 2;if(!Hd)return 8;Hd.$_a.Bv(tc.Qj());return 32};this.T8k=($b,tc,Nc,dd,Hd)=>{if(tc.contextId!==oc.a.Bd)return 8;this.mg.xab(tc);if(1===Nc)return 32;$b=tc;(tc=this.Bp.M8d($b))&&($b=tc);tc=$b.node;if(!Hd)return 8;
const xe=this.xOf(Hd,$b.node);if(!xe)return this.Ec.$b(Tf.a.U4,{["Reason"]:hf.a.pOb}),8;if(1!==this.Vb.FF(xe))return 2;Nc=this.Vb.EF(tc);if(!Nc)return this.Ec.$b(Tf.a.U4,{["Reason"]:hf.a.fni}),8;if(!Nc.gh(this.Vb.Ae(xe)))return this.Ec.$b(Tf.a.U4,{["Reason"]:hf.a.pOb}),8;const je=new Sd.GraphTransaction(7);try{if(this.cD.iyc(Hd),je.Ab(tc),this.e9.XMg(tc,Nc),this.h9.e_($b,he=>{this.km.Zja(he);this.km.oeb(he,xe)}),tc.Gs){const he=[Object.assign(new ia.a,{name:"Source",string:"ApplyStyle"})];Pe.a("TOCFormatting",
!0,void 0,he)}}finally{je&&je.dispose()}Nc&&this.Vb.ke(xe,Nc)&&Vc.b(593078097,3017,50,"Custom linked style applied by user");Hd=F.a.MT(Hd);dd.Gt=Hd>>>16^Hd&65535;dd&&no.a.Gzb&&(dd.lE|=no.a.Eqb($b.node));return 32};this.Vko=($b,tc,Nc,dd,Hd)=>{$b=!0;tc.contextId!==oc.a.Xc&&($b=!1);if(1===Nc&&!$b)return 2;tc=this.e9.bMm(tc);if(!tc)return 2;if(!Hd)return 8;Hd.$_a.Bv(tc.Qj());return 32};this.R8k=($b,tc,Nc,dd,Hd)=>{if(tc.contextId!==oc.a.Xc)return 8;if(this.mg.xab(tc,!1))return this.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.HG}),
8;if(1===Nc)return 32;var xe=tc.node;if(!Hd)return 8;Nc=this.xOf(Hd,tc.node);if(!Nc)return this.Ec.$b(Tf.a.U4,{["Reason"]:hf.a.pOb}),8;const je=this.Vb.FF(Nc);if(1!==je&&2!==je)return 2;(tc=this.rk.$Nf(tc))?(tc=Zb.a.CMb(tc),$b=A.AFrameworkApplication.va.lg(tc,$b,2,!1,dd,Hd)):($b=new Sd.GraphTransaction(7),this.cD.iyc(Hd),$b.Ab(xe),this.e9.FYo(Nc,xe),$b.dispose(),$b=32);xe.Gs&&(tc=[Object.assign(new ia.a,{name:"Source",string:"ApplyStyle"})],Pe.a("TOCFormatting",!0,void 0,tc));(xe=this.Vb.EF(xe))&&
this.Vb.ke(Nc,xe)&&Vc.b(593078096,3017,50,"Custom linked style applied by user");Hd=F.a.MT(Hd);dd.Gt=Hd>>>16^Hd&65535;return $b};this.Yko=($b,tc,Nc,dd,Hd)=>{const xe=this.xud.Tua($b,tc,Nc,dd,Hd,null,0);return 2!==xe?xe:this.xud.Tua($b,tc,Nc,dd,Hd,null,12)};this.U8k=($b,tc,Nc,dd,Hd)=>{const xe={};xe[this.xud.RPa]=6168;xe[this.xud.QPa]=6169;let je=12;if(!tc.view.te)return 2;var he=tc.view.lb,fe=he?he.Og:null;if(!fe)return this.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.oo}),8;if(this.Jw.lJa(Ad.ImageReader.M$a,
fe))return this.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.HWc}),8;if(this.Jw.pFa(ea.ParagraphReader.BX,fe))return this.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.WQ}),8;if(this.mg.Tnc(fe,!1))return this.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.HG}),8;fe=this.Vb.ko();if(Hd&&fe){const De=fe.gh(Hd);if(De){const gg=this.Vb.Sqb(De,fe);let eg=this.Vb.FF(De);gg&&(he=he.gb.J(0),he.ly&&he.Ra.contextId===oc.a.Bd||2===he.length&&he.Ra.contextId===oc.a.Bd&&he.Uc.contextId===oc.a.Vc)&&(eg=1,Hd=gg.getValue(lk.a.la));1===eg?je=0:3===eg&&(je=14);
!this.Vb.ke(De,fe)&&this.Vb.Hd(De)&&(he=this.Vb.Ae(De),Vc.b(562317522,3017,50,String.format("{0}: style applied by user",he)));this.Wha(this.Ram,this.Sam)}}return this.xud.Tua($b,tc,Nc,dd,Hd,xe,je)};this.Zv=h;this.Ge=n;this.sQ=B;this.uB=L;this.ul=ba;this.vd=la;this.OZ=La;this.zSk=fb;this.xe=Cb;this.Bp=Lb}get e9(){return this.Zv}get Jw(){return this.sQ}get rk(){return this.uB}get km(){return this.Ge}get mg(){return this.ul}get Ec(){return this.vd}get h9(){return this.OZ}get xud(){return this.zSk}get Vb(){return this.xe}Wb(){const b=
A.AFrameworkApplication.va,h=$e.App.n0a.b$h(12);b.ra(wb.a.HT,oc.a.Bd,this.T8k);b.ra(wb.a.CNa,oc.a.Bd,this.Xko);b.ra(wb.a.HT,oc.a.Xc,this.R8k);b.ra(wb.a.CNa,oc.a.Xc,this.Vko);b.ra(wb.a.HT,oc.a.paragraph,this.S8k);b.ra(wb.a.HT,oc.a.view,this.U8k);b.Rc(wb.a.HT,1036);b.ra(wb.a.CNa,oc.a.view,this.Yko);b.ra(wb.a.CNa,oc.a.paragraph,this.Wko);b.Rc(wb.a.CNa,99);b.ra(wb.a.LXb,oc.a.view,h);b.ra(wb.a.LXb,oc.a.paragraph,this.LXb);b.Rc(wb.a.LXb,1127);b.fb(wb.a.fjf,oc.a.view,this.XTa,4);b.fb(wb.a.gjf,oc.a.view,
this.XTa,4);b.fb(wb.a.hjf,oc.a.view,this.XTa,4);b.fb(wb.a.ijf,oc.a.view,this.XTa,4);b.fb(wb.a.jjf,oc.a.view,this.XTa,4);b.fb(wb.a.kjf,oc.a.view,this.XTa,4);b.fb(wb.a.ljf,oc.a.view,this.XTa,4);b.fb(wb.a.UTh,oc.a.view,this.XTa,4);b.fb(wb.a.VTh,oc.a.view,this.XTa,4);b.fb(wb.a.WTh,oc.a.view,this.XTa,4);this.Syc=Array(10);this.Vb.DYo(this.Syc)}WLm(b){switch(b){case wb.a.fjf:return 0;case wb.a.gjf:return 1;case wb.a.hjf:return 2;case wb.a.ijf:return 3;case wb.a.jjf:return 4;case wb.a.kjf:return 5;case wb.a.ljf:return 6;
case wb.a.UTh:return 7;case wb.a.VTh:return 8;case wb.a.WTh:return 9;default:return-1}}Wha(b,h){A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const n=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");n&&n.execute(B=>{B.logActivity(b,h)})},cB.GJa)}xOf(b,h){if(b&&h&&ea.ParagraphReader.Xb(h))h=this.Vb.EF(h);else return null;return h.gh(b)}get cD(){return null!=this.EXg?this.EXg:this.EXg=Ya.a.instance.resolve("Box4.IFontStylesGalleryCache")}}cB.GJa=5E3;Object(u.a)(cB,
"StyleActor",null,[]);var yq=d(137);class hu{constructor(b,h,n){this.MRk=b;this.xe=h;this.t5a=n}Wb(){this.t5a.fb(wb.a.Qqe,oc.a.application,this.Qqe.bind(this),96);this.t5a.ra(wb.a.fBc,oc.a.view,this.Rzp.bind(this));this.t5a.fb(wb.a.Bxj,oc.a.view,this.Tzp.bind(this),96)}Qqe(b,h,n,B,L){if(1===n)return 32;b=Object.assign(new vh.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];n=Object.assign(new te.a,{ControlList:[]});n.ControlList.push(Object.assign(new jj.a,{ExternalId:"UpdateStyle",
QueryCommand:"QueryUpdateStyle"}));h.push(n);Array.addRange(b.MenuSectionList,h);L.MenuItems=b;return 32}Tzp(b,h,n,B,L){if(1===n)return 32;b=ok.a.TYj();null==b&&8;b=this.xe.aK(b);L[Dl.a.LabelText]=String.format(F.a.Hf(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}Rzp(b,h,n){b=ok.a.ETb(h);if(1===n||b)return b?8:32;n=new Map;n.set("Source","StyleContextMenuActor");n.set("Action","UpdateStyle");oa.Health.instance.recordKpiUsage(yq.a.vFa,0,yq.a.bD,n);this.MRk.YMg(h)?Vc.b(539842578,3018,50,"User Successfully Updated styles from UI"):
(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new rb.a,{extendedProperties:h}),oa.Health.instance.recordKpiFailure(yq.a.vFa,"UpdateStyleFailed",!1,!0,h),Vc.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(u.a)(hu,"StyleContextMenuActor",null,[]);var TI=d(2094);class OG{constructor(b){this.ga=b}get Sb(){return this.ga}Jxe(b,h=!1){this.Sb.lg(b,wb.a.jXa,2,!0,null,h)}N8(b){this.Sb.Pb(wb.a.N8,
2,b)}}Object(u.a)(OG,"TextFormattingCommands",null,[518]);class zq{constructor(b,h,n,B){this.wbf=this.HIh=!1;this.Plp=(L,ba,la)=>{if(2!==la)return 2;this.HIh||(this.HIh=!0);return 32};this.Ugo=(L,ba,la,La,fb)=>{if(2!==la)return 2;this.Xvj(fb,!0);return 32};this.Tgo=(L,ba,la,La,fb)=>{if(2!==la)return 2;this.Xvj(fb,!1);return 32};this.Pho=(L,ba,la)=>{if(2!==la)return 2;if(!this.Gib)return 8;this.Gib.e0m();return 32};this.Ngo=(L,ba,la)=>{if(2!==la)return 2;if(!this.Gib)return 8;this.Gib.$Go();return 32};
this.Jua=(L,ba)=>{3===ba.iz&&re.SelectionEditor.Dm(ba.Gm.currentSelection)&&(Pe.c(wb.a.Klp),this.wbf=!0)};this.ga=b;this.Ga=h;this.Gib=n;this.hb=B}get Olp(){return this.wbf}Wb(){var b;this.ga.fb(Pa.a.ES,oc.a.view,this.Plp,4);this.ga&&this.Ga&&(this.Ga.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.fb(wb.a.NJg,oc.a.view,this.Ugo,4),this.ga.fb(wb.a.PJg,oc.a.view,this.Tgo,4)),this.ga.fb(Pa.a.KXj,oc.a.application,this.Pho,4),this.ga.fb(Pa.a.WAf,oc.a.application,this.Ngo,4),Uq.EventHandlerManager.instance.$uo(()=>
{this.L3n()}));(null===(b=Ua.StaticActiveAppFrame.za().ib.sc)||void 0===b?0:b.te)&&Ua.StaticActiveAppFrame.za().ib.sc.A6(()=>{this.bMo()});this.hb&&this.hb.Cw(this.Jua)}fno(){Pe.c(wb.a.Nlp);this.wbf=!0}bMo(){const b=window.performance.now();zq.B_e&&250>b-zq.B_e&&1E3<b-zq.Fsh&&(Pe.c(wb.a.Mlp),zq.Fsh=b);this.Gib&&zq.rc&&zq.rc.vE(111)&&this.Gib.showFloatie()}Tcn(b,h){if(h){var n=null;X.a.nM&&b&&(n=b.getSelection());b=null;n&&"Caret"===n.type&&(b=n.getRangeAt(0))&&this.Gib&&this.Gib.wwp(b.getBoundingClientRect(),
h)}}L3n(){zq.B_e=window.performance.now()}Xvj(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(zq.s3m)){for(b=b.firstChild;b;)this.j3k(b,h),b=b.nextSibling;break}b=b.nextSibling}}j3k(b,h){if(b.classList.contains(zq.DQi)){const n="WACImageResizeHandleTouch"+this.oum(b);h?b.classList.add(zq.EQi,n):b.classList.remove(zq.EQi,n)}}oum(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==zq.DQi)return F.a.substring(h,20,h.length);return""}static get rc(){return null!=
zq.AWg?zq.AWg:zq.AWg=Ya.a.instance.Oa("Box4.IFeatureHelper")}}zq.DQi="WACImageResizeHandles";zq.EQi="WACImageResizeHandlesTouch";zq.s3m="WACImgSelection";zq.B_e=0;zq.Fsh=0;Object(u.a)(zq,"TouchInputActor",null,[517]);class Gx{get RPa(){return Ks.a.RPa}get QPa(){return Ks.a.QPa}get BBc(){return Ks.a.BBc}Tua(b,h,n,B,L,ba,la){return Ks.a.Tua(b,h,n,B,L,ba,la)}Stc(b,h,n,B,L,ba){return Ks.a.Stc(b,h,n,B,L,ba)}static get instance(){Gx._instance||(Gx._instance=new Gx);return Gx._instance}}Gx._instance=null;
Object(u.a)(Gx,"ViewActionHandlerProxy",null,[516]);class UI{constructor(b,h,n){this.obo=n;this.kpiName="VisiMarkersUsage";this.Saa="wwaengidc";this.aub=new Map;this.G8o=(B,L,ba,la,La)=>{var fb;if(1===ba)return 32;if(!La)return 2;this.aub.set("Source",sc.a[this.ga.y3]);this.Zcf.Iad?this.aub.set("Action","Removed"):this.aub.set("Action","Applied");oa.Health.instance.recordKpiUsage(this.kpiName,1,this.Saa,this.aub);B=document.getElementsByTagName("head")[0];if(!this.Zcf.blp(B))return x.ULS.sendTraceTag(593294045,
324,15,"Toggling Formatting markers failed"),8;A.AFrameworkApplication.Ld("PlaceholderTextBugFix;PlaceholderTextBugFixCf");(null===(fb=A.AFrameworkApplication.K)||void 0===fb?0:fb.getBooleanFeatureGate("Microsoft.Office.WordOnline.PlaceholderTextBugFixIsEnabled",!1))&&this.obo.rzo();Ua.StaticActiveAppFrame.za().hJ({ShowVisiMarkers:"ToggleButtonModel"});return 32};this.nko=(B,L,ba,la,La)=>{if(1===ba)return 32;La[$g.a.On]=this.Zcf.Iad;return 32};this.ga=b;this.Zcf=h}Wb(){this.ga.fb(wb.a.nAe,oc.a.application,
this.G8o,1);this.ga.fb(wb.a.txj,oc.a.application,this.nko,96)}}Object(u.a)(UI,"VisiMarkersActor",null,[]);class PG{wc(b){b.ia("Box4.Actors.Box4PasteStewardFactory",()=>new lo(Hv.a.oQb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").ha();b.ia("Box4.Actors.Box4PasteStewardUtils",()=>new Lv(A.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").ha();
b.ia("Box4.Actors.ClipboardActor",()=>new NI.ClipboardActor(b.rf("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),Yc.a.instance,b.resolve("Box4.IClipboardDataHelper"),Zb.a.instance,A.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),A.AFrameworkApplication.K,Ph.FocusManager.instance(),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),
A.AFrameworkApplication.dDg(),A.AFrameworkApplication.MTj(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Ya.a.instance.resolve("Common.IReactContextualUILauncher"),!!$e.App.instance&&$e.App.instance.ama,b.resolve("Common.IExternalUICommandDefinitionMapping"))).ha();b.ia("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new yy(A.AFrameworkApplication.K)).ha();b.ia("Box4.Clipboard.ISystemClipboardAccessManagerFactory",()=>new Gy(A.AFrameworkApplication.K,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),
b.resolve("Box4.IClipboardDataHelper"),wx.a.instance)).ha();b.ia("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).ha();b.ia("Box4.Actors.ISystemClipboard",()=>new Jz(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),Object(Pb.a)(),Ua.StaticActiveAppFrame.za().ib,Ph.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),wx.a.instance,A.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IDeleteTableSegmentStrategy",
()=>new AC).ha();b.ia("Box4.ISelectionFactory",()=>new rC.a).ha();b.ia("Box4.IRenderOrderGraphIteratorFactory",()=>new qC).ha();b.ia("Common.IDomElementContentStateFactory",()=>new xx).ha();b.ia("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new BG(Zb.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"))).ha();b.ia("Box4.Actors.PastedContentsPostProcessorHelper",()=>new yC).ha();b.ia("Box4.Actors.PasteFloatiePositionProvider",()=>new Rv(Zb.a.instance,
b.resolve("Box4.ITextMetricsAdapter"),Object(Pb.a)(),$c.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!$e.App.instance&&$e.App.instance.ama)).ha();b.ia("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new Ey(b.resolve("Box4.IClipboardDataHelper"),$e.App.Ew.kL)).ha();b.ia("Box4.Actors.PasteFloatieEventManager",()=>new zs(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),Object(Pb.a)(),ik.a.instance(),A.AFrameworkApplication.ua,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),
b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),$e.App.jf.Il.Ve(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),!!$e.App.instance&&$e.App.instance.ama)).ha();b.ia("Box4.Actors.IClipboardOperationPasteFactory",()=>new Gw(Yc.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.PasteCoordinator"),bE.a.instance,Zb.a.instance,A.AFrameworkApplication.va,
b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.rf("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).ha();b.ia("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new RA(A.AFrameworkApplication.va,Yc.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.IOutlineElementEditor"),Zb.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),
b.resolve("Box4.IParagraphReader"),Ay.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Oa("Box4.IFeatureHelper"))).ha();b.ia("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new yG(Yc.a.instance,wx.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),
b.resolve("Common.ISimpleOperationFactory"),A.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).ha();b.ia("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new Zn(A.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IClipboardOperationFactory",()=>new Bx(b.resolve("Box4.Actors.InternalClipboard"),A.AFrameworkApplication.va,A.AFrameworkApplication.$Cg(),Yc.a.instance,Ay.a.instance,wx.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),
b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();
Em.a.Gta&&b.ia("Box4.Actors.IHiddenExternalPasteView",()=>new eu(Em.a.gWi?b.Qa("Common.ISystemInitiatedFeedback"):null)).ha();b.ia("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new dv(b.rf("Box4.Actors.IBox4PasteStewardFactory"),b.rf("Box4.Actors.IBox4ImageStewardFactory"),b.rf("Box4.Actors.IBox4TableStewardFactory"),b.rf("Box4.Actors.IBox4WordConverterFactory"),b.rf("HtmlImport.IHtmlTranslatorSettings"),b.Oa("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),
b.resolve("Box4.Actors.IExternalPasteCssConverter"),b.resolve("HtmlImport.IHtmlNormalizerSettings"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"),b.resolve("Box4.IFieldCopyPasteHelper"),Em.a.Gta?b.rf("Box4.Actors.IHiddenExternalPasteView"):null)).ha();b.ia("Box4.Actors.InternalClipboard",()=>new ev.a(b.resolve("Box4.Images.IImageEditor"),b.rf("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),
$e.App.jf,b.resolve("Box4.IParagraphIndentationReader"),A.AFrameworkApplication.K,b.resolve("Box4.Graph.IGraphNodeFactory"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.Oa("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").$Lj,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).ha();b.ia("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new IG(b.resolve("Box4.Actors.InternalClipboard"),
b.Oa("Box4.IContentControlCopyPasteHelper"),new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.sc),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.IFieldCopyPasteHelper"))).ha();b.ia("Box4.List.IListCommands",()=>new Jt(A.AFrameworkApplication.va)).ha();b.ia("Box4.List.ListNewLineStrategy",()=>new aE(b.resolve("Box4.List.IListEditor"),b.rf("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.resolve("Box4.ICharacterPropertiesEditor"))).ha();b.ia("Box4.Actors.PasteCoordinator",()=>new Qv(b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),Pd.a.instance)).ha();b.ia("Box4.Actors.Box4ImageStewardFactory",()=>new Cz(b.resolve("Box4.Images.IImageEditor"),A.AFrameworkApplication.mc,b.resolve("Box4.IUndoManager"),b.Oa("Box4.Actors.IImageStewardBridge"),Ua.StaticActiveAppFrame.za().nK,
b.Oa("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").ha();b.ia("Box4.Actors.Box4TableStewardFactory",()=>new wz(Ya.a.instance.resolve("Box4.List.IListEditor"),Ya.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").ha();
b.ia("Box4.Actors.ClipboardOperationWordStrategy",()=>new ls(Yc.a.instance,Zb.a.instance,we.StaticTheCoauthManager.ud(),Pd.a.instance)).ha();b.ia("Box4.Actors.Box4WordConverterFactory",()=>new QA(A.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").ha();b.ia("Box4.Actors.IExternalPasteCssConverter",()=>new TA(A.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IHtmlNormalizerHelper",()=>new HG).ha();b.ia("Box4.ISelectionCommands",()=>new Dw(A.AFrameworkApplication.va)).ha();b.ia("Box4.ITextFormattingCommands",
()=>new OG(A.AFrameworkApplication.va)).ha();b.ia("Box4.Actors.AccessibilityActor",()=>new Kv(b.Qa("Box4.Accessibility.IAccessibilityContextManager"),b.resolve("Box4.Proofing.IErrorRangeEditor"))).ha();b.ia("Box4.Actors.InsertionPointFormatting",()=>new mC(b.Oa("Box4.IFontSlotProvider"),b.Qa("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").ha();b.ia("Box4.UI.PasteFloatieManager",()=>new av).as("Box4.UI.IFloatieManager").ha();b.ia("Box4.Actors.ProofingActor",()=>new si(Ya.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),
A.AFrameworkApplication.va,()=>Ya.a.instance.resolve("Box4.UI.ILanguageDialog"),Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Zb.a.instance,Ya.a.instance.Qa("Box4.IExternalSelectionManager"),Ay.a.instance,Ya.a.instance.resolve("Box4.ISelectionContextMenuProvider"),Pd.a.instance,Yc.a.instance,Ya.a.instance.resolve("Box4.IContextMenuController"),Ya.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Ya.a.instance.Qa("Box4.Actors.IProofingErrorPresenter"),
Ya.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),Ya.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();b.ia("Box4.Actors.StyleActor",()=>new cB(Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ya.a.instance.resolve("Box4.IFormattingEditor"),Object(el.a)(),Ya.a.instance.resolve("Box4.IInsertionPointFormatting"),Pd.a.instance,Yc.a.instance,Ya.a.instance.resolve("Box4.TextFormattingHelper"),Gx.instance,
Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ya.a.instance.resolve("Box4.IContentControlChpHelper"))).ha();b.ia("Box4.Actors.StyleContextMenuActor",()=>new hu(Ya.a.instance.resolve("Box4.IUpdateStyleManager"),Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),A.AFrameworkApplication.va)).ha();b.ia("Box4.Actors.TextFormattingActor",()=>new TI.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Oa("Box4.IFontSlotProvider"),b.Oa("Box4.IContentControlChpHelper"),
Ya.a.instance.resolve("Box4.IFormattingEditor"),Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.resolve("Box4.IParagraphEditor"),Ya.a.instance.resolve("Box4.ILineSpacingHelper"),Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ya.a.instance.resolve("Box4.IOutlineElementEditor"),Ya.a.instance.resolve("Box4.List.IListFormattingEditor"),Ya.a.instance.resolve("Box4.IParagraphIndentationReader"))).ha();b.ia("Box4.Actors.AutoCorrectActor",
()=>new Az(A.AFrameworkApplication.va,Yc.a.instance,()=>Ya.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).ha();b.ia("Box4.Actors.TouchInputActor",()=>new zq(A.AFrameworkApplication.va,A.AFrameworkApplication.K,yz.GrippersManager.instance,Zb.a.instance)).as("Box4.ITouchInputActor").ha();b.register(zz,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").ha();b.ia("Box4.Actors.VisiMarkersActor",()=>new UI(A.AFrameworkApplication.va,b.resolve("Box4.IVisiMarkersOperation"),b.resolve("Box4.PlaceholderText.PlaceholderTextProvider"))).ha();
b.ia("Box4.Actors.IndentationActorExtension",()=>new jn).as("Box4.Actors.IIndentationActorExtension").ha();Object(Kw.a)()&&b.register(xz,"Box4.HighContrastColorPickerState").as("Box4.IHighContrastColorPickerState").ha();Object(kG.a)()&&b.ia("Box4.Actors.PageColorActor",()=>new Uv(zy.a.instance,new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.sc.jd),tp.a.instance,vm.a.instance,Ya.a.instance.Oa("Box4.UI.RecentColorsSectionHandler"),new Tr(Uv.xnb))).ha()}}Object(u.a)(PG,"Box4ActorsComponentConfiguration",
null,[1]);var Lu=d(220),tE=d(1183);const uE=()=>{const b=CC;A.AFrameworkApplication.va.ra(wb.a.tzf,oc.a.bpb,b);A.AFrameworkApplication.va.ra(wb.a.tzf,oc.a.Ric,b);A.AFrameworkApplication.va.ra(wb.a.szf,oc.a.bpb,Lt);A.AFrameworkApplication.va.ra(wb.a.szf,oc.a.Ric,Lt)},CC=(b,h,n)=>$e.App.U_d?8:2===n?(b=new ui.StandardDialog,b.Gd=4,b.uY(1),b.Pe(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.Pe(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.WDg(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,
Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,Ky),32):2,Ky=b=>{1===b&&A.AFrameworkApplication.va.Ob(wb.a.szf,2)},Lt=(b,h,n)=>{if($e.App.U_d)return 8;if(1===n)return h.node.hasProperty(Hf.a.SNb)?32:2;if(2===n&&(h.contextId===oc.a.view&&h.view.lb&&(h=h.view.lb.Og),Lu.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=tE.a.$rm(h.node);fc.a.WZo();try{vE(b)}catch(B){x.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",B)}}return 32},vE=b=>{$c.a.yn(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};
var dB=d(848);class rt{constructor(b){this.rJ=null;this.rTc=(h,n,B,L,ba)=>{if(1===B)return 32;if(2===B&&!ba)return 8;this.cVe.Oae=!this.cVe.Oae;h=rt.$i.Nkc(n);n=new dB.a;B=null;32===A.AFrameworkApplication.va.Pb(wb.a.CZa,2,n)&&n&&(B=n.fontColor);L="";B&&!n.ROb&&(L=Nl.a.VC(B)||"");this.k4d.Ana=L;this.iY.Mtd(L);h=this.k4d.cPb(h,$e.App.W6a);if(!h)return 8;ba.MenuItems=h;x.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.Tid=(h,n,B,L,ba)=>{if(1===B)return 32;if(!ba)return 8;
ba[$g.a.On]=this.cVe.Oae;return 32};this.hca=(h,n,B,L,ba)=>{if(1===B)return 32;A.AFrameworkApplication.va.Pb(wb.a.CZa,2,ba);h=ba&&0<=ba.fontColor&&16777215>=ba.fontColor?ba.fontColor:0;Ua.StaticActiveAppFrame.za().dismissFloatie();(new Tv(rt.xnb,wb.a.Gva)).H0b(h);return 32};this.KXb=(h,n,B,L,ba)=>{if(1===B)return 32;if(2===B&&!ba)return 8;h=rt.$i.Nkc(n);n=new dB.a;B=null;32===A.AFrameworkApplication.va.Pb(wb.a.CZa,2,n)&&n&&(B=n.fontColor);L="";B&&!n.ROb&&(L=Nl.a.VC(B)||"");this.k4d.Ana=L;this.iY.Mtd(L);
h=this.k4d.cPb(h,$e.App.W6a);if(!h)return 8;ba.MenuItems=h;x.ULS.sendTraceTag(508421139,340,50,"Font color dropdown menu is opened.");return 32};this.W0e=b}get k4d(){this.rJ||(this.rJ=new Tr(rt.xnb),this.pta(this.rJ));return this.rJ}pta(b){Object(Kw.a)()&&b.PQ(7,wb.a.rTc);b.PQ(1,wb.a.$ja);b.PQ(3,wb.a.ax);b.PQ(4,wb.a.ax);b.PQ(5,wb.a.Gva);b.PQ(6,wb.a.hca);b.bmb(this.W0e,1)}Wb(b){const h=A.AFrameworkApplication.va;Object(Kw.a)()&&(this.cVe=b,h.ra(wb.a.rTc,oc.a.view,this.rTc),h.fb(wb.a.Tid,oc.a.view,
this.Tid,96));h.ra(wb.a.hca,oc.a.view,this.hca);h.ra(wb.a.KXb,oc.a.view,this.KXb);h.Rc(wb.a.KXb,1127)}static ctm(){return new rt(zy.a.instance)}static get instance(){return null!=rt.IZg?rt.IZg:rt.IZg=rt.ctm()}get iY(){return null!=this.v3g?this.v3g:this.v3g=Ya.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}static get $i(){return Gm.PageReader.instance}}rt.xnb="Font";Object(u.a)(rt,"FontColorActor",null,[]);class ar{constructor(b){this.hca=(h,n,B,L,ba)=>{if(1===B)return 32;A.AFrameworkApplication.va.Pb(wb.a.CZa,
2,ba);h=ba&&0<=ba.highlight&&16777215>=ba.highlight?ba.highlight:0;Ua.StaticActiveAppFrame.za().dismissFloatie();(new Tv("Highlighter",wb.a.Jca)).H0b(h);return 32};this.ga=b}Wb(){this.ga.ra(wb.a.Spj,oc.a.view,this.hca)}static $um(){return new ar(A.AFrameworkApplication.va)}static get instance(){return null!=ar.t_g?ar.t_g:ar.t_g=ar.$um()}}Object(u.a)(ar,"HighlighterColorActor",null,[]);var np=d(93),Mt;(function(b){b.eNp="Heading";b.Bookmark="Bookmark";b.Url="Url";b.zPp="RecentLinks"})(Mt||(Mt={}));
Object(u.b)("InsertLinkUserActivitySource",Mt);class eB{constructor(b,h,n,B,L){this.linkurl=b;this.isHeading=h;this.startCp=n;this.endCp=B;this.paragraphNode=L}}Object(u.a)(eB,"HeadingDataForLinkDialog",null,[]);class Ly{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(u.a)(Ly,"BookmarkDataForLinkDialog",null,[]);class Dt{constructor(b,h,n,B,L,ba){this.key=b;this.name=h;this.startIndex=n;this.count=B;this.level=L;this.isCollapsed=ba}}Object(u.a)(Dt,"GroupHeaderDataForLinkDialog",null,[]);
class Hx{constructor(b,h){this.selectedIndex=b;this.selectedGroupId=h}}Object(u.a)(Hx,"SelectedItemFromLinkDialogGroupedList",null,[]);class Vv{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb){this.es=b;this.rd=h;this.bXl=n;this.bookmarkManager=B;this.t3=L;this.Np=ba;this.rg=la;this.Md=La;this.Lj=fb;this.Wk=Cb;this.iCa=Lb;this.ZOb=null;this.FXi=!1;this.bWf=(Nc,dd)=>{var Hd;if(this.me.lw){var xe=ef.a.C4c(this.es),je=this.me.lb.gb.currentSelection;if(je){je=je.Ra;ea.ParagraphReader.nn(je)&&(je=Nd.a.createTextRange(je.node,
0,ea.ParagraphReader.textLength(je.node)));var he=re.SelectionEditor.c2b(je);re.SelectionEditor.am(he)&&(je=he);if(0!==Nc&&32===A.AFrameworkApplication.va.lg(je,wb.a.QR,1,!0,null,null)&&this.es.equals(je)){ce.a.mark(5562);(null===(Hd=we.StaticTheCoauthManager.ud())||void 0===Hd?0:Hd.Jo)&&this.me.lb.fcc();Nc=new Sd.GraphTransaction(15);Nc.Ab(this.es.node);this.es.node.CL().YG.laa(4);Hd=dd.txtDisplay;je=!1;if(null!=dd.linkurl)if(je=!0,dd.isHeading){m(this.rd,"Heading");he=dd.paragraphNode;const fe=
dd.startCp,De=dd.endCp;dd=this.bookmarkManager.ejm(he);this.bookmarkManager.pSc(dd,fe,De,he,he,!1)}else m(this.rd,"Bookmark"),dd=dd.linkurl;else m(this.rd,"Url"),dd=dd.txtLink.trim();this.jSb(Hd,dd,xe,je);Nc.yi=wb.a.QR;Nc.dispose();ce.a.mark(5563);this.es.node.npb()}else this.me.f9()}else x.ULS.sendTraceTag(509372371,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}};this.me=Object(Pb.a)().zd;this.es=b;n=re.SelectionEditor.c2b(this.es);re.SelectionEditor.am(n)&&(this.es=
n);const $b=new Ge.a(!1,!1,!0);n=this.gum();B={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:n};L=this.ZOb="";L=ea.ParagraphReader.text(this.es.node);la=this.es.cpBegin;La=this.es.cpEnd;({Jxg:L,uCf:la,vCf:La,XTf:ba}=this.xpm(L));if((h="object"===typeof h?
h:null)&&(h.Source&&"CommandingInterface"===h.Source||h.Url&&h.DisplayText))this.jSb(h.DisplayText,h.Url,ba);else{ba[0]&&this.o4l(la,La,ba[0].paragraph);h=""===L.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;$b.Pe(1,h);(null===L||void 0===L?0:L.startsWith(F.a.Imb))?(h=this.MJm(L,n))?n.selectedItem=h:B.txtLink=L:B.txtLink=L;B.txtDisplay=this.ZOb;1>=ba.length&&this.t3.jzl(b,ba[0],1===ba.length)&&(this.FXi=!0,B.textDisplayDisabled=!0);var tc={["id"]:"InsertLinkDialog",
["bodyControls"]:B};this.Wk.Yd(()=>{$b.pi(Box4Intl.Box4Strings.l_InsertLinkTitle,this.bWf,tc)},"RILD:IAS")}}xpm(b){const h=ef.a.C4c(this.es);let n=this.es.cpBegin,B=this.es.cpEnd,L="";if(!h.length)return this.ZOb=b.substring(this.es.cpBegin,this.es.cpEnd),{returnValue:!0,Jxg:L,uCf:n,vCf:B,XTf:h};if(h[0].hyperlink){let ba,la=0,La=Math.max(0,b.length-1),fb=0;for(let Cb=0;Cb<h.length;Cb++)h[Cb].cpBegin>=la&&({cpBegin:ba,cpEnd:la}=this.t3.ila(this.es,h[Cb]),La=Math.min(ba,La),fb=Math.max(la,fb));n=Math.min(La,
n);B=Math.max(fb,B);this.ZOb=b.substring(n,B);n===La&&(L=h[0].hyperlink.url);return{returnValue:!0,Jxg:L,uCf:n,vCf:B,XTf:h}}return{returnValue:!1,Jxg:L,uCf:n,vCf:B,XTf:h}}o4l(b,h,n){if(h!==this.es.cpEnd||b!==this.es.cpBegin)b=Oe.SelectionFactory.eN(n,b,h),this.me.lb.Ic(b),this.es=re.SelectionEditor.c2b(b.Ra.clone())}smp(b,h,n,B,L,ba=!1){B?(B=Nd.a.createTextRange(this.es.node,this.es.cpBegin,this.es.cpBegin+b.length),this.Np.bZl(B,n,h),b=Oe.SelectionFactory.se(this.es.node,this.es.cpBegin+b.length)):
(this.Np.lvb(this.es,2),this.Lj.Ayb(this.es,2),n=Nd.a.Tc(this.es.node,this.es.cpEnd),this.rg.Ne(n,b,!0),B=Nd.a.createTextRange(this.es.node,this.es.cpEnd,this.es.cpEnd+b.length),this.Np.vF(B,h,L,!1,!0,ba),b=Oe.SelectionFactory.se(this.es.node,this.es.cpEnd+b.length));b&&this.me.lb.Ic(b)}jSb(b,h,n,B=!1){var L=null;b||(b=h,A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!n.length||h!==n[0].hyperlink.url)&&
!B){h=ef.a.VKa(h);var ba="";this.iCa&&({Rrg:ba}=this.iCa.wKg(h)).returnValue&&(h=ba)}this.FXi||(b=this.Np.CDo(b));ba=!1;if(h){L=0<n.length;const la=ea.ParagraphReader.text(this.es.node).substring(this.es.cpBegin,this.es.cpEnd)!==b,La=this.Md.Mg;if(La&&1===n.length&&!n[0].hyperlink.wI&&!(n[0].cpBegin>this.es.cpBegin&&n[0].cpEnd<=this.es.cpEnd)){this.smp(b,h,n[0].hyperlink,!la,L,B);return}if(L)for(let fb=0;fb<n.length;fb++)n[fb].hyperlink.wI&&(ba=!0),this.Np.hV(this.es.node,n[fb].hyperlink,!1);la?this.rg.Ne(this.es,
b,!ba):La&&!ba&&this.Lj.Ayb(this.es,1);n=Nd.a.createTextRange(this.es.node,this.es.cpBegin,this.es.cpBegin+b.length);this.Np.vF(n,h,L,ba,!0,B);L=Oe.SelectionFactory.se(this.es.node,this.es.cpBegin+b.length)}else 0<n.length&&(b=n[0],b.hyperlink.wI&&(ba=!0),this.Np.hV(b.paragraph,b.hyperlink));ba&&this.Md.$t(ba?2:7);L&&this.me.lb.Ic(L);$e.App.Onp()}MJm(b,h){h=h.items;const n=b.substring(F.a.Imb.length),B=this.bookmarkManager.aEi(n);b=-1;let L=0;for(let ba=0;ba<h.length;ba++)if(h[ba].isHeading&&0!=B.count&&
h[ba].paragraphNode.id==B.J(0).id){b=ba;break}else if(!h[ba].isHeading&&h[ba].linkurl==n){b=ba;L=1;break}h=new Hx(b,L);return-1!=b?h:null}gum(){const b={};let h=[],n=0,B=0;var L=this.bXl.Lum();L&&(n=L.count,h=h.concat(this.Qum(L)));if(L=this.bookmarkManager.g5d(!1))B=L.count,h=h.concat(this.ijm(L));b.groups=this.Fum(n,B);b.items=h;return b}Fum(b,h){const n=[],B=new Dt("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);n.push(B);b=new Dt("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,
b,h,0,!0);n.push(b);return n}Qum(b){const h=[],n=/\uFFFC/;for(const B of b)b=B.characterData.replace(n," "),b=new eB(b,!0,B.Fc,B.end,B.paragraphNode),h.push(b);return h}ijm(b){const h=[];for(const n of b)b=n.wf(Lc.a.yu).toString(),b=new Ly(b,!1),h.push(b);return h}}Object(u.a)(Vv,"ReactInsertLinkDialog",null,[]);class Lw{static get kh(){return Ge.a.az(Lw.Mn,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Lw.Mn="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(u.a)(Lw,"InsertLinkDialogHtml",null,[]);class Fo extends Ge.a{constructor(b){super();this.une=()=>{const h=document.getElementById("txtLink");this.Bva(1,!h||!h.value.length||ef.a.VXa(h.value))};this.bWf=(h,n)=>{if(this.Dh.lw){var B=this.Dh.lb.gb.currentSelection;if(B)if(B.equals(this.Qy)&&0!==h){h=new Sd.GraphTransaction(15);h.Ab(this.pW[0].node);for(B=0;B<this.pW.length;B++)this.pW[B].node.CL().YG.laa(4);B=n.txtLink.trim();n=this.EPl();B=this.e$m(B);(n||B)&&Fo.Md.$t(7);this.hide();h.dispose()}else this.Dh.f9()}};
this.pW=b;this.Dh=Object(Pb.a)().zd;this.Qy=this.Dh.lb.gb.currentSelection;this.kEf=b[0].cpBegin;this.Z2f=b[b.length-1].cpEnd;this.Qg="InsertMultiParagraphLinkDialog";b=this.Qvp();this.showDialog("",b)}showDialog(b,h){x.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.kh=Lw.kh;""===h.trim()&&this.Pe(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.pi(Box4Intl.Box4Strings.l_InsertLinkTitle,this.bWf,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();
document.getElementById("txtDisplay").disabled=!0;Fo.AZf&&(b=document.getElementById("txtLink"),Nb.a.addHandler(b,Cd.a.input,this.une),Nb.a.addHandler(b,Cd.a.fVc,this.une))}hide(){if(Fo.AZf){const b=document.getElementById("txtLink");b&&(Nb.a.removeHandler(b,Cd.a.fVc,this.une),Nb.a.removeHandler(b,Cd.a.input,this.une))}super.hide()}zAa(b){return Fo.AZf?this.Xjm(this.TFc)?super.zAa(b):!1:super.zAa(b)}Qvp(){let b;var h="";const n=this.pW.length,B=ef.a.QA(this.pW[0],!1);0<B.length&&({cpBegin:L,cpEnd:b}=
Fo.t3.ila(this.pW[0],B[0]),L<=this.pW[0].cpBegin&&(h=B[0].hyperlink.url),this.kEf=Math.min(this.kEf,L));var L=ef.a.QA(this.pW[n-1],!1);0<L.length&&({cpBegin:L,cpEnd:b}=Fo.t3.ila(this.pW[n-1],L[L.length-1]),this.Z2f=Math.max(this.Z2f,b));this.Cop(this.kEf,this.Z2f);return h}Cop(b,h){const n=this.pW.length;if(b!==this.pW[0].cpBegin||h!==this.pW[n-1].cpEnd){b=Nd.a.Tc(this.pW[0].node,b);b=Oe.SelectionFactory.Fo(b);h=Nd.a.Tc(this.pW[n-1].node,h);h=Oe.SelectionFactory.$y(b,h);b=this.hJi(h.Ra.clone());const B=
this.hJi(h.Uc.clone());b&&B&&(this.pW[0]=b,this.pW[n-1]=B,this.Dh.lb.Ic(h),this.Qy=h)}}e$m(b){if(!b)return!1;b=ef.a.VKa(b);for(let n=0;n<this.pW.length;n++){var h=this.pW[n];if(Fo.eza&&re.SelectionEditor.am(h)&&(h=re.SelectionEditor.rKg(h),!re.SelectionEditor.am(h)))continue;h=Nd.a.createTextRange(this.pW[n].node,h.cpBegin,h.cpEnd);this.aop(h);Fo.Np.vF(h,b,!1)}return!0}aop(b){np.a.instance.J(1)&&Fo.Md.k3j(b)}hJi(b){return ea.ParagraphReader.nn(b)&&!re.SelectionEditor.yba(b)&&ea.ParagraphReader.textLength(b.node)?
Nd.a.createTextRange(b.node,0,ea.ParagraphReader.textLength(b.node)):re.SelectionEditor.am(b)?b:null}EPl(){let b=!1;for(const h of this.pW){const n=ef.a.QA(h,!1);n&&(b=Fo.t3.tCj(h,n)||b)}return b}static get t3(){return null!=Fo.PYg?Fo.PYg:Fo.PYg=Ya.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Md(){return null!=Fo.n6g?Fo.n6g:Fo.n6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Np(){return null!=Fo.GYg?Fo.GYg:Fo.GYg=Ya.a.instance.resolve("Box4.IHyperlinkEditor")}static get eza(){null==
Fo.mda&&(Fo.mda=A.AFrameworkApplication.K?A.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Fo.mda}static get AZf(){null==Fo.HXe&&(Fo.HXe=A.AFrameworkApplication.K?A.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return Fo.HXe}}Fo.mda=null;Fo.HXe=null;Object(u.a)(Fo,"InsertMultiParagraphLinkDialog",Ge.a,[]);class yf{static get mg(){return Pd.a.instance}static get p_(){return null!=yf.KUg?yf.KUg:yf.KUg=Ya.a.instance.Oa("Box4.IContentControlChpHelper")}static get t3(){return null!=
yf.QYg?yf.QYg:yf.QYg=Ya.a.instance.resolve("Box4.IHyperlinkStrategy")}static wy(){return yf.Xn||(yf.Xn=Ya.a.instance.Qa("Box4.IExternalSelectionManager"))}static get Md(){return null!=yf.y6g?yf.y6g:yf.y6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Vh(){return null!=yf.E6g?yf.E6g:yf.E6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Ec(){return Yc.a.instance}static get Xdd(){null==yf.bBb&&(yf.bBb=A.AFrameworkApplication.K?
A.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return yf.bBb}static get eza(){null==yf.mda&&(yf.mda=A.AFrameworkApplication.K?A.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return yf.mda}static get Np(){return null!=yf.MYg?yf.MYg:yf.MYg=Ya.a.instance.resolve("Box4.IHyperlinkEditor")}static get rg(){return null!=yf.yUg?yf.yUg:yf.yUg=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get wab(){yf.fYe||(yf.fYe=A.AFrameworkApplication.K?
A.AFrameworkApplication.K.$("IsO365CommercialHost")||A.AFrameworkApplication.K.$("IsO365ConsumerHost"):!1);return yf.fYe}static get Ijp(){yf.iIh||(yf.iIh=A.AFrameworkApplication.K?A.AFrameworkApplication.K.ic("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return yf.iIh}static Wb(){const b=A.AFrameworkApplication.va;b.ra(wb.a.QR,oc.a.view,yf.GRb);b.ra(wb.a.QR,oc.a.Xc,yf.jSb);b.ra(wb.a.QR,oc.a.Bd,yf.jSb);b.Rc(wb.a.QR,1028);b.ra(wb.a.Ehc,oc.a.view,yf.GRb);b.ra(wb.a.Ehc,oc.a.Xc,yf.jSb);b.ra(wb.a.Ehc,
oc.a.Bd,yf.jSb);b.Rc(wb.a.Ehc,1028);b.ra(wb.a.hV,oc.a.view,yf.GRb);b.ra(wb.a.hV,oc.a.Xc,yf.DCj);b.ra(wb.a.hV,oc.a.Bd,yf.DCj);b.Rc(wb.a.hV,1028);b.ra(wb.a.Fwe,oc.a.view,yf.GRb);b.ra(wb.a.Fwe,oc.a.Xc,yf.IKj);b.ra(wb.a.Fwe,oc.a.Bd,yf.IKj);b.ra(wb.a.mcb,oc.a.view,yf.GRb);b.ra(wb.a.mcb,oc.a.Xc,yf.Vpj);b.ra(wb.a.mcb,oc.a.Bd,yf.Vpj);b.ra(wb.a.mcb,oc.a.image,yf.kig);b.ra(wb.a.mcb,oc.a.LOb,yf.kig);b.ra(wb.a.mcb,oc.a.caa,yf.kig);b.ra(wb.a.KVc,oc.a.application,yf.KVc);b.ra(wb.a.mYd,oc.a.view,yf.GRb);yf.wab&&
(b.fb(Pa.a.edb,oc.a.view,this.GRb.bind(this),1028),b.ra(Pa.a.edb,oc.a.Xc,this.edb.bind(this)),b.ra(Pa.a.edb,oc.a.Bd,this.edb.bind(this)),b.Rc(Pa.a.edb,1028),b.ra(Pa.a.cWf,oc.a.Xc,this.edb.bind(this)),b.ra(Pa.a.cWf,oc.a.Bd,this.edb.bind(this)),b.Rc(Pa.a.cWf,1028),b.ra(Pa.a.Ilg,oc.a.view,this.Ilg.bind(this)),b.ra(Pa.a.Clg,oc.a.view,this.Clg.bind(this)),b.fb(Pa.a.xsb,oc.a.Xc,this.xsb.bind(this),1028),b.fb(Pa.a.xsb,oc.a.Bd,this.xsb.bind(this),1028))}static KVc(){return 32}static edb(b,h,n){if(!yf.wab)return 2;
b=yf.dak(h);if(32!=b)return b;if(!yf.UXa(h,!0).returnValue||yf.wfc(h))return 8;1!==n||yf.vpi||(yf.vFe(!0),yf.vpi=!0);return 32}static Ilg(b,h,n,B,L){if(!yf.wab)return 2;if(1===n)return 32;yf.Kte(yf.eJk,yf.fJk,yf.rBh);Rn.a.instance.Yd(()=>{yf.vFe();L.MenuItems=Object.assign(new vh.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const ba=this.Tai();ba?(x.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),L.MenuItems.MenuSectionList.push(ba)):yf.Utj(L,yf.rBh)},
"HA:PRLF");return 32}static Clg(b,h,n,B,L){if(!yf.wab)return 2;if(1===n)return 32;yf.Kte(yf.cJk,yf.dJk,yf.qBh);Rn.a.instance.Yd(()=>{yf.vFe();L.MenuItems=Object.assign(new vh.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});L.MenuItems.MenuSectionList.push(this.BGl());const ba=this.Tai(!0);ba?(x.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),L.MenuItems.MenuSectionList.push(ba)):yf.Utj(L,yf.qBh)},"HA:PILF");return 32}static Utj(b,h){x.ULS.sendTraceTag(524911777,
324,50,"Recent Links could not load in "+h);yf.Kte(yf.EFk,yf.FFk,h);b.MenuItems.MenuSectionList.push(this.bJl());yf.vFe(!0)}static bJl(){const b=this.vuf("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new jj.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static BGl(){const b=this.vuf("InsertLinkSection");b.ControlList.push(Object.assign(new jj.a,{ExternalId:"InsertLink"}));return b}static Tai(b=!1){if(uj.instance.HKd){var h=
this.vuf("RecentLinksSection",b);b=JSON.parse(uj.instance.HKd);this.GKd.clear();b.forEach((n,B)=>{this.GKd.set(B,[n.FileName,n.DocumentUrl]);const L=yf.FHm(n.FileName);var ba=yf.Dtm(n.TimeStamp),la=h.ControlList,La=la.push,fb=Object,Cb=fb.assign,Lb=new jj.a,$b=Pa.a.xsb,tc=Pa.a.xsb;ba=L!==n.FileName?n.FileName+"\n"+ba:ba;var Nc=n.FileName;let dd="SaveAsWordDocx_32";switch(n.App){case "Word":dd="SaveAsWordDocx_32";break;case "PowerPoint":dd="SaveAsPowerPointPptx_32";break;case "Excel":dd="SaveAsExcelXlsx_32"}La.call(la,
Cb.call(fb,Lb,{ExternalId:B,Command:$b,CommandValueId:tc,LabelText:L,Alt:ba,AriaDescription:Nc,ExternalImageId:dd,KeyTip:n.FileName}))});return h}}static vuf(b,h=!1){return Object.assign(new te.a,{Title:h?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static xsb(b,h,n,B,L){if(!yf.wab)return 2;if(!L||L.CommandValueId!=Pa.a.xsb)return 32;yf.Kte(yf.Jzk,yf.Kzk,yf.rKk);n=h;h=new Sd.GraphTransaction(15);h.yi=b;h.Ab(n.node);
B=yf.UXa(n,!0).hyperlink;n=re.SelectionEditor.c2b(n);if(B)yf.Jsg(n),b=Oe.SelectionFactory.eN(n.node,Math.min(n.cpBegin,B.cpBegin),Math.max(n.cpEnd,B.cpEnd)),Zb.a.instance.Ic(b),n=b.Ra;else if(re.SelectionEditor.mf(n)){var ba;re.SelectionEditor.Ftb(n)&&(ba=re.SelectionEditor.i7(n,!1));ba||(ba=this.GKd.get(L.SourceControlId)[0],yf.rg.Ne(n,ba,!0,void 0,b),ba=Oe.SelectionFactory.eN(n.node,n.cpBegin,n.cpBegin+ba.length));if(ba&&(Zb.a.instance.Ic(ba),n=ba.Ra,yf.wfc(n)))return yf.Md.K0b(!1),8}try{yf.Np.vF(n,
this.GKd.get(L.SourceControlId)[1],0<ef.a.C4c(n).length);const la=Oe.SelectionFactory.se(n.node,n.cpEnd);la&&Zb.a.instance.Ic(la);m(L,"RecentLinks")}finally{h&&h.dispose()}x.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static GRb(b,h,n,B,L){if(yf.Xdd)return yf.c2m(b,h,n,B,L);if(!h.view.te)return 2;var ba=h.view.lb;if(!ba||!ba.gb||!ba.gb.length)return 8;var la=ba.gb.currentSelection;let La=la.Ra.clone();if(2===la.length){if(la=la.J(1),!re.SelectionEditor.am(La)||!re.SelectionEditor.gl(la)||
La.node!==la.node)return 8}else if(2<la.length)return 8;if(ba.gb.QL)return 8;if(Object(el.a)().pFa(ea.ParagraphReader.BX,ba.Og))return yf.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.WQ}),8;ea.ParagraphReader.nn(La)&&!re.SelectionEditor.yba(La)&&(ba=La.node,La=Nd.a.createTextRange(ba,0,ea.ParagraphReader.textLength(ba)));return b===wb.a.mYd?yf.S8h(h,La,n,B):A.AFrameworkApplication.va.lg(La,b,n,!0,B,L)}static c2m(b,h,n,B,L){if(!h.view.te)return 2;var ba=h.view.lb;if(!ba||!ba.gb||!ba.gb.length||ba.gb.QL)return 8;
var la=ba.gb.currentSelection;if(ba=yf.Y0f(la))la=yf.ZOf(la.Ra.clone(),!0);else{let La=la.J(0).clone(),fb=1;for(;fb<la.length&&(!ea.ParagraphReader.textLength(La.node)||re.SelectionEditor.gl(La)||yf.eza&&tn.l(La));)La=la.J(fb).clone(),fb++;la=yf.ZOf(La,!1)}return yf.eza&&re.SelectionEditor.am(la)&&tn.l(la)||!re.SelectionEditor.am(la)&&!ba?8:b===wb.a.mYd?yf.S8h(h,la,n,B):A.AFrameworkApplication.va.lg(la,b,n,!0,B,L)}static Y0f(b){if(1===b.length)return!0;if(2===b.length){const h=b.Ra.clone();b=b.J(1);
return re.SelectionEditor.am(h)&&re.SelectionEditor.gl(b)&&h.node===b.node?!0:!1}return!1}static $5h(b){let h=null;const n=[];for(let B=0;B<b.length;B++){const L=yf.ZOf(b.J(B).clone(),!1);if(re.SelectionEditor.am(L))yf.eza&&tn.l(L)||n.push(L);else if(!re.SelectionEditor.gl(L)&&!ea.ParagraphReader.nn(L))return{returnValue:!1,Qnb:h}}h=n;return{returnValue:!yf.eza||0<h.length?!0:!1,Qnb:h}}static jSb(b,h,n,B,L){if(yf.Xdd)return yf.o$m(h,n,L);B=yf.dak(h);if(32!==B)return B;let ba;if(!({hyperlink:ba}=yf.UXa(h,
!0)).returnValue||yf.wfc(h)||!ba&&b==wb.a.Ehc)return 8;if(1===n)return 32;if(!ba&&re.SelectionEditor.mf(h)&&re.SelectionEditor.Ftb(h)&&(b=re.SelectionEditor.i7(h,!1))&&(Zb.a.instance.Ic(b),h=b.Ra,yf.wfc(h)))return yf.Md.K0b(!1),8;ba&&x.ULS.sendTraceTag(593875799,324,50,"Edit link");a(h,L);return 32}static dak(b){return!yf.Enf()||!yf.OUd(b)||b.node.Gs||Zb.a.instance.gb.QL?8:re.SelectionEditor.M7(b)||Ve.a.gZf(b)?2:32}static o$m(b,h,n){var B=Zb.a.instance.gb.currentSelection;const L=yf.Y0f(B);if(L)b=
[b];else if(!({Qnb:b}=yf.$5h(B)).returnValue)return 8;if(!yf.Enf())return 8;for(B=0;B<b.length;B++)if(!yf.OUd(b[B]))return 8;if(Zb.a.instance.gb.QL)return 8;B=Array(b.length);let ba=null;for(let la=0;la<b.length;la++)if(B[la]=b[la],!({hyperlink:ba}=yf.UXa(B[la],!0)).returnValue||yf.wfc(B[la]))return 8;if(1===h)return 32;if(!ba&&1===B.length&&L&&re.SelectionEditor.mf(B[0])&&re.SelectionEditor.Ftb(B[0])&&(h=re.SelectionEditor.i7(B[0],!1))&&(Zb.a.instance.Ic(h),B[0]=h.Ra,yf.wfc(B[0])))return yf.Md.K0b(!1),
8;L?a(B[0],n):new Fo(B,n);return 32}static DCj(b,h,n){if(yf.Xdd)return yf.Hyo(b,h,n);if(!yf.OUd(h)||re.SelectionEditor.M7(h))return 2;let B;if(!({hyperlink:B}=yf.UXa(h,!1)).returnValue)return 2;if(2===n){n=new Sd.GraphTransaction(15);try{n.yi=b,n.Ab(B.paragraph),yf.Jsg(h)}finally{n&&n.dispose()}B.hyperlink.wI&&yf.Md.$t(2)}return 32}static Hyo(b,h,n){var B=Zb.a.instance.gb.currentSelection;if(yf.Y0f(B))h=[h];else if(!({Qnb:h}=yf.$5h(B)).returnValue)return 8;if(!yf.Enf())return 8;for(B=0;B<h.length;B++)if(!yf.OUd(h[B]))return 8;
if(1===n&&!yf.UXa(h[0],!1).returnValue)return 2;if(2===n){for(n=0;n<h.length;n++)if(!yf.UXa(h[n],!0).returnValue)return 2;n=new Sd.GraphTransaction(15);try{const L=h[0];n.yi=b;n.Ab(L.node);for(b=0;b<h.length;b++)yf.Jsg(h[b])}finally{n&&n.dispose()}yf.Md.$t(7)}return 32}static Jsg(b){const h=ef.a.C4c(b);let n=0;for(let B=0;B<h.length;B++)if(h[B].cpBegin>=n){const L=({cpEnd:n}=yf.t3.ila(b,h[B])).returnValue;yf.t3.tCj(b,L)}}static IKj(b,h,n){if(Ad.ImageReader.N$a(h)||!({hyperlink:b}=yf.UXa(h,!1)).returnValue)return 2;
if(2===n){const {cpBegin:B,cpEnd:L}=yf.t3.ila(h,b);Zb.a.instance.Ic(Oe.SelectionFactory.eN(b.paragraph,B,L))}return 32}static Vpj(b,h,n){if(({hyperlink:b}=yf.Etn(h)).returnValue)x.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:b}=yf.UXa(h,!1)).returnValue)return 2;2===n&&$e.App.Uic(b.hyperlink.url);return 32}static kig(b,h,n){b=Ad.ImageReader.ila(h.node);if(!b)return 2;2===n&&$e.App.Uic(b);return 32}static S8h(b,h,n,B){if(Ad.ImageReader.N$a(h)||
!Object(Pb.a)().Ke.ek)return 2;let L;if(!({hyperlink:L}=yf.UXa(h,!1)).returnValue)return 2;if(1===n)return 32;const {cpBegin:ba,cpEnd:la}=yf.t3.ila(h,L);Zb.a.instance.Ic(Oe.SelectionFactory.eN(L.paragraph,ba,la));h=Object(Pb.a)().XIa.ownerDocument.createElement("span");h.innerText=L.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return A.AFrameworkApplication.va.lg(b,wb.a.lYd,2,!0,B,h)}static UXa(b,h){if(re.SelectionEditor.am(b)){const n=tn.g(b),B=lf.a.all(n,L=>6===L.Jh);if(0<n.length&&
(!yf.eza||!B)||yf.mg.vh&&yf.p_&&0<yf.p_.b6d(b).count)return{returnValue:!1,hyperlink:null}}return yf.ttn(b,h)}static Etn(b){let h=null;return Ad.ImageReader.N$a(b)&&(h=ef.a.mkc(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static ttn(b,h){let n=null;const B=ef.a.C4c(b);return B.length?B[0].hyperlink?(n=B[0],b.cpBegin<B[0].cpBegin?{returnValue:h,hyperlink:n}:{returnValue:!0,hyperlink:n}):{returnValue:!1,hyperlink:n}:{returnValue:h,hyperlink:n}}static wfc(b){if(np.a.instance.J(1)){b=
yf.Vh.nWa(b.node,b.cpBegin,b.cpEnd);for(let h=0;h<b.count;++h)if(2===b.J(h).Kd.changeType)return!0}return!1}static Enf(){return np.a.instance.J(1)?!0:!np.a.instance.J(1)||!$e.App.Ew.Y1b}static OUd(b){return yf.mg.Q2(b)||yf.mg.Vla(b)||yf.wy()&&yf.wy().instance&&yf.wy().instance.DX(b)?!1:!0}static ZOf(b,h){return ea.ParagraphReader.nn(b)&&!re.SelectionEditor.yba(b)&&(ea.ParagraphReader.textLength(b.node)||h)?Nd.a.createTextRange(b.node,0,ea.ParagraphReader.textLength(b.node)):b}static FHm(b){return b&&
b.length<=yf.$yj?b:b.substring(0,yf.$yj)+"..."}static Dtm(b){try{const h=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(h){return""}}static vFe(b=!1){const h=Date.now();if(b||h-yf.H5i>yf.Ijp)uj.instance.DHn(),yf.H5i=h}static Kte(b,h,n){const B=new Map;B.set("Source",n);B.set("Action",h);oa.Health.instance.recordKpiUsage(b,0,this.K2a,B)}}yf.Xn=null;yf.bBb=null;
yf.mda=null;yf.GKd=new Map;yf.fYe=null;yf.$yj=35;yf.H5i=Date.now();yf.vpi=!1;yf.K2a="wwaengidc";yf.rKk="RecentLinks";yf.rBh="RecentLinksRibbonOptions";yf.qBh="RecentLinksContextMenuOptions";yf.eJk="PopulateRecentLinksRibbon";yf.fJk="PopulateRecentLinksRibbonAction";yf.cJk="PopulateRecentLinksContextMenu";yf.dJk="PopulateRecentLinksContextMenuAction";yf.EFk="PopulateRecentLinksContextMenu";yf.FFk="PopulateRecentLinksContextMenuAction";yf.Jzk="InsertRecentLinks";yf.Kzk="InsertRecentLinksAction";Object(u.a)(yf,
"HyperlinkActor",null,[]);class Ix{}Ix.Ztb=Object.freeze({x4m:"WordIndentationShortcutUsage"});Ix.bD="wwaengidc";Object(u.a)(Ix,"IndentationConstants",null,[]);class Km{static get Sr(){return Hv.a.oQb}static get mg(){return Pd.a.instance}static get Ec(){return Yc.a.instance}static get lo(){return Object(Pb.a)()}static wy(){return Km.Xn||(Km.Xn=Ya.a.instance.Qa("Box4.IExternalSelectionManager"))}static get w4m(){return null!=Km.WYg?Km.WYg:Km.WYg=Ya.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Wb(){const b=
A.AFrameworkApplication.va;b.ra(wb.a.OI,oc.a.view,Km.uTc);b.ra(wb.a.OI,oc.a.jS,Km.RTh);b.Rc(wb.a.OI,1036);b.ra(wb.a.fR,oc.a.view,Km.uTc);b.ra(wb.a.fR,oc.a.jS,Km.RTh);b.Rc(wb.a.fR,1036)}static Ypo(b){const h=new Map;b=b?b.ja(hi.a.mRi,"Unknown"):"tab";h.set("actionCallSource",b);oa.Health.instance.recordKpiUsage(Ix.Ztb.x4m,1,Ix.bD,h)}static uTc(b,h,n,B,L){const ba=h.view;if(!ba.te)return 2;var la=ba.lb;if(!la)return Km.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.Gga}),8;la=la.Og;if(!la)return Km.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.oo}),
8;if(Ve.a.Sla(h))return 8;if(A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Km.mg.Tnc(la))return Km.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.HG}),8;if(1===n)return 32;if(Object(el.a)().lJa(Km.bif,la))return Km.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.HWc}),8;if(Object(el.a)().pFa(ea.ParagraphReader.BX,la))return Km.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.WQ}),8;if(!A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Km.mg.Tnc(la))return Km.Ec.$b(Tf.a.Te,
{["Reason"]:hf.a.HG}),8;if(Km.wy()&&Km.wy().instance&&Km.wy().instance.DX(la))return Km.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.t8a}),8;la={};la[Ks.a.RPa]=5794;la[Ks.a.QPa]=5795;return Km.w4m.uTc(ba,b,h,n,B,L,la)}static RTh(b,h,n,B,L){var ba,la;if(h.contextId!==oc.a.jS)return 2;var La=h.clone().UEg();if(xh.TableReader.c3i(La)){if(Km.mg.d3i(La))return Km.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.HG}),8}else if(Km.mg.xab(La))return Km.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.HG}),2;La=new ve.GraphIterator;La.set(h.node);re.SelectionEditor.rv(La);
if(!xb.OutlineElementReader.Mh(La))return 2;let fb;switch(b){case wb.a.OI:fb=Km.Sr.pLb(La);break;case wb.a.fR:fb=Km.Sr.tec(La);break;default:return 2}if(1===n||!fb)return fb?32:8;n=0;b===wb.a.fR&&L&&L.ja(zd.a.PVh,!1)&&(n|=2);if(xb.OutlineElementReader.ZT(La))return Km.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.WQ}),2;(null===(la=null===(ba=Km.lo)||void 0===ba?void 0:ba.zd)||void 0===la?0:la.EX)&&Km.lo.Ke&&(Km.lo.Ke.wK=!0);switch(b){case wb.a.OI:Km.Sr.xZa(La,-1,n);break;case wb.a.fR:Km.Sr.VYc(La,1)}B&&no.a.Gzb&&
(B.Gt|=no.a.Eqb(h.node,!0));Km.Ypo(L);return 32}}Km.Xn=null;Km.bif=Ad.ImageReader.M$a;Object(u.a)(Km,"IndentationActor",null,[]);var yn=d(1656);class Gl{static get rl(){return null!=Gl.M2g?Gl.M2g:Gl.M2g=Ya.a.instance.resolve("Box4.IParagraphEditor")}static get hk(){return null!=Gl.r5g?Gl.r5g:Gl.r5g=Ya.a.instance.resolve("Box4.ITableEditor")}static get mg(){return Pd.a.instance}static get Ec(){return Yc.a.instance}static wy(){return Gl.Xn||(Gl.Xn=Ya.a.instance.Qa("Box4.IExternalSelectionManager"))}static Wb(){const b=
A.AFrameworkApplication.va;b.ra(wb.a.rIg,oc.a.view,(h,n)=>Ve.a.Sla(n)?8:32);b.ra(wb.a.Y7,oc.a.view,yn.a.vx);b.ra(wb.a.Y7,oc.a.paragraph,Gl.wIa);b.ra(wb.a.Y7,oc.a.table,Gl.mjf);b.Rc(wb.a.Y7,1036);b.ra(wb.a.paa,oc.a.view,yn.a.vx);b.ra(wb.a.paa,oc.a.paragraph,Gl.wIa);b.ra(wb.a.paa,oc.a.table,Gl.mjf);b.Rc(wb.a.paa,1036);b.ra(wb.a.I8,oc.a.view,yn.a.vx);b.ra(wb.a.I8,oc.a.paragraph,Gl.wIa);b.ra(wb.a.I8,oc.a.table,Gl.mjf);b.Rc(wb.a.I8,1036);b.ra(wb.a.zKa,oc.a.view,yn.a.vx);b.ra(wb.a.zKa,oc.a.paragraph,Gl.wIa);
b.Rc(wb.a.zKa,1036);b.ra(wb.a.yZc,oc.a.view,yn.a.vx);b.ra(wb.a.yZc,oc.a.paragraph,Gl.wIa);b.Rc(wb.a.yZc,1036);b.ra(wb.a.YTb,oc.a.view,yn.a.vx);b.ra(wb.a.YTb,oc.a.paragraph,Gl.wIa);b.Rc(wb.a.YTb,1036);b.ra(wb.a.Nod,oc.a.view,yn.a.vx);b.ra(wb.a.Nod,oc.a.paragraph,Gl.wIa);b.Rc(wb.a.Nod,1036);b.ra(wb.a.Dqc,oc.a.view,yn.a.vx);b.ra(wb.a.Dqc,oc.a.paragraph,Gl.wIa);b.Rc(wb.a.Dqc,1036);b.ra(wb.a.Kec,oc.a.view,yn.a.vx);b.ra(wb.a.Kec,oc.a.paragraph,Gl.wIa);b.Rc(wb.a.Kec,1036);b.ra(wb.a.bwc,oc.a.view,yn.a.vx);
b.ra(wb.a.bwc,oc.a.paragraph,Gl.wIa);b.Rc(wb.a.bwc,1036);b.ra(wb.a.ljc,oc.a.view,yn.a.vx);b.ra(wb.a.ljc,oc.a.paragraph,Gl.wIa);b.Rc(wb.a.ljc,1036)}static mjf(b,h,n,B){let L=!0;if(!h)return 8;xh.TableReader.c3i(h)?Gl.mg.d3i(h)?(Gl.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.HG}),L=!1):Gl.wy()&&Gl.wy().instance&&Gl.wy().instance.DX(h)&&(Gl.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.t8a}),L=!1):(Gl.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.mzf}),L=!1);if(1===n||!L)return L?32:8;h=h.node;switch(b){case wb.a.Y7:Gl.hk.rH(h,1);break;case wb.a.paa:Gl.hk.rH(h,
2);break;case wb.a.I8:Gl.hk.rH(h,3)}B&&no.a.Gzb&&(B.Gt|=2);return 32}static wIa(b,h,n,B,L){let ba=!0;h.contextId!==oc.a.paragraph?ba=!1:Gl.mg.xab(h)?(Gl.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.HG}),ba=!1):Gl.wy()&&Gl.wy().instance&&Gl.wy().instance.DX(h)&&(Gl.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.t8a}),ba=!1);if(1===n||!ba)return ba?32:8;h=h.node;n=ea.ParagraphReader.ez(h);switch(b){case wb.a.Y7:case wb.a.Dqc:Gl.rl.rH(h,1===n&&Gl.Kge(L)?6:1);break;case wb.a.paa:case wb.a.Kec:Gl.rl.rH(h,2===n&&Gl.Kge(L)?1:2);break;
case wb.a.I8:case wb.a.bwc:Gl.rl.rH(h,3===n&&Gl.Kge(L)?1:3);break;case wb.a.zKa:case wb.a.ljc:Gl.rl.rH(h,6===n&&Gl.Kge(L)?1:6);break;case wb.a.YTb:Gl.rl.rH(h,11);break;case wb.a.yZc:Gl.rl.rH(h,7);break;case wb.a.Nod:Gl.rl.rH(h,13)}B&&no.a.Gzb&&(B.Gt|=no.a.Eqb(h));return 32}static Kge(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}Gl.Xn=null;Object(u.a)(Gl,"JustificationActor",null,[]);const QG=()=>{const b=A.AFrameworkApplication.va;
b.ra(wb.a.save,id.a.frame,fB);b.ra(wb.a.sync,id.a.frame,VI)},VI=(b,h,n)=>{if(1===n)return 32;A.AFrameworkApplication.va.Ob(wb.a.zec,2);$e.App.jf.YBe();return 32},fB=(b,h,n)=>{if(1===n)return 2===Ua.StaticActiveAppFrame.za().mode?32:8;A.AFrameworkApplication.va.Ob(wb.a.zec,2);if(2!==Ua.StaticActiveAppFrame.za().mode)return 32;$e.App.jf.lJj(null,null);return 32};class Wv{constructor(){this.activateRibbonTab=(b,h,n,B,L)=>{$e.App.Ew.kL.Kve(L.toString());return 32};this.wxn=(b,h,n,B,L)=>{$e.App.Ew.kL.W4i(1,
L.toString());return 32};this.J3n=(b,h)=>{if(h.contextId!==id.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Wb(){const b=A.AFrameworkApplication.va;b.ra(wb.a.activateRibbonTab,oc.a.view,this.activateRibbonTab);b.Rc(wb.a.activateRibbonTab,5);b.ra(wb.a.X4i,oc.a.view,this.wxn);b.ra(wb.a.pJg,id.a.frame,this.J3n)}static get instance(){return null!=Wv.yZg?Wv.yZg:Wv.yZg=Wv.Qm()}static Qm(){return new Wv}}Object(u.a)(Wv,"RibbonActor",null,[]);var Sp=d(941);class fv{constructor(b,h){this.Fn=null;
this.vrp=(n,B,L,ba,la)=>{let La;ba=B.view;if(!ba.te)return fv.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.ZVb}),8;La=n===wb.a.undo?this.tg.X_:this.tg.DWa;if(1===L)return Ve.a.Sla(B)&&Ve.a.hoc()?8:La?32:8;if(!La)return x.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",n===wb.a.undo?"undo":"redo"),this.xQa.value.e5j(),fv.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.prp}),2;B=new Sd.GraphTransaction(3);B.Ab(ba.jd);B.kxe();n=n===wb.a.undo?this.tg.undo():this.tg.fna();B.dispose();la&&yz.GrippersManager.instance.C2b(la.iz);
if(n)return 32;fv.Ec.$b(Tf.a.jhc,{["Reason"]:hf.a.lhj});return 8};this.Hqa=b;this.xQa=h}get tg(){return this.Fn||(this.Fn=this.Hqa())}Wb(){const b=A.AFrameworkApplication.va,h=this.vrp;b.fb(wb.a.undo,oc.a.view,h,1028);b.fb(wb.a.fna,oc.a.view,h,1028)}static get instance(){return null!=fv.gZg?fv.gZg:fv.gZg=fv.Qm()}static Qm(){const b=Ya.a.instance;return new fv(()=>b.resolve("Box4.IUndoManager"),b.rf("Box4.ICoauthCashTelemetry"))}static get Ec(){return Yc.a.instance}}Object(u.a)(fv,"UndoActor",null,
[]);const RG={track:!0,$mb:!1},DC={["ApplyBulletsList"]:{$mb:!0},["ApplyNumberingList"]:{$mb:!0},["ToggleBulletsList"]:{$mb:!0},["ToggleNumberedList"]:{$mb:!0},["UnList"]:{$mb:!0},["SetFontColor"]:{$mb:!0},["SetFontSize"]:{$mb:!0}};var Aq=d(354);class qn{constructor(){this.W=null}get name(){return"Box4.Actors"}wc(b){this.W=b;(new PG).wc(b)}init(){var b=this.W.resolve("Box4.Actors.ClipboardActor");Object(kG.a)()&&this.W.resolve("Box4.Actors.PageColorActor").Wb();b.Wb();b.E8();uE();rt.instance.Wb(Object(Kw.a)()?
this.W.resolve("Box4.HighContrastColorPickerState"):null);yf.Wb();Km.Wb();Gl.Wb();this.W.resolve("Box4.Actors.TouchInputActor").Wb();ar.instance.Wb();this.W.resolve("Box4.ISelectAllHandlers").Wb();QG();this.W.resolve("Box4.Actors.ProofingActor").Wb();Wv.instance.Wb();(b=this.W.Oa("Box4.IFeatureHelper"))?b.Ds.continueWith(()=>{this.dBj()}):this.dBj();Sp.a.Wb($e.App.n0a);this.W.resolve("Box4.Actors.TextFormattingActor").Wb();fv.instance.Wb();this.W.resolve("Box4.Actors.AccessibilityActor").irg();this.W.resolve("Box4.IClipboardCommands");
this.W.resolve("Box4.Actors.PasteFloatieEventManager");Ua.StaticActiveAppFrame.za().Ie()}dBj(){this.W.resolve("Box4.Actors.StyleContextMenuActor").Wb();this.W.resolve("Box4.Actors.StyleActor").Wb()}dispose(){}static main(){A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.OtelActionsInteractivityTrackerIsEnabled",!1)&&(aa.a.hUi=b=>{if(b&&window.event){var h={...RG,...(DC[b]||{})};h.track&&(b=Object(Aq.b)(window.event,`OtelUserAction - ${b}`),A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.OtelActionsInteractivityTrackerWithContextIsEnabled",
!1)&&h.$mb&&(h=Ya.a.instance.Oa("Box4.IWordActionContextCapturer"))&&h.NOh(b))}});M.a.instance.Jc(new qn)}}Object(u.a)(qn,"Box4ActorsPackage",null,[0,1]);class Mu extends Ex{constructor(b,h,n,B){super(b);this.rsa=n;this.Hdb=B;this.xPg=0;this.vz=h.vYa("UserAction","WordOnlineAddToDictionary")}CBg(b){this.Y1d=this.rsa.Isa(b);if(!this.jol())return!1;const h=this.Y1d.errorDetails.token;this.Hdb.oPh(h);if(!this.Hdb.Erd(h))return x.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),
!1;x.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.vz.start();this.transaction=new Sd.GraphTransaction(15);this.transaction.Ab(b.node);return!0}rre(b){this.cYb(b.node);return!0}lid(b){this.cYb(b);return!0}sre(b){this.cYb(b.node)}WHg(b){this.transaction.dispose();this.Y1d.errorDetails.Vzb(b.actionId);this.Hdb.Zwg("unused corelation id.");this.vz.stop();x.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",
this.xPg,this.vz.Fi,this.Y1d.errorDetails.proofingType));return!0}wyc(b,h){const n=b.role;return super.wyc(b,h)||9===n||10===n||13===n||7===n||8===n}cYb(b){if(b){var h=this.rsa.u7(b,n=>this.Hdb.Erd(n.errorDetails.token));this.rsa.ixb(b,h,!0);this.xPg+=h.length}}jol(){var b,h;return null!==(h=null===(b=this.Y1d)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(x.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(u.a)(Mu,
"AddToDictionaryCallbackSteps",Ex,[]);class wE{constructor(b,h,n,B,L,ba,la){this.Sb=b;this.lb=h;this.pH=n;this.rsa=B;this.Pp=L;this.Hdb=ba;this.sio=la;this.ZTm=(La,fb,Cb,Lb,$b,tc)=>{const Nc=new Mu(this.pH,this.Pp,this.rsa,this.Hdb);return new $A(La,fb,Cb,Lb,$b,tc,Nc,this.Sb,this.lb,this.pH,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Wb(){this.Sb.wW(wb.a.YOh,oc.a.view,this.ZTm,1124);this.sio.Lvo(this.Hdb)}}Object(u.a)(wE,"PersonalDictionaryOrchestrator",null,[]);class Lz{get name(){return"Box4.PersonalDictionary"}wc(b){this.container=
b;b.register(wE,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").ha().Rd(()=>new wE(A.AFrameworkApplication.va,Zb.a.instance,Ay.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Wb()}dispose(){}static main(){ml.a.get_instance().Lk(7,()=>{M.a.instance.Jc(new Lz)})}}
Object(u.a)(Lz,"PersonalDictionaryPackage",null,[0,1]);var $n=d(111);class Xv{constructor(b,h,n,B,L,ba){this.TFa=this.rJ=null;this.cVc=(la,La,fb,Cb,Lb)=>this.s2i(La,fb,Lb,!1)?32:8;this.MJ=(la,La,fb,Cb,Lb)=>{if(!({Pz:la}=this.tSj(La,fb,Lb,!0)).returnValue)return la;x.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");Lb=this.tQk.sra(La.node,Lb);this.iao(La.node,Lb);this.NS();return 32};this.FLb=(la,La,fb,Cb,Lb)=>{if(!({Pz:la}=this.tSj(La,fb,Lb,!1)).returnValue)return la;
this.eao(La.node);return 32};this.zjo=(la,La,fb,Cb,Lb)=>{if(1===fb)return 32;if(!La||!La.view.te)return 2;la=La.view.lb;if(!la)return 2;la=la.Og;if(!la)return 2;la=Object(el.a)().oU(la,16);if(!la||!la.length)return 2;La=null;for(fb=0;fb<la.length;fb++){Cb=la.getContext(fb);if(!Cb||Cb.contextId!==oc.a.Sx)return 2;const $b={};this.UMi(Cb,$b);if($b.CellShading)if(La&&La!==$b.CellShading){La=null;break}else La=$b.CellShading;else{La=null;break}}Lb.CellShading=La;return 32};this.mYb=(la,La,fb,Cb,Lb)=>
1===fb?32:this.UMi(La,Lb);this.IXb=(la,La,fb,Cb,Lb)=>{if(1===fb)return 32;la=La.contextId===oc.a.view?this.lHa.Nkc(La):this.FMf(La);fb={};La=null;32===A.AFrameworkApplication.va.Pb(wb.a.mYb,2,fb)&&fb&&(La=fb.CellShading);fb="";La&&(fb=Nl.a.VC(La)||"");this.rRj.Ana=fb;this.iY.Mtd(fb);la=this.rRj.cPb(la,$e.App.W6a);if(!la)return 8;Lb.MenuItems=la;x.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.hca=(la,La,fb,Cb,Lb)=>{if(1===fb)return 32;Ua.StaticActiveAppFrame.za().dismissFloatie();
A.AFrameworkApplication.va.Pb(wb.a.mYb,2,Lb);this.TFa=new Tv("Shading",wb.a.Xwc);this.TFa.H0b(Lb&&Lb.CellShading?Lb.CellShading:0);return 32};this.Nml=(la,La,fb,Cb,Lb)=>{if(1===fb)return 32;A.AFrameworkApplication.va.Pb(wb.a.Hca,2,Lb);this.iY.W5a(Lb)||x.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.tQk=h;this.W0e=n;this.lHa=B;this.Wd=L;this.hr=ba}get iY(){return null!=this.u3g?this.u3g:this.u3g=Ya.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get rRj(){this.rJ||
(this.rJ=new Tr("Shading"),this.pta(this.rJ));return this.rJ}pta(b){b.PQ(2,wb.a.FLb);b.PQ(3,wb.a.Hca);b.PQ(4,wb.a.Hca);b.bmb(this.W0e,1)}Wb(){this.ga.ra(wb.a.IXb,oc.a.view,this.IXb);this.ga.ra(wb.a.IXb,oc.a.Sx,this.IXb);this.ga.Rc(wb.a.IXb,1126);this.ga.ra(wb.a.cVc,oc.a.view,Sp.a.M1c);this.ga.ra(wb.a.cVc,oc.a.Sx,this.cVc);this.ga.Rc(wb.a.cVc,1028);this.ga.ra(wb.a.Hca,oc.a.view,Sp.a.M1c);this.ga.ra(wb.a.Hca,oc.a.Sx,this.MJ);this.ga.Rc(wb.a.Hca,1028);this.ga.ra(wb.a.FLb,oc.a.view,Sp.a.M1c);this.ga.ra(wb.a.FLb,
oc.a.Sx,this.FLb);this.ga.Rc(wb.a.FLb,1028);this.ga.ra(wb.a.mYb,oc.a.view,this.zjo);this.ga.ra(wb.a.mYb,oc.a.Sx,this.mYb);this.ga.Rc(wb.a.mYb,1124);this.ga.ra(wb.a.Xwc,oc.a.view,Sp.a.M1c);this.ga.ra(wb.a.Xwc,oc.a.Sx,this.Nml);this.ga.Rc(wb.a.Xwc,1028);this.ga.ra(wb.a.mig,oc.a.view,this.hca);this.ga.Rc(wb.a.mig,1028)}NS(){A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");
b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}tSj(b,h,n,B){return this.s2i(b,h,n,B)?{returnValue:2===h,Pz:32}:(2==h&&Sp.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],hf.a.J5l),{returnValue:!1,Pz:8})}s2i(b,h,n,B){return b.contextId!==oc.a.Sx||2===h&&(B&&!n||!b.node)?!1:!0}iao(b,h){const n=new Sd.GraphTransaction(15);n.Ab(b);this.aQj(b);b.properties.setValue(Hf.a.MJ,h);n.dispose()}eao(b){const h=new Sd.GraphTransaction(15);
h.Ab(b);this.aQj(b);b.properties.removeProperty(Hf.a.MJ);h.dispose()}FMf(b){return b.contextId!==oc.a.Sx?null:(b=Object($n.a)().Iu(b.node))?b:null}aQj(b){if(this.Wd&&this.Wd.Mg&&(b=Object(ya.a)(im.TableCellNode,b))){const h=b.gY();this.hr.Jod(b,h)}}UMi(b,h){if(b.contextId!==oc.a.Sx)return 8;(b=b.node)&&b.hasProperty(Hf.a.MJ)&&(h.CellShading=b.getValue(Hf.a.MJ));return 32}static Kkm(){return new Xv(A.AFrameworkApplication.va,tp.a.instance,zy.a.instance,Gm.PageReader.instance,Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get instance(){return null!=Xv.B_g?Xv.B_g:Xv.B_g=Xv.Kkm()}}Object(u.a)(Xv,"CellShadingActor",null,[]);class SG{constructor(){this.W=null}get name(){return"Box4.CellShading"}wc(b){this.W=b}init(){const b=this.W.Oa("Box4.IFeatureHelper");b?b.Ds.continueWith(()=>{this.Mo()}):this.Mo()}Mo(){Xv.instance.Wb();Ua.StaticActiveAppFrame.za().Ie()}dispose(){}}Object(u.a)(SG,"CellShadingPackage",null,[0,1]);class Yv{constructor(){this.GUb=
new Rf.a(()=>this.$tf());this.Nba={}}Qsi(b){return b}}Object(u.a)(Yv,"AListMarkerGalleryLoader",null,[499]);class Pq{constructor(b,h){this.xD=this.Bbd=null;this.levelText=b;this.font=h}get gre(){return this.levelText}get listStyle(){return 6}get Fx(){return"left"}}Object(u.a)(Pq,"ListMarkerBullet",null,[498]);var Jx=d(1432),My=d(363);class eq extends Yv{constructor(){super();this.wFb=new mi.a(Qa.a.th())}Qsi(b){eq.KT||this.kRo();b in eq.KT&&(b=eq.KT[b]);return b}$tf(){const b={};b["0"]=new Pq(Box4Intl.Box4Strings.L_ListStyleNone,
Jx.a.CUi);b["1"]=new Pq(String.fromCharCode(61623),"Symbol");b["2"]=new Pq(String.fromCharCode(111),"Courier New");b["3"]=new Pq(String.fromCharCode(61607),"Wingdings");b["4"]=new Pq(String.fromCharCode(9643),"Courier New");b["5"]=new Pq(String.fromCharCode(61611),"Wingdings");b["6"]=new Pq(String.fromCharCode(61614),"Symbol");b["7"]=new Pq(String.fromCharCode(61483),"Symbol");b["8"]=new Pq(String.fromCharCode(61485),"Symbol");b["9"]=new Pq(String.fromCharCode(9830),"Courier New");b["10"]=new Pq(String.fromCharCode(61664),
"Symbol");b["11"]=new Pq(String.fromCharCode(61558),"Wingdings");b["12"]=new Pq(String.fromCharCode(61656),"Wingdings");b["13"]=new Pq(String.fromCharCode(61514),"Wingdings");b["14"]=new Pq(String.fromCharCode(61516),"Wingdings");b["15"]=new Pq(String.fromCharCode(61692),"Wingdings");b["16"]=new Pq(String.fromCharCode(61691),"Wingdings");b["17"]=new Pq(String.fromCharCode(61553),"Wingdings");return b}mFe(b){b&&b.length&&this.Dmf(b)}lmg(){if(this.Nba){var b=My.a(this.Nba),h=b.length;for(let n=0;n<
h;n++){const B=this.Nba[b[n]];this.wFb.add(B.levelText+"_"+B.font)}}}Dmf(b){this.lmg();for(const h of b)if(h&&!h.aC&&h.RBa&&h.X5c&&(b=h.levelText+"_"+h.font,!this.wFb.contains(b))){const n=My.a(this.Nba).length+My.a(this.GUb.value).length+"";this.Nba[n]=new Pq(h.levelText,h.font);this.wFb.add(b)}}kRo(){eq.KT={};eq.KT["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;eq.KT["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;eq.KT["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;
eq.KT["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;eq.KT["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;eq.KT["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;eq.KT["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;eq.KT["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;eq.KT["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;eq.KT["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;eq.KT["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;eq.KT["Wingdings 0x00d8"]=
Box4Intl.Box4Strings.L_3DRightwards;eq.KT["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;eq.KT["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;eq.KT["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;eq.KT["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;eq.KT["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}eq.KT=null;Object(u.a)(eq,"ListMarkerBulletLoader",Yv,[]);class yr{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(u.a)(yr,"InfoAtLevel",
null,[]);class Mw{constructor(b){this.xD=b}get font(){return"Calibri"}get listStyle(){return 42}get Fx(){return"left"}get gre(){return this.xD?this.vfo():this.xfo()}get Bbd(){return this.xD?this.wfo():null}get levelText(){return""}zsm(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}vfo(){let b="";for(let h=0;3>h;h++)b+=this.r4c(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Mw.TIf(),
b)}wfo(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new yr,{textAtLevel:this.gFi(h),styleAtLevel:this.ZLm(h)}));return b}xfo(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Mw.UIf(),Box4Intl.Box4Strings.L_ListStyleNone)}gFi(b){b=this.xD.Cbd[b];for(let h=0;9>h;h++)b=F.a.replaceAll(b,"%"+(h+1),this.zsm(this.xD.JUb[h]));return b}ZLm(b){const h={};h.fontFamily=6===this.xD.JUb[b]?this.xD.sKa[b]:this.font;return h}r4c(b){const h=this.gFi(b),n=new Sys.StringBuilder;
6===this.xD.JUb[b]&&n.append(String.format("font-family:{0};",this.xD.sKa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',b,n.toString(),h)}static TIf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");
return b}static UIf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(u.a)(Mw,"ListMarkerMultilevel",null,[498]);var EC=d(1449);class Ny extends Yv{constructor(){super()}$tf(){const b=new EC.a,h={};h["0"]=new Mw(null);h["1"]=new Mw(b.stf());h["2"]=new Mw(b.muf("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),[1,2,3,1,2,3,1,2,3]));h["3"]=new Mw(b.H9h([61558,61656,61607,61623,9830,61656,61607,61623,9830],
"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}mFe(){}}Object(u.a)(Ny,"ListMarkerMultilevelLoader",Yv,[]);var wp=d(159);class Qo{constructor(b,h){this.xD=null;this.levelText=b;this.AGd=h}get font(){return"Calibri"}get listStyle(){return this.AGd}get Fx(){switch(this.AGd){case 3:case 5:return"right";default:return"left"}}get gre(){switch(this.AGd){case 1:return this.tuc("1","2","3");case 2:return this.tuc("a","b","c");case 3:return this.tuc("i",
"ii","iii");case 4:return this.tuc("A","B","C");case 5:return this.tuc("I","II","III");case 0:return this.yfo();default:return this.tuc("1","2","3")}}get Bbd(){const b=[],h={};h.fontFamily=wp.FontUtils.$za(this.font);switch(this.AGd){case 1:return b.push(Object.assign(new yr,{textAtLevel:this.R_("1"),styleAtLevel:h})),b.push(Object.assign(new yr,{textAtLevel:this.R_("2"),styleAtLevel:h})),b.push(Object.assign(new yr,{textAtLevel:this.R_("3"),styleAtLevel:h})),b;case 2:return b.push(Object.assign(new yr,
{textAtLevel:this.R_("a"),styleAtLevel:h})),b.push(Object.assign(new yr,{textAtLevel:this.R_("b"),styleAtLevel:h})),b.push(Object.assign(new yr,{textAtLevel:this.R_("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new yr,{textAtLevel:this.R_("i"),styleAtLevel:h})),b.push(Object.assign(new yr,{textAtLevel:this.R_("ii"),styleAtLevel:h})),b.push(Object.assign(new yr,{textAtLevel:this.R_("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new yr,{textAtLevel:this.R_("A"),styleAtLevel:h})),
b.push(Object.assign(new yr,{textAtLevel:this.R_("B"),styleAtLevel:h})),b.push(Object.assign(new yr,{textAtLevel:this.R_("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new yr,{textAtLevel:this.R_("I"),styleAtLevel:h})),b.push(Object.assign(new yr,{textAtLevel:this.R_("II"),styleAtLevel:h})),b.push(Object.assign(new yr,{textAtLevel:this.R_("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new yr,{textAtLevel:this.R_("1"),styleAtLevel:h})),b.push(Object.assign(new yr,
{textAtLevel:this.R_("2"),styleAtLevel:h})),b.push(Object.assign(new yr,{textAtLevel:this.R_("3"),styleAtLevel:h})),b}}tuc(b,h,n){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',Qo.TIf(),this.r4c(b),this.r4c(h),this.r4c(n))}yfo(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Qo.UIf(),Box4Intl.Box4Strings.L_ListStyleNone)}r4c(b){b=this.R_(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}R_(b){return F.a.replaceAll(this.levelText,"%1",b)}static TIf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static UIf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(u.a)(Qo,"ListMarkerNumbering",null,[498]);class xE extends Yv{constructor(){super();this.wFb=new mi.a(Qa.a.th())}lrn(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}$tf(){const b=
{};b["0"]=new Qo(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new Qo("%1.",5);b["2"]=new Qo("%1.",4);b["3"]=new Qo("%1.",1);b["4"]=new Qo("%1.",2);b["5"]=new Qo("%1.",3);b["6"]=new Qo("%1)",5);b["7"]=new Qo("%1)",4);b["8"]=new Qo("%1)",1);b["9"]=new Qo("%1)",2);b["10"]=new Qo("%1)",3);b["11"]=new Qo("(%1)",5);b["12"]=new Qo("(%1)",4);b["13"]=new Qo("(%1)",1);b["14"]=new Qo("(%1)",2);b["15"]=new Qo("(%1)",3);return b}mFe(b){b&&b.length&&this.Dmf(b)}lmg(){if(this.Nba){var b=My.a(this.Nba),h=b.length;
for(let n=0;n<h;n++){const B=this.Nba[b[n]];this.wFb.add(B.levelText+"_"+B.listStyle)}}}Dmf(b){this.lmg();for(const h of b)if(h&&h.aC&&h.RBa&&this.lrn(h.levelText)&&h.listStyle&&(b=Jx.a.iGf(h.levelText))){const n=b+"_"+h.listStyle;if(!this.wFb.contains(n)){const B=My.a(this.Nba).length+My.a(this.GUb.value).length+"";this.Nba[B]=new Qo(b,h.listStyle)}this.wFb.add(n)}}}Object(u.a)(xE,"ListMarkerNumberingLoader",Yv,[]);class iu{static get Pwn(){return iu.pGd}static zDl(b,h,n){try{iu.pGd=iu.FHl(b,h,n)}catch(B){iu.pGd=
null,x.ULS.$w(539787540,393,10,B,"Error in creating autoTriggerTextContext: {0}",B instanceof Error?B.message:"Unknown Error")}}static uGj(){iu.pGd=null}static FHl(b,h,n){if(!Gf.ListItemReader.Hg(h))throw x.ULS.sendTraceTag(539787541,393,10,"Given iterator should be at a ListOutlineElement"),Error("Given iterator should be at a ListOutlineElement");const B=Gf.ListItemReader.y7(h);if(null===B||void 0===B||!B.id)throw x.ULS.sendTraceTag(539787542,393,10,"No list item node with id found under outline element"),
Error("No list item node with id found under outline element");h=n.Nw(h);if(!h)throw x.ULS.sendTraceTag(539787543,393,10,"No listInfo found for given iterator"),Error("No listInfo found for given iterator");return new iu(b,B.id,h)}constructor(b,h,n){this.$2j=b;this.Bzn=h;this.Wrg={listType:n.listType,listStyle:n.listStyle,jie:n.Sw}}xpn(b,h){return h&&b&&this.Bzn===b.id&&h.listType===this.Wrg.listType&&h.listStyle===this.Wrg.listStyle&&h.Sw===this.Wrg.jie}}iu.pGd=null;Object(u.a)(iu,"AutoTriggerTextContext",
null,[]);var st;(function(b){b[b.none=0]="none";b[b.Xdp=1]="style1";b[b.Ydp=2]="style2";b[b.Zdp=3]="style3";b[b.$dp=4]="style4";b[b.aep=5]="style5";b[b.iec=6]="bullet";b[b.invalid=42]="invalid"})(st||(st={}));Object(u.b)("ListStyle",st);const yE={[st.Xdp]:{[1]:"disc",[0]:"decimal"},[st.Ydp]:{[1]:"circle",[0]:"lower-alpha"},[st.Zdp]:{[1]:"square",[0]:"lower-roman"},[st.$dp]:{[0]:"upper-alpha"},[st.aep]:{[0]:"upper-roman"},[st.iec]:{[1]:"bullet"}};var Oy;(function(b){b[b.number=0]="number";b[b.iec=
1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.Kcq=16]="noList";b[b.invalid=42]="invalid"})(Oy||(Oy={}));Object(u.b)("ListType",Oy);class fj{static get rm(){return null!=fj.a1g?fj.a1g:fj.a1g=Ya.a.instance.resolve("Box4.List.IListEditor")}static get Nd(){return fj.ig||(fj.ig=Ya.a.instance.resolve("Box4.List.IListReader"))}static set Nd(b){fj.ig=b}static get rk(){return null!=fj.bZg?fj.bZg:fj.bZg=Ya.a.instance.resolve("Box4.IInsertionPointFormatting")}static wy(){return fj.Xn||
(fj.Xn=Ya.a.instance.Qa("Box4.IExternalSelectionManager"))}static get mg(){return Pd.a.instance}static get Ec(){return Yc.a.instance}static get Xr(){return hl.a.getInstance()}static get fqd(){return null!=fj.l4g?fj.l4g:fj.l4g=Ya.a.instance.Oa("Box4.List.ISingleLevelListEditor")}static Wb(){const b=A.AFrameworkApplication.va;b.ra(wb.a.WE,oc.a.view,fj.pTc);b.ra(wb.a.WE,oc.a.jS,fj.Tqa);b.Rc(wb.a.WE,1036);b.ra(wb.a.XN,oc.a.view,fj.pTc);b.ra(wb.a.XN,oc.a.jS,fj.Tqa);b.Rc(wb.a.XN,1036);b.ra(wb.a.Ega,oc.a.view,
fj.pTc);b.ra(wb.a.Ega,oc.a.jS,fj.Tqa);b.Rc(wb.a.Ega,1036);b.ra(wb.a.$if,oc.a.view,Ce.ActionManager.Zf);b.ra(wb.a.l3h,oc.a.view,Ce.ActionManager.Zf);b.ra(wb.a.q2f,oc.a.view,fj.gFo);b.ra(wb.a.Jif,oc.a.view,Ce.ActionManager.Zf);b.ra(wb.a.ajf,oc.a.view,Ce.ActionManager.Zf);b.ra(wb.a.YGg,oc.a.view,Ce.ActionManager.Zf);b.ra(wb.a.KZj,oc.a.view,Ce.ActionManager.Zf);b.ra(wb.a.xEe,oc.a.view,Ce.ActionManager.Zf)}static gFo(){iu.uGj();return 32}static pTc(b,h,n,B,L){var ba,la,La;if(!h.view.te)return 2;const fb=
fj.Ec.rq(wb.a.pTc);B.Gt=42;B.lE=42;const Cb={[Ks.a.RPa]:5796,[Ks.a.QPa]:5797};var Lb=h.view;if(Object(el.a)().lJa(fj.S2m,Lb.lb.Og))return fj.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.Prf}),fb.end(),8;if(Object(el.a)().lJa(fj.bif,Lb.lb.Og))return fj.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.HWc}),fb.end(),8;if(Object(el.a)().pFa(ea.ParagraphReader.BX,Lb.lb.Og))return fj.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.WQ}),fb.end(),8;if(fj.mg.Tnc(Lb.lb.Og))return fj.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.HG}),fb.end(),8;if(null===(la=null===(ba=
fj.wy())||void 0===ba?void 0:ba.instance)||void 0===la?0:la.DX(h))return fj.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.t8a}),fb.end(),8;if(1===n)return fb.end(),32;L||(L=new Og.DictionaryPropertySet);ba=null;if(2===n){ba=new Sd.GraphTransaction(15);ba.Ab(h.view.jd);fj.gad=!1;la=Hy.OutlineElementGeneralizer.Wka(Lb.lb.gb,!1);if(!la)return ba.dispose(),fj.Ec.$b(Tf.a.usa,{["Reason"]:hf.a.I2d}),fb.end(),8;1<la.length&&L.setValue(zd.a.ogj,null);const $b=L.ja(zd.a.UL,-1),tc=L.ja(zd.a.cC,-1);null===(La=fj.fqd)||void 0===
La?void 0:La.Opl(la);if(La=fj.b1o($b,tc,la))L.setValue(zd.a.cC,16),L.setValue(zd.a.jYa,0);if(!re.SelectionEditor.mf(Lb.lb.Og)&&!La&&0<la.length&&$b){Lb=new ve.GraphIterator;La=Array(la.length);for(let Nc=0;Nc<la.length;Nc++)Lb.set(la.getContext(Nc).node),La[Nc]=fj.Nd.Nw(Lb);fj.a1o(La,L)&&(Lb=new Og.DictionaryPropertySet,Lb.setValue(zd.a.cC,16),Lb.setValue(zd.a.jYa,0),Lb.setValue(hi.a.jua,"clean-list-before-apply-new-list-style"),Lb.setValue(hi.a.nma,L.ja(hi.a.jua,"unknown")+"@"+L.ja(hi.a.nma,"undefined")),
Ks.a.Tua(b,h,n,B,Lb,Cb,11),A.AFrameworkApplication.va.Ob(wb.a.KZj,2),x.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),fj.gad=!0)}Lb=new ve.GraphIterator;Lb.set(la.getContext(0).node);Lb=fj.Nd.Nw(Lb);fj.YDn($b,tc,Lb,la.length)}b=Ks.a.Tua(b,h,n,B,L,Cb,11);32===b&&L.ja(zd.a.PVh,!1)&&(b=Ks.a.Tua(wb.a.fR,h,n,B,L,Cb,11));ba&&ba.dispose();fb.end();return b}static a1o(b,h){let n=null;var B=!1;for(let L=b.length-1;0<=L&&(n?(B=b[L],B=-1!==h.ja(zd.a.UL,-3)?B?n.listType!==
B.listType||n.listStyle!==B.listStyle:!0:B?n.listType!==B.listType:!0):n=b[L],!B);L--);return n&&(b=!1,B||(b=h.ja(zd.a.cC,42),h=h.ja(zd.a.UL,-3),b=b!==n.listType||0<h),B||b)?!0:!1}static YDn(b,h,n,B){0>=B||fj.gad||(b?n?(n=n.listType,-1===b&&h===n?(A.AFrameworkApplication.va.Ob(wb.a.xEe,2),x.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<b&&(!h||1===h)&&(A.AFrameworkApplication.va.Ob(h?wb.a.Jif:wb.a.ajf,2),x.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",
h?"Bullet":"Numbering"))):(A.AFrameworkApplication.va.Ob(h?wb.a.Jif:wb.a.ajf,2),fj.Pnp(),x.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering")):(A.AFrameworkApplication.va.Ob(wb.a.xEe,2),x.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static b1o(b,h,n){if(-1!==b&&b||!n.length)return!1;b=new ve.GraphIterator;let B=null;for(let L=n.length-1;0<=L&&!(b.set(n.getContext(L).node),B=fj.Nd.Nw(b));L--);return B&&h===B.listType?
!0:!1}static Tqa(b,h,n,B,L){var ba;if(h.contextId!==oc.a.jS)return 2;var la=h.clone().UEg();if(fj.mg.xab(la))return fj.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.HG}),2;var La=new ve.GraphIterator;La.set(h.node);re.SelectionEditor.rv(La);if(!xb.OutlineElementReader.Mh(La))return 2;if(1===n)switch(b){case wb.a.WE:return 32;case wb.a.XN:return 32;case wb.a.Ega:return 32;default:return 2}if(xb.OutlineElementReader.ZT(La))return fj.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.WQ}),2;h=fj.Nd.Nw(La);const fb=Object.freeze(null===
h||void 0===h?void 0:h.clone());let Cb=L;if(!Cb)return 8;b===wb.a.XN||b===wb.a.WE||b===wb.a.Ega?(Cb=fj.rm.J_c(b,Cb),la=ms.a.s_(Cb.getValue(zd.a.cC),Cb.getValue(zd.a.jYa))):la=null;fj.Q3(b,Cb);fj.oVo(la,Cb);let Lb=!1;b===wb.a.WE&&Cb&&(Cb.hasProperty(Lc.a.Tw)&&(la.levelText=Cb.ja(Lc.a.Tw,"")),Cb.hasProperty(Hf.a.font)&&(la.font=Cb.ja(Hf.a.font,"")),Cb.hasProperty(zd.a.tFf)&&(Lb=Cb.ja(zd.a.tFf,!1)));fj.cXo(Cb,La);la=fj.rm.Tqa(Cb,La,la,Lb);if(!la.returnValue)return fj.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.v4f}),
2;la=la.cCa;fj.dqo(La,L,fb,la);2===n&&(n=L.ja(zd.a.cC,-1),la&&-1!==n&&((La=L.ja(Lc.a.gt,"Invalid MultiLevel Type"),b===wb.a.XN&&x.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===L||void 0===L?void 0:L.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:st[null==(null===h||void 0===h?void 0:h.listStyle)?null===la||void 0===la?void 0:la.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:Oy[null==(null===
h||void 0===h?void 0:h.listType)?null===la||void 0===la?void 0:la.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===la||void 0===la?void 0:la.listType)})),h)?la.listType&&1!==la.listType||fj.gad||(A.AFrameworkApplication.va.Ob(wb.a.YGg,2),x.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",n?"Bullet":"Numbering",La)):16===la.listType?(A.AFrameworkApplication.va.Ob(wb.a.l3h,2),x.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",
n?"Bullet":"Numbering",La)):la.listType&&1!==la.listType||fj.gad||(A.AFrameworkApplication.va.Ob(wb.a.$if,2),x.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",n?"Bullet":"Numbering",La))),b=Ph.FocusManager.instance(),(null===(ba=null===b||void 0===b?void 0:b.currentScope)||void 0===ba?void 0:ba.name)===Mk.a.tva&&b.ME(Dd.AFrame.Ho));B.Gt=la.listType;B.lE=la.listStyle;return 32}static dqo(b,h,n,B){var L,ba,la,La,fb,Cb,Lb,$b;const tc=new Map;tc.set("actionCallSource",h.ja(hi.a.jua,
"unknown"));tc.set("actionCallSourceTrigger",h.ja(hi.a.nma,"undefined"));tc.set("fromListType",Oy[null!==(L=null===n||void 0===n?void 0:n.listType)&&void 0!==L?L:16]);tc.set("fromListStyle",st[null!==(ba=null===n||void 0===n?void 0:n.listStyle)&&void 0!==ba?ba:0]);tc.set("fromListMarkerType",null!==(fb=l(null!==(la=null===n||void 0===n?void 0:n.listStyle)&&void 0!==la?la:0,null!==(La=null===n||void 0===n?void 0:n.listType)&&void 0!==La?La:16))&&void 0!==fb?fb:"undefined");tc.set("fromLevelText",(null===
n||void 0===n?0:n.RBa)?n.levelText:"undefined");tc.set("toListType",null!==(Cb=Oy[null===B||void 0===B?void 0:B.listType])&&void 0!==Cb?Cb:"undefined");tc.set("toListStyle",null!==(Lb=st[null===B||void 0===B?void 0:B.listStyle])&&void 0!==Lb?Lb:"undefined");tc.set("toListMarkerType",null!==($b=l(null===B||void 0===B?void 0:B.listStyle,null===B||void 0===B?void 0:B.listType))&&void 0!==$b?$b:"undefined");tc.set("toLevelText",(null===B||void 0===B?0:B.RBa)?B.levelText:"undefined");hl.a.vpn&&tc.set("underHeaderFooterKind",
this.Nd.Ezi(b.currentNode));oa.Health.instance.recordKpiUsage(Uk.a.Ztb.Kzn,0,Uk.a.bD,tc)}static cXo(b,h){var n=new ve.GraphIterator;n.hd(h);(h=n.Ub(2))&&ea.ParagraphReader.Xb(h)&&(n=Zb.a.instance.gb.currentSelection)&&n.Ra&&n.Ra.node===h&&re.SelectionEditor.hge(n)&&(fj.CTo(b),fj.ATo(b))}static oVo(b,h){h.hasProperty(Lc.a.gt)&&b.cye(h.getValue(Lc.a.gt));h.hasProperty(hi.a.JT)&&(b.JT=h.getValue(hi.a.JT));h.hasProperty(Lc.a.Tw)&&(b.levelText=h.getValue(Lc.a.Tw));b.UL=h.ja(zd.a.UL,-1);let n=null;b.Wta&&
(n=fj.xym(b,h));b.Wta&&n?fj.XWo(b,n):(b.Wta?x.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",b.UL,b.gt,b.aC):x.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),fj.nSo(b))}static nSo(b){if(b.aC)b.pae&&-1===b.UL||(b.levelText="%1.",b.qf.hasProperty(Hf.a.g8)||b.Kca(0,1));else if(1===b.listType)b.pae&&-1===b.UL||(b.font=Uk.a.EYc,b.levelText=Uk.a.XZd,b.qf.hasProperty(Hf.a.g8)||
b.Kca(1,6));else return;b.Fx="left"}static XWo(b,h){1===b.gt?fj.JVo(b,h):fj.aUo(b,h)}static JVo(b,h){(b.xD=h.xD)?b.r9=h.xD.r9:h.xD||x.ULS.sendTraceTag(588022422,393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",b.UL,b.gt,b.aC)}static aUo(b,h){b.levelText=h.levelText;b.aC?b.Kca(0,h.listStyle):(b.font=h.font,b.Kca(1,1));b.Fx=h.Fx}static xym(b,h){let n=null;2===b.gt?n=b.aC?Ya.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):
Ya.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.gt&&(n=Ya.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let B=n.GUb.value;const L=b.UL+"";L in B||(B=n.Nba,x.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",L,b.gt,b.aC));if(!(L in B)){x.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",
L,b.gt,b.aC);if(h.hasProperty(Hf.a.font))return x.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",L,b.gt,b.aC),b=h.ja(Hf.a.font,""),new Pq(F.a.fromCharCode(parseInt(L)),b);x.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",L,b.gt,b.aC)}return B[L]}static ATo(b){fj.rk.hasProperty(Hf.a.fontColor)&&b.setValue(Hf.a.fontColor,fj.rk.fontColor())}static CTo(b){fj.rk.hasProperty(Hf.a.fontSize)&&
b.setValue(Hf.a.fontSize,fj.rk.fontSize())}static Q3(b,h){b=b===wb.a.WE?0:b===wb.a.XN?1:b===wb.a.Ega?2:-1;h=h.ja(zd.a.UL,-1);x.ULS.sendTraceTag(22923024,324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static Pnp(){const b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");if(b){var h=A.AFrameworkApplication.K.ic("WordDefaultToEditFloodgateDelayInMilliseconds",6E4);b.execute(n=>{window.setTimeout(()=>{n.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else x.ULS.sendTraceTag(554796489,
301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}fj.S2m=Ad.ImageReader.J9c;fj.bif=Ad.ImageReader.M$a;fj.ig=null;fj.Xn=null;fj.gad=!1;Object(u.a)(fj,"ListActor",null,[]);class FC{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){fj.Wb()}dispose(){}wc(b){this.W=b;this.W.ia("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new eq).ha();this.W.ia("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new xE).ha();this.W.ia("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",
()=>new Ny).ha()}static main(){M.a.instance.Jc(new FC)}}Object(u.a)(FC,"Box4ListMarkerPackage",null,[0,1]);class op{static get kh(){return Ge.a.az(op.Mn,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,"")}}op.Mn="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(u.a)(op,"DefineNewBulletDialogHtml",null,[]);class Ur extends Ge.a{constructor(b,h,n,B){super();this.RKc=this.d0e=this.R8b=this.J8b=null;this.iGb=0;this.KTc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.TRi=!0;this.aPl=L=>{if(this.J8b&&L.target!==this.J8b){const ba=this.focusManager.gu();ba&&ba.Mk&&(ba.Mk.mA(L.target),this.J8b=L.target)}this.u2n(L.target.id)};this.xzn=L=>{L=L.Nf;if(!this.j4i(L))return!1;this.focusManager.gu().Mk.mA(L);L.focus();return!0};this.yzn=L=>{var ba=
L.Nf;if(!this.j4i(ba))return!1;var la=ba.id;la=parseInt(la.substr(la.lastIndexOf("_")+1))-this.iGb;if(L.Kb.ctrlKey||L.Kb.altKey||L.Kb.keyCode>=Jd.a.S3b&&L.Kb.keyCode<=Jd.a.T3b)return!1;const La=L.Kb.keyCode;if(L.eventName===Cd.a.Ti){L=-1;if(La===Sys.UI.Key.enter)return this.focusManager.gu().Mk.mA(ba),ba.focus(),this.Alj(ba.id),this.hide(),!0;La===Sys.UI.Key.up?L=la-17:La===Sys.UI.Key.down?L=la+17:La===Sys.UI.Key.left?L=A.AFrameworkApplication.isRtl?la+1:la-1:La===Sys.UI.Key.right&&(L=A.AFrameworkApplication.isRtl?
la-1:la+1);0<=L&&(ba=this.KBi(Ur.Mgc+"_"+(L+this.iGb)))&&ba.focus()}return!0};this.$Ol=L=>{1===L&&this.Alj(this.R8b);this.hide()};this.xv=b;this.focusManager=h;this.ga=n;this.UV=!1;B&&(b=B.indexOf(","),-1!==b&&(B=B.substring(0,b)));this.fontName=B;this.Qg="DefineNewBulletDialog";this.kh=op.kh;this.Pe(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Pe(0,CommonUIStrings.l_DialogClose);this.pi(Box4Intl.Box4Strings.L_SymbolSingle,this.$Ol,null);this.Lda=!1;this.HNa();document.getElementById(Ur.p4d).focus()}HNa(){this.focusManager.gu().scope.tt(Ph.FocusManager.instance().MZ);
this.focusManager.gu().scope.tt(Ph.FocusManager.instance().NZ);this.focusManager.gu().scope.bindAction(Ph.FocusManager.instance().MZ,wb.a.i_d);this.focusManager.gu().scope.bindAction(Ph.FocusManager.instance().NZ,wb.a.h_d)}Zba(){this.lUd(Ur.p4d,"DefineNewBulletFontPlaceholder",wb.a.g_d.toString(),wb.a.qYb.toString(),wb.a.Ghd.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.Ffl()}WN(){super.WN();document.getElementById(this.Sj("WACDialogPanel")).style.width="auto"}lUd(b,h,n,B,L,ba,la){n=cl.c(b,
n,!0,!0,B,L,F.a.Hf(ba),!0,la);this.IYd(b,h,n,"Medium")}Ffl(){const b=document.getElementById(Ur.Mgc);b&&(b.innerHTML=this.mxi(),this.OAj(b))}OAj(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)Nb.a.addHandler(b[h],Cd.a.focus,this.aPl)}$vp(){var b=document.getElementById(Ur.Mgc);if(b){let h=this.fontName;const n=Jx.a.BXf(this.fontName);n&&61472!==this.iGb||!n&&32!==this.iGb?(b.innerHTML=this.mxi(),this.OAj(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&
h&&(h=this.tOh(h),b[0].style.fontFamily=h)}}u2n(b){this.MOj(this.R8b,!1);this.R8b=b;this.MOj(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.R8b){let h=parseInt(this.R8b.substr(this.R8b.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.iGb?61440:0,b.innerText=F.a.PJ(h,4))}}MOj(b,h){(b=this.KBi(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}KBi(b){const h=document.getElementById(Ur.Mgc);return h?h.querySelector("#"+b):null}cra(){const b=document.getElementById(Ur.Mgc);
b&&(this.d0e||(this.d0e=this.xzn,this.Cr.nb(Cd.a.click,b,this.d0e)),this.RKc||(this.RKc=this.yzn,this.ne.nb(Cd.a.Ti,b,this.RKc),this.ne.nb(Cd.a.jv,b,this.RKc),this.ne.nb(Cd.a.oi,b,this.RKc)));super.cra()}j4i(b){return b.classList.contains("DefineNewBulletTableCell")}Alj(b){if(b){b=b.split("_");const h=new Og.DictionaryPropertySet;h.setValue(zd.a.UL,parseInt(b[1]));h.setValue(Hf.a.font,this.fontName);h.setValue(zd.a.cC,1);h.setValue(hi.a.jua,"command-ui");h.setValue(hi.a.nma,"define-new-bullet-dialog");
this.ga.Pb(wb.a.WE,2,h)}this.focusManager.NN(this.kN,!0)}mxi(){const b=new Sys.StringBuilder,h=Jx.a.BXf(this.fontName);let n=this.fontName;n=this.tOh(n);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',n));h?(this.iGb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.iGb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}tOh(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}IYd(b,h,n,B){h=document.getElementById(h);this.xv.S5a(b,n);n=this.xv.CPb(b,B);h.appendChild(n);this.xv.Yua(b)}dispose(){this.UV||(this.xv.R0(Ur.p4d),this.UV=!0);super.dispose()}}Ur.p4d="DefineNewBulletFontStyleComboBox";Ur.Mgc="DefineNewBulletTableContainer";Object(u.a)(Ur,"DefineNewBulletDialog",Ge.a,[]);class fq{N3c(){return wb.a.szn}q4c(){return wb.a.Dlg}}Object(u.a)(fq,"ListMarkerGalleryBulletCommands",
null,[643]);class Py{N3c(){return wb.a.uzn}q4c(){return wb.a.tco}}Object(u.a)(Py,"ListMarkerGalleryMultilevelCommands",null,[643]);class gB{N3c(){return wb.a.vzn}q4c(){return wb.a.Elg}}Object(u.a)(gB,"ListMarkerGalleryNumberingCommands",null,[643]);class Qy{constructor(b,h,n,B,L){this.gGa=this.fSa=null;this.hei=ba=>{if(!this.gGa)return 2;if(this.gGa.focusManager.gu().Mk.Ora.id.startsWith(Ur.Mgc)){let la=null;ba===wb.a.i_d?la=this.gGa.x6a:ba===wb.a.h_d&&(la=document.getElementById(Ur.p4d));if(!la)return 2;
this.gGa.focusManager.gu().Mk.mA(la);la.focus()}else if(ba===wb.a.i_d)this.gGa.focusManager.gu().Mrc();else if(ba===wb.a.h_d)this.gGa.focusManager.gu().Krc();else return 2;return 32};this.u7i=(ba,la)=>{ba=null;la.view.te&&(ba=la.view);return ba&&ba.lb?32:(Vc.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",la.toString()),8)};this.dxn=(ba,la,La)=>1===La?32:2===La?(ba=this.flc(la),ba=Va.FormattingReader.Cs(ba).cache.mI,
this.gGa=new Ur(this.EOk,Ph.FocusManager.instance(),A.AFrameworkApplication.va,ba),32):8;this.Ghd=(ba,la,La,fb,Cb)=>{if(1===La)return 32;if(2===La&&!Cb)return 8;if(this.gGa.TRi){for(ba=0;ba<Jx.a.KTc.length;ba++)wp.FontUtils.A4j(Jx.a.KTc[ba]);this.gGa.TRi=!1}Qn.a.Ybe(la);Cb.PopulationXML=wp.FontUtils.vsi(Qn.a.yze,Qn.a.HFf,wb.a.g_d);return 32};this.sco=(ba,la,La,fb,Cb)=>{ba=la.contextId===oc.a.jS;if(1===La||!ba)return ba?32:8;if(2===La&&!Cb)return 8;Cb.MenuItems=this.KDk.Bym();return 32};this.ZOl=(ba,
la,La,fb,Cb)=>{if(1===La)return 32;if(2===La){ba=Object(ya.a)(267,Cb);if(!ba||!ba.rd)return 8;this.gGa.fontName=ba.rd.fontName;this.gGa.$vp();return 32}return 8};this.ga=b;this.ig=B.resolve("Box4.List.IListReader");this.r$=h;this.EOk=n;switch(this.r$){case 0:b=B.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.fSa=new fq;break;case 1:b=B.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.fSa=new gB;break;case 2:b=B.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");
this.fSa=new Py;break;default:b=B.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),this.fSa=new fq}L=this.ig?this.ig.nym(L):null;b.mFe(L);this.KDk=new Jx.a(h,b,L,!!A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.BTb)}Wb(){this.ga.ra(this.fSa.q4c(),oc.a.view,$e.App.n0a.b$h(11));this.ga.ra(this.fSa.q4c(),oc.a.jS,this.sco);this.ga.Rc(this.fSa.q4c(),1124);this.r$||(this.ga.fb(wb.a.u3f,oc.a.view,this.dxn,1028),this.ga.fb(wb.a.Ghd,oc.a.view,this.Ghd,1124),this.ga.fb(wb.a.g_d,oc.a.view,
this.ZOl,1028),this.ga.fb(wb.a.i_d,id.a.frame,this.hei,64),this.ga.fb(wb.a.h_d,id.a.frame,this.hei,64));this.ga.ra(this.fSa.N3c(),oc.a.view,this.u7i);this.ga.ra(this.fSa.N3c(),oc.a.jS,this.u7i);this.ga.Rc(this.fSa.N3c(),1124)}flc(b){return this.N5d(b).Ra}N5d(b){let h=null;b=b.view;return b?h=re.SelectionEditor.Wj(b.lb.gb.J(0),!1,!1):h}}Object(u.a)(Qy,"ListMarkerGalleryActor",null,[471]);class GC{constructor(){this.Qf=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(Object(Pb.a)()){var b=
Object(Pb.a)();b.Ke&&(this.Qf=b.Ke.jd,this.Cuo())}}dispose(){}wc(b){this.W=b}Cuo(){(new Qy(A.AFrameworkApplication.va,1,this.W.resolve("Common.IStandaloneRootController").Bha,this.W,this.Qf)).Wb();(new Qy(A.AFrameworkApplication.va,0,this.W.resolve("Common.IStandaloneRootController").Bha,this.W,this.Qf)).Wb();(new Qy(A.AFrameworkApplication.va,2,this.W.resolve("Common.IStandaloneRootController").Bha,this.W,this.Qf)).Wb()}static main(){M.a.instance.Jc(new GC)}}Object(u.a)(GC,"Box4ListMarkerGalleryPackage",
null,[0,1]);var Zv=d(461),Vr=d(527),$v=d(488),gq=d(141);const oh=b=>{b.element.style.top=""};var Mz=d(770);class Nz{constructor(b,h,n){this.GJ=!1;this.Hhb=0;this.ria=this.ryh=null;this.hUn=B=>{B.element.style.top="";A.AFrameworkApplication.ua.zed()};this.$Tn=B=>{B.element.parentNode.removeChild(B.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);A.AFrameworkApplication.ua.zed()};this.Pv=()=>{const B=this.St.entries.length,L=Sys.UI.DomElement.getBounds(this.htmlElement).height;let ba;
for(let la=0;la<B;++la)ba=this.St.entries[la],ba.htmlElement&&ba.IGj();this.Hhb=Sys.UI.DomElement.getBounds(this.htmlElement).height;L!==this.Hhb&&this.z2b()};this.nJa=()=>!0;this.El=b;this.KPk=h;this.St=n;this.j$=b.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.Zx=!!A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.q0)&&!this.St.zyf&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";X.a.uj&&Sys.UI.DomElement.addCssClass(this.htmlElement,
"FireFox")}get htmlElement(){return this.j$}get visible(){return this.GJ}set_visible(b){if(this.GJ!==b)return(this.GJ=b)?this.akf():this.ZYc(),b}dispose(){this.visible&&this.ZYc();Lh.a.PT(this.htmlElement);this.El=this.j$=null}dUj(b,h){const n=b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(n):this.htmlElement.insertBefore(n,this.htmlElement.childNodes[h]);b.IGj();this.Hhb+=b.htmlElement.clientHeight;var B=this.htmlElement.childNodes,L=b.QRh,ba=
this.hUn;gq.WacAirSpace.sY(n,"Shared_BasicClass");var la=new $v.a(n);la.oza(0,1);const La=new Vr.a(n);La.sIa(n.clientTop-30,n.clientTop);L?(gq.WacAirSpace.Wub(la,null,null),gq.WacAirSpace.Wub(La,null,ba)):(gq.WacAirSpace.animate(la,null,null),gq.WacAirSpace.animate(La,null,ba));for(h+=1;h<B.length;h++)ba=B[h],gq.WacAirSpace.sY(ba,"Shared_BasicClass"),la=new Vr.a(ba),la.sIa(ba.clientTop-n.clientHeight,ba.clientTop),L?gq.WacAirSpace.Wub(la,null,null):gq.WacAirSpace.animate(la,null,null);b.j6o();this.set_visible(!0)}ZOi(b){const h=
b.htmlElement;if(Lh.a.woc(h)){this.Hhb-=b.htmlElement.clientHeight;var n=h.parentNode.children;b=b.QRh;var B=this.$Tn;gq.WacAirSpace.sY(h,"Shared_BasicClass");var L=new Zv.a(h);L.oza(1,0);b?gq.WacAirSpace.Wub(L,null,B):gq.WacAirSpace.animate(L,null,B);B=!1;for(L=0;L<n.length;L++){if(B){const ba=n[L];gq.WacAirSpace.sY(ba,"Shared_BasicClass");const la=new Vr.a(ba);la.sIa(ba.clientTop,-h.clientHeight);b?gq.WacAirSpace.Wub(la,null,oh):gq.WacAirSpace.animate(la,null,oh)}B||n[L]!==h||(B=!0)}}}akf(){""===
this.El.style.top.trim()&&(this.El.style.top=this.El.offsetTop+"px");this.htmlElement.style.left=this.El.style.left;this.htmlElement.style.top=this.El.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.ryh=this.El.style.top;this.Hhb=b.height;this.z2b();A.AFrameworkApplication.ua.z2(this.Pv);Nb.a.addHandler(this.htmlElement,Cd.a.Iwe,Nb.a.yec);this.ria=this.nJa;A.AFrameworkApplication.ua.SEa.nb(this.htmlElement,
this.ria,null);if(Ph.FocusManager.vM()){var h=Ph.FocusManager.instance();b=h.ge(Mz.a.gUa);b.parent=Dd.AFrame.mq;const n=new Xc.DOMFocusListing(()=>this.htmlElement);n.Gn(1);n.Gn(2);n.Gn(8);h.jra(()=>this.htmlElement,b,n);h=h.getRegion(Mz.a.gUa);h.SZa();h.aS=!0;h.b7a=!0;const B=A.AFrameworkApplication.ua.Iy;b.T5a(()=>{B.ny(Mz.a.gUa)});B.xW(Mz.a.gUa);(n.Uka||A.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&B.bL(Mz.a.gUa)}}ZYc(){this.KTj()&&(this.El.style.top=this.ryh);this.htmlElement.style.visibility=
"hidden";A.AFrameworkApplication.ua&&(Ph.FocusManager.vM()&&Ph.FocusManager.instance().mdb(Mz.a.gUa),this.ria&&(A.AFrameworkApplication.ua.SEa.xc(this.htmlElement,this.ria),this.ria=null));Nb.a.removeHandler(this.htmlElement,Cd.a.Iwe,Nb.a.yec)}z2b(){if(this.KTj()&&this.visible){var b=this.El,h=this.Hhb+this.KPk;const n=Lh.a.KP(b.style.top);gq.WacAirSpace.sY(b,"Shared_BasicClass");b=new Vr.a(b);b.sIa(n,h);gq.WacAirSpace.animate(b,null,null)}}KTj(){return!this.Zx&&!this.St.zyf}}Object(u.a)(Nz,"BusinessBarDom",
null,[1585,13]);var Kx;(function(b){b[b.none=0]="none";b[b.zWp=1]="corruptPage";b[b.OWp=2]="currentPageStatus";b[b.aYp=3]="documentMarkedAsFinal";b[b.hYp=4]="documentSigned";b[b.G_p=5]="fileAccess";b[b.z5p=6]="kickoutWithDataLoss";b[b.SU=7]="lostSession";b[b.W6p=8]="malformedHyperlinkUris";b[b.Edq=9]="odt";b[b.Rgq=10]="readonlyRecommended";b[b.Ziq=11]="saveReplaySuccess";b[b.Yiq=12]="saveReplayFailed";b[b.ptp=13]="unsupportedObjects";b[b.Spq=14]="word11Compat";b[b.Ooq=15]="unsupportedBrowser";b[b.rTp=
16]="applicationNotification";b[b.qlq=17]="skypeDocChatFailed";b[b.Mkq=18]="showDialogInNewWindowInfo";b[b.eQo=19]="sessionExpired";b[b.Vcn=20]="irmPolicyDescription";b[b.Wfq=21]="policyWarningMessage";b[b.ynq=22]="thirdPartyAddinDisabled";b[b.Q0p=23]="gdprPrivacyNotice";b[b.eXp=24]="datacenterDecommissionWarning";b[b.U1p=25]="graphMergePrompt";b[b.Ngq=26]="readOnlyDocument";b[b.JXp=27]="dictationSilence";b[b.HTp=28]="autoSensitivityLabel";b[b.Zgq=29]="recommendedSensitivityLabel";b[b.IXp=30]="dictationDebugInfo";
b[b.Feq=31]="oneNoteCovid19Message";b[b.iVp=32]="citationStylePrompt";b[b.Leq=33]="oneNoteViewModeMessage";b[b.Keq=34]="oneNotePrintImagesDownloading";b[b.Jeq=35]="oneNotePagePrintReady";b[b.b5p=36]="irmPolicyCausedFeatureDisabled";b[b.Y6p=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.G7p=39]="minorVersionLimit";b[b.Wmq=40]="testEntry1";b[b.Xmq=41]="testEntry2";b[b.Ymq=42]="testEntry3";b[b.Zmq=43]="testEntry4";b[b.$mq=44]="testEntry5";b[b.anq=45]="testEntry6";b[b.bnq=46]="testEntry7"})(Kx||
(Kx={}));Object(u.b)("BusinessBarId",Kx);class Nu{constructor(b,h=0,n=null,B=null){this.mqh=this.rfh=!1;this.m$b=null;this.yC=[];this.B1a=B||new Nz(b,h,this);this.J7m(n)}J7m(b){if(b){this.m$b={};b=b.ranking;for(let h=0;h<b.length;h++)this.m$b[Kx[b[h]]]=h}}dispose(){this.B1a.dispose();Ak.a.Kwg(this.yC);this.yC=null}get htmlElement(){return this.B1a.htmlElement}get visible(){return this.B1a.visible}get zyf(){return this.rfh}set zyf(b){this.rfh=b}get p0f(){return this.mqh}set p0f(b){this.mqh=b}get entries(){return this.yC}set entries(b){this.yC=
b}C3(b){for(let h=0;h<this.yC.length;h++)if(this.yC[h].id===b)return!0;return!1}Uy(b,h=!1,n=null,B=null,L=null){b.$M=this;let ba=this.cwm(b.id);h&&!this.m$b&&(ba=0);ba<Nu.sVb&&(this.B1a.dUj(b,ba),this.yC.length>=Nu.sVb&&this.B1a.ZOi(this.yC[Nu.sVb-1]),this.B1a.z2b());Array.insert(this.yC,ba,b);x.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Kx[b.id],void 0===b.c7a||null===b.c7a?"":b.c7a);b.errorCode&&A.AFrameworkApplication.qS(b.errorCode,n,B,L)}removeEntry(b){const h=
Array.indexOf(this.yC,b);-1!==h&&h<Nu.sVb&&(this.yC.length>Nu.sVb&&this.B1a.dUj(this.yC[Nu.sVb],Nu.sVb),this.B1a.ZOi(b),this.B1a.z2b());Array.remove(this.yC,b);b.$M=null;b.dispose()}cwm(b){if(!this.m$b||0===b)return this.yC.length;b=this.m$b[Kx[b]];if(void 0===b||null===b)return this.yC.length;for(let h=0;h<this.yC.length;h++)if(b<this.m$b[Kx[this.yC[h].id]])return h;return this.yC.length}}Nu.sVb=2;Object(u.a)(Nu,"BusinessBar",null,[1562,13,1563]);class zE{create(b,h,n){return new gf.a(b,h,n)}}Object(u.a)(zE,
"Factory",null,[1584]);class TG{static cyl(b,h){b.register(Nu,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ha().Rd(()=>new Nu(h.value,0,b.Oa("CommonUI.IBusinessBarRankProvider")));b.register(zE,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").ha()}}Object(u.a)(TG,"CommonUIComponentConfiguration",null,[]);var AE=d(1075);class gv extends AE.a{constructor(){super()}static get instance(){return gv._instance||gv.CVf()}static CVf(){gv._instance=new gv;return gv._instance}}
gv._instance=null;Object(u.a)(gv,"ReactRootManager",AE.a,[216,217]);class xp extends jj.a{constructor(){super()}get ControlType(){return 3}}Object(u.a)(xp,"CompoundButtonProps",jj.a,[]);class Nw{constructor(b,h,n,B,L,ba,la){this.EZ=h;this.COc=b;this.xoh=h.rhn;this.k8b=h.C$c;this.KXe=ba;this.BDd=B;this.CDd=L;this.wDd=n;this.IM=la;this.Tib=new Cf.a;this.Tib.Z(1,"SpellingIssue_16x16x32");this.Tib.Z(2,"GrammarIssue_16x16x32");this.Tib.Z(3,"WritingIssue_16x16x32");this.Tib.Z(4,null);this.Tib.Z(0,null)}create(b,
h,n){h=Object(ya.a)(pq.a,h);if(!h)return x.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const B=new Sys.StringBuilder;b=this.hBi(b);this.$Xc(B,h,n,b);this.Ttf(B,h);this.SIl(B,h,b);return B.toString()}BMb(b,h,n){const B=Object(ya.a)(pq.a,h);if(!B)return x.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];h=[];b=this.hBi(b);this.Euf(h,B,n,b);this.Utf(h,B);this.TIl(h,B,b);for(n=0;n<h.length;n++)h[n].Id=`${Ku.aji}_${n}`;return h}$Xc(b,h,n,B=null){h.errorType?
1===h.errorType&&(this.gic(h)||b.append(this.zmf(h,n,B))):b.append(this.COc.build())}Euf(b,h,n,B=null){h.errorType?1===h.errorType&&(this.gic(h)||b.push(this.Cfl(h,n,B))):b.push(this.COc.nYh())}Ttf(b,h){const n=new Sys.StringBuilder;this.ZUj(h)?n.append(cl.a("btnIgnoreAllSpellingError",(2===h.errorType?wb.a.xPa:wb.a.hta).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.gic(h)||n.append(cl.a("btnIgrnoreSpellingError",this.bAi(h.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,
null));this.eVj(h)&&(this.EZ.GXi&&n.append(cl.a("btnDoNotCheckForThisIssue",wb.a.yNb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),n.append(cl.a("btnGrammarOptions",wb.a.Zvb.toString(),F.a.Hf(Box4Intl.Box4Strings.l_GrammarOptions),null)));n.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),b.append(n.toString()),b.append("</Controls></MenuSection>"))}Utf(b,h){const n=Object.assign(new te.a,{ControlList:[]});if(this.ZUj(h)){var B=Ju.qD()?
Object.assign(new jj.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:wb.a.hta,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new jj.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});n.ControlList.push(B)}else this.gic(h)||(B=Object.assign(new jj.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.bAi(h.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),n.ControlList.push(B));this.eVj(h)&&(this.EZ.GXi&&
(h=Object.assign(new jj.a,{ExternalId:"DoNotCheckForThisIssue"}),n.ControlList.push(h)),h=Object.assign(new jj.a,{ExternalId:"GrammerSettingsContext"}),n.ControlList.push(h));b.push(n)}hBi(b){if(!this.IM)return null;b=this.IM.language(this.IM.Cs(b.Ra));return hj.a.Cg(b)?hj.a.Cg(b).name:null}bAi(b){return 2===b?wb.a.xPa:this.EZ.xkn?wb.a.C2m:wb.a.WBa}SIl(b,h,n=null){if(this.dCg(h)){var B=F.a.Hf(h.Au.CategoryTitle);B=cl.m(Ku.xuc,Pa.a.mza,this.Tib.J(h.proofingType),""!==B?B:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,
[b.toString()],this.BDd,this.CDd);B=cl.d("cgProofingOuter",[B]);b.clear();b.append(cl.g("msProofingOuter",B,"Menu16",void 0,void 0,n,"ariaLabelledById"));x.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}TIl(b,h,n=null){if(this.dCg(h)){var B=F.a.Hf(h.Au.CategoryTitle);n=Object.assign(new Fe.a,{ExternalId:String.format("{0}_{1}",Ku.xuc,h.proofingType),Command:Pa.a.mza.toString(),Image16by16Class:this.Tib.J(h.proofingType),LabelText:""!==
B?B:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:n,Menu:Object.assign(new vh.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.jim(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});n.Menu.MenuSectionList.push(...b);Array.clear(b);B=Object.assign(new te.a,{ControlList:[]});B.ControlList.push(n);b.push(B);x.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",
h.proofingType,h.typeId)}}zmf(b,h,n=null){const B=this.Uqm(b);var L=[];let ba=!1;var la=b.Au.Suggestions;if(la)if(la=la.slice(0,Math.min(3,la.length)),this.xoh&&(ba=!lf.a.any(la,La=>!La||!La.Description)),1!==la.length||la[0].Action){let La=0,fb=null;ba&&(fb="font-weight: bold;");for(const Cb of la){if(!Cb)continue;la=null;let Lb="";const $b=F.a.Hf(Cb.Text);ba&&(la=this.Fui(Cb.Description),Lb=this.Eui(Cb.Description));L.push(cl.a("btnCorrectWord"+La,h[La].toString(),$b,null,null,null,null,null,fb,
null,la,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,B,$b),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.s8h(b.token)),"ariaDescribedById",Lb));La++}}else h=F.a.Hf(la[0].Text),L.push(cl.a("btnCorrectWord0",wb.a.xPa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,B,h)));h="Menu16";
0<L.length?ba&&(h="Menu16DescriptionEnabled"):L=[cl.a("btnNoSuggestions",wb.a.xPa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return cl.g("msUnknownWord",cl.d(null,L),h,B,this.Dzm(b),n,"ariaLabelledById")}Cfl(b,h,n=null){var B=1!==b.proofingType&&0!==b.proofingType?b.Au.ExplanationTitle:"";B=Object.assign(new te.a,{Title:B,Lang:n,ControlList:[]});let L=!1;var ba=b.Au.Suggestions;if(ba)if(ba=ba.slice(0,Math.min(3,ba.length)),this.xoh&&(L=!lf.a.any(ba,la=>!la||!la.Description)),1!==ba.length||
ba[0].Action){let la=0;for(const La of ba){if(!La)continue;ba=null;let fb="";L&&(ba=this.Fui(La.Description),fb=this.Eui(La.Description));if(la>=h.length)break;ba?(ba=Object.assign(new xp,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",la,b.proofingType),Command:h[la].toString(),LabelText:La.Text,Description:ba,Lang:n,AriaDescription:fb}),B.ControlList.push(ba)):(ba=Object.assign(new jj.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",la,b.proofingType),Command:h[la].toString(),
LabelText:La.Text,Lang:n,RoleInMenu:"menuitem"}),B.ControlList.push(ba));la++}}else b=ba[0],b=Object.assign(new jj.a,{ExternalId:"NoSuggestion",Command:wb.a.xPa.toString(),LabelText:b.Text}),B.ControlList.push(b);0>=B.ControlList.length&&B.ControlList.push(Object.assign(new jj.a,{ExternalId:"btnNoSuggestions",Command:wb.a.xPa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return B}Uqm(b){return F.a.Hf(0!==b.proofingType?b.Au.ExplanationTitle:"")}Dzm(b){return this.dCg(b)?null:this.Tib.J(b.proofingType)}dCg(b){return this.k8b&&
2!==b.errorType&&(1!==b.errorType||!this.gic(b))}ZUj(b){return this.KXe&&!!b.errorType&&1===b.proofingType&&!this.gic(b)}jim(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.s8h(b.token)):""}eVj(b){return this.EZ.Qfe&&this.k8b&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}gic(b){return!!b.errorType&&!!this.wDd&&this.wDd.contains(b.token,b.lcid)}Fui(b){return""===b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):
b}Eui(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}s8h(b){let h="";if(b){let n;for(n=0;n<b.length-1;n++)h=h+b.charAt(n)+",";h+=b.charAt(n)}return h}}Object(u.a)(Nw,"EditorServiceProofingContextMenuCreator",null,[]);class Lx{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(u.a)(Lx,"BusinessBarRankProvider",null,[469]);class HC{constructor(){this.W=
null}get name(){return"Wonca.UI"}wc(b){this.W=b;b.ia("CommonUI.IBusinessBarRankProvider",()=>new Lx).ha();TG.cyl(b,new Rf.a(()=>Ua.StaticActiveAppFrame.za().Bka));b.ia("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new Nw(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.Proofing.IIgnoreAllKeywords"),A.AFrameworkApplication.Vfa,A.AFrameworkApplication.Ys,A.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),
b.resolve("Box4.IFormattingReader"))).ha();b.ia("CommandUI.ReactRootManager",()=>gv.instance).as("Common.IReactRootManager").ha()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){M.a.instance.Jc(new HC)}}Object(u.a)(HC,"WoncaUIPackage",null,[0,1]);class BE{constructor(b){this.tQ=this.DMc=null;this.zp=b}get key(){return"BOOKMARK"}get Av(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get eP(){return this.tQ}reset(b){this.tQ=b.node}$Ea(b){let h=
null;if(this.DMc&&this.zp.cXi(b,this.eP,this.DMc))return h=Object.assign(new By.a,{UF:this.key,contentObject:this.DMc}),{returnValue:!0,zG:h};this.DMc=null;if(!this.eP.hasBookmark)return{returnValue:!1,zG:h};const n=new ve.GraphIterator;n.set(this.eP.Jj());this.zp.Tdd(n);if(this.zp.xen(n)){let B=n.Xd();for(;B;){if(this.zp.cXi(b,this.eP,B))return this.DMc=B,h=Object.assign(new By.a,{UF:this.key,contentObject:B,description:this.RVa()}),{returnValue:!0,zG:h};B=n.Fk()}}return{returnValue:!1,zG:h}}RVa(){return null}}
Object(u.a)(BE,"BookmarkDetailsProvider",null,[405,406]);class hB{constructor(b,h,n,B,L=null){this.Vnh=this.ui=!1;this.CHd=this.dJd=null;this.Kjj=(ba,la)=>{ba=la.node;ba.yc!==pk.a.Aza?x.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",ba.yc):(x.ULS.sendTraceTag(24155019,324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.Hki(!0))};this.pG=n;this.jj=B;this.Oy=h;this.z$g=b;this.HV=L}get lv(){return this.Oy.value}initialize(){this.nrg();this.ui=!0}Hki(b=!1){if(!this.ui)return x.ULS.sendTraceTag(24262273,
324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.Vnh)return!0;let h=!1;this.jj.Yd(()=>{this.dJd={};this.CHd={};if(this.lv){const n=new ve.GraphIterator;n.set(this.lv);if(this.fOn(n)){if(n.Ub(1)){do this.QXk(n.currentNode);while(n.Lf(1))}h=this.Vnh=!0}}},"BGM:EBGL");return h}eBa(b){return this.Hki()?b in this.CHd?this.CHd[b]:null:null}dispose(){this.ui?this.psp():x.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}fOn(b){if(this.pG.dS(b))return(b=b.Ub(30))||x.ULS.sendTraceTag(24691921,
324,10,"Graph does not contain BookmarkContainer"),b;x.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}nrg(){x.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.z$g.jQh(this.Kjj)}psp(){x.ULS.sendTraceTag(24691924,324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.z$g.XDj(this.Kjj)}QXk(b){var h,n,B,L;b?(this.cOh(null!==(n=this.HV.Mmb.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==n?n:S.a.nil,b),this.cOh(null!==
(L=this.HV.Udc.get(null===(B=b.id)||void 0===B?void 0:B.toString()))&&void 0!==L?L:S.a.nil,b),(h=b.properties.ja(Lc.a.yu,null))&&(this.CHd[h]=b)):x.ULS.sendTraceTag(24155022,324,50,"Node is null")}cOh(b,h){b===S.a.nil?x.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=b.toString(),b in this.dJd||(this.dJd[b]=new ob.a),b=this.dJd[b],b.contains(h)||b.add(h))}}Object(u.a)(hB,"BookmarkGraphManager",null,[470]);var CE=d(867),UG=d(1197);class DE{create(){return new UG.a}}Object(u.a)(DE,"BookmarkContainerNodeFactory",
null,[296]);class EE{constructor(b,h,n,B=null){this.a0n=(L,ba)=>{this.zp.Fmj(ba)};this.Hfd=(L,ba)=>{var la=this.moi(ba.clone);L=ba.original.Lc;const La=new qb.a;for(const fb of la)la=fb.Po.toString(),La.mb(la)||(La.add(la,!0),(la=L.Eb(fb.Po))&&!la.anchor&&(la=this.zp.lPb(fb.Po)),la?la.anchor?this.hCl(la,ba.clone):x.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",la.id,la.ja(Lc.a.IKb,-1))):x.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.Cgg=
(L,ba)=>{L=ba.clone;ba=this.moi(L);this.zp.Dkd(L,ba)};this.vG=h;this.zp=n;this.hpk=B||new DE}init(){CE.a.rso(Object(z.a)(this.zp,this.zp.Gdg,"onAfterFullBookmarkRangeDeleted"));this.vG.Egf(this.a0n);ev.a.PRd(this.Hfd);ev.a.QRd(this.Cgg)}moi(b){const h=new ob.a;for(let n=0;n<b.qa.length;n++){const B=b.qa.J(n);if(B.Zh)for(let L=0;L<B.Zh.length;L++)h.add(B.Zh.J(L))}return h}hCl(b,h){var n=h.Jj().td;n=Gs.b(b,n,!0);h=ve.GraphIterator.eb(h);this.F0l(h);h.Ub(30);h.w6(n,1,b.id);h.Yj(n)}F0l(b){if(b.zb(25)&&
b.ld(25)&&!b.fv(30)){const h=this.hpk.create(pk.a.Aza);b.Uf(h,30)}}}Object(u.a)(EE,"BookmarksEventHandler",null,[]);var dt=d(287),ju=d(221),FE=d(428),WI=d(1269),GE=d(135),XI=d(1150);class HE{create(){return new XI.a}}Object(u.a)(HE,"BookmarkNodeFactory",null,[296]);class Ry{constructor(b,h){this.Iea=b;this.npk=h}get IYb(){return this.npk}}Object(u.a)(Ry,"FoundBookmarkRangeObject",null,[495]);class IC{constructor(b,h,n,B,L,ba,la,La=null,fb,Cb=null){this.Eia="_";this.C$g=40;this.AOk=" ";this.Oy=b;this.pG=
h;this.Qd=n;this.R_e=B;this.Pc=L;this.jb=ba;this.hb=la;this.mpk=La||new HE;this.HV=Cb}i4c(b,h){return b?this.HV.Mmb.get(null===h||void 0===h?void 0:h.toString()):this.HV.Udc.get(null===h||void 0===h?void 0:h.toString())}get lv(){return this.Oy.value}get d1a(){return this.R_e.value}Def(b,h){if(!h||!h.Ra||!h.Uc)return x.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const n=h.Ra.node,B=h.Uc.node,L=dt.a.Gqb(h,!0);h=dt.a.Gqb(h,!1);return this.pSc(b,L,h,n,B)}pSc(b,h,n,B,L,ba=!1){x.ULS.sendTraceTag(545642374,
3029,50,String.format("removeExisting value is: {0}",ba));const la=this.eBa(b);if(la)if(ba)this.NBj(la);else return x.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!B||!L)return x.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),!1;ba=this.Pc.Mc(15);ba.Ab(this.d1a);b=this.dVk(b);if(!b)return!1;this.aVk(B,h,b,L,n);ba.dispose();return!0}eBa(b){x.ULS.shipAssertTag(34936482,3029,!!b);return this.poi(h=>b===h.properties.ja(Lc.a.yu,
null))}lPb(b){return b&&b!==S.a.nil?this.poi(h=>b.equals(h.id)):(x.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}Gdg(b){const h=this.lPb(b);h?(x.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.MBj(h),this.Ckd(h)):x.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}fBa(b,h){var n;const B=null!==(n=this.i4c(h,b.id))&&void 0!==n?n:S.a.nil;if(B===S.a.nil)return x.ULS.sendTraceTag(36218377,
3029,10,"ParaId not on Bookmark"),new Ry(null,2);n=this.lv.td.Eb(B);return n?n.isConnected?this.getBookmarkRange(n,b,h):(x.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new Ry(null,3)):(x.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),new Ry(null,2))}Fmj(b){const h=this.P9l(b);h[Symbol.iterator]().next().done||this.aOn(b,h)}Dkd(b,h){const n=new ob.a;let B=0,L=!1;for(const ba of h)ba&&ba.Jb.Zh?(B++,ba.Jb.Zh.remove(ba),0<=ba.oe&&ba.oe<b.qe.length&&(ba.Jb.cp||
(L=!0),n.add(ba.oe))):x.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.nna(n);x.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",B,n.count));L&&!b.qe.length&&b.qe.append(ju.CharacterPropertiesEditor.GN,1024)}g5d(b=!1){x.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const h=new ob.a,n=ve.GraphIterator.eb(this.lv);if(null!==this.Tdd(n)){var B=n.Dq();x.ULS.sendTraceTag(559228944,3029,50,
"Bookmarks count: {0}",B);if(0<B)for(B=n.Xd();null!==B;){const L=B.ja(Lc.a.yu,"");F.a.Tf(L)||(b?h.add(B):L.startsWith(this.Eia)||h.add(B));B=n.Fk()}}!b&&0<h.count&&x.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",h.count);return h}lYm(){return this.lv?this.kzl():!1}kzl(){x.ULS.sendTraceTag(524321506,3029,50,"Finding bookmarks with includeHidden: {0}",!1);const b=ve.GraphIterator.eb(this.lv);if(null!==this.Tdd(b)&&0<b.Dq())for(var h=b.Xd();null!==h;){h=h.ja(Lc.a.yu,"");if(!F.a.Tf(h)&&
!h.startsWith(this.Eia))return!0;h=b.Fk()}return!1}aEi(b){var h=this.eBa(b);const n=new ob.a;if(h){b=this.i4c(!0,h.id);h=this.i4c(!1,h.id);var B=this.lv.td.Eb(b);B&&n.add(B);if(b.equals(h))return n;b=B;do(b=B=this.jb.zg(b,!1,!1,!0))&&n.add(B);while(B&&!B.id.equals(h))}else x.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",b);return n}LBj(b){if(null===b)return x.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.lPb(b);return this.NBj(b)}ejm(b){let h=
"";const n=b.id;b=b.characterData.split(this.AOk);for(let B=0;3>B&&B<b.length;B++)h+=this.Eia+b[B];h.length>this.C$g&&(h=h.substring(0,this.C$g));return this.kek(h,n)}kek(b,h){const n=this.g5d(!0),B=[];let L;for(let la=0;la<n.count;la++){var ba=n.J(la);L=ba.ja(Lc.a.yu,"");ba=this.i4c(!0,ba.id);L.startsWith(b)&&!h.equals(ba)&&B.push(L)}return 0<B.length?(B.sort((la,La)=>la.localeCompare(La,void 0,{numeric:!0})),(h=B[B.length-1].substring(b.length+1))?b+this.Eia+(parseInt(h)+1):b+this.Eia+1):b}ISm(b){F.a.Tf(b)?
x.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.eBa(b),null===b?x.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.fBa(b,!0))?(b=Oe.SelectionFactory.se(b.Iea.paragraph,b.Iea.Jb.cp))&&this.hb.Ic(b):x.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}NBj(b){if(!b)return x.ULS.sendTraceTag(559228888,3029,15,"Could not find bookmark node with given id"),!1;x.ULS.sendTraceTag(559228889,3029,
50,String.format("Removing bookmark {0}",b.id));const h=this.Pc.Mc(15);h.Ab(this.d1a);this.MBj(b);this.Ckd(b);h.dispose();return!0}G6d(b,h){if(!b||0>h)return x.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;let n=null;const B=new ob.a,L=new ob.a;var ba=b.qa;for(var la=0;la<ba.length;la++){var La=ba.J(la);if(La.cp>h||La.cp===h&&0<B.count)break;if(La.Zh){var fb=La.Zh;if(2===fb.length&&fb.J(0).Po.equals(fb.J(1).Po)&&La.cp===h){B.add(fb.J(0).Po.toString());
break}for(let Cb=0,Lb=fb.length;Cb<Lb;Cb++){La=fb.J(Cb);const $b=b.Lc.Eb(La.Po).ja(Lc.a.yu,"");F.a.Tf($b)||$b.startsWith(this.Eia)||(La.Wc?B.add(La.Po.toString()):B.contains(La.Po.toString())?B.remove(La.Po.toString()):L.add(La.Po.toString()))}}}0<B.count&&(n=b.Lc.Eb(S.a.Cf(B.J(B.count-1))));if(!n)for(h=ea.ParagraphReader.zg(b,!0);h&&!n;){for(ba=0;ba<h.qa.length;ba++)if(la=h.qa.J(ba),la.Zh){la=la.Zh;for(let Cb=0,Lb=la.length;Cb<Lb;Cb++)fb=la.J(Cb),La=b.Lc.Eb(fb.Po).ja(Lc.a.yu,""),F.a.Tf(La)||La.startsWith(this.Eia)||
(fb.Wc?L.contains(fb.Po.toString())?L.remove(fb.Po.toString()):B.add(fb.Po.toString()):B.contains(fb.Po.toString())?B.remove(fb.Po.toString()):L.add(fb.Po.toString()))}0<B.count?n=h.Lc.Eb(S.a.Cf(B.J(B.count-1))):h=ea.ParagraphReader.zg(h,!0)}return n}Ztp(b,h){if(null===b)return x.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.yen(h)||this.KXl(h))return!1;const n=this.Pc.Mc(15);n.Ab(this.d1a);this.Ytp(b,h);n.dispose();return!0}poi(b){if(!this.lv)return x.ULS.sendTraceTag(34936483,
3029,10,"PageNode is null"),null;const h=new ve.GraphIterator;h.set(this.lv);if(!this.Tdd(h))return x.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.Ub(1))return null;do{const n=h.currentNode;if(b(n))return n}while(h.Lf(1));return null}getBookmarkRange(b,h,n){for(let B=0;B<b.qa.length;B++){const L=b.qa.J(B);if(L.Zh)for(let ba=0;ba<L.Zh.length;ba++){const la=L.Zh.J(ba);if(la.Po.equals(h.id)&&n===la.Wc)return new Ry(la,0)}}x.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",
b.id,h.ja(Lc.a.IKb,-1),n,h.id,b.qa.length,this.GL(b));return new Ry(null,1)}Tdd(b){if(this.pG.dS(b))return b=b.Ub(30),x.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;x.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}P9l(b){const h=new qb.a;for(let n=0;n<b.qa.length;n++){const B=b.qa.J(n);if(B.Zh)for(let L=0;L<B.Zh.length;L++){const ba=B.Zh.J(L),la=ba.Po.toString();h.mb(la)?(x.ULS.shipAssertTag(36218379,3029,ba.Wc!==h.J(la).Wc),h.remove(la)):
h.add(la,ba)}}return h.values}aOn(b,h){this.Dkd(b,h);this.ENn(b,h)}ENn(b,h){let n=ea.ParagraphReader.zg(b,!1,!0);b=ea.ParagraphReader.zg(b,!0,!0);n||b?(n||this.MWh(h,!0)&&x.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),b||this.MWh(h,!1)&&x.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),n=n||b,b=b||n,this.Vej(n,h,0,!0),this.Vej(b,h,b.qa.last.cp,!1)):x.ULS.sendTraceTag(36218381,
3029,15,"Both paragraphs are null.")}MWh(b,h){for(const n of b)if(h===n.Wc)return!0;return!1}Vej(b,h,n,B){const L=new ob.a;n=this.$Hf(b,n);for(const ba of h)ba.Wc===B&&(n?(h=this.fVk(b,B,n,ba.Po))&&L.add(h):x.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",B));L.count&&(b.Jl(),this.iNg(b,L),x.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",L.count,B)))}fVk(b,h,n,B){const L=this.lPb(B);return L?this.Eef(b,h,n,L):(x.ULS.sendTraceTag(40445218,3029,
15,String.format("BookmarkNode {0} null while trying to add range",B)),null)}Eef(b,h,n,B){var L;if(!B)return x.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!n)return x.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),null;n.Zh||(n.Zh=new FE.a(n));const ba=new WI.a(n,null,B.id,h);n.Zh.add(ba);(h?this.HV.Mmb:this.HV.Udc).set(null===(L=B.id)||void 0===L?void 0:L.toString(),b.id);return ba}iNg(b,h){if(h){x.ULS.sendTraceTag(36218384,
3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((n,B)=>n.oe-B.oe);for(let n=0;n<h.count;n++){const B=h.J(n);B.oe?b.qe.wX(B.oe-1,1024):b.qe.rta(B.oe,1024);b.qe.Kq.Z(B.oe,ju.CharacterPropertiesEditor.GN);b.qe.Nt.Z(B.oe,ju.CharacterPropertiesEditor.fS)}}else x.ULS.shipAssertTag(36218383,3029,!1,"Null BookmarksToUpdate.")}$Hf(b,h){if(!b||!b.qa||!b.qa.last)return null;x.ULS.shipAssertTag(36471766,3029,h<=b.qa.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.qa.last.cp===h){var n=
b.qa.length-1;if(!b.qa.J(n).formatting)for(var B=n-1;0<=B;B--){var L=b.qa.J(B);if(L.formatting){this.Qd.$0(b,n,h,L.formatting);break}}return b.qa.last}n=null;for(B=0;B<b.qa.length;B++){L=b.qa.J(B);if(L.cp>=h){if(L.cp>h||!L.formatting)this.Qd.$0(b,B,h,n),L=b.qa.J(B);L.Zh||(L.Zh=new FE.a(L));x.ULS.shipAssertTag(36471768,3029,L!==b.qa.last);return L}L.formatting&&(n=L.formatting)}return null}dVk(b){const h=new ve.GraphIterator;h.set(this.lv);if(!this.Tdd(h))return x.ULS.sendTraceTag(36471769,3029,10,
"Unable to move to BookmarkContainer"),null;b=this.QDl(b);h.w6(b,1,null);h.Yj(b);return b}QDl(b){const h=this.mpk.create(pk.a.Kmb);h.setValue(Lc.a.yu,b);h.setValue(Lc.a.IKb,Se.a.VF());return h}Ckd(b){if(b&&b.anchor){x.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",b.ja(Lc.a.IKb,-1),b.id);var h=new ve.GraphIterator;h.set(b);h.zb(64);h.eh()}}GL(b){const h=[];let n=0;for(;b.anchor.Uq&&7!==b.type;)h[n]=GE.a[b.type],b=b.anchor.Uq.kt.node,n++;h[n]=GE.a[b.type];return h.join(" ")}Ytp(b,
h){b.setValue(Lc.a.yu,h)}MBj(b){const h=this.fBa(b,!0).Iea;b=this.fBa(b,!1).Iea;if(h&&b&&h.paragraph===b.paragraph){let n;this.Dkd(h.paragraph,(n=new ob.a,n.add(h),n.add(b),n))}else{if(h){let n;this.Dkd(h.paragraph,(n=new ob.a,n.add(h),n))}if(b){let n;this.Dkd(b.paragraph,(n=new ob.a,n.add(b),n))}}}aVk(b,h,n,B,L){if(h=this.Eef(b,!0,this.$Hf(b,h),n)){b.Jl();var ba;this.iNg(b,(ba=new ob.a,ba.add(h),ba));(n=this.Eef(B,!1,this.$Hf(B,L),n))?(B.Jl(),this.iNg(b,(ba=new ob.a,ba.add(n),ba))):x.ULS.sendTraceTag(520646733,
3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else x.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}bEi(b,h){var n;if(!b)return null;h=null!==(n=this.i4c(h,b.id))&&void 0!==n?n:S.a.nil;return b.Lc.Eb(h)?b.Lc.Eb(h):null}xen(b){return!!b&&64===b.lf}zjg(b){var h;if(0===b.Qna)return!1;for(let n=0;n<(null===(h=b.qa)||void 0===h?void 0:h.length);n++){const B=b.qa.J(n);if(null!=B.Zh)for(let L=
0;L<B.Zh.length;L++){const ba=B.Zh.J(L),la=b.Lc.Eb(ba.Po).uqb();if(!F.a.Tf(la)&&!la.startsWith(this.Eia)&&ba.Wc)return!0}}return!1}qui(b){var h;const n=[];if(0===b.Qna)return n;for(let B=0;B<(null===(h=b.qa)||void 0===h?void 0:h.length);B++){const L=b.qa.J(B);if(null!=L.Zh)for(let ba=0;ba<L.Zh.length;ba++){const la=L.Zh.J(ba),La=b.Lc.Eb(la.Po),fb=La.uqb();F.a.Tf(fb)||fb.startsWith(this.Eia)||!la.Wc||n.push(La)}}return n}k4o(b){return b.ja(Lc.a.yI,!1)}yen(b){return F.a.Tf(b)?(x.ULS.sendTraceTag(559228948,
3029,50,"bookmark name is null or empty"),!0):!1}KXl(b){return null!==this.eBa(b)?(x.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}pui(b,h,n){return this.getBookmarkRange(b,h,n).Iea}cXi(b,h,n){if(this.k4o(n)||this.ekn(n))return!1;const B=this.bEi(n,!0),L=this.bEi(n,!1);if(B&&L&&this.jb.p$c(h,B,L)){if(h!==B&&h!==L)return!0;const ba=this.pui(B,n,!0);if(ba&&(B!==h||ba.Jb.cp<=b)&&(n=this.pui(L,n,!1))&&(L!==h||n.Jb.cp>=b))return!0}return!1}ekn(b){b=
null===b||void 0===b?void 0:b.ja(Lc.a.yu,"");return!F.a.Tf(b)&&b.startsWith(this.Eia)?!0:!1}}Object(u.a)(IC,"FullBookmarkManager",null,[467]);class Oz{constructor(){this.VLe=this.Oq=this.W=null}get name(){return"WordEditor.Bookmark"}wc(b){this.W=b;this.Oq=this.W.resolve("Box4.INotebookManager").Il;const h=new IC(new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c),Object($n.a)(),this.W.resolve("Box4.ICharacterPropertiesEditor"),new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.sc.jd),vm.a.instance,this.W.resolve("Box4.IParagraphReader"),
this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ia("WordEditor.Bookmark.FullBookmarkManager",()=>h).as("WordEditor.Bookmark.IBookmarkManager").ha();this.W.ia("WordEditor.Bookmark.BookmarksEventHandler",()=>new EE(this.Oq.Ve(12),this.W.resolve("WordEditor.ITableEditor"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).ha();Eh.a.fck&&(this.VLe=new hB(this.Oq.Ve(64),new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c),Object($n.a)(),Rn.a.instance,
this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ia("WordEditor.Bookmark.BookmarkGraphManager",()=>this.VLe).as("WordEditor.Bookmark.IBookmarkGraphManager").ha())}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo()})}dispose(){this.VLe.dispose()}Mo(){x.ULS.sendTraceTag(36209186,324,50,"Registering paragraph events");this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();x.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.yso(this.W.Qa("Box4.Accessibility.IAccessibilityContextManager"),
this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}yso(b,h){b&&b.execute(n=>{n.kY(new BE(h))})}static main(){M.a.instance.Jc(new Oz)}}Object(u.a)(Oz,"BookmarkPackage",null,[0,1]);var iB=d(949),Mx=d(1138),JC=d(1624),hv=d(1460);class Nt extends hv.a{constructor(b){super();this.CRk=b}get index(){return 3}run(){this.CRk()}WI(){this.D0()}}Object(u.a)(Nt,"FootnoteEndnoteGraphUpdateTracker",hv.a,[]);class jB{constructor(){this.FCd=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}wc(){}init(){jB.rc.Ds.continueWith(()=>
{this.Mo()})}Mo(){iB.a.Ypb=JC.a.instance;this.yTf()}dispose(){}yTf(){this.FCd=new Nt(()=>{JC.a.instance.Vv()});Mx.a.Wte(Object(z.a)(this.FCd,this.FCd.WI,"setUpdateNeeded"));ap.GraphTransactionManager.instance.Ava(this.FCd,3)}static get rc(){return Ya.a.instance.resolve("Box4.IFeatureHelper")}}Object(u.a)(jB,"PackageManager",null,[0,1]);var IE=d(834),JE=d(215),aw=d(576),bw=d(508),kB=d(1745);class Ow extends Cy{constructor(){super()}get Av(){return null}getTitle(b){b=b.Lsa();if(!b||!aw.a.instance.Eta(b))return"";
const h=new Sys.StringBuilder,n=aw.a.instance.w7(b);h.append(1===n?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(aw.a.instance.ekc(b));return h.toString()}}Object(u.a)(Ow,"FootnoteEndnoteBaseDetailsProvider",Cy,[]);class VG extends Ow{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get Jh(){return 7}}Object(u.a)(VG,"FootnoteEndnoteDetailsProvider",Ow,[]);var lB=d(1679),an=d(1696),WG=d(1796);class KE extends Ow{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get Jh(){return 10}}
Object(u.a)(KE,"FootnoteEndnoteRefMarkDetailsProvider",Ow,[]);class Pz{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd,Hd,xe,je){this.XSi=(he,fe,De,gg,eg)=>{gg=fe.view;if(!gg.features.KBe||this.cF.YWi)return 8;const vl=gg.lb.Og;if(!vl)return 2;if(this.ul.Q2(vl))return 8;gg=he===Dc.a.insertFootnote?1:0;var wl=this.N5d(fe);if(!wl)return x.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;fe=!0;wl=wl.Ra;eg&&eg.fpc&&eg.HLa&&(wl=eg.HLa,fe=!eg.keepCurrentFocus);if(1===De&&Ve.a.Sla(vl)||
!wl||!re.SelectionEditor.mf(wl)||this.Bch.instance&&this.Bch.instance.sln(wl)||ef.a.uCa(wl,!0))return 8;if(1===De)return 32;2===De&&(De=this.qW.Vf("UserAction","InsertFootnoteEndnote"),he=this.gwk.w$m(wl,gg,he),eg&&eg.fpc&&(eg.Khj=he),fe&&this.Toe(he,!0,!0),De.stop(),this.Wd.$t(6));return 32};this.$rc=(he,fe,De)=>{const gg=fe.view;if(he===Dc.a.yeb||he===Dc.a.Oyb){if(!gg.features.KBe)return 8}else if(!gg.features.HGg)return 8;if(!gg.lb.Og)return 2;fe=this.flc(fe);return fe?he!==Dc.a.yeb&&he!==Dc.a.Oyb||
this.tRa.KYm(fe.node,he===Dc.a.yeb?1:0)?1===De?32:2===De&&32===this.ga.Pb(Dc.a.Z6,2,!0)?(this.ga.Pb(Dc.a.tbg,2,he),32):8:8:2};this.fcm=(he,fe,De,gg,eg)=>{if(1===De)return 32;if(2===De){he=this.gKm(fe);if(!he)return 8;De=fe=null;switch(eg){case Dc.a.gle:De=he.Uc;fe=this.k7b.B$d(De,1);break;case Dc.a.fle:De=he.Uc;fe=this.k7b.B$d(De,0);break;case Dc.a.ile:De=he.Ra;fe=this.k7b.ELi(De,1);break;case Dc.a.hle:De=he.Ra;fe=this.k7b.ELi(De,0);break;case Dc.a.yeb:De=he.Ra;(fe=this.k7b.B$d(De,1,!0))||(fe=this.tRa.Byi(De.node,
1));break;case Dc.a.Oyb:De=he.Ra,(fe=this.k7b.B$d(De,0,!0))||(fe=this.tRa.Byi(De.node,0))}if(fe)this.Toe(fe);else{if(!this.Sy.sc)return 8;(eg=tn.d(De.node,De.cpBegin))&&7===eg.Jh&&this.tRa.HKj(eg)}}return 32};this.C6o=(he,fe,De,gg,eg)=>1===De?32:2===De?(x.ULS.shipAssertTag(4520066,308,!!eg),x.ULS.shipAssertTag(4520067,308,!!eg.h7a),he=eg.h7a,x.ULS.shipAssertTag(4520068,308,this.lG.Eta(he)),this.Toe(he,eg.dze)?32:8):32;this.D6o=(he,fe,De,gg,eg)=>{if(1===De)return 32;2===De&&(he=eg.Waa,eg=eg.icm)&&
(this.uxa.cic(),fe=this.lG.ctb(he),eg.title=this.lG.Btm(he)+(fe?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};this.lcb=(he,fe,De,gg,eg)=>2===De?(x.ULS.shipAssertTag(4520069,308,!!eg),x.ULS.shipAssertTag(4520070,308,!!eg.h7a),x.ULS.shipAssertTag(4520071,308,ea.ParagraphReader.Xb(eg.h7a)),he=this.lG.i9a(eg.h7a),this.Toe(he,eg.dze)?32:8):32;this.lTo=(he,fe,De)=>{2===De&&this.cF.X0();return 32};this.TUl=(he,fe,De,
gg,eg)=>{if(1===De)return 32;if(2===De)return void 0!==eg&&null!==eg?this.cF.jyf(eg,eg):this.cF.jyf(),32;x.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};this.rxn=(he,fe,De)=>{he=this.flc(fe);return he&&re.SelectionEditor.mf(he)?1===De?32:2===De?(De=0<this.Vp.v7(he.node).Nu,this.cF.Btf(),this.cF.dialog.Lrb=De,32):8:(x.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.dcm=(he,fe,De)=>1===De?32:2===De?(this.cF.dialog.Lrb=!1,
32):8;this.Kjo=(he,fe,De,gg,eg)=>this.Qqi(he,De,eg);this.Ijo=(he,fe,De,gg,eg)=>1===De?32:this.cF.dialog&&this.cF.dialog.fontName?(eg[em.a.Value]=this.cF.dialog.fontName,32):this.Ask.rVa(wb.a.qYb.toString(),eg,null)?32:8;this.ccm=(he,fe,De)=>1===De?32:2===De?(this.cF.dialog.Lrb=!0,32):8;this.Jjo=(he,fe,De,gg,eg)=>this.Qqi(he,De,eg);this.acm=(he,fe,De)=>{if(1===De)return 32;if(2===De){he=this.flc(fe);if(!he)return x.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;fe=this.lG.i9a(he.node);
this.lG.Eta(fe)&&(De=this.Pc.Mc(15),De.Ab(fe),this.o7j(he),this.tRa.rTh(fe,this.cF.dialog),De.dispose());this.cF.Pld();return 32}return 8};this.$bm=(he,fe,De)=>{if(1===De)return 32;if(2===De){he=this.flc(fe);if(!he)return x.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;fe=this.lG.i9a(he.node);this.lG.Eta(fe)&&(De=this.Pc.Mc(15),De.Ab(fe),this.o7j(he),this.tRa.H7k(fe,this.cF.dialog),De.dispose());this.cF.Pld();return 32}return 8};this.bcm=(he,fe,De)=>1===De?32:2===De?(this.cF.Pld(),
32):8;this.Ybm=(he,fe,De,gg,eg)=>{if(1===De)return 32;if(2===De){he=Object(ya.a)(267,eg);if(!he||!he.rd)return 8;this.cF.dialog.fontName=he.rd.fontName;return 32}return 8};this.Zbm=(he,fe,De,gg,eg)=>{if(1===De)return 32;if(2===De){he=Object(ya.a)(267,eg);if(!he||!he.rd)return 8;this.cF.dialog.j7b=he.rd;return 32}return 8};this.ga=b;this.Sy=h;this.Ask=n;this.nd=B;this.lG=L;this.gwk=ba;this.tRa=la;this.uxa=La;this.cF=fb;this.Vp=Cb;this.k7b=Lb;this.Pc=$b;this.ul=tc;this.Gb=Nc;this.qW=dd;this.Wd=Hd;this.nmk=
xe;this.Bch=je}o7j(b){(b=Va.FormattingReader.Cs(b))?(this.cF.dialog.fontName||(this.cF.dialog.fontName=b.cache.mI),-1===this.cF.dialog.fontSize&&(this.cF.dialog.j7b=b.cache.fontSize)):x.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}Qqi(b,h,n){return 1===h&&this.cF.dialog?32:2===h&&this.cF.dialog?(n[Jj.a.On]=b===Dc.a.Gog?this.cF.dialog.Lrb:!this.cF.dialog.Lrb,32):8}Wb(){$e.App.instance.lQi([Dc.a.gle,Dc.a.fle,Dc.a.ile,Dc.a.hle,Dc.a.tbg,Dc.a.yeb,Dc.a.Oyb,
Dc.a.Z6]);this.ga.fb(Dc.a.insertFootnote,oc.a.view,this.XSi,4);this.ga.fb(Dc.a.insertEndnote,oc.a.view,this.XSi,4);this.ga.ra(Dc.a.gle,oc.a.view,this.$rc);this.ga.ra(Dc.a.tbg,oc.a.view,this.fcm);this.ga.ra(Dc.a.fle,oc.a.view,this.$rc);this.ga.ra(Dc.a.ile,oc.a.view,this.$rc);this.ga.ra(Dc.a.hle,oc.a.view,this.$rc);this.ga.ra(Dc.a.yeb,oc.a.view,this.$rc);this.ga.ra(Dc.a.Oyb,oc.a.view,this.$rc);this.ga.ra(Dc.a.nUj,oc.a.view,this.C6o);this.ga.fb(Dc.a.Oqi,oc.a.view,this.ccm,4);this.ga.fb(Dc.a.Gog,oc.a.view,
this.Jjo,100);this.ga.fb(Dc.a.Pqi,oc.a.view,this.dcm,4);this.ga.fb(Dc.a.dxj,oc.a.view,this.Kjo,100);this.ga.ra(Dc.a.oUj,oc.a.view,this.D6o);this.ga.fb(Dc.a.lcb,oc.a.view,this.lcb,96);this.ga.fb(Dc.a.u4d,oc.a.view,this.lTo,96);this.ga.ra(Dc.a.Z6,oc.a.view,this.TUl);this.ga.fb(Dc.a.u6i,oc.a.view,this.rxn,4);this.ga.fb(Dc.a.Lqi,oc.a.view,this.acm,4);this.ga.fb(Dc.a.Mqi,oc.a.view,this.$bm,4);this.ga.fb(Dc.a.Nqi,oc.a.view,this.bcm,4);this.ga.fb(Dc.a.s4d,oc.a.view,this.Ybm,4);this.ga.fb(Dc.a.cxj,oc.a.view,
this.Ijo,100);this.ga.fb(Dc.a.t4d,oc.a.view,this.Zbm,4);this.ga.fb(Dc.a.Jhd,oc.a.view,Pz.Jhd,100);this.ga.fb(Dc.a.Khd,oc.a.view,Pz.Khd,100)}hrg(){this.nmk.execute(b=>{b.kY(new VG);b.kY(new KE)})}flc(b){b=this.N5d(b);return b?b.Ra:(x.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}N5d(b){let h=null;b=b.view;if(!b)return x.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),h;b=b.lb;if(!b)return x.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),
h;b=b.gb;if(!b||!b.length)return x.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),h;b=b.J(0);if(!b)return x.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),h;(h=re.SelectionEditor.Wj(b,!1,!1))||x.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}gKm(b){return(b=b.view)?b.lb.gb.J(0):null}Toe(b,h=!0,n=!1){if(b){this.uxa.cic();var B=b.zsa;if(B){var L=B.Jb,ba=Oe.SelectionFactory.eN(L.paragraph,L.cp,
L.cp+1);L=this.Sy.sc;if(!L)return!1;this.nd.zha(L,ba);L.Oxb=150;L.V0();b=new bw.a(b,h);ba=JE.a.kkc(B,L);B=B.Tsa(L,ba);if(!B)return x.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;n||B.element?this.cF.nDg(b):(this.cF.nDg(new bw.a(b.h7a,!1)),h&&(h=new Re.a(2,1,10,()=>{this.cF.X0()}),this.Gb.Zb(h)));return!0}}return!1}static stm(){return new Pz(A.AFrameworkApplication.va,Ua.StaticActiveAppFrame.za().ib,Ya.a.instance.resolve("Box4.IGeneralCuiUser"),Object(Pb.a)(),aw.a.instance,
an.a.instance,lB.a.instance,JC.a.instance,kB.FootnoteEndnoteControlManager.instance,Ya.a.instance.resolve("Box4.IParagraphIndentationReader"),WG.a.instance,new vm.a,Pd.a.instance,ph.a.instance,A.AFrameworkApplication.ua.hs,Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ya.a.instance.Qa("Box4.Accessibility.IAccessibilityContextManager"),Ya.a.instance.Qa("Box4.IContentControlReader"))}static rtm(){return Pz.stm()}static Jhd(b,h,n,B,L){if(1===n)return 32;if(2===n&&!L)return 8;
Qn.a.Ybe(h);L.PopulationXML=wp.FontUtils.vsi(Qn.a.yze,Qn.a.HFf,Dc.a.s4d);return 32}static Khd(b,h,n,B,L){if(1===n)return 32;if(2===n&&!L)return 8;L.PopulationXML=wp.FontUtils.wsi(Dc.a.t4d);return 32}}Object(u.a)(Pz,"FootnoteEndnoteActor",null,[268]);class XG extends hv.a{constructor(b){super();this.mcf=b}get index(){return 1}run(){this.mcf()}WI(){this.D0()}}Object(u.a)(XG,"FootnoteEndnoteControlUpdateTracker",hv.a,[]);var Sy=d(379);class YG extends Sy.a{constructor(b,h,n,B,L,ba,la){super(b,h,n,B);
this.kv=()=>{this.std(this.Cb)};this.IK=b.container;this.ix=document.createElement("div");b.container.appendChild(this.ix);this.$P(this.ix);this.dLk=L;this.jo.execute(La=>{La.Q0(this.kv)});this.wRa=ba;this.OM=la;this.wRa.execute(La=>{La.BBg(this.jc,this.IK)});this.IK.style.backgroundColor=this.OM.Lkc()}dispose(){super.dispose();this.jo.instance&&this.jo.instance.YZa(this.kv)}get jo(){return null!=this.kYg?this.kYg:this.kYg=Ya.a.instance.Qa("Common.IZoomManager")}QB(b){this.IK.classList.add("FootnoteEndnoteViewElement");
this.std(b.currentNode)}std(b){this.jo.instance&&(this.jo.instance.fvd(this.ix),this.ix.style.width=Math.round(100/this.jo.instance.Aj)+"%");this.dLk(b)}}Object(u.a)(YG,"FootnoteEndnoteViewElement",Sy.a,[]);class cw{constructor(){this._initialized=!1;this.$yd=this.gTe=this.W=null;this.kcm=(b,h,n,B)=>b.gab?new YG(b,h,n,B,L=>{kB.FootnoteEndnoteControlManager.instance.oEo(L)},this.W.Qa("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler")):
null}get name(){return"WordEditor.FootnoteEndnote"}wc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo()})}Mo(){Ym.WordSectionNavigator.instance.wbg=Object(z.a)(lB.a.instance,lB.a.instance.wPn,"navigateToWordSectionNodeWithFootnoteEndnote");IE.a.qBg(this.kcm);kB.FootnoteEndnoteControlManager.instance.bind(Ua.StaticActiveAppFrame.za().aG);this.gTe=Pz.rtm();this.gTe.Wb();this.gTe.hrg();Ua.StaticActiveAppFrame.za().Ie();this.yTf();this._initialized=!0}dispose(){this._initialized&&
(this._initialized=!1,kB.FootnoteEndnoteControlManager.instance.dispose())}yTf(){this.$yd=new XG(()=>{kB.FootnoteEndnoteControlManager.instance.ttd()});Mx.a.Wte(Object(z.a)(this.$yd,this.$yd.WI,"setUpdateNeeded"));ap.GraphTransactionManager.instance.Ava(this.$yd,3)}}Object(u.a)(cw,"PackageManager",null,[0,1]);class LE{constructor(b,h,n,B){this.hb=h;this.Nia=B}get bookmarkManager(){return this.Nia.value}jln(b){return Eh.a.fck?b.startsWith(F.a.Imb):!1}OVm(b){try{this.PVm(b)}catch(h){x.ULS.sendTraceTag(24691935,
324,10,String.format("Error parsing bookmark url. Error: {0}",h.message))}}wKg(b){return{returnValue:!1,Rrg:b,ZOb:""}}PVm(b){if(this.bookmarkManager){b=b.split("/");var h=this.bookmarkManager.eBa(b[b.length-1]);h&&h.anchor?(b=this.bookmarkManager.fBa(h,!0).Iea,h=this.bookmarkManager.fBa(h,!1).Iea,b||h?b?this.KPj(b):(x.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.KPj(h)):(x.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.$4i(!1))):(x.ULS.sendTraceTag(35992275,
324,15,"Cannot find bookmark node"),this.$4i(!0))}}$4i(b){b=Oe.SelectionFactory.pp(Ua.StaticActiveAppFrame.za().ib.$c.uwi(),b);this.hb.Ic(b)}KPj(b){b.paragraph&&b.Jb?(b=Oe.SelectionFactory.se(b.paragraph,b.Jb.cp),b.bWi=!0,this.hb.Ic(b)):x.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(u.a)(LE,"InternalLinkManager",null,[233]);class mB{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}wc(b){b.ia("WordEditor.InternalLinks.InternalLinkManager",
()=>new LE(new Rf.a(()=>b.Oa("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IFeatureHelper"),new Rf.a(()=>b.Oa("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").ha()}static main(){M.a.instance.Jc(new mB)}}Object(u.a)(mB,"WordEditorInternalLinksPackage",null,[0,1]);class Nx{constructor(b){this.aSa=null;this.Pnl=h=>{h=h.Yl;if(h.anchor){ce.a.mark(4763);var n=ve.GraphIterator.eb(h);if(n.zb(8)&&
n.ld(8)&&n.CKg(h)===h){if(pl.OutlineReader.isEmpty(n)){let B=!1;for(let L=0;L<Zb.a.instance.gb.length;L++){const ba=Zb.a.instance.gb.J(L);for(let la=0;la<ba.length;la++)if(ba.J(la).node===h){B=!0;break}}B||this.Oei(n)}ce.a.mark(4764)}}};Nx.pT=b}VYd(b){if(!Nx.$i.Cfe(b))return null;b.Ub(1)&&(b.currentNode.om(8,!0),b.uc());const h=Nx.pT.pIl();Nx.$i.isRtl(b.currentNode)?h.setValue(Hf.a.sr,11):h.setValue(Hf.a.sr,9);b.Uf(h,1);b.Yj(h);return h}LUo(b){if(this.aSa&&b!==this.aSa){const h=new Re.a(2,1,0,this.Pnl,
120);h.Yl=this.aSa;A.AFrameworkApplication.mc.Zb(h)}this.aSa=b}Oei(b){this.aSa===b.currentNode&&(this.aSa=null);const h=new Sd.GraphTransaction(7);h.qu(b);b.eh();h.dispose()}F2h(){if(this.aSa&&this.aSa.anchor){const b=ve.GraphIterator.eb(this.aSa);b.tq()&&pl.OutlineReader.o9c(b)&&this.Oei(b);this.aSa=null}}static get $i(){return Gm.PageReader.instance}}Nx.pT=null;Object(u.a)(Nx,"PageContentEditor",null,[1625]);var bp=d(1266),Qq=d(645);class KC extends vx{constructor(){super()}SSj(b,h,n,B,L){let ba=
!1,la=!0;re.SelectionEditor.mf(L)&&(h=Gf.ListItemReader.Hg(b)&&h,L=xb.OutlineElementReader.XA(b,L,!1)&&!xb.OutlineElementReader.XA(b,L,!0),h&&n.Hnf(b,B)&&(ba=!0),we.StaticTheCoauthManager.ud().Jo&&(L||h&&!ba)&&(la=!1));return{RSj:la,Abk:ba}}}Object(u.a)(KC,"CursorMoveValidator",vx,[]);var Ty=d(275);class xo{constructor(b,h,n,B,L){this.DI=L;this.Y3e=b;this.a$=B;this.sxa=h;this.Oh=n}get Md(){return null!=this.k6g?this.k6g:this.k6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Lj(){return null!=
this.W5g?this.W5g:this.W5g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Vb(){return null!=this.L7g?this.L7g:this.L7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get ei(){return null!=this.a5g?this.a5g:this.a5g=Ya.a.instance.Oa("Box4.Styles.StyleSettings")}get fu(){return this.a$.value}get Kf(){return this.Oh.value}get Ws(){return this.sxa}FTm(b){const h=window.performance.now(),n=new vk.ScriptSharpLegacyMap,B=new Vn.a,L=new vk.ScriptSharpLegacyMap;if(b&&
b.Ex){var ba=null;for(let la=0;la<b.length;la++){const La=b.getContext(la);ba=ba||Object($n.a)().Iu(La.node);let fb;if(!({groupId:fb}=this.Xop(La.node,ba)).returnValue)continue;let Cb;n.mb(fb)||(Cb=[],n.add(fb,Cb));Cb=n.J(fb);Cb.push(La)}for(const la of Sl.toArray(n.keys))b=n.J(la),ba=new ve.GraphIterator,ba.set(b[0].node),({dHj:b,ft:ba}=this.sxa.uop(ba)).returnValue?(n.Z(la,b),L.add(la,ba)):B.add(la)}x.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",
window.performance.now()-h));return{returnValue:n,ITm:B,HTm:L}}pLb(b){return this.qll(b)}tec(b){return this.Qkl(b)}QUd(b,h,n=!0){return ve.GraphIterator.qfa(()=>{var B=!1;if(Gf.ListItemReader.Hg(b))return this.Hnf(b,h,n);B||(Ga.OutlineElementNavigator.Le(b),B=ea.ParagraphReader.Bh(b)||xh.TableReader.isTable(b),Ga.OutlineElementNavigator.he(b),B=B&&this.pll(b,h));return B})}Hnf(b,h,n=!0){return ve.GraphIterator.qfa(()=>{const B=xb.OutlineElementReader.OKa(b),L=pl.OutlineReader.K_(b.currentNode);if(n?
!this.Omn(b,h):!this.Pmn(b,h))return!1;var ba=ve.GraphIterator.eb(b.currentNode);if(0<h&&ba.zb(14)){ba.ld(16);var la=ba.currentNode;const La=Ng.TableCellReader.KOf(ba);ba.ld(14);const fb=ba.currentNode;ba=uq.a.nP(la,fb,Lc.a.sV,Lc.a.Aa,0);la=uq.a.nP(la,fb,Lc.a.CY,Lc.a.Ba,0);ba=ri.a.gA(ba,0);la=ri.a.gA(la,0);return B+L<La-ba-la}return!0})}pll(b,h){const n=xb.OutlineElementReader.OKa(b);var B=xb.OutlineElementReader.pI(b);if(0<h){h=pl.OutlineReader.K_(b.currentNode);B=0;const {rp:La,marginLeft:fb,marginRight:Cb}=
xo.r8d(b.currentNode);var L=ve.GraphIterator.eb(b.currentNode);Ga.OutlineElementNavigator.Le(b);if(xh.TableReader.isTable(b)){B=xh.TableReader.$aa(b);var ba=0;for(var la of B)ba+=la;B=ri.a.gA(ri.a.nf(ba,0),0)}Ga.OutlineElementNavigator.he(b);return L.zb(14)?(L.ld(16),la=L.currentNode,b=Ng.TableCellReader.KOf(L),L.ld(14),ba=L.currentNode,L=uq.a.nP(la,ba,Lc.a.sV,Lc.a.Aa,0),la=uq.a.nP(la,ba,Lc.a.CY,Lc.a.Ba,0),L=ri.a.gA(L,0),la=ri.a.gA(la,0),n+h<b-L-la-B):n+h<La-fb-Cb-B}return 0<n-B}xZa(b,h){this.sqj(b,
-1*Math.abs(h))}VYc(b,h){this.sqj(b,Math.abs(h))}HSl(b,h,n,B,L){let ba=xo.qej;if(h>=xo.qej){ba=h-=n;const la=B*L,La=Math.abs(la),fb=Math.abs(h)%La;fb&&(ba=0>ba?0>B?ba+fb:ba-(La-fb):0<B?ba-fb:ba+(La-fb));ba+=la;ba+=n;xo.Ope&&(n=xb.OutlineElementReader.v7(b),ba=xo.Ope.Avi(b.currentNode,h+n,ba+n,L,ba<h)-n)}return ba}nll(b,h,n){if(!b||!b.length)return!1;h=n?h?-1:1:this.pxi(b[0].node,h);return this.oll(b,h,n)}G6n(b,h,n){if(!b)return x.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),
8;if(!b.length)return x.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),8;if(!n)return x.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!n.length)return x.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const B=b[0].node;h=this.pxi(B,h);if(!this.lNn(B,n[0],h)||!this.iNn(b,h))return 8;this.fu.u9();return 32}iNn(b,h){for(let n=0;n<b.length;n++){const B=
new ve.GraphIterator;B.set(b[n].node);let L=null;Ga.OutlineElementNavigator.Le(B);if(ea.ParagraphReader.Bh(B)){if(L=B.currentNode,!L)return x.ULS.shipAssertTag(589592461,338,!L,"The paraNode is null for the list OE node"),!1}else if(!ea.ParagraphReader.Bh(B)&&!xh.TableReader.isTable(B))return x.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;B.uc();if(L){if(this.QYm(L)){const ba=L.sE(),la=xb.OutlineElementReader.OKa(B);this.Kf.wEa(B,1,la+
h);ba&&this.Lj.wY(L,ba,this.Md.Mg)}hl.a.getInstance().Fu||L.setValue(Hf.a.NU,new Date)}}return!0}lNn(b,h,n){for(let B=0;B<Uk.a.JI;B++){const L=this.sxa.fz(b,h,B);if(!L)return x.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const ba=L.getValue(Lc.a.fe);ba&&L.setValue(Lc.a.fe,ba+n)}return!0}QYm(b){return b.hasProperty(Lc.a.fe)||b.hasProperty(Lc.a.mu)||b.hasProperty(Lc.a.hC)}Qkl(b){return this.QUd(b,1,!0)}qll(b){return this.QUd(b,-1,!0)}pxi(b,h){var n=new ve.GraphIterator;
n.set(b);const B=xb.OutlineElementReader.OKa(n),L=xb.OutlineElementReader.pI(n),ba=xb.OutlineElementReader.v7(n);n=pl.OutlineReader.K_(b);xo.r8d(b);b=(L?B-L:ba)%n;return h?-1*(b?b:n):n-b>xo.Gdi?xo.Gdi:n-b}Xop(b,h){if(Gf.ListItemReader.Of)return h=Gf.ListItemReader.Osa(b),h=Ty.a.Fkc(null===h||void 0===h?void 0:h.listId),{groupId:h,returnValue:null!=h};let n;const B=new ve.GraphIterator;B.set(b);b=B.Ub(4).getValue(Lc.a.listID);return({id:n}=this.sxa.GAc(b,h)).returnValue?{returnValue:!0,groupId:n}:
{returnValue:!1,groupId:n}}oll(b,h,n){var B=!1;for(let L=0;L<b.length;L++){B=b[L];const ba=new ve.GraphIterator;ba.set(B.node);re.SelectionEditor.rv(ba);if(!xb.OutlineElementReader.Mh(ba))return xo.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.DNb}),!1;if(this.QUd(ba,h,n))B=!0;else return xo.Ec.$b(Tf.a.jhc,{["Reason"]:hf.a.$nf}),!1}return B}sqj(b,h){if(this.QUd(b,h,!0)){var n=!1;if(Gf.ListItemReader.Hg(b)){var B=new ve.GraphIterator;B.hd(b);this.Ws.RX(B);var L=B.currentNode;B.uc();n=!0;const {listId:la,listLevel:La}=
Gf.ListItemReader.Osa(b);var ba=this.ULm(la,La+h);if(ba)Ga.OutlineElementNavigator.Le(B),ea.ParagraphReader.Bh(B)&&xo.kJ.VN(ba,B.currentNode,!1),B.uc();else{ba=null;let fb;Ga.OutlineElementNavigator.Le(B);ea.ParagraphReader.Bh(B)&&(ba=B.currentNode);B.uc();fb=ba?ba.sE():null;ba||(Ga.OutlineElementNavigator.Le(B),ea.ParagraphReader.Bh(B)&&(ba=B.currentNode),B.uc());ba&&(ba.hasProperty(Lc.a.fe)&&ba.removeProperty(Lc.a.fe),ba.hasProperty(Lc.a.mu)&&ba.removeProperty(Lc.a.mu));hl.a.getInstance().Wr||L.setValue(Lc.a.listLevel,
La+h);hl.a.getInstance().Fu&&this.DI.L_b(ba,la,La+h);hl.a.getInstance().Wr||L.removeProperty(Lc.a.O3);ba&&fb&&(this.Lj.wY(ba,fb,this.Md.Mg),this.fu.u9());this.Kfp(b,Gf.ListItemReader.Of?ba:L)}}n||(n=xb.OutlineElementReader.OKa(b),B=xb.OutlineElementReader.pI(b),L=pl.OutlineReader.K_(b.currentNode),h=this.HSl(b,n,B,h,L),this.Kf.wEa(b,1,h))}}Pmn(b,h){const n=xb.OutlineElementReader.OKa(b),B=xb.OutlineElementReader.pI(b),L=xb.OutlineElementReader.v7(b),{rp:ba,marginLeft:la,marginRight:La}=xo.r8d(b.currentNode);
if(0<h){if(b=ba-la-La,L&&L+h+$e.App.uFa>b||n+h+$e.App.uFa>b)return!1}else if(L&&0>n+h||0>n-B+h)return!1;return!0}Omn(b,h){var n=this.fu.uE(b);const B=n.level+h;if(Cw.a.Rwn<B||B<Cw.a.O$l)return!1;n=this.Ws.fz(b.currentNode,n.listID,B);if(!n)return x.ULS.shipAssertTag(590700875,338,!!n),!1;if(0<h&&n.hasProperty(Lc.a.fe)){h=n.getValue(Lc.a.fe);const {rp:L,marginLeft:ba,marginRight:la}=xo.r8d(b.currentNode);if(h+$e.App.uFa>L-ba-la)return!1}return!0}ULm(b,h){const n=this.Vb.ko();let B;this.ei.qr&&(B=n.uy());
for(let ba=0;ba<n.JG;ba++){var L=void 0;this.ei.qr?(L=B.rla(ba),L=n.gh(this.Vb.Ae(L))):L=n.yBa(ba);if(this.Ws.Job(L)&&L.ja(Lc.a.listID,this.fu.Lba+1)===b&&L.ja(Lc.a.listLevel,-1)===h)return L}return null}Kfp(b,h){Ga.OutlineElementNavigator.Le(b);if(ea.ParagraphReader.Bh(b)&&b.currentNode.hasProperty(Lc.a.fe)&&(h=this.Ws.ukc(h))){if(h.hasProperty(Lc.a.mu)){var n=h.getValue(Lc.a.mu);this.Y3e.kyb(b.currentNode,n)}h.hasProperty(Lc.a.fe)&&(n=h.getValue(Lc.a.fe),this.Y3e.wEa(b,1,n));h.hasProperty(Lc.a.hC)&&
(h=h.getValue(Lc.a.hC),this.Y3e.rha(b.currentNode,h))}Ga.OutlineElementNavigator.he(b)}static get kJ(){return null!=xo.k7g?xo.k7g:xo.k7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Ope(){return null!=xo.c3g?xo.c3g:xo.c3g=Ya.a.instance.Oa("WordEditor.ParagraphIndentationUtility")}static get rl(){return xo.uv||(xo.uv=Ya.a.instance.resolve("Box4.IParagraphEditor"))}static set rl(b){xo.uv=b}static get Ec(){return Yc.a.instance}static get Xf(){return Po.a.instance}static r8d(b){var h=
Ym.WordSectionNavigator.instance.FN(b);b=xo.Xf.ev(h);const n=xo.Xf.$J(h);h=xo.Xf.FL(h);return{rp:b,marginLeft:n,marginRight:h}}}xo.Gdi=Fg.a.Ow(.25);xo.uv=null;xo.qej=Fg.a.Ow(-11);Object(u.a)(xo,"OutlineElementIndentationEditor",null,[389,390]);var tt=d(265),Ox;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=3]="table"})(Ox||(Ox={}));Object(u.b)("StyleTargetType",Ox);class ME{constructor(b,h){this.BT=null;this.MM=h;this.ig=b}get rl(){return null!=
this.L2g?this.L2g:this.L2g=Ya.a.instance.resolve("Box4.IParagraphEditor")}get cD(){return null!=this.FXg?this.FXg:this.FXg=Ya.a.instance.resolve("Box4.IFontStylesGalleryCache")}get km(){return null!=this.WXg?this.WXg:this.WXg=Ya.a.instance.resolve("Box4.IFormattingEditor")}get Vb(){return null!=this.M7g?this.M7g:this.M7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get j1(){return this.BT||(this.BT=new Qq.WACStyleSet)}set j1(b){this.BT=b}get rc(){return null!=this.cXg?this.cXg:this.cXg=Ya.a.instance.Oa("Box4.IFeatureHelper")}get rm(){return this.MM.value}get rk(){return null!=
this.dZg?this.dZg:this.dZg=Ya.a.instance.Oa("Box4.IInsertionPointFormatting")}get Vbd(){return this.ig||(this.ig=Ya.a.instance.resolve("Box4.List.IListReader"))}get rg(){return null!=this.zUg?this.zUg:this.zUg=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Md(){return null!=this.B6g?this.B6g:this.B6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Lj(){return null!=this.a6g?this.a6g:this.a6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get cK(){return null!=
this.uYg?this.uYg:this.uYg=Ya.a.instance.resolve("Box4.IBox4GraphWriter")}bMm(b){const h=b.node;var n=this.rk?this.rk.gvi():null;if(n&&!n.equals(S.a.nil)){if(b=h.Lc,!b||(n=this.j1.sla(n,b))&&1!==this.Vb.FF(n))return null}else n=Va.FormattingReader.Cs(b),n=Va.FormattingReader.DBa(n);return n}FYo(b,h){const n=this.Vb.EF(h);n&&n.gh(this.Vb.Ae(b))&&(this.XMg(h,n),this.rk&&(this.rk.txb(),this.rk.oeb(b,h)))}j7k(b,h){if(h)if(h.YOb&&0<h.YOb.length){let L=new Ea.a;for(var n of h.YOb)L.add(n);if(h.e5i){n=Va.FormattingReader.mti(b);
const ba=[];for(var B of n)B.formatting&&B.formatting.uo&&ba.push(B.formatting.uo);if(0<ba.length){B=Dx.APropertySet.SAi(ba);n=new Ea.a;for(const la of L)(!B.hasProperty(la)||h.xvn&&la===ye.a.X0a)&&n.add(la);L=n}}this.rl.ILb(b,!0,L)}else this.rl.ILb(b,!0);else Vc.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}VN(b,h,n,B=!1,L=!1,ba=!1,la=null,La=!1){var fb,Cb,Lb;if(ea.ParagraphReader.Xb(h))if(b)if(this.Vb.v0(b.Qj()))if(2!==this.Vb.FF(b))x.ULS.shipAssertTag(593506381,
324,!1);else{var $b=this.Vb.EF(h);if($b){var tc=this.Vb.Ae(b);if(!tc)x.ULS.shipAssertTag(593506377,324,!1);else if($b.gh(tc)){var Nc=null,dd=np.a.instance.J(1)&&!B?h.sE():null;n||((null===la||void 0===la?0:la.Ikl)&&(null===(fb=this.rc)||void 0===fb?0:fb.isFeatureEnabled(98))?(this.j7k(h,la),hl.a.getInstance().Wr||1!=la.YOb.length||la.YOb[0]!=ye.a.X0a?this.Bvp(h,b,la):Nc=this.rm.Xyj(Nc,h)):(hl.a.getInstance().Wr||(Nc=this.rm.Xyj(Nc,h)),this.rl.ILb(h,!0)));this.XMg(h,$b);L&&(null===dd||void 0===dd?
0:dd.hasProperty(lk.a.Yw))&&dd.removeProperty(lk.a.Yw);Gf.ListItemReader.Of&&!hl.a.getInstance().Wr&&this.BTh(b,h,Nc,La);(null===(Cb=this.cK)||void 0===Cb?0:Cb.Mca)?this.cK.Mca(h,lk.a.Yw,b.id):h.properties.setValue(lk.a.Yw,b.id);(La||(Gf.ListItemReader.Of?Gf.ListItemReader.isListItem(h):this.Vbd.Hfa(h)))&&(null===(Lb=this.rc)||void 0===Lb?0:Lb.isFeatureEnabled(98))&&this.c7j(h,b,la);h.iQ=b;h.NOa=null;for(n=0;n<h.qa.length;n++)h.qa.J(n).formatting&&h.qa.J(n).formatting.xSb();Gf.ListItemReader.Of||
this.BTh(b,h,Nc,La);null!=this.cD&&this.cD.iyc(tc);B||!dd||ba||this.Lj.wY(h,dd,this.Md.Mg);Gf.ListItemReader.Of&&this.Vbd.Job(b)&&this.rm.u9()}}else x.ULS.shipAssertTag(593506379,324,!1)}else x.ULS.shipAssertTag(593506382,324,!1);else x.ULS.shipAssertTag(593506383,324,!1);else x.ULS.shipAssertTag(593506384,324,!1)}BTh(b,h,n,B){this.Vbd.Job(b)&&(n||(n=new ve.GraphIterator,n.set(h),n.Jd(),Ga.OutlineElementNavigator.he(n)),B||Gf.ListItemReader.Hg(n)||(h.qg(Lc.a.fe,Lc.a.IP,Lc.a.hC,Lc.a.f4,Lc.a.jZa,Lc.a.Jx),
this.VSd(n,b)))}Bvp(b,h,n){let B;hl.a.getInstance().Wr||(B=this.Vbd.Hfa(b));const L=this.Vbd.Job(h);if(!hl.a.getInstance().Wr&&B||Gf.ListItemReader.Of&&Gf.ListItemReader.isListItem(b))this.c7j(b,h,n),hl.a.getInstance().Wr||!B||L||B.removeProperty(Lc.a.O3)}c7j(b,h,n){const B=b.Lc;if(b=this.rg.m8a(b)){var L=null==b.uo?new tt.a:b.uo.clone();ok.a.Syp(L,h,n&&!n.e5i&&n.YOb?n.YOb:null);L.cMa?h=B.QP(L,!0):(B.ou(L,null),h=L);b.Dk=h.id}else x.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}VSd(){}Iod(b,
h){if(h){x.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var n=this.Vb.EF(h);n?(ok.a.ei.qr?(b=n.uy().zBa(b),n=n.gh(this.Vb.Ae(b))):n=n.XKa(b),n?this.Vb.v0(n.Qj())?this.VN(n,h,!1,void 0,void 0,void 0,null):x.ULS.shipAssertTag(593506368,324,this.Vb.v0(n.Qj())):x.ULS.shipAssertTag(593506369,324,!!n)):x.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else x.ULS.shipAssertTag(593506372,324,!1)}rpf(b,h=!1,n=!1){const B=this.Vb.EF(b).gh(ln.StyleReader.wordStyleIdNormal);
this.VN(B,b,h,void 0,n)}XMg(b,h){(b=Object($n.a)().Iu(b))&&h.RAg(b)}Fei(b){var h=null;if(!b||!b.count)return x.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=ok.a.Mp(),!h))return x.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var n=this.j1.cla(h);if(!n)return x.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var B=new Map;B.set("NumberOfStyles",b.count.toString());B.set("Source","DeleteStyleAPI");
oa.Health.instance.recordKpiUsage(yq.a.VGe,0,yq.a.bD,B);B=0;const L=(new Date).getTime();var ba=null;let la=null,La=null,fb=null;const Cb=this.rc.isFeatureEnabled(32)&&!0;Cb&&(ba=new ob.a,la=new ob.a,La=new ob.a,fb=new ob.a);for(var Lb of b){if(!Lb)return x.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const $b=n.mWa(Lb);if(!$b||!this.Vb.ke($b,n))return x.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!$b,!!$b&&this.Vb.ke($b,n)),!1;const tc=
this.Vb.FF($b);if(2!==tc&&1!==tc)return x.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",tc),!1;const Nc=this.Vb.skc($b,n);let dd=0;if(Nc){if(!this.Vb.ke(Nc,n))return x.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;dd=this.Vb.FF(Nc);if(2!==dd&&1!==dd)return x.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",tc,dd),!1}else x.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");
let Hd=this.nNb($b,n);if(!Hd)return!1;B++;Cb&&(1===tc?(la.add(Lb),fb.add($b.id)):(ba.add(Lb),La.add($b.id)));if(Nc){Hd=this.nNb(Nc,n);if(!Hd)return!1;B++;Cb&&(1===dd?(la.add(this.Vb.Ae(Nc)),fb.add(Nc.id)):(ba.add(this.Vb.Ae(Nc)),La.add(Nc.id)))}}Fx.a.qnc();n=ok.a.vOf(n);Lb=new Sd.GraphTransaction(15);Lb.Ab(h);Cb&&this.Nzo(ba,la,La,fb,h);h.setValue(lk.a.Jha,n);Vc.b(572302817,3018,50,String.format("Style Object Ids - {0}",n));Lb.Axe();Lb.dispose();h=(new Date).getTime();ba=new Map;ba.set("Source","DeleteStyleAPI");
ba.set("NumberOfStyles",b.count.toString());ba.set("TrueStyleCount",B.toString());ba.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new rb.a,{extendedProperties:ba,durationMs:h-L});oa.Health.instance.recordKpiSuccess(yq.a.VGe,b);return!0}Nzo(b,h,n,B,L){if(b&&b.count||h&&h.count)if(L){var ba=(new Date).getTime();if(L=this.gqm(L)){for(;L.moveNext();){if(!ea.ParagraphReader.Bh(L.iterator))continue;const la=L.currentNode;this.wzo(la,b,n);this.xzo(la,h,B)}n=(new Date).getTime();x.ULS.sendTraceTag(591148963,
3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",n-ba));B=new Map;B.set("Source","DeleteStyleRemoveStylesReferences");B.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new rb.a,{extendedProperties:B,durationMs:n-ba});oa.Health.instance.recordKpiSuccess(yq.a.VGe,b)}}else Vc.b(577520338,3018,50,"PageContentNode not provided.");else Vc.b(577520337,3018,50,"No style IDs provided")}wzo(b,h,n){if(h&&h.count&&b){var B=b.Kx;B&&B.hasProperty(lk.a.Yw)&&n.contains(B.getValue(lk.a.Yw))&&
(B.removeProperty(lk.a.Yw),b.Kx=B,b.sE()&&this.Lj.wY(b,b.sE(),this.Md.Mg));(n=this.Vb.Eq(b))&&(n=this.Vb.Ae(n))&&h.contains(n)&&this.rpf(b,!0,!0)}}xzo(b,h,n){if(b&&b.qa&&b.qa.length&&h&&h.count)for(let la=0;la<b.qa.length;la++){var B=b.qa.J(la);if(B&&B.formatting&&(B=B.formatting)&&B.Jb){var L=Va.FormattingReader.DBa(B);L&&(L=this.Vb.Ae(L))&&h.contains(L)&&this.km.jpf(B);if(L=B.Jb.No){var ba=L.uo;ba&&(ba=ba.clone(),ba.hasProperty(lk.a.Gw)&&n.contains(ba.getValue(lk.a.Gw))&&this.Cxo(b,ba,L,B));np.a.instance.J(1)&&
(ba=la===b.qa.length-1?b.characterData.length:b.qa.J(la+1).cp,this.Lj.H_b(b,B.Jb,B.Jb.cp,ba,L,B,this.Md.Mg))}}}}Cxo(b,h,n,B){b&&h&&n&&B&&(b=b.Lc)&&(h.removeProperty(lk.a.Gw),h.cMa?h=b.QP(h,!0):b.ou(h,null),n.Dk=h.id,B.Jb.No=n)}gqm(b){if(!b)return null;b=ve.GraphIterator.eb(b);return b.tq()?Ff.a.Ft(b,b.origin):null}nNb(b,h){if(!b)return x.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var n=b.Qj();return this.Vb.v0(n)?h.Osg(b)?!0:(n=new Map,n.set("Source","DeleteStyle"),
n.set("StyleType",Ox[this.Vb.FF(b)]),n.set("IsCustomStyle",this.Vb.ke(b,h).toString()),n.set("IsLinkedStyle",(!!this.Vb.skc(b,h)).toString()),b=Object.assign(new rb.a,{extendedProperties:n}),oa.Health.instance.recordKpiFailure(yq.a.VGe,"UnableToDeleteStyle",!1,!0,b),x.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(x.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}DYa(b,h,n,B){if(this.rc&&this.rc.isFeatureEnabled(77)){if(!b)return x.ULS.sendTraceTag(591138959,
3018,15,"No style IDs provided for delete."),!1;if(!n&&(n=ok.a.Mp(),!n))return x.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const ba=this.j1.cla(n);if(!ba)return x.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=ba.mWa(b);if(!b)return x.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var L=this.Vb.FF(b);if(2!==L&&1!==L)return x.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",
L),!1;oa.Health.instance.recordKpiUsage(yq.a.oPg,0,yq.a.bD,new Map([["Source","ModifyStyleAPI"]]));L=Date.now();const la=new Sd.GraphTransaction(15);let La,fb;try{la.Ab(n);if(!(B&&0!=B.length||h&&0!=h.count))return!1;if(B&&0!=B.length&&(La=ok.a.M3c(b),!ba.Vwf(b,B)))return this.pMa("ModifyStyleAPI",b,ba,L,"UnableToDeleteStyleProperties"),!1;if(h&&0!=h.count){const Nc=ba.WMg(b,h);fb=ok.a.M3c(b);if(!Nc)return this.pMa("ModifyStyleAPI",b,ba,L,"UnableToModifyStyle"),!1}this.nNn(b,n,fb,La);Fx.a.qnc();const Cb=
ok.a.vOf(ba);n.setValue(lk.a.Jha,Cb);Vc.b(572302818,3018,50,String.format("Style Object Ids - {0}",Cb));const Lb=Date.now(),$b=new Map([["Source","ModifyStyleAPI"]]),tc=Object.assign(new rb.a,{extendedProperties:$b,durationMs:Lb-L});oa.Health.instance.recordKpiSuccess(yq.a.oPg,tc);return!0}finally{la&&la.dispose()}}return!1}nNn(b,h,n,B){var L,ba;if(null!==b){var la;B&&((la=null===(L=this.rm)||void 0===L?void 0:L.Etd(h,B,b,!0))||Vc.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));
n&&((la=null===(ba=this.rm)||void 0===ba?void 0:ba.Etd(h,n,b,!1))||Vc.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}pMa(b,h,n,B,L){const ba=Date.now(),la=!!this.Vb.skc(h,n);b=new Map([["Source",b],["StyleType",Ox[this.Vb.FF(h)]],["IsCustomStyle",this.Vb.ke(h,n).toString()],["IsLinkedStyle",la.toString()]]);B=Object.assign(new rb.a,{extendedProperties:b,durationMs:ba-B});oa.Health.instance.recordKpiFailure(yq.a.oPg,L,!1,!0,B)}}Object(u.a)(ME,"WACStyleEditor",
null,[1649]);class NE extends ME{constructor(b,h,n){super(b,n);this.a$=h}get fu(){return this.a$.value}VSd(b,h){this.fu.VSd(b,h)}}Object(u.a)(NE,"WACStyleEditor",ME,[]);class LC{feb(b,h){b.properties.setValue(Lc.a.marginTop,h)}deb(b,h){b.properties.setValue(Lc.a.marginBottom,h)}Ena(b,h){b.properties.setValue(Lc.a.marginLeft,h)}eeb(b,h){b.properties.setValue(Lc.a.marginRight,h)}sAg(b,h){b.properties.setValue(Lc.a.rp,h)}rAg(b,h){b.properties.setValue(Lc.a.qw,h)}xOj(b,h){b.properties.setValue(Lc.a.u5i,
h)}D_b(b,h){b.properties.setValue(ye.a.GG,h)}ERo(b,h){b.properties.setValue(ye.a.vra,h)}$wc(b,h){b.properties.setValue(ye.a.WH,h)}iYo(b,h){b.properties.setValue(ye.a.separator,h)}}Object(u.a)(LC,"WordSectionEditor",null,[234]);class Qz{get name(){return"WordEditor.OutlineLevelEditors"}wc(b){b.ia("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new LC).as("Box4.IWordSectionEditor").ha();A.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ia("Box4.OutlineLevelEditors.PageContentEditor",
()=>new Nx(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").ha(),b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new xo(Hv.a.iWa,b.resolve("WordEditor.List.IFlatListReader"),b.rf("Box4.IOutlineElementEditor"),b.rf("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("Box4.IOutlineElementIndentationEditor"),b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new xo(Hv.a.iWa,b.resolve("WordEditor.List.IFlatListReader"),
b.rf("Box4.IOutlineElementEditor"),b.rf("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),b.ia("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new KC).as("Box4.List.ICursorMovementValidator").ha(),b.ia("Box4.Styles.WACStyleReader",()=>new bp.a(new Qq.WACStyleSet)).as("Box4.Styles.IWACStyleReader").ha(),b.ia("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new NE(b.resolve("Box4.List.IListReader"),
b.rf("WordEditor.IFlatListEditor"),b.rf("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").ha())}init(){}dispose(){}static main(){M.a.instance.Jc(new Qz)}}Object(u.a)(Qz,"WordEditorOutlineLevelEditorsPackage",null,[0,1]);var OE=d(637),Rz=d(232);class un{constructor(b,h){this.Nd=b;this.Oh=h;this.HSa=null}M_b(b){const {listId:h,listLevel:n}=Gf.ListItemReader.vLf(b,{vka:0,HJa:-1});if(0<h&&0<=n)this.HSa=b;else{var B=1;const L=b.listStyle;42!==L&&0<L&&(B=L);this.HSa=ms.a.s_(b.listType,B,null,
h,n,void 0,"")}B=new EC.a;switch(b.r9){case 0:this.HSa.xD=B.stf();break;case 2:this.HSa.xD=B.H9h(B.BYh,B.AYh);break;case 1:this.HSa.xD=B.muf(B.hdg,B.idg)}}EWo(b){b&&(this.HSa=b)}aai(b){var h=Yc.a.instance.rq(wb.a.ZGl);xb.OutlineElementReader.Mh(b)||(x.ULS.sendTraceTag(508904658,393,15,"PossiblyIncorrectListCreation - createList called with a non OE iterator"),Yc.a.instance.$b("PossiblyIncorrectListCreation",{["Reason"]:hf.a.DNb}));Gf.ListItemReader.Hg(b)&&(x.ULS.sendTraceTag(508904657,393,15,"PossiblyIncorrectListCreation - createList called when OE already has list"),
Yc.a.instance.$b("PossiblyIncorrectListCreation",{["Reason"]:hf.a.pzl}));const n=xb.OutlineElementReader.uU(b);n&&!n.hasProperty(Lc.a.msa)&&x.ULS.sendTraceTag(560563602,393,50,"Paragraph has null EOP formatting during creation of list node.");if(Gf.ListItemReader.Of&&b.Ub(4))return x.ULS.sendTraceTag(508412242,393,15,"PossiblyIncorrectListCreation - createList called when OE already has numberListNode"),h=b.currentNode,b.uc(),h;Gf.ListItemReader.Of&&b.Ub(31)&&b.eh();const B=this.cHl();b.Uf(B,4);n&&
(n.sF=B);h.end();return B}cHl(){return Ht.a.instance.createInstance(pk.a.$bb)}eha(b){const h=Yc.a.instance.rq(wb.a.eha);xb.OutlineElementReader.Mh(b)||Yc.a.instance.$b("PossiblyIncorrectListRemoval",{["Reason"]:hf.a.DNb});Gf.ListItemReader.Hg(b)&&(hl.a.getInstance().Fu?this.ona(b):this.KCj(b));h.end()}KCj(b){this.Nd.RX(b);b.eh()}Tqa(b,h,n,B=!1){const L=Yc.a.instance.rq(wb.a.q7k);this.uPj(b,n,B);const ba=b.hasProperty(zd.a.ogj);var la=b.ja(zd.a.Ade,!1);let La=!1;1===n.gt&&n.Wta&&!n.UL&&(La=!0);const fb=
n.qf.ja(Lc.a.Tw,null);fb&&fb===Box4Intl.Box4Strings.L_ListStyleNone&&(1===n.listType?La=n.Wta&&!n.UL:n.listType||(La=!n.listStyle));if(la)La&&(n.Kca(16,0),b.setValue(zd.a.cC,16),b.setValue(zd.a.jYa,0));else{la=this.Nd.Nw(h);this.DTj(n,la,ba,La)&&(L.properties.Z("ToggledOff","true"),n.Kca(16,0),this.rVo(b));if(!this.nqe(b,h,n,B))return L.end(),x.ULS.sendTraceTag(578331472,393,15,"Failed in performing auto correct numbering."),{returnValue:!1,cCa:n};!n.listType&&b.hasProperty(zd.a.hbb)&&(n.ED=b.getValue(zd.a.hbb),
b.removeProperty(zd.a.hbb))}if(ba&&(L.properties.Z("MultipleOESelection","true"),({cCa:n}=this.m4o(h,n)).returnValue))return L.end(),x.ULS.sendTraceTag(578331473,393,15,"Multiple OE selected and OE is empty as well."),{returnValue:!1,cCa:n};this.a3k(h,n,b,B);iu.uGj();b.hasProperty(hi.a.JT)&&iu.zDl(b.getValue(hi.a.JT),h,this.Nd);b.setValue(zd.a.Ade,!0);L.end();return{returnValue:!0,cCa:n}}DTj(b,h,n,B){if(B)return!0;if(h){B=b.listType===h.listType;const L=!b.listStyle&&b.ED===Uk.a.Ik;let ba=b.listStyle===
h.listStyle&&b.ED===h.ED;b=(!b.Wta||this.Nwg(h,b))&&!n;ba=ba&&b;return B&&(L||ba)}return!1}rVo(b){b.setValue(zd.a.cC,16);b.setValue(zd.a.jYa,0)}Nwg(){return!0}uPj(){}nqe(){return!0}m4o(b,h){return{returnValue:16!==h.listType&&xb.OutlineElementReader.isEmpty(b,!0),cCa:h}}EVc(b){const h=Yc.a.instance.rq(wb.a.EVc);ea.ParagraphReader.Xb(b)||Yc.a.instance.$b("ClearingListFromNonParagraph",{["Reason"]:hf.a.lzf});const n=new ve.GraphIterator;n.set(b);n.Jd();n.qt(12);Ga.OutlineElementNavigator.he(n);this.ona(n);
h.end()}merge(b,h,n){const B=Yc.a.instance.rq(wb.a.zzn);xb.OutlineElementReader.Mh(h)||Yc.a.instance.$b("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});xb.OutlineElementReader.Mh(b)||Yc.a.instance.$b("PossibleIncorrectMergeOfOEs",{["Reason"]:"DestIsNotOE"});Gf.ListItemReader.Hg(h)&&(B.properties.Z("UseSourceListWithNonlistDestination",n.toString()),n&&Gf.ListItemReader.Hg(b)&&this.eha(b),Gf.ListItemReader.Hg(b)&&!n?this.dwj(h,b):n&&(n=this.FBi(h),1===n.gt&&n.Uof(!0),this.rdc(b,n),B.properties.Z("MoveListInfoFromSrcToDestOE",
"true")),this.eha(h),B.properties.Z("RemoveListFromSrcOE","true"));B.end();return!0}dwj(){}FBi(b){return this.Nd.Nw(b)}J_c(b,h){h.hasProperty(zd.a.cC)||(b===wb.a.WE?h.setValue(zd.a.cC,1):(b===wb.a.XN||b===wb.a.Ega)&&h.setValue(zd.a.cC,0));h.hasProperty(zd.a.jYa)||h.setValue(zd.a.jYa,0);return h}Jdc(b,h,n,B,L,ba,la,La){const fb=Yc.a.instance.rq(wb.a.Jdc),Cb=this.Nd.Nw(h);n=ms.a.s_(0,n,void 0,void 0,void 0,la);n.ED=B;n.JT=ba;Cb&&n.ESf(Cb)&&n.ED===Cb.Sw||(B=new Sd.GraphTransaction(15),B.qu(h),La.USn(n.listType,
n.listStyle,n.ED,n.levelText,n.JT)&&(un.rg.Ne(L,""),!Gf.ListItemReader.Of&&ea.ParagraphReader.Xb(b)&&Rz.a.Xla(b)&&(h=this.Nd.Hfa(b))&&un.rg.a1l(b,h)),B.dispose());fb.end()}Etd(b,h,n,B=!1){if(null===n||null===b||null===h)return!1;b=this.Nd.fz(b,h.listId,h.listLevel);if(!b)return x.ULS.sendTraceTag(523069061,393,15,"List def not exist when trying to update pStyle Property."),!1;if(B){if(b.hasProperty(lk.a.Yw)){b.getValue(lk.a.Yw)instanceof S.a||x.ULS.sendTraceTag(512267811,393,15,"StyleObject ID already in list def is not ExtendedGuid.");
if(!S.a.Bt(b.getValue(lk.a.Yw),n.id))return x.ULS.sendTraceTag(523069062,393,15,"List def has different pStyle than what we are expecting to remove, thus not removing it."),!1;b.removeProperty(lk.a.Yw);return!0}}else{n=n.id;n instanceof S.a||x.ULS.sendTraceTag(512267810,393,15,"StyleObject ID to be set on list def is not extendedGuid");if(b.hasProperty(lk.a.Yw))return x.ULS.sendTraceTag(523069063,393,15,"List def has different pStyle than what we are expecting to set, thus not setting it."),!1;b.setValue(lk.a.Yw,
n);return!0}return!1}static get Vic(){return null!=un.zXg?un.zXg:un.zXg=Ya.a.instance.Oa("Box4.IFontSlotProvider")}static get rg(){return null!=un.rUg?un.rUg:un.rUg=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Xr(){return hl.a.getInstance()}}Object(u.a)(un,"ListEditor",null,[262]);var Uy=d(870),et=d(339);class ft{constructor(b,h,n,B,L,ba){this.ig=L;this._pageContent=n;this.$Fb=Array(ft.JI);this.Iac=Array(ft.JI);this.lGh=Array(ft.JI);this.b7e=Array(ft.JI);this.xCh=Array(ft.JI);
this.f6=B;this.ARc=ba;for(B=0;B<ft.JI;B++){var la=this.L3c(b,B,n,L);la?(ba=la.ja(Hf.a.PU,Uk.a.Ik),la=la.ja(Lc.a.KZb,Uk.a.Ik)):la=ba=Uk.a.Ik;this.Iac[B]=ba!==Uk.a.Ik?ba:Uk.a.H7a;this.b7e[B]=la===Uk.a.Ik?B-1:la-1;ft.Oba(h)&&(this.lGh[B]=Uk.a.Ik,this.xCh[B]=Uk.a.Ik);this.$Fb[B]=this.Iac[B]}}L3c(b,h,n,B){B.d7(n);return hl.a.getInstance().U8c&&this.ARc?this.ig.FLf(b,h,this.f6,n):this.ig.O3c(b,h,n.Lc,n)}restart(b){this.$Fb[b]=this.Iac[b]}yle(b){for(var h=0;h<b;h++)this.$Fb[h]===this.Iac[h]&&this.$Fb[h]++;
for(h=b+1;h<ft.JI;h++)this.b7e[h]>=b&&this.restart(h);return this.$Fb[b]++}static Oba(b){return!!b&&b.isFeatureEnabled(67)}}ft.JI=9;Object(u.a)(ft,"AWordList",null,[1807]);class PE{constructor(b,h,n,B){this.yjb=new vk.ScriptSharpLegacyMap;this.ig=b;this.QM=h;this.f6=n;this.ARc=B}Nw(b,h){this.yjb.mb(b)||this.yjb.Z(b,new ft(b,h,this.QM,this.f6,this.ig,this.ARc));return this.yjb.J(b)}Zrc(b,h,n){return this.Nw(b,n).yle(h)}}Object(u.a)(PE,"AListNumberingMap",null,[1806]);class QE extends ft{constructor(b,
h,n,B,L,ba){super(b,h,n,B,L,ba)}DMf(b,h,n,B){B.d7(n);return hl.a.getInstance().U8c&&this.ARc?this.ig.Jym(b,h,this.f6):this.ig.Iym(b,h,this._pageContent.Lc)}vtd(b,h,n){var B=this.DMf(b,h,this._pageContent,this.ig);B?(b=B.ja(Hf.a.PU,Uk.a.H7a),B=B.ja(Lc.a.KZb,Uk.a.Ik),this.$Fb[h]=this.lGh[h]=this.Iac[h]=b,B!==Uk.a.Ik&&(this.xCh[h]=this.b7e[h]=B-1)):n&&(B=this.L3c(b,h,this._pageContent,this.ig),b=Uk.a.H7a,B&&(b=B.ja(Hf.a.PU,Uk.a.H7a)),this.$Fb[h]=this.Iac[h]=b)}}Object(u.a)(QE,"WordList",ft,[]);class Sz extends PE{constructor(b){super(b.Nd,
b.Sh,b.GD,b.r$j);this.NAh=new ob.a}wLf(b,h,n){let B;hl.a.getInstance().u0?{value:B}=this.ig.eH.Dc(b,B):{value:B}=this.ig.N3.Dc(b,B);this.yjb.mb(B)||this.yjb.Z(B,new QE(b,n,this.QM,this.f6,this.ig,this.ARc));if(!this.NAh.contains(b))for(this.NAh.add(b);h<Uk.a.JI;h++)this.yjb.J(B).vtd(b,h,!1);else if(!h)for(h+=1;h<Uk.a.JI;h++)this.yjb.J(B).vtd(b,h,!0);return this.yjb.J(B)}Zrc(b,h,n){return ft.Oba(n)?this.wLf(b,h,n).yle(h):super.Zrc(b,h,n)}}Object(u.a)(Sz,"ListNumberingMap",PE,[]);class RE{constructor(){this.ovb=
0;this.cbk=!1}}Object(u.a)(RE,"LastNumber",null,[]);var SE=d(407);class hq{constructor(b,h,n,B){this.Fle=!1;this.fu=b;this.VZi=n;this.xnc=B;this.Mx=this.fu.uE(h);this.jS=new ve.GraphIterator;this.jS.hd(h)}static get Nd(){return hq.ig||(hq.ig=Ya.a.instance.resolve("Box4.List.IListReader"))}static set Nd(b){hq.ig=b}static get Xr(){return hl.a.getInstance()}static a9l(b,h,n,B=!1,L=!1){var ba=h.currentNode;let la=null,La=!1,fb=!1;h=h.O2b();const Cb=Ff.a.iq(h);Cb.moveNext();for(h=Cb.iterator;h.currentNode!==
ba;){let $b=fb=La=!1;var Lb=hq.QXl(h);if(xb.OutlineElementReader.Mh(h)&&!Lb){Lb=!1;if(h.fv(4))if(hq.Cij(h,n,!0,B,L)){if($b=!0,la=new hq(b,h,!1,!1),Cb.moveNext(),Cb.iterator===ba&&(La=!0),B)break}else xb.OutlineElementReader.isEmpty(h,!1)||(Lb=!0),fb=!0;else!xb.OutlineElementReader.isEmpty(h,!1)&&h.Jrb(12)&&(xb.OutlineElementReader.ZT(h)||(Lb=!0));!B&&Lb&&la&&(n.qf.hasProperty(Lc.a.listLevel)?la.Mx.level=0:la=null)}$b||Cb.moveNext();h=Cb.iterator}la&&(la.xnc=La);if(!la&&h.Lf(1))for(ba=!0;h.currentNode;){if(xb.OutlineElementReader.Mh(h)){if(h.fv(4)&&
hq.Cij(h,n,!1,B,L)){la=new hq(b,h,!0,ba);break}if(!xb.OutlineElementReader.isEmpty(h,!1))break}if(!h.Lf(1))break;ba=!1}la&&(la.Fle=fb);return la}static QXl(b){var h=b.Ub(2);if(!h)return!1;h=ea.ParagraphReader.Bh(b)&&hq.aon(h);b.uc();return h}static aon(b){return tn.a(b,8)}static Cij(b,h,n,B=!1,L=!1){if(!Gf.ListItemReader.Hg(b)&&(x.ULS.sendTraceTag(508913603,393,15,"Trying to call oeMatchesInfo for non list item"),Gf.ListItemReader.Of))return!1;if(Gf.ListItemReader.Of)var ba=Gf.ListItemReader.y7(b);
else hq.Nd.RX(b),ba=b.currentNode,b.uc();const la=hq.Nd.i3(ba);(b=h.aC===la.aC)&&h.listStyle&&1!==h.gt&&(b=h.listStyle===la.listStyle);b&&(h.Wta&&1!==h.gt||h.ijc||L)&&(b=hq.Qln(h,la),h.aC||(b=b&&h.font===la.font));if(1===h.gt)if(1===la.gt&&la.qf.hasProperty(hi.a.Aub))b=h.r9===la.r9;else return!1;b&&h.aC&&h.ED!==Uk.a.Ik&&(b=la.Sw,n&&(B&&1===h.ED&&1===b||b++),b=h.ED===b);b&&(B||h.ijc)&&(h=Gf.ListItemReader.vLf(h,{vka:0}).listId,ba=Gf.ListItemReader.av(ba,{vka:0}).listId,0<h&&0<ba&&(b=h===ba));return b}static Qln(b,
h){h=h.Z6i;b.Wta&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.Z6i.toLocaleLowerCase()}static b9l(b,h,n){var B=h.currentNode;let L=null;const ba=new ve.GraphIterator,la=b.wBa(B,n);var La=!1;let fb=!1;ba.hd(h);ba.uc();for(ba.Ub(1);ba.currentNode!==B;)fb=La=!1,xb.OutlineElementReader.Mh(ba)&&ba.fv(4)&&(h=b.uE(ba),hq.Dij(h,n,!0)?(L=new hq(b,ba,!1,!1),La=!0):(fb=!0,h.listID===n.listID&&h.level<=la.xdb&&(L=null))),ba.Lf(1);L&&(L.xnc=La);if(!L&&ba.Lf(1))for(B=!0;ba.currentNode;){if(xb.OutlineElementReader.Mh(ba)&&
ba.fv(4)){La=b.uE(ba);if(La.listID===n.listID&&La.level<=la.xdb)break;if(hq.Dij(La,n,!1)){L=new hq(b,ba,!0,B);break}}if(!ba.Lf(1))break;B=!1}L&&(L.Fle=fb);return L}static Dij(b,h,n){let B=b.listID===h.listID&&b.level===h.level;B&&h.Sw!==Uk.a.Ik&&(b=b.Sw,n&&b++,B=h.Sw===b);return B}}hq.ig=null;Object(u.a)(hq,"JoinTargetInfo",null,[]);class zr{constructor(b,h){this.Mx=null;this.action=b;h&&(this.Mx=h)}static ivb(){return new zr(0)}static x7i(){return new zr(1)}static azn(b){return new zr(3,b)}static rzn(b){return new zr(2,
b)}static dzn(b){return new zr(4,b)}}Object(u.a)(zr,"ApplyListInfoResult",null,[]);class TE{constructor(){this.startAt=this.xdb=0}}Object(u.a)(TE,"WordListRestartInfo",null,[]);var MC=d(964);class ku{constructor(b,h,n){this.Gqd=n;this.rgd=h.listID}}Object(u.a)(ku,"ListTransferInfo",null,[]);class os extends un{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc){super(b,n,fb);this.DI=tc;this.OFh=!1;this.VFc=this.Szd=this.c6b=null;this.rAe=(Nc,dd)=>dd.listID===Nc.listID&&dd.level===Nc.level;this.O8o=(Nc,
dd,Hd)=>dd.listID!==Nc.listID&&dd.listID!==Hd.rgd||dd.level!==Nc.level?!1:!0;this.qJn=(Nc,dd,Hd)=>dd.listID===Nc.listID||Hd&&dd.listID===Hd.rgd?!0:!1;this.AVj=(Nc,dd,Hd,xe)=>{this.zVj(Nc,dd,Hd,xe)};this.zVj=(Nc,dd,Hd,xe)=>{hl.a.getInstance().Wr||this.DI.qAb(Nc,Hd);dd=Gf.ListItemReader.Of?dd:Nc;Nc=this.vkc(dd);dd=ve.GraphIterator.eb(dd);dd.Jd();dd.uc();this.pcm(dd,Nc,this.qJn,this.wep,xe)};this.Q8o=(Nc,dd,Hd,xe)=>{const {Mx:je,iterator:he}=this.khc(dd,()=>{hl.a.getInstance().Wr||this.DI.qAb(Nc,Hd);
hl.a.getInstance().Fu&&this.DI.qAb(dd,Hd);var fe=Gf.ListItemReader.Of?dd:Nc;const De=this.vkc(fe);fe=ve.GraphIterator.eb(fe);fe.Jd();fe.uc();return{Mx:De,iterator:fe}});this.A4d(he,je,this.YYj,this.ABe,xe)};this.uep=(Nc,dd,Hd,xe)=>{this.Byj(Nc,dd,Hd,xe)};this.ABe=(Nc,dd,Hd,xe)=>{Hd.listID=dd.listID;xe.Ub(4);const je=this.Ws.gWa(xe.currentNode);this.khc(je,()=>{this.tTc(xe.currentNode,Hd,je);xe.uc()})};this.wep=(Nc,dd,Hd,xe)=>{Gf.ListItemReader.Hg(xe)&&(Nc=new ve.GraphIterator,Nc.hd(xe),Nc.Jd(),this.Nd.RX(Nc),
this.Rbn(xe.currentNode,Nc.currentNode))};this.vep=(Nc,dd,Hd,xe)=>{Hd.listID=dd.listID;this.Byj(Nc,dd,Hd,xe);this.ABe(Nc,dd,Hd,xe)};this.XYj=(Nc,dd)=>dd.listID===Nc.listID;this.tep=(Nc,dd)=>dd.level<=Nc.level;this.YYj=(Nc,dd,Hd)=>dd.listID===Hd.rgd;this.Vp=L;this.sxa=b;this.SDd=h;this.Pc=B;this.ikg={};this.HDk=ba;this.Wd=la;this.hr=La;this.xd=Cb;this.fy=Lb;this.Zv=$b}get Oba(){return this.sxa.Wla}get T0b(){return this.OFh}set T0b(b){this.OFh=b}get Ws(){return this.sxa}get e9(){return this.Zv}get Vb(){return this.fy}get ft(){return this.Ws.ft}get Xq(){return this.Ws.Xq}get Yya(){return this.Ws.Yya}get Lba(){return this.Ws.Lba}set Lba(b){this.Ws.Lba=
b}get cYa(){return this.Ws.cYa}set cYa(b){this.Ws.cYa=b}get fqd(){return null!=this.k4g?this.k4g:this.k4g=Ya.a.instance.Oa("Box4.List.ISingleLevelListEditor")}a3k(b,h,n,B){x.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const L=n.ja(zd.a.Ade,!1);let ba=!1,la=-1;!L||h.listStyle&&1!==h.gt||(ba=!n.ja(zd.a.r2f,!1),la=n.ja(zd.a.f4f,-1));b=this.rdc(b,h,{zRi:ba,Dyn:la,Acm:B,qf:n});L||n.setValue(zd.a.r2f,2===b.action);3===b.action&&!n.hasProperty(zd.a.f4f)&&b.Mx&&n.setValue(zd.a.f4f,
b.Mx.level)}merge(b,h,n,B=null){const L=Gf.ListItemReader.Hg(b)||Gf.ListItemReader.Hg(h);b=super.merge(b,h,n,B);L&&this.u9();return b}dwj(b,h){this.hml(b,h)}hml(b,h){b=Gf.ListItemReader.Of?Gf.ListItemReader.Osa(b,{HJa:-1}).listLevel:this.Nd.zLf(b);const n=Gf.ListItemReader.Of?Gf.ListItemReader.Osa(h,{HJa:-1}).listLevel:this.Nd.zLf(h);-1!==b&&-1!==n&&(b-=n,0<b?this.SDd.value.VYc(h,b):0>b&&this.SDd.value.xZa(h,b,0))}KCj(b){this.Nd.RX(b);b.eh();np.a.instance.J(1)&&this.u9()}cKg(b,h,n,B){var L=ve.GraphIterator.eb(n);
L=this.uE(L);const ba=this.aye(b,L,!hl.a.getInstance().Fu);if(!hl.a.kz){b=this.Ws.Tqb(b.currentNode,L);b.listType||(ba.setValue(un.Xr.lda,L.Sw),ba.setValue(un.Xr.zoa,L.MZc),this.OEj(ba,L,h?n:B));switch(b.listType){case 0:h="Numbering";break;case 1:h="Bullet";break;default:h="Invalid List Type"}A.AFrameworkApplication.va.Ob(wb.a.q2f,2);x.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",h);hl.a.getInstance().Wr||this.DI.L_b(ba,L.listID,L.level)}}uE(b){if(!Gf.ListItemReader.Hg(b)&&(x.ULS.sendTraceTag(508924048,
393,15,"Trying to fetch list Ref info for non list item"),Gf.ListItemReader.Of))return null;let h;Gf.ListItemReader.Of?h=Gf.ListItemReader.y7(b):(this.Nd.RX(b),h=b.currentNode,b.uc());return this.vkc(h)}OVo(b,h){this.Nd.RX(b);const n=b.currentNode;b.uc();hl.a.getInstance().Wr||this.DI.qAb(n,h);b=xb.OutlineElementReader.uU(b);hl.a.getInstance().Fu&&this.DI.qAb(b,h);this.vkc(Gf.ListItemReader.Of?b:n)}vkc(b){var h;const n=new Uy.a;Gf.ListItemReader.Of&&(b&&ea.ParagraphReader.Xb(b)||x.ULS.sendTraceTag(509141474,
393,15,`Paragraph node not sent in getListRefInfoNode. Node sent: ${null===(h=null===b||void 0===b?void 0:b.constructor)||void 0===h?void 0:h.name}`));h=np.a.instance.J(1)?Gf.ListItemReader.Of?Gf.ListItemReader.av(b)||Gf.ListItemReader.ola(b):this.Nd.Q_(b,!1,!0):Gf.ListItemReader.av(b,{vka:0,HJa:-1});n.listID=h.listId;n.level=h.listLevel;n.O3=Gf.ListItemReader.oae(b);h=this.T7d(b);n.yTo(h);n.Sw=Gf.ListItemReader.r$d(b);n.MZc=Gf.ListItemReader.cQf(b);return n}aye(b,h,n=!1){const B=xb.OutlineElementReader.uU(b);
b=hl.a.getInstance().Wr?null:this.aai(b);this.tTc(b,h,B,n);return b}tTc(b,h,n=null,B=!1){hl.a.getInstance().Wr||b||Yc.a.instance.$b("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});!hl.a.getInstance().Fu||B||n||Vc.b(509364259,393,15,"Apply list ref info called without para node");h||Yc.a.instance.$b("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});hl.a.getInstance();hl.a.getInstance().Fu&&n&&!B&&this.DI.L_b(n,h.listID,h.level);hl.a.getInstance().bma&&(n=n||this.Nd.gWa(b),this.DI.$zo(n));
hl.a.getInstance().Wr||(this.DI.L_b(b,h.listID,h.level),h.O3&&b.setValue(Lc.a.O3,!0),hl.a.getInstance().Fu||null==h.levelText||b.setValue(Lc.a.Tw,h.levelText))}e8j(b){this.Ws.d7(b);b=Object($n.a)().Iu(b);let h=b.ja(Lc.a.Xq,null);h=h?Array.clone(h):[];b.setValue(Lc.a.Xq,h);this.Ws.pnc()}eep(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}uym(b){b=b.view;if(!b.lb||!b.lb.gb)return null;b=Hy.OutlineElementGeneralizer.Wka(b.lb.gb,
!1);if(1!==b.length)return null;b=ve.GraphIterator.eb(b.getContext(0).node);if(!Gf.ListItemReader.Hg(b))if(14===b.Xd().type){const h=Gf.ListItemReader.Eyi(b.currentNode);h&&b.set(h)}else Vc.b(589177753,393,15,"Encountered an OE of non list type."),b.uc();b.Jd();return b}JHl(b,h,n,B){const L=b.CL(),ba=new Uy.a;ba.listID=this.tai(b);this.Oba?(ba.bie=un.Xr.u0?this.uai(b):this.kai(b),this.wzj(b,ba.listID,ba.bie)):this.yzj(b,ba.listID);ba.FOj(h.qf,this.Abd(n));this.C1d(b);n=this.BBi(b,h);for(let La=0;9>
La;La++){const fb=new Mq.a;L.td.ou(fb);this.xzj(b,this.Oba?S.a.nil:fb.id,this.Oba?fb.id:S.a.nil);this.hWk(fb,h.aC,La);this.mOh(fb,n,La);var la=B.JUb[La];la=6===la?ms.a.s_(1,1):ms.a.s_(0,la);la.oma&&fb.setValue(Hf.a.g8,la.oma);h.ED!==Uk.a.Ik&&La===ba.level&&fb.setValue(Hf.a.PU,h.ED);B.sKa&&B.sKa[La]&&fb.setValue(Hf.a.font,B.sKa[La]);la=B.Cbd[La];x.ULS.shipAssertTag(22127636,338,!!la);fb.setValue(Lc.a.Tw,la);fb.setValue(Lc.a.wga,B.khe[La]);et.a.Pye(B.r9,fb)}return ba}HHl(b,h,n){const B=b.CL(),L=new Uy.a;
L.listID=this.tai(b);this.Oba?(L.bie=un.Xr.u0?this.uai(b):this.kai(b),this.wzj(b,L.listID,L.bie)):this.yzj(b,L.listID);L.FOj(h.qf,this.Abd(n));if(!h.listStyle)switch(L.level%3){case 0:h.Kca(h.listType,1);break;case 1:h.Kca(h.listType,2);break;case 2:h.Kca(h.listType,3)}this.C1d(b);n=this.BBi(b,h);for(let ba=0;9>ba;ba++){const la=new Mq.a;B.td.ou(la);this.xzj(b,this.Oba?S.a.nil:la.id,this.Oba?la.id:S.a.nil);this.gWk(la,h.aC,ba);this.mOh(la,n,ba);2===ba%3&&h.aC?la.setValue(Lc.a.wga,"right"):la.setValue(Lc.a.wga,
"left");ba===L.level&&(h.oma&&la.setValue(Hf.a.g8,h.oma),h.ED!==Uk.a.Ik&&la.setValue(Hf.a.PU,h.ED),h.aC?this.JOj(h,la,ba):(os.GOj(h,la),os.IOj(h,la)),os.HOj(h,la),h.ijc&&la.bAa(h.qf,Lc.a.listID,Lc.a.listLevel))}return L}JOj(b,h,n){b.Wta?(b=b.levelText,b=F.a.replaceAll(b,"%1","%"+(n+1))):b=b.E8c||b.RBa?b.levelText:"%"+(n+1)+".";x.ULS.shipAssertTag(22127638,338,!!b);h.setValue(Lc.a.Tw,b)}DTj(b,h,n,B){if(b.E8c)return!1;if(1===b.gt)return B;if(B)return!0;if(h){B=b.listType===h.listType;const L=!b.listStyle&&
b.ED===Uk.a.Ik;let ba=b.listStyle===h.listStyle&&b.ED===h.ED;b=(!b.Wta||this.Nwg(h,b))&&!n;ba=ba&&b;return B&&(L||ba)}return!1}C1d(b){this.c6b||(this.c6b=b.ja(Lc.a.mOl,null));this.Szd||(this.Szd=b.ja(Lc.a.lOl,null));this.VFc||(this.VFc=b.ja(Lc.a.nOl,null))}Abd(b){720>b&&(b=0);return Math.max(0,Math.min(Math.floor(b/720),8))}awm(b){return b?this.Vp.iX(b).Nu-this.Vp.pI(b).Nu:-1}yzj(b,h){const n=b.ja(Lc.a.ft,null),B=n?n.length:0,L=Array(B+1);let ba=0;for(;ba<B;ba++)L[ba]=n[ba];L[ba]=h;b.setValue(Lc.a.ft,
L);this.Ws.pnc()}wzj(b,h,n){this.iff(Lc.a.ft,b,h);if(un.Xr.u0){this.iff(ye.a.OYa,b,n);var B=this.Ws.Q7d(b);B.add(h,n);b.setValue(ye.a.eH,SE.d(OE.a.dAc(B)))}else this.iff(Lc.a.Yya,b,n),B=this.Ws.P7d(b),B.add(h,n),b.setValue(Lc.a.N3,SE.d(OE.a.dAc(B)))}xzj(b,h,n){this.Oba?(this.aOh(Lc.a.Xq,b,n),this.aOh(Lc.a.t8,b,h)):(n=(n=b.ja(Lc.a.Xq,null))?Array.clone(n):[],n.push(h),b.setValue(Lc.a.Xq,n),this.Ws.pnc())}iff(b,h,n){const B=h.ja(b,null),L=B?B.length:0,ba=Array(L+1);let la=0;for(;la<L;la++)ba[la]=B[la];
ba[la]=n;h.setValue(b,ba)}aOh(b,h,n){let B=h.ja(b,null);B=B?Array.clone(B):[];B.push(n);h.setValue(b,B)}gWk(b,h,n){var B=n%3+1;const L=h?this.VFc:this.Szd;L&&n<L.length?b.setValue(Lc.a.mu,L[n]):b.setValue(Lc.a.mu,360);B=ms.a.s_(h?0:1,this.eep(B),null,0,n);b.Bv(B.qf);b.setValue(Lc.a.Gkf,h?-1:-2);h?b.setValue(Lc.a.Tw,"%"+(n+1)+"."):(b.setValue(Hf.a.font,this.mpm(n)),b.setValue(Lc.a.Tw,String.fromCharCode(this.cpm(n))));et.a.jxc(2,b)}hWk(b,h,n){const B=h?this.VFc:this.Szd;B&&n<B.length?b.setValue(Lc.a.mu,
B[n]):b.setValue(Lc.a.mu,360);b.setValue(Lc.a.Gkf,h?-1:-2);et.a.jxc(1,b)}cpm(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}mpm(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}tai(b){if(this.Oba)this.Lba<Uk.a.Rbd&&this.Ws.d7(b),this.Lba=this.LCi(this.ft,this.Lba,Uk.a.Rbd);else{if(this.Lba<Uk.a.Rbd&&(this.Ws.d7(b),this.ft&&this.Xq)){b=this.ft.length;for(let h=0;h<b;h++)this.ft[h]>=this.Lba&&
(this.Lba=this.ft[h])}this.Lba+=1}return this.Lba}kai(b){this.cYa<Uk.a.vQd&&this.Ws.d7(b);return this.cYa=this.LCi(this.Yya,this.cYa,Uk.a.vQd)}uai(b){var h;this.Ws.d7(b);do b=Math.floor(Math.random()*(os.YJn-os.wej))+os.wej;while(null===(h=this.Ws.bWb)||void 0===h?0:h.includes(b));return b}LCi(b,h,n){if(h<n&&b){n=b.length;for(let B=0;B<n;B++)b[B]>h&&(h=b[B])}h++;return h}UCo(b,h){this.Wqi(b,h,this.rAe,this.AVj,null,!1)}TCo(b,h){this.qcm(b,h,this.rAe,this.zVj)}Hal(){this.u9()}u9(b=null){var h,n;if(np.a.instance.J(1)){var B=
new ve.GraphIterator;if(b)if(8===b.type)B.set(b);else{x.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else B.set(Ua.StaticActiveAppFrame.za().ib.$c),Object($n.a)().KKg(B),b=Object($n.a)().Iu(B.currentNode);if(B.zb(7)||B.ld(7)){B=Ff.a.Ft(B,B.origin);var L=new Sz({Nd:this.Ws,Sh:b,GD:null,r$j:!1});for(b=new Sz({Nd:this.Ws,Sh:b,GD:null,r$j:!1});B.moveNext();){var ba=B.iterator;let La;if(!hl.a.getInstance().Wr){if(!ba.fv(4)&&!ba.fv(31))continue;
this.Nd.MVb(ba);La=ba.currentNode;ba.uc();if(!La){x.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",ba.isValid);continue}}const fb=Gf.ListItemReader.Of?Gf.ListItemReader.h8d(ba):La;if(!this.Oba&&!Gf.ListItemReader.c_f(fb)&&this.Nd.i3(fb).listType)continue;var la=void 0;if(Gf.ListItemReader.Of){if(!fb){x.ULS.sendTraceTag(509141473,393,50,"Skipping updating list numbers because paraNode not found");continue}la=Gf.ListItemReader.av(fb)}else la=
this.Nd.Q_(La,!1,!1);if(this.Oba&&la&&this.Nd.Vee(la.listId)){x.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",la.listId);continue}const Cb=Gf.ListItemReader.Of?fb:xb.OutlineElementReader.uU(ba);Cb&&(Cb.qa?(null==Cb.qa.last&&x.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),this.Oba&&this.Ws.d7(ba.currentNode),12===Cb.type&&(Cb.Yi&&Cb.Kx.hasProperty(Lc.a.listID)||null===(h=Cb.qa.last)||void 0===h||!h.Xi)&&
((ba=Gf.ListItemReader.Of?Cb.Yi?Gf.ListItemReader.ola(fb):Gf.ListItemReader.av(fb):this.Nd.Q_(La,!0,!0))?this.LOj(La,fb,b,un.Xr.K3b,ba):x.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",La.type)),!la||null!==(n=Cb.qa.last)&&void 0!==n&&n.Uh||!this.LOj(La,fb,L,un.Xr.lda,la)||(la=La.getValue(un.Xr.lda),this.Oba&&this.Nd.i3(fb).listType||La.setValue(un.Xr.zoa,la))):x.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else x.ULS.shipAssertTag(593234060,
376,7===B.lf,"Couldnt reach to page manifest node")}}LOj(b,h,n,B,L){B||x.ULS.shipAssertTag(571757918,393,!!B,"Prop definition is null");n=n.Zrc(L.listId,L.listLevel,this.xd);L=-1;b.hasProperty(B)&&(L=b.getValue(B));return n===L||this.Oba&&!Gf.ListItemReader.c_f(h)&&this.Nd.i3(h).listType&&(B!==un.Xr.K3b||1!==this.Nd.i3(h).listType)?!1:(b.setValue(B,n),!0)}Dkn(b,h){let n=!1,B=!0,L=0;const ba=this.uE(b),la=b.currentNode;b=b.O2b();b=Ff.a.iq(b);for(b.vp(MC.a.kie,null);b.moveNext();){var La=b.iterator.currentNode;
if(La===la)break;Gf.ListItemReader.Hg(La)&&(La=this.uE(b.iterator),La.listID===ba.listID&&(La.level>ba.level?(n=!0,L++):La.level===ba.level?(B=!1,L=0):La.level<=h.xdb&&(B=!0,L=0)))}return n&&B&&!0}rnl(b){this.Nd.RX(b);const h=b.currentNode;b.uc();const n=this.uE(b);n&&this.Ws.eie(h,n.listID,n.level)&&this.TCo(b.currentNode,n)}FBi(b){var h;const n=this.Nd.Nw(b);n.ijc=!0;Gf.ListItemReader.Of?(b=Gf.ListItemReader.Osa(b),n.qf.setValue(Lc.a.listID,null!==(h=null===b||void 0===b?void 0:b.listId)&&void 0!==
h?h:0)):(this.Nd.RX(b),h=b.currentNode.ja(Lc.a.listID,0),n.qf.setValue(Lc.a.listID,h),b.ld(11));return n}e3f(b,h,n){const B=new ve.GraphIterator,L=h.currentNode;let ba;var la=Uk.a.Ik;let La=!1,fb=!1,Cb=!1,Lb=null;var $b=h.O2b();$b=Ff.a.iq($b);for($b.vp(MC.a.kie,null);$b.moveNext();){B.hd($b.iterator);if(B.currentNode===L)break;La=!1;Gf.ListItemReader.Hg(B)&&(ba=this.uE(B),ba.listID===b.listID&&(ba.level===b.level?(this.Nd.RX(B),la=B.currentNode,B.uc(),la=la.ja(un.Xr.lda,Uk.a.Ik),La=!0,Lb=B.lBc(1),
fb=!0):ba.level>b.level?Cb=!0:ba.level<=n.xdb&&(la=Uk.a.Ik,Cb=fb=!1)))}!fb&&Cb&&(la=n.startAt);La&&(La=h.lBc(1)===Lb);b=new RE;b.ovb=la;b.cbk=La;return b}yxp(b,h){var n=Gf.ListItemReader.y7(b);b=this.vkc(n);const B=new ve.GraphIterator;B.set(n);if(B.Jd()&&(n=B.Bdb())){n=Ff.a.iq(n);for(n.vp(MC.a.kie,b);n.moveNext();)Gf.ListItemReader.Hg(n.iterator.currentNode)&&this.uE(n.iterator).listID===h&&this.OVo(n.iterator,b.listID);x.ULS.sendTraceTag(509200585,393,50,"Single level List is inflated successfully.")}}Rbn(b,
h){x.ULS.shipAssertTag(22819227,338,!!b&&!!h);h.setValue(Uf.a.t4f,S.a.create().toString())}wBa(b,h){const n=Yc.a.instance.rq(wb.a.wBa),B=new TE;(b=this.Ws.fz(b,h.listID,h.level))?(B.xdb=b.ja(Lc.a.KZb,h.level-1),B.startAt=b.ja(Hf.a.PU,1)):Yc.a.instance.$b("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});n.end();return B}OJl(b){const h=Ht.a.instance.createInstance(pk.a.apd);b.Uf(h,31)}Dzo(b){b.Ub(31)&&b.eh()}ECj(b){var h=this.Vb.Eq(b);h?this.Vb.Ae(h)===ln.StyleReader.wordStyleIdListParagraph&&
(h=this.Vb.EF(b),this.e9.VN(h.gh(ln.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.T0b)):x.ULS.shipAssertTag(8271188,315,!1)}mVo(b){if(this.Vb.Ae(this.Vb.Eq(b))===ln.StyleReader.wordStyleIdNormal){const h=this.Vb.EF(b);this.e9.VN(h.gh(ln.StyleReader.wordStyleIdListParagraph),b,!0,!0,void 0,void 0,void 0,!0)}b.qg(Lc.a.fe,Lc.a.IP,Lc.a.hC,Lc.a.f4,Lc.a.mu,Lc.a.Pma);b.setValue(Lc.a.jZa,0)}tnl(b,h){var n=Gf.ListItemReader.av(b);if(!n)return null;const B=n.listId;n=n.listLevel;for(let ba=0;9>ba;ba++){const la=
this.Ws.fz(b,B,ba);if(!la)return Yc.a.instance.$b("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var L=h.JUb[ba];L=6===L?ms.a.s_(1,1):ms.a.s_(0,L);L.oma&&la.setValue(Hf.a.g8,L.oma);la.hasProperty(Hf.a.font)&&la.removeProperty(Hf.a.font);h.sKa&&h.sKa[ba]&&la.setValue(Hf.a.font,h.sKa[ba]);L=h.Cbd[ba];x.ULS.shipAssertTag(22127641,338,!!L);la.setValue(Lc.a.Tw,L);la.setValue(Lc.a.gt,et.a.Rrc);et.a.Pye(h.r9,la);la.setValue(Lc.a.wga,h.khe[ba]);la.qg(Lc.a.KZb,Hf.a.PU);this.e8j(b)}b=new Uy.a;
b.listID=B;b.level=n;return b}qnl(b,h,n,B){if(B)return this.tnl(b,B);var L=Gf.ListItemReader.av(b);if(!L)return null;B=L.listId;L=L.listLevel;const ba=this.Ws.fz(b,B,L);if(!ba)return Yc.a.instance.$b("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&x.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,h.listType,B,L),null;h.ijc&&(ba instanceof Dx.APropertySet?ba.bAa(h.qf,Lc.a.listID,Lc.a.listLevel):x.ULS.sendTraceTag(527991759,
393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===ba||void 0===ba?void 0:ba.constructor.name));var la=ba.ja(Lc.a.gt,null);la&&la===et.a.Rrc&&this.pnl(b,B);if(!h.listStyle){la=0;if(-1!==n){for(la+=L-n;0>la;)la+=3;la%=3}switch(la){default:n=1;break;case 1:n=2;break;case 2:n=3}h.Kca(h.listType,n)}h.oma&&ba.setValue(Hf.a.g8,h.oma);h.aC?(this.JOj(h,ba,L),ba.hasProperty(Hf.a.font)&&ba.removeProperty(Hf.a.font)):(os.GOj(h,ba),os.IOj(h,ba));os.HOj(h,ba);ba.qg(Lc.a.KZb,
Hf.a.PU,Lc.a.x$c);this.e8j(b);b=new Uy.a;b.listID=B;b.level=L;return b}pnl(b,h){let n;for(let B=0;9>B;B++){n=this.Ws.fz(b,h,B);if(!n){x.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,B);break}n.setValue(Lc.a.gt,et.a.$ae);n.removeProperty(hi.a.Aub)}}$xe(b,h){const n=Yc.a.instance.rq(wb.a.$xe);this.SDd.value||Yc.a.instance.$b("PossibleIncorrectListIndentation",{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.HSa?(n.properties.Z("PendingListInfo","true"),
Gf.ListItemReader.Hg(b)&&(n.properties.Z("RemoveCurrentListInfo","true"),this.T0b=!0,this.ona(b),this.SDd.value.xZa(b,-1,0),this.T0b=!1),16!==this.HSa.listType&&this.rdc(b,this.HSa,{zRi:!0,cem:!0}),this.HSa=null):h||(n.properties.Z("CurrentlyUnderPastedList","true"),this.ona(b,{wCj:!0}));n.end()}$ye(b,h){var n;if(Gf.ListItemReader.Hg(b))return!1;b.Ub(2);var B=oe.a.jbl;const L=[!0,!1].map(ba=>ea.ParagraphReader.zg(b.currentNode,ba,void 0,!1));b.uc();for(let ba=0;ba<L.length;ba++){const la=L[ba];if(la&&
!Rz.a.Xla(la))for(const La of B)if(La.test(la.characterData))return B=null===(n=La.exec(la.characterData))||void 0===n?void 0:n[0],this.tqo(h,ba?"nextPara":"prevPara",B),!1}return!0}tqo(b,h,n){const B=new Map;B.set("CurrentAutoListPreventedAutoListText",b);B.set("UndoAutoListPreferenceFoundIn",h);B.set("UndoAutoListPreferenceAutoListText",n);oa.Health.instance.recordKpiUsage(Uk.a.Ztb.$wo,0,Uk.a.bD,B)}E4o(b,h){return b&&h}FCj(b){for(let h=0;h<b.count;h++){const n=ve.GraphIterator.eb(b.J(h));n.tq();
this.eha(n)}b.clear()}SCo(b){Gf.ListItemReader.Hg(b)&&this.u9()}Xyj(b,h){b=new ve.GraphIterator;b.set(h);b.Jd();Ga.OutlineElementNavigator.he(b);b.Irb(h)||Yc.a.instance.$b("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.ona(b);return b}TUo(b,h,n){this.Oh.wEa(b,h,n,!0)}cVo(b){b.Kca(1,1)}VSd(b,h){const n=Yc.a.instance.rq(wb.a.$7k);if(this.Vb.v0(h.Qj())){if(Gf.ListItemReader.Hg(b)&&this.ona(b),h=this.Ws.OBi(h)){n.properties.Z("EarlyReturn","False");this.Ws.Tqb(b.currentNode,
h);var B=hq.b9l(this,b,h);if(B)B=this.KOj(b,B,!0);else{B=this.aai(b);var L=this.A4d(b,h,this.XYj,this.uep);if(L){const ba=this.uE(L);if(ba.listID===h.listID&&ba.level<h.level&&this.Nd.Nw(L).aC){const la=this.wBa(L.currentNode,ba);ba.Sw===(la.startAt===Uk.a.Ik?1:la.startAt)&&(ba.MZc=ba.Sw,this.OEj(B,ba,L.currentNode))}}L=this.wBa(B,h);b=this.e3f(h,b,L);b=b.ovb!==Uk.a.Ik?b.ovb+1:L.startAt===Uk.a.Ik?1:L.startAt;hl.a.getInstance().Wr||this.tTc(B,h,null,!0);B.setValue(un.Xr.lda,b);B.setValue(un.Xr.zoa,
b)}hl.a.getInstance().Wr||B.setValue(Lc.a.O3,!0);n.end()}}else Yc.a.instance.$b("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}OEj(b,h,n){this.Ws.eie(b,h.listID,h.level)&&this.UCo(n,h)}l8k(b,h,n){if(!Gf.ListItemReader.Hg(h)&&(x.ULS.sendTraceTag(508952674,393,15,"Iterator sent is not pointing to a List OE: applyNewListDefinition"),Gf.ListItemReader.Of))return;let B=null;hl.a.getInstance().Wr||(B=h.Ub(4),h.uc());(h=xb.OutlineElementReader.uU(h))||Vc.b(509386772,393,15,"Encountered a list node but paragraph node is not present");
b=this.sai(b,n,0,null);this.tTc(B,b,h);return b}sai(b,h,n,B=null){b=B?this.JHl(b,h,n,B):this.HHl(b,h,n);un.Xr.Fu||(h.RBa?(h=h.levelText,B||(h=h.replace("%1","%"+(b.level+1))),b.levelText=h):(x.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),b.levelText=""));return b}tMg(b,h,n,B=null){if(Gf.ListItemReader.Hg(b)){var L=b.Ub(4);b.uc();var ba=xb.OutlineElementReader.uU(b);this.khc(ba,()=>{this.tTc(L,h.Mx,ba,n);this.vhi(L,h,n,B)})}else x.ULS.sendTraceTag(587747659,
393,15,"List node received is null : skipping join list action.")}KOj(b,h,n,B=null){const L=xb.OutlineElementReader.uU(b);return this.khc(L,()=>{const ba=this.aye(b,h.Mx,n);this.vhi(ba,h,n,B);return ba})}vhi(b,h,n,B=null){if(this.Ws.Tqb(b,h.Mx).aC){const L=new ve.GraphIterator;L.set(b);L.Jd();L.uc();const ba=this.yam(L,h,B);b=this.qam(L,b,h,n,B,ba);this.vam(h,n,B,ba,b)}}yam(b,h,n){if(h.VZi)h=h.jS;else{let B,L;n?(B=this.YYj,L=this.ABe):h.xnc?(B=this.XYj,L=this.ABe):(B=this.tep,L=this.vep);h=this.A4d(b,
h.Mx,B,L,n)}!h&&n&&(n=new ve.GraphIterator,n.hd(b),n.A$d()&&Gf.ListItemReader.Hg(n)&&(h=n));return h}qam(b,h,n,B,L,ba){B?(L?b=L.Gqd:(ba=this.wBa(h,n.Mx),n=this.e3f(n.Mx,b,ba),b=n.ovb!==Uk.a.Ik?n.ovb+1:ba.startAt===Uk.a.Ik?1:ba.startAt),h.setValue(un.Xr.lda,b),h.setValue(un.Xr.zoa,b)):(b=Uk.a.Ik,this.UVo(h,ba,n));return b}vam(b,h,n,B,L){if(B){var ba=!1;const fb=this.uE(B);var la=fb.level===b.Mx.level,La=!!n&&fb.listID===n.rgd;(fb.listID===b.Mx.listID||La)&&la&&(la=this.wBa(B.currentNode,fb),La=la.startAt===
Uk.a.Ik?1:la.startAt,fb.Sw===La+1&&(ba=h?L===La:this.Dkn(B,la)));if(!ba||n)n?(h=this.O8o,L=this.Q8o):(h=this.rAe,L=this.AVj),ba=new ve.GraphIterator,ba.set(B.currentNode),ba.Jd(),this.Nd.RX(ba),ba.uc(),this.Wqi(B.currentNode,b.Mx,h,L,n)}}UVo(b,h,n){let B=null;h&&(B=this.uE(h));if(B&&B.listID===n.Mx.listID&&B.level===n.Mx.level){const L=this.Nd.Nw(h),ba=L.Sw;b.setValue(un.Xr.lda,ba);b.setValue(un.Xr.zoa,ba);L.qf.setValue(Lc.a.listID,B.listID);L.qf.setValue(Lc.a.listLevel,B.level);if(!n.xnc||n.Fle)n.VZi&&
!n.Fle&&(this.Nd.RX(h),b=h.currentNode,Ga.OutlineElementNavigator.he(h)),b.setValue(un.Xr.zoa,b.getValue(un.Xr.lda))}else h=n.Mx.Sw+1,b.setValue(un.Xr.lda,h),b.setValue(un.Xr.zoa,h)}rdc(b,h,{zRi:n=!1,Dyn:B=-1,Acm:L=!1,cem:ba=!1}={}){return h&&16!==h.listType?ve.GraphIterator.qfa(()=>{if(!xb.OutlineElementReader.Mh(b))return x.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),zr.ivb();const la=xb.OutlineElementReader.uU(b);return Gf.ListItemReader.Of&&!la&&(x.ULS.sendTraceTag(508441813,
393,15,"No paraNode was found while trying to applyListInfo"),Gf.ListItemReader.Of)?zr.ivb():la&&tn.a(la,8)?(x.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),zr.ivb()):np.a.instance.J(1)&&(null===la||void 0===la?0:la.qa.last.Uh)?(x.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),zr.ivb()):this.khc(la,()=>{var La=Object($n.a)().Iu(b.currentNode);const fb=h.xD,Cb=this.infoAtLevel(b,h);var Lb=Gf.ListItemReader.Of?null:b.Ub(4);
if(Gf.ListItemReader.Of?Gf.ListItemReader.isListItem(la):Lb)return Gf.ListItemReader.Of||b.uc(),La=this.CTh(Cb,Gf.ListItemReader.Of?la:Lb,B,fb),La.Mx=this.uE(b),La;this.Dzo(b);({listId:Lb}=Gf.ListItemReader.vLf(h,{vka:-1}));const $b=this.mym(Lb,ba),tc=this.awm(la),Nc=this.axm(h,b,Cb,ba,L,n);this.zTo(Nc,Cb);la&&this.mVo(la);return null==Nc||L||Cb.aC!==this.Nd.Tqb(b.currentNode,Nc.Mx).aC?this.PXl(Cb,$b,Nc,b.currentNode)?this.b8k(b,Cb,$b,tc,fb):this.a8k(b,Cb,La,tc,fb,$b,Lb):(Cb.listStyle||(Nc.xnc=!0),
this.c8k($b,Nc,b))})}):(h||x.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+h),this.ona(b))}b8k(b,h,n,B,L){n=this.Lym(h,n,B);n=this.aye(b,n);b=Gf.ListItemReader.Of?Gf.ListItemReader.y7(b):n;return this.CTh(h,b,-1,L)}axm(b,h,n,B,L,ba){var la;L=b.tvb?new hq(this,ve.GraphIterator.eb(b.tvb),!1,!0):hq.a9l(this,h,n,B,L);if(!L)return null;ba?(L.Mx.level=this.mwm(h,n,B),this.bam(h,L)):L.Mx&&(null===(la=b.qf)||void 0===la?0:la.hasProperty(Lc.a.listLevel))&&(L.Mx.level=b.qf.getValue(Lc.a.listLevel));
return L}mym(b,h){return h&&0<b&&b+""in this.ikg?this.ikg[b+""]:-1}Lym(b,h,n){var B,L;const ba=new Uy.a;ba.listID=h;ba.level=null!==(L=null===(B=b.qf)||void 0===B?void 0:B.wf(Lc.a.listLevel))&&void 0!==L?L:this.Abd(n);b.qf&&b.RBa&&!un.Xr.Fu&&(ba.levelText=b.levelText.replace("%1","%"+(ba.level+1)));return ba}CTh(b,h,n,B){b=this.qnl(h,b,n,B);return zr.azn(b)}c8k(b,h,n){let B=null;0<b&&(B=new ku(0,h.Mx,-1),B.rgd=b);this.KOj(n,h,!1,B);return zr.rzn(h.Mx)}a8k(b,h,n,B,L,ba,la){const La=xb.OutlineElementReader.v7(b);
0<La&&(B+=La);n=this.sai(n,h,B,L);this.xxp(ba,la,n);b=this.aye(b,n);un.Xr.Wr||h.listType||(h=h.ED,h===Uk.a.Ik&&(h=1),b.setValue(un.Xr.lda,h),b.setValue(un.Xr.zoa,h));return zr.dzn(n)}ona(b,{wCj:h=!1}={}){return ve.GraphIterator.qfa(()=>{if(!xb.OutlineElementReader.Mh(b))return x.ULS.sendTraceTag(509678220,393,15,"Iterator not pointing to OE in remove list info word."),zr.ivb();const n=xb.OutlineElementReader.uU(b);if(hl.a.getInstance().Fu&&!n&&(x.ULS.sendTraceTag(508432897,393,15,"OutlineElement has listNode but no paraNode during removeListInfo [setter flight ON]"),
this.Oh.nzo(b.currentNode),hl.a.getInstance().Wr))return zr.ivb();if(np.a.instance.J(1)&&(null===n||void 0===n?0:n.qa.last.Uh))return x.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),zr.ivb();const B=b.Ub(4);return B?n?this.khc(n,()=>{var L;this.ECj(n);this.Kyo(n);Gf.ListItemReader.Of||(n.sF=null);this.Nd.Vee(Gf.ListItemReader.Of?Gf.ListItemReader.av(n,{vka:0}).listId:B.ja(Lc.a.listID,0))?(B.Bpd=!1,this.DI.eha(n,b),Gf.ListItemReader.Of&&!hl.a.getInstance().Wr&&
(n.sF=null)):b.uc();h||this.mSo(b);b.Ub(4)&&(B.Bpd=!1,this.DI.eha(n,b),Gf.ListItemReader.Of&&!hl.a.getInstance().Wr&&(n.sF=null));!hl.a.getInstance().Wr&&(this.Wd.Mg&&!this.T0b||!this.Wd.Mg&&n.Yi)&&(!n.Yi||(null===(L=n.Kx)||void 0===L?0:L.hasProperty(Lc.a.listID)))&&this.OJl(b);return zr.x7i()}):(x.ULS.sendTraceTag(509211404,393,15,"OutlineElement has listNode but no paraNode during removeListInfo"),B.Bpd=!1,b.eh(),zr.x7i()):zr.ivb()})}mSo(b){const h=Object($n.a)().Iu(b.currentNode),n=xb.OutlineElementReader.OKa(b),
B=xb.OutlineElementReader.pI(b),L=xb.OutlineElementReader.v7(b);this.C1d(h);this.Oh.wEa(b,1,Math.max(0,n+(L||-1*B)-this.VFc[0]))}khc(b,h){let n=null;np.a.instance.J(1)&&b&&(n=b.sE());h=h();np.a.instance.J(1)&&!this.T0b&&(b&&n&&this.hr.wY(b,n,this.Wd.Mg),this.u9());return h}Kyo(b){b.hasProperty(Lc.a.fe)&&b.removeProperty(Lc.a.fe);b.hasProperty(Lc.a.hC)&&b.removeProperty(Lc.a.hC);b.hasProperty(Lc.a.mu)&&b.removeProperty(Lc.a.mu)}infoAtLevel(b,h){if(!h)return null;const n=h.xD;if(1===h.gt){if(h.Wta&&
!h.UL||!h.Uof(!1))return h;b=xb.OutlineElementReader.OKa(b);const B=this.Abd(b),L=n.JUb[B];b=ms.a.Faa(h.qf,h.qf);6===L?b.Kca(1,1):b.Kca(0,L);b.cye("multilevel");b.levelText=n.Cbd[B];n.sKa&&n.sKa[B]&&(b.font=n.sKa[B]);b.Fx=n.khe[B];b.r9=n.r9;b.cie=h.cie}else b=h;return b}zTo(b,h){null!==b&&void 0!==b&&b.Mx&&(h.levelText=b.Mx.levelText,h.aC||(h.font=b.Mx.font))}mwm(b,h,n){let B=xb.OutlineElementReader.OKa(b);const L=xb.OutlineElementReader.v7(b);0<L?B+=L:(b=xb.OutlineElementReader.pI(b),0<b&&(B-=b));
h=h.qf.ja(Lc.a.listLevel,-1);return n&&0<=h?h:this.Abd(B)}bam(b,h){if(!this.Ws.Tqb(b.currentNode,h.Mx).listType){const n=this.wBa(b.currentNode,h.Mx);b=this.e3f(h.Mx,b,n);h.Mx.MZc=h.Mx.Sw=b.ovb===Uk.a.Ik?n.startAt-1:b.ovb;h.xnc=b.cbk}}xxp(b,h,n){0>=b?this.ikg[h+""]=n.listID:n.listID=b}PXl(b,h,n,B){if(0>=h)return!1;const L=(ba,la)=>ba.length!==la.length||ba.some((La,fb)=>La!==la[fb]);if(n)return h=this.Nd.Tqb(B,n.Mx),b.aC!==h.aC||L(b.oma,h.oma);n=b.qf.ja(Lc.a.listLevel,-1);return 0<=n&&(h=this.Ws.fz(B,
h,n))&&(h=h.ja(Hf.a.g8,null))&&b.oma?L(h,b.oma):!1}Iyo(b,h){var n;const B=!!h&&ea.ParagraphReader.Xb(h);let L=0,ba=0;B&&(L=this.Vp.iX(Gf.ListItemReader.Of?h:this.Nd.NBi(b)).Nu,ba=this.Vp.pI(h).Nu);B&&this.ECj(h);(null===(n=hl.a.getInstance())||void 0===n?0:n.Wr)||b.Ub(4);this.DI.eha(h,b);B&&this.Oh.wEa(b,1,L-ba)}$ea(b,h,n,B=-1,L=!1,ba=null,la=!1){x.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");const La=Yc.a.instance.rq(wb.a.$ea),fb=this.Pc.Mc(15);fb.qu(b);
let Cb=null,Lb=0;({evn:Cb,zSn:Lb,returnValue:B}=this.B9l(b,h,B,Cb,Lb,L,ba));if(!Cb||la&&(1===n||0>n-Cb.Mx.Sw||2<n-Cb.Mx.Sw))return fb.dispose(),La.end(),!1;for(;0<Lb;)b.A$d(),Lb--;this.txp(b,h,B,Cb);fb.dispose();La.end();return!0}txp(b,h,n,B){for(;b.A$d();){var L=Gf.ListItemReader.y7(b);if(L&&(L=this.vkc(L),L.listID===h.listID)){h=new ku(0,h,n);hl.a.getInstance().Fu?this.tMg(b,B,L.O3,h):this.tMg(b,B,!0,h);break}}}B9l(b,h,n,B,L,ba=!1,la=null){for(var La;b.ALi();){if(b.fv(4)){const fb=this.uE(b),Cb=
this.Nd.Nw(b);if(Cb.listType!==la.listType){L++;continue}if(ba&&Cb.listStyle!==la.listStyle||!ba&&h.level<fb.level){L++;continue}-1===n&&(n=fb.Sw+1);B=null;if(h.level===fb.level||ba)null===(La=this.fqd)||void 0===La?void 0:La.XUf(b),B=new hq(this,b,!1,!1);ba&&fb.level!==h.level&&b.fv(4)&&(b.Ub(4).setValue(Lc.a.listLevel,fb.level),b.uc());break}L++}return{returnValue:n,evn:B,zSn:L}}Kym(b){b=Gf.ListItemReader.y7(b);return this.T7d(b)}T7d(b){let h;np.a.instance.J(1)&&(h=Gf.ListItemReader.Of?Gf.ListItemReader.av(b)||
Gf.ListItemReader.ola(b):this.Nd.Q_(b,!1,!0));return this.Nd.fz(b,h.listId,h.listLevel)}startNewList(b,h,n){x.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var B=Yc.a.instance.rq(wb.a.startNewList),L=this.Pc.Mc(15);L.qu(b);var ba=ms.a.s_(0,h.listStyle,null,0,h.qf.ja(Lc.a.listLevel,-1));if(Gf.ListItemReader.Of)({listId:la,listLevel:La}=Gf.ListItemReader.Osa(b,{vka:0,HJa:-1}));else{b.Ub(4);var la=b.currentNode.ja(Lc.a.listID,0);var La=b.currentNode.ja(Lc.a.listLevel,
-1);b.uc()}ba.cie=la;var fb=h.qf.ja(Lc.a.fe,0);0<fb&&ba.qf.setValue(Lc.a.fe,fb);-1===ba.qf.ja(Lc.a.listLevel,-1)&&ba.qf.setValue(Lc.a.listLevel,La);1===h.gt&&((La=new EC.a,la=h.YJi(b.currentNode,la),la)?1===la&&(ba.cye(et.a.Rrc),ba.xD=La.muf(La.hdg,La.idg),ba.r9=ba.xD.r9):(ba.cye(et.a.Rrc),ba.xD=La.stf(),ba.r9=ba.xD.r9));h.Rsa()&&1>n&&(n=1);ba.ED=n;La=new Og.DictionaryPropertySet;La=this.J_c(wb.a.XN,La);la=xb.OutlineElementReader.uU(b);h=this.uE(b);if(fb=this.Kym(b))ba.levelText=fb.ja(Lc.a.Tw,""),
ba.UL=42,ba.Fx=fb.ja(Lc.a.wga,"left");this.Iyo(b,la);({cCa:ba}=this.Tqa(La,b,ba,!0));b.Ub(4);22!==b.currentNode.type&&63!==b.currentNode.type&&x.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);hl.a.getInstance().Wr||b.currentNode.setValue(Lc.a.listLevel,h.level);hl.a.getInstance().Fu&&({listId:ba}=Gf.ListItemReader.av(hl.a.getInstance().bma?la:b.currentNode),this.DI.L_b(la,ba,h.level));b.uc();ba=new hq(this,b,!1,!1);n=new ku(1,h,n);this.tMg(b,ba,!!hl.a.getInstance().Fu,
n);L.dispose();B.end()}else x.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}P_f(b){if(!b)return!1;const h=b.Ub(2);h&&b.uc();return np.a.instance.J(1)&&h&&12===h.type&&h.qa&&h.qa.last&&h.qa.last.Uh?!0:!1}nqe(b,h,n,B){return this.HDk.nqe(b,h,n,B)}Nwg(b,h){if(!b||!h)return!1;const n=b.qf.ja(Lc.a.Tw,null);h=h.qf.ja(Lc.a.Tw,null);if(!n||!h)return!1;const B=b.qf.ja(Hf.a.font,null);b=b.qf.ja(Hf.a.font,null);return n===h&&B===b}uPj(b,h,n){n||h.listType||(h.ED=b.ja(Hf.a.PU,Uk.a.Ik))}BBi(b,
h){if(!h)return null;const n=Array(9),B=h.cie;if(!this.Yln(h,b)||1>B)return null;for(h=0;9>h;h++){const L=this.Nd.fz(b,B,h);if(null===L||void 0===L?0:L.hasProperty(Lc.a.fe))n[h]=L.getValue(Lc.a.fe);else return null}return n}Yln(b,h){if(!b)return!1;const n=b.qf.ja(Lc.a.listLevel,-1);b=b.qf.ja(Lc.a.fe,-1);if(0>n||0>b)return!1;this.C1d(h);return b!==this.c6b[n]}mOh(b,h,n){b&&b.setValue(Lc.a.fe,h?h[n]:this.c6b&&n<this.c6b.length?this.c6b[n]:720*(n+1))}Wqi(b,h,n,B,L=null,ba=!1){const la=new ve.GraphIterator,
La=this.wBa(b,h);la.set(b);la.Jd();b=It.a.Ft(la,la.O2b());b.vp(MC.a.kie,null);let fb=-1;for(;b.moveNext();){if(!Gf.ListItemReader.Hg(la))continue;const Cb=this.uE(la),Lb=xb.OutlineElementReader.uU(la);this.Nd.RX(la);const $b=la.currentNode;la.uc();if(n!==this.rAe||Cb.listID===h.listID){if(ba){if(-1!==fb&&fb>Cb.level)break;if(-1===fb)fb=Cb.level;else if(Cb.level!==fb)continue}else{if(Cb.level<=La.xdb)break;if(!n(h,Cb,L))continue}B($b,Lb,h.listID,L)}}}qcm(b,h,n,B){const L=new ve.GraphIterator,ba=this.wBa(b,
h);L.set(b);L.Jd();if(Gf.ListItemReader.Hg(L)){b=this.uE(L);var la=xb.OutlineElementReader.uU(L);this.Nd.RX(L);var La=L.currentNode;L.uc();b.level<=ba.xdb||n(h,b,null)&&B(La,la,h.listID,null)}}pcm(b,h,n,B,L=null){const ba=new ve.GraphIterator;ba.hd(b);B(b,h,this.uE(ba),ba,0);this.A4d(b,h,n,B,L)}A4d(b,h,n,B,L=null){let ba=new ve.GraphIterator;const la=this.wBa(b.currentNode,h);let La=null,fb=0;var Cb=new ve.GraphIterator;Cb.hd(b);Cb.zb(10);const Lb=Ff.a.Ft(Cb,Cb.origin);for(Lb.moveNext();Lb.moveNext();)if(La=
null,ba=Lb.iterator,1===ba.role&&(La=Lb.currentNode,ba.fv(4)&&(Cb=this.uE(ba),n(h,Cb,L))))if(Cb.level>h.level)B(b,h,Cb,ba,fb),fb++;else if(Cb.level===h.level||Cb.level<=la.xdb)break;return La?ba:null}Byj(b,h,n,B){this.wBa(b.currentNode,n).xdb>=h.level&&this.rnl(B)}static GOj(b,h){h.setValue(Hf.a.font,b.Wta||b.E8c||b.X5c?b.font:"Symbol")}static IOj(b,h){b=b.Wta||b.E8c||b.RBa?b.levelText:Uk.a.XZd;x.ULS.shipAssertTag(22127637,338,!!b);h.setValue(Lc.a.Tw,b)}static HOj(b,h){b=b.qf.ja(Lc.a.wga,"left");
h.setValue(Lc.a.wga,b)}}os.YJn=2147450879;os.wej=1;Object(u.a)(os,"FlatListEditorCssVersion",un,[261,262]);class ZG{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc){this.Ws=b;this.H6n=h;this.Kf=n;this.Yo=B;this.iC=L;this.Yyn=ba;this.Md=la;this.Lj=La;this.izn=fb;this.rc=Cb;this.Vb=Lb;this.kJ=$b;this.DI=tc}create(){return new os(this.Ws,this.H6n,this.Kf,this.Yo,this.iC,this.Yyn,this.Md,this.Lj,this.izn,this.rc,this.Vb,this.kJ,this.DI)}}Object(u.a)(ZG,"FlatListEditorFactory",null,[]);class NC{constructor(){this.startAt=
this.listLevel=this.listId=0;this.tvb=null}}Object(u.a)(NC,"ListAutoCorrectionRefInfo",null,[]);class Tz{constructor(b,h){this.fDk=b;this.ig=h}nqe(b,h,n,B){if(!b.hasProperty(zd.a.hbb))return!0;h=ve.GraphIterator.eb(h.currentNode);re.SelectionEditor.rv(h);let L=!0;if(!n.listType&&!B){23===h.lf&&h.IL(1);B=b.ja(zd.a.hbb,1);if(1<B){var ba=new ve.GraphIterator;ba.hd(h);ba.zb(10);ba=Ff.a.iq(ba.origin);B=this.A9l(ba,B,n,h.currentNode);n.tvb||(L=!1)}b.setValue(zd.a.hbb,B)}return L}A9l(b,h,n,B){const L=new ob.a;
for(;b.moveNext()&&b.iterator.currentNode!==B;){const ba=b.iterator;if(!ba.fv(4))continue;const la=this.fDk.value.uE(ba),La=this.ig.Nw(ba);this.ojo(L,la);La.listType===n.listType&&La.listStyle===n.listStyle&&(0>h-la.Sw||2<h-la.Sw||L.add(Object.assign(new NC,{listId:la.listID,listLevel:la.level,tvb:ba.currentNode,startAt:la.Sw+1})))}0<L.count&&(h=L.J(L.count-1).startAt,n.tvb=L.J(L.count-1).tvb);return h}ojo(b,h){let n=0;for(;n<b.count;){const B=b.J(n);B.listId===h.listID&&B.listLevel>=h.level?b.removeAt(n):
n++}}}Object(u.a)(Tz,"ListAutoCorrector",null,[232]);class UE{constructor(b,h,n,B,L){this.Meb=(ba,la,La)=>{var fb;ba=Gf.ListItemReader.Of?Gf.ListItemReader.f3c(la):this.MXc(la);if(!ba||this.fu.P_f(ba))return 8;la=this.fu.uE(ba);if(1===la.Sw||this.Q9c(la.level))return 8;la=null===(fb=this.Nd)||void 0===fb?void 0:fb.Nw(ba);if(!la||this.i_i(la))return 8;if(1===La)return 32;this.fu.startNewList(ba,la,1);return 32};this.Leb=(ba,la,La)=>{ba=Gf.ListItemReader.Of?Gf.ListItemReader.f3c(la):this.MXc(la);if(!ba||
this.fu.P_f(ba))return 8;la=this.fu.uE(ba);if(this.Q9c(la.level))return 8;const fb=this.Nd.Nw(ba);if(!fb||this.i_i(fb))return 8;if(1===La)return 32;this.eZc.XAm(ba.currentNode,la.Sw,this.Nd,this.fu,this.o0a);return 32};this.$ea=(ba,la,La)=>{ba=Gf.ListItemReader.Of?Gf.ListItemReader.f3c(la):this.MXc(la);if(!ba||this.fu.P_f(ba))return 8;la=this.fu.uE(ba);if(1!==la.Sw||this.Q9c(la.level))return 8;if(1===La)return 32;La=this.Nd.Nw(ba);return this.fu.$ea(ba,la,La.ED,-1,!1,La)?32:8};this.azb=(ba,la,La,
fb,Cb)=>{ba=Gf.ListItemReader.Of?Gf.ListItemReader.f3c(la):this.MXc(la);if(!ba)return 8;la=this.fu.uE(ba);if(this.Q9c(la.level))return 8;if(1===La)return 32;La=this.Nd.Nw(ba);this.fu.startNewList(ba,La,Cb);return 32};this.Rnb=(ba,la,La,fb,Cb)=>{ba=Gf.ListItemReader.Of?Gf.ListItemReader.f3c(la):this.MXc(la);if(!ba)return 8;la=this.fu.uE(ba);return this.Q9c(la.level)?8:1===La?32:this.fu.$ea(ba,la,la.Sw,Cb)?32:8};this.Sb=b;this.Nd=n;this.fu=B;this.eZc=L}Q9c(b){return 0>b}Wb(){this.Sb.ra(wb.a.Meb,oc.a.jS,
this.Meb);this.Sb.ra(wb.a.Meb,oc.a.Xc,this.Meb);this.Sb.ra(wb.a.Meb,oc.a.view,this.Meb);this.Sb.Rc(wb.a.Meb,12);this.Sb.ra(wb.a.Leb,oc.a.jS,this.Leb);this.Sb.ra(wb.a.Leb,oc.a.Xc,this.Leb);this.Sb.ra(wb.a.Leb,oc.a.view,this.Leb);this.Sb.Rc(wb.a.Leb,12);this.Sb.ra(wb.a.$ea,oc.a.jS,this.$ea);this.Sb.ra(wb.a.$ea,oc.a.Xc,this.$ea);this.Sb.ra(wb.a.$ea,oc.a.view,this.$ea);this.Sb.Rc(wb.a.$ea,12);this.Sb.ra(wb.a.azb,oc.a.jS,this.azb);this.Sb.ra(wb.a.azb,oc.a.Xc,this.azb);this.Sb.ra(wb.a.azb,oc.a.view,this.azb);
this.Sb.Rc(wb.a.azb,12);this.Sb.ra(wb.a.Rnb,oc.a.jS,this.Rnb);this.Sb.ra(wb.a.Rnb,oc.a.Xc,this.Rnb);this.Sb.ra(wb.a.Rnb,oc.a.view,this.Rnb);this.Sb.Rc(wb.a.Rnb,12)}get o0a(){return Ya.a.instance.resolve("Common.IStandaloneRootController").Bha}MXc(b){return this.fu.uym(b)}i_i(b){return 1===(null===b||void 0===b?void 0:b.listType)}}Object(u.a)(UE,"ListContextMenuSectionActor",null,[]);var xm=d(641);class nB{static get hzn(){return Ge.a.az(nB.Mn,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,
Box4Intl.Box4Strings.l_SetValueTo)}}nB.Mn="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(u.a)(nB,"ListSetStartValueDialogHtml",null,[]);class dw extends Ge.a{constructor(b,h,n,B,L){super();this.hId=this.AOe=this.AId=this.Y9e=null;this.vQe=!0;this.UV=!1;this.Jjb=0;this.LWj=[wb.a.hAg,wb.a.aFg,wb.a.Rog];this.vYo=(ba,la)=>{ba=la[Ki.a.Number];this.Dda=Number.isInteger(la[Ki.a.Number])&&ba>=this.Jjb?ba:this.Jjb};this.pLm=(ba,la)=>{this.Dda=this.Dda>=this.Jjb?this.Dda:this.Jjb;la[Ki.a.Number]=this.Dda;la[Ki.a.UnitType]=0};this.pVo=(ba,la)=>{if(1===ba){var La=la.ListRadioStartNew,fb=la.ListRadioContinue,
Cb=ve.GraphIterator.eb(this.Qf);Cb.Jd();la=this.fu.uE(Cb);ba=this.ig.Nw(Cb);if(La)this.fu.startNewList(Cb,ba,this.Dda);else if(fb)if(this.vQe)this.fu.$ea(Cb,la,this.o3e,-1,!1,ba);else{La=!0;for(fb=null;Cb.bK();)if(Gf.ListItemReader.Hg(Cb)){fb=new hq(this.fu,Cb,!1,!1);break}if(!fb||this.fu.uE(Cb).Sw>=this.Dda)La=!1;La?(Cb=ve.GraphIterator.eb(this.Qf),Cb.Jd(),this.fu.$ea(Cb,la,this.o3e,this.Dda,!1,ba)):(this.dispose(),this.nOa(CommonUIStrings.l_ErrorDialogMessage,this.gzn))}}};this.gzn=()=>{new dw(this.Qf,
this.o3e,this.ig,this.fu,this.Ed)};this.W2n=()=>{document.getElementById(dw.y7i).style.visibility="visible"};this.tWn=()=>{document.getElementById(dw.y7i).style.visibility="hidden"};this.Qg="ListSetStartValueDialog";this.kh=nB.hzn;this.Qf=b;this.Dda=h;this.ig=n;this.o3e=h;this.a$=B;h=new ve.GraphIterator;b?(h.set(b),h.Jd(),xb.OutlineElementReader.Mh(h)||Ga.OutlineElementNavigator.he(h),Gf.ListItemReader.Hg(h)&&(b=null,Gf.ListItemReader.Of?b=this.ig.Nw(h):(h.Ub(4),h=h.currentNode,22===h.type&&(b=this.ig.i3(h))),
b&&(b.Rsa()?this.Jjb=1:this.Jjb=0))):this.Jjb=1;this.Ed=L;this.pi(Box4Intl.Box4Strings.l_SetNumberingValueList,this.pVo,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.vQe&&(this.Y9e=document.getElementById("ListRadioStartNew"),this.AId=this.W2n,this.AOe=document.getElementById("ListRadioContinue"),this.hId=this.tWn,Nb.a.addHandler(this.Y9e,"click",this.AId),Nb.a.addHandler(this.AOe,"click",this.hId));for(const ba of this.LWj)Object(xm.a)(ba,this.vYo,this.pLm);this.Ed.wn()}get fu(){return this.a$}dispose(){if(!this.UV){for(const b of this.LWj)Object(xm.b)(b);
this.vQe&&(this.AId&&Nb.a.removeHandler(this.Y9e,"click",this.AId),this.hId&&Nb.a.removeHandler(this.AOe,"click",this.hId));this.Ed.R0("ListStartSpinner");super.dispose();this.UV=!0}}ngl(){const b=cl.l("none",this.Jjb+"","100","1");return cl.j(dw.z7i,wb.a.hAg,wb.a.Rog,Box4Intl.Box4Strings.l_SetValueTo,[b],null,wb.a.aFg)}xKb(b){const h=document.getElementById(dw.z7i);this.Ed.S5a("ListStartSpinner",b);b=this.Ed.CPb("ListStartSpinner","Medium");h.appendChild(b)}Zba(){const b=this.ngl();this.xKb(b)}}
dw.z7i="SetListStartSpinnerContainer";dw.y7i="ListStartAtSpinnerBox";Object(u.a)(dw,"ListSetStartValueDialog",Ge.a,[]);class ew{XAm(b,h,n,B,L){new dw(b,h,n,B,L)}static get instance(){return ew._instance||(ew._instance=new ew)}}ew._instance=null;Object(u.a)(ew,"ListDialogFactory",null,[236]);class oB{constructor(b,h,n){this.a$=b;this.ig=h;this.Pc=n}XUf(b){x.ULS.shipAssertTag(40420184,393,xb.OutlineElementReader.Mh(b));if(Gf.ListItemReader.Hg(b)){const h=this.ig.Nw(b);h.gt||this.O4m(b,h)}}Opl(b){for(let h=
0;h<b.length;h++){const n=new ve.GraphIterator;n.set(b.getContext(h).node);this.XUf(n)}}O4m(b,h){const n=Object($n.a)().Iu(b.currentNode),B=this.a$.uE(b),L=this.Pc.Mc(15);L.qu(b);h=this.a$.l8k(n,b,h);this.a$.yxp(b,B.listID);L.dispose();this.ig.Tqb(b.currentNode,h)}}Object(u.a)(oB,"SingleLevelListEditor",null,[231]);var Uz=d(382);class Pw{Mvj(b,h,n,B,L,ba){return b?A.AFrameworkApplication.va.lg(b,h,n,!0,L,ba):8}}Object(u.a)(Pw,"ListContextManager",null,[1813]);class Ot extends Pw{constructor(b){super();
Ot.gJc=b}Mvj(b,h,n,B,L,ba){if(!b||!b.length)return 8;let la;const La=({ITm:b,HTm:la}=Ot.Sr.FTm(b)).returnValue;let fb=1;for(const Lb of La.keys){var Cb=b.contains(Lb);const $b=La.J(Lb);Ot.Sr.nll(La.J(Lb),this.qVc(h),Cb)?Cb?(x.ULS.sendTraceTag(508350475,393,50,"List Actions: {0} lists, with change in level",this.qVc(h)?"Promote":"Demote"),Cb=A.AFrameworkApplication.va.lg(Uz.a.uJa($b),h,n,B,L,ba)):(x.ULS.sendTraceTag(508350474,393,50,"List Actions: {0} lists, without change in level",this.qVc(h)?"Promote":
"Demote"),Cb=Ot.Sr.G6n(La.J(Lb),this.qVc(h),la.J(Lb))):(x.ULS.sendTraceTag(508350476,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.qVc(h)?"Promote":"Demote"),Cb=8);fb=Ce.ActionManager.Edd(fb,Cb)}return fb}qVc(b){return b===wb.a.OI?!0:!1}static get Sr(){return Ot.gJc||(Ot.gJc=Ya.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}Ot.gJc=null;Object(u.a)(Ot,"WordEditorListContextManager",Pw,[]);class iv{get name(){return"WordEditor.ListEditors"}wc(b){A.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ia("WordEditor.ListEditors.IListAutoCorrector",()=>new Tz(b.rf("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"))).ha(),b.ia("WordEditor.IFlatListEditor",()=>(new ZG(b.resolve("WordEditor.List.IFlatListReader"),b.rf("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new vm.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
b.resolve("Box4.List.IListFormattingEditor"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.List.ListItemEditor"))).create()).ha(),b.ia("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).ha(),b.ia("Box4.List.ISingleLevelListEditor",()=>new oB(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha(),b.ia("Box4.ListEditors.WordEditorListContextManager",
()=>new Ot(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new UE(A.AFrameworkApplication.va,new Vl.a,iv.Nd,iv.fu,ew.instance)).Wb();const b=A.AFrameworkApplication.va;b.fb(wb.a.Rog,oc.a.view,xm.d,96);b.fb(wb.a.aFg,oc.a.view,xm.c,96);b.fb(wb.a.hAg,oc.a.view,xm.c,96)}dispose(){}static get Nd(){return null!=iv.q1g?iv.q1g:iv.q1g=Ya.a.instance.resolve("Box4.List.IListReader")}static get fu(){return null!=iv.tXg?iv.tXg:
iv.tXg=Ya.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){M.a.instance.Jc(new iv)}}Object(u.a)(iv,"WordEditorListEditorsPackage",null,[0,1]);var $G=d(1797),Qw=d(546),YI=d(2177);class OC extends zb.a{constructor(b,h,n,B,L,ba){super(b,h);this.styleId=null;this.lh=0;this.kua=null;this.characterData=n;this.paragraphNode=B;this.listMarker=L;this.sRb=ba}}Object(u.a)(OC,"HeadingText",zb.a,[]);var yp=d(376),aH=d(1101);class pB{constructor(b,h,n,B,L,ba,la){this.Tnn=la;this.Nmh=!0;this.luh=0;
this.MJh=8;this.Oma=null;this.J_m=La=>{if(La.Es)return!0;La=La.role;return 1===La||2===La||4===La};this.$Ck=b;this.pG=h;this.xe=n;this.ig=B;this.CH=L;this.q1=ba}get lv(){return this.$Ck.value}get MUf(){return this.Nmh}set MUf(b){this.Nmh=b}get cVb(){return this.luh}set cVb(b){this.luh=b}get D2b(){return this.MJh}set D2b(b){this.MJh=b}async Kum(){if(this.Tnn){var b=await this.JDm();return this.kmg(b,!0)}b=this.Oma;return isNullOrUndefined(b)?null:Promise.resolve(this.kmg(b,!0))}Lum(){return this.kmg([],
!1)}kmg(b,h){const n=window.performance.now(),B=this.Izi();if(!B)return null;const L=new ob.a;let ba=0;for(;B.moveNext();){var la=B.iterator;if(11===la.lf){const La=Gf.ListItemReader.y7(la),fb=Ga.OutlineElementNavigator.Le(la,!0);h&&b[ba]&&b[ba].ParaId===ea.ParagraphReader.vU(fb)&&ba++;Ga.OutlineElementNavigator.he(la);if(!fb||!ea.ParagraphReader.Xb(fb)||fb.Gs||""===fb.characterData||"\ufffc"===fb.characterData)continue;const Cb=this.h7d(fb);Cb&&(La&&(Cb.listMarker=this.CH.lMa(La,!1).$R,la=this.ig.Nw(la),
1===la.listType&&la.X5c&&(Cb.kua=la.font)),h&&(b[ba-1]&&b[ba-1].ParaId===ea.ParagraphReader.vU(fb)?Cb.lh=ba:Cb.lh=ba+1),L.add(Cb))}}x.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-n));return L}JDm(){const b=new Zf.a;var h=YI.a.Xea(A.AFrameworkApplication.rootQuerySignature,null);const n=new Dm.a;n.ar=h;n.status=aH.a.nH;this.FHk=window.performance.now();h=this.q1.Yaa(0,()=>{if(2!=n.statusCode||null==n.gk||0==n.gk.length||null==n.gk[0]){const B=
String.format("GetPageEndsOperation Failed with status code: {0};",n.statusCode);b.setException(Error.create(B));x.ULS.sendTraceTag(543802465,3019,10,B)}else b.gg(n.gk[0].PageEnds),x.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.FHk))});h.CG(n);h.w_();return Ug.b(b.task)}Hzi(){const b=this.Izi();if(!b)return-1;let h=0;for(;b.moveNext();){const n=b.iterator;if(11===n.lf){const B=Ga.OutlineElementNavigator.Le(n,!0);Ga.OutlineElementNavigator.he(n);
B&&ea.ParagraphReader.Xb(B)&&!B.Gs&&""!==B.characterData&&"\ufffc"!==B.characterData&&this.h7d(B)&&h++}}return h}Izi(){if(!this.lv)return x.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),null;var b=this.pG.tU(this.lv);if(!b)return x.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=ve.GraphIterator.eb(b);if(!b.tq())return x.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;b=Ff.a.Ft(b,b.origin);b.vp(this.J_m,null);return b}h7d(b){var h;return null!==
(h=this.rRm(b))&&void 0!==h?h:this.bEm(b)}rRm(b){if(!this.kun(b))return null;var h=Object(yp.c)(9);h=Object(yp.a)(h);h=[...ea.ParagraphReader.BDf(b,h)];if(0===h.length)return null;const n=ea.ParagraphReader.C9a(b)+1;return this.H6h(b,h,n)}bEm(b){var h,n,B,L,ba=Object(yp.c)(9);ba=Object(yp.a)(ba);const la=ea.ParagraphReader.w4c(b),La=this.xe.EF(b),{L_m:fb,K$l:Cb}=this.EMm(la,La,ba);ba=null!==(L=null!==(n=null===(h=Cb.linkedStyle)||void 0===h?void 0:h.sRb)&&void 0!==n?n:null===(B=Cb.Gw)||void 0===B?
void 0:B.sRb)&&void 0!==L?L:10;return this.n$c(ba-1)?this.H6h(b,fb,ba):null}H6h(b,h,n){var B;if(!this.n$c(n-1))return null;const {p3j:L,o3j:ba}=this.Znp(b,h);return 0===L.length?null:(h=null===(B=ea.ParagraphReader.V9d(b,L))||void 0===B?void 0:B.trim())&&""!=h?new OC(ba.Ad,ba.endCp,h,b,null,n):null}EMm(b,h,n){const B=[];let L={linkedStyle:null,Gw:null},ba=null,la=null;for(const La of b)if(ba=La.O6.formatting?this.Hum(h,La.O6):ba,b=n(La)){if(!la&&b){la=ba;if(!la)break;L=ba}else if(!this.akn(ba,la))break;
B.push(La)}return{L_m:B,K$l:L}}Znp(b,h){var n;let B=-1,L;for(L=0;L<h.length;L++){var ba=h[L],la=b.characterData.substring(ba.O6.cp,ba.cpEnd),La=null===la||void 0===la?void 0:la.trimStart();if(La){B=ba.O6.cp+(la.length-La.length);break}}if(-1===B)return{p3j:[],o3j:{Ad:-1,endCp:-1}};ba=-1;for(la=h.length;0<la;la--){La=h[la-1];const fb=b.characterData.substring(La.O6.cp,La.cpEnd),Cb=null===fb||void 0===fb?void 0:fb.trimEnd();if(Cb){ba=La.cpEnd-(fb.length-Cb.length);break}}return{p3j:null!==(n=h.slice(L,
la))&&void 0!==n?n:[],o3j:{Ad:B,endCp:ba}}}akn(b,h){return null==b&&null==h&&b===h?!0:null==b||null==h?!1:h.linkedStyle&&b.linkedStyle&&h.linkedStyle.sRb===b.linkedStyle.sRb||h.Gw&&b.Gw&&h.Gw.p1h==b.Gw.p1h?!0:!1}Hum(b,h){h=Va.FormattingReader.DBa(h.formatting);b=this.Jum(b,h);h=this.Gum(h);return b||h?{linkedStyle:b,Gw:h}:null}Jum(b,h){b=this.xe.Sqb(h,b);if(!b)return null;h=b.ja(Lc.a.vj,9);return this.dTj(h)?{y6p:b.id,sRb:h+1}:null}Gum(b){var h;b=this.xe.Ae(b);if(!b||!ok.a.h4i(b))return null;const n=
null!==(h=ok.a.y3c(b))&&void 0!==h?h:"0";h=Number.parseInvariant(n);return this.n$c(h-1)?{p1h:b,sRb:h}:null}kun(b){const h=ea.ParagraphReader.C9a(b);if(!this.n$c(h))return!1;if(this.dTj(h))return!0;b=this.xe.Eq(b);b=this.xe.Ae(b);return ok.a.Jpc(b)?!0:!1}dTj(b){return this.MUf&&this.n$c(b)}n$c(b){return b>=this.cVb&&b<=this.D2b}}Object(u.a)(pB,"StyleBasedDocumentHeadings",null,[326]);var Vy=d(1091);class lu{constructor(){this.startTime=0}}Object(u.a)(lu,"TocCallbackData",null,[]);class mu{constructor(b,
h,n,B,L,ba,la,La,fb,Cb,Lb){this.ZMg=($b,tc,Nc)=>{const dd=tc.node;if(!dd)return x.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),2;if(12!==dd.type)return x.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!dd.Gs)return 2;if(1===Nc)return hc.SessionStatusManager.instance.Gk?8:32;this.xd&&this.xd.isFeatureEnabled(116)?this.YQc.Tvp(dd).then(Hd=>{Hd||this.I9j(dd)}):this.I9j(dd);return 32};this.xAp=$b=>
{$b=window.performance.now()-$b.startTime;x.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",$b));$b=Object.assign(new rb.a,{durationMs:$b});oa.Health.instance.recordKpiSuccess(mu.yck,$b);mu.tfb()};this.zTi=($b,tc,Nc,dd,Hd)=>{if(ea.ParagraphReader.Xb(tc.node)&&tc.node.Gs)return 2;if(1===Nc)return hc.SessionStatusManager.instance.Gk?8:32;if(tc.contextId!==oc.a.Xc||this.ul.Bba(tc)||!ea.ParagraphReader.Xb(tc.node))return 32;this.Wd.$t(17);(null===Hd||void 0===Hd?0:Hd.resolve)?
this.YQc.T9h(tc,Hd.resolve):this.YQc.T9h(tc);return 32};this.Rsg=($b,tc,Nc)=>{$b=tc.node;if(!$b)return x.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==$b.type)return x.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),2;if(!$b.Gs)return 2;if(1===Nc)return hc.SessionStatusManager.instance.Gk?8:32;Nc=null;$b.isConnected&&(Nc=Vy.a.Ekc($b,!0),Nc.qAc($b));tc=new ve.GraphIterator;tc.set($b);tc.zb(8);
tc.ld(8);const dd=this.Pc.Mc(15);dd.qu(tc);this.YQc.iyo($b)?(dd.dispose(),Nc&&Nc.normalize(),mu.tfb()):(Nc&&Nc.cancel(),dd.dispose(),x.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.xxd=h;this.Zc=B;this.Pc=L;this.ul=ba;this.YQc=la;this.Wd=La;this.xd=fb;this.ujh=Cb;this.EQ=Lb}Wb(){this.ga.ra(wb.a.y2b,oc.a.paragraph,this.ZMg);this.ga.ra(wb.a.y2b,oc.a.Bd,this.ZMg);this.ga.ra(wb.a.y2b,oc.a.Xc,this.ZMg);this.ga.Rc(wb.a.y2b,1028);this.ga.ra(Dc.a.pWf,oc.a.Xc,this.zTi);
this.ga.Rc(Dc.a.pWf,1028);this.ga.ra(Dc.a.Tkd,oc.a.paragraph,this.Rsg);this.ga.ra(Dc.a.Tkd,oc.a.Bd,this.Rsg);this.ga.ra(Dc.a.Tkd,oc.a.Xc,this.Rsg);this.ga.Rc(Dc.a.Tkd,1028)}I9j(b){oa.Health.instance.recordKpiUsage(mu.yck,1,mu.bD,null);const h=this.vim(b),n=new lu;n.startTime=window.performance.now();this.xxd.QLj(h,Lc.a.bMg,this.RPm(this.ZDm(b)),this.xAp,null,n);this.YQc.iol()}ohk(b){if(null!=b&&b.Gs)if(null==this.ujh.instance)x.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");
else{var h=this.ujh.instance.VDi();b=this.t9l(b);var n=!1;1===this.EQ.Ax&&(n=!0);0!=b&&h!=b&&(h=[Object.assign(new ia.a,{name:"TOCPageNo",string:b}),Object.assign(new ia.a,{name:"HeadingPageNo",string:h}),Object.assign(new ia.a,{name:"isMainView",string:n})],Pe.a("TOCPageNoMismatch",!0,void 0,h))}}t9l(b){for(let h=0;h<b.qa.length;h++){const n=b.qa.J(h);if(null!=n.fc)for(let B=0;B<n.fc.length;B++){const L=n.fc.J(B);if(1===L.ve&&L.BU.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(n.cp,
b.characterData.length-n.cp))}}return 0}ZDm(b){return b?b.ja(Lc.a.gQ,null):(x.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}vim(b){return this.Zc.Ksa(b,7,7).Ub(35)}RPm(b){const h=[];h.push(b+",TOC,0");return h}static tfb(){A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},
mu.GJa)}}mu.GJa=5E3;mu.yck="WordUpdateTOC";mu.bD="wwaengidc";Object(u.a)(mu,"TableOfContentsActor",null,[323]);class VE{}Object(u.a)(VE,"FieldData",null,[]);class WE extends VE{constructor(){super();this.Nzb=null}}Object(u.a)(WE,"TOCFieldData",VE,[]);class qB{constructor(b,h,n,B,L,ba=null){this.N_m=b;this.yu=h;this.lh=n;this.RYj=B;this.listMarker=L;this.kua=ba}}Object(u.a)(qB,"TOCHeadingData",null,[]);class bH{constructor(b,h){this.w2a=b;this.zp=h}async Jzi(b){this.w2a.MUf=b.NUf;this.w2a.cVb=b.cVb;
this.w2a.D2b=b.D2b;return this.w2a.Kum()}gjm(b){if(b=this.fjm(b))return this.zp.eBa(b)}fjm(b){const h=b.qa.length;for(let n=0;n<h;n++){const B=b.qa.J(n);if(B.hyperlink&&B.hyperlink.fga&&B.hyperlink.url.startsWith(F.a.Imb))return B.hyperlink.url.substr(B.hyperlink.url.indexOf("_Toc"))}return null}mue(b){(b=this.gjm(b))&&this.zp.Gdg(b.id)}FMm(){return this.w2a.Hzi()}Muj(b,h){const n=new WE,B=new ob.a;for(const L of b){b=this.DMm(L,h);if(!b)return null;B.add(b)}n.Nzb=B;return n}DMm(b,h){let n;if(h&&
(n=this.PDl(b),!n))return x.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;h=Cn.AParagraphNode.iV(b.characterData.trim());const B=this.wOm(b.sRb);return new qB(h,n,b.lh,B,b.listMarker,b.kua)}PDl(b){const h=String.format("{0}{1}","_Toc",Se.a.VF());return this.zp.pSc(h,b.Fc,b.end,b.paragraphNode,b.paragraphNode)?h:null}wOm(b){return String.format("toc {0}",b)}}Object(u.a)(bH,"TOCDataManager",null,[263]);class Px{QDg(){const b=Object.assign(new ui.StandardDialog,
{Du:A.AFrameworkApplication.gga,Gd:0,BOa:!1});b.uY(1);b.Nna(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=Px.m_g?Px.m_g:Px.m_g=new Px}}Object(u.a)(Px,"TOCDialogHelper",null,[]);var Vz=d(179),ps=d(534),pK=d(253),PC=d(157);class QC{constructor(b,h,n,B,L,ba,la){this.RDg=b;this.etb=h;this.NUf=n;this.cVb=B;this.D2b=L;this.TJb=ba;this.ltd=[];this.BU=la}toString(){return"showPageNumber:"+this.RDg+
"  isHyperlink:"+this.etb+" includeOutlineLevels:"+this.NUf+" lowerOutlineLevel:"+this.cVb+" upperOutlineLevel:"+this.D2b+" addContentControl:"+this.TJb+" unsupportedSwitches:"+this.ltd.toString()}}Object(u.a)(QC,"TOCSettings",null,[]);class Tj{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd,Hd,xe,je,he){this.snh="TOC";this.Gpb=this.nPe=this.ebf=null;this.hfb=b;this.Oh=h;this.fF=n;this.Zv=B;this.fy=L;this.ul=ba;this.hb=la;this.Qd=La;this.vIh=fb;this.Ge=Cb;this.cbf=Lb;this.Tp=tc;this.$K=Nc;this.Bo=
dd;this.Pc=Hd;this.Gb=xe;this.qh=je;this.jb=he}get n8c(){return this.snh}set n8c(b){this.snh=b}get Ozb(){this.ebf||(this.ebf=this.lxi());return this.ebf}lxi(){return new QC(!0,!0,!0,0,8,!0,this.reo())}async T9h(b,h){Pe.a(Tj.MKl);const n=window.performance.now();if(this.jb.Xb(b.node))if(this.ul.Bba(b))x.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),Tj.oYa("IP is in locked range");else{var B=await this.hfb.Jzi(this.Ozb);if(B){var L=
new Re.a(2,1,0,()=>{this.OKl(b,B,this.Ozb.etb,n);h&&h()});this.Gb.Zb(L)}else x.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),Tj.oYa("Failed to get TOC data")}else x.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),Tj.oYa("Context should be paragraph")}OKl(b,h,n,B=0){let L;try{if(0==B&&(B=window.performance.now()),this.Gni(b.node)){var ba=new ve.GraphIterator;ba.set(b.node);ba.zb(7);ba.ld(7);L=this.Pc.Mc(15);
L.qu(ba);var la=this.hfb.Muj(h,n);la||Tj.oYa("Failed to prepare TOC Field data");var La=la.Nzb?la.Nzb.count:0;if(La){h=null;var fb;for(n=0;n<La;n++){const tc=la.Nzb.J(n);if(!({UMb:fb}=this.wTi(b,h,n,La,tc,Lb?Lb.toString():void 0)).returnValue){Tj.oYa("Failed to populate new TOC paragraph");return}if(0==n){var Cb=fb.currentNode;var Lb=ea.ParagraphReader.vU(Cb)}h=fb}if(this.Ozb.TJb&&!this.ltf(Cb.id,h.io.id))Tj.oYa("Failed to add content control block");else{var $b=window.performance.now()-B;Pe.a(Tj.Muf,
!0,$b)}}else if(this.cbf.QDg(),this.oFl(b)){const tc=window.performance.now()-B;Pe.a(Tj.Muf,!0,tc)}}else Tj.oYa("Failed to fetch style set")}catch(tc){Tj.oYa(String.format("{0} {1}",tc.message,tc.stack))}finally{L&&L.dispose()}}Gni(b){this.nPe=this.fy.EF(b);return this.nPe?!0:(x.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static rMa(b){b=[Object.assign(new ia.a,{name:Tj.vAp,string:b})];Pe.a(Tj.aNg,!1,void 0,b)}static X6f(b){b=[Object.assign(new ia.a,{name:Tj.Vzo,string:b})];
Pe.a(Tj.qDj,!1,void 0,b)}static oYa(b){b=[Object.assign(new ia.a,{name:Tj.NKl,string:b})];Pe.a(Tj.Muf,!1,void 0,b)}async Tvp(b){const h=this.qIi(b);if(null==h)Tj.rMa("Cannot update TOC when firstTocPara = null");else{var n=this.HMm(h);if(0<n.ltd.length)return this.XFn(n.ltd),!1;Pe.a(Tj.uAp);var B=window.performance.now(),L=await this.hfb.Jzi(n);if(!L)return x.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),Tj.rMa("Failed to fetch TOC data"),!1;b=new Re.a(1,1,0,()=>{this.wAp(h,
L,n,B)});this.Gb.Zb(b);return!0}}wAp(b,h,n,B=0){let L;try{if(null==b)Tj.rMa("Attempt to update TOC when firstTocPara = null");else{0==B&&(B=window.performance.now());var ba=new ve.GraphIterator;ba.set(b);ba.zb(7);ba.ld(7);L=this.Pc.Mc(15);L.qu(ba);var la=this.hfb.Muj(h,n.etb);if(null==la)Tj.rMa("Attempt to update TOC when tocFieldData = null");else{var La;if(({iof:La}=this.LCj(b,n)).response){x.ULS.sendTraceTag(559018207,3019,50,String.format("Attempting to update TOC with settings: {0}",n.toString()));
var fb=la.Nzb?la.Nzb.count:0;if(this.Gni(b)){var Cb;this.F0i(b)&&(this.pDj(b),(b=this.jb.zg(b,!1,!0))&&(Cb=b.ja(Lc.a.Yc,null).toString()));var Lb=b.ja(Lc.a.gQ,null);h=Lb;Cb=null!==Cb&&void 0!==Cb?Cb:Lb;if(fb){for(var $b=0,tc;b.Gs&&h==Lb&&$b<fb;){const Hd=la.Nzb.J($b);n.etb&&this.hfb.mue(b);if(!this.Zzp(b,$b,fb,Hd,n)){x.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");Tj.rMa("Failed to update TOC paragraph");return}b.setValue(Lc.a.gQ,Cb);$b++;tc=b;b=this.jb.zg(tc,!1,!0);if(!b){h=
null;break}this.M0i(b)&&this.oDj(b);h=b.ja(Lc.a.gQ,null)}h==Lb&&this.Fsg(b);var Nc;if(({f3f:Nc}=this.HYk(la,$b,fb,tc,Cb)).response)if(n.TJb&&!this.ltf(La,Nc.id))Tj.rMa("Failed to add content control block");else{var dd=window.performance.now()-B;Pe.a(Tj.aNg,!0,dd)}else Tj.rMa("Failed to add new paragraph")}else this.cbf.QDg(),this.rAp(b,n.TJb,La,n.BU,Cb)&&($b=window.performance.now()-B,Pe.a(Tj.aNg,!0,$b))}else Tj.rMa("Failed to fetch style set")}else Tj.rMa("Failed to remove Content Control")}}}catch(Hd){Tj.rMa(String.format("{0} {1}",
Hd.message,Hd.stack))}finally{L&&L.dispose()}}HYk(b,h,n,B,L){let ba=new ve.GraphIterator;for(ba.set(B);h<n;){B=b.Nzb.J(h);if(!({UMb:B}=this.wTi(null,ba,h,n,B,L)).returnValue)return{f3f:ba.currentNode,response:!1};ba=B;h++}return{f3f:ba.currentNode,response:!0}}LCj(b,h){var n;let B,L;const ba=null===(n=null===b||void 0===b?void 0:b.qa)||void 0===n?void 0:n.first.Hb;if(ba&&0<ba.length)if(b=b.qa.first.Hb.J(0),b.fg){n=b.Ud.getValue(Lc.a.Iw);B=this.qh.pr(b.Ud.id,!0);L=this.qh.pr(b.Ud.id,!1);if(0!=this.Tp.mZb(n))return x.ULS.sendTraceTag(558952907,
3019,10,"Failed to release content control"),{response:!1,iof:B,K0h:L};h.TJb=!0}else x.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),h.TJb=!1;else h.TJb=!1;return{response:!0,iof:B,K0h:L}}rAp(b,h,n,B,L){x.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.hfb.mue(b);const ba=this.f6d(b);if(!this.Vtj(ba,h,n,B))return Tj.rMa("Failed to populate empty TOC."),!1;if(h=this.jb.zg(b,!1,!0))n=b.ja(Lc.a.gQ,null),B=h.ja(Lc.a.gQ,null),n==B&&this.Fsg(h);b.setValue(Lc.a.gQ,
L);return!0}Vtj(b,h,n,B){this.Qd.Ne(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.kfj(b);const L=b.qa.first;this.Ge.SN(L.formatting,!0);this.wtf(b,0,1,B);L.XBg&&b.qe.Kq.Z(L.formatting.oe,ju.CharacterPropertiesEditor.GN);return h&&n&&!this.ltf(n,b.id)?!1:!0}f6d(b){b.qa.reset();b.qUa();const h=new Vz.a(b,0);h.formatting=new PC.a(h,S.a.nil);h.mi=!0;b.qa.add(h);return Nd.a.createTextRange(b,0,b.characterData.length)}F0i(b){if(ea.ParagraphReader.JR(b)){var h=b.qa.last.fc;if(!h||!h.length)return!1;
if(4<=h.length){b=0===h.J(h.length-4).ve;const n=1===h.J(h.length-3).ve&&h.J(h.length-3).BU.trim().startsWith(this.n8c),B=2===h.J(h.length-2).ve;h=5===h.J(h.length-1).ve;return b&&n&&B&&h}}return!1}M0i(b){if(ea.ParagraphReader.JR(b)){var h=b.qa.first.fc;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.J(0).ve,h=3===h.J(1).ve,b&&h}return!1}pDj(b){const h=b.qa.last.fc,n=h.J(h.length-4),B=h.J(h.length-3),L=h.J(h.length-2),ba=h.J(h.length-1);h.remove(n);h.remove(B);h.remove(L);h.remove(ba);b.removeProperty(Lc.a.gQ)}oDj(b){const h=
b.qa.first.fc,n=h.J(0),B=h.J(1);h.remove(n);h.remove(B);b.removeProperty(Lc.a.gQ)}Fsg(b){if(b){var h=b.ja(Lc.a.gQ,null),n=b.ja(Lc.a.Yc,null).toString(),B=h;n==h&&this.F0i(b)&&(this.pDj(b),(b=this.jb.zg(b,!1,!0))&&(B=b.ja(Lc.a.gQ,null)));n=new ve.GraphIterator;n.set(b);n.zb(8);x.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var L;b&&b.Gs&&B==h&&L!=b;){if(this.M0i(b)){this.oDj(b);break}this.hfb.mue(b);this.Bo.he(n);B=this.Bo.ht(n,!1,!0);this.Oh.YDa(b);if(!B)return null;
L=b;n.Ub(2);B=(b=n.currentNode)?b.ja(Lc.a.gQ,null):null}return b}}HMm(b){var h=b.qa,n=h?h.length:0,B=null;b=new QC(!0,!1,!1,0,8,!0,void 0);for(let L=0;L<n&&(B=this.GMm(h.J(L)),b.BU=B,B=this.CJm(B),B[0]!==this.n8c);L++);h=B?B.length:0;for(n=1;n<h;n++)switch(B[n]){case "\\h":b.etb=!0;break;case "\\u":b.NUf=!0;break;case "\\o":this.lWo(B[n+1],b)&&n++;break;case "\\z":break;case "\\n":b.RDg=!1;b.ltd.push(B[n]);break;default:b.ltd.push(B[n])}return b}lWo(b,h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&
3===b.length?(h.cVb=Number.parseInvariant(b[1])-1,h.D2b=Number.parseInvariant(b[2])-1,!0):!1}iyo(b){try{Pe.a(Tj.Uzo);const h=window.performance.now(),n=this.qIi(b);if(null==n){Tj.X6f("Attempt to remove TOC when firstTocPara = null");return}let B,L,ba;const la=this.lxi();if(!({iof:B,K0h:L}=this.LCj(n,la)).response)return Tj.X6f("Failed to remove content control"),!1;if(void 0==B&&void 0==L)ba=this.Fsg(n);else{ba=n.Lc.Eb(B);const fb=new ve.GraphIterator;fb.set(ba);fb.zb(8);b=!1;let Cb;for(;!b&&ba&&
Cb!=ba;){ba.id.equals(L)&&(b=!0);ba&&ba.Gs&&this.hfb.mue(ba);this.Bo.he(fb);const Lb=this.Bo.ht(fb,!1,!0);this.Oh.YDa(ba);if(!Lb){ba=null;break}fb.Ub(2);Cb=ba;ba=fb.currentNode}}ba&&this.Qdd(ba);const La=window.performance.now()-h;Pe.a(Tj.qDj,!0,La)}catch(h){Tj.X6f(String.format("{0} {1}",h.message,h.stack))}return!0}Qdd(b){b=Nd.a.Tc(b,0);b=new gn.Selection([b],!0);this.hb.Ic(b)}ltf(b,h){return this.Tp.Nqa(b,h,null,Tj.Khi,!0).returnValue?(x.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),
!1):!0}iol(){this.hfb.FMm()||this.cbf.QDg()}qIi(b){if(!b.Gs)return x.ULS.sendTraceTag(528320659,3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ja(Lc.a.gQ,null);return this.$K.jEm(b)}XFn(b){b.length&&(b=[Object.assign(new ia.a,{name:"UnsupportedSwitches",string:b.toString()})],Pe.a("UnsupportedTocInstruction",void 0,void 0,b))}GMm(b){const h=(b=b.fc)?b.length:0;for(let n=0;n<h;n++)if(1===b.J(n).ve&&b.J(n).BU.trim().startsWith(this.n8c))return b.J(n).BU.trim();return null}CJm(b){const h=
[];if(!b)return h;b=b.split(" ");return b.length?b:h}oFl(b){b=this.vai(b,null,!0,void 0).returnValue;if(!b)return Tj.oYa("Failed to create paragraph"),!1;const h=Nd.a.Tc(b,0);if(!this.Vtj(h,!0,b.id,this.Ozb.BU))return Tj.oYa("Failed to populate empty TOC"),!1;x.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}vai(b,h,n,B){let L,ba;n&&b?(L=this.EFl(b),ba=L.currentNode,B=ea.ParagraphReader.vU(ba).toString()):h&&(L=this.ZAm(h),ba=this.Oh.QJ(L));if(!ba)return x.ULS.sendTraceTag(592233798,
3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,UMb:L};ba.setValue(Lc.a.gQ,B);return{returnValue:ba,UMb:L}}reo(){const b=new Sys.StringBuilder(this.n8c);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}Heo(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.Ozb.etb&&h.append(" \\h");return h.toString()}ZAm(b){b.Jd();this.Bo.he(b);return this.Oh.tta(b,!1)}EFl(b){const h=new ve.GraphIterator;h.set(b.node);h.Jd();this.Bo.he(h);let n=this.MCi(h);const B=
!b.cpBegin;if(xb.OutlineElementReader.isEmpty(h,!0))return this.fTi(n);if(B)return this.Oh.$z(n,!0,!1),this.Oh.Tca(h,n,b,!1,!1,!1),b=this.MCi(n),this.fTi(b);n=this.Oh.tta(h);this.Oh.Tca(h,n,b,!1,!1,!0);b=this.Oh.tta(h);this.Oh.Y_b(b.currentNode,!1);this.Oh.QJ(b);this.Bo.Le(b);return b}MCi(b){const h=new ve.GraphIterator;h.hd(b);h.Jd();return h}fTi(b){this.Oh.$z(b,!0,!0);this.Oh.Y_b(b.currentNode,!1);this.Bo.Le(b);return b}kfj(b){const h=b.qa;1===h.length&&(h.first.mi=!1,b.A1d().mi=!0)}Zzp(b,h,n,B,
L){const ba=this.f6d(b);this.Qd.Ne(ba,"");this.buj(b,B,L);this.wtf(b,h,n,L.BU);return L.etb&&!this.vF(b,B.yu)?!1:!0}wTi(b,h,n,B,L,ba){h=({UMb:b}=this.vai(b,h,0==n,ba)).returnValue;if(!h)return{returnValue:!1,UMb:b};this.buj(h,L,this.Ozb);this.wtf(h,n,B,this.Ozb.BU);return this.Ozb.etb&&!this.vF(h,L.yu)?{returnValue:!1,UMb:b}:{returnValue:!0,UMb:b}}buj(b,h,n){this.Y9m(b,h.N_m,h.listMarker,h.RYj,h.kua);this.vIh.Fan(b,b.characterData.length);n.RDg&&this.U$m(b,h);this.kfj(b);this.LYo(b,h.RYj)}Cym(b,h){if(!b)return 0;
const n=Tj.xOm();return 4<b.length?n.J(h)+.5*Math.floor(b.length/3):n.J(h)}Y9m(b,h,n,B,L){n&&this.p$m(b,n,B);n=Nd.a.Tc(b,b.characterData.length);this.Qd.Ne(n,h);L&&(b=b.qa.sh(0),this.Ge.tha(b.formatting,L))}p$m(b,h,n){n=this.Cym(h,n);const B=Nd.a.Tc(b,0);this.Qd.Ne(B,h);this.vIh.q$m(b,h.length,n)}U$m(b,h){var n=Nd.a.Tc(b,b.characterData.length);this.Qd.Ne(n,h.lh.toString());n=b.qa.sh(b.characterData.length-h.lh.toString().length);h=this.Heo(h.yu);this.ZWa(b,n,0,2,h);this.ZWa(b,n,1,2,h);this.ZWa(b,
n,2,2,h);n=b.qa.sh(b.characterData.length);this.ZWa(b,n,3,2,h)}LYo(b,h){h=this.nPe.gh(h);this.Zv.VN(h,b,!0)}wtf(b,h,n,B){const L=b.qa.first,ba=b.qa.last;h?this.ZWa(b,L,4,1,B):(this.ZWa(b,L,0,1,B),this.ZWa(b,L,1,1,B),this.ZWa(b,L,2,1,B));h===n-1?this.ZWa(b,ba,3,1,B):this.ZWa(b,ba,5,1,B)}ZWa(b,h,n,B,L=null){n=new ps.a(h,null,n,B,!0,!1,!1,L);h.fc||(h.fc=new pK.a(h));h.fc.add(n);b.Jl();this.qLl(n,b)}qLl(b,h){b.oe?h.qe.wX(b.oe-1,2):h.qe.rta(b.oe,2);h.qe.Kq.Z(b.oe,ju.CharacterPropertiesEditor.GN);h.qe.Nt.Z(b.oe,
ju.CharacterPropertiesEditor.fS)}vF(b,h){b=Nd.a.createTextRange(b,0,b.characterData.length);return this.fF.vF(b,h,!1,!1,!1,!0)?!0:(x.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static xOm(){Tj.Oya||(Tj.Oya=new qb.a,Tj.Oya.Z("toc 1",1),Tj.Oya.Z("toc 2",1.5),Tj.Oya.Z("toc 3",2),Tj.Oya.Z("toc 4",2.5),Tj.Oya.Z("toc 5",3),Tj.Oya.Z("toc 6",3.5),Tj.Oya.Z("toc 7",4),Tj.Oya.Z("toc 8",4.5),Tj.Oya.Z("toc 9",5));return Tj.Oya}}Tj.Oya=null;Tj.Khi="Table of Contents";
Tj.MKl="CreateTocClient";Tj.Muf="CreateTocSuccess";Tj.NKl="CreateTocFailureCause";Tj.uAp="UpdateTocClient";Tj.aNg="UpdateTocSuccess";Tj.vAp="UpdateTocFailureCause";Tj.Uzo="RemoveTocClient";Tj.qDj="RemoveTocSuccess";Tj.Vzo="RemoveTocFailureCause";Object(u.a)(Tj,"TOCField",null,[259,260]);var Qx=d(681);class RC{constructor(b,h){this.eGa=b;this.iQa=h}Fan(b,h){if(ea.ParagraphReader.Xb(b)&&!(0>h)){var n=Po.a.rec(b);n=new Qx.a(n,4,1,1);this.eGa.gce(b,n);b=Nd.a.Tc(b,h);this.iQa.tce(b)}}q$m(b,h,n){var B=
Qn.a.gP/2;const L=b.qa.Mqb(h);B=Va.FormattingReader.Bj(L.formatting,Hf.a.fontSize,2*B)/2;n=new Qx.a(Fg.a.Ow(B/36)*n,1,0,1);this.eGa.gce(b,n);b=Nd.a.Tc(b,h);this.iQa.tce(b)}}Object(u.a)(RC,"TOCTabUtility",null,[257]);class rB{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}wc(b){this.W=b;this.W.ia("WordEditor.AutoSaveParamsUpdateService",()=>new $G.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Qw.a.mU)).ha();this.W.ia("WordEditor.TableOfContents.StyleBasedDocumentHeadings",
()=>new pB(new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c),Object($n.a)(),this.W.resolve("Box4.Styles.IWACStyleReader"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),new tq.a,this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Vra)).as("WordEditor.TableOfContents.IDocumentHeadings").ha();this.W.ia("WordEditor.TableOfContents.TOCDataManager",()=>new bH(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").ha();
this.W.ia("WordEditor.TableOfContents.TOCTabUtility",()=>new RC(this.W.resolve("WordEditor.ICustomTabStopUtility"),this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").ha();this.W.ia("WordEditor.TableOfContents.TOCField",()=>new Tj(this.W.resolve("Box4.ITOCDataManager"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),Pd.a.instance,this.W.resolve("Box4.ISelectionManager"),
this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),this.W.resolve("Box4.IFormattingEditor"),Px.instance,this.W.resolve("Box4.IFeatureHelper"),this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.Oa("WordEditor.ParagraphWordIdMapping"),this.W.resolve("Box4.IOutlineElementNavigator"),vm.a.instance,A.AFrameworkApplication.mc,this.W.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").ha();
this.W.ia("WordEditor.TableOfContents.TableOfContentsActor",()=>new mu(A.AFrameworkApplication.va,this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),vm.a.instance,Pd.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.W.resolve("Box4.IFeatureHelper"),this.W.Qa("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").ha()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Wb()}dispose(){}}
Object(u.a)(rB,"PackageManager",null,[0,1]);class Ol{constructor(b,h,n,B,L,ba,la,La){this.EZa=(fb,Cb,Lb,$b,tc)=>{if(!({Pz:fb}=this.Iyb(Cb,Lb,tc,!0,!0)).returnValue)return fb;this.mOd.C$h(tc,Cb.node);return 32};this.NDa=(fb,Cb,Lb,$b,tc)=>this.fNi(Cb,Lb,$b,tc,!0);this.MXb=(fb,Cb,Lb,$b,tc)=>{if(!({Pz:fb}=this.Iyb(Cb,Lb,tc,!1,!0)).returnValue)return fb;this.mOd.uHl(tc,Cb.node);x.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Wqa=(fb,Cb,Lb,$b,tc)=>{if(!({Pz:$b}=this.Iyb(Cb,Lb,tc,!1,
!0)).returnValue)return 2==Lb&&8==$b&&Sp.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],hf.a.pOb),$b;const Nc=Cb.node;let dd=null;(dd=fb===wb.a.Wqa?this.mOd.e3b(tc[$g.a.SourceControlId],Nc):this.Ry.D9d(Nc,tc))?(this.mqe(Nc,()=>{this.eQd.c0b(dd,Nc)}),this.NS(),$b=32):(Sp.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],hf.a.pOb),$b=8);fb===wb.a.Wqa&&32===$b&&x.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");x.ULS.shipAssertTag(0,
324,32===$b);return $b};this.sza=(fb,Cb,Lb,$b,tc)=>this.fNi(Cb,Lb,$b,tc,!1);this.oCe=(fb,Cb,Lb,$b,tc)=>Ks.a.Tua(fb,Cb,Lb,$b,tc,{},14);this.JLb=(fb,Cb,Lb,$b,tc)=>{if(!({Pz:fb}=this.Iyb(Cb,Lb,tc,!1,!1)).returnValue)return fb;const Nc=Cb.node;this.mqe(Nc,()=>{this.eQd.lsl(Nc)});return 32};this.Ry=b;this.mOd=h;this.ga=n;this.eQd=B;this.Pc=L;this.uB=ba;this.kCk=La}Wb(){this.gvc($e.App.n0a.c$h())}gvc(b){this.ga.ra(wb.a.EZa,oc.a.view,b);this.ga.ra(wb.a.EZa,oc.a.table,this.EZa);this.ga.Rc(wb.a.EZa,1127);
this.ga.ra(wb.a.Wqa,oc.a.view,this.oCe);this.ga.ra(wb.a.Wqa,oc.a.table,this.Wqa);this.ga.Rc(wb.a.Wqa,1030);this.ga.ra(wb.a.HT,oc.a.table,this.Wqa);this.ga.ra(wb.a.sza,oc.a.view,this.oCe);this.ga.ra(wb.a.sza,oc.a.table,this.sza);this.ga.Rc(wb.a.sza,1038);this.ga.ra(wb.a.NDa,oc.a.view,b);this.ga.ra(wb.a.NDa,oc.a.table,this.NDa);this.ga.Rc(wb.a.NDa,1127);this.ga.ra(wb.a.MXb,oc.a.view,b);this.ga.ra(wb.a.MXb,oc.a.table,this.MXb);this.ga.Rc(wb.a.MXb,1126);this.ga.ra(wb.a.JLb,oc.a.view,this.oCe);this.ga.ra(wb.a.JLb,
oc.a.table,this.JLb);this.ga.Rc(wb.a.JLb,1028)}NS(){A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}fNi(b,h,n,B,L){if(!({Pz:ba}=this.Iyb(b,h,B,L,!0)).returnValue)return 2==h&&8==ba&&Sp.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],
hf.a.K5l),ba;b=b.node;h=this.Ry.k3(b);var ba=B[$g.a.On];const la=Ol.$Mm(B.MenuItemId);L?B[$g.a.On]=Ol.H3o(h,la):(this.Y8k(h,la,ba,b),n.Gt=la,n.lE=ba?0:1,x.ULS.shipAssertTag(0,324,!!la));return 32}mqe(b,h){const n=this.Pc.Mc(15);try{n.Ab(b),this.uB.txb(),h()}finally{n&&n.dispose()}}Iyb(b,h,n,B,L){return this.qsn(b,h,n,B,L)?{returnValue:B||2===h,Pz:32}:{returnValue:!1,Pz:8}}qsn(b,h,n,B,L){if(b.contextId!==oc.a.table)return!1;if(B||2===h)if(L&&!n||!Object(Wb.a)(NA.TableNode,b.node)||this.kCk(b.node))return!1;
return!0}Y8k(b,h,n,B){const L=(512===h||1024===h?!n:n)?b|h:b&~h;L!==b&&this.mqe(B,()=>{this.eQd.xEa(L,B)})}static YE(){Ol.olb[Ol.D$l]=32;Ol.olb[Ol.u$l]=128;Ol.olb[Ol.Hwn]=64;Ol.olb[Ol.wwn]=256;Ol.olb[Ol.Hbl]=512;Ol.olb[Ol.Gbl]=1024}static H3o(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static $Mm(b){let h=0;b in Ol.olb&&(h=Ol.olb[b]);return h}}Ol.D$l="buttonFirstRow";Ol.u$l="buttonFirstColumn";Ol.Hwn="buttonLastRow";Ol.wwn="buttonLastColumn";Ol.Hbl="buttonBandedRow";Ol.Gbl="buttonBandedColumn";
Ol.olb={};Object(u.a)(Ol,"TableStyleActor",null,[]);Ol.YE();var Wz=d(442);class sB extends Wz.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(u.a)(sB,"TableGalleryButtonProps",Wz.a,[]);class SC extends sB{constructor(){super()}get Type(){return 6}}Object(u.a)(SC,"TableStyleGalleryButtonProps",sB,[]);class Xz{}Xz.tRn=2147483647;Object(u.a)(Xz,"TableStyleUtil",null,[]);class gt{constructor(b,h,n){this.tpf="Clear";this.mOb=null;this.FPk=b;this.xe=h;this.Ry=n;
this.Vfa=A.AFrameworkApplication.Vfa;this.Ys=A.AFrameworkApplication.Ys}l8a(){}PWk(b,h){this.l8a(b);const n=this.xti(b),B=n.length;if(!(0>=B)){var L=Xz.tRn,ba=null;for(let fb=0;fb<B;fb++){var la=n[fb],La=this.Ry.qNm(la);L!==La&&(L=Object.assign(new te.a,{Id:"msMoreTableStyles"+La,Title:this.rNm(La),ControlList:[]}),ba=Object.assign(new fl.a,{Type:6,Id:"galleryMoreTableStyles"+La,ExternalGalleryId:"TableStylesGallery",Width:gt.lGg,ElementDimensions:"Size64by48",GalleryItems:[]}),this.mOb&&(ba.ExternalId=
this.mOb[La.toString()]),L.ControlList.push(ba),h.MenuSectionList.push(L),L=La);La=this.xe.aK(la);la=gt.CHg+fb;La=Object.assign(new SC,{Id:la,ExternalId:la,Command:wb.a.Wqa.toString(),QueryCommand:wb.a.EZa.toString(),LabelText:La?F.a.Hf(La):"",Alt:La,VerticalCenterAlign:"true"});La.TableCellStyles=this.K9d(la,b);La.TableStyles=this.L4c(la,b);ba&&ba.GalleryItems.push(La)}}}OWk(b){const h=Object.assign(new te.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",
ControlList:[]}),n=Object.assign(new jj.a,{Id:"fseaClearTableFormatting",Command:wb.a.JLb.toString(),LabelText:F.a.Hf(this.tpf),Alt:F.a.Hf(this.tpf),Image16by16:this.Ys,Image16by16Class:Bb.getImageClassWithCluster(this.Vfa,gt.ksl),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(n);b.MenuSectionList.push(h)}C$h(b,h){this.l8a(h);const n=b[$g.a.SourceControlId];var B=this.e3b(n,h);if(B){var L=this.Ry.VG(h);L=L?this.xe.Ae(L):null;var ba=this.xe.aK(B);B=this.xe.Ae(B);b[Jj.a.Alt]=
ba;b[Jj.a.On]=B===L;h=Object.assign(new SC,{Id:n,ExternalId:n,Command:wb.a.Wqa.toString(),QueryCommand:wb.a.EZa.toString(),TableCellStyles:this.K9d(n,h),TableStyles:this.L4c(n,h),Alt:ba});b[Jj.a.GalleryButtonProps]=h}else b[Jj.a.InnerHTML]=null,b[Jj.a.Alt]=null,b[Jj.a.On]=!1,b[Jj.a.GalleryButtonProps]=null}K9d(b,h){this.l8a(h);return(b=this.e3b(b,h))?this.FPk.Yui(b,h):null}L4c(b,h){this.l8a(h);return this.e3b(b,h),null}uHl(b,h){b.MenuItems=this.vAm(h)}vAm(b){const h=Object.assign(new vh.a,{Id:"menuMoreTableStyles",
MenuSectionList:[]});this.PWk(b,h);this.OWk(h);return h}e3b(b,h){return b?b.startsWith(gt.CHg)?this.$Pf(parseInt(b.substr(gt.CHg.length)),h):this.BGo(parseInt(b.substr(gt.Zgp.length)),h):null}}gt.CHg="buttonTableStyleMenu";gt.Zgp="buttonTableStyleRibbon";gt.lGg=7;gt.ksl="ClearTableStyle_16x16x32";Object(u.a)(gt,"ATableStyleRibbonControl",null,[256]);class tB extends gt{constructor(b,h,n){super(null,h,n);this.AHh=b}C$h(b,h){this.l8a(h);const n=b[$g.a.SourceControlId];var B=this.e3b(n,h);if(B){var L=
this.Ry.VG(h);L=L?this.xe.Ae(L):null;var ba=this.xe.aK(B);B=this.xe.Ae(B);b[Jj.a.Alt]=ba;b[Jj.a.On]=B===L;h=Object.assign(new SC,{Id:n,ExternalId:n,Command:wb.a.Wqa.toString(),QueryCommand:wb.a.EZa.toString(),TableCellStyles:this.K9d(n,h),TableStyles:this.L4c(n,h),Alt:ba});b[Jj.a.GalleryButtonProps]=h}else b[Jj.a.InnerHTML]=null,b[Jj.a.Alt]=null,b[Jj.a.On]=!1,b[Jj.a.GalleryButtonProps]=null}K9d(b,h){this.l8a(h);return(b=this.e3b(b,h))?this.AHh.Yui(b,h,5,5):null}L4c(b,h){this.l8a(h);return this.e3b(b,
h),null}}Object(u.a)(tB,"ATableStyleRibbonControlVariableSizePreviews",gt,[]);var XE=d(1537),cH=d(1224);class Rw{constructor(b,h,n,B){this.xjm=(L,ba)=>this.getBorder(L,this.p5.mP(ba));this.wjm=(L,ba)=>this.getBorder(L,this.p5.zR(ba));this.fy=b;this.Mz=h;this.IIb=n;this.p5=B;this.qpk=new Rf.a(()=>this.vjm());this.Vgb=new Rf.a(()=>this.ujm())}vjm(){const b={},h=A.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";b.right=h?"border-left":"border-right";
b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":"border-right";return b}ujm(){const b={};b[vi.a.Dza]=vi.a.Pmb;b[vi.a.Pmb]=vi.a.Pmb;b[vi.a.r6a]=vi.a.r6a;return b}oEl(b,h,n,B){const L=new cH.a;L.rowCount=n;L.wnb=B;L.b0a=this.IIb.xMm(b);L.Ja=b.ja(Lc.a.Ja,1);L.Ia=b.ja(Lc.a.Ia,1);L.tableLook=h;L.iCe=1;return L}Yui(b,h,n,B){if(!this.fy.Ae(b)||!Object(Wb.a)(277,b)||!Object(Wb.a)(bu.a,h))return null;const L=this.Mz.k3(h);n=this.oEl(b,L,n,B);B=[];for(n.rowIndex=0;n.rowIndex<n.rowCount;n.rowIndex++)this.XYk(b,
h,n,B);return B}L4c(){return null}Kla(){}XYk(b,h,n,B){n.Lmc=!n.rowIndex;for(n.cellIndex=0;n.cellIndex<n.wnb;n.cellIndex++)this.oVk(b,h,n,B)}oVk(b,h,n,B){h=this.IIb.nxl(n,this.IIb.qIf(n),h,b);const L={};var ba=this.Mz.gIf(b,h,Hf.a.fontColor,!0,Hm.a.jN(),"None");L.color=ba?ba:"inherit";ba=this.Mz.gIf(b,h,Hf.a.MJ,!0,Hm.a.jN(),"None");L["background-color"]=ba?ba:"inherit";this.zZk(n,b,h,L);B.push(L)}zZk(b,h,n,B){b=this.IIb.NVa(b);this.dRd(5,b,h,n,B);this.dRd(3,b,h,n,B);this.dRd(0,b,h,n,B);this.dRd(4,
b,h,n,B)}dRd(b,h,n,B,L){h=this.Aqm(b,h,n,B);h!==vi.a.RH&&(L[this.qpk.value[XE.a[b]]]=h)}Aqm(b,h,n,B){let L=vi.a.RH;if(({gra:L}=this.oPa(B,b,1,h,this.wjm,L)).returnValue)return L;({gra:L}=this.oPa(n,b,3,h,this.xjm,L));return L}oPa(b,h,n,B,L,ba){return this.p5.vSj(n,h,B)&&(ba=L(b,h))!==vi.a.RH||!h&&({gra:ba}=this.oPa(b,1,n,B,L,ba)).returnValue||4===h&&({gra:ba}=this.oPa(b,2,n,B,L,ba)).returnValue?{returnValue:!0,gra:ba}:{returnValue:ba!==vi.a.RH,gra:ba}}getBorder(b,h){let n="",B,L;({borderStyle:B,borderWidth:L}=
this.Bjm(b,h));if(B===vi.a.r6a)return n;n=String.format(vi.a.VTd,L,B,this.njm(b,h));return n.trim()}njm(b,h){if(!h)return vi.a.E2;b=this.Mz.p0c(b,h.color,Nl.a.auto);return b!==Nl.a.auto?Nl.a.VC(b):vi.a.E2}Bjm(b,h){var n=vi.a.Cza;let B=vi.a.TH+vi.a.Ydc;if(!h)return{borderStyle:n,borderWidth:B};n=this.Mz.p0c(b,h.style,vi.a.r6a);b=this.Mz.p0c(b,h.size,vi.a.TH);B=this.yjm(n,b)+vi.a.Ydc;n=this.pjm(n);return{borderStyle:n,borderWidth:B}}yjm(b,h){let n=2;b===vi.a.UKb&&h<vi.a.maa&&(n=1);return n}pjm(b){return this.Vgb.value[b]||
vi.a.Wdc}static uNm(){return new Rw(Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ya.a.instance.resolve("WordEditor.IWACTableStyleReader"),wr.a.instance,vi.a.instance)}static get instance(){return null!=Rw.uZg?Rw.uZg:Rw.uZg=Rw.uNm()}}Object(u.a)(Rw,"TableStylePreviewGenerator",null,[297]);var Rx;(function(b){b[b.KTp=0]="background1";b[b.cnq=1]="text1";b[b.LTp=2]="background2";b[b.dnq=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";
b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.v0p=11]="followedHyperlink";b[b.XWp=12]="dark1";b[b.m6p=13]="light1";b[b.YWp=14]="dark2";b[b.n6p=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(Rx||(Rx={}));Object(u.b)("ThemeColor",Rx);class Sx{constructor(b){this.u9b=b}shm(b,h,n){let B;({xyj:h,aWh:B}=this.wHm(h));b=[];const L=[];for(let la=0;16>la;la++){if(!(Rx[la]in n.SIb))continue;const La=la,fb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,
WoncaIntl.WoncaStrings[B[La]],this.oxm(la));var ba=h[La];ba=ba&4278190080|(ba&255)<<16|ba&65280|(ba&16711680)>>>16;L.push(Object.assign(new gm,{Color:La.toString(),DisplayColor:"#"+F.a.PJ(ba,6),Alt:F.a.Hf(fb)}));b[b.length]=la}return{returnValue:L,ijp:b}}oxm(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;
case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}wHm(b){let h=null,n=null;b=this.u9b(b);if(!b)return{xyj:h,aWh:n};h=b.properties.ja(Lc.a.cfb,null);n=b.properties.getValue(Lc.a.XCe).split(" ");return{xyj:h,aWh:n}}static wNm(){return new Sx(Object(z.a)(Object($n.a)(),Object($n.a)().Iu,"navigateToPageContentNode"))}static get instance(){return null!=
Sx.OZg?Sx.OZg:Sx.OZg=Sx.wNm()}}Object(u.a)(Sx,"TableStyleThemeHelper",null,[284]);var Yz=d(967);class nu{get ei(){return null!=this.K4g?this.K4g:this.K4g=Ya.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(b,h){this.iaf={};this.SIb={};this.xe=b;this.Ry=h}GBf(b,h){const n=this.iaf[Rx[h]];return n&&n.length?n:this.mfm(b,h)}uAi(b,h,n){if(h=this.GBf(h,n))for(b=this.xe.Ae(b),n=0;n<h.length;n++)if(this.xe.Ae(h[n])===b)return n;return-1}Kla(){this.iaf={};this.SIb={}}mfm(b,h){const n=[];this.SIb={};
b=this.Ry.H4c(b);this.LSd(n,this.SIb,0,h,b);this.LSd(n,this.SIb,1,h,b);this.LSd(n,this.SIb,2,h,b);this.LSd(n,this.SIb,3,h,b);return this.iaf[Rx[h]]=n}LSd(b,h,n,B,L){const ba=L.JG,la=L.uy();for(let fb=0;fb<ba;fb++){var La=void 0;this.ei.qr?(La=la.rla(fb),La=L.gh(this.xe.Ae(La))):La=L.yBa(fb);if(3!==this.xe.FF(La))continue;const Cb=this.Ry.pNm(La),Lb=this.Ry.Q9d(La);h[Rx[Lb]]=!0;Cb!==n||Lb!==B&&16!==Lb||this.xe.Ae(La)===Yz.a.$Vb||(b[b.length]=La)}}static eRm(){return new nu(Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),
Ya.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static kLl(){return nu.eRm()}}Object(u.a)(nu,"WACTableStyleRibbonList",null,[282]);class jv extends tB{constructor(b,h,n,B,L){super(b,h,n);this.S5b=4;this.GOd=[];this.jcn=()=>{this.Sbc.Kla();this.AHh.Kla()};this.GPk=L;this.Sbc=B;this.tpf=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.jco()}jEl(b,h){b.MenuItems=this.xem(h)}jco(){this.mOb={};this.mOb["0"]="CustomTableStyles";this.mOb["1"]="PlainTableStyles";this.mOb["2"]="GridTableStyles";
this.mOb["3"]="ListTableStyles"}xem(b){const h=Object.assign(new vh.a,{Id:"menuTableTheme"});h.MenuSectionList=[];if(this.Irn(b))return h;const n=Object.assign(new te.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),B=Object.assign(new Sv.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:Dc.a.smb.toString(),QueryCommand:Dc.a.CYb.toString(),Width:jv.jjp});B.Colors=({ijp:this.GOd}=this.GPk.shm(this.GOd,b,this.Sbc)).returnValue;n.ControlList.push(B);
h.MenuSectionList.push(n);return h}l8a(b){if(b=this.Ry.VG(b))b=this.Ry.Q9d(b),16!==b&&(this.S5b=b)}xti(b){return this.Sbc.GBf(b,this.S5b)}$Pf(b,h){h=this.Sbc.GBf(h,this.S5b);return 0>b||b>=h.length?null:h[b]}BGo(b,h){var n=this.Ry.VG(h);n=this.Sbc.uAi(n,h,this.S5b);n=-1!==n?Math.floor(n/gt.lGg)*gt.lGg:0;return this.$Pf(n+b,h)}rNm(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;
case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}Irn(b){this.l8a(b);return 0>=this.xti(b).length}pAp(b,h){if(!b||!h)return null;b=parseInt(b[$a.Color]);var n=this.Ry.VG(h);const B=this.Ry.Q9d(n);if(B===b)return null;if(16===B)return this.S5b=b,null;n=this.Sbc.uAi(n,h,B);this.S5b=b;return this.$Pf(n,h)}NSl(b){b=this.Ry.VG(b);b=this.Ry.Q9d(b);if(16!==b)for(let h=0;h<this.GOd.length;h++)if(this.GOd[h]===b)return h;return-1}bmb(b){b.Gef(this.jcn,2)}static vNm(){return new jv(Rw.instance,
Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ya.a.instance.resolve("WordEditor.IWACTableStyleReader"),nu.kLl(),Sx.instance)}static get instance(){return null!=jv.s_g?jv.s_g:jv.s_g=jv.vNm()}}jv.jjp=4;Object(u.a)(jv,"TableStyleRibbonControls",tB,[255,256]);var uB=d(1637);class ht extends Ol{constructor(b,h,n,B,L,ba,la,La){super(b,h,n,B,L,ba,la,La);this.juc=(fb,Cb,Lb,$b,tc)=>{if(!({Pz:fb}=this.Iyb(Cb,Lb,tc,!1,!0)).returnValue)return fb;this.EHg.jEl(tc,Cb.node);return 32};this.smb=(fb,Cb,Lb,$b,
tc)=>{if(!({Pz:fb}=this.Iyb(Cb,Lb,tc,!1,!0)).returnValue)return 2==Lb&&8==fb&&Sp.a.recordQosError("TableStyleColorButtonClickNoResponse",["TableInteractionFailed"],hf.a.L5l),fb;const Nc=Cb.node,dd=this.EHg.pAp(tc,Nc);dd&&this.mqe(Nc,()=>{this.eQd.c0b(dd,Nc)});return 32};this.CYb=(fb,Cb,Lb,$b,tc)=>{if(!({Pz:fb}=this.Iyb(Cb,Lb,tc,!0,!0)).returnValue)return fb;tc[$a.IndexColorSelected]=this.EHg.NSl(Cb.node);return 32}}gvc(b){super.gvc(b);this.ga.ra(Dc.a.smb,oc.a.view,this.oCe);this.ga.ra(Dc.a.smb,oc.a.table,
this.smb);this.ga.Rc(Dc.a.smb,1030);this.ga.ra(Dc.a.juc,oc.a.view,b);this.ga.ra(Dc.a.juc,oc.a.table,this.juc);this.ga.Rc(Dc.a.juc,1126);this.ga.ra(Dc.a.CYb,oc.a.view,b);this.ga.ra(Dc.a.CYb,oc.a.table,this.CYb);this.ga.Rc(Dc.a.CYb,1127)}get EHg(){return this.mOd}static oNm(){return new ht(Ya.a.instance.resolve("WordEditor.IWACTableStyleReader"),jv.instance,A.AFrameworkApplication.va,uB.a.instance,new vm.a,Ya.a.instance.resolve("Box4.IInsertionPointFormatting"),Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Object(z.a)(Pd.a.instance,Pd.a.instance.Otb,"isTableNodeInLockedRange"))}static get instance(){return null!=ht.CZg?ht.CZg:ht.CZg=ht.oNm()}}Object(u.a)(ht,"TableStyleActor",Ol,[]);class YE{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}wc(b){this.W=b;this.W.ia("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>Rw.instance).ha();this.W.ia("Box4.TableEditors.IWACTableStyleEditor",()=>uB.a.instance).ha()}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>
{this.Mo()})}Mo(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(107)&&(ht.instance.Wb(),jv.instance.bmb(zy.a.instance),Ua.StaticActiveAppFrame.za().Ie())}dispose(){}}Object(u.a)(YE,"TableStylePackage",null,[0,1]);var ZE=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",
ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},
children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",
LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",
QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},
children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",
Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",
Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",
Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},ZI=d(1517);class Zz{constructor(b,h){this.FRa=b;this.ZFa=h}Wuo(b){this.FRa.NRd(b)}gJa(b){this.ZFa.gJa(b)}u0b(b,
h){return this.ZFa.u0b(b,h)}t0b(b,h){return this.ZFa.t0b(b,h)}SDe(b,h,n){this.ZFa.SDe(b,h,n)}}Object(u.a)(Zz,"ClientPaginationHeaderFooterBridge",null,[347]);class $E{constructor(b,h){this.Ym=b;this.ga=h;this.Zda=new gp.a;this.$da=new gp.a}gJa(b){b=ve.GraphIterator.eb(b);if(b.tq()&&b.Dq()){b.Xd();do 10===b.lf&&this.Alg(b.currentNode),b.Cu();while(8!==b.lf)}}u0b(b,h){var n=this.EQb(h);if(!this.Zda.mb(n))return x.ULS.sendTraceTag(573400388,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+
n),!1;h=this.Zda.J(n);x.ULS.shipAssertTag(573400389,336,this.$da.mb(n),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");n=this.$da.J(n);return this.$Sf(h,b,n)}t0b(b,h){var n=this.EQb(h);if(!this.Zda.mb(n))return x.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+n),!1;h=this.Zda.J(n);x.ULS.shipAssertTag(573400391,336,this.$da.mb(n),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");
n=this.$da.J(n);return this.hFf(h,b,n)}SDe(b,h,n){h=this.UOf(h,n);this.ga.Pb(b?Dc.a.vGe:Dc.a.yud,2,h)}UOf(b,h){h=this.Ym.LPb(h);if(!h)return x.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;h=this.Ym.tla(h);const n=1===b;b=!(b%2);return 1===h?1:2===h?n?2:1:3===h?b?3:4:n?2:b?3:4}Alg(b){if(10===b.type){var h=new gp.a,n=this.Ym.LPb(b);x.ULS.shipAssertTag(573400393,336,!!n,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");
var B=this.Ym.tla(n);b=this.EQb(b);this.QMg(b,B);this.PMg(b,h);n=ve.GraphIterator.eb(n);if(n.Dq()){n.Xd();do b=n.currentNode,B=this.Ym.w3c(b),b=this.Ym.GOi(b),h.add(B,b),n.Cu();while(36===n.lf)}}}QMg(b,h){this.$da.mb(b)?this.$da.Z(b,h):this.$da.add(b,h)}PMg(b,h){this.Zda.mb(b)?this.Zda.Z(b,h):this.Zda.add(b,h)}EQb(b){x.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ja(Lc.a.yna,0)}$Sf(b,h,n){const B=1===h;h=!(h%2);switch(n){case 2:if(B){if(b.mb(2))return b.J(2)}else if(b.mb(0))return b.J(0);
break;case 3:if(h){if(b.mb(1))return b.J(1)}else if(b.mb(0))return b.J(0);break;case 4:if(B){if(b.mb(2))return b.J(2)}else if(h){if(b.mb(1))return b.J(1)}else if(b.mb(0))return b.J(0);break;case 1:if(b.mb(0))return b.J(0)}return!1}hFf(b,h,n){const B=1===h;h=!(h%2);switch(n){case 2:if(B){if(b.mb(5))return b.J(5)}else if(b.mb(3))return b.J(3);break;case 3:if(h){if(b.mb(4))return b.J(4)}else if(b.mb(3))return b.J(3);break;case 4:if(B){if(b.mb(5))return b.J(5)}else if(h){if(b.mb(4))return b.J(4)}else if(b.mb(3))return b.J(3);
break;case 1:if(b.mb(3))return b.J(3)}return!1}}Object(u.a)($E,"ClientPaginationPageAdornmentContentManager",null,[349]);class aF{constructor(b,h,n,B,L,ba){this.lyl=la=>{1===la&&this.hG.mG&&(la=this.Zc.Ksa(this.hG.mG,8,8),this.Ym.Nkl(la)?this.nQl(la):this.F5o())};this.grp=la=>{1===la&&this.ga.Pb(wb.a.YX,2,!1)};this.hG=b;this.Ym=h;this.Zc=n;this.Pc=B;this.vIc=L;this.ga=ba}U5o(){const b=new ui.StandardDialog;b.Gd=1;b.Pe(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);
b.uY(0);b.Ix(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.lyl)}nQl(b){b.ld(8);const h=this.Pc.Mc(15);h.set(b.io.pk);this.vIc.jxo(b);this.hG.dismiss();h.dispose();x.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}F5o(){const b=new ui.StandardDialog;b.Gd=1;b.Pe(1,Box4Intl.Box4Strings.L_OpenInWord);b.Pe(0,CommonUIStrings.l_Close);b.uY(0);b.Ix(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,
0,this.grp);x.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(u.a)(aF,"DeleteHeaderFooterDialog",null,[]);class kv{constructor(b,h,n,B,L){this.Ym=b;this.Zc=h;this.Pc=n;this.vIc=B;this.ga=L}create(b){return new aF(b,this.Ym,this.Zc,this.Pc,this.vIc,this.ga)}}Object(u.a)(kv,"DeleteHeaderFooterDialogFactory",null,[348]);class vB{constructor(b,h,n,B,L,ba,la,La,fb,Cb){this.Kda=null;this.nJg=(Lb,$b,tc,Nc,dd)=>{var Hd=this.dQf($b);return Hd?1===tc?32:(tc=this.control)?
($b=this.Pc.Mc(15),$b.Ab(Hd),$b.yi=Lb,tc.hfa?this.ga.Ob(Dc.a.VW,2):(Hd=this.lli(Hd),Nc.Gt=Hd?1:0,Nc=Lb!==Dc.a.yud,(Lb=this.AKf(Lb,dd))&&tc.tEa(Lb),this.ga.Pb(Dc.a.d0d,2,Nc)),$b.dispose(),32):8:8};this.Ewf=(Lb,$b,tc)=>{if(1===tc)return 32;this.htk.create(this.control).U5o();return 32};this.Vjo=(Lb,$b,tc,Nc,dd)=>1===tc?32:(Lb=this.control)?(dd[$g.a.On]=Lb.hfa,32):8;this.zyb=(Lb,$b,tc,Nc,dd)=>{if(1===tc||!this.control.hfa)return 32;$b=this.Gzi(Lb,dd);tc=vB.GKi(this.control.mG);Nc=this.Pc.Mc(15);Nc.Ab(tc);
Nc.yi=Lb;Lb=this.Zc.Ql();Lb.set(tc);this.GRa.EBf(Lb.currentNode,$b);this.Ym.KVb(Lb);this.vIc.fQj(Lb,$b);Nc.dispose();return 32};this.tEa=(Lb,$b,tc,Nc,dd)=>{if(1===tc)return 32;Lb=this.AKf(Lb,dd);this.control.hfa&&this.control.tEa(Lb);return 32};this.gxe=(Lb,$b,tc,Nc,dd)=>{if(1===tc)return 32;Lb=this.RGi(Lb,dd);Nc.Gt=Lb;$b=this.dQf($b);if(!$b)return 8;Nc=this.Zc.Ql();Nc.set($b);Nc.zb(8);Nc.qt(8);if(!this.ll.mOn(Nc,Lb))return 8;this.Ym.KVb(Nc);this.control.Mka(Nc.currentNode);return 32};this.Blg=(Lb,
$b,tc,Nc,dd)=>{if(1===tc)return 32;Lb=this.OQk.GJl(this.dQf($b));dd.PopulationXML=Lb;return 32};this.Pse=(Lb,$b,tc,Nc,dd)=>{Lb=this.Gzi(Lb,dd);$b=this.control.mG;tc=this.Ym.tla($b);dd[$g.a.On]=Lb===tc;1===Lb&&(dd[$g.a.LabelText]=this.LLi($b)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.Ore=(Lb,$b,tc,Nc,dd)=>{if(1===tc||!this.control.hfa)return 32;$b=this.control.mG;void 0!==$b&&null!==$b&&($b=this.Ym.tla($b),
Lb=this.AKf(Lb,dd),tc=this.control.U5b,dd[$g.a.Visible]=this.fip(Lb,$b),dd[$g.a.On]=Lb===tc);return 32};this.kko=(Lb,$b,tc,Nc,dd)=>{if(1===tc||!this.control.hfa)return 32;Lb=this.control.mG;void 0!==Lb&&null!==Lb&&this.Fco(Lb,dd);return 32};this.ujo=(Lb,$b,tc,Nc,dd)=>{if(1===tc||!this.control.hfa)return 32;Lb=this.RGi(Lb,dd);$b=this.control.mG;tc=0;void 0!==$b&&null!==$b&&(tc=$b.getValue(Lc.a.yna));dd[$g.a.On]=Lb===tc;return 32};this.VW=(Lb,$b,tc)=>{if(1===tc)return 32;this.control.dismiss();return 32};
this.Dae=()=>32;this.d0d=(Lb,$b,tc,Nc,dd)=>{if(1===tc)return 32;this.control.show(dd);return 32};this.kub=(Lb,$b,tc,Nc,dd)=>{if(1===tc)return 32;if(!dd)return 8;$b=dd.h7a;if(!$b||!$b.isConnected)return 8;Lb=this.Ym.$dd($b);if(!({isHeader:tc,oIg:$b}=this.Ym.aJi($b)).returnValue)return 8;this.control.Mka(Lb);this.control.tEa($b);this.control.show(tc,dd.dze);return 32};this.ga=b;this.Ym=h;this.vIc=n;this.GRa=B;this.ll=L;this.Zc=ba;this.Pc=la;this.OQk=La;this.Gxk=fb;this.htk=Cb}get control(){return this.Kda}set control(b){this.Kda=
b}Wb(){this.ga.ra(Dc.a.jce,oc.a.view,this.nJg);this.ga.fb(Dc.a.Log,oc.a.application,this.Vjo,96);this.ga.ra(Dc.a.vGe,oc.a.view,this.nJg);this.ga.ra(Dc.a.yud,oc.a.view,this.nJg);this.ga.fb(Dc.a.Dae,oc.a.view,this.Dae,64);this.ga.ra(Dc.a.d0d,oc.a.view,this.d0d);this.ga.fb(Dc.a.VW,oc.a.application,this.VW,96);this.ga.fb(Dc.a.kub,oc.a.application,this.kub,96);this.ga.fb(Dc.a.uQo,oc.a.view,this.tEa,96);this.ga.ra(Dc.a.sMj,oc.a.view,this.tEa);this.ga.ra(Dc.a.uMj,oc.a.view,this.tEa);this.ga.ra(Dc.a.tMj,
oc.a.view,this.tEa);this.ga.ra(Dc.a.vMj,oc.a.view,this.tEa);this.ga.fb(Dc.a.UTo,oc.a.view,this.zyb,100);this.ga.fb(Dc.a.eOj,oc.a.view,this.zyb,4);this.ga.fb(Dc.a.dOj,oc.a.view,this.zyb,4);this.ga.fb(Dc.a.bOj,oc.a.view,this.zyb,4);this.ga.fb(Dc.a.cOj,oc.a.view,this.zyb,4);this.ga.ra(Dc.a.gxe,oc.a.view,this.gxe);this.ga.ra(Dc.a.Vyg,oc.a.view,this.gxe);this.ga.fb(Dc.a.Blg,oc.a.view,this.Blg,96);this.ga.fb(Dc.a.Ewf,oc.a.view,this.Ewf,4);this.ga.fb(Dc.a.Pwj,oc.a.view,this.Ore,97);this.ga.fb(Dc.a.Rwj,oc.a.view,
this.Ore,97);this.ga.fb(Dc.a.Qwj,oc.a.view,this.Ore,97);this.ga.fb(Dc.a.Swj,oc.a.view,this.Ore,97);this.ga.fb(Dc.a.hxj,oc.a.view,this.Pse,97);this.ga.fb(Dc.a.gxj,oc.a.view,this.Pse,97);this.ga.fb(Dc.a.exj,oc.a.view,this.Pse,97);this.ga.fb(Dc.a.fxj,oc.a.view,this.Pse,97);this.ga.fb(Dc.a.Pjo,oc.a.view,this.kko,97);this.ga.fb(Dc.a.gog,oc.a.view,this.ujo,97)}lli(b){const h=this.Ym.LPb(b),n=this.Ym.tla(h);b=this.GRa.EBf(b,n);this.control.Mka(h);return b}Gzi(b,h){switch(b){case Dc.a.eOj:case Dc.a.hxj:b=
1;break;case Dc.a.dOj:case Dc.a.gxj:b=2;break;case Dc.a.bOj:case Dc.a.exj:b=3;break;case Dc.a.cOj:case Dc.a.fxj:b=4;break;default:b=h}return b}AKf(b,h){switch(b){case Dc.a.sMj:case Dc.a.Pwj:b=1;break;case Dc.a.uMj:case Dc.a.Rwj:b=2;break;case Dc.a.tMj:case Dc.a.Qwj:b=3;break;case Dc.a.vMj:case Dc.a.Swj:b=4;break;case Dc.a.vGe:case Dc.a.yud:b=h;break;case Dc.a.jce:b=0;break;default:b=h}return b}RGi(b,h){return b===Dc.a.Vyg||b===Dc.a.gog?parseInt(h.MenuItemId):h}dQf(b){return this.ll.jba(b.Hk)}fip(b,
h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}Fco(b,h){const n=this.LLi(b);if(h[uk.a.Visible]=n)b=this.ll.HKi(this.Gxk(b)),b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[uk.a.LabelText]=b}LLi(b){const h=this.Zc.Ql();h.set(b);h.zb(8);h.qt(8);return 1<this.ll.uPf(h)}static GKi(b){const h=new ve.GraphIterator;h.set(b);h.zb(10);return Ym.WordSectionNavigator.$Ho(h)}}Object(u.a)(vB,
"HeaderFooterActor",null,[]);var bF=d(858),Tx=d(765);class Sw{constructor(b,h,n,B,L){this.HFk=b;this.Ym=h;this.ll=n;this.Zc=B;this.ga=L}Yki(b,h){this.Ym.KVb(b);h=this.p1l(b,h);b.uc();return h}EBf(b,h){b=this.Zc.Ksa(b,8,8);let n=!1;this.ll.DVa(b,B=>{const L=this.Zc.Ql();L.set(B);n=(B=this.Yki(L,h))||n;return B});return n}p1l(b,h){if(3!==this.ga.mode)return!1;let n=!1;h=Tx.a.xxf(h);for(let B=0;B<h.length;++B)n=this.HFk.o1l(b,h[B])||n;return n}}Sw.POl=1;Object(u.a)(Sw,"HeaderFooterInserter",null,[340]);
class fw{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb){this.GEh=this.tfh=!1;this.mG=null;this.DXe=!1;this.U5b=0;this.sWb=()=>{this.DXe=!0};this.O9=b;b.bind(this);this.kcf=B;this.Gtk=fb;this.jxh=L;this.AGk=ba;this.Dib=la;this.Y_=h;this.footer=n;this.Y_.QKl();this.O9.eB();this.uaf=Sw.POl;this.GRa=La;fw.ga=Cb;this.rQ=Lb}get hfa(){return this.tfh}show(b=!0,h=!0){this.hfa||(this.D9j(),this.CNj(!0),this.Y_.Zro(),this.Gtk(),this.Obp(),A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.GCa&&(kh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new bF.a,
{state:0,disablePopover:!0}))):x.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready")));(this.GEh=h)&&this.jxh(b)}dismiss(b=!1){this.hfa&&(this.AGk(b),this.CNj(!1),this.tNb(),this.U5b=0,this.fdp(),A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.GCa&&(kh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new bF.a,{disablePopover:!1}))):x.ULS.sendTraceTag(509384031,3023,15,"Dismissing header/footer overlay and appChrome is not ready")))}CNj(b){this.tfh=
b;fw.ga.Ob(wb.a.DFf,2);this.O9.u4(b);this.Y_.u4(b);this.footer.u4(b);this.kcf()}Mka(b){this.mG!==b&&(this.mG=b,this.Y_.Mka(b),this.footer.Mka(b),this.U5b=0,this.zyb(this.Dib.tla(b)))}tNb(){this.mG&&(this.Y_.Bob(),this.footer.Bob(),this.mG=null)}update(){this.hfa&&this.u2b()}u2b(){this.mG&&(this.Dib.MXl(this.mG)&&this.Dib.q_m(this.mG)?this.D9j():this.dismiss())}D9j(){const b=this.Dib.tla(this.mG);b!==this.uaf&&this.zyb(b)}zyb(b){this.uaf=b;this.tEa(this.UNm(b))}UNm(b){switch(b){case 2:return 2;case 3:return 3;
case 4:return 2}return 1}tEa(b,h=!0){this.U5b!==b&&(this.GRa.EBf(this.mG,this.uaf),this.Y_.rMj(b),this.Y_.oVh(Mk.a.Sfa),this.footer.rMj(b),this.footer.oVh(Mk.a.wfa),this.U5b=b,this.hfa&&this.GEh&&this.V1l(h))}V1l(b){this.jxh(b);b?this.Y_.gxc():this.footer.gxc()}dispose(){this.O9.fda();this.Y_.dispose();this.footer.dispose()}Obp(){this.rQ.MSc(this.sWb);this.DXe=!1}fdp(){this.rQ.Aue(this.sWb);this.DXe&&fw.ga.Ob(Dc.a.Dae,2)}static YUl(){fw.ga.Pb(Pa.a.Urb,2,!0);fw.ga.Ob(Dc.a.Z6,2)}}fw.ga=null;Object(u.a)(fw,
"HeaderFooterControl",null,[360,13]);class cF{constructor(b,h,n,B,L){this.kcf=b;this.Dib=h;this.GRa=n;this.ga=B;this.rQ=L}create(b,h,n,B,L){return new fw(b,h,n,this.kcf,B,L,this.Dib,this.GRa,fw.YUl,this.ga,this.rQ)}}Object(u.a)(cF,"Factory",null,[346]);class dH{constructor(){this.Kda=null}get control(){return this.Kda}set control(b){this.Kda=b}rGf(b){return this.sGf(this.control.mG,this.control.U5b,b.isHeader,b)}sGf(b,h,n,B){return()=>{if(!b.isConnected)return null;this.control.Mka(b);this.control.tEa(h);
this.control.show(n);return B}}dismiss(){this.Kda.hfa&&this.Kda.dismiss()}}Object(u.a)(dH,"HeaderFooterControlLauncher",null,[]);var $I=d(1243),dF=d(697),eH=d(874);class Tw{constructor(b,h,n){this.gAc=null;const B=h?"Header":"Footer";this.Ms=b.ownerDocument.createElement("div");this.Ms.id=h?"HeaderPane":"FooterPane";this.Ms.classList.add(Tw.t_m,B);this.vJb=(new eH.a(this.Ms,"WACViewPanel_"+B)).BK;this.Ms.appendChild(this.vJb);b.appendChild(this.Ms);h&&(this.gAc=b.ownerDocument.createElement("div"),
this.gAc.classList.add(Tw.z_m),this.Ms.appendChild(this.gAc));this.f9g=n.VDm(this.Ms)}bind(){}u4(b){b?this.f9g.h5k():this.f9g.j5k()}Ecl(b){b.Odc(this.vJb)}}Tw.z_m="HeaderToolbarContainer";Tw.t_m="HeaderFooterPane";Object(u.a)(Tw,"PaneControlDom",null,[370]);class lv{constructor(b,h,n,B,L){this.hG=this.Fr=null;this.wmj=()=>{this.hG.dismiss(!0);if(this.V6b){const ba=new Iw.a(!0);this.V6b.ENa(ba)}return!0};this.zD=ba=>{ba.Kb.preventDefault();return!1};this.Ms=b.ownerDocument.createElement("div");this.Ms.id=
lv.W7h;this.Ms.className=lv.W7h;this.a2=B;this.V6b=L;this.COi=new Tw(this.Ms,!0,h);this.rIl(this.Ms);this.Iqi=new Tw(this.Ms,!1,h);this.u4(!1);b.appendChild(this.Ms)}rIl(b){this.Fr=b.ownerDocument.createElement("div");this.Fr.id=lv.X6n;this.Fr.className=lv.V6n;this.Fr.tabIndex=0;this.Fr.setAttribute(Bc.a.Ph,Bc.a.eaa);this.Fr.setAttribute(Bc.a.Jja,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.Fr)}bind(b){this.hG=b}u4(b){if(!b&&this.a2){var h=new Iw.a(!0);
this.a2.ENa(h)}!b&&this.V6b&&(h=new Iw.a(!0),this.V6b.ENa(h));this.Ms.style.display=b?"":"none";this.COi.u4(b);this.Iqi.u4(b)}mTo(){this.Fr.focus()}eB(){Ef.a.instance.nb(Cd.a.click,this.Fr,this.wmj);Yg.a.instance.nb(Cd.a.nz,this.Ms,this.zD)}fda(){Ef.a.instance.xc(Cd.a.click,this.Fr,this.wmj);Yg.a.instance.xc(Cd.a.nz,this.Ms,this.zD)}}lv.W7h="HeaderFooterControl";lv.X6n="HeaderFooterOverlay";lv.V6n="EditingSurfaceOverlay HeaderFooterOverlay";Object(u.a)(lv,"HeaderFooterControlDom",null,[359]);var ut=
d(147);class eF{constructor(b,h,n,B,L,ba,la,La,fb,Cb){this.O9=null;this.sa=new mg.a;this.hG=this.WLd=null;this.yfg=Lb=>{this.Ica(Lb);this.sa.raiseEvent("OnShowEventKey")};this.xfg=Lb=>{this.ql&&(this.WLd=new $I.a(this.ql));this.Yb.yYc(Mk.a.Sfa);this.Yb.yYc(Mk.a.wfa);this.sha(Lb);this.sa.raiseEvent("OnDismissEventKey")};this.Dpe=()=>{this.WLd&&(this.WLd.dispose(),this.WLd=null)};this.Yb=b;this.aq=h;this.$yh=n;this.hyk=B;this.sIk=L;this.ga=ba;this.Och=dF.a.create();this.Sgh=bb.KeyInputManager.lc(Jd.a.Mu,
0);this.N1=bb.KeyInputManager.lc(Jd.a.Z4,0);this.BOk=bb.KeyInputManager.lc(Jd.a.U0a,0);this.YK=la;this.Ga=La;this.a2=fb;this.V6b=Cb;this.ql&&this.ql.A6(this.Dpe)}nQh(b){this.sa.addHandler("OnShowEventKey",b)}VAo(b){this.sa.removeHandler("OnShowEventKey",b)}NRd(b){this.sa.addHandler("OnDismissEventKey",b)}RDj(b){this.sa.removeHandler("OnDismissEventKey",b)}get ql(){const b=this.YK.value;return b?b.nj?b:(x.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),
null):(x.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.hG}get FAl(){return this.Och}bind(b){this.hG=this.Kyl(b);this.Och.instance=this.hG}Kyl(b){this.O9=new lv(b,this.sIk.value,this.Ga,this.a2,this.V6b);b=this.$yh.value.create(this.ga,this.O9.COi,!0,Mk.a.Sfa);const h=this.$yh.value.create(this.ga,this.O9.Iqi,!1,Mk.a.wfa);this.hG=this.hyk.value.create(this.O9,b,h,this.yfg,this.xfg);this.wVf();this.xW();return this.control}wVf(){var b=
3===this.ga.mode?Mk.a.zF:Mk.a.bvc;const h=this.Yb.ge(Mk.a.Sfa);h.parent=b;this.Yb.Uef(Mk.a.Sfa);const n=this.Yb.ge(Mk.a.wfa);n.parent=b;this.Yb.Uef(Mk.a.wfa);b=this.Yb.ge(ut.a.rRb);b.parent=Dd.AFrame.mq;b.Bja(()=>{this.O9.mTo()});b.bindAction(this.Sgh,Dc.a.VW);b.bindAction(this.N1,Dc.a.VW);b.bindAction(this.BOk,Dc.a.VW);h.bindAction(this.N1,Dc.a.VW);n.bindAction(this.N1,Dc.a.VW)}xW(){this.aq.xW(Mk.a.Sfa);this.aq.xW(ut.a.g$a);this.aq.xW(Mk.a.wfa);this.aq.xW(ut.a.rRb)}Ica(b){this.aq.bL(Mk.a.Sfa);this.aq.bL(ut.a.g$a);
this.aq.bL(Mk.a.wfa);this.aq.bL(ut.a.rRb);this.aq.ny(Dd.AFrame.Ho);this.Yb.eSc(Mk.a.Sfa);this.Yb.eSc(Mk.a.wfa);b?this.Yb.Bg(Mk.a.Sfa):this.Yb.Bg(Mk.a.wfa)}sha(b){this.aq.ny(Mk.a.Sfa);this.aq.ny(ut.a.g$a);this.aq.ny(Mk.a.wfa);this.aq.ny(ut.a.rRb);this.aq.bL(Dd.AFrame.Ho);(b||this.Yb.currentScope&&(this.Yb.currentScope.name===Mk.a.Sfa||this.Yb.currentScope.name===ut.a.g$a||this.Yb.currentScope.name===Mk.a.wfa||this.Yb.currentScope.name===ut.a.rRb))&&this.Yb.Bg(Dd.AFrame.Ho)}dispose(){const b=this.Yb.ge(ut.a.rRb);
b.tt(this.Sgh);b.tt(this.N1);this.Yb.ge(Mk.a.Sfa).tt(this.N1);this.Yb.ge(Mk.a.wfa).tt(this.N1);this.ql&&this.ql.yZb(this.Dpe);this.control.dispose()}}Object(u.a)(eF,"HeaderFooterControlOwner",null,[344,345]);var TC=d(1222);class iq{constructor(b,h,n,B,L,ba,la,La){this.zqa=b;this.APk=h;this.PMe=n;this.Zm=B;this.UHk=L;this.YNk=ba;this.Xxk=la;iq.Oh=La}J9m(b,h){this.APk(b,1,3,null,!1);this.zqa.TPj(Yz.a.$Vb,1696,b.currentNode);this.PMe(b,0,this.Zm?3:1,h);this.PMe(b,1,2,h);this.PMe(b,2,this.Zm?1:3,h);this.UHk(b);
this.YNk(b,!1,!0,null);this.Xxk(b,h)}static get kJ(){return null!=iq.i7g?iq.i7g:iq.i7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get rl(){return null!=iq.T2g?iq.T2g:iq.T2g=Ya.a.instance.resolve("Box4.IParagraphEditor")}static sRo(b,h,n){qh.moveToCellContent(b,0,h);Ga.OutlineElementNavigator.Le(b);iq.kJ.Iod(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);iq.rl.rH(b.currentNode,n);h||iq.rl.Sr.wEa(b,1,-115);2===h&&iq.rl.Sr.J_b(b.currentNode,1,-115);qh.returnToContainingTable(b)}static STo(b,
h){Ga.OutlineElementNavigator.Le(b);iq.kJ.Iod(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,b.currentNode);Ga.OutlineElementNavigator.he(b)}static Jkm(){return(b,h,n)=>{iq.sRo(b,h,n)}}static kum(){return(b,h)=>{iq.STo(b,h)}}static XMm(b){return(h,n,B,L,ba)=>b.PUa(h,n,B,L,ba)}static VKm(){return(b,h,n,B,L)=>iq.Oh.$z(b,h,n,B,L)}}iq.Oh=null;Object(u.a)(iq,"HeaderFooterDefaultTableInserter",null,[342]);class UC{constructor(b,h,n,B){this.Ym=b;this.XId=h;this.Zc=n;this.ll=
B}fQj(b,h){b.io.properties.setValue(Lc.a.vSf,2===h||4===h);b.zb(8);b.aud(8).properties.setValue(Lc.a.mae,3===h||4===h)}jxo(b){this.ll.DVa(b,h=>{const n=this.Zc.Ql();n.set(h);this.Ym.KVb(n);this.fQj(n,1);this.kxo(n);return!0})}kxo(b){for(;b.Xd();)b.eh()}}Object(u.a)(UC,"HeaderFooterEditor",null,[341]);var fH=d(1190);class fF extends hv.a{constructor(b){super();this.mcf=b}get index(){return 0}run(){this.mcf()}p_m(b,h){h.property===Lc.a.vSf&&this.WI()}t7n(b,h){h.property===Lc.a.mae&&this.WI()}WI(){this.D0()}}
Object(u.a)(fF,"ControlUpdateNeededTracker",hv.a,[]);class Wr{constructor(b,h,n,B,L,ba){this.phb=null;this.iyk=n;this.UCd=h;this.z7b=b;this.iIk=B;this.CSa=ba}start(){this.z7b.bind(Ua.StaticActiveAppFrame.za().aG);this.UCd.control=this.z7b.control;this.UCd.Wb();this.iyk.control=this.z7b.control;this.iIk.value.create(this.z7b.control,Object(z.a)(this.UCd,this.UCd.lli,"ensureSectionHeaderFooterAttachedToControl")).Wb();this.a1m()}a1m(){this.phb=new fF(()=>{this.z7b.control.update()});const b=$e.App.jf.Il;
b.Ve(35).fo(Object(z.a)(this.phb,this.phb.p_m,"headerFooterContainerNodePropertyChanged"));b.Ve(8).fo(Object(z.a)(this.phb,this.phb.t7n,"pageContentNodePropertyChanged"));fH.a.Wte(Object(z.a)(this.phb,this.phb.WI,"setUpdateNeeded"));ap.GraphTransactionManager.instance.Ava(this.phb,3)}dispose(){this.z7b.dispose();this.CSa.Ogi()}}Object(u.a)(Wr,"HeaderFooterManager",null,[]);class $z{constructor(b,h,n,B){this.ll=b;this.Ym=h;this.x9b=n;this.IPe=B}o1l(b,h){let n=!1;const B=Tx.a.lMf(h);b.fv(B)||(this.X9m(b,
h),this.IPe.I9m(b.currentNode,h),n=!0);return n}X9m(b,h){const n=this.x9b.create(pk.a.k6c),B=b.currentNode.ja(Lc.a.yna,0);n.properties.setValue(Lc.a.yna,B);n.properties.setValue(Lc.a.bmc,h);h=Tx.a.lMf(h);b.Uf(n,h)}}Object(u.a)($z,"HeaderFooterNodeLevelInserter",null,[339]);var Wy=d(235),aA=d(421);class Ux extends Wy.a{constructor(b,h,n){super(b,h,"","");this.zGb=null;this.ROi=Ux.Edi;this.p6c=[];this.XUe=n}get tC(){return!0}get cssClass(){return"cui-herodock"}xn(){this.Tro();super.xn()}lVa(){for(const b of this.p6c)b.z1d();
super.lVa()}Nap(){const b=[],h=[],n=[];for(let B=0;B<this.p6c.length;B++){const L=this.p6c[B];L.visible?b.length<this.ROi?b.push(L):Object(Wb.a)(aA.FlyoutAnchor,L)?Array.addRange(h,L.Anm()):h.push(L):n.push(L)}return{xlp:b,T6n:h,pcn:n}}qIl(b){if(!b||!b.length)return null;const h=new ae.Menu(this.root,this.id+"OverflowMenu",null,null,null),n=new Tn.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const B of b)n.Uf(B.PW("Menu20"));
h.Uf(n);return h}Tro(){this.jva();this.Qc=ng.a.WZa(this.Qc);this.pE();const {xlp:b,T6n:h,pcn:n}=this.Nap();for(var B of b){var L=B.PW("Medium20");L.enabled=!0;this.qcc(L,this.children.count);this.Qc.appendChild(L.Qc);L.psa()}if(B=this.qIl(h)){if(this.zGb)this.zGb.Ig=B;else{L=this.id+"OverflowMenuLauncher";const ba={};ba.Image20by20=this.XUe.OverflowMenuImage20by20;ba.Image20by20Class=this.XUe.OverflowMenuImage20by20Class;ba.PopulateDynamically="false";ba.HideDefaultArrow="true";ba.Alt=this.XUe.OverflowMenuTooltip;
ba.Command="798637440";ba.Id=L;this.zGb=new aA.FlyoutAnchor(this.root,L,ba,B)}B=this.zGb.PW("Small20");B.enabled=!0;this.qcc(B,this.children.count);this.Qc.appendChild(B.Qc);B.psa()}if(A.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const ba of n)B=ba.PW("Medium20"),this.Uf(B),B.psa()}dispose(){this.zGb&&(this.zGb.dispose(),this.zGb=null);for(const b of this.p6c)b.dispose();this.jva();super.dispose()}set tC(b){super.tC=b}}Ux.Edi=4;Object(u.a)(Ux,"HeroDock",Wy.a,
[]);var br=d(648);class aJ extends br.a{constructor(){super();this.JBe=this.tnn=this.Gcp=!1;this.KJn=A.AFrameworkApplication.n_f?1:Ux.Edi}}Object(u.a)(aJ,"ToolbarBuildOptions",br.a,[]);var xj=d(48),bA=d(944),gH=d(774);class qs extends Wy.a{constructor(b,h,n){super(b,h,"","");this.pDc=n.Alignment;this.Zfh=n.ScalingDirection===xj.a.Qfk}xn(){this.PAa();this.d_(this.Qc);super.xn()}d_(b){for(const h of this.children){h.pE();switch(this.pDc){case xj.a.hIe:ng.a.pg(h.Qc,"cui-toolbar-button-left");break;case xj.a.egb:ng.a.pg(h.Qc,
"cui-toolbar-button-center");break;case xj.a.L3b:ng.a.pg(h.Qc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.pDc);}h.visible&&b.appendChild(h.Qc);h.psa()}}oR(b){if(!Object(Wb.a)(Gn.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");}get cssClass(){switch(this.pDc){case xj.a.hIe:return"cui-toolbar-buttondock alignleft";case xj.a.egb:return"cui-toolbar-buttondock aligncenter";case xj.a.L3b:return"cui-toolbar-buttondock alignright";
default:throw Error.argumentOutOfRange(this.pDc);}}get tC(){return!0}get alignment(){return this.pDc}Blc(){let b=0;if(this.alignment===xj.a.egb)for(const h of this.children){const n=h;n.visible&&(b+=n.Qc.offsetWidth)}else b=this.Qc.offsetWidth;return b}A9d(){let b=null;if(this.alignment===xj.a.egb)for(const h of this.children){if(h.visible){b=Sys.UI.DomElement.getBounds(h.Qc);break}}else b=Sys.UI.DomElement.getBounds(this.Qc);return b?0===this.root.L4?b.x:b.x+b.width:0}H6d(){let b=null;if(this.alignment===
xj.a.egb){if(0<this.children.count){const h=this.children.IJf(this.children.count-1);for(;h.Zub();){const n=h.get_current();if(n.visible){b=Sys.UI.DomElement.getBounds(n.Qc);break}}}}else b=Sys.UI.DomElement.getBounds(this.Qc);return b?0===this.root.L4?b.x+b.width:b.x:0}xBf(){for(const b of this.children){const h=b;if(!Object(Wb.a)(Gn.a,h)||h.control.visible)h.visible=!0}}iLo(b){const h=this.children.toArray(),n=new gH.a;let B=this.Zfh?0:h.length-1;const L=this.children.count,ba=this.root.d0a;for(;this.Blc()>=
b&&!(B>=L||0>B);){const la=h[B];ba&&Object(Wb.a)(Gn.a,la)&&la.control.visible&&(n.add(la),la.uTh());B+=this.Zfh?1:-1}for(const la of n)la.sCj(),la.visible=!1}set tC(b){super.tC=b}}Object(u.a)(qs,"ButtonDock",Wy.a,[]);class wB extends lm.a{constructor(b,h,n,B,L,ba,la=!1){super(b,h,ba);this.kxa=this.t1=this.sqa=null;this.z1e=!1;this.Lab=B;this.JBe=L;this.VOd=0;Kf.c(h.Size)||(h.Size===xj.a.KRg||n.options.tnn?this.VOd=0:h.Size===xj.a.Uik&&(this.VOd=1));this.PQk=la}get d0a(){return!0}Uf(b){super.Uf(b);
Object(Wb.a)(qs,b)&&!this.z1e&&(b.alignment===xj.a.hIe?(this.sqa&&this.nAg(),this.sqa=b):b.alignment===xj.a.egb?(this.t1&&this.nAg(),this.t1=b):b.alignment===xj.a.L3b&&(this.kxa&&this.nAg(),this.kxa=b))}nAg(){this.z1e=!0;this.kxa=this.t1=this.sqa=null}gyb(b,h){b=this.F2c(b);Kf.c(b)||b.visible===h||(b.visible=h,this.refresh())}xn(){super.xn();this.fAj(!0)}fAj(b){const h=this.root.hMb;Kf.c(this.Qc)&&this.RKl();this.Qc=ng.a.WZa(this.Qc);this.q6c&&this.Qc.appendChild(this.q6c);for(const n of this.children)n.visible&&
(n.pE(),this.Qc.appendChild(n.Qc),n.psa());this.t1&&b&&this.K0l();h&&h.X0();this.dirty=!1}K0l(){if(this.t1.visible&&this.t1.children.count&&(this.HTh(0,0),this.LXl(this.sqa,this.t1,this.kxa))){let b=0,h=0;const n=this.sqa?this.sqa.Blc():0,B=this.kxa?this.kxa.Blc():0;if(0<B||0<n)B>n?(b=0,h=B-n):(b=n-B,h=0);this.HTh(b,h)}}LXl(b,h,n){let B=!1;0===this.root.L4?(b&&(B=b.H6d()>h.A9d()),!B&&n&&(B=h.H6d()>n.A9d())):(b&&(B=b.H6d()<h.A9d()),!B&&n&&(B=h.H6d()<n.A9d()));return B}HTh(b,h){0===this.L4?(this.t1.Qc.style.marginLeft=
b+"px",this.t1.Qc.style.marginRight=h+"px"):(this.t1.Qc.style.marginRight=b+"px",this.t1.Qc.style.marginLeft=h+"px")}RKl(){this.pE()}nv(){this.Hhi(()=>{sC.a.prototype.nv.call(this)})}Yua(b){b=this.F2c(b);Kf.c(b)||this.Hhi(Object(z.a)(b,b.wn,"pollForStateAndUpdate"))}Hhi(b){this.Urc=this.Mbb=!1;b();if(this.Mbb||this.Urc)this.PQk||this.refresh(),this.scale()}oR(b){if(!Object(Wb.a)(Ux,b)&&!Object(Wb.a)(qs,b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");
if(Object(Wb.a)(qs,b)&&b.alignment===xj.a.egb)for(const h of this.children)if(h.alignment===xj.a.egb)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b="cui-toolbar-toolbar ";0===this.VOd?(b+="cui-toolbar-onerow ",A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.Gba||(b+="UITextTranformUpperCase ")):1===this.VOd&&(b+="cui-toolbar-singledock ");return b+super.cssClass}get DAa(){return"div"}get Cca(){return 26}get E1j(){return this.TQ}set E1j(b){this.TQ=
b}WDl(b){b=b[xj.a.Tx];return new qs(this.root,b.Id,b)}pE(){super.pE();this.Qc.setAttribute("role","toolbar");this.properties.Title&&this.Qc.setAttribute("title",this.properties.Title)}GPa(b){return this.root&&this.root.fvc(b)?!0:!1}pTo(){this.v_a()}scale(){super.scale();if(!ng.a.at(this.properties.Scale)||this.z1e)return!1;Kf.c(this.sqa)||(this.sqa.visible=!0,this.sqa.xBf());Kf.c(this.t1)||(this.t1.visible=!0,this.t1.xBf());Kf.c(this.kxa)||(this.kxa.visible=!0,this.kxa.xBf());this.fAj(!1);const b=
this.Qc.offsetWidth,h=Kf.c(this.sqa)?0:this.sqa.Blc(),n=Kf.c(this.t1)?0:this.t1.Blc(),B=Kf.c(this.kxa)?0:this.kxa.Blc();B+n+h>=b&&(B+h>=b?(this.WOi(this.t1),B>=b?(this.WOi(this.sqa),this.axg(this.kxa,b)):this.axg(this.sqa,b-B)):this.axg(this.t1,b-B-h));this.Mbb=!1;this.xn();return!1}WOi(b){b&&(b.visible=!1)}axg(b,h){b&&b.iLo(h)}}Object(u.a)(wB,"Toolbar",lm.a,[1422]);class mv extends wB{constructor(b,h,n,B,L=!1){super(b,h,n,!1,!1,B,L);this.$sh=!0}get Cca(){return 7}get cssClass(){return mv.Hcp+" "+
super.cssClass}static get Hcp(){let b="cui-statusbar";A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.Gba||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(u.a)(mv,"StatusBar",wB,[]);var Vx=d(521);class Xy extends Vx.a{constructor(){super();this.toolbar=null;this.rge=!1}}Object(u.a)(Xy,"ToolbarBuildContext",Vx.a,[]);class VC extends kg.Builder{constructor(b,h,n,B){super(b,h,Cg.Task.p7(n),B);this.N1n=L=>{this.xBg(this.yhl(L.Oid,L.TWc));this.toolbar.E1j=this;this.toolbar.xn();
this.placeholder.appendChild(this.toolbar.Qc);ng.a.pg(this.placeholder,"loaded");this.Eza.continueWith(()=>{this.Eza.result.qWb(this.toolbar)},11)};if(Kf.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}xBg(b){this.root=b}get zJg(){return this.options}whl(){const b=new Xy,h=new bA.a;h.id="toolbar";h.sjd=1;h.handler=this.N1n;h.data=b;this.uAa.ewe(h)}yhl(b,h){var n=xj.a.gla(b,xj.a.Kjk);Kf.c(n)&&(n=xj.a.gla(b,xj.a.ajk),h.rge=!0);if(Kf.c(n))throw Error.create("No toolbar element was present in the data");
b=new xj.a(n);n=A.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");h.rge?this.xBg(new mv(b.attributes[xj.a.id],b.attributes,this,this.lea,n)):this.xBg(new wB(b.attributes[xj.a.id],b.attributes,this,this.zJg.Gcp,this.zJg.JBe,this.lea,n));this.toolbar.Nza=this.options.Nza;this.toolbar.MFe=!0;this.toolbar.xn();b=xj.a.Dx(xj.a.gla(b.node,xj.a.tfk));h=this.ffl(b,h);for(const B of h)this.toolbar.Uf(B);return this.toolbar}ffl(b,h){const n=[];for(let B=0;B<b.length;B++)this.GXa(b[B])||
Array.add(n,this.Ifl(b[B],h));return n}Ifl(b,h){const n=xj.a.a4c(b);let B=null;n===xj.a.Rdk?B=this.ofl(b,h):n===xj.a.dgk&&(B=this.egl(b,h));return B}egl(b,h){var n=new xj.a(b);n=new Ux(this.root,n.attributes[xj.a.id],b[xj.a.Tx]);n.ROi=this.zJg.KJn;b=xj.a.gla(b,xj.a.RAb);b=xj.a.Dx(b);const B=[];for(let ba=0;ba<b.length;ba++){var L=b[ba];this.GXa(L)||(L=this.Tja(L,h),Array.add(B,L))}n.p6c=B;return n}ofl(b,h){new xj.a(b);const n=this.toolbar.WDl(b);b=xj.a.gla(b,xj.a.RAb);b=xj.a.Dx(b);for(let B=0;B<b.length;B++){if(this.GXa(b[B]))continue;
const L=this.xhl(b[B],h);n.Uf(L)}return n}xhl(b,h){var n=new xj.a(b);const B=n.name;n=n.attributes[xj.a.mCc];let L;L=h.rge?"Small14":"Small";switch(B){case xj.a.button:return b=this.Tja(b,h),b.PW(Kf.b(n)?L:n);case xj.a.pKa:return L=h.rge?"Medium14":"Medium",b=this.Tja(b,h),b.PW(Kf.b(n)?L:n);case xj.a.label:return b=this.Tja(b,h),b.PW(Kf.b(n)?L:n);case xj.a.separator:return b=this.Tja(b,h),b.PW("Small");case xj.a.toggleButton:return b=this.Tja(b,h),b.PW(Kf.b(n)?L:n);default:throw Error.create("Invalid control type.");
}}}Object(u.a)(VC,"ToolbarBuilder",kg.Builder,[]);var WC=d(1525);class cA{constructor(b,h,n,B,L,ba){this.yvb=()=>{this.toolbar.wn()};this.IK=b;b=new Kl.a(sk.a.v6a,WordEditorIntl.WordEditorStrings,null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);B=new aJ;B.eJ={};ba=3!==ba.mode;B.eJ.HeaderToolbarControlsRight=ba;B.eJ.HeaderToolbarButtonDockRight=ba;B.eJ.HeaderToolbarButtonRemovePageNumbers=ba;L=new VC(B,this.IK,this,L);L.uAa=new WC.a(cA.A_m,b);L.whl();this.Fqa=L.toolbar;n.execute(la=>{this.toolbar.oH=
la});this.toolbar.refresh();this.toolbar.wn();this.gi=h;h.$5a(this.yvb)}get toolbar(){return this.Fqa}dispose(){this.gi.vvc(this.yvb);this.toolbar&&(this.toolbar.dispose(),this.Fqa=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.pTo()}XUl(){this.toolbar.Y6()}qWb(){}}cA.A_m="WordEditorHeaderToolbarData";Object(u.a)(cA,"HeaderFooterToolbar",null,[191,357]);class dA{constructor(b,h,n,B,L){this.gi=b;this.WOe=h;this.xd=n;this.lea=B;this.ga=L}create(b){return new cA(b,this.gi,this.WOe,this.xd,
this.lea,this.ga)}}Object(u.a)(dA,"Factory",null,[338]);class rs{constructor(b,h){this.Zc=b;this.ll=h}GJl(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.FJl(b)+"</Controls></MenuSection></Menu>"}Vtm(b){const h=this.Zc.Ql();h.set(b);h.zb(8);h.ld(8);return h}FJl(b){if(!b)return"";let h="";b=this.Vtm(b);this.ll.DVa(b,n=>{const B=this.ll.HKi(n);n=n.getValue(Lc.a.yna);h+=cl.k(n.toString(),
n.toString(),Dc.a.Vyg.toString(),Dc.a.gog.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,B));return!0});return h}}Object(u.a)(rs,"HeaderFooterToolbarGenerator",null,[337]);var gF=d(136);class xB extends Sy.a{constructor(b,h,n,B,L,ba,la){super(b,h,n,B);this.kv=()=>{this.std(this.Cb)};this.IK=b.container;this.ix=document.createElement("div");this.$P(this.ix);this.qHa=L;this.wRa=ba;this.jo.execute(La=>{La.Q0(this.kv)});this.OM=la;this.IK.style.backgroundColor=
this.OM.Lkc()}dispose(){super.dispose();this.jo.instance&&this.jo.instance.YZa(this.kv)}get jo(){return null!=this.gYg?this.gYg:this.gYg=Ya.a.instance.Qa("Common.IZoomManager")}QB(b){this.IK.classList.add("HeaderFooterViewElement");this.ix.classList.add("HeaderFooterViewContent");this.std(b.currentNode)}a7(b){this.ix.parentNode&&this.ix.parentNode===this.IK||(this.IK.appendChild(this.ix),this.wRa.instance&&this.wRa.instance.BBg(this.jc,this.IK));super.a7(b)}wNb(b){gF.a.Yd(()=>{gF.a.prototype.wNb.call(this,
b);this.M6j();this.wRa.instance&&this.wRa.instance.O5j(this.jc,this.ix.style.paddingLeft,this.ix.style.paddingTop)},"HFVE:UFO")}std(b){this.jo.instance&&this.jo.instance.fvd(this.ix);this.M6j();b=this.qHa.hlc(b);this.ix.style.paddingLeft=b.Ffc+"px";this.ix.style.width=b.SWc+"px";this.wRa.instance&&this.wRa.instance.O5j(this.jc,this.ix.style.paddingLeft,this.ix.style.paddingTop)}M6j(){if(this.jo.instance){this.ix.style.paddingTop="";var b=fo.a.WB(this.ix);b.paddingTop&&(b=Lh.a.KP(b.paddingTop),this.ix.style.paddingTop=
Math.round(b/this.jo.instance.Aj)+"px")}}}Object(u.a)(xB,"HeaderFooterViewElement",Sy.a,[]);class hH{constructor(b,h,n){this.qHa=b;this.wRa=h;this.OM=n}create(b,h,n,B){return new xB(b,h,n,B,this.qHa,this.wRa,this.OM)}}Object(u.a)(hH,"Factory",null,[336]);var iH=d(377),jH=d(210),XC=d(1049),cr=d(627);class vt extends iH.a{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd,Hd,xe,je){super(h,ba,la,La,fb,jH.a.TPi,Cb,Lb,$b,tc,Nc,dd,Hd,xe,je);this.isHeader=this.isHeader=b;this.G4a=L;this.G4a.xrd=this;B(this);
this.Vyd=n;this.qGa=document.createElement("div");this.qGa.setAttribute("Unselectable","on");this.qGa.setAttribute("hideselection","hideselection");this.qGa.setAttribute("style","outline:none;");this.qGa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;this.qGa.tabIndex=0;this.features.vTj=!0;this.features.Mnf=!0}get xZf(){return!0}WPf(){const b=this.Vyd.rGf(this);return XC.ViewReference.UG(this,b)}myf(b){Object(Wb.a)(vt,b)||this.Vyd.dismiss()}get dTf(){return"WordEditor"+
(this.isHeader?"Header":"Footer")+"HiddenLabel"}B4c(){return cr.a.Hej}Pv(){super.Pv();this.G4a.kli()}qF(b,h=null){this.qGa.parentNode&&this.qGa.parentNode.removeChild(this.qGa);super.qF(b,h);this.G4a.Xki(this.jd.pk)}detach(){this.G4a.jli();super.detach();this.qGa.parentNode||this.container.insertBefore(this.qGa,this.container.firstChild)}Dod(){this.lw?super.Dod():this.qGa.focus()}F4d(){this.Pv()}}Object(u.a)(vt,"HeaderFooterView",iH.a,[351,352,193,129,13,104,353,354,355]);class Yy{constructor(b,h,
n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd,Hd){this.Vyd=b;this.CSk=h;this.BSk=n;this.Sy=B;this.nd=L;this.Hqa=ba;this.ga=la;this.d3a=La;this.Lya=fb;this.K$=Cb;this.fTk=Lb;this.Pu=$b;this.wC=tc;this.hg=Nc;this.hi=dd;this.Nyd=Hd}create(b,h){return new vt(b,h,this.Vyd,this.CSk,this.BSk(),this.Sy,this.nd,this.Hqa,this.ga,this.d3a,this.Lya,this.K$,this.fTk,this.Pu,this.wC,this.hg,this.hi,this.Nyd)}}Object(u.a)(Yy,"Factory",null,[335]);class Ar{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd,Hd,xe,je){this.Tyh=
!1;this.$Fh="SourceControlId";this.Ejp=1;this.Fjp=1E3;this.mse=(he,fe,De,gg,eg)=>{if(1===De)return 32;this.xCd(eg[this.$Fh]);eg[Jj.a.Text]=this.Q3e.N7n(this.ckb.RRb);return 32};this.Ujo=(he,fe,De,gg,eg)=>{if(1===De)return 32;eg[$g.a.On]=this.ckb.RRb;return 32};this.b4m=(he,fe,De,gg,eg)=>{if(1===De)return 32;this.ckb.Wwp(eg[$g.a.On]);return 32};this.OCj=(he,fe,De)=>{if(1===De)return 32;if(this.Kda){fe=Object($n.a)().Iu(fe.view.jd);De=ve.GraphIterator.eb(fe);const gg=this.Wd.p6a();try{const eg=this.Pc.Mc(15);
try{eg.Ab(fe),eg.yi=he,Po.a.instance.DVa(De,vl=>{this.U9b.Qkd(vl,this.yom,this.CUo);return!0})}finally{eg&&eg.dispose()}}finally{gg&&gg.dispose()}}return 32};this.Lhd=(he,fe,De,gg,eg)=>{if(1===De)return 32;eg.MenuItems=this.kIk.value;this.Tyh?this.ckb.vFo():this.Tyh=!0;return 32};this.V$m=(he,fe,De,gg,eg)=>{if(1===De)return 32;const vl=this.xCd(eg[this.$Fh]);if(this.Kda){fe=Object($n.a)().Iu(fe.view.jd);De=ve.GraphIterator.eb(fe);gg=this.Pc.Mc(15);try{gg.Ab(fe);gg.yi=he;let wl=null;const Sm=this.Vd.Vf("UserAction",
"InsertPageNumber");Po.a.instance.DVa(De,qp=>{this.Kda.hfa||this.Huk(qp);wl=this.P3e.T$m(qp,vl,this.ckb.RRb)||wl;return!0});Sm.stop();if(!wl)return 8;this.J6o(wl,vl)}finally{gg&&gg.dispose()}this.Wd.$t(12)}return 32};this.M7n=()=>32;this.s7o=(he,fe,De,gg,eg)=>{if(1===De)return 32;2===De&&this.CSa.showCallout(eg);return 32};this.r7o=(he,fe,De,gg,eg,vl)=>this.i9e.create(he,fe,De,gg,eg,vl);this.$Ul=(he,fe,De)=>{if(1===De)return 32;this.CSa.Ogi();return 32};this.z5o=he=>{A.AFrameworkApplication.va.ava(null,
Dc.a.VUj,he.Yl,null)};this.yom=he=>{const fe=Zb.a.instance.gb.currentSelection;let De=-1;for(const gg of fe)if(gg.node===he){De=gg.cpBegin;break}return{returnValue:De,Zee:re.SelectionEditor.Dm(fe)}};this.CUo=(he,fe)=>{he=Oe.SelectionFactory.se(he,fe);Zb.a.instance.Ic(he)};this.ga=b;this.Pc=h;this.Gb=n;this.ckb=B;this.Kda=L;this.Ym=ba;this.Q3e=la;this.P3e=La;this.U9b=fb;this.CSa=Cb;this.hb=Lb;this.i9e=$b;this.Vd=tc;this.Wd=Nc;this.xCd=dd;this.Huk=je;this.kIk=new Rf.a(()=>this.ckb.PDm())}Wb(){this.ga.fb(Dc.a.Lhd,
oc.a.view,this.Lhd,100);this.ga.fb(Dc.a.Wqj,oc.a.view,this.M7n,68);this.ga.fb(Dc.a.mTi,oc.a.view,this.V$m,4);this.ga.fb(Dc.a.RRb,oc.a.view,this.b4m,4);this.ga.fb(Dc.a.Qkd,oc.a.view,this.OCj,4);this.ga.fb(Dc.a.hzo,oc.a.view,this.OCj,4);this.ga.fb(Dc.a.Jog,oc.a.application,this.Ujo,97);this.ga.fb(Dc.a.mse,oc.a.application,this.mse,97);this.ga.fb(Dc.a.UUj,oc.a.view,this.s7o,4);this.ga.wW(Dc.a.VUj,oc.a.view,this.r7o,100);this.ga.fb(Dc.a.ZUl,oc.a.view,this.$Ul,4)}J6o(b,h){const n=b.Jb.paragraph;if(n){var B=
this.Ym.$dd(n);B&&this.Kda.Mka(B)}B=this.Kda.hfa;this.Kda.show(4>h);n&&this.TTo(n)&&(this.bYo(b,n),this.IZk(b,B))}TTo(b){let h;if(!({isHeader:h,oIg:b}=this.Ym.aJi(b)).returnValue)return!1;this.Kda.tEa(b,h);return!0}bYo(b,h){b=Oe.SelectionFactory.se(h,b.Jb.cp);this.hb.Ic(b)}IZk(b,h){h=new Re.a(2,1,h?this.Ejp:this.Fjp,this.z5o);h.Yl=b;this.Gb.Zb(h)}}Object(u.a)(Ar,"PageNumbersActor",null,[356]);class Zy{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc){this.ga=b;this.Gb=h;this.ckb=n;this.Q3e=B;this.P3e=
L;this.U9b=ba;this.CSa=la;this.i9e=La;this.Ym=fb;this.Wd=Cb;this.xCd=Lb;this.LRk=$b;this.sja=tc}create(b,h){return new Ar(this.ga,new vm.a,this.Gb,this.ckb,b,this.Ym,this.Q3e,this.P3e,this.U9b,this.CSa,Zb.a.instance,this.i9e,Ua.StaticActiveAppFrame.za().hs,this.Wd,this.xCd,this.LRk,this.sja,h)}}Object(u.a)(Zy,"Factory",null,[334]);var kH=d(2088),cp;(function(b){b[b.small=0]="small";b[b.o7p=1]="mediumSmall";b[b.Js=2]="medium";b[b.LX=3]="large"})(cp||(cp={}));Object(u.b)("ModalCalloutSize",cp);var Pt;
(function(b){b[b.DDe=0]="topCenter";b[b.Tnq=1]="topJustified";b[b.Unq=2]="topLeft";b[b.Vnq=3]="topRight";b[b.Ylf=4]="bottomCenter";b[b.rUp=5]="bottomLeft";b[b.sUp=6]="bottomRight"})(Pt||(Pt={}));Object(u.b)("BeakLocation",Pt);class Wx{constructor(b,h,n){this.Djp=1;this.r6e=!1;this.jac=null;this.Eto=()=>{this.hb.Cw(this.bva);this.r6e=!0;this.jac=null};this.bva=(B,L)=>{if(B=L.Gm.currentSelection)1<B.length||!B.length?B=!0:(B=B.Ra,B=B.cpEnd-B.cpBegin,B=1<B||!B),B&&this.Ftk()};this.Gb=b;this.hb=h;this.Ftk=
n}eB(){this.HZk()}fda(){this.r6e?(this.hb.nY(this.bva),this.r6e=!1):this.jac&&(this.Gb.vf(this.jac),this.jac=null)}HZk(){this.jac=new Re.a(2,1,this.Djp,this.Eto);this.Gb.Zb(this.jac)}}Object(u.a)(Wx,"CalloutDismissManager",null,[]);class $y{constructor(b,h,n,B){this.dismiss=()=>{this.gK&&(this.wGc.fda(),this.Ldd.dismiss())};this.Ldd=b;this.Rp=B;this.wGc=new Wx(h,n,this.dismiss)}get gK(){return this.Ldd.gK}show(){if(!this.gK){const b=document.createElement("div");b.classList.add($y.L7n);b.innerText=
WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.Ldd.content=b;this.Ldd.show();this.Rp&&this.Rp.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.wGc.eB()}}dispose(){this.dismiss();this.Ldd.dispose()}static AHl(b,h){h=kH.a.hai($c.a.getElementBounds(b.targetElement),h,Ua.StaticActiveAppFrame.za().aG,cp.small);h.Nja=$y.RHf(b);h.Du=!1;return h}static RHf(b){let h=Pt.Ylf;Object(Wb.a)(351,b.view)&&b.view.isHeader&&(h=Pt.DDe);return h}}$y.L7n="PageNumbersCalloutControl";
Object(u.a)($y,"PageNumbersCallOutControl",null,[350]);class ou{constructor(b,h,n){this.iW=null;this.bW=!1;this.dismiss=()=>{this.gK&&this.iW&&Wk.UISurfaces.kP().then(B=>{this.wGc.fda();B.removeNotification(this.iW);this.bW=!1;return null},B=>{x.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",B);return null})};this.El=b;this.wGc=new Wx(h,n,this.dismiss)}get gK(){return this.bW}show(){this.gK||Wk.UISurfaces.kP().then(b=>{const h=b.callout(Object.assign(new ip.a,{target:this.El,
content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),n=Object.assign(new Mi.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.bW=!0},expirationOptions:Object.assign(new jh.a,{displayTimeoutSeconds:7,onExpire:()=>{this.dismiss()}})});this.iW=b.addNotification(h,n);this.wGc.eB();return null},b=>{x.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(u.a)(ou,"ReactPageNumbersCallOutControl",null,[350]);class lH{constructor(b,h,n){this.hb=
h;this.Gb=b;this.Rp=n}create(b,h){if(A.AFrameworkApplication.ua.Ib&&A.AFrameworkApplication.ua.Ib.MXa)return new ou(h.targetElement,this.Gb,this.hb);b=$y.AHl(h,b);return new $y(b,this.Gb,this.hb,this.Rp,A.AFrameworkApplication.ua.AS)}}Object(u.a)(lH,"Factory",null,[333]);class bJ{constructor(b,h){this.hG=null;this.jIk=b;this.yj=h}get control(){return this.hG}showCallout(b){this.control&&this.control.gK&&this.control.dismiss();this.hG=this.Ieo(b);this.control.show()}Ogi(){this.control&&(this.control.dismiss(),
this.hG=null)}Ieo(b){const h=this.yj.Gsa();this.hG=this.jIk.value.create(h,b);return this.control}}Object(u.a)(bJ,"PageNumbersCalloutControlManager",null,[331]);var YC=d(823);class mH extends Wz.a{constructor(){super();this.Text=null}get Type(){return 7}}Object(u.a)(mH,"PageNumberGalleryButtonProps",Wz.a,[]);const Xx=(b,h,n)=>{b=b.Ql();b.set(n);h.KVb(b);return b};class Qt{constructor(b,h,n){this.jWe=!1;this.sja=h;this.Zm=n}get RRb(){return this.jWe}PDm(){const b=Object.assign(new vh.a,{Id:"menuPageNumbersDropDown",
MenuSectionList:[]});b.MenuSectionList.push(this.lXk());b.MenuSectionList.push(this.fYk());b.MenuSectionList.push(this.IYk());return b}Wwp(b){this.jWe=b;this.cAj()}vFo(){this.jWe=!1;const b={};b[Qt.cRi]="CheckboxModel";this.sja(b);this.cAj()}lXk(){const b=Object.assign(new te.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:F.a.Hf(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new YC.a,
{Id:Qt.c4m,Command:Dc.a.RRb.toString(),QueryCommand:Dc.a.Jog.toString(),LabelText:F.a.Hf(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:F.a.Hf(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}fYk(){const b=Object.assign(new te.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),h=Object.assign(new fl.a,{Id:"galleryPageNumbersPosition",
ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.Zm){for(var n=3;1<=n;n--)h.GalleryItems.push(this.uKf(n));for(n=6;4<=n;n--)h.GalleryItems.push(this.uKf(n))}else for(n=1;6>=n;n++)h.GalleryItems.push(this.uKf(n));b.ControlList.push(h);return b}IYk(){const b=Object.assign(new te.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new jj.a,{Id:"btnRemovePageNumber",
Command:Dc.a.Qkd.toString(),LabelText:F.a.Hf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:F.a.Hf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:A.AFrameworkApplication.Ys,Image16by16Class:Bb.getImageClass("WordRemovePageNumbers_16x16x32"),KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}uKf(b){const h=Qt.ejg+b.toString();var n=Object,B=n.assign,L=new mH,ba=Dc.a.mTi.toString(),la=Dc.a.mse.toString(),La=F.a,fb=La.Hf;let Cb="";switch(b){case 1:Cb=
WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Cb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Cb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Cb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;break;case 5:Cb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Cb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return B.call(n,L,{Id:h,Command:ba,QueryCommand:la,Alt:fb.call(La,
Cb)})}cAj(){const b={};for(let h=1;6>=h;h++)b[Qt.ejg+h.toString()]="PageNumberGalleryButtonModel";b[Qt.cRi]="CheckboxModel";this.sja(b)}static QDm(b){return b?parseInt(b.substr(Qt.ejg.length)):1}}Qt.c4m="btnIncludePageCount";Qt.cRi="IncludePageCount";Qt.ejg="btnPageNumbersPosition";Object(u.a)(Qt,"PageNumbersControl",null,[332]);class gw{constructor(b,h,n,B,L=null,ba=null,la=null,La=null){this.zum=(fb,Cb)=>{const Lb=new Ei.a;fb=4>fb;switch(Cb){case 1:case 2:Lb.add(fb?0:3);break;case 3:case 4:Lb.add(fb?
0:3),Lb.add(fb?1:4)}return Lb};this.enm=(fb,Cb,Lb)=>{var $b=Xx(this.Zc,this.Ym,fb);this.Ym.LVb($b,Lb);let tc=this.Wrk($b,Cb);if(tc)this.U9b.rDj(tc);else{$b=Xx(this.Zc,this.Ym,fb);this.Ym.LVb($b,Lb);$b.Xd();if(xb.OutlineElementReader.Mh($b)&&(Ga.OutlineElementNavigator.Le($b),ea.ParagraphReader.Bh($b))){$b=$b.currentNode;const Nc=this.fJi(Cb);ea.ParagraphReader.ez($b)===Nc&&this.U9b.rDj($b)&&(tc=$b)}tc||($b=Xx(this.Zc,this.Ym,fb),this.Ym.LVb($b,Lb),this.MN.kSb($b,null,!0),tc=Ga.OutlineElementNavigator.Le($b),
this.rH(Cb,tc))}return tc};this.fnm=(fb,Cb)=>{let Lb=null;fb.Ub(1);if(xb.OutlineElementReader.Mh(fb)&&(fb.Ub(2),xh.TableReader.isTable(fb))){var $b=fb.currentNode;if(3===xh.TableReader.Fh($b)){let tc=0;$b=xh.TableReader.Lo($b);switch(Cb){case 1:case 4:tc=$b?2:0;break;case 2:case 5:tc=1;break;case 3:case 6:tc=$b?0:2}qh.moveToCellContent(fb,0,tc);fb.currentNode&&xb.OutlineElementReader.Mh(fb)&&(fb=Ga.OutlineElementNavigator.Le(fb),ea.ParagraphReader.Xb(fb)&&(Lb=fb))}}return Lb};this.Wjn=(fb,Cb)=>{const Lb=
Xx(this.Zc,this.Ym,fb);fb=Lb.currentNode.ja(Lc.a.yna,0);this.Ym.LVb(Lb,Cb);Cb=Lb.currentNode.ja(Lc.a.yna,0);return fb===Cb};this.Zc=b;this.lIk=h;this.U9b=n;this.Ym=B;this.wIc=L||this.zum;this.Xrk=ba||this.enm;this.Wrk=la||this.fnm;this.hBk=La||this.Wjn}get MN(){return null!=this.V1g?this.V1g:this.V1g=Ya.a.instance.resolve("Box4.IOutlineEditor")}T$m(b,h,n){var B=Xx(this.Zc,this.Ym,b).io;B=this.Ym.tla(B);B=this.wIc(h,B);let L=null;for(let la=0;la<B.length;la++){var ba=B.sg(la);this.hBk(b,ba)&&(ba=this.Xrk(b,
h,ba),L=this.lIk.eYk(ba,n)||L)}return L}rH(b,h){gw.e9.Iod(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);gw.rl.rH(h,this.fJi(b))}fJi(b){let h=1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get rl(){return null!=gw.R2g?gw.R2g:gw.R2g=Ya.a.instance.resolve("Box4.IParagraphEditor")}static get e9(){return null!=gw.B4g?gw.B4g:gw.B4g=Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(u.a)(gw,"PageNumbersInserter",
null,[330]);var eA=d(961),ZC=d(965);class Uw{constructor(b,h,n=null,B=null,L=null){this.rDl=(ba,la)=>{ba=Nd.a.Tc(ba,ea.ParagraphReader.textLength(ba));const La=ba.node.Lc;return La?Uw.rg.Gla(ba,fb=>{fb=ZC.a.getInstance(fb,eA.a.QJf(la));this.BYd(fb,15,La,la);this.BYd(fb,47,La,la);this.BYd(fb,16,La);this.BYd(fb,17,La);return fb}):null};this.Aan=(ba,la)=>{ba=Nd.a.Tc(ba,ea.ParagraphReader.textLength(ba));Uw.rg.Ne(ba,la)};this.Pc=b;this.YId=n||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;
this.ROe=B||this.rDl;this.RHh=L||this.Aan}eYk(b,h){const n=this.Pc.Mc(15);n.Ab(b);var B=ea.ParagraphReader.text(b),L=!1;0<B.length&&" "!==B.charAt(B.length-1)&&(L=!0);if(h){h=String.format(this.YId,"#","$");L&&(h=" "+h);L=h.indexOf("#");B=h.indexOf("$");x.ULS.shipAssertTag(4256717,309,-1!==L,"{0}",{["PageNumberIndex"]:L});x.ULS.shipAssertTag(4256718,309,-1!==B,"{0}",{["PageCountIndex"]:B});x.ULS.shipAssertTag(4256719,309,L!==B,"{0}",{["PageNumberIndex"]:L,["PageCountIndex"]:B});let La;let fb;if(L<
B){var ba=L;La=B;var la=eA.a.a3c(0);fb=eA.a.a3c(1)}else ba=B,La=L,la=eA.a.a3c(1),fb=eA.a.a3c(0);this.qWf(b,h,0,ba);la=this.ROe(b,la);this.qWf(b,h,ba+1,La);ba=this.ROe(b,fb);this.qWf(b,h,La+1,h.length);b=L<B?la:ba}else L&&this.RHh(b," "),b=this.ROe(b,eA.a.a3c(0));n.dispose();return b}BYd(b,h,n,B=null){const L=new Mq.a;L.setValue(Hf.a.ada,!0);L.setValue(Lc.a.wOb,1);L.setValue(Lc.a.mt,h);switch(h){case 15:L.setValue(Lc.a.QXa,!0);L.setValue(Lc.a.G_,B);break;case 47:L.setValue(Lc.a.G_,B);break;case 17:L.setValue(Lc.a.FTb,
!0)}h=n.ou(L,S.a.create());this.$Yk(b,h)}$Yk(b,h){b.fza(h,S.a.nil,Cn.AParagraphNode.oE,null)}qWf(b,h,n,B){h=h.substring(n,B);0<h.length&&this.RHh(b,h)}static get rg(){return Uw.Qd||(Uw.Qd=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set rg(b){Uw.Qd=b}}Uw.Qd=null;Object(u.a)(Uw,"PageNumbersNodeLevelInserter",null,[329]);class fA{N7n(b){return fA.qGm(b)}static qGm(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,
fA.Lqj,fA.Lqj)}}fA.Lqj="1";Object(u.a)(fA,"PageNumbersPositionPreviewGenerator",null,[328]);class hF{constructor(){this.pch=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");this.rrk=this.pch.length}MZm(b){let h=b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===ea.ParagraphReader.textLength(b)?{returnValue:!0,Ohd:h}:{returnValue:!1,Ohd:-1}}qYm(b){let h=b.characterData.lastIndexOf(this.pch);return-1!==h&&h+this.rrk===ea.ParagraphReader.textLength(b)?
{returnValue:!0,Ohd:h}:{returnValue:!1,Ohd:-1}}jZm(b){return tn.a(b,9)?!0:!1}}Object(u.a)(hF,"PageNumbersReader",null,[327]);class yB{constructor(b,h,n,B,L,ba=null,la=null){this.gzo=(La,fb,Cb,Lb)=>{La=Xx(this.Zc,this.Ym,La);this.Ym.LVb(La,fb);fb=It.a.Bq(La);for(La=!1;fb.moveNext();){const $b=fb.currentNode;if(ea.ParagraphReader.Xb(fb.currentNode)&&tn.a(fb.currentNode,9)){La=!0;let tc;const Nc=({Zee:tc}=Cb($b,tc)).returnValue;let dd=Nc;dd=this.Ixo($b,dd);dd=this.Ezo($b,dd);-1<Nc&&(dd===Nc&&tc||Lb($b,
dd))}}La&&this.Wd.$t(12)};this.Zc=b;this.Ym=h;this.R3e=n;this.Wd=B;this.EOc=L;this.wIc=ba||Tx.a.xxf;this.FKk=la||this.gzo;this.YId=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.hjh=String.format(this.YId,"#","$");this.vzk=this.hjh.indexOf("#");this.uzk=this.hjh.indexOf("$");this.pTe=String.format(this.YId,"\ufffc","\ufffc");this.ajh=this.pTe.length}Qkd(b,h,n){var B=Xx(this.Zc,this.Ym,b).io;B=this.Ym.tla(B);B=this.wIc(B);for(const L of B)this.FKk(b,L,h,n)}rDj(b){if(this.R3e.jZm(b)){let h=
-1;if(({Ohd:h}=this.R3e.qYm(b)).returnValue&&this.B1h(b,h)||({Ohd:h}=this.R3e.MZm(b)).returnValue&&this.Rnl(b,h))return!0}return!1}Ezo(b,h){var n=b.qa.length;for(let L=0;L<n;L++){var B=b.qa.J(L);B.blob&&9===B.blob.Jh&&(B=B.cp,n=Nd.a.createTextRange(b,B,B+1),this.EOc(n,""),n=b.qa.length,L--,h=this.eRh(h,B,1))}return h}Ixo(b,h){let n=b.characterData.indexOf(this.pTe);for(;-1!==n;)this.B1h(b,n)&&(h=this.eRh(h,n,this.ajh)),n=b.characterData.indexOf(this.pTe);return h}Rnl(b,h){const n=b.qa.sh(h);return n&&
n.blob&&9===n.blob.Jh?(b=Nd.a.createTextRange(b,h,h+1),this.EOc(b,""),!0):!1}B1h(b,h){const n=b.qa.sh(h+this.vzk),B=b.qa.sh(h+this.uzk);return n&&n.blob&&9===n.blob.Jh&&B&&B.blob&&9===B.blob.Jh?(b=Nd.a.createTextRange(b,h,h+this.ajh),this.EOc(b,""),!0):!1}eRh(b,h,n){-1<b&&b>h&&(h=b-h,b=h>n?b-n:b-h);return b}}Object(u.a)(yB,"PageNumbersRemover",null,[325]);class Hp{constructor(b,h){this.tBb=this.sBb=null;this.Ms=b;this.Gb=h}h5k(){this.Ms.style.display="";this.sBb||(this.tBb&&(this.Gb.vf(this.tBb),
this.tBb=null),this.sBb=new Re.a(0,1,10,()=>{this.Ms.classList.add("Displayed");this.sBb=null}),this.Gb.Zb(this.sBb))}j5k(){this.Ms.classList.remove("Displayed");this.tBb||(this.sBb&&(this.Gb.vf(this.sBb),this.sBb=null),this.tBb=new Re.a(0,1,200,()=>{this.Ms.style.display="none";this.tBb=null}),this.Gb.Zb(this.tBb))}}Object(u.a)(Hp,"PaneControlAnimationHelper",null,[279]);class gA{constructor(b){this.Gb=b}VDm(b){return new Hp(b,this.Gb)}}Object(u.a)(gA,"PaneControlAnimationHelperFactory",null,[252]);
class cJ{constructor(b,h,n,B,L,ba,la,La,fb=!1){this.o8g=this.Fqa=this.VCd=null;this.s_m=()=>{this.Dw.sendNotification(this.o8g+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=b;this.O9=h;this.O9.bind(this);this.CXe=n;this.kya=L;this.ibf=la;this.Yb=La;this.nEd=fb;this.Bia=ba.value.create(n,B);this.O9.Ecl(this.Bia);this.N1=bb.KeyInputManager.lc(Jd.a.Z4,0)}get Dw(){return null!=this.RTg?this.RTg:this.RTg=Ya.a.instance.resolve("Common.Utils.IAriaNotifier")}u4(b){this.O9.u4(b);
this.Fqa&&!b&&this.Fqa.XUl()}Mka(b){this.VCd!==b&&(this.Bob(),this.VCd=b)}rMj(b){if(this.VCd){var h=this.kya.l9a(this.VCd,Tx.a.yum(b,this.CXe));this.nEd?(this.o8g=this.bti(b,this.CXe),this.Bia.G_b(Bc.a.gTd)):this.xtp(b);h&&this.bkf(h)}}oVh(b){this.nEd&&this.Yb&&(b=this.Yb.ge(b))&&b.y6(this.s_m)}bti(b,h){let n="";switch(b){case 1:n=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:
h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:n=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:n=3!==this.ga.mode?
h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;break;case 4:n=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?
WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return n}xtp(b){this.Bia.GNj(this.bti(b,this.CXe),Bc.a.gTd)}gxc(){this.Bia.Dod()}bkf(b){this.Bob();this.Bia.qF(b,b.pk)}Bob(){this.Bia.detach()}QKl(){this.Fqa=this.ibf.value.create(this.O9.gAc);this.e0o(this.Fqa)}e0o(b){if(this.Yb){const h=this.Yb.ge(ut.a.g$a);h.parent=Dd.AFrame.mq;h.Bja(()=>{b.setFocus();this.mZo()});h.bindAction(this.N1,Dc.a.VW)}}mZo(){if(this.Yb){var b=
this.Yb.ge(ut.a.g$a);const h=new Xc.DOMFocusListing(()=>this.O9.gAc);h.lna=!0;h.Gn(1);this.Yb.Umb(this.O9.gAc,b,h);b=this.Yb.getRegion(ut.a.g$a);b.SZa();b.aS=!0;h.Uka&&h.mA(h.Uka)}}dispose(){void 0!==this.Fqa&&null!==this.Fqa&&(this.Yb.ge(ut.a.g$a).tt(this.N1),this.Fqa.dispose())}Zro(){void 0!==this.Fqa&&null!==this.Fqa&&this.Fqa.refresh()}}Object(u.a)(cJ,"PaneControl",null,[280]);class nH{constructor(b,h,n,B){this.Ym=b;this.kyk=h;this.ibf=n;this.Yb=B}create(b,h,n,B){return new cJ(b,h,n,B,this.Ym,
this.kyk,this.ibf,this.Yb,A.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(u.a)(nH,"Factory",null,[251]);var qK=d(1220);class oH extends Iy.a{constructor(b,h,n,B,L,ba,la,La,fb){super();this.init(b);this.vm("ShowCalloutForPageNumberOperation");this.wmk=La;this.ssb(this.wmk,h,B,L,ba);this.sA=0;this.BSa=ba;this.CSa=la;this.gi=fb;1===this.behavior&&(this.xs=32,this.Iva())}get k0l(){if(null!=this.UVg)var b=this.UVg;else{var h;b=this.UVg=null===(h=A.AFrameworkApplication.K)||
void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.EndOperationOnFailureIsEnabled",!1)}return b}run(){var b=this.gi.ib.Vu;if(!this.sA){var h=JE.a.kkc(this.BSa,b);this.BSa.Ylc(b,h)?this.BSa.Tsa(b,h).element&&(this.sA=1):this.k0l&&(this.sA=2)}1===this.sA&&(h=JE.a.kkc(this.BSa,b),h=this.BSa.Tsa(b,h),b=new qK.a(h.element,b),this.CSa.showCallout(b),this.sA=2);2===this.sA&&(this.xs=32,this.Iva())}}Object(u.a)(oH,"ShowCalloutForPageNumberOperation",Iy.a,[]);class Yx{constructor(b,h,n){this.CSa=
b;this.ga=h;this.b4b=n}create(b,h,n,B,L,ba){return new oH(b,h,n,B,L,ba,this.CSa,this.ga,this.b4b)}}Object(u.a)(Yx,"Factory",null,[250]);class nv{get MN(){return null!=this.T1g?this.T1g:this.T1g=Ya.a.instance.resolve("Box4.IOutlineEditor")}wc(b){b.ia("WordEditor.HeaderFooter.HeaderFooterManager",()=>new Wr(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.rf("WordEditor.HeaderFooter.IPageNumbersActorFactory"),
b.resolve("WordEditor.IHeaderFooterViewElementFactory"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new Yy(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),ZI.a.srf,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),Ua.StaticActiveAppFrame.za().ib,Object(Pb.a)(),()=>b.resolve("Box4.IUndoManager"),A.AFrameworkApplication.va,b.resolve("Box4.IInteractiveEventNotifier"),
b.Qa("Box4.ITextMetricsAdapter"),b.resolve("Box4.IRotatingCoordinateConverter"),b.Qa("Common.IZoomManager"),b.Oa("Box4.IContentControlViewElementManager"),b.Oa("Box4.CpConversionManagerImpl"),b.Oa("Box4.ContentControlConfigSettings"),b.Oa("Box4.IContentControlReader"),b.Oa("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new hH(b.resolve("Box4.SectionAlignedViewPositionProvider"),
b.Qa("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"))).as("WordEditor.IHeaderFooterViewElementFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new dA(Eh.a.en,b.Qa("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),Eh.a.en,A.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").ha();b.ia("WordEditor.HeaderFooter.PaneControl.Factory",()=>new nH(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
b.rf("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.rf("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),Ph.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new cF(()=>{Ua.StaticActiveAppFrame.za().Ie()},b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),A.AFrameworkApplication.va,b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").ha();
b.ia("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new Zy(A.AFrameworkApplication.va,ph.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Qt.QDm,Object(z.a)(Ua.StaticActiveAppFrame.za(),Ua.StaticActiveAppFrame.za().Ktd,"updateRibbonControl"),Object(z.a)(Ua.StaticActiveAppFrame.za(),Ua.StaticActiveAppFrame.za().hJ,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new dH).ha();b.ia("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",()=>new gA(ph.a.instance)).ha();
b.ia("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new eF(Ph.FocusManager.instance(),Ua.StaticActiveAppFrame.za().Iy,b.rf("WordEditor.HeaderFooter.IPaneControlFactory"),b.rf("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.rf("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),A.AFrameworkApplication.va,new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.sc),A.AFrameworkApplication.K,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").ha();
b.ia("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new UC(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Gm.PageReader.instance,new Vl.a,Po.a.instance)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new rs(new Vl.a,Po.a.instance));b.ia("WordEditor.HeaderFooter.HeaderFooterActor",()=>new vB(A.AFrameworkApplication.va,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),
Po.a.instance,new Vl.a,new vm.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),vB.GKi,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new iq(uB.a.instance,iq.XMm(b.resolve("Box4.ITableEditor")),iq.Jkm(),A.AFrameworkApplication.isRtl,Ga.OutlineElementNavigator.he,iq.VKm(),iq.kum(),b.resolve("Box4.IOutlineElementEditor")));b.ia("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",
()=>new TC.a(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Vl.a,h=>this.MN.kSb(h,null,TC.a.rCg),A.AFrameworkApplication.isRtl,Object(z.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").Y_b,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter"),b.resolve("Box4.Styles.IWACStyleEditor")));b.ia("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new $z(Po.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).ha();b.ia("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new kv(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Vl.a,new vm.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),A.AFrameworkApplication.va)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new Sw(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
Po.a.instance,new Vl.a,A.AFrameworkApplication.va)).ha();b.ia("WordEditor.HeaderFooter.PageNumbersControl",()=>new Qt(Object(z.a)(Ua.StaticActiveAppFrame.za(),Ua.StaticActiveAppFrame.za().Ktd,"updateRibbonControl"),Object(z.a)(Ua.StaticActiveAppFrame.za(),Ua.StaticActiveAppFrame.za().hJ,"updateRibbonControls"),A.AFrameworkApplication.isRtl)).ha();b.register(fA,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").ha();b.ia("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new Uw(new vm.a,
b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersInserter",()=>new gw(new Vl.a,b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersReader",()=>new hF).ha();b.ia("WordEditor.HeaderFooter.PageNumbersRemover",()=>new yB(new Vl.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(z.a)(nv.rg,nv.rg.Ne,"replaceTextRange"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new bJ(b.rf("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),Ua.StaticActiveAppFrame.za())).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").ha();b.ia("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new lH(ph.a.instance,Zb.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").ha();
b.ia("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new Yx(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),A.AFrameworkApplication.va,Ua.StaticActiveAppFrame.za())).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").ha();b.ia("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new $E(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),A.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").ha();
b.ia("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new Zz(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").ha()}static get rg(){return null!=nv.qUg?nv.qUg:nv.qUg=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(u.a)(nv,"HeaderFooterComponentConfiguration",null,[1]);class Zx{constructor(){this.XCd=this.W=null}get name(){return"WordEditor.HeaderFooter"}wc(b){this.W=
b;(new nv).wc(b)}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo()})}Mo(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(107)&&(this.XCd=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.XCd.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.XCd&&this.XCd.dispose()}static main(){M.a.instance.Jc(new Zx)}}Object(u.a)(Zx,"PackageManager",null,[0,1]);var $x=d(351),ss=d(535);class iF{constructor(b,h){this.hg=b;this.Wm=
h}create(){return new ss.a(this.hg.instance,this.Wm.instance)}}Object(u.a)(iF,"ContentControlNodeFactory",null,[296]);var jF=d(1798),kF=d(415),zB=d(1149);class Tp{create(){return new zB.a}}Object(u.a)(Tp,"ContentControlContainerNodeFactory",null,[296]);var Xr=d(212),az=d(424),lF=d(315),$C=d(228),ov=d(238),dJ=d(1196);const ay=b=>b?(b=b.ja(Lc.a.HUa,null))&&b.includes(Xr.a.Udi):!1;class e{constructor(b,h,n,B,L,ba,la){this.cta=b;this.Kf=h;this.rg=n;this.ika=B;this.h9=L;this.km=ba;this.Mzl=la;this.OUn=
(La,fb)=>{hn.a.pga&&(La=fb.node,fb=ve.GraphIterator.eb(La),fb.zb(7)&&(fb=fb.ld(54)))&&(fb=fb.getValue(Lc.a.Ud),La=La.id,1==(null===fb||void 0===fb?void 0:fb.length)&&La.equals(fb[0])&&(La=this.cta.gxi(),this.Uei(La)))};this.Qeg=(La,fb)=>{if(hn.a.pga)for(const Cb of fb.Wci)ay(Cb.Ud)||(La=Cb.Ud.ja(Lc.a.HUa,null),this.Uei(La))}}get rYf(){return A.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled")}init(){this.ika.CAj(this.Qeg);this.Mzl.DT(this.OUn)}Uei(b){const h=this.cta.YPb();
h&&b&&this.cta.VQb(h,b)&&(b=new Sd.GraphTransaction(7),b.qu(h),h.eh(),b.dispose())}FXc(){const b=new dJ.a;b.setValue(Lc.a.HSm,!0);var h=(h=yb.a.create())?h.toString().replace(RegExp("-","g"),"").toUpperCase():null;b.setValue(Lc.a.Dlc,h);b.setValue(Lc.a.Fzl,this.rYf);h=yb.a.create();b.setValue(Lc.a.mLi,h);return b}Wgl(b){const h=b.currentNode.getValue(Lc.a.mLi);b.Uf(new az.a,1);b.S_();b.currentNode.setValue(Lc.a.Lhi,h);b.Uf(this.Kf.dob(),1);b.S_();return this.Kf.QJ(b)}GYo(b){var h=this.cta.dLf();h.zb(7);
if(h.uc()&&h.tWa(0,B=>8==B.type)){h=h.currentNode;const B=(new Qq.WACStyleSet).iba(h);if(B){var n=B.gh(Xr.a.Ykg);if(!n&&(n=this.tYk(h),x.ULS.sendTraceTag(508952736,368,50,`Placeholder text style is not in document. Adding new style succeeded: ${!!n}`),!n))return;b=Nd.a.createTextRange(b,0,ea.ParagraphReader.textLength(b));this.h9.e_(b,L=>{this.km.Zja(L);this.km.oeb(L,n)})}}}LHl(b){var h=this.cta.dLf();const n=this.FXc();h.Uf(n,29);h.S_();h=this.Wgl(h);this.rg.Ne(Nd.a.Tc(h,0),b,!1,!1);this.GYo(h);
return n}atl(b){const h=this.cta.YPb();this.cta.VQb(h,b);b=this.FXc();const n=this.cta.dLf();n.Uf(b,29);n.Yj(b);Gs.a(h.currentNode,n.currentNode,!1);return b}Jyp(b,h){const {Lpe:n,hOi:B}=this.cta.Gsm(b);if(n){var L=Nd.a.createTextRange(n,0,ea.ParagraphReader.textLength(n));this.rg.Ne(L,h,!1,!1);B&&this.MQl(b);this.oxp(b)}}MQl(b){const h=this.cta.YPb();if(h&&b&&this.cta.VQb(h,b))for(h.Xd(),b=h.Dq(),--b;0<b;b--)h.WG(b),h.eh()}oxp(b){const h=this.cta.YPb();this.cta.VQb(h,b)&&h.currentNode.setValue(Hf.a.NU,
new Date)}tYk(b){var h;const n=null===(h=ok.a.ei)||void 0===h?void 0:h.qr;h=n?new lF.a(new $C.a):new ov.a(new $C.a);h.setValue(lk.a.la,"Placeholder Text");h.setValue(lk.a.na,1);h.setValue(Lc.a.ma,"PlaceholderText");h.setValue(ye.a.oa,99);h.setValue(Lc.a.pa,"Default Paragraph Font");h.setValue(Lc.a.qo,!0);h.setValue(Hf.a.fontColor,8421504);return ok.a.tSc([h],b)?(n&&(b=ok.a.Vb.ko(),h=ok.a.Vb.Ae(h),h=b.gh(h)),h):null}}Object(u.a)(e,"GlossaryEditor",null,[228]);class t{constructor(b,h,n,B,L){this.ika=
b;this.s7h=h;this.eMb=n;this.bM=B;this.Lj=L;this.Dzl=new Tp;this.beg=(ba,la)=>{this.bM.Yd(()=>{if(la){la.Pm.selectedContentControls||(la.Pm.selectedContentControls={});var La=la.Pm.selectedContentControls,fb=la.hOa;if(fb&&fb.length){var Cb=fb[0];fb=fb[fb.length-1];Cb=this.ika.FIf(Nd.a.Tc(Cb.node,Cb.lk),Nd.a.Tc(fb.node,fb.Ep),!1);for(const Lb of Cb)hn.a.Yy&&Lb.Ud.ja(Lc.a.xN,!1)||(La[Lb.Ud.id.toString()]=!0)}}},"CC:OnBeforeCopy")};this.Hfd=(ba,la)=>{this.bM.Yd(()=>{if(la){var La=la.clone,fb=la.original;
try{const Cb=la.Pm.selectedContentControls,Lb=this.ika.MHf(fb,0,fb.characterData.length,!0,!0,!1);for(const $b of Lb){const tc=$b.pe.toString();Cb[tc]?$b.lq&&!this.$Bl($b.Ud,La,Cb)&&(x.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",tc)),this.gsg(La,$b.pe)):this.gsg(La,$b.pe)}}catch(Cb){x.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",Cb.toString()),this.s7h.gxo(La)}}},"CC:onParagraphCopy")};this.Cgg=(ba,
la)=>{this.bM.Yd(()=>{if(la){var La=la.clone,fb=la.original;try{const Cb=this.ika.MHf(La,0,fb.characterData.length);la.Pm.ccObjectIdMapping||(la.Pm.ccObjectIdMapping={});const Lb=la.Pm.ccObjectIdMapping;for(let $b=0;$b<Cb.count;$b++){const tc=Cb.J($b),Nc=tc.pe.toString();if(this.ppn(tc))if(tc.Wc){const dd=fb.Jj().td.Eb(Nc),Hd=this.kFm(tc),xe=this.Ssl(dd,Hd.Prj,Hd.ISi,La.Jj().td);Lb[Nc]=xe.id;this.eMb.L6j(Lb[Nc],La.id,null);this.Lj.trc(xe)}else this.eMb.L6j(Lb[Nc],null,La.id);Lb[Nc]?(tc.pe=Lb[Nc],
tc.Fv=null):this.gsg(La,tc.pe)}}catch(Cb){x.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Cb.toString())}}},"CC:onParagraphPaste")}}init(){ev.a.uPh(this.beg);ev.a.PRd(this.Hfd);ev.a.QRd(this.Cgg)}Dlm(b){if(!b.zb(25)||!b.ld(25))return null;if(!b.fv(25)){const h=this.Dzl.create(pk.a.Cra);b.Uf(h,25)}return b.Ub(25)}$Bl(b,h,n){var B=b.ja(Lc.a.xaa,null);const L=ve.GraphIterator.eb(h);h=h.Jj().td;n=B&&n[B.toString()]?h.Eb(B):this.Dlm(L);if(!n)return x.ULS.sendTraceTag(521172765,
368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;B=Gs.b(b,h,!0);ve.GraphIterator.eb(n).w6(B,26,b.id);54!==n.type&&B.setValue(Lc.a.xaa,n.id);hn.a.Yy&&kF.a.wWf(null,B);return B}gsg(b,h){this.s7h.YPl(new ob.a([b]),h)}ppn(b){var h=b.Jb.paragraph.Lc;if(!h)return x.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.pe.toString())),!1;h=h.Eb(b.Fv);if(!h)return x.ULS.sendTraceTag(520152149,
368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.pe.toString())),!1;b=h.getValue(Lc.a.mt);return 38===b||39==b}gkm(b,h){var n,B=b.qa.J(b.qa.length-1);let L=b.characterData.length;B=(null===(n=null===B||void 0===B?void 0:B.Hb)||void 0===n?void 0:n.length)||0;b.id.equals(h.Jb.paragraph.id)&&(L=h.Jb.cp,B=h.Jb.Hb.DL(h.pe,h.Wc));return this.ika.NHf(b,0,L,0,B)}kFm(b){let h=null,n=b.Jb.paragraph;const B={};for(;n;){const L=this.gkm(n,b);for(let ba=L.count-1;0<=ba;ba--){const la=
L.J(ba);if(!la.lq)continue;const La=la.pe.toString();if(la.Wc){if(!B[La])return{Prj:la.Ud,ISi:h}}else B[La]=!0,h||(h=la.Ud)}n=ea.ParagraphReader.zg(n,!0,!0)}return{Prj:null,ISi:h}}Ssl(b,h,n,B){let L;h?L=this.eMb.iBa(h):(L=this.eMb.jBa(),h=L.currentNode);B=Gs.b(b,B,!0);B.Kg(Lc.a.Iw,Se.a.VF());54!==h.type&&B.setValue(Lc.a.xaa,h.id);L.fK(B,n,26);hn.a.pga&&!ay(b)&&this.eMb.Ysl(b,B);return B}}Object(u.a)(t,"ContentControlCCP",null,[]);var E=d(780);class W{constructor(b,h,n,B){this.Qd=b;this.hg=h;this.jb=
n;this.qh=B}get l0(){return!!this.hg.instance&&this.hg.instance.l0}get MSb(){return!!this.hg.instance&&this.hg.instance.MSb}bza(b,h,n,B,L,ba=Xr.a.iNb,la=Xr.a.Hgc,La=null,fb=Xr.a.mwf,Cb=-1){(b=this.Ikc(b,n))?(b.Hb||(b.Hb=new $x.a(b)),this.UVk(h,b.Hb,B,L,ba,la,La,fb,Cb)):x.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}Dei(b,h,n){if(b){new ob.a;for(let L=0;L<b.count;L++){var B=this.BIf(b.J(L),h,!1);for(const ba of B)this.Jxo(ba,n)}}}XPl(b,h){this.Dei(b,
h,!0)}YPl(b,h){this.Dei(b,h,!1)}Ne(b,h,n,B){this.Qd.Ne(b,h,n===wb.a.Jpd||hn.a.Qec&&8===B)}Ikc(b,h){var n=Nd.a.Tc(b,h);this.Qd.Ieb(n);for(n=0;n<b.qa.length;n++){const B=b.qa.J(n);if(B.cp>h)break;if(B.cp===h)return B}return null}UVk(b,h,n,B,L=Xr.a.iNb,ba=Xr.a.Hgc,la=null,La=Xr.a.mwf,fb=-1){const Cb=h.Jb.paragraph;b=new E.a(h.Jb,!0,!0,!0,null,b,B,n,L,ba,la,La,null,this.qh);if(!this.l0||-1>=fb||fb>h.length)fb=h.length;h.insert(b,fb);Cb.Jl();b.oe?Cb.qe.wX(b.oe-1,512):Cb.qe.rta(b.oe,512);Cb.qe.Kq.Z(b.oe,
ju.CharacterPropertiesEditor.GN);Cb.qe.Nt.Z(b.oe,ju.CharacterPropertiesEditor.fS)}BIf(b,h,n){const B=new ob.a;for(let L=0;L<b.qa.length;L++){const ba=b.qa.J(L);if(ba.Hb)for(let la=0;la<ba.Hb.length;la++)if(ba.Hb.J(la).pe.equals(h)&&(B.add(ba.Hb.J(la)),n))return B}return B}otd(b,h,n){if(this.MSb&&b){var B=b.node,L=b.lk,ba=b.Ep,la=this.kwi(B,L,h,!0);h=this.kwi(B,ba,h,!1);n?-1!==la&&la++:-1!==h&&h++;L||-1===la||(la=Math.max(la,this.jb.ry(B)));ba===this.jb.textLength(B)&&-1!==h&&(h=Math.min(h,this.jb.Bx(B)));
b.Fb=la;b.Tb=h}}kwi(b,h,n,B){return(b=(b=b.qa.sh(h))?b.Hb:null)&&b.length?b.DL(n,B):-1}Jxo(b,h){b&&b.Jb.Hb&&(h?b.Jb.Hb.remove(b):b.Jb.Hb.kva(b),h=b.Jb.paragraph,0<=b.oe&&b.oe<h.qe.length&&(b.Jb.cp||1!==h.qe.length||(h.qe.wX(0,512),h.qe.Kq.Z(1,ju.CharacterPropertiesEditor.GN),h.qe.Nt.Z(1,ju.CharacterPropertiesEditor.fS)),h.qe.removeAt(b.oe,512)),h.Jl())}gxo(b){const h=b.qa;if(h){var n=new ob.a;for(let B=0;B<h.length;B++){const L=h.J(B);if(L&&L.Hb){for(let ba=0;ba<L.Hb.length;ba++)n.add(L.Hb.J(ba).oe);
L.Hb=null}}b.nna(n)}}Mrp(b,h,n){if(!(0>h||0>n))for(this.Qd.Ieb(Nd.a.Tc(b,h)),this.Qd.Ieb(Nd.a.Tc(b,n)),h=b.qa.h3(h),n=b.qa.h3(n),--n;n>h;n--){const B=b.qa.J(n);B.NYf?b.qa.removeAt(n):B.formatting=null}}}Object(u.a)(W,"ContentControlChpManager",null,[395]);class ha{constructor(b,h,n,B,L){this.jb=b;this.Bp=h;this.hi=n;this.xd=B;this.qh=L}BHf(b){if(!b||!re.SelectionEditor.mf(b))return null;if(!b.cpBegin){const h=this.mui(b.node,b.Fb,!0);if(h)return h}return b.cpBegin===this.jb.textLength(b.node)?this.mui(b.node,
b.Fb-1,!1):null}Zim(b,h){b=this.U$h(b,h);return this.BHf(b)}mui(b,h,n){return b.qa&&b.qa.length?(b=n?b.qa.first.Hb:b.qa.last.Hb)&&0<=h&&h<b.length&&b.J(h).fg&&b.J(h).Wc===n&&this.$Xf(b.J(h))?b.J(h):null:null}XKf(b){if(!b||!re.SelectionEditor.mw(b))return null;var h=this.Bp.c6d(b,b);b=0<h.count?h.J(h.count-1):null;return b&&!b.fg&&this.$Xf(b)?(h=1<h.count?h.J(h.count-2):null)&&!h.fg&&this.$Xf(h)?null:b:null}$Xf(b){if(!b)return!1;var h=this.YDi(b);if(!h)return!1;if(b.Wc)var n=b;else n=h,h=b;var B=this.jb.textLength(b.Jb.paragraph);
if(n.Jb.cp||h.Jb.cp!==B||!n.lq||n.JCa||!h.lq||h.JCa)return!1;n=n.Jb.Hb;h=h.Jb.Hb;for(B=0;B<n.length&&!n.J(B).pe.equals(b.pe);B++)if(!n.J(B).Wc)return!1;for(n=h.length-1;0<=n&&!h.J(n).pe.equals(b.pe);n--)if(h.J(n).Wc)return!1;return!0}Vsd(b){b=this.BHf(b);this.VXd(b,!1)}E4j(b,h){b=this.U$h(b,h);this.Vsd(b)}pPa(b){b=this.XKf(b);return this.VXd(b,!0)?b:null}uen(b,h){b=this.BHf(b);return!!b&&b.pe.equals(h)}Knc(b,h,n){b=this.Zim(b,h);return!!b&&b.pe.equals(n)}GZf(b,h){b=this.XKf(b);return!!b&&b.pe.equals(h)}VXd(b,
h){if(!b)return!1;const n=this.YDi(b);return this.d8h(b,h)&&(!n||this.d8h(n,h))}d8h(b,h){if(!b||b.fg===h)return!1;var n=this.Bp.pEe(b.Jb.paragraph,b.Wc);const B=b.Jb.Hb;-1!==n||b.Wc||(n=B.length);const L=h===b.Wc?1:-1;n+=h?L:0;b=B.DL(b.pe,b.Wc)+L;if(n===b||0<L!==b>n)return x.ULS.shipAssertTag(24933847,368,n!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",n,b,L),x.ULS.shipAssertTag(24933848,368,0<L===b>n,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",
n,b,L),!1;for(var ba=n;ba!==b;ba+=L){var la=B.J(ba);B.kva(la);la.fg=h;B.Jan(la,ba);this.$wp(B.J(ba))}if(this.A3)for(B.Jb.paragraph.Jl(),ba=n;ba!==b;ba+=L)la=B.J(ba),la.paragraph.qe.Kq.Z(la.oe,ju.CharacterPropertiesEditor.GN),la.paragraph.qe.Nt.Z(la.oe,ju.CharacterPropertiesEditor.fS);h||this.Kzp(B,n,b,L);x.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",Math.abs(b-n),h?"block":"inline");return!0}K8d(b){return b.Wc&&this.qh.pr(b.Ud.id,!0).equals(b.Jb.paragraph.id)?38:!b.Wc&&
this.qh.pr(b.Ud.id,!1).equals(b.Jb.paragraph.id)?39:b.fg&&b.Wc?40:b.fg&&!b.Wc?41:!b.fg&&b.Wc?38:39}$wp(b){const h=b.Jb.paragraph.Lc;if(h){var n=h.Eb(b.Fv),B=b.Ud;if(n){n=n.clone();n.setValue(Lc.a.q1f,b.fg);const L=this.K8d(b);n.setValue(Lc.a.mt,L);h.ou(n,null);b.Fv=n.id}B&&B.setValue(Lc.a.xba,b.fg)}}YDi(b){if(b.Jb.cp&&b.Jb.cp!==this.jb.textLength(b.Jb.paragraph)||!b.Jb.paragraph.qa||!b.Jb.paragraph.qa.length)return null;const h=b.Wc?b.Jb.paragraph.qa.last:b.Jb.paragraph.qa.first;if(!h.Hb)return null;
b=h.Hb.DL(b.pe,!b.Wc);return-1===b?null:h.Hb.J(b)}Kzp(b,h,n,B){var L=b.J(h).Ud;if(L){var ba=b.J(h).Wc;L=this.qh.pr(L.id,ba);if(!L.equals(S.a.nil))if(b.Jb&&b.Jb.paragraph&&b.Jb.paragraph.id.equals(L)){for(h+=B;h!==n;h+=B){const la=b.J(h).Ud;if(!la)return;this.qh.iJ(la.id,L,ba)}0<=n&&n<b.length&&b.J(n).fg&&this.e1f(b.J(n))&&(b=b.J(n).Ud)&&this.qh.iJ(b.id,L,ba)}else x.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}e1f(b){return b.lq&&
!b.JCa}U$h(b,h){if(!b||!this.hi)return null;const n=h?Nd.a.Tc(b,0):Nd.a.zx(b);b=this.hi.Rr(b,h);n.Tb=n.Fb=b;return n}get A3(){return this.xd.isFeatureEnabled(28)}}Object(u.a)(ha,"ContentControlConverter",null,[394]);var Ka;(function(b){b[b.gLp=0]="BoundingBox";b[b.BQp=1]="Tags";b[b.hNp=2]="Hidden";b[b.MOp=3]="NumberOfContentControlAppearance"})(Ka||(Ka={}));Object(u.b)("ContentControlAppearance",Ka);var sb=d(1697);class dc{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb){this.gib=this.rqa=this.VAd=this.rNd=
this.$Hd=null;this.Foa=this.Kk=this.uNc=this._id=0;this.t6b=this.jkb=this.nOd=this._title=this.SFa=null;this.hFd=this.gFd=this.Qqh=this.QKd=this.DJc=this.zJc=this.lAd=!1;this.lsh=null;this.fg=!1;this.Oyd=null;this.Ei=n;this.Oy=h;this.hh=B;this.Dr=L;this.Wm=ba;this.x5=la;this.Aia=La;this.uja=fb;this.FJb=Cb;this.qh=Lb;b?(this.$Hd=b.id,this.Oyd=b,this.aX(!1)):this._id=Se.a.VF()}get Ej(){return this.Ei.value}get id(){this.aX();return this._id}set id(b){this._id=b;this.isValid()&&(this.Ud.setValue(Lc.a.Iw,
this._id),this.JY())}get parentId(){this.aX();return this.uNc}set parentId(b){this.uNc=b}get title(){this.aX();return this._title}set title(b){this._title=b;this.isValid()&&(this.Ud.setValue(Lc.a.Jnb,this._title),this.JY(),this.rtd(h=>{h.title=this._title?this._title:Xr.a.iNb}))}get tag(){this.aX();return this.nOd}set tag(b){this.nOd=b;this.isValid()&&(this.Ud.setValue(Lc.a.Nnb,this.nOd),this.JY())}get type(){this.aX();return this.Kk}set type(b){this.Kk=b;this.isValid()&&(this.Ud.setValue(Lc.a.f7a,
sb.a[this.Kk]),this.JY())}get appearance(){this.aX();return this.Foa}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.Foa=b;this.isValid()&&(this.Ud.setValue(Lc.a.Knb,Ka[this.Foa].toLowerCase()),this.JY(),this.rtd(h=>{h.appearance=Ka[this.Foa].toLowerCase()}))}get color(){this.aX();return this.SFa}set color(b){if(b&&16777215>=b)this.SFa=b,this.isValid()&&(this.Ud.setValue(Lc.a.NWc,this.SFa),this.JY(),this.rtd(h=>{h.color=this.SFa}));
else throw Error.argumentOutOfRange("The color value is out of range.");}get placeholderText(){this.aX();return this.jkb}set placeholderText(b){this.jkb=b;hn.a.pga&&this.hh.t7j(b,this.Oyd)&&(this.JY(),this.RL&&this.Wm.sKb(this,!0))}get n0d(){this.aX();return this.t6b}set n0d(b){this.t6b=b;this.isValid()&&(this.Ud.setValue(Lc.a.dMb,this.t6b),this.JY())}get Xyf(){this.aX();return this.lAd}set Xyf(b){b&&(this.lAd=b,this.isValid()&&(this.Ud.setValue(Lc.a.HXd,this.lAd),this.JY()))}get removeWhenEdited(){this.aX();
return this.QKd}set removeWhenEdited(b){if(b&&!this.Nla)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.QKd=b;this.isValid()&&(this.Ud.setValue(Lc.a.v7h,this.QKd),this.JY())}get Nla(){this.aX();return this.zJc}set Nla(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.zJc=b;this.isValid()&&(this.Ud.setValue(Lc.a.Cfc,
this.zJc),this.rtd(h=>{h.hN=this.zJc}),this.JY())}get isEditable(){this.aX();return this.DJc}set isEditable(b){this.DJc=b;this.isValid()&&(this.Ud.setValue(Lc.a.Mnb,this.DJc),this.rtd(h=>{h.editable=this.DJc}),this.JY())}get isSupported(){this.aX();return this.Qqh}get ypn(){return this.isSupported&&11!==this.type&&10!==this.type}get Msn(){this.aX();return this.t6b&&"table of contents"===this.t6b.toLowerCase()?!0:!1}get wfe(){this.aX();return this.gFd}set wfe(b){this.gFd=b;this.isValid()&&(this.Ud.setValue(Lc.a.A7h,
this.gFd),this.JY())}get Poc(){this.aX();return this.hFd}set Poc(b){this.hFd=b;this.isValid()&&(this.Ud.setValue(Lc.a.B7h,this.hFd),this.JY())}get RL(){return this.Ud.ja(Lc.a.yaa,!1)}set RL(b){this.isValid()&&this.Ud.setValue(Lc.a.yaa,b)}get isChecked(){return 8!==this.type?!1:this.Ud.ja(ye.a.Yrf,!1)}set isChecked(b){8===this.type&&this.isValid()&&(this.Ud.setValue(ye.a.Yrf,b),this.JY())}get pv(){this.aX();return this.rNd}set pv(b){this.rNd=b}get MA(){this.aX();return this.VAd}set MA(b){this.VAd=
b}get objectId(){return this.$Hd}set objectId(b){this.$Hd=b;this.Oyd=this.Ej.Eb(this.$Hd)}get start(){this.p9j();return this.rqa}set start(b){this.rqa=b}get end(){this.p9j();return this.gib}set end(b){this.gib=b}get Ud(){return this.Oyd}u9n(b){for(let h=0;3>h;++h)if(Ka[h].toLowerCase()===b)return h;return 0}JY(){const b=this.start.node;b&&b.setValue(Hf.a.NU,new Date)}Gtd(){this._id=this.Ud.ja(Lc.a.Iw,0);this.Foa=this.u9n(this.Ud.ja(Lc.a.Knb,null));this.SFa=this.Ud.ja(Lc.a.NWc,null);this._title=this.Ud.ja(Lc.a.Jnb,
null);this.nOd=this.Ud.ja(Lc.a.Nnb,null);this.fg=this.Ud.ja(Lc.a.xba,!1);this.zJc=this.Ud.ja(Lc.a.Cfc,!1);this.DJc=this.Ud.ja(Lc.a.Mnb,!1);this.Qqh=this.Ud.ja(Lc.a.hka,!1);this.t6b=this.Ud.ja(Lc.a.dMb,null);this.lAd=this.Ud.ja(Lc.a.HXd,!1);this.rNd=this.qh.pr(this.Ud.id,!0);this.VAd=this.qh.pr(this.Ud.id,!1);this.hFd=this.Ud.ja(Lc.a.B7h,!1);this.gFd=this.Ud.ja(Lc.a.A7h,!1);this.QKd=this.Ud.ja(Lc.a.v7h,!1);this.Kk=Object(sb.b)(this.Ud.ja(Lc.a.f7a,"RichText"));let b=null;try{const h=this.Ud.ja(Lc.a.xaa,
S.a.nil);if(S.a.Bt(h,S.a.nil))this.uNc=0;else if(b=this.Ej.Eb(h))this.uNc=b.ja(Lc.a.Iw,0)}catch(h){this.uNc=0}this.Iyp()}Iyp(){if(this.FJb){var b=this.Ud.ja(Lc.a.HUa,"");if((b=this.Aia.vKi(b))&&0<b.length){this.jkb=this.vti(b.Ra,b.Uc);return}}this.jkb=(b=this.hh.jBa())&&b.currentNode?b.currentNode.ja(Lc.a.OWc,null):null}aX(b=!0){if(!b||this.isValid())b=this.Ud.ja(Hf.a.lastModifiedTime,new Date(0)),this.lsh!==b?(x.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),
this.Gtd(),this.lsh=b):x.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}Jzp(b,h){this.rNd=b;this.VAd=h;this.qh.iJ(this.Ud.id,b,!0);this.qh.iJ(this.Ud.id,h,!1)}p9j(){if(this.Ud){var b=this.pv,h=this.MA;if(!b||!h||b.equals(S.a.nil)||h.equals(S.a.nil))x.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");else if(b=this.hh.Dsa(b,!0),h=this.hh.Dsa(h,!1),
b&&h)if(b.isConnected&&h.isConnected||x.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.fg)b=Nd.a.create(b),this.Dr.otd(b,this.objectId,!0),this.start=b,b=Nd.a.create(h),this.Dr.otd(b,this.objectId,!0),this.end=b;else{let n=h=-1;if(b.qa){for(let B=0;B<b.qa.length&&(-1===h||-1===n);B++){const L=b.qa.J(B);if(L.Hb)for(let ba=0;ba<L.Hb.length&&(-1===h||-1===n);ba++){const la=L.Hb.J(ba);S.a.Bt(la.pe,this.objectId)&&(la.Wc?h=L.cp:n=L.cp)}}0<=h&&0<=n&&(b=Nd.a.bU(h,n,
!1,b),this.Dr.otd(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const n=this.end;if(!h||!n)return b;this.fg?b=this.vti(h,n):(h=ea.ParagraphReader.text(h.node).substring(h.cpBegin,n.cpEnd),b+=Cn.AParagraphNode.iV(h));return b}isValid(){return!!this.Ud&&this.Ud.isConnected}Gye(b){return this.uja?this.Wm.YAg(this,b)?0:2:2}clear(){return this.uja?this.Wm.YAg(this,"")?0:2:2}svi(){const b=new ob.a;var h=this.Ud.ja(Lc.a.Ud,[]);for(const n of h)if(!S.a.Bt(n,S.a.nil)){h=
this.Ei.value.Eb(n);try{b.add(this.x5.rMb(h,this.Oy,this.Ei,this.hh,this.Dr,this.Wm,this.Aia,this.uja,this.FJb))}catch(B){}}return b}YGf(){const b=new ob.a;this.lti(this,b);return b}lti(b,h){b=b.svi();if(b.count)for(const n of b)h.add(n),this.lti(n,h)}TG(b=!1){const h=new ob.a;if(this.fg){var n=this.Wm.gX(this.start,this.end);for(var B of n)n=Nd.a.create(B),this.Dr.otd(n,this.objectId,b),h.add(n)}else B=this.start.clone(),this.Dr.otd(B,this.objectId,b),h.add(B);return h}rtd(b){const h=this.Wm.gX(this.start,
this.end);for(let n=0;n<h.count;n++){const B=this.Dr.BIf(h.J(n),this.objectId,!1);if(B){for(let L=0;L<B.count;L++)b(B.J(L));h.J(n).Nk()}}}vti(b,h){const n=new Sys.StringBuilder;h=this.Wm.gX(b,h);for(const B of h)B.id.equals(b.node.id)||n.append("\r"),n.append(ea.ParagraphReader.rca(B));return n.toString()}}Object(u.a)(dc,"ContentControl",null,[258]);class xc{constructor(b){this.qh=b}rMb(b,h,n,B,L,ba,la,La,fb){return new dc(b,h,n,B,L,ba,this,la,La,fb,this.qh)}}Object(u.a)(xc,"ContentControlFactory",
null,[393]);class Rc{constructor(b,h,n,B,L){this.Ei=b;this.Dr=h;this.jQk=n;this.OZ=B;this.Ga=L}bvp(b,h,n){var B,L;if(!(hn.a.asf&&b&&h&&n))return!1;const ba=b.Ud;if(!ba)return!1;var la=ba.ja(Lc.a.fMb,S.a.nil);la&&!la.equals(S.a.nil)?b=this.Ei.value.Eb(la):(b=this.Dr.Ikc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0),b=null===(B=null===b||void 0===b?void 0:b.formatting)||void 0===B?void 0:B.uo,b||(b=new tt.a,this.Ei.value.ou(b,null)),ba.setValue(Lc.a.fMb,b.id));B=this.Ei.value.Eb(b.id);la="boolean"===
typeof n&&n;const La=null===(L=this.Ga)||void 0===L?void 0:L.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);h=this.jQk.qKf(ba,B,h,n,La?null:la);h=this.OZ.fGe(h);for(const [fb,Cb]of h)b.setValue(fb,Cb);return!0}}Object(u.a)(Rc,"ContentControlFormattingManager",null,[392]);var md=d(1007);class ud{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc){this.Oy=b;this.Ei=h;this.Zc=n;this.EGb=B;this.Nrk=L;this.pT=ba;this.Oh=la;this.jb=La;this.jJd=fb;this.jCd=Cb;this.qh=Lb;this.bUe=
$b;this.Aia=tc}get lv(){return this.Oy.value}jBa(){const b=this.Zc.Ql();b.set(this.lv);this.EGb.dS(b);if(b.Ub(25))return b;this.jCd.instance&&this.jCd.instance.Dta&&x.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");x.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}s3c(b,h,n=!1){this.$Nb();const B=new ob.a;let L;if(b){L=b.Ub(26);if(!L)return B;for(;L&&(!h(L)||(B.add(L),!n));){B.addRange(this.s3c(b,h));if(n&&0<B.count)break;
L=b.Lf(26)}b.uc()}return B}NDm(){const b=this.Zc.Ql();b.set(this.Oy.value);this.EGb.dS(b);return b.currentNode}KXa(b,h,n){let B;B=b.equals(h);B||(B=(b=this.Dsa(b,n))?b.id.equals(h):!1);return B}JVa(b,h){b=this.Bu(b);if(!b)return null;let n=null;for(;55===b.type;){const B=this.qh.pr(b.id,h);if(B.equals(n)){b=null;break}else b=this.Bu(B);n=B}return b}Dsa(b,h){return(b=this.JVa(b,h))?ea.ParagraphReader.Xb(b)?b:h?this.jb.Zl(b):this.jb.hD(b):null}Bei(b,h=!1){this.fup(b);this.Cei(b,h)}fup(b){var h=this.iBa(b);
h=this.iBa(h.parentNode);h=55===h.currentNode.type?h.currentNode.id:null;let n,B;n=this.Bu(this.qh.pr(b.id,!0));for(B=this.Bu(this.qh.pr(b.id,!1));n&&55===n.type;)n=this.Bu(this.qh.pr(n.id,!0));for(;B&&55===B.type;)B=this.Bu(this.qh.pr(B.id,!1));n&&B&&this.K6j(n.id,B.id,h,L=>{L=L.ja(Lc.a.q_,S.a.nil);return!L||L.equals(S.a.nil)||b.id.equals(L)})}Cei(b,h=!1){x.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");var n=this.iBa(b);const B=this.iBa(n.parentNode);let L=S.a.nil,
ba=S.a.nil;var la=B.currentNode.ja(Lc.a.Ud,[]);const La=new ob.a;for(var fb=0;fb<la.length;fb++)La.add(la[fb]);if(h){if(54!==B.currentNode.type){L=this.qh.pr(B.currentNode.id,!0);ba=this.qh.pr(B.currentNode.id,!1);la=this.Bu(L);for(fb=this.Bu(ba);la&&55===la.type;)L=this.qh.pr(la.id,!0),la=this.Bu(L);for(;fb&&55===fb.type;)ba=this.qh.pr(fb.id,!1),fb=this.Bu(ba)}la=this.iBa(b);if(la.Ub(26)){fb=new ob.a;for(fb.add(la.currentNode);la.Lf(26);)fb.add(la.currentNode);for(var Cb of fb)this.Cei(Cb,h)}}else if(L=
this.qh.pr(b.id,!0),ba=this.qh.pr(b.id,!1),h=this.fwm(La,b.id),Cb=this.iBa(b),Cb.Ub(26)){la=this.iBa(Cb.currentNode);fb=la.currentNode;let Lb=b;for(;fb;){const $b=Cb.currentNode;La.insert(h++,$b.id);fb=la.Lf(26);const tc=this.iBa($b);54!==B.currentNode.type?$b.setValue(Lc.a.xaa,B.currentNode.id):$b.removeProperty(Lc.a.xaa);Gs.h(tc,B,Lb,26);Lb=tc.currentNode;fb&&(Cb.set(fb),Cb.T4(this.jBa().currentNode))}}54!==B.currentNode.type&&(h=this.qh.pr(B.currentNode.id,!0),Cb=this.qh.pr(B.currentNode.id,!1),
h.equals(b.id)&&this.qh.iJ(B.currentNode.id,L,!0),Cb.equals(b.id)&&this.qh.iJ(B.currentNode.id,ba,!1));n.eh();x.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(La,b.id);la=Array(La.count);for(n=0;n<La.count;n++)la[n]=La.J(n);B.currentNode.setValue(Lc.a.Ud,la);md.a.UCa(b.id)}TVk(b,h,n,B,L,ba,la=null){let La;if(h){var fb=this.Bu(h.objectId);La=this.iBa(fb)}else La=this.jBa(),fb=La.currentNode;const Cb=this.Nrk.create(pk.a.Ud);la&&Cb.properties.Bv(la.properties);54!==fb.type&&
Cb.setValue(Lc.a.xaa,fb.id);la?La.fSb(Cb,n,26,la.id):La.fK(Cb,n,26);this.q9j(b,Cb.id,L,!0);this.q9j(b,Cb.id,ba,!1);b.fg&&(h&&(n=this.qh.pr(fb.id,!0),la=this.qh.pr(fb.id,!1),n.equals(L)&&this.qh.iJ(fb.id,Cb.id,!0),la.equals(ba)&&this.qh.iJ(fb.id,Cb.id,!1)),this.K6j(L,ba,Cb.id,Lb=>{Lb=Lb.ja(Lc.a.q_,S.a.nil);const $b=h?h.objectId:null;return!Lb||Lb.equals(S.a.nil)||Lb.equals($b)}));L=this.iBa(Cb);ba=Array(B.count);for(fb=B.count-1;0<=fb;fb--)ba[fb]=B.J(fb).objectId,n=this.Bu(B.J(fb).objectId),n=this.iBa(n),
n.currentNode.setValue(Lc.a.xaa,Cb.id),Gs.h(n,L,null,26);0<ba.length&&Cb.setValue(Lc.a.Ud,ba);ud.rc.isFeatureEnabled(34)&&(b.n0d&&Cb.setValue(Lc.a.dMb,b.n0d),b.Xyf&&Cb.setValue(Lc.a.HXd,!0));return Cb}q9j(b,h,n,B){12===this.Bu(n).type?this.qh.iJ(h,n,B):(this.qh.VMg(h,n,B),this.qh.iJ(h,B?b.start.node.id:b.end.node.id,B))}oSo(b,h,n,B,L){b.setValue(Lc.a.xba,h);b.setValue(Lc.a.Cfc,!0);b.setValue(Lc.a.Mnb,!0);b.setValue(Lc.a.Iw,n);b.setValue(Lc.a.Knb,Ka[0]);b.setValue(Lc.a.hka,!0);b.setValue(Lc.a.f7a,
sb.a[L]);B&&b.setValue(Lc.a.Qzb,B);b.setValue(Lc.a.Dfc,0)}L6j(b,h=null,n=null){h&&this.qh.iJ(b,h,!0);n&&this.qh.iJ(b,n,!1)}Sei(b){if(!b||!b.count||!b.J(0))return null;const h=this.hNf(b);for(let n=0;n<b.count;n++)this.Oh.YDa(b.J(n));return h}hNf(b){if(!b||!b.J(0))return null;const h=this.Zc.Ql();h.set(b.J(0));h.Jd();h.uc();return h.bK()?h.currentNode:null}XEm(b){const h=this.Zc.Ql();h.set(b);h.Jd();h.uc();h.uc();return h}nOh(b,h,n){const B=new ob.a;for(let L=0;L<n;L++){h=this.pT.kSb(b,h,!0,null);
if(!h||!b.Xd())return null;const ba=b.currentNode;b.uc();b.uc();B.add(ba)}return B}wlc(b){const h=this.Zc.Ql();h.set(b);for(h.zb(7);h.uc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}LDi(b){const h=this.Zc.Ql();h.set(b);h.Jd();return(b=h.Bdb())?b.id:null}eLf(b){const h=this.Zc.Ql();h.set(b);return h.zb(7)?h:null}Bu(b){return this.Ei.value.Eb(b)}$Nb(){if(!ud.loh){var b=this.jBa();b&&this.iKg(b);ud.loh=!0}}V_a(b){return this.jJd.V_a(b)}Sof(b,h,n,B){let L=
null,ba=b.ld(16);for(;ba!==n;){if(h&&Ng.TableCellReader.CYi(b)||!h&&Ng.TableCellReader.WZf(b))L=b.ld(14);else return{returnValue:!1,jn:B};ba=b.ld(16)}L&&(B=Nd.a.create(L));return{returnValue:!0,jn:B}}iKg(b){if(b.Ub(26)){for(this.iKg(b);b.Lf(26);)this.iKg(b);b.uc()}}remove(b,h){for(let n=0;n<b.count;n++)if(b.J(n).toString()===h.toString()){b.removeAt(n);break}}iBa(b){const h=this.Zc.Ql();h.set(b);h.T4(this.jBa().currentNode);return h}fwm(b,h){for(let n=0;n<b.count;n++)if(b.J(n).equals(h))return n;
return-1}K6j(b,h,n,B){b=this.Nmm(b,h);for(h=0;h<b.count;h++)B(b.J(h))&&(n?b.J(h).setValue(Lc.a.q_,n):b.J(h).removeProperty(Lc.a.q_),this.jCd.instance&&this.jCd.instance.LWi&&b.J(h).om(16,!0))}Nmm(b,h){const n=new ob.a;var B=this.Bu(b);const L=this.Bu(h);if(!B||!L)return n;const ba=({xbd:la}=this.h5d(B,L)).returnValue;B=la[ba];if(14===B.type)n.add(B);else if(15===B.type&&1<=ba){const La=la[ba-1];1===xh.TableReader.xg(La)&&n.add(La)}var la=ve.GraphIterator.eb(ba>=la.length-1?B:la[ba+1]);la.zb(7);for(B=
Ff.a.Ft(la,B);B.moveNext()&&B.currentNode!==L;)14===B.currentNode.type&&n.add(B.currentNode);if(!S.a.Bt(h,b)&&14===L.type)for(la=ve.GraphIterator.eb(L),B=Ff.a.Ft(la,L);B.moveNext();)14===B.currentNode.type&&n.add(B.currentNode);return n}h5d(b,h){b=this.mqb(b);h=this.mqb(h);let n=0;for(;n<b.length&&n<h.length&&b[n]===h[n];++n);return{returnValue:0<n?n-1:n,xbd:b,lwg:h}}mqb(b){const h=[];h.push(b);b=ve.GraphIterator.eb(b);for(b.zb(7);b.uc();)h.push(b.currentNode);h.reverse();return h}static get rc(){return null!=
ud.yWg?ud.yWg:ud.yWg=Ya.a.instance.Oa("Box4.IFeatureHelper")}FXc(b,h,n=!1){b=this.bUe.instance.LHl(b);n?(n=Xr.a.AOl,b.setValue(Lc.a.Dlc,n)):n=b.ja(Lc.a.Dlc,null);h.setValue(Lc.a.HUa,n)}Ysl(b,h){this.vtj(b)&&(b=b.ja(Lc.a.HUa,null),b=this.bUe.instance.atl(b).ja(Lc.a.Dlc,null),h.setValue(Lc.a.HUa,b))}t7j(b,h){if(!this.vtj(h))return!1;var n=h.ja(Lc.a.HUa,null);n?ay(h)?this.FXc(b,h):this.bUe.instance.Jyp(n,b):(n=this.Aia.gxi())?h.setValue(Lc.a.HUa,n):this.FXc(b,h,!0);return!0}vtj(b){if(!b)return!1;var h=
b.getValue(Lc.a.f7a);if(!h)return!1;h=Object(sb.b)(h);b=b.getValue(Lc.a.dMb);return(0==h||1==h)&&b!==Tj.Khi}}ud.loh=!1;Object(u.a)(ud,"ContentControlGraphManager",null,[391]);class Ud{constructor(b,h,n,B,L,ba,la,La,fb,Cb){this.pOe=Cb;this.Eoa=null;this.Ann=(Lb,$b)=>{if(this.l0)return this.Bnn(Lb,$b);if(!Lb||!Lb.count)return x.ULS.sendTraceTag(17356048,368,15,"The GNC list should not be null or empty"),!1;let tc=!0;switch($b){case 0:$b=this.mN(Lb.J(0),Lb.J(Lb.count-1),1);if((Lb=this.mN(Lb.J(0),Lb.J(Lb.count-
1),3))&&0<Lb.count){if(!Lb.J(0).isSupported||!Lb.J(0).isEditable){tc=!1;break}for(Lb=Lb.J(0);Lb;)this.Ikd($b,Lb.id),Lb=this.getById(Lb.parentId)}if($b)for(var Nc of $b)if(!Nc.isSupported||!Nc.isEditable){tc=!1;break}break;case 1:if(Lb.J(0).contextId!==oc.a.Xc){x.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");tc=!1;break}($b=this.mN(Lb.J(0),Lb.J(0),1))&&0<$b.count&&(tc=!1);break;case 2:if(Lb.J(0).contextId!==oc.a.Xc){x.ULS.sendTraceTag(17424994,
368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");tc=!1;break}($b=this.mN(Lb.J(0),Lb.J(0),3))&&0<$b.count&&(tc=!1);break;case 3:case 4:$b=this.x7d(Lb.J(0),!0);Nc=this.x7d(Lb.J(Lb.count-1),!1);if(!$b||!Nc){x.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");tc=!1;break}if(($b=this.mN($b,$b,3))&&0<$b.count){tc=!1;break}if(($b=this.mN(Nc,Nc,3))&&0<$b.count){tc=!1;break}if($b=
this.Wm.mN(Lb.J(0),Lb.J(Lb.count-1),1))for(const dd of $b)if(!dd.Nla){tc=!1;break}break;default:tc=!1}return tc};Ud.Oy=b;Ud.Ei=h;this.hh=n;this.Dr=B;this.Wm=L;this.x5=ba;this.Aia=la;this.hg=La;this.Bp=fb}get nXa(){return!!this.hg.instance&&this.hg.instance.nXa}get Dta(){return!!this.hg.instance&&this.hg.instance.Dta}get Lde(){return!!this.hg.instance&&this.hg.instance.Lde}get l0(){return!!this.hg.instance&&this.hg.instance.l0}get Ode(){return!!this.hg.instance&&this.hg.instance.Ode}MSb(){return!!this.hg.instance&&
this.hg.instance.MSb}Nqa(b,h,n=null,B=null,L=!1){if(!this.nXa)return{returnValue:2,id:0};b=this.hh.Dsa(b,!0);h=this.hh.Dsa(h,!1);if(!b||!h)return{returnValue:2,id:0};b=Nd.a.create(b);h=Nd.a.create(h);return this.YMh(b,h,n,B,L,0,!1)}$Uk(b,h,n=0,B=!1){return this.nXa&&b&&h?this.YMh(b,h,null,null,!1,n,B):{returnValue:2,id:0}}U5a(b,h=null,n=0,B=!1){let L=0;if(!this.nXa)return{returnValue:2,id:L};const ba=this.x5.rMb(h,Ud.Oy,Ud.Ei,this.hh,this.Dr,this.Wm,this.Aia,this.nXa,this.Lde);ba.type=n;ba.start=
b;ba.end=b;ba.pv=b.node.id;ba.MA=b.node.id;ba.fg=!1;return this.Wm.ZNh(ba,h,B)?(L=ba.id,{returnValue:0,id:L}):{returnValue:2,id:L}}SVk(b,h=null){if(!this.nXa||!this.Kjn(b))return{returnValue:2,id:0};var n=b.J(0).contextId===oc.a.Vc?b.J(1):b.J(0);const B=b.J(b.count-1);if(this.Grf(b,oc.a.paragraph)||this.Grf(b,oc.a.Vc)){b=n.node.id;let L=B.node.id;const ba=b.equals(L);n=this.Wm.bXj(n,!0);void 0!==n&&null!==n&&(b=n,L=ba?b:L);this.Wm.bXj(B,!1);h.setValue(Lc.a.xba,!0);return this.Nqa(b,L,h)}return n!==
B||n.contextId!==oc.a.Bd&&n.contextId!==oc.a.Xc?{returnValue:2,id:0}:(h.setValue(Lc.a.xba,!1),this.U5a(n,h))}getById(b){if(!this.Dta)return null;const h=this.hh.s3c(this.hh.jBa(),n=>n.getValue(Lc.a.Iw)===b,!0);return 0<h.count?this.Wm.BR(h.J(0)):null}getByTitle(b){if(!this.Dta)return null;const h=this.hh.s3c(this.hh.jBa(),B=>B.ja(Lc.a.Jnb,null)===b,!1),n=new ob.a;for(const B of h)n.add(this.Wm.BR(B));return n}getByTag(b){if(!this.Dta)return null;const h=this.hh.s3c(this.hh.jBa(),B=>B.ja(Lc.a.Nnb,
null)===b,!1),n=new ob.a;for(const B of h)n.add(this.Wm.BR(B));return n}mN(b,h,n,B=!1){return this.Dta?this.l0?this.Wm.Fsa(b,h,n):this.Wm.mN(b,h,n,B):null}gX(b,h){return this.Wm.gX(b,h)}Tgm(){if(!this.Dta)return null;const b=this.hh.s3c(this.hh.jBa(),()=>!0,!1),h=new ob.a;for(const n of b)h.add(this.Wm.BR(n));return h}mZb(b){if(!this.nXa)return x.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),2;b=this.getById(b);return this.Wm.VDa(b)?0:2}NPl(b){if(!this.nXa)return 2;
b=this.getById(b);return this.Wm.deleteContentControl(b)?0:2}kWk(b){this.Wm.CAj(b)}tcl(b){this.Eoa=b;this.Eoa.avo(this.Ann)}anm(b){if(!this.MSb())return null;let h;var n=b.TG();h=this.x7d(n.J(n.count-1),!1);n=this.Dr.Ikc(n.J(n.count-1).node,h.cpBegin).Hb;b=this.FNm(n,b);if(-1===b)return null;h.Fb=b;h.Tb=h.Fb;return h}Bnn(b,h){if(!b||!b.count)return x.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(h){case 0:return this.Nhn(b);case 3:case 4:case 6:return this.Ipn(b,
6===h);case 1:case 2:case 5:return 1!==b.count||b.J(0).contextId!==oc.a.Xc?(x.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.FZi(b.J(0),5===h,!1);default:return!1}}Nhn(b){const h=this.Wm.Fsa(b.J(0),b.J(b.count-1),3);if(h&&0<h.count){var n=h.J(0);if(!n.isSupported||!n.isEditable)return!1}b=this.Wm.Fsa(b.J(0),b.J(b.count-1),1);for(n=0;h&&n<h.count;n++)this.Ikd(b,h.J(n).id);if(b)for(const B of b)if(!B.isSupported||
!B.isEditable)return!1;return!0}Ipn(b,h){var n=b.J(0),B=b.J(b.count-1),L=n.lk,ba=B.Ep;if(-1===L||-1===ba)return!1;L=this.Bp.aba(n.node,L,n.Fb);ba=this.Bp.aba(B.node,ba,B.Tb);var la=-1,La=Math.min(L.count,ba.count);for(--La;0<=La;La--){const fb=L.J(La).pe,Cb=ba.J(La).pe;if(fb.equals(Cb)){la=La;break}}if(-1<la&&(La=this.Wm.BR(L.J(la).Ud),!La.isEditable||!La.isSupported||La.RL&&!this.ohn(La,b)))return!1;n=this.Wm.Fsa(n,B,1);for(B=0;B<=la;B++)this.Ikd(n,this.Wm.BR(L.J(B).Ud).id);for(B=la+1;B<L.count;B++){La=
this.Wm.BR(L.J(B).Ud);if(!La.isEditable||!La.Nla||!La.isSupported||La.RL)return!1;this.Ikd(n,La.id)}for(L=la+1;L<ba.count;L++){la=this.Wm.BR(ba.J(L).Ud);if(!la.isEditable||!la.Nla||!la.isSupported||la.RL)return!1;this.Ikd(n,la.id)}if(n)for(const fb of n)if(!fb.isSupported||!fb.Nla)return!1;return h&&(b=this.x7d(b.J(0),!0))?this.FZi(b,!0,!0):!0}ohn(b,h){h=this.Bp.UEm(h.J(0),h.J(h.count-1));return!!b&&!!h&&b.objectId.equals(h.pe)}FZi(b,h,n){return(b=this.Wm.Fsa(b,b,3))&&0<b.count&&(b=b.J(0),!b.isSupported||
!b.isEditable||!this.Ode&&h&&!b.fg||!n&&b.RL||hn.a.flg&&h&&1===b.type)?!1:!0}x7d(b,h){if(!b)return null;let n=null;switch(b.contextId){case oc.a.paragraph:n=h?Nd.a.Tc(b.node,0):Nd.a.zx(b.node);break;case oc.a.Vc:n=Nd.a.zx(b.node);break;case oc.a.Bd:n=h?Nd.a.Tc(b.node,b.cpBegin):Nd.a.Tc(b.node,b.cpEnd);break;case oc.a.Xc:n=b}n&&(n.Tb=n.Fb=h?b.Fb:b.Tb);return n}Ikd(b,h){if(b)for(const n of b)if(n.id===h){b.remove(n);break}}FNm(b,h){if(!b)return-1;let n=-1;for(let B=0;B<b.length;B++)if(b.J(B).pe.equals(h.objectId)&&
!1===b.J(B).Wc){n=B;if(h.fg&&0<B&&b.J(B-1).fg&&!b.J(B-1).Wc)return-1;break}return n}Kjn(b){if(void 0===b||null===b)return!1;for(let h=0;h<b.count;h++){const n=b.J(h).contextId;if(n!==oc.a.paragraph&&n!==oc.a.Vc&&n!==oc.a.Bd&&n!==oc.a.Xc||0<h&&h<b.count-1&&n===oc.a.Bd&&(b.J(h).cpBegin||b.J(h).cpEnd!==b.J(h).node.characterData.length))return!1}return b.J(0).contextId===oc.a.Vc&&1===b.count||this.Grf(b,oc.a.Xc)&&1<b.count?!1:!0}Grf(b,h){for(const n of b)if(n.contextId===h)return!0;return!1}YMh(b,h,n=
null,B=null,L=!1,ba=0,la=!1){let La=0;var fb=h.node;let Cb=Nd.a.create(b.node);fb=Nd.a.create(fb);if(!({vXj:Cb,iki:fb}=this.pOe.n2h(Cb,fb)).success)return{returnValue:2,id:La};const Lb=this.x5.rMb(n,Ud.Oy,Ud.Ei,this.hh,this.Dr,this.Wm,this.Aia,this.nXa,this.Lde);Lb.type=ba;Lb.start=b;Lb.end=h;Lb.pv=Cb.node.id;Lb.MA=fb.node.id;Lb.fg=!0;Lb.n0d=B;Lb.Xyf=L;return this.Wm.ZNh(Lb,n,la)?(La=Lb.id,{returnValue:0,id:La}):{returnValue:2,id:La}}}Ud.Oy=null;Ud.Ei=null;Object(u.a)(Ud,"ContentControlManager",null,
[235]);var Id=d(669),Ee=d(161),kf=d(201);class Ke extends Sys.EventArgs{constructor(b){super();this.Wci=b}}Object(u.a)(Ke,"ContentControlChangeEventArgs",Sys.EventArgs,[]);var dh=d(1557);class $h{constructor(){this.vhj=0;this.Vrj=null}}Object(u.a)($h,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,[]);const rj=b=>!(null===b||void 0===b?0:b.length),zl=b=>null==b?!1:[...b].some(h=>h.Wc),Wl=b=>null==b?!1:[...b].some(h=>!h.Wc);class Rh{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd,
Hd,xe,je,he,fe,De,gg,eg,vl,wl){this.Lj=vl;this.aBh=[];this.R5e=[];this.Oy=b;this.Ei=h;this.hh=n;this.Dr=B;this.x5=L;this.Ge=fb;this.fy=Cb;this.hb=ba;this.tG=la;this.lHa=La;this.Aia=Nc;this.FJb=dd;this.uja=Lb;this.JK=$b;this.ga=tc;this.Bp=Hd;this.hg=xe;this.hi=je;this.jb=he;this.Pc=fe;this.AKh=De;this.xd=gg;this.qh=eg;this.JK&&(this.JK.addHandler(Id.a.lZb,Object(z.a)(this,this.poj,"onShowingPlaceholder")),this.JK.addHandler(Id.a.xue,Object(z.a)(this,this.tnj,"onRemoveWhenEdited")),wl.execute(Sm=>{this.qG=
Sm}))}get lv(){return this.Oy.value}get Ej(){return this.Ei.value}get l0(){return!!this.hg.instance&&this.hg.instance.l0}get A3(){return!!this.xd&&this.xd.isFeatureEnabled(28)}dispose(){this.JK&&(this.JK.removeHandler(Id.a.lZb,Object(z.a)(this,this.poj,"onShowingPlaceholder")),this.JK.removeHandler(Id.a.xue,Object(z.a)(this,this.tnj,"onRemoveWhenEdited")))}mN(b,h,n,B=!1){if(this.l0)return this.Fsa(b,h,n);if(!b||!h)return null;const L=this.hh.Dsa(b.node.id,!0);var ba=this.hh.Dsa(h.node.id,!1);if(!L||
!ba)return null;b=b.contextId===oc.a.Vc?b:Nd.a.Tc(L,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===oc.a.Vc?h:Nd.a.Tc(ba,-1===h.cpEnd?ba.characterData.length:h.cpEnd);ba=null;switch(n){case 0:ba=this.prm(b,h);break;case 1:ba=this.dFm(b,h);break;case 3:ba=this.rEi(b,h,B);break;case 2:ba=this.FOm(b,h);break;case 4:ba=this.FIf(b,h,!1)}return ba}Fsa(b,h,n){if(!b||!h||b.contextId!==oc.a.Vc&&(b=this.e8h(b,!0),!b)||h.contextId!==oc.a.Vc&&(h=this.e8h(h,!1),!h))return null;let B=null;switch(n){case 0:B=this.qrm(b,
h);break;case 1:B=this.eFm(b,h);break;case 3:B=this.sEi(b,h);break;case 2:B=this.GOm(b,h);break;case 4:B=this.FIf(b,h,!0)}return B}e8h(b,h){var n=this.hh.Dsa(b.node.id,h);if(!n)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Fb):(h=-1===b.cpEnd?n.characterData.length:b.cpEnd,b=b.Tb);n=Nd.a.Tc(n,h);n.Fb=b;n.Tb=b;return n}prm(b,h){const n=new ob.a;if(b.contextId===oc.a.Vc||h.contextId===oc.a.Vc||b.equals(h))return n;const B=new Vn.a,L=this.oPb(b,b),ba=this.oPb(h,h);for(let la=0;la<L.count;la++)if(L.J(la).Wc)for(let La=
0;La<ba.count;La++)ba.J(La).Wc||L.J(la).pe.equals(ba.J(La).pe)&&(!L.J(la).fg||this.hh.KXa(L.J(la).pe,b.node.id,!0)&&this.hh.KXa(ba.J(La).pe,h.node.id,!1))&&this.bRd(n,B,L.J(la).pe);return n}qrm(b,h){const n=new ob.a;if(b.contextId===oc.a.Vc||h.contextId===oc.a.Vc||b.equals(h)&&b.Fb===b.Tb||-1===b.Fb||-1===h.Tb)return n;var B=b.node.qa.sh(b.cpBegin),L=h.node.qa.sh(h.cpEnd);B&&B.Hb&&0<B.Hb.length&&b.Fb<=B.Hb.length&&L&&L.Hb&&0<L.Hb.length&&h.Tb<=L.Hb.length&&(b=b.Fb,h=h.Tb,b===B.Hb.length&&b--,0<h&&
h--,B=B.Hb.J(b),L=L.Hb.J(h),B.Wc&&!L.Wc&&S.a.Bt(B.pe,L.pe)&&B.lq&&L.lq&&(L=B.Ud)&&n.add(this.BR(L)));return n}dFm(b,h){const n=new ob.a,B=new Vn.a,L=this.oPb(b,h);for(let ba=0;ba<L.count;ba++)this.bRd(n,B,L.J(ba).pe);b=this.rEi(b,h,!1,!1);for(const ba of b)B.contains(ba.objectId)||(n.add(ba),B.add(ba.objectId));return n}eFm(b,h){const n=new ob.a,B=new Vn.a,L=this.LHf(b,h);for(let ba=0;ba<L.count;ba++)this.Jef(n,B,L.J(ba));b=this.sEi(b,h);for(const ba of b)B.contains(ba.objectId)||(n.add(ba),B.add(ba.objectId));
return n}rEi(b,h,n,B=!0){const L=new ob.a;b.equals(h)&&(n=!1);const ba=new Vn.a;let la=!1;b=this.oPb(null,b,!0,n);h=this.oPb(h,null,n,!0);for(n=b.count-1;0<=n;n--){for(let La=0;La<h.count&&!(b.J(n).pe.equals(h.J(La).pe)&&(b.J(n),this.bRd(L,ba,b.J(n).pe)&&(la=!this.hh.Bu(b.J(n).pe).ja(Lc.a.xaa,null),B||la)));La++);if(0<L.count&&(B||la))break}return L}sEi(b,h){const n=new ob.a,B=new Vn.a,L=b.node;var ba=h.node;const la=h.contextId===oc.a.Vc?ba.characterData.length:h.cpEnd;b=this.Bp.aba(L,b.contextId===
oc.a.Vc?L.characterData.length:b.cpBegin,b.Fb);h=this.Bp.aba(ba,la,h.Tb);ba=b.count>h.count?h.count:b.count;for(--ba;0<=ba;ba--)b.J(ba).pe.equals(h.J(ba).pe)&&this.Jef(n,B,b.J(ba));return n}FOm(b,h){const n=new ob.a;let B=new Vn.a;const L=this.oPb(b,h);let ba=0,la=null;if(b.equals(h))return n;for(b=0;b<L.count;b++)!L.J(b).Wc||L.J(b).fg&&!this.hh.KXa(L.J(b).pe,L.J(b).Jb.paragraph.id,!0)?L.J(b).Wc||L.J(b).fg&&!this.hh.KXa(L.J(b).pe,L.J(b).Jb.paragraph.id,!1)||(ba--,0>ba?(ba=0,B=new Vn.a):!ba&&la&&L.J(b).pe.equals(la)&&
this.bRd(n,B,la)):(ba||(la=L.J(b).pe),ba++);return n}GOm(b,h){const n=new ob.a;if(b.equals(h)&&b.Fb===h.Tb)return n;let B=new Vn.a;b=this.LHf(b,h);h=0;let L=null;for(let ba=0;ba<b.count;ba++){const la=b.J(ba);!la.Wc||la.fg&&!this.hh.KXa(la.pe,la.Jb.paragraph.id,!0)?la.Wc||la.fg&&!this.hh.KXa(la.pe,la.Jb.paragraph.id,!1)||(h--,0>h?(h=0,B=new Vn.a):!h&&L&&la.pe.equals(L.pe)&&this.Jef(n,B,L)):(h||(L=la),h++)}return n}FIf(b,h,n){const B=new ob.a;b=n?this.LHf(b,h):this.oPb(b,h);h=0;for(n=0;n<b.count;n++){var L=
b.J(n);L.lq&&(L.Wc?h++:(h--,0>h?h=0:(L=this.BR(L.Ud))&&B.add(L)))}return B}oPb(b,h,n=!0,B=!0){const L=new ob.a,ba=this.gX(b,h);if(!ba.count)return L;let la,La,fb,Cb;for(let Lb=0;Lb<ba.count;Lb++){la=0;La=ba.J(Lb).characterData.length;fb=Cb=!0;if(b&&ba.J(Lb).id.equals(b.node.id)){if(b.contextId===oc.a.Vc)continue;0<=b.cpBegin&&(la=b.cpBegin)}h&&ba.J(Lb).id.equals(h.node.id)&&0<=h.cpEnd&&(La=h.cpEnd);Lb||(fb=n);Lb!==ba.count-1||h&&h.contextId===oc.a.Vc||(Cb=B);L.addRange(this.MHf(ba.J(Lb),la,La,fb,
Cb))}return L}LHf(b,h){const n=new ob.a,B=this.gX(b,h);let L,ba,la;for(let fb=0;fb<B.count;fb++){const Cb=B.J(fb);if(Cb.qa.length){var La=Cb.qa.J(Cb.qa.length-1);L=0;ba=Cb.characterData.length;la=0;La=La&&La.Hb?La.Hb.length:0;b&&Cb.id.equals(b.node.id)&&(L=b.lk,la=b.Fb);h&&Cb.id.equals(h.node.id)&&(ba=h.Ep,La=h.Tb);n.addRange(this.NHf(Cb,L,ba,la,La))}}return n}MHf(b,h,n,B=!0,L=!0,ba=!0){const la=new ob.a;b=b.qa;for(let La=0;La<b.length;La++){if(b.J(La).cp<h)continue;if(b.J(La).cp>n)break;const fb=
b.J(La);if(fb.Hb&&0<fb.Hb.length&&(fb.cp!==h||B)&&(fb.cp!==n||L))for(let Cb=0;Cb<fb.Hb.length;Cb++){const Lb=fb.Hb.J(Cb);(ba||Lb.Wc)&&la.add(Lb)}}return la}NHf(b,h,n,B,L){const ba=new ob.a;b=b.qa;for(let la=0;la<b.length;la++){if(b.J(la).cp<h)continue;if(b.J(la).cp>n)break;const La=b.J(la);if(La.Hb&&0<La.Hb.length){let fb=0,Cb=La.Hb.length;La.cp===h&&-1!==B&&(fb=B);for(La.cp===n&&-1!==L&&(Cb=L);fb<Cb&&fb<La.Hb.length;fb++)ba.add(La.Hb.J(fb))}}return ba}bRd(b,h,n){let B=null;if(h.contains(n)||!(B=
this.Ej.Eb(n)))return!1;b.add(this.BR(B));h.add(n);return!0}Jef(b,h,n){let B=null;!h.contains(n.pe)&&(B=n.Ud)&&(b.add(this.BR(B)),h.add(n.pe))}D3j(b,h){let n,B=!1;n=({qcb:h,pcb:b,mpd:B}=this.E3j(b,h,!1,B)).returnValue||B;B&&(n=n||({qcb:h,pcb:b,mpd:B}=this.E3j(h,b,!0,B)).returnValue);return{returnValue:n,qcb:h,pcb:b}}E3j(b,h,n,B){let L,ba;if(n)return L=ba=null,{returnValue:!1,qcb:ba,pcb:L,mpd:!1};let la=!1;ba=b;L=h;const La=b.cpBegin,fb=h.cpEnd;B=!1;var Cb=n?this.pti(h):this.hhm(b);let Lb=!1,$b=!1,
tc=0,Nc=0;for(const dd of Cb)for(Cb=0;Cb<dd.qa.length;Cb++){const Hd=dd.qa.J(Cb);!$b&&dd.id.equals(h.node.id)&&($b=!0);if(!Lb&&(dd.id.equals(h.node.id)&&-1!==fb&&Hd.cp>fb||$b&&!dd.id.equals(h.node.id)))if(Lb=!0,tc!==Nc)la=!0;else return{returnValue:!1,qcb:ba,pcb:L,mpd:B};if((!dd.id.equals(b.node.id)||Hd.cp>=La||-1===La)&&Hd.Hb)for(let xe=0;xe<Hd.Hb.length;xe++){const je=Hd.Hb.J(xe),he=this.Ej.Eb(je.pe);if(!he.getValue(Lc.a.xba)||(!je.Wc||this.hh.KXa(this.qh.pr(he.id,!0),dd.id,!0))&&(je.Wc||this.hh.KXa(this.qh.pr(he.id,
!1),dd.id,!1))){je.Wc?tc++:tc--;if(la&&tc===Nc)return{qcb:ba,pcb:L}=this.xEl(b.node,dd,b.cpBegin,Hd.cp),{returnValue:!0,qcb:ba,pcb:L,mpd:B};!n&&tc<Nc&&(B=!0,Nc--)}}}return{returnValue:la,qcb:ba,pcb:L,mpd:B}}xEl(b,h,n,B){let L;h.id.equals(b.id)?b=0<n||B<ea.ParagraphReader.textLength(h)?L=Nd.a.createTextRange(h,n,B):L=Nd.a.create(h):(L=0<n?Nd.a.createTextRange(b,n,ea.ParagraphReader.textLength(b)):Nd.a.create(b),b=B<ea.ParagraphReader.textLength(h)?Nd.a.createTextRange(h,0,B):Nd.a.create(h));return{qcb:L,
pcb:b}}LAm(b){const h=b.cpBegin,n=this.pti(b);for(let L=n.count-1;0<=L;L--){const ba=n.J(L);for(let la=ba.qa.length-1;0<=la;la--){const La=ba.qa.J(la);if((!ba.id.equals(b.node.id)||La.cp<=h||-1===h&&!La.cp)&&La.Hb){var B=La.Hb.length-1;for((La.cp===h||-1===h&&!La.cp)&&this.l0&&ba.id.equals(b.node.id)&&(B=b.Fb-1);0<=B;B--){const fb=La.Hb.J(B),Cb=this.Ej.Eb(fb.pe);if(fb.Wc){if(Cb.getValue(Lc.a.xba)&&!this.hh.KXa(this.qh.pr(Cb.id,!0),ba.id,!0))continue;return null}if(!Cb.getValue(Lc.a.xba)||this.hh.KXa(this.qh.pr(Cb.id,
!1),ba.id,!1))return this.BR(Cb)}}}}return null}BR(b){if(!b)return null;this.hh.$Nb();return this.x5.rMb(b,this.Oy,this.Ei,this.hh,this.Dr,this,this.Aia,this.uja,this.FJb)}gX(b,h){b=this.oti(b,h,Rh.XPb(12));if(!b)return null;h=new ob.a;for(const n of b)h.add(n);return h}fhm(b,h){const n=Rh.Vwm();return this.oti(Nd.a.create(b.node),Nd.a.create(h.node),n)}oti(b,h,n){if(!n||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var B=b.node;if(B&&n(B)){var L;return L=new ob.a,L.add(B),
L}}B=Object.assign(new $h,{vhj:35,Vrj:n});b=b?b.node:null;h=h?h.node:null;L=this.pJm(b,h);if(!L)return null;h=this.h3k(h,n,Rh.TYh,B);return this.bhm(b,h,L,n,Rh.TYh,B)}pJm(b,h){return(b=b?this.bBi(b):this.bBi(h))?b.ld(35):this.hh.NDm()}h3k(b,h,n,B){if(!b)return null;h(b)||(h=this.chm(b,h,n,B),h.count&&(b=h.J(h.count-1)));return b}bhm(b,h,n,B,L,ba){b?(b=ve.GraphIterator.eb(b),b.zb(7),n=Ff.a.Ft(b,n)):n=Ff.a.iq(n);L&&n.vp(L,ba);for(L=new ob.a;n.moveNext()&&(B(n.currentNode)&&L.add(n.currentNode),!h||
!n.currentNode.id.equals(h.id)););return L}chm(b,h,n,B){b=Ff.a.iq(b);n&&b.vp(n,B);for(n=new ob.a;b.moveNext();)h(b.currentNode)&&n.add(b.currentNode);return n}bBi(b){b=ve.GraphIterator.eb(b);return b.zb(35)?b:null}WNi(b,h){b=this.gX(b,h);for(const n of b)if((b=this.hh.eLf(n))&&b.wla(4))return!0;return!1}ZNh(b,h=null,n=!1){if(!b)return!1;var B=b.start,L=b.end;if(!re.SelectionEditor.mw(B)&&B.contextId!==oc.a.paragraph||!re.SelectionEditor.mw(L)&&L.contextId!==oc.a.paragraph||!this.l0&&({qcb:B,pcb:L}=
this.D3j(b.start,b.end)).returnValue||this.l0&&!({start:B,end:L}=this.$kl(B,L)).returnValue)return!1;b.start=B;b.end=L;const ba=this.Yhn(B,L);if(this.l0){var la=this.Fsa(b.start,b.end,3);var La=this.Fsa(b.start,b.end,2)}else la=this.mN(b.start,b.end,3),La=this.mN(b.start,b.end,2);const fb=la&&0<la.count?la.J(0):null,Cb=La&&0<La.count?La.J(0):null;if(n)return this.c9c(b,0,la)?!0:!1;if(this.c9c(b,0,la)){n=(n=Object(ya.a)(dc,this.LAm(b.start)))?this.hh.Bu(n.objectId):null;La=this.hh.TVk(b,fb,n,La,b.pv,
b.MA,h);this.Lj.trc(La);if(b.fg)for(L=this.gX(b.start,b.end),n=0;n<L.count;n++)if(this.l0){la=fb?fb.objectId:null;const Lb=this.GAi(la,L.J(n),!0);this.Dr.bza(L.J(n),La.id,0,!0,!0,void 0,void 0,void 0,void 0,Lb);la=this.GAi(la,L.J(n),!1);this.Dr.bza(L.J(n),La.id,L.J(n).characterData.length,!0,!1,void 0,void 0,void 0,void 0,la)}else this.Dr.bza(L.J(n),La.id,0,!0,!0),this.Dr.bza(L.J(n),La.id,L.J(n).characterData.length,!0,!1);else this.l0?(n=-1===B.Fb?0:B.Fb,this.Dr.bza(b.start.node,La.id,B.cpBegin,
!1,!0,void 0,void 0,void 0,void 0,n),this.Dr.bza(b.end.node,La.id,L.cpEnd,!1,!1,void 0,void 0,void 0,void 0,ba?n+1:L.Tb)):(this.Dr.bza(b.start.node,La.id,b.start.cpBegin,!1,!0),this.Dr.bza(b.start.node,La.id,b.start.cpEnd,!1,!1));h||this.hh.oSo(La,b.fg,b.id,this.hh.wlc(this.hh.Bu(b.pv)),b.type);1===b.type&&this.Dr.Mrp(b.start.node,B.lk,B.Ep);h=!(hn.a.Qec&&8===b.type);b.objectId=La.id;B=this.hh.jBa().currentNode;h&&!B.hasProperty(Lc.a.OWc)&&B.setValue(Lc.a.OWc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);
h&&hn.a.pga&&this.hh.t7j(WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,La);fb&&this.G8j(fb.Ud,b);Cb&&this.G8j(La,Cb);h&&ba&&this.ga.Pb(wb.a.Jpd,2,b.id);hn.a.Qec&&8===b.type&&this.YMj(!1,b,La);dh.a.t7h()&&this.qG&&this.qG.fireEvent(3,{node:La});return!0}return!1}deleteContentControl(b){if(!this.c9c(b,3))return x.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),!1;if(this.Lj.Rsd(b.Ud))return!0;b.RL&&(b.RL=!1);const h=this.hb.gb.currentSelection;b=b.TG();const n=
new gn.Selection(b.toArray(),!0);let B=!1;this.hb.d_b(()=>{this.hb.Ic(n);if(32===this.ga.Ob(wb.a.SJ,2)){if(this.AKh.instance){const L=this.AKh.instance.xCi(h,n,this.hb.gb.currentSelection);this.hb.Ctp(new Ee.SelectionCollection([L],0))}B=!0}});return B}VDa(b,h=!1,n=!1){if(this.c9c(b,2)){if(b.RL)return x.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(b);const B=hn.a.As?b.Ud:this.hh.Bu(b.objectId);let L=new ob.a;h&&(L=b.YGf());
L.add(b);if(n||!this.Lj.Rsd(b.Ud)){B&&B.anchor&&this.hh.Bei(B,h);for(const ba of L)b=this.gX(ba.start,ba.end),this.Dr.XPl(b,ba.objectId);this.Rxj(L)}x.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}x.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}YAg(b,h){if(this.c9c(b,1)){let La=!1;h||(La=!0,{Y2o:n,returnValue:h}=this.wQb(b),n&&this.hh.jBa().currentNode.setValue(Lc.a.OWc,h));var n=b.svi().toArray();for(var B=0;B<n.length;B++)this.VDa(n[B],
!0);n=this.Iap(h);if(b.fg){B=this.gX(b.start,b.end);if(!B.count)return!1;if(1===B.count&&A.AFrameworkApplication.$u)this.Dr.Ne(Nd.a.createTextRange(B.J(0),0,B.J(0).characterData.length),h);else{var L=this.hh.XEm(B.J(0));h=B.J(0).Ajc();B=this.hh.Sei(B);B=this.hh.nOh(L,B,n.length);for(L=0;L<B.count;L++){this.Dr.Ne(Nd.a.createTextRange(B.J(L),0,0),n[L],void 0,b.type);for(var ba=0;ba<h.count;ba++)this.Dr.bza(B.J(L),h.J(ba),0,!0,!0),this.Dr.bza(B.J(L),h.J(h.count-ba-1),B.J(L).characterData.length,!0,!1)}b.Jzp(B.J(0).id,
B.J(B.count-1).id);n=this.tG.se(B.J(0),0);this.hb.Ic(n)}}else{L=0;1<n.length&&x.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");h=b.start;B=h.node;for(var la=0;la<B.qa.length&&h.contextId===oc.a.Bd;la++)if(ba=B.qa.J(la),ba.cp===h.cpBegin&&ba.blob){L++;for(la+=1;la<B.qa.length;la++)if(ba=B.qa.J(la),ba.cp>h.cpBegin&&ba.cp<=h.cpEnd)if(ba.blob)L++;else break;else if(ba.cp>h.cpEnd)break;break}if(0<L&&L+h.cpBegin<h.cpEnd)B=Nd.a.createTextRange(h.node,
h.cpBegin,h.cpBegin+L),h=Nd.a.createTextRange(h.node,h.cpBegin+L,h.cpEnd),this.Dr.Ne(h,n[0]),this.Dr.Ne(B,"");else if(0<L&&L+h.cpBegin===h.cpEnd)for(this.Dr.Ne(b.start,n[0]),n=0;n<B.qa.length;n++){if(L=B.qa.J(n),L.cp===h.cpBegin){L.blob=null;break}}else A.AFrameworkApplication.$u?(n=n.join(" "),this.Dr.Ne(b.start,n)):this.Dr.Ne(b.start,n[0],void 0,b.type)}this.sKb(b,La);let fb;this.Ulo((fb=new ob.a,fb.add(b),fb));return!0}return!1}sKb(b,h){const n=this.Dr.Ikc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:
0);if(n){const L=this.hh.Bu(b.objectId);if(h){h=this.fy.EF(b.start.node);var B=h.gh(Xr.a.Ykg);B||(ok.a.ei.qr?(B=h.uy().zBa(Xr.a.xtj),B=h.gh(this.fy.Ae(B))):B=h.XKa(Xr.a.xtj));B&&(this.Ge.Zja(n.formatting),this.Ge.oeb(n.formatting,B));L&&(b.RL=!0)}else L&&b.RL&&(this.bHo(b,n),b.RL=!1)}else x.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control")}bHo(b,h){b=this.hh.Bu(b.objectId);let n=null;b&&(n=b.ja(Lc.a.fMb,S.a.nil));this.Ge.Zja(h.formatting);n&&!n.equals(S.a.nil)&&
(b=this.Ei.value.Eb(n),h.formatting=b)}wQb(b){let h=!1;b=b.placeholderText;this.Hrn(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,h=!0);return{returnValue:b,Y2o:h}}Nwo(b,h=!0){this.uja&&(h&&this.Jwo(b),this.Two(b))}Owo(b){if(this.uja&&(b=this.mN(b,b,4)))for(const h of b)this.VDa(h,!1)}oWn(b,h){if(h&&!b.Wc&&(this.hh.$Nb(),(b=b.Jb.paragraph.Lc.Eb(b.pe))&&b.anchor)){this.hh.Bei(b);b=this.x5.rMb(b,this.Oy,this.Ei,this.hh,this.Dr,this,this.Aia,this.uja,this.FJb);let n;this.Rxj((n=
new ob.a,n.add(b),n))}}tnj(b,h){this.hh.$Nb();b=this.hh.Bu(h.pe);const n=this.BR(b);if(n&&n.isValid()&&n.removeWhenEdited){const B=this.Pc.Mc(7);B.Ab(b);this.VDa(n,!1);h.state=2;B.dispose()}}poj(b,h){this.hh.$Nb();b=this.hh.Bu(h.pe);this.Vfn(b)&&(b=b.ja(Lc.a.Iw,0),this.ga&&(this.ga.Pb(wb.a.Jpd,2,b),Rh.Md.Lhf()))}Vfn(b){return b&&b.isConnected&&!b.ja(Lc.a.yaa,!1)?hn.a.As?this.Nde(b)&&!b.Tv:this.Nde(b):!1}Nde(b){b=this.x5.rMb(b,this.Oy,this.Ei,this.hh,this.Dr,this,this.Aia,this.uja,this.FJb);if(!b.isValid())return!1;
if(b.fg){if(b.pv.toString()===b.MA.toString()){var h=this.hh.Bu(b.pv);if(!h)return x.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===h.type&&1===h.qa.length)return this.MWi(h.qa.J(0),b.objectId)}}else{h=b.start;if(!h)return x.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),!1;if(h.cpBegin===h.cpEnd)return h=this.hh.Bu(b.pv).qa.sh(h.cpBegin),this.MWi(h,b.objectId)}return!1}MWi(b,h){b=
b?b.Hb:null;if(!b)return!1;const n=b.DL(h,!0);return-1<n&&n+1<b.length&&b.J(n+1).pe.toString()===h.toString()}CAj(b){this.R5e.push(b)}bXj(b,h){if(void 0===b||null===b||b.contextId!==oc.a.Bd)return null;b=Nd.a.Tc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<ea.ParagraphReader.textLength(b.node)?this.hh.V_a(b):null}select(b,h){if(b&&!b.equals(S.a.nil)){var n=this.hh.Bu(b);if(n&&55===n.type){n=this.BR(n);if(n.fg)n=this.$im(n);else{n=n.start;if(!n)return;n.contextId=oc.a.Bd;n=this.tG.Fo(n)}if(n&&
n.length)return this.jNj(n.Ra,b,h,!0,!0),this.jNj(n.Uc,b,h,!1,!1),this.hb.Ic(n),n}}}HMo(b,h){if(!re.SelectionEditor.mf(b)||b.Fb!==b.Tb)return!1;const n=b.Fb;return-1===n?!1:(b=this.Bp.X8a(b.node,b.cpBegin,n,!h))&&h===b.Wc?(h=this.BR(b.Ud),this.select(b.pe,!h.isEditable),!0):!1}$im(b){var h=this.hh.JVa(b.pv,!0);b=this.hh.JVa(b.MA,!1);if(!h||!b)return null;h=this.fhm(Nd.a.create(h),Nd.a.create(b));if(!h||!h.count)return null;b=new ob.a;for(let n=0;n<h.count;n++){let B;if(12===h.J(n).type)B=n===h.count-
1?Nd.a.createTextRange(h.J(n),0,ea.ParagraphReader.textLength(h.J(n))):Nd.a.create(h.J(n)),this.hi&&(B.Fb=this.hi.Rr(B.node,!0),B.Tb=this.hi.Rr(B.node,!1));else if(15===h.J(n).type)B=kf.TableNodeContext.create(h.J(n));else continue;b.add(B)}return new gn.Selection(b.toArray(),!0)}KRo(b){if(b&&!b.equals(S.a.nil)&&(this.hh.$Nb(),(b=this.hh.Bu(b))&&55===b.type&&b.isConnected)){var h=b.ja(Lc.a.yaa,!1);b.setValue(Lc.a.yaa,!1);h&&this.Dro(b)}}o1j(b){if(b&&!b.equals(S.a.nil)&&(this.hh.$Nb(),(b=this.hh.Bu(b))&&
55===b.type&&b.isConnected)){var h=this.BR(b);h.isEditable&&8===h.type&&this.YMj(!h.isChecked,h,b)}}YMj(b,h,n){const {POa:B,font:L}=this.clm(b,n),ba=this.Pc.Mc(15);ba.Ab(n);h.isChecked=b;this.YAg(h,B);b=this.Dr.Ikc(h.start.node,Math.max(h.start.cpBegin,0));this.Ge.tha(b.formatting,L);ba.dispose()}clm(b,h){b?(b=h.ja(ye.a.r7h,Xr.a.PNl),h=h.ja(ye.a.q7h,Xr.a.ONl)):(b=h.ja(ye.a.z7h,Xr.a.RNl),h=h.ja(ye.a.y7h,Xr.a.QNl));b=String.fromCodePoint(Number("0x"+b));return{POa:b,font:h}}Dro(b){var h=this.qh.pr(b.id,
!0);h.equals(S.a.nil)||(h=this.hh.Dsa(h,!0))&&(b=this.Dr.BIf(h,b.id,!0))&&0<b.count&&(b=b.J(0),h=b.Jb,h.formatting=b.uR?b.uR.Bf(h):new PC.a(h,S.a.nil))}wBj(b){if(b=this.swi(b))for(const h of b)this.Lj.TBg()&&(h.RL=!1),this.VDa(h,!1)}pwi(b){const h=new ob.a;if(b=this.swi(b))for(const n of b)h.add(n.Ud);return h}Pwo(b){if(b&&(11===b.type||14===b.type||15===b.type||16===b.type)){var h=this.jb.Zl(b),n=this.jb.hD(b);if(this.hi&&h&&n){b=this.hi.Rr(h,!0);const B=this.hi.Rr(n,!1);h=Nd.a.create(h);n=Nd.a.create(n);
h.Fb=b;n.Tb=B;if(b=this.Fsa(h,n,4))for(const L of b)this.VDa(L,!1)}}}ihm(b){var h=this.qh.pr(b.id,!0,b.EI);b=this.qh.pr(b.id,!1,b.EI);if(h.equals(S.a.nil)||b.equals(S.a.nil))return new ob.a;h=this.hh.Dsa(h,!0);b=this.hh.Dsa(b,!1);return h&&b?this.gX(Nd.a.create(h),Nd.a.create(b))||new ob.a:new ob.a}JVa(b,h){return this.hh.JVa(b,h)}LKf(b,h){if(b&&55===b.type&&(b=this.BR(b),b=h?b.start:b.end)){const n=Nd.a.Tc(b.node,h?b.lk:b.Ep);n.Fb=n.Tb=(h?b.Fb:b.Tb)+(h?-1:1);return n}return null}Ymm(b){return(b=
this.BR(b))?b.start:null}jNj(b,h,n,B,L){if((b.contextId===oc.a.Bd||b.contextId===oc.a.Xc||b.contextId===oc.a.paragraph)&&(L=b.node.qa.sh(L?b.lk:b.Ep))&&L.Hb)for(let ba=0;ba<L.Hb.length;ba++){const la=L.Hb.J(ba);if(la.pe.equals(h)&&la.lq)if(B&&la.Wc){b.Fb=n?ba:ba+1;break}else if(!B&&!la.Wc){b.Tb=n?ba+1:ba;break}}}Ulo(b){for(let h=0;h<this.aBh.length;++h)(0,this.aBh[h])(this,new Ke(b))}Rxj(b){for(let h=0;h<this.R5e.length;++h)(0,this.R5e[h])(this,new Ke(b))}Two(b){b=Nd.a.create(b);if(b=this.mN(b,b,
4))for(const h of b)h.fg||this.VDa(h,!1)}Jwo(b){if(b=b.Ajc())for(let n=0;n<b.count;n++){var h=this.hh.Bu(b.J(0));h=this.x5.rMb(h,this.Oy,this.Ei,this.hh,this.Dr,this,this.Aia,this.uja,this.FJb);this.VDa(h)}}hhm(b){return this.gX(b,null)}c9c(b,h,n=null){let B=!0;try{if(!b)return x.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;x.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",h,b.isSupported,b.Nla));if(!hn.a.As&&
this.lHa&&np.a.instance.J(1)&&this.lHa.IU(this.Oy.value))return x.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.Cnn(h)&&this.Dnn(h)&&!this.Wfn(b))return!1;if(!n){const la=this.TEm(b);la&&(n=new ob.a,n.add(la))}var L=this.hh.LDi(b.start.node);const ba=this.hh.LDi(b.end.node);if(L&&ba&&!L.equals(ba)||!L&&ba||L&&!ba)return!1;L=!0;if(n&&0<n.count){if(!n.J(0).isSupported)return!1;L=n.J(0).isEditable}switch(h){case 0:B=this.jdn(b,L);break;
case 1:B=(this.A3||!this.Ree(b))&&b.isSupported&&b.isEditable&&this.lUh(b)&&this.PWi(b);A.AFrameworkApplication.$u||(B=B&&!this.WNi(b.start,b.end));break;case 2:const la=b.Msn?!0:b.isSupported;B=(this.A3||!this.Ree(b))&&la&&b.Nla&&L;x.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:B=b.isSupported&&b.Nla&&L&&this.lUh(b)&&this.PWi(b)&&!this.WNi(b.start,b.end)}}catch(ba){x.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+h+", Exception: "+ba),
B=!1}return B}Dnn(b){return!(A.AFrameworkApplication.$u&&1===b)}Cnn(b){return!(this.l0&&(!b||2===b||3===b))}jdn(b,h){if(hn.a.flg)return this.kdn(b,h);let n=!0;if(!this.A3&&this.Ree(b))n=!1;else if(this.l0)this.l0?b.fg||re.SelectionEditor.mw(b.start)||b.start.contextId===oc.a.Vc?b.fg&&(b.start.contextId!==oc.a.paragraph&&b.start.contextId!==oc.a.Vc||b.end.contextId!==oc.a.paragraph&&b.end.contextId!==oc.a.Vc)&&(n=!1):n=!1:n=h?this.$Vi(b):!1;else if(!(b.fg||-1!==b.start.cpBegin&&-1!==b.end.cpEnd&&b.start.equals(b.end)))n=
!1;else if(b.fg&&(b.start.contextId!==oc.a.paragraph||b.end.contextId!==oc.a.paragraph||b.start.equals(b.end)&&!ea.ParagraphReader.textLength(b.start.node)))n=!1;else if(b.start.contextId===oc.a.Xc||b.end.contextId===oc.a.Xc||b.start.contextId===oc.a.Vc||b.end.contextId===oc.a.Vc)n=!1;return n}kdn(b,h){return(this.A3||!this.Ree(b))&&this.ldn(b)&&this.Mjn(b)&&h&&!this.gln(b)&&this.$Vi(b)?!0:!1}Mjn(b){var h;const n=b.start,B=n.contextId,L=null===(h=b.end)||void 0===h?void 0:h.contextId;return b.fg?
B!==oc.a.paragraph&&B!==oc.a.Vc||L!==oc.a.paragraph&&L!==oc.a.Vc?!1:!0:re.SelectionEditor.mw(n)||B===oc.a.Vc?!0:!1}swi(b){if(!b||!b.length)return null;const h=b[0];b=b[b.length-1];this.hi&&(this.jb.nn(h)&&12===h.node.type&&(h.Fb=this.hi.Rr(h.node,!0)),this.jb.nn(b)&&12===b.node.type&&(b.Tb=this.hi.Rr(b.node,!1)));return this.Fsa(h,b,4)}lUh(b){b=b.YGf();for(const h of b)if(!h.isSupported||!h.Nla)return!1;return!0}Wfn(b){if(this.D3j(b.start,b.end).returnValue)return!1;const h=this.mN(b.start,b.end,
2);if(!h)return!0;for(const n of h)if(!n.objectId.equals(b.objectId)&&(n.fg&&(n.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||n.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===ea.ParagraphReader.textLength(n.end.node)))||!n.fg&&(b.start.node.id.equals(n.start.node.id)&&(-1!==b.start.cpBegin?n.start.cpBegin===b.start.cpBegin:!n.start.cpBegin)||b.end.node.id.equals(n.end.node.id)&&(-1!==b.end.cpEnd?n.end.cpEnd===b.end.cpEnd:n.end.cpEnd===ea.ParagraphReader.textLength(b.end.node)))))return!1;
return!0}PWi(b){if(b.fg){var h=this.hh.Bu(b.pv),n=this.hh.Bu(b.MA);let B=null;if(12===h.type&&12===n.type){h=this.hh.wlc(h);h=this.hh.Bu(h);n=this.hh.wlc(n);n=this.hh.Bu(n);if(!h||!n)return!1;16===h.type&&16===n.type&&h.id.equals(n.id)&&(B=h)}b=this.gX(b.start,b.end);if(!b.count)return!1;for(const L of b)if(b=this.hh.wlc(L),b=this.hh.Bu(b),!b||!(16!==b.type||B&&b.id.equals(B.id)))return!1}return!0}Ree(b){return b.fg?!1:hn.a.ykd?(b=b.start.node)?b.ja(Lc.a.Fta,!0)||b.ja(hi.a.kna,!1)?!1:!0:!0:(b=b.start.node)?
!b.ja(Lc.a.Fta,!0):!0}ldn(b){return 1!==b.type?!0:b.pv.equals(b.MA)&&ea.ParagraphReader.Xb(b.start.node)&&!this.vZm(b)?!0:!1}vZm(b){const h=b.start;var n=h.node;const B=n.qa;if(b.fg){if(n.gv||n.B7||n.hasBookmark)return!0;for(var L of B)if(this.aOi(L))return!0;return!1}b=h.lk;n=h.Ep;let ba=L=null;for(const la of B.S4i(b,n))if(!(la.cp<b))if(la.cp===b)L=la;else if(la.cp===n)ba=la;else if(this.aOi(la))return!0;return this.wZm(h,L,ba)?!0:!1}aOi(b){return rj(b.Hb)&&rj(b.kf)&&rj(b.Zh)&&rj(b.fc)&&null==b.hyperlink&&
!b.vn&&null==b.blob?!1:!0}wZm(b,h,n){if(null==h&&null==n)return!1;const B=b.Fb;b=b.Tb;return null!=h&&(h.Hb&&B<h.Hb.length||null!=h.blob)||null!=n&&n.Hb&&0<b||null!=h&&null!=n&&(zl(h.kf)&&Wl(n.kf)||zl(h.Zh)&&Wl(n.Zh)||!rj(h.fc)&&!rj(n.fc)&&[...h.fc].some(L=>0===L.ve)&&[...n.fc].some(L=>3===L.ve)||null!=h.hyperlink&&n.vn)?!0:!1}gln(b){var h,n;return(null!==(n=null===(h=this.mN(b.start,b.end,3))||void 0===h?void 0:h.toArray())&&void 0!==n?n:[]).some(B=>1===B.type)?!0:!1}$Vi(b){if(!b.fg)return!0;var h=
this.hh.Bu(b.pv);b=this.hh.Bu(b.MA);if(Ng.TableCellReader.KCa(h)||Ng.TableCellReader.KCa(b)||Le.a.gma(h)||Le.a.gma(b))return!1;h=this.hh.wlc(h);h=this.hh.Bu(h);b=this.hh.wlc(b);b=this.hh.Bu(b);return h&&b&&(16!==h.type&&16!==b.type||h.id.equals(b.id))?!0:!1}TEm(b){if(!b)return null;b=this.hh.Bu(b.objectId);if(!b)return null;b=b.ja(Lc.a.xaa,S.a.nil);return b.equals(S.a.nil)?null:(b=this.hh.Bu(b))?this.BR(b):null}pti(b){return this.gX(null,b)}Iap(b){return(b||"").split(RegExp("\r\n|\r|\n"))}Hrn(b){return b&&
""!==b?!1:!0}GAi(b,h,n){h=h.qa.sh(n?0:h.characterData.length);if(!h)return x.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Hb||!h.Hb.length)return 0;if(!b)return n?0:h.Hb.length;for(let B=0;B<h.Hb.length;B++){const L=h.Hb.J(B);if(S.a.Bt(L.pe,b)&&L.Wc===n)return n?B+1:B}return n?0:h.Hb.length}$kl(b,h){var n=b.node,B=h.node,L=b.contextId===oc.a.paragraph?0:b.cpBegin,ba=h.contextId===oc.a.paragraph?ea.ParagraphReader.textLength(B):h.cpEnd;n=this.Bp.aba(n,
L,b.Fb);B=this.Bp.aba(B,ba,h.Tb);ba=!n||!n.count;L=!B||!B.count;if(ba&&L)return{returnValue:!0,start:b,end:h};if(ba)return{returnValue:this.oEe(b,B.J(B.count-1).pe,!0),start:b,end:h};if(L)return{returnValue:this.oEe(h,n.J(n.count-1).pe,!1),start:b,end:h};if(n.count===B.count)return n=n.J(n.count-1),B=B.J(B.count-1),{returnValue:n.pe.equals(B.pe),start:b,end:h};n=(ba=n.count<B.count)?B.J(B.count-1):n.J(n.count-1);return{returnValue:ba?this.oEe(b,n.pe,!0):this.oEe(h,n.pe,!1),start:b,end:h}}oEe(b,h,
n){var B=b.node;let L;if(n){L=b.contextId===oc.a.paragraph?0:b.cpBegin;var ba=b.Fb}else L=b.contextId===oc.a.paragraph?ea.ParagraphReader.textLength(B):b.cpEnd,ba=b.Tb;B=B.qa.sh(L);if(-1===ba||!B||!B.Hb||!B.Hb.length)return!1;B=B.Hb;if(n)for(n=ba;n<B.length;n++){ba=B.J(n);if(!ba.Wc)break;if(ba.pe.equals(h))return b.Fb=n+1,!0}else for(n=ba-1;0<=n;n--){ba=B.J(n);if(ba.Wc)break;if(ba.pe.equals(h))return b.Tb=n,!0}return!1}Yhn(b,h){return this.Q9k(b,h)&&b.Fb===b.Tb&&(b.contextId===oc.a.Xc||b.contextId===
oc.a.paragraph&&!b.node.characterData.length)}Q9k(b,h){return b.equals(h)&&b.Fb===h.Fb&&b.Tb===h.Tb}G8j(b,h){if(b&&h.fg){var n=this.qh.pr(b.id,!0),B=this.hh.Dsa(h.pv,!0);n.equals(B?B.id:null)&&this.qh.iJ(b.id,h.objectId,!0);n=this.qh.pr(b.id,!1);B=this.hh.Dsa(h.MA,!1);n.equals(B?B.id:null)&&this.qh.iJ(b.id,h.objectId,!1)}}static get Md(){return null!=Rh.j6g?Rh.j6g:Rh.j6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static XPb(b){return h=>h.type===b}static Vwm(){return b=>
12===b.type||15===b.type}static TYh(b,h){return b.lf===h.vhj||b.parentNode&&h.Vrj(b.parentNode)?!1:!0}}Object(u.a)(Rh,"ContentControlOperator",null,[229,13,230]);class Mg{constructor(b,h,n){this.Zc=b;this.Oy=h;this.EGb=n}vKi(b){const h=this.YPb();return h&&b&&this.VQb(h,b)?this.ZQm(h):null}VQb(b,h,n=!1){if(!b||!h)return!1;do{var B=b.currentNode;if(!B)break;B=B.ja(Lc.a.Dlc,null);if(B===h||n&&B&&B.includes(h))return!0}while(b.Lf(29));return!1}ZQm(b){var h=b.Ub(1);b.uc();b=b.IL(1);if(!h||!b)return null;
h=Oe.SelectionFactory.IJl(h,b);b=re.SelectionEditor.Wj(h,!1,!1);return hn.a.pga&&!b?null:Oe.SelectionFactory.$y(h,b.Uc)}YPb(){const b=this.Zc.Ql();b.set(this.Oy.value);this.EGb.dS(b);return b.Ub(28)&&b.Ub(29)?b:null}dLf(){const b=this.Zc.Ql();b.set(this.Oy.value);this.EGb.dS(b);return b.Ub(28)?b:null}Gsm(b){var h=this.YPb();if(!h||!b||!this.VQb(h,b,!1))return null;h.Xd();b=1<h.Dq();h.Xd();h.Xd();h=h.currentNode;return ea.ParagraphReader.Xb(h)?{Lpe:h,hOi:b}:{Lpe:null,hOi:b}}gxi(){const b=this.YPb();
return this.VQb(b,Xr.a.Udi,!0)?b.currentNode.getValue(Lc.a.Dlc):null}}Object(u.a)(Mg,"GlossaryNavigator",null,[227]);class Xl{constructor(b,h,n,B,L,ba){this.Dr=b;this.hh=h;this.Wm=n;this.jb=B;this.Ih=L;this.uja=ba}Qnd(b,h,n){if(!this.uja)return 1;if(!({xp:L}=this.t1f(b)).returnValue||!this.Ih.Z2i(L,h)||this.tBj(b,h))return 2;var B=this.Ih.qti(h);var L=B.J(0).Ajc();L&&L.count||(L=new ob.a,L.add(b.objectId));b=this.hh.Sei(B);n=n.split("\n");h=Object(ya.a)(ve.GraphIterator,this.hh.eLf(h));h=this.hh.nOh(h,
b,n.length);for(b=0;b<h.count;++b){B=h.J(b);this.Dr.Ne(Nd.a.createTextRange(B,0,0),n[b]);for(let ba=0;ba<L.count;++ba)this.Dr.bza(B,L.J(ba),0,!0,!0),this.Dr.bza(B,L.J(L.count-ba-1),B.characterData.length,!0,!1)}return 0}tBj(b,h){if(!this.uja)return 1;let n;if(!({xp:n}=this.t1f(b)).returnValue||!this.Ih.Z2i(n,h))return 2;h=this.Ih.qti(h);if(0<h.count&&(h=this.Wm.mN(Nd.a.create(h.J(0)),Nd.a.create(h.J(h.count-1)),2)))for(const B of h)if(B.id!==b.id&&!this.Wm.VDa(B,!0))return 2;return 0}zpc(b){if(!this.uja||
!({xp:n}=this.t1f(b)).returnValue)return!1;b=b.YGf();for(var h of b)if(!h.Nla||!h.isSupported)return!1;if(this.Ih.Mfn(n))return!1;var n=Object(ya.a)(ve.GraphIterator,this.hh.eLf(n));h=new ob.a;this.jb.vQb(n,!0,!1,h);for(const B of h)if(0<B.ja(Lc.a.wOb,0)||this.jb.D9a(B).lz)return!1;return!0}t1f(b){let h=null;return b&&b.pv.toString()===b.MA.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(h=this.hh.Bu(b.pv))&&14===h.type?{returnValue:!0,xp:h}:{returnValue:!1,xp:null}:{returnValue:!1,xp:h}}}Object(u.a)(Xl,
"TableContentControlEditor",null,[226]);class ql{Mfn(b){let h=!1;const n=new ve.GraphIterator;n.set(b);qh.forEachCellInTable(n,B=>{if(!Ng.TableCellReader.Wg(B)){let L=Zj.OutlineNavigator.Wba(B);for(;L;){if(xb.OutlineElementReader.$lc(B))return h=!0,!1;L=B.Cj(1)}}return!0});return h}Z2i(b,h){const n=new ve.GraphIterator;n.set(h);return Ng.TableCellReader.KCa(h)&&n.zb(14)&&n.ld(14).id===b.id?!0:!1}qti(b){const h=new ob.a,n=new ve.GraphIterator;n.set(b);b=new ob.a;ea.ParagraphReader.vQb(n,!0,!1,b);for(const B of b)h.add(B);
return h}}Object(u.a)(ql,"TableReader",null,[225]);class Al{constructor(){this.Wm=null}get name(){return"WordEditor.ContentControl"}init(){A.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&($x.a.PZa(Object(z.a)(Ya.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),Ya.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").oWn,"onContentControlRangeChanged")),this.Wm=Ya.a.instance.Oa("WordEditor.ContentControl.IContentControlOperator"),Ya.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init(),
Ya.a.instance.resolve("WordEditor.ContentControl.GlossaryEditor").init())}dispose(){this.Wm&&(this.Wm.dispose(),this.Wm=null)}wc(b){b.ia("WordEditor.ContentControl.Perf.IPerfLogger",()=>new jF.a($c.a.Ee)).ha();b.ia("WordEditor.ContentControl.ContentControlFactory",()=>new xc(Ya.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").ha();b.ia("WordEditor.ContentControlNodeFactory",()=>new iF(Ya.a.instance.Qa("Box4.ContentControlConfigSettings"),
Ya.a.instance.Qa("Box4.ContentControl.IContentControlOperator"))).ha();b.ia("WordEditor.ContentControl.ContentControlGraphManager",()=>new ud(new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c),new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c.td),new Vl.a,Object($n.a)(),Ya.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Ya.a.instance.resolve("Box4.IOutlineEditor"),Ya.a.instance.resolve("Box4.IOutlineElementEditor"),Ya.a.instance.resolve("Box4.IParagraphReader"),Ya.a.instance.resolve("WordEditor.IParagraphSplitHelper"),
Ya.a.instance.Qa("Box4.ContentControlConfigSettings"),Ya.a.instance.resolve("Box4.ContentControlParagraphMapping"),Ya.a.instance.Qa("WordEditor.ContentControl.GlossaryEditor"),Ya.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"))).as("WordEditor.ContentControl.IContentControlGraphManager").ha();b.ia("WordEditor.ContentControl.GlossaryNavigator",()=>new Mg(new Vl.a,new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c),Object($n.a)())).as("WordEditor.ContentControl.IGlossaryNavigator").ha();
b.ia("WordEditor.ContentControl.ContentControlOperator",()=>new Rh(new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c),new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c.td),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ya.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Zb.a.instance,Ya.a.instance.resolve("Box4.ISelectionFactory"),Gm.PageReader.instance,Ya.a.instance.resolve("Box4.IFormattingEditor"),
Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),A.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),Ya.a.instance.Oa("Box4.IContentControlDataChangedManager"),A.AFrameworkApplication.va,Ya.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),A.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Ya.a.instance.resolve("Box4.IContentControlChpHelper"),Ya.a.instance.Qa("Box4.ContentControlConfigSettings"),Ya.a.instance.Oa("Box4.IContentControlReader"),
Ya.a.instance.resolve("Box4.IParagraphReader"),Ya.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Ya.a.instance.Qa("Box4.Actors.IVirtualSelectionMerger"),Ya.a.instance.resolve("Box4.IFeatureHelper"),Ya.a.instance.resolve("Box4.ContentControlParagraphMapping"),Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"),Ya.a.instance.Qa("WordEditor.Extension.RichApiEventManager"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").ha();
b.ia("WordEditor.ContentControl.ContentControlManager",()=>new Ud(new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c),new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c.td),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Ya.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),
Ya.a.instance.Qa("Box4.ContentControlConfigSettings"),Ya.a.instance.resolve("Box4.IContentControlChpHelper"),Ya.a.instance.resolve("Box4.IContentControlAroundTableChecker"))).as("WordEditor.ContentControl.IContentControlManager").ha();b.ia("WordEditor.ContentControl.ContentControlChpManager",()=>new W(Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.Qa("Box4.ContentControlConfigSettings"),Ya.a.instance.resolve("Box4.IParagraphReader"),Ya.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").ha();
b.ia("WordEditor.ContentControl.GlossaryEditor",()=>new e(Ya.a.instance.resolve("WordEditor.ContentControl.GlossaryNavigator"),Ya.a.instance.resolve("Box4.IOutlineElementEditor"),Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ya.a.instance.resolve("Box4.TextFormattingHelper"),Ya.a.instance.resolve("Box4.IFormattingEditor"),$e.App.jf.Il.Ve(55))).as("WordEditor.ContentControl.IGlossaryEditor").ha();b.ia("WordEditor.ContentControl.TableContentControlEditor",
()=>new Xl(Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ya.a.instance.resolve("Box4.IParagraphReader"),new ql,A.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").ha();A.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&
b.ia("Box4.ContentControlConverter",()=>new ha(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").ha();b.ia("WordEditor.ContentControl.ContentControlCCP",()=>new t(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),b.resolve("Box4.TrackChange.ITrackChangeEditor"))).ha();b.ia("WordEditor.ContentControl.ContentControlFormattingManager",()=>new Rc(new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c.td),Ya.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Ya.a.instance.resolve("Box4.Actors.TextFormattingActor"),Ya.a.instance.resolve("Box4.TextFormattingHelper"),A.AFrameworkApplication.K)).as("WordEditor.ContentControl.IContentControlFormattingManager").ha()}static main(){M.a.instance.Jc(new Al)}}
Object(u.a)(Al,"ContentControlPackage",null,[0,1]);var Hk=d(1463),Dj=d(547),ao=d(1878),yj=d(851);class Up{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(u.a)(Up,"UxManagerMenuActionTelemetryData",null,[]);class hA extends Sys.EventArgs{constructor(b,h,n){super();this.definition=b;this.source=h;this.Twl=n}}Object(u.a)(hA,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class by extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=
h}}Object(u.a)(by,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class Ou{constructor(b,h,n,B,L,ba,la=!1,La=null,fb=null,Cb=null,Lb=!1,$b=null,tc=!1,Nc=!0,dd=null,Hd=!1,xe=10){this.target=this.container=this.Ig=null;this.isDismissed=!1;this.mfd=this.Yed=this.Mmi=this.F0=this.Pv=this.Nga=this.hDa=this.eNa=this.documentElement=this.lV=this.editingElement=null;this.isFocused=!1;this.V_d=null;this.tkg=this.UYf=!1;this.AFe=null;this.Wqe=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=n;this.definition=B;this.eUk=
L;this.ZXa=ba;this.bVa=la;this.RTj=La;this.asa=fb;this.hostServices=Cb;this.X5o=Lb;this.zqj=$b;this.bUj=tc;this.WUl=Nc;this.Mmi=dd;this.showDictationCommandUx=Hd;this.source=xe}}Object(u.a)(Ou,"UxManagerState",null,[]);var hw=d(1698);class Dn{constructor(b,h,n,B,L,ba,la,La,fb,Cb){this.Yb=b;this.hb=h;this.rB=n;this.nd=B;this.ne=L;this.Gb=ba;this.yj=la;this.Wl=La;this.h6=fb;this.X4b=Cb;this.k9e=!1;this._state=null;this.shouldIgnoreFocusEvent=Lb=>{var $b;return this.nd.zd.Hy&&!this.nd.zd.EX&&Lb===(null===
($b=this.nd.Ke)||void 0===$b?void 0:$b.editingElement)};this.sa=new mg.a;this.WMd=new qb.a;this.tgf((Lb,$b)=>{Dn.eEn(n,$b.definition,$b.source)});this.i0k((Lb,$b)=>{Dn.dEn(n,$b.definition,$b.source,$b.Twl)});this.Yb.ge(Dn.h4d).iK=!0;A.AFrameworkApplication.va.ra(Dc.a.sZc,oc.a.view,this.sZc.bind(this))}tgf(b){this.sa.addHandler(Dn.P8f,b)}FDj(b){this.sa.removeHandler(Dn.P8f,b)}pmo(b,h){this.sa.raiseEvent(Dn.P8f,new by(b,h))}i0k(b){this.sa.addHandler(Dn.Jdj,b)}omo(b,h,n){this.sa.raiseEvent(Dn.Jdj,new hA(b,
h,n))}hAp(b){var h;if(!b.isDismissed&&b.lV){var n=hw.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(n&&n.length){n=hw.b(n);var B=$c.a.getElementBounds(b.lV);n.width||n.height?n.x+n.width<B.x||n.x>B.x+B.width||n.y+n.height<B.y||n.y>B.y+B.height?this.dismiss():(B=b.target,B.style.left=n.x+"px",B.style.top=n.y+"px",B.style.width=n.width+"px",B.style.height=n.height+"px",null===(h=b.Ig)||void 0===h?void 0:h.updatePosition(),b.Ig||x.ULS.sendTraceTag(512255777,341,50,"Menu is null so can't update position")):
(x.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else x.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}Kxj(b){b.isDismissed||b.AFe||(b.AFe=new Re.a(2,1,1,()=>{b.AFe=null;this.hAp(b)},147),this.Gb.Zb(b.AFe))}eNa(b,h){!b.isDismissed&&b.WUl&&0<h.kM.length&&(this.dismiss(),x.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}C4k(b){return!!b&&b.id===Dn.hUk}hDa(b,h){if(b.isDismissed||
!h||!h.Kb)return!1;h=h.Kb;const n=h.keyCode,B=!b.isFocused&&!!b.Ig,L=h.altKey||h.ctrlKey||h.shiftKey;let ba=!1;n===Jd.a.Z4?(this.dismiss(),x.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),ba=!0):n!==Jd.a.Mu&&n!==Jd.a.xz||!B||L||!this.C4k(b.definition)?n!==Jd.a.W2b&&n!==Jd.a.pud||!B||L||(this.dog(b),b.Ig?(b.Ig.focus(),ba=!0,x.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):x.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(b.Ig.executeDefaultAction(),x.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),ba=!0);ba&&(h.preventDefault(),h.stopPropagation());return ba}Yed(b,h){if(b.isDismissed||!b.Ig)return x.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.Ig),!1;b.Ig.invokeBadgeId(h);x.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}mfd(b,h){if(b.isDismissed||!b.Ig)return x.ULS.sendTraceTag(512255775,
341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.Ig),!1;b.Ig.executeActionFromString(h);x.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}Nga(b,h){if(b.isDismissed||!h||!h.Kb||!b.Ig)return x.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!h,!(null===h||void 0===h?
0:h.Kb),!b.Ig),!1;const n=b.target;b=b.Ig.getElementBounds();var B=h.Kb;h=B.clientX;B=B.clientY;n&&Dn.Btj(h,B,$c.a.getElementBounds(n),16)||b&&Dn.Btj(h,B,Dn.qel(b),4)||this.dismiss();return!1}N_o(b){var h=hw.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=hw.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=Dn.yXc();b.target=h;b.editingElement=this.nd.Ke.editingElement;b.lV=this.nd.zd.container;b.documentElement=document.documentElement;b.eNa=(n,B)=>{this.eNa(b,B)};b.hDa=n=>
this.hDa(b,n);b.Nga=n=>this.Nga(b,n);b.F0=()=>{this.Kxj(b)};b.Pv=()=>{this.Kxj(b)};b.showDictationCommandUx&&(b.Yed=n=>this.Yed(b,n),b.mfd=n=>this.mfd(b,n),this.X4b&&this.X4b.execute(n=>{n.ZVo(b.Yed);n.aWo(b.mfd)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.hb.Cw(b.eNa);this.yj.z2(b.Pv);this.ne.nb(Cd.a.gL,b.editingElement,b.hDa);b.bVa&&this.Wl.nb(Cd.a.Aua,b.documentElement,b.Nga);Nb.a.addHandler(b.lV,"scroll",b.F0);b.ZXa||this.dog(b);return!0}aRb(b,h){const n=
!!b.Ig;this.omo(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Yb.currentScope.name===Dn.h4d&&this.Yb.fV(Dn.h4d);b.eNa&&this.hb.nY(b.eNa);b.hDa&&b.editingElement&&this.ne.xc(Cd.a.gL,b.editingElement,b.hDa);this.X4b&&this.X4b.execute(B=>{b.showDictationCommandUx&&(B.DFo(),B.EFo());B.uOj(!1,b.showDictationCommandUx)});b.Nga&&b.documentElement&&b.bVa&&this.Wl.xc(Cd.a.Aua,b.documentElement,b.Nga);b.F0&&b.lV&&
Nb.a.removeHandler(b.lV,"scroll",b.F0);b.Pv&&this.yj.iha(b.Pv);b.Ig=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.lV=null;b.eNa=null;b.hDa=null;b.Nga=null;b.F0=null;b.Pv=null;b.Yed=null;b.mfd=null;n&&b.asa&&(b.UYf?b.tkg=!0:b.asa(b.V_d))}Z9a(b,h){var n;if(!h)return!1;switch(h.actionType){case Bo.b.Toggle:if(h.objectFulfillment===Dn.Pkp)return this.k9e=!this.k9e,this.wMg(),this.oZc(b),!0;if(h.objectFulfillment===Dn.Tkp)return{value:n}=this.WMd.Dc(h.suggestionGroup.type,
!1),this.WMd.Z(h.suggestionGroup.type,!n),this.oZc(b),!0;break;case Bo.b.GiveFeedback:if(ao.a.chn(null===(n=h.suggestionGroup)||void 0===n?void 0:n.type)||yj.a.Prn(h.objectName))break;this.focus();this.wMg();this.oZc(b);return!0;case Bo.b.RevealSuggestions:this.oZc(b)}b.UYf=!0;h=b.eUk.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.UYf=!1;h&&this.oZc(b);b.tkg&&(b.tkg=!1,b.asa(b.V_d),b.V_d=null);return h}oZc(b){b.Nga&&b.documentElement&&b.bVa&&(this.Wl.xc(Cd.a.Aua,b.documentElement,b.Nga),b.bVa=
!1)}M3o(b,h){return b.id===Dj.a.Slb?!1:!(0<=b.positionInSet&&0<b.setSize)&&!h}Usd(b){var h;if(this.N_o(b)){var n=1;A.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(n=3);var B=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(B=b.definition.suggestionGroups[0].type,B=this.WMd.mb(B)?this.WMd.J(B):b.X5o);h=!1;A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",!1)&&(h=!0);n={containerElement:b.container,
targetElement:b.target,definition:b.definition,onAction:L=>this.Z9a(b,L),onDismiss:L=>{this.aRb(b,L)},keepCurrentFocus:b.ZXa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.k9e,showDescription:B,showEditorButton:b.bUj,showEditorBranding:this.M3o(b.definition,b.bUj),hostServices:b.hostServices,maxSuggestionGroupNumber:n,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.Mmi,showDictationCommandUx:b.showDictationCommandUx,editingElement:b.editingElement};
b.zqj&&b.zqj(n);this.rB.createContextualUi(n).then(L=>{this.pmo(b.definition,b.source);b.Ig=L;x.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.RTj&&b.RTj();this.X4b&&9!==b.source&&this.X4b.execute(ba=>ba.uOj(!0,b.showDictationCommandUx))}).catch(L=>{this.aRb(b,{BSp:Hk.a.Unknown});x.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",L)});0<b.Wqe&&x.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.Wqe)}else 5<++b.Wqe?(x.ULS.sendTraceTag(50968330,
341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Gb.Zb(new Re.a(2,1,Math.pow(3,b.Wqe),()=>{b.isDismissed||this.Usd(b)},146))}get zI(){return!!this._state&&!this._state.isDismissed}SLg(b,h){this.zI&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.zI?this._state.definition:null}set definition(b){this.zI&&(this._state.definition=b,this._state.Ig&&this._state.Ig.setDefinition(b))}focus(){this.zI&&this._state.Ig&&(this._state.isFocused||
this.dog(this._state),this._state.Ig.focus())}wMg(){this.zI&&this._state.Ig&&this._state.Ig.updatePosition()}dog(b){this.Yb.NN(Dn.h4d,!1);b.isFocused=!0}Ona(b,h,n,B,L,ba=null,la=null,La=null,fb=!1,Cb=null,Lb=!1,$b=!0,tc=null,Nc=!1,dd=10){if(!h||this._state&&!this._state.isDismissed)return!1;let Hd,xe;if(!({paragraphNode:xe,start:b,end:Hd}=Dn.wop(b)).returnValue)return!1;this._state=new Ou(xe,b,Hd,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd);this.Usd(this._state);return!0}F_b(b){this._state&&(this._state.V_d=
b)}sZc(b,h,n){if(1===n)return this.zI?32:0;this.zI&&this.dismiss();return 32}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.Ig)||void 0===b?void 0:b.dismiss())}static eEn(b,h,n){n=new Up(n);b.logAction({actionType:Bo.b.SessionStart,engagement:Bo.a.Try,objectName:Dn.U_j,objectId:h.id,data:n});if(h.suggestionGroups)for(const B of h.suggestionGroups)b.logAction({actionType:Bo.b.Presented,engagement:Bo.a.See,objectName:B.type,objectId:B.id,data:n})}static dEn(b,h,n,B){n=
new Up(n);b.logAction({actionType:Bo.b.SessionEnd,engagement:Bo.a.None,objectName:Dn.U_j,objectId:h.id,data:n},B)}static yXc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static qel(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static Btj(b,h,n,B){const L=n.y-B,ba=n.x+n.width+B,la=n.y+n.height+B;return n.x-B<=b&&b<=ba&&L<=h&&h<=la}static wop(b){let h,n;if(!b||!ea.ParagraphReader.Xb(b.node)||b.contextId!==oc.a.Xc&&b.contextId!==oc.a.Bd&&b.contextId!==
oc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};n=b.node;b.contextId!==oc.a.paragraph?(h=b.cpBegin,b=b.cpEnd):(h=0,b=n.characterData.length);return{returnValue:!0,paragraphNode:n,start:h,end:b}}$qc(){this.h6&&this.h6.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}Dn.hUk="ActionSet";Dn.U_j="IntentGroup";Dn.h4d="CanvasContextualUxReact";Dn.Pkp="Context";Dn.Tkp="Description";Dn.P8f="MenuDidOpen";Dn.Jdj="MenuDidClose";Object(u.a)(Dn,"UxManager",null,[]);class pv{constructor(){this.W=
null}get name(){return"WordEditor.CanvasContextualProvider"}wc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo()})}Mo(){const b=A.AFrameworkApplication.K.$("EditorGoalsEnabled"),h=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0)&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",!1);(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(58)||mn.a.ULa||
A.AFrameworkApplication.K.$("RewriteIsEnabled")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(A.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").xC.loadScript("canvasContextual")).then(()=>{this.W.ia("CanvasContextual.ICanvasContextualController",()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:A.AFrameworkApplication.uiCulture,
dataCulture:A.AFrameworkApplication.dataCulture,isRightToLeft:A.AFrameworkApplication.isRtl,ulsLogger:new zc.a,dimeCallback:async()=>{this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")},loadUpsellDependencies:async()=>{this.W.Qa("Common.IInProductMessagingUIManager").execute(n=>{n.L7i()})},getSoftPaywallData:()=>this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),getPremiumPreviewCritiquesList:()=>this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),
logSystemInitiatedFeedback:async n=>{this.W.Qa("Common.ISystemInitiatedFeedback").execute(B=>B.logActivity(n,null))}})).ha();this.W.ia("WordEditor.CanvasContextualProvider.UxManager",()=>new Dn(Ph.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),this.W.resolve("CanvasContextual.ICanvasContextualController"),Object(Pb.a)(),bb.KeyInputManager.instance,A.AFrameworkApplication.mc,A.AFrameworkApplication.ua,A.AFrameworkApplication.ua.i9,this.W.Qa("Common.ISystemInitiatedFeedback"),this.W.Qa("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).ha();
this.W.resolve("CanvasContextual.ICanvasContextualController");this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.W.ia("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:A.AFrameworkApplication.uiCulture,ulsLogger:new zc.a})).ha(),this.W.resolve("CanvasContextual.IEditorInitializer").init(),this.W.ia("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new zc.a})).ha(),
this.W.resolve("CanvasContextual.ISkittleControllerV2"),h&&(this.W.ia("CanvasContextual.IAIFeedbackSkittleController",()=>canvasContextual.FactoryGlobal.getAIFeedbackSkittleControllerInstance({ulsLogger:new zc.a})).ha(),this.W.resolve("CanvasContextual.IAIFeedbackSkittleController")))}).catch(n=>{x.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",n)})}dispose(){}static main(){M.a.instance.Jc(new pv)}}Object(u.a)(pv,"PackageManager",
null,[0,1]);class mF{constructor(b,h,n,B){this.j$m=(L,ba,la)=>{L=null;ba.view.te&&(L=ba.view);if(!L||!L.lb)return 8;if(!this.VK.LZf())return 2;if(1===la)return 32;this.OIk.XEl();return 32};this.Ccj=(L,ba,la)=>{let La=null;ba.view.te&&(La=ba.view);if(!La||!La.lb)return 8;if(!this.VK.LZf())return 2;if(1===la)return 32;if(1!==this.VK.glc(this.hb.gb,!0).count)return 2;ba=new Sd.GraphTransaction(15);try{if(ba.Ab(La.jd),!this.VK.Epp(L===Dc.a.j8f))return 8}finally{ba&&ba.dispose()}return 32};this.ga=b;this.hb=
h;this.VK=n;this.OIk=B}Wb(){this.ga.ra(Dc.a.lce,oc.a.view,this.j$m);this.ga.ra(Dc.a.j8f,oc.a.view,this.Ccj);this.ga.ra(Dc.a.Dcj,oc.a.view,this.Ccj)}}Object(u.a)(mF,"IntelligentPlaceholderActor",null,[]);class wt{constructor(){this.SDc=new qb.a;this.xyd=new qb.a}cVk(b,h){let n;({value:n}=this.SDc.Dc(b,n)).returnValue||this.SDc.Z(b,n=new Ea.a);n.add(h)}IVk(b,h){this.xyd.mb(b)&&x.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.xyd.Z(b,h)}bVk(b,h,n){this.cVk(b,h);this.IVk(h,
n)}hjm(b){let h;return({value:h}=this.SDc.Dc(b,h)).returnValue?h:null}lmm(b){let h;return({value:h}=this.xyd.Dc(b,h)).returnValue?h:null}bAo(b){let h;if(({value:h}=this.SDc.Dc(b,h)).returnValue){for(const n of h)this.xyd.remove(n);this.SDc.remove(b)}else x.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(u.a)(wt,"IntelligentPlaceholderAtMentionManager",null,[398]);var Vw=d(1776);class pH extends Vw.a{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get Av(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}wTj(b){return!b.ja(Lc.a.yI,
!1)}RVa(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(u.a)(pH,"IntelligentPlaceholderDetailsProvider",Vw.a,[]);var cy=d(1935),nF=d(2171),eJ=d(1939);class AB{constructor(){this.WFa=""}Ila(b){this.WFa+=b}mWf(b){this.WFa+=b}RVf(b){this.WFa+=b}cnc(b){this.WFa+=b}ZSi(b){this.WFa+=b}}Object(u.a)(AB,"PlainTextFormatCreator",null,[1444]);var oF=d(1690),dy=d(2170);d(350);var Om=d(1775),Ch=d(1578);class ey{constructor(){this.qGc=new qb.a}contains(b){return this.qGc.mb(ey.H2f(b))}add(b){this.qGc.Z(ey.H2f(b),
b)}remove(b){this.qGc.remove(ey.H2f(b))}Nrp(b){for(const h of b.qGc)this.add(h.value)}Hmi(){const b=new ob.a;for(const h of this.qGc)b.add(h.value.nk);return b}static H2f(b){return b.nk.toString()}}Object(u.a)(ey,"CommentRangeSet",null,[]);class iA extends Sys.EventArgs{constructor(b){super();this.lL=b}}Object(u.a)(iA,"OnFollowUpEventArgs",Sys.EventArgs,[]);class pF extends iA{constructor(b,h){super(b);this.kbo=h}}Object(u.a)(pF,"OnCreateEventArgs",iA,[]);class aD extends iA{constructor(b,h){super(b);
this.Apn=h}}Object(u.a)(aD,"OnResolveEventArgs",iA,[]);var bD=d(229);class BB{}BB.mIe="MentionExperienceDegraded";Object(u.a)(BB,"AtMentionsConstants",null,[]);class qF{constructor(b,h,n,B,L,ba,la,La,fb,Cb){this.udd=b;this.W$k=h;this.Ird=n;this.aVd=B;this.lb=L;this.lo=ba;this.Gce=la;this.ZTi=La;this.Dw=fb;this.Cdc=Cb;this.rZa=null;this.y1n=(Lb,$b,tc)=>{x.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");Lb=this.Gce.F$a(Lb,tc.displayName,tc.email,tc.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,
$b),!0);Lb?x.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.Cdc.logKpiFailure("LPPWordEditorKPI","FailedToInsertAtMention",{isInternal:!0},{name:BB.mIe,isInternal:!0})};this.j0n=(Lb,$b)=>{x.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");$b&&this.Cdc.Vw(Dc.a.$ll);this.Gce.vWm(Lb.id,$b)};this.eXn=()=>{this.lo.zd.Hy&&!this.lo.zd.EX&&this.lo.Ke.Lzf?this.n0h=!0:(this.udd.reset(),x.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};
this.M2n=()=>{x.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.nYk()};this.i0n=(Lb,$b,tc,Nc=new Map)=>{Nc=Object.assign(new rb.a,{extendedProperties:Nc});this.Cdc.logKpiFailure("LPPWordEditorKPI",Lb,{isIntentional:$b,isInternal:tc,additionalValues:Nc},{name:BB.mIe,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:$b,isInternal:tc,additionalValues:Nc})};(b=Ya.a.instance.Oa("Box4.IEditStateEventManager"))&&b.addHandler(bD.a.qIa,this.eHo.bind(this))}Ife(){return!!this.rZa}eHo(){this.Ife()&&
this.n0h&&(this.rZa.updateInputText(this.Wad,!1),this.n0h=!1)}ariaNotify(b,h){this.Dw.sendNotification(b,h)}nYk(){const b=this.lo.Ke.editingElement;if(b){var h=b.getAttribute(Bc.a.ETc);b.setAttribute(Bc.a.ETc,h?h.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else x.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}ozo(){const b=this.lo.Ke.editingElement;if(b){var h=b.getAttribute(Bc.a.ETc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?
b.setAttribute(Bc.a.ETc,h.join(" ")):b.removeAttribute(Bc.a.ETc)):x.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else x.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}yql(){this.ozo();this.rZa&&this.rZa.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.rZa=null;this.ZTi.INj(!0)}Vte(){this.udd.Hrg(()=>{this.yql()});this.udd.urg((b,h)=>{this.Wad=b;if(this.rZa)1<this.Wad.length&&"@"===this.Wad.trimEnd()?
(this.Cdc.Vw(Dc.a.Zll),this.udd.reset()):this.rZa.updateInputText(this.Wad,!1);else if(this.Cdc.logKpiUsage("LPPWordEditorKPI",0),this.Cdc.Vw(Dc.a.X4n),(b=this.svm(h))&&b.height){h=b.y;const n=b.height,B=document.createElement("div");B.id="PeoplePicker";B.style.position="absolute";B.style.top=h-5+"px";B.style.left=b.x+"px";B.style.height=n+10+"px";document.body.appendChild(B);this.W$k.createPeoplePicker({editingElementId:this.lo.Ke.editingElement.id,containerElement:B,automationID:"PeoplePickerAutomationID",
onReplaceTextCallback:this.y1n,onPermissionsReceivedCallback:this.j0n,onDismiss:this.eXn,onShow:this.M2n,onFailure:this.i0n}).then(L=>{L.updateInputText(this.Wad,!1);this.rZa=L;this.ZTi.INj(!1)})}});this.udd.vrg(b=>{if(this.rZa)this.rZa.onKeyDown(b.Kb.rawEvent)})}svm(b){var h=this.lb.gb;if(!h)return null;h=h.currentSelection;if(!h)return null;h=h.Ra;if(!h)return null;h=h.node;if(!h)return null;h=Object(ya.a)(120,h);if(!h)return null;h=Object(ya.a)(169,h.nl(this.lo.zd.oc));if(!h)return null;h=Object(ya.a)(88,
h);if(!h)return null;let n=null;try{n=this.Ird.F2(this.aVd.Djc(2,b),h,!1,!1,!1,!1)}catch(B){x.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",B)}return n}}Object(u.a)(qF,"WordEditorAtMentionsHandler",null,[248]);var Ls=d(1570);class jq{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd){this.ga=b;this.Zc=h;this.ESa=n;this.hb=B;this.Tq=L;this.Qd=ba;this.fF=la;this.cEd=La;this.Wd=fb;this.hr=Cb;this.nok=$b;this.Ei=tc;this.Pc=Lb;this.sa=new mg.a;
this.Ri=Nc;this.K9g=dd;Ch.a.xgf((Hd,xe)=>{this.yI(xe.lL,!0)&&this.sa.raiseEvent(jq.efd)})}UPh(b){this.sa.addHandler(jq.nkj,b)}v1k(b){this.sa.addHandler(jq.Dnj,b)}b1k(b){this.sa.addHandler(jq.ZZn,b)}xgf(b){this.sa.addHandler(jq.efd,b)}yI(b,h){let n=b.ja(Lc.a.yI,!1);h&&(n=n&&!b.ja(Lc.a.Rea,!1));return n}Goc(b){return this.Tq.Goc(b)}nCm(b){for(const h of b)for(const n of h)if(jq.S1f(n.contextId))return n.node.Lc;return null}KJm(b,h,n){const B=new ey,L=b.Lc;for(let ba=0;ba<b.qa.length;ba++){const la=
b.qa.J(ba);if(la.cp>=h)break;if(la.kf&&la.kf.length)for(let La=0;La<la.kf.length;La++){const fb=la.kf.J(La);this.yI(L.Eb(fb.nk),n)&&(fb.Wc?B.add(fb):B.remove(fb))}}return B}LJm(b,h,n,B){const L=new ey,ba=b.Lc;for(let la=0;la<b.qa.length;la++){const La=b.qa.J(la);if(La.cp>n)break;if(La.kf&&La.kf.length)for(let fb=0;fb<La.kf.length;fb++){const Cb=La.kf.J(fb);this.yI(ba.Eb(Cb.nk),B)&&(Cb.Wc?La.cp<n&&L.add(Cb):La.cp<=h&&L.remove(Cb))}}return L}WGi(b,h){let n;const B=b.node;b.contextId!==oc.a.paragraph?
(n=b.cpBegin,b=b.cpEnd):(n=0,b=B.characterData.length);return n===b?this.KJm(B,n,h):this.LJm(B,n,b,h)}D4c(b,h){return jq.S1f(b.contextId)?this.WGi(b,h).Hmi():new ob.a}glc(b,h){const n=new ey;for(const B of b)for(const L of B)jq.S1f(L.contextId)&&n.Nrp(this.WGi(L,h));return n.Hmi()}LZf(){var b=this.hb.gb;if(!b||1!==b.length||1!==b.J(0).length)return!1;b=b.J(0).Ra.node;return ea.ParagraphReader.Xb(b)&&!ea.ParagraphReader.Wza(b)&&this.Tq.Tsb(this.ga,!0)?!0:!1}aTi(b,h){if(!this.LZf())return null;if(this.Tq.yYm())return x.ULS.sendTraceTag(592761861,
323,15,"Placeholder insertion failed because of draft comment"),null;let n=!1;var B=this.hb.gb.J(0).Ra;B.contextId===oc.a.Xc?(b=b?re.SelectionEditor.i7(B,!1):null)&&b.ly&&b.Ra.contextId===oc.a.Bd?this.hb.Ic(b):(this.Qd.Ne(B,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+" ",!0),this.hb.Ic(Oe.SelectionFactory.eN(B.node,B.cpBegin,B.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):n=!0;this.Ri.lNb||cy.a.instance.Q7c();b=this.Tq.Wfc(this.hb.gb.currentSelection);
if(!b)return null;this.Goc(b)&&this.K9g.Vw(Pa.a.IMa,{succeeded:!0,yfb:29});var L=this.Zc.jg(b);const ba=L.Ub(1);if(!ba||ba.yc!==pk.a.$X)return null;L=L.Ub(2);if(!L||L.yc!==pk.a.paragraphNode)return null;this.OLg(b.Lc,b.id);this.sa.raiseEvent(jq.nkj,new pF(b,h));n&&(h=B.node,B=B.contextId!==oc.a.paragraph?B.cpEnd:h.characterData.length,this.hb.Ic(Oe.SelectionFactory.eN(h,B,B)));return b}lce(b){return!!this.aTi(!0,b)}c8c(b,h,n,B,L,ba){if(0>h)return!1;B="@"+B;const la=B+" ",La=new Sd.GraphTransaction(15);
try{La.Ab(b);this.Qd.Ne(Nd.a.createTextRange(b,h,n),la);this.Wd.Mg&&(this.hr.wpf(b,h,h+B.length),this.hr.Hna(b,h+B.length,h+la.length,1));const fb=this.fF.vF(Nd.a.createTextRange(b,h,h+B.length),"mailto:"+L,!1,!0,!1);if(!fb)return!1;const Cb=fb.dw;if(!Cb)return x.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.hb.Ic(Oe.SelectionFactory.eN(b,h,h+B.length));const Lb=this.aTi(!1,2);if(!Lb)return!1;ba&&this.cEd.bVk(ba,Cb,Lb.id);this.hb.Ic(Oe.SelectionFactory.se(b,
h+la.length))}finally{La&&La.dispose()}return!0}F$a(b,h,n,B){const L=this.hb.Og;return re.SelectionEditor.mf(L)?this.c8c(L.node,L.cpBegin-b,L.cpBegin,h,n,B):!1}NFm(b){if(1===b.length&&b.J(0).ly&&(b=b.J(0).Ra,b.contextId===oc.a.Xc&&ea.ParagraphReader.Xb(b.node))){const h=b.node;for(let n=0;n<h.qa.length;n++){const B=h.qa.J(n);if(B.cp===b.cpBegin){b=B.Q8d(!0,!0);if(0<b.length)return b[0].nk;break}}}return null}nMb(b,h,n){return this.Tq.qXc(b,h,n).returnValue}j5d(b,h,n,B,L){let ba=!1;const la=b.characterData;
if(h>=la.length||n>la.length||n<h)return{returnValue:!1,GVa:ba};let La=h,fb=null;for(let Lb=0;Lb<b.qa.length;Lb++){const $b=b.qa.J(Lb),tc=$b.cp;if(!(tc<h)){if($b.vn&&fb)try{const Nc=la.substring(La,tc),dd=new nF.a;dd.fullName=Nc.startsWith("@")?Nc.substr(1):Nc;Om.a(fb,dd);const Hd=new eJ.a;Om.b(fb,Hd);L&&(Hd.contentId=this.nok.kGf());B.RVf(Nc,dd,Hd);ba=!0;fb=null;La=tc}catch(Nc){var Cb=Object.assign(new rb.a,{extendedProperties:new Map});Cb.extendedProperties.set("exception",Nc.message);this.K9g.logKpiFailure("LPPWordEditorKPI",
"FailedToRenderAtMention",{isInternal:!0,additionalValues:Cb},{name:BB.mIe,isInternal:!0,additionalValues:Cb})}tc<=n&&!fb&&(Cb=Math.min(tc,n),Cb>La&&B.Ila(la.substring(La,Cb)),La=tc);$b.hyperlink&&$b.hyperlink.wI&&(fb=$b.hyperlink);if(tc>=n)break}}return{returnValue:!0,GVa:ba}}Cti(b,h,n,B,L=-1){var ba=!1,la=b.Eb(h),La=b.Eb(Ls.k(la));la=b.Eb(Ls.h(la));L=0<L?L:Number.MAX_VALUE;b=this.nMb(La,h,!0);h=this.nMb(la,h,!1);if(-1===b||-1===h)return{returnValue:!1,GVa:ba};if(La===la)return this.j5d(La,b,h,n,
B);const fb=this.ESa.Jra(La,!1,!1);if(!fb)return{returnValue:!1,GVa:ba};La=new ob.a;let Cb=0;do La.add(fb.my),Cb+=fb.my.characterData.length;while(fb.my!==la&&fb.lba()&&Cb<L);for(L=0;L<La.count;L++)if(ba=La.J(L),la=ba.characterData,L)if(L===La.count-1){if(!({GVa:ba}=this.j5d(ba,0,h,n,B)).returnValue)return{returnValue:!1,GVa:ba}}else{if(!({GVa:ba}=this.j5d(ba,0,la.length,n,B)).returnValue)return{returnValue:!1,GVa:ba};n.Ila("\n")}else{if(!({GVa:ba}=this.j5d(ba,b,la.length,n,B)).returnValue)return{returnValue:!1,
GVa:ba};n.Ila("\n")}return{returnValue:!0,GVa:ba}}i5d(b,h){const n=new AB;return this.Cti(b,h,n,!1,-1).returnValue?n.WFa:null}u2d(b,h){var n=b.Eb(h);if(!n)return null;b=b.Eb(Ls.h(n));if(!b)return null;h=this.nMb(b,h,!1);if(-1===h)return null;n=b.characterData;if(h>=n.length||!F.a.qga(n.charAt(h))){n=this.Pc.Mc(15);try{n.Ab(b),this.Qd.Ne(Nd.a.Tc(b,h)," ")}finally{n&&n.dispose()}}return Oe.SelectionFactory.se(b,h+1)}OLg(b,h){const n=b.Eb(h),B=new oF.a;this.Cti(b,h,B,!0).returnValue&&(B.Ila("\n"),this.Tq.C6j(n,
B.RQa),this.sa.raiseEvent(jq.a4n))}yNo(b,h){for(const n of b){if(n.contains(h))return!0;for(const B of n)for(const L of h)if(B.node===L.node&&B.lk>=L.lk)return!0}return!1}PYc(b,h,n,B,L){const ba=this.hb.gb.clone(),la=new bB.a(Ua.StaticActiveAppFrame.za().ib.sc);b=Oe.SelectionFactory.se(b,h);n=Nd.a.Tc(n,B);b=Oe.SelectionFactory.$y(b,n);this.hb.Ic(b);n=!this.yNo(ba,b);return 32===this.ga.lg(la,wb.a.SJ,2,!0,null,null)?(n?this.hb.Y0(ba):L!==S.a.nil&&(L=this.u2d(this.Ei.value,L),this.hb.Ic(L)),!0):!1}Qxo(b,
h){var n=b.Eb(h);const B=b.Eb(Ls.k(n));b=b.Eb(Ls.h(n));if(B===b){n=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var L=B.characterData.indexOf(n);-1!==L&&this.PYc(B,L,b,L+n.length,h)}}Lei(b,h,n){var B=b.Eb(h);if(!B)return!1;const L=b.Eb(Ls.k(B));b=b.Eb(Ls.h(B));B=this.nMb(L,h,!0);const ba=this.nMb(b,h,!1);if(-1===B||-1===ba||!this.PYc(L,B,b,ba,S.a.nil))return!1;n&&this.Vei(h);return!0}Vei(b){this.Tq.Bsg(b,!0)}Epp(b){var h=this.nCm(this.hb.gb);if(!h)return!1;const n=
this.glc(this.hb.gb,!0);if(1!==n.count)return!1;const B=h.Eb(n.J(0));if(b)h=this.Lei(h,n.J(0),!1);else{const L=Ls.k(B),ba=Ls.h(B);S.a.Bt(L,ba)||x.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.rBl(n.J(0));h.Eb(L).om(16,!0);h=!0}h&&(B.setValue(Lc.a.Rea,!0),this.sa.raiseEvent(jq.Dnj,new aD(B,b)));return h}hWh(b,h){b=this.glc(this.hb.gb,!1);h.Pm[jq.Agi]=!!b.count}Clj(b,h){if(h.Pm[jq.Agi]&&ea.ParagraphReader.Xb(h.clone)&&(h=h.clone,b=h.Lc)&&
(h=Nd.a.createTextRange(h,0,h.characterData.length),h=this.D4c(h,!1),h.count))for(const n of h)(h=b.Eb(n))&&h.setValue(Lc.a.yI,!1)}Tnm(b,h,n){let B;const L=({xVc:fb}=this.Tq.qXc(h,n,!0)).returnValue;n=({xVc:B}=this.Tq.qXc(h,n,!1)).returnValue;let ba=null,la=-1,La=-1;for(;fb<B;fb++){const Cb=h.qa.J(fb);if(Cb.hyperlink&&Cb.hyperlink.wI&&Cb.hyperlink.dw===b){ba=Cb.hyperlink;la=Cb.cp;break}}if(!ba||la<L)return{returnValue:!1,n9h:la,m9h:La};for(b=fb;b<h.qa.length;b++){var fb=h.qa.J(b);if(fb.cp>n)break;
if(fb.tX){La=fb.cp;break}}return{returnValue:-1!==La,n9h:la,m9h:La}}Tyo(b){var h=this.cEd.lmm(b);if(h){var n=null;Ua.StaticActiveAppFrame.za()&&(n=Ua.StaticActiveAppFrame.za().ib.$c.td);if(n){var B=n.Eb(h);h=n.Eb(Ls.k(B));var L=n.Eb(Ls.h(B));if(h!==L)x.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({n9h:b,m9h:L}=this.Tnm(b,h,B.id)).returnValue){var ba=new Sd.GraphTransaction(7);try{ba.Ab(h);const la=Nd.a.createTextRange(h,b,L);this.Qd.Ne(la,"");this.OLg(n,
B.id)}finally{ba&&ba.dispose()}this.hb.gb&&0<this.hb.gb.length?(n=this.hb.gb.J(0).Ra,n.node===h?x.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",n.cpBegin,b):x.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):x.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.hb.Ic(Oe.SelectionFactory.se(h,b))}else x.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else x.ULS.sendTraceTag(50954438,
323,15,"Unable to find object space for removing mention")}else x.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}vWm(b,h){if(!h){h=this.cEd.hjm(b);if(!h){x.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(const n of h)this.Tyo(n)}this.cEd.bAo(b)}Zgm(){cy.a.instance.Q7c();const b=new ob.a;for(const n of this.Tq.Rhf)if(n.Nr!==dy.a.dE){var h=S.a.Cf(n.objectId);h=this.Ei.value.Eb(h);this.yI(h,!0)&&b.add(h)}return b}YMo(b){b=this.Tq.ZNf(b);this.hb.Ic(b)}rBl(b){b?
this.Ei.value.Eb(b).setValue(Lc.a.yI,!1):x.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static S1f(b){return b===oc.a.Bd||b===oc.a.Xc||b===oc.a.paragraph}}jq.Agi="DisableNestedIntelligentPlaceholder";jq.nkj="CreateIntelligentPlaceholder";jq.Dnj="ResolveIntelligentPlaceholder";jq.a4n="UpdateIntelligentPlaceholder";jq.efd="DeleteIntelligentPlaceholder";jq.ZZn="MentionAddedToFollowUpEventKey";Object(u.a)(jq,"IntelligentPlaceholderEditor",null,[399,400,401]);class dr{constructor(b,
h,n,B){this.Jxa=!1;this.Qs=!0;this.ne=null;this.Cmb=L=>{if(!this.Qs||!this.Ukl(L,this.hb.gb))return!1;L.Kb.preventDefault();L.Kb.stopPropagation();this.nd.zd&&this.nd.zd.D_c(!1);L=this.u2d(this.hb.gb);if(!L)return!1;this.hb.Ic(L);return!0};this.nd=b;this.Ei=h;this.hb=n;this.n$=B}Mdc(b,h){this.Jxa||(b.lCa?(this.Dmb(h),this.Jxa=!0):b.Eja(()=>{this.Jxa||(this.Dmb(h),this.Jxa=!0)}))}dispose(){this.ne&&this.ne.xc(Cd.a.gL,this.nd.Ke.editingElement,this.Cmb)}Dmb(b){this.ne=b;this.nd.zd.nj&&this.ne.nb(Cd.a.gL,
this.nd.Ke.editingElement,this.Cmb)}Ukl(b,h){if(b.Kb.keyCode!==Jd.a.xz&&b.Kb.keyCode!==Jd.a.Mu||1!==h.length||!h.J(0).ly)return!1;var n=this.n$.glc(h,!0);if(1!==n.count)return!1;const B=h.J(0).Ra.node;if(!ea.ParagraphReader.Xb(B))return!1;b=this.n$.nMb(B,n.J(0),!0);n=this.n$.nMb(B,n.J(0),!1);return h.J(0).Ra.cpBegin<b||h.J(0).Ra.cpEnd>n?!1:!0}u2d(b){b=this.n$.glc(b,!0);if(1!==b.count)return null;b=b.J(0);return this.n$.u2d(this.Ei.value,b)}INj(b){this.Qs=b}}Object(u.a)(dr,"IntelligentPlaceholderKeyboardListener",
null,[397,13]);class CB{constructor(b,h){this.ibn=n=>{1===n&&this.ga.Ob(Pa.a.IMa,2);2===n&&(this.zDh.instance?this.zDh.instance.JAc("https://go.microsoft.com/fwlink/?linkid=2154656")&&F.a.IX("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):x.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));n=[Object.assign(new ia.a,{name:"DialogResult",int64:n})];Pe.d(Dc.a.tqi,void 0,
void 0,void 0,void 0,void 0,n)};this.ga=b;this.zDh=h}XEl(){const b=new ui.StandardDialog;b.Gd=11;b.Pe(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.Pe(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.Ix(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,0,this.ibn);Pe.a("FollowUpsPhaseOutDialogShown")}}Object(u.a)(CB,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var cD=d(1547);class Bq{constructor(b,h,n,B,L,ba){this.E$=
this.L4e=null;this.o8=()=>{this.E$||(this.E$=new Re.a(3,1,0,()=>{this.E$=null;this.dae(this.hb.gb)},130),this.Gb.Zb(this.E$))};this.Pc=b;this.VK=h;this.hb=n;this.Gb=B;this.Wbf=L;this.Ei=ba;this.J5=new wj.a;this.Ar=new cD.a;this.ozh=new mi.a(this.J5);this.VK.UPh((la,La)=>{this.uYk(La.lL)})}uYk(b){b=b.id;const h=this.REi(this.Ei.value,b);h&&this.Ar.Z(b,h)}REi(b,h){const n=b.Eb(h);return!n||this.VK.Goc(n)?null:this.VK.i5d(b,h)}pfl(b){const h=new cD.a;var n=this.VK.glc(b,!0);if(!n)return h;b=this.Ei.value;
for(const B of n)(n=this.REi(b,B))&&h.Z(B,n);return h}Bsg(b){if(this.L4e){const h=this.Pc.Mc(15);try{h.Ab(this.Wbf()),this.VK.Vei(this.L4e)}finally{h&&h.dispose()}}this.L4e=b?this.VK.NFm(b):null}XWm(b){const h=this.Ei.value;if(b=b?this.pfl(b):new cD.a){var n=new mi.a(this.J5),B=new mi.a(this.J5);Bq.brm(this.Ar,b,n,B);for(var L of n)this.Ar.Z(L,b.J(L));for(const ba of B)if(n=this.Ar.J(ba),B=this.VK.i5d(h,ba),this.Ar.remove(ba),B&&(b=L=!1,Qa.a.e5c().equals(B,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?
(b=!0,n=!1):n=-1<B.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?L=!0:!Qa.a.e5c().equals(n,B),n||L||b)){B=this.Pc.Mc(15);try{B.Ab(this.Wbf()),b?this.VK.Lei(h,ba,!0):(L&&this.VK.Qxo(h,ba),n&&this.VK.OLg(h,ba))}finally{B&&B.dispose()}}}}KEm(b){const h=new mi.a(this.J5);for(const n of b)for(const B of n)b=B.node,ea.ParagraphReader.Xb(b)&&h.add(b.id);return h}oVm(b){var h=this.Ei.value;const n=b?this.KEm(b):new mi.a(this.J5);if(n){b=new ob.a;for(const ba of this.ozh)if(!n.contains(ba)){var B=
h.Eb(ba);if(B){B=B.qa;for(let la=0;la<B.length;la++){const La=B.J(la).kf;if(La)for(let fb=0;fb<La.length;fb++){var L=La.J(fb);L.Wc&&(L=h.Eb(L.nk))&&L.ja(Lc.a.T3i,!1)&&S.a.Bt(ba,Ls.h(L))&&this.VK.Goc(L)&&b.add(L)}}}}this.ozh=n;if(b.count){h=this.Pc.Mc(7);try{h.Ab(this.Wbf());for(const ba of b)ba.qg(Lc.a.T3i)}finally{h&&h.dispose()}}}}dae(b){this.Bsg(b);this.XWm(b);this.oVm(b)}d0h(){this.E$&&(this.Gb.vf(this.E$),this.E$=null)}nWb(){if(this.E$||this.Ei.USf)this.d0h(),this.dae(null)}LE(){this.hb.Cw(this.o8);
A.AFrameworkApplication.aJ(()=>{this.nWb()})}dispose(){this.hb.nY(this.o8);this.d0h()}static brm(b,h,n,B){for(const L of h){const ba=L.key;b.mb(ba)||n.add(ba)}for(const L of b)b=L.key,h.mb(b)||B.add(b)}}Object(u.a)(Bq,"IntelligentPlaceholderSelectionCache",null,[13]);var Ip;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=1]="contextMenu";b[b.T$k=2]="atMention";b[b.jnq=3]="textGesture";b[b.paste=4]="paste";b[b.vJp=5]="workItemIntent";b[b.YUp=6]="characterTrigger"})(Ip||(Ip={}));Object(u.b)("IntelligentPlaceholderCreation",
Ip);class ts{constructor(b,h,n,B){this.nGa=b;this.Fn=h;this.U4b=n;this.Oy=B}kze(b){return b&&b.Lc&&b.Lc.id.equals(this.Oy.value.td.id)?!0:!1}NSj(b){return this.kze(b)&&b.ja(Lc.a.yI,!1)?!0:!1}zEn(){this.U4b.execute(b=>{b.logAction({actionType:Bo.b.SessionStart,engagement:Bo.a.Offer,objectName:ts.Bzc})})}Iie(b,h){const n=2==h&&this.kze(b);if(this.NSj(b)||n){var B=b.getValue(Lc.a.MG);this.U4b.execute(L=>{L.logAction({actionType:Bo.b.Created,engagement:Bo.a.None,objectName:ts.Bzc,objectId:B.toString(),
objectFulfillment:Ip[h]})})}}xCn(b){if(this.NSj(b)){var h=b.getValue(Lc.a.MG);this.U4b.execute(n=>{n.logAction({actionType:Bo.b.Deleted,engagement:Bo.a.None,objectName:ts.Bzc,objectId:h.toString()})})}}aFn(b,h){if(this.kze(b)){var n=b.getValue(Lc.a.MG);this.U4b.execute(B=>{B.logAction({actionType:Bo.b.Resolved,engagement:Bo.a.None,objectName:ts.Bzc,objectId:n.toString(),objectFulfillment:h?"RemoveText":"KeepText"})})}}SFn(b){b===Dc.a.lce&&this.U4b.execute(h=>{h.logAction({actionType:Bo.b.Deleted,
engagement:Bo.a.None,objectName:ts.Bzc,objectFulfillment:ts.$hp})})}cEn(b){if(this.kze(b)){var h=b.getValue(Lc.a.MG);this.U4b.execute(n=>{n.logAction({actionType:Bo.b.Modified,engagement:Bo.a.None,objectName:ts.Bzc,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}bcl(){this.zEn();this.nGa.UPh((b,h)=>{this.Iie(h.lL,h.kbo)});this.nGa.v1k((b,h)=>{this.aFn(h.lL,h.Apn)});this.nGa.b1k((b,h)=>{this.cEn(h.lL)});this.Fn.Qcc((b,h)=>{this.SFn(h.actionId)});Ch.a.xgf((b,h)=>{this.xCn(h.lL)})}}ts.Bzc=
"IntelligentPlaceholder";ts.$hp="Undo";Object(u.a)(ts,"IntelligentPlaceholderTelemetry",null,[]);class kq{constructor(){this.n$=this.OFd=this.kMd=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}wc(b){this.W=b;b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",()=>new CB(A.AFrameworkApplication.va,b.Qa("Common.App.SafeLinks.ISafeLinksManager"))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new wt).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").ha();
b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new jq(A.AFrameworkApplication.va,new Vl.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c.td),b.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",
()=>new mF(A.AFrameworkApplication.va,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new Bq(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.ISelectionManager"),
A.AFrameworkApplication.mc,()=>Ua.StaticActiveAppFrame.za().ib.sc.jd,new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c.td))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new dr(Object(Pb.a)(),new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c.td),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",
()=>new ts(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.Qa("CanvasContextual.ICanvasContextualController"),new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c))).ha()}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo()})}Mo(){const b=this.W.resolve("Box4.IFeatureHelper");this.W.Qa("WordEditor.CanvasContextualProvider.UxManager");this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Wb();
this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").bcl();this.n$=this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");ev.a.V_k(Object(z.a)(this.n$,this.n$.hWh,"beforeIntelligentPlaceholderPaste"));ev.a.QRd(Object(z.a)(this.n$,this.n$.Clj,"onIntelligentPlaceholderPaste"));this.kMd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(95)||this.kMd.LE();this.OFd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");
this.OFd.Mdc(Ua.StaticActiveAppFrame.za().ib,bb.KeyInputManager.instance);this.vuo(this.W.Qa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.kMd&&this.kMd.dispose();this.OFd&&this.OFd.dispose();this.n$&&(ev.a.lAo(Object(z.a)(this.n$,this.n$.hWh,"beforeIntelligentPlaceholderPaste")),ev.a.QAo(Object(z.a)(this.n$,this.n$.Clj,"onIntelligentPlaceholderPaste")))}vuo(b,h,n){b&&b.execute(B=>
{B.kY(new pH(h,n))})}static main(){M.a.instance.Jc(new kq)}}Object(u.a)(kq,"PackageManager",null,[0,1]);var yo=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",
attrs:{Id:"NavControls",DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},
children:[{name:"Row",attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",
attrs:{Id:"GroupReplaceControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",
Image16by16:"IMGMAP@we@UpArrow_16x16x32",LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},qH=d(2231),it=d(2084),Rt=d(2178);class bz{}bz.Dap="Search_16x16x32";bz.vap="ClosePaneGlyph_16x16x32";
Object(u.a)(bz,"SearchBoxIcons",null,[]);var Yr=d(2181),fy=d(2182),Ww=d(2180);class qv{constructor(){this.jih=null}get key(){return"FIND_HIT"}get Av(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.jih=b.node.cWa()}$Ea(b){let h=null;for(const n of this.jih)if(n.Fc<=b&&b<n.end)return h=Object.assign(new By.a,{UF:this.key,contentObject:n}),{returnValue:!0,zG:h};return{returnValue:!1,zG:h}}}Object(u.a)(qv,"FindHitDetailsProvider",null,[405,406]);var lq=d(1744),iw=d(1659),
rF=d(1701),pu=d(1756);class Pu{constructor(b,h,n,B,L,ba,la,La=null,fb=null){this.an=null;this.find=(Cb,Lb,$b,tc,Nc)=>1===$b?32:void 0===Nc||null===Nc?8:Nc.length?this.yFg(Nc):(this.Unf(Rt.a.initial),32);this.Hic=(Cb,Lb,$b,tc,Nc)=>this.WUj(Dc.a.Pyb,Cb,Lb,$b,tc,Nc);this.h8l=(Cb,Lb,$b,tc,Nc)=>this.WUj(Dc.a.Qyb,Cb,Lb,$b,tc,Nc);this.Woi=(Cb,Lb,$b)=>1===$b?32:this.yFg(this.gp.ZVa());this.Pid=(Cb,Lb,$b,tc,Nc)=>{Cb=!this.gp.cI;Nc[If.a.Image16by16Class]=Cb?Bb.getImageClass(bz.Dap):Bb.getImageClass(bz.vap);
Nc[If.a.LabelText]=Cb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;Nc[If.a.ApplyLabelTextToControlOnly]=!0;Nc[If.a.EnsureControlRoleIsButton]=!0;Nc[If.a.On]=!1;return 32};this.m9l=(Cb,Lb,$b)=>{if(1===$b)return 32;this.vLi(!1);return 32};this.x9l=(Cb,Lb,$b)=>{if(1===$b)return 32;this.vLi(!0);return 32};this.Uog=(Cb,Lb,$b,tc,Nc)=>{Nc[Dl.a.Visible]=this.gp.cVj;return 32};this.fpg=(Cb,Lb,$b,tc,Nc)=>{Nc[Dl.a.Visible]=this.gp.cVj;return 32};
this.x$d=(Cb,Lb,$b,tc,Nc)=>{if(1===$b)return 32;this.zC.dmd.CLi(Nc);return 32};this.XUd=(Cb,Lb,$b)=>{if(1===$b)return 32;this.Unf(Rt.a.initial);return 32};this.VVc=(Cb,Lb,$b)=>{if(1===$b)return 32;pu.a.Usd();this.Unf(Rt.a.initial);this.gp.lA(!1);return 32};this.TIa=(Cb,Lb,$b)=>{if(1===$b)return this.hfn(Cb===Pa.a.u3h);this.gp.TIa();return 32};this.gFe=(Cb,Lb,$b)=>{if(1===$b)return 32;switch(Cb){case Pa.a.ODf:this.gp.matchCase=!this.gp.matchCase;break;case Pa.a.gEf:this.gp.matchWholeWord=!this.gp.matchWholeWord}return this.yFg(this.gp.ZVa())};
this.Wre=(Cb,Lb,$b,tc,Nc)=>{Nc[$g.a.On]=this.gp.matchCase;return 32};this.Yre=(Cb,Lb,$b,tc,Nc)=>{Nc[$g.a.On]=this.gp.matchWholeWord;return 32};this.Cog=(Cb,Lb,$b,tc,Nc)=>{Cb=this.gp.matchCase;Lb=this.gp.matchWholeWord;$b="";Cb&&Lb?$b=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Cb?$b=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):
Lb&&($b=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));Nc[Am.a.Value]=$b;Nc[Am.a.Visible]=Cb||Lb;return 32};this.Nuc=(Cb,Lb,$b,tc,Nc)=>{Cb=this.gp.Q5;Lb="";switch(this.gp.cI){case Rt.a.NXj:Lb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case Rt.a.oKj:Lb=Cb?this.CNf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case Rt.a.Rxb:Lb=this.CNf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);
break;case Rt.a.Vha:Lb=this.CNf(this.gp.TLa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case Rt.a.JYa:Lb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case Rt.a.Avc:Lb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case Rt.a.zvc:Lb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}Nc[Am.a.Value]=Lb;return 32};this.Xre=(Cb,Lb,$b,tc,Nc)=>{Nc&&(Nc.CommandValueId=this.gp.ZVa());return 32};this.replace=
(Cb,Lb,$b,tc,Nc)=>{if(1===$b)return this.w0f()?32:8;if(!this.w0f())return 8;Cb=this.gp.yQb();"string"===typeof Nc&&Nc&&(Cb=Nc);x.ULS.sendTraceTag(6033813,312,50,"Replace Called");Pe.a("NavigationPaneReplace");Nc=this.AHb.replace(Cb);this.gp.PQo(Nc);return 32};this.replaceAll=(Cb,Lb,$b,tc,Nc)=>{if(1===$b)return this.Hpn()?32:8;Cb=this.gp.yQb();"string"===typeof Nc&&Nc&&(Cb=Nc);Pe.a("NavigationPaneReplace");this.an=this.Vd.Vf("UserAction","ReplaceAll");this.gp.qaa(Rt.a.Avc);x.ULS.sendTraceTag(4065348,
312,50,"Replace All started feedback indicated to user.");rF.a.$Co(this.gp.ZVa(),this.gp.yQb());this.AHb.replaceAll(Cb,this.w1n);return 32};this.w1n=(Cb,Lb)=>{this.an&&(this.an.stop(),this.an=null);x.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Cb,["TotalCount"]:Lb});rF.a.XCo(Cb,Lb);this.gp.qaa(Rt.a.zvc)};this.bxj=(Cb,Lb,$b,tc,Nc)=>{Lb=!1;if(!Nc)return 8;this.gp.Nj.isVisible&&(Lb=Cb===Dc.a.hjd===this.gp.y4c());Cb!==Dc.a.hjd||this.uqh||(Lb=!1);Nc[$g.a.On]=Lb;return 32};
this.Dog=(Cb,Lb,$b,tc,Nc)=>{if(!Nc||!this.gp.Nj.isVisible)return 32;Nc[$g.a.On]=this.gp.TLa;return 32};this.Fog=(Cb,Lb,$b,tc,Nc)=>{if(!Nc)return 32;Nc.currentFindReplaceViewType=this.gp.cI;return 32};this.ako=(Cb,Lb,$b,tc,Nc)=>{if(1===$b)return 32;Cb=Nc[$g.a.On];Nc&&(Nc[$g.a.On]=this.gp.Nj.isVisible);Cb&&!Nc[$g.a.On]&&(Pu.W2j(),Pe.a("NavigationPaneCrossClick"));return 32};this.t0a=(Cb,Lb,$b,tc,Nc)=>{const dd=this.gp.Nj.isVisible;x.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",dd);return dd?this.VVc(Cb,
Lb,$b,tc,Nc):this.byc(Cb,Lb,$b,tc,Nc)};this.byc=(Cb,Lb,$b,tc,Nc)=>{if(1===$b)return hc.SessionStatusManager.instance.ZA?32:8;if(2===$b){Pu.W2j();this.E8();lq.FindReplaceUIManager.Dil(Cb,Nc,this.gp.Nj.isVisible);Lb=!0;Cb===Dc.a.gyc&&void 0!==Nc&&null!==Nc&&(Lb=Nc);this.gp.lA(!0,Lb);Nc=Ww.a.initial;switch(Cb){case Dc.a.cyc:x.ULS.sendTraceTag(42501022,367,50,"");Nc=Ww.a.headings;break;case Dc.a.Pyb:Nc=Ww.a.find;break;case Dc.a.Qyb:Nc=Ww.a.replace;break;case Dc.a.gyc:Nc=Ww.a.intelligentPlaceholder;break;
case Dc.a.t0a:Nc=this.gp.xgc,Nc||(x.ULS.sendTraceTag(42501023,367,50,""),Nc=Ww.a.headings)}this.gp.LVo(Nc,Lb);pu.a.opp();return 32}return 8};this.OMa=()=>{this.gp.cI&&!this.gp.TLa&&x.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.gp=h;this.zC=n;this.AHb=B;this.uqh=L;this.Vd=la;fb&&fb(1,this.OMa,null);this.vRa=La}E8(){}Wb(){this.ga.fb(Dc.a.wpg,oc.a.view,this.ako,96);this.ga.ra(Dc.a.t0a,oc.a.view,this.t0a);this.ga.ra(Dc.a.cyc,oc.a.view,this.byc);this.ga.ra(Dc.a.Pyb,
oc.a.view,this.byc);this.ga.ra(wb.a.TDf,oc.a.view,this.find);this.ga.ra(Pa.a.Hic,oc.a.view,this.Hic);this.ga.ra(wb.a.SDf,oc.a.view,this.Woi);this.ga.fb(Pa.a.Bjo,oc.a.view,this.Pid,97);this.ga.ra(wb.a.gcg,oc.a.view,this.m9l);this.ga.ra(wb.a.Amg,oc.a.view,this.x9l);this.ga.fb(wb.a.Uog,oc.a.view,this.Uog,97);this.ga.fb(wb.a.fpg,oc.a.view,this.fpg,97);this.ga.ra(Dc.a.x$d,oc.a.view,this.x$d);this.ga.ra(wb.a.zec,oc.a.view,this.XUd);this.ga.ra(Pa.a.TIa,oc.a.view,this.TIa);this.ga.ra(Pa.a.u3h,oc.a.application,
this.TIa);this.ga.ra(Dc.a.VVc,oc.a.view,this.VVc);this.ga.ra(Pa.a.ODf,oc.a.view,this.gFe);this.ga.ra(Pa.a.gEf,oc.a.view,this.gFe);this.ga.fb(Pa.a.Wre,oc.a.view,this.Wre,97);this.ga.fb(Pa.a.Yre,oc.a.view,this.Yre,97);this.ga.fb(Dc.a.Cog,oc.a.view,this.Cog,97);this.ga.fb(Dc.a.Nuc,oc.a.view,this.Nuc,97);this.ga.fb(Dc.a.Dog,oc.a.view,this.Dog,97);this.ga.fb(Dc.a.Fog,oc.a.view,this.Fog,97);this.ga.fb(Dc.a.Eog,oc.a.view,this.bxj,97);Object(iw.b)()&&this.ga.fb(Dc.a.Xre,oc.a.view,this.Xre,96);this.uqh&&(this.ga.fb(Dc.a.Qyb,
oc.a.view,this.byc,1028),this.ga.fb(Dc.a.hjd,oc.a.view,this.bxj,97),this.ga.fb(Dc.a.replace,oc.a.view,this.replace,1028),this.ga.fb(Dc.a.replaceAll,oc.a.view,this.replaceAll,1028),A.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)&&this.ga.fb(Pa.a.$Df,oc.a.view,this.h8l,1028));this.ga.ra(Dc.a.gyc,oc.a.view,this.byc)}hrg(){this.vRa&&this.vRa.execute(b=>{b.kY(new qv)})}WUj(b,
h,n,B,L,ba){if(1===B)return hc.SessionStatusManager.instance.ZA?32:8;if(void 0===ba||null===ba)return 8;this.byc(b,n,2,L,ba);b=this.gp;b.Ezg(ba.CommandValueId);Object(iw.b)()&&("MatchCase"in ba&&(b.matchCase=ba.MatchCase),"MatchWholeWord"in ba&&(b.matchWholeWord=ba.MatchWholeWord));return this.Woi(h,n,B,L,ba)}yFg(b){if(void 0===b||null===b||!b.length)return 32;b=Yr.a.createQuery(b,this.Gjo);if(void 0===b||null===b)return x.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.zC.find(b);return 32}get Gjo(){let b=
fy.a.none;this.gp.matchCase&&(b|=fy.a.matchCase);this.gp.matchWholeWord&&(b|=fy.a.ZOg);return b}vLi(b){this.gp.xgc!==Ww.a.headings&&this.gp.Q5&&(b?this.zC.dmd.MSm():this.zC.dmd.xLi())}Unf(b){this.gp.cI&&(this.gp.TLa||x.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.zC.F6a(),this.gp.qaa(b))}hfn(b){return this.gp.cI===Rt.a.Avc||b&&!this.gp.cI?8:32}CNf(b){return String.format(b,this.gp.rzd,this.gp.Q5)}w0f(){return this.gp.y4c()&&0<this.gp.Q5}Hpn(){return this.w0f()&&
this.gp.TLa}static W2j(){null!=A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},Pu.GJa)}static hsm(b,h,n,B){return new Pu(A.AFrameworkApplication.va,b,h,n,B,Ph.FocusManager.instance(),Ua.StaticActiveAppFrame.za().hs,Ya.a.instance.Qa("Box4.Accessibility.IAccessibilityContextManager"),Object(z.a)(A.AFrameworkApplication.ua.AS,
A.AFrameworkApplication.ua.AS.nb,"registerHandler"))}static gsm(b,h,n,B){return Pu.hsm(b,h,n,B)}}Pu.GJa=5E3;Object(u.a)(Pu,"FindReplaceActor",null,[]);var bo=d(978),jA=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.HM},set:function(h){this.HM=h},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"last",{get:function(){return this.q3a},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};
b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,n){this.removeItem(h);n={key:h,NI:this.q3a,next:void 0,data:n};this.first||(this.first=n);this.q3a&&(this.q3a.next=n);this.q3a=n;this._map.set(h,n)};b.prototype.insertAfter=function(h,n,B){h=this._map.get(h);if(!h)return!1;B={key:n,NI:h,next:h.next,data:B};var L=h.next;L&&(L.NI=B);h.next=B;this._map.set(n,B);return!0};b.prototype.insertBefore=function(h,n,B){h=this._map.get(h);if(!h)return!1;B={key:n,NI:h.NI,next:h,
data:B};var L=h.NI;L&&(L.next=B);h.NI=B;this._map.set(n,B);return!0};b.prototype.removeItem=function(h){var n=this._map.get(h);n&&(this.first===n&&(this.first=n.next),this.q3a===n&&(this.q3a=n.NI),n.NI&&(n.NI.next=n.next),n.next&&(n.next.NI=n.NI),this._map.delete(h))};return b}();class dD{constructor(){this.type="heading"}}Object(u.a)(dD,"NavPaneHeadingItem",null,[]);class sF{constructor(){this.type="bookmark"}}Object(u.a)(sF,"NavPaneBookmarkItem",null,[]);class jw{constructor(b,h,n,B,L,ba,la){this.jb=
b;this.hb=h;this.Yb=n;this.zp=B;this.g4=L;this.CH=ba;this.lyk=la;this.w4a=0;this.VHd=new Map;this.jlh=!1;this.IFa=new Map}get headingsReady(){return this.jlh}set headingsReady(b){this.jlh=b}get jYb(){return this.w4a}get z8(){this.Y9b&&0!=this.Y9b.length()||(this.Y9b=this.Aeo());return this.Y9b}set z8(b){this.Y9b=b}get r_b(){return this.mMk}set r_b(b){this.r_b&&(this.r_b.isSelected=!1);b.isSelected=!0;this.mMk=b}ZLf(b,h){return"bookmark"===b.type?b.text:h.id.toString()}Aeo(){const b=new jA;if(!this.g4)return b;
this.VHd=new Map;let h;const n=[];for(const B of this.g4.paragraphs()){const L=this.JCi(B,n);null===L||void 0===L?void 0:L.forEach(ba=>{(h=this.wEi(ba,n))&&"heading"===h.type&&h.indentLevel<ba.indentLevel&&(1>=h.indentLevel?(h.isCollapsed=!1,ba.isHidden=!1):(h.isCollapsed=!0,ba.isHidden=!0));b.insert(this.ZLf(ba,B),ba)})}return b}wEi(b,h){return"heading"===b.type?1<h.length?h[h.length-2]:void 0:0<h.length?h[h.length-1]:void 0}yMg(b){var h;let n=ea.ParagraphReader.C9a(b),B=!1;9===n&&this.IFa.has(b.id.toString())&&
(n=this.IFa.get(b.id.toString()),B=!0);const L=null===(h=this.z8.get(b.id.toString()))||void 0===h?void 0:h.data;if(L){if(L.indentLevel===n){h=Cn.AParagraphNode.iV(b.characterData.trim());b=this.zp.value.zjg(b);if(h!==L.text||L.hasBookmark!==b)return L.text=h,L.hasBookmark=b,!0;!B&&L.isPurelyADH&&(L.isPurelyADH=!1,--this.w4a);return!1}this.Whd();return!0}if(9===n)return this.Mdn(b)?(this.Whd(),!0):!1;this.Whd();return!0}Mdn(b){var h;const n=this.zp.value.qui(b);b=null!==(h=this.VHd.get(b.id.toString()))&&
void 0!==h?h:0;if(b!==n.length)return!0;for(h=0;h<b;++h)if(!this.z8.get(n[h].uqb()))return!0;return!1}tQl(b){if(this.z8.get(b.id.toString())||this.zp.value.zjg(b))return this.Whd(),!0;this.IFa.has(b.id.toString())&&(this.IFa.delete(b.id.toString()),--this.w4a);return!1}Whd(){const b=new jA;this.w4a=0;if(this.g4){this.VHd=new Map;var h=[],n,B;for(const L of this.g4.paragraphs()){const ba=this.JCi(L,h);null===ba||void 0===ba?void 0:ba.forEach(la=>{var La=this.ZLf(la,L);B=this.wEi(la,h);this.sHo(La,
la,B);b.insert(La,la);"heading"===(null===n||void 0===n?void 0:n.type)&&(La=n,La.indentLevel>=la.indentLevel&&(La.isCollapsed=void 0));n=la})}}this.z8=b}sHo(b,h,n){var B,L;if(b=null===(B=this.Y9b.get(b))||void 0===B?void 0:B.data)b.isSelected&&(h.isSelected=!0,this.r_b=h),h.isHidden=b.isHidden;if(n){if(B=null===(L=this.Y9b.get(this.ZLf(n,n.paragraphNode)))||void 0===L?void 0:L.data)n.isCollapsed=B.isCollapsed;n.isCollapsed?h.isHidden=!0:n.isHidden?(n.isCollapsed=!0,h.isHidden=!0):(n.isCollapsed=!1,
h.isHidden=!1)}}JCi(b,h){var n=ea.ParagraphReader.C9a(b),B=!this.Zjn(b);const L=this.$jn(n)&&B?!0:!1;B=this.IFa.has(b.id.toString())&&B;const ba=[];if(L)ba.push(this.J$h(b,n,!1,h));else if(B)this.w4a+=1,this.a0c&&(n=this.IFa.get(b.id.toString()),ba.push(this.J$h(b,n,!0,h)));else{let la=0;this.zp.value.qui(b).forEach(La=>{const fb=new sF;fb.text=La.uqb();fb.isSelected=!1;fb.bookmarkManager=this.zp;fb.indentLevel=0<h.length?h[h.length-1].indentLevel+1:0;la+=1;ba.push(fb)});this.VHd.set(b.id.toString(),
la)}return ba}J$h(b,h,n,B){var L,ba;const la=new dD;la.text=Cn.AParagraphNode.iV(b.characterData.trim());la.indentLevel=h;la.paragraphNode=b;la.isSelected=!1;la.isPurelyADH=n;la.listMarker=this.pMf(b);la.hasBookmark=this.zp.value.zjg(b);for(b=null===(L=B[B.length-1])||void 0===L?void 0:L.indentLevel;b&&b>=h;)B.pop(),b=null===(ba=B[B.length-1])||void 0===ba?void 0:ba.indentLevel;(!b||b<h)&&B.push(la);return la}Zjn(b){return this.jb.Xb(b)&&0===this.jb.textLength(b,9)}Tqm(b){for(b=this.g4.h4c(b);b;){let h=
this.z8.get(b.node.id.toString());for(;h;){const n=h.data;if("heading"===n.type&&!n.isHidden)return n;h=h.NI}b=b.NI}}f4l(b){(b=this.z8.get(b))&&(1==b.data.isCollapsed?this.hVj(b):this.p0m(b))}onClickHeading(b){var h;this.r_b=b=null===(h=this.z8.get(b))||void 0===h?void 0:h.data;h=Oe.SelectionFactory.se(b.paragraphNode,0);this.hb.Ic(h);this.Yb.Bg(Dd.AFrame.Ho)}onClickBookmark(b){var h;this.r_b=b=null===(h=this.z8.get(b))||void 0===h?void 0:h.data;this.zp.value.ISm(b.text);this.Yb.Bg(Dd.AFrame.Ho)}K0m(b){var h,
n;if(b=null===(n=null===(h=b.entries())||void 0===h?void 0:h.next())||void 0===n?void 0:n.value)if(h=this.Tqm(b[0]))this.r_b=h}onShareHeadingClick(b){var h;Pe.a("CreateHeadingLinkThroughNavPane",!0,void 0);if(b=null===(h=this.z8.get(b))||void 0===h?void 0:h.data)h=b.paragraphNode.getValue(Lc.a.Yc),this.lyk.value.K$h(h)}LLg(b,h){const n=b.id.toString(),B=this.IFa.has(n);if(!B||this.IFa.get(n)!==h){this.IFa.set(n,h);if(this.a0c)return this.yMg(b);B||this.z8.get(n)||(this.w4a+=1)}return!1}LPl(b){const h=
b.id.toString(),n=this.IFa.has(h);if(n){this.IFa.delete(h);if(this.a0c)return this.yMg(b);n&&!this.z8.get(h)&&--this.w4a}return!1}Kkp(b){this.a0c=b;this.Whd()}iMg(b){var h;const n=null===(h=this.z8.get(b.id.toString()))||void 0===h?void 0:h.data;if(!n)return!1;b=this.pMf(b);if(n.listMarker===b)return!1;this.Ftp();return!0}r_d(b){var h;b=null===(h=this.z8.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;return!0}hVj(b){var h=b.data;1==h.isCollapsed&&
(h.isCollapsed=!1);h=h.indentLevel;b=b.next;let n;for(;b&&b.data.indentLevel>h;)n=b,b=n.next,n.data.isHidden=!1,"heading"==n.data.type&&(b=n.data.isCollapsed?this.E9o(n):this.hVj(n));return b}p0m(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let n;for(;b&&b.data.indentLevel>h;)n=b,b=n.next,n.data.isHidden=!0}E9o(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}$jn(b){return 0<=b&&8>=b}Ftp(){let b=this.z8.first;for(;b;){if("heading"===b.data.type){const h=
b.data;h.listMarker=this.pMf(h.paragraphNode)}b=b.next}}pMf(b){var h;if(b.sF instanceof bo.a)return this.vQm(null===(h=this.CH.lMa(b.sF))||void 0===h?void 0:h.$R)}vQm(b){for(let h=0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(u.a)(jw,"NavPaneHeadingsManager",null,[]);var Qu=d(1660);class Br{constructor(){this.AHb=this.zC=this.EHc=this.BBd=this.W=null}get name(){return"WordEditor.FindReplace"}wc(b){var h;this.W=b;A.AFrameworkApplication.Ld("ImprovedNavPaneDiscoverability;ImprovedNavPaneDiscoverabilityCf");
(null===(h=A.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImprovedNavPaneDiscoverabilityIsEnabled",!1))&&pu.a.initialize(b.Qa("Common.IDynamicScriptLoaderProvider"),"WACViewPanelContainer");const n=new jw(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.ISelectionManager"),Ph.FocusManager.instance(),b.rf("WordEditor.Bookmark.IBookmarkManager"),b.resolve("Box4.IParagraphCollection"),b.resolve("Box4.IListMarkerUtility"),b.rf("WordEditor.Actors.HeadingsActor"));
this.W.ia("WordEditor.FindReplace.NavPaneHeadingsManager",()=>n).as("WordEditor.FindReplace.NavPaneHeadingsManager").ha()}init(){Br.rc.Ds.continueWith(()=>{this.Mo()})}Mo(){if($e.App.hPg){const b=$e.App.YGe;this.EHc=lq.FindReplaceUIManager.getInstance(b);this.zC=it.FindManager.createInstance(this.EHc,qH.a.instance,Qu.a.instance,!0);this.AHb=this.zC.zZb;this.BBd=Pu.gsm(this.EHc,this.zC,this.AHb,b);this.BBd.Wb();this.BBd.E8();this.BBd.hrg();Ua.StaticActiveAppFrame.za().Ie()}}dispose(){this.EHc&&this.EHc.dispose()}static get rc(){return null!=
Br.tWg?Br.tWg:Br.tWg=Ya.a.instance.resolve("Box4.IFeatureHelper")}}Object(u.a)(Br,"FindReplacePackageManager",null,[0,1]);class kw{constructor(){}kGf(){return"_@_"+yb.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}Bwp(b,h,n,B){h.RQo(b,B);h.Sm(b,Hf.a.ada,!0);h.Sm(b,Lc.a.QXa,!0);h.Sm(b,Lc.a.G_,kw.Nni(n));h.Sm(b,Lc.a.mt,15)}W2k(b,h,n,B){const L=b.AYd(B);h.Sm(L,Hf.a.ada,!0);h.Sm(L,Lc.a.mt,47);h.Sm(L,Lc.a.G_,kw.Nni(n));b=b.AYd(B);h.Sm(b,Hf.a.ada,!0);h.Sm(b,Lc.a.mt,16);return[L.Dk,
b.Dk]}Mem(b,h,n){b=b.AYd(n);h.Sm(b,Hf.a.ada,!0);h.Sm(b,Lc.a.FTb,!0);return b.Dk}static Nni(b){return String.format(' HYPERLINK "{0}"',b)}}Object(u.a)(kw,"AtMentionHyperlinkConfigurator",null,[363]);var lw=d(1677);class Ru{constructor(b,h,n){this.Pia=b;this.hb=h;this.oNi=this.OVi=this.MXe=!1;this.DWb=this.DWb.bind(this);this.EWb=this.EWb.bind(this);this.OWb=this.OWb.bind(this);n&&n.execute(B=>{this.W1a=B});Es.a.tTd.ZIf.then(B=>{this.oNi=!0;this.OVi=B.isSuccess})}Vte(){this.Pia.urg(this.DWb);this.Pia.vrg(this.EWb);
this.Pia.Hrg(this.OWb)}Ife(){return!1}DWb(b,h,n){var B,L;h=Date.now();if(this.W1a)if(this.oNi&&!this.OVi)x.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");else{var ba=null===(L=null===(B=this.hb.gb)||void 0===B?void 0:B.currentSelection)||void 0===L?void 0:L.Uc;ba?(B=ba.node,ea.ParagraphReader.Xb(B)?(L=ea.ParagraphReader.text(B),0>n||n>L.length?x.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the prefix was not within the bounds of the paragraph."):
1<b.length&&("@"===b.trimEnd()||lw.a.jCc&&"/"===b.trimEnd())?(Pe.c(Dc.a.mAl,!0,void 0,void 0,void 0,void 0),this.Pia.reset()):(this.MXe?this.W1a.cxp():(this.MXe=!0,this.W1a.C8o(ba)),this.W1a.SLg(n,n+b.length),b=L.substring(0,n)+b,this.W1a.AGf(B,b,n,h))):x.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):x.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else x.ULS.sendTraceTag(537776153,
3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}EWb(b){if(this.W1a)this.W1a.onKeyDown(b)}OWb(){this.MXe=!1;this.W1a&&this.W1a.d4h()}}Object(u.a)(Ru,"ContextIQUserInitHandler",null,[248]);class Zr{constructor(){this.rB=null}get name(){return"WordEditor.AtMentions"}wc(b){this.W=b;b.ia("Box4.IAtMentionHyperlinkConfigurator",()=>new kw(b.resolve("Box4.IFeatureHelper"))).ha();const h={crewAlias:Zr.cek,featureName:Zr.Pfk,topLevelKpiName:Zr.Ljk,vetoPillar:7};
b.ia("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new Vm.a(oa.Health.instance,new Xk.a,h)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").ha()}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo()})}dispose(){}Mo(){this.W.Qa("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(h=>{A.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(h=h&&A.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));(h||
lw.a.Bvd())&&this.Rzn()})});this.W.resolve("Box4.IAtMentionHyperlinkConfigurator")}Rzn(){(A.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.W.resolve("Common.IDynamicScriptLoaderProvider").xC.loadScript("canvasAtMentions")).then(()=>{A.AFrameworkApplication.K.Rn(()=>{this.Oso()})})}Oso(){const b={peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:A.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},
useLPP:!0,isTestEnv:this.Asn()};this.rB=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFeatureEnabled("MsoContextIq",!1).then(n=>{n&&lw.a.Cvd()||!n&&lw.a.Bvd()?(lw.a.WXf=!n,this.W.ia("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new Ru(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.Qa("WordEditor.CanvasContextual.ContextIQIntentProvider"))).ha()):
this.W.ia("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new qF(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.rB,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.ISelectionManager"),Object(Pb.a)(),this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).ha();
this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").Vte()})})}Asn(){var b,h;const n=null!==(b=A.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==b?b:"-1";b=null!==(h=A.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return n===Zr.Pdk&&b===Zr.Odk}}Zr.Pdk="-4";Zr.Odk="DC2";Zr.cek="webasynccollabeng";Zr.Pfk="AtMentions";Zr.Ljk="AtMentionsFeatureUsage";Object(u.a)(Zr,"PackageManager",null,[0,1]);var Uh=d(1794),dp=d(1437);class rH{constructor(b,
h,n,B){this.ga=b;this.Re=h;this._augLoopRuntimeManager=n;this.SSk=B;this.Nya=0;this.uQd=this.uac=!1;this.Bah=this.hCh=this.Z0e=this.iCh=0;this.nCb=null;this.cuk=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",!0],["Rewrite",!0]]);this.Qsk=[{id:`${Ku.xuc}_${1}`},{id:`${Ku.xuc}_${2}`},{id:`${Ku.xuc}_${3}`},{id:dp.a.OZd},{id:dp.a.hYd},{id:dp.a.hhd},{id:dp.a.fhd}];this.Xmk=[{id:"OpenCopilotComposeDraftContent"},
{id:"OpenCopilotComposeRewrite"},{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"Draw"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"Sort"},{id:"ReviewDesignerSuggestion"}];this.uyd=new Map;this.Inh=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.EEk=A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",
8);this.hqk=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.Re.nb(this,Uh.SearchSuggestionAnnotation.getTypeName());(A.AFrameworkApplication.K.$("IsO365CommercialHost")||A.AFrameworkApplication.K.$("IsO365ConsumerHost"))&&this.uyd.set("InsertLink","InsertLinkFlyout");this.uyd.set("GraphicsEditor","");this.f6j();this.Wb(this.ga)}Mgo(b,h){if(this.Inh){var n=Date.now();this.Z0e&&1250>n-this.Z0e||this.yGb||(this.Z0e=n,this.nCb=b,this.nNd=this.ALm(h),
this.gGo(),this.wEo())}}lD(b,h){if(b.annotationType===Uh.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===Kq.a.getTypeName()&&(h=Date.now(),b=b.content,this.yGb&&this.yGb===b.correlationId)){window.clearTimeout(this.Nya);this.yGb=void 0;var n=this.uac,B=this.Ezm(b),L=B&&0<B.length;L&&(this.Sxp(B),this.uQd&&(n=!1));n&&this.JEj();h={["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:b.correlationId,["requestPreparationTime"]:this.hCh,["canvasContextRetrievalTime"]:this.Bah,
["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-h,["latencyMs"]:h-this.iCh,["containsZTM"]:L,["shouldFallBack"]:this.uac,["fallBack"]:n};x.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(h))}}Ezm(b){const h=this.getSuggestions(b.intentSuggestions,Uh.IntentIds.ZeroTermMenu,Uh.ObjectSemantic.GenericSuggestions,Uh.ObjectSchemaType.RankedSuggestion);return 1===h.length?h[0]:b.menuSuggestions}getSuggestions(b,h,n,B){return Array.isArray(b)?b.filter(L=>L.intent===
h&&L.result.semantic===n&&L.result.type===B).map(L=>L.result.value):[]}Wb(b){b.fb(Pa.a.o$i,oc.a.application,this.xEo.bind(this),96)}ALm(b){const h=[],n=new Map,B=Date.now();for(const L of b){if(!L)continue;b=[];const ba={itemsMetadata:new qb.a};for(let la=0;la<L.ControlList.length;la++){const La=L.ControlList[la];if(La&&!La.ExternalId)continue;b.push(La.ExternalId);const fb={timeStamp:B,source:"FallbackZeroTermMenu",confidenceScore:-1};ba.itemsMetadata[La.ExternalId]=fb;n.set(La.ExternalId,fb)}h.push(appChrome.api.menuSection(b,
L.Title,L.Lang,L.Id,ba))}return{sections:h,commands:n}}A2j(b){return this.uyd.has(b)?this.uyd.get(b):b}BPa(b){const h={};for(const n of b)b=this.A2j(n.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));Ua.StaticActiveAppFrame.za().I4d(h)}zfn(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?!1:this.cuk.has(b)?this.nNd.commands.has(b):!0}Rbi(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,
null,null,{menuTargetType:this.nCb})}iqb(b=!1){b=b?sm.a.instance.BHc:sm.a.instance.iqb();const h=[],n=Date.now();for(const B of b)B.commandId&&h.push({Id:B.commandId,TimeElapsedSinceClick:(n-B.timeStamp)/1E3,ContentType:B.contentType,CommandSurface:B.commandSurface,InputMethod:B.iz});return h}x2c(){const b=sm.a.instance.x2c(),h=[],n=Date.now();for(const B of b)B.controlId&&h.push({Id:B.controlId,TimeElapsedSinceClick:(n-B.timeStamp)/1E3,ContentType:B.contentType,CommandSurface:B.commandSurface,InputMethod:B.iz});
return h}THf(){const b={semantic:Uh.ObjectSemantic.CanvasContext,type:Uh.ObjectSchemaType.WordCanvasContext,value:{contentType:this.nCb}};if(this.hqk){const h=Date.now(),n=this.SSk.THf(Zb.a.instance.gb.currentSelection);n&&n.value.contentType&&(b.value=n.value);this.Bah=Date.now()-h}return b}zwi(){const b=this.x2c(),h=this.iqb(),n=this.iqb(!0),B=[];B.push({semantic:Uh.ObjectSemantic.ControlIdHistory,type:Uh.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Uh.SequenceType.ControlId,Sequence:b}});
B.push({semantic:Uh.ObjectSemantic.CommandIdHistory,type:Uh.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Uh.SequenceType.CommandId,Sequence:h}});B.push({semantic:Uh.ObjectSemantic.FilteredCommandIdHistory,type:Uh.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Uh.SequenceType.CommandId,Sequence:n}});B.push(this.THf());return B}f6j(){this._augLoopRuntimeManager.getSession().then(b=>this.rxd=b).catch(()=>{this.rxd=void 0})}wEo(){const b=Date.now(),h=this.zwi(),n=[Uh.IntentIds.ZeroTermMenu,
Uh.IntentIds.Logging];this.hCh=Date.now()-b;this.aZj(n,h,"ContextualMenu")}xEo(b,h,n){2===n&&(b=this.zwi(),this.aZj([Uh.IntentIds.Logging],b,"Floatie"));return 32}aZj(b,h,n){if(0===b.length||0===h.length)x.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated");else{var B=new Uh.SearchSuggestionSignal({correlationId:this.I2c("ACM"),intents:b,contextObjects:h,entryPoint:n});this.uac=0<=b.indexOf(Uh.IntentIds.ZeroTermMenu);this.iCh=Date.now();this.yGb=B.correlationId;
this.Nya=window.setTimeout(()=>{this.D1n(B.correlationId)},750);h=new Kq.l({parentPath:["Signal",Uh.SearchSuggestionSignal.getTypeName()],items:[{id:yb.a.create().toString(),body:B}]});this.rxd&&!this.rxd.isClosed?this.rxd.submitOperation(h):(this._augLoopRuntimeManager.submitOperation({operation:h}),this.f6j());x.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",["correlationId"]:B.correlationId,["shouldFallBack"]:this.uac,
["intents"]:b}))}}I2c(b){const h=yb.a.create().toString();appChrome.api.setOfeCorrelationId(b,h);return h}D1n(b){this.yGb&&this.yGb===b&&(this.yGb=void 0,this.uac&&this.JEj(),x.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.uac})))}JEj(){const b=this.Rbi(this.nNd.sections);appChrome.api.dispatch(b);this.S5h()}S5h(){this.uQd=!0}Zxo(b){var h,n;const B=[],L=new Map;if(!b||0===b.length)return B;
for(const ba of b){if(!ba||!ba.controlIds||0===ba.controlIds.length)continue;b={controlIds:[],id:ba.id,title:ba.title,lang:ba.lang,data:{itemsMetadata:new qb.a}};const la="CommandsZTM"===ba.id;for(const La of ba.controlIds){if(L.has(La))continue;if(la&&b.controlIds.length>=this.EEk)break;const fb=null===(n=null===(h=ba.data)||void 0===h?void 0:h.itemsMetadata)||void 0===n?void 0:n[La];L.set(La,fb);b.controlIds.push(La);fb&&(b.data.itemsMetadata[La]=fb)}0<b.controlIds.length&&B.push(b)}return B}gGo(){this.uQd=
!1;if(this.Inh){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}Sxp(b){this.uQd||(b=this.Efm(b),0<b.length&&appChrome.api.dispatch(b))}Efm(b){const h=[];let n=[];var B=this.fFm();B&&0<B.length&&n.push(...B);(B=this.Dem())&&n.push(B);Array.isArray(b)&&0<b.length&&(b=this.hAa(b))&&(b.id="CommandsZTM",n.push(b));(b=this.rem())&&n.push(b);n=this.Zxo(n);if(0===n.length)return[];
h.push(this.Rbi(n));this.S5h();return h}fFm(){var b,h;const n=null===(b=this.nNd)||void 0===b?void 0:b.sections.filter(B=>{var L;return null===(L=B.id)||void 0===L?void 0:L.startsWith(Ku.aji)});for(const B of n)if(null===(h=B.data)||void 0===h?0:h.itemsMetadata)for(const L in B.data.itemsMetadata)B.data.itemsMetadata[L].source="PassThroughZeroTermMenu";return n}Dem(){const b=this.usi(this.Qsk,"DefaultZeroTermMenu");return this.hAa(b)}rem(){const b=this.usi(this.Xmk,"AdvertizedZeroTermMenu");return this.hAa(b)}usi(b,
h){const n=[];for(const B of b)B&&this.Q3o(B)&&this.nNd.commands.has(B.id)&&n.push({suggestion:B.id,rankingScore:-1,suggestionSource:h});return n}Q3o(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}hAa(b){const h=[],n={itemsMetadata:new qb.a},B=Date.now();this.BPa(b);for(const L of b)b=this.A2j(L.suggestion),this.zfn(b)&&(h.push(b),n.itemsMetadata[b]={timeStamp:B,source:L.suggestionSource,confidenceScore:L.rankingScore});return 0<h.length?
appChrome.api.menuSection(h,null,null,null,n):null}}Object(u.a)(rH,"AugLoopSearchSuggestionManager",null,[223,224]);class tF{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}wc(b){this.W=b;this.W.ia("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new rH(A.AFrameworkApplication.va,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").ha()}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>
{Es.a.Pl().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){M.a.instance.Jc(new tF)}}Object(u.a)(tF,"PackageManager",null,[0,1]);var eD=d(474),er=d(1027);class uF extends er.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(u.a)(uF,"BootMessage",er.a,[]);var vF=d(1145);class fD{constructor(){this.EO=null;this.e_n=b=>{if(b.target===this.EO)if(void 0===b.data||null===b.data)x.ULS.sendTraceTag(50739143,
3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=D.a(b.data);this.GBe(h.api)?this.dxd.J(h.api).jke(h.method,h):x.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){x.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.dxd=new Cf.a}i2f(){return!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",
!1)}create(b,h){let n=!1;try{this.EO=new Worker(b);this.EO.onmessage=this.e_n;const B=Object.assign(new uF,{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(B);this.i2f()&&vF.a.Blk(this.EO);n=!0}catch(B){x.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",B)}return n}postMessage(b){try{const h=D.c(b);this.EO.postMessage(h)}catch(h){x.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}GBe(b){return this.dxd.mb(b)}GUk(b,
h){this.GBe(b)&&x.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",b);this.dxd.Z(b,h)}Vhm(b){return this.GBe(b)?this.dxd.J(b):null}}Object(u.a)(fD,"WebWorker",null,[1743]);class wF{constructor(){this.yPg=[]}mLl(b,h){if(h){var n=A.AFrameworkApplication.lC(b.YJj,7),B=[];for(let L=0;L<b.j1b.length;L++){let ba;switch(b.j1b[L].format){case 5:case 6:ba=eD.a.CQb(b.j1b[L].name);break;default:ba=b.j1b[L].name}B.push(A.AFrameworkApplication.lC(ba,
b.j1b[L].format))}try{const L=URL.createObjectURL(new Blob(["importScripts('"+n+"');"],{type:"application/javascript"})),ba=new fD;if(ba.create(L,B))for(this.yPg.push(ba),n=0;n<b.FBe.length;n++){const la=h.CDl(ba,b.FBe[n]);la&&ba.GUk(b.FBe[n],la)}}catch(L){x.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",L.message)}}else x.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(u.a)(wF,"WebWorkerCollection",null,
[]);class DB{constructor(b,h){this.Ddf=new wF;if(b){b=b.create();for(let n=0;n<b.length;n++)this.Ddf.mLl(b[n],h)}else x.ULS.sendTraceTag(50442779,3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...n){let B=!1;for(let ba=0;ba<this.Ddf.yPg.length;ba++){var L=this.Ddf.yPg[ba];L.GBe(b)&&((L=L.Vhm(b))?B=L.callMethod(h,n)||B:x.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}B||x.ULS.sendTraceTag(50442781,
3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(u.a)(DB,"WebWorkerRouter",null,[1742]);class gD extends er.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(u.a)(gD,"SettingsMessage",
er.a,[]);class Su{constructor(b){this.EO=b}}Object(u.a)(Su,"WebWorkerApiMain",null,[]);class sH extends Su{constructor(b){super(b)}i2f(){return!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}callMethod(b,h){if(!h)return x.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.okl(h);x.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",
b);return!1}jke(b,h){switch(b){case 14:this.GVm(h);break;default:x.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}okl(b){if(2!==b.length)return x.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return x.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}",
"object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new gD,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:A.AFrameworkApplication.userSessionId,LocalCobaltSessionId:Qh.a.instance.IF,LocalCobaltMachineId:Qh.a.instance.qma,LocalCobaltClusterId:Qh.a.instance.mua,LocalCobaltSessionHasBackup:Qh.a.instance.nua,WaciiEnabledRequests:Qh.a.instance.voa,SettingsRoutedToServer:Qh.a.instance.ABg,WacClusterId:A.AFrameworkApplication.Be.i1});this.EO.postMessage(b);return!0}GVm(b){this.i2f()&&
b&&b.result&&(x.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.XBp())}async XBp(){try{const b=await new vF.a.Clk.WorkerUtilsTestClass(10);await b.Qh(5);15==await b.counter?x.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):x.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){x.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}}}Object(u.a)(sH,"InitializeWorkerApiMain",Su,[]);class xF extends er.a{constructor(){super();
this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=ed.a.none;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(u.a)(xF,"CatchUpNetworkRequestWorkerRequestMessage",er.a,[]);class yF extends Su{constructor(b,h){super(b);this.ZUc=h}callMethod(b,h){if(4===b)return b=Object.assign(new xF,{rootQuerySignature:h[0],requestEndpoint:h[1],appMode:h[2],activityFeedIsEnabled:h[3]}),this.EO.postMessage(b),!0;x.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",
b);return!1}jke(b,h){switch(b){case 5:x.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.ZUc.nRo(h);break;default:x.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(u.a)(yF,"CatchUpNetworkRequestWorkerExternalApi",Su,[]);class Ms extends er.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=
null}}Object(u.a)(Ms,"LocalInferenceMessage",er.a,[]);class Ns{constructor(){this.prediction=this.context=null}}Object(u.a)(Ns,"LocalInferenceOutput",null,[]);class Kj{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(u.a)(Kj,"TextPredictionConfig",null,[]);class hD{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(u.a)(hD,"TextPredictionSettings",null,[]);class Ej{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(u.a)(Ej,
"TextPredictionDynamicPayload",null,[]);class Jn extends Su{constructor(b,h){super(b);this.ZSk=h}callMethod(b,h){if(!h)return x.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.ukl(h);case 7:return this.pkl(h);case 9:return this.tkl(h);case 10:return this.qkl(h);case 13:return this.rkl(h);case 14:return this.skl(h);default:return x.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",
b),!1}}jke(b,h){switch(b){case 9:this.NWm(h);break;default:x.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}NWm(b){b&&b.prediction&&(b=Object.assign(new Ns,{prediction:b.prediction,context:b.context}),this.ZSk.BVh().Xgo(b))}pkl(b){if(1>b.length)return x.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Ms,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.EO.postMessage(b);return!0}ukl(b){if(1>b.length)return x.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Ms,{api:4,method:8,paragraphContent:b});this.EO.postMessage(b);
return!0}tkl(b){if(2>b.length)return x.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new Ms,{api:4,method:9,paragraphContent:b,context:h});this.EO.postMessage(h);return!0}qkl(b){if(1>b.length)return x.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Ms,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.EO.postMessage(b);return!0}rkl(b){if(1>b.length)return x.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Ms,{api:4,method:13,textPredictionConfig:this.Jxi(b)});this.EO.postMessage(b);return!0}skl(b){if(1>
b.length)return x.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(Wb.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new Ms,{api:4,method:14,textPredictionConfig:this.Jxi(b)});this.EO.postMessage(b);return!0}getConfig(b=null){return Object.assign(new Kj,{scriptDirectory:A.AFrameworkApplication.c9+"/intelligence/",settings:Object.assign(new hD,{extendedRankLimit:0}),modelFilesUrl:b})}Jxi(b=
null){return Object.assign(new Kj,{scriptDirectory:A.AFrameworkApplication.c9+"/intelligence/",settings:Object.assign(new hD,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(u.a)(Jn,"LocalInferenceWorkerApiMain",Su,[]);class xt extends Su{constructor(b){super(b);A.AFrameworkApplication.aJ(()=>{this.nWb()})}callMethod(b){x.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}jke(b){x.ULS.sendTraceTag(591689870,
3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}nWb(){const b=Object.assign(new er.a,{api:3,method:6});this.EO.postMessage(b)}}Object(u.a)(xt,"ShutdownWorkerApiMain",Su,[]);class tH{constructor(b){this.container=b}CDl(b,h){let n=null;switch(h){case 0:n=new sH(b);break;case 2:n=new yF(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));break;case 3:n=new xt(b);break;case 4:n=new Jn(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));
break;default:x.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",h)}return n}}Object(u.a)(tH,"WordWebWorkerApiFactory",null,[402]);var Qg=d(344);class EB{constructor(b,h){this.name=b;this.format=h}}Object(u.a)(EB,"ImportedScript",null,[]);class zF{constructor(){this.FBe=this.j1b=this.YJj=null}}Object(u.a)(zF,"WebWorkerConfig",null,[]);var uH=d(1505);class vH{constructor(b){this.dHh=[];this.sBk=b;if(A.AFrameworkApplication.K){b=A.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||
A.AFrameworkApplication.K.$("IsCombinedBundleEnabled");const n=A.AFrameworkApplication.K.kb("ContentBaseUrl")?6:5;var h=A.AFrameworkApplication.K.kb("AppScriptBaseName");const B=b?"":".";if(h){const L=b?"":"{0}";h+=`${B}${L}worker.js`;this.dHh.push(new EB(`MicrosoftAjax${b?"":"DS"}.${L}js`,n),new EB(h,n))}else x.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else x.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=
[],h=Object.assign(new zF,{YJj:"workerboot",j1b:this.dHh,FBe:[0,2,3,4]});this.sBk&&this.Hhn()&&h.j1b.push(new EB("intelligence/edge-inference-web.js",5));b.push(h);return b}Hhn(){return(new Qg.a("arrowFunction",()=>{try{Object(uH.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}}Object(u.a)(vH,"WordWebWorkerConfigFactory",null,[222]);class $d{constructor(){this.Ga=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve("Box4.Workers.IWebWorkerRouter");
b.sendMessage.apply(b,[0,1].concat([this.Ga.appSettings,A.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}wc(b){this.W=b;this.Ga=this.W.resolve("Common.IAppSettingsManager");const h=this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ia("Box4.Workers.WebWorkerRouter",()=>new DB(new vH(h),new tH(b))).as("Box4.Workers.IWebWorkerRouter").ha()}static main(){M.a.instance.Jc(new $d)}}Object(u.a)($d,"WordEditorWorkersPackage",null,[0,1]);var kA=d(1261);class iD{constructor(){this.kLd=
[]}iGi(b,h){let n=-1,B=null;B=L=>{L?h(this.kLd[n]):(++n,n<this.kLd.length?this.kLd[n].wec(b,B):h(null))};B(!1)}wec(b,h){this.iGi(b,n=>{h(!!n)})}Ivc(b,h,n){this.iGi(b,B=>{if(!B)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");B.Ivc(b,h,n)})}COh(b){this.kLd.push(b)}}Object(u.a)(iD,"CompositeExternalContentURLResolver",null,[403,404]);var FB=d(1499);class GB extends FB.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=
0;this.ProviderName=this.IFrameHtml=null}}Object(u.a)(GB,"ExternalContentEmbedResponse",FB.a,[]);var HB=d(1524),AF=d(811),gy=d(1246),hy=d(1411),cz=d(773),yt=d(539),us=d(174),St=d(937),$r;(function(b){b[b.ikf=0]="autoCorrect";b[b.M4l=1]="externalComponentPaste";b[b.X4l=2]="externalHyperlinkPaste";b[b.OZp=3]="externalContentFloatieConversion"})($r||($r={}));Object(u.b)("ExternalContentConversionContext",$r);class th{constructor(){this.lUb=this.kUb=null;this.LCf=new hy.ExternalContentEmbedRetriever;
this.MPc=!0;this.oHc=this.Zo=this.YPi=this.XPi=this.Km=this.zt=null;this.whd=()=>{x.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.Wtc=()=>{x.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=th.tsa&&th.tsa.Bwi()}get o0b(){return this.MPc}set o0b(b){this.MPc=b}Fnf(b,h){let n=!1;if(b){switch(b.contextId){case oc.a.Xc:n=!h;break;case oc.a.Bd:n=!0}n&&!St.a(b.node)&&(n=!1)}return n}Stn(b){const h=b.startsWith(ef.a.zuc),
n=b.startsWith(ef.a.Gid),B=b.startsWith(ef.a.Lre);return(h||n||B)&&ef.a.VXa(b)}Ayj(){this.Zo=S.a.create();th.Ff.DMb(this.Zo,4);th.Ff.C8(this.Zo,0,th.Ff.Xo());this.iSb(this.kUb,3,this.lUb,!0)}YWa(b,h,n){this.Zo=S.a.create();th.Ff.DMb(this.Zo,n?0:2);th.Ff.C8(this.Zo,0,th.Ff.Xo());this.oHc();this.iSb(b,n?0:2,h)}fqe(b,h){this.Zo=S.a.create();th.Ff.DMb(this.Zo,1);th.Ff.C8(this.Zo,0,th.Ff.Xo());this.iSb(b,1,h)}kce(b,h,n,B){if(!b||!b.isConnected||!Ad.ImageReader.Lt(b))return null;const L=new cz.a;L.setValue(lk.a.xmc,
n);L.setValue(lk.a.QWa,h);L.g7a=this.XPi;L.Av=this.YPi;L.providerName=B;L.Qab=1===n;L.creationTime=Date.now();ve.GraphIterator.eb(b).Uf(L,2);this.Scd(L);return L}tAj(b){this.oHc=b}gJe(b,h){const n=th.D4.Wgc(h)||0;h=th.D4.N7a(h)||0;const B=b.Width/b.Height;1<=B?(b.Width=n,b.Height=n/B):(b.Height=h,b.Width=h/B)}lRg(b,h,n){if(null!=b&&null!=h&&!F.a.Tf(n)){var B=th.Hed.Kkc(n);A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",
!1)?B.Nva=!1:B.Nva=!0;B.hideFloatie=!0;this.gJe(b,h.node);this.anc(b,h,!1,!1,B,n)}}jrb(b){return b?b.He:0}XNg(b,h,n){let B=null;const L=b.node;if(!ea.ParagraphReader.Xb(L)||!L.isConnected)return{returnValue:!1,rwa:B};if(n)return{returnValue:!0,rwa:b};n=b.cpBegin;const ba=b.cpEnd,la=ea.ParagraphReader.text(L);if(0<=n&&ba<=la.length&&la.substring(n,ba)===h)return{returnValue:!0,rwa:b};const La=la.indexOf(h);return 0<=La?(B=Nd.a.createTextRange(L,La,La+h.length),{returnValue:!0,rwa:B}):0<=n&&ba<=la.length&&
this.Zlc(b)?{returnValue:!0,rwa:b}:{returnValue:!1,rwa:B}}Zlc(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Nd.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=ef.a.QA(h,!1);if(1===h.length){h=h[0];const n=ea.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==n)return!0}return!1}X1f(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}tfb(b,h){A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$(h)&&
window.setTimeout(()=>{const n=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");n&&n.execute(B=>{B.logActivity(b,h)})},th.GJa)}MJf(b,h){const n=!F.a.taa(h);switch(b){case 1:b=n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):
WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}iSb(b,h,n,B=!1){if(this.Stn(n)){var L=th.Hed.Kkc(n);if(L)if(this.X1f(L)){x.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(ya.a)(Nd.a,b);var ba=!h;this.Fnf(b,ba)?this.v9c(n)?(h=1===h,B=this.Ysm(b),L.hideFloatie=!0,this.anc(B,b,ba,h,L,n)):this.gmg(b,h,L,n,B):th.Ff.kU(this.Zo,2,"URL inserted in Non-Embedable context",th.Ff.Xo())}else x.ULS.sendTraceTag(577521882,
324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),th.Ff.kU(this.Zo,2,"Size provided is not valid for OEmbed",th.Ff.Xo())}else x.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),th.Ff.kU(this.Zo,2,"URL inserted is not valid for ExternalContent",th.Ff.Xo())}Ysm(b){const h=new GB;h.Width=th.D4.Wgc(b.node)||0;h.Height=th.D4.N7a(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}v9c(b){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&null!=th.Rba&&th.Rba.U2i(b)}gmg(b,h,n,B,L){const ba=!h,la=1===h,La=th.D4.Wgc(b.node)||0,fb=th.D4.N7a(b.node)||0,Cb=HB.a.Brf(n.qNg,!0,La,fb);this.pcd(b,B,h,!0);this.LCf.A1h(Cb,Lb=>{th.Ff.C8(this.Zo,4,th.Ff.Xo());th.Ff.Ynd(this.Zo,this.jrb(Lb.data));if(Lb=this.omg(Lb)){x.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var $b=us.q(Lb.MediaType);th.Ff.Ite(this.Zo,7,$b);$b=b;({rwa:$b}=this.XNg(b,B,la)).returnValue?(this.pcd($b,
B,h,!1),null==n.width?0<La&&Lb.Width>La&&(x.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Lb.Width=La):(x.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Lb.Width=this.qud(n.width,Lb.Width,La)),null==n.height?0<fb&&Lb.Height>fb&&(x.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),
Lb.Height=fb):(x.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Lb.Height=this.qud(n.height,Lb.Height,fb)),th.tsa.qhb||L?this.anc(Lb,$b,ba,la,n,B):(this.kUb=b,this.lUb=B,this.DXc(B))):(x.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),th.Ff.kU(this.Zo,2,"No conversion as the context is no longer valid for the external content conversion",
th.Ff.Xo()));la&&this.Q6a($b.node)}else la&&this.Q6a(b.node),th.Ff.kU(this.Zo,1,"URL not oEmbedable",th.Ff.Xo())},Lb=>{th.Ff.C8(this.Zo,4,th.Ff.Xo());th.Ff.Ynd(this.Zo,this.jrb(Lb.data));la&&this.Q6a(b.node);x.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Lb.data.De);th.Ff.kU(this.Zo,2,"ExternalContentEmbedRequest failed",th.Ff.Xo())},Lb=>{la&&this.Q6a(b.node);x.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Lb)},this.Zo)}qud(b,
h,n){!b&&0<n&&h>n||b>n?(x.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=n):b>n?h=n:b&&b<n&&(h=b);return h}anc(b,h,n,B,L,ba){this.Km=yb.a.create();b.Width=b.Width/b.Height*(b.Height-(yt.a.o6c+yt.a.K6))+2*yt.a.K6;const la=new Sd.GraphTransaction(15);la.Ab(h.node);la.yi=Dc.a.YWa;const La=this.Zlc(h);null!=L.Nva&&!L.Nva||B||La||(b.Title=""===L.title||L.title?L.title:b.Title,!b.Title&&""!==b.Title)||(h=this.rWf(h,la,b.Title,
ba,n));if(h){B&&(h=this.Jwf(h));var fb=this.PYd(h,B);if(fb){n=us.q(b.MediaType);var Cb=this.$8d(b,n);this.XPi=b.IFrameHtml;this.YPi=b.Title;if(fb=this.$Vf(fb,Cb,la,B,ba,n,b.ProviderName))la.sMa(this.Km,1),la.dispose(),this.kUb=h,this.lUb=ba,this.Jig(L,b,fb),this.Tlg(ba,B||L.hideFloatie,La,n,b.Title,b.ProviderName)}else la.dispose(),x.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),th.Ff.kU(this.Zo,2,"Could not create IP context on splitting the paragraph",
th.Ff.Xo())}else th.Ff.kU(this.Zo,2,"GraphNodeContext is null",th.Ff.Xo())}$8d(b,h){const n=new Og.DictionaryPropertySet;th.KR.are(n,b.Width,b.Height);b=this.LJf(h,b.Title);n.setValue(Hf.a.imageAltText,b);n.setValue(Lc.a.uX,Se.a.VF());n.setValue(Lc.a.imageType,Zq.other);return n}$Vf(b,h,n,B,L,ba,la){if(!b)return null;b=th.KR.oce(b,h);if(!b)return n.dispose(),x.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),th.Ff.kU(this.Zo,2,"The anchored image could not be inserted",
th.Ff.Xo()),null;n=b.node;L=this.kce(n,L,ba,la);th.Ff.nMg(this.Zo,L.id);B||this.vzg(n);return n}Jig(b,h,n){F.a.taa(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(th.Ff.C8(this.Zo,8,th.Ff.Xo()),x.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.l0d(n,h.Thumbnail))}Tlg(b,h,n,B,L,ba){h||this.DXc(b);this.tfb("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");this.ipe("IsHyperlinkWithNonURLDisplayText",
n,ba);this.ariaNotify(B,L);th.Ff.C8(this.Zo,5,th.Ff.Xo())}ipe(b,h,n){x.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");aa.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new ia.a,{name:b,bool:h}),Object.assign(new ia.a,{name:"ProviderName",string:n})]}))}ariaNotify(b,h){this.o0b&&th.Dw&&(b=this.MJf(b,h),th.Dw.sendNotification(b,!0))}rWf(b,h,n,B,L){if(L){if((L=ef.a.QA(b,
!1))&&1!==L.length)return h.dispose(),x.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;th.Np.hV(L[0].paragraph,L[0].hyperlink)}return this.$tg(b,n,B)}Jwf(b){const h=b.node,n=ea.ParagraphReader.text(h);return 0<n.length&&!n.trim().length?(b=Nd.a.createTextRange(h,0,n.length),th.rg.Ne(b,""),Nd.a.Tc(h,0)):b}PYd(b,h){return h?b:this.KKf(b)}KKf(b){const h=ea.ParagraphReader.text(b.node),n=ve.GraphIterator.eb(b.node);
if(n.Jd()){b=Nd.a.Tc(b.node,b.cpEnd);Ga.OutlineElementNavigator.he(n);const B=th.Kf.tta(n);th.Oh.Tca(n,B,b,!0,!0,!0,!0);""!=h&&th.Oh.$z(n,!1,!0);n.Xd();return Nd.a.Tc(n.currentNode,0)}return null}omg(b){if(!({group:b}=ii.a.R4(b.data.De)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}$tg(b,h,n){const B=b.cpBegin+h.length;th.rg.Ne(b,h);b=Nd.a.createTextRange(b.node,b.cpBegin,B);th.Np.vF(b,n,!1);return b}LJf(b,h){const n=!F.a.taa(h);switch(b){case 1:return n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}l0d(b,h){b.Jj().yg.CF(()=>{this.mmg(h,b)},()=>{x.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}Scd(b){b=ve.GraphIterator.eb(b);b.zb(12);b.ld(12);b.io.ZT=!0}Q6a(b){b.Otc=
null}vzg(b){b=ve.GraphIterator.eb(b);b.zb(11)&&(b.ld(11),b.Jd()&&b.Fk()&&b.Xd()&&ea.ParagraphReader.Xb(b.currentNode)&&(b=Oe.SelectionFactory.se(b.currentNode,0),Zb.a.instance.Ic(b)))}pcd(b,h,n,B){const L=b.cpBegin,ba=b.cpEnd;b=ea.ParagraphReader.text(b.node).trim();L||b!==h&&""!==b?L?ba===b.length?x.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",$r[n],B):0<L&&
ba<b.length&&x.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",$r[n],B):x.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",$r[n],B):x.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
$r[n],B)}DXc(b){this.chc();const h=new Jw.a(1,A.AFrameworkApplication.isRtl);h.ihd=b;th.vpb.Gjd(h)}chc(){const b=new Iw.a(!0);th.mca.ENa(b)}mmg(b,h){if(b=this.UMf(b,h))h=Array(1),h[0]=b,b=AF.a.construct(h,!1,A.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.zt.kq:null),h=this.Nuf(),this.Zxb(h,b)}UMf(b,h){if(!h)return x.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.zt=h.Jj();(new ve.GraphIterator).set(h);
if(!h.anchor||!h.anchor.Uq||!h.anchor.Uq.kt)return x.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var n=h.anchor.Uq.kt.node;if(!n)return x.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;n=n.ja(hi.a.lK,fk.a.Hu);const B=h.getValue(Hf.a.$H),L=ri.a.nf(Ad.ImageReader.tE(h.properties),0),ba=ri.a.nf(Ad.ImageReader.YJ(h.properties),1);return gy.a.construct(h.id.toString(),
b,h.ja(Hf.a.imageAltText,""),L,ba,h.ja(Lc.a.f0,""),n,h.ja(Lc.a.uX,0),h.ja(Lc.a.Tla,!1),h.ja(hi.a.Dka,-1),h.ja(Lc.a.Bub,Box4Intl.Box4Strings.l_Picture),h.ja(Hf.a.xCa,!1),B,h.ja(Lc.a.runId,1),h.ja(Lc.a.Yc,0))}Zxb(b,h){A.AFrameworkApplication.Be.Ij(b,2,D.c(h),{},!1,2,this.whd,this.Wtc,null,void 0,void 0,void 0,void 0,"26");x.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}Nuf(){let b=za.a.O1c("PicturePaste.ashx");const h=pk.a.TWa;A.AFrameworkApplication.K&&!A.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&
(b=za.a.Fp(b,lg.a.fileId,this.zt.kq));b=za.a.Fp(b,lg.a.cellId,this.zt.pl.toString());this.Km||(this.Km=yb.a.create(),x.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=za.a.Fp(b,lg.a.v_,this.Km.toString());b=za.a.Fp(b,lg.a.classId,h.toString());this.zt.NG&&(b=za.a.Fp(b,lg.a.NG,this.zt.NG));b=za.a.Fp(b,lg.a.FAb,"1");b=za.a.Fp(b,wh.a.imageType,Zq.other.toString());b=Qh.a.instance.Xff(b);b=za.a.Fp(b,lg.a.zza,this.zt.yg.Is.toString());b=za.a.Fp(b,
lg.a.Ltc,"0");return b=za.a.Fp(b,lg.a.R2b,"1")}static get vpb(){return null!=th.cWg?th.cWg:th.cWg=Ya.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get tsa(){th.uGa||(th.uGa=Ya.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return th.uGa}static get mca(){return null!=th.e3g?th.e3g:th.e3g=Ya.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get Dw(){return null!=th.TTg?th.TTg:th.TTg=Ya.a.instance.resolve("Common.Utils.IAriaNotifier")}static get D4(){return null!=
th.p4g?th.p4g:th.p4g=Ya.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get KR(){return null!=th.VYg?th.VYg:th.VYg=Ya.a.instance.resolve("WordEditor.IImageEditor")}static get Kf(){return th.Oh||(th.Oh=Ya.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Np(){return null!=th.NYg?th.NYg:th.NYg=Ya.a.instance.resolve("Box4.IHyperlinkEditor")}static get rg(){return null!=th.AUg?th.AUg:th.AUg=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Ff(){return null!=
th.lWg?th.lWg:th.lWg=Ya.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get Hed(){return null!=th.P1g?th.P1g:th.P1g=Ya.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get Rba(){return null!=th.E1g?th.E1g:th.E1g=Ya.a.instance.resolve("Fluid.Host.LoopComponentManager")}}th.Oh=null;th.GJa=5E3;th.uGa=null;Object(u.a)(th,"ExternalContentEditor",null,[413]);var qu=d(288),Cr=d(1303);class xk{constructor(b,h){this.qhb=!0;this.LWb=n=>{if(null!=n.result)return n.result.Value;
x.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.qhb};this.dcb=n=>{n.qp||n.ij?x.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):(this.cZh(n.result),x.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.qhb};this.ey=b;this.sT=h}Bwi(){const b=
new Zf.a;this.T1i()&&this.sT?this.sT.axb(qu.a.ZWc).CWRCo(this.LWb,0).CWRCo(this.dcb,8):b.gg(this.qhb)}Yha(b){this.sT&&this.sT.Yha(qu.a.ZWc,new Cr.a(qu.a.ZWc,b))}EKo(b){this.T1i()&&(this.ey.Lva("saveConvertExternalContentIsEnabled",b.toString()),x.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),this.cZh(b),this.Yha(b))}T1i(){const b=A.AFrameworkApplication.K.$("IsAnonymousUser");if(A.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)x.ULS.sendTraceTag(559437387,
324,50,"User is anonymous ");else return!0;return!1}cZh(b){this.qhb=b}}Object(u.a)(xk,"ExternalContentSettingInfo",null,[411]);var BF=d(1234);class dz{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(u.a)(dz,"FluidComponentProperties",null,[]);class jD{constructor(){this.loopType=this.Av=this.g7a=this.url=null;this.mediaType=0;this.Yaj=null}}Object(u.a)(jD,"IFrameProps",null,[]);class Bl{static get D4(){return null!=
Bl.n4g?Bl.n4g:Bl.n4g=Ya.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get KR(){return Bl.Ck||(Bl.Ck=Ya.a.instance.resolve("WordEditor.IImageEditor"))}static get Dw(){return null!=Bl.STg?Bl.STg:Bl.STg=Ya.a.instance.resolve("Common.Utils.IAriaNotifier")}static get Np(){return null!=Bl.HYg?Bl.HYg:Bl.HYg=Ya.a.instance.resolve("Box4.IHyperlinkEditor")}static get Kf(){return null!=Bl.j2g?Bl.j2g:Bl.j2g=Ya.a.instance.resolve("Box4.IOutlineElementEditor")}static get rg(){return null!=
Bl.xUg?Bl.xUg:Bl.xUg=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static VXa(b){const h=b.startsWith(ef.a.zuc),n=b.startsWith(ef.a.Gid),B=b.startsWith(ef.a.Lre);return(h||n||B)&&ef.a.VXa(b)}static Fnf(b,h){let n=!1;if(b){switch(b.contextId){case oc.a.Xc:n=!h;break;case oc.a.Bd:n=!0}n&&!St.a(b.node)&&(n=!1)}return n}static Zlc(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Nd.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=ef.a.QA(h,!1);if(1===h.length){h=h[0];const n=ea.ParagraphReader.text(b.node).substring(h.cpBegin,
h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==n)return!0}return!1}static LJf(b,h){const n=!F.a.taa(h);switch(b){case 1:return n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static Scd(b){b=
ve.GraphIterator.eb(b);b.zb(12);b.ld(12);b.io.ZT=!0}static $8d(b,h,n,B){const L=new Og.DictionaryPropertySet;Bl.KR.are(L,h,b);b=Bl.LJf(B,n);L.setValue(Hf.a.imageAltText,b);L.setValue(Lc.a.uX,Se.a.VF());L.setValue(Lc.a.imageType,Zq.other);return L}static kce(b,h,n){if(!b||!b.isConnected||!Ad.ImageReader.Lt(b))return null;const B=new cz.a;B.setValue(lk.a.xmc,h.mediaType);B.setValue(lk.a.QWa,h.url);B.setValue(zd.a.loopComponentType,h.loopType);B.g7a=h.g7a;B.Av=h.Av;B.providerName=n;B.creationTime=Date.now();
B.Qab=1===h.mediaType;B.createMode=h.Yaj;ve.GraphIterator.eb(b).Uf(B,2);Bl.Scd(B);return B}static PYd(b,h){return h?b:Bl.KKf(b)}static KKf(b){const h=ea.ParagraphReader.text(b.node),n=ve.GraphIterator.eb(b.node);if(n.Jd()){b=Nd.a.Tc(b.node,b.cpEnd);Ga.OutlineElementNavigator.he(n);const B=Bl.Kf.tta(n);Bl.Kf.Tca(n,B,b,!0,!0,!0,!0);""!=h&&Bl.Kf.$z(n,!1,!0);n.Xd();return Nd.a.Tc(n.currentNode,0)}return null}static vzg(b){b=ve.GraphIterator.eb(b);b.zb(11)&&(b.ld(11),b.Jd()&&b.Fk()&&b.Xd()&&ea.ParagraphReader.Xb(b.currentNode)&&
(b=Oe.SelectionFactory.se(b.currentNode,0),Zb.a.instance.Ic(b)))}static MJf(b,h){const n=!F.a.taa(h);switch(b){case 1:b=n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,
h){Bl.Dw&&(b=Bl.MJf(b,h),Bl.Dw.sendNotification(b,!0))}static ipe(b,h,n,B=""){x.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");aa.a.sendTelemetryEvent(Object.assign(new wa.a,{name:n,dataFields:[Object.assign(new ia.a,{name:b,bool:h}),Object.assign(new ia.a,{name:"ProviderName",string:B})]}))}}Object(u.a)(Bl,"ExternalContentHelper",null,[]);var Xw=d(802);class IB{constructor(){this.Km=this.zt=null}l0d(b,h,n){b.Jj().yg.CF(()=>{this.mmg(h,b,n)},()=>
{x.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}mmg(b,h,n){if(b=this.UMf(b,h))h=Array(1),h[0]=b,n=AF.a.construct(h,n,A.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.zt.kq:null),b=this.Nuf(),this.Zxb(b,n)}UMf(b,h){if(!h)return x.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.zt=h.Jj();(new ve.GraphIterator).set(h);if(!h.anchor||!h.anchor.Uq||
!h.anchor.Uq.kt)return x.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var n=h.anchor.Uq.kt.node;if(!n)return x.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;n=n.ja(hi.a.lK,fk.a.Hu);const B=h.getValue(Hf.a.$H),L=ri.a.nf(Ad.ImageReader.tE(h.properties),0),ba=ri.a.nf(Ad.ImageReader.YJ(h.properties),1);return gy.a.construct(h.id.toString(),b,h.ja(Hf.a.imageAltText,
""),L,ba,h.ja(Lc.a.f0,""),n,h.ja(Lc.a.uX,0),h.ja(Lc.a.Tla,!1),h.ja(hi.a.Dka,-1),h.ja(Lc.a.Bub,Box4Intl.Box4Strings.l_Picture),h.ja(Hf.a.xCa,!1),B,h.ja(Lc.a.runId,1),h.ja(Lc.a.Yc,0))}Zxb(b,h){A.AFrameworkApplication.Be.Ij(b,2,D.c(h),{},!1,2,this.whd.bind(this),this.Wtc.bind(this),null,void 0,void 0,void 0,void 0,"26");x.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}whd(){x.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}Wtc(){x.ULS.sendTraceTag(592996168,
324,10,"Picture paste request for External Content failed.")}Nuf(){let b=za.a.O1c("PicturePaste.ashx");const h=pk.a.TWa;A.AFrameworkApplication.K&&!A.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=za.a.Fp(b,lg.a.fileId,this.zt.kq));b=za.a.Fp(b,lg.a.cellId,this.zt.pl.toString());this.Km||(this.Km=yb.a.create(),x.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=za.a.Fp(b,lg.a.v_,this.Km.toString());b=za.a.Fp(b,lg.a.classId,
h.toString());this.zt.NG&&(b=za.a.Fp(b,lg.a.NG,this.zt.NG));b=za.a.Fp(b,lg.a.FAb,"1");b=za.a.Fp(b,wh.a.imageType,Zq.other.toString());b=Qh.a.instance.Xff(b);b=za.a.Fp(b,lg.a.zza,this.zt.yg.Is.toString());b=za.a.Fp(b,lg.a.Ltc,"0");return b=za.a.Fp(b,lg.a.R2b,"1")}}Object(u.a)(IB,"ExternalContentThumbnailHelper",null,[]);class ru extends IB{constructor(){super(...arguments);this.Zo=null}static get Ff(){return null!=ru.kWg?ru.kWg:ru.kWg=Ya.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}tak(b,
h,n){return Bl.VXa(h)?Bl.Fnf(b,n)?!0:(ru.Ff.kU(this.Zo,2,"URL inserted in Non-Embedable context",ru.Ff.Xo()),!1):(x.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),ru.Ff.kU(this.Zo,2,"URL inserted is not valid for ExternalContent",ru.Ff.Xo()),!1)}}Object(u.a)(ru,"AbstractExternalContentEditor",IB,[413]);var ez=d(1270),CF=d(1262);class pp extends ru{constructor(b){super();pp.E3a=b;this.G5f()}G5f(){CF.a.G5f(pp.E3a.kxi())}static get rl(){return null!=
pp.J2g?pp.J2g:pp.J2g=Ya.a.instance.resolve("Box4.IParagraphEditor")}IFl(b,h){h=this.cCi(b,h);this.WSi(h,b,5)}YWa(b,h,n){if(this.tak(b,h,n)){var B=this.cCi(b,null);B.url=h;this.WSi(B,b,n?0:2)}}fqe(b,h){this.YWa(b,h,!1)}WSi(b,h,n){this.Km=yb.a.create();const B=new Sd.GraphTransaction(15);B.Ab(h.node);B.yi=Dc.a.U9m;const L=Bl.Zlc(h),ba=us.q(b.mediaType),la=Bl.$8d(b.height,b.width,b.title,ba);h=this.rwp(h,1==n);(h=Bl.Ck.oce(h,la))?(h=h.node,Bl.kce(h,{url:b.url,mediaType:ba,Av:b.title,loopType:b.type,
Yaj:n},void 0)||x.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),B.sMa(this.Km,1),B.dispose(),this.l0d(h,b.thumbnail,!1),this.mdo(L,ba,b.type)):x.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}rwp(b,h){Bl.rg.Ne(b,"");return Bl.PYd(b,h)}mdo(b,h,n){Bl.ipe("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");Bl.ariaNotify(h,this.kim(n))}kim(b){switch(b){case Xw.a.CheckList:return"Checklist Component";
case Xw.a.TaskAssignment:return"Task List Component";case Xw.a.Poll:return"Poll Component";default:return"Fluid Component"}}cCi(b,h){const n=new dz;n.width=Bl.D4.Wgc(b.node)||0;us.j()?n.height=null!=pp.E3a&&pp.E3a.hxi(h)||Bl.D4.N7a(b.node)||0:n.height=null!=pp.E3a&&pp.E3a.hxi(h)+2*yt.a.K6||Bl.D4.N7a(b.node)||0;n.title="Fluid Component";n.mediaType="fluid";n.type=h;n.thumbnail=this.Zsm();n.url=null!=pp.E3a&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2210.23001/en-us_web/assets/fallback.jpg";
return n}Zsm(){return pp.E3a.kxi()}static v9c(b){A.AFrameworkApplication.Ld("2cejb611;b0jjh576");return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=pp.E3a&&pp.E3a.U2i(b)&&ez.a.Tpl(b)}}Object(u.a)(pp,"FluidComponentEditor",ru,[]);class kD{get Q4l(){return null!=this.bWg?this.bWg:this.bWg=Ya.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get b4d(){return null!=this.vXg?this.vXg:this.vXg=Ya.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}gdo(b,
h){b&&(pp.v9c(h)?this.b4d.YWa(b,h,!0):this.Q4l.YWa(b,h,!0))}}Object(u.a)(kD,"PostHyperlinkAutoCorrectStrategy",null,[409]);class Np{wec(b,h){h(Np.rdo.test(b))}Ivc(b,h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",960,960,b);b=Object.assign(new GB,{OperationId:0,
StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:Np.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}Np.rdo=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$","i");Np.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(u.a)(Np,"PowerBIURLResolver",null,[403,404]);class Tu{constructor(b){this.QJh=b}wec(b,h){let n=!1;try{if(Tu.Yrn(b)){const B=this.QJh.Kkc(b);n=null!=B.width&&null!=B.height&&!!B.thumbnailUrl&&!!B.title&&null!=B.Nva}}catch(B){}h(n)}Ivc(b,
h){var n=this.QJh.Kkc(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",n.width,n.height,b);n=Object.assign(new GB,
{Height:n.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:n.thumbnailUrl,Title:n.title,Width:n.width});h(n)}static Yrn(b){for(const h of Tu.Uep)if(b.startsWith(h))return!0;return!1}static Daa(){return new Tu(Ya.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}Tu.Uep=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(u.a)(Tu,"WedgeComponentExperimentsURLResolver",null,[403,404]);var zo=d(950);let fz=!1;class Tt{static b7o(b){Tt.k_i||
Tt.addEventListener();const h=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");h&&h.execute(n=>{n.logActivity(b,null)})}static addEventListener(){window.addEventListener(Tt.Afp,Tt.zfp,!0);Tt.k_i=!0}static xsl(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click();fz=!0}}Tt.DGn="LoopHomeTabFlightActivity";Tt.Afp="switchToInsertTabAndClickLoopButtonEvent";Tt.k_i=!1;Tt.zfp=()=>{var b,h;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));const n=
null===(b=A.AFrameworkApplication.K)||void 0===b?void 0:b.ic("WordLoopsTUIButtonDropdownDelayInMs",50);b=new Re.a(0,1,n,()=>{Tt.xsl()});null===(h=A.AFrameworkApplication.mc)||void 0===h?void 0:h.Zb(b)};Object(u.a)(Tt,"FluidComponentsTUIHelper",null,[]);class DF{constructor(b,h,n){this.ga=b;this.Xvk=h;this.ul=n;this.Iph=!1;this.iuh=1E3;this.juh=15E3;this.o9e=this.f9e=!0;this.o9e=!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowLoopComponentSurveyEnabled",
!1);this.iuh=!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.LoopComponentDropdownFocusTime",1E3);this.juh=!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NotUseLoopComponentSurveyTriggerTime",15E3)}Wb(){this.ga.fb(Dc.a.bTi,oc.a.Xc,this.s$m.bind(this),1028);this.ga.fb(Dc.a.Lqe,oc.a.Xc,this.Lqe.bind(this),1028);this.ga.fb(Dc.a.i8c,oc.a.Xc,this.dWf.bind(this),1028);this.ga.fb(Dc.a.W7c,oc.a.Xc,
this.dWf.bind(this),1028);this.ga.fb(Dc.a.sce,oc.a.Xc,this.dWf.bind(this),1028);this.ga.fb(Dc.a.M6i,oc.a.Xc,this.Vgk.bind(this),1028)}s$m(){return 32}Lqe(b,h,n){if(2!==n)return 32;this.o9e&&(this.iDj(),this.Anp());return 32}dWf(b,h,n){var B,L;if(1===n){if(!this.qee(b)||!zo.a.LYi())return x.ULS.sendTraceTag(508937180,324,50,"Loops feature is disabled as it is not supported"),2;if(!h.Gl||!re.SelectionEditor.mf(h)||(null===(B=this.ul)||void 0===B?0:B.Q2(h))||(null===(L=this.ul)||void 0===L?0:L.Vla(h)))return 2;
if(h&&h.node&&St.a(h.node))return 32}else if(2===n)return this.Xvk.IFl(h,DF.Xsm(b)),this.iDj(),32;return 2}Anp(){if(null!=Xa.a.instance.getItem("LoopComponentSurveyShowed")||fz)this.f9e=!1;if(this.f9e){let b=this.bCi();window.setTimeout(()=>{b&&"hidden"!==b.visibility&&(this.Iph=!0)},this.iuh);this.DKk=window.setTimeout(()=>{const h=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");this.Iph&&h&&h.execute(n=>{(b=this.bCi())&&"hidden"===b.visibility&&!fz&&(x.ULS.sendTraceTag(508941015,324,50,"Triggering not use loop component survey"),
n.O_a("WordLoopFeedbackSurvey",null),this.f9e=!1,Xa.a.instance.setItem("LoopComponentSurveyShowed","true"))})},this.juh)}}bCi(){var b,h;let n=null;try{const B=document.getElementById("Ribbon-LoopComponentDropdown");B&&(n=fo.a.WB(null===(h=null===(b=B.parentNode)||void 0===b?void 0:b.parentNode)||void 0===h?void 0:h.parentNode))}catch(B){x.ULS.sendTraceTag(508941014,324,10,"Loop component dropdown get parent and parent get exception "+(null!=B?B.toString():""))}return n}iDj(){this.o9e&&window.clearTimeout(this.DKk)}qee(b){return b===
Dc.a.W7c||b===Dc.a.i8c?ez.a.qee():!0}Vgk(b,h,n){2===n&&F.a.IX("https://go.microsoft.com/fwlink/?linkid=2194838")&&$e.App.Lwg.JAc("https://go.microsoft.com/fwlink/?linkid=2194838");return 32}static Xsm(b){switch(b){case Dc.a.i8c:return Xw.a.TaskAssignment;case Dc.a.W7c:return Xw.a.CheckList;case Dc.a.sce:return Xw.a.Poll;default:return null}}}Object(u.a)(DF,"FluidComponentsActor",null,[]);class Fj extends ru{constructor(){super();this.lUb=this.kUb=null;this.LCf=new hy.ExternalContentEmbedRetriever;
this.oHc=null;null!=Fj.tsa&&Fj.tsa.Bwi()}Ayj(){this.Zo=S.a.create();Fj.Ff.DMb(this.Zo,4);Fj.Ff.C8(this.Zo,0,Fj.Ff.Xo());this.iSb(this.kUb,3,this.lUb,!0)}YWa(b,h,n){this.Zo=S.a.create();Fj.Ff.DMb(this.Zo,n?0:2);Fj.Ff.C8(this.Zo,0,Fj.Ff.Xo());this.oHc();this.iSb(b,n?0:2,h)}fqe(b,h){this.Zo=S.a.create();Fj.Ff.DMb(this.Zo,1);Fj.Ff.C8(this.Zo,0,Fj.Ff.Xo());this.iSb(b,1,h)}tAj(b){this.oHc=b}gJe(b,h){const n=Fj.D4.Wgc(h)||0;h=Fj.D4.N7a(h)||0;const B=b.Width/b.Height;1<=B?(b.Width=n,b.Height=n/B):(b.Height=
h,b.Width=h/B)}lRg(b,h,n){if(null!=b&&null!=h&&!F.a.Tf(n)){var B=Fj.Hed.Kkc(n);A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",!1)?B.Nva=!1:B.Nva=!0;B.hideFloatie=!0;this.gJe(b,h.node);this.anc(b,h,!1,!1,B,n)}}jrb(b){return b?b.He:0}XNg(b,h,n){let B=null;const L=b.node;if(!ea.ParagraphReader.Xb(L)||!L.isConnected)return{returnValue:!1,rwa:B};if(n)return{returnValue:!0,rwa:b};n=b.cpBegin;const ba=b.cpEnd,
la=ea.ParagraphReader.text(L);if(0<=n&&ba<=la.length&&la.substring(n,ba)===h)return{returnValue:!0,rwa:b};const La=la.indexOf(h);return 0<=La?(B=Nd.a.createTextRange(L,La,La+h.length),{returnValue:!0,rwa:B}):0<=n&&ba<=la.length&&Bl.Zlc(b)?{returnValue:!0,rwa:b}:{returnValue:!1,rwa:B}}X1f(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}tfb(b,h){A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const n=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");
n&&n.execute(B=>{B.logActivity(b,h)})},Fj.GJa)}iSb(b,h,n,B=!1){if(this.tak(b,n,!h)){var L=Fj.Hed.Kkc(n);L&&(this.X1f(L)?(x.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),this.gmg(b,h,L,n,B)):(x.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Fj.Ff.kU(this.Zo,2,"Size provided is not valid for OEmbed",Fj.Ff.Xo())))}}gmg(b,h,n,B,L){const ba=!h,la=1===h,La=Fj.D4.Wgc(b.node)||0,fb=Fj.D4.N7a(b.node)||0,Cb=HB.a.Brf(n.qNg,
!0,La,fb);this.pcd(b,B,h,!0);this.LCf.A1h(Cb,Lb=>{Fj.Ff.C8(this.Zo,4,Fj.Ff.Xo());Fj.Ff.Ynd(this.Zo,this.jrb(Lb.data));if(Lb=this.omg(Lb)){x.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var $b=us.q(Lb.MediaType);Fj.Ff.Ite(this.Zo,7,$b);$b=b;({rwa:$b}=this.XNg(b,B,la)).returnValue?(this.pcd($b,B,h,!1),null==n.width?0<La&&Lb.Width>La&&(x.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),
Lb.Width=La):(x.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Lb.Width=this.qud(n.width,Lb.Width,La)),null==n.height?0<fb&&Lb.Height>fb&&(x.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Lb.Height=fb):(x.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Lb.Height=this.qud(n.height,Lb.Height,
fb)),Fj.tsa.qhb||L?this.anc(Lb,$b,ba,la,n,B):(this.kUb=b,this.lUb=B,this.DXc(B))):(x.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),Fj.Ff.kU(this.Zo,2,"No conversion as the context is no longer valid for the external content conversion",Fj.Ff.Xo()));la&&this.Q6a($b.node)}else la&&this.Q6a(b.node),Fj.Ff.kU(this.Zo,1,"URL not oEmbedable",Fj.Ff.Xo())},Lb=>{Fj.Ff.C8(this.Zo,4,Fj.Ff.Xo());Fj.Ff.Ynd(this.Zo,
this.jrb(Lb.data));la&&this.Q6a(b.node);x.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Lb.data.De);Fj.Ff.kU(this.Zo,2,"ExternalContentEmbedRequest failed",Fj.Ff.Xo())},Lb=>{la&&this.Q6a(b.node);x.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Lb)},this.Zo)}qud(b,h,n){!b&&0<n&&h>n||b>n?(x.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=n):b>n?
h=n:b&&b<n&&(h=b);return h}anc(b,h,n,B,L,ba){this.Km=yb.a.create();b.Width=b.Width/b.Height*(b.Height-(yt.a.o6c+yt.a.K6))+2*yt.a.K6;const la=new Sd.GraphTransaction(15);la.Ab(h.node);la.yi=Dc.a.YWa;const La=Bl.Zlc(h);null!=L.Nva&&!L.Nva||B||La||(b.Title=""===L.title||L.title?L.title:b.Title,!b.Title&&""!==b.Title)||(h=this.rWf(h,la,b.Title,ba,n));if(h){B&&(h=this.Jwf(h));var fb=Bl.PYd(h,B);if(fb){n=us.q(b.MediaType);var Cb=Bl.$8d(b.Height,b.Width,b.Title,n);(fb=this.$Vf(fb,Cb,B,{url:ba,g7a:b.IFrameHtml,
Av:b.Title,mediaType:n},b.ProviderName))?(la.sMa(this.Km,1),la.dispose(),this.kUb=h,this.lUb=ba,this.Jig(L,b,fb),this.Tlg(ba,B||L.hideFloatie,La,n,b.Title,b.ProviderName)):la.dispose()}else la.dispose(),x.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Fj.Ff.kU(this.Zo,2,"Could not create IP context on splitting the paragraph",Fj.Ff.Xo())}else Fj.Ff.kU(this.Zo,2,"GraphNodeContext is null",Fj.Ff.Xo())}$Vf(b,h,n,B,L){if(!b)return null;
b=Fj.KR.oce(b,h);if(!b)return x.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Fj.Ff.kU(this.Zo,2,"The anchored image could not be inserted",Fj.Ff.Xo()),null;b=b.node;B=Bl.kce(b,B,L);Fj.Ff.nMg(this.Zo,B.id);n||Bl.vzg(b);return b}Jig(b,h,n){F.a.taa(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Fj.Ff.C8(this.Zo,8,Fj.Ff.Xo()),x.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),
this.l0d(n,h.Thumbnail,!1))}Tlg(b,h,n,B,L,ba){h||this.DXc(b);this.tfb("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Bl.ipe("IsHyperlinkWithNonURLDisplayText",n,"Office.Word.Online.ExternalContent.OEmbedInsertions",ba);Bl.ariaNotify(B,L);Fj.Ff.C8(this.Zo,5,Fj.Ff.Xo())}rWf(b,h,n,B,L){if(L){if((L=ef.a.QA(b,!1))&&1!==L.length)return h.dispose(),x.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Bl.Np.hV(L[0].paragraph,
L[0].hyperlink)}return this.$tg(b,n,B)}Jwf(b){const h=b.node,n=ea.ParagraphReader.text(h);return 0<n.length&&!n.trim().length?(b=Nd.a.createTextRange(h,0,n.length),Bl.rg.Ne(b,""),Nd.a.Tc(h,0)):b}omg(b){if(!({group:b}=ii.a.R4(b.data.De)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}$tg(b,h,n){const B=b.cpBegin+h.length;Bl.rg.Ne(b,h);b=Nd.a.createTextRange(b.node,b.cpBegin,B);Bl.Np.vF(b,n,!1);return b}Q6a(b){b.Otc=null}pcd(b,h,n,B){const L=b.cpBegin,ba=b.cpEnd;b=ea.ParagraphReader.text(b.node).trim();
L||b!==h&&""!==b?L?ba===b.length?x.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",$r[n],B):0<L&&ba<b.length&&x.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",$r[n],B):x.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
$r[n],B):x.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",$r[n],B)}DXc(b){this.chc();const h=new Jw.a(1,A.AFrameworkApplication.isRtl);h.ihd=b;Fj.vpb.Gjd(h)}chc(){const b=new Iw.a(!0);Fj.mca.ENa(b)}static get vpb(){return null!=Fj.dWg?Fj.dWg:Fj.dWg=Ya.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get tsa(){Fj.uGa||(Fj.uGa=Ya.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));
return Fj.uGa}static get mca(){return null!=Fj.f3g?Fj.f3g:Fj.f3g=Ya.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get D4(){return null!=Fj.o4g?Fj.o4g:Fj.o4g=Ya.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get KR(){return null!=Fj.UYg?Fj.UYg:Fj.UYg=Ya.a.instance.resolve("WordEditor.IImageEditor")}static get Hed(){return null!=Fj.O1g?Fj.O1g:Fj.O1g=Ya.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}Fj.GJa=5E3;Fj.uGa=null;
Object(u.a)(Fj,"ExternalContentEditorV2",ru,[]);class Yw{constructor(){this.xd=this.W=null}get name(){return"WordEditor.ExternalContent"}get rc(){return this.xd?this.xd:this.xd=this.W.resolve("Box4.IFeatureHelper")}wc(b){var h;this.W=b;b.ia("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new kA.a(Po.a.instance,Ym.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").ha();b.ia("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new kD).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").ha();
b.ia("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new xk(b.resolve("Box4.IRoamingServiceRequestManager"),b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").ha();A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ia("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new Fj).as("Wonca.ExternalContent.IExternalContentEditor").ha(),b.ia("WordEditor.ExternalContent.FluidComponentEditor",
()=>new pp(b.resolve("Fluid.Host.LoopComponentManager"))).ha(),b.ia("WordEditor.ExternalContent.FluidComponentsActor",()=>new DF(A.AFrameworkApplication.va,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),Pd.a.instance)).ha(),(null===(h=A.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&Tt.b7o(Tt.DGn)):b.ia("WordEditor.ExternalContent.ExternalContentEditor",()=>new th).as("Wonca.ExternalContent.IExternalContentEditor").ha()}init(){this.rc.Ds.continueWith(()=>
{this.Mo()});A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").Wb()}dispose(){}zFl(){const b=new iD;this.Tji()&&b.COh(Tu.Daa());b.COh(new Np);return b}Mo(){null==A.AFrameworkApplication.K||A.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ia("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new BF.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").ha();
this.Tji()&&(this.W.ia("WordEditor.ExternalContent.IWordExternalContentURLResolver",()=>this.zFl()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").ha(),this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}Tji(){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){M.a.instance.Jc(new Yw)}}Object(u.a)(Yw,"ExternalContentPackage",null,[0,1]);var Kn;(function(b){b[b.invalid=
-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.iwf=6]="decimal";b[b.PTp=7]="bar";b[b.ovb=8]="num"})(Kn||(Kn={}));Object(u.b)("TabStopValues",Kn);class co{}co.Pdi=8;co.WOl=1;co.Saa="wwaengidc";co.kpiName="WordRuler";co.precision=.0625;co.Egp=1;co.pCp="ShowHideRuler";Object(u.a)(co,"Constants",null,[]);var JB=d(1146);class Cq{static dlc(b,h){if(!Cq.R$c)return null;switch(b){case "Left":return n=>{const B=n.rulerCanvasProps;
n=n.indents;return{wUb:0,UZb:B.scale-(B.margins[1].value+n[2].value+Math.max(n[0].value,n[1].value)+8*B.precision)}};case "Right":return n=>{const B=n.rulerCanvasProps;n=n.indents;return{wUb:0,UZb:B.scale-(n[2].value+(B.margins[0].value+Math.max(n[0].value,n[1].value))+8*B.precision)}};case "MoveTableColumn":return()=>{let n=0,B=0;if(0===h){var L={};32===Cq.Sb.Pb(wb.a.Quc,2,L)&&(n=Fg.a.oB(L.MinIndent),B=Fg.a.oB(L.MaxIndent))}else L={np:h-1},32===Cq.Sb.Pb(wb.a.Ouc,2,L)&&(n=Fg.a.oB(L.MinResize),B=Fg.a.oB(L.MaxResize));
return{wUb:n,UZb:B}};case "Top":return n=>{n=n.rulerCanvasProps;return{wUb:0,UZb:n.scale-(n.margins[1].value+8*n.precision)}};case "Bottom":return n=>{n=n.rulerCanvasProps;return{wUb:0,UZb:n.scale-(n.margins[0].value+8*n.precision)}}}return null}static n9d(b){if(!Cq.R$c)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>{var n=h.rulerCanvasProps,B=h.indents,L=h.ipContextIndex;h=n.margins;var ba=n.scale;n=n.precision;if("MoveTableColumn"!==h[0].type){L=h[0].value;
h=h[1].value+B[2].value;var la=L;"LeftIndent"===b&&(la+=Math.max(B[0].value,B[1].value));B=-1*L;n=ba-(la+h+8*n)}else{ba=0;for(la=0;la<=L;la++)ba+=h[la].value;la=0;if("LeftIndent"===b){la=B[0].value;const La=B[1].value;ba+=Math.max(la,La);la=Math.max(la,La)}h=h[L+1].value;la+=B[2].value;B=-1*ba;n=h-la-n}return{wUb:B,UZb:n}};case "RightIndent":return h=>{var n=h.rulerCanvasProps,B=h.indents,L=h.ipContextIndex,ba=n.margins;h=n.scale;n=n.precision;if("MoveTableColumn"!==ba[0].type){var la=ba[0].value;
ba=ba[1].value;L=B[0].value;var La=B[1].value;B=-1*ba;h-=la+ba+Math.max(L,La)+8*n}else{la=0;for(La=0;La<=L;La++)la+=ba[La].value;ba=ba[L+1].value;L=B[0].value;La=B[1].value;B=-1*(h-la-ba);h=ba-Math.max(L,La)-n}return{wUb:B,UZb:h}}}return null}static gJm(){return b=>{var h=b.rulerCanvasProps,n=b.indents,B=b.ipContextIndex,L=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==L[0].type?(B=L[0].value,L=L[1].value+n[2].value,n=Math.min(n[0].value,n[1].value)+b,b=h-(B+L+b)):(h=n[2].value,L=L[B+1].value,
n=Math.min(n[0].value,n[1].value)+b,b=L-(h+b));return{wUb:n,UZb:b}}}static get Sb(){return null!=Cq.HTg?Cq.HTg:Cq.HTg=A.AFrameworkApplication.va}static get R$c(){null==this.njb&&(A.AFrameworkApplication.yga("WoRul910;WoRul910cf"),this.njb=A.AFrameworkApplication.K?A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.njb}}Cq.njb=null;Object(u.a)(Cq,"RulerPropertyBoundaryHelper",null,[]);var wH=d(1002),gz=d(1546),Zw=d(1142),
Os=d(1328),jt=d(1329);class as{constructor(b,h,n,B,L,ba,la){this.A6n="OutlineContainer";this.FRk="UpdateCustomTabFailed";this.rHb="ReadRulerPropertiesFailed";this.JRk="UpdateIndentFailed";this.EJh="UpdateMarginFailed";this.Yne=La=>{(La.button===Sys.UI.MouseButton.rightButton||this.gqn&&La.button===Sys.UI.MouseButton.leftButton)&&this.F7e.show(new Sys.UI.Point(La.clientX,La.clientY),2)};this.e9j=()=>{this.K0a()};this.eo=b;this.z9b=h;this.ga=n;this.F7e=B;this.uA=L;this.EH=ba;this.F6b=null;this.YK=la;
this.Zx=!!A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.q0;this.vmj=this.Ine.bind(this);this.spj=this.kv.bind(this);this.d9j=this.K0a.bind(this)}LE(){this.Hff();this.HOh();this.z9b.Il.Ve(10).fo(this.vmj);Nb.a.addHandler(this.cdf,Cd.a.scroll,this.e9j);this.eo.execute(h=>{h.Q0(this.spj)});const b=[this.GMf(),document.getElementById(Mk.a.DBc),document.getElementById("PageContentContainer")];this.Lrg(b);Ua.StaticActiveAppFrame.za().cL.registerBoundingWindowRectsChanged("documentPanel",(h,
n)=>{"undefined"!==n&&this.Kfb([1,0])})}Lrg(b){this.F6b?this.F6b.register(b,this.d9j):Zw.a(gz.a.O5k,()=>{appChrome.getResizeObserver().then(h=>{this.F6b=h.createResizeObserver();this.F6b.register(b,this.d9j);return null})})}GMf(){var b;const h=this.EH.Ax;return 1===h||2===h?(null===(b=A.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isRulerPositionFixEnabled",!1))?this.Yyh:this.qIk:this.Cyh}get cdf(){return document.getElementById(Mk.a.c1a)}get Cyh(){const b=
document.getElementsByClassName(this.A6n);return b&&0<b.length?b[0]:null}get qIk(){var b=this.uA.FOb;if(!b)return null;b=this.pMo(ea.ParagraphReader.vU(b));return wH.a.WDi(b)}get DSa(){return this.YK.value}get Yyh(){return this.DSa.ue(this.DSa.jd).lS}pMo(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+b+"']"):null}get uQ(){return this.eo&&this.eo.instance?this.eo.instance.Aj:co.WOl}rkc(){const b={};return 32!==this.ga.Pb(wb.a.ANa,2,b)?(x.ULS.sendTraceTag(529065947,Os.a.XOn,jt.a.ut,
"Unable to read page properties for Ruler"),Yl.recordQosError(this.rHb,[Yl.hja],"Unable to read page properties for Ruler"),null):b}dispose(){this.UOi();this.z9b.Il.Ve(10).QN(this.vmj);Nb.a.removeHandler(this.cdf,Cd.a.scroll,this.e9j);this.eo.execute(b=>{b.YZa(this.spj)});this.F6b&&this.F6b.dispose();Ua.StaticActiveAppFrame.za().cL.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==h&&this.Kfb([1,0])})}get K_i(){null==as.bYe&&(as.bYe=A.AFrameworkApplication.K?A.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&
A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&A.AFrameworkApplication.K.$("RulerThemingIsEnabled"):!1);return as.bYe}get gqn(){null==as.KYe&&(as.KYe=A.AFrameworkApplication.K?A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRulerContextMenuOnLeftClick",!1):!1);return as.KYe}}as.bYe=null;as.KYe=null;Object(u.a)(as,"ARuler",null,[275]);var mq=d(311);class zp extends as{constructor(b,h,n,B,L,ba,la,La){super(b,
h,n,L,ba,la,La);this.YR="HorizontalRuler";this.Qek="CustomTabModificationFromRuler";this.vgk="IndentModificationFromRuler";this.lIe="MarginModificationFromRuler";this.Flh=this.Elh=this._tabStops=null;this.GWn=(fb,Cb,Lb)=>{if(!(fb>=this._tabStops.length)){fb=this._tabStops[fb];var $b="Modify"===Lb?this.ga.Pb(Dc.a.Jrc,2,{["tabStop"]:fb,["value"]:Fg.a.Ow(Cb)}):this.ga.Pb(Dc.a.kdb,2,fb);if(32===$b){Cb=1;var tc=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",Lb,Kn[fb.Lha]);
x.ULS.sendTraceTag(591213271,3014,50,tc)}else Cb=0,tc=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",Lb,Kn[fb.Lha]),x.ULS.sendTraceTag(591213272,3014,15,tc),Yl.recordQosError(this.FRk,[Yl.hja],"Unable to modify custom tab using ruler");Pe.a(this.Qek,32===$b,void 0,[Object.assign(new ia.a,{name:"Operation",string:Lb}),Object.assign(new ia.a,{name:"TabType",int64:Kn[fb.Lha]})]);Lb=new Map;Lb.set("Command","OnCustomTabChange");Lb.set("Source",this.YR);Lb.set("Response",
tc);oa.Health.instance.recordKpiUsage(co.kpiName,Cb,co.Saa,Lb)}};this.VYn=(fb,Cb)=>{var Lb=new JB.a;Lb.unit=1;Lb.value=Fg.a.Ow(Cb);Cb=8;switch(fb){case "FirstLineIndent":Cb=this.ga.Pb(wb.a.Fod,2,Lb);break;case "HangingIndent":Cb=this.ga.Pb(wb.a.God,2,Lb);break;case "LeftIndent":Cb=this.ga.Pb(wb.a.u$a,2,Lb);break;case "RightIndent":Cb=this.ga.Pb(wb.a.t$a,2,Lb)}let $b;32===Cb?(Lb=1,$b=String.format("Indents set using Ruler. Indent: {0}",fb),x.ULS.sendTraceTag(592517017,3014,50,$b)):(Lb=0,$b=String.format("Unable to set indent using Ruler. Indent: {0}",
fb),x.ULS.sendTraceTag(592496523,3014,15,$b,fb),Yl.recordQosError(this.JRk,[Yl.hja],"Unable to set indent using Ruler."));Pe.a(this.vgk,32===Cb,void 0,[Object.assign(new ia.a,{name:"Type",string:fb})]);fb=new Map;fb.set("Command","OnIndentChange");fb.set("Source",this.YR);fb.set("Response",$b);oa.Health.instance.recordKpiUsage(co.kpiName,Lb,co.Saa,fb)};this.etc=(fb,Cb)=>{if(Yl.instance.nga)switch(Cb.Nbb){case 2:case 1:this.Lrg([this.Yyh]);break;case 0:this.Lrg([this.Cyh])}};this.egg=(fb,Cb,Lb)=>{let $b;
$b="Left"===fb?this.ga.Pb(wb.a.Ena,2,Fg.a.Ow(Cb)):"Right"===fb?this.ga.Pb(wb.a.eeb,2,Fg.a.Ow(Cb)):Lb?this.ga.Pb(wb.a.gCe,2,{["columnIndex"]:Lb-1,["width"]:Fg.a.Ow(Cb)}):this.ga.Pb(wb.a.wxc,2,Fg.a.Ow(Cb));32===$b?(Cb=1,Lb=String.format("Margins set using Ruler. Margin: {0}",fb),x.ULS.sendTraceTag(592517018,3014,50,Lb)):(Cb=0,Lb=String.format("Unable to set margins using Ruler. Margin: {0}",fb),x.ULS.sendTraceTag(592496524,3014,15,Lb),Yl.recordQosError(this.EJh,[Yl.hja],"Unable to set margins using Ruler."));
Pe.a(this.lIe,32===$b,void 0,[Object.assign(new ia.a,{name:"Type",string:fb})]);fb=new Map;fb.set("Command","OnMarginChange");fb.set("Source",this.YR);fb.set("Response",Lb);oa.Health.instance.recordKpiUsage(co.kpiName,Cb,co.Saa,fb)};this.cTa=B;this.vs={}}get sX(){return this.Elh}get hLa(){return this.Flh}renderRuler(){this.sX.classList.remove("HideWACHorizontalRulerContainer");this.sX.classList.add("ShowWACHorizontalRulerContainer");var b=this.rkc();if(b){var h=this.egg,n=this.VYn,B=this.GWn,L=this.Jsd(),
ba=this.v3j(),la=this.u3j();L&&ba&&la||(this.vs.disabled=!0);this.vs.onIndentChange=n;this.vs.onMarginChange=h;this.vs.onTabChange=B;this.K0a();b=ri.a.qj(b.rp,0);this.hLa.style.width=(b*this.uQ).toString()+"px";return this.cTa().then(La=>{La.renderRuler(this.hLa,this.vs)})}}static Q$c(){null==this.MEb&&null!=A.AFrameworkApplication.K&&(this.MEb=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.isRulerPositionFixEnabled",!1));return this.MEb}u3j(){const b=[];var h={};if(32!==
this.ga.Pb(Dc.a.nYb,2,h))return x.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),Yl.recordQosError(this.rHb,[Yl.hja],"Unable to read paragraph tabs for Ruler"),!1;var n=h.customTabs;if(!n||0>=n.length)return this.vs.tabs=b,!0;this._tabStops=n;h="";for(const B of n){switch(B.Lha){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h="DecimalTab";break;case 7:h="BarTab"}n=ri.a.vNa(B.QOa,0);b.push({["type"]:h,["value"]:n,["getRulerPropertyBoundary"]:Cq.gJm()})}this.vs.tabs=
b;return!0}Kfb(b){var h;if(this.sX){this.sX.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.vs&&delete this.vs.disabled;for(const n of b)switch(n){case 0:b=this.v3j();const B=this.u3j();b&&B||(this.vs.disabled=!0);break;case 1:this.Jsd()||(this.vs.disabled=!0)}if(null===(h=this.uA.currentSelection)||void 0===h?0:h.u9c)this.vs.disabled=!0;this.cTa().then(n=>{n.renderRuler(this.hLa,this.vs);return null})}}Jsd(){const b={};var h=this.rkc();if(!h)return!1;b.scale=Fg.a.oB(h.rp);b.precision=
co.precision;b.rulerType="Horizontal";if(!this.K4n())return this.vs.ipContextIndex=0,this.vs.permittedUnits=co.Pdi,h=[{["type"]:"Left",["value"]:Fg.a.oB(h.marginLeft),["getRulerPropertyBoundary"]:Cq.dlc("Left",0)},{["type"]:"Right",["value"]:Fg.a.oB(h.marginRight),["getRulerPropertyBoundary"]:Cq.dlc("Right",1)}],b.margins=h,this.vs.rulerCanvasProps=b,!0;var n={};h={};var B=this.ga.Pb(wb.a.njd,2,n);const L=this.ga.Pb(wb.a.AYb,2,h);if(32!==B||32!==L)return x.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),
Yl.recordQosError(this.rHb,[Yl.hja],"Unable to read table properties for Ruler"),!1;n=n.ColumnWidths;B=h.TablePosition;if(!B||!n||0>=n.length)return x.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),Yl.recordQosError(this.rHb,[Yl.hja],"Cannot show table properties on the ruler as they are null"),!1;h=Array(n.length+1);h[0]={["type"]:"MoveTableColumn",["value"]:Fg.a.oB(B.x/this.uQ),["getRulerPropertyBoundary"]:Cq.dlc("MoveTableColumn",0)};for(B=0;B<
n.length;B+=1)h[B+1]={["type"]:"MoveTableColumn",["value"]:Fg.a.oB(n[B]),["getRulerPropertyBoundary"]:Cq.dlc("MoveTableColumn",B+1)};this.vs.ipContextIndex=this.UMm();this.vs.permittedUnits=co.Egp;b.margins=h;this.vs.rulerCanvasProps=b;return!0}v3j(){var b={};if(32!==this.ga.Pb(wb.a.Zcb,2,b))return x.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),Yl.recordQosError(this.rHb,[Yl.hja],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};
h.getRulerPropertyBoundary=Cq.n9d("FirstLineIndent");const n={type:"HangingIndent"};n.getRulerPropertyBoundary=Cq.n9d("HangingIndent");const B={type:"RightIndent"};B.getRulerPropertyBoundary=Cq.n9d("RightIndent");const L={type:"LeftIndent"};L.getRulerPropertyBoundary=Cq.n9d("LeftIndent");this.vs.rtl=b.isRtl;b=b.Eu;h.value=1===b.specialIndentType?Fg.a.oB(b.Eha+b.oD):2===b.specialIndentType?Fg.a.oB(b.oD-b.Eha):Fg.a.oB(b.oD);n.value=Fg.a.oB(b.oD);L.value=Fg.a.oB(b.oD);B.value=Fg.a.oB(b.ota);this.vs.indents=
[h,n,B,L];return!0}HOh(){Nb.a.addHandler(this.sX,Cd.a.nz,this.Yne);zp.Q$c()&&this.EH.LRd(this.etc)}UOi(){this.sX&&(this.sX.classList.remove("ShowWACHorizontalRulerContainer"),this.sX.classList.add("HideWACHorizontalRulerContainer"),Nb.a.removeHandler(this.sX,Cd.a.nz,this.Yne));this.cTa().then(b=>{b.dispose(this.hLa);return null});zp.Q$c()&&this.EH.dtg(this.etc)}kv(){this.g9j();this.K0a();this.Kfb([1,0])}Ine(b,h){b=h.property;if(b===Lc.a.rp||b===Lc.a.marginLeft||b===Lc.a.marginRight)this.g9j(),this.K0a(),
this.Kfb([1])}g9j(){var b=this.rkc();b&&(b=ri.a.qj(b.rp,0),this.hLa.style.width=Math.round(b*this.uQ).toString()+"px")}K0a(){window.requestAnimationFrame(()=>{var b=this.GMf();b&&(b=$c.a.getElementBounds(b),A.AFrameworkApplication.isRtl?this.hLa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+"px":this.hLa.style.marginLeft=b.x.toString()+"px")})}UMm(){const b=ve.GraphIterator.eb(this.uA.FOb);if(b.zb(14))return b.ld(16),tx.a(b,!0);x.ULS.sendTraceTag(557110540,
3014,15,"Unable to read table column index for Ruler");Yl.recordQosError(this.rHb,[Yl.hja],"Unable to read table column index for Ruler");return 0}K4n(){let b=!0;const h=this.uA.currentSelection.bR();if(null===h)return x.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),Yl.recordQosError(this.rHb,[Yl.hja],"Unable to get Context Iterator for the Ruler"),!1;for(;h.moveNext()&&b;){const n=ve.GraphIterator.eb(h.current.node);n.Jd();b=b&&xh.TableReader.yy(n)}return b}Hff(){if(!this.hLa&&
!this.sX){this.Elh=document.createElement("div");this.sX.id=zp.xyk;this.sX.className=zp.wyk;this.sX.setAttribute(Bc.a.Jja,WordEditorIntl.WordEditorStrings.L_Ruler);this.sX.setAttribute(Bc.a.Ph,Bc.a.PUh);this.sX.classList.add("HideWACHorizontalRulerContainer");if(this.K_i){var b=A.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");const h=A.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");fc.a.Bfa(b,!h)&&this.sX.classList.add(zp.YEk)}this.Flh=document.createElement("div");
this.hLa.className=zp.vyk;this.hLa.id=zp.yyk;this.sX.appendChild(this.hLa);b=null;this.Zx&&((b=Object(mq.a)("EditorBars"))&&b.appendChild(this.sX),this.sX.classList.add("regionComposer"));b||(b=document.getElementById(Mk.a.DBc),b.insertBefore(this.sX,b.firstChild))}}static LG(){return new zp(Ya.a.instance.Qa("Common.IZoomManager"),$e.App.jf,A.AFrameworkApplication.va,Wk.UISurfaces.JGi,Ya.a.instance.resolve("WordEditor.IRulerContextMenu"),dt.a.instance,Ya.a.instance.resolve("WordEditor.IMainViewModeManager"),
zp.Q$c()?new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.sc):null)}static get instance(){return null!=zp.p_g?zp.p_g:zp.p_g=zp.LG()}}zp.MEb=null;zp.xyk="WACHorizontalRulerContainer";zp.wyk="WACHorizontalRulerContainer";zp.yyk="WACHorizontalRuler";zp.vyk="WACHorizontalRuler";zp.YEk="ModernUxWACHorizontalRulerContainer";Object(u.a)(zp,"HorizontalRuler",as,[]);var iy=d(1028);class nq extends as{constructor(b,h,n,B,L,ba,la,La){super(b,h,n,L,ba,la,La);this.YR="VerticalRuler";this.lIe="MarginModificationFromRuler";
this.uKh=this.tKh=null;this.egg=(fb,Cb)=>{let Lb=8;"Top"===fb?Lb=this.ga.Pb(wb.a.feb,2,Fg.a.Ow(Cb)):"Bottom"===fb&&(Lb=this.ga.Pb(wb.a.deb,2,Fg.a.Ow(Cb)));let $b;32===Lb?(Cb=1,$b=String.format("Margins set using Ruler. Margin: {0}",fb),x.ULS.sendTraceTag(529065945,3014,50,$b)):(Cb=0,$b=String.format("Unable to set margins using Ruler. Margin: {0}",fb),x.ULS.sendTraceTag(529065946,3014,15,$b),Yl.recordQosError(this.EJh,[Yl.hja],"Unable to set margins using Ruler."));Pe.a(this.lIe,32===Lb,void 0,[Object.assign(new ia.a,
{name:"Type",string:fb})]);fb=new Map;fb.set("Command","OnMarginChange");fb.set("Source",this.YR);fb.set("Response",$b);oa.Health.instance.recordKpiUsage(co.kpiName,Cb,co.Saa,fb)};this.cTa=B;this.vs={}}get d5(){return this.tKh}get PPa(){return this.uKh}renderRuler(){this.d5.classList.remove("HideWACVerticalRulerContainer");this.d5.classList.add("ShowWACVerticalRulerContainer");var b=this.rkc();if(b){var h=this.egg;this.Jsd()||(this.vs.disabled=!0);this.vs.onMarginChange=h;this.K0a();b=ri.a.qj(b.qw,
1);this.PPa.style.height=(b*this.uQ).toString()+"px";this.cTa().then(n=>{n.renderRuler(this.PPa,this.vs);return null})}}Kfb(b){var h;if(this.d5){this.d5.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.vs&&delete this.vs.disabled;for(const n of b)switch(n){case 1:this.Jsd()?this.K0a():this.vs.disabled=!0}if(null===(h=this.uA.currentSelection)||void 0===h?0:h.u9c)this.vs.disabled=!0;this.cTa().then(n=>{n.renderRuler(this.PPa,this.vs);return null})}}static Q$c(){null==this.MEb&&null!=
A.AFrameworkApplication.K&&(this.MEb=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.isRulerPositionFixEnabled",!1));return this.MEb}Jsd(){const b={},h=this.rkc();if(!h)return!1;b.scale=Fg.a.oB(h.qw);b.precision=co.precision;b.rulerType="Vertical";this.vs.ipContextIndex=0;this.vs.permittedUnits=co.Pdi;b.margins=[{["type"]:"Top",["value"]:Fg.a.oB(h.marginTop),["getRulerPropertyBoundary"]:Cq.dlc("Top",0)},{["type"]:"Bottom",["value"]:Fg.a.oB(h.marginBottom),["getRulerPropertyBoundary"]:Cq.dlc("Bottom",
1)}];this.vs.rulerCanvasProps=b;return!0}HOh(){this.Hff();Nb.a.addHandler(this.d5,Cd.a.nz,this.Yne)}UOi(){this.d5&&(this.d5.classList.remove("ShowWACVerticalRulerContainer"),this.d5.classList.add("HideWACVerticalRulerContainer"),Nb.a.removeHandler(this.d5,Cd.a.nz,this.Yne));this.cTa().then(b=>{b.dispose(this.PPa);return null})}kv(){this.c9j();this.K0a();this.Kfb([1])}Ine(b,h){b=h.property;if(b===Lc.a.qw||b===Lc.a.marginTop||b===Lc.a.marginBottom)this.c9j(),this.K0a(),this.Kfb([1])}c9j(){var b=this.rkc();
b&&(b=ri.a.qj(b.qw,1),this.PPa.style.height=Math.round(b*this.uQ).toString()+"px")}K0a(){window.requestAnimationFrame(()=>{var b=this.GMf();if(b){const h=$c.a.getElementBounds(b);this.PPa.style.height=h.height.toString()+"px";b=this.JOm(b);this.PPa.style.marginTop=b+"px"}})}JOm(b){b=b.getBoundingClientRect().y;const h=this.cdf.getBoundingClientRect().y;return b-h}Hff(){if(!this.PPa&&!this.d5){this.tKh=document.createElement("div");this.d5.id=nq.wSk;this.d5.className=nq.vSk;this.d5.setAttribute(Bc.a.Jja,
WordEditorIntl.WordEditorStrings.L_Ruler);this.d5.setAttribute(Bc.a.Ph,Bc.a.PUh);this.d5.classList.add("HideWACVerticalRulerContainer");if(this.K_i){var b=A.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");const h=A.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");fc.a.Bfa(b,!h)&&Sys.UI.DomElement.addCssClass(this.d5,nq.ZEk)}this.uKh=document.createElement("div");this.PPa.className=nq.uSk;this.PPa.id=nq.xSk;this.d5.appendChild(this.PPa);b=document.getElementById(Mk.a.DBc);
b.insertBefore(this.d5,b.firstChild)}}static LG(){return new nq(Ya.a.instance.Qa("Common.IZoomManager"),$e.App.jf,A.AFrameworkApplication.va,Wk.UISurfaces.JGi,Ya.a.instance.resolve("WordEditor.IRulerContextMenu"),dt.a.instance,Ya.a.instance.resolve("WordEditor.IMainViewModeManager"),nq.Q$c()?new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.sc):null)}static get instance(){return null!=nq.o_g?nq.o_g:nq.o_g=nq.LG()}}nq.MEb=null;nq.wSk="WACVerticalRulerContainer";nq.vSk="WACVerticalRulerContainer";nq.xSk=
"WACVerticalRuler";nq.uSk="WACVerticalRuler";nq.ZEk="ModernUxWACVerticalRulerContainer";Object(u.a)(nq,"VerticalRuler",as,[]);class Yl{constructor(b,h,n,B,L,ba,la,La,fb){this.aVe=this.EXe=!1;this.YR="RulerActor";this.sDh=null;this.nga=!1;this.xqk="ClearAllTabStopsFailed";this.AFh="ShowHideRulerFailed";this.pZe=null;this.WVd=(Cb,Lb,$b)=>{if(1===$b)return 32;Cb=this.ga.Ob(Dc.a.nZb,2,null);32===Cb?($b=1,Lb=String.format("Clear all tab stops from ruler"),x.ULS.sendTraceTag(591213266,3014,50,Lb)):($b=
0,Lb=String.format("Unable to clear all tab stop from ruler"),x.ULS.sendTraceTag(591213267,3014,15,Lb),Yl.recordQosError(this.xqk,[Yl.hja],Lb));const tc=new Map;tc.set("Command","ClearAllTabStops");tc.set("Source",this.YR);tc.set("Response",Lb);oa.Health.instance.recordKpiUsage(co.kpiName,$b,co.Saa,tc);return Cb};this.Z7c=(Cb,Lb,$b)=>{if(1===$b)switch(Cb){case Dc.a.Ekf:case Dc.a.jwf:return 2;default:return 32}Lb=this.F7e.THm();switch(Cb){case Dc.a.b4f:var tc=1;break;case Dc.a.mwg:tc=4;break;case Dc.a.oof:tc=
3;break;default:return x.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}Cb=new Qx.a(Lb,tc,0,1);Cb=this.ga.Pb(Dc.a.Pnd,2,Cb);32===Cb?($b=1,Lb=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",Kn[tc],Lb.toString()),x.ULS.sendTraceTag(591213269,3014,50,Lb)):($b=0,Lb=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",Kn[tc],Lb.toString()),x.ULS.sendTraceTag(591213270,3014,15,Lb));tc=new Map;tc.set("Command","InsertCustomTabStopRuler");
tc.set("Source",this.YR);tc.set("Response",Lb);oa.Health.instance.recordKpiUsage(co.kpiName,$b,co.Saa,tc);return Cb};this.M0b=(Cb,Lb,$b,tc,Nc)=>{var dd;if(this.EXe||1===$b&&Ve.a.Sla(Lb.Hk))return 8;(null===(dd=A.AFrameworkApplication.K)||void 0===dd?0:dd.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",!1))&&Lb.contextId!=oc.a.view&&(x.ULS.sendTraceTag(508359384,3014,15,String.format("context id: {0}",Lb.contextId)),Lb=new bB.a(Ua.StaticActiveAppFrame.za().ib.sc));return this.nga?this.s6c(Cb,
Lb,$b,tc,Nc):this.S7o(Lb,$b)};this.tJo=()=>{this.nga?x.ULS.sendTraceTag(574128526,3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.Ob(wb.a.M0b,2)?(x.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),Yl.recordQosError(this.AFh,[Yl.hja],"Ruler could not be enabled")):x.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.s6c=(Cb,Lb,$b)=>{if(1===$b||!this.nga)return 32;this.nga=!1;this.G7e.pJj(!1);
this.Mib.dispose();this.ahe()&&this.Gyf();this.f9j();x.ULS.sendTraceTag(593351623,3014,50,"Ruler is disabled");Cb=new Map;Cb.set("Command","HideRuler");Cb.set("Source",this.YR);Cb.set("Response","");oa.Health.instance.recordKpiUsage(co.kpiName,1,co.Saa,Cb);return 32};this.Fse=(Cb,Lb,$b,tc,Nc)=>{if(1===$b)return 32;Nc&&(Nc[$g.a.On]=this.nga);return 32};this.C5m=Cb=>{this.nga=Cb.result};this.qRb=()=>{this.EXe=!1};this.HOi=()=>{this.EXe=!0};this.ga=b;this.Mib=h;this.Pcf=n;this.b4b=B;this.F7e=L;this.G7e=
ba;Yl.ll=La;this.FRa=la;this.EH=fb;this.FRa.nQh(this.HOi);this.FRa.NRd(this.qRb)}initialize(){this.Wb();this.sDh=this.tJo;window.addEventListener("TurnRulerOnAction",this.sDh,!0);return this.G7e.fJm().continueWith(this.C5m,8)}Wb(){this.ga.ra(wb.a.M0b,oc.a.view,this.M0b);this.ga.fb(wb.a.Fse,oc.a.view,this.Fse,96);this.ga.ra(Dc.a.Ekf,oc.a.view,this.Z7c);this.ga.ra(Dc.a.oof,oc.a.view,this.Z7c);this.ga.ra(Dc.a.WVd,oc.a.view,this.WVd);this.ga.ra(Dc.a.jwf,oc.a.view,this.Z7c);this.ga.ra(Dc.a.s6c,oc.a.view,
this.s6c);this.ga.ra(Dc.a.b4f,oc.a.view,this.Z7c);this.ga.ra(Dc.a.mwg,oc.a.view,this.Z7c);iy.a.ed.addHandler(iy.a.Ane,this.fgd.bind(this));this.EH.fKb(this.etc)}oSi(){this.nga&&(this.Mib.LE(),this.Mib.renderRuler(),this.ahe()&&this.HEj())}HEj(){this.Pcf.LE();this.Pcf.renderRuler()}Gyf(){this.Pcf.dispose()}ahe(){return this.t4i()&&this.isPaginatedView()}t4i(){null==this.pZe&&null!=A.AFrameworkApplication.K&&(this.pZe=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",
!1));return this.pZe}znp(){A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",!1)&&this.nga&&Ya.a.instance.Qa("Common.ISystemInitiatedFeedback").execute(b=>{b.logActivity("LocateRulerActivity",null)})}yAc(){this.nga||Ya.a.instance.Qa("Common.ISystemInitiatedFeedback").execute(b=>{b.logActivity("TurnRulerOnActivity",null)})}m_(){this.FRa.VAo(this.HOi);this.FRa.RDj(this.qRb);this.nga&&(this.Mib.dispose(),this.ahe()&&this.Gyf())}f9j(){if(this.b4b){const b={};b[co.pCp]=
"ToggleButtonModel";this.b4b.hJ(b)}}S7o(b,h){if(!Yl.ll.jba(b.Hk))return x.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),Yl.recordQosError(this.AFh,[Yl.hja],"Cannot show ruler. Word Section Node not found."),8;if(1===h)return 32;this.nga=!0;this.G7e.pJj(!0);this.oSi();this.f9j();x.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;b.set("Command","ShowRuler");b.set("Source",this.YR);b.set("Response","");oa.Health.instance.recordKpiUsage(co.kpiName,
1,co.Saa,b);return 32}isPaginatedView(){return 1===this.EH.Ax||2===this.EH.Ax}fgd(b,h){switch(h.documentMode){case "View":this.nga&&(this.ga.Ob(wb.a.M0b,2),this.aVe=!0);break;case "Edit":this.aVe&&(this.ga.Ob(wb.a.M0b,2),this.aVe=!1)}}etc(b,h){if(Yl.instance.nga&&Yl.instance.t4i())switch(h.Nbb){case 2:case 1:Yl.instance.HEj();break;case 0:Yl.instance.Gyf()}}static recordQosError(b,h,n){const B=Object.assign(new rb.a,{extendedProperties:new Map});n&&B.extendedProperties.set("exception",n);oa.Health.instance.recordQosError(b,
h,!1,!0,!1,!1,B)}static LG(){return new Yl(A.AFrameworkApplication.va,zp.instance,nq.instance,Ua.StaticActiveAppFrame.za(),Ya.a.instance.resolve("WordEditor.IRulerContextMenu"),Ya.a.instance.Oa("WordEditor.Ruler.IRulerSettingInfo"),Ya.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Po.a.instance,Ya.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=Yl.oZg?Yl.oZg:Yl.oZg=Yl.LG()}}Yl.ll=null;Yl.hja="RulerInteractionFailed";Object(u.a)(Yl,
"RulerActor",null,[]);class rv{constructor(b,h){this.ZOc=null;this.LWb=n=>n.result?n.result.Value.toString():"";this.dcb=n=>{if(n.qp||n.ij)x.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.ZOc=!1;else{n=n.result;const B=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",!1);"true"===n.toLowerCase()&&B&&x.ULS.sendTraceTag(508703490,3014,50,"Roaming setting is set to true by default");""===n&&A.AFrameworkApplication.K&&
(!B||appChrome.api.isSmallDevice()||appChrome.api.isVerySmallDevice()?n=A.AFrameworkApplication.K.kb("RulerDefaultOn"):(n="true",x.ULS.sendTraceTag(508703489,3014,50,"Enabling Ruler by default for undefined roaming setting for large screens")));this.ZOc="true"===n.toLowerCase();x.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully.")}return this.ZOc};this.ey=b;this.sT=h}fJm(){const b=new Zf.a;if(null==this.ZOc){if(this.X1i())return this.sT.axb(qu.a.Imd).CWRCo(this.LWb,
0).CWRCo(this.dcb,8);b.gg(!1)}else b.gg(this.ZOc);return b.task}Yha(b){this.sT.Yha(qu.a.Imd,new Cr.a(qu.a.Imd,b))}pJj(b){this.X1i()&&(this.ey.Lva("saveRulerIsEnabled",b.toString()),x.ULS.sendTraceTag(591541276,3014,50,"Try to save ruler settings value to Roaming Service."));this.Yha(b)}X1i(){const b=A.AFrameworkApplication.K.$("IsAnonymousUser");if(A.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)x.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(u.a)(rv,
"RulerSettingInfo",null,[247]);class lD{constructor(){this.cnh=this.W=null}get name(){return"WordEditor.Ruler"}wc(b){this.W=b;x.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ia("WordEditor.Ruler.RulerSettingInfo",()=>new rv(this.W.resolve("Box4.IRoamingServiceRequestManager"),this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").ha();this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo()});this.cnh=
Yl.instance.initialize();x.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}Mo(){this.cnh.continueWith(()=>{Yl.instance.oSi();Yl.instance.yAc();Yl.instance.znp()});x.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){Yl.instance.m_();x.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(u.a)(lD,"PackageManager",null,[0,1]);class vs{constructor(){this.Omc=this.adc=null}}Object(u.a)(vs,"CreatePickerCustomizationDictionaryOptions",
null,[1485]);class $w{}$w.kh="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(u.a)($w,"InsertMediaM365DialogHtml",null,[]);class Ps{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd,Hd,xe){this.fN=xe;this.thb=null;this.YYf=this.FFd=!1;this.RUj=je=>{if(je.rawEvent&&(je=je.rawEvent.data))try{const he=Sys.Serialization.JavaScriptSerializer.deserialize(je,
!0),fe=he.MessageId?he.MessageId.toString():null;he&&fe&&(fe===H.a.cnc||fe===H.a.VVf)&&this.RMc.start(fe===H.a.cnc?this.ajb:this.onh)}catch(he){}};this.Kvp=(je,he,fe,De,gg)=>{if(1===fe)return 32;this.cqh?je=CommonUIStrings.l_OneDriveName:""!==this.fDd?je=this.fDd:(je=CommonUIStrings.l_HostGeneric,x.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));gg[Dl.a.LabelText]=je;return 32};this.Nvp=(je,he,fe,De,gg)=>{if(1===fe)return 32;
if(!A.AFrameworkApplication.JZf())return gg[Dl.a.Visible]=!1,32;this.cqh?je=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.fDd?je=String.format(CommonUIStrings.l_ChangePictureFromHost,this.fDd):(je=CommonUIStrings.l_ChangePictureFromHostGeneric,x.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));gg[Dl.a.LabelText]=je;return 32};this.Lvp=(je,he,fe,De,
gg)=>{if(1===fe)return 32;A.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(gg[Dl.a.Visible]=!1);return 32};this.Mvp=(je,he,fe,De,gg)=>{if(1===fe)return 32;A.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||(gg[Dl.a.Visible]=!1);return 32};this.Vze=(je,he,fe)=>{he=this.bJc.value.Vja(he);if(1===fe)return he&&this.$ib.$kn?32:8;if(2!==fe||!he)return 8;this.thb=yb.a.create();x.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");
je=this.Cwm(je,this.thb);je=this.Nef(je);je=this.XDd.F3c(je);je.correlationId=this.thb;je.lWf=this.pnh;je.wua=1;return this.Tze(je,CommonUIStrings.L_PictureInsertTitle,this.ajb)};this.V6o=(je,he,fe)=>{je=32===this.ga.lg(he,wb.a.QR,1,!1,null,null);if(1===fe)return je&&this.$ib.DZi?32:8;if(2!==fe||!je)return 8;x.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.Tze(this.nnh.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,
this.onh)};this.DUj=(je,he,fe)=>{je=this.bJc.value.Vja(he);if(1===fe)return je&&this.$ib.IZf?32:8;if(2!==fe||!je)return 8;x.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.Tze(this.nnh.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.ajb)};this.Rze=(je,he,fe)=>{he=this.bJc.value.Vja(he);if(1===fe)return he&&this.$ib.bln?32:8;if(2!==fe||!he)return 8;x.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");
this.thb=yb.a.create();fe=A.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.GK.isFreemiumUpsellEnabled();fe=this.FFd?1:fe?0:-1;je=this.nzm(je,this.thb,fe);je=this.XDd.F3c(je);je.kh=$w.kh;je.correlationId=this.thb;je.wua=2;je.lWf=this.pnh;je.Dea=this.GK;je.userLicenseType=fe;return this.Tze(je,CommonUIStrings.L_PictureInsertTitle,this.ajb)};this.Wze=(je,he,fe)=>{he=this.bJc.value.Vja(he);je=Ya.a.instance.Oa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===fe)return he&&
!this.$ib.IZf&&je&&je.T0f()&&!A.AFrameworkApplication.Cge?32:8;if(2!==fe||!he||!je)return 8;x.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");this.thb=yb.a.create();fe=Ps.pKh;he=!1;A.AFrameworkApplication.KZf()&&(he=this.Vfm());const De=new vs;De.adc=he;De.Omc=!0;fe=je.Gtf(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,fe,"Insert Media",1,De);je.P6d(fe).then(gg=>{if(null!=gg&&0<gg.length){const eg=[];for(let vl=0;vl<gg.length;vl++){const wl=
gg[vl][I.a.otj],Sm=gg[vl][I.a.ntj],qp={};qp.Extension=wl;qp.OriginalUrl=Sm;qp.caption=wl;eg.push(qp)}this.ajb.$Wa=wb.a.G2;this.ajb.E$a(eg)}});return 32};this.Uze=(je,he,fe)=>{var De=this.bJc.value.Vja(he);he=Ya.a.instance.Oa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===fe)return De&&he&&he.T0f()?32:8;if(2!==fe||!De||!he)return 8;fe=Ya.a.instance.Oa("Common.App.PhoneLink.IPhoneLinkManager");null!=fe&&fe.G6l(A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",
!1));x.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");this.thb=yb.a.create();fe=Ps.pKh;De=new vs;De.adc=!0;De.Omc=!0;fe=he.Gtf(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,!0,!1,!0,fe,"InsertPictureFromMobile",3,De);he.P6d(fe).then(gg=>{if(null!=gg&&0<gg.length){var eg=[];const vl=je===wb.a.pce;let wl=!1;const Sm=A.AFrameworkApplication.K.kb("PhoneLinkServiceEndpoint");for(let qp=0;qp<gg.length;qp++){const my=
gg[qp][I.a.otj],gx=gg[qp][I.a.ntj],ow={};ow.Extension=my;ow.OriginalUrl=gx;ow.caption=my;eg.push(ow);wl||(wl=-1!==ow.OriginalUrl.indexOf(Sm))}this.ajb.$Wa=wb.a.G2;this.ajb.E$a(eg);eg={};eg.InsertImageCount=gg.length;wl&&Pe.c(vl?wb.a.t$m:wb.a.snl,void 0,void 0,void 0,void 0,void 0,eg)}});return 32};this.RMc=B;this.DId=L;this.XDd=la;this.nnh=La;this.T1=fb;this.ga=b;this.bJc=ba;this.cqh=tc;this.fDd=dd;this.$ib=n;this.ajb=Cb;this.onh=Lb;this.pnh=Hd;(this.GK=$b)&&this.GK.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(je=>x.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",je)).then(je=>{(this.FFd=je)||this.GK.hva("MsoPremiumStockImages",()=>{this.FFd=!0;x.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Wb(){(this.$ib.IZf||this.$ib.DZi)&&this.$ib.aln&&this.Eeo();this.uuo();this.tuo();this.ga.fb(wb.a.g1h,oc.a.view,this.DUj,1284);this.ga.fb(wb.a.Wwj,
oc.a.view,this.Nvp,1124);this.ga.fb(wb.a.fWf,oc.a.view,this.DUj,1284);this.ga.fb(wb.a.Mog,oc.a.view,this.Kvp,1124);this.ga.fb(wb.a.C$m,oc.a.view,this.V6o,1284)}uuo(){this.ga.fb(wb.a.insertOnlinePicture,oc.a.view,this.Vze,1284);this.ga.fb(wb.a.mce,oc.a.view,this.Rze,1284);this.ga.mna("word_insertOnlinePictures",wb.a.insertOnlinePicture,oc.a.view,this.Vze,b=>{Ua.StaticActiveAppFrame.za().cBc(b,Object(z.a)(new dp.a,(new dp.a).qPb,"getCommandById"))});this.ga.mna("word_insertOnlinePictures",wb.a.mce,
oc.a.view,this.Rze,b=>{Ua.StaticActiveAppFrame.za().cBc(b,Object(z.a)(new dp.a,(new dp.a).qPb,"getCommandById"))});this.ga.fb(wb.a.vof,oc.a.view,this.Vze,1284);this.ga.fb(wb.a.xof,oc.a.view,this.Wze,1284);this.ga.mna("word_insertOnlinePictures",wb.a.xof,oc.a.view,this.Wze);this.ga.fb(wb.a.yof,oc.a.view,this.Rze,1284);this.ga.fb(wb.a.Uwj,oc.a.view,this.Lvp,1284);this.ga.fb(wb.a.Vwj,oc.a.view,this.Mvp,1284);this.ga.mna("word_insertOnlinePictures",wb.a.vof,oc.a.view,this.Vze);this.ga.mna("word_insertOnlinePictures",
wb.a.yof,oc.a.view,this.Rze);this.ga.fb(wb.a.hWf,oc.a.view,this.Wze,1284);this.ga.mna("word_insertOnlinePictures",wb.a.hWf,oc.a.view,this.Wze,b=>{Ua.StaticActiveAppFrame.za().cBc(b,Object(z.a)(new dp.a,(new dp.a).qPb,"getCommandById"))})}tuo(){A.AFrameworkApplication.KZf()&&(this.ga.fb(wb.a.pce,oc.a.view,this.Uze,1284),this.ga.fb(wb.a.wof,oc.a.view,this.Uze,1284),this.ga.mna("mso_insertMobileDevicePictures",wb.a.pce,oc.a.view,this.Uze,b=>{Ua.StaticActiveAppFrame.za().cBc(b,Object(z.a)(new dp.a,(new dp.a).qPb,
"getCommandById"))}),this.ga.mna("mso_insertMobileDevicePictures",wb.a.wof,oc.a.view,this.Uze,b=>{Ua.StaticActiveAppFrame.za().cBc(b,Object(z.a)(new dp.a,(new dp.a).qPb,"getCommandById"))}))}Eeo(){A.AFrameworkApplication.ua.get_element().appendChild(this.DId.u8a);Nb.a.addHandler(this.DId.u8a.contentWindow,"message",this.RUj);this.YYf=!0}Cwm(b,h){let n=0;A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib&&5===A.AFrameworkApplication.ua.Ib.Tk&&(n=12);const B=hj.a.Cg(A.AFrameworkApplication.lcid);
return String.format(A.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,b===wb.a.insertOnlinePicture?1:0,A.AFrameworkApplication.lcid,B?B.name:"en-us",A.AFrameworkApplication.buildVersion,h,n,A.AFrameworkApplication.K.kb("UserId"))}Tze(b,h,n){try{return b.Sze(h,n,void 0),x.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(B){return x.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",
B.toString()),this.qq(yd.a.oed,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}nzm(b,h,n){if(wb.a.mce===b)return b=this.T1.bYh(A.AFrameworkApplication.K.kb("InsertOnlineM365PictureEndpoint"),h.toString(),1,n),this.Nef(b);b=this.T1.bYh(A.AFrameworkApplication.K.kb("InsertOnlineM365PictureEndpoint"),h.toString(),0,n);return this.Nef(b)}qq(b,h,n){const B=new ui.StandardDialog(!0);B.Du=A.AFrameworkApplication.gga;B.Gd=0;B.Pe(1,CommonUIStrings.l_DialogClose);B.Gy(b,
h,n,()=>{})}Vfm(){const b=Ya.a.instance.Oa("Common.App.PhoneLink.IPhoneLinkManager");return null!=b?b.jkm():!1}dispose(){this.YYf&&this.DId.u8a.contentWindow&&(Nb.a.removeHandler(this.DId.u8a.contentWindow,"message",this.RUj),this.YYf=!1)}Nef(b){return this.fN&&this.fN.fP?(b=new ub.QueryStringBuilder(b),b.ze("theme","4"),b.toString()):b}}Ps.pKh=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(u.a)(Ps,"InsertMediaActor",null,[13]);var zt=d(1051);class KB extends zt.a{constructor(b,h){super(b,
za.a.getOrigin(h))}$q(b,h){this.isEnabled()&&this.zea(this.$eb)&&(this.Aw(b),this.BD(b,h))}}Object(u.a)(KB,"InsertMediaCrossDocumentMessenger",zt.a,[412,50,13]);class Vp{getInstance(b,h){return new KB(b,h)}}Object(u.a)(Vp,"InsertMediaCrossDocumentMessengerFactory",null,[375]);var LB=d(836);class lA{}lA.kh="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(u.a)(lA,"InsertMediaDialogHtml",null,[]);var Qs;(function(b){b[b.OK=0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(Qs||(Qs={}));Object(u.b)("HubbleAction",Qs);var Uu;(function(b){b[b.unknown=0]="unknown";b[b.XTp=1]="bing";b[b.dOp=2]="M365";b[b.I3p=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.Zae=5]="hubble"})(Uu||(Uu={}));Object(u.b)("InsertMediaProviders",Uu);class fg extends Ge.a{constructor(b,h,n,B=null,L=!1){super(!1,!1,L);this.Jz=null;this.qHc=!1;this.Jcd=this.S3=
null;this.bnf="KeepFocusDiv";this.yUd="KeepFocusStartDiv";this.correlationId=null;this.wua=0;this.Dea=this.lWf=null;this.userLicenseType=0;this.X_e=null;this.hZn=()=>{this.S3&&(this.S3.style.visibility="visible",window.setTimeout(()=>{if(this.Mj){const ba=this.Mj.getElementById(this.yUd);ba&&ba.focus()}},0))};this.sga=ba=>{ba.keyCode===Sys.UI.Key.tab&&(ba.target.id!==this.bnf||ba.shiftKey?ba.target.id===this.yUd&&ba.shiftKey&&(ba.preventDefault(),this.Mj.getElementById(this.bnf).focus()):(ba.preventDefault(),
this.Mj.getElementById(this.yUd).focus()))};this.Rjj=()=>{x.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.hOb(this.x6a);this.$xb(1)};this.sfg=()=>{this.Jz&&(x.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.Jz.sendMessage(H.a.vNj,{["CustomHeaders"]:""}))};this.ilj=()=>{this.Jz&&(x.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.Jz.sendMessage(H.a.lYo,{["SessionId"]:A.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};
this.flj=()=>{this.Jz&&(x.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.Jz.sendMessage(H.a.mRo,{["CID"]:""}))};this.DZn=()=>{this.Dea&&(x.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.Dea.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.YDd=b;this.j6b="";this.T1=n;this.rya=[];this.OJd=h;this.kh=B||lA.kh;this.Qg="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}async Sze(b,
h){this.j6b=b;this.qHc=!1;this.showDialog(this.j6b,null);this.S3=this.Wjc(this.Sj("insertmediaframe"));if(!this.S3)throw this.hOb(this.x6a),Error.invalidOperation("Couldn't get InsertMediaIframe.");b=document.createElement("div");b.setAttribute("Id",this.yUd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.S3.parentNode.insertBefore(b,this.S3.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",
this.bnf);b.setAttribute("tabindex","0");this.S3.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.yxf,"keydown",this.sga);this.S3.src=this.YDd;this.S3.style.width="100%";this.S3.style.height="100%";this.S3.frameBorder="0";A.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&X.a.uj?(this.S3.style.visibility="hidden",this.Jcd=this.hZn,Nb.a.addHandler(this.S3,"load",this.Jcd)):this.S3.style.visibility=
"visible";this.Wjc(this.Sj("WACDialogButtonPanel")).style.display="none";this.Wjc(this.Sj("WACDialogTitleText")).style.display="none";2===this.wua&&(this.Wjc(this.Sj("WACDialogTitlePanel")).style.display="none",this.Wjc(this.Sj("WACDialogBodyPanel")).style.padding="0");Ph.FocusManager.instance().gu().scope.iK=!0;this.Jz=this.OJd.getInstance(this.S3.contentWindow,this.YDd);this.Jz.zea("https://osiziwuspersimmon002.blob.core.windows.net");this.Jz.zea("https://osizewuspersimmon001.blob.core.windows.net");
this.Jz.zea("https://osizpscuspersimmon000.blob.core.windows.net");this.Jz.zea("https://cdn.hubblecontent.msit.osi.office.net");this.Jz.zea("https://cdn.hubblecontent.osi.office.net");this.Jz.$q(H.a.NNh,n=>{this.fjj(n,Object(z.a)(h,h.E$a,"insertMediaCallback"))});this.Jz.$q(H.a.insert,n=>{this.nne(n,Object(z.a)(h,h.E$a,"insertMediaCallback"))});this.Jz.$q(H.a.kOh,n=>{this.tmj(n)});this.Jz.$q(H.a.$wi,this.sfg);this.Jz.$q(H.a.getSessionId,this.ilj);this.Jz.$q(H.a.Iui,this.flj);this.Jz.$q(H.a.UUd,this.Rjj);
2!==this.wua||this.userLicenseType||(this.Jz.$q(H.a.xxn,this.DZn),this.X_e=this.Dea.hva("MsoPremiumStockImages",n=>{x.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.Jz.sendMessage(H.a.VAp,{["LicenseTier"]:n.toString()})}));this.$xb(3)}dispose(){this.Dea&&this.X_e&&this.Dea.rZb("MsoPremiumStockImages",this.X_e);this.Jz&&(this.Jz.dispose(),this.Jz=null);this.Jcd&&(Nb.a.removeHandler(this.S3,"load",this.Jcd),this.Jcd=null);super.dispose()}fjj(b,h){x.ULS.sendTraceTag(7135752,
352,100,"OnAddItem : Got message.");if(b=this.T1.L9n(b))this.rya.push(b),this.qHc&&(h(this.rya),this.qHc=!1)}qq(){const b=new ui.StandardDialog(!0);b.Du=A.AFrameworkApplication.gga;b.Gd=0;b.Pe(1,CommonUIStrings.l_DialogOk);b.Ix(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}$xb(b){if(2===this.wua){const n=A.AFrameworkApplication.K.kb("InsertMediaDialogAriaTenantNameSpace");if(n&&""!==n){var h=[];h.push(Object.assign(new ia.a,{name:"InsertedFiles",
int64:this.rya.length}));h.push(Object.assign(new ia.a,{name:"MediaDetails",string:JSON.stringify(this.rya)}));h.push(Object.assign(new ia.a,{name:"DialogResult",string:Qs[b]}));h.push(Object.assign(new ia.a,{name:"DialogMode",string:this.nCi()}));h.push(Object.assign(new ia.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ia.a,{name:"Provider",string:Uu[this.wua]||"Unknown"}));aa.a.sendTelemetryEvent(Object.assign(new wa.a,{name:String.format("{0}.{1}",n,this.telemetryEventName),
dataFields:h}))}}}nCi(){return 3===this.wua?"Icons":5===this.wua?"ExternalContent":"Images"}Wjc(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",b));return h}nne(b,h){x.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.hOb(this.x6a);h?this.rya&&50<this.rya.length?(this.qq(),this.$xb(0),x.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.rya.length,Uu[this.wua])):this.rya&&0<
this.rya.length?(h(this.rya),this.$xb(0),x.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.rya.length,Uu[this.wua])):(x.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.qHc=!0,h(this.rya),this.$xb(2)):this.$xb(2)}tmj(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,x.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),aa.a.sendOtelEvent(Object.assign(new LB.a,{otelEvent:b})))}}
Object(u.a)(fg,"InsertMediaDialog",Ge.a,[372,13]);class MB{constructor(b,h){this.xWe=b;this.T1=h}F3c(b,h=!1){return new fg(b,this.xWe,this.T1,lA.kh,h)}getInstance(){throw Error.notImplemented();}}Object(u.a)(MB,"InsertMediaDialogFactory",null,[374]);class jy{constructor(b,h,n){this.kWi=!1;this.correlationId=null;this.wua=0;this.lWf=null;this.Cyk=b;this.sRc=[];this.gDd=h;this.bHh=n.split(";")}async Sze(b,h){Array.clear(this.sRc);b=this.Cyk.value;b.zea(this.gDd);b.Aw(h.C6c);this.kWi||(b.BD(h.C6c,n=>
{this.nne(n,h)}),this.kWi=!0);x.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.Ybi,{["FileExtensionFilterList"]:this.bHh})}j_k(b){Array.contains(this.sRc,b)||this.sRc.push(b)}nne(b,h){x.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.Zrj(b);const n=[];for(let B=0;B<b.length;B++){const L=b[B];h.jee(L,this.bHh)?n.push(L):this.j_k(h.jGi(L))}n&&n.length?h.E$a(n):x.ULS.sendTraceTag(20509843,
352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.sRc.length&&(h=this.sRc.join(", "),x.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),this.z8o(h))}z8o(b){const h=new ui.StandardDialog;h.Gd=0;h.yY(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null)}dispose(){}}Object(u.a)(jy,"InsertMediaFromHostManager",null,[372,13]);class mD{constructor(b){this.Izk=
b}F3c(){throw Error.notImplemented();}getInstance(){return this.Izk}}Object(u.a)(mD,"InsertMediaFromHostManagerFactory",null,[373,374]);class NB{constructor(){this.u8a=document.createElement("iframe");this.u8a.src="about:blank";this.u8a.style.visibility="hidden";this.u8a.style.position="absolute";this.u8a.style.zIndex="-100"}}Object(u.a)(NB,"InsertMediaFromHostOneDriveHostFrame",null,[371]);class ax extends zt.a{constructor(b,h){super(b,"*"===h?h:za.a.getOrigin(h));this.RMh(H.a.cnc);this.RMh(H.a.VVf)}bve(){}}
Object(u.a)(ax,"InsertMediaFromOneDriveCrossDocumentMessenger",zt.a,[369,50,13]);class hz{}Object(u.a)(hz,"OnlineMediaSearchResult",null,[]);class bx{bYh(b,h,n,B){const L=hj.a.Cg(A.AFrameworkApplication.lcid).name,ba=A.AFrameworkApplication.buildVersion,la=F.a.MT(A.AFrameworkApplication.K.kb("UserId")).toString();if(-1!==b.indexOf("exp=")){const La=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",!1)?1:0;A.AFrameworkApplication.Ld("ShIns226;ShIns226cf");
return String.format(b,A.AFrameworkApplication.lcid,L,ba,h,bx.rJe,la,B,n,La)}return String.format(b,A.AFrameworkApplication.lcid,L,ba,h,bx.rJe,la,B,n)}L9n(b){if(!b||!b.Values)return null;b=b.Values;if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new hz,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||
"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||"",ProviderName:b.providerName||""})}M9n(b){const h=[];if(!b||!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let B=0;B<b.length;B++){var n=b[B];n&&(n=Object.assign(new hz,{Type:n.Extension||"",OriginalUrl:n.SourceUrl||"",Caption:n.caption,Height:n.Height||0,Width:n.Width||0}),h.push(n))}return h}Yjg(b){const h=[];for(let B=0;B<b.data.files.length;B++){var n=b.data.files[B];
n&&(n=Object.assign(new hz,{ContentType:n.itemType||"",Type:n.extension||"",OriginalUrl:n.urls&&n.urls.open?n.urls.open:"",Height:n.photo?n.photo.height:0,Width:n.photo?n.photo.width:0}),h.push(n))}return h}jee(b,h){if(!b)return!1;for(let n=0;n<h.length;n++)if(0<=b.toLowerCase().indexOf(h[n]))return!0;return!1}zeo(b){let h="";if(b)for(let n=0;n<b.length;n++){const B=b[n];B&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',B.OriginalUrl,B.Width,B.Height))}return h}}bx.rJe=0;Object(u.a)(bx,
"InsertMediaHelper",null,[367]);class ni{constructor(b,h,n,B,L){this.$kn=b;this.IZf=h;this.DZi=n;this.aln=B;this.bln=L}}Object(u.a)(ni,"InsertMediaSettingsManager",null,[]);class mA{constructor(b){this.nJc=wb.a.QR;this.ga=b}get $Wa(){return this.nJc}set $Wa(b){this.nJc=b}E$a(b){try{x.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Pb(this.$Wa,2,b[h]);x.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",
b.length)}catch(h){x.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",h.toString())}}}Object(u.a)(mA,"InsertOneDriveFileHandler",null,[365]);class nD extends mA{constructor(b){super(b)}get Ybi(){return H.a.VVf}get C6c(){return H.a.S9m}Zrj(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}jGi(){Vc.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}jee(){return!0}hwj(b,
h,n){b=n(b);b.length&&(n={},n.Items=b,h.sendMessage(this.C6c,n))}asj(b){const h=[];for(let n=0;n<b.data.files.length;n++){const B=b.data.files[n];if(B){const L={};L.DisplayText=String.format("{0}{1}",B.name,B.extension);L.Url=this.N$l([B.urls.viewInBrowser,B.urls.open,B.urls.download]);h.push(L)}}return h}N$l(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];x.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(u.a)(nD,"InsertOneDriveFileHelper",
mA,[364,365]);class Lj{constructor(b,h,n,B){this.Oo=B;this.nJc=wb.a.G2;this.Rp=null;this.p0n=()=>{Jc.a.oV&&this.Oo.fM([26],this.Fe)};this.ga=b;this.T1=h;this.pja=n;Jc.a.oV&&(this.Fe=ch.a.getInstance(jc.a),rp.a.prg(this.p0n))}get Sb(){return this.ga}get Dw(){return this.Rp||(this.Rp=Ya.a.instance.resolve("Common.Utils.IAriaNotifier"))}get $Wa(){return this.nJc}set $Wa(b){this.nJc=b}E$a(b){try{Jc.a.oV&&this.Oo.jY([26]);x.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",
b.length);const h=this.T1.zeo(b);let n=2;if(h&&0<h.length){const B=new Og.DictionaryPropertySet;B.setValue(zd.a.mS,h);B.setValue(zd.a.L7,!0);if(this.pja){const L=this.pja.Fqd();L.qdc("insertOnlineImage");B.setValue(zd.a.Oza,L)}n=this.ga.Pb(this.$Wa,2,B)}x.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===n,""===h)}catch(h){x.ULS.$w(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}
Object(u.a)(Lj,"InsertOnlineImageHandler",null,[365]);class oD extends Lj{constructor(b,h,n,B=null){super(b,h,B,n)}get Ybi(){return H.a.cnc}get C6c(){return H.a.f$m}Zrj(b){return this.T1.M9n(b)}jGi(b){return b.Type}jee(b,h){return this.T1.jee(b.Type,h)}asj(b){return this.T1.Yjg(b)}hwj(b,h,n){n=n(b);if(n.length){b=[];for(let B=0;B<n.length;B++){const L=n[B],ba={};ba.Extension=L.Type;ba.SourceUrl=L.OriginalUrl;ba.caption=L.Type;ba.SourceUrl=L.OriginalUrl;ba.Width=L.Width;ba.Height=L.Height;b.push(ba)}n=
{};n.Items=b;h.sendMessage(this.C6c,n)}}}Object(u.a)(oD,"InsertOnlineImageHelper",Lj,[364,365]);class EF{constructor(b,h){this.wDb=b;this.OJd=h}start(b){this.wDb.start({mode:"open",select:"multi",lightbox:"white"},(h,n)=>{this.processResponse(h,n,b)})}processResponse(b,h,n){x.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.OJd.getInstance(window.frames[0].parent,
window.document.URL),n.hwj(h,b,B=>n.asj(B))):x.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(u.a)(EF,"OneDriveFilePickerHelperV5",null,[366]);class OB{constructor(){this.WDd=this.W=null}get name(){return"Box4.Media"}wc(b){this.W=b;b.ia("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new NB).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ha();const h=new ni(Boolean.parse(A.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||
"false"),A.AFrameworkApplication.JZf(),!1,A.AFrameworkApplication.aDg(),A.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));b.ia("Box4.Media.OneDriveFilePickerHelperV5",()=>new EF(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").ha();b.ia("Box4.Media.InsertMediaActor",()=>new Ps(A.AFrameworkApplication.va,A.AFrameworkApplication.K,h,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),
b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new Rf.a(()=>Ya.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),A.AFrameworkApplication.Htb,A.AFrameworkApplication.iua,
A.AFrameworkApplication.n1m,A.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).ha();b.ia("Box4.Media.InsertMediaDialogFactory",()=>new MB(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").ha();b.ia("Box4.Media.InsertMediaFromHostManagerFactory",()=>new mD(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").ha();
b.ia("Box4.Media.InsertMediaFromHostManager",()=>new jy(new Rf.a(()=>{if(A.AFrameworkApplication.aDg()){var n=Ya.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").u8a;n=new ax(n.contentWindow,"*")}else n=A.AFrameworkApplication.c0;return n}),A.AFrameworkApplication.aDg()?za.a.getOrigin(window.document.URL):za.a.getOrigin(A.AFrameworkApplication.RXb),A.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).ha();b.register(Vp,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ha();
b.register(bx,"Box4.Media.InsertMediaHelper").ha();b.ia("Box4.Media.InsertOnlineImageHelper",()=>new oD(A.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),new vc.b,b.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();b.ia("Box4.Media.InsertOneDriveFileHelper",()=>new nD(A.AFrameworkApplication.va)).ha()}init(){this.WDd=this.W.resolve("Box4.Media.InsertMediaActor");this.WDd.Wb()}dispose(){this.WDd&&this.WDd.dispose()}}Object(u.a)(OB,"MediaPackage",null,[0,1]);var xH=d(1071);class pD{get name(){return"Box4.PlaceholderText"}wc(b){this.W=
b;this.W.ia("Box4.PlaceholderText.PlaceholderTextProvider",()=>new xH.a(Ua.StaticActiveAppFrame.za().ib.sc,this.W.resolve("Box4.ObjectSpaceParagraphCollection"),this.W.resolve("Box4.ITextRenderingStrategy"),this.W.Qa("Common.Interface.IEditNotificationManager"),$e.App.jf.Il.Ve(12),this.W.rf("Box4.IParagraphReader"))).ha()}init(){this.W.resolve("Box4.PlaceholderText.PlaceholderTextProvider").init()}dispose(){}static main(){M.a.instance.Jc(new pD,4)}}Object(u.a)(pD,"PlaceholderTextPackage",null,[0,
1]);class PB{constructor(b,h,n,B){this.C9b=b;this.Zia=h;this.xBk=n;this.Rq=B;this.Emj=()=>{(A.AFrameworkApplication.iEj||this.Zal())&&this.PAc()}}init(){PB.$al&&this.xBk&&this.QI()}QI(){this.Zia.Zt(this.Emj)}PAc(){this.Zia.jV(this.Emj)}Zal(){if(!this.C9b)return!1;const b=this.Vrm();return b&&32===A.AFrameworkApplication.va.Pb(Pa.a.lva,2,b)&&this.Rq?(this.Rq.execute(h=>{h.logActivity("AutoRenameDocumentCallout",null);A.AFrameworkApplication.mc.Zb(new Re.a(5,1,12E4,()=>{h.logActivity("AutoRenameSentimentSurvey",
null)},0,"floodgateSurveyForAutoRenameSentiment"))}),Pe.a("AutoRenameDocumentSuccess"),!0):!1}Vrm(){let b,h=this.C9b.Q3d();for(;h;){const n=h.node;if(0<ea.ParagraphReader.textLength(n,9)&&(b=Cn.AParagraphNode.Wrm(n.characterData.trim()),0<b.length))break;h=h.next}return b}static get $al(){var b;null===this.wLe&&(this.wLe=null===(b=A.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocument",!1));return this.wLe}}PB.wLe=null;Object(u.a)(PB,
"AutoRenameExecutor",null,[]);class qD{Kmn(){const b=A.AFrameworkApplication.sessionStartInfoSettings.ApplicationModeExtended;return A.AFrameworkApplication.BI&&(!A.AFrameworkApplication.Cua||"blank"===A.AFrameworkApplication.Cua)&&0<=b.toLowerCase().indexOf("new")}get name(){return"Box4.AutoRename"}wc(b){this.W=b;this.W.ia("Box4.AutoRename.AutoRenameExecutor",()=>new PB(this.W.resolve("Box4.ObjectSpaceParagraphCollection"),$e.App.jf.Il.Ve(12),this.Kmn(),b.Qa("Common.ISystemInitiatedFeedback"))).ha()}init(){this.W.resolve("Box4.AutoRename.AutoRenameExecutor").init()}dispose(){}static main(){M.a.instance.Jc(new qD,
20)}}Object(u.a)(qD,"AutoRenamePackage",null,[0,1]);var Ut=d(372);class sv{constructor(){this.RIo="getAddinShortcutsPreference";this.SIo="saveAddinShortcutsPreference";this.TIo="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.zgm=6E4;this.vle=this.Tra=this.Rca=null}tGi(b){return String.format(this.TIo,A.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",b,A.AFrameworkApplication.jm)}executeRequest(b,h,n,B,L=null){return sv.RT.XJb(b,h,L,null,n,B,!1,null,this.zgm)}saveSetting(b,
h,n,B,L){return this.qJj(b,h,n,null,B,L)}startBatchUpdateScope(){this.vle=[]}saveShortcutInfoArrayBatch(b,h,n){this.TKo(n,b,h)}TKo(b,h,n){const B={action:"",addinId:"",ownerType:0};B.timestamp=(new Date).toUTCString();const L=this.getShortcutInfoArray(h.toString(),n.toString());b?(B.shortcutInfoArray=b,this.Mef(h,n,b)):L&&(B.shortcutInfoArray=L);b={};b[h.toString()]=B;h=new Ut.a(n.toString(),b);this.vle.push(h)}commitBatchUpdateScope(){return this.Fpd()?this.VKo().then(()=>{this.eec();return Promise.resolve(!0)}):
this.XKo().then(()=>{this.eec();return Promise.resolve(!0)})}VKo(){return this.getSetting().then(b=>{let h=null;if(b&&!({Zu:h}=D.d(b)).returnValue)return x.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const n of this.vle){(b=h[n.key])||(b={});const B=n.value;for(const L of Yb.a.FR(B))b[L]=B[L];h[n.key]=b}this.Rca=h;try{return localStorage.setItem("AddinShortcutPreferenceData",D.c(h)),Promise.resolve(!0)}catch(n){return x.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",n),Promise.resolve(!1)}})}XKo(){return this.RPo().then(b=>this.owe(b))}RPo(){return this.dOf().then(b=>{let h=null;b&&(({Zu:h}=D.d(b)).returnValue||x.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const n of this.vle){(b=h[n.key])||(b={});const B=n.value;for(const L of Yb.a.FR(B))b[L]=B[L];h[n.key]=b}this.Rca=h;return D.c(h)})}saveShortcutInfoArray(b,h,
n){return this.qJj(0,"","",n,b,h)}qJj(b,h,n,B,L,ba){const la=this.Fpd(),La={};La.action=n;La.addinId=h;La.ownerType=b;La.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(L.toString(),ba.toString());0===b&&B?(La.shortcutInfoArray=B,this.Mef(L,ba,B)):h&&(La.shortcutInfoArray=h);b={};b[L.toString()]=La;L=new Ut.a(ba.toString(),b);return la?this.UKo(L):this.WKo(L)}UKo(b){return this.getSetting().then(h=>{let n=null;if(h&&!({Zu:n}=D.d(h)).returnValue)return x.ULS.sendTraceTag(522739855,0,
10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);n||(n={});n[b.key]=b.value;this.Rca=n;try{return localStorage.setItem("AddinShortcutPreferenceData",D.c(n)),Promise.resolve(!0)}catch(B){return x.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",B),Promise.resolve(!1)}})}WKo(b){return this.QPo(b).then(h=>this.owe(h))}QPo(b){return this.dOf().then(h=>{let n=null;h&&(({Zu:n}=D.d(h)).returnValue||x.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
n||(n={});n[b.key]=b.value;this.Rca=n;return D.c(n)})}saveSettings(b){this.Rca=D.a(b);this.eec();return this.Fpd()?this.tJj(b):this.owe(b)}tJj(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return x.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}owe(b){const h={};h.Wac=b;const n=D.c(h);return new Promise(B=>{try{if(void 0===n||null===n||!n.length||1E6<=n.length)B(!1);else{var L=this.executeRequest(this.tGi(this.SIo),
2,"SaveAddinShortcutsPreferenceRequest","38",n);L.continueWith(()=>{if(L.qp||L.ij)x.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),B(!1);else{var ba=L.result;void 0!==ba.args&&null!==ba.args&&void 0!==ba.args.data&&null!==ba.args.data&&ba.args.data.He===ja.a.zz?B(!0):B(!1)}})}}catch(ba){x.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",ba.toString()),B(!1)}})}getSetting(){const b=this.Fpd();return this.Rca?Promise.resolve(D.c(this.Rca)):
b?this.EKm():this.dOf()}Fpd(){const b=A.AFrameworkApplication.K.$("IsAnonymousUser"),h=A.AFrameworkApplication.K.$("IsRoamingServiceEnabled");var n=A.AFrameworkApplication.K.kb("Puid");const B=A.AFrameworkApplication.K.kb("UserPrincipalName");n=!(void 0===n||null===n)&&!(void 0===B||null===B)&&0<n.length&&0<B.length;return b||!h||!n}EKm(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return x.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",
b),Promise.resolve("")}}dOf(){return new Promise((b,h)=>{try{const n=this.executeRequest(this.tGi(this.RIo),1,"GetSettingRequest","37");n.continueWith(()=>{if(n.qp||n.ij)x.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let L="";var B=n.result;B&&B.args&&B.args.data?B.args.data.He!==ja.a.zz?x.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",B.args.data.He):B.args.data.De?(B=D.a(B.args.data.De),B.Wac&&(L=B.Wac)):x.ULS.sendTraceTag(522739865,
0,10,"GetSettingFromRoaming : ResponseData is null"):x.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(L)}})}catch(n){x.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",n.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.Fpd(),n=this;return this.getSetting().then(B=>{let L=null;B&&(L=D.a(B));if(!L)return x.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),
Promise.resolve(!0);for(const ba of Yb.a.FR(L)){B=L[ba.toString()];for(const la of Yb.a.FR(B)){const La=B[la];if(La.addinId===b)delete B[la.toString()];else if(0===La.ownerType&&La.shortcutInfoArray){const fb=La.shortcutInfoArray,Cb=new ob.a;for(let Lb=0;Lb<fb.length;++Lb)fb[Lb].addinId!==b&&Cb.add(fb[Lb]);La.shortcutInfoArray=Cb.toArray()}}Yb.a.count(B)||delete B[ba]}n.Rca=L;n.Nxo(b);return h?n.tJj(D.c(L)):n.owe(D.c(L))})}eec(){if(this.Rca){this.Tra=null;const n=this.Rca;for(const B in n){var b=
B;const L=n[B];for(const ba in L){var h=ba;const la=L[ba];la.shortcutInfoArray&&this.Mef(parseInt(h),parseInt(b),la.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>{let h=null;if(b&&!({Zu:h}=D.d(b)).returnValue)return x.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.Rca=h;this.eec();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,
h,n){return this.Rca&&(n=this.Rca[n])&&(h=n[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.Rca&&(h=this.Rca[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,h,n){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),n)}setShortcutInfoArray(b,h,n){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),n).then(()=>{this.eec();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.Tra)return Promise.resolve(!0);
var n=this.Tra[b];if(!n)return Promise.resolve(!0);var B=n[h];n=B.modifiers;B=B.keyCode;const L=this.getShortcutInfoArray(n.toString(),B.toString());if(!L||!L.length)return Promise.resolve(!0);let ba=0;for(const la of L){if(la.addinId===b&&la.action===h)break;++ba}if(ba>=L.length)return Promise.resolve(!0);L.splice(ba,1);return this.saveShortcutInfoArray(n,B,L).then(()=>{this.eec();return Promise.resolve(!0)})}Mef(b,h,n){this.Tra||(this.Tra={});for(const B of n){n=B.addinId;const L=B.action;let ba=
this.Tra[n];ba||(ba={});const la={};la.modifiers=b;la.keyCode=h;ba[L]=la;this.Tra[n]=ba}}Nxo(b){b in this.Tra&&delete this.Tra[b]}isActionCustomized(b,h){return this.Tra&&(b=this.Tra[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,h){return this.Tra&&(b=this.Tra[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.Rca}static instance(){sv.khf||(x.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),sv.khf=new sv,sv.RT=A.AFrameworkApplication.Be);return sv.khf}}sv.khf=
null;sv.RT=null;Object(u.a)(sv,"AddinShortcutsPreferenceSettingHelper",null,[]);class FF{constructor(b,h){this.jzd=null;new ob.a;this.iph=!0;this.ACd=b;this.ikh=h}kgf(b){this.ikh.addHandler("GoalChangedEvent",b)}$Rn(){this.ikh.raiseEvent("GoalChangedEvent")}lYf(b,h){return this.jzd&&this.iph?b in this.jzd?this.jzd[b]:"Formality"===h&&this.ACd.VNf().formality?!1:!0:!0}TRo(b,h){h===this.ACd.VNf().formality&&(this.jzd=b,this.$Rn())}pwp(b){this.iph=b}}Object(u.a)(FF,"GoalChangeSource",null,[385,386,387]);
var mw=d(1061),QB=d(999),GF=d(758);class nA{constructor(b,h,n,B,L,ba){this.ARa=h;this.BGa=n;this.Re=b;this.MC=B;this.Sg=L;this.Mxk=ba;this.BGa.YSb()&&this.initialize()}initialize(){return this.MC.Pl().then(()=>{this.Re.nb(this,mw.a.getTypeName());this.Re.addHandler(this,QB.a.getTypeName())}).catch(b=>{this.Sg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}lD(b,h){if(h===mh.a.getTypeName()||h===GF.a.getTypeName())if(!b||!b.content)this.Sg.sendTraceTag(528274564,
2252,10,"Handled annotation is invalid");else if(Cj.a.getTypeNameFor(b.content)===mw.a.getTypeName()||Cj.a.getTypeNameFor(b.content)===QB.a.getTypeName())if(Cj.a.getTypeNameFor(b.content)===mw.a.getTypeName()){var n=b.content;this.Sg.sendTraceTag(528274565,2252,50,"Goal annotation received with formality goal: {0}",n.critiqueConfiguration.formalityGoal);this.ARa.TRo(n.critiqueConfiguration.mapping,n.critiqueConfiguration.formalityGoal)}else if(Cj.a.getTypeNameFor(b.content)===QB.a.getTypeName())if(b=
b.content,b.features){for(n of b.features)if("Goals"===n.featureName){this.Mxk.pwp(!!n.supportType);return}this.Sg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Sg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}Object(u.a)(nA,"GoalsAnnotationHandler",null,[223]);class rD{constructor(b){this.Ga=b}YSb(){return this.Ga.$("EditorGoalsEnabled")}}Object(u.a)(rD,"GoalsGate",null,[384]);var oA=d(1264),yH=d(1271),HF=d(948);
class Rs{}Rs.YZd=0;Rs.c_d="1.0";Rs.settingType="Goals";Object(u.a)(Rs,"GoalsConstants",null,[]);var pA=d(1160);class ky{constructor(b,h,n,B,L){this.e$b=null;this.aZi=!1;this.Nzh=b;this.CCd=h;this.Sg=n;this.BGa=B;this.cUe=L;this.BGa.YSb()?this.Wno():this.BGa.YSb()&&this.pyg(Rs.YZd,Rs.c_d)}Wno(){new Promise(b=>{this.Nzh.DEi(Rs.settingType,h=>{this.Xno(h)?(this.pyg(this.e$b.formality,this.e$b.version),b(this.e$b)):(this.pyg(Rs.YZd,Rs.c_d),b(null))})})}Xno(b){this.aZi=!0;if(!b||!b.Fyb)return this.Sg.sendTraceTag(528274529,
2252,50,"No persisted goal is registered."),!1;b=b.Fyb.properties;var h=b.getValue(Lc.a.LTi);h=parseInt(h);b=b.getValue(Lc.a.MTi);if(!this.CCd.gOg(b))return this.Sg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.e$b=b=Object.assign(new pA.a,{formality:h,version:b});this.Sg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}pyg(b,h){b=Object.assign(new HF.a,
{formality:b,version:h});this.cUe.SLj(b)}OJp(b){if(this.CCd.gOg(b.version)){var h=oA.a.cGl(b.version,b.formality.toString());this.Nzh.pOh(Object.assign(new yH.a,{Fyb:h,settingType:Rs.settingType}))?this.e$b=b:this.Sg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Sg.sendTraceTag(528274560,2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}mBi(){this.aZi||this.Sg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");
return this.e$b}}Object(u.a)(ky,"GoalsPersistenceHandler",null,[383]);class IF{constructor(b,h,n,B){this.Sg=b;this.dUe=h;this.CCd=n;this.BGa=B;this.BCd=Object.assign(new pA.a,{formality:Rs.YZd,version:Rs.c_d});this.$8e=this.BGa.YSb()}VNf(){this.$8e&&(this.$8e=!1,this.dUe.mBi()&&(this.BCd=this.dUe.mBi()));return this.BCd}SXo(b){this.$8e=!1;this.CCd.gOg(b.version)?(this.BGa.YSb()&&this.dUe.OJp(b),this.BCd=b):(this.Sg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",
b.version),this.BCd=Object.assign(new pA.a,{formality:Rs.YZd,version:Rs.c_d}))}}Object(u.a)(IF,"GoalsProvider",null,[381,382]);class RB{constructor(b,h,n,B){this.Re=b;this.MC=h;this.QY=n;this.Sg=B}SLj(b){b=Object.assign(new mh.a,{parentPath:["Signal",HF.a.getTypeName()],items:[Object.assign(new Fk.a,{body:b})]});this.x1d(b)}x1d(b){this.MC.Pl().then(()=>{this.fef(b)}).catch(h=>{this.Sg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}fef(b){this.Re.activateAnnotation(mw.a.getTypeName(),
RB.fdc).then(()=>{this.QY.getAugLoopRuntimeManager().submitOperation(Object.assign(new Na.a,{operation:b}))}).catch(h=>{this.Sg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}RB.fdc="GoalSelected";Object(u.a)(RB,"GoalsSignalSender",null,[380]);class cx{constructor(){cx.Ocf=new RegExp(cx.sSk)}gOg(b){return!!b.match(cx.Ocf)&&1===b.match(cx.Ocf).length}}cx.sSk="[0-9]+[.]?[0-9]*";cx.Ocf=null;Object(u.a)(cx,"GoalsValidator",null,[237]);class SB{constructor(){this.W=
null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}wc(b){this.W=b;this.W.ia("WordEditor.Goals.GoalsValidator",()=>new cx).as("WordEditor.Goals.IGoalsValidator").ha();this.W.ia("WordEditor.Goals.IGoalsGate",()=>new rD(this.W.resolve("Common.IAppSettingsManager"))).ha();this.W.ia("WordEditor.Goals.GoalsProvider",()=>new IF(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),
this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").ha();this.W.ia("WordEditor.Goals.GoalChangeSource",()=>new FF(this.W.resolve("WordEditor.Goals.IGoalReader"),new mg.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").ha();this.W.ia("WordEditor.Goals.GoalsPersistenceHandler",()=>new ky(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),
this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").ha();this.W.ia("WordEditor.Goals.GoalsAnnotationHandler",()=>new nA(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),
this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").ha();this.W.ia("WordEditor.Goals.GoalsSignalSender",()=>new RB(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").ha()}static main(){M.a.instance.Jc(new SB)}}Object(u.a)(SB,"WordEditorGoalsPackage",
null,[0,1]);var Ln=d(1932),Go=d(673),fJ=d(446);class sD{constructor(){this.annotation=null;this.languages=new mi.a(Qa.a.th())}}Object(u.a)(sD,"CritiqueCountWrapper",null,[]);class ly{constructor(){this.Ywa=new qb.a}i6d(){return this.Ywa}iRi(b,h,n,B){if(this.Ywa.mb(n)){this.Ywa.J(n).annotation.count+=h;n=this.Ywa.J(n).languages;for(var L of B)n.add(L)}else L=S.a.create().toString(),b=Object.assign(new fJ.a,{id:L,categoryName:b,count:h}),this.Ywa.add(n,Object.assign(new sD,{annotation:b,languages:B}))}}
ly.kj=389;Object(u.a)(ly,"BaseCritiquesByTypeCounter",null,[220]);class gJ extends ly{constructor(b){super();this.wHb=new Ea.a;this.NOe=new Ea.a;this.cQd=b}hUm(b){const h=b.annotation;try{if(h&&Go.a(Cj.a.getTypeNameFor(h.content))){const n=h.content;if(b.opType===mh.a.getTypeName()){this.cQd.dAo(h.parentPath,n);const B=n.M_.state;if(60!==B&&70!==B)return this.wHb.contains(h.id)&&this.wHb.remove(h.id),this.n4m(h.id,n),Ln.a.mzb(h,8),!0;this.wHb.add(h.id)}else if(b.opType===Au.a.getTypeName())if(this.wHb.contains(h.id))this.wHb.remove(h.id);
else if(this.hdi(n.typeId,h.id))return Ln.a.mzb(h,16),!0}}catch(n){Ln.a.mcd(n,[h],!0)}return!1}gUm(b){if((b=b.annotation)&&Go.a(Cj.a.getTypeNameFor(b.content))){const h=b.content,n=h.M_.state;if((60===n||70===n)&&!this.wHb.contains(b.id))return this.wHb.add(b.id),this.hdi(h.typeId,b.id)}return!1}n4m(b,h){this.NOe.add(b);b=new mi.a(Qa.a.th());h.language&&b.add(h.language);this.iRi(h.categoryName,1,h.typeId,b)}hdi(b,h){if(!this.NOe.contains(h))return!1;if(!this.Ywa.mb(b))return x.ULS.sendTraceTag(589866503,
ly.kj,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.Ywa.J(b).annotation.count)return x.ULS.sendTraceTag(589866504,ly.kj,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.NOe.remove(h);this.Ywa.J(b).annotation.count--;return!0}}Object(u.a)(gJ,"AlCritiquesByTypeCounter",ly,[416,220]);var tD=d(1081);class rK extends hv.a{constructor(b,
h,n,B,L,ba,la,La,fb){var Cb;super();this.Re=b;this.cQd=h;this.BKe=n;this.dfh=B;this.ARa=L;this.dya=ba;this.jj=la;this.Uda=this.vdh=!1;this.q2e=new qb.a;this.AXn=(Lb,$b)=>{this.cQd.jVm($b)&&(this.Uda=!0,this.D0())};this.zUn=(Lb,$b)=>{this.BKe.hUm($b)&&this.u_b()};this.Akj=()=>{this.u_b()};this.Pdg=(Lb,$b)=>{this.BKe.gUm($b)&&this.u_b()};this.Dvb=()=>{this.u_b()};this.u_b=()=>{let Lb=!1;this.jj.Yd(()=>{var $b=this.Ynm();const tc=new ob.a;for(const Nc of $b)$b=Object.assign(new tD.a,{id:Nc.id,parentPath:Es.a.ANb,
content:Nc,annotationType:Cj.a.getTypeNameFor(Nc)}),tc.add($b),Lb||(Lb=0<Nc.count);this.Re.SRo(tc)},"CC:SATH");!this.vdh&&Lb&&(aa.a.sendTelemetryEvent({...(new wa.a),name:"Office.Word.Online.Editor.CritiquesAvailable"}),this.vdh=!0)};this.tgn=(Lb,$b,tc)=>{const Nc=!this.ARa||this.ARa.lYf(Lb,tc);Lb=this.dya&&this.dya.instance?this.dya.instance.kYf(Lb,tc,$b.substr(1,$b.length-2)):!0;return Nc&&Lb};null===La||void 0===La?void 0:La.kgf(this.Dvb);fb.Ava(this,7);null===(Cb=this.dya)||void 0===Cb?void 0:
Cb.execute(Lb=>{Lb.Igf(this.u_b)})}get index(){return 3}run(){this.Uda&&(this.u_b(),this.Uda=!1)}Ymj(){this.u_b()}KCl(b){let h=0;if(({value:h}=this.q2e.Dc(b.categoryName,0)).returnValue)if(h!==b.count)this.q2e.Z(b.categoryName,b.count);else return!1;else this.q2e.add(b.categoryName,b.count);return!0}Ynm(){const b=new qb.a;var h=this.cQd.i6d();const n=this.BKe.i6d();this.TLg(b,h);this.TLg(b,n);this.dfh&&(h=this.dfh.i6d(),this.TLg(b,h));h=new ob.a;for(const B of b.values)this.KCl(B)&&h.add(B);return h}TLg(b,
h){for(const L of h){h=L.value.annotation;const ba=L.key;var n=this.PPo(L.value.languages);if(!b.mb(h.categoryName)){var B=S.a.create().toString();B=Object.assign(new fJ.a,{id:B,categoryName:h.categoryName,count:0,countsByTypeId:{}});b.add(h.categoryName,B)}this.tgn(ba,n,h.categoryName)&&(n=b.J(h.categoryName),n.count+=h.count,n.countsByTypeId[ba]=(n.countsByTypeId[ba]?n.countsByTypeId[ba]:0)+h.count)}}PPo(b){const h=[];let n=0;for(const B of b)h[n++]=B;return D.c(h)}}Object(u.a)(rK,"CritiquesCounter",
hv.a,[414,415]);class Lm{constructor(b){this.C5=b}i6d(){const b=new qb.a,h=new mi.a(Qa.a.th()),n=Object.assign(new fJ.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.C5.nFc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new sD,{annotation:n,languages:h}));return b}}Object(u.a)(Lm,"DictationCritiquesByTypeCounter",null,[221,220]);class sK extends ly{constructor(b){super();this.ahb=new qb.a;this.Re=b}jVm(b){const h=Es.a.E8d(b.nodeId);if(!Es.a.Tf(h)){if(b.opb&&
b.opb.length){let n=null;for(const B of b.opb)B.errorDetails.jab()||(b=this.Mwi(B),Es.a.Tf(b)||(n||(n=new qb.a),n.mb(b)||n.add(b,new ob.a),n.J(b).add(B)));this.idi(h);n?this.QVo(h,n):this.ahb.remove(h)}else{if(!this.ahb.mb(h))return!1;this.idi(h);this.ahb.remove(h)}return!0}return!1}dAo(b,h){var n;if(({value:n}=this.ahb.Dc(b,n)).returnValue)for(const L of n)if(b=L.value,0<b.count&&this.RIf(b.J(0))===h.categoryName)for(n=b.count-1;0<=n;n--){var B=b.J(n).end-b.J(n).Fc;b.J(n).Fc===h.range.start&&B===
h.range.length&&(B=this.Mwi(b.J(n)),this.Ywa.mb(B)&&(B=this.Ywa.J(B).annotation,B.count=Math.max(0,B.count-1)),b.removeAt(n))}}idi(b){if(this.ahb.mb(b))for(const n of this.ahb.J(b)){var h=n.key;b=n.value;this.Ywa.mb(h)&&(h=this.Ywa.J(h).annotation,h.count=Math.max(0,h.count-b.count))}}QVo(b,h){const n=new qb.a,B=new qb.a;for(const L of h){h=L.key;B.add(h,new mi.a(Qa.a.th()));for(const ba of L.value){const la=ba.end-ba.Fc,La=this.RIf(ba);this.xol(b,La,ba.Fc,la)?x.ULS.sendTraceTag(589866513,ly.kj,50,
"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",h,b,ba.Fc,la):(n.mb(h)||n.add(h,new ob.a),n.J(h).add(ba),B.J(h).add(this.$nm(ba)))}}this.ahb.Z(b,n);for(const L of this.ahb.J(b))0<L.value.count&&(b=this.RIf(L.value.J(0)),this.iRi(b,L.value.count,L.key,B.J(L.key)))}Mwi(b){let h=null;b&&(b=Object(ya.a)(218,b.errorDetails))&&b.Au&&(h=b.Au.TypeId);return h}RIf(b){let h=null;b&&(b=Object(ya.a)(218,b.errorDetails))&&b.Au&&(h=b.Au.CategoryTitle);
return h}$nm(b){let h="";b&&b.errorDetails&&(h=hj.a.Cg(b.errorDetails.lcid).name);return h}xol(b,h,n,B){if((b=this.Re.kHf(b))&&0<b.count)for(const L of b)if(b=Cj.a.getTypeNameFor(L.content),L&&Go.a(b)&&(b=L.content,b.categoryName===h&&b.range.start===n&&b.range.length===B))return!0;return!1}}Object(u.a)(sK,"WacCritiquesByTypeCounter",ly,[219,220]);class tK{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}wc(b){this.W=b}init(){var b=this.W.resolve("Common.IAppSettingsManager");
if(b.$("AugLoopOperationsAreEnabled")){this.W.ia("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>new sK(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();this.W.ia("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new gJ(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).ha();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.W.ia("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",
()=>new Lm(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).ha();this.W.ia("WordEditor.CritiqueCounts.ICritiquesCounter",()=>new rK(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.Oa("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.Oa("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.Qa("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),
Rn.a.instance,this.W.Oa("WordEditor.Goals.IGoalChangeSource"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).ha();b=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.W.resolve("Box4.Proofing.IErrorRangeEditor").aQh(b.AXn);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").o0k(b.zUn);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").MPh(b.Pdg);h&&(h=this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),h.wPh(b.Akj),h.xPh(b.Akj))}}dispose(){}static main(){M.a.instance.Jc(new tK)}}
Object(u.a)(tK,"WordEditorCritiqueCountsPackage",null,[0,1]);class iz{get name(){return"WordEditor.GraphicsEditor"}wc(){}init(){}dispose(){}static main(){M.a.instance.Jc(new iz)}}Object(u.a)(iz,"PackageManager",null,[0,1]);var hJ=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},
children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",
Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",
Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",
LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class uD{constructor(b){this.vuk={};this.Yb=b;this.HHb=new Lf.a}rVa(b,h){const n=this.Yb.Kwb,B=parseInt(b);return b&&B!==Ce.ActionManager.xAf?this.HHb.mb(n)?(b=this.HHb.J(n).Mlc(B,h,2),
32===b||1===b):!1:!1}$La(b){const h=parseInt(b),n=this.Yb.Kwb;return b&&h!==Ce.ActionManager.xAf?this.HHb.mb(n)?32===this.HHb.J(n).Mlc(h,this.vuk,1):!1:!0}gBj(b,h){this.HHb.Z(b,h)}DSj(b){b=parseInt(b);const h=this.Yb.Kwb;return!!h&&!!this.HHb.J(h)&&this.HHb.J(h).yfn(b)}}Object(u.a)(uD,"NonCanvasCuiUser",null,[1450,205]);var dx=d(1298),qA=d(53),vD;(function(b){b[b.dRp=0]="UnspecifiedGallery";b[b.qLp=1]="CharacterCodeGallery";b[b.SMp=2]="FontStyleGallery";b[b.BNp=3]="InkThicknessGallery";b[b.wNp=4]=
"IconGallery";b[b.ZNp=5]="ListGallery";b[b.AQp=6]="TableStyleGallery";b[b.dPp=7]="PageNumberGallery";b[b.pLp=8]="ChangeColorsGallery"})(vD||(vD={}));Object(u.b)("GalleryType",vD);class su{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(u.a)(su,"CommonGalleryButtonProps",null,[]);class iJ extends su{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(u.a)(iJ,"AdditionalTableStyleGalleryButtonProps",su,[]);class uK extends iJ{constructor(){super()}}
Object(u.a)(uK,"AdditionalChangeColorsGalleryButtonProps",iJ,[]);class jJ extends su{constructor(){super();this.character=null}}Object(u.a)(jJ,"AdditionalCharacterCodeGalleryButtonProps",su,[]);class vK extends su{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(u.a)(vK,"AdditionalFontStyleGalleryButtonProps",su,[]);class zH{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}
Object(u.a)(zH,"AdditionalGalleryProperties",null,[]);class wK extends su{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.role=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(u.a)(wK,"AdditionalIconButtonProperties",su,[]);class VM extends su{constructor(){super();this.styleDisplayName=null}}Object(u.a)(VM,"AdditionalInkThicknessGalleryButtonProps",su,[]);class xK extends su{constructor(){super();this.ariaLabel=this.infoAtLevel=
null}}Object(u.a)(xK,"AdditionalListGallerButtonProps",su,[]);class yK extends su{constructor(){super();this.text=null}}Object(u.a)(yK,"AdditionalPageNumberGalleryButtonProps",su,[]);var TB=d(1216);const WM=(b,h)=>{var n=appChrome.selectors.getActiveControlStates();if(n=Object(ya.a)(Object,n[b])){if((b=Object(ya.a)(String,n.value))&&b===h)return!1;b=Object(ya.a)(String,n.selectedKey);if(!h&&!b)return!1;if(b){n=Array.isArray(n.options)?n.options:null;let B=null;for(let L=0;L<n.length;L++){const ba=
Object(ya.a)(Object,n[L]);if(Object(ya.a)(String,ba.key)===b){B=ba;break}}if(B&&Object(ya.a)(String,B.text)===h)return!1}}return!0},zK=(b,h,n,B)=>{if(0<(B&2)){B=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":B.push(AH(b,n[$g.a.On]));break;case "CheckboxModel":B.push(appChrome.actions.toggleCheckbox(b,n[$g.a.On]));break;case "ComboBoxModel":if(!WM(b,n[em.a.Value]))break;(h=n[em.a.Key])?B.push(appChrome.actions.updateComboBoxKey(b,h,n[em.a.Value])):B.push(appChrome.actions.updateComboBoxValue(b,
n[em.a.Value]));break;case "FontPickerModel":B.push(appChrome.actions.updateFontPickerSelectedFont(b,n[TB.a.SelectedFont]));break;case "SplitButtonModel":B.push(AH(b,n[If.a.On]));break;case "SpinButtonModel":B.push(appChrome.actions.updateSpinButton(b,n[Ki.a.Number],Fg.a.i7a(n[Ki.a.UnitType]),n[Ki.a.Text],n[Ki.a.MaxValue],n[Ki.a.Alt]));break;case "ColorPickerModel":B.push(appChrome.actions.updateColorPickerSelectedColor(b,n[$a.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":B.push(appChrome.actions.updatePageNumberGalleryButtonText(b,
n[Jj.a.Text]));break;case "CompoundButtonModel":n[$g.a.Description]&&B.push(appChrome.actions.updateCompoundButtonDescription(b,n[$g.a.Description]));$g.a.On in n&&B.push(AH(b,n[$g.a.On]));break;case "SliderModel":n.snapToStep?B.push(appChrome.actions.updateSliderSelectedValue(b,n[ho.Value])):B.push(appChrome.actions.updateSliderValue(b,n[ho.Value],n[ho.MinValue]||0,n[ho.MaxValue],n[ho.Text]));break;case "FlyoutAnchorModel":uk.a.ImageIsVisible in n&&B.push(appChrome.actions.hideFlyoutAnchorIcon(b,
!n[uk.a.ImageIsVisible]));$g.a.On in n&&B.push(AH(b,n[$g.a.On]));break;case "InputBoxModel":B.push(appChrome.actions.updateInputBoxValue(b,n[Mn.a.Text]))}h=B;var L=Object(ya.a)(String,n[Yh.a.iconColor]);void 0!==L&&null!==L&&h.push(appChrome.actions.updateIconColor(b,L));rA(b,n,B);h=B;(L=Object(ya.a)(Object,n[Yh.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,L));h=B;L=Object(ya.a)(String,n[Yh.a.customTooltip]);void 0!==L&&null!==L&&h.push(appChrome.actions.setControlCustomTooltip(b,L));
b=B;(n=Array.isArray(n[Yh.a.Rqg])?n[Yh.a.Rqg]:null)&&b.push.apply(b,n);return B}return null},ex=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),AH=(b,h)=>appChrome.actions.toggleButton(b,h),rA=(b,h,n)=>{h=Object(ya.a)(String,h[Yh.a.Icon]);void 0!==h&&null!==h&&n.push(appChrome.actions.setControlIcon(b,h))};class XM{constructor(b,h,n,B){this.Vl=B;this.nya=b;this.AB=h;this.S$b=n;this.kKc={}}oco(b,h,n,B,L=null){const ba=b.ExternalGalleryId||b.ExternalId;var la=b.ExternalId;B.push(ba);
if(appChrome.selectors.isControlDefined(ba))b.GalleryStyle&&kh.d("setGalleryStyles")&&h.push(appChrome.actions.setGalleryStyles(ba,b.GalleryStyle));else{if(4!==b.Type)return;n.push(appChrome.api.createGalleryModel(ba,Object.assign(new zH,{columns:b.Width,sections:[appChrome.api.gallerySection([],la)],styles:b.GalleryStyle,galleryType:"IconGallery"})))}n=0;if(kh.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){la=[];B=[];const fb=[],Cb={};for(var La of b.GallerySections){la.push(appChrome.api.gallerySection([],
La.SectionId,La.Title));0===n&&La.GalleryButtons&&0<La.GalleryButtons.length&&(n=La.GalleryButtons[0].Type);this.XEi(La.GalleryButtons,L,Cb);const Lb=this.Xef(B,La.GalleryButtons,Cb);B.push.apply(B,this.bNf(Lb,ba,La.SectionId,!1,n,L,!0,Cb));fb.push.apply(fb,Lb)}h.push(appChrome.actions.setGallerySections(ba,la));h.push.apply(h,B);h.push.apply(h,this.vKf(ba,vD[n],fb,null,5===b.Type,!0,null,Cb))}else b.GalleryItems&&0<b.GalleryItems.length&&(n=b.GalleryItems[0].Type),La=this.XEi(b.GalleryItems,L,null),
h.push.apply(h,this.bNf(this.Xef(h,b.GalleryItems,La),ba,la,!1,n,L,!1,La))}pGm(b,h){const n=[];let B=null,L=!1;if(!b)return null;const ba=this.nya.Dhd(this.AB,b.commandId,h);n.push(ex(b.externalUxCommand,!ba));if(b.previewControlIds){const fb=[];for(let Cb=0;Cb<b.previewControlIds.length;Cb++){var la={},La=b.previewControlIds[Cb];la.SourceControlId=La;const Lb=this.Vl.getCommandByExternalUxId(La);this.S8d(Lb||b,la);la[Jj.a.On]&&(B=la.SourceControlId,la[Jj.a.HighlightOn]&&(L=!0));rA(La,la,n);if(la=
Object(ya.a)(Wz.a,la[Jj.a.GalleryButtonProps]))fb.push(la),ba&&(La=this.nya.Dhd(this.AB,la.Command,h),la.IsDisabled=!La)}0<fb.length&&n.push.apply(n,this.bNf(this.Xef(n,fb),b.externalUxCommand,b.externalUxCommand,!0,fb[0].Type));n.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,B));L&&(x.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",B),n.push(appChrome.actions.highlightSelectedFontStyle(B)))}return n}Xef(b,h,n=null){const B=[],L=[];for(let la=
0;la<h.length;la++){const La=h[la],fb=Kf.b(La.ExternalId)?La.Id:La.ExternalId;B.push(fb);const Cb=n&&n[fb]?n[fb].result:-1;switch(La.Type){case 1:var ba=La;L.push(appChrome.api.createCharacterCodeGalleryButtonModel(fb,Object.assign(new jJ,{disabled:-1!==Cb?1>(Cb&1):ba.IsDisabled,character:ba.Character,style:ba.Style,title:ba.Alt})));break;case 2:ba=La;L.push(appChrome.api.createFontStylesGalleryButtonModel(fb,Object.assign(new vK,{disabled:-1!==Cb?1>(Cb&1):ba.IsDisabled,styleDisplayName:ba.LabelText,
style:ba.Style,title:ba.Alt,previewStyleLabel:ba.PreviewStyleLabel})));break;case 3:ba=La;L.push(appChrome.api.createInkThicknessGalleryButtonModel(fb,Object.assign(new VM,{disabled:-1!==Cb?1>(Cb&1):ba.IsDisabled,styleDisplayName:ba.LabelText,style:ba.Style,title:ba.Alt})));break;case 4:ba=La;L.push(appChrome.api.createIconGalleryButtonModel(fb,Object.assign(new wK,{disabled:-1!==Cb?1>(Cb&1):ba.IsDisabled,icon:[ba.Icon],role:ba.Role,fullIconStyle:ba.FullIconStyle,previewIconStyle:ba.PreviewIconStyle,
largePreviewIconStyle:ba.LargePreviewIconStyle,label:ba.LabelText,title:ba.Alt})));break;case 5:ba=La;L.push(appChrome.api.createListGalleryButtonModel(fb,Object.assign(new xK,{disabled:-1!==Cb?1>(Cb&1):ba.IsDisabled,infoAtLevel:ba.LevelInfo,ariaLabel:ba.Alt})));break;case 6:ba=La;L.push(appChrome.api.createTableStyleGalleryButtonModel(fb,Object.assign(new iJ,{disabled:-1!==Cb?1>(Cb&1):ba.IsDisabled,tableCellStyles:ba.TableCellStyles,tableStyles:ba.TableStyles,title:ba.Alt,columns:ba.columns})));
break;case 8:ba=La;L.push(appChrome.api.createChangeColorsGalleryButtonModel(fb,Object.assign(new uK,{disabled:-1!==Cb?1>(Cb&1):ba.IsDisabled,tableCellStyles:ba.TableCellStyles,tableStyles:ba.TableStyles,title:ba.Alt})));break;case 7:ba=La,L.push(appChrome.api.createPageNumberGalleryButtonModel(fb,Object.assign(new yK,{disabled:-1!==Cb?1>(Cb&1):ba.IsDisabled,text:ba.Text,title:ba.Alt})))}this.Vl.addCommandToMaps(Object.assign(new qA.a(fb,La.Command),{queryCommandId:La.QueryCommand,menuItemId:La.MenuItemId}))}b.push(appChrome.actions.addControls(L));
return B}bNf(b,h,n,B,L,ba=null,la=!1,La=null){const fb=[];B?fb.push(appChrome.actions.populateGalleryItems(h,b)):(this.kKc[h]=!1,la||(B=!0,appChrome.selectors.isControlDefined(h)&&(B=appChrome.selectors.getGalleryState(h),B=B.disableIndividualButtons?B.disableIndividualButtons:!0),fb.push.apply(fb,this.vKf(h,vD[L],b,null,5===L,B,ba,La))),fb.push(appChrome.actions.updateGallerySectionItems(h,n,b)));return fb}Qtm(b){return this.vKf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?
b.disableIndividualButtons:!0)}vKf(b,h,n,B,L,ba=!0,la=null,La=null){const fb=[];if(b in this.kKc){if(this.kKc[b])return delete this.kKc[b],fb;this.kKc[b]=!0}let Cb=null,Lb=-1;if(n)({dsi:Lb,returnValue:Cb}=this.FNh(h,n,fb,ba,la,La));else if(B)for(const $b of B)(n=({dsi:Lb}=this.FNh(h,$b.galleryButtons,fb,ba,null,La)).returnValue)&&(Cb=n);fb.push(appChrome.actions.updateGallerySelectedId(b,Cb));ba&&fb.push(ex(b,!1));L&&0<Lb&&fb.push(appChrome.actions.updateListGalleryTextDirection(b,2===Lb));return fb}WEi(b,
h=null){const n={},B={};B.SourceControlId=b;B.Location=h;b=this.Vl.getCommandByExternalUxId(b);if(!b)return n.result=-1,n.props=B,n;b=this.S8d(b,B);n.result=b;n.props=B;return n}XEi(b,h=null,n=null){n||(n={});for(const B of b)b=Kf.b(B.ExternalId)?B.Id:B.ExternalId,n[b]=this.WEi(b,h);return n}FNh(b,h,n,B,L=null,ba=null){let la,La=null;la=-1;let fb=!1;for(const Lb of h){var Cb=this.Ntm(b);h=ba&&ba[Lb]&&-1!==ba[Lb].result?ba[Lb]:this.WEi(Lb,L);const $b=h.result;h=h.props;B&&n.push(ex(Lb,1>($b&1)));(Cb=
zK(Lb,Cb,h,$b))&&n.push.apply(n,Cb);h[Jj.a.On]&&(La=Lb,h[Jj.a.HighlightOn]&&h[Jj.a.HighlightOn]&&(fb=!0));void 0!==h[Yh.a.labelText]&&null!==h[Yh.a.labelText]&&(Cb=this.Vl.getCommandByExternalUxId(Lb),n.push(appChrome.actions.setControlLabel(Cb.externalUxCommand,h[Yh.a.labelText])));h[Jj.a.IsRtl]&&0>la&&(la=h[Jj.a.IsRtl])}fb&&(x.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",La),n.push(appChrome.actions.highlightSelectedFontStyle(La)));return{returnValue:La,dsi:la}}Ntm(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}S8d(b,h){h.MenuItemId=b.menuItemId;return this.nya.Xua(this.AB,this.S$b,
b.commandId,b.queryCommandId,h)}}Object(u.a)(XM,"ReactGalleryPoller",null,[]);var YM=d(747),fx=d(700),ZM=d(1803),AK=d(838),$M=d(1804);class BK{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(u.a)(BK,"PopulateFontPickerDataProps",null,[]);var CK=d(303),nw=d(1982);class fr{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;
this.shouldTakeFocus=!1}}Object(u.a)(fr,"CommonOptionalButtonProperties",null,[]);class JF extends fr{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(u.a)(JF,"OptionalButtonProperties",fr,[]);class DK extends fr{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(u.a)(DK,"OptionalCompoundButtonProperties",fr,[]);class EK extends fr{constructor(){super();
this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(u.a)(EK,"OptionalErrorViewProperties",fr,[]);class FK extends fr{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(u.a)(FK,"OptionalFlyoutAnchorProperties",fr,[]);class GK extends fr{constructor(){super();this.isBanner=null}}Object(u.a)(GK,"OptionalLabelProperties",
fr,[]);class HK extends fr{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.details=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(u.a)(HK,"OptionalMultipActionButtonProperties",fr,[]);class IK extends JF{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(u.a)(IK,"OptionalPersonaButtonProperties",JF,[]);class BH extends fr{constructor(){super();this.toggled=
!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(u.a)(BH,"OptionalToggleButtonProperties",fr,[]);var pO=d(1806),qO=d(1805),rO=d(511);class sA{constructor(){this.X4h=this.actions=null;this.gbk=!1}}Object(u.a)(sA,"PopulateActions",null,[]);class JK{RHi(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.gHm(b);case "InkButtonModel":return this.fHm(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);
case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}gHm(b){const h={};h[$g.a.On]=appChrome.selectors.getButtonToggleState(b);return h}fHm(b){const h={};h[$g.a.On]=kh.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return h}}Object(u.a)(JK,"ReactStatePropsSelector",null,[]);class CH{constructor(b,h,n,B,L){this.nya=b;this.AB=h;this.S$b=n;this.Vl=B;this.C$e={};this.jKk=new JK;this.qHb=L}cWj(b){const h=b.populationProps.populateQueryCommandId;
return b.populationProps.populateOnlyOnce&&h in this.C$e}HHm(b,h,n=null){const B=[],L={};if(!this.cWj(b)){const ba=b.populationProps.populateQueryCommandId,la={};la.MenuId=b.externalUxCommand;la.IsShadowMenuOpen=this.isShadowMenuOpen(n);if(0<(this.nya.Xua(this.AB,this.S$b,ba,ba,la,this.Awm(n))&1))if("FontPickerModel"===h)this.C$e[ba]=!0,B.push(CH.UFm(b,la)),L[b.externalUxCommand]="FontPickerModel";else if(la.MenuItems)switch(this.C$e[ba]=!0,h){case "ComboBoxModel":B.push(CH.SFm(b,la));L[b.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":B.push.apply(B,this.dKi(b.externalUxCommand,h,la.MenuItems,L,n&&"location"in n?n.location:null))}}return Object.assign(new sA,{actions:B,X4h:L,gbk:this.isShadowMenuOpen(n)})}pCi(b,h,n,B,L,ba,la,La,fb=null){let Cb=null;const Lb=[];Kf.c(b.Title)||(Cb=b.Title);for(let $b=0;$b<b.ControlList.length;$b++){const tc=Object(ya.a)(hp.a,b.ControlList[$b]);
if(!tc||tc.ExternalId)ba&&this.cmm(tc,ba),h.push.apply(h,this.TFm(tc,la,Lb,L,n,B,fb))}return La?appChrome.api.menuSection(Lb,Cb,b.Lang):null}dKi(b,h,n,B,L=null){const ba=[],la=[],La=[],fb=[];for(var Cb=0;Cb<n.MenuSectionList.length;Cb++){var Lb=Object(ya.a)(te.a,n.MenuSectionList[Cb]);Lb&&(Lb=this.pCi(Lb,ba,b,h,fb,B,la,n.UpdateDynamically,L),n.UpdateDynamically&&La.push(Lb))}Cb=null;n.MenuFooterSection&&(Cb=this.pCi(n.MenuFooterSection,ba,b,h,fb,B,la,n.UpdateDynamically,L));n.UpdateDynamically&&ba.push(appChrome.actions.updateMenu(b,
La,n.Title,n.AriaLabel,n.ShouldAutoOpen,n.AriaRoleDescription,n.MenuTargetDescriptor,Cb,n.IsFlexLayout));0<la.length&&ba.splice(0,0,appChrome.actions.addControls(la));0<fb.length&&kh.d("setStatefulSplitButtonMruBypassControls")&&ba.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,fb));return ba}cmm(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]=
"CheckboxModel";break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(ya.a)(Sv.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]="FlyoutAnchorModel"}}TFm(b,h,n,B,L,ba,la=null){const La=[];switch(b.ControlType){case 14:A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&(B=Object(ya.a)(AK.a,b),null!=B.IsBanner&&B.IsBanner&&this.Xbo(Object(ya.a)(AK.a,b),La,h,n));break;case 1:case 3:b=Object(ya.a)(jj.a,b);this.Zbo(b,
La,h,n);b.MenuItemsStatefulData&&kh.d("setStatefulSplitButtonMenuItemsStatefulData")&&La.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(L,b.MenuItemsStatefulData));break;case 2:this.Kco(Object(ya.a)(rO.a,b),La,h,n);break;case 6:this.$bo(Object(ya.a)(YC.a,b),La,h,n);break;case 4:this.Dco(Object(ya.a)(ek,b),La,h,n);break;case 7:this.bco(Object(ya.a)(Sv.a,b),La,h,n);break;case 12:this.ico(Object(ya.a)(ZM.a,b),La,h,n);break;case 13:this.Aco(Object(ya.a)($M.a,b),La,h,n);break;case 9:b=
Object(ya.a)(Fe.a,b);this.kco(b,La,h,n);"StatefulSplitButtonModel"===ba&&B.push(b.ExternalId);break;case 8:this.qHb.oco(Object(ya.a)(fl.a,b),La,h,n,la)}return La}Xbo(b,h,n,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new nw.a(b.IconName)),n.push(appChrome.api.createLabelModel(b.ExternalId,
b.LabelText,b.Id,Object.assign(new GK,{isBanner:b.IsBanner,iconSet:h?h.iconSet:null}))))}Zbo(b,h,n,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.rSd()&&((n=this.dWa(b))&&0<n.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,
(new nw.a(n)).iconSet)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(Wb.a)(xp,b)?n.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new DK,{iconSet:(new nw.a(this.dWa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):(B=b.DismissHostingSurfaceOnExecute,n.push(appChrome.api.createButtonModel(b.ExternalId,
b.LabelText,Object.assign(new JF,{iconSet:(new nw.a(this.dWa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==B&&null!==B?B:!0})))),this.Vl.addCommandToMaps(Object.assign(new qA.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));
b.Lang&&kh.d("setControlLanguage")&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}$bo(b,h,n,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.rSd()&&((n=this.dWa(b))&&0<n.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new nw.a(n)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(n.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new BH,{iconSet:(new nw.a(this.dWa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.Vl.addCommandToMaps(Object.assign(new qA.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}ico(b,h,n,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.Label&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.Label)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new nw.a(b.IconName)),n.push(appChrome.api.createErrorViewModel(b.ExternalId,Object.assign(new EK,{label:b.Label,retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId,ariaDescription:b.AriaDescription,iconSet:h?h.iconSet:null}))))}Aco(b,h,n,B){B.push(b.ExternalId);
appChrome.selectors.isControlDefined(b.ExternalId)?(n={},b.Label&&(n.label=b.Label),b.SecondaryLabel&&(n.secondaryLabel=b.SecondaryLabel),b.Details&&(n.details=b.Details),b.Description&&(n.description=b.Description),b.iconSet&&(n.iconSet=b.iconSet),b.Links&&(n.links=b.Links),b.CommandValueId&&(n.commandValueId=b.CommandValueId),b.ActionCommandValueId&&(n.actionCommandValueId=b.ActionCommandValueId),b.ActionCommandId&&(n.actionCommandId=b.ActionCommandId),b.CommandId&&(n.commandId=b.CommandId),h.push(appChrome.actions.updateMultiActionButton(b.ExternalId,
n))):(n.push(appChrome.api.createMultiActionButtonModel(b.Id,Object.assign(new HK,{label:b.Label,secondaryLabel:b.SecondaryLabel,actionText:b.ActionText,description:b.Description,iconSet:b.iconSet,links:b.Links,details:b.Details,actionId:b.ActionId,commandId:b.CommandId,actionCommandId:b.ActionCommandId||b.ActionId,commandValueId:b.CommandValueId,actionCommandValueId:b.ActionCommandValueId||b.CommandValueId}))),b.CommandIdMapped&&this.Vl.addCommandToMaps(new qA.a(b.CommandId,b.CommandIdMapped)),b.ActionIdMapped&&
this.Vl.addCommandToMaps(new qA.a(b.ActionId,b.ActionIdMapped)))}Kco(b,h,n,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.rSd()&&((n=this.dWa(b))&&0<n.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new nw.a(n)).iconSet)),A.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(A.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?n.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new BH,{iconSet:(new nw.a(this.dWa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:b.ToggleUsingIcon}))):n.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,
Object.assign(new BH,{iconSet:(new nw.a(this.dWa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,toggleUsingIcon:b.ToggleUsingIcon}))),this.Vl.addCommandToMaps(Object.assign(new qA.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}Dco(b,h,n,B){B.push(b.ExternalId);B=this.sFm(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,
B,b.LabelText)):kh.a("createPersonaButtonModel")&&n.push(appChrome.api.createPersonaButtonModel(b.ExternalId,B,b.LabelText,Object.assign(new IK,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}kco(b,h,n,B){B.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.rSd()&&((n=this.dWa(b))&&0<n.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,
(new nw.a(n)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{B=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const L=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;n.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new FK,{iconSet:(new nw.a(this.dWa(b))).iconSet,
keytip:b.KeyTip,hideIcon:B,toggled:L,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));this.Vl.addCommandToMaps(Object.assign(new qA.a(b.ExternalId,b.Command),{queryCommandId:b.QueryCommand,populationProps:new YM.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.dKi(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}bco(b,h,n,B){b.McuLayout&&B.push(b.McuExternalId);B.push(b.ExternalId);
B=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(B=this.jKk.RHi(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(n.push(appChrome.api.createColorPickerModel(b.McuExternalId,b.Width)),this.Vl.addCommandToMaps(Object.assign(new qA.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),B=b.Width),n.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.Vl.addCommandToMaps(Object.assign(new qA.a(b.ExternalId,
b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));n=[];const L=[];for(let ba=0;ba<b.Colors.length;ba++){const la=b.Colors[ba],La=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.HighContrastColorPickerEnabled",!1)?la.Disabled:!1;ba<B?n.push(appChrome.api.colorPickerCell(la.Color,la.DisplayColor,la.Alt,La)):L.push(appChrome.api.colorPickerCell(la.Color,la.DisplayColor,la.Alt,La))}0<n.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,
n));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,L));b.SelectedColorId&&(0<n.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,b.SelectedColorId)))}dWa(b){return b.Image32by32Class?this.Vl.gyi(b.Image32by32Class):b.Image16by16Class?this.Vl.gyi(b.Image16by16Class):b.ExternalImageId}sFm(b){return b?Object.assign(new qO.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,
isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new pO.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}Awm(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}rSd(){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",!1)}static UFm(b,h){return appChrome.actions.populateFontPickerDataAsync(new Promise((n,B)=>{Ya.a.instance.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(L=>
{L.isFeatureEnabled(CK.a.yUb,!1).then(ba=>{let la=h.fonts;ba||L.isFreemiumUpsellEnabled()||(la=lf.a.tbk(la,La=>La.fontType!==CK.a.dmg));ba=Object.assign(new BK,{commandId:b.externalUxCommand,fonts:la,isSubscriber:ba,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});n(ba)}).catch(B)})}))}static SFm(b,h){const n=[];for(let B=0;B<h.MenuItems.MenuSectionList.length;B++){const L=h.MenuItems.MenuSectionList[B];L.Title&&n.push(appChrome.api.comboBoxHeader("Header-"+
B.toString(),L.Title));for(let ba=0;ba<L.ControlList.length;ba++){const la=Object(ya.a)(fx.a,L.ControlList[ba]);la&&n.push(appChrome.api.comboBoxItem(la.MenuItemId,la.LabelText,la.Styles,la.CommandValueId,la.AriaLabel,la.Data,la.Disabled))}B<h.MenuItems.MenuSectionList.length-1&&n.push(appChrome.api.comboBoxDivider("Divider-"+B.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,n)}}Object(u.a)(CH,"ReactPopulateQueryCommandPoller",null,[]);class KK{constructor(b,h,n,
B,L){this.Vl=n;this.nya=b;this.AB=h;this.S$b=B;this.qHb=L}GHm(b,h,n){const B=[];if(this.Ofn(h))b=this.FLm(b,h,n),void 0!==b&&null!==b&&B.push.apply(B,b);else if(b){var L=this.S8d(b,n);Yh.a.visible in n&&B.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!n[Yh.a.visible]));B.push(ex(b.externalUxCommand,1>(L&1)));void 0!==n[Yh.a.labelText]&&null!==n[Yh.a.labelText]&&B.push(appChrome.actions.setControlLabel(b.externalUxCommand,n[Yh.a.labelText]));void 0!==h&&null!==h&&(L=zK(b.externalUxCommand,
h,n,L),void 0!==L&&null!==L&&B.push.apply(B,L),"PeopleWell"===h&&this.oYk(b.externalUxCommand,n,B))}return B}Rqm(b,h,n){const B=[];switch(h){case "FlyoutAnchorModel":var L=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var ba=appChrome.selectors.getSplitButtonState(b);if(ba=this.Vl.getCommandByExternalUxId(ba.command))n=this.nya.Dhd(this.AB,ba.commandId,n),B.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,!n)),B.push(ex(b,!1));return B;default:return null}h=
!1;for(ba in L)if(L=this.Vl.getCommandByExternalUxId(ba),Kf.c(L))h=!0;else if(n.SourceControlId=L.externalUxCommand,this.nya.Dhd(this.AB,L.commandId,n))return B.push(ex(b,!1)),B;B.push(ex(b,!h));return B}FLm(b,h,n){switch(h){case "PreviewGalleryModel":return this.qHb.pGm(b,n);case "GalleryModel":return this.qHb.Qtm(n)}return null}Ofn(b){return"GalleryModel"===b||"PreviewGalleryModel"===b}S8d(b,h){h.MenuItemId=b.menuItemId;return this.nya.Xua(this.AB,this.S$b,b.commandId,b.queryCommandId,h)}oYk(b,
h,n){const B=h[uk.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[uk.a.LabelText];B&&0<B.length&&(h=String.format.apply(null,[h].concat(B)));n.push(this.QPm(b,h))}QPm(b,h){return appChrome.actions.updatePeopleWell(this.Klm(b),h)}Klm(b){const h=[];var n={};b=this.Vl.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.nya.Xua(this.AB,this.S$b,"1285265560",b,n);n=n.MenuItems;if(!n)return h;n=n.MenuSectionList[0];for(b=0;b<n.ControlList.length;b++){const B=n.ControlList[b],L=
{};L.name=B.Alt;L.id=B.MenuItemId;L.description=B.Description;L.color=B.ImageBackColor;L.joinTime=B.JoinTimeInMS;L.imageUrl=B.ImageUrl;L.activeStatus=B.ActiveStatus;L.isAnonymous=B.IsAnonymous;L.canJump=B.CanJump;L.upn=B.Upn;h.push(L)}return h}}Object(u.a)(KK,"ReactQueryCommandPoller",null,[]);var Yd=d(1203);class jz{constructor(b,h,n){this.Vl=b;this.AB=h;b=new Yd.a;this.MOk=new JK;this.qHb=new XM(b,this.AB,n,this.Vl);this.jBh=new CH(b,this.AB,n,this.Vl,this.qHb);this.YAh=new KK(b,this.AB,this.Vl,
n,this.qHb)}UKa(){const b=[];if(!kh.c())return b;b.push.apply(b,this.OPm());var h=this.Opm();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const n=this.Ppm();for(const B of n)b.push(appChrome.actions.updateControlEnabledDisabledState(B,!0)),delete h[B];b.push.apply(b,this.j$d(h))}return b}Ehd(b,h){kh.c()&&(b=this.j$d(b,h),appChrome.api.dispatch(b))}wlg(b,h,n=null){if(!Kf.c(b)&&b.populationProps&&!this.jBh.cWj(b)){b=this.jBh.HHm(b,h,n);if(!b.gbk){let B;
(B=b.actions).push.apply(B,this.j$d(b.X4h,kh.g(n)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}j$d(b,h=0){const n=[],B={};if(kh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var L of appChrome.selectors.getActiveGroupIds())for(var ba of appChrome.selectors.getVisibleControlsInGroup(L))B[ba]=!0;for(const la in b)L=la,ba=b[la],0===h&&B[L]&&(h=2),
n.push.apply(n,this.NPm(L,ba,h));return n}NPm(b,h,n=0){const B=[],L=this.Vl.getCommandByExternalUxId(b);let ba={};appChrome.selectors.isControlDefined(b)&&(ba=this.MOk.RHi(b,h));ba[dx.a.yfb]=n;Kf.c(L)?(ba.ExternalUxId=b,(b=this.YAh.Rqm(b,h,ba))&&0<b.length&&B.push.apply(B,b)):(ba.MenuItemId=L.menuItemId,ba.SourceControlId=b);B.push.apply(B,this.YAh.GHm(L,h,ba));return B}OPm(){const b=[],h=appChrome.selectors.getContextualTabIds(),n=appChrome.selectors.getActiveContextualTabIds();for(let L=0;L<h.length;L++){var B=
this.Vl.GOf(h[L]);B&&(B=this.AB.$La(B),0<=Array.indexOf(n,h[L])!==B&&b.push(appChrome.actions.activateDeactivateContextualTab(h[L],B)))}return b}Opm(){var b=appChrome.selectors.getSelectedTabId();const h=[],n=this.Vl.GOf(b);n&&(this.AB.$La(n)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}Ppm(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const n of b)if(b=this.Vl.hum(n))for(const B of b)this.AB.$La(B.commandId)||((b=B.externalUxCommandIds)||
(b=appChrome.selectors.getVisibleControlsInGroup(B.externalUxGroupId)),h.push.apply(h,b));return h}}Object(u.a)(jz,"ReactRibbonRootPoller",null,[1439]);class zj{constructor(b,h,n=null){this.AB=this.QGa=this.xkb=null;this.u$b=h;b.MTa(this);this.oH=n}get fua(){this.QGa||(this.QGa=new Date,this.QGa.setTime(0));return this.QGa}set fua(b){this.QGa=b}get Cca(){return 2}get oH(){return this.AB}set oH(b){this.AB=b}get $uc(){this.xkb||(this.xkb=new jz(this.u$b,this.oH,this.Cca));return this.xkb}Cnb(){const b=
document.activeElement;Lh.a.isEditable(b)&&b.blur()}executeCommand(b,h,n,B,L,ba,la,La=2){Kf.c(this.oH)||(L=new lr.a,L.CommandLocation=La,L.InvocationMethod=B,L.CommandTabName=n,h[dx.a.yfb]=La,this.oH.rVa(b,h,L,ba,la),this.gCn(b,h))}UKa(){return Kf.c(this.oH)?[]:this.$uc.UKa()}wn(){const b=this.UKa();0<b.length&&(this.fua=new Date,appChrome.api.dispatch(b))}Ftd(){kh.c()&&this.$uc.Ehd({PeopleWell:"PeopleWell"},18)}ttd(){}gCn(b,h){try{const n=Ya.a.instance.Oa("Common.ISystemInitiatedFeedback");if(n&&
h){const B=h.SourceControlId||h.launcherId||h.LegacyId||h.NewContextId;let L=(B?"_"+B:"")+(h.SqmControlId?"_"+h.SqmControlId:"");L=L.length?L:"_"+b;n.c6f("Ribbon"+L)}}catch(n){x.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(n?n.toString():""))}}}Object(u.a)(zj,"ReactRibbonRoot",null,[556,1438]);var kJ=d(1703);class LK{constructor(b){this.ddf=this.CUe=!1;this.ohb=null;this.uah=!1;this.QS=null;this.Hxa=!1;this.sWn=h=>{h.Kb&&h.Kb.target&&"input"===h.Kb.target.tagName.toLowerCase()&&
Ph.FocusManager.instance().ME("ribbon");return!1};this.X5e=b;Yg.a.instance.nb(Cd.a.nz,this.E2c(),this.sWn);(b=Ya.a.instance.Qa("Common.IActionContextProvider"))&&b.execute(h=>{this.QS=h});A.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&A.AFrameworkApplication.ua.Ib.BN?ml.a.get_instance().Lk(16,()=>{this.isReady?this.initializeContextualUI(this.E2c()):ml.a.get_instance().Lk(7,()=>{this.initializeContextualUI(this.E2c())})}):ml.a.get_instance().Lk(7,()=>{this.initializeContextualUI(this.E2c())})}get D3(){return this.Hxa}get isReady(){return A.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
A.AFrameworkApplication.ua.Ib.BN?ml.a.get_instance().isCompleted(16)&&ml.a.get_instance().isCompleted(7):ml.a.get_instance().isCompleted(7)}Ykl(){if(this.uah)return!0;try{return Promise.resolve(null),this.uah=!0}catch(b){return!1}}eLg(b){if(!this.isReady||this.ddf)return this.a7f("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.Ykl())return this.a7f("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(A.AFrameworkApplication.o0d||""!==A.AFrameworkApplication.$u)if(!A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",
!1)||"DocGen"===A.AFrameworkApplication.$u||"ContentAssemblyView"===A.AFrameworkApplication.$u)return this.a7f("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.ddf=!0;let h=Pa.a.Vg;switch(b){case 1:h=Pa.a.showContextMenu;break;case 0:h=Pa.a.showFloatie;break;case 2:h=Pa.a.Yxc}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.ddf=!1;Pe.c(h)},0)});return!1}wKi(b){return Wk.UISurfaces.Y8a().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=
h.getBlockedSmallScreenFloatieGroupList();const n=[];for(const B of b)Array.contains(h,B)||n.push(B);return n}return b})}showFloatie(b,h,n,B=null){this.eLg(0)||this.wKi(h).then(L=>{if(0>=L.length)return null;this.DBg(L).then(()=>{const ba={};ba.target=b;Wk.UISurfaces.Y8a().then(la=>{appChrome.api.dispatch(la.showFloatie(ba,n,void 0,this.OLf(),B));this.Hxa=!0;A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&A.AFrameworkApplication.va&&
A.AFrameworkApplication.va.Ob(Pa.a.o$i,2);return null})});return null})}showContextMenu(b,h,n=null,B=null){this.eLg(1)||this.ZTj(b,h,n,B)}ZTj(b,h,n=null,B=null){this.DBg(null).then(()=>{const L={};L.target=b;B&&(L.directionalHint=B);Wk.UISurfaces.Y8a().then(ba=>{appChrome.api.dispatch(ba.showContextMenu(L,h,n,void 0,this.OLf()));return null})})}Xxc(b,h,n,B=null){this.eLg(2)||this.wKi(h).then(L=>{0>=L.length?this.ZTj(b,n,B):this.DBg(L).then(()=>{const ba={};ba.target=b;const la={};la.target=b;Wk.UISurfaces.Y8a().then(La=>
{appChrome.api.dispatch(La.showContextualUI(ba,la,n,void 0,B,this.OLf()));this.Hxa=!0;return null})});return null})}a7f(b){x.ULS.sendTraceTag(561394519,340,15,b)}iyf(){this.isReady&&Wk.UISurfaces.isLoaded()&&Wk.UISurfaces.Y8a().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}dismissFloatie(){this.isReady&&Wk.UISurfaces.isLoaded()&&Wk.UISurfaces.Y8a().then(b=>{this.Hxa=!1;appChrome.api.dispatch(b.hideFloatie());return null})}tZc(){this.isReady&&Wk.UISurfaces.isLoaded()&&Wk.UISurfaces.Y8a().then(b=>
{appChrome.api.dispatch(b.hideContextualUI());this.Hxa=!1;return null})}initializeContextualUI(b){return Wk.UISurfaces.Y8a().then(h=>{this.CUe||(h.initializeContextualUI(b),this.CUe=!0);return null})}DBg(b){if(!this.CUe)return this.initializeContextualUI(this.E2c()).then(()=>{this.setActiveFloatieGroups(b);return null});this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);
var n=[];Wk.UISurfaces.Y8a().then(B=>{n.push.apply(n,this.X5e.$uc.j$d(B.selectors.getFloatieOnlyControlsMap(),9));0<n.length&&appChrome.api.dispatch(n);return null})}}E2c(){if(this.ohb)return this.ohb;this.ohb=kJ.a("div");this.ohb.id="ReactContextualUIDiv";this.ohb.style.position="absolute";this.ohb.style.zIndex="1001";document.body.insertBefore(this.ohb,document.body.firstChild);return this.ohb}OLf(){return this.QS?this.QS.contentType:"Unknown"}}Object(u.a)(LK,"ReactContextualUILauncher",null,[1440]);
class lJ extends br.a{constructor(){super()}}Object(u.a)(lJ,"FloatieBuildOptions",br.a,[]);class DH extends Vx.a{constructor(){super()}}Object(u.a)(DH,"FloatieBuildContext",Vx.a,[]);var sO=d(694);class MK extends kg.Builder{constructor(b,h,n){super(b,h,n,null);this.K1n=B=>{this.Qfl(B.Oid,B.TWc);this.sR.Ppi=this;this.sR.xn();this.sR.Qc.style.display="none";this.placeholder.appendChild(this.sR.Qc);this.Eza.continueWith(()=>{this.Eza.result.qWb(this.sR)},11);ul.a.instance.nb(Cd.a.nt,this.sR.Qc,Object(z.a)(this.sR,
this.sR.zE,"onPointerDown"))};if(Kf.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get sR(){return this.root}g_o(b){this.root=b}Pfl(){const b=new DH,h=new bA.a;h.sjd=1;h.handler=this.K1n;h.data=b;this.uAa.ewe(h)}Qfl(b,h){b=xj.a.gla(b,xj.a.Rfk);if(Kf.c(b))throw Error.create("No floatie element was present in the data");b=new xj.a(b);this.g_o(new Rp(b.attributes[xj.a.id],b.attributes));b=xj.a.gla(b.node,xj.a.WHe);this.vmf(b,h)}vmf(b,h){b=xj.a.Dx(b);for(let n=0;n<b.length;n++){if(this.GXa(b[n]))continue;
const B=this.Bmf(b[n],h);this.sR.Uf(B)}}Bmf(b,h){var n=new xj.a(b);b=new sO.Group(this.sR,n.attributes[xj.a.id],n.attributes[xj.a.r1a],n.attributes[xj.a.lCc],n.attributes[xj.a.m1a],!1,n.name===xj.a.Mjk,!1,n.attributes);n=xj.a.Dx(n.node);for(let B=0;B<n.length;B++)b.Uf(this.pUd(n[B],h));return b}pUd(b,h){b=new xj.a(b);var n=b.attributes[xj.a.id];b=xj.a.Dx(b.node);var B=2;2===b.length&&(B=3);n=new km.a(this.sR,n,B,2,1);for(B=0;B<b.length;B++){const ba=new xj.a(b[B]);var L=xj.a.gla(ba.node,xj.a.RAb);
L=xj.a.Dx(L);this.Imf(n.k9d(B+1),L,ba.attributes[xj.a.id],h)}return n}Imf(b,h,n,B){for(n=0;n<h.length;n++){if(this.GXa(h[n]))continue;const L=new xj.a(h[n]),ba=this.Tja(h[n],B);ba&&b.Uf(ba.PW(L.attributes[xj.a.mCc]))}}}Object(u.a)(MK,"FloatieBuilder",kg.Builder,[]);class LF{constructor(b,h){this.yw=null;this.vvl=b;this.WOe=h;this.RXn=this.Xme.bind(this)}get sR(){return this.yw}Enb(b,h,n){h=new Kl.a(sk.a.v6a,Box4Intl.Box4Strings,null,null,h);const B=new lJ;B.eJ=n||{};B.eJ.floatieshadingColor=!1;const L=
new MK(B,document.body,this.vvl.kIj);L.uAa=new WC.a(b,h);L.Pfl();this.WOe.execute(ba=>{L.sR.oH=ba});L.sR.Uuo(this.RXn);L.sR.cuo(()=>[]);this.yw=L.sR;return this.sR}}Object(u.a)(LF,"AFloatieInitializer",null,[]);class NK extends LF{constructor(b,h,n,B){super(h,n);this.nlg=()=>{this.sR.wn()};this.gi=b;this.SK=B}Enb(b,h,n){if(b=super.Enb(b,h,n))b.suc=!0,b.fre=!0,b.preventDismissOnScroll=!0;this.gi.$5a(this.nlg);return b}K7c(b,h,n=null){this.SK.qWh(()=>this.Enb(b,h,n))}Xme(){this.sR.suc=!0}}Object(u.a)(NK,
"PasteFloatieInitializer",LF,[]);var OK=d(871);class pw{BEa(b,h){this.yll&&this.P5o(b,h,pw.S8f,pw.currentSelection)}P5o(b,h,n,B){switch(n){case 1:case 6:case 2:case 3:case 4:pw.Tzf.show(B,b,h)}}Kdj(){switch(pw.S8f){case 5:case 1:return!0;default:return!1}}rMl(){return pw.S8f}get yll(){return 1!==Ua.StaticActiveAppFrame.za().state}static get Tzf(){return null!=pw.RVg?pw.RVg:pw.RVg=Ya.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static Fzm(b){if(!b)return 0;if(2===Ua.StaticActiveAppFrame.za().mode){const h=
b.Ra.node,n=ve.GraphIterator.eb(h);n.tq();return Ok.e(n.currentNode)?2:A.AFrameworkApplication.V2b||!Lu.isEmbeddedFileNode(h)||Lu.isInvalid(h)?Ve.a.qkn(b.Ra)||Ve.a.eZf(b.Ra)?6:1:3}return 4}static get currentSelection(){return Zb.a.instance.gb.currentSelection}static get S8f(){return pw.Fzm(pw.currentSelection)}}Object(u.a)(pw,"SelectionContextMenuProvider",null,[1755]);var MH=d(1964);class NH{constructor(b,h){this.fre=this.suc=!1;this.g6c=!0;this.kO=b;this.Vl=h}get isVisible(){return this.kO.D3}get controls(){return null}dismissFloatie(){this.kO.dismissFloatie();
return!0}kBf(){}xeb(b,h,n,B,L=null){this.kO.showFloatie(Object.assign(new MH.a,{x:b.x,y:b.y}),this.NGf(n),n,L)}KPb(){return new Sys.UI.Bounds(0,0,0,0)}Y6(){return this.dismissFloatie()}NGf(){return[]}}Object(u.a)(NH,"ReactFloatie",null,[243,244]);class PK{constructor(b){this.qzd=null;this.kO=b}dispose(){}Y6(){this.kO.tZc();return!0}showContextMenu(b,h){this.J0b(b,h.clientPoint,h.Ag)}J0b(b,h,n){this.ueb(b,new Sys.UI.Bounds(h.x,h.y,0,0),n);x.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",
b)}ueb(b,h,n,B=null){this.qzd?this.kO.Xxc(Object.assign(new MH.a,{x:h.x,y:h.y}),this.qzd.NGf(n),n,b):this.kO.showContextMenu(Object.assign(new MH.a,{x:h.x,y:h.y}),n,b,B);this.qzd=null}Yxc(b,h,n,B){this.qzd=Object(ya.a)(NH,n);B.BEa(b,h);return!0}}Object(u.a)(PK,"ReactContextMenuController",null,[549,13]);var dN=d(501);class rJ{constructor(){this.wna=this.text=this.yta=null}}Object(u.a)(rJ,"BusinessBarButtonData",null,[]);class OH{constructor(){this.text=this.yta=null}}Object(u.a)(OH,"BusinessBarLinkData",
null,[]);var zn=d(556),EI=d(261);class hK{constructor(b,h,n,B){this.Thh=this.efh=this.Shb=this.bdh=null;this.St=b;this.Lwa=h;this.ga=n;this.Ga=B}Ikg(){this.jVc();this.kVc();this.Sec()}kVc(){}jVc(){const b=Ua.StaticActiveAppFrame.za().ib.$c;b&&(this.bdh=this.Mfb(this.bdh,1,2===Ua.StaticActiveAppFrame.za().mode&&b.fYf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}u4i(){return A.AFrameworkApplication.ua&&1===A.AFrameworkApplication.ua.mode}Sec(){let b=null;if(10<=$e.App.jf.aO){if($e.App.jf.dda.EWa){var h=
$e.App.jf.vGb;EI.a.GSb(h)?22===h?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===h||20===h?b=X.a.Di?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===h?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===h?b=X.a.Di?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===h&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):EI.a.WSf($e.App.jf.dda.Gea)||$e.App.pn||this.u4i()||
(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}}else if(h=Ua.StaticActiveAppFrame.za().ib.activeSection){const n=h.tgd;EI.a.GSb(n)?22===n?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===n||20===n?b=X.a.Di?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===n?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===n?b=X.a.Di?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===n&&(b=
Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):EI.a.WSf(h.L5a)||$e.App.pn||this.u4i()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.Thh=this.Mfb(this.Thh,5,!!b,b)}rUj(b,h,n,B){b=this.Lwa.create(null,b,null);b.closeable=!0;b.id=23;b.image=3;b.mRd(h,()=>{$c.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+n)});B&&(b.aka=B);this.St.Uy(b,!0)}F6o(b,h,n){this.rUj(b,h,n,null)}Q6o(b){b=this.Lwa.create(null,b,null);b.closeable=!0;b.id=20;this.St.Uy(b)}Z5o(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,
h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.Shb||(this.Shb=this.Lwa.create(b,h,null),this.Shb.closeable=!0,this.Shb.id=27,this.St.Uy(this.Shb))}Z_m(){this.Shb&&(this.Shb=this.Mfb(this.Shb,27,!1,""))}sDg(b){this.efh=this.Mfb(this.efh,30,!0,b)}Mfb(b,h,n,B,L=!1,ba="",la=null,La=null,fb=null){n?b?b.message=B:(b=this.Lwa.create(ba,B,null),b.id=h,b.closeable=L,la&&b.addButton(la.text,la.yta,la.wna),La&&b.mRd(La.text,La.yta),fb&&(b.aka=fb),this.St.Uy(b,!1)):b&&(this.St.removeEntry(b),
b=null);return b}Fef(b){this.St.Uy(b,void 0)}}Object(u.a)(hK,"BusinessBarController",null,[211]);class nC extends hK{constructor(b,h,n,B){super(b,h,n,B);this.Nxa=null}gLf(b,h,n=null,B=null,L=null,ba=2){if(this.Nxa)return null;this.Nxa=this.Lwa.create(h,n||"",null);this.Nxa.id=6;this.Nxa.image=ba;this.Nxa.e$c=!1;b&&(this.Nxa.errorCode=b);this.Nxa.closeable=!1;h=A.AFrameworkApplication.sH&&this.Ga.$("ShowFeedbackButtonOnKickoutBusinessBar");B?(this.Nxa.addButton(B,L,""),h&&this.Nxa.LOh(WoncaIntl.WoncaStrings.L_GiveFeedback,
()=>{this.jLi(b)})):h&&this.Nxa.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.jLi(b)},"");this.St.Uy(this.Nxa,void 0,null,null,null);return this.Nxa}jLi(b){x.ULS.sendTraceTag(36471966,338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Pb(Pa.a.vla,2,{["ErrorCode"]:b})}static get $i(){return Gm.PageReader.instance}}Object(u.a)(nC,"BusinessBarController",hK,[210,211]);class oC{static get Aij(){const b=F.a.ej(hj.a.Cg(A.AFrameworkApplication.lcid).name);return oC.nnn?String.format("https://support.office.com/{0}/client/results?Shownav=true&lcid=1033&ns=WDWAEndUser&version=15&omkt={0}&ver=15&apps=WDWAENDUSER%2CXLWAENDUSER%2CPPWAENDUSER%2CONWAENDUSER&HelpID=WordODF",
b):String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}static get nnn(){if(null!=oC.o0g)var b=oC.o0g;else{var h;A.AFrameworkApplication.Ld("d932d186;491d2669");b=null===(h=A.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.OdtDialogLearnMoreUrlChangeEnabled",!1);b=oC.o0g=b}return b}}Object(u.a)(oC,"OdtUtils",null,[]);class YD extends nC{constructor(b,h,n,B){super(b,h,n,B);this.jGb=this.TBb=this.nIc=this.quh=this.ETa=
this.wuh=this.LFh=null;this.CDk="https://go.microsoft.com/fwlink/?linkid=2134357"}Ikg(){super.Ikg();this.upl();this.Rpl()}kVc(){const b=Ua.StaticActiveAppFrame.za().ib.$c;if(b){var h=$e.App.K3;if($e.App.Et||$e.App.pn||h&&A.AFrameworkApplication.nw)this.LFh=this.Mfb(this.LFh,4,nC.$i.Jab(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.wuh=this.Mfb(this.wuh,3,nC.$i.uab(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.quh=this.Mfb(this.quh,8,nC.$i.rzl(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,
!0),nC.$i.RTb(b)?this.ETa||(this.ETa=this.Lwa.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.ETa.id=14,this.ETa.closeable=!0,this.ETa.image=3,this.ETa.addButton(Box4Intl.Box4Strings.L_LearnMore,zn.a.gyn,""),this.St.Uy(this.ETa,!1)):this.ETa&&(this.St.removeEntry(this.ETa),this.ETa=null)}}upl(){if(Eh.a.j$c){const b=oC.Aij,h=this.Lwa.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,
null);h.id=9;h.closeable=!0;h.tXk(b);this.St.Uy(h,!0)}}get dtn(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",!1)?X.a.etn:!1}Rpl(){this.dtn&&!this.jGb&&(this.jGb=this.Lwa.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.jGb.id=15,this.jGb.closeable=!0,this.jGb.e$c=!1,this.jGb.addButton(Box4Intl.Box4Strings.L_DownloadNow,zn.a.mtp,""),this.St.Uy(this.jGb,!1))}G6o(b,h){if(Ua.StaticActiveAppFrame.za().ib.$c){const n=
new rJ;n.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;n.yta=()=>{b()};const B=new OH;B.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;B.yta=()=>{$c.a.openWindow(4,A.AFrameworkApplication.privacyUrl)};this.nIc=this.Mfb(this.nIc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,n,B,()=>{h()})}}g0m(){this.nIc&&(this.nIc=this.Mfb(this.nIc,25,!1,""))}H5o(){if(Ua.StaticActiveAppFrame.za().ib.$c){const b=
new OH;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.yta=()=>{$c.a.openWindow(4,this.CDk)};this.TBb||(this.TBb=this.Lwa.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.TBb.id=32,this.TBb.closeable=!0,this.TBb.image=3,this.TBb.mRd(b.text,b.yta),this.St.Uy(this.TBb,!1))}}C3(b){return this.St.C3(b)}Uy(b,h){this.St.Uy(b,h)}}Object(u.a)(YD,"BusinessBarController",nC,[209,210,211]);class AI{constructor(){this.menuTargetType=
null}}Object(u.a)(AI,"MenuTargetDescriptor",null,[]);class zv{static get Aaa(){return null!=zv.fVg?zv.fVg:zv.fVg=Ya.a.instance.resolve("Box4.IContextMenuController")}static showContextMenu(b,h){zv.Aaa.showContextMenu(b,h)}static J0b(b,h,n){zv.Aaa.J0b(b,h,n)}static ueb(b,h,n,B=null){zv.Aaa.ueb(b,h,n,B)}}Object(u.a)(zv,"BaseContextMenu",null,[]);class Mj extends zv{constructor(b,h,n,B=!1,L,ba=null,la){super();this.Rtj=(La,fb,Cb,Lb,$b)=>{if(1===Cb)return 32;La=$b.iz;$b=$b.rd;fb=Object.assign(new vh.a,
{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.vHl(fb,La,$b.IsShadowMenuOpen);$b.MenuItems=fb;return 32};this.tio=h;this.so=n;this.$kb=ba;this.kYe=B;this.Wb(b);this.Mgb=la;Mj.Y4a[1]=wb.a.QAe;Mj.Y4a[2]=wb.a.C$d;Mj.Y4a[3]=wb.a.uBe}get eZl(){return dp.a.OZd}get dZl(){return dp.a.hYd}get fZl(){return dp.a.hhd}get Rzf(){return dp.a.bkg}Wb(b){b.fb(wb.a.zlg,oc.a.application,this.Rtj,96);b.fb(wb.a.Ttj,oc.a.application,this.Rtj,96)}show(b,h,n){let B=null,L=new Sys.UI.Bounds(0,0,0,
0);const ba=this.TGm(b);if(ba&&(b=b.Ra.node)&&(b=b.ue(Object(Pb.a)().zd.oc))){L=Jy.a.Jr(b,ba.end);if(A.AFrameworkApplication.isRtl&&L.x>h.x||!A.AFrameworkApplication.isRtl&&L.x+L.width<h.x||L.y+L.height<h.y)L=Jy.a.Jr(b,ba.end-1);h.x=L.x+(A.AFrameworkApplication.isRtl?0:L.width);h.y=L.y+L.height;B=6}zv.ueb("ContextMenu",new Sys.UI.Bounds(h.x,h.y,L.width,L.height),n,B)}q3(b,h){return this.Ypd(b)||Mj.Pec(wb.a.mergeCells)||Mj.Pec(wb.a.KOa)||this.gEg(b)||this.UTj(b,h)||Mj.IUj()||Mj.wUj(b).returnValue}Ypd(b){return 2===
Ua.StaticActiveAppFrame.za().mode&&this.a$c(b)}$Xc(b,h,n=null){if(Ju.qD()&&2===Ua.StaticActiveAppFrame.za().mode){h=this.Mgb.k8h(b.Ra);if(!h||!this.Wpn()&&!this.xrn(h.errorDetails))return;h=h.errorDetails}else{if(!this.Ypd(b))return;h=this.wFi(b)}var B=hj.a.Cg(h.lcid);const L=B?B.name:"UNKNOWN";B=Object(Wb.a)(pq.a,h)?h.typeId:"";x.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,B,L);if(b=this.tio.bgc(b,h))n.push.apply(n,
b),this.CFn(h,B)}xrn(b){return b&&(1===b.proofingType||2===b.proofingType)}Wpn(){A.AFrameworkApplication.Ld("gec07842;ae49c383");return!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",!1)}CFn(b,h){const n=Mj.Y4a[b.proofingType];n&&(A.AFrameworkApplication.va.Ob(n,2),x.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",n,h,b.proofingType,Ju.qD()))}wFi(b){return this.so.Isa(b.Ra).errorDetails}a$c(b){return this.so.Pwe(b)}Xjc(){return null}GYd(){}TGm(b){return this.a$c(b)?
this.so.Isa(b.Ra):(b=this.Xjc(b))?new zb.a(b.fw,b.cpEnd):null}gEg(b){if(2!==Ua.StaticActiveAppFrame.za().mode||!b)return!1;b=Uz.a.uJa(b.toArray());return!!Object(el.a)().EW(b,14)}jVj(b,h){return 2===h||3===h&&!this.a$c(b)}UTj(b,h){return 3!==h||this.a$c(b)}YDl(){const b=[];b.push(Object.assign(new jj.a,{ExternalId:this.eZl}));b.push(Object.assign(new jj.a,{ExternalId:this.dZl}));b.push(Object.assign(new jj.a,{ExternalId:this.fZl}));return b}CIl(){const b=[];this.kYe&&b.push(Object.assign(new jj.a,
{ExternalId:this.Rzf}));return b}static get Nd(){return null!=Mj.p1g?Mj.p1g:Mj.p1g=Ya.a.instance.resolve("Box4.List.IListReader")}static get pkn(){null==Mj.GXe&&(Mj.GXe=A.AFrameworkApplication.K?A.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return Mj.GXe}static get Xdd(){null==Mj.bBb&&(Mj.bBb=A.AFrameworkApplication.K?A.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return Mj.bBb}static get eza(){null==Mj.mda&&(Mj.mda=A.AFrameworkApplication.K?A.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):
!1);return Mj.mda}static Pec(b){return 32===A.AFrameworkApplication.va.Ob(b,1)}static IUj(){return 2===Ua.StaticActiveAppFrame.za().mode&&!!$e.App.Ew.kL&&$e.App.Ew.kL.P$c(wb.a.Uoe.toString())}static KUj(b){if(1!==b.length||!b.Ra.Gl)return!1;b=ve.GraphIterator.eb(b.Ra.node);b.zb(11);b.uc();return b.fv(4)&&!Mj.Nd.Nw(b).listType?!0:!1}static wUj(b){let h=!1,n=!1;if(!b)return{returnValue:!1,Nrb:h,N6c:n};if(Mj.Xdd)return Mj.P6o(b,n);if(!(b.ly||Mj.pkn&&2===b.length&&b.Uc.contextId===oc.a.Vc))return{returnValue:!1,
Nrb:h,N6c:n};b=b.Ra.clone();h=32===A.AFrameworkApplication.va.lg(b,wb.a.mcb,1,!0,null,null);n=32===A.AFrameworkApplication.va.lg(b,wb.a.QR,1,!0,null,null);return{returnValue:h||n,Nrb:h,N6c:n}}static P6o(b,h){let n;h=b.Ra.clone();n=Mj.eza&&tn.l(h);let B=!n&&32===A.AFrameworkApplication.va.lg(h,wb.a.mcb,1,!0,null,null);if(b.ly||2===b.length&&b.Uc.contextId===oc.a.Vc)h=!n&&32===A.AFrameworkApplication.va.lg(h,wb.a.QR,1,!0,null,null);else{h=!0;const L=b.length;for(let ba=0;ba<L;ba++){const la=b.J(ba).clone();
if(la.contextId===oc.a.paragraph||la.contextId===oc.a.Bd)(n=Mj.eza&&tn.l(la))||(h=32===A.AFrameworkApplication.va.lg(la,wb.a.QR,1,!0,null,null)&&h);else if(la.contextId!==oc.a.Vc)return h=B=!1,{returnValue:!1,Nrb:B,N6c:h}}}return{returnValue:B||h,Nrb:B,N6c:h}}static qCi(b){const h=Object.assign(new te.a,{ControlList:[]});for(const n of b)h.ControlList.push(Object.assign(new jj.a,{ExternalId:n}));return h}static rE(b){const h=[];for(const n of b)h.push(Object.assign(new jj.a,{ExternalId:n}));return h}}
Mj.GXe=null;Mj.bBb=null;Mj.mda=null;Mj.Y4a=[];Object(u.a)(Mj,"AEditSurfaceContextMenu",zv,[]);var TM=d(760),nO=d(936),Av=d(1884),Vh=d(933);class Dr{static cGm(b,h,n){h=[];n.Ueo.bgc(n.jhm(b),h);return h}static Hpm(b,h,n){const B=[];if(n.Ypd(b))return B;mn.a.ULa&&!X.a.Mt||n.Exf.GYd(b,null,h,B);return B}static oLm(b,h,n){const B=[];n.$Xc(b,h,B);return B}}Object(u.a)(Dr,"ContextMenuSectionHelper",null,[]);var qx=d(2185);class Hl{static upm(b,h,n){h=[];n.sSl(b)&&h.push(Object.assign(new jj.a,{ExternalId:"ReviewDesignerSuggestion",
LabelText:n.qIm(b)}));return h}static Nzm(){return Mj.Pec(wb.a.mergeCells)?Mj.rE(["MergeCells"]):Mj.Pec(wb.a.VAe)?Mj.rE(["SplitCells"]):[]}static mNm(){return Mj.Pec(wb.a.HAe)&&(A.AFrameworkApplication.Ld("4aah1391;h7hg6461"),A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableSortInContextMenuEnabled",!1))?Mj.rE(["Sort"]):[]}static TOm(b,h,n){h=[];if(!n.Vh.S6h(b))return h;b=n.Vh.KJi(b);h.push(Object.assign(new jj.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,
WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));h.push(Object.assign(new jj.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_RejectChange,b)}));return h}static wkm(b,h,n){return A.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&b&&b.Ra&&b.Ra.node&&n.Ec&&n.Ec.shj(b.Ra.node)?Mj.rE(["ShowCatchUpActivitiesForParagraph"]):[]}static oqm(b){return oo.d6o(b)?Mj.rE(["Draw"]):oo.AUj(b)?
Mj.rE(["EditIllustration"]):[]}static QRm(b){return oo.H8o(b)?[Object.assign(new Fe.a,{ExternalId:"WrapTextMenu"})]:[]}static a9d(b,h,n){return n.LSl(b)?Mj.rE(["CreatePullQuote"]):[]}static getContentControls(b,h,n){return n.rSl()?Mj.rE(["RemoveContentControl"]):[]}static imm(){return Mj.rE(["NewComment"])}static Skm(b){const h=[];!oo.fEg(b)&&oo.IDg(b)&&hc.SessionStatusManager.instance.ZA&&b.PL&&h.push(Object.assign(new Fe.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));
return h}static Hwm(b,h,n){h=[];!oo.fEg(b)&&oo.IDg(b)&&hc.SessionStatusManager.instance.ZA&&(x.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.PL&&!A.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?h.push(...Mj.rE(["ChangePicture"])):h.push(...n.DGl().ControlList),(b=oo.JAi())&&0<b.length&&(n=n.sKl(b),null!=n&&h.push(...n.ControlList)));return h}static QGm(){return Mj.IUj()?Mj.rE(["SetProofingLanguage"]):[]}static zIm(b,h,n){return n.Vpn&&n.O7o(b)?Mj.rE(["Rewrite"]):
[]}static rym(b){return Mj.KUj(b)?Mj.rE(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static BEm(){return oo.XUj()?Mj.rE(["ParagraphOptions"]):[]}static zvm(b){return oo.AUj(b)?Mj.rE(["EditIllustration"]):[]}static fLm(b){return oo.fEg(b)?Mj.rE(["ShowSmartLookupPane"]):[]}static cPm(b){return oo.NUj(b)?Mj.rE(["ModernTranslatorSplitButton"]):[]}static Ium(b,h,n){h=[];if(b.ly){const B=b.Ra;if(B.contextId===oc.a.paragraph||B.contextId===oc.a.Xc||B.contextId===oc.a.Bd){b=b.Ra.node;if(!n.Dg.Xb(b)||
b.Gs||""===b.characterData)return h;n.czf.h7d(b)&&h.push(...Mj.rE(["CreateHeadingLink"]))}}return h}static getBookmark(b,h,n){h=[];if(b.ly){const B=b.Ra;(re.SelectionEditor.mf(B)||re.SelectionEditor.P$a(B))&&n.ydl.G6d(b.Ra.node,b.Ra.cpBegin)&&(h.push(...Mj.rE(["DeleteBookmarkContextMenu"])),h.push(...Mj.rE(["EditBookmarkNameContextMenu"])))}return h}static ila(b){let h=!1,n=!1;const B=[];({Nrb:h,N6c:n}=Mj.wUj(b)).returnValue&&(h?n?B.push(...Mj.rE(["EditHyperlink","SelectHyperlink","OpenHyperlink",
"CopyHyperlink","RemoveHyperlink"])):B.push(...Mj.rE(["OpenHyperlink"])):n&&(A.AFrameworkApplication.K.$("IsO365CommercialHost")||A.AFrameworkApplication.K.$("IsO365ConsumerHost")?B.push(...Mj.rE(["InsertLinkFlyout"])):B.push(...Mj.rE(["InsertLink"]))));return B}static Elm(b,h,n){const B=[];if(!n.UTj(b,h))return B;2===Ua.StaticActiveAppFrame.za().mode?(B.push(...n.YDl()),B.push(...n.CIl()),3===h&&n.a$c(b)&&B.push(Object.assign(new jj.a,{ExternalId:"Delete"}))):(!A.AFrameworkApplication.O0&&!A.AFrameworkApplication.lH||
A.AFrameworkApplication.UNb)&&B.push(Object.assign(new jj.a,{ExternalId:"Copy"}));return B}static eHf(b,h,n){return n.gEg(b)&&n.jVj(b,h)?Mj.rE(["EditTableAltText"]):[]}static NAi(b,h,n){return n.CSl(b)?Mj.rE(["ShowIntentSuggestion"]):[]}static ZMm(b,h,n){const B=[];n.gEg(b)&&!n.jVj(b,h)&&(B.push(Object.assign(new Fe.a,{ExternalId:"InsertTableMenu"})),B.push(Object.assign(new Fe.a,{ExternalId:"DeleteTableMenu"})),B.push(Object.assign(new Fe.a,{ExternalId:"SelectTableMenu"})));return B}static eNm(b,
h,n){return n.j8o(b)?Mj.rE(["UpdateTableOfContents"]):[]}static frm(b){return oo.k6o(b)?Mj.rE(["ShowHideEquationToolsPane"]):[]}static Cnm(b,h,n){switch(n.tUk){case qx.a.blankDocument:case qx.a.blankLine:return Mj.rE(["OpenCopilotComposeDraftContent"]);case qx.a.selection:return Mj.rE(["OpenCopilotComposeRewrite"]);default:return[]}}}Object(u.a)(Hl,"ContextMenuSectionItemHelper",null,[]);class oo extends Mj{get Dg(){return this.jb}get czf(){return this.w2a}constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,
$b,tc,Nc,dd,Hd,xe,je,he=!1,fe=null,De=null,gg,eg,vl,wl){super(b,h,n,he,void 0,fe,gg);this.E_d=wl;this.b5e=this.QS=null;this.cXe=this.clh=!1;this.Bwe=new Map;this.KD={};this.Nub={};this.ga=b;this.K=B;this.Vh=L;this.EZ=La;this.WK=fb;this.Yn=Cb;this.ZRk=!!fe;this.Exf=Lb;this.Ueo=$b;this.Neh=Hd;this.Zoa=xe;this.ydl=je;this.w2a=vl;this.jb=eg;dd&&dd.execute(Sm=>{this.LDh=Sm});tc&&tc.execute(Sm=>{this.b5e=Sm});this.Ec=la;this.tu=Nc;De&&De.execute(Sm=>{this.QS=Sm});this.s5m();this.Hco();this.I6l();this.z6l().catch(()=>
{x.ULS.sendTraceTag(508679947,3048,50,"Fetching copilot state for context menu failed.")});this.Gco()}get Rzf(){return this.ZRk?dp.a.fhd:super.Rzf}b4o(){const b=Eh.a.en.ib.sc.lb.gb.currentSelection;return this.Ypd(b)&&2!==this.wFi(b).errorType}q3(b,h){return super.q3(b,h)||oo.XUj()||Mj.KUj(b)||oo.IDg(b)||oo.NUj(b)}vHl(b,h,n){const B=[];let L=null;try{L=Eh.a.en.ib.sc.lb.gb.currentSelection}catch(ba){x.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");
return}this.vco(L,h,B,this.qnm(L));b.MenuSectionList.push(...B);this.BVo(b);!n&&this.LDh&&this.LDh.Mgo(b.MenuTargetDescriptor.menuTargetType,B)}qnm(b){return Mj.Pec(wb.a.mergeCells)?As.GSg:b.u9c?As.RQg:b.PL?As.SRg:b.mpc()?As.JQg:b.qXa?As.CQg:As.WQg}EGl(b){b=oo.SGl(b);return Object.assign(new jj.a,{ExternalId:"SmartLookupContextMenu",LabelText:b})}tKl(b){return(b=oo.Nek(b))?Object.assign(new jj.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}DGl(){const b=Object.assign(new te.a,{ControlList:[]}),
h=oo.JAi();b.ControlList.push(this.EGl(h));return b}sKl(b){const h=Object.assign(new te.a,{ControlList:[]});if(b&&0<b.length){b=this.tKl(b);if(null==b)return null;h.ControlList.push(b)}return h}Lpc(b){return b.PL||2<b.length||!b.length||2===b.length&&!re.SelectionEditor.gl(b.Uc)||1===b.length&&re.SelectionEditor.gl(b.Uc)?!1:this.W1f(b.Ra)}W1f(b){return ea.ParagraphReader.Xb(b.node)?""!==ea.ParagraphReader.text(b.node).trim():!1}j8o(b){var h=ve.GraphIterator.eb(b.Ra.node);h=Object(ya.a)(TM.a,h.currentNode);
return b.PL?!1:!!h&&h.Gs}I6l(){this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.tu.execute(b=>{b.isFeatureEnabled(nO.a.Ggj,!1).then(h=>{h||x.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.clh=h;return null})}):x.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}async z6l(){x.ULS.sendTraceTag(508679949,3048,50,"Fetching copilot state for context menu.");
this.cXe=await (await Object(Vh.c)(this.SBl)).isEnabled();x.ULS.sendTraceTag(508679948,3048,50,`Fetching copilot state for context menu complete. Enabled: ${this.cXe}`)}get Vpn(){return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.clh&&!this.cXe:!1}O7o(b){if(!this.Lpc(b)||b.qXa||b.mpc())return!1;b=b.Ra;if(ea.ParagraphReader.nn(b)||re.SelectionEditor.mf(b)||re.SelectionEditor.am(b)){b=this.WK.oBa(b);b||(b=A.AFrameworkApplication.lcid);
switch(b&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}CSl(b){if(1!==b.length||X.a.Mt)return!1;const h=mn.a.ULa;if(h&&this.b4o()||Ju.qD()&&!this.Mgb.k8h(b.Ra))return!1;const n=oo.rc.isFeatureEnabled(58);return b.J(0).contextId===oc.a.Xc&&(h||n)&&0<this.Yn.G3c(b.J(0),0).count||h&&this.Xjc(b)?!0:!1}sSl(b){return 1===b.length&&this.Neh.YB(b.Ra.node).Ula}qIm(b){var h,n;const B=null===(h=this.E_d)||void 0===
h?void 0:h.lX(null===(n=null===b||void 0===b?void 0:b.Ra)||void 0===n?void 0:n.node);return Av.a.EJi(B)}get Lw(){return null!=this.CVg?this.CVg:this.CVg=Ya.a.instance.Oa("WordEditor.Designer.IDesignerTaskPane")}get TBl(){return null!=this.iVg?this.iVg:this.iVg=Ya.a.instance.Oa("WordEditor.Copilot.Compose.CopilotComposeIndicatorActor")}get SBl(){return null!=this.hVg?this.hVg:this.hVg=Ya.a.instance.Qa("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition")}LSl(b){if(!this.Zoa.xXi()||!this.Lw||
this.Lw.isVisible||!(1===b.length||2===b.length&&re.SelectionEditor.gl(b.Uc))||b.Ttb||!re.SelectionEditor.am(b.Ra)&&b.Ra.contextId!==oc.a.paragraph||b.g2i()||this.Neh.YB(b.Ra.node).Ula)return!1;const h=ea.ParagraphReader.text(b.Ra.node),n=b.Ra.contextId===oc.a.paragraph?0:b.Ra.cpBegin,B=b.Ra.contextId===oc.a.paragraph?h.length:b.Ra.cpEnd-n;return 1>B||1500<B||F.a.Tf(F.a.XDa(h.substr(n,B)))||1!=no.a.Eqb(b.Ra.node)?!1:!0}rSl(){return 32==this.ga.Ob(wb.a.Hkd,1)}Xjc(b){return this.Exf.Xjc(b)}GYd(b,h,
n,B=null){this.Ypd(b)||this.Exf.GYd(b,h,n,B)}jhm(b){return this.b5e?this.b5e.khm(b):[]}BVo(b){const h=this.QS?this.QS.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new AI,{menuTargetType:h})}static get rc(){return null!=oo.$Wg?oo.$Wg:oo.$Wg=Ya.a.instance.resolve("Box4.IFeatureHelper")}static IDg(b){return A.AFrameworkApplication.v3&&!b.qXa&&Ya.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").Atn()}static b9d(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=F.a.YA(b,
h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static SGl(b){let h=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(b=oo.b9d(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return h}static Nek(b){b=oo.b9d(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,b):null}static JAi(){const b=(new ca.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static AUj(b){const h=
oo.rc.isFeatureEnabled(46);return!b.LWc&&h&&!X.a.Mt&&b.qXa}static d6o(b){const h=oo.rc.isFeatureEnabled(46);return!b.LWc&&h&&!X.a.Mt&&b.PL}static fEg(b){return A.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&!b.mpc()}static NUj(b){return A.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&!b.qXa&&!b.mpc()}static k6o(b){return b.h2i()&&A.AFrameworkApplication.ua.Ib.I$c}static XUj(){return 2===Eh.a.en.mode}static H8o(b){return b.PL}get tUk(){var b;return null===(b=this.TBl)||
void 0===b?void 0:b.xUk}vco(b,h,n,B){this.Nub[B].forEach(L=>{const ba=Object.assign(new te.a,{ControlList:[]}),la=ba.ControlList;L.forEach(La=>{La instanceof Gq?n.push(...this.Bwe.get(La)(b,h,this)):la.push(...this.KD[La](b,h,this))});(null===la||void 0===la?0:la.length)&&n.push(ba)})}Gco(){this.Bwe.set(Gq.G3b,Dr.cGm);this.Bwe.set(Gq.OHe,Dr.Hpm);this.Bwe.set(Gq.JIe,Dr.oLm)}Hco(){this.KD[Wf.SAb]=Hl.Elm;this.KD[Wf.QIe]=Hl.ZMm;this.KD[Wf.RIe]=Hl.eNm;this.KD[Wf.NHe]=Hl.upm;this.KD[Wf.kIe]=Hl.Nzm;this.KD[Wf.SIe]=
Hl.mNm;this.KD[Wf.yHe]=Hl.eHf;this.KD[Wf.cIe]=Hl.Hwm;this.KD[Wf.Mvd]=Hl.NAi;this.KD[Wf.bIe]=Hl.zvm;this.KD[Wf.IIe]=Hl.fLm;this.KD[Wf.UIe]=Hl.cPm;this.KD[Wf.sIe]=Hl.QGm;this.KD[Wf.wIe]=Hl.zIm;this.KD[Wf.Ovd]=Hl.rym;this.KD[Wf.Rvd]=Hl.BEm;this.KD[Wf.tIe]=Hl.a9d;this.KD[Wf.wvd]=Hl.getContentControls;this.KD[Wf.qJe]=Hl.QRm;this.KD[Wf.PHe]=Hl.oqm;this.KD[Wf.FHe]=Hl.Skm;this.KD[Wf.TIe]=Hl.TOm;this.KD[Wf.EHe]=Hl.wkm;this.KD[Wf.vvd]=Hl.getBookmark;this.KD[Wf.YHe]=Hl.Ium;this.KD[Wf.$He]=Hl.ila;this.KD[Wf.fgb]=
Hl.imm;this.KD[Wf.Mvd]=Hl.NAi;this.KD[Wf.QHe]=Hl.frm;this.KD[Wf.mQg]=Hl.Cnm}s5m(){const b=[Wf.kIe,Wf.SIe,Wf.yHe,Wf.QIe];this.Nub[As.GSg]=[[Wf.SAb],b,[Wf.fgb],[Gq.G3b],[Wf.wvd]];this.Nub[As.SRg]=[[Wf.SAb],[Wf.FHe,Wf.PHe,Wf.qJe],b,[Wf.fgb],[Gq.G3b]];this.Nub[As.JQg]=[[Wf.QHe],[Wf.Ovd,Wf.Rvd],[Wf.vvd,Wf.fgb],[Gq.G3b]];this.Nub[As.WQg]=[[Wf.Mvd],[Wf.NHe],[Gq.JIe],[Gq.OHe],[Wf.SAb],[Wf.cIe,Wf.bIe,Wf.IIe,Wf.UIe],[Wf.sIe,Wf.wIe,Wf.Rvd],[Wf.mQg],[Wf.Ovd],b,[Wf.wvd],[Wf.$He,Wf.vvd,Wf.YHe,Wf.fgb],[Wf.tIe],
[Wf.TIe],[Wf.EHe],[Wf.RIe],[Gq.G3b]];this.Nub[As.RQg]=[[Wf.SAb],[Wf.fgb]];this.Nub[As.CQg]=[[Wf.SAb],[Wf.bIe]];this.Nub[As.Tgk]=[[Wf.Mvd],[Wf.NHe],[Gq.JIe],[Gq.OHe],[Wf.SAb],[Wf.FHe],[Wf.PHe],[Wf.qJe],[Wf.cIe],[Wf.IIe],[Wf.UIe],[Wf.sIe],[Wf.wIe],[Wf.QHe],[Wf.Ovd],[Wf.Rvd],[Wf.$He],[Wf.kIe],[Wf.SIe],[Wf.yHe],[Wf.QIe],[Wf.vvd],[Wf.YHe],[Wf.fgb],[Wf.tIe],[Wf.wvd],[Wf.TIe],[Wf.EHe],[Wf.RIe],[Gq.G3b]]}}Object(u.a)(oo,"EditSurfaceContextMenu",Mj,[]);var As;(function(b){b[b.GSg=1]="TABLE_MULTI_CELL";b[b.WQg=
2]="GENERIC";b[b.SRg=3]="PICTURE";b[b.JQg=4]="EQUATION";b[b.Tgk=5]="LEGACY";b[b.RQg=6]="FLUID";b[b.CQg=7]="DRAWING"})(As||(As={}));Object(u.b)("Scenarios",As);class Gq{}Gq.G3b=new Gq;Gq.OHe=new Gq;Gq.JIe=new Gq;Object(u.a)(Gq,"Sections",null,[]);var Wf;(function(b){b[b.Mvd=1]="INTENT_SUGGESTION";b[b.SAb=2]="ESSENTIALS";b[b.cIe=3]="INSIGHT";b[b.bIe=4]="ILLUSTRATION";b[b.IIe=5]="SMART_LOOKUP";b[b.UIe=6]="TRANSLATE";b[b.sIe=7]="PROOFING";b[b.wIe=8]="REWRITE_SUGGESTIONS";b[b.Ovd=9]="LISTS";b[b.Rvd=10]=
"PARAGRAPH_OPTIONS";b[b.kIe=11]="MERGE_SPLIT_CELLS";b[b.SIe=12]="TABLE_SORT";b[b.yHe=13]="ALT_TEXT";b[b.$He=14]="HYPERLINK";b[b.vvd=15]="BOOKMARK";b[b.YHe=16]="HEADING_LINK";b[b.fgb=17]="COMMENT";b[b.tIe=18]="PULL_QUOTE";b[b.qJe=19]="WRAP_TEXT";b[b.PHe=20]="DRAW";b[b.TIe=21]="TRACK_CHANGE";b[b.EHe=22]="CATCHUP_ACTIVITIES";b[b.RIe=23]="TABLE_OF_CONTENTS";b[b.NHe=24]="DESIGNER_REVIEW";b[b.QIe=25]="TABLE_ITEMS";b[b.FHe=26]="CHANGE_PICTURE";b[b.QHe=27]="EQUATION_TOOLS";b[b.wvd=28]="CONTENT_CONTROL";b[b.mQg=
29]="COPILOT_COMPOSE"})(Wf||(Wf={}));Object(u.b)("SectionItem",Wf);class rn extends zv{constructor(b,h,n){super();this.El=null;this.Pqe=(B,L,ba,la,La)=>{if(1===ba)return 32;B=[];L=[];this.c4o()&&L.push("InsertTabStopMenuSplitButton");this.O3o()&&L.push("ClearAllTabStops");L.push("HideRuler");B.push(rn.qCi(L));L=Object.assign(new vh.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});L.MenuSectionList.push(...B);La.MenuItems=L;return 32};this.ga=b;this.eo=h;this.uA=n;this.Wb()}get Mib(){return document.getElementById("WACHorizontalRuler")}get uQ(){return this.eo&&
this.eo.instance?this.eo.instance.Aj:1}get target(){return this.El}show(b,h){this.El=b;zv.J0b("RulerContextMenu",b,h);x.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",rn.YR);b.set("Response","Ruler Context menu invoked.");oa.Health.instance.recordKpiUsage(rn.kpiName,1,rn.Saa,b)}THm(){var b=0,h=(this.target.x-$c.a.IHf(this.Mib))/this.uQ;h=ri.a.gA(h,0);var n={},B=this.uA.FOb,L=ve.GraphIterator.eb(B);L.Jd();if(!xh.TableReader.yy(L))return 32===
this.ga.Pb(wb.a.ANa,2,n)&&(b=n.marginLeft),h-b;b={};L={};n=this.ga.Pb(wb.a.njd,2,b);var ba=this.ga.Pb(wb.a.AYb,2,L);if(32!==n||32!==ba)return x.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;ba=L.TablePosition;if(!ba||!b||0>=b.length)return x.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),h;n=0;L=ve.GraphIterator.eb(B);L.zb(14)&&(L.ld(16),n=tx.a(L,!0));B=ba.x/this.uQ;for(L=0;L<n;L++)B+=b[L];return h-
B}Wb(){this.ga.fb(Dc.a.Pqe,oc.a.application,this.Pqe,96)}c4o(){var b={},h={},n=this.ga.Pb(wb.a.ANa,2,b),B=this.ga.Pb(wb.a.Zcb,2,h);if(32===n&&32===B){B=h.Eu;n=ri.a.qj(B.ota,0);B=1===B.specialIndentType?ri.a.qj(B.oD,0):ri.a.qj(B.oD-B.Eha,0);const L=ri.a.qj(b.marginLeft,0);b=ri.a.qj(b.marginRight,0);const ba=$c.a.IHf(this.Mib),la=$c.a.zui(this.Mib);h.isRtl?(h=ba+this.uQ*Math.max(b,b+n),n=la-this.uQ*Math.max(L,L+B)):(h=ba+this.uQ*Math.max(L,L+B),n=la-this.uQ*Math.max(b,b+n));if(this.target.x>=h&&this.target.x<=
n)return!0}return!1}O3o(){var b={};if(32!==this.ga.Pb(Dc.a.nYb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static qCi(b){const h=Object.assign(new te.a,{ControlList:[]});for(const n of b)h.ControlList.push(Object.assign(new jj.a,{ExternalId:n}));return h}}rn.Saa="wwaengidc";rn.kpiName="WordRuler";rn.YR="RulerContextMenu";Object(u.a)(rn,"RulerContextMenu",zv,[215]);var es=d(299),Ss=d(1529),Zt=d(489),oO=d(812),ZD=d(1283),iK=d(1802);class qw{constructor(){this.lineStyle=vi.a.RH;this.Jbd=
vi.a.TH;this.borderColor=vi.a.E2}}Object(u.a)(qw,"TableBorderFormattingData",null,[]);var Vu=d(751);class Pk{constructor(){this.z3=this.vZi=!1;this.Kzb=Vu.a.none;this.Fx=0;this.$fb=1}}Object(u.a)(Pk,"WrapTextPropertiesData",null,[]);var MA=d(1159);class Gj extends ZD.a{constructor(b=null){super(b);this.RDh=new iK.a;this.qLh=new Pk;this.sHh=new qw;this.zUe=!1;this.nQi=h=>{const n=new es.a;n.iKa=!0;n.FO=h;return n};this.rY=()=>{const h=new es.a;h.nRb=!1;h.FO=wb.a.ANa;h.rd=this.RDh;h.$oc=!0;h.$la=!0;
return h};this.vxj=()=>{const h=new es.a;h.nRb=this.zUe;this.zUe=!0;h.FO=wb.a.adb;h.rd=this.sHh;h.$oc=!0;h.$la=!0;return h};this.Yud=()=>{const h=new es.a;h.nRb=!1;h.FO=Dc.a.Vuc;h.rd=this.qLh;h.$oc=!0;h.$la=!0;return h};this.mbe=(h,n)=>{const B=new es.a;B.rd=new Og.DictionaryPropertySet;switch(h){case Dc.a.f7c:B.rd.setValue(zd.a.ksb,n[Ki.a.Number]);break;case Dc.a.Z6c:B.rd.setValue(zd.a.hsb,n[Ki.a.Number]);break;case Dc.a.$6c:B.rd.setValue(zd.a.isb,n[Ki.a.Number]);break;case Dc.a.a7c:B.rd.setValue(zd.a.jsb,
n[Ki.a.Number])}return B};this.Rjo=()=>{const h=new es.a;h.rd=new Og.DictionaryPropertySet;h.$la=!0;return h}}initialize(){super.initialize();this.kd.Z(Dc.a.t3f,Ss.a.usb);this.kd.Z(Dc.a.x3f,Ss.a.usb);this.kd.Z(Dc.a.z3f,Ss.a.usb);this.kd.Z(Dc.a.Log,Gj.AZa);this.kd.Z(Dc.a.hjd,Gj.AZa);this.kd.Z(Dc.a.Eog,Gj.AZa);this.kd.Z(Pa.a.DYb,Gj.AZa);this.kd.Z(wb.a.jse,this.rY);this.kd.Z(wb.a.ise,this.rY);this.kd.Z(wb.a.hse,this.rY);this.kd.Z(wb.a.lse,this.rY);this.kd.Z(wb.a.kse,this.rY);this.kd.Z(wb.a.gse,this.rY);
this.kd.Z(wb.a.sse,this.rY);this.kd.Z(wb.a.rse,this.rY);this.kd.Z(wb.a.qse,this.rY);this.kd.Z(wb.a.nse,this.rY);this.kd.Z(wb.a.ose,this.rY);this.kd.Z(wb.a.pse,this.rY);this.kd.Z(wb.a.apg,this.rY);this.kd.Z(wb.a.$og,this.rY);this.kd.Z(wb.a.oog,this.rY);this.kd.Z(wb.a.qog,this.rY);this.kd.Z(wb.a.pog,this.rY);this.kd.Z(wb.a.nog,this.rY);this.kd.Z(wb.a.geb,Gj.qIn);this.kd.Z(wb.a.z_a,Gj.T7n);this.kd.Z(wb.a.fyb,Gj.avl);Object(MA.a)()&&(this.kd.Z(wb.a.ixc,Gj.Pyn),this.kd.Z(wb.a.Qog,this.rY),this.kd.Z(wb.a.Pog,
this.rY));this.kd.Z(wb.a.Wqa,Gj.AZa);this.kd.Z(wb.a.MXb,Gj.AZa);this.kd.Z(wb.a.EZa,Gj.AZa);this.kd.Z(wb.a.sza,Gj.AZa);this.kd.Z(wb.a.NDa,Gj.AZa);this.kd.Z(Dc.a.Lhd,Gj.AZa);this.kd.Z(Dc.a.s4d,Ss.a.dFf);this.kd.Z(Dc.a.t4d,this.Usi);this.Pn.Z(Dc.a.Jhd,Ss.a.aVa);this.Pn.Z(Dc.a.Khd,Ss.a.aVa);this.kd.Z(wb.a.a0b,Ss.a.r8a);this.kd.Z(wb.a.$_b,Ss.a.r8a);this.kd.Z(wb.a.xyb,Ss.a.r8a);this.kd.Z(wb.a.opg,this.mH);this.kd.Z(wb.a.mpg,this.mH);this.kd.Z(wb.a.npg,this.mH);this.kd.Z(wb.a.lM,Gj.jio);this.Pn.Z(Dc.a.Yse,
Gj.Bkd);this.Pn.Z(Dc.a.Zse,Gj.Bkd);this.Pn.Z(Dc.a.$se,Gj.Bkd);this.Pn.Z(Dc.a.Wse,Gj.Bkd);this.Pn.Z(Dc.a.Xse,Gj.Bkd);this.kd.Z(Dc.a.Yse,this.Yud);this.kd.Z(Dc.a.Zse,this.Yud);this.kd.Z(Dc.a.$se,this.Yud);this.kd.Z(Dc.a.Wse,this.Yud);this.kd.Z(Dc.a.Xse,this.Yud);this.kd.Z(Dc.a.kHe,Gj.WBc);this.kd.Z(Dc.a.lHe,Gj.WBc);this.kd.Z(Dc.a.mHe,Gj.WBc);this.kd.Z(Dc.a.nHe,Gj.WBc);this.kd.Z(Dc.a.oHe,Gj.WBc);this.kd.Z(Dc.a.pHe,Gj.WBc);this.kd.Z(Dc.a.AOa,Gj.djc);this.kd.Z(Dc.a.pUj,Gj.djc);this.kd.Z(Dc.a.qUj,Gj.djc);
this.kd.Z(Dc.a.Oze,Gj.djc);this.kd.Z(Dc.a.Pze,Gj.djc);this.kd.Z(Dc.a.Lpd,Gj.djc);this.kd.Z(Dc.a.Twb,this.Rjo);this.kd.Z(Dc.a.Uid,Gj.Y4d);this.kd.Z(Dc.a.$re,Gj.Y4d);this.kd.Z(Dc.a.ase,Gj.Y4d);this.kd.Z(Dc.a.bse,Gj.Y4d);this.kd.Z(Dc.a.f7c,this.mbe);this.kd.Z(Dc.a.Z6c,this.mbe);this.kd.Z(Dc.a.$6c,this.mbe);this.kd.Z(Dc.a.a7c,this.mbe);this.kd.Z(wb.a.hta,this.nQi);this.kd.Z(wb.a.yNb,this.nQi);this.kd.Z(Dc.a.Rwb,Gj.Rwb);this.kd.Z(Dc.a.Xze,Ss.a.r8a);this.kd.Z(wb.a.spg,this.vxj);this.kd.Z(wb.a.tpg,this.vxj)}clearCache(){super.clearCache();
this.zUe=!1;this.RDh=new iK.a;this.qLh=new Pk;this.sHh=new qw}WIf(){const b=super.WIf();b.xIa=Gj.xIa;b.g6a=Gj.g6a;return b}static get p7n(){return null!=Gj.t2g?Gj.t2g:Gj.t2g=Ya.a.instance.Oa("WordEditor.IPageCommandStringBuilder")}static get kB(){Gj.Hya||(Gj.Hya=Ya.a.instance.Oa("WordEditor.ITableBorderManager"));return Gj.Hya}static AZa(b,h){b=new es.a;b.rd=h;return b}static hod(b,h,n){h[$g.a.Description]=b?b.nIn(n):null}static xIa(b,h){const n=Object(ya.a)(iK.a,b.rd),B=Object(ya.a)(Zt.a,b.rd),L=
Object(ya.a)(Pk,b.rd),ba=Object(ya.a)(qw,b.rd);let la=!0;const La=Gj.p7n;switch(b.awb){default:la=ZD.a.xIa(b,h);break;case wb.a.jse:h[Yh.a.Icon]=n.vCa?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[$g.a.On]=!n.mVb;Gj.hod(La,h,0);break;case wb.a.ise:h[Yh.a.Icon]=n.vCa?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";h[$g.a.On]=1===n.mVb;Gj.hod(La,h,1);break;case wb.a.hse:h[Yh.a.Icon]=n.vCa?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[$g.a.On]=
2===n.mVb;Gj.hod(La,h,2);break;case wb.a.lse:h[Yh.a.Icon]=n.vCa?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";h[$g.a.On]=3===n.mVb;Gj.hod(La,h,3);break;case wb.a.kse:h[Yh.a.Icon]=n.vCa?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";h[$g.a.On]=4===n.mVb;Gj.hod(La,h,4);break;case wb.a.gse:h[Yh.a.Icon]=n.vCa?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[$g.a.On]=5===n.mVb;break;case wb.a.sse:h[$g.a.On]=!n.hXb;h[$g.a.Description]=La?La.Igd(0):null;
break;case wb.a.rse:h[$g.a.On]=1===n.hXb;h[$g.a.Description]=La?La.Igd(1):null;break;case wb.a.qse:h[$g.a.On]=2===n.hXb;h[$g.a.Description]=La?La.Igd(2):null;break;case wb.a.nse:h[$g.a.On]=3===n.hXb;h[$g.a.Description]=La?La.Igd(3):null;break;case wb.a.ose:h[$g.a.On]=4===n.hXb;h[$g.a.Description]=La?La.Igd(4):null;break;case wb.a.pse:h[$g.a.On]=5===n.hXb;break;case wb.a.apg:h[$g.a.On]=!n.vCa;break;case wb.a.$og:h[$g.a.On]=n.vCa;break;case wb.a.oog:h[$g.a.On]=1===n.eWc;break;case wb.a.qog:h[$g.a.On]=
2===n.eWc;break;case wb.a.pog:h[$g.a.On]=3===n.eWc;break;case wb.a.nog:h[$g.a.On]=0===n.eWc;break;case wb.a.Qog:h[$g.a.On]=-1===n.e7i;break;case wb.a.Pog:h[$g.a.On]=2===n.e7i;break;case wb.a.opg:h[$g.a.On]=B.Eu?!B.Eu.specialIndentType:!1;break;case wb.a.mpg:h[$g.a.On]=B.Eu?1===B.Eu.specialIndentType:!1;h[Dl.a.Image16by16Class]=B.isRtl?Bb.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):Bb.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case wb.a.npg:h[$g.a.On]=B.Eu?2===B.Eu.specialIndentType:
!1;h[Dl.a.Image16by16Class]=B.isRtl?Bb.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):Bb.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case Dc.a.Yse:h[$g.a.On]=1===L.$fb;break;case Dc.a.Zse:h[$g.a.On]=8===L.$fb;break;case Dc.a.$se:h[$g.a.On]=9===L.$fb;break;case Dc.a.Wse:h[$g.a.On]=3===L.$fb;break;case Dc.a.Xse:h[$g.a.On]=4===L.$fb;break;case Dc.a.Twb:h[$g.a.On]=b.rd.ja(zd.a.rCa,!1);break;case Dc.a.Rwb:h[em.a.IsFreeForm]=!0;h[em.a.Value]=b.rd[Am.a.Value];break;case wb.a.spg:h[Jj.a.On]=
Gj.kB.tui(h.MenuItemId)===ba.lineStyle;break;case wb.a.tpg:h[Jj.a.On]=Gj.kB.uui(h.MenuItemId)===ba.Jbd}return la}static qIn(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new es.a;h.rd=b;return h}static T7n(b,h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=
2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new es.a;h.rd=b;return h}static avl(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}h=new es.a;h.rd=b;return h}static Pyn(b,h){b=3;switch(h.MenuItemId){case "buttonLineNumberingNone":b=-1;break;case "buttonLineNumberingContinuous":b=2}h=new es.a;h.rd=b;return h}static Rwb(){const b=new es.a;b.FO=Dc.a.Rwb;b.rd={};b.$la=!0;b.$oc=!0;return b}static WBc(b,h){const n=
new es.a;n.rd=new Og.DictionaryPropertySet;let B=1;switch(b){case Dc.a.nHe:B=1;break;case Dc.a.oHe:B=8;break;case Dc.a.pHe:B=9;break;case Dc.a.lHe:B=3;break;case Dc.a.mHe:B=4}n.rd.setValue(zd.a.$fb,B);n.rd.setValue(zd.a.HOa,h[$g.a.SourceControlId]);return n}static djc(b,h,n){b=new es.a;b.rd=n.InvocationMethod;return b}static jio(b,h){b=new es.a;b.rd=h;return b}static Bkd(){const b=new oO.a;b.FO=Dc.a.Vuc;return b}static Y4d(){const b=new es.a;b.rd=new Og.DictionaryPropertySet;b.E$c=!0;return b}static g6a(b,
h){let n=!0;switch(b.awb){case Dc.a.Uid:b=b.rd.ja(zd.a.ksb,0);h[Ki.a.Number]=b;h[Ki.a.UnitType]=7;break;case Dc.a.$re:b=b.rd.ja(zd.a.hsb,0);h[Ki.a.Number]=b;h[Ki.a.UnitType]=7;break;case Dc.a.ase:b=b.rd.ja(zd.a.isb,0);h[Ki.a.Number]=b;h[Ki.a.UnitType]=7;break;case Dc.a.bse:b=b.rd.ja(zd.a.jsb,0);h[Ki.a.Number]=b;h[Ki.a.UnitType]=7;break;default:n=ZD.a.g6a(b,h)}return n}}Gj.Hya=null;Object(u.a)(Gj,"CuiActionBridge",ZD.a,[]);class jm extends Ge.a{constructor(b){super();this.yvl=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;
this.M0o=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.I_d=this.VHb=this.T9=this.K3a=this.U8e=null;this.yIj=h=>{h.target.setAttribute(Bc.a.wmb,Bc.a.hq);Sys.UI.DomElement.removeCssClass(this.VHb,"inactiveRowSelection");this.VHb=h.target};this.xIj=h=>{h.target.removeAttribute(Bc.a.wmb);Sys.UI.DomElement.addCssClass(h.target,"inactiveRowSelection")};this.S0h=h=>{(h=h.target.parentNode)&&h!==this.VHb&&this.v4(h)};this.u_j=h=>h.Kb.keyCode===Jd.a.Mu?(h.Kb.stopPropagation(),!0):!1;this.LLh=h=>{if(!h.Kb)return!1;
const n=h.Kb.keyCode;if(h.eventName===Cd.a.Ti){h=this.iwm(this.VHb);let B=-1;const L=Yb.a.count(this.Yye)-1;n===Sys.UI.Key.down?B=h<L?h+1:0:n===Sys.UI.Key.up?B=0<h?h-1:L:n===Sys.UI.Key.home?B=0:n===Sys.UI.Key.end&&(B=L);-1!==B&&this.v4(this.T9.tBodies[0].children[B])}return!0};this.Yb=b;this.kh="<div id='AccessibilityHelpDialogBody'></div>";this.Qg="AAccessibilityHelpDialog";this.Gd=6;this.Pe(0,CommonUIStrings.l_DialogClose)}get Dxf(){return null}get Yye(){this.U8e||(this.U8e=this.J6m());return this.U8e}get wgp(){return 300}get Sej(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get Rej(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get z7a(){return this.Yb.gu()}u_a(b){super.u_a(b);
this.fco()}L_a(){this.showDialog(this.dialogTitle,Object(z.a)(this,this.BTk,"accHelpDialogResultHandler"));this.HNa();this.setFocus()}setFocus(){this.T9?(this.VHb=this.T9.tBodies[0].firstChild,this.v4(this.VHb)):this.oJ&&"none"!==this.oJ.style.display?this.v4(this.oJ):this.v4(this.qB)}cra(){this.ne.nb(Cd.a.Ti,this.I_d,this.LLh);if(this.T9){this.ne.nb(Cd.a.oi,this.T9,this.u_j);const b=this.T9.tBodies[0].children;for(let h=0;h<b.length;h++)if(Nb.a.addHandler(b[h],Cd.a.focus,this.yIj),Nb.a.addHandler(b[h],
Cd.a.blur,this.xIj),X.a.Mt){const n=b[h].children;for(let B=0;B<n.length;B++)Nb.a.addHandler(n[B],Cd.a.focus,this.S0h)}}super.cra()}Aob(){this.ne&&(this.ne.xc(Cd.a.Ti,this.I_d,this.LLh),this.T9&&this.ne.xc(Cd.a.oi,this.T9,this.u_j));if(this.T9){const b=this.T9.tBodies[0].children;for(let h=0;h<b.length;h++)if(Nb.a.removeHandler(b[h],Cd.a.focus,this.yIj),Nb.a.removeHandler(b[h],Cd.a.blur,this.xIj),X.a.Mt){const n=b[h].children;for(let B=0;B<n.length;B++)Nb.a.removeHandler(n[B],Cd.a.focus,this.S0h)}}super.Aob()}HNa(){this.z7a.scope.tt(this.Yb.MZ);
this.z7a.scope.tt(this.Yb.NZ);this.z7a.scope.bindAction(this.Yb.MZ,Pa.a.aSc);this.z7a.scope.bindAction(this.Yb.NZ,Pa.a.$Rc)}mXm(b){if(!this.z7a.Mk||!this.z7a.Mk.Ora)return 2;var h=this.z7a.Mk.Ora;if(this.T9&&(h===this.qB&&b===Pa.a.aSc||h===this.K3a&&b===Pa.a.$Rc))this.v4(this.VHb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===Pa.a.aSc?h=this.K3a:b===Pa.a.$Rc&&(h=this.qB),h&&this.v4(h);else if(b===Pa.a.aSc)this.z7a.Mrc();else if(b===Pa.a.$Rc)this.z7a.Krc();else return 2;return 32}BTk(){}fco(){this.I_d=
document.getElementById("AccessibilityHelpDialogBody")||this.Nq;this.pKl();this.QJl();this.CHl()}pKl(){if(this.Dxf){var b=document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.Dxf;b.appendChild(h);this.cpa.appendChild(b)}}QJl(){if(this.Yye&&!Yb.a.isEmpty(this.Yye)){this.T9=document.createElement("table");this.T9.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute(Bc.a.Ph,
Bc.a.ITc);b.appendChild(h);var n=Lh.a.BXc(14,this.yvl);h.appendChild(n);n=Lh.a.BXc(14,this.M0o);h.appendChild(n);this.T9.appendChild(b);b=document.createElement("tbody");h=0;n=this.Yye;for(const ba in n){var B=ba,L=n[ba];const la=document.createElement("tr");la.tabIndex=0;la.setAttribute(Bc.a.Ph,Bc.a.ITc);la.id="SelectableTableRow"+h++;B=Lh.a.BXc(15,B);la.appendChild(B);L=Lh.a.BXc(15,L);la.appendChild(L);b.appendChild(la)}b.style.maxHeight=this.wgp+"px";this.T9.appendChild(b);this.I_d.appendChild(this.T9)}}CHl(){if(this.Rej&&
this.Sej){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.K3a=document.createElement("a");this.K3a.innerText=this.Rej;this.K3a.href=this.Sej;this.K3a.target="_blank";this.K3a.id=this.Sj("AccessibilityHelpDialogLink");this.K3a.className=Dd.AFrame.Thf;b.appendChild(this.K3a);this.Oc.insertBefore(b,this.Oc.lastChild)}}iwm(b){return Number.parseInvariant(b.id.substr(18))}t2(b,h,n,B=null){b&&h&&n&&(n=B?String.format(n,B):n,b[h]=n)}IHi(b,h){return X.a.$l?h:b}}Object(u.a)(jm,
"AAccessibilityHelpDialog",Ge.a,[32]);class Ts extends jm{constructor(b){super(b)}get dialogTitle(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get Dxf(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}J6m(){const b=this.IHi(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),h=this.IHi(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),n={};this.t2(n,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);
this.t2(n,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.t2(n,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.t2(n,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,h);this.t2(n,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.t2(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.t2(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,b);this.t2(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);this.t2(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,
b);this.t2(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.t2(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.t2(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.t2(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.t2(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,b);this.t2(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstShortcut,b);A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.t2(n,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,
CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);A.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&this.t2(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(Ts.rc&&Ts.rc.isFeatureEnabled(58)||mn.a.ULa)&&this.t2(n,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return n}static get rc(){return null!=Ts.KWg?
Ts.KWg:Ts.KWg=Ya.a.instance.Oa("Box4.IFeatureHelper")}}Object(u.a)(Ts,"AccessibilityHelpDialog",jm,[]);var FI=d(358);class $D{static get kh(){return Ge.a.az($D.Mn,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}$D.Mn="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(u.a)($D,"ApplyStylesDialogHtml",null,[]);class BD extends Ge.a{constructor(b,h){super();this.CJ=null;this.BQc=!1;this.sJb=this.Ogb=this.LMc=this.PMc=this.RQc=null;this.V8k=(n,B)=>{if(this.Dh.lw){if(n){n=B.styleList;B=B.styleText;if(-1===n||F.a.xh(B)!==F.a.xh(this.CJ[n]))n=this.aIi(B);B=this.CJ[n];n=this.Vb.ko();ok.a.ei.qr?(n=n.uy(),B=this.Vb.Ae(n.zBa(B))):B=this.Vb.Ae(n.XKa(B));A.AFrameworkApplication.va.lg(this._context,wb.a.HT,2,!1,new FI.a,B)}this.Dh.f9()}};this.t3n=n=>{this.BQc?(this.BQc=
!1,this.validate()):"value"===n.rawEvent.propertyName&&(this.BQc=!0,this.j2.value!==this.RQc&&(this.RQc=this.j2.value,this.NVh()))};this.KZn=()=>{-1!==this.uqa.selectedIndex&&(X.a.R7&&(this.BQc=!0),this.RQc=this.CJ[this.uqa.selectedIndex],this.j2.value=this.CJ[this.uqa.selectedIndex],this.validate())};this.onKeyDown=n=>{X.a.nM?n.keyCode!==Jd.a.PD&&n.keyCode!==Jd.a.Y4||this.Ogb||this.sJb||(this.sJb=new Re.a(0,1,1,this.jDp),A.AFrameworkApplication.mc.Zb(this.sJb)):X.a.R7&&n.keyCode===Jd.a.PD&&(this.BQc=
!0)};this.LI=()=>{this.Ogb||(this.Ogb=new Re.a(0,1,1,this.Bal),A.AFrameworkApplication.mc.Zb(this.Ogb));this.sJb&&(A.AFrameworkApplication.mc.vf(this.sJb),this.sJb=null)};this.Bal=()=>{this.Ogb=null;this.NVh()};this.jDp=()=>{this.sJb=null;this.validate()};this._context=b;this.xd=h;this.Qg="ApplyStylesDialog";this.Dh=this._context.view;this.uOf();b=this.hep();h="";this.CJ.length>b&&(h=this.CJ[b]);h={["styleText"]:h,["styleList"]:b};this.kh=$D.kh;this.pi(WordEditorIntl.WordEditorStrings.l_ApplyStyles,
this.V8k,h);this.uqa=document.getElementById("styleList");this.Llg();this.uqa.selectedIndex=b;this.j2=document.getElementById("styleText");this.j2.focus();this.j2.select();this.rId=this.KZn;Nb.a.addHandler(this.uqa,"change",this.rId);this.qId=this.onKeyDown;Nb.a.addHandler(this.j2,"keydown",this.qId);X.a.R7?(this.PMc=this.t3n,Nb.a.addHandler(this.j2,"propertychange",this.PMc),this.RQc=this.CJ[b]):(this.LMc=this.LI,Nb.a.addHandler(this.j2,"keypress",this.LMc))}get Vb(){return null!=this.q7g?this.q7g:
this.q7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get ei(){return null!=this.V4g?this.V4g:this.V4g=Ya.a.instance.Oa("Box4.Styles.StyleSettings")}hep(){var b=this.Dh.lb;if(!b||!b.gb)return Vc.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.gb.currentSelection;if(!b)return Vc.b(579216409,3018,15,"CurrentSelection is null"),0;ea.ParagraphReader.nn(b.Ra)&&(b=re.SelectionEditor.Wj(b,!0,!1));b=b.Ra;if(!b||!re.SelectionEditor.mw(b))return Vc.b(579216410,3018,15,"Received invalid nodeContext, null={0}",
!b),0;var h=Va.FormattingReader.Cs(b);(h=Va.FormattingReader.DBa(h))||(h=this.Vb.Eq(b.node));if(!h)return 0;b=this.Vb.aK(h);b=Array.indexOf(this.CJ,b);0>b&&(b=0);return b}Llg(){const b=this.CJ.length;for(let h=0;h<b;h++){const n=document.createElement("OPTION");n.value=h.toString();n.text=this.CJ[h];this.uqa.add(n,null)}}uOf(){var b=ok.a.Mp();if(b){if(this.ei.qr){var h=(new Qq.WACStyleSet).cla(b);b=h.JG}else{var n=(new Qq.WACStyleSet).iba(b);b=n.JG}var B=this.xd.isFeatureEnabled(107)&&!!this.Vb.Zg;
this.CJ=[];for(let L=0;L<b;L++){let ba;ba=n instanceof Qq.WACStyleSet?n.yBa(L):h.rla(L);if(this.Vb.isHidden(ba))continue;const la=this.Vb.FF(ba);if(!B){if(3===la)continue}else if(3===la&&this.Vb.Ae(ba)===Yz.a.$Vb)continue;Array.add(this.CJ,this.Vb.aK(ba))}this.CJ.sort(BD.hxl)}else Vc.b(577644352,3018,15,"Couldn't find PageContentNode")}dispose(){this.PMc&&Nb.a.removeHandler(this.j2,"propertychange",this.PMc);this.qId&&Nb.a.removeHandler(this.j2,"keydown",this.qId);this.rId&&Nb.a.removeHandler(this.uqa,
"change",this.rId);this.LMc&&Nb.a.removeHandler(this.j2,"keypress",this.LMc);this.Ogb&&A.AFrameworkApplication.mc.vf(this.Ogb);this.Ogb=this.LMc=this.uqa=this.j2=this.qId=this.PMc=this.rId=null;super.dispose()}NVh(){var b=this.j2.value,h=this.z4m(b);const n=-1===h?b:this.CJ[h];b=b.length;const B=n.length;this.RQc=n;this.j2.value=n;this.uqa.selectedIndex=h;B>b&&(X.a.nM?this.j2.setSelectionRange(b,B):X.a.R7&&(h=this.j2.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",
B-b),h.select()));this.validate();this.j2.focus()}z4m(b){let h=0,n=this.CJ.length,B=-1;for(b=F.a.xh(b);h<n;){const L=Math.floor((h+n)/2),ba=BD.Vqf(b,this.CJ[L]);if(!ba){B=L;break}0<ba?h=L+1:n=L}if(B>h)for(;!BD.Vqf(b,this.CJ[B-1])&&(B--,B!==h););return B}validate(){const b=-1===this.aIi(this.j2.value),h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(h.style.display="none",h.innerText="");return!b}aIi(b){b=F.a.xh(b);
const h=this.CJ.length;for(let n=0;n<h;n++)if(b===F.a.xh(this.CJ[n]))return n;return-1}static Vqf(b,h){const n=Math.min(b.length,h.length);b=F.a.xh(b);h=F.a.xh(h);for(let B=0;B<n;B++){const L=F.a.charCodeAt(b,B),ba=F.a.charCodeAt(h,B);if(L!==ba)return L-ba}return b.length<=h.length?0:1}static hxl(b,h){return BD.Vqf(b,h)}}Object(u.a)(BD,"ApplyStylesDialog",Ge.a,[]);var Vt=d(239);class CD extends ui.StandardDialog{constructor(b){super();this.ey=b;this.V5o()}V5o(){this.Gd=1;this.uY(1);this.Pe(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);
this.Ix(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.Twf.bind(this))}Twf(b){1===b&&this.ey.Lva("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.ij?Vc.b(524834400,3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.vk,h.vk.stack):(this.cGo(),Vc.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}cGo(){Vt.a.xAb="{}"}}Object(u.a)(CD,"DeleteSavedStylesConfirmationDialog",ui.StandardDialog,
[]);class QK extends ui.StandardDialog{constructor(b,h){super();this.Twf=L=>{if(1===L){L=new Map;L.set("Source","DeleteStyleConfirmationDialog");L.set("Action","DeleteStyle");oa.Health.instance.recordKpiUsage(yq.a.vFa,0,yq.a.bD,L);var ba=ok.a.Mp();L=new Sd.GraphTransaction(15);L.Ab(ba);L.yi=wb.a.nNb;this.kJ.Fei(this.NGh)?Vc.b(578359694,3018,50,"User deleted a style via UI."):(ba=new Map,ba.set("Source","DeleteStyleConfirmationDialog"),ba.set("Action","DeleteStyle"),ba=Object.assign(new rb.a,{extendedProperties:ba}),
oa.Health.instance.recordKpiFailure(yq.a.vFa,"DeleteStyleFailed",!1,!0,ba),Vc.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));L.dispose()}};h||Vc.b(590128417,3018,10,"styleId is null");let n=null,B=null;if(this.Dh=b.view)B=this.Dh.lb;B&&(n=B.gb.currentSelection.Ra);n?(b=n.node)?(this.QM=Object($n.a)().Iu(b))?(this.NGh=new ob.a,this.NGh.add(h),this.W5o(h)):Vc.b(590128448,3018,10,"_pageContenNode is null."):Vc.b(590128419,3018,10,"node is null."):Vc.b(590128418,
3018,10,"nodeContext is null.")}get kJ(){return null!=this.h7g?this.h7g:this.h7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get Vb(){return null!=this.z7g?this.z7g:this.z7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}W5o(b){const h=(new Qq.WACStyleSet).iba(this.QM);h?((b=h.gh(b))||Vc.b(590128450,3018,10,"Style set doesn't contain style with given ID"),b=this.Vb.aK(b),this.Gd=4,this.uY(2),this.Ix(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,
b),0,this.Twf)):Vc.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(u.a)(QK,"DeleteStyleConfirmationDialog",ui.StandardDialog,[]);class PH{static get kh(){return Ge.a.az(PH.Mn)}}PH.Mn="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(u.a)(PH,"DeleteStyleDialogHtml",null,[]);class sJ extends Ge.a{constructor(b){super();this.QM=this.CJ=null;this.PQl=(h,n)=>{this.Dh.lw&&(h?(h=n.styleList,-1!==h&&(h=this.CJ[h],
n=this.Vb.ko(),ok.a.ei.qr?(n=n.uy(),h=this.Vb.Ae(n.zBa(h))):h=this.Vb.Ae(n.XKa(h)),this.eZc.OQl(this._context,h),this.Dh.f9())):this.Dh.f9())};this._context=b;this.Qg="DeleteStyleDialog";this.Gd=1;this.Pe(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.Dh=this._context.view;this.uOf();this.kh=PH.kh;this.pi(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.PQl,{["styleList"]:0});this.uqa=document.getElementById("styleList");this.Llg();this.uqa.selectedIndex=0;this.uqa.focus()}get Vb(){return null!=
this.t7g?this.t7g:this.t7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get eZc(){return null!=this.EVg?this.EVg:this.EVg=Ya.a.instance.resolve("WordEditor.UI.IDialogFactory")}Llg(){const b=this.CJ.length;for(let h=0;h<b;h++){const n=document.createElement("OPTION");n.value=h.toString();n.text=this.CJ[h];this.uqa.add(n,null)}}uOf(){if(this.QM=ok.a.Mp()){var b=(new Qq.WACStyleSet).iba(this.QM),h=b.uy(),n=b.JG;this.CJ=[];for(let L=0;L<n;L++){let ba;ba=ok.a.ei.qr?h.rla(L):b.yBa(L);if(!this.Vb.isHidden(ba)&&
this.Vb.ke(ba,b)){var B=this.Vb.FF(ba);if(2===B||1===B)ba.hasProperty(Lc.a.linkedStyle)&&2!==B||(B=ba.ja(Lc.a.gE,null))&&0<B.length||this.CJ.push(this.Vb.aK(ba))}}this.CJ.sort()}else Vc.b(578650370,3018,15,"PageContentNode is null")}}Object(u.a)(sJ,"DeleteStyleDialog",Ge.a,[]);var eN=d(839);class tv{constructor(b){this.Yl=null;this.rR=b}}Object(u.a)(tv,"PropertySetChangedState",null,[]);class RK{static ygo(b,h,n){if(b&&h){var B=new tv(h),L=(ba,la,La)=>{n.xgo(ba,la,La,B)};b=new eN.a(h,b);b.VRd=L;b.vVd=
L;b.Gue=L;b.Rcb()}}}Object(u.a)(RK,"PropertySetChangedManager",null,[]);class SK{constructor(b){this.SSa=b}xgo(b,h,n,B){const L=this.SSa[b.id.toString()];L&&L(b,h,n,B)}}Object(u.a)(SK,"PropertyChangedProcessor",null,[]);const MF=(b,h,n)=>{const B=dt.a.instance.FOb;if(B){const L=new Sd.GraphTransaction(15);L.Ab(B);RK.ygo(b,h,new SK(n));L.dispose()}};class VB{static get kh(){return Ge.a.az(VB.Mn,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,
WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}VB.Mn="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(u.a)(VB,"MarginsDialogHtml",null,[]);class Kp{static get u8(){return null!=Kp.u2g?Kp.u2g:Kp.u2g=Ya.a.instance.Oa("WordEditor.IPageCommands")}static mIn(b,h,n){Kp.u8&&null!==n&&Kp.u8.eye(0,n)}static iIn(b,h,n){Kp.u8&&null!==n&&Kp.u8.eye(3,n)}static kIn(b,h,n){Kp.u8&&null!==n&&Kp.u8.eye(1,n)}static lIn(b,h,n){Kp.u8&&null!==n&&Kp.u8.eye(2,n)}static c8n(b,h,n){Kp.u8&&null!==n&&Kp.u8.z_a(0,n)}static D7n(b,h,n){Kp.u8&&null!==n&&Kp.u8.z_a(1,n)}static bvl(b,h,n){Kp.u8&&null!==n&&(b==ye.a.GG?Kp.u8.qxe(0,
n):b==ye.a.WH?Kp.u8.qxe(1,n):b==ye.a.vra?Kp.u8.qxe(2,n):b==ye.a.separator&&Kp.u8.qxe(3,n))}}Object(u.a)(Kp,"PageLevelPropertyChangedHandlers",null,[]);const TK=[Dc.a.lgd,Dc.a.kgd,Dc.a.Voe,Dc.a.Woe,Dc.a.fse,Dc.a.cse,Dc.a.dse,Dc.a.ese];class hx extends Ge.a{constructor(b,h,n,B,L){super();this.T1c=(ba,la)=>{var La=hx.Did(ba);ba=$e.App.Pba;this.xq.hasProperty(La)?(La=this.xq.getValue(La),la[Ki.a.Number]=Fg.a.OPa(La,ba)):la[Ki.a.Number]=0;la[Ki.a.UnitType]=ba};this.Knd=(ba,la)=>{this.xq.setValue(hx.Did(ba),
Fg.a.sPa(la[Ki.a.Number],la[Ki.a.UnitType]));this.xv.wn()};this.oIn=ba=>{let la=!1;1===ba&&(Math.abs(this.xq.getValue(Lc.a.marginTop))+Math.abs(this.xq.getValue(Lc.a.marginBottom))+$e.App.uFa<=this.Sya.getValue(Lc.a.qw)&&this.xq.getValue(Lc.a.marginLeft)+this.xq.getValue(Lc.a.marginRight)+$e.App.uFa<=this.Sya.getValue(Lc.a.rp)?MF(this.JGa,this.xq,hx.Wkc()):la=!0);this.dispose();la&&this.nOa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.jIn)};this.jIn=()=>{Ya.a.instance.resolve("WordEditor.UI.IDialogFactory").fai(this.JGa,
this.Sya,this.p$)};this.Qg="MarginsDialog";this.Sya=h.clone();this.JGa=b.clone();this.xq=b.clone();this.p$=n;this.eZ=!1;this.xv=L;this.kh=VB.kh;n&&(this.OFc=Zs.a.U1b);this.pi(WordEditorIntl.WordEditorStrings.L_PageMargins,this.oIn,null);this.P7c();this.g$e=document.getElementById("DialogMarginTopSpinner");this.v4(this.g$e)}Zba(){this.nUd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",Dc.a.lgd,Dc.a.fse,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.nUd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",Dc.a.kgd,Dc.a.cse,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.nUd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",Dc.a.Voe,Dc.a.dse,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.nUd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",Dc.a.Woe,Dc.a.ese,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}P7c(){for(const b of TK)Object(xm.a)(b,this.Knd,this.T1c);this.xv.Yua("DialogMarginTopSpinner");
this.xv.Yua("DialogMarginBottomSpinner");this.xv.Yua("DialogMarginLeftSpinner");this.xv.Yua("DialogMarginRightSpinner")}dispose(){for(const b of TK)Object(xm.b)(b);this.xv.R0("DialogMarginTopSpinner");this.xv.R0("DialogMarginBottomSpinner");this.xv.R0("DialogMarginLeftSpinner");this.xv.R0("DialogMarginRightSpinner");super.dispose()}nUd(b,h,n,B,L){n=hx.ogl(h,n,B,L);this.xKb(n,b,h)}xKb(b,h,n){h=document.getElementById(h);this.xv.S5a(n,b);b=this.xv.CPb(n,"Medium");h.appendChild(b)}static Wkc(){return hx.SSa||
(hx.SSa=hx.agc())}static agc(){const b={};b[Lc.a.marginTop.id.toString()]=Kp.mIn;b[Lc.a.marginBottom.id.toString()]=Kp.iIn;b[Lc.a.marginLeft.id.toString()]=Kp.kIn;b[Lc.a.marginRight.id.toString()]=Kp.lIn;return b}static ogl(b,h,n,B){let L=!0;if(h===Dc.a.lgd||h===Dc.a.kgd)L=!1;return cl.j(b,h,n,B,[hx.qgl(L),hx.pgl(L)])}static qgl(b){return cl.l("inch",b?"0":"-22","22",".1")}static pgl(b){return cl.l("centimeter",b?"0":"-55.8","55.8","1")}static Did(b){let h=null;switch(b){case Dc.a.lgd:case Dc.a.fse:h=
Lc.a.marginTop;break;case Dc.a.kgd:case Dc.a.cse:h=Lc.a.marginBottom;break;case Dc.a.Voe:case Dc.a.dse:h=Lc.a.marginLeft;break;case Dc.a.Woe:case Dc.a.ese:h=Lc.a.marginRight}return h}}hx.SSa=null;Object(u.a)(hx,"MarginsDialog",Ge.a,[]);class QH{static get kh(){return Ge.a.az(QH.Mn,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}QH.Mn="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(u.a)(QH,"PaperSizeDialogHtml",null,[]);const ix=[Dc.a.Zoe,Dc.a.Yoe,Dc.a.vse,Dc.a.tse];class Lp extends Ge.a{constructor(b,h,n,B,L){super();this.T1c=(ba,la)=>{var La=this.Did(ba);ba=$e.App.Pba;this.xq.hasProperty(La)?(La=this.xq.getValue(La),la[Ki.a.Number]=Fg.a.OPa(La,ba)):la[Ki.a.Number]=0;la[Ki.a.UnitType]=ba};this.Knd=(ba,la)=>{this.xq.setValue(this.Did(ba),Fg.a.sPa(la[Ki.a.Number],la[Ki.a.UnitType]));this.xv.wn()};this.p8n=ba=>{let la=!1;1===ba&&(this.xq.getValue(Lc.a.qw)>=$e.App.uFa+this.Sya.getValue(Lc.a.marginTop)+
this.Sya.getValue(Lc.a.marginBottom)&&this.xq.getValue(Lc.a.rp)>=$e.App.uFa+this.Sya.getValue(Lc.a.marginLeft)+this.Sya.getValue(Lc.a.marginRight)?MF(this.JGa,this.xq,Lp.Wkc()):la=!0);this.dispose();la&&this.nOa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.o8n)};this.o8n=()=>{Ya.a.instance.resolve("WordEditor.UI.IDialogFactory").Iai(this.JGa,this.Sya,this.p$)};this.Qg="PaperSizeDialog";this.Sya=h.clone();this.JGa=b.clone();this.xq=b.clone();this.p$=n;this.eZ=!1;this.xv=L;this.kh=QH.kh;
n&&(this.OFc=Zs.a.U1b);this.pi(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,this.p8n,null);this.P7c();this.g$e=document.getElementById("DialogWidthSpinner");this.v4(this.g$e)}Zba(){this.iYh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",Dc.a.Zoe,Dc.a.vse,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.iYh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",Dc.a.Yoe,Dc.a.tse,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}P7c(){for(const b of ix)Object(xm.a)(b,
this.Knd,this.T1c);this.xv.Yua("DialogWidthSpinner");this.xv.Yua("DialogHeightSpinner")}dispose(){for(const b of ix)Object(xm.b)(b);this.xv.R0("DialogWidthSpinner");this.xv.R0("DialogHeightSpinner");super.dispose()}iYh(b,h,n,B,L){n=Lp.Fgl(h,n,B,L);this.xKb(n,b,h)}xKb(b,h,n){h=document.getElementById(h);this.xv.S5a(n,b);b=this.xv.CPb(n,"Medium");h.appendChild(b)}Did(b){let h=null;switch(b){case Dc.a.Yoe:case Dc.a.tse:h=Lc.a.qw;break;case Dc.a.Zoe:case Dc.a.vse:h=Lc.a.rp}return h}static Wkc(){return Lp.SSa||
(Lp.SSa=Lp.agc())}static agc(){const b={};b[Lc.a.rp.id.toString()]=Kp.c8n;b[Lc.a.qw.id.toString()]=Kp.D7n;return b}static Fgl(b,h,n,B){return cl.j(b,h,n,B,[Lp.Hgl(),Lp.Ggl()])}static Hgl(){return cl.l("inch",Lp.nWj,Lp.rwn,Lp.a$o)}static Ggl(){return cl.l("centimeter",Lp.nWj,Lp.qwn,Lp.$9o)}}Lp.nWj="0";Lp.rwn="22";Lp.a$o=".1";Lp.$9o="1";Lp.qwn="55.8";Lp.SSa=null;Object(u.a)(Lp,"PaperSizeDialog",Ge.a,[]);const fN=RegExp("[{|}|;|\\\\]"),UK=b=>{if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,
n=b.JG;let B;for(B=1;B<=n;B++){const L=h+B;if(!(b.mWa(L)||b.mlc(L)||b.mWa(L+"Char")||b.mlc(L+"Char")))break}return h+B};class VK extends Ge.a{constructor(b,h,n,B,L){var ba,la,La,fb;super(!1,!1,!0);this.context=b;this.Sb=h;this.b3=n;this.Vb=B;this.gZa=L;this.$1d=null;this.Fyj=(Cb,Lb)=>{if(this.me.lw){if(0!==Cb){Cb="string"===typeof Lb.styleText?Lb.styleText:null;Lb=this.Tqd;var $b=Cb;const tc=F.a.XDa($b);let Nc=null;if(0===tc.length)Nc=WordEditorIntl.WordEditorStrings.l_StyleNameEmpty;else if(253<
$b.length)Nc=WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength;else if(fN.test($b))Nc=WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters;else if(Lb.zBa($b)||Lb.mlc(tc))Nc=WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;(Lb=Nc)?(this.$1d=Lb,Lb=UK(this.Tqd),Cb=this.BPb(Cb,Lb),this.$1d=null,this.eZ=!1,this.hide(),this.pi(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.Fyj,Cb),this.eZ=!0):(this.hide(),Lb=new Map,Lb.set("Source","ReactCreateNewStyleDialog"),Lb.set("Action",
"CreateStyle"),oa.Health.instance.recordKpiUsage(yq.a.vFa,0,yq.a.bD,Lb),this.fff(Cb)||(Cb=new Map,Cb.set("Source","ReactCreateNewStyleDialog"),Cb.set("Action","CreateStyle"),Cb=Object.assign(new rb.a,{extendedProperties:Cb}),oa.Health.instance.recordKpiFailure(yq.a.vFa,"CreateStyleFailed",!1,!0,Cb)))}else this.hide();this.me.f9()}};this.Qg="CreateNewStyleDialog";this.me=b.view;(b=null===(fb=null===(La=null===(la=null===(ba=this.me)||void 0===ba?void 0:ba.lb)||void 0===la?void 0:la.gb)||void 0===La?
void 0:La.currentSelection)||void 0===fb?void 0:fb.Ra)?(ba=b.node)?(this.Sh=this.gZa.Iu(ba))?(this.Tqd=(new Qq.WACStyleSet).cla(this.Sh),(this.VVb=this.b3.W2d(b))?(ba=this.VVb.ja(Hf.a.fontSize,22),16>ba?Vc.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=ba?Vc.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):90>=ba?Vc.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Vc.b(593078047,
3018,50,"Font size more than 45pt in create new style dialog preview"),this.Ssg(this.VVb),this.Sh&&this.VVb&&(this.Lda=!1,ba=UK(this.Tqd),ba=this.BPb(ba,ba),this.pi(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.Fyj,ba))):Vc.b(592737758,3018,10,"_newStyleProperties is null.")):Vc.b(592737757,3018,10,"_pageContenNode is null."):Vc.b(592725466,3018,10,"node is null."):Vc.b(556917206,3018,10,"nodeContext is null.")}Ssg(b){b.qg(lk.a.Yw,lk.a.Gw,...yq.a.kba())}BPb(b,h){const n=52<=this.VVb.ja(Hf.a.fontSize,
Qn.a.gP),B=Fx.a.VIf(this.VVb,"97%",26,!1,!0,n);B["padding-left"]="5px";n||(B["line-height"]="40px");b={["styleNameLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,["previewWindowLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,["styleName"]:b,["previewContainerText"]:h,["getPreviewStyle"]:()=>B};this.$1d&&(b.errorMessage=this.$1d);return{["id"]:this.Qg,["bodyControls"]:b}}fff(b){const h=new Sd.GraphTransaction(15);h.Ab(this.Sh);h.yi=wb.a.EMb;const n=
ok.a.fff(b,ok.a.AFi(this.VVb),null,this.Sh);n&&(Vc.b(593078046,3018,50,"User created linked style"),this.Tqd=(new Qq.WACStyleSet).cla(this.Sh),b=F.a.XDa(F.a.e0(b)),b=this.Tqd.mlc(b),this.Sb.lg(this.context,wb.a.HT,2,!1,new FI.a,this.Vb.Ae(b)));h.dispose();return n}}Object(u.a)(VK,"ReactCreateNewStyleDialog",Ge.a,[]);class DD extends Ge.a{constructor(b,h=!1,n){super(!1,!1,h);let B=h=this.IM=null;this.Qg=DD.id;this.Dh=b.view;this.zp=n;this.Dh&&(B=this.Dh.lb);B&&B.gb&&B.gb.currentSelection&&(h=B.gb.currentSelection.Ra);
h?(b=h.node)?(this.QM=Object($n.a)().Iu(b))||x.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):x.ULS.sendTraceTag(539762889,3029,10,"node is null"):x.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}UCp(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),n=this.Qgm();const B=""===F.a.XDa(b),L=b.length>DD.BJn;n=n.includes(b);h=h.test(b);b=b.startsWith("_");let ba=null;if(B||L||n||b||!h)ba=B?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:L?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:
b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return ba}zen(b,h){return b?b===h:!1}Qgm(){const b=this.zp.g5d(!1),h=[];for(let n=0;n<b.count;n++){const B=b.J(n).ja(Lc.a.yu,"");h.push(B)}return h}}DD.id="BookmarkEditDialog";DD.BJn=40;Object(u.a)(DD,"AEditBookmarkDialog",Ge.a,[]);class WK extends DD{constructor(b,h,n){super(b,!0,n);this.ZRe=null;this.K2a=
"wwaengidc";this.nKc="ReactCreateEditBookmarkNameDialog";this.Crh="EditBookmarkName";this.Oxa="EditBookmarkNameDialog";this.ULe=h;this.zp=n;this.QM&&(this.Lda=!1,b=this.BPb(h.properties.ja(Lc.a.yu,null)),this.pi(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.Hyj.bind(this),b))}Hyj(b,h){if(this.Dh.lw){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var n;this.ULe.hasProperty(Lc.a.yu)?n=this.ULe.getValue(Lc.a.yu):x.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.UCp(b);
this.zen(b,n)?(x.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.ZRe=h,n=this.BPb(b),this.ZRe=null,this.eZ=!1,this.hide(),this.pi(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.Hyj.bind(this),n),this.eZ=!0):(this.hide(),n=new Map,n.set("Source",this.nKc),n.set("Action",this.Crh),oa.Health.instance.recordKpiUsage(this.Oxa,0,this.K2a,n),this.inl(b)||(n=new Map,n.set("Source",this.nKc),n.set("Action",this.Crh),
n=Object.assign(new rb.a,{extendedProperties:n}),oa.Health.instance.recordKpiFailure(this.Oxa,"Unable to edit bookmark",!1,!0,n)))}else this.hide();this.Dh.f9()}}inl(b){b=F.a.XDa(F.a.e0(b));try{const h=this.zp.Ztp(this.ULe,b);if(h)x.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");else return x.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),h}catch(h){return x.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",
h.Message),!1}}BPb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.ZRe;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.Qg,["bodyControls"]:h}}}Object(u.a)(WK,"ReactEditBookmarkNameDialog",DD,[]);class mt extends Ge.a{constructor(b,h,n,B){super(!1,!1,!0);this.Zul=()=>{this.eZc.Q9h(this.RRi,this.kGe,this.sad)};this.$ul=(L,ba)=>{ba&&1===L&&(ba.columnsCountSpinButtonProps&&this.x0.setValue(ye.a.GG,ba.columnsCountSpinButtonProps.value),ba.columnsWidthSpinButtonProps&&
(L=ba.columnsWidthSpinButtonProps,this.x0.setValue(ye.a.WH,[Fg.a.sPa(L.value,Fg.a.IUa(L.unitType.toLowerCase()))])),ba.columnsSpacingSpinButtonProps&&(L=ba.columnsSpacingSpinButtonProps,this.x0.setValue(ye.a.vra,Fg.a.sPa(L.value,Fg.a.IUa(L.unitType.toLowerCase())))),ba.columnsLineBetweenCheckboxProps&&this.x0.setValue(ye.a.separator,ba.columnsLineBetweenCheckboxProps.checked),this.cvl()&&(ba=mt.PTd,this.T9k()?MF(this.RRi,this.x0,this.Wkc):ba=ba!==mt.PTd?ba:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,
this.dispose(),ba!==mt.PTd&&this.nOa(ba,this.Zul)))};this.cvl=()=>this.x0.hasProperty(ye.a.GG)&&this.x0.hasProperty(ye.a.WH)&&this.x0.hasProperty(ye.a.vra)&&this.x0.hasProperty(ye.a.separator);this.y5d=(L,ba,la)=>Math.floor((L-(ba-1)*la)/ba);this.QHf=(L,ba,la)=>1==ba?0:Math.floor((L-ba*la)/(ba-1));this.A3k=(L,ba,la,La)=>{const fb=L/ba;la<mt.uyc?(la=mt.uyc,La=this.QHf(L,ba,la)):la>fb&&(la=fb,La=this.QHf(L,ba,la));return[la,La]};this.w3k=(L,ba,la,La)=>{const fb=(L-mt.uyc*ba)/(ba-1);0>La?(La=0,la=this.y5d(L,
ba,La)):La>fb&&(La=fb,la=this.y5d(L,ba,La));return[la,La]};this.sPa=(L,ba)=>Fg.a.sPa(L,Fg.a.IUa(ba));this.cYc=(L,ba,la,La,fb)=>({["unitType"]:L,["unitPlaceholder"]:F.a.yqe(ba),["minValue"]:la,["maxValue"]:La,["step"]:fb});this.RRi=b.clone();this.x0=b.clone();this.kGe=h.clone();this.fwb=this.kGe.getValue(Lc.a.rp)-this.kGe.getValue(Lc.a.marginLeft)-this.kGe.getValue(Lc.a.marginRight);this.tVb=Math.floor(this.fwb/mt.uyc);this.sad=n;this.eZc=B;this.Qg=mt.id;b={};b.getUnitValue=3==$e.App.Pba?Fg.a.oB:Fg.a.C0a;
b.getCalculatedWidthValue=this.y5d;b.getCalculatedSpacingValue=this.QHf;b.twipsFromValueAndUnits=this.sPa;b.adjustWidthForLimits=this.A3k;b.adjustSpacingForLimits=this.w3k;b.pageContentWidth=this.fwb;b.maxColumnCount=this.tVb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.Ulm();b.columnsWidthSpinButtonProps=this.Ylm();b.columnsSpacingSpinButtonProps=this.Wlm();b.columnsLineBetweenCheckboxProps=
this.Vlm();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.pi(Box4Intl.Box4Strings.l_ColumnsDialogTitle,this.$ul.bind(this),b)}Ulm(){var b=[this.cYc("None",0,1,this.tVb,1)];const h=this.kOf(ye.a.GG);b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,["unitType"]:Fg.a.i7a(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",
["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.j0b(h,b)}Ylm(){var b=[this.cYc("Inch",3,.5,Fg.a.oB(this.fwb),.1),this.cYc("Centimeter",1,1.27,Fg.a.C0a(this.fwb),1)];const h=$e.App.Pba,n=this.kOf(ye.a.WH);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:Fg.a.i7a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",
["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.j0b(n,b)}Wlm(){var b=[this.cYc("Inch",3,0,Fg.a.oB(this.fwb-2*mt.uyc),.1),this.cYc("Centimeter",1,0,Fg.a.C0a(this.fwb-2*mt.uyc),1)];const h=$e.App.Pba,n=this.kOf(ye.a.vra);b={["type"]:"AppSpinButtonProps",["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,
["unitType"]:Fg.a.i7a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.j0b(n,b)}Vlm(){const b=this.x0.getValue(ye.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,
["checked"]:b}}get Wkc(){return null!=this.oYg?this.oYg:this.oYg=(()=>this.Suf())()}Suf(){const b={};b[ye.a.GG.id.toString()]=b[ye.a.WH.id.toString()]=b[ye.a.vra.id.toString()]=b[ye.a.separator.id.toString()]=Kp.bvl;return b}T9k(){const b=this.x0.getValue(ye.a.WH),h=this.x0.getValue(ye.a.GG),n=this.x0.getValue(ye.a.vra);let B=0;for(let L=0;L<h;L++)B+=b[0];if(h<=this.tVb&&(h-1)*n+B<=this.fwb)return!0;x.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",
h,b[0],n);return!1}kOf(b){if(this.x0.hasProperty(b)){if(b==ye.a.GG)return this.x0.getValue(b);if(b==ye.a.WH){var h=$e.App.Pba;b=this.x0.getValue(ye.a.vra);const n=this.x0.getValue(ye.a.GG);return Fg.a.OPa(this.y5d(this.fwb,n,b),h)}if(b==ye.a.vra){if(1==this.x0.getValue(ye.a.GG))return 0;h=$e.App.Pba;b=this.x0.getValue(b);return Fg.a.OPa(b,h)}}return 0}j0b(b,h){h.value=isNaN(b)?mt.PTd:b;return h}}mt.id="ColumnsDialog";mt.PTd="";mt.uyc=720;Object(u.a)(mt,"WordReactColumnsDialog",Ge.a,[]);var pG=d(510);
const pC=(b,h,n)=>{const B=[];if(b.length!==h.length||n&&n.length!==h.length)return B;for(let L=0;L<b.length;L++){const ba={};ba.key=h[L];ba.text=b[L];ba.type="AppComboBoxItem";n&&(ba.ariaLabel=n[L]);B[L]=ba}return B},xw=(b,h,n,B,L)=>({["unitType"]:b,["unitPlaceholder"]:F.a.yqe(h),["minValue"]:n,["maxValue"]:B,["step"]:L}),qG=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),GI=(b,
h,n)=>{let B=!1;b.hasProperty(h)&&b.hasProperty(n)?(n=b.getValue(n),1===n?(b=Number.NaN,h=5,B=!0):(b=b.getValue(h),h=2===n?4:5)):(b=Number.NaN,h=$e.App.QLa?4:5);return{vyc:b,Afb:h,Enc:B}};class HI{constructor(){this.GWj=this.srj=this.qrj=this.t8n=this.xjg=!1}}Object(u.a)(HI,"Box4PropertySetChangedState",null,[]);class cm{static get Tmc(){return null!=cm.XYg?cm.XYg:cm.XYg=Ya.a.instance.Oa("Box4.IIndentationCommands")}static get b5i(){return null!=cm.L0g?cm.L0g:cm.L0g=Ya.a.instance.Oa("Box4.IJustificationCommands")}static get X8(){return null!=
cm.t4g?cm.t4g:cm.t4g=Ya.a.instance.Oa("Box4.ISpacingCommands")}static nvn(b,h,n){cm.b5i&&n&&(null===h||11!==n||10!==h&&9!==h)&&cm.b5i.rH(n)}static Qyn(b,h,n){cm.X8&&n&&cm.X8.QE(n)}static tAl(b,h,n){h!=n&&cm.X8.bxc(n)}static Avn(b,h,n){h!=n&&cm.X8.cod(n)}static EFp(b,h,n){h!=n&&cm.X8.Uod(n)}static yvn(b,h,n){h!=n&&cm.X8.bod(n)}static xrj(b,h,n,B){cm.X8&&void 0!==n&&null!==n&&(b=cm.k2c(B),!b.xjg&&B.rR.hasProperty(zd.a.Btc)&&B.rR.hasProperty(zd.a.Ctc)&&(h=B.rR.getValue(zd.a.Ctc),B=B.rR.getValue(zd.a.Btc),
b.xjg=!0,cm.X8.vha(1,h,B)))}static wrj(b,h,n,B){cm.X8&&void 0!==n&&null!==n&&(b=cm.k2c(B),!b.t8n&&B.rR.hasProperty(zd.a.ztc)&&B.rR.hasProperty(zd.a.Atc)&&(h=B.rR.getValue(zd.a.Atc),B=B.rR.getValue(zd.a.ztc),b.xjg=!0,cm.X8.vha(0,h,B)))}static prj(b,h,n,B){cm.Tmc&&void 0!==n&&null!==n&&(b=cm.k2c(B),!b.qrj&&B.rR.hasProperty(zd.a.kNa)&&B.rR.hasProperty(zd.a.lNa)&&(h=B.rR.getValue(zd.a.lNa),B=B.rR.getValue(zd.a.kNa),b.qrj=!0,cm.Tmc.fPj(1,h,B)))}static rrj(b,h,n,B){cm.Tmc&&void 0!==n&&null!==n&&(b=cm.k2c(B),
!b.srj&&B.rR.hasProperty(zd.a.kwb)&&B.rR.hasProperty(zd.a.lwb)&&(h=B.rR.getValue(zd.a.lwb),B=B.rR.getValue(zd.a.kwb),b.srj=!0,cm.Tmc.fPj(0,h,B)))}static SEg(b,h,n,B){cm.Tmc&&void 0!==n&&null!==n&&(b=cm.k2c(B),!b.GWj&&B.rR.hasProperty(zd.a.S_a)&&B.rR.hasProperty(zd.a.T_a)&&(h=0,B.rR.hasProperty(zd.a.Y8)&&(h=B.rR.getValue(zd.a.Y8)),n=B.rR.getValue(zd.a.T_a),B=B.rR.getValue(zd.a.S_a),b.GWj=!0,cm.Tmc.Aye(h,n,B)))}static k2c(b){b.Yl||(b.Yl=new HI);return b.Yl}}Object(u.a)(cm,"ParagraphLevelPropertyChangedHandlers",
null,[]);class vy{constructor(){this.SSa=null}kEm(b){const h={};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var n=xw("Point",5,0,1584,1),B=xw("Line",4,0,327,1),L=[n,B];B=qG();var ba=[Box4Intl.Box4Strings.L_SpinnerAuto];n=[""];({vyc:La,Afb:la,Enc:fb}=GI(b,zd.a.Ctc,zd.a.Btc));var la={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Fg.a.i7a(la),["validUnits"]:L,["numberFormatInfo"]:B,["validReservedValues"]:ba};fb?la.reservedValue=ba[0]:la.value=isNaN(La)?"":La;h.beforeSpacingSpinButtonProps=la;({vyc:La,Afb:la,Enc:fb}=GI(b,zd.a.Atc,zd.a.ztc));L={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Fg.a.i7a(la),
["validUnits"]:L,["numberFormatInfo"]:B,["validReservedValues"]:ba};fb?L.reservedValue=ba[0]:L.value=isNaN(La)?"":La;h.afterSpacingSpinButtonProps=L;if(ba=L=b.hasProperty(zd.a.xa))ba=vy.ebb.dQb(b),ba=b.hasProperty(zd.a.xa)&&b.hasProperty(zd.a.fbb)&&2===b.getValue(zd.a.fbb)?!Se.a.pCa(ba,1)&&!Se.a.pCa(ba,1.5)&&!Se.a.pCa(ba,2):!1;if(L){var La=vy.ebb.dQb(b);L=0;var fb=!1;b.hasProperty(zd.a.xa)&&b.hasProperty(zd.a.fbb)||(fb=!0);fb||(2!==b.getValue(zd.a.fbb)&&(fb=!0),L=La,1>L&&(fb=!0));fb?L="":(La="multiple",
ba||(Se.a.pCa(L,1)?La="1.00":Se.a.pCa(L,1.5)?La="1.50":Se.a.pCa(L,2)&&(La="2.00")),L=La)}else L=null;La={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:pC([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],
["1.00","1.50","2.00","multiple"]),["allowFreeForm"]:!1};L?La.selectedKey=L:La.defaultSelectedKey="";h.lineSpacingComboBoxProps=La;L=0;La=!1;b.hasProperty(zd.a.xa)&&b.hasProperty(zd.a.fbb)&&2===b.getValue(zd.a.fbb)&&ba&&(L=vy.ebb.dQb(b),La=!0,1>L&&(L=Number.NaN));b=[xw("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,
["numberFormatInfo"]:B,["validReservedValues"]:n};La?b.value=L:b.reservedValue=n[0];h.atSpinButtonProps=b;return h}Wkc(){return this.SSa||(this.SSa=this.agc())}agc(){const b={};b[zd.a.xa.id.toString()]=cm.Qyn;b[zd.a.Atc.id.toString()]=cm.wrj;b[zd.a.ztc.id.toString()]=cm.wrj;b[zd.a.Ctc.id.toString()]=cm.xrj;b[zd.a.Btc.id.toString()]=cm.xrj;return b}static get ebb(){return null!=vy.W0g?vy.W0g:vy.W0g=Ya.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(u.a)(vy,"ReactParagraphDialog",null,[]);const II=
b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,rG=(b,h,n,B)=>{let L=$e.App.Pba;b.hasProperty(h)&&b.hasProperty(n)&&!B?(h=b.getValue(h),b=b.getValue(n),h?2===b?L=2:h=Fg.a.OPa(h,L):$e.App.QLa&&(L=2)):(h=Number.NaN,$e.App.QLa&&(L=2));return{vyc:h,Afb:L}},jK=b=>{let h="0";b.hasProperty(zd.a.Y8)&&(b=b.getValue(zd.a.Y8),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},sG=(b,h)=>{if(h.hasProperty(zd.a.Y8)&&2===h.getValue(zd.a.Y8)&&h.hasProperty(zd.a.T_a)&&h.hasProperty(zd.a.S_a)&&
b.hasProperty(zd.a.lNa)&&b.hasProperty(zd.a.kNa)){var n=b.getValue(zd.a.lNa),B=b.getValue(zd.a.kNa);n=(new vr.a(B,n)).Nu;B=h.getValue(zd.a.T_a);h=h.getValue(zd.a.S_a);h=(new vr.a(h,B)).Nu;b.setValue(zd.a.lNa,n+h);b.setValue(zd.a.kNa,1)}},UM=b=>{const h=b.getValue(zd.a.lNa);b=b.getValue(zd.a.kNa);return(new vr.a(b,h)).Nu},JI=b=>{const h=b.getValue(zd.a.lwb);b=b.getValue(zd.a.kwb);return(new vr.a(b,h)).Nu},KI=(b,h)=>h.hasProperty(zd.a.lNa)&&h.hasProperty(zd.a.kNa)&&h.hasProperty(zd.a.lwb)&&h.hasProperty(zd.a.kwb)&&
b.hasProperty(Lc.a.marginLeft)&&b.hasProperty(Lc.a.marginRight)&&b.hasProperty(Lc.a.rp),kK=b=>b.hasProperty(zd.a.Pgd)?b.getValue(zd.a.Pgd):!1,lK=b=>b.hasProperty(ye.a.keepWithNext)?b.getValue(ye.a.keepWithNext):!1,mK=b=>b.hasProperty(ye.a.widowControl)?b.getValue(ye.a.widowControl):!1,nK=b=>b.hasProperty(ye.a.keepTogether)?b.getValue(ye.a.keepTogether):!1;class kr extends Ge.a{constructor(b,h,n,B){super(!1,!1,!0);this.pLh=null;this.C8n=()=>{Ya.a.instance.resolve("Box4.UI.IBox4DialogFactory").XYd(this.JGa,
this.Sya,this.p$)};this.E8n=(fb,Cb)=>{if(Cb&&(1===fb||2===fb)){if(Cb.alignmentComboBoxProps){var Lb=parseInt(Cb.alignmentComboBoxProps.selectedKey);isNaN(Lb)||II(Lb)&&this.xq.setValue(zd.a.Fx,Lb)}var $b=Cb.bySpinButtonProps;Lb=!!$b&&""!==$b.value;var tc=Cb.didChangeSpecialIndentationComboBoxValue;if(Cb.specialIndentationComboBoxProps){var Nc=parseInt(Cb.specialIndentationComboBoxProps.selectedKey);1!==Nc&&2!==Nc&&Nc||!(Nc||tc||Lb)||this.xq.setValue(zd.a.Y8,Nc)}if($b){Nc=$b.value;$b=Fg.a.IUa($b.unitType.toLowerCase());
let dd;0<=Nc||(Nc=0);2===$b?dd=2:(dd=1,Nc=Fg.a.sPa(Nc,$b));if(Lb||tc)this.xq.setValue(zd.a.T_a,Nc),this.xq.setValue(zd.a.S_a,dd)}Cb.beforeTextSpinButtonProps&&(tc=Cb.beforeTextSpinButtonProps,Lb=Fg.a.IUa(tc.unitType.toLowerCase()),tc=""===tc.value?Number.NaN:tc.value,isNaN(tc)||(Nc=tc,2===Lb?$b=2:($b=1,Nc=Fg.a.sPa(tc,Lb)),this.xq.setValue(zd.a.lNa,Nc),this.xq.setValue(zd.a.kNa,$b)));Cb.afterTextSpinButtonProps&&(tc=Cb.afterTextSpinButtonProps,Lb=Fg.a.IUa(tc.unitType.toLowerCase()),tc=""===tc.value?
Number.NaN:tc.value,isNaN(tc)||(Nc=tc,2===Lb?$b=2:($b=1,Nc=Fg.a.sPa(tc,Lb)),this.xq.setValue(zd.a.lwb,Nc),this.xq.setValue(zd.a.kwb,$b)));Cb.beforeSpacingSpinButtonProps&&(Lb=Cb.beforeSpacingSpinButtonProps,tc=Fg.a.IUa(Lb.unitType.toLowerCase()),Nc=Lb.reservedValue,""!==Lb.value&&(Nc===Box4Intl.Box4Strings.L_SpinnerAuto?(tc=1,Lb=0):(tc=4===tc?2:4,Lb=Lb.value),this.xq.setValue(zd.a.Ctc,Lb),this.xq.setValue(zd.a.Btc,tc)));Cb.afterSpacingSpinButtonProps&&(Lb=Cb.afterSpacingSpinButtonProps,tc=Fg.a.IUa(Lb.unitType.toLowerCase()),
Nc=Lb.reservedValue,""!==Lb.value&&(Nc===Box4Intl.Box4Strings.L_SpinnerAuto?(tc=1,Lb=0):(tc=4===tc?2:4,Lb=Lb.value),this.xq.setValue(zd.a.Atc,Lb),this.xq.setValue(zd.a.ztc,tc)));if(Cb.atSpinButtonProps||Cb.lineSpacingComboBoxProps)if(Lb=Cb.atSpinButtonProps.value,1<Lb)this.xq.setValue(zd.a.xa,Lb),this.xq.setValue(zd.a.fbb,2);else if(Lb=Cb.lineSpacingComboBoxProps.selectedKey)Lb="1.00"===Lb?1:"1.50"===Lb?1.5:"2.00"===Lb?2:0,Lb=1<=Lb?Lb:1,this.xq.setValue(zd.a.xa,Lb),this.xq.setValue(zd.a.fbb,2);Cb.contextualSpacingCheckboxProps&&
this.xq.setValue(zd.a.Pgd,Cb.contextualSpacingCheckboxProps.checked);Cb.keepWithNextCheckboxProps&&this.xq.setValue(ye.a.keepWithNext,Cb.keepWithNextCheckboxProps.checked);Cb.widowOrphanCheckboxProps&&this.xq.setValue(ye.a.widowControl,Cb.widowOrphanCheckboxProps.checked);Cb.keepTogetherCheckboxProps&&this.xq.setValue(ye.a.keepTogether,Cb.keepTogetherCheckboxProps.checked);sG(this.JGa,this.JGa);sG(this.xq,this.JGa);Cb="";Lb=this.Sya;tc=this.xq;if(Nc=KI(Lb,tc))Nc=tc.hasProperty(zd.a.T_a)&&tc.hasProperty(zd.a.S_a);
Nc?(Nc=tc.getValue(zd.a.T_a),$b=tc.getValue(zd.a.S_a),Nc=(new vr.a($b,Nc)).Nu,Lb=UM(tc)+JI(tc)+Lb.getValue(Lc.a.marginRight)+Lb.getValue(Lc.a.marginLeft)+Nc+$e.App.uFa<=Lb.getValue(Lc.a.rp)):Lb=KI(Lb,tc)?UM(tc)+JI(tc)+Lb.getValue(Lc.a.marginRight)+Lb.getValue(Lc.a.marginLeft)+$e.App.uFa<=Lb.getValue(Lc.a.rp):!0;Lb?MF(this.JGa,this.xq,this.IRm(this.Q8e?this.Q8e.agc():{})):Cb=""!==Cb?Cb:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==Cb?this.nOa(Cb,this.C8n):2===fb&&(Pe.c(Dc.a.Zxc,
!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Pb(Dc.a.Zxc,2,null))}};this.JGa=b.clone();this.xq=b.clone();this.Sya=h.clone();this.p$=n;this.ga=B;this.Q8e=new vy;b=this.Q8e.kEm(this.xq);h=xw("Inch",3,-11,22,.1);n=xw("Inch",3,0,22,.1);var L=xw("Centimeter",1,-27.94,55.88,1);B=xw("Centimeter",1,0,55.88,1);var ba=xw("Character",2,-316.8,316.8,.5),la=xw("Character",2,0,316.8,.5);h=[h,L,ba];B=[n,B,la];n=qG();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,
["forId"]:"GeneralGroup"};L=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];ba=["1","2","3","6","7"];let La=5;la=this.xq.hasProperty(zd.a.Fx)?this.xq.getValue(zd.a.Fx):0;if(10===la||9===la)la=11;if(A.AFrameworkApplication.lcid===hj.a.Cg("AR-SA").LCID||11===la)b.isKashidaSupported=!0,L[La]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,
ba[La]="11",La=6;if(A.AFrameworkApplication.lcid===hj.a.Cg("TH-TH").LCID||13===la)b.isThaiSupported=!0,L[La]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,ba[La]="13";L={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:pC(L,ba),["allowFreeForm"]:!1};II(la)?L.selectedKey=la.toString():L.defaultSelectedKey="";b.alignmentComboBoxProps=
L;b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};la={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:lK(this.xq)};b.keepWithNextCheckboxProps=la;la={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:mK(this.xq)};
b.widowOrphanCheckboxProps=la;la={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:nK(this.xq)};b.keepTogetherCheckboxProps=la;b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};L=jK(this.xq);la="0"===L;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:pC([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:L,["allowFreeForm"]:!1};ba=$e.App.Pba;L=0;({vyc:L,Afb:ba}=rG(this.xq,zd.a.T_a,zd.a.S_a,la));B={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Fg.a.i7a(ba),["validUnits"]:B,["numberFormatInfo"]:n};B=this.j0b(L,B);b.bySpinButtonProps=B;la=$e.App.Pba;B=0;({vyc:B,Afb:la}=rG(this.xq,zd.a.lNa,zd.a.kNa,!1));la={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Fg.a.i7a(la),["validUnits"]:h,["numberFormatInfo"]:n};
la=this.j0b(B,la);b.beforeTextSpinButtonProps=la;la=$e.App.Pba;B=0;({vyc:B,Afb:la}=rG(this.xq,zd.a.lwb,zd.a.kwb,!1));h={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Fg.a.i7a(la),["validUnits"]:h,["numberFormatInfo"]:n};h=this.j0b(B,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};n={["type"]:"AppCheckboxInternalProps",
["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:kK(this.xq)};b.contextualSpacingCheckboxProps=n;h.dialogButtonsOption=9;b=pG.a.isSharedUxGateEnabled("SharedOnline.ChangeGate.DialogButtonSpacingFix");h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions,["positionInFooter"]:b?"left":void 0};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:b?
void 0:"left",["margin-left"]:"0"}}};this.pi(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.E8n,h)}IRm(b){return this.pLh||(this.pLh=this.Suf(b))}Suf(b){b[zd.a.Fx.id.toString()]=cm.nvn;b[zd.a.kNa.id.toString()]=cm.prj;b[zd.a.lNa.id.toString()]=cm.prj;b[zd.a.kwb.id.toString()]=cm.rrj;b[zd.a.lwb.id.toString()]=cm.rrj;b[zd.a.Y8.id.toString()]=cm.SEg;b[zd.a.S_a.id.toString()]=cm.SEg;b[zd.a.T_a.id.toString()]=cm.SEg;b[zd.a.Pgd.id.toString()]=cm.tAl;b[ye.a.keepWithNext.id.toString()]=cm.Avn;b[ye.a.widowControl.id.toString()]=
cm.EFp;b[ye.a.keepTogether.id.toString()]=cm.yvn;return b}j0b(b,h){h.value=isNaN(b)?"":b;return h}}Object(u.a)(kr,"WordReactParagraphDialog",Ge.a,[]);class tJ{HDl(b){new BD(b,Ya.a.instance.resolve("Box4.IFeatureHelper"))}OHl(b,h){new VK(b,h,Ya.a.instance.resolve("Box4.IFormattingReader"),Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),Object($n.a)())}ZYl(b,h,n){new WK(b,h,n)}fai(b,h,n){new hx(b,h,n,Ya.a.instance.resolve("WordEditor.IPageCommands"),Ya.a.instance.resolve("Common.IStandaloneRootController").Bha)}Iai(b,
h,n){new Lp(b,h,n,Ya.a.instance.resolve("WordEditor.IPageCommands"),Ya.a.instance.resolve("Common.IStandaloneRootController").Bha)}Q9h(b,h,n){new mt(b,h,n,Ya.a.instance.resolve("WordEditor.UI.IDialogFactory"))}ZCl(b){return new Ts(b)}XYd(b,h,n){new kr(b,h,n,A.AFrameworkApplication.va)}JQl(){const b=Ya.a.instance.Oa("Box4.IRoamingServiceRequestManager");null==b?Vc.b(524834398,3018,10,"Roaming service not resolved."):new CD(b)}OQl(b,h){new QK(b,h)}Uwf(b){return new sJ(b)}}Object(u.a)(tJ,"DialogFactory",
null,[213,214]);class WB extends Ge.a{constructor(b,h){super(!1,!1,!0);this.Chi="DoNotCheckSpellingCheckbox";this.Ohi="DocumentChoiceGroup";this.tzd=0;this.v5i="LanguageList";this.documentContext="DocumentContext";this.$r="RangeContext";this.JUo=(n,B)=>{const L=Yc.a.instance.rq(wb.a.yOj);if(1!==n)L.properties.Z("canceled","true");else{n=B[this.v5i].replace(WB.$Rg,"");var ba=parseInt(n),la=Boolean.parse(B[this.Chi]);B=B[this.Ohi];B===this.documentContext?this.SFd.wSo(ba,la):this.SFd.RXo(ba,la);L.properties.Z("PreviousLCID",
this.tzd.toString());L.properties.Z("ChangedLCID",ba.toString());L.properties.Z("NoProof",la.toString());this.Grh.IUo(ba,this.tzd);Pe.d(wb.a.yOj,!0,void 0,void 0,void 0,void 0,[Object.assign(new ia.a,{name:"SelectedLcid",string:n}),Object.assign(new ia.a,{name:"NoProof",string:la.toString()}),Object.assign(new ia.a,{name:"Context",string:B})]);Ua.StaticActiveAppFrame.za().Ie(!0)}L.end()};this.Grh=h;this.SFd=b}KDg(){const b=Array(2);b[0]={["key"]:this.$r,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};
b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps={["id"]:this.Ohi,["defaultSelectedKey"]:this.ipm(),["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.tzd=({xio:this.Dsk}=this.SFd.GJm()).returnValue;h.languageListPropsProvider=this.sxm();h.spellingCheckboxProps={["id"]:this.Chi,["checked"]:!this.Dsk,
["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.pi(Box4Intl.Box4Strings.l_Language,this.JUo,{["id"]:"LanguageDialog",["bodyControls"]:h})}ipm(){return this.SFd.mf()?this.documentContext:this.$r}sxm(){return()=>{let b,h;const n=({selectedIndex:b,yyc:h}=this.Grh.rxm(this.tzd)).returnValue;for(let B=0;B<n.length&&B<h;B++)n[B].value=WB.$Rg+n[B].value;return{["id"]:this.v5i,["items"]:n,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}WB.$Rg="recent-";Object(u.a)(WB,
"ReactLanguageDialog",Ge.a,[212]);class XK extends LF{constructor(b,h,n,B){super(h,n);this.nlg=()=>{this.sR.wn()};this.gi=b;this.SK=B}Enb(b,h,n){if(b=super.Enb(b,h,n))b.suc=!0,b.fre=!0,b.preventDismissOnScroll=!0;this.gi.$5a(this.nlg);return b}K7c(b,h,n=null){this.SK.qWh(()=>this.Enb(b,h,n))}Xme(){this.sR.suc=!0}}Object(u.a)(XK,"ExternalContentFloatieInitializer",LF,[]);class gN{HXb(){Yl.instance.nga&&(zp.instance.Kfb([1,0]),Yl.instance.ahe()&&nq.instance.Kfb([1]))}}Object(u.a)(gN,"RulerUser",null,
[207]);class qk{constructor(){this.whitelistedControlIds=null}}Object(u.a)(qk,"StatusBarProps",null,[]);class Fh{constructor(b,h,n=!0){this.sa=new mg.a;this.dYj=()=>4;this.zKd=!1;this.Z5e=null;this.sja=h.hJ;this.j$e=h.aYj;n?ml.a.get_instance().Lk(7,()=>{this.lYh(b,h)}):this.lYh(b,h)}lYh(b,h){const n={};n.StatusBarBuildStartTime=Date.now();window.setTimeout(()=>{n.FirstTimeoutCallbackExecutionStartTime=Date.now();Rn.a.instance.Yd(()=>{Wk.UISurfaces.JLm().then(B=>{n.StatusBarApiResolutionTime=Date.now();
const L=Object.assign(new qk,{whitelistedControlIds:h.whitelistedControlIds});B.initializeNewStatusBar(b,L,this.j$e);this.Z5e=B;this.zKd=!0;n.ReactStatusBarInitializedTime=Date.now();window.setTimeout(()=>{n.SecondTimeoutCallbackExecutionStartTime=Date.now();Rn.a.instance.Yd(()=>{const ba=[];if(h.eJ){const la=h.eJ;for(const La in la)ba.push(appChrome.actions.updateControlHiddenState(La,la[La]));appChrome.api.dispatch(ba)}n.PollingStartTime=Date.now();this.HXb();n.PollingEndTime=Date.now();x.ULS.sendTraceTag(509748573,
813,50,JSON.stringify(n))},"RSB:I2")},0);A.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.RaiseReactStatusBarInitializedEvent")&&this.Gmo();return null}).catch(()=>{x.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(h.Wva&&b){Fh.Rkh||(A.AFrameworkApplication.va.ra(Pa.a.cYj,id.a.frame,this.dYj),A.AFrameworkApplication.va.ra(Pa.a.bYj,id.a.frame,this.dYj),Fh.Rkh=!0);const B=Zs.a.Wbe(h.Wva,h.QNj,b,!1);B.iK=!0;this.LYb(B,
Pa.a.cYj,Pa.a.bYj)}},0)}HXb(){this.zKd&&this.sja&&window.setTimeout(()=>{this.sja(this.Z5e.selectors.getStatusBarControlsMap(this.j$e),7)},0)}gyb(b,h){this.zKd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,h))},0)}nS(b){this.zKd&&this.sja&&window.setTimeout(()=>{const h=this.Z5e.selectors.getStatusBarControlsMap(this.j$e);if(h[b]){const n={};n[b]=h[b];this.sja(n,7)}},0)}LYb(b,h,n){const B=bb.KeyInputManager.lc(Jd.a.xz,0),L=bb.KeyInputManager.lc(Jd.a.xz,
4);b.tt(B);b.tt(L);b.bindAction(B,h);b.bindAction(L,n)}Gmo(){this.sa&&(this.sa.raiseEvent("RSBIE"),this.sa.dispose(),this.sa=null)}}Fh.Rkh=!1;Object(u.a)(Fh,"ReactStatusBar",null,[]);class uv{constructor(){this.whitelistedControlIds=this.eJ=this.hJ=null;this.Wtn=!1;this.QNj=this.Wva=this.aYj=null}}Object(u.a)(uv,"ReactStatusBarInitOptions",null,[]);var Ho=d(437);class Xp{constructor(b,h,n,B,L){this.u$b=this.TSa=this.Ga=null;this.Ocp=()=>{const ba=Ua.StaticActiveAppFrame.za().sq.getRegion(Mk.a.Wva);
ba&&ba.O9f()};this.OXm=(ba,la,La,fb,Cb)=>{if(!Cb)return x.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),8;if(1===La)return 32;Cb&&2===Cb.length&&this.TSa&&this.TSa.gyb(Cb[0],Cb[0]);return 32};this.Ptd=ba=>{Ua.StaticActiveAppFrame.za().hJ(ba)};this.ga=B;Rn.a.instance.Yd(()=>{this.Ga=L;this.u$b=this.TSa=null;const ba={};A.AFrameworkApplication.dVj||(ba[Ho.a.nJo]=!0);ba.GiveFeedback=!A.AFrameworkApplication.sH;this.Ga.$("OfficeOnlineInGallatinTextVisible")||
(ba.CenterStatusLabel=!0);ba[Ho.a.Kqj]=!0;this.Ga.$("WPMPackageIsEnabled")&&this.Ga.$("WPMStatusBarLabelIsEnabled")||(ba[Ho.a.CPg]=!0);this.Ga.$("AddInCommandsIsEnabled")||(ba[Ho.a.hXk]=!0);this.Ga.$("WordEditorShowOcsConnectionStatus")||(ba[Ho.a.pdg]=!0);ba[Ho.a.qGp]=!0;this.Ga.$("ReadingTimeIsEnabled")||(ba[Ho.a.Uyj]=!0);window.setTimeout(()=>{this.Q7m(b,ba)},0)},"SBU:I")}Wb(){this.ga.fb(wb.a.kBe,oc.a.application,this.OXm,96)}Q7m(b,h){this.u$b=Ya.a.instance.Oa("WordEditor.WordEditorReactCommandDefinitionMapping");
const n={};for(const L in h){var B=h[L];n[this.nNf(L)]=B}this.TSa=new Fh(b,Object.assign(new uv,{eJ:n,hJ:this.Ptd,Wtn:!1,aYj:"WordEditorStatusBar",Wva:Mk.a.Wva,QNj:this.Ocp}))}nNf(b){let h="";if(this.u$b){const n=this.u$b.NJf(b);n&&0<n.count&&(h=n.J(0))}return h&&""!==h?h:b}HXb(){this.TSa&&this.TSa.HXb()}gyb(b,h){this.TSa&&this.TSa.gyb(this.nNf(b),h)}nS(b){this.TSa&&this.TSa.nS(this.nNf(b))}dispose(){}}Object(u.a)(Xp,"StatusBarUser",null,[206,13]);var ED=d(1154);class jx{constructor(b){this.Cld=(h,
n,B,L,ba)=>{this.ga.Ob(this.Urm(ba[ED.a.xpe]),2);return 32};this.ga=b;this.ga.ra(Pa.a.Cld,id.a.frame,this.Cld);this.ga.ra(Pa.a.qFj,id.a.frame,Ce.ActionManager.Zf)}}Object(u.a)(jx,"FileMenuSQMInformation",null,[1476]);class uJ extends jx{constructor(b){super(b);this.pto()}pto(){this.ga.ra(Pa.a.lug,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.kFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.mug,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.lFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.mFj,
id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.nug,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.nFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.oFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.pFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.QFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Dc.a.jFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.RFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.tFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.uFj,id.a.frame,Ce.ActionManager.Zf)}Urm(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return Pa.a.lug;
case "tabHome":case "FileHomePage":return A.AFrameworkApplication.Ld("1ba3i132;45gid285"),Pa.a.kFj;case "menuJewelInfo":case "FileInfoPage":return Pa.a.mug;case "menuJewelNew":case "FileNewPage":return Pa.a.lFj;case "menuJewelOpen":case "FileOpenPage":return Pa.a.mFj;case "menuJewelPrint":case "FilePrintPage":return Pa.a.nug;case "menuJewelSaveAs":case "FileSaveAsPage":return Pa.a.nFj;case "menuJewelDownload":case "FileDownloadPage":return Dc.a.jFj;case "menuJewelShare":case "FileSharePage":return Pa.a.oFj;
case "menuJewelTransform":case "FileTransformPage":return Pa.a.pFj}return Pa.a.qFj}}Object(u.a)(uJ,"WordEditorFileMenuSQMInformation",jx,[]);var mz=d(1152);class YK{constructor(b){this.ga=b;this.ga.ra(Pa.a.Dld,id.a.frame,Object(z.a)(this,this.Dld,"reportTabSwitch"));this.ga.ra(Pa.a.LFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.NFj,id.a.frame,Ce.ActionManager.Zf)}Dld(b,h,n,B,L){this.ga.Ob(this.CIm(L[mz.a.fHg]),2);return 32}}Object(u.a)(YK,"RibbonSQMInformation",null,[1435]);class hN extends YK{constructor(b){super(b);
this.Kvo()}Kvo(){this.ga.ra(Pa.a.CFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.EFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Dc.a.pug,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.FFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.GFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Dc.a.HFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Dc.a.IFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Dc.a.JFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Dc.a.KFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Dc.a.qug,
id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Dc.a.MFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Pa.a.OFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Dc.a.PFj,id.a.frame,Ce.ActionManager.Zf);this.ga.ra(Dc.a.DFj,id.a.frame,Ce.ActionManager.Zf)}CIm(b){switch(b){case "tabAddins":case "Addins":return Pa.a.CFj;case "tabHome":case "Home":return Pa.a.FFj;case "tabInsert":case "Insert":return Pa.a.GFj;case "tabDeveloper":case "Developer":return Pa.a.EFj;case "tabPageLayout":case "Layout":return Dc.a.HFj;case "tabReferences":case "References":return Dc.a.KFj;
case "tabReview":case "Review":return Dc.a.qug;case "tabView":case "View":return Pa.a.OFj;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return Dc.a.MFj;case "tabMailings":case "Mailings":return Dc.a.IFj;case "tabWordDesign":case "Design":return Dc.a.PFj;case "tabHelp":case "Help":return Dc.a.pug;case "ctabPictureTools":case "Picture":return Dc.a.JFj;case "Copilot":return Dc.a.DFj}return Pa.a.NFj}}Object(u.a)(hN,"WordEditorRibbonSQMInformation",
YK,[]);class iN{constructor(b=null,h=null,n=null){this.eJ=b||{};this.m3j=h||[];this.q3j=n||{}}}Object(u.a)(iN,"RibbonTrimmingProperties",null,[]);class vA{constructor(b,h,n){this.uAa=b;this.eJ=h;this.p2f=n}}Object(u.a)(vA,"ReactRibbonJewelProperties",null,[]);class RH{constructor(){this.zno=(b,h,n,B,L)=>{if(1===n)return 32;A.AFrameworkApplication.yga("54hi9858;4f638686");if(!L)return 32;b=L.SourceControlId;17!==L.UILocation||"New"!==b&&"Open"!==b||(L=[],kh.d("setFileMenuSelectedPage")&&("New"===b&&
A.AFrameworkApplication.ua?2===A.AFrameworkApplication.ua.Ib.Tk?L.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):L.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&A.AFrameworkApplication.ua&&(2===A.AFrameworkApplication.ua.Ib.Tk?L.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):L.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),L.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(L));return 32};
A.AFrameworkApplication.va.ra(Pa.a.gYa,id.a.frame,this.zno)}t6i(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}NZa(){return!1}Gtj(){}jhi(){}}Object(u.a)(RH,"ReactFileMenu",null,[417]);class jN{xtf(){const b=new RH,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}Object(u.a)(jN,"ReactFileMenuFactory",null,[376]);class NF{constructor(b,h,n,B=!1){this.Ozc=b;this.fph=
this.Ozc.dab;this.eme=Ya.a.instance.Oa("Common.IOfficeTrialExperience");this.jVb=Ya.a.instance.Oa("Common.IMacOfficeOffer");NF.zMe=!1;this.mon=B;this.ga=h;this.Yb=n}get Sb(){return this.ga}get focusManager(){return this.Yb}Ajf(){return this.fph&&!!this.eme&&!!this.jVb}e1a(b,h){this.Ozc.Rn(()=>{x.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.fph=!0;this.kCf(b,h)});Ya.a.instance.Qa("Common.IOfficeTrialExperience").execute(n=>{x.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");
this.eme=n;this.kCf(b,h)});Ya.a.instance.Qa("Common.IMacOfficeOffer").execute(n=>{x.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.jVb=n;this.kCf(b,h)})}kCf(b,h){NF.zMe||(this.Ajf()?(x.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),NF.zMe=!0):x.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}NF.zMe=!1;Object(u.a)(NF,"RibbonDependencies",null,[80]);class ZK{constructor(b,h,n){this.NDb=b;this.ga=h;this.Yb=n}}Object(u.a)(ZK,
"WoncaRibbonUserFactory",null,[109]);class kN{constructor(b,h){this.SNe=b;this.Zbc=h}Byb(b){this.SNe.Byb(b);this.Zbc&&this.Zbc.Byb(b)}aod(b){this.SNe.aod(b);this.Zbc&&this.Zbc.aod(b)}Std(b){this.SNe.Std(b);this.Zbc&&this.Zbc.Std(b)}}Object(u.a)(kN,"RibbonCommandTrimmer",null,[377]);var lN=d(1324),xO=d(1241);class mN{constructor(b,h){this.Ga=b;this.M$b=h}Byb(b){X.a.Di&&6>X.a.l$a&&(b.fseaInsertPicture=!0);this.Ga.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Ga.$("ClipartInsertEnabled")||
(b.fseaInsertClipart=!0);this.Ga.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);zo.a.h0i()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Ga.$("InsertOnlinePictureEnabled"),n=A.AFrameworkApplication.JZf();h||(b.fseaInsertOnlinePicture=!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);n||(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);if(n||A.AFrameworkApplication.Cge)b.fseaInsertPictureFromOneDrive=!0;n&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=
!0):b.flyOnlinePicture=!0;A.AFrameworkApplication.KZf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);A.AFrameworkApplication.zAc&&(b.btnOpenInClient=!0);A.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&A.AFrameworkApplication.K.$("DisablePrint")&&this.AAc(b)}aod(b){b.menuJewel=!0;A.AFrameworkApplication.sH||(b.jbtnGiveFeedback=!0)}AAc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;
b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}Std(b){delete b.menuJewel;A.AFrameworkApplication.privacyUrl||(b.jbtnPrivacy=!0);A.AFrameworkApplication.Ald||(b.jbtnReportAbuse=!0);A.AFrameworkApplication.HCe||(b.jbtnTermsOfUse=!0);A.AFrameworkApplication.k3d||(b.jbtnFileSharing=!0);A.AFrameworkApplication.mxb||(b.jbtnShareRWC=!0);A.AFrameworkApplication.ADf||A.AFrameworkApplication.yNg||(b.jbtnVersion=!0);this.M$b.eme&&this.M$b.eme.iTn||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=
!0);this.M$b.jVb&&this.M$b.jVb.O2o||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);A.AFrameworkApplication.zAc?(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[$e.App.Et?"btnjOpenInClient":"btnjEditInClient"]=!0;A.AFrameworkApplication.Unp&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=!0,b.jbtnDownloadAsOdt=!0);A.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&A.AFrameworkApplication.K.$("DisablePrint")?this.AAc(b):A.AFrameworkApplication.K.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=
!0:b.jbtnDirectPrint=!0;A.AFrameworkApplication.lH&&(this.AAc(b),b.faShare=!0);if(A.AFrameworkApplication.O0||X.a.RXa||!A.AFrameworkApplication.D6c&&!A.AFrameworkApplication.rDf&&!A.AFrameworkApplication.wNg)b.jbtnFileEmbed=!0;lN.a.Z3m()||(b.btnjClose=!0);A.AFrameworkApplication.Htb?(b.jbtnVersion=!0,x.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):A.AFrameworkApplication.$ge()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&
b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);A.AFrameworkApplication.kqg||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Ga.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!A.AFrameworkApplication.ua&&
A.AFrameworkApplication.ua.Ib.z1i;if(b.faOpen&&b.faNew||!h)b.faHome=!0;if(A.AFrameworkApplication.rL||".ODT"===$e.App.v0c.toUpperCase()||!A.AFrameworkApplication.K.$("WordEditorAppsForOfficeRibbonIsEnabled")||!xO.a.sSd||A.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=!0}}Object(u.a)(mN,"WoncaCommandTrimmer",null,[377]);var yO=d(1076);d(476);var zO=d(1153),$K=d(1236);class vJ{constructor(b,h){this.M1=this.JM=null;this._clientId=b;this.lea=h}i2l(){if(!Kf.c(this.M1))return this.M1;
this.tBf();if(Kf.c(this.M1))throw Error.create("HeaderSkeleton.EnsureTopBarDomElement _elmTopBar1 is null or undefined");this.M1.style.display="block";this.lea&&this.lea.z2(Object(z.a)(this,this.Pv,"onResize"));return this.M1}Pv(){this.jEa()}jEa(){this.$Af()?(document.getElementById("application").style.minWidth="0px",(new $K.a(this.M1,null,A.AFrameworkApplication.isRtl)).lLo(this.M1)):A.AFrameworkApplication.ua.Ib.BN||zO.a.mLo(this.M1,A.AFrameworkApplication.isRtl)}$Af(){return A.AFrameworkApplication.K?
A.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):!1}tBf(){if(Kf.c(this.JM)){var b;({l6c:b}=Zs.a.Lsd(!A.AFrameworkApplication.a0)).returnValue?(this.JM=kJ.a("div"),this.JM.className=Zs.a.S4l,this.JM.id=Kl.a.z2d,b.appendChild(this.JM),this.mBf(),A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.Fba&&!A.AFrameworkApplication.a0&&this.nBf(),this.h2l()):A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("ReactHeaderCrashLogs")&&x.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}h2l(){Kf.c(this.M1)&&
(this.M1=kJ.a("div"),this.M1.className=Zs.a.CJg,this.M1.style.display="none",this.JM.appendChild(this.M1))}mBf(){Sys.UI.DomElement.addCssClass(this.JM,Zs.a.T4l);A.AFrameworkApplication.isRtl&&kJ.b(this.JM,"cui-rtl")}nBf(){Sys.UI.DomElement.addCssClass(this.JM,"FlexBoxLayout")}}Object(u.a)(vJ,"HeaderSkeleton",null,[]);var FD=d(661);class aL{constructor(){this.VCc=null}dqp(){this.VCc||(this.VCc=Ya.a.instance.Oa("Common.App.AccountSwitching.IAccountSwitching"))||x.ULS.sendTraceTag(589050651,1300,10,
"Unable to resolve IAccountSwitching")}Wfm(){this.dqp();return this.VCc?this.VCc.getCustomAuthConfig():null}static Dgn(){return A.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(u.a)(aL,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class SH{constructor(){this.bUb=this.cultureName=null}}Object(u.a)(SH,"HeaderCultureInfo",null,[]);var GD=d(1704);class nN{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(u.a)(nN,"SearchInitializationSettings",
null,[]);var OF=d(312);class oN{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(u.a)(oN,"DocumentTitleAppProps",null,[]);class pN{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=
this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(u.a)(pN,"DocumentTitleCalloutAppProps",null,[]);class bL{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=
this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=
this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(u.a)(bL,"HeaderAppProps",null,[]);class qN{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(u.a)(qN,"HeaderControls",null,[]);class cL{constructor(){this.command=this.label=null}}Object(u.a)(cL,"WorkflowButtonAppProps",null,[]);var wJ;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.w4p=2]="insufficientPermission";b[b.V3p=3]="incompatibleEditorsPresent";
b[b.LYp=4]="editorsPresent";b[b.Ile=5]="notSupported"})(wJ||(wJ={}));Object(u.b)("RenameDisableReason",wJ);class xJ{constructor(b=""){this.sxg=this.documentTitleAppProps=this.zPg=null;this.eQf=()=>{if(!this.zPg){const h=FD.a();if(h){const n=this.xHm(h.command);n&&(this.zPg=Object.assign(new cL,{command:n,label:h.label}))}}return this.zPg};this.kXn=()=>{ml.a.get_instance().vK(17)};this.onMove=()=>{const h={};h.MoveButtonClickedTime=new Date;A.AFrameworkApplication.va.Pb(Pa.a.JVb,2,h)};this.Ypm=()=>
{let h=null,n=null;var B=Ya.a.instance.Oa("Common.IRenameProps");B?(B=B.aGi(),0!==B&&(h=this.XHm(B),n=wJ[B])):x.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new pN,{breadcrumbBrandName:A.AFrameworkApplication.It.breadcrumbBrandName,breadcrumbBrandUrl:A.AFrameworkApplication.It.breadcrumbBrandUrl,breadcrumbFolderName:A.AFrameworkApplication.It.breadcrumbFolderName,breadcrumbFolderUrl:A.AFrameworkApplication.It.breadcrumbFolderUrl,hideDocumentTitleInput:A.AFrameworkApplication.ua.Ib.c0m,
isVersionHistoryEnabled:this.f4o(),documentExtension:F.a.fla(A.AFrameworkApplication.fileName),isMoveEnabled:32===A.AFrameworkApplication.va.Ob(Pa.a.JVb,1),onMove:this.onMove,message:h,renameDisableReason:n,openBreadcrumbsInNewTab:A.AFrameworkApplication.K.$("OpenLinksInNewWindow")})};this.Gxi=()=>{if(!this.documentTitleAppProps){const h=A.AFrameworkApplication.It.FA;this.documentTitleAppProps=Object.assign(new oN,{documentTitle:A.AFrameworkApplication.q0d?h:F.a.BL(h),onFirstRender:this.kXn,getCalloutAppProps:this.Ypm,
isShared:!1})}return this.documentTitleAppProps};this.AAl=h=>{appChrome.getHeaderApi().then(n=>{n.setNavBarData(h.result);return null});x.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")};this.onFirstRender=()=>{Ya.a.instance.Qa("Common.App.O365Shell.IO365ShellActor").execute(h=>{h.F0o.continueWith(this.AAl,3)});ml.a.get_instance().vK(15)};this.onFullyLoaded=()=>{ml.a.get_instance().vK(16)};this.NOk=""!==b?b:Zg.a.E4}xHm(b){const h=Ya.a.instance.Oa("Common.IExternalUICommandDefinitionMapping").qPb(b);
if(h&&0<h.length)return h[0].externalUxCommand;x.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}znm(){return Object.assign(new qN,{workflowButton:this.eQf()})}XHm(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}f4o(){return!!A.AFrameworkApplication.ua&&
A.AFrameworkApplication.ua.Ib.w2i}L1o(){return!!A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.v2i}N3o(){const b=!FD.b()&&!A.AFrameworkApplication.hideHeader&&!A.AFrameworkApplication.hTf&&(A.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||A.AFrameworkApplication.K.$("TeamsChatIsEnabled"));x.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}Cso(b=!1){appChrome.getHeaderApi().then(h=>{const n=Ya.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");
h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",B=>{n.onFlexPaneOpen(B)});h.setHeaderCommandHandler("OnFlexPaneClose",B=>{n.onFlexPaneClose(B)});h.setHeaderCommandHandler("SetCookie",B=>fc.a.set(B.cookieName,B.value));h.setHeaderCommandHandler("GetCookie",B=>this.Bnm(B));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",this.eQf);b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",
this.Gxi),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.lXn();return null}));GD.a.bge()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(z.a)(this,this.PGi,"getSearchInitializationSettings"))})}lXn(){Ya.a.instance.Qa("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.rAb(!1,A.AFrameworkApplication.va.mode)})}Bnm(b){b=fc.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}sMm(){return OF.AppChromeOverrideUtilities.isEnabled?
OF.AppChromeOverrideUtilities.G8d("suiteux-shell",!1):this.NOk+A.AFrameworkApplication.xna+"suiteux-shell"}pla(b=!1){a:{try{var h=hj.a.Cg(A.AFrameworkApplication.lcid);if(h){var n=Object.assign(new SH,{cultureName:h.name,bUb:h.bUb});break a}}catch(B){x.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+A.AFrameworkApplication.lcid.toString())}n=Object.assign(new SH,{cultureName:"en-us",bUb:"en"})}h=Ya.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");
n=Object.assign(new bL,{appName:CommonUIStrings.l_AppNameShort,culture:n.cultureName,language:n.bUb,isConsumer:!A.AFrameworkApplication.BNg,showAppLauncher:FD.h(),showMeControl:FD.g(),hideUserName:A.AFrameworkApplication.Jae,defaultDocumentTitleToLeft:A.AFrameworkApplication.Bdi,assetsContainerOverride:this.sMm(),controls:this.znm(),documentTitleAppProps:b?null:this.Gxi(),showDocumentTitleControl:!b,showWorkflowButton:!!this.eQf(),showChatControl:this.N3o(),showGoPremiumControl:FD.i(),showDiscoverPremiumButton:FD.f(),
enableSearchControl:GD.a.sqn(),onFlexPaneOpen:Object(z.a)(h,h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(z.a)(h,h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.L1o(),testTraffic:A.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:this.onFirstRender,onFullyLoaded:this.onFullyLoaded,enableUpdatedRUMReporting:A.AFrameworkApplication.M1o()});!A.AFrameworkApplication.V2b||A.AFrameworkApplication.rEg?(n.userDisplayName=A.AFrameworkApplication.userName,n.emailAddress=
A.AFrameworkApplication.K.kb("UserPrincipalName"),n.userID=A.AFrameworkApplication.K.kb("Puid")||"",n.signOutLink=A.AFrameworkApplication.rEg):A.AFrameworkApplication.signInUrl&&(n.signInLink=A.AFrameworkApplication.signInUrl);GD.a.bge()&&(h=this.PGi(),n.loadTellMeResources=h.loadTellMeResources,n.getTokenRequestDictionary=h.getTokenRequestDictionary,n.enableVanillaSearchBox=A.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),n.userRing=h.userRing);aL.Dgn()&&(h=new aL,n.shellAuthProviderConfigPromise=
Object(z.a)(h,h.Wfm,"getAccountSwitchingConfig"));this.WUk();this.Cso(b);A.AFrameworkApplication.Ld("1fb8i225;405dc927;4057j379;7eb0a923;82d02276;c29b9277;bcge5509;d960a232");return n}WUk(){A.AFrameworkApplication.K.$("SideLoadingIsEnabled")&&ml.a.get_instance().Lk(16,()=>{appChrome.getHeaderApi().then(b=>{b.setCustomHeaderButtonBadgeCharacter("overrideSettingButtonId","\u25b6");b.setCustomHeaderButtonBadgeLabel("overrideSettingButtonId","Sideloading is active so javascript is coming from an unofficial source.");
b.setCustomHeaderButtonBadgeColors("overrideSettingButtonId",{badgeColor:"green",badgeHoverColor:"green",badgeFontColor:"white",badgeFontHoverColor:"white"});return null})})}PGi(){if(!this.sxg){const b=new GD.a;let h=A.AFrameworkApplication.K.kb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.sxg=Object.assign(new nN,{loadTellMeResources:b.PAn(),getTokenRequestDictionary:Object(z.a)(b,b.BOm,"getTokenRequestDict"),userRing:h})}return this.sxg}}Object(u.a)(xJ,"ReactSharedHeaderPropsHelper",
null,[1567]);class dL{constructor(){this.label=this.value=null}}Object(u.a)(dL,"TextInfoSectionField",null,[]);var PF=d(1018),AO=d(1306);class yJ{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(u.a)(yJ,"CommandDefinition",null,[]);class wA{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(u.a)(wA,"CommandDefinitionMapping",null,[]);const BO=b=>Object.assign(new wA,{getCommandByExternalUxId:h=>
{const n=b.getCommandByExternalUxId(h);return n?Object.assign(new yJ,{commandId:parseInt(n.commandId),externalUxCommand:n.externalUxCommand}):Object.assign(new yJ,{externalUxCommand:h})},getDoNothingCommand:()=>parseInt(Pa.a.Vg),addCommandToMaps:Object(z.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(z.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(z.a)(b,b.addTabToMap,"addTabToMap")});var CO=d(1441);class rN{}Object(u.a)(rN,"RibbonInitState",null,[]);var sN=d(451),DO=d(1362);
class tN{constructor(){}flatten(b){const h=[];for(const n of b)h.push.apply(h,n);return h}}Object(u.a)(tN,"ReactAsyncDispatcher",null,[]);var EO=d(1770);class uN{constructor(b,h){this.iOk=b;this.Yqk=h}}Object(u.a)(uN,"ReactExecuteCommandContext",null,[]);class vv{}vv.Trigger="FontTrigger";vv.Name="FontName";vv.Action="FontAction";vv.Level="FontLevel";vv.IsPinned="FontIsPinned";Object(u.a)(vv,"FontPickerLogProperties",null,[]);class vN{constructor(b,h,n,B,L,ba,la,La,fb,Cb=null,Lb=null){this.X1=null;
this.$Eh=!1;this.QRe=[];this.ozd=-1;this.xOd=!1;this.uPk=0;this.SEc=null;this.IAh=!1;this.Uyd=null;this.duh=!1;this.Xvp=($b,tc)=>{const Nc=$b.launcherId;this.Oxc(Nc,tc)&&(tc=appChrome.selectors.getFlyoutAnchorMenuItems(Nc),this.bBc(tc,Nc,kh.g($b)))};this.Zwp=($b,tc)=>{const Nc=$b.launcherId;this.Oxc(Nc,tc)&&(tc=kh.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(Nc):appChrome.selectors.getFlyoutAnchorMenuItems(Nc),this.bBc(tc,Nc,kh.g($b)))};this.Qyp=($b,tc)=>{const Nc=
$b.launcherId;this.Oxc(Nc,tc)&&(tc=appChrome.selectors.getPreviewGalleryMenuItems(Nc),this.bBc(tc,Nc,kh.g($b)))};this.Hzp=($b,tc)=>{const Nc=$b.launcherId;this.Oxc(Nc,tc)&&(tc=appChrome.selectors.getSplitButtonMenuItems(Nc),this.bBc(tc,Nc,kh.g($b)))};this.Nzp=($b,tc)=>{const Nc=$b.launcherId;this.Oxc(Nc,tc)&&(tc=appChrome.selectors.getStatefulSplitButtonMenuItems(Nc),this.bBc(tc,Nc,kh.g($b)))};this.fja=b;this.xkb=h;this.w7e=Object(ya.a)(1438,b);this.Vl=n;this.Yb=B;L&&(this.X1=new EO.a(L,B));this.ILk=
ba;this.svk=la;this.Rq=Cb;this.ga=La;this.hFb={};this.Ga=fb;this.uTg=Lb;fb&&(fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||fb.$("EnqueueTasksWhenTaskMgrIsYielding"))&&og.a.instance.pif.CWR(()=>this.$Eh=!0);fb&&(b=this.Ga.kb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({Zu:this.SEc}=D.d(b));this.SEc||(this.SEc={})}get tLj(){return!!window.appChrome&&!!appChrome.selectors}TJj(){-1!==this.ozd&&window.clearTimeout(this.ozd);this.ozd=
window.setTimeout(()=>{for(this.ozd=-1;0<this.QRe.length;){if(ph.a.instance.Rw){this.TJj();break}const b=this.QRe.shift();b&&this.executeCommand(b.iOk,b.Yqk)}},0)}executeCommand(b,h){if(ph.a.instance.Rw){if(this.$Eh){this.QRe.push(new uN(b,h));this.TJj();return}x.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",b,h.modelType,Yb.a.toJSON(h.payload));
if(this.Ga.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const n=this.Vl.getCommandByExternalUxId(b),B=h.modelType;this.uTg&&this.uTg.iCn(b,h);n?this.u3l(b,n,B,h):this.v3l(b,B,h);this.sol(h);this.Gnp(h);this.WHn(b,h)}}v3l(b,h,n){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.jmi(n,b);break;case "ButtonModel":this.p3l(n,b)}}Dyp(b,h,n,B,L){if(n.payload)switch(n.payload.type){case "CoauthorMenuPayload":b.MenuItemId=n.payload.coauthorId;break;case "ButtonPayload":b.MenuItemId=
h.menuItemId;b.CommandValueId=n.payload.commandValueId;b.TerminalParentControlId=n.payload.terminalParentControlId;this.Ga&&this.Ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8213680_EnableUnDismissWhenClickingMenu")?(h=!0,Kf.c(n.payload.dismissHostingSurfaceOnExecute)||(h=n.payload.dismissHostingSurfaceOnExecute),h&&this.P6()):this.P6();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=n.payload.commandValueId;L=h.commandPreviewId;break;case "ButtonRevertPreviewPayload":b.MenuItemId=
h.menuItemId;b.CommandValueId=n.payload.commandValueId;L=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=B;return L}Eyp(b,h,n){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=this.Vl.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.Vl.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":n.CommandId=h.payload.executedControl;n.ControlId=h.payload.executedControl;
n.ParentControlId=h.payload.parentControl;n.CloseAllMenus=!0;this.P6();break;case "TellMeSearchResultChangePayload":n.Value=h.payload.searchText;break;case "SmartLookupPayload":n.CommandValueId=h.payload.selectionContextJson}return b}u3l(b,h,n,B){var L=this.eco(B,n),ba=h.commandId;const la={},La={};switch(n){case "SplitButtonModel":if(this.I5c(B.payload,this.Hzp,L))return;la.MenuItemId=h.menuItemId;this.dBg(B,la);break;case "StatefulSplitButtonModel":if(this.I5c(B.payload,this.Nzp,L))return;n=B.payload.statefulData;
L=B.payload.statefulMode;"color"===L?la.Color=n:"icon"===L&&(n=this.Vl.getCommandByExternalUxId(n))&&(la.MenuItemId=n.menuItemId);break;case "FileMenu":la.MenuItemId=h.menuItemId;la.SourceControlId=b;B.payload&&"FileMenuPageSwitchPayload"===B.payload.type&&this.sVm(ba,B.payload,b);break;case "TellMe":ba=this.Eyp(ba,B,la);la.SourceControlId=b;la.Location=B.payload.location;break;case "ButtonModel":B.payload&&"TabSwitchPayload"===B.payload.type?this.pXm(la,B):ba=this.Dyp(la,h,B,b,ba);break;case "CompoundButtonModel":la.MenuItemId=
h.menuItemId;la.CommandValueId=B.payload.commandValueId;la.SourceControlId=b;this.dBg(B,la);this.P6();break;case "ToggleButtonModel":case "InkButtonModel":la.MenuItemId=h.menuItemId;la.SourceControlId=b;this.dBg(B,la);this.P6();break;case "FontPickerModel":switch(B.payload.type){case "MenuOpenPayload":ba=this.Vl.getCommandByExternalUxId("FontPickerMenuOpen").commandId;la[TB.a.FontPickerId]=B.payload.launcherId;break;case "MenuClosePayload":ba=this.Vl.getCommandByExternalUxId("FontPickerMenuClose").commandId;
la[TB.a.FontPickerId]=B.payload.launcherId;break;case "FontPickerFontSelectedPayload":n=B.payload.font;L=null;"string"===typeof n?(L=wp.FontUtils.MYa(n),la.CommandValueId=L,L=wp.FontUtils.UYd(L)):(n.data?(la.CommandValueId=n.data.fontToApply,la.MenuItemId=n.data.themeIndex,la[TB.a.Formatting]=n.data):la.CommandValueId=n.name,L=n);la.SourceControlId=b;la[TB.a.RequestUpdateMru]=L;La[vv.Name]=B.payload.nameToLog?B.payload.nameToLog:"string"===typeof n?wp.FontUtils.Hde(n)?"*"+n:wp.FontUtils.LYf(n)?"[EF]":
"[MF]":"";La[vv.IsPinned]=B.payload.isPinned;La[vv.Level]=B.payload.level;this.u6f();break;case "FontPickerFontInfoRequestedPayload":la.CommandValueId=B.payload.font.name;la[TB.a.Trigger]=B.payload.trigger;La[vv.Trigger]=B.payload.trigger;La[vv.Name]=B.payload.nameToLog;this.u6f();break;case "FontPickerFontPinningPayload":n=B.payload.isPinned;la.CommandValueId=B.payload.fontKey;la[TB.a.IsPinned]=n;La[vv.Name]=B.payload.nameToLog;La[vv.Action]=n?"pin":"unpin";La[vv.Level]=B.payload.level;this.u6f();
break;default:return}break;case "ComboBoxModel":var fb=B.payload.type;switch(fb){case "MenuOpenPayload":case "MenuPopulatePayload":this.Oxc(B.payload.launcherId,L)&&(ba={},ba[B.payload.launcherId]=n,this.xkb.Ehd(ba,kh.g(B.payload)),this.hFb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":n=B.payload.newValue;if(!n)return;n.value?(la[em.a.Value]=n.value,la[em.a.IsFreeForm]=!0):(la[em.a.Value]=n.text,la.MenuItemId=n.key,la.CommandValueId=n.commandValueId);
"ComboBoxPreviewPayload"===fb&&(ba=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":ba=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(B.payload.type){case "ZeroTermContextMenuClosePayload":n=Yb.a.FR(B.payload);for(fb of n)la[fb]=B.payload[fb];break;default:this.I5c(B.payload,this.Xvp,L),la.launcherId=B.payload.launcherId}break;case "InkFlyoutAnchorModel":this.I5c(B.payload,this.Zwp,L);la.launcherId=B.payload.launcherId;break;case "ColorPickerModel":switch(B.payload.type){case "ColorPickerPayload":la[$a.Color]=
B.payload.selectedColorId;la.colorRGB=B.payload.color;break;case "ColorPickerPreviewPayload":ba=h.commandPreviewId;la[$a.Color]=B.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":ba=h.commandRevertId;break;default:return}break;case "SpinButtonModel":la[Ki.a.Number]=B.payload.value;la[Ki.a.UnitType]=Fg.a.IUa(B.payload.unitType.toLowerCase());la[Ki.a.Text]=B.payload.reservedValue;break;case "SliderModel":la[ho.Value]=B.payload.value;break;case "InsertTableModel":la[Vo.a.Rows]=B.payload.rows;
la[Vo.a.Columns]=B.payload.columns;break;case "CheckboxModel":la[$g.a.On]=B.payload.checked;la.MenuItemId=h.menuItemId;la.TerminalParentControlId=B.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.I5c(B.payload,this.Qyp,L)){la.launcherId=B.payload.launcherId;break}this.jmi(B,b);return;case "DocumentTitleModel":switch(B.payload.type){case "DocumentTitleRenamePayload":la.getNewDocumentTitle=B.payload.getNewDocumentTitle;break;case "MenuOpenPayload":ba={};ba[B.payload.launcherId]=
n;this.xkb.Ehd(ba,kh.g(B.payload));this.hFb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":la.MenuItemId=B.payload.url;this.ZCn(B.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":la.MenuItemId=B.payload.assetId;la.SourceControlId=b;A.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&(la.IsPremium=B.payload.isPremium||!1);this.$Cn(B.payload.pageId);break;case "CoauthorGallery":la.RenderTime=B.triggerTime;
break;case "PeopleWell":la.RenderTime=B.triggerTime;break;case "SyncStatus":la.SourceControlId=b;break;case "InputBoxModel":la.Text=B.payload.newValue;break;case "PersonaButtonModel":la.CommandValueId=B.payload.commandValueId;this.xWm(B.payload);break;case "MultiActionButtonModel":la.CommandValueId=B.payload.commandValueId;la.Href=B.payload.href;la.SourceControlId=b;la.Type=B.payload.type;la.TerminalParentControlId=B.payload.terminalParentControlId;this.P6();break;default:return}ba&&!this.isShadowMenuOpen(B.payload)&&
(B.payload&&"terminalParentControlId"in B.payload&&(la.ParentMenuId=B.payload.terminalParentControlId),la.CommandValueId||(la.CommandValueId=la.MenuItemId),h.legacyControlId&&(la.LegacyId=h.legacyControlId),la.SourceControlId||(la.SqmControlId=b),this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&la.launcherId&&(h=this.Vl.getCommandByExternalUxId(la.launcherId))&&(la.launcherCommandId=parseInt(h.commandId)),B.payload&&!Kf.c(B.payload.PRIReadinessCheck)&&
(la.PRIReadinessCheck=B.payload.PRIReadinessCheck,this.IAh=!0),B.payload&&!Kf.c(B.payload.shouldTakeFocus)&&(la[dx.a.I_a]=B.payload.shouldTakeFocus),h=this.dff(B,la),B.payload&&!Kf.c(B.payload.interactiveUid)&&(La.interactive_uid=B.payload.interactiveUid),Kf.c(B.triggerTime)||(La.TriggerTime=B.triggerTime),B.payload&&!Kf.c(B.payload.userActionKey)&&(La.userActionKey=B.payload.userActionKey),this.rzg(La,B,b,ba),this.w7e.executeCommand(ba,la,this.getSelectedTabId(),h,!0,()=>{this.L9f(la,b)},La,kh.g(B.payload)))}rzg(b,
h,n,B){if(this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&n&&B&&h.payload){const L=!Kf.c(h.payload.launcherId);n=this.aJj(this.VBm(L?h.payload.launcherId:n,B),B,!1);b.ControlId=n;const ba=h.payload.inputMethod,la=h.payload.location;Kf.c(ba)||Kf.c(la)||this.qCn(1===ba,2===ba||3===ba||4===ba,L&&("Overflow"===la||"ToolBarOverflow"===la)||"TabSwitchPayload"===h.payload.type,n,la)}this.Ga&&this.Ga.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&
h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=this.aJj(h.payload.terminalParentControlId,B,!0))}qCn(b,h,n,B,L){this.Uyd||(this.Uyd={});const ba=[];L=Wc.a.bba("UILocation",L,2);Array.add(ba,L);if(L=this.getSelectedTabId())L=Wc.a.bba("Tab",L,2),Array.add(ba,L);this.Uyd[B]||n||(this.Uyd[B]=1,h?this.hcd("DistinctUserInitiatedTerminalCommand",ba):b&&this.hcd("DistinctUserInitiatedKeyboardCommand",ba));h?n?this.hcd("UserInitiatedNavigationalCommand",ba):this.hcd("UserInitiatedTerminalCommand",
ba):b&&this.hcd("UserInitiatedKeyboardCommand",ba)}hcd(b,h){Pe.b(b,null,0,!0,0,h)}aJj(b,h,n){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;x.ULS.sendTraceTag(510247689,207,15,n?"CommandId: "+h+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+h+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}VBm(b,h){h=parseInt(h);h=Ce.ActionManager.tqf(h)||Ce.ActionManager.U$(h)||"";return!Kf.c(h)&&h in this.SEc?this.SEc[h]:100<
b.length?"":b}u6f(){this.Rq&&this.Rq.execute(b=>{b.c6f("ModernFontPickerExperience")})}dff(b,h){let n=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(n=b.payload.inputMethod,h[dx.a.iz]=n);return n}L9f(b,h){const n=Object(ya.a)(Dd.AFrame,A.AFrameworkApplication.ua);if(this.Yb&&this.TSj(b)){if(!this.Yb.currentScope&&n){let B="null";if(b){const L=b.Value;delete b.Value;B=Yb.a.toJSON(b);Kf.c(L)||(b.Value=L)}x.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",
h,B,n.Gdb)}this.Yb.UEf()}(this.Yb&&this.Yb.currentScope&&this.Yb.currentScope.name!==Dd.AFrame.dva&&n&&this.Yb.currentScope.name!==n.Gdb||this.TSj(b))&&this.kul(b)}TSj(b){return!!b&&!Kf.c(b[dx.a.I_a])&&b[dx.a.I_a]}kul(b){dx.a.iz in b&&1===b[dx.a.iz]&&PF.ShyRibbon.hnb(1,0)}pXm(b,h){kh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.P6();this.fja.wn();if(this.ILk&&this.ga){const n={};n[mz.a.fHg]=h.payload.tabId;this.ga.Pb(Pa.a.Dld,
2,n,this.mX(h));Kf.c(h.payload.inputMethod)||(this.ga.Ob(Pa.a.LFj,2),this.xOd||this.l8o(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.Vl.GOf(h);x.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.Rq&&h){const n=h+"TabSwitchActivity";this.Rq.execute(B=>{B.c6f(n)})}}I5c(b,h,n){const B=b.type;return"MenuClosePayload"===B?!0:"MenuOpenPayload"===B?(h(b,n),!0):!1}xWm(b){b=b.type;"MenuOpenPayload"===b?A.AFrameworkApplication.hrd=!0:"MenuClosePayload"===
b&&(A.AFrameworkApplication.hrd=!1)}eco(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const n=b.payload.launcherId,B=this.Vl.getCommandByExternalUxId(n);return B&&B.populationProps?((b=this.xkb.wlg(B,h,b.payload))&&n in this.hFb&&delete this.hFb[n],b):!1}getSelectedTabId(){return this.tLj?appChrome.selectors.getSelectedTabId():null}bBc(b,h,n){this.xkb.Ehd(b,n);this.hFb[h]=new Date}Oxc(b,h){let n=!0;b in this.hFb&&(n=
this.hFb[b].getTime()<this.fja.fua.getTime());return n&&!h&&this.tLj}jmi(b,h){const n={};var B=b.payload.selectedGalleryId;const L=this.Vl.getCommandByExternalUxId(B);if(L){n.SourceControlId=B;n.MenuItemId=L.menuItemId;n.SqmControlId=h;L.legacyControlId&&(n.LegacyId=L.legacyControlId);b.payload&&!Kf.c(b.payload.shouldTakeFocus)&&(n[dx.a.I_a]=b.payload.shouldTakeFocus);this.PEm(b.payload,n);(B=this.mX(b))||(B={});this.rzg(B,b,h,L.commandId);const ba=this.dff(b,n);this.w7e.executeCommand(L.commandId,
n,this.getSelectedTabId(),ba,!0,()=>{this.L9f(n,h)},B,kh.g(b.payload))}}p3l(b,h){const n=this.Vl.getCommandByExternalUxId(h);if(n){const B={};B.SourceControlId=h;B.MenuItemId=h;B.SqmControlId=h;b.payload&&!Kf.c(b.payload.shouldTakeFocus)&&(B[dx.a.I_a]=b.payload.shouldTakeFocus);let L=this.mX(b);L||(L={});this.rzg(L,b,h,n.commandId);const ba=this.dff(b,B);this.w7e.executeCommand(n.commandId,B,this.getSelectedTabId(),ba,!1,()=>{this.L9f(B,h)},L,kh.g(b.payload))}}PEm(b,h){"CharacterGalleryPayload"===
b.type&&(h.MenuItemId=b.character)}dBg(b,h){b.payload&&"toggled"in b.payload&&(h[$g.a.On]=b.payload.toggled)}WHn(b,h){if("MenuOpen"===b){if(this.X1&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.X1.onMenuOpen()}else if("MenuClose"===b&&this.X1)this.X1.onMenuClose()}P6(){this.X1&&this.X1.yeg()}mX(b){let h=null;Kf.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}sVm(b,h,n){if(this.svk&&this.ga){const B={};B[ED.a.xpe]=n;this.ga.Pb(Pa.a.Cld,2,B)}this.bBc(h.pageControlIdMap,
b,kh.g(h))}$Cn(b){if(this.ga)switch(b){case "FileHomePage":this.ga.Ob(Pa.a.QFj,2);break;case "FileNewPage":this.ga.Ob(Pa.a.RFj,2)}}ZCn(b){if(this.ga)switch(b){case "FileHomePage":this.ga.Ob(Pa.a.tFj,2);break;case "FileOpenPage":this.ga.Ob(Pa.a.uFj,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===b.type&&b.isShadowRendering}l8o(b){if(A.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.Rq.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",null)}),this.xOd=!0;
else{if(A.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.Rq.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.uPk)){this.xOd=!0;return}A.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.Ob(Pa.a.P0b,2)&&(this.xOd=!0)}}sol(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.IAh&&appChrome.PRIToastManager.dismissToast()}Gnp(b){!this.duh&&this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",
!1)&&(b=kh.g(b.payload),31===b||14===b||15===b||2===b)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>{const h=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");h&&h.execute(n=>{n.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},0)}),this.duh=!0)}}Object(u.a)(vN,"ReactExecuteCommandHandler",null,[]);class wN{constructor(){this.h3d=null}get sAb(){return 0}get ubb(){return 0}get EMa(){return!1}jEa(){}t1j(){}Y2(){return!1}SNj(){}Y6(){return!1}GPa(b){return this.h3d&&
this.h3d.NZa(b)?!0:!1}get Tna(){return!1}gyb(){}Tde(){return!1}get TXd(){return null}set TXd(b){}Oja(){}ofa(){}NPf(){return null}lVa(){}refresh(){}get controls(){return null}fvc(){return!1}Cnb(){}wn(){}get oH(){return null}set oH(b){}ttd(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}Object(u.a)(wN,"ReactRibbonExternal",null,[555,491,556]);class xN{constructor(b,h,n,B){this.VXn=(L,ba)=>{if((L=Object(ya.a)(Dd.AFrame,A.AFrameworkApplication.ua))&&ba.chj&&A.AFrameworkApplication.ua&&
A.AFrameworkApplication.ua.Ib.GCa){const la=appChrome.selectors.getShyState();la.isActive&&ba.chj.name===L.Gdb&&PF.ShyRibbon.hnb(la.state,1)}};this.RHj=()=>4;this.QHj=()=>4;this.MHj=()=>{kh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.GCa&&appChrome.selectors.getShyState().isActive&&PF.ShyRibbon.hnb(1,0),this.Yb.Bg(Dd.AFrame.Ho));return 4};this.R1n=L=>{L.Kb&&L.Kb.target&&"input"!==L.Kb.target.tagName.toLowerCase()&&L.Kb.preventDefault();
return!1};this.Yb=b;this.ga=h;this.IKh=n;this.N$b=B}initialize(){this.ga.ra(Pa.a.omd,id.a.frame,this.RHj);this.ga.ra(Pa.a.nmd,id.a.frame,this.QHj);this.ga.ra(Pa.a.Lve,id.a.frame,this.MHj);var b=Zs.a.Wbe(this.N$b,null,this.IKh,!1);b.iK=!0;this.LYb(b,Pa.a.omd,Pa.a.nmd);b.bindAction(bb.KeyInputManager.lc(Jd.a.Sfb,0),Pa.a.Lve);b=this.Yb.ge(Dd.AFrame.dva);b.iK=!0;this.LYb(b,Pa.a.V7a,Pa.a.V7a);Yg.a.instance.nb(Cd.a.nz,this.IKh,this.R1n);b=kc.a.instance;kh.a("enterKeytipMode")&&b.dWo(this.N$b,()=>{appChrome.api.enterKeytipMode(!1)});
kh.a("exitKeytipMode")&&b.$Vo(this.N$b,()=>{appChrome.api.exitKeytipMode();PF.ShyRibbon.hnb(1,0)});A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.GCa&&(b=Object(ya.a)(Ph.FocusManager,this.Yb))&&b.N0k(this.VXn)}j8m(b){b=Zs.a.Wbe(b,null,document.getElementById("WACToolbarContainer"),!1);b.iK=!0;this.LYb(b,Pa.a.omd,Pa.a.nmd)}LYb(b,h,n){const B=bb.KeyInputManager.lc(Jd.a.xz,0),L=bb.KeyInputManager.lc(Jd.a.xz,4);b.tt(B);b.tt(L);b.bindAction(B,h);b.bindAction(L,n)}dispose(){this.ga.Zw(Pa.a.omd,
id.a.frame,this.RHj);this.ga.Zw(Pa.a.nmd,id.a.frame,this.QHj);this.ga.Zw(Pa.a.Lve,id.a.frame,this.MHj)}}Object(u.a)(xN,"ReactRibbonFocusManager",null,[13]);class rw{constructor(b,h,n,B,L,ba,la,La=null,fb=!0,Cb=null,Lb=null){this.pib=this.rPd=this.NNe=this.fja=null;this.CEh=[];this.O$b=null;this.tlo=()=>{A.AFrameworkApplication.K.Rn(()=>{this.qVl()})};this.fFn=()=>{if(A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.Hs){var $b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");"SingleLine"===
appChrome.selectors.getRibbonMode()?$b.execute(tc=>{tc.logActivity("SingleRibbonModeActivity",null)}):"Multiline"===appChrome.selectors.getRibbonMode()&&$b.execute(tc=>{tc.logActivity("MultiRibbonModeActivity",null)});if(A.AFrameworkApplication.K&&A.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ScreenSizeActivity")){$b=Lh.a.srb();const tc=Lh.a.nX();Pe.a("ScreenBucket_W_"+(1550<$b?"Large":1050<$b?"Medium":"Small")+"_H_"+(850<tc?"Large":675<tc?"Medium":"Small"))}}};
this.MDg=()=>{const $b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");$b&&$b.execute(tc=>{tc.logActivity("SingleLineToolBarOptOut",null)});return 32};this.NBn=()=>{this.ga.ra(Pa.a.nKg,id.a.frame,Object(z.a)(this,this.nKg,"triggerModeSwitcherTUI"));this.ga.fb(Pa.a.MDg,id.a.frame,this.MDg,96);const $b=fc.a.Bfa(A.AFrameworkApplication.K.kb("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const tc=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");tc&&(A.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")?
(tc.execute(Nc=>{Nc.logActivity("VNextStylesOn",null)}),tc.execute(Nc=>{Nc.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):A.AFrameworkApplication.K.$("Fluent2StyleFGOnlyIsEnabled")&&$b&&tc.execute(Nc=>{Nc.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)};this.Yvo=()=>{ml.a.get_instance().Lk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const $b=appChrome.api.getRibbonSubComponentMappings();for(const Nc in $b){var tc=
Nc;const dd=$b[Nc];if(dd)for(const Hd of dd)A.AFrameworkApplication.va.d3(Hd)?appChrome.api.reportRibbonSubComponentBehaviorMapped(tc):A.AFrameworkApplication.va.XVo(Hd,this.cIl(tc));else appChrome.api.reportRibbonSubComponentBehaviorMapped(tc)}};this.YSa=b;this.k1e=h;this.N$b=n;this.Yb=B;this.ga=L;this.Vl=ba;this.fja=Cb?Cb:new zj(gv.instance,this.Vl);this.iKc=la;this.UCh=new wN;this.ZSa=La;this.a9e=fb;new tN;this.Yhh=Lb;ml.a.get_instance().Lk(7,Object(z.a)(this,this.xXo,"setRibbonPostInteractiveReady"));
ml.a.get_instance().Lk(7,this.fFn);ml.a.get_instance().Lk(19,this.NBn);ml.a.get_instance().Lk(7,this.Yvo);ml.a.get_instance().Lk(7,this.tlo)}initialize(b,h,n=null){this.a9e||this.vK(5);n?n.then(()=>{this.BEj()}).catch(()=>x.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):sN.a.Mrd(sN.a.Mrd(Cg.Task.WAA(this.U7i(b),this.T7i(rw.prk)),()=>this.T7i(rw.Gnk)),()=>this.U7i(h)).continueWith(()=>{this.BEj()},11)}dispose(){this.lrp();this.pib&&this.pib.jhi();this.O$b&&this.O$b.dispose();
for(const b of this.CEh)ml.a.get_instance().Uql(b);A.AFrameworkApplication.va.Zw(Pa.a.gEo,id.a.frame,Ce.ActionManager.Zf)}T7i(b){return Ya.a.instance.resolve("Common.ISharedDependencyLoader").Sqc(A.AFrameworkApplication.lC(b,2))}U7i(b){return""===b?Cg.Task.p7(!0):Ya.a.instance.resolve("Common.ISharedDependencyLoader").Sqc(A.AFrameworkApplication.lC(b,3))}T7m(){(this.ZSa||this.iKc)&&appChrome.api.dispatch(this.WJi());this.yZo();kh.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(A.AFrameworkApplication.c9);
this.fja.wn()}BEj(){this.T7m();this.a9e&&(appChrome.renderAppChrome(this.YSa,kh.e()),this.vK(10));this.VMh();this.wmf();this.a9e&&this.vK(5);this.gSi()}gSi(){this.Yb&&this.ga&&this.N$b&&(this.O$b=new xN(this.Yb,this.ga,this.YSa,this.N$b),this.O$b.initialize())}get mmd(){return this.UCh}setCommandDefinitionMapping(){if(kh.a("setCommandDefinitionMapping")){const b=BO(this.Vl);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.GCa&&
kh.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,h)=>{0===h&&this.euc()})}VMh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(ya.a)(zj,this.fja);this.NNe=new vN(this.fja,b.$uc,this.Vl,this.Yb,this.k1e,Ya.a.instance.Oa("Common.IRibbonSQMInformation"),Ya.a.instance.Oa("Common.IFileMenuSQMInformation"),A.AFrameworkApplication.va,A.AFrameworkApplication.K,Ya.a.instance.Qa("Common.ISystemInitiatedFeedback"),null);this.Acl();
this.oUm()}Acl(){this.rPd=appChrome.api.bindCommandHandler((b,h)=>{this.NNe.executeCommand(b,h)})}lrp(){this.rPd&&(this.rPd(),this.rPd=null)}yZo(){appChrome.api.initializeLogger(new zc.a)}UKa(){return this.fja?this.fja.UKa():[]}euc(){Rn.a.instance.Yd(()=>{let b=null;Rn.a.instance.Yd(()=>{b=this.UKa()},"RB:GA");b&&0<b.length&&(this.fja.fua=new Date,Rn.a.instance.Yd(()=>{appChrome.api.dispatch(b)},"RB:DA"));this.pib&&Rn.a.instance.Yd(()=>{this.pib.Gtj()},"RB:J")},"RB:PFSU")}Ftd(){this.fja.Ftd()}qWb(){}jUk(b){b=
[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}WJi(){var b=A.AFrameworkApplication.K;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Ya.a.instance.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>{n.isFeatureEnabled("ConnectedServices",!0).then(B=>{B&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",
!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));h.push.apply(h,this.vyi());b=new CO.a(this.Vl);this.ZSa.eJ&&(DO.a.Xnp(this.ZSa.eJ),h.push.apply(h,b.a5d(this.ZSa.eJ)));if(this.ZSa.m3j)for(const n of this.ZSa.m3j)h.push(appChrome.actions.updateGallerySectionHiddenState(n.T4d,n.Fjq,n.coq));h.push.apply(h,b.cti(this.ZSa.q3j));return h}vyi(){const b=[];if(this.iKc&&this.iKc.eJ){const n=this.iKc.eJ;for(const B in n){var h=n[B];const L=this.Vl.NJf(B);if(L)for(const ba of L)b.push(appChrome.actions.updateControlHiddenState(ba,
h))}}return b}BPa(b){b&&this.fja.$uc.Ehd(b,0)}wlg(b){this.fja.$uc.wlg(this.Vl.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}qVl(){const b=A.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=A.AFrameworkApplication.K.appSettings;h&&appChrome.api.dispatch(this.Czp(b,"Shared"===(h.SharingStatus||"")))}Czp(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}vK(b){ml.a.get_instance().vK(b);this.CEh.push(b)}xXo(){kh.d("updateRibbonInitializationState")&&
appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new rN,{postRibbonInteractiveReady:!0})))}wmf(){this.iKc&&this.Yhh&&(this.pib=this.Yhh.xtf(),this.UCh.h3d=this.pib)}vxn(b,h){this.pib&&this.pib.t6i(b,h)}hwg(b,h,n){if(1===n)return 32;this.vPj(!0);this.euc();A.AFrameworkApplication.ua.Ie();return 32}iwg(b,h,n){if(1===n)return 32;this.vPj(!1);this.JXo();this.euc();A.AFrameworkApplication.ua.Ie();return 32}nKg(b,h,n){if(1===n)return 32;(b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback"))&&
b.execute(B=>{B.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}JXo(){fc.a.vOa(A.AFrameworkApplication.K.kb("IsSimplifiedRibbonOnCookieName"),"true",fc.a.xMa)}vPj(b){fc.a.vOa(A.AFrameworkApplication.K.kb("ReactRibbonMLRPreferenceCookieName"),b.toString(),fc.a.xMa)}cIl(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}oUm(){if(A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&kh.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&A.AFrameworkApplication.Ptc.jef){const b=A.AFrameworkApplication.Ptc.jef,h=A.AFrameworkApplication.Ptc.vMh;h.payload||(h.payload={});const n=h.payload.launcherId?h.payload.launcherId:b;rw.THj.mb(n)?rw.THj.J(n)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():(h.payload.PRIReadinessCheck=!0,this.NNe.executeCommand(b,h))}}}rw.prk="common";rw.Gnk="appChrome";rw.THj=new AO.a(Qa.a.e5c());
Object(u.a)(rw,"ReactRibbonUser",null,[719,191,13]);class QF extends rw{constructor(b,h,n,B,L,ba,la,La,fb=null,Cb=!0,Lb=null,$b=null){super(b,h,B,L,ba,la,La,fb,Cb,Lb,$b);this.pCd=null;this.NDb=n;this.NDb.execute(tc=>{this.pCd=tc});this.NDb.execute(tc=>{this.fja.oH=tc})}UKa(){return this.pCd?(this.pCd.clearCache(),super.UKa()):[]}qWb(b){if(!b)throw Error.argumentNull();this.NDb.execute(h=>{b.oH=h})}}Object(u.a)(QF,"ReactRibbonUser",rw,[]);var FO=d(1079);class TH extends QF{constructor(b,h,n,B,L,ba,
la,La,fb,Cb=!0,Lb=null,$b=null){super(h,b.Maa,B,Mk.a.tva,L.focusManager,L.Sb,la,La,fb,Cb,Lb,$b);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.pVe=b;this.lea=ba;L.e1a(()=>{this.jzp();A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?ml.a.get_instance().Lk(7,()=>{this.YRi()}):this.YRi()},null)}get mXi(){return!!A.AFrameworkApplication.K.appSettings.BootActivityNavigationId}YRi(){this.gGl();this.xtf();this.Eso()}jzp(){this.YSa.classList.add("FlexBoxLayout");
this.pVe.Gsa().classList.add("cui-exth");this.pVe.Gsa().classList.add("FlexBoxLayout");this.pVe.Gsa().classList.add("ScrollableRibbon")}gGl(){A.AFrameworkApplication.a0||this.rKl()}rKl(){if(!A.AFrameworkApplication.a0){var b=(new vJ(TH.GLk,this.lea)).i2l(),h=Zs.a.Wbe(Mk.a.IWa,null,b,!0);h.iK=!0;this.LYb(h,Pa.a.omd,Pa.a.nmd);h.bindAction(bb.KeyInputManager.lc(Jd.a.Sfb,0),Pa.a.Lve);Zw.a(1,()=>{this.uCo(b)})}}uCo(b){const h=new xJ;appChrome.renderSharedHeader(b,h.pla()).then(this.kyf.bind(this))}pCj(){A.AFrameworkApplication.ua.Ib.u2i?
appChrome.getHeaderApi().then(b=>{document.getElementById(A.AFrameworkApplication.xpb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new FO.a).kyf()}kyf(){this.mXi&&A.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(ml.a.get_instance().Lk(12,this.pCj.bind(this),11),x.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.pCj()}LYb(b,h,n){const B=bb.KeyInputManager.lc(Jd.a.xz,0),L=bb.KeyInputManager.lc(Jd.a.xz,
4);b.tt(B);b.tt(L);b.bindAction(B,h);b.bindAction(L,n)}xtf(){const b=!!this.ZSa&&"FileMenu"in this.ZSa.q3j;A.AFrameworkApplication.ua.Ib.LXa&&!b&&Zw.a(1,this.OBo.bind(this))}OBo(){const b=[];if(A.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=[Object.assign(new dL,{label:CommonUIStrings.L_DiagnosticsSessionId,value:A.AFrameworkApplication.userSessionId}),Object.assign(new dL,{label:CommonUIStrings.L_DiagnosticsBuild,value:A.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",
h))}b.push.apply(b,this.vyi());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}Eso(){this.ga.ra(Pa.a.g0a,oc.a.view,this.g0a.bind(this));this.ga.ra(Pa.a.hwg,oc.a.view,this.hwg.bind(this));this.ga.ra(Pa.a.iwg,oc.a.view,this.iwg.bind(this))}activateRibbonTab(b){this.jUk(b)}euc(){ml.a.get_instance().isCompleted(7)&&this.pCd&&(ce.a.mark(4893),Fx.a.Pyp(),super.euc(),ce.a.mark(4894))}g0a(b,h,n,B,L){if(2===L[dx.a.iz]){if(n=Object(ya.a)(bB.a,h))B=Object(ya.a)(iH.a,
n.view);else return x.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(h),b,Yb.a.join(L," ",":")),8;if(B&&""!==B.xL)Ve.a.Sla(h)&&Ve.a.hoc()||(this.Yb.Bg(B.xL),appChrome.selectors.getShyState().isActive&&PF.ShyRibbon.hnb(0,1));else return x.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(n.view),
b,Yb.a.join(L," ",":"),this.Pwm(n.view)),8}return 32}Pwm(b){return b?"is ContentEditableView: "+b.ek+" is Editing View: "+b.oCa+" is HtmlView: "+b.gab+" is InteractiveView: "+b.te+" is NavigationPaneView: "+b.Jmn+" is PageView: "+b.nj+" is WordNavigationPaneHeadingsView "+b.g2f:"null view"}}TH.GLk="WACRibbon";Object(u.a)(TH,"ReactRibbonUser",QF,[718,719,191,13]);class yN extends TH{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc=null,dd,Hd){super(b,h,n,B,L,ba,la,La,fb,!1,Cb,Nc);this.a5k=()=>{this.Rq&&
this.Rq.execute(xe=>{xe.logActivity("WordShyRibbon",null)});return 32};this.Y_o=()=>{A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&"true"!==fc.a.get(A.AFrameworkApplication.K.kb("ReactRibbonMLRPreferenceCookieName"))&&ml.a.get_instance().Lk(20,()=>{this.Rq.execute(xe=>{xe.logActivity("FloodgateFirstStart",null)})})};this.e7m=()=>{pi.a.instance.uf(ze.a.u8m,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(xe=>
{var je;this.ZSa&&xe.push.apply(xe,this.WJi());(this.oFh||this.pFh)&&this.$kb&&xe.push.apply(xe,this.zkm());xe.push(appChrome.actions.setControlCustomTooltip(dp.a.fyn,CommonUIStrings.l_LoopsLearnMoreTooltip));xe.push(appChrome.actions.setControlCustomTooltip(dp.a.hql,"Plan and manage tasks with to-do lists you can share and work on with others."));xe.push(appChrome.actions.setControlCustomTooltip(dp.a.yhp,"Assign tasks, set due dates, and track in a table you can easily edit."));xe.push(appChrome.actions.setControlCustomTooltip(dp.a.Fbo,
"Make surveys to get quick feedback, schedule, and plan."));var he=null===(je=A.AFrameworkApplication.K)||void 0===je?void 0:je.kb("ReactShyRibbonPreferenceCookieName");je=fc.a.get(he);this.X_o(je);this.Y_o();xe.push.apply(xe,this.UKa());xe.push(appChrome.actions.setControlBehaviorAttached(!0));const fe=Ya.a.instance.resolve("WordEditor.IModeSwitcherControl");je=fe.rwm();A.AFrameworkApplication.Ld("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",
!1)&&(he=appChrome.selectors.getModeSwitcherMode())&&he!==je.activeMode&&x.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${je.activeMode}, Actual: ${he}`);"Suggest"===je.activeMode||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===je.activeMode?appChrome.getUpdateAppModeAndTabsActions(je,!0).then(De=>{appChrome.api.dispatch(xe.concat(De));fe.sdj();this.mSi()}):(xe.push(appChrome.actions.updateModeSwitcher(je)),
appChrome.api.dispatch(xe),fe.sdj(),this.mSi())})};this.$kb=Lb;this.oFh=$b;this.pFh=tc;this.Rq=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");this.Gb=dd;this.BTe=Hd}t8m(){x.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");ml.a.get_instance().vK(5);const b=this.mXi&&A.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?12:10;ml.a.get_instance().Lk(b,this.e7m,11);A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.lYk()}lYk(){this.Gb.Zb(new Re.a(5,
1,0,()=>{this.BTe.execute(b=>{b.DWo()})}))}zkm(){const b=[];this.oFh&&(b.push(appChrome.actions.setButtonSecondaryText(dp.a.OZd,this.$kb.R0m)),b.push(appChrome.actions.setButtonSecondaryText(dp.a.hYd,this.$kb.Q0m)),b.push(appChrome.actions.setButtonSecondaryText(dp.a.hhd,this.$kb.S0m)));this.pFh&&b.push(appChrome.actions.setButtonSecondaryText(dp.a.fhd,this.$kb.T0m));return b}X_o(b){"true"===b?this.Rq.execute(h=>{h.logActivity("OptInShyRibbonNormalScreenActivity",null)}):"false"!==b&&""!==b||!(1300>
window.innerWidth||700>window.innerHeight)||this.Rq.execute(h=>{h.logActivity("NonOptInShyRibbonSmallScreenActivity",null)});document.addEventListener("ShyRibbonSmallScreenActivity",()=>{requestAnimationFrame(()=>setTimeout(()=>{var h;null===(h=document.getElementById("RibbonModeToggle"))||void 0===h?void 0:h.click()},0))},!1);A.AFrameworkApplication.va.fb(Pa.a.NRh,id.a.frame,this.a5k,96)}mSi(){A.AFrameworkApplication.Ptc.krp();this.VMh();this.wmf();this.gSi();ml.a.get_instance().vK(7);pi.a.instance.Y$(ze.a.hTc,
ze.a.gwg,(new Date).getTime());A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&this.O$b&&this.O$b.j8m(ut.a.QVj)}BPa(b){if(b){const h=this.vzi();try{super.BPa(b)}finally{null===h||void 0===h?void 0:h.dispose()}}}UKa(){const b=this.vzi();try{return super.UKa()}finally{null===b||void 0===b?void 0:b.dispose()}}vzi(){var b;let h=void 0;const n=null===(b=$e.App.jf)||void 0===b?void 0:b.Il;n&&(h=new Sd.GraphTransaction($e.App.YXi()&&$e.App.BZf?
0:2),h.set(n));return h}}Object(u.a)(yN,"ReactRibbonUser",TH,[]);class zN extends ZK{constructor(b,h,n,B,L,ba,la,La){super(b,h,n);this.kYe=A.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&X.a.N7;this.Vl=L;this.X5e=ba;this.Gb=la;this.BTe=La}uJl(b,h){const n=new NF(A.AFrameworkApplication.K,this.ga,this.Yb,this.kYe),B=new yO.a(n);return this.VJl(b,h,B,n)}VJl(b,h,n,B){var L=new kN(new mN(A.AFrameworkApplication.K,B),n);n=this.P7m(L);const ba={};L.Byb(ba);L=!X.a.N7;const la=X.a.Vr||X.a.uj;var La=
X.a.$l;A.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(La=X.a.Di||La);La=new OK.a(La);b=new yN(b,h,WordEditorIntl.WordEditorStrings,this.NDb,B,b,this.Vl,n,new iN(ba),this.X5e,La,L,la,new jN,this.Gb,this.BTe);b.t8m();return b}P7m(b){const h={};b.aod(h);b.Std(h);return new vA(null,h,"jewelWordEditor")}}Object(u.a)(zN,"WordEditorRibbonUserFactory",ZK,[]);class eL{constructor(b,h){this.AB=b;this.OHd=h}rVa(b,h,n,B=null,L=null){return this.OHd.DSj(b)?this.OHd.rVa(b,h,n,B,L):this.AB.rVa(b,
h,n,B,L)}$La(b,h=null){return this.OHd.DSj(b)?this.OHd.$La(b):this.AB.$La(b,h)}}Object(u.a)(eL,"RootCuiUser",null,[205]);class AN extends eL{constructor(b,h){super(b,h)}clearCache(){this.AB.clearCache()}}Object(u.a)(AN,"WordGeneralCuiUser",eL,[204,205]);var GO=d(1534);class oq{static getSelectedText(){const b=(new ca.a).WNf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static b9d(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=F.a.YA(b,h)?h-1:h),b=b.length>h?b.substr(0,
h).trim()+"...":b);return b}}Object(u.a)(oq,"SearchUtils",null,[]);class Dq extends NH{constructor(b,h,n){super(b,n);this.HK=h}NGf(b){const h=[];var n=Zb.a.instance.gb.currentSelection;const B=!!this.HK&&this.HK.P$c(wb.a.qof.toString()),L=!!this.HK&&this.HK.P$c(wb.a.BYb.toString()),ba=!B&&!n.qXa&&Dq.Sdb.Kdj(),la=!(A.AFrameworkApplication.$u&&Dq.EZi)&&(!!this.HK&&this.HK.P$c(Pa.a.IMa.toString())||!!cy.a.instance&&(3===cy.a.instance.mode||2===cy.a.instance.mode)),La=n.h2i()&&A.AFrameworkApplication.ua.Ib.I$c;
var fb=!1;if(A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1)){fb=!!n&&(n.ly||2===n.length&&re.SelectionEditor.gl(n.Uc));var Cb=oq.getSelectedText();fb=fb&&0<Cb.length&&60>Cb.length}b=(Cb=3===b||X.a.Di||A.AFrameworkApplication.zFf)&&Dq.Tzf.q3(n,b);n=Dq.EZi&&n&&1===n.length&&n.J(0).contextId===oc.a.Xc;Cb&&h.push(this.Vl.nBa("ClipboardGroup")[0].externalUxGroupId);ba&&(h.push(this.Vl.nBa("TextFormattingGroup")[0].externalUxGroupId),
h.push(this.Vl.nBa("StylesGroup")[0].externalUxGroupId));fb&&h.push(this.Vl.nBa("DefineGroup")[0].externalUxGroupId);B&&h.push(this.Vl.nBa("PictureToolsGroup")[0].externalUxGroupId);L&&h.push(this.Vl.nBa("TableToolsGroup")[0].externalUxGroupId);La&&h.push(this.Vl.nBa("EquationToolsGroup")[0].externalUxGroupId);la&&h.push(this.Vl.nBa("CommentGroup")[0].externalUxGroupId);n&&h.push(this.Vl.nBa("ContentAssemblyGroup")[0].externalUxGroupId);b&&h.push(this.Vl.nBa("ContextMenuGroup")[0].externalUxGroupId);
GO.a.IWi&&Dq.bhn&&h.push(this.Vl.nBa("DesignerGroup")[0].externalUxGroupId);return h}static get Tzf(){return null!=Dq.QVg?Dq.QVg:Dq.QVg=Ya.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get Sdb(){return null!=Dq.T3g?Dq.T3g:Dq.T3g=Ya.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static K7c(b,h,n,B){b.wcl(()=>Dq.Enb(h,n,B))}static Enb(b,h,n){return new Dq(b,h,n)}static get bhn(){null===this.gXe&&(A.AFrameworkApplication.Ld("DesignerInContextMenuConsumerExp;DesignerInContextMenuConsumerExpCf"),
this.gXe=A.AFrameworkApplication.K?A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerInContextMenuConsumerExpIsEnabled",!1):!1);return this.gXe}static get EZi(){null!==this.OXe||"Templatization"!==A.AFrameworkApplication.$u&&"ContentAssemblyEdit"!==A.AFrameworkApplication.$u||(A.AFrameworkApplication.Ld("insertSnippetTreatment;insertSnippetControl"),this.OXe=A.AFrameworkApplication.K?A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertSnippetActionForCA",
!1):!1);return this.OXe}}Dq.gXe=null;Dq.OXe=null;Object(u.a)(Dq,"WordReactFloatie",NH,[]);class fL{constructor(){this.qia=this.rQc=this.W=null}get name(){return"WordEditor.UI"}init(){var b;this.W.resolve("WordEditor.UI.BusinessBarController").Ikg();const h=$e.App.Ew.kL,n=Ua.StaticActiveAppFrame.za();Dq.K7c(n,this.W.resolve("Common.IReactContextualUILauncher"),h,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));this.qia=this.W.Oa("Box4.IContextMenuController");const B=new NK(n,h,this.W.Qa("Box4.IGeneralCuiUser"),
this.W.resolve("Box4.UI.PasteFloatieManager")),L={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===(b=A.AFrameworkApplication.K)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:L["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:L["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:L["floatie.gbUseSmartPasteButton"]=!1}B.K7c("PasteFloatieData",
null,L);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();(new XK(n,h,this.W.Qa("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).K7c("ExternalContentFloatieData",[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");ml.a.get_instance().Lk(7,()=>{this.rQc=this.W.resolve("WordEditor.UI.StatusBarUser");this.rQc.Wb()})}dispose(){this.rQc&&(this.rQc.dispose(),this.rQc=null);this.qia&&(this.qia.dispose(),this.qia=null)}wc(b){this.W=b;b.ia("WordEditor.UI.BusinessBarController",
()=>new YD(b.resolve("CommonUI.IBusinessBar"),b.resolve("CommonUI.IBusinessBarEntryFactory"),A.AFrameworkApplication.va,A.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").ha();let h=X.a.$l;A.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=X.a.Di||h);b.ia("Box4.UI.ShortcutHintMapping",()=>new OK.a(h));const n=X.a.Vr||X.a.uj,B=A.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(X.a.N7||
n),L=A.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");b.ia("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new Ju(Ya.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Ya.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new mg.a)).ha();b.ia("WordEditor.UI.EditSurfaceContextMenu",()=>new oo(A.AFrameworkApplication.va,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),b.resolve("Box4.Proofing.IErrorRangeEditor"),A.AFrameworkApplication.K,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,L?b.Qa("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),b.Oa("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),b.Qa("Box4.IPresenceDataManager"),b.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
b.Qa("WordEditor.ContextualSearch.ISearchSuggestionManager"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),B,n?b.resolve("Box4.UI.ShortcutHintMapping"):null,Ya.a.instance.Qa("Common.IActionContextProvider"),Ya.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),
b.Oa("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").ha();b.ia("Box4.ISelectionContextMenuProvider",()=>new pw).ha();b.ia("WordEditor.UI.CuiActionBridge",()=>new Gj(A.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").ha();b.ia("WordEditor.UI.DialogFactory",()=>new tJ).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").ha();b.ia("Common.NonCanvasCuiUser",()=>new uD(Ph.FocusManager.instance())).as("Common.INonCanvasCuiUser").ha();b.ia("WordEditor.UI.WordGeneralCuiUser",
()=>new AN(b.resolve("Box4.IGeneralCuiUser"),b.resolve("Common.INonCanvasCuiUser"))).ha();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ia("WordEditor.UI.StatusBarUser",()=>new Xp(Ua.StaticActiveAppFrame.za().JFg,b.Qa("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),A.AFrameworkApplication.va,A.AFrameworkApplication.K,Ua.StaticActiveAppFrame.za())).as("WordEditor.IStatusBarUser").ha();const ba=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ia("CommandUI.ReactRibbonRoot",()=>new zj(gv.instance,
b.resolve("Common.IExternalUICommandDefinitionMapping"),ba)).ha();const la=b.Qa("WordEditor.UI.WordGeneralCuiUser");b.ia("WordEditor.UI.WordEditorRibbonUserFactory",()=>new zN(la,A.AFrameworkApplication.va,Ph.FocusManager.instance(),b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),A.AFrameworkApplication.mc,b.Qa("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").ha();
b.ia("WordEditor.UI.ReactLanguageDialog",()=>new WB(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");b.ia("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new hN(A.AFrameworkApplication.va)).as("Common.IRibbonSQMInformation").ha();b.ia("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new uJ(A.AFrameworkApplication.va)).as("Common.IFileMenuSQMInformation").ha();b.ia("WordEditor.UI.RulerUser",()=>new gN).as("WordEditor.IRulerUser");
b.ia("WordEditor.UI.RulerContextMenu",()=>new rn(A.AFrameworkApplication.va,Ya.a.instance.Qa("Common.IZoomManager"),dt.a.instance)).as("WordEditor.IRulerContextMenu").ha();b.ia("Common.IReactContextualUILauncher",()=>new LK(b.resolve("CommandUI.ReactRibbonRoot"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).ha();b.ia("Box4.IContextMenuController",()=>new PK(b.resolve("Common.IReactContextualUILauncher"))).ha()}static main(){A.AFrameworkApplication.Ld("5b6i5792;30d4f535");Cp.instance.Uji();
Cp.instance.IAf();M.a.instance.Jc(new fL,6)}}Object(u.a)(fL,"WordEditorUIPackage",null,[0,1]);var HO=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},
children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",
attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},
XB={};XB.fCc=function(){function b(){return la()&&(dd()||3<=($b()?Hd("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}function n(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function B(Yf){Yf=(new RegExp(Yf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Ci=-1;null!=Yf&&2<=Yf.length&&(Ci=parseFloat(Yf[1]),isNaN(Ci)&&(Ci=-1));return Ci}function L(){pJ||(pJ=!0,qJ=B("Windows Phone"));return 8<=qJ}function ba(){return"function"==typeof navigator.msLaunchUri&&
!n()&&!Nc()&&!La()}function la(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function La(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function fb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Cb(){return fb()?8==window.document.documentMode:!1}function Lb(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function $b(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function tc(){return 0<=
window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Nc(){var Yf=window.navigator.userAgent.toLowerCase();return 0<=Yf.indexOf("android")&&0<=Yf.indexOf("chrome")}function dd(){return 3<=(Lb()?Hd("firefox/"):0)}function Hd(Yf){var Ci=window.navigator.userAgent.toLowerCase(),Aj=Ci.indexOf(Yf);return 0<=Aj?parseInt(Ci.substring(Aj+Yf.length,Ci.length)):0}function xe(Yf,Ci,Aj,Ik,eo){if(Ik&&null!=Ci)Ci();else if(ba())navigator.msLaunchUri(Yf,Ci,Aj);else if(!(tc()||0<=window.navigator.userAgent.indexOf("iPhone")||
0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&la())||La())he(Yf,Ci,Aj);else if(tc()&&eo)a:{try{window.open(Yf,"_self")}catch(Rq){null!=Aj&&Aj();break a}null!=Ci&&Ci()}else je(Yf,Ci,Aj)}function je(Yf,Ci,Aj){var Ik=document.getElementById("OICLinkTag");null==Ik&&(Ik=document.createElement("a"),Ik.id="OICLinkTag",Ik.style.visibility="hidden",Ik.href="",0==(Ro.Options&tu.SupportsTopTargetNavigation)||Ro.NoBrowserModalDialogs?Ik.target="_blank":Ik.target="_top",document.body.appendChild(Ik),
null!=Ik.addEventListener&&Ik.addEventListener("click",function(eo){null!=eo.stopPropagation&&eo.stopPropagation()},!1));try{Ik.href=Yf,Ik.dispatchEvent(new MouseEvent("click"))}catch(eo){null!=Aj&&Aj();return}null!=Ci&&Ci()}function he(Yf,Ci,Aj){var Ik=document.getElementById("OICFrame");null==Ik&&(Ik=document.createElement("iframe"),Ik.className="ObjectInDialog",Ik.style.visibility="hidden",Ik.src="about:blank",document.body.appendChild(Ik),Ik.id="OICFrame");try{Ik.contentWindow.location.href=Yf}catch(eo){null!=
Aj&&Aj();return}null!=Ci&&Ci()}function fe(Yf){return 0!=(Yf.Options&tu.SkipProtocolHandler)||Cb()}function De(Yf){return Yf===ny.ReadOnly||Yf===ny.ReadWrite}function gg(Yf,Ci,Aj,Ik){var eo;try{var Rq=new ActiveXObject("SharePoint.OpenDocuments.4");return(eo=Rq.ViewDocument3(window.self,Yf,Ci,Ik))?(uA(oy.O14ActiveX),Ao.None):Ao.Failed}catch(Jp){}if(tu.O14Only===(Aj&tu.O14Only))return Ro.DescriptiveUnattemptedEnums?Ao.O14AttemptFailure:Ao.Unattempted;try{return Rq=new ActiveXObject("SharePoint.OpenDocuments.3"),
(eo=Rq.ViewDocument3(window.self,Yf,Ci,Ik))?(uA(oy.O12ActiveX),Ao.None):Ao.Failed}catch(Jp){}if(tu.O12UpOnly===(Aj&tu.O12UpOnly))return Ro.DescriptiveUnattemptedEnums?Ao.O12UpOnlyFail:Ao.Unattempted;try{return Rq=new ActiveXObject("SharePoint.OpenDocuments.2"),(eo=De(Ci)?Rq.ViewDocument2(window.self,Yf,Ik):Rq.EditDocument2(window.self,Yf,Ik))?(uA(oy.O11ActiveX),Ao.None):Ao.Failed}catch(Jp){}return Ro.DescriptiveUnattemptedEnums?Ao.ActiveXUnattempted:Ao.Unattempted}function eg(Yf,Ci,Aj,Ik,eo){Yf==
Wp.Visio&&Aj==ny.ReadWrite&&(Aj=ny.WriteOnly);Ik=Ik||n()&&!L();if(!Ik){Ik="";if(Yf==Wp.PowerPoint){Yf=Ik;Ik=Ro.DocumentExtension;Aj=De(Aj);var Rq=new Set([".pot",".potm",".potx"]),Jp=new Set([".pps",".ppsm",".ppsx"]);Aj=Aj&&Rq.has(Ik)?"nft|ofc|":Aj&&Jp.has(Ik)?"ofv|ofs|t|":!Aj&&Jp.has(Ik)?"ofe|ofs|t|":Aj?"ofv|ofc|":"ofe|";Aj=Yf+Aj}else Aj=De(Aj)?Ik+"ofv|ofc|":Ik+"ofe|";Ik=Aj;Ro.NewTelemetryDataIsEnabled&&(Aj=Ro.SessionOrigin?"or|"+Ro.SessionOrigin+"|":"",Aj+=Ro.ClickTime?"ct|"+Ro.ClickTime+"|":"",
Aj+=Ro.CorrelationId?"cid|"+Ro.CorrelationId+"|":"",Ik+=wl(Aj));eo+=wl(Ik+"u|")}eo+=wl(Ci);Ci=window.location.href;Aj=Ci.toLowerCase().indexOf("&wdlor=");-1!=Aj?(Aj+=7,Yf=Ci.indexOf("&",Aj),Ci=-1==Yf?Ci.substr(Aj):Ci.substring(Aj,Yf)):Ci=void 0;if(null!=Ci&&"undefined"!=typeof Ci){Aj="";try{Aj=decodeURIComponent(Ci)}catch(zD){}0<Aj.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Aj)&&(eo=eo+"|f|"+Aj)}return eo}function vl(Yf,Ci,Aj,Ik,eo,Rq){var Jp=mJ(Yf);if(null==Jp)return lz(Ro.DescriptiveUnattemptedEnums?
Ao.ProtocolHandlerIsNull:Ao.Unattempted,Ro.Application),!1;Yf=eg(Yf,Ci,Aj,Ik,Jp);xe(Yf,Sm,qp,eo,Rq);return!0}function wl(Yf){if(la()&&tc()){var Ci="";try{Ci=decodeURI(Yf)}catch(Aj){}if(Ci==Yf)return encodeURI(Yf)}return Yf}function Sm(){uA(oy.ProtocolHandler)}function qp(){Ro.Options|=tu.SkipProtocolHandler;FH(Ro,UB,yD)}function my(){null!=KF&&KF(oy.RoamingProtocolHandler)}function gx(){null!=JH&&JH(Ao.ControlNeeded)}function ow(){var Yf=document.getElementById("npSharePointPlugin");if(null==Yf){Yf=
"application/x-sharepoint";la()&&3<=($b()?Hd("version/"):0)&&tA("application/x-sharepoint-webkit",!0)&&(Yf="application/x-sharepoint-webkit");if(!tA(Yf,!0))if(la()&&tA("application/officelive",!0))Yf="application/officelive";else return null;var Ci=document.createElement("object");Ci.id="npSharePointPlugin";Ci.type=Yf;Ci.style.width="0px";Ci.style.height="0px";Ci.style.setProperty("visibility","hidden","");document.body.appendChild(Ci);Yf=document.getElementById("npSharePointPlugin")}return Yf}function tA(Yf,
Ci){var Aj=window.navigator.mimeTypes;if(null==Aj)return!1;Yf=Aj[Yf];return!Yf||Ci&&!Yf.enabledPlugin?!1:!0}function wD(Yf){try{if(null!=new ActiveXObject(Yf))return!0}catch(Ci){}return!1}function EH(Yf){switch(Yf){case Wp.OneNote:return"OneNote.Notebook";default:return""}}function mJ(Yf){if(Yf!=Wp.OneNote&&n()&&!L())return"office:";switch(Yf){case Wp.Excel:return"ms-excel:";case Wp.OneNote:return"onenote:";case Wp.PowerPoint:return"ms-powerpoint:";case Wp.Visio:return"ms-visio:";case Wp.Word:return"ms-word:";
case Wp.Project:return"ms-project:";case Wp.Publisher:return"ms-publisher:";case Wp.Infopath:return"ms-infopath:";case Wp.Access:return"ms-access:";default:return""}}function nJ(Yf){switch(Yf){case Wp.Excel:return"root\\office15\\excel.exe";case Wp.PowerPoint:return"root\\office15\\powerpnt.exe";case Wp.Visio:return"root\\office15\\visio.exe";case Wp.Word:return"root\\office15\\winword.exe";case Wp.Project:return"root\\office15\\winproj.exe";case Wp.Publisher:return"root\\office15\\mspub.exe";case Wp.Infopath:return"root\\office15\\infopath.exe";
case Wp.Access:return"root\\office15\\msaccess.exe";default:return null}}function FH(Yf,Ci,Aj){Ro=Yf;UB=Ci;yD=Aj;if(Yf.DocumentUrl){var Ik=Aj=Ci=Yf.DocumentUrl;try{Ik=decodeURIComponent(Yf.DocumentUrl)}catch(AD){}try{Aj=encodeURI(Yf.DocumentUrl)}catch(AD){}Ci=Ci+""+Yf.CorrelationIdForWinClient;Ik+=Yf.CorrelationIdForWinClient;Aj+=Yf.CorrelationIdForWinClient;Yf.Mode===ny.ReadWrite&&tu.CheckoutRequired===(Yf.Options&tu.CheckoutRequired)&&(Yf.Mode=ny.ForceCheckout);tu.HostIsEditOnly===(Yf.Options&tu.HostIsEditOnly)&&
(Yf.Mode=ny.WriteOnly);if(fe(Yf)?0:la()&&(Yf.Application==Wp.OneNote||tA("application/x-sharepoint-protocolhandler",!1)||tA("application/x-sharepoint-webkit-protocolhandler",!1))||ba()||Nc()||!(b()||dd()||"ActiveXObject"in window&&!n()||tc())||15<=xD())vl(Yf.Application,Yf.EncodeUrl?Aj:Ci,Yf.Mode,Yf.Application==Wp.OneNote,Yf.SilentExternalHandler,Yf.NavigateUsingWindowOpen);else{var eo;if(eo=Cb())a:{var Rq=Yf.EncodeUrl?Ci:Ik,Jp=Yf.Mode,zD=EH(Yf.Application);try{eo=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,
Rq,Jp,zD);break a}catch(AD){}eo=!1}if(eo)uA(oy.O15ActiveX);else{if(b()||dd()){var bs=Yf.EncodeUrl?Ci:Ik;Ik=Yf.Mode;eo=EH(Yf.Application);Rq=ow();if(null==Rq)bs=Ro.DescriptiveUnattemptedEnums?Ao.PluginIsNull:Ao.Unattempted;else{Jp=!1;try{Jp=Rq.ViewDocument3(window.self,bs,Ik,eo)}catch(AD){}if(!Jp)try{Jp=De(Ik)?Rq.ViewDocument2(window.self,bs,eo):Rq.EditDocument2(window.self,bs,eo)}catch(AD){}Jp?(uA(oy.NpapiPlugin),bs=Ao.None):bs=Ao.Failed}}else{try{bs=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=bs&&
bs.SaveSSOCreds()}catch(AD){}bs=gg(Yf.EncodeUrl?Ci:Ik,Yf.Mode,Yf.Options,EH(Yf.Application))}if(bs!=Ao.None){if(Ik=Yf.CouldUseRoamingApps)KH||(KH=!0,LH=B("Windows NT")),Ik=6.1<=LH&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(fb()||dd()||tc());if(Ik&&Yf.Application!=Wp.OneNote){if(!XB.fCc.nLp()){lz(Ao.ControlNeeded,Ro.Application);return}if(Yf.RoamingAppsLauncher){"undefined"==typeof Yf.RoamingAppsLauncher||null==Yf.RoamingAppsLauncher?lz(Ro.DescriptiveUnattemptedEnums?Ao.RoamingLauncherIsNull:
Ao.Unattempted,Ro.Application):"undefined"==typeof Yf.RoamingBitsUrl||null==Yf.RoamingBitsUrl?XB.fCc.VNp(Yf.DocumentUrl,Yf.RoamingAppsLauncher,Yf.Application,Yf.ApplicationParameters,UB,yD):XB.fCc.Ugk(Yf.DocumentUrl,Yf.RoamingAppsLauncher,Yf.RoamingApplicationExe,Yf.ApplicationParameters,Yf.RoamingPlatform,Yf.RoamingBitsUrl,UB,yD);return}if(!Yf.ContinueIfLauncherIsNull){lz(Ao.LauncherNeeded,Ro.Application);return}}tu.NoProtocolHandlerFallback==(Yf.Options&tu.NoProtocolHandlerFallback)||fe(Yf)||fb()||
la()&&!(Ro.DescriptiveUnattemptedEnums?bs>=Ao.O14Unattempted&&bs<=Ao.DocumentUrlIsNull:bs==Ao.Unattempted)?lz(bs,Ro.Application):vl(Yf.Application,Yf.EncodeUrl?Aj:Ci,Yf.Mode,Yf.Application==Wp.OneNote,Yf.SilentExternalHandler,Yf.NavigateUsingWindowOpen)}}}}else lz(Ro.DescriptiveUnattemptedEnums?Ao.DocumentUrlIsNull:Ao.Unattempted,Ro.Application)}function uA(Yf){null!=UB&&UB(Yf)}function lz(Yf,Ci){"undefined"==typeof Ci&&(Ci=null);null!=yD&&yD(Yf,Ci)}function xD(){var Yf=0;if(b()||dd()||tc()){var Ci=
ow();try{null!=Ci&&(Yf=Ci.GetOfficeVersion())}catch(Aj){}}else wD("SharePoint.OpenDocuments.5")?Yf=15:wD("SharePoint.OpenDocuments.4")?Yf=14:wD("SharePoint.OpenDocuments.3")?Yf=12:wD("SharePoint.OpenDocuments.2")&&(Yf=11);return Yf}function GH(){return la()&&(tA("application/x-sharepoint",!0)||tA("application/x-sharepoint-webkit",!0))}var HH="",oJ="",IH="",UB,yD,KF,JH,Ro,KH,LH,pJ,qJ,ny={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},tu={None:0,CheckoutRequired:1,
O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Ao={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},oy={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,
RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Wp={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:ny,OpenDocumentOptions:tu,OpenDocumentFailureType:Ao,OpenDocumentControl:oy,OfficeApplication:Wp,EditDocumentInClient:FH,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=Wp.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=
!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:xD,IsO14MacPluginInstalled:GH,OfferOfficeInDialog:function(){return h()&&11>=xD()},OfferOfficeNoIntrusive:function(){return h()&&
15>xD()},OfferMacOffice:function(){return la()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!GH()},InstallRoamingControl:function(){Lb()?window.InstallTrigger.install({Office:{URL:oJ}}):he(IH,null,null)},CanUseRoamingControl:function(){if(ba())return!0;if(tc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Lb()){var Yf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Yf);
var Ci=document.createEvent("Events");Ci.initEvent("RoamingOfficeInstalled",!0,!1);Yf.dispatchEvent(Ci);return!!Yf.getAttribute("installed")}if(fb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Aj){}return!1},InitUrls:function(Yf,Ci,Aj){HH=Yf;oJ=Aj;IH=Ci},LaunchRoamingApps:function(Yf,Ci,Aj,Ik,eo,Rq){XB.fCc.Ugk(Yf,Ci,nJ(Aj),Ik,"x86",HH,eo,Rq)},LaunchRoamingApps2:function(Yf,Ci,Aj,Ik,eo,Rq,Jp,zD){var bs="";null!=Ik&&(bs+=" "+Ik);null!=Yf&&(bs+=' "'+Yf+'"');if(ba()||
tc())KF=Jp,JH=zD,Jp='office: "'+(Rq+'" "')+(Aj+'" "ROAMING"'),Jp+=' "'+Ci+'"',Jp+=' "'+eo+'"',Jp+=" "+bs,xe(Jp,my,gx,!1,!1);else if(Lb())Yf=document.createElement("RoamingExtensionElement"),Yf.setAttribute("cabUrl",Rq),Yf.setAttribute("app",Aj),Yf.setAttribute("licensingEntitlements",Ci),Yf.setAttribute("platform",eo),Yf.setAttribute("args",bs),document.documentElement.appendChild(Yf),Ci=document.createEvent("Events"),Ci.initEvent("RoamingOfficeLaunch",!0,!1),Yf.dispatchEvent(Ci),null!=Jp&&Jp(oy.RoamingFFExtension);
else if(fb()){if(Yf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Yf)try{Yf.HrConfigureSingle(Rq,Aj,Ci,eo,bs),null!=Jp&&Jp(oy.RoamingActiveX)}catch(AD){}}else null!=zD&&zD(Ao.Failed)},ShouldShowDialog:function(){return!n()},NavigateToUrlUsingClickingOnATag:je,OpenDocumentWithProtocolHandler:vl,OpenDocumentWithProtocolHandlerNoCallBack:function(Yf,Ci,Aj,Ik){var eo=mJ(Yf);if(null==eo)return lz(Ro.DescriptiveUnattemptedEnums?Ao.ProtocolHandlerNoCallbackIsNull:Ao.Unattempted,Ro.Application),
!1;Yf=eg(Yf,Ci,Aj,Ik,eo);xe(Yf,null,null,!1,!1);return!0}}}();XB.ClientUtils=XB.fCc;var UH=d(1550);class zJ{constructor(b,h,n){this.X3n=(B,L,ba,la,La)=>{if(1===ba)return 32;La?(B=La.SourceControlId,"btnjTryMacOfficeForWordEditor"===B?$c.a.yn(za.a.k9a(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===B&&$c.a.yn(za.a.k9a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.v6i();return 32};this.dpj=(B,L,ba)=>{if(1===ba)return 32;switch(B){case Pa.a.g4j:$c.a.yn(za.a.k9a(15),
"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Pa.a.f4j:$c.a.yn(za.a.k9a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};this.ga=b;this.vBk=h;this.q$=n}Wb(){this.ga.ra(Pa.a.Dpp,id.a.frame,this.X3n);this.ga.ra(Pa.a.g4j,id.a.frame,this.dpj);this.ga.ra(Pa.a.f4j,id.a.frame,this.dpj)}v6i(){$c.a.yn(zJ.oHn,"_blank",void 0,"LaunchMacTrialWindow")}get rpd(){return this.vBk&&X.a.$l&&!X.a.$_f&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get O2o(){const b=this.rpd;b||
A.AFrameworkApplication.wm.dRo();return b}get N2o(){return this.rpd}static get oHn(){return za.a.eba("522401")}}Object(u.a)(zJ,"MacOfficeOffer",null,[1547]);class AJ{constructor(b,h,n){this.Y3n=(B,L,ba,la,La)=>{if(this.IPd&&1===ba)return this.isFreemiumUpsellEnabled&&this.tpd?32:8;2===ba&&(La?(B=La.SourceControlId,"btnjTryOfficeForWordEditor"===B?$c.a.yn(za.a.k9a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===B?$c.a.yn(za.a.k9a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):
this.y3f()):this.y3f());return 32};this.MKg=(B,L,ba,la,La)=>{if(this.IPd&&1===ba)return this.isFreemiumUpsellEnabled&&this.tpd?32:8;2===ba&&(La?(B=La.SourceControlId,$c.a.yn(za.a.eba("862405")+this.NEm(B),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):$c.a.yn(za.a.eba("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};this.m4j=(B,L,ba)=>{if(this.IPd&&1===ba)return this.isFreemiumUpsellEnabled&&this.tpd?32:8;if(2===ba)switch(B){case Pa.a.l4j:$c.a.yn(za.a.k9a(14),
"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Pa.a.k4j:$c.a.yn(za.a.k9a(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};this.ga=b;this.CBk=h;this.GK=null;(this.IPd=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Ya.a.instance.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(B=>{this.GK=B});this.q$=n}Wb(){this.ga.ra(Pa.a.Opp,id.a.frame,this.Y3n);this.ga.ra(Pa.a.MKg,
id.a.frame,this.MKg);this.ga.ra(Pa.a.l4j,id.a.frame,this.m4j);this.ga.ra(Pa.a.k4j,id.a.frame,this.m4j)}get iTn(){return this.tpd}get hTn(){return this.tpd&&MSOJS.ClientUtils.OfferOfficeInDialog()}get tpd(){return this.CBk&&!X.a.$l}get isFreemiumUpsellEnabled(){let b=!1;this.GK&&(b=this.GK.isFreemiumUpsellEnabled());return b}y3f(b=null){let h=0;b&&(h=b);$c.a.yn(AJ.gym(h),"_blank",void 0,"LaunchOfficeOffer")}NEm(b){let h=0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=
2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=
16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=
29}return 0===h?"":String.format("&pc={0:D}",h)}static gym(b){if(X.a.Di)switch(b){case 1:return za.a.eba("393806");case 2:return za.a.eba("393810");case 3:return za.a.eba("393809");case 5:return za.a.eba("393805")}else if(X.a.vI)switch(b){case 1:return za.a.eba("521979");case 3:return za.a.eba("521980");case 5:return za.a.eba("521978");case 2:return za.a.eba("522490")}else{if(2===b)return za.a.eba("517778");if(1===b)return za.a.k9a(30)}return za.a.eba("522402")}}Object(u.a)(AJ,"OfficeTrialExperience",
null,[1546]);class BN{wc(b){b.register(AJ,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ha().Rd(()=>new AJ(A.AFrameworkApplication.va,A.AFrameworkApplication.G_f,A.AFrameworkApplication.lcid));b.register(zJ,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ha().Rd(()=>new zJ(A.AFrameworkApplication.va,A.AFrameworkApplication.y_i,A.AFrameworkApplication.lcid))}}Object(u.a)(BN,"OpenInClientConfiguration",null,[1]);class CN{constructor(b=!1,
h=!1,n=!1,B=!1,L=!0,ba=!1,la=!0,La=!0,fb=!0,Cb=!1,Lb=!1,$b=!1,tc=!1,Nc=!1,dd=!1,Hd=!1,xe=!1,je=!1,he=null,fe=null,De=null,gg=null,eg=null,vl=null,wl=null,Sm=null,qp=null){this.Unc=!1;this.BIk=b;this.GIk=h;this.iNk=n;this.gNk=B;this.bNk=L;this.cNk=ba;this.eNk=la;this.fNk=La;this.dNk=fb;this.tNk=Cb;this.NNk=Lb;this.sNk=$b;this.fPk=tc;this.mNk=Nc;this.Gzk=dd;this.FNk=Hd;this.ONk=xe;this.jqk=je;this.kNk=he;this.rNk=fe;this.hNk=eg;this.pNk=De;this.jNk=gg;this.oNk=vl;this.qNk=wl;this.lNk=Sm;this.nNk=qp}get isj(){return this.BIk}get v$n(){return this.GIk}get zSj(){return this.iNk}get ySj(){return this.gNk}get Y1o(){return this.bNk}get Z1o(){return this.cNk}get a2o(){return this.eNk}get b2o(){return this.fNk}get $1o(){return this.dNk}get Kyb(){return this.mNk}get Z8m(){return this.Gzk}get gTj(){return this.FNk}get ITj(){return this.ONk}get bml(){return this.jqk}get CSj(){return this.tNk}get j4o(){return this.NNk}get k2o(){return this.sNk}get Nep(){return this.fPk}get ASj(){return this.kNk||
Object(z.a)(this,this.Tvc,"returnFalse")}get j2o(){return this.rNk||Object(z.a)(this,this.Tvc,"returnFalse")}get i2o(){return this.pNk||Object(z.a)(this,this.Svg,"returnTrue")}get d2o(){return this.jNk||Object(z.a)(this,this.Svg,"returnTrue")}get c2o(){return this.hNk||Object(z.a)(this,this.Tvc,"returnFalse")}get h2o(){return this.oNk||Object(z.a)(this,this.Svg,"returnTrue")}get BSj(){return this.qNk||Object(z.a)(this,this.Tvc,"returnFalse")}get e2o(){return this.lNk||Object(z.a)(this,this.Tvc,"returnFalse")}get g2o(){return this.nNk||
Object(z.a)(this,this.Tvc,"returnFalse")}Svg(){return!0}Tvc(){return!1}}Object(u.a)(CN,"HtmlTranslatorSettings",null,[316]);class py{constructor(b,h,n,B,L,ba,la){this.mg=b;this.rg=h;this.g_=n;this.RCf=B;this.Lj=L;this.Md=ba;this.cK=la}m$m(b,h){var n;b=h.view;h=h.Hk;if(!h||!this.mg.hYi(h,!0)||this.RCf&&this.RCf.instance&&this.RCf.instance.DX(h))return 2;var B=py.Jeb?!py.t3.uCa(h):!0;this.g_&&B&&this.g_.LAc(h.node,Jd.a.Mu,h.cpBegin);B=h.node;(null===(n=this.cK)||void 0===n?0:n.replaceText)&&this.cK.Woc(B)?
(n=B.qa.Y7a(h.cpBegin),this.cK.replaceText(B,n,n,Im.a.Fbd)):this.rg.Gla(h,L=>new Im.a(L));if(this.Md.Mg){n=new Sd.GraphTransaction(15);try{n.Ab(h.node),this.Lj.Hna(h.node,h.cpBegin,h.cpBegin+1,1)}finally{n&&n.dispose()}}B=h.node;n=h.cpEnd+1;" "===ea.ParagraphReader.text(B).charAt(n)&&(B=Nd.a.createTextRange(B,n,n+1),this.rg.Ne(B,"\u00a0"));h=Nd.a.Tc(h.node,n);b.lb.Ic(Oe.SelectionFactory.Fo(h));return 32}static get t3(){return null!=py.OYg?py.OYg:py.OYg=Ya.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Jeb(){null==
py.pqa&&(py.pqa=A.AFrameworkApplication.K?A.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return py.pqa}}py.pqa=null;Object(u.a)(py,"InsertLineBreakStrategy",null,[]);class Wu{static get Kf(){return null!=Wu.b2g?Wu.b2g:Wu.b2g=Ya.a.instance.resolve("Box4.IOutlineElementEditor")}static get Lj(){return null!=Wu.S5g?Wu.S5g:Wu.S5g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Md(){return null!=Wu.v6g?Wu.v6g:Wu.v6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static M$m(b,
h,n,B,L){if(L&&L.hasProperty(zd.a.targetObject)){var ba=h.view.jd.Lc.Eb(L.getValue(zd.a.targetObject));ba=Nd.a.create(ba)}else ba=Object(el.a)().EW(h.Hk,11);if(!ba)return 8;b=A.AFrameworkApplication.va.lg(ba,b,n,!0,B,L);if(32===b&&2===n){if(!h.view.te)return 2;h=h.view;B=h.lb.Og;if(B=Object(el.a)().EW(B,11)){n=new Ml.a;n.set(B.node);n.Jd();if(L&&L.hasProperty(zd.a.targetObject))for(L=L.wf(zd.a.targetObject);!n.currentNode.id.equals(L)&&n.uc()&&(Ga.OutlineElementNavigator.he(n),11===n.lf););Ga.OutlineElementNavigator.Y3(n,
!1,!1);L=re.SelectionEditor.lKa(n,!0);L=ea.ParagraphReader.zu(L)?Oe.SelectionFactory.se(L,0):Oe.SelectionFactory.lr(L);h.lb.Ic(L)}}return b}static nce(b,h,n,B,L){b=b===wb.a.f8c;h=h.node;if(L&&L.hasProperty(zd.a.targetObject)&&!h.id.equals(L.wf(zd.a.targetObject)))return 2;if(1===n)return 32;n=new ve.GraphIterator;n.set(h);n.zb(10);Wu.Kf.$z(n,b,!0);Wu.Md.Mg&&(n=Ga.OutlineElementNavigator.Le(n),Wu.Lj.h0b(n,1));return 32}}Object(u.a)(Wu,"InsertOutlineElementStrategy",null,[]);class VH{constructor(b,
h,n,B,L,ba,la,La,fb,Cb,Lb){this.kTi=($b,tc,Nc)=>{var dd,Hd;if(null===(dd=this.Jda)||void 0===dd?0:dd.U_a)return this.Jda.U_a(Nc,tc.cpBegin,{Fb:tc.Fb,Tb:tc.Tb});dd=!tc.cpBegin;Nc=tc.cpBegin===ea.ParagraphReader.textLength(Nc);const xe=!(null===(Hd=we.StaticTheCoauthManager.ud())||void 0===Hd||!Hd.Jo);let je=!0;xe&&dd&&!Nc?(je=!1,Hd=new ve.GraphIterator,Hd.hd($b),Hd.Jd(),this.Oh.$z(Hd,!0,!1)):Hd=this.Oh.tta($b);this.Oh.Tca($b,Hd,tc,!1,!0,je,!1,!0);!xe||dd||Nc||($b=Object(el.a)().$5d(tc),we.StaticTheCoauthManager.ud().Ak.yG($b));
return Hd};this.p1=h;this.Iuk=b;this.uB=ba;this.LDk=L;this.Oh=n;this.Esk=B;this.ul=la;this.hb=La;this.tG=fb;this.kFc=Cb;this.Jda=Lb}$Pn(b,h,n,B,L){if(!h.view.te)return 2;h=h.view;let ba=null;h.nj&&(ba=h);const la=h.lb.Og;var La=!0;let fb=!1,Cb=null;if(!la)return 2;const Lb=new Sd.GraphTransaction(15);Lb.Ab(h.jd);let $b=null;2===n&&($b=new Ml.a,$b.set(la.node),$b.Jd(),Cb=new wC.a($b),Ga.OutlineElementNavigator.he($b),La=xb.OutlineElementReader.isEmpty($b,!1),{RSj:La,Abk:fb}=this.Esk.SSj($b,La,Hv.a.oQb,
-1,la));b=A.AFrameworkApplication.va.lg(la,b,n,!1,B,L);La&&32===b&&2===n&&(fb||Ga.OutlineElementNavigator.GMa($b,!1,!re.SelectionEditor.mf(la),!1),fb&&Cb&&Cb.restore($b),this.uB.freeze(),(n=Oe.SelectionFactory.pp($b.currentNode,!0))||x.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),h.lb.Ic(n),this.uB.ZOa(),this.Iuk.tg.$G());ba&&(La||ba.V0(),ba.Ke&&ba.EX&&(ba.Ke.wK=!0));yz.GrippersManager.instance.C2b(1);Lb.dispose();return b}newLine(b,h,n){b=!1;if(Ad.ImageReader.M7(h)||
Ad.ImageReader.M$a(h))h=this.qBl(h),b=!0;const B=h;if((h=re.SelectionEditor.mf(h))&&this.ul.vh&&!this.ul.Qmn(B))return 2;if(1===n)return 32;const L=B.node,ba=new ve.GraphIterator;ba.set(L);ba.Jd();Ga.OutlineElementNavigator.he(ba);n=new Sd.GraphTransaction(15);n.qu(ba);h?(this.kFc.instance&&this.kFc.instance.pPa(B),ea.ParagraphReader.Xb(L)&&B.cpBegin===ea.ParagraphReader.textLength(L)&&tn.m(B)&&9===ea.ParagraphReader.C9a(L)&&this.uB.oCl(B),Gf.ListItemReader.Hg(ba)?this.LDk.execute(ba,B,L,this.kTi):
this.kTi(ba,B,L),this.p1&&this.p1.LAc(L,Jd.a.Mu,B.cpBegin),b&&(Ga.OutlineElementNavigator.ht(ba,!1,!1),b=ba.Ub(2),(b=this.tG.se(b,0))&&this.hb.Ic(b))):this.Oh.$z(ba,!0,!0);n.dispose();Ua.StaticActiveAppFrame.za()&&Ua.StaticActiveAppFrame.za().Ie();return 32}qBl(b){if(Ad.ImageReader.M7(b))var h=Nd.a.Tc(b.node,b.cpBegin);else{h=ea.ParagraphReader.YT(b.node);var n=h.properties.wf(Lc.a.Kq);b=b.node.properties.getValue(Lc.a.runId);n=VH.PIf(b,n,h.qa);h=Nd.a.Tc(h,n)}return h}static bEf(b,h){let n=0;for(;n<
h.length&&!(b<h[n]);)n++;return n}static PIf(b,h,n){let B=0;b=VH.bEf(b,h);let L=0;if(b===h.length)L=n.length-1;else for(;L<n.length;){h=n.J(L);if(h.formatting&&h.formatting.oe===b)break;L++}L<n.length&&(B=n.J(L).cp);return B}}Object(u.a)(VH,"NewLineStrategy",null,[]);class nz{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd,Hd){this.Fn=null;this.Hqa=b;this.ZAd=la;this.HHd=new VH(this,h,n,B,L,ba,La,Lb,$b,dd,Hd);this.mnh=new py(La,fb,h,Cb,tc,Nc,Hd)}get tg(){return this.Fn||(this.Fn=this.Hqa())}Wb(){const b=
A.AFrameworkApplication.va,h=Object(z.a)(this.HHd,this.HHd.newLine,"newLine");b.fb(wb.a.enter,oc.a.view,Object(z.a)(this.ZAd.value,this.ZAd.value.v2l,"enterView"),1124);b.fb(wb.a.aSj,oc.a.view,Object(z.a)(this.ZAd.value,this.ZAd.value.J0o,"shiftEnterView"),1124);b.ra(wb.a.newLine,oc.a.view,Object(z.a)(this.HHd,this.HHd.$Pn,"newLineView"));b.ra(wb.a.newLine,oc.a.Xc,h);b.ra(wb.a.newLine,oc.a.image,h);b.ra(wb.a.newLine,oc.a.Bd,h);b.ra(wb.a.newLine,oc.a.caa,h);b.ra(wb.a.newLine,oc.a.bpb,h);b.ra(wb.a.newLine,
oc.a.R7c,h);b.ra(wb.a.newLine,oc.a.paragraph,h);b.ra(wb.a.newLine,oc.a.dK,h);b.ra(wb.a.newLine,oc.a.yPa,h);b.Rc(wb.a.newLine,1124);b.fb(wb.a.b8c,oc.a.view,Object(z.a)(this.mnh,this.mnh.m$m,"insertLineBreakView"),1028);b.ra(wb.a.f8c,oc.a.view,Wu.M$m);b.ra(wb.a.f8c,oc.a.jS,Wu.nce);b.Rc(wb.a.f8c,1092)}static get instance(){return null!=nz.RZg?nz.RZg:nz.RZg=nz.Qm()}static Qm(){return new nz(()=>Ya.a.instance.resolve("Box4.IUndoManager"),Ya.a.instance.Oa("Box4.IAutoCorrectScheduler"),Ya.a.instance.resolve("Box4.IOutlineElementEditor"),
Ya.a.instance.resolve("Box4.List.ICursorMovementValidator"),Ya.a.instance.resolve("Box4.List.ListNewLineStrategy"),Ya.a.instance.resolve("Box4.IInsertionPointFormatting"),Ya.a.instance.rf("Box4.Actors.IEnterViewStrategy"),Pd.a.instance,Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.Qa("Box4.IExternalSelectionManager"),Zb.a.instance,Ya.a.instance.resolve("Box4.ISelectionFactory"),Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Ya.a.instance.Qa("Box4.IContentControlConverter"),Ya.a.instance.resolve("Box4.IBox4GraphWriter"))}}Object(u.a)(nz,"EnterActor",null,[]);var qy=d(1444),RF=d(630);class yk{static get rl(){return null!=yk.K2g?yk.K2g:yk.K2g=Ya.a.instance.resolve("Box4.IParagraphEditor")}static get X8(){return null!=yk.s4g?yk.s4g:yk.s4g=Ya.a.instance.Oa("Box4.ISpacingCommands")}static get a0a(){return null!=yk.E4g?yk.E4g:yk.E4g=Ya.a.instance.Oa("Box4.Styles.IWACStyleReader")}static get ebb(){return null!=yk.Y0g?yk.Y0g:
yk.Y0g=Ya.a.instance.Oa("Box4.ILineSpacingHelper")}static get Lj(){return null!=yk.$5g?yk.$5g:yk.$5g=Ya.a.instance.Oa("Box4.TrackChange.ITrackChangeEditor")}static get Md(){return null!=yk.A6g?yk.A6g:yk.A6g=Ya.a.instance.Oa("Box4.TrackChange.ITrackChangeManager")}static Wb(){const b=A.AFrameworkApplication.va;b.ra(wb.a.j4f,oc.a.view,yn.a.vx);b.Rc(wb.a.j4f,1028);b.ra(wb.a.QE,oc.a.view,yn.a.vx);b.ra(wb.a.QE,oc.a.paragraph,yk.$Sd);b.Rc(wb.a.QE,1036);b.ra(wb.a.bxc,oc.a.paragraph,yk.w7k);b.ra(wb.a.bxc,
oc.a.view,yn.a.vx);b.Rc(wb.a.bxc,1036);b.ra(wb.a.cod,oc.a.paragraph,yk.Xif);b.ra(wb.a.cod,oc.a.view,yn.a.vx);b.ra(wb.a.Uod,oc.a.paragraph,yk.sjf);b.ra(wb.a.Uod,oc.a.view,yn.a.vx);b.ra(wb.a.bod,oc.a.paragraph,yk.Wif);b.ra(wb.a.bod,oc.a.view,yn.a.vx);b.ra(wb.a.Mff,oc.a.view,yk.R2k);b.Rc(wb.a.Mff,1036);b.ra(wb.a.Nsg,oc.a.view,yk.wBo);b.Rc(wb.a.Nsg,1036);b.ra(wb.a.Lff,oc.a.view,yk.Q2k);b.Rc(wb.a.Lff,1036);b.ra(wb.a.Lsg,oc.a.view,yk.vBo);b.Rc(wb.a.Lsg,1036);b.ra(wb.a.D_a,oc.a.view,yn.a.vx);b.ra(wb.a.D_a,
oc.a.paragraph,yk.$Sd);b.Rc(wb.a.D_a,1036);b.ra(wb.a.C_a,oc.a.view,yn.a.vx);b.ra(wb.a.C_a,oc.a.paragraph,yk.$Sd);b.Rc(wb.a.C_a,1036);b.ra(wb.a.UAe,oc.a.view,yk.TAe);b.ra(wb.a.UAe,oc.a.paragraph,yk.TAe);b.Rc(wb.a.UAe,1028);b.ra(wb.a.bFg,oc.a.view,yk.TAe);b.ra(wb.a.bFg,oc.a.paragraph,yk.TAe);b.Rc(wb.a.bFg,1028);b.ra(wb.a.LAe,oc.a.view,yn.a.vx);b.ra(wb.a.LAe,oc.a.paragraph,yk.TTh);b.Rc(wb.a.LAe,1028);b.ra(wb.a.KAe,oc.a.view,yn.a.vx);b.ra(wb.a.KAe,oc.a.paragraph,yk.TTh);b.Rc(wb.a.KAe,1028)}static TTh(b,
h,n,B,L){if(1===n)return 32;b===wb.a.LAe?b=wb.a.D_a:b===wb.a.KAe&&(b=wb.a.C_a);return yk.$Sd(b,h,n,B,yk.T9n(L))}static T9n(b){var h=b.indexOf(",");const n=b.substring(0,h);b=b.substring(h+1,b.length);h=new qy.a;h.value=parseFloat(n);h.unit=parseInt(b);return h}static TAe(b,h,n,B,L){if(2===n){h=L[Ki.a.Text];n=L[Ki.a.Number];L=L.Increment;B=new qy.a;let ba=!1;""===h||L&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(B.value=0,B.unit=$e.App.QLa?2:4,ba=!0):n||L||(B.value=0,B.unit=1,ba=!0);ba&&(A.AFrameworkApplication.va.Pb(b===
wb.a.UAe?wb.a.D_a:wb.a.C_a,2,B),Ua.StaticActiveAppFrame.za().Ie())}return 32}static $Sd(b,h,n,B,L){if(!({Pz:n}=yn.a.kCg(n,h)).returnValue)return n;h=h.node;switch(b){case wb.a.QE:yk.rl.QE(h,new RF.a(2,L));break;case wb.a.D_a:b=new RF.a(L.unit,L.value);yk.rl.dyb(h,b);break;case wb.a.C_a:b=new RF.a(L.unit,L.value),yk.rl.cyb(h,b)}B&&no.a.Gzb&&(B.Gt|=no.a.Eqb(h));return 32}static R2k(b,h,n){if(1===n)return 32;x.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=yk.YHi(h);
if(!b)return x.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;b=(b=b.ja(Lc.a.wj,240)/20)?b:yk.LOl;yk.X8.vha(1,b,4);return 32}static wBo(b,h,n){if(1===n)return 32;x.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");yk.X8.vha(1,0,4);return 32}static Q2k(b,h,n){if(1===n)return 32;x.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=yk.YHi(h);if(!b)return x.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),
8;b=b.ja(Lc.a.ta,240)/20;yk.X8.vha(0,b?b:12,4);return 32}static vBo(b,h,n){if(1===n)return 32;x.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");yk.X8.vha(0,0,4);return 32}static Xif(b,h,n,B,L){if(2==n){if("boolean"!==typeof L)return 16;b=h.node;h=null;np.a.instance.J(1)&&(h=b.sE());yk.rl.Xif(b,L);h&&yk.Lj.wY(b,h,yk.Md.Mg)}return 32}static sjf(b,h,n,B,L){if(2==n){if("boolean"!==typeof L)return 16;b=h.node;h=null;np.a.instance.J(1)&&(h=b.sE());yk.rl.sjf(b,L);h&&yk.Lj.wY(b,
h,yk.Md.Mg)}return 32}static Wif(b,h,n,B,L){if(2==n){if("boolean"!==typeof L)return 16;b=h.node;h=null;np.a.instance.J(1)&&(h=b.sE());yk.rl.Wif(b,L);h&&yk.Lj.wY(b,h,yk.Md.Mg)}return 32}static w7k(b,h,n,B,L){if(2==n){if("boolean"!==typeof L)return 16;b=new Map;b.set("Value",L.toString());oa.Health.instance.recordKpiUsage(Uk.a.Ztb.Qkp,0,Uk.a.bD,b);h=h.node;b=null;np.a.instance.J(1)&&(b=h.sE());h.hasProperty(Lc.a.yx)&&h.removeProperty(Lc.a.yx);yk.ebb.g6d(h)!==L&&h.setValue(Lc.a.yx,L);(L=yk.ebb.zkc(h,
!0))&&L.om(4,!0);(L=yk.ebb.zkc(h,!1))&&L.om(4,!0);b&&yk.Lj.wY(h,b,yk.Md.Mg)}return 32}static YHi(b){b=b.view;return b.te&&(b=b.lb)&&b.gb.currentSelection?yk.a0a.Eq(b.gb.currentSelection.Ra.node):null}}yk.LOl=12;Object(u.a)(yk,"SpacingActor",null,[]);class gL{process(){}}Object(u.a)(gL,"NoOpFormattingViewOperationFinishedStageProcessor",null,[1810]);class hL{constructor(b){this.Ge=b}JTo(b,h){b&&h&&h.cache&&(this.Ge.tha(b,h.cache.mI),this.Ge.oC(b,h.cache.fontSize))}dQb(){return null}jWa(){return null}jlc(){return null}iX(){return null}}
Object(u.a)(hL,"FormattingStewardBridge",null,[1811]);class iL{wc(b){b.ia("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new gL).ha();b.ia("Box4.Actors.IFormattingStewardBridge",()=>new hL(b.resolve("Box4.IFormattingEditor"))).ha()}}Object(u.a)(iL,"WoncaActorsConfiguration",null,[1]);class jL{constructor(b,h,n,B,L,ba,la,La){this.ga=b;this.ypk=h;this.xpk=n;this.N$g=B;this.EIk=L;this.qJd=ba;this.IIk=la;this.JIk=La}get Sb(){return this.ga}Jel(b){this.Sb.ava(b,this.ypk,null,null)}Hel(b){this.Sb.ava(b,
this.xpk,null,null)}G2(b,h,n){n?this.Sb.ava(b,this.N$g,h,null):this.Sb.Pb(this.N$g,2,h)}y$n(b,h){this.Sb.ava(b,this.qJd,h,null)}j4(b,h){this.Sb.ava(b,this.IIk,h,null)}ywb(b,h){this.Sb.ava(b,this.JIk,h,null)}ekg(b,h=!1){const n=new Og.DictionaryPropertySet;n.setValue(zd.a.mS,b);n.setValue(zd.a.Dsj,!0);n.setValue(zd.a.Z$a,h);this.Sb.Pb(this.EIk,2,n)}}Object(u.a)(jL,"ClipboardCommands",null,[1796]);class kL{}Object(u.a)(kL,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1795]);class lL{constructor(b){this.ga=
b}get Sb(){return this.ga}fPj(b,h,n){let B=0;b?1===b&&(B=wb.a.u$a):B=wb.a.t$a;b=new JB.a;b.unit=n;b.value=h;this.Sb.Pb(B,2,b)}Aye(b,h,n){let B=0;1===b?B=wb.a.$_b:2===b?B=wb.a.xyb:b||(B=wb.a.a0b);b=new JB.a;b.unit=n;b.value=h;this.Sb.Pb(B,2,b)}}Object(u.a)(lL,"IndentationCommands",null,[1793]);var WH;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.j4p=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.XXp=7]="distribute";
b[b.margin=8]="margin";b[b.L2p=9]="highKashida";b[b.P6p=10]="lowKashida";b[b.n7p=11]="mediumKashida";b[b.tdq=12]="numTab";b[b.snq=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(WH||(WH={}));Object(u.b)("Justification",WH);class mL{constructor(b){this.ZRa={};this.ga=b;this.o5m()}get Sb(){return this.ga}rH(b){b=this.ZRa[WH[b]];void 0!==b&&null!==b&&this.Sb.Ob(b,2)}o5m(){this.ZRa.left=wb.a.Y7;this.ZRa.center=wb.a.paa;this.ZRa.right=wb.a.I8;this.ZRa.both=wb.a.zKa;this.ZRa.lowKashida=wb.a.YTb;
this.ZRa.mediumKashida=wb.a.YTb;this.ZRa.highKashida=wb.a.YTb;this.ZRa.distribute=wb.a.yZc;this.ZRa.thaiDistribute=wb.a.Nod}}Object(u.a)(mL,"JustificationCommands",null,[1792]);class nL{constructor(b){this.ga=b}QE(b){this.ga.Pb(wb.a.QE,2,b)}bxc(b){this.ga.Pb(wb.a.bxc,2,b)}cod(b){this.ga.Pb(wb.a.cod,2,b)}Uod(b){this.ga.Pb(wb.a.Uod,2,b)}bod(b){this.ga.Pb(wb.a.bod,2,b)}vha(b,h,n){this.ga.Pb(b?wb.a.D_a:wb.a.C_a,2,Object.assign(new qy.a,{value:h,unit:n}))}}Object(u.a)(nL,"SpacingCommands",null,[1790]);
class oL{constructor(b,h,n){this.Sb=b;this.$Zc=h;this.yZl=n;this.d5n=(B,L,ba)=>{if(1===ba)return this.$Zc.B2?32:8;this.$Zc.DAn();this.yZl().e6o(this.$Zc.yqm());return 32}}Wb(){this.Sb.fb(wb.a.Zvb,oc.a.application,this.d5n,1028)}}Object(u.a)(oL,"EditorSettingsUIActor",null,[]);class pL extends Ge.a{constructor(b,h){super(!1,!1,!0);this.AZl=b;this.hYa=h;this.zZl=n=>{1!==n?x.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):(this.AZl.Jtp(),x.ULS.sendTraceTag(578869131,340,50,
"Editor Settings updated"))}}async e6o(b){const h=await this.hYa.zUb;b={["id"]:"SettingsDialog",["uiLanguage"]:A.AFrameworkApplication.uiCulture,["selectedLanguage"]:hj.a.Cg(A.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.Cad,["editorSettings"]:b};this.pi(Box4Intl.Box4Strings.l_EditorSettings,this.zZl,b);x.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")}}Object(u.a)(pL,"EditorSettingsDialog",Ge.a,[]);var DN=d(252);class BJ{constructor(b,h,n,B,L,ba,
la,La,fb,Cb,Lb,$b,tc){this.KGb=this.tNc=this.wEc=null;this.H9e=0;this.SWe=!1;this.sa=new mg.a;this.xee=!1;this.Zv=b;this.uB=h;this.Ge=n;this.uv=B;this.jb=L;this.Qd=ba;this.ul=la;this.xd=La;this.Wd=fb;this.hr=Cb;this.OZ=Lb;this.fy=$b;this.Bp=tc}get i0l(){return this.xd?this.xd.isFeatureEnabled(38):!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get EFf(){return null!=this.KXg?this.KXg:this.KXg=Ya.a.instance.resolve("Box4.IFormatPainterStrategy")}get DU(){return this.SWe}set DU(b){this.SWe!==
b&&(this.SWe=this.xee=b,this.sa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}X_k(b){this.sa.addHandler("FormatPainterBrushActiveStatusChanged",b)}mtj(b){const h=b.Ra;x.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);this.reset();var n=h.node;b=this.Q_i(b);if(this.EFf.V2o(h.contextId,b))try{this.KGb=this.jb.D9a(n)}catch(B){throw x.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",B.message),B;}this.tNc=this.fy.Eq(n);n=Va.FormattingReader.Cs(h);
n.uo&&(this.wEc=Object(ya.a)(tt.a,n.uo.clone()));this.H9e=b?oc.a.paragraph:h.contextId}oTh(b){if(b){const n=this.Q_i(b);for(let B=0;B<b.length;B++){const L=b.J(B);if(null===L||void 0===L?0:L.Gl)this.qKb(L,n);else if(0==(null===L||void 0===L?void 0:L.length))x.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",L);else if(L)for(let ba=0;ba<L.length;ba++){var h=L.getContext(ba);if(null===h||void 0===h?0:h.Ex){if(h)for(let la=0;la<h.length;la++)L.addContext(h.getContext(la))}else(null===
h||void 0===h?0:h.Gl)?this.qKb(h,n):x.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}}}sTh(b,h){if(h){var n=b.node,B=n.qa.last,L=this.Qd.m8a(n),ba=L.Bf(L.Jb);this.tTh(L,h,null);np.a.instance.J(1)&&this.hr.H_b(n,B,b.cpBegin,b.cpEnd,ba,L,this.Wd.Mg)}}I7k(b,h,n){if(h||n)0<tn.g(b).length&&x.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.OZ.e_(b,B=>{this.tTh(B,h,n)})}tTh(b,h,n){this.Ge.Zja(b);b.uo&&b.uo.removeProperty(Hf.a.highlight);
this.Ge.jpf(b);n&&(n=n.clone(),n.qg(...yq.a.kba()),this.Bv(b,n.Qj()));this.Bv(b,h)}Bv(b,h){if(h){var n=b.paragraph.Lc;if(n){var B=b.uo;B=B?Object(ya.a)(Mq.a,B.clone()):tt.a.FUa(pk.a.swb);for(const la of h.fk())if(la!==Lc.a.dw&&la!==Lc.a.G_&&la!==Hf.a.sD&&la!==Hf.a.O7&&la!==Lc.a.S$a&&la!==Hf.a.DN&&la!==Lc.a.Xab&&la!==Lc.a.noProof){if(la===lk.a.Gw){var L=h.ja(lk.a.Gw,S.a.nil);if(L!==S.a.nil)if(L=this.fy.ko().sla(L,n)){var ba=this.fy.aK(L);if(ba===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(L=this.fy.EF(b.paragraph),
ok.a.ei.qr?(ba=L.uy().zBa(ba),L=L.gh(this.fy.Ae(ba))):L=L.XKa(ba),L){B.bAa(L.Qj(),...yq.a.kba());continue}else x.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else x.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}B.setValue(la,h.wf(la))}B.cMa?h=n.QP(B,!0):(n.ou(B),h=B);b.Dk=h.id}}}Q_i(b){return!b.ly&&b.Uc.contextId!==oc.a.Vc}reset(){this.KGb=this.tNc=this.wEc=null;this.H9e=oc.a.none}qKb(b,
h){if(b.contextId===oc.a.Xc||b.contextId===oc.a.Bd)var n=this.ul.Bba(b);else if(b.contextId===oc.a.paragraph)n=this.ul.Efe(b);else if(b.contextId===oc.a.Vc)n=this.ul.gee(b);else{x.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}x.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(n)x.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{n=Object(ya.a)(Cn.AParagraphNode,b.node);var B=
!1;n&&(B=b.contextId===oc.a.Bd&&!!n&&!b.cpBegin&&b.cpEnd===this.jb.textLength(n));if(h=this.EFf.V0o(this.H9e,b.contextId,h,B))try{ea.ParagraphReader.Xb(n)?(this.tNc&&this.Zv.VN(this.tNc,n,!0),this.uv.LTh(n,this.KGb)):x.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(L){throw x.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",L.message),L;}B=b;b.contextId===oc.a.paragraph?B=Nd.a.createTextRange(n,0,
ea.ParagraphReader.textLength(n)):b.contextId===oc.a.Xc&&(B=this.uB.$Nf(b),B=Zb.a.CMb(B));if(B&&B.contextId===oc.a.Bd){const L=this.Bp.M8d(B);L&&(B=L);try{this.I7k(B,this.wEc,h?null:this.tNc)}catch(ba){throw x.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",ba.message),ba;}}if(b.contextId===oc.a.paragraph||b.contextId===oc.a.Vc)h=new ve.GraphIterator,h.set(n),h.Jd(),h.ld(11),B=Gf.ListItemReader.Hg(h),n=!ea.ParagraphReader.textLength(n),x.ULS.sendTraceTag(22832067,354,50,
"Applied format to EOP: InList - {0}, IsEmpty - {1}.",B,n),B?(n=Gf.ListItemReader.y7(h),Gf.ListItemReader.isListItem(n)&&this.sTh(b,this.wEc)):this.i0l&&this.sTh(b,this.wEc)}}}Object(u.a)(BJ,"FormatPainter",null,[1751]);var lG=d(124);class kt{constructor(b,h,n,B,L,ba,la,La=!1,fb,Cb,Lb){this.oFd=!1;this.oTe=new Dz.a;this.wVm=()=>{this.YV.DU=!1;return 32};this.xVm=($b,tc,Nc)=>{$b=!1;if(tc=this.uA.Tka){switch(tc.contextId){case oc.a.Bd:case oc.a.paragraph:case oc.a.Vc:case oc.a.Xc:$b=!0}$b&&re.SelectionEditor.am(tc)&&
tn.b(tc)&&(this.vd.$b(Tf.a.Tn,{["Reason"]:hf.a.JWc}),$b=!1);$b&&ea.ParagraphReader.BX(tc)&&(this.vd.$b(Tf.a.Tn,{["Reason"]:hf.a.WQ}),$b=!1)}if(1===Nc||!$b)return $b?32:8;6!==this.ga.iE?(this.YV.DU?x.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(x.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.YV.mtj(this.uA.currentSelection),this.oFd||(this.gi.Z5a(this.V6j),(Nc=this.gi.ib.Vu)&&Nc.nj&&Nc.APh(this.U6j),this.oFd=!0)),this.YV.DU=!this.YV.DU):
(x.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.YV.mtj(this.uA.currentSelection),this.YV.DU=!1);return 32};this.vVm=($b,tc,Nc,dd,Hd)=>{if(6===this.ga.iE||this.YV.DU){x.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.iE);$b=this.gi.hs.Vf("UserAction","FormatPainterApply");if(kt.rc&&kt.rc.vE(111)){Hd=Hd?Hd.KeepBrushActive:!1;Nc=null;this.uA.currentSelection&&2===this.uA.currentSelection.trigger&&(Hd=Hd||this.YV.xee,
this.YV.xee&&re.SelectionEditor.Dm(this.uA.currentSelection)&&(Nc=re.SelectionEditor.i7(this.uA.currentSelection.Ra,!1)))&&(Nc.trigger=2);this.YV.xee=!1;if(Hd||2!==this.uA.currentSelection.trigger)tc=new Sd.GraphTransaction(15),Nc&&Nc.Ra?(tc.set(Nc.Ra.node.pk),this.hb.Ic(Nc)):tc.set(this.uA.FOb.pk),Nc=Oe.SelectionFactory.Fo(this.hb.Og),this.YV.oTh(Nc),tc.dispose();this.YV.DU=Hd}else Hd=new Sd.GraphTransaction(15),Hd.set(this.uA.FOb.pk),tc=Oe.SelectionFactory.Fo(this.hb.Og),this.YV.oTh(tc),this.YV.DU=
!1,Hd.dispose();$b.stop()}return 32};this.V6j=()=>{this.Joe(this.YV.DU)};this.U6j=()=>{this.Joe(this.YV.DU)};this.gi=b;this.Yb=h;this.ga=n;this.vd=B;this.uA=L;this.YV=ba;this.hb=la;this.PAk=La;this.qA=fb;this.My=Cb;this.Ksk=Lb}get $ih(){return X.a.ju||X.a.Yfe?"url("+this.$yi()+"), pointer":'url("'+this.$yi()+'"), pointer'}$yi(){return this.My?this.qA.kBa(sk.a.ki("FormatPainterText.cur"),sk.a.ki("FormatPainterTextDarkMode.cur"),new lG.a(Hm.a.jN())):sk.a.ki("FormatPainterText.cur")}Wb(){const b=this.Yb.ge(Mk.a.zF);
b.bindAction(bb.KeyInputManager.lc(Jd.a.Sfb,0),wb.a.DFf);b.bindAction(bb.KeyInputManager.lc(Jd.a.YAb,6),wb.a.K4d);this.PAk||b.bindAction(bb.KeyInputManager.lc(Jd.a.aBb,6),wb.a.J8a);this.ga.fb(wb.a.K4d,oc.a.view,this.xVm,1028);this.ga.fb(wb.a.J8a,oc.a.view,this.vVm,1028);this.ga.fb(wb.a.DFf,oc.a.view,this.wVm,1028);this.YV.X_k(()=>{this.bNg(this.YV.DU)});this.My&&this.Ksk.MRd(()=>{this.Joe(this.YV.DU)})}bNg(b){const h=this.gi.hs.Vf("UserAction","FormatPainterUpdateCursor");this.Joe(b);this.gi.Ie();
h.stop()}T6j(b,h){for(let n=0;n<b.length;n++)this.S6j(b[n],h);(b=this.gi.ib.Vu)&&b.te&&this.S6j(b.Kh.editingElement,h)}S6j(b,h){b.style.cursor=h?this.$ih:""}Joe(b){const h=document.querySelectorAll(".OutlineElement");if(1<h.length){const n=h[h.length-2].style.cursor===this.$ih;if(this.gi.ib.isEditingAllowed||this.gi.ib.bA){if(b&&!n||!b&&n)this.T6j(h,b),this.q7j(b);b||!this.oFd||this.oTe.count||(this.gi.GDj(this.V6j),(b=this.gi.ib.Vu)&&b.nj&&b.rAo(this.U6j),this.oFd=!1)}else n&&(this.T6j(h,!1),this.q7j(!1))}}q7j(b){const h=
this.gi.ib.Vu;h&&(b?this.oTe.add(h.jd.Uj):this.oTe.remove(h.jd.Uj))}static get rc(){return null!=kt.DWg?kt.DWg:kt.DWg=Ya.a.instance.Oa("Box4.IFeatureHelper")}}Object(u.a)(kt,"FormatPainterActor",null,[]);class At{constructor(b,h,n){this.Xn=n}v2l(b,h,n,B,L){var ba;if(!({me:n,selected:ba,Pz:fb,T9c:La}=this.aTj(h,n,!1)).returnValue)return fb;ce.a.mark(5013);var la=At.Jw.TO(ba);for(let Cb=0;Cb<la.length;++Cb){if(!la[Cb].isValid)continue;const Lb=la[Cb].iterator;Lb.tq();if(pl.OutlineReader.zy(Lb))return this.xli(n,
Lb)}var La=hn.a.JXd&&La?wb.a.b8c:this.arm();if(ba.Ex||re.SelectionEditor.am(ba)||ea.ParagraphReader.nn(ba)&&!re.SelectionEditor.yba(ba)){if(At.rc&&At.rc.isFeatureEnabled(23)&&Object(el.a)().kEg(ba).returnValue)return 8;var fb=this.yli(h,n,b,B,L,La)}else if(re.SelectionEditor.gl(ba))fb=this.wli(h,n,b,B,L,La);else if(re.SelectionEditor.mf(ba)){fb=new ve.GraphIterator;fb.set(ba.node);fb.zb(10);la=ef.a.QA(ba,!1);if(0<la.length){if(!la[0].hyperlink)return x.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",
la[0].cpBegin,la[0].cpEnd),8;$e.App.Uic(la[0].hyperlink.url);return 32}Ng.TableCellReader.G3(fb)&&(qh.returnToContainingCell(fb),Ng.TableCellReader.Rla(fb)&&(la=new ve.GraphIterator,la.hd(fb),qh.returnToContainingRow(la),pl.OutlineReader.XA(fb,ba,!1)&&Le.a.FYi(la)&&0>=ba.Fb&&(La=wb.a.f8c,qh.returnToContainingTable(fb),Ga.OutlineElementNavigator.he(fb),L||(L=new Og.DictionaryPropertySet),L.Kg(zd.a.targetObject,fb.currentNode.id))));fb=this.zli(h,n,b,B,L,La)}else re.SelectionEditor.yba(ba)&&(fb=A.AFrameworkApplication.va.lg(h,
wb.a.newLine,2,!1,B,L));ce.a.mark(5014);return fb}aTj(b,h,n){let B=null,L=null,ba=!1;if(1===h)return{returnValue:!1,me:B,selected:L,Pz:32,T9c:ba};if(!b.view.te)return{returnValue:!1,me:B,selected:L,Pz:2,T9c:ba};B=b.view;L=B.lb.Og;return!L||!At.mg.hYi(L,n)||hn.a.JXd&&At.mg.Vla(L,la=>ba=la)&&!ba?{returnValue:!1,me:B,selected:L,Pz:2,T9c:ba}:this.Xn&&this.Xn.instance&&this.Xn.instance.DX(L)?{returnValue:!1,me:B,selected:L,Pz:4,T9c:ba}:{returnValue:!0,me:B,selected:L,Pz:2,T9c:ba}}J0o(b,h,n,B,L){let ba,
la;if(!({me:n,selected:ba,Pz:la}=this.aTj(h,n,!0)).returnValue)return la;const La=At.Jw.TO(ba);for(let fb=0;fb<La.length;++fb){if(!La[fb].isValid)continue;const Cb=La[fb].iterator;Cb.tq();if(pl.OutlineReader.zy(Cb))return this.xli(n,Cb)}ba.Ex||re.SelectionEditor.am(ba)?la=this.yli(h,n,b,B,L,wb.a.b8c):re.SelectionEditor.gl(ba)?la=this.wli(h,n,b,B,L,wb.a.b8c):re.SelectionEditor.mf(ba)?la=this.zli(h,n,b,B,L,wb.a.b8c):re.SelectionEditor.yba(ba)&&(la=A.AFrameworkApplication.va.lg(h,wb.a.newLine,2,!1,B,
L));return la}xli(b,h){b.lb.Ic(Oe.SelectionFactory.pp(h.currentNode,!1));return 32}yli(b,h,n,B,L,ba){const la=new Sd.GraphTransaction(15);la.yi=n;la.Ab(h.jd);h=new Og.DictionaryPropertySet;h.setValue(zd.a.EZc,!0);h=A.AFrameworkApplication.va.lg(b,wb.a.SJ,2,!0,B,h);32===h&&(h=A.AFrameworkApplication.va.lg(b,ba,2,!1,B,L));la.dispose();return h}wli(b,h,n,B,L,ba){const la=new Sd.GraphTransaction(15);la.yi=n;la.Ab(h.jd);h.lb.Ic(re.SelectionEditor.Wj(h.lb.gb.J(0),!1,!1));b=A.AFrameworkApplication.va.lg(b,
ba,2,!1,B,L);la.dispose();return b}zli(b,h,n,B,L,ba){const la=new Sd.GraphTransaction(15,n);la.yi=n;la.Ab(h.jd);b=A.AFrameworkApplication.va.lg(b,ba,2,!1,B,L);la.dispose();return b}static get Jw(){return Object(el.a)()}static get mg(){return Pd.a.instance}static get rc(){return null!=At.zWg?At.zWg:At.zWg=Ya.a.instance.Oa("Box4.IFeatureHelper")}}Object(u.a)(At,"AEnterViewStrategy",null,[1814]);class BI extends At{constructor(b,h,n){super(b,h,n)}arm(){return wb.a.newLine}}Object(u.a)(BI,"EnterViewStrategy",
At,[]);class rl{constructor(b){this.Gm=this.transaction=null;this.me=b;this.WWc=this.ap=0}}Object(u.a)(rl,"SelectAllArguments",null,[]);class uy{constructor(b,h,n){this.v7n=b;this.$xn=h;this.Yo=n;this.p4l=(B,L,ba)=>L.view.nj?this.s8a(L,ba,this.EXj):this.KMo(L,ba);this.wid=(B,L)=>L.ap?1===L.ap?(L.me.lb.Eod(L.Gm,B),L.ap=2,!0):2===L.ap?(L.me.lb.gb.y7a=L.Gm.y7a,this.tg.$G(),L.transaction.lOa(B),L.ap=3,L.transaction.dispose(),ce.a.mark(5799),!0):!1:(L.transaction=this.Yo.Mc(2),L.transaction.Ab(L.me.jd),
L.ap=1,!0);this.KMo=(B,L)=>{if(1===L)return 32;if(!B.view.te)return 2;B=B.view;return B.lb&&B.lb.gb&&B.lb.gb.currentSelection?this.EXj(B).Xfa?1:32:8};this.EXj=B=>{B.nj&&x.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");B=new Mv.a(null,this.Cho,new rl(B));B.vm("SelectAllInOutline");B.run();return B};this.Cho=(B,L)=>{if(!L.ap)return L.Gm=Oe.SelectionFactory.LMo(L.me.lb.gb.currentSelection),L.transaction=this.Yo.Mc(2),L.transaction.Ab(L.me.jd),L.ap=1,!0;if(1===L.ap){if(!L.WWc)return L.me.lb.Ic(L.Gm.J(0),
B),++L.WWc,!0;if(L.WWc<L.Gm.length)return L.me.lb.fZk(L.Gm.J(L.WWc),B),++L.WWc,!0;L.ap=2}return 2===L.ap?(L.me.lb.gb.y7a=L.Gm.y7a,this.tg.$G(),L.transaction.lOa(B),L.ap=3,L.transaction.dispose(),!0):!1}}get tg(){return this.$xn.value}Wb(){const b=A.AFrameworkApplication.va;b.ra(wb.a.BEa,id.a.frame,uy.YTj);b.ra(wb.a.RBg,id.a.frame,uy.YTj);b.fb(wb.a.s8a,oc.a.view,this.p4l,2);b.fb(wb.a.c6a,oc.a.view,Dd.AFrame.Vg,100);b.fb(wb.a.Q9f,oc.a.view,uy.Q9f,4)}s8a(b,h,n){if(1===h)return 32;if(!b.view.te)return 2;
h=b.view;if(!h.lb)return 8;const B=h.lb.gb;if(!B||!B.length)return 8;ce.a.mark(5798);Ua.StaticActiveAppFrame.za().ib.isEditingAllowed||Ua.StaticActiveAppFrame.za().ib.bA||h.nj?b=re.SelectionEditor.kMf(B):(Ph.FocusManager.instance().ME(Dd.AFrame.Ho),b=Oe.SelectionFactory.wKj(h.jd));if(!b)return 8;B.y7a||x.ULS.sendTraceTag(39098305,324,50,"Progress selection start");n&&this.v7n.mTb(re.SelectionEditor.Ywi(b))?n=n(h):(n=new rl(h),n.Gm=b,n=new Mv.a(null,this.wid,n),n.vm("ExpandSelection"),n.run());return n.Xfa?
1:32}static get Sdb(){return null!=uy.S3g?uy.S3g:uy.S3g=Ya.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static Q9f(b,h,n){if(1===n)return 32;if(!h.view.te)return 8;b=h.view;h=Oe.SelectionFactory.pp(b.root.graphNode,!0);if(!h)return 8;b.lb.Ic(h);return 32}static YTj(){var b=Ua.StaticActiveAppFrame.za().ib.Vu;if(!b.te)return 2;if(b.te&&1!==Ua.StaticActiveAppFrame.za().state){ce.a.mark(4668);var h=b.lb.gb.currentSelection;if(!h&&A.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;
h=re.SelectionEditor.QO(h);let n=h.x,B=h.y+h.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)n=b.x,B=b.y;uy.Sdb.BEa(new Sys.UI.Point(n,B),1);ce.a.mark(4669)}return 32}}Object(u.a)(uy,"SelectAllHandlers",null,[1791]);class SF{Hxe(){}}Object(u.a)(SF,"FontNameFormattingStrategyNoop",null,[1794]);var TF=d(942);class XH{constructor(b,h,n,B,L,ba){this.KWh=this.NWh=null;this.jt=b;this.JWh=h;this.mdl=n;this.vdl=B;this.NWh=L;
this.KWh=ba}}Object(u.a)(XH,"BookmarkHighlightContext",null,[]);class qL extends Oi.a{constructor(){super()}get Ufa(){return!0}get Yrb(){return 5}get k$a(){if(null!=this.P5)return this.P5;this.P5=[];this.P5.push(new Fp.a(mo.a.STd,mo.a.STd));this.P5.push(new Fp.a(mo.a.mlf,mo.a.mlf));this.P5.push(new Fp.a(mo.a.eUc,mo.a.eUc));return this.P5}bNa(b,h){this.Ufa&&Rn.a.instance.Yd(()=>{const n=this.Gq.vJa;var B=this.Gq.dbd;if(n)if(5===n.type){B=n.ZB;if(n.dM&&n.dM.jt.includes(b))for(const L of h.BNa("*"))this.Gq.TZa(L);
B&&B.jt.includes(b)&&this.qyb(h,n.action,B,b)}else B&&5===B.type&&3===n.action&&B.ZB.jt.includes(b)&&this.qyb(h,0,B.ZB,b)},"BHA:OPHC")}TXa(b){return Object(Wb.a)(XH,b)}E9a(b,h){if(b)for(const n of b.jt)h.add(n)}qyb(b,h,n,B){0===h&&b.htmlElement&&Rn.a.instance.Yd(()=>{const L=b.BNa("*"),ba=L.length,la=mo.a.STd;var La=B.id===n.NWh,fb=B.id===n.KWh;let Cb=!1;var Lb=0,$b=[];const tc=Array(ba);for(let Hd=0;Hd<ba;Hd++){var Nc=L[Hd];const xe=Yq.a(Nc);tc[Hd]=xe;const je=Nc.classList;if(0!=tc[Hd]){const he=
!je.contains(mo.a.jI),fe=Hg.a.Eb(Nc,mo.a.HKb);fe&&$b.push(...fe);if(La){let De;if((De=Hg.a.Eb(Nc,mo.a.UTd))&&fe&&1===De.length&&1===fe.length&&De[0].equals(fe[0]))continue;De&&(Lb+=De.length,1===xe?je.add(mo.a.mlf):je.add(la));if(fe)for(const gg of fe)this.ude(n,gg)&&(Lb--,Cb&&je.add(mo.a.eUc));0!==Lb&&he&&je.add(la)}if(!La&&!fb&&n.vdl.has(B.id))if((Nc=Hg.a.Eb(Nc,mo.a.HKb))&&Cb){je.add(la);for(const De of Nc)if(this.ude(n,De)){je.add(mo.a.eUc);break}}else he&&je.add(la)}Cb=!je.contains(mo.a.f8a)}if(fb&&
!La){La=new Set;for(var dd of $b)this.ude(n,dd)&&La.add(dd);Cb=!1;for($b=0;0!==La.size&&$b<ba;$b++){Lb=L[$b];dd=Lb.classList;if(0!=tc[$b])if(fb=!1,Lb=Hg.a.Eb(Lb,mo.a.HKb)){for(const Hd of Lb)this.ude(n,Hd)&&(La.delete(Hd),fb=!0);0!==La.size&&dd.add(la);Cb&&fb&&dd.add(mo.a.eUc)}else dd.contains(mo.a.jI)||dd.add(la);Cb=!dd.contains(mo.a.f8a)}}},"BHA:SPH")}ude(b,h){for(const n of b.mdl)if(h.equals(n))return!0;return!1}}Object(u.a)(qL,"BookmarkHighlightActor",Oi.a,[438]);var mG=d(1985),ry;(function(b){b[b.t5p=
0]="jsonToDocumentXml";b[b.FXl=1]="documentXmlToJson";b[b.GXl=2]="documentXmlToThemeJson";b[b.Noq=3]="unsupported"})(ry||(ry={}));Object(u.b)("GraphicsEditorConversionRequestType",ry);var UF=d(1750);class XD{constructor(b,h,n,B,L,ba,la,La,fb,Cb){this.Af=b;this.pG=h;this.jb=L;this.UY=ba;this.Ck=la;this.Vd=La;this.xd=Cb;this.Ga=fb}cyg(b,h,n,B){const L=b.hMh(h);if(L){var ba=Object(Wb.a)(UF.a,b),la=this.Vd.Vf("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",
ba,n)),La=h.Hk.node,fb=()=>{n||this.removeImage(h.Hk,L.getId())};ba=XD.ZXh();B=this.wYh(L.getId().toString(),La,B,n);try{b.CSh(B,h)}catch(Cb){x.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+Cb.message);this.qq(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);return}this.Af.Ij(ba,2,B.toString(),{},!0,0,Cb=>{x.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");
b.Usc(Cb,L,()=>{this.qq(b.g9d())},fb,La,h,la)},Cb=>{const Lb=415===Cb.data.He;let $b="";Cb&&Cb.data&&Cb.data.vi&&"X-CorrelationId"in Cb.data.vi&&Cb.data.vi["X-CorrelationId"]&&($b=Cb.data.vi["X-CorrelationId"]);b.bV(`Graphics editor request failed. HttpStatus [${Cb.data.He}], ResponseData [${Cb.data.De}], CorrelationId [${$b}]`,L,La,fb,()=>{this.qq(Lb?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.g9d())},la,Lb)},null)}else this.qq(b.g9d())}rOo(b,h,n){return new Promise((B,
L)=>{var ba=b.Hk,la=null;la=El.a.r_f(ba)?ba.getContext(0).node:ba.node;ba=XD.ZXh();la=this.wYh(h.toString(),la,n,!1);la.ze(mG.a.ysf,ry.GXl.toString());this.Af.Ij(ba,2,la.toString(),{},!0,0,La=>{x.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");B(La.data.De)},La=>{x.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${La.data.He}, ResponseData ${La.data.De}`);
this.qq(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);L(null)},null)})}wYh(b,h,n,B){const L=h.Jj(),ba=new ub.QueryStringBuilder("WordGraphicsEditorHandler.ashx");A.AFrameworkApplication.Aja(ba);ba.ze(mG.a.sBe,this.Okn(h)?"true":"false");ba.ze(lg.a.nodeId,b);ba.ze(lg.a.cellId,L.pl.toString());ba.ze(lg.a.fileId,L.kq);ba.ze(lg.a.v_,n.toString());ba.ze(mG.a.$3l,B?"true":"false");if(b=!!this.xd&&this.xd.isFeatureEnabled(46)){ba.ze(wh.a.qtj,b.toString());if(b=this.xd.isFeatureEnabled(86))ba.ze(wh.a.Sao,
b.toString()),ba.ze(wh.a.B2m,"true");this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&ba.ze(wh.a.abo,"true")}ba.ze(wh.a.YVh,"true");Qh.a.instance.$Jb(ba);return ba}Okn(b){if(!this.pG)return!1;b=this.pG.Iu(b);return!!b&&b.wf(Lc.a.g1f)}removeImage(b,h){b.cpBegin===b.cpEnd-1&&this.Ck.ovc(b.node,h,this.jb,this.UY)}qq(b){const h=new ui.StandardDialog;h.Gd=0;h.Gy(yd.a.Bzf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);
Ua.StaticActiveAppFrame.za().Ie()}static ZXh(){const b=new ub.QueryStringBuilder("WordGraphicsEditorHandler.ashx");A.AFrameworkApplication.Aja(b);return b.toString()}}Object(u.a)(XD,"GraphicsEditorRequestManager",null,[436]);class rL extends oD{constructor(b,h,n){super(b,h,n);this.$Wa=wb.a.QR}E$a(b){null!=b&&0<b.length&&this.Sb.Pb(this.$Wa,2,b[0])}Vdk(b,h,n,B){const L=hj.a.Cg(A.AFrameworkApplication.lcid).name;b=String.format(b,A.AFrameworkApplication.lcid,L,A.AFrameworkApplication.buildVersion,h,
bx.rJe,n);b+="&flipgrid=1&ted=1";A.AFrameworkApplication.Ld("wwa11yq3;wwa11yq3cf");A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.OnlineMediaAccessibilityChangesEnabled",!1)&&(b+="&resize_picker=1");B&&this.G2i()&&(B=new ub.QueryStringBuilder(b),B.dL("stream2","1"),A.AFrameworkApplication.K.$("GetCustomHeaderEnabled")&&B.dL("enablegetcustomheader","1"),b=B.toString());return b}G2i(){A.AFrameworkApplication.Ld("EnableStream2VideosInsertion;EnableStream2VideosInsertioncf");
A.AFrameworkApplication.Ld("EnableStream2Videos;EnableStream2Videoscf");return A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2VideosInsertion",!1)&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2Videos",!1)?!0:!1}}Object(u.a)(rL,"InsertHubbleMediaHelper",oD,[]);class sL{constructor(b,h,n,B,L,ba,la,La){this.GFd=!1;this.ga=b;this.Ga=h;this.XDd=n;this.T1=B;this.hBd=L;this.ul=ba;this.Fok=La;
this.Lnk=la;this.T1.G2i()&&la.isFeatureEnabled("OmgStreamTwo",!1).then(fb=>{this.GFd=fb;this.GFd||(this.KGh=la.hva("OmgStreamTwo",Cb=>{this.GFd=Cb.isEnabled}))})}dispose(){this.KGh&&this.Lnk.rZb("OmgStreamTwo",this.KGh)}Wb(){this.ga.fb(Dc.a.Tpj,oc.a.Xc,this.B5n.bind(this),1028);this.ga.fb(Dc.a.hTi,oc.a.Xc,this.E$m.bind(this),1028)}E$m(b,h,n,B,L){if(1!==n){if(null==L)return 16;if(!h.Gl||!re.SelectionEditor.mf(h))return 2;b=this.Mqm(L);L=L.OriginalUrl;A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.hBd.lRg(b,h,L)}return 32}fkk(){A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}Mqm(b){const h=new GB;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;h.ProviderName=b.ProviderName;return h}B5n(b,h,n){var B,
L;if(1!==n)h=F.a.MT(this.Ga.kb("UserId")).toString(),h=this.T1.Vdk(this.Ga.appSettings.InsertVideoHubbleEndpoint,yb.a.create().toString(),h,this.GFd),this.T1.$Wa=Dc.a.hTi,h=this.XDd.F3c(h,!0),h.correlationId=yb.a.create(),h.wua=5,h.Sze(null,this.T1,this.Fok),aa.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new ia.a,{name:"ActionId",int64:b})]})),this.fkk();else if(!(h&&h.node&&St.a(h.node))||(null===(B=this.ul)||void 0===B?0:B.Q2(h))||
(null===(L=this.ul)||void 0===L?0:L.Vla(h)))return 2;return 32}}Object(u.a)(sL,"OnlineMediaActor",null,[]);const IO={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};
class xA extends fg{constructor(b,h,n,B=null,L=!1){super(b,h,n,B,L);this.yIc=null;this.sfg=()=>{this.Jz&&(x.ULS.sendTraceTag(509092503,352,50,`onGetCustomHeaders : Token available: ${!!xA.RHa} time: ${(new Date).getTime()-this.ji}`),this.Jz.sendMessage(H.a.vNj,{["CustomHeaders"]:xA.RHa||""}))}}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}h2c(){const b={};b.insertMediaServiceEndpoint=this.YDd;b.iFrameId="mediaiframe";return b}async Sze(b,h,n){n&&(this.ji=(new Date).getTime(),
Date.now()>xA.xIh&&await this.refreshToken(n));this.j6b=b;this.yIc=h;this.qHc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.h2c(),["componentIsVisibleCallback"]:this.eik.bind(this)};this.pi(this.j6b,null,b)}eik(){this.S3=this.Wjc(this.Sj("mediaiframe"));let b=this.YDd;if(A.AFrameworkApplication.K.$("NewInsertMediaServiceEndpoint")){const h=new URL(b),n=IO[h.protocol+"//"+h.host];n?b=n:x.ULS.sendTraceTag(508937025,352,10,`Target URL: ${h.host} not found`)}this.Jz=this.OJd.getInstance(this.S3.contentWindow,
b);this.Jz.$q(H.a.NNh,h=>{this.fjj(h,this.yIc.E$a.bind(this.yIc))});this.Jz.$q(H.a.insert,h=>{this.nne(h,this.yIc.E$a.bind(this.yIc))});this.Jz.$q(H.a.kOh,this.tmj.bind(this));this.Jz.$q(H.a.$wi,this.sfg.bind(this));this.Jz.$q(H.a.getSessionId,this.ilj.bind(this));this.Jz.$q(H.a.Iui,this.flj.bind(this));this.Jz.$q(H.a.UUd,this.Rjj.bind(this));this.$xb(3)}$xb(b){const h=[];h.push(Object.assign(new ia.a,{name:"DialogResult",string:Qs[b]}));h.push(Object.assign(new ia.a,{name:"DialogMode",string:this.nCi()}));
h.push(Object.assign(new ia.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ia.a,{name:"Provider",string:Uu[this.wua]||"Unknown"}));aa.a.sendTelemetryEvent(Object.assign(new wa.a,{name:this.telemetryEventName,dataFields:h}))}async refreshToken(b){try{const h=await b.wV("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");h.IsSuccess&&(xA.xIh=h.Telemetry.expiresOn?1E3*(h.Telemetry.expiresOn-10):0,xA.RHa=h.Token);x.ULS.sendTraceTag(509092504,352,50,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: ${!!xA.RHa} time: ${(new Date).getTime()-
this.ji}`)}catch(h){x.ULS.sendTraceTag(508954306,352,10,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: false time: ${(new Date).getTime()-this.ji} error: ${h} `)}}}xA.xIh=0;Object(u.a)(xA,"OnlineMediaDialog",fg,[]);class tL{constructor(b,h){this.xWe=b;this.T1=h}F3c(b,h=!1){return new xA(b,this.xWe,this.T1,null,h)}getInstance(){throw Error.notImplemented();}}Object(u.a)(tL,"OnlineMediaDialogFactory",null,[435]);class CI extends OA{constructor(){super(1,3);this.kO=Ya.a.instance.resolve("Common.IReactContextualUILauncher");
this.d0j=!1}xeb(){A.AFrameworkApplication.va.Ob(Dc.a.ayc,2)}I1d(){this.Rpi&&!this.yw&&(this.yw=this.rRa())}v2d(){if(this.yw&&this.yw.isVisible){var b=Object(ya.a)(Ko.a,this.yw.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.oy(b.Jqb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)x.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var h=b.getBoundingClientRect();0<h.top&&
h.bottom<window.innerHeight&&(h=b.getAttribute(Bc.a.hTd)||"",Bc.a.PO===h&&b.click())}}D3(){return this.kO.D3}}Object(u.a)(CI,"ExternalContentFloatieManager",OA,[]);class Eq{constructor(){Eq.E7m()}get Vb(){return null!=this.y7g?this.y7g:this.y7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get Av(){return null}f2b(b){var h=null;if(!ea.ParagraphReader.Bh(b))return{returnValue:!1,Zea:h};if((b=this.Vb.Eq(b.currentNode))&&2===this.Vb.FF(b)){const n=this.Vb.Ae(b);
Eq.yT.contains(n)&&(h=this.Vb.aK(b),h=Object.assign(new Kt.a,{UF:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,Zea:h}}Fqb(b,h){let n=null;h&&b.contentId.equals(h.contentId)||(n=b.contentObject);return n}static E7m(){Eq.yT=new Vn.a;Eq.yT.add(ln.StyleReader.styleIdHeading1);Eq.yT.add(ln.StyleReader.styleIdHeading2);Eq.yT.add(ln.StyleReader.styleIdHeading3);Eq.yT.add(ln.StyleReader.e1b);Eq.yT.add(ln.StyleReader.Uqd);Eq.yT.add(ln.StyleReader.Vqd);Eq.yT.add(ln.StyleReader.wBe);Eq.yT.add(ln.StyleReader.vBe);
Eq.yT.add(ln.StyleReader.wordStyleIdHeading1);Eq.yT.add(ln.StyleReader.wordStyleIdHeading2);Eq.yT.add(ln.StyleReader.wordStyleIdHeading3);Eq.yT.add(ln.StyleReader.LBc);Eq.yT.add(ln.StyleReader.MBc);Eq.yT.add(ln.StyleReader.NBc);Eq.yT.add(ln.StyleReader.Uud);Eq.yT.add(ln.StyleReader.Vud);Eq.yT.add(ln.StyleReader.Wud);Eq.yT.add(ln.StyleReader.KAb);Eq.yT.add(ln.StyleReader.Xud)}}Eq.yT=null;Object(u.a)(Eq,"ParagraphStyleDetailsProvider",null,[630,406]);class uL{constructor(b,h,n,B){this.vRa=b;this.nDk=
h;this.wDk=n;this.xDk=B}irg(){this.vRa.execute(b=>{b.iZb(this.nDk.value);b.iZb(new Eq);b.iZb(this.xDk.value);b.kY(this.wDk.value)})}}Object(u.a)(uL,"AccessibilityActor",null,[]);class vL{constructor(b,h,n){this.zi=null;this.Gpd=(B,L,ba)=>{if(1===ba)return 32;this.zi=this.nGc.value.ZCl(this.Yb);if(!this.zi)return x.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.zi.L_a();return 32};this.MLh=B=>this.zi?this.zi.mXm(B):2;this.ga=b;this.nGc=h;this.Yb=n}Wb(){if(A.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var b=
bb.KeyInputManager.lc(Jd.a.XAb,5);this.Yb.ge(Dd.AFrame.Ho).tt(b);this.Yb.ge(Dd.AFrame.mq).bindAction(b,Pa.a.Gpd);this.ga.ra(Pa.a.Gpd,id.a.frame,this.Gpd);this.ga.ra(Pa.a.aSc,id.a.frame,this.MLh);this.ga.ra(Pa.a.$Rc,id.a.frame,this.MLh)}}}Object(u.a)(vL,"AccessibilityHelpDialogActor",null,[]);var EN=d(1132),FN=d(1458);class wL{constructor(b,h){this.ayk=b.ic("WordHangForActionManagerThresholdTime",750);this.ga=h;this.umk=EN.a.UG(26,5,new FN.a)}P0(){this.ga.P0(this)}l8(){}j8(b){const h=+b.endTime-+b.startTime;
if(h>this.ayk){let n="";switch(b.behavior){case 1:n="E";break;case 2:n="X";break;case 3:n="A"}(b=Ce.ActionManager.U$(b.actionId))&&b.length||(b="UnknownAction");this.umk.track(h,b+"_"+n)}}}Object(u.a)(wL,"ActionHangDetector",null,[65]);var CJ=d(1552);class oz extends Tc{constructor(b,h=null){super(b,void 0,A.AFrameworkApplication.O7a,new Rb(b,!1),void 0,void 0,h)}get Hbb(){return this.fee?CommonUIStrings.l_DownloadACopyDialog_EmailALinkText:CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get Gqc(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get Nbd(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get gYc(){return A.AFrameworkApplication.O7a?
"UIFontDialogTextLarge":null}get fee(){return"VersionHistory"===this.r_h?!1:!A.AFrameworkApplication.ua.Ib.isBusinessUser&&!A.AFrameworkApplication.ua.Ib.isEduUser}Jie(){x.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed")}o6f(){x.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}kcd(){x.ULS.sendTraceTag(19462214,324,50,"Download a copy dialog button clicked");A.AFrameworkApplication.va.Ob(Pa.a.vii,2)}}Object(u.a)(oz,"DownloadACopyDialog",Tc,[]);var yA;(function(b){b[b.Unknown=
0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.wPp=7]="Publisher";b[b.ANp=8]="Infopath";b[b.yKp=9]="Access"})(yA||(yA={}));Object(u.b)("OfficeApplication",yA);var kx;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.VRp=2]="WriteOnly";b[b.TMp=3]="ForceCheckout";b[b.URp=4]="WriteLocalCopy";b[b.ROp=5]="OpenInBrowser"})(kx||(kx={}));Object(u.b)("OpenDocumentMode",kx);
class xL extends Ge.a{constructor(){super(!1,!1,!0)}Soe(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};
h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.pi("Send feedback to Microsoft",this.fWo.bind(this),b);return new Promise(n=>{this.rGk=n})}fWo(b,h){1===b&&this.rV(h.selectedReason)}dispose(){super.dispose();this.rGk()}rV(b){const h={},n={},B={},L={},ba={};h.appId=2155;h.manifestType="Fps";h.submitTime=
(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=yb.a.create().toString();ba.reason=b;const la={},La={numberOfOptions:5};La.selectedRating=b;la.rating=[La];L.surveySpecificData=JSON.stringify(la);B.extendedManifestData=JSON.stringify(L);h.application=B;ba.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";h.survey=ba;h.telemetry=this.cLb();h.web=this.tUc();n["Content-Type"]="application/json";this.DNa(JSON.stringify(h),n)}Aea(b,h,n,B){h&&b&&B&&n&&B in h&&(b[n]=h[B])}cLb(){const b=
A.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=A.AFrameworkApplication.buildVersion;h.featureArea="Open In Desktop App";this.Aea(h,b,"audienceGroup","AudienceGroup");this.Aea(h,b,"osBuild","OsVersion");this.Aea(h,b,"platform","Platform");this.Aea(h,b,"processSessionId","WACSessionID");return h}tUc(){const b=A.AFrameworkApplication.sessionStartInfoSettings,h={};this.Aea(h,b,"browser","Browser");this.Aea(h,b,"browserVersion","BrowserVersion");this.Aea(h,b,"dataCenter","WACDatacenter");
return h}DNa(b,h,n=0){let B=0;3<n||(1===n?B=200:1<n&&(B=200+500*(n-1)),A.AFrameworkApplication.mc.Zb(new Re.a(2,1,B,()=>{A.AFrameworkApplication.Be.Ij("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{x.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.DNa(b,h,n+1);x.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",n)},null)})))}}Object(u.a)(xL,"WordOpenInClientFeedbackDialog",Ge.a,[]);var zA=
d(1519),GN=d(1877);const HD=b=>{for(let h=0;h<b.children.length;h++){const n=b.children[h];n.style.position="relative";n.style.top=(n.parentNode.offsetHeight-n.offsetHeight)/2+"px"}},YH=b=>b.Kb.keyCode===Jd.a.Mu||b.Kb.keyCode===Jd.a.U0a?(b.Nf.click(),!0):!1,VF=(b,h,n,B,L,ba,la)=>{const La=document.createElement("a");La.className="ProtocolLaunchingDialogButtonAnchor";La.className+=" OICDialog";La.id=b;La.setAttribute(Bc.a.Ph,Bc.a.eaa);La.style.padding="0";La.style.margin="0";B&&yL(L,h,n,B,La);b=document.createElement("span");
b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=L;La.appendChild(b);La.tabIndex=0;ba&&Ef.a.instance.nb(Cd.a.click,La,ba);la&&bb.KeyInputManager.instance.nb(Cd.a.oi,La,la);return La},yL=(b,h,n,B,L)=>{var ba=document.createElement("img");ba.alt=b;ba.className=Bb.getImageClassWithCluster(n,B);ba.src=h;ba.setAttribute(Bc.a.Ph,Bc.a.BA);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(ba);ba=document.createElement("span");ba.className="ProtocolLaunchingDialogIconContainer";
ba.appendChild(b);L.appendChild(ba)};class ZH{static get kh(){return Ge.a.az(ZH.Mn,CommonUIStrings.l_OICLaunchDialogTitle)}}ZH.Mn="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(u.a)(ZH,"OICLaunchDialogHtml",null,[]);class zL extends Ge.a{constructor(b){super();this.K4b=this.JBb=null;this.UV=!1;this.Hnj=()=>{this.hide();this.jp.Jvc();return!0};this.Nnj=()=>{x.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();A.AFrameworkApplication.va.Ob(Pa.a.PZb,2);return!0};this.xTn=()=>{this.jp.Jvc()};this.jp=b;this.kh=ZH.kh;this.Gd=5;this.Qg="OICLaunchDialog";this.showDialog("",this.xTn);this.wOj();this.L8("ProtocolLaunchingDialogTitle");4!==A.AFrameworkApplication.ua.Ib.fVa&&
(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.v4(this.JBb);x.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Zba(){this.JBb=VF("BtnRichClient",this.jp.zZc,this.jp.r7c,this.jp.zUf,CommonUIStrings.l_OICLaunchRichClient,this.Nnj,YH);document.getElementById("OICLaunchRichClient").appendChild(this.JBb);HD(this.JBb);this.K4b=VF("BtnReturn",this.jp.zZc,
this.jp.r7c,this.jp.MQi,CommonUIStrings.l_OICReturnToOnlineClient,this.Hnj,YH);document.getElementById("OICReturnToApp").appendChild(this.K4b);HD(this.K4b)}dispose(){this.UV||(this.JBb&&(Ef.a.instance.xc(Cd.a.click,this.JBb,this.Nnj),bb.KeyInputManager.instance.xc(Cd.a.oi,this.JBb,YH)),this.K4b&&(Ef.a.instance.xc(Cd.a.click,this.K4b,this.Hnj),bb.KeyInputManager.instance.xc(Cd.a.oi,this.K4b,YH)),super.dispose(),this.UV=!0)}}Object(u.a)(zL,"OICLaunchDialog",Ge.a,[]);class $H{static get kh(){return Ge.a.az($H.Mn,
CommonUIStrings.l_OICDialogTitle)}}$H.Mn="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(u.a)($H,"ProtocolLaunchingDialogV2Html",null,[]);class AL extends Ge.a{constructor(b){super();this.J4b=this.A1a=null;this.UV=!1;this.Wgb=null;this.Rkj=h=>this.oeg(h,0);this.klj=h=>this.oeg(h,2);this.Gnj=h=>this.oeg(h,1);this.Okj=()=>{this.hide();4===A.AFrameworkApplication.ua.Ib.fVa?(x.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.jp.Jvc()):(x.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.jp.B5c());return!0};this.$me=()=>{x.ULS.sendTraceTag(37339423,
211,50,"Open give feedback dialog");return!0};this.Xne=()=>{x.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";A.AFrameworkApplication.va.Ob(Pa.a.PZb,2);return!0};this.$ng=()=>{this.jp.Jvc()};this.jp=b;this.kh=$H.kh;this.Gd=5;this.Qg="ProtocolLaunchingDialog";this.OFc="OICRetryDialog";A.AFrameworkApplication.mc.Qrb&&A.AFrameworkApplication.mc.restart();A.AFrameworkApplication.mc.Zb(new Re.a(2,1,5E3,()=>{this.yfp()},101));this.showDialog("",
this.$ng);this.wOj();this.L8("Issues");this.iqi();x.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Zba(){const b=document.getElementById("Issues");if(b){yL("",this.jp.zZc,this.jp.r7c,this.jp.zUf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.jp.Dpj?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);HD(b);b.style.display="none"}A.AFrameworkApplication.ua.Ib.lLi?
(this.J4b=VF("GiveFeedback",this.jp.zZc,this.jp.r7c,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,this.$me,this.klj),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.J4b),HD(this.J4b)):document.getElementById("ButtonGiveFeedback").style.display="none";0===A.AFrameworkApplication.ua.Ib.fVa||A.AFrameworkApplication.bUl?document.getElementById("ButtonEdit").style.display="none":(this.A1a=VF("Edit",this.jp.zZc,this.jp.r7c,"",2===A.AFrameworkApplication.ua.Ib.Tk?4===
A.AFrameworkApplication.ua.Ib.fVa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===A.AFrameworkApplication.ua.Ib.fVa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,this.Okj,this.Rkj),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.A1a),HD(this.A1a));0===A.AFrameworkApplication.ua.Ib.fVa&&!A.AFrameworkApplication.G_f&&b&&(b.style.display="none")}jqi(){return this.Wgb?(this.v4(this.Wgb),!0):!1}iqi(){return this.A1a?
(this.v4(this.A1a),!0):!1}oeg(b,h){let n=!1;if(b.Kb.keyCode===Jd.a.Mu||b.Kb.keyCode===Jd.a.U0a)b.Nf.click(),n=!0;else if(b.Kb.keyCode===Sys.UI.Key.down||b.Kb.keyCode===Sys.UI.Key.up)switch(h){case 1:n=this.iqi();break;case 0:n=this.jqi()}return n}Yfg(){dN.Redirect.showHelp("OICFailure");return!0}yfp(){var b=document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&
!b.children.length&&(this.Wgb=VF("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,this.Xne,this.Gnj),b.appendChild(this.Wgb),HD(this.Wgb),this.A1a||this.jqi())}}dispose(){this.UV||(this.A1a&&(Ef.a.instance.xc(Cd.a.click,this.A1a,this.Okj),bb.KeyInputManager.instance.xc(Cd.a.oi,this.A1a,this.Rkj)),this.J4b&&(Ef.a.instance.xc(Cd.a.click,this.J4b,this.$me),bb.KeyInputManager.instance.xc(Cd.a.oi,this.J4b,this.klj)),this.Wgb&&(Ef.a.instance.xc(Cd.a.click,this.Wgb,this.Xne),bb.KeyInputManager.instance.xc(Cd.a.oi,
this.Wgb,this.Gnj)),super.dispose(),this.UV=!0)}}Object(u.a)(AL,"ProtocolLaunchingDialog",Ge.a,[]);class aI extends ui.StandardDialog{constructor(b){super();this.$me=h=>{x.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.Vkj(h)};this.Xne=()=>{x.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");A.AFrameworkApplication.va.Ob(Pa.a.PZb,2)};this.$ng=h=>{aI.tNi?3===h?this.qHj():2===h||0===h?this.T7h():1===h&&this.afc():2===h?this.qHj():(1===h||0===h)&&this.T7h()};this.jp=b;this.Qg=
"ProtocolLaunchingDialog";A.AFrameworkApplication.mc.Qrb&&A.AFrameworkApplication.mc.restart();A.AFrameworkApplication.ua.Ib.lLi&&this.GWk(this.$me);aI.tNi?(this.Gd=12,this.Pe(1,CommonUIStrings.l_CloseFile),this.Pe(2,CommonUIStrings.l_OICDialogContinueHere),this.Pe(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Gd=4,this.Pe(1,CommonUIStrings.l_OICDialogContinueHere),this.Pe(2,CommonUIStrings.l_OICDialogLaunchAgain));this.Qub(CommonUIStrings.l_OICDialog2ndTitle,5===this.jp.Dpj?CommonUIStrings.l_OICBrowserDialogTitle:
CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,this.$ng,null)}afc(){x.ULS.sendTraceTag(577783557,211,50,"Closing the document");A.AFrameworkApplication.va.Pb(Pa.a.close,2,Wg.a)}qHj(){x.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(this.Xne,0)}T7h(){4===A.AFrameworkApplication.ua.Ib.fVa||A.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===A.AFrameworkApplication.ua.mode?(x.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),
this.jp.Jvc()):(x.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.jp.B5c())}static get tNi(){return A.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===A.AFrameworkApplication.va.Ob(Pa.a.close,1)}}Object(u.a)(aI,"StandardProtocolLaunchingDialog",ui.StandardDialog,[]);class BL{}Object(u.a)(BL,"EditDocumentInClientParams",null,[]);class CL{static Sii(b,h,n,B,L,ba,la=!1,La=!1,fb="",Cb=!1,Lb=!1,$b=!1,tc="",Nc="",dd="",Hd=!1,xe=""){const je=new BL;je.DocumentUrl=b;je.DocumentExtension=
xe;je.Mode=h;je.Options=n;je.Application=B;je.SilentExternalHandler=la;je.EncodeUrl=La;je.CorrelationIdForWinClient=fb;je.NavigateUsingWindowOpen=Cb;je.DescriptiveUnattemptedEnums=Lb;je.NoBrowserModalDialogs=$b;je.SessionOrigin=tc;je.CorrelationId=Nc;je.ClickTime=dd;je.NewTelemetryDataIsEnabled=Hd;MSOJS.ClientUtils.EditDocumentInClient(je,L,ba)}}Object(u.a)(CL,"ClientUtils",null,[]);var HN=d(589),DL=d(1024);class YB{constructor(b){this.l4a=this.LGc=this.IEc=null;this.UHc=!1;this.MQe=this.y0e=this.Pwh=
null;this.dyd=this.pA=this.uMd="";this.application=this.mx=0;this.hfp=this.NGg=!1;this.PHo=(h,n,B)=>n.contextId!==id.a.frame?2:1===B?32:this.PZb();this.Qij=()=>{this.Qpf()};this.Rij=()=>{this.Jvc()};this.Llj=()=>{this.q6i()};this.e2m=()=>this.ugi(!0);this.JBp=b&&A.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");A.AFrameworkApplication.va.d3(Pa.a.PZb)||A.AFrameworkApplication.va.ra(Pa.a.PZb,id.a.frame,this.PHo);this.EVj=!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("SilentExternalHandler")}get Dpj(){return this.mx}$Yo(b,
h="",n=""){this.pA=n||yb.a.create().toString();this.uMd=h||HN.a.hDi();this.dyd=b}get options(){let b=0;A.AFrameworkApplication.UEo&&(b|=1);A.AFrameworkApplication.Lpj&&(b|=4);this.afp()&&(b|=64);return b}afp(){return!(2===this.application&&A.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get zZc(){return A.AFrameworkApplication.Ys}get r7c(){return A.AFrameworkApplication.Vfa}get MQi(){return""}get zUf(){return""}get gfp(){return A.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get Xip(){return this.Pwh||
(this.Pwh=Ya.a.instance.resolve("Common.IOfficeTrialExperience"))}Qpf(){this.NGg||this.r3l()}Jvc(){this.hfp||this.tmi()}Wyj(b){return this.JBp&&X.a.Di?(new zL(this),32):this.P5h(b)}P5h(b){const h=({Zzb:b}=this.axn(b)).returnValue;x.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}Fc(b,h,n,B,L,ba,la=""){this.IEc=b;this.MQe=la;this.LGc=h;this.l4a=ba;this.application=n;this.mx=B;return A.AFrameworkApplication.Cii?(this.q6i(),32):A.AFrameworkApplication.iua&&!A.AFrameworkApplication.tPi?
(A.AFrameworkApplication.$Dg(),8):this.fWh(L)}get wTn(){return!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}PZb(){this.wTn&&this.PBn();return this.P5h(this.UHc)}JLj(){const b=new DL.a(H.a.YX);b.Values["ui-language"]=A.AFrameworkApplication.lcid.toString();b.Values[zt.a.uci]=A.AFrameworkApplication.userSessionId;return this.l4a.value.send(b)?32:8}PBn(){oa.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new rb.a,{inStaging:!1}))}jPo(b){const h=new DL.a(H.a.KEp);h.Values["ui-language"]=A.AFrameworkApplication.lcid.toString();h.Values[zt.a.uci]=A.AFrameworkApplication.userSessionId;h.Values[I.a.JEp]=b;this.l4a.value.send(h)}axn(b){this.UHc=b;this.jPo(5===this.mx?YB.k5n:YB.q5n);return 5===this.mx?this.$wn():this.exn()}$wn(){this.z6i();return{returnValue:32,Zzb:"HostEditUrl,"}}exn(){let b;var h=b="";A.AFrameworkApplication.OOh&&(h="|f|"+A.AFrameworkApplication.userSessionId);
const n=A.AFrameworkApplication.K.$("IsAssignmentMode")&&A.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||A.AFrameworkApplication.xad||X.a.RXa,B=A.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),L=A.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(A.AFrameworkApplication.va.ule){var ba=A.AFrameworkApplication.va.mX(3588168074);ba&&this.$Yo(ba.epochClickTime,ba.sessionOrigin,ba.correlationId);this.iaj()}if(A.AFrameworkApplication.Buj){b+="NewOrder,";
ba=8;this.l4a&&this.l4a.value&&this.l4a.value.isEnabled()&&A.AFrameworkApplication.N2b&&(b+="Post,",ba=this.JLj());if(32===ba)return{returnValue:ba,Zzb:b};x.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return A.AFrameworkApplication.It.gca?(x.ULS.shipAssertTag(5566816,211,!!A.AFrameworkApplication.It.gca),b+="HostUrl,",{returnValue:A.AFrameworkApplication.ua.UX(!0,A.AFrameworkApplication.It.gca),Zzb:b}):this.IEc?(x.ULS.sendTraceTag(18715405,211,15,
"Try to open doc in rich client, SessionId {0}",A.AFrameworkApplication.userSessionId),b+="DocUrl,",CL.Sii(this.IEc,this.mx,this.options,this.application,Object(z.a)(this,this.Qkj,"onEditInClientSuccess"),Object(z.a)(this,this.Pkj,"onEditInClientFailure"),this.EVj,A.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,n,B,L,this.uMd,this.pA,this.dyd,A.AFrameworkApplication.va.ule,this.MQe),{returnValue:32,Zzb:b}):{returnValue:8,Zzb:b}}b+="OldOrder,";if(!this.IEc&&A.AFrameworkApplication.It.gca)return this.l4a&&
this.l4a.value&&this.l4a.value.isEnabled()&&A.AFrameworkApplication.N2b?(b+="Post,",h=this.JLj()):(x.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(x.ULS.shipAssertTag(22595484,211,!!A.AFrameworkApplication.It.gca),b+="HostUrl,",{returnValue:A.AFrameworkApplication.ua.UX(!0,A.AFrameworkApplication.It.gca),Zzb:b}):{returnValue:h,Zzb:b};x.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",A.AFrameworkApplication.userSessionId);
b+="DocUrl,";CL.Sii(this.IEc,this.mx,this.options,this.application,Object(z.a)(this,this.Qkj,"onEditInClientSuccess"),Object(z.a)(this,this.Pkj,"onEditInClientFailure"),this.EVj,A.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,n,B,L,this.uMd,this.pA,this.dyd,A.AFrameworkApplication.va.ule,this.MQe);return{returnValue:32,Zzb:b}}UDo(b){A.AFrameworkApplication.wm.setDw(8981,b)}Qkj(b){this.UDo(b);x.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?
(this.gfp||this.z6i(),this.iaj()):this.NGg||this.Qpf()}Pkj(b,h=0){x.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const n=!!this.LGc&&!this.UHc;let B=0;1===b&&(B=2);6<=b&&13>=b&&(B=1,1===h&&(this.NGg=!0));this.Xip.hTn?(x.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",B),GN.a.instance.bIl(this.UHc?this.Qij:this.Rij,n?this.Llj:null,
this.ugi(!1)?this.e2m:null,B,h)):(x.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",B),GN.a.instance.$Hl(this.UHc?this.Qij:this.Rij,n?this.Llj:null,B))}}iaj(){try{const b=[Object.assign(new ia.a,{name:"CorrelationId",string:this.pA}),Object.assign(new ia.a,{name:"SessionOrigin",string:this.uMd}),Object.assign(new ia.a,{name:"ClickTime",string:this.dyd}),Object.assign(new ia.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Pe.a("OpenInClientCompleted",
!0,0,b)}catch(b){x.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}z6i(){A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.cH&&A.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?new aI(this):new AL(this)}ugi(b){const h=(X.a.O9c||X.a.ju)&&!!A.AFrameworkApplication.P_d;h&&b&&($c.a.yn(A.AFrameworkApplication.P_d,"_blank",void 0,"OpenInClient"),this.Qpf());return h}}YB.q5n="OpenInDesktop";YB.k5n="OpenInBrowser";Object(u.a)(YB,"AOpenInClientOperation",
null,[]);class nG extends YB{constructor(b,h,n=!1){super(n);this.jzk=b;this.izk=h}get MQi(){return this.izk}get zUf(){return this.jzk}r3l(){A.AFrameworkApplication.va.Pb(Pa.a.close,2,Wg.a)}tmi(){}fWh(b){return this.Wyj(b)}q6i(){x.ULS.shipAssertTag(5566817,211,!!this.LGc);A.AFrameworkApplication.gga?A.AFrameworkApplication.ua.UX(!0,this.LGc):$c.a.yn(this.LGc,void 0,void 0,"LaunchDownload")}B5c(){A.AFrameworkApplication.ua.Ib.B5c()}}Object(u.a)(nG,"OpenInClientOperation",YB,[]);class DJ extends nG{constructor(){super("Word_32x32x32",
"EditInWordWebApp_32x32x32",!0);this.Uwo=b=>{x.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");$e.App.Lna?$e.App.Ak.Akd(!1,"OpenInWordOperation").then(()=>{this.qig(b)}).catch(()=>{this.b$i(b,-1)}):$e.App.uV.CF(this.qig,this.b$i,b)};this.b$i=b=>{x.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new ui.StandardDialog;h.Gd=0;h.Gy(yd.a.Trp,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.mBn:this.nBn)};
this.mBn=()=>{A.AFrameworkApplication.va.Pb(Pa.a.close,2,Wg.c)};this.nBn=()=>{Ua.StaticActiveAppFrame.za().D8(null)};this.qig=b=>{A.AFrameworkApplication.hrd=!0;x.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);this.Wyj(b)}}jcl(b){$e.App.jf.Qbb.Nmc||we.StaticTheCoauthManager.ud().qC.Ko?(x.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.qig(b)):Qw.a.mU(zA.a.Qpj,!0,this.Uwo,null,b)}fWh(b){this.jcl(b);return 32}tmi(){Ua.StaticActiveAppFrame.za().D8(null)}}
Object(u.a)(DJ,"OpenInWordOperation",nG,[]);const ZB=(b,h)=>{x.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");b[$g.a.On]=Gm.PageReader.instance.nw(h);Gm.PageReader.instance.nw(h)?b[$g.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:b[$g.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},eK=(b,h,n,B,L)=>{if(!Ua.StaticActiveAppFrame.za()||!Ua.StaticActiveAppFrame.za().ib||!A.AFrameworkApplication.Om.qqb)return 8;h=
Ua.StaticActiveAppFrame.za().ib.$c;if(!h)return 8;if(b===wb.a.Kre&&2===n){b=new Sd.GraphTransaction(15);try{b.Ab(h),Gm.PageReader.instance.Ykp(h)}finally{b&&b.dispose()}ZB(L,h)}return 32},fK=(b,h,n,B,L)=>{if(!Ua.StaticActiveAppFrame.za()||!Ua.StaticActiveAppFrame.za().ib)return 8;b=Ua.StaticActiveAppFrame.za().ib.$c;if(!b)return 8;L[$g.a.Alt]=A.AFrameworkApplication.Om.qqb?"":CommonUIStrings.l_ProtectDocumentToolTip;ZB(L,b);return 32};var gK=d(1189);class EL extends CJ.a{constructor(b,h){super(b,
h);this.irh=this.hrh=this.aqh=!1;this.YSc=new ob.a("docx doc docm dot dotx odt dotm".split(" "));this.Zcd=100;this.rmj=(n,B,L,ba,la)=>{var La;if(B.contextId!==id.a.frame)return 2;if(!($e.App.PVc||A.AFrameworkApplication.It.gca||A.AFrameworkApplication.N2b||this.aqh))return x.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.aqh=!0,8;if(1===L)return hc.SessionStatusManager.instance.Gk?8:32;let fb=!1;void 0!==la&&null!==la&&(fb=la);if(null===(La=A.AFrameworkApplication.K)||void 0===La?0:
La.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",!1))(new xL).Soe().then(()=>this.$Wb(n,fb));else return this.$Wb(n,fb);return 32};this.GFe=(n,B,L)=>{if(1==L){if(!gK.a.QXe)return this.hrh||(x.ULS.sendTraceTag(508703937,231,50,"Open files from PC is shown as disabled"),this.hrh=!0),64;if(!A.AFrameworkApplication.Be.GBc)return this.irh||(x.ULS.sendTraceTag(508598026,231,50,"Open files from PC is shown as disabled due to empty token"),this.irh=!0),64}else if(2==L)return Pe.a("OpenFileFromPC"),
(n=this.RJl())?this.U6o(L,n):2;return 32};this.kWl=n=>{this.CCn();if(!A.AFrameworkApplication.xad&&A.AFrameworkApplication.ua.Ib.cCg(Pa.a.lfa.toString()))this.rEa(!0,H.a.download,!0,{});else if(A.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let B=A.AFrameworkApplication.INb,L=null;n&&(n.FileDownloadUrl&&(B=n.FileDownloadUrl.toString()),n.CallSource&&(L=n.CallSource.toString()));new oz(B,L)}else super.lfa(0,null,2,null,null)};this.Dkl=n=>{super.workflow(0,null,2,null,n)};this.h6=
Ya.a.instance.Qa("Common.ISystemInitiatedFeedback")}get WVf(){this.lnh||(this.lnh=Ya.a.instance.resolve("Common.IInsertFileUploader"));return this.lnh}Wb(){super.Wb();this.ga.ra(wb.a.YX,id.a.frame,this.rmj);A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Rc(wb.a.YX,12288);var b=this.ga;b.fb(wb.a.Kre,oc.a.application,eK,4);b.fb(wb.a.hpg,oc.a.application,fK,96);this.ga.ra(Pa.a.lig,id.a.frame,this.rmj);
this.ga.ra(wb.a.$9j,oc.a.view,this.GFe);this.ga.ra(wb.a.a$j,oc.a.view,this.GFe)}$Wb(b,h){x.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new DJ).Fc($e.App.PVc,A.AFrameworkApplication.INb,yA.Word,b===Pa.a.lig?kx.OpenInBrowser:kx.WriteOnly,h,new Rf.a(()=>this.c0))}ETd(b){return cd.a.instance.QIa()?!0:Ua.StaticActiveAppFrame.za().eJj(zA.a.afc,zn.a.xtl,b)}RJl(){return()=>{window.addEventListener("fileUploadedSuccessfully",this.Lnp,{once:!0});this.WVf.yVo(this.Zcd);
this.WVf.BQo(this.YSc);this.WVf.showDialog()}}U6o(b,h){return 2===b?(h(),32):2}Lnp(){window.addEventListener("focus",()=>{const b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");null!=b&&b.execute(h=>{Pe.a("triggerUploadFileFeatureSurvey");h.logActivity("UploadFileFeatureSurvey","UploadFileFloodgateSurveyIsEnabled")})},{once:!0})}lfa(b,h,n,B,L){if(2===n){if(!A.AFrameworkApplication.INb&&!A.AFrameworkApplication.ua.Ib.cCg(Pa.a.lfa.toString()))return 8;Qw.a.mU(zA.a.lfa,!0,this.kWl,null,L);return 32}return super.lfa(b,
h,n,B,L)}CCn(){A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.h6&&this.h6.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,n,B,L){return 2===n?(Qw.a.mU(zA.a.workflow,!0,this.Dkl,null,L),32):super.workflow(b,h,n,B,L)}}Object(u.a)(EL,"AppFrameCommandUIActor",CJ.a,[]);class FL extends ui.StandardDialog{constructor(){super();this.Gd=0;this.Qub(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,
CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,null,null)}}Object(u.a)(FL,"WheresTheSaveButtonDialog",ui.StandardDialog,[]);const IN=(b,h,n)=>{if(1===n)return 32;new FL;return 32};var oG=d(591),GL=d(1424);class Bt extends gs.a{constructor(b,h,n,B,L=null){super();this.vga=L;this.lpk=56;this.KNc="px";this.gLe="aria-label";this.kQa="BookmarkIndicator";this.ylh="HighlightBookmarkedContent";this.tyk="HighlightBookmark";
this.K2a="wwaengidc";this.xdl="Bookmark_24";this.jb=b;this.Pg=h;this.mZ=n;(this.vB=B)&&this.vB.JRd(this.zD.bind(this))}l1o(b){if(b.Kj){for(const h of b.$f.mj)if(this.mSj(h))return!0;return!1}return this.mSj(b.htmlElement)}qeb(b){let h=!1;Rn.a.instance.Yd(()=>{h=this.l1o(b)},"BIA:SCIVE");return h}mSj(b){return Bt.h9e?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}t7a(b){const h=[];Rn.a.instance.Yd(()=>{const n=b.D6a(0,this.lpk,this.zoom);
h.push(this.Ira(b.s8,n,b.CBc[0].y-b.E7[0].y))},"BIA:CIs");return h}Ira(b,h,n){const B=b.uh.ownerDocument,L=Hi.a.createElement(B,Tm.a.div);L.className=Bt.opk;Bt.B$g;L.style.left=h+this.KNc;L.style.top=n+this.KNc;h=Hi.a.createElement(B,Tm.a.div);kh.a("renderIcon")&&appChrome.api.renderIcon(this.xdl,h);h.setAttribute("role","img");h.setAttribute("alt","Bookmark");h.title="Bookmark";h.setAttribute(this.gLe,"Bookmark");L.appendChild(h);b={context:new XH([],L,new Set,new Set,null,null),sdg:b,container:L};
this.Pg.rK(Cd.a.click,L,this.SMa.bind(this),b);return L}cWd(){const b=Object.assign(new qr.a,{action:1,type:5,ZB:null,dM:this.nia});this.nia=null;this.mZ.qH(b)}zD(b,h){this.nia&&(h.o8a.Nf.classList.contains("BookmarkHighlightSelected")||this.cWd())}SMa(b){this.fdb(this.ylh,this.tyk);if(null==b){var h=new Map;h.set("Source",this.kQa);h=Object.assign(new rb.a,{additionalValues:h});oa.Health.instance.recordKpiFailure(this.ylh,"Unable to highlight bookmarked content",!1,!0,h);return!1}h=b.Mq.context;
if(Bt.Hab(h,this.nia))return!0;h=this.CKf(b.Mq.sdg,h,b.Mq.container);b=Object.assign(new qr.a,{action:0,type:5,ZB:h,dM:this.nia});this.nia=h;this.mZ.qH(b);return!0}CKf(b,h,n){h={LWh:new Set,jXb:new Set,OWh:null,llf:null};const B=this.jb.Gv(b.Cb,!0,!1),L=[];if(B)for(const ba of B)L.push(ba);this.gYk(b,h,L);h=new XH(L,n,h.LWh,h.jXb,h.OWh,h.llf);this.nia&&this.nia.jt===L&&(n.className+=String.format(" {0}",Bt.kpk),this.nia=h);return h}gYk(b,h,n){var B;if(b.Kj){var L=new Set;for(const la of b.$f.mj)la.querySelectorAll("*").forEach(L.add,
L);b=Array.from(L.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),0);let ba=[];h.jXb.add(n[0].id);h.OWh=n[0].id;h.llf=n[0].id;b.forEach(la=>{const La=Hg.a.Eb(la,mo.a.UTd);if(La)for(const fb of La)ba.push(fb),h.LWh.add(fb);if(!ba.length)return!0;la=Hg.a.Eb(la,mo.a.HKb);if(!la)return!0;ba=GL.a.mvc(ba,la)});for(b=this.jb.zg(n[n.length-1],!1,!0);ba.length&&b;)h.jXb.add(b.id),h.llf=b.id,n.push(b),L=this.vga.value.nl(b),L=null===(B=null===L||void 0===L?void 0:L.htmlElement)||
void 0===B?void 0:B.querySelectorAll("."+mo.a.klf),null===L||void 0===L?void 0:L.forEach(la=>{(la=Hg.a.Eb(la,mo.a.HKb))&&(ba=GL.a.mvc(ba,la))}),b=this.jb.zg(b,!1,!0)}fdb(b,h){const n=new Map;n.set("Source",this.kQa);n.set("Action",h);oa.Health.instance.recordKpiUsage(b,0,this.K2a,n)}static Hab(b,h){return!!h&&!!b&&b.JWh===h.JWh}}Bt.kpk="WordBookmarkIndicatorContainerSelected";Bt.h9e=!0;Bt.B$g="WordBookmarkIndicatorContainer";Bt.opk="WordBookmarkSvgIndicatorContainer";Object(u.a)(Bt,"BookmarkIndicatorActor",
gs.a,[246]);class HL{constructor(b,h,n,B,L,ba,la,La,fb,Cb=null,Lb=null,$b=null,tc=null,Nc=null,dd=null,Hd=null){var xe,je;this.Eia="_";this.vxd=(null===(xe=A.AFrameworkApplication.K)||void 0===xe?0:xe.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableLocalizedBookmarkName",!1))?WordEditorIntl.WordEditorStrings.L_Bookmark:"Bookmark";this.Nok=(null===(je=A.AFrameworkApplication.K)||void 0===je?0:je.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableLocalizedBookmarkName",!1))?new RegExp("^"+
this.vxd+"\\d+$","i"):/^BOOKMARK\d+$/i;this.kQa="BookmarkRibbonOptions";this.ipk="BookmarkFloatieOptions";this.kdh="CreateBookmarkOnRange";this.ldh="CreateBookmarkOnView";this.jdh="CreateBookmarkOnIP";this.SOe="CreateBookmark";this.K2a="wwaengidc";this.zFh="ShowHideBookmarksOnDocument";this.Aeh="DeleteBookmark";this.gtk="DeleteBookmarkAction";this.TNk="ShowHideBookmarks";this.yFh="ShowBookmarksFloatie";this.QNk="ShowBookmarksFloatieAction";this.hgh="EditBookmark";this.fuk="EditBookmarkAction";this.olf=
"BookmarksUsage";this.zdl="InsertTabSwitchActivity";this.oan="Insert";this.b4b=b;this.ga=h;this.hb=n;this.zp=B;this.Oy=L;this.m$=ba;this.Pc=la;this.kO=La;this.Rq=Lb;this.A$g=fb;this.Oe=Cb;this.S9=Nc;this.Bo=$b;this.nd=tc;this.HV=dd;this.ul=Hd}get lv(){return this.Oy.value}Wb(){this.ga.ra(Dc.a.KUa,oc.a.view,this.KUa.bind(this));this.ga.fb(Pa.a.g0a,oc.a.application,this.Jnp.bind(this),96);this.ga.ra(Dc.a.KUa,oc.a.Bd,this.SDl.bind(this));this.ga.ra(Dc.a.KUa,oc.a.Xc,this.RDl.bind(this));this.ga.ra(Dc.a.deleteBookmark,
oc.a.view,this.deleteBookmark.bind(this));this.ga.ra(Dc.a.Nzf,oc.a.view,this.YYl.bind(this));this.ga.fb(Dc.a.QTj,oc.a.view,this.L6o.bind(this),1028);this.ga.fb(Dc.a.Rre,oc.a.application,this.Rre.bind(this),96);this.ga.fb(Dc.a.Gze,oc.a.Xc,this.Gze.bind(this),1028);this.ga.fb(wb.a.aie,oc.a.view,this.aie.bind(this),1028);this.ga.fb(Dc.a.Pae,oc.a.view,this.Pae.bind(this),1028);this.ga.Rc(Dc.a.KUa,1028)}Jnp(b,h,n,B,L){return L&&L.NewContextId===this.oan?(this.yie(this.zdl),32):2}KUa(b,h,n,B,L){var ba,
la;b=this.hb.Og;if(!b||b.contextId===oc.a.caa)return 2;if(1===n)return Ve.a.Sla(h)||(null===(ba=this.ul)||void 0===ba?0:ba.Q2(b))||(null===(la=this.ul)||void 0===la?0:la.Vla(b))?8:32;h=this.hb.gb.currentSelection;if(!h||this.Oe.Dm(h))return 2;this.vcd(L,"User is trying to create bookmark from UILocation : {0}");this.fdb(this.ldh,this.SOe);if(h&&this.zp.Def(this.uqb(),h))return this.yie(this.olf),32;L=new Map;L.set("Source",this.kQa);L=Object.assign(new rb.a,{additionalValues:L});oa.Health.instance.recordKpiFailure(this.ldh,
"Unable to create bookmark",!1,!0,L);return 8}SDl(b,h,n,B,L){if(1===n)return 32;if(oc.a.Bd!==h.contextId)return 8;this.vcd(L,"User is trying to create bookmark from UILocation : {0}");b=this.hb.gb.currentSelection;if(!b)return 2;this.fdb(this.kdh,this.SOe);if(this.zp.Def(this.uqb(),b))return this.yie(this.olf),32;b=new Map;b.set("Source",this.kQa);b=Object.assign(new rb.a,{additionalValues:b});oa.Health.instance.recordKpiFailure(this.kdh,"Unable to create bookmark for range",!1,!0,b);return 8}RDl(b,
h,n,B,L){if(1===n)return 32;if(oc.a.Xc!==h.contextId)return 8;this.vcd(L,"User is trying to create bookmark from UILocation : {0}");b=this.hb.gb.currentSelection;if(!b)return 2;this.Oe.Dm(b)&&(h=b.Ra,this.Oe.Ftb(h)?(b=this.Oe.i7(h,!1),b||(x.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.Oe.i7(h,!0))):x.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.fdb(this.jdh,this.SOe);if(this.zp.Def(this.uqb(),
b))return this.yie(this.olf),32;b=new Map;b.set("Source",this.kQa);b=Object.assign(new rb.a,{additionalValues:b});oa.Health.instance.recordKpiFailure(this.jdh,"Unable to create bookmark for IP",!1,!0,b);return 8}Rre(b,h,n,B,L){1===n&&32;L[$g.a.On]=Bt.h9e;return 32}L6o(b,h,n,B,L){if(1===n)return 32;this.fdb(this.zFh,this.TNk);(b=L[$g.a.On])||x.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");Bt.h9e=b;b=Object($n.a)().tU(this.lv);if(null!==b)return this.Ljd(b),this.b4b.hJ({ShowBookmarks:"CheckboxModel"}),
32;b=new Map;b.set("Source",this.kQa);b=Object.assign(new rb.a,{additionalValues:b});oa.Health.instance.recordKpiFailure(this.zFh,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,n,B,L){b=this.hb.gb.currentSelection;if(!b)return 2;b=b.Ra;b=this.zp.G6d(b.node,b.cpBegin);if(1===n)return b?32:8;this.vcd(L,"User is trying to delete bookmark from UILocation : {0}");this.kO.D3&&(x.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),this.kO.dismissFloatie());
this.fdb(this.Aeh,this.gtk);b||x.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.zp.LBj(b.id))return this.A$g&&this.A$g.cWd(),32;n=new Map;n.set("Source",this.kQa);n=Object.assign(new rb.a,{additionalValues:n});oa.Health.instance.recordKpiFailure(this.Aeh,"Unable to delete bookmark",!1,!0,n);return 8}YYl(b,h,n,B,L){b=this.hb.gb.currentSelection;if(!b)return 2;b=b.Ra;b=this.zp.G6d(b.node,b.cpBegin);if(1===n)return b?32:8;this.vcd(L,
"User is trying to edit bookmark from UILocation : {0}");this.kO.D3&&(x.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.kO.dismissFloatie());this.fdb(this.hgh,this.fuk);b||x.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.S9.value.ZYl(h,b,this.zp),32;h=new Map;h.set("Source",this.kQa);h=Object.assign(new rb.a,{additionalValues:h});oa.Health.instance.recordKpiFailure(this.hgh,"Unable to edit bookmark",
!1,!0,h);return 8}vcd(b,h){b&&b.UILocation&&x.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}Gze(b,h,n,B,L){1===n&&32;this.fdb(this.yFh,this.QNk);if(h.contextId===oc.a.Xc)return b=Array(1),b.push("Bookmarks"),this.kO.showFloatie(L.location,b,1),32;L=new Map;L.set("Source",this.ipk);L=Object.assign(new rb.a,{additionalValues:L});oa.Health.instance.recordKpiFailure(this.yFh,"Unable to show bookmark floatie",!1,!0,L);return 8}aie(b,h,n,B,L){let ba;return 1===n?(Rn.a.instance.Yd(()=>{ba=this.ga.lg(h,
wb.a.QR,n,!0,B,L);32!==ba&&(ba=this.ga.lg(h,Dc.a.KUa,n,!0,B,L))},"BA:LFE"),ba):8}Pae(b,h,n){var B;if(1===n)return 32;if(b=this.hb.gb.currentSelection){b=b.Ra.node;if(h=this.Tmi(b))return h.click(),32;x.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.zp.G6d(b,0)){b=this.HV.Mmb.get(null===(B=b.id)||void 0===B?void 0:B.toString());B=Object($n.a)().tU(this.lv).Lc.Eb(b);if(B=this.Tmi(B))return B.click(),32;x.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else x.ULS.sendTraceTag(539523267,
3029,50,"No bookmark found enclosing the content.")}return 2}Tmi(b){let h;b=this.Bo.nm(b).nl(this.nd.zd.oc);b.hab&&(b=b.htmlElement.querySelectorAll("div."+Bt.B$g),0<b.length&&(h=b[0]));return h}Ljd(b){const h=oG.b(b);if(h){var n=this.Pc.Mc(2);try{for(n.Ab(b);h.moveNext();){if(!ea.ParagraphReader.Bh(h.iterator))continue;const B=h.currentNode;this.RXl(B)&&this.m$.ySb(B,!0)}}finally{n&&n.dispose()}}}RXl(b){for(let n=0;n<b.qa.length;n++){const B=b.qa.J(n);if(null!=B.Zh)for(let L=0;L<B.Zh.length;L++){var h=
B.Zh.J(L);if(null!=h&&(h=b.Lc.Eb(h.Po).ja(Lc.a.yu,""),!F.a.Tf(h)&&!h.startsWith(this.Eia)))return!0}}}uqb(){var b=this.zp.g5d(!1);const h=[];for(let n=0;n<b.count;n++){const B=b.J(n).ja(Lc.a.yu,"");this.Nok.test(B)&&h.push(B)}return 0<h.length?(h.sort((n,B)=>n.localeCompare(B,void 0,{numeric:!0})),b=parseInt(h[h.length-1].substring(this.vxd.length)),this.vxd+(b+1)):this.vxd+1}fdb(b,h){const n=new Map;n.set("Source",this.kQa);n.set("Action",h);oa.Health.instance.recordKpiUsage(b,0,this.K2a,n)}yie(b){this.Rq&&
this.Rq.execute(h=>{h.logActivity(b,null)})}}Object(u.a)(HL,"BookmarkActor",null,[]);class IL{constructor(b,h,n){this.Sb=b;this.aTl=h;this.Xf=n;this.rqf=this.rqf.bind(this)}Wb(){this.Sb.ra(Dc.a.t3f,oc.a.view,this.rqf)}rqf(b,h,n,B,L){return 1===n?32:(b=this.Xf.jba(h.Hk))?(L=3===L.iz,this.aTl.value.Q9h(this.UGm(b),this.CQm(b),L),32):2}UGm(b){const h=new Og.DictionaryPropertySet;h.setValue(ye.a.GG,this.Xf.Fh(b));h.setValue(ye.a.WH,this.Xf.$aa(b));h.setValue(ye.a.vra,this.Xf.Dqb(b));h.setValue(ye.a.separator,
this.Xf.s9d(b));return h}CQm(b){const h=new Og.DictionaryPropertySet;h.setValue(Lc.a.marginLeft,this.Xf.$J(b));h.setValue(Lc.a.marginRight,this.Xf.FL(b));h.setValue(Lc.a.rp,this.Xf.ev(b));return h}}Object(u.a)(IL,"ColumnsDialogActor",null,[]);var JL=d(506);class KL{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb){this.Tp=b;this.Aia=h;this.Ge=n;this.Dr=B;this.Wm=L;this.Qd=ba;this.Pc=la;this.xe=La;this.ga=fb;this.QAk=Cb;this.Mrk=Lb}get rYf(){return this.QAk}Wb(){this.ga.fb(wb.a.Jpd,oc.a.view,this.D9m.bind(this),
96);this.ga.fb(wb.a.Hkd,oc.a.view,this.Hkd.bind(this),4);this.ga.fb(wb.a.SSd,oc.a.view,this.SSd.bind(this),1028)}SSd(b,h,n,B,L){if(!hn.a.asf)return 8;b=L.FormattingActionId;L=L.FormattingActionData;if(!h.view||!h.view.te)return 2;h=h.view;if(!(b&&L&&h.lb&&h.lb.gb.currentSelection))return 8;h=this.Wm.pwi(h.lb.gb.currentSelection.toArray());for(const ba of h){h=ba.ja(Lc.a.Iw,0);n=this.Tp.getById(h);if(!n)return x.ULS.sendTraceTag(509136987,368,10,"Content control not found by id '"+h+"'."),8;if(!this.Mrk.bvp(n,
b,L))return x.ULS.sendTraceTag(509136986,368,10,"Content control with id '"+h+"' failed to update formatting."),8}return 32}D9m(b,h,n,B,L){h=this.Tp.getById(L);if(!h)return 8;n=h.Ud;if(!n)return 8;if(hn.a.Qec&&8===h.type||n.ja(Lc.a.yaa,!1))return 2;B=this.Tp.anm(h);if(!B)return 8;L=this.Pc.Mc(7);L.Ab(B.node);if(!this.rYf)return(b=h.placeholderText)||(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Qd.Ne(B,b),hn.a.pga?this.Wm.sKb(h,!0):this.sKb(h),n.setValue(Lc.a.yaa,!0),L.dispose(),
32;const ba=new Og.DictionaryPropertySet;ba.setValue(zd.a.w$d,B);var la=n.ja(Lc.a.HUa,"");la=this.Aia.vKi(la);if(!la)return this.Dr.Ne(B,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,hn.a.As?b:void 0),hn.a.pga?this.Wm.sKb(h,!0):this.sKb(h),n.setValue(Lc.a.yaa,!0),L.dispose(),32;ba.setValue(zd.a.i5c,la);if(1<la.length&&!h.fg)return L.dispose(),8;hn.a.pga?this.ga.Pb(wb.a.Spd,2,{i5c:la,w$d:B,placeholderText:h.placeholderText}):this.mCl(ba);n.setValue(Lc.a.yaa,!0);L.dispose();return 32}Hkd(b,
h,n){b=h.view.te?h.view:null;if(!b||!b.lb)return 8;const [B,L]=this.aKm(b.lb.gb);if(0===B.length)return 8;if(1===n){for(var ba of B){var la=L.get(ba.parentId);if(this.QWi(ba,la))return 32}return 8}if(2===n){n=this.k$o(B,L);ba=this.Pc.Mc(15);ba.Ab(b.jd);for(la of n)n=L.get(la.parentId),this.QWi(la,n)&&this.Tp.mZb(la.id);ba.dispose();Object(JL.l)()&&Object(JL.o)("RemoveContentControl");return 32}return 2}aKm(b){var h,n,B=[];for(const ba of b)B.push(...(null!==(h=this.Wm.Fsa(ba.Ra,ba.Uc,1))&&void 0!==
h?h:[]));if(0===B.length)return[B,new Map];h=[];for(const ba of b)h.push(...(null!==(n=this.Wm.Fsa(ba.Ra,ba.Uc,3))&&void 0!==n?n:[]));b=new Map(B.map(ba=>[ba.id,ba]));if(0===h.length)return[B,b];const L=new Map(h.map(ba=>[ba.id,ba]));B=B.filter(ba=>!L.has(ba.id));b=new Map([...b,...L]);return 0==B.length?[[h[0]],b]:[B,b]}sKb(b){const h=this.Dr.Ikc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(h){if(b=this.xe.EF(b.start.node).gh(Xr.a.Ykg))this.Ge.Zja(h.formatting),this.Ge.oeb(h.formatting,
b)}else x.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}mCl(b){this.ga.Pb(wb.a.Spd,2,b)}QWi(b,h){return b.Nla&&b.ypn&&(!h||h.isEditable)}k$o(b,h){const n=(B,L)=>null==B||null==L||B.id===L.id?!1:B.id===L.parentId||n(h.get(B.parentId),L);return b.slice().sort((B,L)=>n(B,L)?1:n(L,B)?-1:0)}}Object(u.a)(KL,"ContentControlActor",null,[]);var lx=d(1170);class EJ extends Ge.a{constructor(b,h,n){super(!1,!1,!0);this.jth=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,
lx.a.Ohf,lx.a.Nhf,lx.a.Phf];this.$nk=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,lx.a.p4k,lx.a.o4k,lx.a.r4k];this.U8g=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.Zxc=()=>{new EJ(this.ga,this.aaf,this.ZFc)};this.owm=()=>{const B=[];for(const L of this.aaf)B.push(this.l9(L));return B};this.Lzp=B=>{const L=new Set;this.xia="";for(const ba of B)if(""!==ba.position){const la=this.lDi(ba.position);
if(0>la||22<la){this.xia=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(L.has(la)){this.xia=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.xkp(ba)),L.add(la)}else{this.xia=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.xia&&(this._tabStops=[],this.aaf=B)};this.IMl=(B,L)=>{try{if(1===B){if(""!==this.xia)throw Error.create(this.xia);L.DefaultTabStop&&(this.ZFc=lx.a.twg(L.DefaultTabStop),this.ZCp(this.ZFc));
if(32!==this.ga.Pb(Dc.a.r2b,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Fg.a.Ow(this.ZFc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(ba){this.nOa(ba.message,this.Zxc)}};this.ga=b;this.aaf=h;this._tabStops=[];this.ZFc=n;this.xia="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.h2c()};this.pi(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.IMl,b)}l9(b){return{["position"]:b.position,["alignment"]:b.alignment,["leader"]:b.leader}}lDi(b){return Math.floor(100*
parseFloat(b))/100}xkp(b){return new Qx.a(Fg.a.Ow(this.lDi(b.position)),lx.a.MMm(b.alignment),lx.a.KMm(b.leader),1)}ZCp(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var h={};if(32===this.ga.Pb(wb.a.ANa,2,h)){var n=h.marginLeft;const B=ri.a.qj(h.marginRight,0);n=ri.a.qj(n,0);h=ri.a.qj(h.rp,0);if(ri.a.Zfa(b,0,!1)>=h-B-n)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);}}h2c(){return{["getInitState"]:this.owm,
["updateState"]:this.Lzp,["validPositions"]:this.JHi(0,"Position"),["validAlignments"]:this.Lvi(this.U8g,this.U8g,null,"Alignment"),["validLeaders"]:this.Lvi(this.jth,this.jth,this.$nk,"Leader"),["defaultTabStopSpinButtonProps"]:this.JHi(.01,"DefaultTabStops"),["defaultTabStopLength"]:this.ZFc,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,
["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}JHi(b,h){return{["type"]:"AppSpinButtonProps",
["id"]:"CustomTabDialogSpinButtonPosition",["label"]:h,["unitType"]:"Inch",["validUnits"]:[xw("Inch",3,b,22,.1)],["numberFormatInfo"]:qG()}}Lvi(b,h,n,B){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:B,["options"]:pC(b,h,n)}}}Object(u.a)(EJ,"CustomTabDialog",Ge.a,[]);class pz{constructor(b,h,n){this.Jrc=(B,L,ba,la,La)=>{if(2!==ba)return 8;if(!La)return 16;B=La.tabStop;La=La.value;if(!B)return 16;Pe.c(Dc.a.Jrc);La=new Qx.a(La,B.Lha,B.hua,B.gHg);L=L.node;this.eGa.kdb(L,
B);this.eGa.gce(L,La);return 32};this.Pnd=(B,L,ba,la,La)=>{if(2===ba){if(!La)return 16;this.eGa.gce(L.node,La);return 32}return 8};this.nYb=(B,L,ba,la,La)=>{B=this.eGa.Qyj(L.node);if(!("customTabs"in La))return La.customTabs=B,32;L=La.customTabs;if(!L||0>=L.length||!B||0>=B.length)return La.customTabs=null,32;ba=[];for(const fb of L)for(const Cb of B)if(Cb.QOa===fb.QOa&&Cb.gHg===fb.gHg&&Cb.Lha===fb.Lha){ba.push(fb);break}La.customTabs=ba;return 32};this.kdb=(B,L,ba,la,La)=>{if(2===ba){if(!La)return 16;
Pe.c(Dc.a.kdb);this.eGa.kdb(L.node,La);return 32}return 8};this.nZb=(B,L)=>{this.eGa.nZb(L.node);return 32};this.r2b=(B,L,ba,la,La)=>{if(2===ba){if(!La)return 16;B=La.tabStops;ba=La.defaultTabStopLength;L=L.node;la=!1;const fb=this.eGa.YCo(L,B);La.defaultTabStopLengthSaved||(la=this.pT.pSo(L,ba),La.defaultTabStopLengthSaved=!0);fb&&Pe.d(Dc.a.r2b,!0,void 0,void 0,void 0,void 0,[Object.assign(new ia.a,{name:"Custom Tab Stops Count",string:B.length.toString()})]);if(null==la)return x.ULS.sendTraceTag(571479714,
3015,15,"Could not set Default Tab Stop Length."),16;la&&(this.kld&&this.kld.TUi(),this.Md.$t(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),Pe.d(Dc.a.r2b,!0,void 0,void 0,void 0,void 0,[Object.assign(new ia.a,{name:"Default Tab Stop Length",string:ba.toString()})]));return 32}return 8};this.$Tj=(B,L,ba)=>{if(2!==ba)return 8;B={};if(32!==this.ga.Pb(Dc.a.K_,2,B))return x.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),16;L={};if(32!==this.ga.Pb(wb.a.ANa,
2,L))return x.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;B=lx.a.twg(Fg.a.oB(B.defaultTabStop));ba={};ba.defaultTabStopLength=B;ba.sectionPropertiesData=L;if(32!==this.ga.Pb(Dc.a.cOg,2,ba))return x.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!ba.isParagraphValid)return x.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),this.eGa.nOa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),
8;L={};if(32!==this.ga.Pb(Dc.a.nYb,2,L))return x.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(L=L.customTabs)||(L=[]);L=lx.a.LMm(L);new EJ(this.ga,L,B);Pe.c(Dc.a.Zxc,!0);return 32};this.eon=(B,L,ba,la,La)=>{if(2!==ba)return 8;if(!La)return 16;if(La.isParagraphValid)return 32;ba={};if(32!==this.ga.lg(L,wb.a.Zcb,2,!1,null,ba))return 16;B=La.sectionPropertiesData;L=La.defaultTabStopLength;var fb=ba.Eu;la=fb.ota;fb=1===fb.specialIndentType?fb.oD:fb.oD-fb.Eha;const Cb=B.marginLeft,
Lb=B.marginRight;ba.isRtl?(ba=ri.a.qj(Math.max(Lb,Lb+la),0),la=ri.a.qj(Math.max(Cb,Cb+fb),0)):(ba=ri.a.qj(Math.max(Cb,Cb+fb),0),la=ri.a.qj(Math.max(Lb,Lb+la),0));B=ri.a.qj(B.rp,0);L=ri.a.Zfa(L,0,!1);La.isParagraphValid=L<B-ba-la;return 32};this.ga=b;this.eGa=h;this.pT=n}get Md(){return null!=this.e6g?this.e6g:this.e6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get kld(){return null!=this.y3g?this.y3g:this.y3g=Ya.a.instance.Oa("WordEditor.Actors.RenderParagraphsContainingTabs")}Wb(){const b=
n=>Hy.OutlineElementGeneralizer.Wka(n.gb,!0),h=$e.App.n0a.zXc(b,!0);this.ga.ra(Dc.a.nYb,oc.a.view,$e.App.n0a.zXc(b,!1));this.ga.fb(Dc.a.nYb,oc.a.paragraph,this.nYb,96);this.ga.ra(Dc.a.kdb,oc.a.view,h);this.ga.fb(Dc.a.kdb,oc.a.paragraph,this.kdb,96);this.ga.ra(Dc.a.nZb,oc.a.view,h);this.ga.fb(Dc.a.nZb,oc.a.paragraph,this.nZb,96);this.ga.ra(Dc.a.Pnd,oc.a.view,h);this.ga.fb(Dc.a.Pnd,oc.a.paragraph,this.Pnd,96);this.ga.ra(Dc.a.Jrc,oc.a.view,h);this.ga.fb(Dc.a.Jrc,oc.a.paragraph,this.Jrc,96);this.ga.ra(Dc.a.r2b,
oc.a.view,h);this.ga.fb(Dc.a.r2b,oc.a.paragraph,this.r2b,96);this.ga.ra(Dc.a.cOg,oc.a.view,h);this.ga.fb(Dc.a.cOg,oc.a.paragraph,this.eon,96);this.ga.ra(Dc.a.Zxc,oc.a.view,this.$Tj);this.ga.ra(Dc.a.xTi,oc.a.view,this.$Tj)}}Object(u.a)(pz,"CustomTabActor",null,[]);var JN=d(134),bI=d(665);class LL{constructor(b,h,n,B,L,ba,la,La,fb){this.ga=b;this.WPd=n;this.G1a=(this.JPc=L)&&B;this.fp=ba;this.qW=la;this.Lsk=La;this.My=fb;this.Wnk=h;this.yaj(!0);this.p$i(!0);A.AFrameworkApplication.aJ(()=>{this.nWb()});
this.G1a&&kh.a("dispatch")&&appChrome.api.dispatch(this.JZj([]))}Wb(){this.G1a&&(this.ga.ra(Dc.a.Rkp,oc.a.view,this.YMl.bind(this)),this.ga.ra(Dc.a.epd,oc.a.view,this.epd.bind(this)),this.ga.fb(Dc.a.jjd,oc.a.view,this.jjd.bind(this),96));this.JPc&&(this.ga.ra(Dc.a.fpd,oc.a.view,this.fpd.bind(this)),this.ga.fb(Dc.a.Jse,oc.a.view,this.Jse.bind(this),96))}lcn(b){if(!this.z2o(b))return!1;const h=vm.a.instance.Mc(2);try{h.Ab(b.root);const n=ve.GraphIterator.eb(b.root.graphNode),B=It.a.Bq(n);for(;B.moveNext();){const L=
Object(ya.a)(JN.a,B.currentNode);L&&L.uI(b.oc,20,!0)}}finally{h&&h.dispose()}return!0}z2o(b){return b&&b.root&&b.lw?b.nj||b.xZf||b.QYi||b.ek:!1}WEo(){let b=!1;this.WPd.forEach(h=>{this.lcn(h)&&(b=!0)});return b}Skp(){x.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.fp.fP?"dark":"light");return this.fp.fP?bI.a.uSc(1):bI.a.XBj(1)}lJg(){const b=this.fp.N6;x.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.WEo()||
(b?!bI.a.uSc(0):!bI.a.XBj(0)))return!1;this.Lsk.tmo(b);return!0}JZj(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.fp.fP));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.mIi(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.fp.Teb?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):x.ULS.sendTraceTag(527283228,
3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){x.ULS.sendTraceTag(527282835,3023,10,h)}return b}YMl(){return this.lJg()?32:8}fpd(b,h,n){if(1===n)return 32;b=this.qW.Vf("UserAction","sharedUXDarkModeToggle");if(kh.a("toggleSharedUXDarkMode"))x.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),kh.a("isSharedUXDarkModeOn")?this.fp.fP=appChrome.api.isSharedUXDarkModeOn():this.fp.fP=!this.fp.fP,x.ULS.sendTraceTag(529388308,
3023,50,"User in new ribbonMode: {0}",this.fp.fP);else return 8;appChrome.getHeaderApi().then(B=>{B.hasOwnProperty("refreshThemeOverride")&&B.refreshThemeOverride()});this.Skp()||x.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.G1a&&!this.fp.Teb&&(this.lJg()||x.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");Ua.StaticActiveAppFrame.za().hJ(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",
!this.fp.fP));this.G1a&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.fp.fP));b.stop();x.ULS.sendTraceTag(555885377,3023,50,"{0}",b.Fi);Pe.b(this.fp.fP?"DarkModeOn":"DarkModeOff");return 32}epd(b,h,n){if(1===n)return 32;b=this.qW.Vf("UserAction","sharedUXDarkModeSwitchBackground");x.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.fp.Teb=!this.fp.Teb;if(!this.lJg())return 8;h={};h.DarkModeSwitchBackground=
this.My?"ButtonModel":"ToggleButtonModel";Ua.StaticActiveAppFrame.za().hJ(h);b.stop();x.ULS.sendTraceTag(555885378,3023,50,"{0}",b.Fi);x.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.fp.Teb);Pe.b(this.fp.Teb?"DarkCanvasOff":"DarkCanvasOn");return 32}Jse(b,h,n,B,L){if(1===n)return 32;if(!L)return 2;kh.a("isSharedUXDarkModeOn")&&(this.fp.fP=appChrome.api.isSharedUXDarkModeOn());L&&(L[$g.a.On]=this.fp.fP);return 32}jjd(b,h,n,B,L){if(1===n)return 32;if(!L)return 2;!this.My&&L&&
(L[$g.a.On]=this.fp.Teb);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.fp.fP));this.G1a&&this.JZj(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.mIi(!1)));appChrome.api.dispatch(b);return 32}mIi(b){const h={};this.fp.Teb?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");
return h}nWb(){this.JPc&&this.yaj(!1);this.G1a&&this.p$i(!1)}yaj(b){var h;x.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",b,this.fp.fP?"dark":"light",this.fp.FJa);b&&this.fp.fP!=(null===(h=this.Wnk)||void 0===h?void 0:h.$("DarkModeIsOn"))&&x.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.fp.fP?"dark":"light",this.fp.FJa)}p$i(b){x.ULS.sendTraceTag(561088150,3023,
50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.fp.N6?"dark":"light",this.fp.XMl)}}Object(u.a)(LL,"DarkModeActor",null,[]);var ML=d(332);class uu{constructor(b){this.Fn=null;this.Hqa=b}get yKb(){return null!=this.UTg?this.UTg:this.UTg=Ya.a.instance.Oa("Box4.IAutoCorrectRules")}get g_(){return null!=this.WTg?this.WTg:this.WTg=Ya.a.instance.Oa("Box4.IAutoCorrectScheduler")}get bY(){return null!=this.A2g?this.A2g:this.A2g=Ya.a.instance.Oa("Box4.Pages.IPageContentEditor")}get MN(){return null!=
this.Y1g?this.Y1g:this.Y1g=Ya.a.instance.Oa("Box4.IOutlineEditor")}get tg(){return this.Fn||(this.Fn=this.Hqa())}Q6i(b,h,n){if(this.MN&&uu.km){var B=ML.ContextSetEditor.kLf(h);b=B.node;re.SelectionEditor.gl(B)&&(B=Nd.a.Tc(b,ea.ParagraphReader.textLength(b)));var L=Va.FormattingReader.language(Va.FormattingReader.Cs(B));B=ve.GraphIterator.eb(n.jd);Object($n.a)().Gve(B);var ba=b=null;if(B)for(let la=B.Ub(1);la&&!ba;la=B.Cj(1))pl.OutlineReader.BCa(la)&&(ba=la);if(B&&!ba){if(!this.bY||!this.MN)return;
b=new Sd.GraphTransaction(7);b.qu(B);ba=this.bY.VYd(B);this.MN.Hja(B,!0);L&&(Ga.OutlineElementNavigator.Le(B),B=Nd.a.Tc(B.currentNode,0),uu.km.Xxe(Va.FormattingReader.Cs(B),L))}L=Oe.SelectionFactory.pp(ba,!0);n.lb.Ic(L);re.SelectionEditor.mf(h)&&(n=ve.GraphIterator.eb(h.node),n.tq(),Zj.OutlineNavigator.Rvg(n),this.yKb&&this.g_&&pl.OutlineReader.XA(n,h,!0)&&(h=this.yKb.KDf(h,-1,!1,Jd.a.xz))&&this.g_.OJj(h));this.tg&&this.tg.$G();b&&b.dispose()}}static get km(){return null!=uu.YXg?uu.YXg:uu.YXg=Ya.a.instance.Oa("Box4.IFormattingEditor")}static get instance(){return null!=
uu.F_g?uu.F_g:uu.F_g=uu.Qm()}static Qm(){return new uu(()=>Ya.a.instance.Oa("Box4.IUndoManager"))}}Object(u.a)(uu,"TitleViewEditor",null,[]);class FJ{Nwf(b,h,n){return 1===n?32:FJ.xQl(h.node)}static xQl(b){const h=new ve.GraphIterator;h.set(b);h.tq();b=new Sd.GraphTransaction(7);b.qu(h);h.eh();b.dispose();return 32}}Object(u.a)(FJ,"DeleteOutlineLevelContentStrategy",null,[]);class gr{constructor(){this.itk=new FJ;this.Nwf=(b,h,n,B,L)=>this.itk.Nwf(b,h,n,B,L)}Wb(b){const h=this.$ei.Xwf.bind(this.$ei),
n=this.Nwf,B=this.Pei.CQl.bind(this.Pei);this.erg(b,h,n,B);b.ra(wb.a.backspace,oc.a.Xc,B);b.ra(wb.a.backspace,oc.a.Bd,B);b.ra(wb.a.backspace,oc.a.Vc,Ce.ActionManager.gU);b.ra(wb.a.backspace,oc.a.outline,n);b.ra(wb.a.backspace,oc.a.view,h);b.Rc(wb.a.backspace,1124);b.ra(wb.a.wAa,oc.a.Xc,Ce.ActionManager.gU);b.ra(wb.a.wAa,oc.a.Bd,B);b.ra(wb.a.wAa,oc.a.Vc,Ce.ActionManager.gU);b.ra(wb.a.wAa,oc.a.outline,n);b.ra(wb.a.wAa,oc.a.view,h);b.fb(wb.a.tZd,oc.a.view,h,1124);b.ra(wb.a.SJ,oc.a.Xc,B);b.ra(wb.a.SJ,
oc.a.Bd,B);b.ra(wb.a.SJ,oc.a.Vc,Ce.ActionManager.gU);b.ra(wb.a.SJ,oc.a.outline,n);b.ra(wb.a.SJ,oc.a.view,h);b.Rc(wb.a.SJ,1124);b.fb(wb.a.mvf,oc.a.view,h,1124);b.fb(wb.a.Wra,oc.a.view,gr.Wra,1028)}erg(){}static get Kf(){return null!=gr.a2g?gr.a2g:gr.a2g=Ya.a.instance.resolve("Box4.IOutlineElementEditor")}static get bY(){return null!=gr.x2g?gr.x2g:gr.x2g=Ya.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get MN(){return null!=gr.X1g?gr.X1g:gr.X1g=Ya.a.instance.resolve("Box4.IOutlineEditor")}static get rc(){return null!=
gr.ZWg?gr.ZWg:gr.ZWg=Ya.a.instance.Oa("Box4.IFeatureHelper")}static Wra(b,h,n,B,L){B=h.view;if(!B.lb||!B.lb.gb.currentSelection||re.SelectionEditor.Dm(B.lb.gb.currentSelection))return 8;if(1===n)return 32;n=B.lb.gb;const ba=n.currentSelection;var la=ba.Ra,La=null,fb=!1;if(n.QL){if(la.contextId===oc.a.outline&&1===n.length){for(b=ve.GraphIterator.eb(la.node);b.Xd();)b.eh();gr.MN.Hja(b,!0);Ga.OutlineElementNavigator.Le(b);b=Oe.SelectionFactory.se(b.currentNode,0);B.lb.Ic(b);return 32}La=la.node;var Cb=
null;if(Ok.c(la)){var Lb=La.ue(B.oc);Lb&&(Lb=Lb.zhq)&&0<=Lb.width&&0<=Lb.height&&(Cb=new tz.a(ri.a.em(Lb.x,0),ri.a.em(Lb.y,1)));Cb||(Cb=ns.a(La))}else Cb=ns.a(la.node);la=ve.GraphIterator.eb(la.node);la.tq();Object($n.a)().Gve(la);La=gr.bY.VYd(la);ns.b(La,Cb.x,Cb.y);gr.MN.Hja(la,!0);La=Oe.SelectionFactory.pp(La,!0)}else if(1===n.length){fb=n.last;la=Zb.a.CMb(fb);if(gr.rc&&gr.rc.isFeatureEnabled(23)&&Object(el.a)().kEg(la).returnValue)return 2;la=fb.Uc;fb=!n.Pw&&!(null===(Cb=n.currentSelection)||void 0===
Cb?0:Cb.Nab)&&(re.SelectionEditor.gl(la)||ea.ParagraphReader.nn(la)||re.SelectionEditor.yba(la))}fb&&(fb=re.SelectionEditor.Wj(ba,!1,!1,void 0,!1),B.lb.Ic(fb),A.AFrameworkApplication.va.lg(h,wb.a.newLine,2,!1,null,L),La=B.lb.gb.currentSelection,B.lb.Ic(ba));L||(L=new Og.DictionaryPropertySet);L.setValue(zd.a.EZc,!0);A.AFrameworkApplication.va.lg(h,wb.a.SJ,2,!0,null,L);if(La&&La.Ra.isValid)return B.lb.Ic(La),32;n.QL&&uu.instance.Q6i(b,h.Hk,B);re.SelectionEditor.Dm(B.lb.gb.currentSelection)||A.AFrameworkApplication.va.lg(h,
wb.a.newLine,2,!1,null,L);return 32}static wQl(b,h){if(1===h)return 32;h=new Sd.GraphTransaction(7);h.Ab(b);gr.Kf.YDa(b);h.dispose();return 32}}Object(u.a)(gr,"ADeleteActor",null,[]);var NL=d(251),GJ=d(746);class En{get mg(){return Pd.a.instance}CQl(b,h,n,B,L){B=null===L||void 0===L?void 0:L.cud;if(1===n)return 32;var ba=b===wb.a.backspace;if(this.mg.vh){if(this.mg.cZi(h)&&En.ika&&(n=h.clone(),n.Tb+=1,--n.Fb,this.mg.Apc(n)))return En.ika.wBj([n]),32;if(this.mg.h_f(h,ba))return 2}if(En.wy()&&En.wy().instance&&
En.wy().instance.DX(h))return 4;const la=h.node;var La=h.cpBegin;n=h.cpEnd;let fb=h.Fb,Cb=h.Tb;const Lb=ea.ParagraphReader.text(la),$b=Lb.length;let tc=!1;if(La===n){if(ba&&!La||!ba&&La===$b)return 2;ba?({cp:La,returnValue:tc}=this.mg.jfj(la,La),tc||({cp:La,lra:fb,returnValue:tc}=this.mg.ifj(h,La,fb)),tc||(La--,F.a.YA(Lb,La)&&La--),b=wb.a.zkf):({cp:n,returnValue:tc}=this.mg.VNn(la,n),tc||({cp:n,lra:Cb,returnValue:tc}=this.mg.UNn(h,n,Cb)),tc||(n++,F.a.YA(Lb,n)&&n++),b=wb.a.xei)}La=La===n?Nd.a.Tc(la,
La):Nd.a.createTextRange(la,La,n);Oq.a.Hpb&&(La.nfa=h.nfa,La.isa=h.isa);tc&&this.mg.vh&&(ba?La.Fb=fb:La.Tb=Cb);if(!this.mg.Apc(La))return 2;this.NJb(la);h=new Sd.GraphTransaction(15);h.yi=b;h.Ab(la);ba=Object(Wb.a)(GJ.a,L)&&L.I8a;if(!En.Md.Mg||ba||hn.a.As&&En.LIa.ege(Zb.a.instance.gb.currentSelection))this.Qei(La,B);else{ba=En.Md.p6a();try{const Nc=En.Vh.sqd(La);let dd;if(({type:dd}=Nc.i$d()).returnValue){const Hd=Object(ya.a)(97,L);Hd&&Hd.ja(hi.a.tYf,!1)||!hn.a.As&&4===dd?En.Md.Gcb=dd:En.Md.$t(dd)}L=
0;for(let Hd=Nc.length-1;0<=Hd;--Hd){let xe;const je=({Oge:xe}=Nc.getContext(Hd)).returnValue;xe?(En.Np.lvb(je,null),L+=En.Lj.Ayb(je,2),En.Lj.yYd=n+L):this.Qei(je,B)}}finally{ba&&ba.dispose()}}h.dispose();return 32}NJb(){}static get Md(){return null!=En.h6g?En.h6g:En.h6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Lj(){return null!=En.V5g?En.V5g:En.V5g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Vh(){return null!=
En.C6g?En.C6g:En.C6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Np(){return null!=En.LYg?En.LYg:En.LYg=Ya.a.instance.resolve("Box4.IHyperlinkEditor")}static wy(){return En.Xn||(En.Xn=Ya.a.instance.Qa("Box4.IExternalSelectionManager"))}static get ika(){En.LDb||(En.LDb=Ya.a.instance.Qa("Box4.ContentControl.IContentControlOperator"));return En.LDb.instance}static get LIa(){return null!=En.hUg?En.hUg:En.hUg=Ya.a.instance.resolve("Box4.IContentControlViewElementManager")}}
En.Xn=null;En.LDb=null;Object(u.a)(En,"ADeleteParagraphContentStrategy",null,[]);var OL=d(237);class sw extends En{constructor(){super()}get rg(){return null!=this.nUg?this.nUg:this.nUg=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Lr(){return null!=this.eUg?this.eUg:this.eUg=Ya.a.instance.Qa("Box4.ContentControlConfigSettings")}get Irc(){return null!=this.H1g?this.H1g:this.H1g=Ya.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get p_(){return null!=this.MUg?this.MUg:this.MUg=
Ya.a.instance.resolve("Box4.IContentControlChpHelper")}get iU(){return null!=this.lXg?this.lXg:this.lXg=Ya.a.instance.resolve("Box4.IFieldEditor")}Qei(b,h){this.MPl(b,h)}s3k(b,h,n,B){this.Lr.instance&&this.Lr.instance.vh&&(b.cpBegin===h.cpBegin?b.Fb=h.Fb:n&&(b.Fb=n.Hb&&n.Hb.length?0:-1),b.Tb=B)}NJb(b){we.StaticTheCoauthManager.NJb(b)}MPl(b,h){var n=b.node;const B=OL.b([new zb.a(b.cpBegin,b.cpEnd)],this.DPm(b));var L=new qb.a,ba=[];sw.uul(n,B,L,ba);for(const la of L.keys)1<L.J(la)&&CE.a.kjj(S.a.Cf(la));
this.Rxo(n,ba);this.Irc.HVc(n);n=b.Tb;L=!!this.Lr.instance&&this.Lr.instance.vh;for(ba=B.length-1;0<=ba;ba--)n=this.deleteRange(b,B[ba],n,L,h)}DPm(b){const h=[],n=b.node;var B=tn.f(n,la=>la.Xja);for(var L of B)B=L.Jb.cp,h.push(new zb.a(B,B+1));L=[];Oq.a.kI?this.iU&&(L=this.iU.TJf(n,b)):L=ea.ParagraphReader.aWa(n);for(var ba of L)this.cnn(ba,b)&&h.push(ba);ba=!!this.Lr.instance&&this.Lr.instance.Dta;this.Lr.instance&&this.Lr.instance.vh||!ba||!n.gv||(sw.w7h&&sw.w7h.Owo(b),this.p_&&h.push(...this.p_.CIf(n).toArray()));
return OL.a(h)}cnn(b,h){return Oq.a.kI?this.iU?!this.iU.sXi(b,h):!1:!b.hN||!sw.$Yf(b,h)}Rxo(b,h){const n=new ob.a;for(const B of h)for(h=0;h<B.length;){h=this.sAi(B,h,0);if(-1===h)break;let L=this.sAi(B,h+1,3);if(-1===L)break;if(B.J(h).hN)for(;L>=h;){const ba=B.J(L);n.add(ba.oe);B.remove(ba);L--}h=L+1}b.nna(n)}sAi(b,h,n){for(;h<b.length;h++){const B=b.J(h);if(1===B.Zq&&B.ve===n)return h}return-1}deleteRange(b,h,n,B,L){const ba=h.Fc,la=h.end;h=null;B&&(h=b.node.qa.sh(ba));ba<la&&(B=Nd.a.createTextRange(b.node,
ba,la),Oq.a.Hpb&&(B.nfa=b.nfa,B.isa=b.isa),this.s3k(B,b,h,n),this.rg.Ne(B,"",void 0,void 0,wb.a.QTc,!1,L));return n=h&&h.Hb&&h.Hb.length?h.Hb.length:-1}static get w7h(){return null!=sw.WUg?sw.WUg:sw.WUg=Ya.a.instance.Oa("WordEditor.ContentControl.IContentControlOperator")}static $Yf(b,h){return b.Fc>=h.cpBegin&&b.end<=h.cpEnd}static uul(b,h,n,B){let L=0;b=b.qa;for(const ba of h)for(;L<b.length;){h=b.J(L);if(h.cp>=ba.Fc&&h.cp<ba.end&&(h.fc&&h.fc.mzl&&B.push(h.fc),h.Zh))for(let la=0;la<h.Zh.length;la++){const La=
h.Zh.J(la).Po.toString();n.mb(La)?n.Z(La,n.J(La)+1):n.Z(La,1)}++L}}}Object(u.a)(sw,"DeleteParagraphContentStrategy",En,[]);class HJ{static get fJ(){return NL.a.instance}static XQl(b,h,n){if(1===n)return 32;b=h.node;return HJ.fJ.LUd(b)?gr.wQl(b,n):32}}Object(u.a)(HJ,"DeleteUnsupportedObjectStrategy",null,[]);var cI=d(910),KN=d(549);class LN{constructor(b,h,n,B,L){this.fEp=b;this.Aca=n;this.rd=B;this.actionId=h;this.cud=L}}Object(u.a)(LN,"DeleteActionData",null,[]);class Ti{constructor(b,h,n,B,L,ba,
la,La,fb,Cb){this.Rei=b;this.mg=h;this.fJ=n;this.Np=B;this.t3=L;this.Dg=ba;this.Irj=la;this.rg=La;this.Md=fb;this.LIa=Cb}omp(b){return!re.SelectionEditor.am(b)&&!re.SelectionEditor.ega(b)}oKm(b,h,n){var B;let L,ba,la;if(!h&&b&&b.ly&&(B=b.Ra)&&re.SelectionEditor.mf(B)&&this.Dg.Xb(B.node)&&(L=B.node.qa.sh(B.cpBegin))&&L.vn&&(ba=this.slm(L))&&ba.hyperlink.wI&&(la=this.cKm(b,ba.cp)))return la;if(!b)return null;if(B=this.rqp(b,h))return B;if(!n)return b;h=re.SelectionEditor.zVa(b,!h,{jC:!1,Kt:!0,qE:!0,
$F:!0});return Oe.SelectionFactory.$y(b,h.Ra,!1)}slm(b){const h=b.paragraph.qa;let n=null;b=b.cp;for(let B=0;B<h.length;B++){const L=h.J(B);if(L.cp>=b)break;L.vn&&(n=null);L.hyperlink&&(n=L)}return n}fKm(b,h){var n=b.Ra.node;if(h){if(h=re.SelectionEditor.Q_a(b.Ra.node,b.Ra.cpBegin,!0),b=Oe.SelectionFactory.$y(b,Nd.a.Tc(b.Ra.node,h),!1),n=n.qa.sh(h),n.J7||n.n0)b.Ra.Fb=0}else if(h=re.SelectionEditor.Q_a(b.Ra.node,b.Ra.cpBegin,!1),b=Oe.SelectionFactory.$y(b,Nd.a.Tc(b.Ra.node,h),!1),n=n.qa.sh(h),n.J7||
n.n0)b.Ra.Fb=n.Rx+n.dQ;b.ooc=!0;return b}rqp(b,h){var n=b.Ra;let B=null;if(!b.ly||!n||!re.SelectionEditor.mf(n))return null;if(this.Dg.Xb(n.node)&&(B=h?n.node.qa.sh(n.cpBegin):n.node.qa.Mqb(n.cpBegin-1))&&B.KU)return this.fKm(b,h);n=ve.GraphIterator.eb(b.Ra.node);if(!n.zb(8))return null;Ga.OutlineElementNavigator.he(n);let L=!1;const ba=[];if(h?B&&B.mi:0===b.Ra.cpBegin){do(b=h?Ga.OutlineElementNavigator.ht(n,!0,!0,!1):Ga.OutlineElementNavigator.Y3(n,!0,!0,!1))&&(null===b||void 0===b?0:b.WWa)?(ba.push(Nd.a.create(Ga.OutlineElementNavigator.Le(n))),
Ga.OutlineElementNavigator.he(n)):L=!0;while(!L);if(0<ba.length)return h=new gn.Selection(h?ba:ba.reverse(),h),h.ooc=!0,h}return null}cKm(b,h){var n=re.SelectionEditor.YAa(b,{jC:!1,Kt:!1,qE:!0,$F:!0});if(!n||!n.ly||n.Ra.node!==b.Ra.node)return null;n=n.Ra;if(n.cpBegin!==n.cpEnd)return null;const B=this.Dg.text(n.node);for(let L=n.cpBegin-1;L>=h;L--)if(!F.a.Qw(B.charCodeAt(L)))return Oe.SelectionFactory.$y(b,Nd.a.Tc(n.node,L+1),!1);return Oe.SelectionFactory.$y(b,Nd.a.Tc(n.node,h),!1)}Xwf(b,h,n,B,
L){var ba,la;if(1===n)return 32;(n=null===(la=null===(ba=h.view)||void 0===ba?void 0:ba.lb)||void 0===la?void 0:la.Og)&&Object(el.a)().mdi(n).filter(ea.ParagraphReader.BX).forEach(La=>{var fb;return null===(fb=ea.ParagraphReader.LKa(La.node))||void 0===fb?void 0:fb.Kye("delete_selection")});la=!1;b===wb.a.mvf?(b=wb.a.SJ,la=!0):b===wb.a.tZd?(b=wb.a.backspace,la=!0):b===wb.a.wAa&&(h=new bB.a(Ua.StaticActiveAppFrame.za().ib.sc));if(!h.view.te)return 2;yz.GrippersManager.instance.lA(!1);ba=b===wb.a.SJ;
n=dt.a.dKf(h);if(la&&this.mg.vh&&n&&re.SelectionEditor.Dm(n)&&this.mg.h_f(n.Ra,!ba,!0))return 2;la=this.oKm(n,ba,la);return this.ZQl(b,h,B,L,la,ba)}ZQl(b,h,n,B,L,ba){var la;const La=h.view,fb=La.lb;var Cb=B,Lb=B;b===wb.a.wAa&&(Lb=Cb=null,L=new gn.Selection(B,!0));if(!L)return 32;const $b=this.u1o(Cb,ba);if(this.mg.vh&&Ti.ika&&1===fb.gb.length&&re.SelectionEditor.Dm(L)&&L.ly&&Ti.ika.HMo(L.Ra,ba)||Oq.a.kI&&Ti.iU&&1===fb.gb.length&&re.SelectionEditor.Dm(L)&&L.ly&&Ti.iU.IMo(L.Ra,ba))return 32;let tc;
ba?ce.a.mark(tc=5009):ce.a.mark(tc=5011);Cb=new Sd.GraphTransaction(15);Cb.yi=b;Cb.Ab(La.jd);let Nc=null,dd=({gLo:Nc}=this.onm(b,B,fb,L,Nc)).returnValue;var Hd=null;({qAe:Hd}=Object(el.a)().kEg(dd)).returnValue&&(dd=Hd);if(!dd)return Cb.dispose(),32;Hd=!1;A.AFrameworkApplication.Ld("b1jb9393;09icj321");if(null===(la=A.AFrameworkApplication.K)||void 0===la?0:la.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))la=dd.node,Hd=null===la||void 0===la?void 0:la.gv;const xe=
new LN(h,b,n,Lb,Hd);Lb=null;this.mg.vh&&Ti.ika&&(Lb=Object(el.a)().TO(dd),Ti.ika.wBj(Lb));Oq.a.kI&&Oq.a.M7a&&Ti.iU&&1===fb.gb.length&&!re.SelectionEditor.Dm(L)&&(Lb||(Lb=Object(el.a)().TO(dd)),Ti.iU.Swo(Lb));this.p2j(dd);const je=this.f5d(dd,L,ba);let he=null;ba?he=new cI.a(L):je&&(he=new cI.a(je));let fe=!1;Lb=Ti.Wk;if(re.SelectionEditor.mf(dd)){const De=Vy.a.Ekc(La.jd,$b);Lb.Yd(()=>{this.HPl(h,n,B,dd,ba,he,L,De,fb,$b,xe,je)},"DVS:DAIPC")}else!this.Md.Mg||hn.a.As&&this.LIa.ege(L)?Lb.Yd(()=>{fe=this.Xsj(b,
La.jd,dd,fb,$b,xe,he,Nc)},"DVS:PUD"):(Lb.Yd(()=>{this.nmp(b,La.jd,dd,ba,L,fb,$b,xe,he)},"DVS:TCDC"),fe=!0);this.V$l(fb);this.xGj(dd);Cb.dispose();ce.a.mark(tc+1);return b===wb.a.wAa?fe?32:8:32}Xsj(b,h,n,B,L,ba,la,La){h=Vy.a.Ekc(h,L);this.omp(n)&&h.ofb(n);b=Ti.Ec.rq(b);b.properties.Z("CountOfParagraphsDeleted",this.Dg.Rsf(n).toString());n=this.nVl(n,B,L,h,ba,la,La);b.end();return n}nmp(b,h,n,B,L,ba,la,La,fb){var Cb=0,Lb=null;const $b=Object(el.a)().TO(n),tc=$b[$b.length-1];if(tc.contextId===oc.a.paragraph||
tc.contextId===oc.a.Vc){var Nc=ve.GraphIterator.eb(tc.node);Nc.Jd();Ga.OutlineElementNavigator.he(Nc);Ga.OutlineElementNavigator.ht(Nc,!0,!1)&&(Lb=Ga.OutlineElementNavigator.Le(Nc))&&(Cb=this.Dg.textLength(Lb))}else Cb=this.Dg.textLength(tc.node)-tc.cpEnd;Nc=Object(ya.a)(97,La.rd);if(Nc=!!Nc&&Nc.ja(hi.a.tYf,!1))this.Vsj(b,h,n,ba,la,La,fb,!1,Nc);else{Nc=this.Md.p6a();try{this.Vsj(b,h,n,ba,la,La,fb,!0)}finally{Nc&&Nc.dispose()}}if(L.ooc)Cb=this.f5d(n,L,B),this.Dg.Xb(Cb.Ra.node)&&Zb.a.instance.Ic(Cb);
else{if(B){if(n.Ex){b=$b.length-1;do L=$b[b],b--;while(!L.node.isConnected&&0<=b)}else L=n;if(!this.Dg.Xb(L.node))return;switch(tc.contextId){case oc.a.paragraph:case oc.a.Vc:Cb=Lb&&Lb.isConnected?0:Cb;break;case oc.a.Xc:case oc.a.Bd:break;default:Cb=0}Cb=Oe.SelectionFactory.se(L.node,this.Dg.textLength(L.node)-Cb);L.lk===Cb.Ra.cpBegin&&(Cb.Ra.Fb=L.Fb)}else{Cb=L.Ra.node;if(!this.Dg.Xb(Cb))return;Lb=L.Ra.contextId===oc.a.paragraph?0:L.Ra.contextId===oc.a.Vc?this.Dg.textLength(Cb):L.Ra.cpBegin;Cb=Oe.SelectionFactory.se(Cb,
Lb)}Zb.a.instance.Ic(Cb)}}Vsj(b,h,n,B,L,ba,la,La,fb=!1){n=this.oem(B,n);n=Ti.Vh.sqd(n);({type:Lb}=n.i$d()).returnValue&&(La&&4!==Lb?this.Md.$t(Lb):hn.a.As||(this.Md.Gcb=Lb));for(La=n.length-1;0<=La;--La){var Cb=void 0;var Lb=({Oge:Cb}=n.getContext(La)).returnValue;Cb?(Cb=fb&&Lb.contextId===oc.a.Vc&&La===n.length-1,this.Np.lvb(Lb,2),Cb||Ti.Lj.Ayb(Lb,2)):this.Xsj(b,h,Lb,B,L,ba,la,null)}}oem(b,h){if(Object(Wb.a)(El.a,h)){b=Hy.OutlineElementGeneralizer.Wka(b.gb,!0);for(let n=0;n<b.length;n++)if(b.getContext(n).contextId===
oc.a.table)return b}return h}onm(b,h,n,B,L){b===wb.a.wAa?(b=Uz.a.uJa(h),L=KN.SelectionReferenceFactory.instance.GMb()):(L=null,b=1===n.gb.length?Zb.a.CMb(B):n.Og);return{returnValue:b,gLo:L}}Rkl(b){return!b.Gl||b.contextId!==oc.a.paragraph||!this.Dg.Xb(b.node)||this.Md.Mg||this.mg.Efe(b)?!1:!0}p2j(b){if(b.Ex)for(let h=0;h<b.length;h++)this.p2j(b.getContext(h));else this.Rkl(b)&&(b.node.MUd=!0)}xGj(b){if(b.Ex)for(let h=0;h<b.length;h++)this.xGj(b.getContext(h));else b.Gl&&(b=b.node)&&this.Dg.Xb(b)&&
(b.MUd=!1)}f5d(b,h,n){if(b.Gl&&re.SelectionEditor.mf(b)&&!n){const B=b.node;let L=b.cpBegin,ba=-1;if(({cp:L}=this.mg.jfj(B,L)).returnValue)return Oe.SelectionFactory.se(B,L);if(({cp:L,lra:ba}=this.mg.ifj(b,L,ba)).returnValue)return h=Oe.SelectionFactory.se(B,L),h.Ra.Fb=ba,h.Ra.Tb=ba,h}h=re.SelectionEditor.zVa(h,!n,{jC:!h.ooc||h.ly,Kt:!1,qE:!1,$F:!0,Iza:re.SelectionEditor.Dm(h)});this.mg.vh&&re.SelectionEditor.am(b)&&(h.Ra.Tb=h.Ra.Fb=n?b.Tb:b.Fb);return h}HPl(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b){const tc=
Ti.Wk;!re.SelectionEditor.XA(B.node,B,L)||this.mg.vh&&this.mg.cZi(B)?tc.Yd(()=>{this.lQl(B,L,ba,la,La,fb,Cb,Lb)},"DVS:IPM"):tc.Yd(()=>{const {response:Nc,Z0:dd}=this.kQl(b,h,n,B,L,la,La,fb,Lb,$b);Ti.Dhj(La,32===Nc);dd&&Ti.pva(fb,ba)},"DVS:ISE")}YVm(b,h){h.rd||(h.rd=new Og.DictionaryPropertySet);h.rd.setValue(hi.a.jua,"delete");h.rd.setValue(hi.a.nma,"backspace");var n=Gf.ListItemReader.Of?b:b.sF;const B=Ti.Nd.i3(n),L=iu.Pwn;if(null===L||void 0===L?0:L.xpn(n,B)){h.rd.setValue(hi.a.nma,"backspace-autocorrect");
n=L.$2j+" ";const ba=Nd.a.Tc(b,0);this.rg.Ne(ba,n);b=Oe.SelectionFactory.se(b,n.length);Zb.a.instance.Ic(b);x.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",L.$2j)}return A.AFrameworkApplication.va.lg(h.fEp,B.aC?wb.a.XN:wb.a.WE,2,!1,h.Aca,h.rd)}tVm(b,h,n,B,L){let ba=!1;0<this.Irj.v7(b).Nu&&(L=A.AFrameworkApplication.va.lg(h,wb.a.nvc,2,!1,n,B),ba=!0);return{oX:ba,response:L}}AVm(b,h,n,B,L){let ba=!1;0<this.Irj.pI(b).Nu&&(L=A.AFrameworkApplication.va.lg(h,wb.a.Mkd,2,!1,n,
B),ba=!0);return{oX:ba,response:L}}HWm(b,h,n,B,L){let ba=!1;Ti.Sr.pLb(b)&&(L=A.AFrameworkApplication.va.lg(h,wb.a.OI,2,!1,n,B),ba=!0);return{oX:ba,response:L}}bUm(b,h,n,B,L,ba,la,La,fb,Cb){const Lb=new Ml.a;Lb.hd(h);let $b=!1;if(Ga.OutlineElementNavigator.GMa(Lb,!1,!b,!1)){Cb=!0;fb=32;$b=!0;(new ve.GraphIterator).hd(Lb);Ga.OutlineElementNavigator.Le(Lb);const Nc=Lb.currentNode;ea.ParagraphReader.Wza(Nc)&&ea.ParagraphReader.LKa(Nc).Kye("delete_ip");var tc=new ve.GraphIterator;tc.set(la);(tc=this.Dg.isEmpty(tc))&&
L&&re.SelectionEditor.yba(L.Ra)?(n.ofb(ba),Ga.OutlineElementNavigator.Le(h),Ti.Kf.YDa(h.currentNode)):Nc.NL?(n.ofb(ba),Ga.OutlineElementNavigator.he(Lb),Lb.eh()):b&&tc?this.mg.J0i(la)&&!({Z0:Cb}=this.Rvj(b,la,Nc,L,Cb)).returnValue&&(n.ofb(ba),Ti.rm.eha(h),this.Rei.qeo(la),h.eh()):xh.TableReader.isTable(Lb)?(n.ofb(ba),b&&(qh.moveToFirstRow(Lb),qh.moveToFirstColumn(Lb),Zj.OutlineNavigator.Wba(Lb),Ga.OutlineElementNavigator.Le(Lb),La.Ic((new cI.a(Oe.SelectionFactory.se(Lb.currentNode,0))).restore())),
fb=2,Cb=!1):this.Dg.Xb(Nc)&&(1==this.Dg.textLength(Nc)&&(La=tn.e(Nc),1==La.length&&8==La[0].Jh&&(La=Nd.a.createTextRange(Nc,0,1),this.rg.Ne(La,"",void 0,void 0,wb.a.QTc))),({Z0:Cb}=this.Rvj(b,la,Nc,L,Cb)).returnValue||(B.actionId==wb.a.backspace&&n.qAc(la),this.Rei.IPl(b,n,ba,h,la,Lb)))}return{oX:$b,response:fb,Z0:Cb}}Rvj(b,h,n,B,L){if(this.Md.Mg){if(Ti.Xza){const ba=Object(Wb.a)(Cn.AParagraphNode,n)?Ti.Xza.q$c(n):!1,la=Object(Wb.a)(Cn.AParagraphNode,h)?Ti.Xza.q$c(h):!1;if(ba!==la)return{returnValue:!1,
Z0:L};if(!hn.a.As&&la)return this.mg.vh&&Ti.U9k(h,n,b)&&this.Md.$t(4),{returnValue:!1,Z0:L}}b=b?h:n;if(!Object(Wb.a)(Cn.AParagraphNode,b))return{returnValue:!1,Z0:L};h=b.qa.last;n=A.AFrameworkApplication.userName;if(!h.Xi||h.Xi.authorName!==n)return Ti.Lj.h0b(b,2),B&&(Zb.a.instance.Ic(B),L=!1),{returnValue:!0,Z0:L}}return{returnValue:!1,Z0:L}}QVm(b,h,n,B,L,ba,la,La){xb.OutlineElementReader.Yin(h,b)||({response:la,Z0:La}=Ti.iWl(n,B,b,ba,L,la,La));return{oX:!1,response:la,Z0:La}}kQl(b,h,n,B,L,ba,la,
La,fb,Cb){let Lb=!1,$b=2;const tc=B.node;let Nc=void 0,dd=!1;const Hd=Ti.Wk;if(!L){if(Gf.ListItemReader.Of?Gf.ListItemReader.isListItem(tc):tc.sF)return Hd.Yd(()=>{$b=this.YVm(tc,fb)},"DVS:HLOE"),{response:$b,Z0:Lb};Hd.Yd(()=>{({response:$b,oX:dd}=this.tVm(tc,b,h,n,$b))},"DVS:HIOD");if(dd)return{response:$b,Z0:Lb};Hd.Yd(()=>{({response:$b,oX:dd}=this.AVm(tc,b,h,n,$b))},"DVS:HWPF");if(dd)return{response:$b,Z0:Lb};Nc=this.aBi(tc);Hd.Yd(()=>{({response:$b,oX:dd}=this.HWm(Nc,b,h,n,$b))},"DVS:HPOB");if(dd)return{response:$b,
Z0:Lb}}null!==Nc&&void 0!==Nc?Nc:Nc=this.aBi(tc);Hd.Yd(()=>{({response:$b,oX:dd,Z0:Lb}=this.bUm(L,Nc,la,fb,Cb,B,tc,La,$b,Lb))},"DVS:HAOE");if(dd)return{response:$b,Z0:Lb};Hd.Yd(()=>{({response:$b,oX:dd,Z0:Lb}=this.QVm(L,Nc,h,n,la,ba,$b,Lb))},"DVS:HFLOE");return{response:$b,Z0:Lb}}D1o(b){return re.SelectionEditor.am(b)||this.fJ.$3i(b)||re.SelectionEditor.ega(b)}u1o(b,h){return b&&b.hasProperty(zd.a.EZc)?!b.ja(zd.a.EZc,!1):!h}static get Nd(){return null!=Ti.o1g?Ti.o1g:Ti.o1g=Ya.a.instance.resolve("Box4.List.IListReader")}static get rm(){return null!=
Ti.e1g?Ti.e1g:Ti.e1g=Ya.a.instance.resolve("Box4.List.IListEditor")}static get Kf(){return null!=Ti.i2g?Ti.i2g:Ti.i2g=Ya.a.instance.resolve("Box4.IOutlineElementEditor")}static get Sr(){return Hv.a.oQb}static get Lj(){return null!=Ti.Y5g?Ti.Y5g:Ti.Y5g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Vh(){return null!=Ti.F6g?Ti.F6g:Ti.F6g=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Ec(){return Yc.a.instance}static get ika(){Ti.LDb||
(Ti.LDb=Ya.a.instance.Qa("Box4.ContentControl.IContentControlOperator"));return Ti.LDb.instance}static get iU(){Ti.dGf||(Ti.dGf=Ya.a.instance.Qa("Box4.IFieldEditor"));return Ti.dGf.instance}static get Xza(){return null!=Ti.$Ug?Ti.$Ug:Ti.$Ug=Ya.a.instance.Oa("Box4.IContentControlReader")}static get Wk(){return Rn.a.instance}V$l(b){if(1===b.gb.length&&(b=b.gb.J(0),re.SelectionEditor.Dm(b))){var h=b.Ra;b=h.node;h=h.cpBegin;var n=this.Dg.text(b);h<n.length&&0<h&&" "===n.charAt(h-1)&&" "===n.charAt(h)&&
this.rg.Ne(Nd.a.createTextRange(b,h-1,h),"\u00a0")}}vbl(b,h){if(!h.hyperlink.htb){const n=new Sd.GraphTransaction(15);try{n.Ab(b.node),this.t3.hV(b,h)}finally{n&&n.dispose()}h.hyperlink.wI&&this.Md.$t(2)}}static iWl(b,h,n,B,L,ba,la){if(n=re.SelectionEditor.zVa(B,!n,{jC:!1,Kt:!1,qE:!1,$F:!0})){B=Oe.SelectionFactory.$y(B,n.Ra);ba=32;for(n=0;n<B.length;++n){L.ofb(B.J(n));const La=A.AFrameworkApplication.va.lg(B.J(n),wb.a.SJ,2,!0,b,h);2!==La&&(ba=La)}32===ba&&(la=!0)}return{response:ba,Z0:la}}nVl(b,h,
n,B,L,ba,la){let La=!1;this.E1o(b)?(La=Ti.ryf(b,!0,h,n,B,L))&&Ti.IPa(ba,h,la):this.D1o(b)?(La=Ti.ryf(b,!1,h,n,B,L))&&Ti.IPa(ba,h,la):(B.normalize(),Ti.IPa(ba,h,la));return La}static IPa(b,h,n){n&&n.pva()||Ti.pva(h,b)}static ryf(b,h,n,B,L,ba){var la;B||pl.OutlineReader.IXa(b)||(n=Ti.Xsd(n))&&L.NYo(n);A.AFrameworkApplication.Ld("b1jb9393;09icj321");if(null===(la=A.AFrameworkApplication.K)||void 0===la?0:la.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))ba.rd?ba.rd.cud=
ba.cud:ba.rd={cud:ba.cud};la=b instanceof El.a?b.getContext(0).node:b.node;la=Ti.kDm(la);b=32===A.AFrameworkApplication.va.lg(b,ba.actionId,2,h,ba.Aca,ba.rd);Ti.Dhj(L,b,la);return b}static get km(){return null!=Ti.aYg?Ti.aYg:Ti.aYg=Ya.a.instance.resolve("Box4.IFormattingEditor")}static get a0a(){return null!=Ti.G4g?Ti.G4g:Ti.G4g=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}static kDm(b){const h=new Yj.a;if(b){let n=null;b=Oe.SelectionFactory.pp(b,!0);if(!b)x.ULS.sendTraceTag(509645905,315,
10,"Unexpected null selection.");else for(let B=0;B<b.length;B++)if(Va.FormattingReader.Lrf(b.J(B))){n=b.J(B);break}n&&((b=Va.FormattingReader.Cs(n))&&b.cache&&b.cache.sD&&(b=b.Bf(null),Ti.km.F8(b)),b&&(h.formatting=b.Dk,h.languageId=Va.FormattingReader.language(b)),h.uoa=Ti.a0a.Eq(n.node))}return h}static Dhj(b,h,n){h?b.normalize(n):b.cancel()}static pva(b,h){h&&Ti.Wk.Yd(()=>{const n=h.restore();n&&b.Ic(n)},"DVS:RS")}lQl(b,h,n,B,L,ba,la,La){let fb;!h&&({hyperlink:fb}=this.t3.zoc(b)).returnValue?
(n=new cI.a(B),this.vbl(b,fb),L.normalize(),Ti.pva(ba,n)):Ti.ryf(b,!1,ba,la,L,La)&&(h&&this.Md.Mg?(h=Ti.Lj.yYd)?(ba.Ic(Oe.SelectionFactory.se(b.node,h)),Ti.Lj.yYd=null):Ti.pva(ba,n):Ti.pva(ba,n))}static U9k(b,h,n){n?(n=b,b=h):n=h;h=Ti.Xza.Voc(n,!1);b=Ti.Xza.Voc(b,!0);return!(h&&b)}E1o(b){return b.Ex||pl.OutlineReader.IXa(b)||this.Dg.nn(b)}static Xsd(b){return(b=Hy.OutlineElementGeneralizer.Wka(b.gb,!0))&&1===b.length&&(b=b.getContext(0).node,xh.TableReader.HU(b))?b:null}aBi(b){const h=new ve.GraphIterator;
h.set(b);h.Jd();Ga.OutlineElementNavigator.he(h);return h}}Ti.LDb=null;Ti.dGf=null;Object(u.a)(Ti,"ADeleteViewStrategy",null,[]);class wv{IPl(b,h,n,B,L,ba){const la=ba.currentNode;Ga.OutlineElementNavigator.he(ba);b?(h.qAc(ba.currentNode),wv.mg.p_i(n,L,la,!1)||wv.Kf.merge(B,ba,!1,!1)):wv.mg.p_i(n,la,L,!0)||wv.Kf.merge(ba,B,!1,!1)}qeo(b){b&&ea.ParagraphReader.Xb(b)&&(Ch.a.Gkd(b),wv.QYl.rhf(b))}static get Kf(){return null!=wv.e2g?wv.e2g:wv.e2g=Ya.a.instance.resolve("Box4.IOutlineElementEditor")}static get QYl(){return null!=
wv.NVg?wv.NVg:wv.NVg=Ya.a.instance.resolve("Box4.IDynamicRangeEditor")}static get mg(){return Pd.a.instance}}Object(u.a)(wv,"DeleteParagraphNodeStrategy",null,[461]);class PL extends Ti{constructor(b,h,n,B,L,ba,la,La,fb){super(new wv,b,h,n,B,L,ba,la,La,fb)}}Object(u.a)(PL,"DeleteViewStrategy",Ti,[]);class $B extends gr{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b){super();this.deleteParagraph=(tc,Nc)=>{tc=Nc.node;Ch.a.Gkd(tc);this.oRe.rhf(tc);this.zp&&this.zp.instance&&this.zp.instance.Fmj(tc);tc.gv&&
(this.Wm.Nwo(tc,!this.vh),this.vh&&this.sjh.instance&&this.sjh.instance.I6j(tc));return 0};this.GPl=(tc,Nc,dd)=>{if(1===dd)return 32;tc=Ua.StaticActiveAppFrame.za().hs.Vf("ModelUpdate","DeleteAnchoredObject");Nc=Nc.node;dd=new ve.GraphIterator;dd.set(Nc);dd.zb(12);var Hd=dd.yp(12);if(Pd.a.instance.o$c(Hd))return 2;we.StaticTheCoauthManager.NJb(Hd);Hd=new Sd.GraphTransaction(7);Hd.Ab(Nc);dd.eh();Hd.dispose();tc.stop();return 32};this.jtk=new sw;this.ktk=new PL(Pd.a.instance,NL.a.instance,ba,la,La,
fb,Cb,Lb,$b);this.Wm=b;this.bIc=h;this.sjh=n;this.oRe=B;this.zp=L}get vh(){return this.bIc.instance?this.bIc.instance.vh:!1}get $ei(){return this.ktk}get Pei(){return this.jtk}erg(b,h,n,B){const L=HJ.XQl,ba=this.GPl;b.ra(wb.a.backspace,oc.a.caa,ba);b.ra(wb.a.backspace,oc.a.yPa,L);b.ra(wb.a.SJ,oc.a.caa,ba);b.ra(wb.a.SJ,oc.a.yPa,L);b.ra(wb.a.backspace,oc.a.paragraph,this.deleteParagraph);b.ra(wb.a.SJ,oc.a.paragraph,this.deleteParagraph);b.ra(wb.a.wAa,oc.a.paragraph,this.deleteParagraph);b.Rc(wb.a.wAa,
64);super.erg(b,h,n,B)}static NJb(b){var h;(null===(h=we.StaticTheCoauthManager.ud())||void 0===h?0:h.Jo)&&we.StaticTheCoauthManager.ud().Ak.yG(b)}}Object(u.a)($B,"DeleteActor",gr,[]);var mO=d(477);class DI{constructor(){this.Height=this.Width=0}static construct(b,h){const n=new DI;n.Width=b;n.Height=h;return n}}Object(u.a)(DI,"ViewportInfo",null,[]);class WF extends Ys.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=
this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}lm(){return mO.a.ufp}static construct(b,h,n,B,L,ba,la,La,fb,Cb,Lb){const $b=new WF;$b.ContractVersion=b;$b.DocumentContent=h;$b.EnhancementId=n;$b.World=B;$b.ScalingFactor=L;$b.DesktopViewportInfo=DI.construct(ba,la);$b.MobileViewportInfo=DI.construct(La,fb);$b.MinParagraphCount=Cb;$b.ContentCulture=Lb;return $b}}Object(u.a)(WF,"SwayPreviewRequest",Ys.a,[]);var MN=d(640);class AA{static get kh(){A.AFrameworkApplication.Ld("wwa11yq3;wwa11yq3cf");
return Ge.a.az($e.App.instance&&$e.App.instance.z4i?AA.dTl:AA.Mn,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,AA.eKo,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}AA.eKo=sk.a.ki("progress.gif");AA.Mn="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
AA.dTl="<div class='WACDialogRow digitalPrintDialogWrapper digitalPrintDialogWrapperResize UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper swayGalleryWrapperResize' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper swayPreviewWrapperResize' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(u.a)(AA,"DigitalPrintDialogHtml",null,[]);class vu{constructor(b,h,n,B){this.fontFamily=b;this.LGo=h;this.fontWeight=n;this.fontStyle=B}}Object(u.a)(vu,"FontInfo",null,[]);class hr{constructor(b,h,n,B){this.styleName=b;this.title=h;this.ikp=n;this.I_m=B}}Object(u.a)(hr,"StyleVisualInfo",null,[]);class aC extends Ge.a{constructor(b,h,n,B,L=!0){super();this.d$=this.Nm=this.Mpa=this.Y5=this.cDd=this.iHh=this.aOd=this.T$e=this.U$e=this.l$e=this.Nac=this.hTa=this.m6=this.gac=null;this.Ecf=this.u6e=
!1;this.SBd=null;this.pXl=()=>{this.BJj(0)};this.oXl=(ba,la)=>{this.BJj(la)};this.Voj=ba=>{this.dBi(ba)===Sys.UI.Key.enter&&(this.ohg(ba),ba.preventDefault(),ba.stopPropagation())};this.dlj=ba=>{((ba=ba.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===ba.id||ba.id===xf.a.zwd)||X.a.Mt)&&this.hTa&&this.K_b(this.hTa)};this.elj=ba=>{const la=this.dBi(ba);la!==Sys.UI.Key.tab&&la!==Sys.UI.Key.left&&la!==Sys.UI.Key.right&&la!==Sys.UI.Key.up&&la!==Sys.UI.Key.down||this.lXm(la)||(ba.preventDefault(),
ba.stopPropagation(),this.eYn(la))};this.rfg=()=>{this.Ecf||(this.Ecf=!0,x.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),Nb.a.removeHandler(this.m6,Cd.a.scroll,this.rfg))};this.Yfg=()=>{x.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.ohg=ba=>{ba.preventDefault();ba.stopPropagation();A.AFrameworkApplication.va.Ob(wb.a.sgi,2);ba.target?(ba="button"===ba.target.tagName.toLowerCase()?ba.target:ba.target.parentNode)&&ba.id!==this.gac&&(x.ULS.sendTraceTag(25231813,382,
50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.gac,ba.id),this.h1h(ba),this.Qai()):x.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.MTl=ba=>{const la=(new Date).getTime()-this.Xeh;pi.a.instance.uf(ze.a.OTl,la);ba?this.VOo():(x.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),A.AFrameworkApplication.va.Ob(wb.a.rgi,2))};this.TOo=()=>
{this.c8o();try{const ba=aC.Thi.h5l(),la=WF.construct(2,ba,this.gac,"VerticalWorld",.3,1366,600,330,280,20,aC.Thi.Chb.name);A.AFrameworkApplication.Be.Ij(String.format("{0}/we/GetSwayPreview.ashx?{1}",$e.App.webServiceBase,A.AFrameworkApplication.rootQuerySignature),2,MN.b(la),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.zfo,this.gvj,la)}catch(ba){x.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",ba.message)}};this.zfo=
ba=>{var la=null;({group:la}=ii.a.R4(ba.data.De)).returnValue?(la=la.Responses[0],la.Succeeded?(this.Vie(ba.data,ze.a.vfp),this.onb(),this.mPj(this.T$e,la.PreviewHtml),this.mPj(this.aOd,la.PreviewHtmlMobile)):this.gvj(null)):x.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.gvj=()=>{this.d8o();this.U$e.style.background="#E6E6E6";this.iHh.style.background="#E6E6E6"};this.kh=AA.kh;this.Qg="DigitalPrintDialog";x.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.WJk=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.j6b=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.oPk=n;this.zHc=B;this.Pe(1,this.WJk);this.pi(this.j6b,this.MTl,null);this.O6m();this.cep();this.Xeh=(new Date).getTime();L&&Qw.a.mU(zA.a.Vxf,!1,this.pXl,this.oXl,null);this.c8m();this.m5m();this.jAn();this.J5f();this.aAn();this.Qai()}get aBa(){return this.SBd}BJj(b){if(!this.u6e){const h=
(new Date).getTime()-this.Xeh;pi.a.instance.uf(ze.a.NTl,h);b?x.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",Op.a[b])):x.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.x6a.disabled=!1}}O6m(){this.Nac=document.getElementById("digitalPrintStatusMessageDiv");this.l$e=document.getElementById("digitalPrintStatusMessageIconDiv");this.U$e=document.getElementById("swayDesktopPreviewWrapperDiv");
this.T$e=document.getElementById("swayDesktopPreviewHtmlHolder");this.aOd=document.getElementById("swayMobilePreviewHtmlHolder");this.iHh=document.getElementById("swayMobilePreviewWrapperDiv");this.m6=document.getElementById("swayGallery");this.m6.setAttribute("tabindex","0");Nb.a.addHandler(this.m6,Cd.a.scroll,this.rfg);this.m6.setAttribute(Bc.a.Ph,Bc.a.IUh);this.Y5=document.getElementById("digitalPrintLearnMoreLink");this.Y5.href="https://go.microsoft.com/fwlink/?linkid=871972";Nb.a.addHandler(this.Y5,
Cd.a.click,this.Yfg);this.Mpa=new ob.a;this.cDd=document.getElementById("homeWrapper");this.L8("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.zHc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}c8m(){this.Nm=new ob.a;this.Nm.add(new hr("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.Nm.add(new hr("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.Nm.add(new hr("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.Nm.add(new hr("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.Nm.add(new hr("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.Nm.add(new hr("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.Nm.add(new hr("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.Nm.add(new hr("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.Nm.add(new hr("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.Nm.add(new hr("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.Nm.add(new hr("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.Nm.add(new hr("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.Nm.add(new hr("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.Nm.add(new hr("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.Nm.add(new hr("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.Nm.add(new hr("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.Nm.add(new hr("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.Nm.add(new hr("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.Nm.add(new hr("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.Nm.add(new hr("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.Nm.add(new hr("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.Nm.add(new hr("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}m5m(){this.d$=
new ob.a;this.d$.add(new vu("universc","universc","normal","normal"));this.d$.add(new vu("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.d$.add(new vu("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.d$.add(new vu("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.d$.add(new vu("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.d$.add(new vu("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.d$.add(new vu("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.d$.add(new vu("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.d$.add(new vu("ArialNova","ArialNova","normal","normal"));this.d$.add(new vu("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.d$.add(new vu("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.d$.add(new vu("RockwellNova","RockwellNova","normal","normal"));
this.d$.add(new vu("SabonNRegLT","SabonNRegLT","normal","normal"));this.d$.add(new vu("DaytonaThin","DaytonaThin","100","normal"))}jAn(){const b=document.createElement("style");b.setAttribute("type","text/css");let h="";for(const n of this.d$)h+=String.format(this.oPk,n.fontFamily,n.LGo,n.fontWeight,n.fontStyle);b.innerText=h;this.cDd.appendChild(b)}aAn(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
sk.a.ki("SwayPreviewFrame.svg")),n=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",sk.a.ki("SwayPreviewFrameHC.svg"));b.innerText=h+n;X.a.Vr&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.cDd.appendChild(b)}dBi(b){return b?b.keyCode:window.event.keyCode}hide(){this.Trg();super.hide()}Trg(){if(this.m6&&!this.u6e){for(let b=0;b<this.Mpa.count;b++)Nb.a.removeHandler(this.Mpa.J(b),
Cd.a.click,this.ohg),Nb.a.removeHandler(this.Mpa.J(b),Cd.a.Ti,this.Voj);Nb.a.removeHandler(this.m6,Cd.a.Ti,this.elj);Nb.a.removeHandler(this.m6,Cd.a.focus,this.dlj);Nb.a.removeHandler(this.Y5,Cd.a.click,this.Yfg);this.Ecf||Nb.a.removeHandler(this.m6,Cd.a.scroll,this.rfg);this.u6e=!0}}J5f(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",sk.a.uel());this.cDd.appendChild(b);for(const h of this.Nm)this.Ztf(this.m6,h);this.v4(this.m6);
this.h1h(this.m6.firstChild);this.m6.firstChild.focus();Nb.a.addHandler(this.m6,Cd.a.Ti,this.elj);Nb.a.addHandler(this.m6,Cd.a.focus,this.dlj)}Ztf(b,h){const n=document.createElement("button");n.className="swayGalleryItem swayClip136x90 swayImageBorderButton";n.setAttribute(Bc.a.wmb,Bc.a.PO);n.setAttribute("title",h.title);n.setAttribute(Bc.a.Ph,Bc.a.LUh);n.id=h.styleName;b.appendChild(n);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);
b.src=sk.a.ki("swayPublish.png");b.setAttribute(Bc.a.Ph,Bc.a.BA);b.setAttribute("unselectable","on");b.setAttribute(Bc.a.JB,Bc.a.hq);b.id=h.styleName+"img";n.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.ikp;b.setAttribute(Bc.a.JB,Bc.a.hq);b.setAttribute("unselectable","on");b.setAttribute(Bc.a.Ph,Bc.a.BA);n.appendChild(b);const B=document.createElement("label");B.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;B.className=h.I_m;B.setAttribute(Bc.a.JB,
Bc.a.hq);b.setAttribute("unselectable","on");B.setAttribute(Bc.a.Ph,Bc.a.BA);n.appendChild(B);Nb.a.addHandler(n,Cd.a.click,this.ohg);Nb.a.addHandler(n,Cd.a.Ti,this.Voj);this.Mpa.add(n)}eYn(b){const h=this.aBa;this.sbm(b,h,!A.AFrameworkApplication.isRtl)||this.ubm(b,h,!A.AFrameworkApplication.isRtl)||this.pbm(b,h)||this.qbm(b,h)}lXm(b){return b===Sys.UI.Key.tab?(this.aBa&&this.aBa!==this.hTa&&(this.aBa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.SBd=this.hTa),!0):!1}sbm(b,
h,n){return b===Sys.UI.Key.right&&n||b===Sys.UI.Key.left&&!n?(b=(b=h.nextSibling)||this.m6.firstChild,this.K_b(b),!0):!1}ubm(b,h,n){return b===Sys.UI.Key.left&&n||b===Sys.UI.Key.right&&!n?(b=(b=h.previousSibling)||this.m6.lastChild,this.K_b(b),!0):!1}pbm(b,h){return b===Sys.UI.Key.down?(b=this.Mpa.indexOf(h),h=b+2,h<this.Mpa.count?(b=this.Mpa.J(h))&&this.K_b(b):(h=b%2+1,h=2<=h?0:h,(b=this.Mpa.J(h))&&this.K_b(b)),!0):!1}qbm(b,h){b===Sys.UI.Key.up&&(b=this.Mpa.indexOf(h),h=b-2,0<=h?(b=this.Mpa.J(h))&&
this.K_b(b):(h=b?20+b-1:this.Mpa.count-1,(b=this.Mpa.J(h))&&this.K_b(b)))}K_b(b){this.aBa&&this.aBa.id!==this.hTa.id&&(this.aBa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.SBd=b;this.aBa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.aBa.focus()}cep(){this.x6a.className="WACDialogButtonNormal swayPrintToWebButton";this.x6a.setAttribute("tabindex","0");this.qB.className="WACDialogButtonNormal swayCancelButton";
this.qB.setAttribute("tabindex","0");this.x6a.disabled=!0}h1h(b){this.aBa&&(this.aBa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.hTa&&(this.hTa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.hTa.setAttribute(Bc.a.wmb,Bc.a.PO));this.gac=b.id;this.hTa=b;this.hTa.setAttribute(Bc.a.wmb,Bc.a.hq);this.SBd=b;this.aBa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}Qai(){ph.a.instance.Zb(new Re.a(2,
1,50,this.TOo))}mPj(b,h){b.innerHTML=h}VOo(){x.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.gac));A.AFrameworkApplication.va.Ob(wb.a.tgi,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",$e.App.webServiceBase,A.AFrameworkApplication.rootQuerySignature,A.AFrameworkApplication.userSessionId,this.gac);$c.a.openWindow(4,b)}Vie(b,h){pi.a.instance.uf(h,+b.YO-+b.bH)}d8o(){var b=WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;
this.onb();this.Nac.innerText=b;this.Nac.style.display="block"}c8o(){this.onb();this.l$e.style.display="block";this.Nac.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.Nac.style.display="block"}onb(){this.U$e.style.background="";this.aOd.style.background="";Lh.a.PT(this.T$e);Lh.a.PT(this.aOd);this.Nac.style.display="none";this.l$e.style.display="none"}static get Thi(){return null!=aC.JVg?aC.JVg:aC.JVg=Ya.a.instance.Oa("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}
Object(u.a)(aC,"DigitalPrintDialog",Ge.a,[]);class IJ{constructor(b,h){this._context=this.kl=null;this.bNe=0;this.byd=!1;this.ZFh=null;this.Vxf=(n,B,L,ba,la)=>{if(1===L)return A.AFrameworkApplication.lH?8:32;this.ZFh=la.SourceControlId;if(A.AFrameworkApplication.K.$("IsAnonymousUser"))return x.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),this.fyc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=
B;if(IJ.wmn())return x.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.vtf(),32;switch(this.bNe){case 1:x.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.vtf();break;case 2:x.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");this.fyc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);
break;case 0:this.byd=!1,this.kl=(new yl.a).create(),this.kl.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.kl.lM(CommonUIStrings.l_DefaultDialogTitle,this.Hpl,null),A.AFrameworkApplication.Be.Ij(String.format("{0}/we/CheckSwayLicense.ashx?{1}",$e.App.webServiceBase,A.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.Jpl,this.Ipl,null)}return 32};this.Hpl=()=>{this.byd=!0;x.ULS.sendTraceTag(34373831,382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};
this.Jpl=n=>{if(!this.byd){this.kl.close();var B=null;this.Vie(n.data,ze.a.tfp);({group:B}=ii.a.R4(n.data.De)).returnValue?(n=B.Responses[0],x.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",n.HasLicense,n.Succeeded),n.Succeeded?(this.bNe=n.HasLicense?1:2,2===this.bNe?this.fyc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):this.vtf()):this.fyc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):
(x.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.fyc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.Ipl=n=>{this.byd||(this.kl.close(),x.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.Vie(n.data,ze.a.sfp),this.fyc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};this.ga=b;this.S9=h}Wb(){A.AFrameworkApplication.O0?
x.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):A.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&A.AFrameworkApplication.K.$("DisablePrint")?x.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.fb(wb.a.mZc,oc.a.view,this.Vxf,4),this.ga.fb(wb.a.sgi,oc.a.view,Ce.ActionManager.gU,4),this.ga.fb(wb.a.tgi,oc.a.view,Ce.ActionManager.gU,4),this.ga.fb(wb.a.rgi,oc.a.view,Ce.ActionManager.gU,4),
this.ga.fb(Pa.a.O_d,oc.a.view,Ce.ActionManager.gU,4))}vtf(){x.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.ZFh);new aC(this._context,this.ga,A.AFrameworkApplication.K.kb("SwayFontDownloadUrlTemplate"),A.AFrameworkApplication.K.kb("FileSource"))}fyc(b){const h=new ui.StandardDialog;h.Gd=0;h.Nna(CommonUIStrings.l_DefaultDialogTitle,b,null)}Vie(b,h){pi.a.instance.uf(h,+b.YO-+b.bH)}static wmn(){return"OneDriveWOPI"===
A.AFrameworkApplication.K.kb("FileSource")}}Object(u.a)(IJ,"DigitalPrintActor",null,[]);class dI{constructor(){this.cJh=null}xaj(){x.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}x4j(b){if(!b)return x.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.k4i(b.errorDetails))return!1;this.cJh=Object(ya.a)(pq.a,b.errorDetails).typeId;return!0}ppd(b){return this.k4i(b)?Object(ya.a)(pq.a,b).typeId===this.cJh:!1}k4i(b){if(!b)return x.ULS.sendTraceTag(25007843,
375,15,"No ErrorDetails found"),!1;b=Object(ya.a)(pq.a,b);return b?b.token&&b.typeId?!0:(x.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(x.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(u.a)(dI,"DoNotCheckThisCritiqueTypeStrategy",null,[430]);class eI extends Ge.a{constructor(b,h,n){super(!1,!1,!0);this.Sb=b;this.tsa=n;this.Ttk="DocumentChoiceGroup";this.ygh="EmbededContent";this.cmh="HyperLink";this.h_e=n.qhb;b={["id"]:"ExternalContentDefaultSettingsDialog",
["bodyControls"]:this.h2c()};this.spk=this.O4l.bind(this);this.Pe(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.pi(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.spk,b)}h2c(){const b=Array(2);b[0]={["key"]:this.ygh,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.cmh,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};const h={};h.documentChoiceGroupProps=
{["id"]:this.Ttk,["defaultSelectedKey"]:this.h_e?this.ygh:this.cmh,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return h}O4l(b,h){1===b?(this.h_e!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?Dc.a.vVa:Dc.a.wpb,this.Sb.Ob(b,2),this.h_e=h.isExternalContentSelected,aa.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new ia.a,{name:"ActionId",int64:b})]}))),this.tsa.EKo(h.isExternalContentSelected)):0===b&&x.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}Object(u.a)(eI,
"ExternalContentDefaultSettingsDialog",Ge.a,[]);class Sq{constructor(b,h,n,B,L){this.kO=Ya.a.instance.resolve("Common.IReactContextualUILauncher");this.KBb=$g.a.On;this.ayc=()=>{const ba=Array(1);ba.push("ExternalContent");var la=Ya.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").bWa();la=Object.assign(new MH.a,{x:la.x,y:la.y});this.kO.showFloatie(la,ba,1);return 32};this.wRb=()=>{this.kO.D3&&this.kO.dismissFloatie();return 32};this.axj=(ba,la,La,fb,Cb)=>{if(la="object"===
typeof Cb?Cb:null)ba===Dc.a.Aog?(ba=Sq.s3a!==Dc.a.vVa&&Sq.s3a!==Dc.a.wpb,la[this.KBb]=Sq.s3a===Dc.a.vVa||ba):ba===Dc.a.Bog&&(la[this.KBb]=Sq.s3a===Dc.a.wpb);return 32};this.Kmi=(ba,la,La)=>{1!==La&&(ba===Dc.a.wpb&&Sq.s3a!==Dc.a.wpb?(x.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.Fn.undo()&&(la=new Jw.a(1,A.AFrameworkApplication.isRtl),la.ihd="ExternalContent",Sq.vpb.Gjd(la))):ba===Dc.a.vVa&&Sq.s3a!==Dc.a.vVa&&(x.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),
A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.rhh.Ayj()),Sq.s3a=ba);aa.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new ia.a,{name:"behavior",string:La.toString()}),Object.assign(new ia.a,{name:"ActionId",int64:ba})]}));return 32};this.ga=b;this.Fn=h;this.rhh=B;this.lAk=L;this.rpk=this.P4l.bind(this);A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.rhh.tAj(()=>{this.reset()})}Wb(){this.ga.fb(Dc.a.Aog,oc.a.view,this.axj,97);this.ga.fb(Dc.a.Bog,oc.a.view,this.axj,97);this.ga.fb(Dc.a.Jmi,oc.a.view,this.rpk,1028);this.ga.fb(Dc.a.vVa,oc.a.view,this.Kmi,1028);this.ga.fb(Dc.a.wpb,oc.a.view,this.Kmi,1028);this.lAk||(this.ga.fb(Dc.a.ayc,oc.a.view,this.ayc,96),this.ga.fb(Dc.a.wRb,oc.a.view,this.wRb,96))}p6o(b){new eI(this.ga,b,Sq.tsa)}P4l(b,h,n){1!==n&&this.p6o(Sq.s3a);return 32}static get vpb(){return null!=Sq.eWg?Sq.eWg:Sq.eWg=Ya.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get tsa(){Sq.uGa||
(Sq.uGa=Ya.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Sq.uGa}reset(){Sq.s3a=null!=Sq.tsa?Sq.tsa.qhb?Dc.a.vVa:Dc.a.wpb:Dc.a.vVa}}Sq.s3a=Dc.a.vVa;Sq.uGa=null;Object(u.a)(Sq,"ExternalContentActor",null,[]);class bC extends zs{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc){super(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b);this.D8c=tc;this.l2d=!1;this.Dnh=null}ikd(){this.l2d||(super.ikd(),this.l2d=!0)}MEe(){this.l2d&&(super.MEe(),bC.Xii&&this.Dnh&&bC.Xii.removeHandler(bD.a.qIa,
this.Dnh),this.l2d=!1)}s2b(){if(this.D8c){this.Zza.D3&&this.Zza.dismissFloatie();const b=new Jw.a(0,A.AFrameworkApplication.isRtl);b.location=this.Dcb.bWa();this.showFloatie(null,b)}else this.Zza.D3&&A.AFrameworkApplication.va.Ob(Dc.a.wRb,2),A.AFrameworkApplication.va.Ob(Dc.a.ayc,2);this.Fpc=!1}dismissFloatie(b){!this.VXe&&(b&&(this.Dcb.OWf(),this.y5j()),this.Zza.D3||this.VRa)&&(this.VRa=!b,this.MEe(),this.D8c?this.Zza.dismissFloatie():A.AFrameworkApplication.va.Ob(Dc.a.wRb,2))}showFloatie(b,h){h||
(h=new Jw.a(0,A.AFrameworkApplication.isRtl));h.location||(h.location=this.Dcb.bWa());if(!h.location)return!1;this.VRa&&(this.VRa=!1,this.ikd());this.D8c?(b=Array(1),b.push("ExternalContent"),this.Zza.showFloatie(this.Dcb.bWa(),b,1)):A.AFrameworkApplication.va.Ob(Dc.a.ayc,2);return!0}zYc(){if(!this.Fpc){const b=new Re.a(3,1,this.cdi,()=>{this.s2b()},196);ph.a.instance.Zb(b);this.Fpc=!0}}qna(){this.D8c?this.Zza.D3&&this.Zza.dismissFloatie():A.AFrameworkApplication.va.Ob(Dc.a.wRb,2);this.zYc()}m_b(){this.D8c?
this.Zza.D3&&this.Zza.dismissFloatie():A.AFrameworkApplication.va.Ob(Dc.a.wRb,2);this.zYc()}static get Xii(){return null!=bC.PVg?bC.PVg:bC.PVg=Ya.a.instance.resolve("Box4.IEditStateEventManager")}}Object(u.a)(bC,"ExternalContentFloatieEventManager",zs,[]);class BA extends Rv{constructor(b,h,n,B,L){super(b,h,n,B,L)}UZh(){if(!this.hb||!this.hb.gb||!this.hb.gb.currentSelection)return x.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;
var b=this.hb.gb.currentSelection.Ra,h=!b.cpBegin&&!b.cpEnd;let n=b.node;if(n&&h&&!n.NL){do n=this.hFi(n);while(n&&!n.NL&&Object(Wb.a)(Cn.AParagraphNode,n)&&!n.characterData.trim().length)}let B="";const L=Object(ya.a)(Cn.AParagraphNode,n);L&&(B=L.characterData.length===b.cpBegin||h?L.characterData.trimEnd():L.characterData.substring(0,b.cpBegin).trimEnd());h=L?B.length:b.cpBegin;b=Object.assign(new XA,{BDa:Object(ya.a)(120,(L?Object(ya.a)(120,L):Object(ya.a)(120,n))||b.node),Ntc:h});return this.gKf(b)}Xzi(b,
h){let n=null;const B=Object(ya.a)(169,b.BDa.nl(h.oc));if(!B)return null;if(Object(Wb.a)(Cn.AParagraphNode,b.BDa)){const L=Object(ya.a)(Cn.AParagraphNode,b.BDa);if(L.ZT){if(b=Object(ya.a)(yx.a,ea.ParagraphReader.LKa(L)))(b=Object(ya.a)(169,b.nl(h.oc)))&&(n=b.getBounds()),n&&(n.height+=BA.Spi,n.width-=BA.Jam);return n}h=Object(ya.a)(88,B);if(!h)return null;try{if(n=this.Kya.F2(b.Ntc,h,0<b.Ntc,!1,!1,!1))n.height+=BA.Spi}catch(ba){x.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",
ba),n=null}}n||(n=B.getBounds());return n}}BA.Spi=65;BA.Jam=100;Object(u.a)(BA,"ExternalContentFloatiePositionProvider",Rv,[]);class CA{constructor(b,h,n,B,L,ba){this.uug=(la,La,fb)=>{if(1===fb)return A.AFrameworkApplication.O0||A.AFrameworkApplication.lH||A.AFrameworkApplication.Lta||hc.SessionStatusManager.instance.Gk?8:32;if(la===wb.a.print)la=1;else if(la===Dc.a.OZc)la=0;else if(la===Dc.a.F0d)la=2;else return 8;return this.oKo(la)};this.ga=b;this.S9=h;this.Z6b=n;this.Ctk=B;this.kfh=L;this.Hpk=
ba}Wb(){A.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&this.Ctk||A.AFrameworkApplication.lH?(document.body.classList.add("WACStopPrinting"),""!==this.kfh&&this.Hpk.Q6o(this.kfh)):(this.ga.ra(wb.a.print,oc.a.application,this.uug),this.ga.ra(Dc.a.OZc,oc.a.application,this.uug),this.ga.ra(Dc.a.F0d,oc.a.application,this.uug))}oKo(b){const h=A.AFrameworkApplication.rootQuerySignature;if(!h||""===h||we.StaticTheCoauthManager.ud()&&we.StaticTheCoauthManager.ud().qC.Ko)return 8;this.Z6b.wde=!1;
this.Z6b.hbk.start();Qw.a.mU(zA.a.PAl,!0,Object(z.a)(this.Z6b,this.Z6b.yEo,"requestFileDownload"),Object(z.a)(this.Z6b,this.Z6b.AWb,"onForceSaveFailed"),b);return 32}}Object(u.a)(CA,"FileDownloadActor",null,[]);class QL extends vd{constructor(b,h=null,n=null){super(b,!0,h,!1,void 0,n)}get ZTf(){return null}get Hbb(){return this.Vde?CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkText_EditPermissions:A.AFrameworkApplication.O7a?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get Gqc(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get cSd(){return null}get Vde(){return"VersionHistory"===
this.r_h?!1:A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfCopyLinkEnabled",!1)}Jie(){x.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed");A.AFrameworkApplication.yga("tcopypdf;ccopypdf")}}Object(u.a)(QL,"DownloadAsPdfDialog",vd,[]);class cs{constructor(){this._url=this.tw=null;this.N4a=this.M4a=0;this.Hlb=!1;this.tMa=()=>{A.AFrameworkApplication.Be.Ij(this._url,1,null,null,!0,2,this.kcb,this.bV,null)};this.kcb=b=>{cs.Nld();const h=b.data.rna;
let n=null;if(h)try{n=h.selectSingleNode("/docdata/status")}catch(B){}n&&("InProgress"===n.text&&22>this.M4a++||"ServiceBusy"===n.text&&3>this.N4a++)?this.WNa(1E3*(this.M4a+this.N4a)):this.tw(!0,n?n.text:null,b.data)};this.bV=b=>{this.Hlb?(cs.xHa||(cs.sjb=new Date,cs.xHa=!0,cs.nW=1),18E4>(new Date).getTime()-cs.sjb.getTime()?this.wxb(4<=cs.nW?2E4:1E3):this.X9a(b.data)):4>cs.nW?this.wxb(2E3):this.X9a(b.data)}}send(b,h,n){this._url=b;this.tw=h;this.Hlb=n;this.tMa(null)}WNa(b){b=new Re.a(2,1,b,this.tMa);
A.AFrameworkApplication.mc.Zb(b)}wxb(b){this.WNa(b);cs.nW++}X9a(b){this.tw(!1,null,b)}static Laa(b,h){(new cs).send(b,h,!1)}static Nld(){cs.xHa=!1;cs.nW=0}}cs.sjb=null;cs.xHa=!1;cs.nW=0;Object(u.a)(cs,"ClientRequestWithRetry",null,[]);class ID extends Tc{constructor(b){super(b,void 0,A.AFrameworkApplication.O7a)}get Hbb(){return ID.mnn?WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady.replace("{0}",""):WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}static get mnn(){if(null!=
ID.n0g)var b=ID.n0g;else{var h;A.AFrameworkApplication.Ld("32d51153;h1018576");b=null===(h=A.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.OdtDialogDownloadLinkRemovalEnabled",!1);b=ID.n0g=b}return b}get Gqc(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get Nbd(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get gYc(){return A.AFrameworkApplication.O7a?"UIFontDialogTextLarge":null}Jie(){x.ULS.sendTraceTag(7628378,
324,50,"ODT download dialog displayed")}o6f(){x.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}kcd(){x.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get tbd(){return oC.Aij}get oub(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get iej(){return!A.AFrameworkApplication.O7a}}Object(u.a)(ID,"DownloadAsOdtDialog",Tc,[]);class RL{constructor(b,h){this.oib=this.J5a=null;this.Beb=n=>{1===Ua.StaticActiveAppFrame.za().state||this.J5a||
(this.J5a=(new yl.a).create(),n=n.Yl,this.QBn(n),1===n?this.J5a.message=this.SCb.fU.isEnabled?A.AFrameworkApplication.O7a?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:n?2===n&&(this.J5a.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.J5a.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,this.J5a.lM(CommonUIStrings.l_DefaultDialogTitle,this.cancelButton,null))};this.cancelButton=
()=>{this.wde=!0};this.aca=(n,B,L)=>{this.PFg("Success. Save and Conversion Complete.");L=new ub.QueryStringBuilder(L.request.get_url());A.AFrameworkApplication.Aja(L);L=L.toString();const ba=this.QEo(L);this.bsa(ba);2!==ba&&this.SCb.hgo();if(!n||B)this.U8(ba);else if(this.wde)this.wde=!1,this.oib=null;else{this.oib&&A.AFrameworkApplication.mc.vf(this.oib);this.oib=null;if(0===ba){B=new ia.a;B.name="IsLabeled";const la=A.AFrameworkApplication.K.kb("AppliedPolicyId");B.bool=!!(la&&0<la.length);Pe.a("PdfProtectionUsage",
n,void 0,[B])}this.vVl(L,ba)}};this.wde=!1;this.SCb=b;this.hbk=h.vYa("UserAction","WordEditorForceSaveAndPrint")}bsa(b){this.J5a&&(this.$Bn(b),this.J5a.close(),this.J5a=null)}U8(b){if(1!==Ua.StaticActiveAppFrame.za().state){this.UCn(b);const h=new ui.StandardDialog;h.Gd=0;h.Pe(1,CommonUIStrings.l_DialogClose);h.Gy(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}BNf(b){switch(b){case 0:return"downloadpdf";case 1:return"printpdf";
case 2:return"odt";default:return x.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),"printpdf"}}yEo(b){var h=A.AFrameworkApplication.rootQuerySignature;h&&""!==h?(h="WordViewer/request."+this.KCf(b)+"?"+h+"&type="+this.BNf(b)+"&rndm="+yb.a.create(),1===b&&this.SCb.g5o()&&(h+="&useNamedAction=1"),A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&wp.FontUtils.Zye()&&(1===b||!b)&&(0<wp.FontUtils.Lci&&(h+="&cfcVer="+wp.FontUtils.Lci),wp.FontUtils.Kci&&
(h+="&cfcUrl="+encodeURI(wp.FontUtils.Kci)),wp.FontUtils.Mci&&(h+="&cfcEncData="+encodeURIComponent(wp.FontUtils.Mci)),wp.FontUtils.Jci&&(h+="&cfcBaseUrl="+encodeURI(wp.FontUtils.Jci))),cs.Laa(h,this.aca),this.oib||(this.oib=new Re.a(2,1,500,this.Beb),this.oib.Yl=b,A.AFrameworkApplication.mc.Zb(this.oib))):(this.PFg("failed. QuerySignature is empty."),this.U8(b))}KCf(b){return 2===b?"odt":"pdf"}AWb(){this.PFg("Failed. force save failed.")}QEo(b){if(0<b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;
if(0<b.indexOf("&type=odt"))return 2;x.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}PFg(b){x.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",b);this.hbk.stop()}vVl(b,h){const n=new ob.a;n.add("access_token");n.add("access_token_ttl");1!==Ua.StaticActiveAppFrame.za().state&&(1===h?this.SCb.D7o(b,n):h?2===h&&new ID(b):new QL(b))}dispose(){}QBn(b){switch(b){case 0:x.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");
break;case 2:x.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:x.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:x.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}$Bn(b){switch(b){case 0:x.ULS.sendTraceTag(38114786,203,50,"Download Cancelled: Pdf");break;case 2:x.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:x.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:x.ULS.sendTraceTag(38114817,
203,15,"Download Cancelled: {0}",b)}}UCn(b){switch(b){case 0:x.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:x.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:x.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;default:x.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}}Object(u.a)(RL,"FileDownloadManager",null,[]);class cC{get key(){return"LIST"}get Av(){return Box4Intl.Box4Strings.l_ListContentTitle}f2b(b){let h=null;const n=
cC.Nd.Nw(b);if(!n)return{returnValue:!1,Zea:h};b=this.oym(b,n);h=Object.assign(new Kt.a,{UF:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,Zea:h}}Fqb(b,h){b=b.contentObject;const n=this.Wwm(b.lz),B=new Ei.a;h?(h=h.contentObject,h.level!==b.level?(B.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),B.add(n)):h.id.equals(b.id)&&h.lz.listType===b.lz.listType||B.add(n)):(B.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),B.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),B.add(n));return B.toArray().join(" ")}Wwm(b){let h="";const n=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.Sw);else if(1===b.listType)switch(n){case 1:h=this.CYh;break;case 2:h=this.Lhl;break;case 3:h=this.Mhl;break;default:h=this.CYh}return h}static get Nd(){return null!=cC.l1g?cC.l1g:cC.l1g=Ya.a.instance.resolve("Box4.List.IListReader")}}Object(u.a)(cC,"ListDetailsProvider",null,[630,406]);class SL{constructor(){this.lz=this.listId=
this.id=null;this.level=0}}Object(u.a)(SL,"ListItemInfo",null,[]);class fI extends cC{constructor(b){super();this.a$=b}get CYh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get Lhl(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get Mhl(){return WoncaIntl.WoncaStrings.L_BulletStyle3}oym(b,h){const n=this.a$.uE(b);return Object.assign(new SL,{id:b.currentNode.id,listId:new S.a(yb.a.nil,n.listID),lz:h,level:n.level+1})}}Object(u.a)(fI,"FlatListDetailsProvider",cC,[]);class TL{constructor(b,h){this.ga=
b;this.ig=h}get Vb(){return null!=this.u7g?this.u7g:this.u7g=Ya.a.instance.Oa("Box4.Styles.IWACStyleReader")}Wb(){}}Object(u.a)(TL,"FormattingActor",null,[]);var NN=d(1250),Xu=d(325),ON=d(1809);class UL{constructor(b,h,n,B,L,ba,la,La){this.Db=b;this.LMk=h;this.Pc=n;this.ZDb=B;this.eq=L;this.Ga=ba;this.xd=la;this.mBk=La}Usc(b,h,n,B,L,ba,la){x.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:la.Fi});this.ZDb.then(()=>
{this.LMk(b.data.De);x.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:la.Fi});la.stop()})}bV(b,h,n,B,L,ba,la){ba.stop();L();la?(this.tao(h,n),x.ULS.sendTraceTag(574377989,3001,15,"{0}",{["message"]:b,["id"]:Ad.ImageReader.p9a(h.Db)})):x.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:Ad.ImageReader.p9a(h.Db)})}CSh(b,h){b.ze(mG.a.ysf,ry.FXl.toString());if(this.xd&&this.xd.isFeatureEnabled(46)){var n=
this.eq.Qn(h.Hk);n=this.eq.Ek(n);b.ze(wh.a.mt,Xu.a[n]);5===n&&this.O6k(b,h)}this.mBk&&b.ze(wh.a.wbe,"true")}hMh(){return new ON.a(this.Db.id,this.Db)}g9d(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}tao(b,h){const n=this.Pc.Mc(7,wb.a.sTm);n.Ab(h);b.Db.setValue(Lc.a.Z6h,!0);n.dispose()}O6k(b,h){var n=h.Hk;h=this.eq.Qn(n);var B=n.node;const L=(n=this.eq.TKa(h,B.Lc,!1))?this.eq.NKa(n):"";if(""===L)throw x.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),
Error.argumentNull("OriginalObjectDataBlobId");B=(B=this.eq.TKa(h,B.Lc,!0))?this.eq.NKa(B):"";b.ze(wh.a.mtc,L);b.ze(wh.a.lbk,B);n=n.ja(lk.a.Rni,"");""!==n&&b.ze(wh.a.extension,n);b.ze(wh.a.width,this.eq.XB(h).toString());b.ze(wh.a.height,this.eq.fD(h).toString());b.ze(wh.a.yhd,this.eq.grb(h).toString());n=this.Ga.$("WordEditorImageCropIsEnabled");b.ze(wh.a.Xbi,n.toString());n&&(n=this.eq.Gfa(h),b.ze(wh.a.top,n.top.toString()),b.ze(wh.a.bottom,n.bottom.toString()),b.ze(wh.a.left,n.left.toString()),
b.ze(wh.a.right,n.right.toString()));n=this.Ga.$("WordEditorImageRotateIsEnabled");b.ze(wh.a.tIj,n.toString());n&&(b.ze(wh.a.angle,this.eq.g3(h).toString()),h=this.eq.Msa(h),b.ze(wh.a.flipH,h.Spb?"true":"false"),b.ze(wh.a.flipV,h.oKa?"true":"false"));b.ze(wh.a.Bji,"true")}}Object(u.a)(UL,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[446]);class VL{constructor(){this.xRa=null}ycl(b){this.xRa=b}teardown(){null!=this.xRa&&(this.xRa.teardown(),this.xRa=null);this.p5e=null}getGraphicData(){return this.xRa?
this.xRa.getGraphicData():null}Wwo(){null!=this.p5e&&this.setGraphicData(this.p5e)}setGraphicData(b){this.p5e=b;if(this.xRa)try{this.xRa.setGraphicData(b)}catch(h){x.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",h.toString())}else x.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.xRa?this.xRa.hasEdits():!1}}Object(u.a)(VL,"GraphicsEditorGC2HostUser",
null,[450]);var dC=d(1810),PN=d(1177),QN=d(1422),RN=d(855),XL=d(1518),SN=d(1176);class YL{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(u.a)(YL,"GC2ScriptLoader",null,[]);class JJ{constructor(b,h,n){this.DNe=b;this._context=h;this.XSa=n}closeEditor(){this.DNe&&(this.DNe(),this.DNe=null)}logActivity(b,h,n,B){Pe.a(b,h,n,B)}logTrace(b,h,n,B){x.ULS.sendTraceTag(575522531,3001,JJ.pGn(h),B)}isEnabled(b){const h=
A.AFrameworkApplication.K;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");
default:return h.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const h=`${Ya.a.instance.resolve("Box4.IFontServiceParser").G8a}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",h);b=wp.FontUtils.qGf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(n=>"premium"!==n.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return oa.Health.instance}getFonts(b){const h=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",
!1),n=h?"msofp_hier":"msofp",B=`${Ya.a.instance.resolve("Box4.IFontServiceParser").G8a}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(n,B);wp.FontUtils.PMh();wp.FontUtils.pNh({});b=wp.FontUtils.pGf(()=>!1,(L,ba)=>ba).MenuSectionList;h&&0<b.length&&(b.pop(),b.push(this.Hyl()));return b}Hyl(){const b=wp.FontUtils.qGf(()=>!1,()=>"").fonts.map((h,n)=>{const B=h.name;h=h.displayName;const L=wp.FontUtils.Xta(B);return Object.assign(new fx.a,{MenuItemId:wp.FontUtils.sKj+n,CommandValueId:B,
LabelText:h||B,Styles:{["optionText"]:{["fontFamily"]:h&&!L?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:B})});return Object.assign(new te.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=this._context.Hk;var n=Ad.ImageReader.Qn(h);if(this.tkn(n,h,b)&&(n=Ad.ImageReader.q9(n,zd.a.q8,""),n.length))return Promise.resolve(n);n=new ub.QueryStringBuilder("/we/GetImage.ashx?");n.UJb(h.node.Jj().kq);n.ze(wh.a.QZd,
b);A.AFrameworkApplication.Aja(n);n.ze(lg.a.FAb,"1");Qh.a.instance.$Jb(n);n.ze(wh.a.Zci,"true");const B=n.toString();return new Promise((L,ba)=>{this.XSa.Ij(B,1,null,null,!1,2,la=>{L(la.data.De)},la=>{ba(la.data.He.toString())},null)})}getPlaceholders(){const b={};b.PictureDownloading=sk.a.ki("progress.gif");b.PictureInvalid=sk.a.ki("CancelRequest.32x32x32.png");return b}getTheme(){const b=Object($n.a)().Iu(this._context.view.jd).properties.ja(Lc.a.XCe,"");return 0===b.length?[]:b.split(" ").map(h=>
$e.App.W6a[h])}static pGn(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}tkn(b,h,n){const B=h.node.Lc;h=Ad.ImageReader.k8d(b,B,!1);b=Ad.ImageReader.k8d(b,B,!0);return n===h||n===b}}Object(u.a)(JJ,"GraphicsEditorApp",null,[458]);class rk extends Ge.a{constructor(b,h,n,B,L){super(!1,!1,!0);this.closeEditor=()=>{this.H7h();this.dispose()};this.Zra=ba=>{this.H7h(2===ba)};this.Fib=b;this.Uxk=h;this.vmh=n;this._context=B;this.XSa=L}H6o(b){return new Promise((h,
n)=>{this.pi(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.Zra,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(B,L)=>this.JKb(B,L,b),["onload"]:B=>{this.onLoad(B,h,n)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.Fib.Wwo()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,h,n){b?(this.Fib.ycl(b),
h(b)):(x.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),n(null))}JKb(b,h,n){b=A.AFrameworkApplication.K;const B=SN.a();B.loadScriptWithRetryHandler=h;const L=new JJ(this.closeEditor,this._context,this.XSa),ba={["bootConfig"]:Object.assign(new QN.a,{scriptBaseUrl:OF.AppChromeOverrideUtilities.isEnabled?OF.AppChromeOverrideUtilities.Y7d(A.AFrameworkApplication.lcid):A.AFrameworkApplication.c9+A.AFrameworkApplication.lcid+"/",isMLRRibbonMode:A.AFrameworkApplication.ua.Ib.Pxc,
isCombinedBundleEnabled:A.AFrameworkApplication.K.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new YL(new PN.DynamicScriptLoader(B)),["publicPath"]:A.AFrameworkApplication.c9,["appSettings"]:b.appSettings,["logger"]:new zc.a,["featureGateManager"]:Object.assign(new RN.a,{getBooleanFeatureGate:Object(z.a)(b,b.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(z.a)(b,b.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(z.a)(b,b.getStringFeatureGate,"getStringFeatureGate")}),
["app"]:L,["resolveScript"]:(la,La)=>XL.a.resolveScript(la,La),["initialTabId"]:n};b.$("DynamicBundlesIsEnabled")&&(n="",A.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||A.AFrameworkApplication.K.$("IsCombinedBundleEnabled")||(n=b.$("IsWebpack5RibbonEnabled")?"wp5/":"exp/"),ba.dynamicBundlesPath=OF.AppChromeOverrideUtilities.isEnabled?OF.AppChromeOverrideUtilities.qwc+n:b.kb("StaticContentUrl")+n);return new Promise((la,La)=>{h("gc2",A.AFrameworkApplication.lC("gc2.js",5),"anonymous",
5,!1).then(()=>{la(ba)}).catch(()=>{x.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");La(null)})})}H7h(b){b=this.Fib.hasEdits()&&!b;this.Uxk(b?this.Fib.getGraphicData():null,!!this.vmh,this.vmh,b)}}Object(u.a)(rk,"ReactGraphicsEditorDialog",Ge.a,[]);class DA{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc,dd=!1){this.hsi=dd;this.ZDb=this._context=null;this.I6o=(Hd,xe,je,he,fe)=>{var De,gg,eg;const vl=!!fe&&Object(Wb.a)(S.a,fe);try{if(1===je){const Sm=
xe.view;return this.Ck.Vja(xe)&&Sm.features.LBe?32:8}this.JBk=4===(null===fe||void 0===fe?void 0:fe.InputMethod)?!0:!1;Object(zi.c)()&&(this.hsi||NN.a.rpb(()=>{this.hsi=!0}));x.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${vl}`);performance.mark("LaunchStart");this._context=xe;const wl=new rk(this.Fib,this.zeg,vl?fe:null,xe,this.Af);Hd=null;if(vl&&(null===(De=A.AFrameworkApplication.K)||void 0===De?0:De.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectDrawInDrawingCanvasForPictures",
!1))){const Sm=null===(eg=null===(gg=xe.view.lb)||void 0===gg?void 0:gg.gb)||void 0===eg?void 0:eg.currentSelection;if(null===Sm||void 0===Sm?0:Sm.PL)Hd="Draw"}this.ZDb=wl.H6o(Hd).then(()=>{x.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${vl}`)}).catch(()=>{this.ahi()});if(!vl){const Sm=gx=>{this.ZDb.then(()=>{this.hoj(gx,!1)})};if(A.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===A.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return Sm(JSON.stringify({elements:[]})),
32;let qp=null;qp=Object($n.a)().Iu(xe.view.jd);const my=qp.properties.ja(Lc.a.isi,"");if(0<my.length)return Sm(my),32;this.iUe.rOo(xe,S.a.create(),yb.a.create()).then(gx=>{const ow=this.Pc.Mc(0,wb.a.u5c);ow.Ab(qp);qp.setValue(Lc.a.isi,gx);ow.dispose();Sm(gx);return null}).catch(gx=>{x.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",gx.toString(),vl);this.ahi()})}return 32}catch(wl){return x.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",
wl.toString(),vl),8}};this.bVm=(Hd,xe,je,he,fe)=>{var De,gg;Hd=xe.view;je=null===(gg=null===(De=null===Hd||void 0===Hd?void 0:Hd.lb)||void 0===De?void 0:De.gb)||void 0===gg?void 0:gg.currentSelection;if(null===je||void 0===je||!je.qXa)return 8;if(!Hd.features.LBe)return 32;x.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.Tii(fe,xe);return 32};this.aVm=(Hd,xe,je,he,fe)=>{var De,gg,eg=xe.view;eg=null===(gg=null===(De=null===eg||void 0===eg?void 0:eg.lb)||void 0===De?
void 0:De.gb)||void 0===gg?void 0:gg.currentSelection;return null!==eg&&void 0!==eg&&eg.qXa?this.tMi(Hd,xe,je,he,fe):8};this.tMi=(Hd,xe,je)=>{if(1===je)return xe.view.features.LBe?32:8;if(2===je){Hd=Ad.ImageReader.Qn(xe.Hk);if(!Hd)return 2;x.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.Tii(Hd,xe);return 32}return 2};this.hoj=(Hd,xe=!0)=>{this.Fib.setGraphicData(Hd);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");Hd=performance.getEntriesByName("EditorLaunch");
x.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${xe} Duration: ${Hd[Hd.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");performance.clearMeasures("EditorLaunch")};this.zeg=(Hd,xe,je,he)=>{var fe;this.Fib.teardown();if(xe&&this._context){var De=this._context.view.lb.Og,gg=De.node;De.Gl&&ea.ParagraphReader.Xb(gg)&&(De=null===(fe=this.J$)||void 0===fe?void 0:fe.YB(gg),27==(null===De||void 0===
De?void 0:De.role)&&x.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",he,he?" Everything deleted: "+(0==(null===Hd||void 0===Hd?void 0:Hd.json.length)):""))}if(he)if(x.ULS.sendTraceTag(541714E3,3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(Hd)if(he=Hd.json,fe=Hd.width,gg=Hd.height,he.length||xe)if(!he.length&&xe)if(xe=this._context.Hk){xe=xe.node;if(Ad.ImageReader.vba(xe)){if(!this.Ck.oxo(xe,new ve.GraphIterator,Pd.a.instance,
$B.NJb)){x.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.Ck.ovc(xe,je,this.jb,this.UY)){x.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}x.ULS.sendTraceTag(572363226,3001,50,"Graphic removed thru dialog.")}else x.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else De=new dC.a(this._context,A.AFrameworkApplication.ua.KWa,!0,this.Ck,this.Ga,Object($n.a)()),Hd=yb.a.create(),
je=new UF.a(De,he,this.AM,this.Fn,Hd,vm.a.instance,xe,je,this.Ck,this.eq,fe,gg,this.Ga,this.UY,this.xd,Object(zi.c)(),Object(zi.b)()),this.iUe.cyg(je,this._context,xe,Hd),this.Wha(),this.JBk&&this.Enp();else x.ULS.sendTraceTag(541714001,3001,50,"Empty Json on new content creation when close dialog");else x.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else x.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Ga=
h;this.iUe=n;this.Ck=B;this.AM=L;this.Fn=ba;this.Fib=new VL;this.Pc=La;this.jb=fb;this.UY=Cb;this.eq=Lb;this.xd=tc;this.Af=$b;this.J$=Nc}Wb(){let b=!0;this.Ga.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(b=this.xd&&this.xd.isFeatureEnabled(46));b&&!X.a.Mt&&(this.ga.fb(Dc.a.DQf,oc.a.view,this.I6o,4),this.ga.fb(wb.a.Qzf,oc.a.view,this.bVm,4),this.ga.fb(Dc.a.Vii,oc.a.view,this.aVm,4),this.ga.fb(Dc.a.thc,oc.a.view,this.tMi,4))}ahi(){const b=new ui.StandardDialog;b.Gd=0;b.Gy(yd.a.Bzf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,
WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,null);Ua.StaticActiveAppFrame.za().Ie()}Tii(b,h){var n=b.ja(hi.a.UP,1);const B=b.ja(lk.a.h0,fi.a.finished);n&&B!==fi.a.KPa?b.ja(Lc.a.Z6h,!1)?(h=new ui.StandardDialog,h.Gd=0,h.Gy(yd.a.Bzf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),Ua.StaticActiveAppFrame.za().Ie(),x.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",
["id"]:Ad.ImageReader.p9a(b)})):(this.ga.Pb(Dc.a.DQf,2,b.id),this.ZDb||(x.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.ZDb=new Promise(L=>{L(null)})),n=yb.a.create(),b=new UL(b,this.hoj,vm.a.instance,this.ZDb,this.eq,this.Ga,this.xd,Object(zi.d)(b)),this.iUe.cyg(b,h,!0,n)):x.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}Wha(){const b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");b?b.execute(h=>
{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):x.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}Enp(){const b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):x.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(u.a)(DA,"GraphicsEditorActor",null,[]);var JD=d(563);class eC{constructor(b,h,n){this.K2a="wwaengidc";this.gzd="CreateLinkForHeading";
this.psk="CreateLinkForHeadingAction";this.wuk="\ufffc";this.w2a=b;this.ga=h;this.jb=n}Wb(){this.ga.ra(Dc.a.HXc,oc.a.paragraph,this.Buf.bind(this));this.ga.ra(Dc.a.HXc,oc.a.Bd,this.Buf.bind(this));this.ga.ra(Dc.a.HXc,oc.a.Xc,this.Buf.bind(this));this.ga.Rc(Dc.a.HXc,1028)}Buf(b,h,n){b=h.node;if(1===n)return this.f_i(b)?32:8;this.bqo(this.gzd,this.psk);if(!this.f_i(b))return x.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;n=b.getValue(Lc.a.Yc);
if(!n)return x.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),n=new Map,n.set("Source",this.gzd),n=Object.assign(new rb.a,{additionalValues:n}),oa.Health.instance.recordKpiFailure(this.gzd,"Unable to create sharable link as paragraph id is missing",!1,!0,n),8;this.K$h(n);return 32}K$h(b){b=String.format('{{"{0}":"{1}"}}',JD.a.heading,b);this.ga.Pb(Pa.a.Uaa,2,{["nav"]:btoa(b),["mode"]:"copy"},{["ControlId"]:"CopyLinkToHeading"})}f_i(b){return!this.jb.Xb(b)||this.jb.moc(b)||
this.jb.$Sb(b)||b.Gs||""===b.characterData||b.characterData===this.wuk||!this.w2a.h7d(b)?!1:!0}bqo(b,h){const n=new Map;n.set("Source",this.gzd);n.set("Action",h);oa.Health.instance.recordKpiUsage(b,0,this.K2a,n)}}Object(u.a)(eC,"HeadingsActor",null,[]);class fC{E3o(b){return ea.ParagraphReader.Wza(this.rzi(b))}Und(b,h,n){if(b=ea.ParagraphReader.LKa(this.rzi(b)))h=b.ue(h),Object(Wb.a)(431,h)&&(us.m(b)?h.MYo(n):h.Und())}rzi(b){return b&&b.Gl&&b?b.node:null}}Object(u.a)(fC,"IFrameFocusStrategy",null,
[432]);class XF{constructor(b){this.RHa=null;this.wDd=b}xaj(){x.ULS.sendTraceTag(25007835,375,50,"Ignore all spelling error triggered")}x4j(b){if(!b)return x.ULS.sendTraceTag(25007836,375,15,"Error range is null"),!1;if(!b.errorDetails)return x.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return x.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.RHa=F.a.oDe(b.errorDetails.token,
b.errorDetails.lcid);this.wDd.add(this.RHa,b.errorDetails.lcid);return!0}ppd(b){return b?b.token?F.a.oDe(b.token,b.lcid)===this.RHa:(x.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),!1):(x.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(u.a)(XF,"IgnoreAllProofingErrorStrategy",null,[430]);var KD=d(1434),YF=d(617),LD=d(578);class ZF{constructor(b,h){this.filename=b;this.blob=h}}Object(u.a)(ZF,"UploadBlobParameters",null,[]);class tw extends $l{constructor(b,
h,n,B,L,ba,la,La,fb=null){super(b,h,n,null,L,ba,La,!1);this.SCk="DragAndDrop";this.Whh="FileName";this.Zhh=0;this.KJh=null;this.$td=this.Dob=!1;this.$fh=B;this.jAh=fb}get c$j(){return"DragDropInsertImage"}get YR(){return this.SCk}get fileExtension(){return this.Whh}get fileSize(){return this.Zhh}get d$j(){return this.KJh}Zqd(b){const h=new ZF(this.$fh.name,this.$fh);b.ZYj(h);this.KJh=b.Elb}WAa(b,h){this.jAh&&this.jAh();super.WAa(b,h)}aOg(b){const h=!!b&&this.qoa(b.name,null)&&this.bOg(b,null);b&&
(this.Whh=b.name,this.Zhh=b.size);h||this.Kie();return h}}Object(u.a)(tw,"DragDropInsertImageUploader",$l,[]);class ir{constructor(b,h,n,B,L,ba,la){this.j7c=ba;this.pV=la;this.Oje=this.Pje=this.pke=this.qke=0;this.ga=null;this.uzf=(La,fb,Cb)=>{if($e.App.U_d)return 8;La=fb.node;return 1===Cb?La?32:2:2===Cb?(Cb=Ad.ImageReader.Qn(fb),fb=Ad.ImageReader.d4c(Cb,fb.node.Jj().td,A.AFrameworkApplication.K,A.AFrameworkApplication.ua.KWa),vE(fb),32):2};this.X$m=(La,fb,Cb)=>{const Lb=this.Ck.Vja(fb);if(2===Cb&&
Lb){if(wb.a.xX===La||wb.a.tVd===La)A.AFrameworkApplication.iua?A.AFrameworkApplication.$Dg():this.KIl(fb);return 32}return 1!==Cb||wb.a.xX!==La&&wb.a.tVd!==La?2:Lb?32:2};this.lSb=(La,fb,Cb,Lb,$b)=>this.Ck.Vja(fb)?1===Cb?32:this.Ck.kWf(fb,$b)?32:2:2;this.dYo=()=>{if(this.hb&&this.hb.gb&&this.hb.gb.currentSelection){const La=this.hb.gb.currentSelection.Ra;La&&this.hb.Ic(Oe.SelectionFactory.se(La.node,La.cpBegin))}};this.BYl=(La,fb,Cb,Lb,$b)=>{x.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");
if((La=$b.DataTransfer)&&La.files&&0<La.files.length){x.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",La.files.length));for(Cb=0;Cb<La.files.length;Cb++)Lb=La.files[Cb],0<=F.a.xh(Lb.type).indexOf("image")&&this.g$m(Lb,fb)&&(Lb=this.hb.gb.currentSelection.Ra,this.hb.Ic(Oe.SelectionFactory.se(Lb.node,Lb.cpBegin+1)));this.WPa();return 32}x.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.Zao=(La,fb,Cb,Lb,$b)=>{if(2===Cb)return A.AFrameworkApplication.va.lg(fb.Hk,
La,Cb,!0,Lb,$b);if(!fb.view.te)return 8;La=fb.view;if(!La.lb)return 8;La=La.lb.Og;La=Object(el.a)().TO(La);return 1===La.length&&this.SQ(La[0])?(this.KEn(),32):8};this.QTm=(La,fb,Cb)=>{if(!this.SQ(fb))return 8;const Lb=Ad.ImageReader.Qn(fb),$b=Ad.ImageReader.XB(Lb),tc=Ad.ImageReader.fD(Lb);La=La===wb.a.N$d;x.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:La});if(1===Cb)return this.$i.I7||Ad.ImageReader.lab(Lb)?2:La&&$b<this.Pje&&tc<this.Oje||!La&&$b>this.qke&&tc>this.pke?32:2;
Cb=La?1.1:.9;this.setSize(Lb,fb,$b*Cb,tc*Cb,!0);return 32};this.Euc=(La,fb,Cb,Lb,$b)=>{if(!this.$qa(fb))return 8;La=Ad.ImageReader.Qn(fb);fb=Ad.ImageReader.SKa(La);Cb=Ad.ImageReader.RKa(La);if(0>=fb||0>=Cb)return 2;La=Ad.ImageReader.XB(La)/fb*100;$b.setValue(zd.a.q7c,La);return 32};this.Imc=(La,fb,Cb,Lb,$b)=>{if(!this.$qa(fb))return 8;La=Ad.ImageReader.Qn(fb);if(1===Cb)return this.$i.I7||Ad.ImageReader.lab(La)?2:32;x.ULS.sendTraceTag(20459937,322,50,"Change image scale.");Cb=$b.ja(zd.a.q7c,-1)/100;
Lb=$b.ja(zd.a.GQi,!1);const tc=$b.ja(zd.a.vUf,!0);$b=$b.ja(zd.a.wUf,!0);if(0>=Cb)return ir.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.Hsb}),2;const Nc=Ad.ImageReader.SKa(La),dd=Ad.ImageReader.RKa(La),Hd=Ad.ImageReader.XB(La),xe=Ad.ImageReader.fD(La);if(0>=Nc||0>=dd)return ir.Ec.$b(Tf.a.U4,{["Reason"]:hf.a.Hsb}),2;Lb?(Lb=tc?Cb*Hd:Hd,Cb=$b?Cb*xe:xe):(Lb=tc?Cb*Nc:Hd,Cb=$b?Cb*dd:xe);this.setSize(La,fb,Lb,Cb);we.StaticTheCoauthManager.ud().Jo&&we.StaticTheCoauthManager.ud().Ak.yG(fb.node);this.WPa();return 32};this.sYb=
(La,fb,Cb,Lb,$b)=>{if(!this.SQ(fb))return 8;La=Ad.ImageReader.Qn(fb);La=Ad.ImageReader.fD(La);if(0>=La)return 2;$b.setValue(zd.a.mLa,La);return 32};this.mLa=(La,fb,Cb,Lb,$b)=>{if(!this.$qa(fb))return 8;La=Ad.ImageReader.Qn(fb);if(1===Cb)return this.$i.I7||Ad.ImageReader.lab(La)?2:32;x.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Cb=$b.ja(zd.a.mLa,0);$b=Ad.ImageReader.kab(La);if(0>=Cb)return ir.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.Hsb}),2;Lb=Ad.ImageReader.SKa(La);const tc=Ad.ImageReader.RKa(La),
Nc=Ad.ImageReader.XB(La);var dd=Ad.ImageReader.fD(La);dd=Nc/dd;if(0>=Lb||0>=tc)if(ir.Ec.$b(Tf.a.U4,{["Reason"]:hf.a.Hsb}),this.$Sj(La))return 2;this.setSize(La,fb,$b?Cb*dd:Nc,Cb);we.StaticTheCoauthManager.ud().Jo&&we.StaticTheCoauthManager.ud().Ak.yG(fb.node);Ua.StaticActiveAppFrame.za().Ie();return 32};this.tYb=(La,fb,Cb,Lb,$b)=>{if(!this.SQ(fb))return 8;La=Ad.ImageReader.Qn(fb);La=Ad.ImageReader.XB(La);if(0>=La)return 2;$b.setValue(zd.a.nLa,La);return 32};this.nLa=(La,fb,Cb,Lb,$b)=>{if(!this.$qa(fb))return 8;
La=Ad.ImageReader.Qn(fb);if(1===Cb)return this.$i.I7||Ad.ImageReader.lab(La)?2:32;x.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Cb=$b.ja(zd.a.nLa,0);$b=Ad.ImageReader.kab(La);if(0>=Cb)return ir.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.Hsb}),2;Lb=Ad.ImageReader.SKa(La);const tc=Ad.ImageReader.RKa(La);var Nc=Ad.ImageReader.XB(La);const dd=Ad.ImageReader.fD(La);Nc=dd/Nc;if(0>=Lb||0>=tc)if(ir.Ec.$b(Tf.a.U4,{["Reason"]:hf.a.Hsb}),this.$Sj(La))return 2;this.setSize(La,fb,Cb,$b?Cb*Nc:dd);we.StaticTheCoauthManager.ud().Jo&&
we.StaticTheCoauthManager.ud().Ak.yG(fb.node);Ua.StaticActiveAppFrame.za().Ie();return 32};this.vYb=(La,fb,Cb,Lb,$b)=>{if(!this.SQ(fb))return 8;La=Ad.ImageReader.Qn(fb);La=Ad.ImageReader.kab(La);$b.setValue(zd.a.g0,La);return 32};this.g0=(La,fb,Cb,Lb,$b)=>{if(!this.SQ(fb))return 8;La=Ad.ImageReader.Qn(fb);if(1===Cb&&this.$i.I7)return 2;we.StaticTheCoauthManager.ud().Jo&&we.StaticTheCoauthManager.ud().Ak.yG(fb.node);$b&&(fb=$b.ja(zd.a.g0,!0),x.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),
this.Ck.lOj(La,fb),Ua.StaticActiveAppFrame.za().Ie());return 32};this.Ycb=(La,fb,Cb,Lb,$b)=>{if(!this.SQ(fb))return 8;La=Ad.ImageReader.Qn(fb);La=Ad.ImageReader.O_(La);$b.setValue(zd.a.fsb,La);return 32};this.fsb=(La,fb,Cb,Lb,$b)=>{if(!this.SQ(fb))return 8;if(1===Cb)return this.$i.I7?2:32;if(we.StaticTheCoauthManager.ud().Jo&&(La=fb.node.ja(hi.a.lK,fk.a.Hu),La!==fk.a.Hu&&(La=we.StaticTheCoauthManager.ud().Ak.Vqb(La),LD.CoauthLockEditor.getInstance().seb(La))))return ir.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.HG}),
2;La=Ad.ImageReader.Qn(fb);$b=$b.ja(zd.a.fsb,null);this.Ck.jUo(La,fb,$b);x.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.Md.$t(13);return 32};this.Xcb=(La,fb,Cb,Lb,$b)=>{if(!this.SQ(fb))return 8;La=Ad.ImageReader.Qn(fb);La=Ad.ImageReader.eWa(La);$b.setValue(zd.a.f0,La);return 32};this.f0=(La,fb,Cb,Lb,$b)=>{if(!this.SQ(fb))return 8;if(1===Cb)return this.$i.I7?2:32;if(we.StaticTheCoauthManager.ud().Jo&&(La=fb.node.ja(hi.a.lK,fk.a.Hu),La!==fk.a.Hu&&(La=we.StaticTheCoauthManager.ud().Ak.Vqb(La),
LD.CoauthLockEditor.getInstance().seb(La))))return ir.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.HG}),2;La=Ad.ImageReader.Qn(fb);$b=$b.ja(zd.a.f0,null);this.Ck.iUo(La,fb,$b);x.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Md.$t(13);return 32};this.Odb=(La,fb,Cb)=>{var Lb,$b;if(1===Cb)return 32;if(!fb.view.te)return x.ULS.sendTraceTag(512267791,322,15,"No interactive view. Action: {0}",La),8;fb=fb.view;Cb=null===($b=null===(Lb=fb.lb)||void 0===Lb?void 0:Lb.gb)||void 0===$b?void 0:
$b.J(0);if(!Cb)return x.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",La),8;$b=Cb.Ra;Lb=this.pV.Vf("UserAction",La.toString());let tc;La==wb.a.zxg?tc=this.j7c.Odb($b,2):La==wb.a.Cxg?(tc=this.j7c.Odb($b,0),5==tc&&(tc=this.j7c.Odb($b,2))):La==wb.a.Dxg&&(tc=this.j7c.Odb($b,1),5==tc&&(tc=this.j7c.Odb($b,3)));switch(tc){case 4:$b=32;fb.V0();break;case 5:$b=2;break;default:$b=8}Lb.stop();x.ULS.sendTraceTag(512267789,322,50,"Select image: {0}. Duration: {1}. Action: {2}",tc,Lb.Fi,La);
return $b};this.Ck=b;this.Xn=h;this.Md=n;this.tg=B;this.hb=L;this.Fe=Jc.a.pq?ch.a.getInstance(jc.a):ch.a.getInstance(Bh.a)}get $i(){return Gm.PageReader.instance}get sfa(){return this.Xn.instance}get Sb(){return this.ga}b8m(){this.qke=ri.a.em(1,0);this.pke=ri.a.em(1,1);this.Pje=ri.a.em(1920,0);this.Oje=ri.a.em(1280,1)}Wb(b){this.ga=b;const h=this.Zao,n=this.X$m,B=this.lSb,L=this.QTm;b.fb(wb.a.xX,oc.a.view,n,1284);b.ra(wb.a.lSb,oc.a.Xc,B);b.ra(wb.a.zxg,oc.a.view,this.Odb);b.ra(wb.a.Cxg,oc.a.view,this.Odb);
b.ra(wb.a.Dxg,oc.a.view,this.Odb);b.ra(wb.a.lSb,oc.a.image,B);b.Rc(wb.a.lSb,1284);b.fb(wb.a.tVd,oc.a.view,n,1284);b.fb(wb.a.qof,oc.a.view,h,1028);this.ys(b,wb.a.N$d,L);this.ys(b,wb.a.mEg,L);this.ys(b,wb.a.Euc,this.Euc);this.ys(b,wb.a.sYb,this.sYb);this.ys(b,wb.a.tYb,this.tYb);this.ys(b,wb.a.Ycb,this.Ycb);this.ys(b,wb.a.Xcb,this.Xcb);this.ys(b,wb.a.Imc,this.Imc);this.ys(b,wb.a.Oxe,this.mLa);this.ys(b,wb.a.Pxe,this.nLa);this.ys(b,wb.a.Znd,this.fsb);this.ys(b,wb.a.I_b,this.f0);this.ys(b,wb.a.vYb,this.vYb);
this.ys(b,wb.a.g0,this.g0);this.ys(b,wb.a.uzf,this.uzf);b.fb(wb.a.Jii,oc.a.view,this.BYl,4);b.Rc(wb.a.N$d,4);b.Rc(wb.a.mEg,4);b.Rc(wb.a.Euc,69);b.Rc(wb.a.sYb,69);b.Rc(wb.a.tYb,69);b.Rc(wb.a.vYb,69);b.Rc(wb.a.Ycb,69);b.Rc(wb.a.Xcb,69);b.Rc(wb.a.g0,4);b.Rc(wb.a.Imc,4);b.Rc(wb.a.Oxe,4);b.Rc(wb.a.Pxe,4);b.Rc(wb.a.Znd,4);b.Rc(wb.a.I_b,4);this.b8m()}ys(b,h,n){b.ra(h,oc.a.image,n);b.ra(h,oc.a.LOb,n);b.ra(h,oc.a.Bd,n);b.ra(h,oc.a.caa,n)}KIl(b){new $l(b,ph.a.instance,A.AFrameworkApplication.K,null,this.tg,
this.ga,new vc.b)}oDp(b){return this.$i.I7?(ir.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(ir.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.O5l}),!1):ir.mg.Q2(b)?(ir.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.HG}),!1):this.sfa&&this.sfa.DX(b)?(ir.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.t8a}),!1):!0}zkn(b){const h=Ad.ImageReader.Qn(b);return h&&5===Ad.ImageReader.Ek(h)&&this.WXi(b,h)}WXi(b,h){(h=!Ad.ImageReader.okc(h)&&!Ad.ImageReader.Xee(h))||ir.Ec.$b(Tf.a.Tn,{["Reason"]:hf.a.f7h});return h&&this.oDp(b)}g$m(b,
h){var n,B;h=new tw(h,ph.a.instance,A.AFrameworkApplication.K,b,this.tg,this.ga,this.hb,new vc.b,this.dYo);if(h.aOg(b))Jc.a.pq?this.Fe.logKpiUsage({kpiName:jc.d.$Ka,kpiType:0}):(null===(B=A.AFrameworkApplication.K)||void 0===B?0:B.$("ShouldLogPicturesExtendedHealthKpis"))&&this.Fe.logKpiUsage({kpiName:Bh.c.oLa,kpiType:0});else return Jc.a.pq?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new rb.a,{extendedProperties:b}),this.Fe.logKpiFailure({kpiName:jc.d.$Ka,errorName:"PictureDragDropInvalid",
optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:Object(df.c)(jc.d.Llc)})):(null===(n=A.AFrameworkApplication.K)||void 0===n?0:n.$("ShouldLogPicturesExtendedHealthKpis"))?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new rb.a,{extendedProperties:b}),this.Fe.logKpiFailure({kpiName:Bh.c.oLa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:{name:Bh.c.Gmc,errorNameOverride:null,isIntentional:!0,
isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):oa.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),x.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new xg.a(document.body,Object(z.a)(h,h.Yvb,"onUploadFrameInitialized"),Object(z.a)(h,h.ooa,"uploadResponseReceived"),A.AFrameworkApplication.K,!1,void 0,rf.a(A.AFrameworkApplication.K));return!0}SQ(b){return this.zkn(b)}$qa(b){const h=Ad.ImageReader.Qn(b);
if(!h)return!1;const n=Ya.a.instance.Oa("Box4.IFeatureHelper"),B=Ad.ImageReader.Ek(h);return 5===B||10===B||48===B||11===B||n&&n.isFeatureEnabled(46)&&4===B?this.WXi(b,h):!1}setSize(b,h,n,B,L=!1){we.StaticTheCoauthManager.ud().Jo&&we.StaticTheCoauthManager.ud().Ak.yG(h.node);const ba=Ad.ImageReader.kab(b);let la=1;n>this.Pje?la=this.Pje/n:n<this.qke&&(la=this.qke/n);let La=1;B>this.Oje?La=this.Oje/B:B<this.pke&&(La=this.pke/B);if(ba||L)la=Math.min(la,La),La=Math.min(la,La);1!==la&&(n*=la);1!==La&&
(B*=La);this.Syf(b,h,n,B)}Syf(b,h,n,B){this.Ck.pYo(b,h,n,B)}KEn(){x.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}WPa(){A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}$Sj(b){const h=Ad.ImageReader.SKa(b);b=Ad.ImageReader.RKa(b);return 0>=h||
0>=b}static get mg(){return Pd.a.instance}static get Ec(){return Yc.a.instance}}Object(u.a)(ir,"ImageActor",null,[]);var TN=d(889);class qz{constructor(b,h,n,B,L,ba){this.tI=b;this.graphNode=h;this.Dhc=n;this.wTm=B;this.bBa=L;this.Oo=ba;this.oCd=new TN.a(this.Mp(),qz.gCc);if(Jc.a.pq||Jc.a.oV)this.Fe=ch.a.getInstance(jc.a)}Nra(b){this.OX("crop");this.Oo.jY([7]);if(null===this.tI||void 0===this.Dhc||void 0===this.bBa)return this.vD("crop","Argument(s) invalid"),!1;const h=this.getGraphicData("crop");
if(void 0===h)return!1;const n=this.bBa.FRm();n.top=b.top;n.left=b.left;n.right=b.right;n.bottom=b.bottom;try{if(!this.vTc(n,h))return this.UUb("crop","Failed to apply and update"),this.vD("crop","Failed to apply and update"),!1}catch(B){return this.UUb("crop",B),this.vD("crop",B.stack?B.stack:B.message?B.message:B.toString()),!1}this.Oo.fM([7]);this.S4();this.ncd("crop");return!0}rotate(b){this.OX("rotate");this.Oo.jY([8]);if(null===this.tI||void 0===this.Dhc||void 0===this.bBa)return this.vD("rotate",
"Argument(s) invalid"),!1;const h=this.getGraphicData("rotate");if(void 0===h)return!1;b-=this.tI.Yga.zGi();if(0!==b){const n=this.bBa.JRm();n.rotation=b;try{if(!this.vTc(n,h))return this.vD("rotate","Failed to apply and update"),!1}catch(B){return this.UUb("rotate",B),this.vD("rotate",B.stack?B.stack:B.message?B.message:B.toString()),!1}}this.Oo.fM([8]);this.S4();this.ncd("rotate");return!0}flip(b,h){const n="flip"+(b?"H":"")+(h?"V":"");this.OX(n);this.Oo.jY([9]);if(null===this.tI||void 0===this.Dhc||
void 0===this.bBa)return this.vD(n,"Argument(s) invalid"),!1;const B=this.getGraphicData(n);if(void 0===B)return!1;const L=this.bBa.GRm();L.flip=this.bBa.Qsm();L.flip.x=b;L.flip.y=h;try{if(!this.vTc(L,B))return this.vD(n,"Failed to apply and update"),!1}catch(ba){return this.UUb(n,ba),this.vD(n,ba.stack?ba.stack:ba.message?ba.message:ba.toString()),!1}this.Oo.fM([9]);this.S4();this.ncd(n);return!0}sVd(b,h,n){const B="changePictureBorderProps"+(void 0!==b?"_Weight":"")+(void 0!==h?"_DashType":"")+
(void 0!==n?"_Color":"");this.OX(B);this.Oo.jY([10]);if(null===this.tI||void 0===this.Dhc||void 0===this.bBa)return this.vD(B,"Argument(s) invalid"),!1;const L=this.getGraphicData(B);if(void 0===L)return!1;const ba=this.bBa.DRm();void 0!==b&&(ba.weight=b);void 0!==h&&(ba.gN=h);void 0!==n&&(ba.color=n);try{if(!this.vTc(ba,L))return this.UUb(B,"Failed to apply and update"),this.vD(B,"Failed to apply and update"),!1}catch(la){return this.UUb(B,la),this.vD(B,la.stack?la.stack:la.message?la.message:la.toString()),
!1}this.Oo.fM([10]);this.S4();this.ncd(B);return!0}resize(b,h){this.OX("resize");this.Oo.jY([11]);if(null===this.tI||void 0===this.Dhc||void 0===this.bBa)return this.vD("resize","Argument(s) invalid"),!1;const n=this.getGraphicData("resize");if(void 0===n)return!1;let B=0;var L=0;({width:B,height:L}=Ad.ImageReader.o9a(this.tI));b/=B;h/=L;L=this.bBa.KRm();L.scale=this.bBa.aLm();L.scale.width=b;L.scale.height=h;try{if(!this.vTc(L,n))return this.vD("resize","Failed to apply and update"),!1}catch(ba){return this.UUb("resize",
ba),this.vD("resize",ba.stack?ba.stack:ba.message?ba.message:ba.toString()),!1}this.Oo.fM([11]);this.S4();this.ncd("resize");return!0}static get gCc(){return Ya.a.instance.Oa("Box4.ICssColorProvider")}getGraphicData(b){try{const h=this.oCd.fPf();return this.tI.getGraphicData(h)}catch(h){this.vD(b,h.stack?h.stack:h.message?h.message:h.toString())}}vTc(b,h){this.Dhc.apply(b,h);b=this.tI.nPb(h);if(void 0===b)return!1;this.bup(b);return!0}bup(b){const h=new Sd.GraphTransaction(15);h.Ab(this.graphNode);
this.tI.setValue(ye.a.uN,b.uN);this.wTm.KKo(b.Omi,b.MCa,this.tI);h.dispose()}Mp(){return Object($n.a)().Iu(this.graphNode)}OX(b){const h=this.jRg;h.Oob=b;x.ULS.sendTraceTag(509657553,322,50,"{0}",h)}vD(b,h){const n=this.jRg;n.message=h;n.Oob=b;x.ULS.sendTraceTag(509666444,322,15,"{0}",n)}get jRg(){return{["id"]:Ad.ImageReader.p9a(this.tI),["type"]:Ad.ImageReader.Ek(this.tI)}}ncd(b){Jc.a.pq&&this.Fe.logKpiSuccess({kpiName:jc.d.J$d+jc.b.U4d+b+Xu.a[Ad.ImageReader.Ek(this.tI)].toString()})}UUb(b,h){if(Jc.a.pq){const {width:n,
height:B}=Ad.ImageReader.o9a(this.tI);h=Object.assign(new rb.a,{extendedProperties:new Map([["Exception",h.message?h.message:h.toString()]])});h.extendedProperties.set("ErrorLevel","warning");this.Fe.logKpiFailure({kpiName:jc.d.J$d+jc.b.U4d+b+Xu.a[Ad.ImageReader.Ek(this.tI)].toString(),errorName:"DrawingResponseInvalid"+Object(df.b)(B,n),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:h},optionalVeto:Object(df.c)(jc.d.TLi,h,null,!1)})}}S4(){if(Jc.a.oV){var b=this.Oo.records;for(const [h,
n]of Object.entries(b))b={additionalValues:Object.assign(new rb.a,{durationMs:n}),hasImpliedUsage:!0},this.Fe.logKpiSuccess({kpiName:jc.d.Qtc+vc.a[h]+Xu.a[Ad.ImageReader.Ek(this.tI)].toString(),optionalProperties:b}),this.Oo.rvc(Number(h))}}}Object(u.a)(qz,"EditWithGC2Command",null,[]);class Ap{KKo(b,h,n){this.lAn(b,h);this.NKo(n)}lAn(b,h){this.UJ=Array(4);this.UJ[nn.a.left]=b.eAf;this.UJ[nn.a.top]=b.gAf;this.UJ[nn.a.right]=b.fAf;this.UJ[nn.a.bottom]=b.dAf;this.tVa=b.tVa;this.uVa=b.uVa;(this.MCa=
h)&&this.jBl()}NKo(b){b.setValue(ye.a.HBa,Math.round(this.tVa).toString());b.setValue(ye.a.IBa,Math.round(this.uVa).toString());const h=Array(4);this.UJ.forEach((n,B)=>{h[B]=Math.round(n).toString()});b.setValue(ye.a.xWa,h);b.setValue(ye.a.V$a,this.MCa)}jBl(){this.rfp();const b=this.tVa/2,h=this.uVa/2;this.tVa%2&&0===this.uVa%2?(--this.UJ[nn.a.left],++this.UJ[nn.a.top]):this.uVa%2&&0===this.tVa%2&&(++this.UJ[nn.a.left],--this.UJ[nn.a.top]);this.UJ[nn.a.left]+=b-h;this.UJ[nn.a.right]-=b-h;this.UJ[nn.a.top]+=
h-b;this.UJ[nn.a.bottom]-=h-b}rfp(){const b=this.tVa;this.tVa=this.uVa;this.uVa=b}}Object(u.a)(Ap,"GraphicsExtents",null,[]);var KJ=d(1248),LJ=d(1249),gI=d(562);class hI{constructor(){this.uFp={["PictureBorderWeightZeroPointTwoFive"]:.25,["PictureBorderWeightZeroPointFive"]:.5,["PictureBorderWeightZeroPointSevenFive"]:.75,["PictureBorderWeightOne"]:1,["PictureBorderWeightOnePointFive"]:1.5,["PictureBorderWeightTwoPointTwoFive"]:2.25,["PictureBorderWeightThree"]:3,["PictureBorderWeightFourPointFive"]:4.5};
this.bNl={["PictureBorderStyleSolid"]:0,["PictureBorderStyleDash"]:7,["PictureBorderStyleRoundDot"]:8};this.Rao={["background1"]:0,["text1"]:1,["background2"]:2,["text2"]:3,["accent1"]:4,["accent2"]:5,["accent3"]:6,["accent4"]:7,["accent5"]:8,["accent6"]:9};this.Qao={[0]:"background1",[1]:"text1",[2]:"background2",[3]:"text2",[4]:"accent1",[5]:"accent2",[6]:"accent3",[7]:"accent4",[8]:"accent5",[9]:"accent6"};this.Qdi={dOa:{quc:1}};this.Tdi=.75;this.Rdi=0;this.ejp=8;this.ZQn=6}Mkp(b,h){if(b){var n=
this.CFm(b);h=h.Yga.I8d();b.On=void 0===n?!1:n===h}}Lkp(b,h){if(b){var n=this.HEi(b);h=h.Yga.WMf();b.On=void 0===n||void 0===h?!1:n===h}}static U4c(b){return b.Yga.U4c()}gOm(b){var h=b.dOa;b=this.Qao[h.quc];const n=h.ZIa.fje;h=h.ZIa.eje;let B,L;void 0!=n?B=n:void 0!=h&&(L=100-h);return{quc:b,ZIa:{gfb:B,Cxc:L}}}Nca(b,h,n){var B;const L=null===(B=w())||void 0===B?void 0:B.tJa();h=new qz(b,h,L,new Ap,y(),new vc.b);n=this.LEi(n);if(void 0===n)return!1;B=!!b.Yga.U4c();b=void 0!==b.Yga.WMf();return h.sVd(n,
b?void 0:this.Rdi,B?void 0:this.Qdi)}HWo(b,h,n){var B;const L=null===(B=w())||void 0===B?void 0:B.tJa();h=new qz(b,h,L,new Ap,y(),new vc.b);n=this.HEi(n);if(void 0===n)return!1;B=!!b.Yga.U4c();b=!!b.Yga.I8d();return h.sVd(b?void 0:this.Tdi,n,B?void 0:this.Qdi)}x4(b,h,n){var B;const L=null===(B=w())||void 0===B?void 0:B.tJa();B=new qz(b,h,L,new Ap,y(),new vc.b);h=this.zFm(n,h);if(void 0===h)return!1;n=!!b.Yga.I8d();b=void 0!==b.Yga.WMf();return B.sVd(n?void 0:this.Tdi,b?void 0:this.Rdi,h)}qvc(b,h){var n;
const B=null===(n=w())||void 0===n?void 0:n.tJa();return(new qz(b,h,B,new Ap,y(),new vc.b)).sVd()}zFm(b,h){if(b.length===this.ejp){b=parseInt(b,16)>>>24;h=Object($n.a)().Iu(h);h=Tr.kpp(b-1,h);if(void 0===h){x.ULS.sendTraceTag(508692042,322,15,`getPictureBorderColorFromActionData: Could not find theme color info for color index ${b}`);return}b=this.Rao[h.UCe];if(void 0===b){x.ULS.sendTraceTag(508683782,322,15,`getPictureBorderColorFromActionData: Could not find preset scheme color for ${h.UCe}`);return}const n=
void 0!==h.gfb?100-h.gfb:100-h.Cxc;return{dOa:{quc:b,ZIa:{eje:n,fje:void 0!==h.gfb?100-n:void 0}}}}if(b.length===this.ZQn)return{lmd:"#"+F.a.PJ(Nl.a.Emb(parseInt(b,16)),6)};x.ULS.sendTraceTag(508692041,322,15,"setPictureBorderColor: Invalid action data received.")}CFm(b){b=this.LEi(b);if(void 0!==b)return b=ri.a.M0(b,0,!1),ri.a.Wkg(b)}LEi(b){b=this.uFp[b.SourceControlId];void 0===b&&x.ULS.sendTraceTag(508692040,322,15,"getPictureBorderWeightFromActionDataInPoints: Invalid action data received.");
return b}HEi(b){b=this.bNl[b.SourceControlId];void 0===b&&x.ULS.sendTraceTag(508692039,322,15,"getPictureBorderDashTypeFromActionData: Invalid action data received.");return b}}Object(u.a)(hI,"Gc2PictureBorderHelper",null,[]);var ZL=d(411),UN=d(467),VN=d(1523);class Io extends ir{constructor(b,h,n,B,L,ba,la,La,fb,Cb){super(b,h,B,ba,la,La,fb);this.fuh=!1;this.ETe=this.eea=null;this.Px=(Lb,$b,tc,Nc,dd)=>{if(!this.SQ($b))return 8;if(1===tc)return this.$i.I7?2:32;Lb=parseInt(dd);x.ULS.sendTraceTag(593372312,
322,50,"SetPictureStyle: "+Lb);this.SLd.wlo($b,Ad.ImageReader.Qn($b),Lb);this.fcd($b);this.WPa();return 32};this.ove=(Lb,$b,tc)=>{if(!this.SQ($b))return 8;x.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");Lb=Ad.ImageReader.Qn($b);if(1===tc)return this.$i.I7?2:32;tc=Ad.ImageReader.r9a(Lb);tc===hs.a.qdb?(tc=new Sd.GraphTransaction(15),tc.Ab($b.node),Ad.ImageReader.Lnc()?Lb.setValue(Lc.a.CXb,""):this.KM.ayo(Lb),tc.dispose(),this.BOc.create(Lb,$b).Px(sh.a.yGj),this.fcd($b)):tc===hs.a.MRh&&this.BOc.create(Lb,
$b).Px(sh.a.yGj);return 32};this.CVm=(Lb,$b,tc,Nc,dd)=>{if(!this.SQ($b))return 8;Lb=Ad.ImageReader.Qn($b);if(1===tc)return this.$i.I7||Ad.ImageReader.toc(Lb)?2:32;dd&&(this.KM.esd(Lb,$b),x.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),Ua.StaticActiveAppFrame.za().Ie());this.WPa();return 32};this.DVm=(Lb,$b,tc,Nc,dd)=>{var Hd;if(!this.SQ($b))return 8;if(1===tc)return this.$i.I7?2:32;Lb=Ad.ImageReader.Qn($b);if(dd){tc=Ad.ImageReader.yde(Ad.ImageReader.Qn($b));x.ULS.sendTraceTag(22381022,
322,50,"Applying New Image Cropping, isCanvas: "+tc);Nc=dd.ja(zd.a.ksb,0);const je=dd.ja(zd.a.hsb,0),he=dd.ja(zd.a.isb,0);dd=dd.ja(zd.a.jsb,0);var xe=Ad.ImageReader.Gfa(Lb);const fe=xe.bottom,De=xe.left,gg=xe.right;if(Nc===xe.top&&je===fe&&he===De&&dd===gg)return x.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;if(Object(zi.d)(Lb)&&(xe=null===(Hd=w())||void 0===Hd?void 0:Hd.tJa(),(new qz(Lb,$b.node,xe,new Ap,y(),new vc.b)).Nra({top:.001*Nc,bottom:.001*
je,left:.001*he,right:.001*dd})))return 32;tc?(new KJ.a(Lb,new LJ.a,new vc.b)).YRo(Nc,je,he,dd,this.FWn,$b):this.SLd.llo($b,Ad.ImageReader.Qn($b),Nc,je,he,dd);this.fcd($b);Ua.StaticActiveAppFrame.za().Ie()}return 32};this.V$d=(Lb,$b,tc,Nc,dd)=>{if(!this.SQ($b))return 8;Nc=Ad.ImageReader.Qn($b);if(1===tc)return this.$i.I7||Ad.ImageReader.toc(Nc)?2:32;if(dd){x.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.KM.rCa()||this.KM.esd(Nc,$b);switch(Lb){case Dc.a.f7c:Lb=
dd.ja(zd.a.ksb,-1);tc=0;break;case Dc.a.Z6c:Lb=dd.ja(zd.a.hsb,-1);tc=1;break;case Dc.a.$6c:Lb=dd.ja(zd.a.isb,-1);tc=2;break;case Dc.a.a7c:Lb=dd.ja(zd.a.jsb,-1);tc=3;break;default:return 8}this.KM.Pwp(Lb,tc);this.fcd($b);Ua.StaticActiveAppFrame.za().Ie()}return 32};this.Twb=(Lb,$b,tc,Nc,dd)=>{if(!this.SQ($b))return 8;Ad.ImageReader.Qn($b);dd&&(Lb=this.KM.rCa(),dd.setValue(zd.a.rCa,Lb));return 32};this.Duc=(Lb,$b,tc,Nc,dd)=>{if(!this.SQ($b))return 8;Lb=Ad.ImageReader.Qn($b);if(dd){if(this.KM.rCa())({top:Hd,
bottom:tc,left:Lb,right:$b}=this.KM.oom());else{Nc=ri.a.nf(Ad.ImageReader.XB(Lb),0);var Hd=ri.a.nf(Ad.ImageReader.fD(Lb),1);$b=Ad.ImageReader.Gfa(Lb);const xe=Math.max($b.top,0);tc=Math.max($b.bottom,0);Lb=Math.max($b.left,0);$b=Math.max($b.right,0);Nc=1E5*Nc/(1E5-(Lb+$b));const je=1E5*Hd/(1E5-(xe+tc));Hd=Math.floor(xe*je/1E5);tc=Math.floor(tc*je/1E5);Lb=Math.floor(Lb*Nc/1E5);$b=Math.floor($b*Nc/1E5)}dd.setValue(zd.a.ksb,Hd);dd.setValue(zd.a.hsb,tc);dd.setValue(zd.a.isb,Lb);dd.setValue(zd.a.jsb,$b)}return 32};
this.Olc=(Lb,$b,tc,Nc,dd)=>{if(!this.SQ($b))return 8;if(1===tc){if(this.$i.I7)return 2;this.lGn();return 32}Lb=Ad.ImageReader.Qn($b);this.KM.rCa()&&this.KM.esd(Lb,$b);Lb=dd.ja(zd.a.HOa,"");dd=dd.ja(zd.a.$fb,0);x.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:dd,["SourceControlId"]:Lb});switch(dd){case 1:this.KM.iZo($b);break;case 8:this.KM.Jye($b,Vu.a.Z0b,1);break;case 9:this.KM.Jye($b,Vu.a.Z0b,3);break;case 3:this.KM.Jye($b,Vu.a.none,void 0,!0);break;case 4:this.KM.Jye($b,Vu.a.none,
void 0,!1)}this.WPa();Ua.StaticActiveAppFrame.za().Ie();return 32};this.Vuc=(Lb,$b,tc,Nc,dd)=>{if(!this.SQ($b))return 8;Lb=Ad.ImageReader.Qn($b);$b=Ad.ImageReader.M7($b);tc=Ad.ImageReader.z3(Lb);Nc=Ad.ImageReader.ulc(Lb);Lb=Ad.ImageReader.ez(Lb);return this.jlo($b,tc,Nc,Lb,dd)?32:8};this.FVm=(Lb,$b,tc,Nc,dd)=>{var Hd;if(!this.$qa($b))return 8;Nc=Ad.ImageReader.Qn($b);if(1===tc)return hc.SessionStatusManager.instance.Gk?8:this.$i.I7||Ad.ImageReader.uoc(Nc)?2:32;this.KM.rCa()&&this.KM.esd(Nc,$b);if(dd){const je=
dd.ja(zd.a.n7c,0),he=Ad.ImageReader.yde(Nc);x.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",je,he);tc=Ad.ImageReader.g3(Nc);var xe=Ad.ImageReader.Msa(Nc);let fe=xe.Spb;xe=xe.oKa;switch(je){case 0:tc=dd.ja(zd.a.vX,0);break;case 2:tc-=90;tc=df.e(tc);break;case 1:tc+=90;tc=df.e(tc);break;case 4:fe=!fe;break;case 3:xe=!xe;break;case 5:tc+=dd.ja(zd.a.vX,0),tc=df.e(tc)}if(Object(zi.d)(Nc))if(dd=null===(Hd=w())||void 0===Hd?void 0:Hd.tJa(),Hd=new qz(Nc,$b.node,dd,new Ap,y(),
new vc.b),4===je){if(Hd.flip(!0,!1))return 32}else if(3===je){if(Hd.flip(!1,!0))return 32}else if(Hd.rotate(tc))return 32;he?(new KJ.a(Nc,new LJ.a,new vc.b)).EXo(tc,fe,xe,this.X1n,$b):je?this.BOc.create(Nc,$b).JWo(tc,fe,xe):(Hd=yb.a.create(),dd=new Sd.GraphTransaction(15,wb.a.qba),dd.Ab($b.node),this.KM.sUo(Nc,tc),this.SLd.slo($b,Ad.ImageReader.Qn($b),tc,Hd),dd.sMa(Hd,1),dd.yi=Lb,dd.dispose());this.WPa();this.fcd($b);Ua.StaticActiveAppFrame.za().Ie()}return 32};this.uYb=(Lb,$b,tc,Nc,dd)=>{if(!this.SQ($b))return 8;
Lb=Ad.ImageReader.Qn($b);Lb=Ad.ImageReader.g3(Lb);if(0>Lb)return 2;dd.setValue(zd.a.vX,Lb);return 32};this.X1n=(Lb,$b,tc,Nc)=>{if(Lb){const dd=new Sd.GraphTransaction(15,wb.a.qba);dd.Ab(Nc.node);$b.setValue(zd.a.tLb,JSON.stringify(tc));$b.setValue(zd.a.iu,Lb);this.KM.Sxe($b,tc.rotationAngle,tc.lmc,tc.ABc);this.dPb($b);dd.dispose()}};this.E1n=(Lb,$b,tc,Nc)=>{if(Lb){const dd=new Sd.GraphTransaction(15);dd.Ab(Nc.node);$b.setValue(zd.a.tLb,JSON.stringify(tc));$b.setValue(zd.a.iu,Lb);this.KM.zxe($b,tc.AEe,
tc.htd);this.dPb($b);dd.dispose()}};this.FWn=(Lb,$b,tc,Nc)=>{if(Lb){const dd=new Sd.GraphTransaction(15);dd.Ab(Nc.node);$b.setValue(zd.a.tLb,JSON.stringify(tc));$b.setValue(zd.a.iu,Lb);this.KM.mUo($b,Math.round(tc.oAa*gI.a.gob),Math.round(tc.lAa*gI.a.gob),Math.round(tc.mAa*gI.a.gob),Math.round(tc.nAa*gI.a.gob));this.dPb($b);dd.dispose()}};this.Mhd=(Lb,$b,tc,Nc,dd)=>{if(!this.$qa($b))return 8;if(1===tc)return 32;Lb=this.Mp($b);if(!Lb)return 8;tc=Ad.ImageReader.Qn($b);Object(zi.d)(tc)?($b=hI.U4c(tc),
void 0===$b?$b=Io.vhd.Ana="":void 0!==$b.dOa?($b=(new hI).gOm($b),Io.vhd.Ana=$b,$b=""):$b=Io.vhd.Ana=$b.lmd):($b=this.Gp.GEi(Hm.a.hX($b),tc),Io.vhd.Ana=$b);this.iY&&this.iY.Mtd($b);$b=Io.vhd.cPb(Lb,$e.App.W6a);if(!$b)return 8;dd.MenuItems=$b;return 32};this.x4=(Lb,$b,tc,Nc,dd)=>{if(!this.$qa($b))return 8;Nc=Ad.ImageReader.Qn($b);if(Object(zi.d)(Nc)){if(!Ad.ImageReader.Inf(Nc))return 2}else if(Nc&&Ad.ImageReader.aA(Nc))return 2;if(1===tc)return 32;if(2!==tc)return 2;if(!dd)return x.ULS.sendTraceTag(571287758,
322,10,"SetPictureBorderColor: actionData null"),8;if(Object(zi.d)(Nc)){if(!this.njc.x4(Nc,$b.node,dd))return 8}else{tc=new Sd.GraphTransaction(15);tc.Ab($b.node);const Hd=Io.bPa.sra($b.node,dd);this.Gp.x4(Nc,dd,$b,Hd);this.dPb(Nc);tc.dispose()}Lb==wb.a.wod&&this.iY.W5a(dd);this.gwd();this.WPa();return 32};this.hca=(Lb,$b,tc)=>{if(!this.$qa($b))return 8;if(1===tc)return 32;Ua.StaticActiveAppFrame.za().dismissFloatie();Io.TFa=new Tv("PictureBorder",wb.a.wod);Io.TFa.H0b(0);return 32};this.Nca=(Lb,$b,
tc,Nc,dd)=>{if(!this.$qa($b))return 8;if(1===tc)return 32;Lb=Ad.ImageReader.Qn($b);if(Object(zi.d)(Lb)){if(!Ad.ImageReader.Inf(Lb))return 2}else if(Lb&&Ad.ImageReader.aA(Lb))return 2;if(!dd)return x.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;if(Object(zi.d)(Lb)){if(!this.njc.Nca(Lb,$b.node,dd))return 8}else tc=new Sd.GraphTransaction(15),tc.Ab($b.node),this.Gp.Nca(Lb,dd,$b),this.dPb(Lb),tc.dispose();this.gwd();this.WPa();return 32};this.jeb=(Lb,$b,tc,Nc,dd)=>{if(!this.$qa($b))return 8;
if(1===tc)return 32;Lb=Ad.ImageReader.Qn($b);if(Object(zi.d)(Lb)){if(!Ad.ImageReader.Inf(Lb))return 2}else if(Lb&&Ad.ImageReader.aA(Lb))return 2;if(!dd)return x.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),8;if(Object(zi.d)(Lb)){if(!this.njc.HWo(Lb,$b.node,dd))return 8}else tc=new Sd.GraphTransaction(15),tc.Ab($b.node),this.Gp.jeb(Lb,dd,$b),this.dPb(Lb),tc.dispose();this.gwd();this.WPa();return 32};this.qvc=(Lb,$b,tc)=>{if(!this.$qa($b))return 8;if(1===tc)return 32;
Lb=Ad.ImageReader.Qn($b);if(Object(zi.d)(Lb)){if(!this.njc.qvc(Lb,$b.node))return 8}else tc=new Sd.GraphTransaction(15),tc.Ab($b.node),Ad.ImageReader.Xlc(Lb)&&(this.Gp.qvc(Lb),this.dPb(Lb)),tc.dispose();this.gwd();this.WPa();return 32};this.KM=b;this.BOc=n;this.SLd=L;Io.gi=Cb;null===la||void 0===la?void 0:la.Cw(Io.zkl)}get iY(){return null!=this.t3g?this.t3g:this.t3g=Ya.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}static zkl(){Io.$ao()}get Gp(){this.eea||(this.eea=new ZL.a);return this.eea}get njc(){this.ETe||
(this.ETe=new hI);return this.ETe}Wb(b){super.Wb(b);this.ys(b,wb.a.Px,this.Px);b.Rc(wb.a.Px,4);this.ys(b,wb.a.ove,this.ove);this.ys(b,Dc.a.kHe,this.Olc);b.Rc(Dc.a.kHe,4);this.ys(b,Dc.a.lHe,this.Olc);this.ys(b,Dc.a.mHe,this.Olc);this.ys(b,Dc.a.nHe,this.Olc);this.ys(b,Dc.a.oHe,this.Olc);this.ys(b,Dc.a.pHe,this.Olc);this.ys(b,Dc.a.Vuc,this.Vuc);b.Rc(Dc.a.Vuc,101);this.ys(b,Dc.a.Y6c,this.CVm);b.Rc(Dc.a.Y6c,4);this.ys(b,Dc.a.Twb,this.Twb);b.Rc(Dc.a.Twb,101);this.ys(b,Dc.a.tQi,this.DVm);this.ys(b,Dc.a.f7c,
this.V$d);this.ys(b,Dc.a.Z6c,this.V$d);this.ys(b,Dc.a.$6c,this.V$d);this.ys(b,Dc.a.a7c,this.V$d);this.ys(b,Dc.a.Uid,this.Duc);b.Rc(Dc.a.Uid,101);this.ys(b,Dc.a.$re,this.Duc);b.Rc(Dc.a.$re,101);this.ys(b,Dc.a.ase,this.Duc);b.Rc(Dc.a.ase,101);this.ys(b,Dc.a.bse,this.Duc);b.Rc(Dc.a.bse,101);this.ys(b,wb.a.qba,this.FVm);b.Rc(wb.a.qba,4);this.ys(b,wb.a.uYb,this.uYb);b.Rc(wb.a.uYb,101);this.ys(b,wb.a.Mhd,this.Mhd);b.Rc(wb.a.Mhd,4);this.ys(b,wb.a.x4,this.x4);b.Rc(wb.a.x4,4);this.ys(b,wb.a.wod,this.x4);b.Rc(wb.a.wod,
4);this.ys(b,wb.a.oig,this.hca);b.Rc(wb.a.oig,4);this.ys(b,wb.a.MDa,this.MDa.bind(this));b.Rc(wb.a.MDa,4);this.ys(b,wb.a.Nca,this.Nca);b.Rc(wb.a.Nca,4);this.ys(b,wb.a.wYb,this.wYb.bind(this));b.Rc(wb.a.wYb,4);this.ys(b,wb.a.jeb,this.jeb);b.Rc(wb.a.jeb,4);this.ys(b,wb.a.lcg,this.qvc);b.Rc(wb.a.lcg,4)}Syf(b,h,n,B){var L;x.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+Ad.ImageReader.yde(b));this.KM.rCa()&&this.KM.esd(b,h);if(Object(zi.d)(b)){const ba=null===(L=w())||void 0===
L?void 0:L.tJa();if((new qz(b,h.node,ba,new Ap,y(),new vc.b)).resize(n,B))return}Ad.ImageReader.aA(b)?(b=yb.a.create(),L=new Sd.GraphTransaction(15),L.Ab(h.node),this.SLd.rlo(h,Ad.ImageReader.Qn(h),n,B,b),L.sMa(b,1),L.dispose()):Ad.ImageReader.Txc(b)?(new KJ.a(b,new LJ.a,new vc.b)).nXo(n,B,this.E1n,h):(super.Syf(b,h,n,B),this.Md.$t(13))}SQ(b){if(!b.Gl)return!1;var h=b.node;return(h=Object(zi.c)()?h instanceof $k.a||h instanceof VN.a?h:null:Object(ya.a)($k.a,h))&&us.n(h)?(ir.Ec.$b(KD.a.Tn,{["Reason"]:YF.a.WQ}),
!1):super.SQ(b)}static $ao(){Io.qGb||(Io.gi.$5a(Io.yvb),Io.qGb=!0)}jlo(b,h,n,B,L){return L?(L.vZi=b,L.z3=h,L.Kzb=n,L.Fx=B,L.$fb=Io.RRm(L),!0):!1}fcd(b){we.StaticTheCoauthManager.ud().Jo&&we.StaticTheCoauthManager.ud().Ak.yG(b.node)}lGn(){this.fuh||(x.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.fuh=!0)}dPb(b){const h=UN.a.instance.ZBf(b);this.KM.Qxe(b,h[nn.a.left],h[nn.a.right],h[nn.a.top],h[nn.a.bottom])}Mp(b){return b.contextId===oc.a.view?Gm.PageReader.instance.Nkc(b):Object($n.a)().Iu(b.node)}MDa(b,
h,n,B,L){if(!this.$qa(h))return 8;2===n&&(b=Ad.ImageReader.Qn(h),Object(zi.d)(b)?this.njc.Mkp(L,b):this.Gp.ckk(L,b));return 32}wYb(b,h,n,B,L){if(!this.$qa(h))return 8;2===n&&(b=Ad.ImageReader.Qn(h),Object(zi.d)(b)?this.njc.Lkp(L,b):this.Gp.bkk(L,b));return 32}gwd(){A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&window.setTimeout(()=>{const b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},
5E3)}static get bPa(){return null!=Io.K5g?Io.K5g:Io.K5g=tp.a.instance}static get vhd(){Io.rJ||(Io.rJ=new Tr("PictureBorder"),Io.pta(Io.rJ));return Io.rJ}static RRm(b){if(b.vZi)b=1;else switch(b.Kzb){case Vu.a.none:b=b.z3?3:4;break;case Vu.a.Z0b:b=1===b.Fx?8:3===b.Fx?9:2;break;case Vu.a.G1j:b=5;break;case Vu.a.O0j:b=6;break;case Vu.a.I0j:b=7;break;default:b=0}return b}static pta(b){b.PQ(3,wb.a.x4);b.PQ(4,wb.a.x4);b.PQ(5,wb.a.wod);b.PQ(6,wb.a.x4);b.bmb(zy.a.instance,1)}}Io.qGb=!1;Io.rJ=null;Io.TFa=
null;Io.yvb=()=>{Io.gi.vvc(Io.yvb);Io.qGb=!1;if(kh.c()){var b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else x.ULS.sendTraceTag(509445760,322,50,"appChrome is undefined")};Object(u.a)(Io,"ImageActor",ir,[]);class Fm{static get rl(){return null!=Fm.N2g?Fm.N2g:Fm.N2g=Ya.a.instance.resolve("Box4.IParagraphEditor")}static get iC(){return null!=Fm.Y2g?
Fm.Y2g:Fm.Y2g=Ya.a.instance.resolve("Box4.IParagraphIndentationReader")}static get h4(){return Fm.rl.Sr}static get tg(){return null!=Fm.K6g?Fm.K6g:Fm.K6g=Ya.a.instance.resolve("Box4.IUndoManager")}static Wb(){const b=A.AFrameworkApplication.va;b.ra(wb.a.gYb,oc.a.view,yn.a.vx);b.ra(wb.a.gYb,oc.a.paragraph,Fm.Uqa);b.Rc(wb.a.gYb,1036);b.ra(wb.a.pNb,oc.a.view,yn.a.vx);b.ra(wb.a.pNb,oc.a.paragraph,Fm.Uqa);b.Rc(wb.a.pNb,1036);b.ra(wb.a.wob,oc.a.view,yn.a.vx);b.ra(wb.a.wob,oc.a.paragraph,Fm.Uqa);b.Rc(wb.a.wob,
1036);b.ra(wb.a.nvc,oc.a.view,yn.a.vx);b.ra(wb.a.nvc,oc.a.paragraph,Fm.Uqa);b.Rc(wb.a.nvc,1036);b.ra(wb.a.Mkd,oc.a.view,yn.a.vx);b.ra(wb.a.Mkd,oc.a.paragraph,Fm.Uqa);b.Rc(wb.a.Mkd,1036);b.ra(wb.a.u$a,oc.a.view,yn.a.vx);b.ra(wb.a.u$a,oc.a.paragraph,Fm.Uqa);b.Rc(wb.a.u$a,1036);b.ra(wb.a.psb,oc.a.view,yn.a.vx);b.ra(wb.a.psb,oc.a.paragraph,Fm.Uqa);b.Rc(wb.a.psb,1036);b.ra(wb.a.t$a,oc.a.view,yn.a.vx);b.ra(wb.a.t$a,oc.a.paragraph,Fm.Uqa);b.Rc(wb.a.t$a,1036);b.ra(wb.a.Uxe,oc.a.view,Fm.SAe);b.ra(wb.a.Uxe,
oc.a.paragraph,Fm.SAe);b.Rc(wb.a.Uxe,1028);b.ra(wb.a.Xzg,oc.a.view,Fm.SAe);b.ra(wb.a.Xzg,oc.a.paragraph,Fm.SAe);b.Rc(wb.a.Xzg,1028);b.ra(wb.a.$_b,oc.a.view,yn.a.vx);b.ra(wb.a.$_b,oc.a.paragraph,Fm.Uqa);b.Rc(wb.a.$_b,1036);b.ra(wb.a.xyb,oc.a.view,yn.a.vx);b.ra(wb.a.xyb,oc.a.paragraph,Fm.Uqa);b.Rc(wb.a.xyb,1036);b.ra(wb.a.a0b,oc.a.view,yn.a.vx);b.ra(wb.a.a0b,oc.a.paragraph,Fm.Uqa);b.Rc(wb.a.a0b,1036);b.ra(wb.a.TEg,oc.a.view,yn.a.vx);b.Rc(wb.a.TEg,1028);b.ra(wb.a.Fod,oc.a.view,yn.a.vx);b.ra(wb.a.Fod,
oc.a.paragraph,Fm.Uqa);b.Rc(wb.a.Fod,1036);b.ra(wb.a.God,oc.a.view,yn.a.vx);b.ra(wb.a.God,oc.a.paragraph,Fm.Uqa);b.Rc(wb.a.God,1036)}static SAe(b,h,n,B,L){2===n&&""===L[Ki.a.Text]&&(b=b===wb.a.Uxe?wb.a.u$a:wb.a.t$a,h=new JB.a,h.value=0,h.unit=$e.App.QLa?2:1,A.AFrameworkApplication.va.Pb(b,2,h),Ua.StaticActiveAppFrame.za().Ie());return 32}static Uqa(b,h,n,B,L){if(!({Pz:n}=yn.a.kCg(n,h)).returnValue)return n;h=h.node;switch(b){case wb.a.gYb:Fm.h4.Qng(h,!0);break;case wb.a.pNb:Fm.h4.Qng(h,!1);break;
case wb.a.wob:Fm.h4.wob(h);break;case wb.a.nvc:Fm.h4.rha(h,0);break;case wb.a.Mkd:Fm.h4.kyb(h,0);break;case wb.a.psb:case wb.a.u$a:n=new ve.GraphIterator;n.set(h);n.zb(11);let ba=L.value;L=L.unit;b===wb.a.psb&&(ba=(new vr.a(L,ba)).Nu+Fm.iC.pI(h).Nu,L=1);Fm.h4.wEa(n,L,ba);break;case wb.a.t$a:Fm.h4.J_b(h,L.unit,L.value);break;case wb.a.$_b:L?(b=(new vr.a(L.unit,L.value)).Nu,Fm.h4.rha(h,b)):Fm.iC.W6d(h).Nu||Fm.h4.rha(h,pl.OutlineReader.K_(h));break;case wb.a.xyb:L?(b=(new vr.a(L.unit,L.value)).Nu,Fm.h4.kyb(h,
b)):Fm.iC.pI(h).Nu||Fm.h4.kyb(h,pl.OutlineReader.K_(h));break;case wb.a.a0b:Fm.h4.rha(h,0);break;case wb.a.Fod:b=L;b=(new vr.a(b.unit,b.value)).Nu;Fm.h4.NAg(h,1,b);break;case wb.a.God:b=L,b=(new vr.a(b.unit,b.value)).Nu,Fm.h4.NAg(h,2,b)}Fm.tg.$G();B&&no.a.Gzb&&(B.Gt|=no.a.Eqb(h));return 32}}Object(u.a)(Fm,"IndentationActor",null,[]);var $L=d(410),WN=d(69),iI=d(455),XN=d(1295);class Yp{constructor(b){this.d4a=this.bIa=this.BMc=null;this.ZKh=!1;this.jre=h=>{if(this.bIa)if(h===Pa.a.ire)Ph.FocusManager.instance().getRegion(Dd.AFrame.Ncb).Mrc();
else if(h===Pa.a.hre)Ph.FocusManager.instance().getRegion(Dd.AFrame.Ncb).Krc();else return 2;else return 2;return 32};this._frame=b}Ybp(){if(this.ZKh)this.y6i();else{const b=cb.a.create(A.AFrameworkApplication.K.kb("WopiBootstrapUrl"));b.w2((h,n)=>{n.succeeded?(this.ZKh=!0,this.y6i()):x.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});ab.a.D_(b)}}y6i(){if(this.BMc)x.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.vwa;
this.bIa=document.createElement("div");b.parentNode.insertBefore(this.bIa,b);this.d4a=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:A.AFrameworkApplication.K.kb("FileName"),reactRoot:this.bIa});this.d4a.setWebpackPublicPath(A.AFrameworkApplication.c9);this.d4a.renderDocumentPanel()}}$wm(b){const h={};h.Container=b;h.BootstrapperUrl=A.AFrameworkApplication.K.kb("WopiBootstrapUrl");h.ApplicationUrl=this._frame.CAb;b={};b.HostName=A.AFrameworkApplication.K.kb("FileSource");b.HostSessionId=
A.AFrameworkApplication.K.kb("HostSessionId");b.UserId=A.AFrameworkApplication.K.kb("UserId");b.DocumentClickTime=new Date(this._frame.Rub);b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=A.AFrameworkApplication.K.kb("FileName");b.FileGetUrl="";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};
b.userClickTime=this._frame.Rub;h.Diagnostics=b;b={};b.WopiSrc=A.AFrameworkApplication.K.kb("WopiSrc");b.AccessToken=A.AFrameworkApplication.K.kb("AccessToken");b.AccessTokenTtl=A.AFrameworkApplication.K.kb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=n=>{Yp.YZ=n;this.d4a.setMaxPage(Yp.YZ.GetPageCount());this.d4a.setCurrentPage(Yp.YZ.GetCurrentPage());this.d4a.setPageControlVisible(!0);Yp.YZ.RegisterEventHandler("PageChanged",B=>{this.d4a.setCurrentPage(B.newPage)});Yp.YZ.RegisterEventHandler("BrowserEvent",
B=>{27===B.keyCode?this.closeViewer():B.button&&1!==B.button||this.bIa.click()});n=this._frame.Rub-(new Date).getTime();x.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",n);this.Wb();Ph.FocusManager.instance().NN(Dd.AFrame.Ncb,!0);this.buildFocusRegion();this.HNa(Ph.FocusManager.instance().ge(Dd.AFrame.Ncb));this.bIa.click()};h.FnOnInitializeFailure=(n,B)=>{x.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",n.toString(),B.toString());this.closeViewer()};return h}buildFocusRegion(){const b=
Ph.FocusManager.instance();var h=b.getRegion(Dd.AFrame.Ncb);h=[2,3];const n=b.ge(Dd.AFrame.Ncb),B=new Xc.DOMFocusListing(()=>this.bIa);B.lna=!0;for(const L of h)B.Gn(L);h=b.jra(()=>this.bIa,n,B);h.SZa();h.aS=!0;h.b7a=!0;B.mA(B.Uka)}Wb(){A.AFrameworkApplication.va.ra(Pa.a.ire,id.a.frame,this.jre);A.AFrameworkApplication.va.ra(Pa.a.hre,id.a.frame,this.jre)}HNa(b){b.tt(Ph.FocusManager.instance().MZ);b.tt(Ph.FocusManager.instance().NZ);b.bindAction(Ph.FocusManager.instance().MZ,Pa.a.ire);b.bindAction(Ph.FocusManager.instance().NZ,
Pa.a.hre)}loadViewer(b){b=this.$wm(b);this.BMc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.BMc.Complete(b.WopiInfo)}closeViewer(){Ph.FocusManager.instance().fV(Dd.AFrame.Ncb);Yp.YZ&&(Yp.YZ.Dispose(),Yp.YZ=null,A.AFrameworkApplication.va.Zw(Pa.a.ire,id.a.frame,this.jre),A.AFrameworkApplication.va.Zw(Pa.a.hre,id.a.frame,this.jre));this.BMc&&(this.bIa.parentNode.removeChild(this.bIa),this.bIa=this.BMc=null)}printAction(){x.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");
A.AFrameworkApplication.va.Ob(wb.a.print,2)}downloadPdfAction(){x.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");A.AFrameworkApplication.va.Ob(Dc.a.OZc,2)}downloadCopyAction(){x.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");A.AFrameworkApplication.va.Ob(Pa.a.lfa,2)}zoomInAction(){if(Yp.YZ){let b=Yp.YZ.GetZoomLevel();b+=.2;Yp.YZ.SetZoomLevel(b)}}zoomOutAction(){if(Yp.YZ){let b=Yp.YZ.GetZoomLevel();b-=.2;Yp.YZ.SetZoomLevel(b)}}setPage(b){if(Yp.YZ){const h=
Yp.YZ.GetPageCount();1>b?(Yp.YZ.SetCurrentPage(1),this.d4a.setCurrentPage(1)):1<=b&&b<=h?Yp.YZ.SetCurrentPage(b):(Yp.YZ.SetCurrentPage(h),this.d4a.setCurrentPage(h))}}static getInstance(b){Yp.n5e||(Yp.n5e=new Yp(b));return Yp.n5e}}Yp.YZ=null;Yp.n5e=null;Object(u.a)(Yp,"PreviewPanelActor",null,[]);class So{static get Jak(){return null!=So.d7g?So.d7g:So.d7g=A.AFrameworkApplication.K.kb("ClassicViewModePreferenceCookieName")}static get Ng(){return null!=So.EUg?So.EUg:So.EUg=Ya.a.instance.Oa("WordEditor.ClientPagination.IClientPaginationSettings")}static Wb(b,
h){b.fb(wb.a.readingMode,id.a.frame,So.ick,128);b.ra(wb.a.UBe,id.a.frame,So.ick);So.EQ=h;b.ra(Dc.a.bxe,id.a.frame,So.bxe);b.fb(Dc.a.Hse,id.a.frame,So.Hse,96);b.ra(Dc.a.Hhe,id.a.frame,So.Hhe);b.fb(Dc.a.Oog,id.a.frame,So.Oog,96)}static ick(b,h,n){if(h.contextId!==id.a.frame)return 2;h=Eh.a.en;switch(b){case wb.a.readingMode:if(!h.CAb)return 8;if(1===n)return hc.SessionStatusManager.instance.Gk?8:32;b=(new Date).getTime();og.a.instance.qro(b);h.Rub=b;A.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?
Qw.a.mU(zA.a.x9f,!0,So.$eo,null,h):Qw.a.mU(zA.a.x9f,!0,So.xgj,null,h);return 32;case wb.a.UBe:return 32;default:return 2}}static xgj(b){iI.a()?So.rQm(b):So.LZj(b)}static rQm(b){const h={};h[I.a.FTf]=So.Jak;A.AFrameworkApplication.IR().execute(n=>{n.Aw(H.a.GTf);n.hsp(H.a.GTf);n.BD(H.a.GTf,B=>{So.Znl(B,b)});n.sendMessage(H.a.evm,h)})}static Znl(b,h){b.Values[I.a.FTf]===So.Jak&&("true"===b.Values[I.a.HPi]?So.LZj(h):(So.zvp(),So.Dfp()))}static zvp(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b=
{activeMode:"View"};A.AFrameworkApplication.Ld("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static Dfp(){A.AFrameworkApplication.nw=!0;Ua.StaticActiveAppFrame.za().Xca(1);Ua.StaticActiveAppFrame.za().ib.Vu&&Ua.StaticActiveAppFrame.za().ib.Vu.nj&&Ua.StaticActiveAppFrame.za().ib.Vu.BVf();
A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&Ua.StaticActiveAppFrame.za().Ie();XN.MainView.K2j(A.AFrameworkApplication.K)}static LZj(b){try{const h=new qb.a;let n,B;A.AFrameworkApplication.dbk?(n=$e.App.hostUrl,B=3):(n=b.CAb,B=1);b.Rub&&h.add(A.AFrameworkApplication.y9f,b.Rub.toString());A.AFrameworkApplication.dYf&&h.add(A.AFrameworkApplication.wsf,"1");A.AFrameworkApplication.Nnf&&h.add(A.AFrameworkApplication.azl,"1");h.add($L.a.ONg,$L.a.userSessionData);
h.add(A.AFrameworkApplication.lre,A.AFrameworkApplication.userSessionId);const L=A.AFrameworkApplication.K.kb(A.AFrameworkApplication.mwa);L&&h.add(A.AFrameworkApplication.W4j,L);x.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");iI.b(A.AFrameworkApplication.K)?iI.d("view",h,iI.c):(n=za.a.hOh(n,h),A.AFrameworkApplication.dbk?$c.a.yn(n,$c.a.wwa(B),void 0,"AuthenticationLostDuringSession"):$c.a.openWindow(B,n,!1,void 0,WN.a.lEj))}catch(h){}}static $eo(b){x.ULS.sendTraceTag(38355487,323,50,
"previewPanel: init");(A.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Ya.a.instance.resolve("Common.IDynamicScriptLoaderProvider").xC.loadScript("previewPanel")).catch(()=>{x.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");So.xgj(b)}).then(()=>{Yp.getInstance(b).Ybp()})}static bxe(b,h,n){if(1===n)return 32;So.EQ.sNj(1===So.EQ.Ax?0:1);Ua.StaticActiveAppFrame.za().Ie();return 32}static Hse(b,h,n,B,L){if(1===n)return 32;
L[$g.a.On]=1===So.EQ.Ax;return 32}static Hhe(b,h,n){if(1===n)return 32;So.EQ.sNj(2);Ua.StaticActiveAppFrame.za().Ie();return 32}static Oog(){return So.Ng.Z2d?32:8}}So.EQ=null;Object(u.a)(So,"MainViewModeActor",null,[]);class aM{constructor(b,h,n){this.pIn=(B,L,ba,la,La)=>1===ba?32:(B=this.ll.jba(L.Hk))?(La=3===La.iz,this.S9.value.fai(this.VGm(B),this.RQb(B),La),32):2;this.ga=b;this.S9=h;this.ll=n}Wb(){this.ga.ra(Dc.a.x3f,oc.a.view,this.pIn);this.ga.fb(Dc.a.fse,oc.a.view,xm.d,96);this.ga.fb(Dc.a.cse,
oc.a.view,xm.d,96);this.ga.fb(Dc.a.dse,oc.a.view,xm.d,96);this.ga.fb(Dc.a.ese,oc.a.view,xm.d,96);this.ga.ra(Dc.a.lgd,oc.a.view,xm.c);this.ga.ra(Dc.a.kgd,oc.a.view,xm.c);this.ga.ra(Dc.a.Voe,oc.a.view,xm.c);this.ga.ra(Dc.a.Woe,oc.a.view,xm.c)}VGm(b){const h=new Og.DictionaryPropertySet;h.setValue(Lc.a.marginTop,this.ll.Qsa(b));h.setValue(Lc.a.marginBottom,this.ll.qBa(b));h.setValue(Lc.a.marginLeft,this.ll.$J(b));h.setValue(Lc.a.marginRight,this.ll.FL(b));return h}RQb(b){const h=new Og.DictionaryPropertySet;
h.setValue(Lc.a.rp,this.ll.ev(b));h.setValue(Lc.a.qw,this.ll.jD(b));return h}}Object(u.a)(aM,"MarginsDialogActor",null,[]);class MJ{constructor(b){this.fsd=(h,n,B)=>{if(1===B)return 32;h=A.AFrameworkApplication.ua;if(!h)return 32;h.GTd();MJ.FKo(h);return 32};this.ga=b}Wb(){this.ga.ra(Dc.a.fsd,oc.a.view,this.fsd)}static FKo(b){const h=A.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");var n=A.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");n=fc.a.Bfa(h,!n);fc.a.vOa(h,
(!n).toString(),fc.a.xMa);n?x.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):x.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");Pe.d(Dc.a.fsd,!0,void 0,void 0,void 0,void 0,[Object.assign(new ia.a,{name:"ModernUxExperimentPreference",string:(!n).toString()})]);b.D8(null)}}Object(u.a)(MJ,"ModernUxActor",null,[]);var YN=d(947),jr=d(1889);class bM{constructor(b,h,n,B){this.FAe=Fg.a.Ow(1)/6;this.RWo=(L,ba,la,La,fb)=>{if(1===la)return 32;
if(la=this.Xf.jba(ba.Hk)){if(0<=fb&&fb<jr.a.l4.length){ba=new Sd.GraphTransaction(15);ba.Ab(la);ba.yi=L;L=jr.a.l4[fb].FFb;La=jr.a.l4[fb].l9b;const Cb=jr.a.l4[fb]._marginLeft;fb=jr.a.l4[fb].m9b;this.Ape(L,La,this.Xf.jD(la))&&this.Ape(Cb,fb,this.Xf.ev(la))?(this.xG.feb(la,L),this.xG.deb(la,La),this.xG.Ena(la,Cb),this.xG.eeb(la,fb),this.Wd.$t(11)):this.nOa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);ba.dispose()}else return 2;return 32}x.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ba.Hk);return 2};this.SWo=(L,ba,la,La,fb)=>{if(1===la)return 32;if(la=this.Xf.jba(ba.Hk)){if(0<=fb&&fb<jr.a.Zua.length)ba=new Sd.GraphTransaction(15),ba.Ab(la),ba.yi=L,L=(La=this.Xf.R9c(la))?jr.a.Zua[fb].a4a:jr.a.Zua[fb].b4a,fb=La?jr.a.Zua[fb].b4a:jr.a.Zua[fb].a4a,this.Ape(this.Xf.qBa(la),this.Xf.Qsa(la),fb)&&this.Ape(this.Xf.$J(la),this.Xf.FL(la),L)?(this.xG.sAg(la,L),this.xG.rAg(la,fb),this.Wd.$t(11)):this.nOa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),ba.dispose();else return 2;return 32}x.ULS.sendTraceTag(520618524,
3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Hk);return 2};this.hWo=(L,ba,la,La,fb)=>{if(1===la)return 32;if(la=this.Xf.jba(ba.Hk)){ba=this.Xf.R9c(la);La=new Sd.GraphTransaction(15);La.Ab(la);La.yi=L;this.xG.xOj(la,fb);if(fb&&!ba||!fb&&ba){L=this.Xf.ev(la);fb=this.Xf.jD(la);this.xG.sAg(la,fb);this.xG.rAg(la,L);L=this.Xf.Qsa(la);fb=this.Xf.qBa(la);const Cb=this.Xf.$J(la),Lb=this.Xf.FL(la);ba?(this.xG.feb(la,A.AFrameworkApplication.isRtl?Cb:Lb),this.xG.deb(la,A.AFrameworkApplication.isRtl?
Lb:Cb),this.xG.Ena(la,A.AFrameworkApplication.isRtl?fb:L),this.xG.eeb(la,A.AFrameworkApplication.isRtl?L:fb)):(this.xG.feb(la,A.AFrameworkApplication.isRtl?Lb:Cb),this.xG.deb(la,A.AFrameworkApplication.isRtl?Cb:Lb),this.xG.Ena(la,A.AFrameworkApplication.isRtl?Math.abs(L):fb),this.xG.eeb(la,A.AFrameworkApplication.isRtl?fb:L));this.Wd.$t(11)}La.dispose();return 32}x.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Hk);return 2};this.Ede=(L,ba,la)=>{if(1===
la)return 1===this.EH.Ax?32:8};this.fyb=(L,ba,la,La,fb)=>{if(1===la)return 32;la=this.Xf.jba(ba.Hk);if(!la)return x.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Hk),2;ba=new Sd.GraphTransaction(15);ba.Ab(la);ba.yi=L;L=Math.floor(this.Xf.ev(la)/720);if(0>fb||fb>L)return 2;this.xG.D_b(la,fb);this.lCd.execute(Cb=>{Cb.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.txe=(L,ba,la,La,fb)=>{if(1===la)return 32;la=this.Xf.jba(ba.Hk);if(!la)return x.ULS.sendTraceTag(520618521,
3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Hk),2;ba=new Sd.GraphTransaction(15);ba.Ab(la);ba.yi=L;L=fb[0];La=this.Xf.ev(la);if(720>L||L>La)return 2;this.xG.$wc(la,fb);this.lCd.execute(Cb=>{Cb.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.sxe=(L,ba,la,La,fb)=>{if(1===la)return 32;la=this.Xf.jba(ba.Hk);if(!la)return x.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Hk),2;ba=new Sd.GraphTransaction(15);ba.Ab(la);
ba.yi=L;L=this.Xf.ev(la);La=this.Xf.Fh(la);if(0>fb||fb>(L-720*La)/(La-1))return 2;this.xG.ERo(la,fb);this.lCd.execute(Cb=>{Cb.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.rxe=(L,ba,la,La,fb)=>{if(1===la)return 32;la=this.Xf.jba(ba.Hk);if(!la)return x.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Hk),2;ba=new Sd.GraphTransaction(15);ba.Ab(la);ba.yi=L;if(null==fb)return 2;this.xG.iYo(la,fb);this.lCd.execute(Cb=>{Cb.logActivity("WordWebColumnsActivity",
null)});ba.dispose();return 32};this.ANa=(L,ba,la,La,fb)=>{let Cb;try{Cb=this.Xf.jba(ba.Hk)}catch(Lb){return x.ULS.sendTraceTag(508339925,3009,50,"context.nextContext = {0}",ba.Hk),2}if(Cb)return fb.marginTop=this.Xf.Qsa(Cb),fb.marginBottom=this.Xf.qBa(Cb),fb.marginLeft=this.Xf.$J(Cb),fb.marginRight=this.Xf.FL(Cb),fb.rp=this.Xf.ev(Cb),fb.qw=this.Xf.jD(Cb),fb.vCa=this.Xf.R9c(Cb),fb.GG=this.Xf.Fh(Cb),fb.vra=this.Xf.Dqb(Cb),fb.Wul=this.Xf.s9d(Cb),fb.mVb=this.szm(fb),fb.hXb=this.SDm(fb),fb.eWc=this.Xlm(fb),
32;x.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Hk);return 2};this.fye=(L,ba,la,La,fb)=>{if(1===la)return 32;if(la=this.Xf.jba(ba.Hk)){ba=new Sd.GraphTransaction(15);ba.Ab(la);switch(L){case wb.a.feb:this.xG.feb(la,fb);break;case wb.a.deb:this.xG.deb(la,fb);break;case wb.a.Ena:this.xG.Ena(la,fb);break;case wb.a.eeb:this.xG.eeb(la,fb)}this.Wd.$t(11);ba.dispose();return 32}x.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ba.Hk);return 2};this.ePj=(L,ba,la,La,fb)=>{if(1===la)return 32;if(la=this.Xf.jba(ba.Hk)){ba=new Sd.GraphTransaction(15);ba.Ab(la);let Cb=La=0;switch(L){case wb.a.uAg:Cb=fb;this.xG.sAg(la,Cb);La=this.Xf.jD(la);break;case wb.a.tAg:La=fb,this.xG.rAg(la,La),Cb=this.Xf.ev(la)}this.xG.xOj(la,La<Cb);this.Wd.$t(11);ba.dispose();return 32}x.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Hk);return 2};this.xG=b;this.Wd=h;this.EH=n;this.lCd=B}get Xf(){return Po.a.instance}tzm(b){var h=
$e.App.m_f,n=h?1:3,B=A.AFrameworkApplication.numberFormat;let L=jr.a.l4[b].FFb;var ba=jr.a.l4[b].l9b;var la=jr.a.l4[b]._marginLeft;b=jr.a.l4[b].m9b;L=h?Fg.a.C0a(L):Fg.a.oB(L);ba=h?Fg.a.C0a(ba):Fg.a.oB(ba);la=h?Fg.a.C0a(la):Fg.a.oB(la);b=h?Fg.a.C0a(b):Fg.a.oB(b);h=F.a.xKa(L,n,B);ba=F.a.xKa(ba,n,B);la=F.a.xKa(la,n,B);n=F.a.xKa(b,n,B);B={};B.top=h;B.bottom=ba;B.left=la;B.right=n;return B}nIn(b){const h=WordRibbonStrings.PageMarginsTop,n=WordRibbonStrings.PageMarginsBottom,B=WordRibbonStrings.PageMarginsLeft,
L=WordRibbonStrings.PageMarginsRight;b=this.tzm(b);return[[h,b.top,n,b.bottom],[B,b.left,L,b.right]]}Igd(b){var h=$e.App.m_f,n=h?1:3;const B=A.AFrameworkApplication.numberFormat;let L=jr.a.Zua[b].a4a;b=jr.a.Zua[b].b4a;L=h?Fg.a.C0a(L):Fg.a.oB(L);b=h?Fg.a.C0a(b):Fg.a.oB(b);h=F.a.xKa(b,n,B);n=F.a.xKa(L,n,B);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,n)}Wb(){const b=A.AFrameworkApplication.va;b.fb(wb.a.geb,oc.a.view,this.RWo,4);b.fb(wb.a.z_a,oc.a.view,this.SWo,4);b.fb(wb.a.setOrientation,
oc.a.view,this.hWo,4);b.fb(wb.a.ANa,oc.a.view,this.ANa,96);b.ra(wb.a.feb,oc.a.view,this.fye);b.ra(wb.a.deb,oc.a.view,this.fye);b.ra(wb.a.Ena,oc.a.view,this.fye);b.ra(wb.a.eeb,oc.a.view,this.fye);b.ra(wb.a.uAg,oc.a.view,this.ePj);b.ra(wb.a.tAg,oc.a.view,this.ePj);b.fb(wb.a.Ede,oc.a.view,this.Ede,4);b.ra(wb.a.fyb,oc.a.view,this.fyb);b.ra(wb.a.txe,oc.a.view,this.txe);b.ra(wb.a.sxe,oc.a.view,this.sxe);b.ra(wb.a.rxe,oc.a.view,this.rxe)}Ape(b,h,n){return n>=b+h+$e.App.uFa}szm(b){let h=5;for(let n=0;n<jr.a.l4.length;n++)if(jr.a.l4[n].FFb===
b.marginTop&&jr.a.l4[n].l9b===b.marginBottom&&jr.a.l4[n]._marginLeft===b.marginLeft&&jr.a.l4[n].m9b===b.marginRight){h=n;break}return h}SDm(b){let h=5;b=new YN.a(Math.min(b.rp,b.qw),Math.max(b.rp,b.qw));for(let n=0;n<jr.a.Zua.length;n++)if(this.S7n(b,jr.a.Zua[n])){h=n;break}return h}Xlm(b){let h=0;switch(b.GG){case 1:h=1;break;case 2:h=2;break;case 3:h=3}return h}S7n(b,h){return Se.a.VVi(b.b4a,Math.max(h.b4a-this.FAe,0),h.b4a+this.FAe)&&Se.a.VVi(b.a4a,Math.max(h.a4a-this.FAe,0),h.a4a+this.FAe)}nOa(b){if(!xf.a.cP){const h=
new ui.StandardDialog;h.Gd=0;h.yY(CommonUIStrings.l_DefaultDialogTitle,b,null)}}}Object(u.a)(bM,"PageActor",null,[429]);class NJ{constructor(b){this.ga=b}get Sb(){return this.ga}eye(b,h){let n=0;b?1===b?n=wb.a.Ena:2===b?n=wb.a.eeb:3===b&&(n=wb.a.deb):n=wb.a.feb;this.Sb.Pb(n,2,h)}z_a(b,h){let n=0;1===b?n=wb.a.tAg:b||(n=wb.a.uAg);this.Sb.Pb(n,2,h)}qxe(b,h){let n=0;switch(b){case 0:n=wb.a.fyb;break;case 1:n=wb.a.txe;break;case 2:n=wb.a.sxe;break;case 3:n=wb.a.rxe}this.Sb.Pb(n,2,h)}}Object(u.a)(NJ,"PageCommands",
null,[428]);class cM{constructor(b,h,n){this.R7n=(B,L,ba,la,La)=>1===ba?32:(B=this.ll.jba(L.Hk))?(La=3===La.iz,this.S9.value.Iai(this.WGm(B),this.RQb(B),La),32):2;this.ga=b;this.S9=h;this.ll=n}Wb(){this.ga.ra(Dc.a.z3f,oc.a.view,this.R7n);this.ga.fb(Dc.a.vse,oc.a.view,xm.d,96);this.ga.fb(Dc.a.tse,oc.a.view,xm.d,96);this.ga.ra(Dc.a.Zoe,oc.a.view,xm.c);this.ga.ra(Dc.a.Yoe,oc.a.view,xm.c)}WGm(b){const h=new Og.DictionaryPropertySet;h.setValue(Lc.a.rp,this.ll.ev(b));h.setValue(Lc.a.qw,this.ll.jD(b));return h}RQb(b){const h=
new Og.DictionaryPropertySet;h.setValue(Lc.a.marginTop,Math.abs(this.ll.Qsa(b)));h.setValue(Lc.a.marginBottom,Math.abs(this.ll.qBa(b)));h.setValue(Lc.a.marginLeft,this.ll.$J(b));h.setValue(Lc.a.marginRight,this.ll.FL(b));return h}}Object(u.a)(cM,"PaperSizeDialogActor",null,[]);class jI{constructor(b,h,n){this.ga=b;this.S9=h;this.qZ=n}Wb(){this.ga.fb(wb.a.uqc,oc.a.view,this.F8n.bind(this),1028);this.ga.ra(wb.a.uqc,oc.a.paragraph,this.D8n.bind(this));this.ga.fb(wb.a.Rko,oc.a.view,xm.d,96);this.ga.fb(wb.a.Sko,
oc.a.view,xm.d,96);this.ga.fb(wb.a.Yjo,oc.a.view,xm.d,96);this.ga.fb(wb.a.Zjo,oc.a.view,xm.d,96);this.ga.fb(wb.a.oap,oc.a.view,xm.c,96);this.ga.fb(wb.a.nap,oc.a.view,xm.c,96);this.ga.fb(wb.a.J5n,oc.a.view,xm.c,96);this.ga.fb(wb.a.K5n,oc.a.view,xm.c,96);this.ga.fb(wb.a.v5n,oc.a.view,xm.c,96);this.ga.fb(wb.a.lap,oc.a.view,xm.c,96);this.ga.fb(wb.a.w5n,oc.a.view,xm.c,96)}D8n(b,h,n,B,L){if(1===n)return 3===this.ga.mode||2===this.ga.mode?32:8;b=h.node;h=this.U3j(h);L=3===L.iz;this.S9.value.XYd(this.u4c(b),
this.RQb(h),L);return 32}F8n(b,h,n,B,L){b=h.view.lb;if(!b||jI.mg.Tnc(b.Og))return 8;if(Object(el.a)().pFa(ea.ParagraphReader.BX,b.Og))return jI.Ec.$b(Tf.a.Te,{["Reason"]:hf.a.WQ}),8;if(1===n)return 3===this.ga.mode||2===this.ga.mode?32:8;n=b.gb.currentSelection;h=this.U3j(h);L=3===L.iz;if(1===n.length&&re.SelectionEditor.mf(n.J(0)))return n=n.J(0).node,this.S9.value.XYd(this.u4c(n),this.RQb(h),L),32;b=[];for(B=0;B<n.length;B++){const ba=n.J(B);(!B&&re.SelectionEditor.gl(ba)||ea.ParagraphReader.nn(ba)||
re.SelectionEditor.am(ba))&&b.push(ba.node)}if(!b.length)return 8;n=Array(b.length);for(B=0;B<b.length;B++)n[B]=this.u4c(b[B]);n=Dx.APropertySet.SAi(n);this.S9.value.XYd(n,this.RQb(h),L);return 32}u4c(b){const h=new Og.DictionaryPropertySet;h.setValue(zd.a.Fx,ea.ParagraphReader.ez(b));const n=this.qZ.jWa(b);var B=n.lineSpacing;h.setValue(zd.a.fbb,B.unit);h.setValue(zd.a.xa,B.value);B=n.beforeSpacing;h.setValue(zd.a.Btc,B.unit);h.setValue(zd.a.Ctc,B.value);B=n.afterSpacing;h.setValue(zd.a.ztc,B.unit);
h.setValue(zd.a.Atc,B.value);h.setValue(zd.a.Pgd,n.yx);h.setValue(ye.a.keepWithNext,ea.ParagraphReader.keepWithNext(b));h.setValue(ye.a.widowControl,ea.ParagraphReader.l3b(b));h.setValue(ye.a.keepTogether,ea.ParagraphReader.keepTogether(b));return h}static get mg(){return Pd.a.instance}static get Ec(){return Yc.a.instance}}Object(u.a)(jI,"AParagraphDialogActor",null,[]);class ZN extends jI{constructor(b,h,n,B,L){super(b,h,n);this.ll=B;this.Vp=L}Wb(){super.Wb();this.ga.fb(wb.a.ixj,oc.a.view,xm.d,96);
this.ga.fb(wb.a.jxj,oc.a.view,xm.d,96);this.ga.fb(wb.a.dko,oc.a.view,xm.d,96);this.ga.fb(wb.a.t4m,oc.a.view,xm.c,96);this.ga.fb(wb.a.v4m,oc.a.view,xm.c,96);this.ga.fb(wb.a.jap,oc.a.view,xm.c,96);this.ga.fb(wb.a.kap,oc.a.view,xm.c,96);this.ga.fb(wb.a.E5n,oc.a.view,xm.c,96);this.ga.fb(wb.a.M5n,oc.a.view,xm.c,96);this.ga.fb(wb.a.L5n,oc.a.view,xm.c,96);this.ga.fb(wb.a.pap,oc.a.view,xm.c,96);this.ga.fb(wb.a.Tko,oc.a.view,xm.d,96);this.ga.fb(wb.a.Uko,oc.a.view,xm.d,96)}U3j(b){return this.ll.jba(b.Hk)}u4c(b){const h=
super.u4c(b);var n=this.Vp.iX(b);const B=this.Vp.pI(b);h.setValue(zd.a.kNa,1);h.setValue(zd.a.lNa,n.Nu-B.Nu);n=this.Vp.K9a(b);h.setValue(zd.a.kwb,n.unit);h.setValue(zd.a.lwb,n.value);b=this.Vp.jlc(b);b.specialIndentType&&(h.setValue(zd.a.Y8,b.specialIndentType),h.setValue(zd.a.S_a,b.unit),h.setValue(zd.a.T_a,b.value));return h}RQb(b){const h=new Og.DictionaryPropertySet;h.setValue(Lc.a.rp,this.ll.ev(b));h.setValue(Lc.a.qw,this.ll.jD(b));h.setValue(Lc.a.marginTop,Math.abs(this.ll.Qsa(b)));h.setValue(Lc.a.marginBottom,
Math.abs(this.ll.qBa(b)));h.setValue(Lc.a.marginLeft,this.ll.$J(b));h.setValue(Lc.a.marginRight,this.ll.FL(b));return h}}Object(u.a)(ZN,"ParagraphDialogActor",jI,[]);class dM extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.$Zi=h}}Object(u.a)(dM,"AfterPasteEventArgs",Sys.EventArgs,[]);class EA{constructor(b){this.aXe=null;this.hBd=b}get b4d(){return null!=this.uXg?this.uXg:this.uXg=Ya.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get Sde(){this.aXe||(this.aXe=
!!A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$(sr.a.rfi));return this.aXe}rho(b){if(b&&xb.OutlineElementReader.Mh(b.ZAa)&&xb.OutlineElementReader.Mh(b.eub)){this.Mho(b);var h=new Ml.a;for(h.hd(b.ZAa);h&&h.currentNode;){const n=this.F8d(h),B=ea.ParagraphReader.Xb(n);B&&ea.ParagraphReader.Inb(n)&&this.pho(n);const L=h.currentNode.id===b.eub.currentNode.id;B&&this.Sde&&n.pk.ela(n.type).ete(new dM(n,L));if(L)break;Ga.OutlineElementNavigator.ht(h,!1,!1)}}}pho(b){x.ULS.sendTraceTag(590435214,
307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const h=b.Otc;b=Nd.a.Tc(b,0);pp.v9c(h)?this.b4d.fqe(b,h):this.hBd.fqe(b,h)}Mho(b){if(b.ZAa.currentNode&&b.eub.currentNode&&b.ZAa.currentNode.id===b.eub.currentNode.id){const h=this.F8d(b.ZAa);ea.ParagraphReader.Xb(h)?this.tho(h,b.A$n,b.z$n):x.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}tho(b,h,n){x.ULS.shipAssertTag(590956771,
307,0<=h);x.ULS.shipAssertTag(590958592,307,0<=n);var B=ea.ParagraphReader.text(b);if(""!==B){var L=Nd.a.createTextRange(b,h,n);L=ef.a.QA(L,!1);if(1===L.length){const ba=L[0];L=B.substring(h,n).trim();B=B.substring(ba.cpBegin,ba.cpEnd).trim();h=L===B;L=Nd.a.createTextRange(b,ba.cpBegin,ba.cpEnd);if(ba.hyperlink&&h&&!ef.a.VXa(B))b=ba.hyperlink.url;else if(h)b=B;else{x.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");
return}pp.v9c(b)?this.b4d.YWa(L,b,!1):this.hBd.YWa(L,b,!1)}else x.ULS.sendTraceTag(590958597,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",L.length)}}F8d(b){const h=Ga.OutlineElementNavigator.Le(b);Ga.OutlineElementNavigator.he(b);return h}}Object(u.a)(EA,"PastedContentsProcessorPostMergeAfterPaste",null,[426]);class $F extends Ex{constructor(b,h,n,B,L,ba,la,La){super(B);this.W7e=7;this.qx=
this.eHc=null;this.IVe=0;this.FVe=b;this.ul=h;this.so=n;this.Vd=L;this.ymk=la;this.v4a=La;this.l6=this.Vd.vYa("UserAction","WordIgnoreAll")}CBg(b){this.FVe.xaj();this.eHc=this.so.Isa(b);this.v4a.oQi(this.eHc,null,!1);return this.FVe.x4j(this.eHc)?(this.l6.start(),this.qx=new Sd.GraphTransaction(15),this.qx.Ab(b.node),!0):!1}rre(b){this.cYb(b.node);return!0}lid(b){this.cYb(b);return!0}sre(b){this.cYb(b.node)}WHg(b){this.qx.dispose();this.eHc.errorDetails.Vzb(b.actionId);this.l6.stop();x.ULS.sendTraceTag(19779652,
324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",this.IVe,this.l6.Fi,this.eHc.errorDetails.proofingType));return!0}wyc(b,h){if(super.wyc(b,h))return!0;b=b.role;return 9===b||10===b||13===b||7===b||8===b}yFi(b){if(b&&b.type!==this.W7e){const h=ve.GraphIterator.eb(b);return h.zb(this.W7e)?h.ld(this.W7e):b}return b}vkn(b,h){return this.FVe.ppd(h.errorDetails)&&!this.ul.Bba(Nd.a.createTextRange(b,h.Fc,h.end))}cYb(b){if(b){var h=this.so.u7(b,
n=>this.vkn(b,n));this.ymk?this.so.ixb(b,h,!0):0<h.length&&(b.om(4,!0),this.so.aWb(b));this.IVe+=h.length}}}Object(u.a)($F,"IgnoreAllCallbackSteps",Ex,[]);class kI{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc){this.djd=(Nc,dd,Hd,xe,je)=>{if(1===Hd)return 32;Nc=this.WK.oBa(dd.view.lb.Og);if(Nc=hj.a.Cg(Nc))je[Dl.a.LabelText]=Nc.displayName;return 32};this.hta=(Nc,dd,Hd,xe,je,he)=>{const fe=new $F(this.Xyk,this.ul,this.so,this.Oe,this.Vd,this.EZ,0,this.v4a);return new $A(Nc,dd,Hd,xe,je,he,fe,this.ga,
this.hb,this.Oe,"IgnoreAllOperation")};this.yNb=(Nc,dd,Hd,xe,je,he)=>{const fe=new $F(this.Ptk,this.ul,this.so,this.Oe,this.Vd,this.EZ,1,this.v4a);return new $A(Nc,dd,Hd,xe,je,he,fe,this.ga,this.hb,this.Oe,"DoNotCheckThisCritiqueType")};this.ga=b;this.ul=h;this.hb=n;this.Oe=B;this.so=L;this.WK=ba;this.Vd=la;this.Xyk=La;this.Ptk=fb;this.k8b=Cb.C$c;this.EZ=Cb;this.v4a=Lb;this.KXe=$b;this.Mgb=tc}Wb(){this.KXe&&(Ju.qD()?this.ga.fb(wb.a.hta,oc.a.Xc,this.D2m.bind(this),1028):this.ga.wW(wb.a.hta,oc.a.view,
this.hta,1028));this.k8b&&this.ga.wW(wb.a.yNb,oc.a.view,this.yNb,1028);this.ga.fb(Dc.a.djd,oc.a.view,this.djd,96)}D2m(b,h,n,B,L){if(1===n)return 32;x.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.Mgb.MRf(L?L:h,null,Bo.b.IgnoreAll);return 32}}Object(u.a)(kI,"ProofingActor",null,[]);var mx=d(1808);class FA{constructor(b,h,n,B,L,ba,la,La,fb,Cb){this.jp=this.dTa=this.CNd=this.DNd=null;this.cG=this.Ps=this.zq=0;this.wib=this.vib=!1;this.sea=this.Ahb=this.zhb=this.xhb=this.Bhb=
0;this.CMd=null;this.iia=this.GZ=this.Ir=this.iT=0;this.Km=null;this.b3a=0;this.Zgg=Lb=>{var $b;if(Jc.a.pq){var tc=Object.assign(new rb.a,{extendedProperties:new Map});tc.extendedProperties.set("status",Lb.data.status.toString());tc.extendedProperties.set("httpStatus",Lb.data.He.toString());this.z$i("GraphicSwordRequestFailed",this.b3a,tc)}else 5===this.b3a&&(tc=Object.assign(new rb.a,{extendedProperties:new Map}),tc.extendedProperties.set("status",Lb.data.status.toString()),tc.extendedProperties.set("httpStatus",
Lb.data.He.toString()),(null===($b=A.AFrameworkApplication.K)||void 0===$b?0:$b.$("ShouldLogPicturesExtendedHealthKpis"))?($b={name:Bh.c.obe,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:tc},tc.extendedProperties.set("ErrorLevel","warning"),this.Fe.logKpiFailure({kpiName:Bh.c.Emc,errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:tc},optionalVeto:$b})):oa.Health.instance.recordQosError("PictureSwordRequestFailed",
["ImageEditFailed"],!1,!0,!1,!1,tc));x.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:Lb.data.status,["HttpStatus"]:Lb.data.He,["Id"]:Lb.data.id,["ResponseData"]:Lb.data.De},Xu.a[this.b3a]);this.Hve()};this.Ck=n;this.JSa=Cb;this._image=b;this._context=h;this.zFd=!1;(b=Object($n.a)().Iu(h.node))&&b.wf(Lc.a.g1f)&&(this.zFd=!0);this.$Ic=B.$("ImageDataURLPresentationIsEnabled");this.iJk=B.$("WordOartPostRequestIsEnabled");this.Ga=B;this.us=L;this.Vd=ba;this.Wd=
la;this.Fn=La;this.AM=fb;this.Fe=ch.a.getInstance(Bh.a);this.n7m();this.Wne=this.Usc.bind(this)}n7m(){this.jp="";this.zq=Ad.ImageReader.XB(this._image);this.Ps=Ad.ImageReader.fD(this._image);this.sea=Ad.ImageReader.grb(this._image);this.cG=Ad.ImageReader.g3(this._image);var b=Ad.ImageReader.Msa(this._image);this.vib=b.Spb;this.wib=b.oKa;b=Ad.ImageReader.Gfa(this._image);this.Bhb=Math.max(b.top,0);this.xhb=Math.max(b.bottom,0);this.zhb=Math.max(b.left,0);this.Ahb=Math.max(b.right,0);this.Km=yb.a.nil;
this.dTa=null;this.b3a=Ad.ImageReader.Ek(this._image)}oUd(b,h){return(new mx.a(this.us,this.b3a,this.Ga,this.zq,this.Ps,this.cG,this.sea,this.Bhb,this.xhb,this.zhb,this.Ahb,this.vib,this.wib,this.zFd)).build(this._context.node,this._image,b,h)}resize(b,h){this.jp="Resize";this.eBe();ce.a.mark(this.Skc());this.zq=b;this.Ps=h;this.sendMessage(!1,this.Wne)}Px(b){this.jp="Styles";this.eBe();ce.a.mark(this.Skc());this.sea=b;this.sendMessage(!1,this.Wne)}JWo(b,h,n){this.jp="Rotation";this.eBe();this.cG=
b;this.vib=h;this.wib=n;this.sendMessage(!1,this.Wne)}IWo(b,h){this.jp="SwordRequestManager";this.eBe();this.dTa=b;this.cG=h.angle;this.zq=h.width;this.Ps=h.height;this.sea=h.styleId;this.Bhb=h.top;this.xhb=h.bottom;this.zhb=h.left;this.Ahb=h.right;this.Km=h.v_;this.sendMessage(!1,this.Wne)}sendMessage(b,h){this.JSa.jY([this.JSa.fLf(this.jp)]);if(this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var n=this.aob(n);const B=Ad.ImageReader.Wsa(this._image,this.Ga,this.us);B?Jc.a.uyb(this._image,
B,4):this._image.setValue(hi.a.EVa,!0);n.dispose()}this.QXj(b);ce.a.mark(this.Skc());b=new ub.QueryStringBuilder(this.oUd(b,!0));this.$Ic&&b.ze(wh.a.Zci,"true");this.iJk?(n=new ub.QueryStringBuilder("WordOart.ashx"),A.AFrameworkApplication.Be.Ij(n.toString(),2,b.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,this.Zgg,null)):A.AFrameworkApplication.Be.Ij(b.toString(),1,"",null,!0,0,h,this.Zgg,null)}aob(b){b=this.Km&&this.Km!==yb.a.nil?new Sd.GraphTransaction(7,
wb.a.qba):new Sd.GraphTransaction(15);b.Ab(this._context.node);return b}get cgk(){const b=new Sd.GraphTransaction(3);b.Ab(this._context.node);return b}Hve(){this.u1d();this.t1d();const b=this.cgk;var h=Ad.ImageReader.BKa(this._image,this._context.node.Lc,this.Ga,this.us);this._image.setValue(hi.a.EVa,!1);this._image.setValue(zd.a.g7c,h);this._image.setValue(zd.a.vX,-1);this._image.setValue(hi.a.UP,1);h=Ad.ImageReader.Wsa(this._image,this.Ga,this.us);this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&
(this._image.removeProperty(zd.a.Aqe),this._image.removeProperty(zd.a.zqe),h&&Jc.a.uyb(this._image,h,3));b.dispose();FA.qq();this.dTa&&this.dTa()}QXj(b){this.Vd&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.DNd=this.Vd.Vf("WebServiceCall",b))}u1d(){this.DNd&&(this.DNd.stop(),this.DNd=null)}eBe(){if(this.Vd){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.jp,Xu.a[this.b3a]);this.CNd=this.Vd.Vf("WebServiceCall",b)}}t1d(){this.CNd&&(this.CNd.stop(),
this.CNd=null)}S4(){if(Jc.a.oV){var b=this.JSa.records;for(const [h,n]of Object.entries(b))b={additionalValues:Object.assign(new rb.a,{durationMs:n}),hasImpliedUsage:!0},this.Fe.logKpiSuccess({kpiName:jc.d.Qtc+vc.a[h]+Xu.a[this.b3a].toString(),optionalProperties:b}),this.JSa.rvc(Number(h))}}B$i(b){this.Fe.logKpiSuccess({kpiName:jc.d.t5c+this.jp+Xu.a[b].toString()})}A$i(b,h){b=Object.assign(new rb.a,{extendedProperties:new Map([["Exception",b.message]])});this.z$i("GraphicResponseInvalid",h,b)}z$i(b,
h,n){n.extendedProperties.set("ErrorLevel","warning");this.Fe.logKpiFailure({kpiName:jc.d.t5c+this.jp+Xu.a[h].toString(),errorName:b+Object(df.b)(this.Ps,this.zq),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:n},optionalVeto:Object(df.c)(jc.d.zQf,n,null,!1)})}static qq(){const b=new ui.StandardDialog;b.Gd=0;b.Gy(yd.a.Xao,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);Ua.StaticActiveAppFrame.za()&&Ua.StaticActiveAppFrame.za().Ie()}}
Object(u.a)(FA,"RenderedImageEditOperation",null,[449]);var OJ=d(216),aG=d(550);class $N extends FA{constructor(b,h,n,B,L,ba,la,La,fb,Cb){super(b,h,n,B,L,ba,la,La,fb,Cb);if(Jc.a.pq||Jc.a.oV)this.Fe=ch.a.getInstance(jc.a)}sendMessage(b,h){Object(OJ.a)(()=>{let n;n=this.aob(n);this._image.setValue(hi.a.UP,0);n.dispose()});this.QXj(b);ce.a.mark(this.Skc());this.JSa.jY([13]);b=new ub.QueryStringBuilder("WordOart.ashx");this.wmh=this.getUrl(!0,!1);b=new aG.a(b.toString(),2,this.getUrl(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},
!1,2,null,null,null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,"text");A.AFrameworkApplication.Be.send(b).UDa(h,n=>{this.Zgg(n)})}Usc(b){try{const h=JSON.parse(b.data.UNa);this.Txk=h[wh.a.s5c];this.OSk=h[wh.a.width];this.myk=h[wh.a.height];this.c9g=h[wh.a.ZSc];this.RGc=Array(4);this.RGc[nn.a.left]=h[wh.a.Tob];this.RGc[nn.a.right]=h[wh.a.Uob];this.RGc[nn.a.top]=h[wh.a.Vob];this.RGc[nn.a.bottom]=h[wh.a.Sob];this.frh=void 0!==h[wh.a.MCa]?"true"===h[wh.a.MCa].toLowerCase():null;
Object(OJ.a)(()=>{this.Gtd();this._context.node.Jj().yg.CF(()=>{this.i$l()},null,null)})}catch(h){Jc.a.pq&&(b=Object.assign(new rb.a,{extendedProperties:new Map([["Exception",h.message],["Operation",this.jp]])}),b.extendedProperties.set("ErrorLevel","warning"),this.Fe.logKpiFailure({kpiName:jc.d.J$d+jc.b.TAa+Xu.a[Ad.ImageReader.Ek(this._image)].toString(),errorName:"DrawingResponseInvalid"+Object(df.b)(this.Ps,this.zq),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:Object(df.c)(jc.d.TLi,
b,null,!1)})),x.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",h.message,this.jp,Ad.ImageReader.Ek(this._image)),this.Hve()}}kne(){x.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}Gtd(){let b;b=this.aob(b);this._image.setValue(ye.a.uN,this.Txk);this.c9g&&this._image.setValue(ye.a.wSd,this.c9g);this._image.setValue(ye.a.HBa,this.OSk);this._image.setValue(ye.a.IBa,this.myk);this._image.setValue(ye.a.xWa,
this.RGc);this.czk&&this._image.setValue(zd.a.MRb,this.czk);Jc.a.uyb(this._image,this.wmh,3);this._image.setValue(Lc.a.Rob,this.wmh);this.frh?this._image.setValue(ye.a.V$a,this.frh):this._image.removeProperty(ye.a.V$a);this.Iql();b.dispose()}Iql(){this._image.removeProperty(zd.a.iu);this._image.removeProperty(zd.a.vX);this._image.removeProperty(zd.a.Aqe);this._image.removeProperty(zd.a.zqe)}i$l(){this.AM.mOa(this._context);if(this.Km&&this.Km!==yb.a.nil){const b=this._context.node.Jj(),h=new S.a(this.Km,
1);this.Fn.mfc(b,h)}this.Wd.$t(13);Jc.a.pq&&this.Fe.logKpiSuccess({kpiName:jc.d.J$d+jc.b.TAa+Xu.a[Ad.ImageReader.Ek(this._image)].toString()});this.u1d();this.t1d();ce.a.mark(this.o4c());this.JSa.fM([13]);this.S4();Object(OJ.a)(()=>{let b;b=this.aob(b);this._image.setValue(hi.a.UP,1);b.dispose()});this.dTa&&this.dTa()}getUrl(b,h){b=new ub.QueryStringBuilder(this.oUd(b,h));b.ze(wh.a.wbe,"true");return b.toString()}Skc(){return 51511}o4c(){return 51512}}Object(u.a)($N,"RenderedGraphicEditOperation",
FA,[]);var eM=d(618);class aO extends FA{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb){super(b,h,n,B,L,ba,la,La,fb,Lb);this.phh=null;this.kne=$b=>{const tc=this.oUd(!0,!1);let Nc;Nc=this.aob(Nc);this._image.setValue(Lc.a.$Sc,this.CMd);var dd=Ya.a.instance.Oa("Box4.IFeatureHelper");Jc.a.pq&&this.B$i(this.zHb);dd&&dd.isFeatureEnabled(46)&&this._image.setValue(Lc.a.A2d,this.phh);this.Ga.$("WordEditorImageRotateIsEnabled")&&this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Ck.Sxe(this._image,
this.cG,this.vib,this.wib);const Hd=Ad.ImageReader.Wsa(this._image,this.Ga,this.us),xe=()=>{Hd&&Jc.a.uyb(this._image,Hd,3);Jc.a.uyb(this._image,tc,3);this.Ck.Qxe(this._image,Fg.a.iI(this.iT),Fg.a.iI(this.GZ),Fg.a.iI(this.Ir),Fg.a.iI(this.iia));this._image.setValue(Lc.a.Rob,tc);Ad.ImageReader.aA(this._image)||this._image.setValue(Lc.a.pLa,hs.a.qdb);this.Ck.zxe(this._image,this.zq,this.Ps);this.Ga.$("WordEditorImageRotateIsEnabled")&&!this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Ck.Sxe(this._image,
this.cG,this.vib,this.wib);2===$b.data.status&&Ad.ImageReader.F3($b.data.De)&&(this._image.setValue(zd.a.iu,$b.data.De),$b.data.request&&this._image.setValue(zd.a.MRb,Object(eM.a)("POST"===$b.data.request.get_httpVerb()?$b.data.request.get_body():$b.data.request.get_url())));this.dTa&&this.dTa();this.AM.mOa(this._context);if(this.Km&&this.Km!==yb.a.nil){const je=this._context.node.Jj(),he=new S.a(this.Km,1);this.Fn.mfc(je,he)}this.Wd.$t(13);this.u1d();this.t1d();ce.a.mark(this.o4c());this.JSa.fM([this.JSa.fLf(this.jp)]);
this.S4()};if(this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Km&&this.Km!==yb.a.nil&&(dd=this._context.node.Jj())&&dd.yg){Nc.dispose();dd.yg.CF(()=>{let je;je=this.aob(je);xe();je.dispose()},null,null);return}xe();Nc.dispose()};if(Jc.a.pq||Jc.a.oV)this.Fe=ch.a.getInstance(jc.a);this.zHb=Cb}Skc(){return 51511}o4c(){return 51512}Usc(b){try{var h=JSON.parse(b.data.De);const L=Sys.Net.XMLDOM("string"===typeof h[wh.a.LRh]?h[wh.a.LRh]:null);this.CMd="string"===typeof h[wh.a.xSd]?h[wh.a.xSd]:
null;const ba=Ya.a.instance.Oa("Box4.IFeatureHelper");ba&&ba.isFeatureEnabled(46)&&(this.phh="string"===typeof h[wh.a.vic]?h[wh.a.vic]:null);X.a.Mt&&L.setProperty("SelectionNamespaces","xmlns:mc='"+sh.a.X4k+"'");const la=L.selectSingleNode("/mc:AlternateContent");if(!la)throw Jq.a.argument("Alternate content element could not be retrieved!");const La=la.firstChild;if(!La)throw Jq.a.argument("Alternate content choice element could not be retrieved!");const fb=La.firstChild;if(!fb)throw Jq.a.argument("Drawing element could not be retrieved!");
var n=fb.firstChild;if(!n)throw Jq.a.argument("Inline element could not be retrieved!");h=b=null;const Cb=RegExp("effectExtent"),Lb=RegExp("extent");for(const tc of n.childNodes)-1!==tc.nodeName.search(Cb)&&(b=tc),-1!==tc.nodeName.search(Lb)&&(h=tc);if(!b||!h)throw Jq.a.argument("Effect extent or extent could not be retrieved!");this.iT=parseInt(b.selectSingleNode("@l").text);this.GZ=parseInt(b.selectSingleNode("@r").text);this.Ir=parseInt(b.selectSingleNode("@t").text);this.iia=parseInt(b.selectSingleNode("@b").text);
const $b=df.e(this.cG);if(45<=$b&&135>=$b||225<=$b&&315>=$b){const tc=parseInt(h.selectSingleNode("@cx").text);var B=parseInt(h.selectSingleNode("@cy").text);n=tc/2;B/=2;this.iT-=n-B;this.GZ+=n-B;this.Ir-=B-n;this.iia+=B-n}}catch(L){Jc.a.pq&&this.A$i(L,this.zHb);x.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",L.message,this.jp,Xu.a[this.zHb]);this.Hve();return}this.sendMessage(!0,this.kne)}}Object(u.a)(aO,"RenderedDrawingEditOperation",
FA,[]);class fM extends FA{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b){super(b,h,n,B,L,ba,la,La,fb,$b);this.eea=null;this.kne=tc=>{var Nc;const dd=this.oUd(!0,!1);let Hd;Hd=this.aob(Hd);this._image.setValue(Lc.a.CXb,this.CMd);const xe=Ad.ImageReader.Wsa(this._image,this.Ga,this.us);Jc.a.pq?this.B$i(this.zHb):(null===(Nc=A.AFrameworkApplication.K)||void 0===Nc?0:Nc.$("ShouldLogPicturesExtendedHealthKpis"))&&this.Fe.logKpiSuccess({kpiName:Bh.c.Emc});const je=()=>{xe&&Jc.a.uyb(this._image,xe,3);Jc.a.uyb(this._image,
dd,3);this.Ck.Qxe(this._image,Fg.a.iI(this.iT),Fg.a.iI(this.GZ),Fg.a.iI(this.Ir),Fg.a.iI(this.iia));this._image.setValue(Lc.a.Rob,dd);Ad.ImageReader.aA(this._image)||this._image.setValue(Lc.a.pLa,hs.a.qdb);this._image.setValue(Lc.a.yhd,this.sea);this._image.setValue(zd.a.x3m,-1);this.xd.isFeatureEnabled(86)&&Ad.ImageReader.Xlc(this._image)&&this.Gp.qvc(this._image);this._image.setValue(hi.a.EVa,!1);this.Ck.zxe(this._image,this.zq,this.Ps);this.Ga.$("WordEditorImageRotateIsEnabled")&&this.Ck.Sxe(this._image,
this.cG,this.vib,this.wib);this.Ga.$("WordEditorImageCropIsEnabled")&&this.Ck.Tzg(this._image,this.Bhb,this.xhb,this.zhb,this.Ahb);2===tc.data.status&&Ad.ImageReader.F3(tc.data.De)&&(this._image.setValue(zd.a.iu,tc.data.De),tc.data.request&&this._image.setValue(zd.a.MRb,Object(eM.a)("POST"===tc.data.request.get_httpVerb()?tc.data.request.get_body():tc.data.request.get_url())));this.dTa&&this.dTa();this.AM.mOa(this._context);if(this.Km&&this.Km!==yb.a.nil){const he=this._context.node.Jj(),fe=new S.a(this.Km,
1);this.Fn.mfc(he,fe)}this.Wd.$t(13);this.u1d();this.t1d();ce.a.mark(this.o4c());this.JSa.fM([this.JSa.fLf(this.jp)]);this.S4()};if(this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Km&&this.Km!==yb.a.nil&&(Nc=this._context.node.Jj())&&Nc.yg){Hd.dispose();Nc.yg.CF(()=>{let he;he=this.aob(he);je();he.dispose()},null,null);return}je();Hd.dispose()};this.zHb=Cb;this.xd=Lb;if(Jc.a.pq||Jc.a.oV)this.Fe=ch.a.getInstance(jc.a)}Skc(){return 7988}o4c(){return 7989}get Gp(){this.eea||(this.eea=
new ZL.a);return this.eea}Usc(b){var h;try{const n=b.data.rna;this.CMd=b.data.De;X.a.Mt&&n.setProperty("SelectionNamespaces","xmlns:pic='"+sh.a.Vao+"'");const B=n.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.iT=parseInt(B.selectSingleNode("@l").text);this.GZ=parseInt(B.selectSingleNode("@r").text);this.Ir=parseInt(B.selectSingleNode("@t").text);this.iia=parseInt(B.selectSingleNode("@b").text)}catch(n){b=Object.assign(new rb.a,{extendedProperties:new Map});b.extendedProperties.set("exception",
n.message);b.extendedProperties.set("operation",this.jp);Jc.a.pq?this.A$i(n,this.zHb):(null===(h=A.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Bh.c.obe,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.Fe.logKpiFailure({kpiName:Bh.c.Emc,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},
optionalVeto:h})):oa.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);x.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",n.message,this.jp,Xu.a[this.zHb]);this.Hve();return}this.sendMessage(!0,this.kne)}}Object(u.a)(fM,"RenderedPictureEditOperation",FA,[]);class bO{constructor(b,h,n,B,L,ba,la,La){this.Ck=b;this.Ga=h;this.us=n;this.Vd=B;this.Wd=L;this.Fn=ba;this.AM=la;this.xd=La}create(b,
h){const n=Ad.ImageReader.Ek(b);return Object(zi.d)(b)?new $N(b,h,this.Ck,this.Ga,this.us,this.Vd,this.Wd,this.Fn,this.AM,new vc.b):10===n||11===n||48===n||4===n?new aO(b,h,this.Ck,this.Ga,this.us,this.Vd,this.Wd,this.Fn,this.AM,n,new vc.b):5===n?new fM(b,h,this.Ck,this.Ga,this.us,this.Vd,this.Wd,this.Fn,this.AM,n,this.xd,new vc.b):null}}Object(u.a)(bO,"Factory",null,[422]);class MD{constructor(){this.FZc=b=>{const h=window.performance.now(),n=ok.a.Mp();if(n){b=oG.a(b.Yl,n);b=Ff.a.Ft(b,n);var B=0,
L=new Sd.GraphTransaction(3);try{for(L.Ab(n);b.moveNext();){if(!ea.ParagraphReader.Bh(b.iterator))continue;const ba=b.currentNode;this.jii(ba)&&(B++,ba.om(4,!0));const la=window.performance.now()-h;if(2500<B||100<la){this.CHb=null;this.ujd(ba);break}}}finally{L&&L.dispose()}}else Vc.b(570450380,3018,10,"PageContentNode not found")};this.CHb=null}TUi(){const b=ok.a.Mp();this.Ljd(b);this.ujd(null)}ujd(b){this.CHb&&(A.AFrameworkApplication.mc.vf(this.CHb),this.CHb=null);this.CHb=new Re.a(1,1,1,this.FZc,
198);this.CHb.Yl=b;A.AFrameworkApplication.mc.Zb(this.CHb)}Ljd(b){const h=oG.b(b);if(h){var n=new Sd.GraphTransaction(3);try{for(n.Ab(b);h.moveNext();){if(!ea.ParagraphReader.Bh(h.iterator))continue;const B=h.currentNode;this.jii(B)&&B.om(4,!0)}}finally{n&&n.dispose()}}}jii(b){b=b.jJ;for(const h of b)if(h.hab)return 0<h.m1b;return!1}}Object(u.a)(MD,"RenderParagraphsContainingTabs",null,[]);class gM{constructor(b,h){this.tQe=!0;this.KFc=null;this.RWl=()=>{this.KFc=null;this.tQe=!0;this.eTa&&this.eTa.L0a(!Be.StaticSaveItems.vN())};
this.Lfb=(n,B,L)=>{if(1===L)return 32;2===L&&(n=!1,Be.StaticSaveItems.vN()?this.tQe=!1:this.tQe?n=!0:this.sAp(),this.eTa&&this.eTa.L0a(n));return 32};this.ga=b;this.eTa=h}Wb(){this.ga.fb(Pa.a.Lfb,oc.a.application,this.Lfb,1124)}sAp(){this.KFc?A.AFrameworkApplication.mc.vf(this.KFc):this.KFc=new Re.a(4,1,5E3,this.RWl);A.AFrameworkApplication.mc.Zb(this.KFc)}}Object(u.a)(gM,"SaveStatusActor",null,[]);var lI=d(710);class hM{get Wwg(){return null!=this.L3g?this.L3g:this.L3g=Ya.a.instance.Oa("Box4.ISaveStyleManager")}get eFo(){return this.dFo||
(this.dFo=Ya.a.instance.Oa("Box4.IResetAndDeleteStyleManager"))}get ei(){return null!=this.X4g?this.X4g:this.X4g=Ya.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(b,h){this.applyStyles=(n,B,L)=>{n=ok.a.ETb(B);if(1===L||n)return n?8:32;this.S9.value.HDl(B);return 32};this.EMb=(n,B,L)=>{n=ok.a.ETb(B);if(1===L||n)return n?8:32;this.S9.value.OHl(B,this.ga);return 32};this.Uwf=(n,B,L)=>{n=ok.a.ETb(B)||this.x1o();if(1===L||n)return n?8:32;this.S9.value.Uwf(B);return 32};this.ga=b;this.S9=h}get Vb(){return null!=
this.J7g?this.J7g:this.J7g=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}Wb(){this.ga.fb(wb.a.applyStyles,oc.a.view,this.applyStyles,1028);this.ga.fb(wb.a.EMb,oc.a.view,this.EMb,4);this.ga.fb(wb.a.nNb,oc.a.view,this.Uwf,4);this.ga.fb(wb.a.Vwg,oc.a.view,this.aLo.bind(this),4);this.ga.fb(wb.a.hvg,oc.a.view,this.ivg.bind(this),4);this.ga.fb(wb.a.Pwf,oc.a.view,this.KQl.bind(this),4)}aLo(b,h,n){b=ok.a.ETb(h)||this.C1o();if(1===n||b)return b?8:32;this.Wwg.$Ko();return 32}ivg(b,h,n){b=ok.a.ETb(h)||
this.A1o();if(1===n||b)return b?8:32;this.eFo.ivg();return 32}KQl(b,h,n){b=ok.a.ETb(h)||this.w1o();if(1===n||b)return b?8:32;this.S9.value.JQl();return 32}w1o(){return"{}"===Vt.a.xAb?!0:!1}A1o(){if(0==Vt.a.xP.size)return!0;var b=Vt.a.xP;const h=this.Vb.ko();let n=0;for(const B of b.values())b=h.gh(B),this.Vb.ke(b,h)||n++;return 0==n?!0:!1}C1o(){var b=Vt.a.xAb,h=Vt.a.xP;const n=this.Vb.ko();if(0==h.size)return!0;if(!({Zu:b}=D.d(b)).returnValue)return x.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),
!0;if(Object.keys(b).length!=h.size)return!1;for(const L of h.values()){h=n.gh(L);var B=b[L];if(null==B)return!1;if(B=ok.a.F9d(B)){if(h=ok.a.U2c(h,n),ok.a.d$c(h,B))return!1}else x.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}x1o(){var b=ok.a.Mp();if(!b)return Vc.b(577368330,3018,15,"PageContentNode is null"),!0;b=this.ei.qr?(new Qq.WACStyleSet).cla(b):(new Qq.WACStyleSet).iba(b);const h=b.JG;for(let B=0;B<h;B++){let L;b instanceof Qq.WACStyleSet?
L=b.yBa(B):b instanceof lI.a&&(L=b.rla(B));if(!this.Vb.isHidden(L)&&this.Vb.ke(L,b)){var n=this.Vb.FF(L);if(2===n||1===n)if(!L.hasProperty(Lc.a.linkedStyle)||2===n)if(n=L.ja(Lc.a.gE,null),!(n&&0<n.length))return!1}}return!0}}Object(u.a)(hM,"StylesActor",null,[]);class ND{constructor(b){this.TBe=(h,n,B)=>{h=A.AFrameworkApplication.ua;if(1===B)return 1!==h.mode||hc.SessionStatusManager.instance.Gk?2:32;oa.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,ND.bD,null);const L={};L[I.a.FTf]=A.AFrameworkApplication.K.kb("ClassicViewModePreferenceCookieName");
L[I.a.HPi]="true";A.AFrameworkApplication.IR().execute(ba=>{ba.sendMessage(H.a.udp,L)});return A.AFrameworkApplication.va.Ob(wb.a.readingMode,2)};this.ga=b}Wb(){this.ga.ra(Dc.a.TBe,oc.a.view,this.TBe)}}ND.bD="wwaengidc";Object(u.a)(ND,"SwitchToClassicViewModeActor",null,[]);class iM{constructor(b,h,n,B,L,ba,la,La,fb){this.angle=n;this.styleId=B;this.width=b;this.height=h;this.top=L;this.bottom=ba;this.left=la;this.right=La;this.v_=fb}}Object(u.a)(iM,"SWordData",null,[]);class mI{constructor(b,h){this.jl=
this.S5=this.fr=null;this.O6e=this.w9b=!1;this.iT=this.GZ=this.iia=this.Ir=this.sea=this.Ps=this.zq=this.cG=0;this.Km=null;this.aca=()=>{this.O6e=!1;this.w9b&&this.z_c()};this.eq=b;this.BOc=h;this.fSi()}fSi(){this.GZ=this.iT=this.iia=this.Ir=this.sea=this.Ps=this.zq=this.cG=-1;this.Km=yb.a.nil}z_c(){this.O6e||(this.yDp(),this.dJl(),this.w9b=!1)}dJl(){this.jl=new iM(this.zq,this.Ps,this.cG,this.sea,this.Ir,this.iia,this.iT,this.GZ,this.Km);this.BOc.create(this.S5,this.fr).IWo(this.aca,this.jl);this.O6e=
!0;let b;Object(Wb.a)(4,this.S5)?b=Xu.a[Ad.ImageReader.Ek(this.S5)]:(x.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),b="generic");x.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",this.zq,this.Ps,this.cG,this.sea,this.Ir,this.iia,this.iT,this.GZ,
b);this.fSi()}yDp(){this.zq=-1!==this.zq?this.zq:this.S5.ja(zd.a.nLa,-1);this.Ps=-1!==this.Ps?this.Ps:this.S5.ja(zd.a.mLa,-1);this.zq=-1!==this.zq?this.zq:this.eq.XB(this.S5);this.Ps=-1!==this.Ps?this.Ps:this.eq.fD(this.S5);this.cG=-1!==this.cG?this.cG:this.eq.g3(this.S5);this.sea=-1!==this.sea?this.sea:this.eq.grb(this.S5);const b=this.eq.Gfa(this.S5);this.Ir=-1!==this.Ir?this.Ir:b.top;this.iia=-1!==this.iia?this.iia:b.bottom;this.iT=-1!==this.iT?this.iT:b.left;this.GZ=-1!==this.GZ?this.GZ:b.right}slo(b,
h,n,B){this.fr=b;this.cG=n;this.w9b=!0;this.S5=h;this.Km=B;this.z_c()}rlo(b,h,n,B,L){this.fr=b;this.w9b=!0;this.S5=h;this.Km=L;this.S5.setValue(zd.a.nLa,n);this.S5.setValue(zd.a.mLa,B);this.z_c()}wlo(b,h,n){this.fr=b;this.w9b=!0;this.S5=h;this.sea=n;this.z_c()}llo(b,h,n,B,L,ba){this.fr=b;this.Ir=n;this.iia=B;this.iT=L;this.GZ=ba;this.w9b=!0;this.S5=h;h=b=0;({width:b,height:h}=this.eq.o9a(this.S5));this.zq=b-(L+ba)/1E5*b;this.Ps=h-(n+B)/1E5*h;this.z_c()}}Object(u.a)(mI,"SWordRequestManager",null,[421]);
class gC{constructor(b,h,n,B=null,L=null,ba=null,la=null,La=null,fb=null,Cb=null){this.Fn=null;this.iKh=!1;this.$fp=(Lb,$b,tc,Nc,dd)=>{if(1===tc)return 32;const Hd=Lb===wb.a.SBg;if(!$b.view.te)return 2;const xe=$b.view,je=xe.lb,he=je.Og;if(!he||gC.mg.Q2(he))return 2;if(this.Xn&&this.Xn.instance&&this.Xn.instance.DX(he))return 4;Lb=null;var fe=Ce.ActionManager.eDa;let De=!1;var gg=re.SelectionEditor.mf(he);if(he.Ex){if(je.gb.QL&&(fe=he.getContext(0),Lb=new ve.GraphIterator,Lb.set(fe.node),Lb.tq(),
fe=Hd?wb.a.Exg:wb.a.Gwe),fe=this.Y$e.Pfo(fe),fe===Ce.ActionManager.eDa){var eg=Object(el.a)().EW(he,16);eg?(Hd&&(fe=wb.a.jle),Lb=new ve.GraphIterator,Lb.set(eg.node),Lb.Jd()):fe=Hd?wb.a.OI:wb.a.fR}}else if(he.Gl)if(Lb=new ve.GraphIterator,Lb.set(he.node),re.SelectionEditor.rv(Lb),pl.OutlineReader.IXa(he))fe=Hd?wb.a.Exg:wb.a.Gwe;else{if(this.DVe&&this.DVe.E3o(he))return this.DVe.Und(he,xe.oc,Hd),32;Ad.ImageReader.N$a(he)?fe=Hd?wb.a.Dxg:wb.a.Cxg:(fe=Hd?this.Y$e.hTm(Lb,he,fe,$b):this.Y$e.gTm(Lb,he,fe),
xb.OutlineElementReader.Mh(Lb)&&he.contextId===oc.a.Xc&&(De=xb.OutlineElementReader.XA(Lb,he,!1)),eg=Gf.ListItemReader.Hg(Lb)&&De,fe!==Ce.ActionManager.eDa||Ng.TableCellReader.Yta(Lb)||eg||(this.iKh||(x.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.iKh=!0),A.AFrameworkApplication.va.Ob(wb.a.BSi,2),this.$Si($b)))}else return 2;if(!Hd&&fe===Ce.ActionManager.eDa&&Ng.TableCellReader.Yta(Lb))if(qh.returnToCell(Lb),Ng.TableCellReader.BXa(Lb)||xh.TableReader.tZi(Lb)&&Ng.TableCellReader.WZf(Lb)){if(fe=
this.iUk(),!fe)return 2}else fe=wb.a.rgj;if(fe===Ce.ActionManager.eDa)return 2;switch(fe){case wb.a.rgj:case wb.a.jle:Nc=fe===wb.a.jle;gg&&this.n5&&this.p1&&(gg=this.n5.KDf(he,-1,!0,Jd.a.xz))&&this.p1.OJj(gg);tc=32;qh.returnToCell(Lb);qh.moveToNextOrPreviousCell(Lb,Nc)&&(gg=!0,Nc=!1,pl.OutlineReader.HSf(Lb)||(Zj.OutlineNavigator.W9f(Lb,!1),Ga.OutlineElementNavigator.Le(Lb),ea.ParagraphReader.zu(Lb.currentNode)&&(gg=!1,ea.ParagraphReader.textLength(Lb.currentNode)||(Nc=!0)),Nc||qh.returnToCell(Lb)),
Nc?Lb=Oe.SelectionFactory.se(Lb.currentNode,0):(Lb=Oe.SelectionFactory.lr(Lb.currentNode),!gg&&re.SelectionEditor.gl(Lb.Uc)&&(gg=Lb.toArray(),Array.removeAt(gg,gg.length-1),Lb=new gn.Selection(gg,Lb.isForward))),je.Ic(Lb));break;case wb.a.Exg:case wb.a.Gwe:fe===wb.a.Gwe?Zj.OutlineNavigator.ufj(Lb,!1):Zj.OutlineNavigator.ufj(Lb,!0);je.Ic(Oe.SelectionFactory.lr(Lb.currentNode));tc=32;break;case wb.a.vqd:tc=A.AFrameworkApplication.va.lg($b,fe,tc,!0,Nc,dd);break;default:if(tc=A.AFrameworkApplication.va.lg($b,
fe,tc,!0,Nc,dd),!De&&gg&&(fe===wb.a.OI||fe===wb.a.fR)){const vl=re.SelectionEditor.QO(je.gb.currentSelection).y;$e.App.hvc(()=>{this.YNn(je,xe,vl)})}}32===tc&&$b.view.te&&this.tg.$G();return tc};this.Hqa=b;this.Y$e=h;this.Xn=n;this.n5=B;this.p1=L;this.$$e=ba;this.iQa=la;this.xd=La;this.Pc=fb;this.DVe=Cb}get tg(){return this.Fn||(this.Fn=this.Hqa())}Wb(){const b=A.AFrameworkApplication.va,h=this.$fp;b.fb(wb.a.tab,oc.a.view,h,1124);b.fb(wb.a.SBg,oc.a.view,h,1124);b.ra(wb.a.BSi,oc.a.view,Ce.ActionManager.Zf)}YNn(b,
h,n){if(b&&h){var B=b.gb.currentSelection;re.SelectionEditor.QO(B).y<n?(h=re.SelectionEditor.F0c(h,B,!1),h=re.SelectionEditor.XAa(h,{jC:!1,Kt:!1,qE:!1,$F:!0})):h=re.SelectionEditor.G0c(h,B,!1);b.Ic(h)}}iUk(){return wb.a.H$a}$Si(){}Qdd(b,h,n){if(b&&h){var B=b.gb.currentSelection;re.SelectionEditor.QO(B).y<n?(h=re.SelectionEditor.F0c(h,B,!1),h=re.SelectionEditor.XAa(h,{jC:!1,Kt:!1,qE:!1,$F:!0})):h=re.SelectionEditor.XAa(B,{jC:!1,Kt:!1,qE:!1,$F:!0});b.Ic(h)}}static get mg(){return Pd.a.instance}}Object(u.a)(gC,
"TabActor",null,[]);class nI{constructor(b){this.gJc=b}get Sr(){return this.gJc}Pfo(b){return b}hTm(b,h,n,B){B=B.view;const L=B.lb.gb.currentSelection;if(Ng.TableCellReader.Yta(b))return this.nZi(b,h)?wb.a.OI:wb.a.jle;Ga.OutlineElementNavigator.he(b);if(re.SelectionEditor.mf(h))xb.OutlineElementReader.XA(b,h,!1)&&this.cTj(b)?n=wb.a.gYb:re.SelectionEditor.gge(B,L)&&this.Sr.pLb(b)?n=wb.a.OI:re.SelectionEditor.gge(B,L)&&(n=wb.a.OI);else if(re.SelectionEditor.am(h)){if(!this.Sr.pLb(b))return n;re.SelectionEditor.atb(h)?
n=wb.a.OI:re.SelectionEditor.x3i(h)&&(n=this.cTj(b)?wb.a.gYb:wb.a.OI)}else this.Sr.pLb(b)&&(n=wb.a.OI);return n}gTm(b,h,n){if(Ng.TableCellReader.G3(b))return this.nZi(b,h)?wb.a.fR:n;Ga.OutlineElementNavigator.he(b);if(re.SelectionEditor.mf(h))xb.OutlineElementReader.XA(b,h,!1)&&(!Gf.ListItemReader.Hg(b)&&xb.OutlineElementReader.isEmpty(b,!1)?n=Ce.ActionManager.eDa:this.v1o(b)?n=wb.a.wob:this.pSj(b)?n=wb.a.pNb:this.Sr.tec(b)&&(n=wb.a.fR));else if(re.SelectionEditor.am(h)){if(!this.Sr.tec(b))return n;
re.SelectionEditor.atb(h)?n=wb.a.fR:re.SelectionEditor.x3i(h)&&(n=this.pSj(b)?wb.a.pNb:wb.a.fR)}else this.Sr.tec(b)&&(n=wb.a.fR);return n}cTj(b){return Gf.ListItemReader.Hg(b)?!1:0<xb.OutlineElementReader.v7(b)?!0:!1}pSj(b){if(Gf.ListItemReader.Hg(b))return!1;const h=xb.OutlineElementReader.v7(b);b=pl.OutlineReader.K_(b.currentNode);return h<b?!0:!1}v1o(b){return Gf.ListItemReader.Hg(b)?!1:0<xb.OutlineElementReader.pI(b)?!0:!1}static Xs(){return new nI(Hv.a.oQb)}nZi(b,h){if(this.bpn){const n=new ve.GraphIterator;
n.hd(b);Ga.OutlineElementNavigator.he(n);if(Gf.ListItemReader.Hg(n)&&xb.OutlineElementReader.XA(n,h,!1))return!0}return!1}get bpn(){var b;A.AFrameworkApplication.Ld("egdi3422;7g6fa693");return null===(b=A.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(u.a)(nI,"TabActorPromoteDemoteStrategy",null,[434]);class hC extends gC{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc){super(b,h,n,B,L,ba,la,La,fb,Cb);this.Ine=
(Nc,dd)=>{Nc=dd.property;!this.kld||Nc!==Lc.a.rp&&Nc!==Lc.a.marginLeft&&Nc!==Lc.a.marginRight||this.kld.TUi()};this.K_=(Nc,dd,Hd,xe,je)=>{Nc=pl.OutlineReader.K_(this.wEm(dd));je.defaultTabStop=Nc;return 32};this.z9b=Lb;this.ga=tc;this.LE();this.ga.ra(Dc.a.K_,oc.a.view,this.K_)}get kld(){return null!=this.x3g?this.x3g:this.x3g=Ya.a.instance.Oa("WordEditor.Actors.RenderParagraphsContainingTabs")}LE(){this.z9b.Il.Ve(10).fo(this.Ine)}$Si(b){const h=b.view,n=h.lb;b=n.Og;if(this.iQa&&this.Pc){var B=this.Pc.Mc(15);
B.Ab(b.node);b.contextId===oc.a.Bd&&A.AFrameworkApplication.va.Ob(wb.a.SJ,2);this.iQa.tce(n.Og);B.dispose();var L=re.SelectionEditor.QO(n.gb.currentSelection).y;$e.App.hvc(()=>{this.Qdd(n,h,L)})}}wEm(b){return b.view.lb.gb.currentSelection.Ra.node}static get instance(){return null!=hC.A_g?hC.A_g:hC.A_g=hC.Qm()}static Qm(){return new hC(()=>Ya.a.instance.resolve("Box4.IUndoManager"),nI.Xs(),Ya.a.instance.Qa("Box4.IExternalSelectionManager"),Ya.a.instance.resolve("Box4.IAutoCorrectRules"),Ya.a.instance.resolve("Box4.IAutoCorrectScheduler"),
Ya.a.instance.Oa("Box4.ITabPresenterFactory"),Ya.a.instance.Oa("Box4.IBlobEditor"),Ya.a.instance.Oa("Box4.IFeatureHelper"),Ya.a.instance.Oa("Box4.Graph.GraphTransactionFactory"),Ya.a.instance.Oa("Box4.Actors.IIFrameFocusStrategy"),$e.App.jf,Ya.a.instance.Oa("Box4.ITabRenderer"),A.AFrameworkApplication.va)}}Object(u.a)(hC,"TabActor",gC,[]);class Wt{static get Wu(){return null!=Wt.MTg?Wt.MTg:Wt.MTg=Ya.a.instance.resolve("Box4.IAppFrame")}static initialize(){Sp.a.gpc=Wt.dqn;Zb.a.instance.Cw(Wt.Ckl)}static Ckl(){Wt.HGp()}static dqn(b){return!xh.TableReader.Mkn(b)}static yvb(){Wt.Wu.vvc(Wt.yvb);
Wt.qGb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static HGp(){var b,h,n;((null===(b=dt.a.instance.currentSelection)||void 0===b?0:b.eMa)||(null===(h=dt.a.instance.currentSelection)||void 0===h?0:h.Pw)||(null===(n=dt.a.instance.currentSelection)||void 0===n?0:n.Nab))&&!Wt.qGb&&(Wt.Wu.$5a(Wt.yvb),Wt.qGb=!0)}}Wt.qGb=!1;Object(u.a)(Wt,"TableActor",
null,[]);var OD=d(383),jM=d(718),oI=d(1023);class ti{static get bPa(){return null!=ti.J5g?ti.J5g:ti.J5g=tp.a.instance}static get Md(){return null!=ti.m6g?ti.m6g:ti.m6g=Ya.a.instance.Oa("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get $Zj(){ti.rJ||(ti.rJ=new Tr("TableBorder"),ti.pta(ti.rJ));return ti.rJ}static get kB(){ti.Hya||(ti.Hya=Ya.a.instance.Oa("WordEditor.ITableBorderManager"),ti.Hya.initialize());return ti.Hya}static Wb(){const b=A.AFrameworkApplication.va,h=$e.App.n0a.zXc(n=>
ti.pem(n));b.ra(wb.a.pzb,oc.a.view,ti.Qdb);b.ra(wb.a.pzb,oc.a.table,ti.Pdb);b.Rc(wb.a.pzb,4);b.ra(wb.a.Xeb,oc.a.view,ti.Qdb);b.ra(wb.a.Xeb,oc.a.table,ti.Pdb);b.Rc(wb.a.Xeb,4);b.ra(wb.a.Yeb,oc.a.view,ti.Qdb);b.ra(wb.a.Yeb,oc.a.table,ti.Pdb);b.Rc(wb.a.Yeb,4);b.ra(wb.a.uzb,oc.a.view,ti.Qdb);b.ra(wb.a.uzb,oc.a.table,ti.Pdb);b.Rc(wb.a.uzb,4);b.ra(wb.a.rzb,oc.a.view,ti.Qdb);b.ra(wb.a.rzb,oc.a.table,ti.Pdb);b.Rc(wb.a.rzb,4);b.ra(wb.a.szb,oc.a.view,ti.Qdb);b.ra(wb.a.szb,oc.a.table,ti.Pdb);b.Rc(wb.a.szb,4);
b.ra(wb.a.tzb,oc.a.view,ti.Qdb);b.ra(wb.a.tzb,oc.a.table,ti.Pdb);b.Rc(wb.a.tzb,4);b.ra(wb.a.qzb,oc.a.view,ti.Qdb);b.ra(wb.a.qzb,oc.a.table,ti.Pdb);b.Rc(wb.a.qzb,4);b.ra(wb.a.PTa,oc.a.view,ti.Qdb);b.ra(wb.a.PTa,oc.a.table,ti.Pdb);b.Rc(wb.a.PTa,4);b.ra(wb.a.Rqe,oc.a.view,ti.Rqe);b.ra(wb.a.wha,oc.a.view,ti.Eye);b.ra(wb.a.wha,oc.a.H4,ti.Dye);b.ra(wb.a.wha,oc.a.b1,ti.Fye);b.Rc(wb.a.wha,4);b.ra(wb.a.hvb,oc.a.view,ti.Eye);b.ra(wb.a.hvb,oc.a.H4,ti.Dye);b.ra(wb.a.hvb,oc.a.b1,ti.Fye);b.Rc(wb.a.hvb,4);b.ra(wb.a.pig,
oc.a.view,ti.hca);b.Rc(wb.a.pig,4);b.ra(wb.a.leb,oc.a.view,ti.Eye);b.ra(wb.a.leb,oc.a.H4,ti.Dye);b.ra(wb.a.leb,oc.a.b1,ti.Fye);b.Rc(wb.a.leb,4);b.fb(wb.a.huc,oc.a.view,ti.huc,1124);b.ra(wb.a.meb,oc.a.view,ti.Eye);b.ra(wb.a.meb,oc.a.H4,ti.Dye);b.ra(wb.a.meb,oc.a.b1,ti.Fye);b.Rc(wb.a.meb,4);b.fb(wb.a.iuc,oc.a.view,ti.iuc,1124);b.ra(wb.a.adb,oc.a.view,h);b.ra(wb.a.adb,oc.a.H4,ti.adb);b.ra(wb.a.adb,oc.a.b1,ti.adb);b.Rc(wb.a.adb,97)}static NS(){A.AFrameworkApplication.K&&A.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&
window.setTimeout(()=>{const b=Ya.a.instance.Qa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}static Qdb(b,h,n,B){if(1===n)return 32;if(!h.view.te)return 2;const L=h.view;if(!L.lb||!L.lb.gb)return 8;h=L.lb.gb;if(2===n){x.ULS.sendTraceTag(578027873,306,50,"Selecting table border using border gallery");if((n=Oe.SelectionFactory.Xsd(h))&&xh.TableReader.HU(n))return A.AFrameworkApplication.va.lg(Nd.a.create(n),
b,2,!1,B,null);n=L.lb.Og;if(!n)return 8;B=Object(el.a)().oU(n,16);n=Object(el.a)().EW(n,14);if(!n)return Sp.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],hf.a.Isb),8;if(!ti.xKg(n.node,B,h))return 8;b=oI.getTableCellBorderContext(Rr.TableBorderSelectionCache.Eca,Rr.TableBorderSelectionCache.rWa(),b);if(!b||0>=b.length)return Sp.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],hf.a.Isb),8;Rr.TableBorderSelectionCache.Eyb(b);b=Oe.SelectionFactory.IMb(b,
!0);h=null;b&&(h=Oe.SelectionFactory.Lra(b));if(!h||0>=h.currentSelection.length)return Sp.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],hf.a.Isb),8;Zb.a.instance.Y0(h)}return 32}static Pdb(b,h,n){if(1===n)return 32;if(2!==n||14!==h.node.type)return 2;b=oI.getTableBorderContext(h.node,b);if(!b)return Sp.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],hf.a.Isb),8;b=Oe.SelectionFactory.egc(b,!0);h=null;b&&(h=Oe.SelectionFactory.Lra(b));if(!h||0>=
h.currentSelection.length)return Sp.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],hf.a.Isb),8;Zb.a.instance.Y0(h);return 32}static Rqe(b,h,n,B,L){if(1===n)return 32;b=h.contextId===oc.a.view?Gm.PageReader.instance.Nkc(h):OD.a.FMf(h);if(!b)return 8;h=new qw;n="";32===A.AFrameworkApplication.va.Pb(wb.a.adb,2,h)&&h&&(n=h.borderColor);ti.$Zj.Ana=n;b=ti.$Zj.cPb(b,$e.App.W6a);if(!b)return 8;L.MenuItems=b;x.ULS.sendTraceTag(578027874,340,50,"Table border color dropdown menu is opened.");
return 32}static Eye(b,h,n,B,L){if(!ti.kB)return 2;if(1===n)return 32;if(!h.view.te)return 2;var ba=h.view;if(!ba.lb||!ba.lb.gb)return 8;h=ba.lb.gb;if(2===n){x.ULS.sendTraceTag(578027875,306,50,"Setting table border property for the command: {0} with action data {1}",b,ti.Q1c(b,L));n=Oe.SelectionFactory.I4j(h);if(!n){const la=Oe.SelectionFactory.Xsd(h);la&&14===la.type&&(n=Xm.TableNodeBorderContext.qka(la,4))}if(n)return A.AFrameworkApplication.va.lg(n,b,2,!0,B,L);n=Oe.SelectionFactory.UKg(h);if(!n||
0>=n.length){n=ba.lb.Og;if(!n)return 8;ba=Object(el.a)().oU(n,16);n=Object(el.a)().EW(n,14);if(!n||!ti.xKg(n.node,ba,h))return 8;n=oI.getTableCellBorderContext(Rr.TableBorderSelectionCache.Eca,Rr.TableBorderSelectionCache.rWa(),wb.a.PTa);if(!n||0>=n.length)return 8}ba=Uz.a.uJa(n);if(!ba)return 8;ti.NS();h=new Sd.GraphTransaction(15);h.Ab(n[0].node);h.yi=b;b=A.AFrameworkApplication.va.lg(ba,b,2,!0,B,L);h.dispose();return b}return 32}static Dye(b,h,n,B,L){if(!ti.kB)return 2;if(1===n)return 32;if(2!==
n||h.contextId!==oc.a.H4)return Sp.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],hf.a.H2d),2;x.ULS.sendTraceTag(578027904,306,50,"Setting table border property for the table border for the command: {0} with action data {1}",b,ti.Q1c(b,L));n=h.node;B=new ko;let ba=0;({a_j:B,property:ba}=ti.obi(n,b,L,B,ba));ti.NS();L=!0;const la=new Sd.GraphTransaction(15);la.Ab(n);la.yi=b;if(L=ti.kB.hRo(h,B,ba))b=new ve.GraphIterator,b.set(n),qh.forEachCellInTable(b,La=>{La.currentNode.om(4,
!0);return!0});la.dispose();L&&ti.Md&&ti.Md.$t(16);return L?32:(Sp.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],hf.a.H2d),8)}static Fye(b,h,n,B,L){if(!ti.kB)return 2;if(1===n)return 32;if(2!==n||h.contextId!==oc.a.b1)return Sp.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],hf.a.H2d),2;x.ULS.sendTraceTag(578027905,306,50,"Setting table border property for the cell border for the command: {0} with action data {1}",b,ti.Q1c(b,L));n=h.node;B=new ko;
let ba=0;({a_j:B,property:ba}=ti.obi(n,b,L,B,ba));(b=ti.kB.gzg(Hm.a.hX(h),h,B,ba))&&ti.Md&&ti.Md.$t(16);return b?32:(Sp.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],hf.a.H2d),8)}static hca(b,h,n){if(1===n)return 32;Ua.StaticActiveAppFrame.za().dismissFloatie();ti.TFa=new Tv("TableBorder",wb.a.wha);ti.TFa.H0b(0);return 32}static huc(b,h,n,B,L){if(!ti.kB)return 8;if(1===n)return 32;b=ti.kB.tGf();L.MenuItems=b;return 32}static iuc(b,h,n,B,L){if(!ti.kB)return 8;if(1===n)return 32;
b=ti.kB.uGf();L.MenuItems=b;return 32}static adb(b,h,n,B,L){if(!ti.kB)return 2;if(!re.SelectionEditor.jad(h)&&!re.SelectionEditor.kad(h))return 8;b=Object(ya.a)(qw,L);if(!b)return 8;re.SelectionEditor.jad(h)?ti.kB.alo(h,b):ti.kB.yjo(h,b);return 32}static xKg(b,h,n){if(!b||14!==b.type)return x.ULS.sendTraceTag(578027906,306,15,"Table node must be present"),!1;if(!h)return x.ULS.sendTraceTag(578027907,306,15,"Cell context must be present"),!1;if(n&&n.currentSelection&&n.currentSelection.Xe&&n.currentSelection.Xe.Ra&&
n.currentSelection.Xe.Ra.contextId===oc.a.b1&&Rr.TableBorderSelectionCache.rWa()&&0<Rr.TableBorderSelectionCache.rWa().length)return!0;Rr.TableBorderSelectionCache.O7c(b);n=Rr.TableBorderSelectionCache.Eca;for(let L=0;L<h.length;L++){if(h.getContext(L).contextId!==oc.a.Sx)return!1;const ba=h.getContext(L).node;if(!Ng.TableCellReader.$s(ba)){var B=new ve.GraphIterator;B.set(ba);if(B.zb(14)&&qh.getContainingTable(B)===b){B.ld(14);B=Ng.TableCellReader.DKa(B,ba);if(!B)return!1;Array.add(Rr.TableBorderSelectionCache.rWa(),
new jM.a(ba,B.rowIndex,B.np,ba.rowSpan,ba.colSpan));n.leftMostColumnSelected=Math.min(n.leftMostColumnSelected,B.np);n.rightMostColumnSelected=Math.max(n.rightMostColumnSelected,B.np);n.topMostRowSelected=Math.min(n.topMostRowSelected,B.rowIndex);n.bottomMostRowSelected=Math.max(n.bottomMostRowSelected,B.rowIndex)}}}Rr.TableBorderSelectionCache.Eca=n;return!0}static pta(b){b.PQ(3,wb.a.wha);b.PQ(4,wb.a.wha);b.bmb(zy.a.instance,1)}static pem(b){const h=b.gb;var n=Oe.SelectionFactory.I4j(h);if(!n){const B=
Oe.SelectionFactory.Xsd(h);B&&14===B.type&&(n=Xm.TableNodeBorderContext.qka(B,4))}if(n)return Uz.a.uJa([n]);n=Oe.SelectionFactory.UKg(h);if(!n||0>=n.length){n=b.Og;if(!n)return null;b=Object(el.a)().oU(n,16);n=Object(el.a)().EW(n,14);if(!n||!ti.xKg(n.node,b,h))return null;n=oI.getTableCellBorderContext(Rr.TableBorderSelectionCache.Eca,Rr.TableBorderSelectionCache.rWa(),wb.a.PTa);if(!n||0>=n.length)return null}return Uz.a.uJa(n)}static obi(b,h,n,B,L){switch(h){case wb.a.wha:B.color=ti.bPa.sra(b,n);
L=3;break;case wb.a.hvb:B.style="none";L=2;break;case wb.a.leb:(b="object"===typeof n?n:null)&&"MenuItemId"in b&&(B.style=ti.kB.tui(b.MenuItemId));L=2;break;case wb.a.meb:(b="object"===typeof n?n:null)&&"MenuItemId"in b&&(B.weight=ti.kB.uui(b.MenuItemId)),L=1}return{a_j:B,property:L}}static Q1c(b,h){let n="";if(!h)return n;switch(b){case wb.a.wha:n=h;break;case wb.a.hvb:n="none";break;case wb.a.leb:case wb.a.meb:(b="object"===typeof h?h:null)&&"MenuItemId"in b&&(n=b.MenuItemId)}return n}}ti.rJ=null;
ti.TFa=null;ti.Hya=null;Object(u.a)(ti,"TableBorderActor",null,[]);class pI{b$l(b,h,n,B){return b?this.B8l(h,n,B):this.c$l(h,n,B)}Toi(b,h,n,B,L){return b?this.D9l(h,n,B,L):this.q9l(h,n,B,L)}n9l(b){let h=!1;var n=b.isForward?b.Xe.Uc:b.Xe.Ra;b=new ve.GraphIterator;b.set(n.node);b.zb(14);n=null;Ng.TableCellReader.kga(b)?Ng.TableCellReader.fTb(b)||(h=!0,n=qh.moveToNextRow(b)):n=qh.moveToNextColumn(b);return{returnValue:n,qOn:h}}y9l(b){var h=b.isForward?b.Xe.Uc:b.Xe.Ra;const n=new ve.GraphIterator;n.set(h.node);
n.zb(14);h=null;Ng.TableCellReader.Rla(n)?Ng.TableCellReader.Qla(n)||(h=new ve.GraphIterator,h.set(b.Fza.node),h.zb(14),b=Le.a.Jt(h),Le.a.Jt(n)>b?(qh.moveToPreviousRow(n),qh.moveToLastColumn(n),h=n.currentNode):h=qh.moveToPreviousRow(n)):h=qh.moveToPreviousColumn(n);return h}fpi(b,h){var n=b.isForward?b.Xe.Uc:b.Xe.Ra;b=new ve.GraphIterator;b.set(n.node);b.zb(14);n=null;h?Ng.TableCellReader.Qla(b)||(n=qh.moveToPreviousRow(b)):Ng.TableCellReader.fTb(b)||(n=qh.moveToNextRow(b));return n}XTb(b,h,n){for(;Ng.TableCellReader.Wg(b);)if(h){if(n&&
b.qCa(1)||!n&&b.wCa(1))return null;n?qh.moveToPreviousColumn(b):qh.moveToNextColumn(b)}else{if(Ng.TableCellReader.T7(b.currentNode)){const B=new ve.GraphIterator;B.hd(b);if(this.XTb(B,!0,!0)||this.XTb(B,!0,!1)){b.hd(B);break}}else{if(!n&&qh.moveToControllingCell(b,2))break;if(n&&qh.moveToControllingCell(b))break}if(n&&Ng.TableCellReader.Qla(b)||!n&&Ng.TableCellReader.fTb(b))return null;n?qh.moveToPreviousRow(b):qh.moveToNextRow(b)}return b.currentNode}Kic(b,h){if(!Le.a.isTableRow(b))return null;b=
ve.GraphIterator.eb(b.currentNode);b.zb(14);let n;const B=xh.TableReader.rD(b.origin);do n=h?qh.moveToPreviousRow(b):qh.moveToNextRow(b);while(B&&n&&Le.a.tXa(b));return n}Yub(b,h,n,B,L){let ba=null;Ga.OutlineElementNavigator.he(b);const la=xb.OutlineElementReader.isRtl(b.currentNode);if(n)if(qh.returnToCell(b),h=Ng.TableCellReader.kga(b),n=Ng.TableCellReader.Rla(b),L||!la&&n||la&&B&&h)qh.returnToContainingRow(b),(B=this.Kic(b,!0))?ba=Oe.SelectionFactory.pp(B,!h):L&&(Ga.OutlineElementNavigator.he(b),
L=new Ml.a,L.hd(b),(b=Ga.OutlineElementNavigator.Y3(L,!1,!1))&&(ba=Oe.SelectionFactory.pp(b,!1)));else{do la?qh.moveToNextColumn(b):qh.moveToPreviousColumn(b);while(Ng.TableCellReader.Wg(b)&&!Ng.TableCellReader.Qla(b));Ng.TableCellReader.Wg(b)||(ba=Oe.SelectionFactory.pp(b.currentNode,!la))}else xb.OutlineElementReader.XA(b,h,la)||re.SelectionEditor.mf(h)||qh.returnToCell(b),ba=Oe.SelectionFactory.pp(b.currentNode,!la);return ba}Xub(b,h,n,B,L){let ba=null;Ga.OutlineElementNavigator.he(b);const la=
xb.OutlineElementReader.isRtl(b.currentNode);if(n)if(qh.returnToCell(b),n=Ng.TableCellReader.kga(b),h=Ng.TableCellReader.Rla(b),L||!la&&B&&n||la&&!B&&h)qh.returnToContainingRow(b),(B=this.Kic(b,!1))?ba=Oe.SelectionFactory.pp(B,h):(Ga.OutlineElementNavigator.he(b),B=new Ml.a,B.hd(b),(b=Ga.OutlineElementNavigator.ht(B,!1,!1))&&(ba=Oe.SelectionFactory.pp(b,!0)));else{do la?qh.moveToPreviousColumn(b):qh.moveToNextColumn(b);while(Ng.TableCellReader.Wg(b)&&!Ng.TableCellReader.kga(b));Ng.TableCellReader.Wg(b)||
(ba=Oe.SelectionFactory.pp(b.currentNode,la))}else xb.OutlineElementReader.XA(b,h,!la)||re.SelectionEditor.mf(h)||qh.returnToCell(b),ba=Oe.SelectionFactory.pp(b.currentNode,la);return ba}}Object(u.a)(pI,"ATableCellSelectionStrategy",null,[1802]);class qI extends pI{constructor(){super()}q9l(b,h,n,B){let L=b.currentSelection,ba=null;if(b.Pw)if(h)if(2===L.Xe.Ama&&!L.isForward&&L.Xe.Uc.equals(L.Fza))L=Oe.SelectionFactory.ebi(L.Fza.node,!1);else{var la=({qOn:b}=this.n9l(L)).returnValue;la&&(Ng.TableCellReader.$s(la)&&
(la=ve.GraphIterator.eb(la),la.zb(14),la=!b&&this.XTb(la,!0,!1)?la.currentNode:b||qh.moveToNextRow(la)?this.XTb(la,!1,!1):null),la&&(ba=Oe.SelectionFactory.Fo(kf.TableNodeContext.create(la),L.isForward)))}else L=b.Nha,b=ve.GraphIterator.eb(L.Xe.Uc.node),b.zb(14),Ng.TableCellReader.NLa(b.currentNode)&&qh.moveToLastGhostCell(b,2),(la=qh.moveToNextColumn(b))?(b=Ng.TableCellReader.T7(la),Ng.TableCellReader.$s(la)&&!b&&(la=ve.GraphIterator.eb(la),la.zb(14),la=qh.moveToControllingCell(la)),b?L=Oe.SelectionFactory.pp(L.Xe.Uc.node,
!1):ba=Oe.SelectionFactory.pp(la,!0)):(la=L.Xe.Uc.node,ba=Oe.SelectionFactory.pp(la,!1));else b=h&&L.isForward||!h&&!L.$ta?L.Xe.Uc:L.Xe.Ra,Le.a.gma(b.node)&&(b=ve.GraphIterator.eb(b.node),(la=this.Kic(b,!1))?ba=h?Oe.SelectionFactory.Fo(kf.TableNodeContext.create(la),L.isForward):Oe.SelectionFactory.pp(la,!0):L=re.SelectionEditor.Wj(Oe.SelectionFactory.lr(b.currentNode),!1,!0));return ba?ba:B?re.SelectionEditor.Jic(L,!1,h,!0):re.SelectionEditor.XAa(L,{jC:!h,Kt:h,qE:n,$F:!0})}D9l(b,h,n,B){let L=b.currentSelection;
var ba=null;if(b.Pw)h?1===L.Xe.Ama&&L.isForward&&L.Xe.Ra.equals(L.Fza)||(ba=this.y9l(L),(ba=this.Roi(L,ba))||L.isForward&&(L=L.c1c())):(L=b.Nha,ba=Oe.SelectionFactory.pp(L.Xe.Ra.node,!0));else if(h){var la=(L.isForward?L.Xe.Uc:L.Xe.Ra).node;b=ve.GraphIterator.eb(la);re.SelectionEditor.rv(b);Le.a.gma(la)&&(L.isForward&&1===L.Xe.Ama&&L.$ta?(ba=Le.a.OA(la).toArray(),(ba=this.Roi(L,0<=ba.length-2?ba[ba.length-2]:null))||L.isForward&&(L=L.c1c())):(la=this.Kic(b,!0))?ba=Oe.SelectionFactory.Fo(kf.TableNodeContext.create(la),
L.isForward):L=Oe.SelectionFactory.pp(b.currentNode,!0))}else ba=re.SelectionEditor.Wj(L,!0,!1);return ba?ba:B?re.SelectionEditor.Jic(L,!0,h,!0):re.SelectionEditor.YAa(L,{jC:!h,Kt:h,qE:n,$F:!0})}Roi(b,h){if(!h)return null;var n=h;Ng.TableCellReader.$s(h)&&(n=ve.GraphIterator.eb(h),n.zb(14),n=this.XTb(n,!0,!0)?n.currentNode:Ng.TableCellReader.Ska(h));return n?Oe.SelectionFactory.Fo(kf.TableNodeContext.create(n),b.isForward):null}c$l(b,h,n){let B=h.currentSelection,L=null;if(h.Pw){var ba=h.t_>h.SOa;
if(n)if(2===h.length&&1===h.Nha.Xe.Ama&&ba)B=re.SelectionEditor.Wj(B,!0,!1);else{if(h=this.fpi(B,!0))Ng.TableCellReader.$s(h)&&(h=ve.GraphIterator.eb(h),h.zb(14),h=this.XTb(h,!1,!0)),h&&(L=Oe.SelectionFactory.Fo(kf.TableNodeContext.create(h),B.isForward));L||B.isForward&&(B=B.c1c())}else ba&&(B=h.Nha)}else h=n&&B.isForward?B.Xe.Uc:B.Xe.Ra,Le.a.gma(h.node)&&(h=ve.GraphIterator.eb(h.node),(ba=this.Kic(h,!0))?L=n?Oe.SelectionFactory.Fo(kf.TableNodeContext.create(ba),B.isForward):Oe.SelectionFactory.pp(ba,
!0):n&&(B=Oe.SelectionFactory.pp(h.currentNode,!0)));return L?L:re.SelectionEditor.bob(b,B,!1,n,n)}B8l(b,h,n){let B=h.currentSelection,L=null;if(h.Pw){const ba=h.t_<h.SOa;if(n)if(2===h.length&&1===h.Nha.Xe.Ama&&ba)B=re.SelectionEditor.Wj(B,!1,!1);else{if(h=this.fpi(B,!1))Ng.TableCellReader.$s(h)&&(h=ve.GraphIterator.eb(h),h.zb(14),h=this.XTb(h,!1,!1)),h&&(L=Oe.SelectionFactory.Fo(kf.TableNodeContext.create(h),B.isForward))}else ba&&(B=h.Nha)}else h=!n||B.isForward?B.Xe.Uc:B.Xe.Ra,Le.a.gma(h.node)&&
(h=ve.GraphIterator.eb(h.node),(h=this.Kic(h,!1))&&(L=n?Oe.SelectionFactory.Fo(kf.TableNodeContext.create(h),B.isForward):Oe.SelectionFactory.pp(h,B.$ta)));return L?L:re.SelectionEditor.bob(b,B,!0,n,n)}}Object(u.a)(qI,"TableCellSelectionStrategy",pI,[]);class kM{constructor(b){this.lM=(h,n,B,L,ba)=>{if(1===B)return 32;h=(new yl.a).create();n="";switch(ba.DialogType){case "DirectPrintPreparingPDF":n=CommonUIStrings.l_DirectPrintPreparingPDF;ba=CommonUIStrings.l_DefaultDialogTitle;break;default:ba=
CommonUIStrings.l_DefaultDialogTitle}h.message=n;h.lM(ba,null,null);return 32};this.ga=b}Wb(){this.ga.fb(wb.a.lM,oc.a.view,this.lM,1028)}}Object(u.a)(kM,"UIAutomationActor",null,[]);class lM{constructor(b,h,n,B){this.jb=b;this.iQa=h;this.VDc=n;this.e$=B}DKg(b,h,n){return this.VDc.Nnn(h)?n?!0:b&&this.jb.Bh(b)?(b=this.zx(b.currentNode),this.iQa.lTi(b),!0):!1:!1}YRf(b,h){return this.VDc.Q2l(b,h)}dSf(b){b&&this.jb.Bh(b)&&(b=this.zx(b.currentNode),this.iQa.tce(b))}zx(b){return Nd.a.zx(b)}Mca(b,h,n){this.e$.qsj&&
this.VDc.QXi(n)&&(this.e$.Mca(b,h),b.setValue(zd.a.iYi,!0))}M_b(){}vee(b){return this.VDc.vee(b)}get Hfe(){return this.VDc.Hfe}QE(){}vha(){}Aye(){}get zTj(){return!1}}Object(u.a)(lM,"WordEditorPasteStewardBridge",null,[420]);class cO{constructor(b){this.sa=new mg.a;this.cJj="WordFileSaveAsButtonClicked";this.JGp=()=>{this.sa.raiseEvent(this.cJj,null);return 32};this.ga=b}Wb(){A.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.ra(Dc.a.gck,id.a.frame,this.JGp)}S1k(b){this.sa.addHandler(this.cJj,
b)}}Object(u.a)(cO,"WordFileSaveAsActor",null,[]);class mM extends jn{constructor(){super()}uTc(b,h,n,B,L,ba,la){return Ks.a.Stc(h,n,B,L,ba,la)}}Object(u.a)(mM,"WordIndentationActorExtension",jn,[]);class nM{constructor(b){this.uYa=b;this.ixc=()=>32;this.ffe=(h,n,B)=>{if(1===B)return 1===this.uYa.Ax?32:8}}Wb(){const b=A.AFrameworkApplication.va;b.ra(wb.a.ixc,oc.a.view,this.ixc);b.ra(wb.a.ffe,oc.a.view,this.ffe)}}Object(u.a)(nM,"LineNumberingActor",null,[]);class bG{constructor(b,h,n,B,L){this.Sb=
b;this.bPa=h;this.xcb=n;this.eY=B;this.Yo=L;this.TFa=this.rJ=null;this.ood=(ba,la,La)=>{if(1===La)return 32;la=this.Ssa(la);if(0===la.length)return 8;if(this.zIa(la))return this.Sb.Ob(wb.a.pzb,La);La=this.vqb(la);const fb=this.Yo.Mc(15);fb.Ab(la[0]);fb.yi=ba;for(const Cb of la)this.xcb.eyb(Cb,[1],La);fb.dispose();return 32};this.uod=(ba,la,La)=>{if(1===La)return 32;la=this.Ssa(la);if(0===la.length)return 8;if(this.zIa(la))return this.Sb.Ob(wb.a.uzb,La);La=this.vqb(la);const fb=this.Yo.Mc(15);fb.Ab(la[0]);
fb.yi=ba;for(const Cb of la)this.xcb.eyb(Cb,[0],La);fb.dispose();return 32};this.qod=(ba,la,La)=>{if(1===La)return 32;la=this.Ssa(la);if(0===la.length)return 8;if(this.zIa(la))return this.Sb.Ob(wb.a.Xeb,La);La=this.vqb(la);const fb=this.Yo.Mc(15);fb.Ab(la[0]);fb.yi=ba;for(const Cb of la)this.xcb.eyb(Cb,[2],La);fb.dispose();return 32};this.tod=(ba,la,La)=>{if(1===La)return 32;la=this.Ssa(la);if(0===la.length)return 8;if(this.zIa(la))return this.Sb.Ob(wb.a.Yeb,La);La=this.vqb(la);const fb=this.Yo.Mc(15);
fb.Ab(la[0]);fb.yi=ba;for(const Cb of la)this.xcb.eyb(Cb,[3],La);fb.dispose();return 32};this.lod=(ba,la,La)=>{ba=this.Ssa(la);if(0===ba.length)return 8;ba=this.zIa(ba);return 1===La&&ba?32:1!==La||ba?ba?this.Sb.Ob(wb.a.rzb,La):8:8};this.nod=(ba,la,La)=>{ba=this.Ssa(la);if(0===ba.length)return 8;ba=this.zIa(ba);return 1===La&&ba?32:1!==La||ba?ba?this.Sb.Ob(wb.a.szb,La):8:8};this.sod=(ba,la,La)=>{if(1===La)return 32;la=this.Ssa(la);if(0===la.length)return 8;if(this.zIa(la))return this.Sb.Ob(wb.a.tzb,
La);La=this.vqb(la);const fb=this.Yo.Mc(15);fb.Ab(la[0]);fb.yi=ba;for(const Cb of la)this.xcb.eyb(Cb,[0,1,2,3],La);fb.dispose();return 32};this.pod=(ba,la,La)=>{if(1===La)return 32;la=this.Ssa(la);if(0===la.length)return 8;if(this.zIa(la))return this.Sb.Ob(wb.a.qzb,La);La=this.vqb(la);const fb=this.Yo.Mc(15);fb.Ab(la[0]);fb.yi=ba;for(const Cb of la)this.xcb.eyb(Cb,[4],La);fb.dispose();return 32};this.kod=(ba,la,La)=>{if(1===La)return 32;la=this.Ssa(la);if(0===la.length)return 8;if(this.zIa(la))return this.Sb.Ob(wb.a.PTa,
La);La=this.vqb(la);const fb=this.Yo.Mc(15);fb.Ab(la[0]);fb.yi=ba;for(const Cb of la)this.xcb.eyb(Cb,[0,1,2,3,4],La);fb.dispose();return 32};this.rod=(ba,la,La)=>{if(1===La)return 32;la=this.Ssa(la);if(0===la.length)return 8;if(this.zIa(la))return this.Sb.Ob(wb.a.hvb,La);La=this.Yo.Mc(15);La.Ab(la[0]);La.yi=ba;for(const fb of la)this.xcb.Xql(fb);La.dispose();return 32};this.Nqe=(ba,la,La,fb,Cb)=>{var Lb;if(1===La)return 32;ba=Gm.PageReader.instance.Nkc(la);if(!ba)return 8;la=this.Ssa(la);la=null!==
(Lb=this.IMf(la))&&void 0!==Lb?Lb:this.eY.R2c();this.Brj.Ana=Nl.a.VC(la.color);Lb=this.Brj.cPb(ba,$e.App.W6a);if(!Lb)return 8;Cb.MenuItems=Lb;return 32};this.cpg=(ba,la,La,fb,Cb)=>{var Lb;if(1===La)return 32;if(!Cb)return 0;la=this.Ssa(la);la=null!==(Lb=this.IMf(la))&&void 0!==Lb?Lb:this.eY.R2c();switch(ba){case Dc.a.yse:ba=this.eY.Djm(la.style);Cb&&Cb.MenuItemId===ba&&(Cb[$g.a.On]=!0);break;case Dc.a.zse:ba=this.eY.Gjm(la.size);Cb&&Cb.MenuItemId===ba&&(Cb[$g.a.On]=!0);break;case Dc.a.xse:ba=this.eY.Ajm(la.space);
Cb&&Cb.MenuItemId===ba&&(Cb[$g.a.On]=!0);break;default:return 8}return 32};this.oye=(ba,la,La,fb,Cb)=>{fb=this.Ssa(la);if(0===fb.length)return 8;const Lb=this.zIa(fb);if(1===La)return Lb&&ba===Dc.a.Q_b?8:32;la=this.vqb(fb);const $b=this.Q1c(ba,Cb);switch(ba){case Dc.a.sOa:if(Lb)return this.Sb.Pb(wb.a.wha,La,$b);la.color=this.bPa.sra(fb[0],$b);break;case Dc.a.pxc:if(Lb)return this.Sb.Pb(wb.a.leb,La,Cb);la.style=this.eY.Cjm($b);break;case Dc.a.qxc:if(Lb)return this.Sb.Pb(wb.a.meb,La,Cb);la.size=this.eY.Fjm($b);
break;case Dc.a.Q_b:if(Lb)return 8;la.space=this.eY.zjm($b);break;default:return 8}La=this.Yo.Mc(15);La.Ab(fb[0]);La.yi=ba;for(const tc of fb)ba=this.eY.xui(tc),this.xcb.eyb(tc,ba,la);La.dispose();this.g6i=la;return 32};this.huc=(ba,la,La,fb,Cb)=>{if(!this.eY)return 8;if(1===La)return 32;ba=this.eY.tGf();Cb.MenuItems=ba;return 32};this.iuc=(ba,la,La,fb,Cb)=>{if(!this.eY)return 8;if(1===La)return 32;ba=this.eY.uGf();Cb.MenuItems=ba;return 32};this.rco=(ba,la,La,fb,Cb)=>{if(!this.eY)return 8;if(1===
La)return 32;ba=this.eY.Pem();Cb.MenuItems=ba;return 32};this.hca=(ba,la,La)=>{if(1===La)return 32;Ua.StaticActiveAppFrame.za().dismissFloatie();this.TFa=new Tv(bG.xnb,Dc.a.sOa);this.TFa.H0b(0);return 32};this.g6i=this.eY.R2c()}get Brj(){this.rJ||(this.rJ=new Tr(bG.xnb),this.pta());return this.rJ}pta(){this.rJ.PQ(3,Dc.a.sOa);this.rJ.PQ(4,Dc.a.sOa);this.rJ.bmb(zy.a.instance,1)}Wb(){this.jso();this.mso();this.lso()}jso(){A.AFrameworkApplication.va;this.Sb.ra(Dc.a.ood,oc.a.view,this.ood);this.Sb.Rc(Dc.a.ood,
4);this.Sb.ra(Dc.a.uod,oc.a.view,this.uod);this.Sb.Rc(Dc.a.uod,4);this.Sb.ra(Dc.a.qod,oc.a.view,this.qod);this.Sb.Rc(Dc.a.qod,4);this.Sb.ra(Dc.a.tod,oc.a.view,this.tod);this.Sb.Rc(Dc.a.tod,4);this.Sb.ra(Dc.a.lod,oc.a.view,this.lod);this.Sb.Rc(Dc.a.lod,4);this.Sb.ra(Dc.a.nod,oc.a.view,this.nod);this.Sb.Rc(Dc.a.nod,4);this.Sb.ra(Dc.a.sod,oc.a.view,this.sod);this.Sb.Rc(Dc.a.sod,4);this.Sb.ra(Dc.a.pod,oc.a.view,this.pod);this.Sb.Rc(Dc.a.pod,4);this.Sb.ra(Dc.a.kod,oc.a.view,this.kod);this.Sb.Rc(Dc.a.kod,
4);this.Sb.ra(Dc.a.rod,oc.a.view,this.rod);this.Sb.Rc(Dc.a.rod,4)}mso(){this.Sb.ra(Dc.a.Nqe,oc.a.view,this.Nqe);this.Sb.ra(Dc.a.sOa,oc.a.view,this.oye);this.Sb.Rc(Dc.a.sOa,4);this.Sb.ra(Dc.a.yse,oc.a.view,this.cpg);this.Sb.ra(Dc.a.pxc,oc.a.view,this.oye);this.Sb.Rc(Dc.a.pxc,4);this.Sb.fb(Dc.a.Xtj,oc.a.view,this.huc,1124);this.Sb.ra(Dc.a.zse,oc.a.view,this.cpg);this.Sb.ra(Dc.a.qxc,oc.a.view,this.oye);this.Sb.Rc(Dc.a.qxc,4);this.Sb.fb(Dc.a.Ytj,oc.a.view,this.iuc,1124);this.Sb.ra(Dc.a.xse,oc.a.view,
this.cpg);this.Sb.ra(Dc.a.Q_b,oc.a.view,this.oye);this.Sb.Rc(Dc.a.Q_b,4);this.Sb.fb(Dc.a.Wtj,oc.a.view,this.rco,1124)}lso(){this.Sb.ra(Dc.a.nig,oc.a.view,this.hca);this.Sb.Rc(Dc.a.nig,4)}Ssa(b){b=dt.a.dKf(b);const h=[];for(const n of b)ea.ParagraphReader.Xb(n.node)&&h.push(n.node);return h}IMf(b){if(0!==b.length){var h=this.eY.wui(b[0]);for(const n of b)if(b=this.eY.wui(n),!this.eY.kUh(h,b)){h=void 0;break}return h}}Q1c(b,h){var n="";if(!h)return n;switch(b){case Dc.a.sOa:n=(n="object"===typeof h?
h:null)&&"Color"in n?n.Color:h;break;case Dc.a.pxc:case Dc.a.qxc:case Dc.a.Q_b:(h="object"===typeof h?h:null)&&"MenuItemId"in h&&(n=h.MenuItemId)}return n}vqb(b){b=this.IMf(b);b||(b=this.g6i);b||(b=this.eY.R2c());return b}zIa(b){for(const h of b)if(!ea.ParagraphReader.E3(h))return!1;return!0}}bG.xnb="ParagraphBorder";Object(u.a)(bG,"ParagraphBorderActor",null,[]);class PJ{constructor(){this.FId=this.jFd=null}get name(){return"WordEditor.Actors"}init(){Object(Pb.a)().Ke.Ngc=!0;A.AFrameworkApplication.va.ra(Dc.a.zFp,
id.a.frame,IN);this.W.resolve("WordEditor.Actors.DeleteActor").Wb(A.AFrameworkApplication.va);nz.instance.Wb();Fm.Wb();So.Wb(A.AFrameworkApplication.va,this.W.resolve("WordEditor.IMainViewModeManager"));yk.Wb();hC.instance.Wb();ti.Wb();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").Wb(A.AFrameworkApplication.va);this.W.resolve("WordEditor.Actors.ExternalContentActor").Wb();this.FId=this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor");this.FId.Wb();A.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&
this.W.resolve("Box4.Actors.FormatPainterActor").Wb();A.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve("WordEditor.Actors.SaveStatusActor").Wb();A.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&A.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.EZ.Qfe=!0);A.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").Wb();
A.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Wb();this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").Wb();this.W.resolve("Common.IOfficeTrialExperience").Wb();this.W.resolve("Common.IMacOfficeOffer").Wb();this.W.resolve("WordEditor.Actors.MarginsDialogActor").Wb();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").Wb();this.W.resolve("WordEditor.Actors.ColumnsDialogActor").Wb();this.W.resolve("WordEditor.Actors.FileDownloadActor").Wb();
this.W.resolve("WordEditor.Actors.StylesActor").Wb();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").Wb();this.W.resolve("WordEditor.Actors.ProofingActor").Wb();this.W.resolve("WordEditor.Actors.PageActor").Wb();Object(MA.a)()&&this.W.resolve("WordEditor.Actors.LineNumberingActor").Wb();this.W.resolve("WordEditor.Actors.DarkModeActor").Wb();this.W.resolve("WordEditor.Actors.ImageActor").Wb(A.AFrameworkApplication.va);this.W.resolve("WordEditor.Actors.FormattingActor").Wb();this.W.resolve("WordEditor.Actors.UIAutomationActor").Wb();
this.W.resolve("WordEditor.Actors.ContentControlActor").Wb();this.W.resolve("WordEditor.Actors.CustomTabActor").Wb();this.W.resolve("WordEditor.Actors.BookmarkActor").Wb();this.W.resolve("WordEditor.Actors.HeadingsActor").Wb();this.W.resolve("Box4.Indicator.IIndicatorManager").QZa(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Wb();this.W.resolve("WordEditor.Actors.AccessibilityActor").irg();this.W.resolve("WordEditor.Actors.ISWordRequestManager");
this.W.resolve("Box4.Actors.AutoCorrectActor").Wb();this.W.resolve("WordEditor.Actors.DigitalPrintActor").Wb();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.W.resolve("Box4.Actors.VisiMarkersActor").Wb();this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").P0();this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").Wb();A.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?
this.kso():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Wb();this.mZ.idb(this.jpk);this.W.resolve("WordEditor.Bookmark.FullBookmarkManager").lYm()&&Ua.StaticActiveAppFrame.za().ib.Aki();Ua.StaticActiveAppFrame.za().Ie();Wt.initialize();A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1)&&this.W.resolve("WordEditor.Actors.ParagraphBorderActor").Wb()}dispose(){this.FId&&this.FId.dispose()}kso(){this.xd.Ds.isCompleted?this.xd&&this.xd.isFeatureEnabled(46)&&
this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Wb():this.xd.Ds.continueWith(()=>{this.xd&&this.xd.isFeatureEnabled(46)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Wb(),Ua.StaticActiveAppFrame.za().Ie())})}get kon(){if(null==this.jFd)if(this.xd)if(this.xd.Ds.isCompleted)this.jFd=this.xd.isFeatureEnabled(2);else return!1;else this.jFd=!1;return this.jFd}wc(b){var h,n;this.W=b;this.xd=b.Oa("Box4.IFeatureHelper");this.EZ=this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");
this.EZ.C$c=A.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new iL).wc(b);b.ia("Box4.IClipboardCommands",()=>new jL(A.AFrameworkApplication.va,wb.a.mmf,wb.a.oUc,wb.a.G2,wb.a.dkg,wb.a.paste,wb.a.j4,wb.a.ywb)).ha();b.ia("HtmlImport.IHtmlNormalizerSettings",()=>{const B=b.resolve("Common.IAppSettingsManager");return new Ov(!0,B.$("SplitHyperlinkFixWithEnterIsEnabled"))}).ha();
b.ia("HtmlImport.IHtmlTranslatorSettings",()=>{const B=b.resolve("Common.IAppSettingsManager"),L=ba=>!ba.Unc;return new CN(B.$("PasteComplexTablesIsEnabled"),!0,!0,!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,B.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,ba=>ba.Unc,()=>!1,L,L,L,L,void 0,()=>this.kon,ba=>!ba.Unc)}).ha();b.ia("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new lM(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),
b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").ha();b.ia("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new EA(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").ha();b.ia("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new kL).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ha();b.ia("Box4.IIndentationCommands",
()=>new lL(A.AFrameworkApplication.va)).ha();b.ia("Box4.IJustificationCommands",()=>new mL(A.AFrameworkApplication.va)).ha();b.ia("Box4.ISpacingCommands",()=>new nL(A.AFrameworkApplication.va)).ha();b.ia("WordEditor.IPageCommands",()=>new NJ(A.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.StylesActor",()=>new hM(A.AFrameworkApplication.va,b.rf("WordEditor.UI.IDialogFactory"))).ha();b.ia("WordEditor.Actors.DigitalPrintActor",()=>new IJ(A.AFrameworkApplication.va,b.rf("WordEditor.UI.IDialogFactory"))).ha();
b.ia("WordEditor.Actors.FileDownloadManager",()=>new RL(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),new UH.a)).ha();b.ia("WordEditor.Actors.FileDownloadActor",()=>new CA(A.AFrameworkApplication.va,b.rf("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),A.AFrameworkApplication.K.$("DisablePrint"),A.AFrameworkApplication.K.kb("IrmPolicyDescription"),b.resolve("WordEditor.IBusinessBarController"))).ha();b.ia("WordEditor.Actors.ParagraphDialogActor",()=>new ZN(A.AFrameworkApplication.va,
b.rf("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),Po.a.instance,b.resolve("Box4.IParagraphIndentationReader"))).ha();b.ia("WordEditor.Actors.MarginsDialogActor",()=>new aM(A.AFrameworkApplication.va,b.rf("WordEditor.UI.IDialogFactory"),Po.a.instance)).ha();b.ia("WordEditor.Actors.ColumnsDialogActor",()=>new IL(A.AFrameworkApplication.va,b.rf("WordEditor.UI.IDialogFactory"),Po.a.instance)).ha();b.ia("WordEditor.Actors.ModeSwitcherControlActor",()=>new iy.a(b.Qa("Common.ISystemInitiatedFeedback"),
TF.a.Q2c())).as("WordEditor.IModeSwitcherControl").ha();b.ia("WordEditor.Actors.PaperSizeDialogActor",()=>new cM(A.AFrameworkApplication.va,b.rf("WordEditor.UI.IDialogFactory"),Po.a.instance)).ha();b.ia("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new XF(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).ha();b.register(dI,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").ha();b.ia("WordEditor.Actors.ProofingActor",()=>new kI(A.AFrameworkApplication.va,Pd.a.instance,Ya.a.instance.resolve("Box4.ISelectionManager"),
Ay.a.instance,Ya.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),Ya.a.instance.resolve("Box4.ILanguageReader"),Ya.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Ya.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Ya.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),this.EZ,Ya.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),A.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),Ya.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();
(A.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").xC.loadScript("EditorSettingsManager")).then(()=>{const B=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");B.g5m();B.init();b.ia("Box4.Proofing.EditorSettingsUIActor",()=>new oL(A.AFrameworkApplication.va,b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new pL(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).ha();
A.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&A.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").Wb()});b.ia("WordEditor.Actors.PageActor",()=>new bM(Ya.a.instance.resolve("Box4.IWordSectionEditor"),Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ya.a.instance.resolve("WordEditor.IMainViewModeManager"),Ya.a.instance.Qa("Common.ISystemInitiatedFeedback"))).as("WordEditor.IPageCommandStringBuilder").ha();
Object(MA.a)()&&b.ia("WordEditor.Actors.LineNumberingActor",()=>new nM(Ya.a.instance.resolve("WordEditor.IMainViewModeManager"))).ha();b.ia("WordEditor.Actors.DarkModeActor",()=>new LL(A.AFrameworkApplication.va,A.AFrameworkApplication.K,DN.a.$sa(),!!$e.App.instance&&$e.App.instance.MLa,!!$e.App.instance&&$e.App.instance.W$c,Ya.a.instance.resolve("Box4.IDarkModeState"),Ya.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Ya.a.instance.resolve("Box4.DarkModeEventsManager"),!!$e.App.instance&&
$e.App.instance.Qta)).ha();b.ia("WordEditor.FlatListDetailsProvider",()=>new fI(b.resolve("WordEditor.IFlatListEditor")));b.ia("WordEditor.Actors.AccessibilityActor",()=>new uL(b.Qa("Box4.Accessibility.IAccessibilityContextManager"),b.rf("WordEditor.FlatListDetailsProvider"),b.rf("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),b.rf("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).ha();b.ia("WordEditor.Actors.AppFrameCommandUIActor",()=>new EL(A.AFrameworkApplication.va,b.Qa("Postmessage.IHostPostmessenger"))).ha();
b.ia("WordEditor.Actors.ImageActor",()=>new Io(b.resolve("WordEditor.IImageEditor"),b.Qa("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.Images.ImageNavigator"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.IAppFrame"),
A.AFrameworkApplication.K)).as("Box4.Actors.ImageActor").ha();b.ia("WordEditor.Actors.WordFileSaveAsActor",()=>new cO(A.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new bO(b.resolve("WordEditor.IImageEditor"),A.AFrameworkApplication.K,A.AFrameworkApplication.ua.KWa,Ya.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),
b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.Actors.DeleteActor",()=>new $B(Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ya.a.instance.Qa("Box4.ContentControlConfigSettings"),Ya.a.instance.Qa("Box4.IContentControlEditor"),Ya.a.instance.resolve("Box4.IDynamicRangeEditor"),Ya.a.instance.Qa("WordEditor.Bookmark.IBookmarkManager"),Ya.a.instance.resolve("Box4.IHyperlinkEditor"),Ya.a.instance.resolve("Box4.IHyperlinkStrategy"),Ya.a.instance.resolve("Box4.IParagraphReader"),
Ya.a.instance.resolve("Box4.IParagraphIndentationReader"),Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ya.a.instance.resolve("Box4.ContentControl.ContentControlViewElementManager"))).ha();this.W.ia("WordEditor.Actors.SWordRequestManager",()=>new mI(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),A.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").ha();
b.ia("WordEditor.Actors.TableCellSelectionStrategy",()=>new qI).as("Box4.ITableCellSelectionStrategy").ha();A.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&b.ia("Box4.Actors.FormatPainter",()=>new BJ(b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.ICharacterPropertiesEditor"),Pd.a.instance,b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.IContentControlChpHelper"))).as("Box4.IFormatPainter").ha();b.ia("Box4.Actors.FormatPainterActor",()=>new kt(Ua.StaticActiveAppFrame.za(),Ph.FocusManager.instance(),A.AFrameworkApplication.va,Yc.a.instance,dt.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),!!$e.App.instance&&
$e.App.instance.Qta,b.resolve("Box4.DarkModeEventsManager"))).ha();b.ia("WordEditor.Actors.FormattingActor",()=>new TL(A.AFrameworkApplication.va,b.resolve("Box4.List.IListReader"))).ha();b.ia("WordEditor.Actors.UIAutomationActor",()=>new kM(A.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.SaveStatusActor",()=>new gM(A.AFrameworkApplication.va,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).ha();b.ia("Box4.Actors.IEnterViewStrategy",()=>new BI(b.Oa("Box4.IAutoCorrectScheduler"),
b.rf("Box4.IUndoManager"),b.Qa("Box4.IExternalSelectionManager"))).ha();b.ia("Box4.ISelectAllHandlers",()=>new uy(Gm.PageReader.instance,b.rf("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha();b.ia("WordEditor.Actors.ContentControlActor",()=>new KL(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),
b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Styles.IWACStyleReader"),A.AFrameworkApplication.va,A.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),b.resolve("WordEditor.ContentControl.IContentControlFormattingManager"))).ha();b.ia("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new vL(A.AFrameworkApplication.va,b.rf("WordEditor.UI.IDialogFactory"),Ph.FocusManager.instance())).ha();b.ia("Box4.Actors.FontNameFormattingStrategyNoop",
()=>new SF).as("Box4.Actors.IFontNameFormattingStrategy").ha();b.ia("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new XD(A.AFrameworkApplication.Be,Object($n.a)(),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Ya.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),A.AFrameworkApplication.K,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").ha();
b.ia("WordEditor.Actors.GraphicsEditorActor",()=>new DA(A.AFrameworkApplication.va,A.AFrameworkApplication.K,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),A.AFrameworkApplication.Be,
this.xd,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();b.ia("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new MD).ha();b.ia("WordEditor.Actors.CustomTabActor",()=>new pz(A.AFrameworkApplication.va,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).ha();b.ia("WordEditor.Actors.HeadingsActor",()=>new eC(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),A.AFrameworkApplication.va,b.resolve("Box4.IParagraphReader"))).ha();
b.ia("WordEditor.Actors.BookmarkActor",()=>new HL(Ua.StaticActiveAppFrame.za(),A.AFrameworkApplication.va,Zb.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.$c),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),Ay.a.instance,this.W.Qa("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IOutlineElementNavigator"),
Object(Pb.a)(),this.W.rf("WordEditor.UI.IDialogFactory"),this.W.resolve("Box4.BookmarkParagraphMapping"),Pd.a.instance)).ha();b.ia("WordEditor.Actors.BookmarkIndicatorActor",()=>new Bt(b.resolve("Box4.IParagraphReader"),Ef.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib.sc))).ha();b.ia("Box4.Actors.IIFrameFocusStrategy",()=>new fC).ha();b.ia("WordEditor.Actors.ExternalContentFloatiePositionProvider",
()=>new BA(Zb.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Object(Pb.a)(),$c.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).ha();b.ia("WordEditor.Actors.ExternalContentActor",()=>new Sq(A.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),A.AFrameworkApplication.K,b.resolve("Wonca.ExternalContent.IExternalContentEditor"),A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).as("WordEditor.Actors.ExternalContentActor").ha();
b.ia("Box4.UI.ExternalContentFloatieManager",()=>new CI).as("Box4.UI.IFloatieManager").ha();b.ia("WordEditor.Actors.ActionHangDetector",()=>new wL(A.AFrameworkApplication.K,A.AFrameworkApplication.va)).as("WordEditor.Actors.ActionHangDetector").ha();b.ia("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new bC(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),Object(Pb.a)(),ik.a.instance(),A.AFrameworkApplication.ua,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),
b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),$e.App.jf.Il.Ve(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).ha();b.ia("Box4.Actors.WordIndentationActorExtension",()=>new mM).as("Box4.Actors.IIndentationActorExtension").ha();A.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&
A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ia("WordEditor.Actors.ModernUxActor",()=>new MJ(A.AFrameworkApplication.va)).ha();A.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ia("WordEditor.Actors.SwitchToClassicViewModeActor",()=>new ND(A.AFrameworkApplication.va)).ha();(new BN).wc(b);b.ia("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new tL(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),
b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").ha();b.ia("WordEditor.OnlineMedia.InsertHubbleMediaHelper",()=>new rL(A.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),new vc.b)).ha();b.ia("WordEditor.OnlineMedia.OnlineMediaActor",()=>new sL(A.AFrameworkApplication.va,A.AFrameworkApplication.K,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),
Pd.a.instance,b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),A.AFrameworkApplication.K.$("GetCustomHeaderEnabled")?Ya.a.instance.resolve("Common.App.OAuth.IOAuthManager"):void 0)).ha();null!==(n=null===(h=A.AFrameworkApplication.K)||void 0===h?void 0:h.$("PageLoadStatsDialogIsEnabled"))&&void 0!==n&&n&&d.e(16).then(d.bind(null,2232)).then(B=>{(new B.cPp(()=>b.resolve("WordEditor.IStatusBarUser"))).Wb()});this.jpk=new qL;this.mZ=this.W.resolve("Box4.Highlight.IHighlightManager");
A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1)&&this.W.ia("WordEditor.Actors.ParagraphBorderActor",()=>new bG(A.AFrameworkApplication.va,tp.a.instance,this.W.resolve("WordEditor.ParagraphEditors.IParagraphBorderEditor"),this.W.resolve("WordEditor.ParagraphEditors.IParagraphBorderManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"))).ha()}static main(){M.a.instance.Jc(new PJ)}}Object(u.a)(PJ,"WordEditorActorsPackage",null,
[0,1]);class oM{constructor(b){this.TEd=!1;this.llj=()=>{this.TEd=!0;this.wu.Eue(this.llj)};this.wu=b;this.wu.hmb(this.llj)}}Object(u.a)(oM,"GraphFullyConnectedGetter",null,[451]);class qg{constructor(){this.hth=Object.assign(new gp.a,{})}ZVk(b,h){let n;const B=b&1023;({value:n}=this.hth.Dc(B,0)).returnValue||qg.uSm().contains(B)||x.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,B);n+=h;this.hth.Z(B,n);return n}static uSm(){qg.RNd||(qg.RNd=new Ea.a,qg.qc(0),qg.qc(1),
qg.qc(2),qg.qc(3),qg.qc(4),qg.qc(5),qg.qc(6),qg.qc(7),qg.qc(8),qg.qc(9),qg.qc(10),qg.qc(11),qg.qc(12),qg.qc(13),qg.qc(14),qg.qc(15),qg.qc(16),qg.qc(17),qg.qc(18),qg.qc(19),qg.qc(20),qg.qc(21),qg.qc(22),qg.qc(23),qg.qc(24),qg.qc(25),qg.qc(26),qg.qc(27),qg.qc(28),qg.qc(29),qg.qc(30),qg.qc(31),qg.qc(32),qg.qc(33),qg.qc(34),qg.qc(35),qg.qc(36),qg.qc(37),qg.qc(38),qg.qc(39),qg.qc(40),qg.qc(41),qg.qc(42),qg.qc(43),qg.qc(44),qg.qc(45),qg.qc(46),qg.qc(47),qg.qc(48),qg.qc(49),qg.qc(50),qg.qc(51),qg.qc(52),
qg.qc(53),qg.qc(54),qg.qc(55),qg.qc(56),qg.qc(57),qg.qc(58),qg.qc(59),qg.qc(60),qg.qc(61),qg.qc(62),qg.qc(63),qg.qc(64),qg.qc(65),qg.qc(66),qg.qc(67),qg.qc(68),qg.qc(69),qg.qc(70),qg.qc(71),qg.qc(72),qg.qc(73),qg.qc(74),qg.qc(75),qg.qc(76),qg.qc(77),qg.qc(78),qg.qc(79),qg.qc(80),qg.qc(81),qg.qc(82),qg.qc(83),qg.qc(84),qg.qc(85),qg.qc(86),qg.qc(87),qg.qc(88),qg.qc(89),qg.qc(90),qg.qc(91),qg.qc(92),qg.qc(93),qg.qc(94),qg.qc(95),qg.qc(96),qg.qc(97),qg.qc(98),qg.qc(99),qg.qc(100),qg.qc(101),qg.qc(102),
qg.qc(103),qg.qc(104),qg.qc(105),qg.qc(106),qg.qc(107),qg.qc(108),qg.qc(109),qg.qc(110),qg.qc(111),qg.qc(112),qg.qc(113),qg.qc(114),qg.qc(115),qg.qc(116),qg.qc(117),qg.qc(118),qg.qc(119),qg.qc(120),qg.qc(121),qg.qc(122),qg.qc(124),qg.qc(126),qg.qc(127),qg.qc(128),qg.qc(129),qg.qc(130),qg.qc(131),qg.qc(132),qg.qc(133),qg.qc(134),qg.qc(135),qg.qc(136),qg.qc(140),qg.qc(145),qg.qc(146),qg.qc(147));return qg.RNd}static qc(b){qg.RNd.add(b&1023)}}qg.RNd=null;Object(u.a)(qg,"LanguagePerParagraphModel",null,
[]);class pM{constructor(){this.fDg=!1;this.zVd=this.yVd=this.r3b=0;this.a4i=!0;this.tJp=0}}Object(u.a)(pM,"UpdateWordCountStateResult",null,[]);class qM extends Sys.EventArgs{constructor(b){super();this.isEnabled=b}}Object(u.a)(qM,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class rM{constructor(){this.m1h=this.l1h=this.wordCount=-1;this.MNb=this.BXh=0;this.LNb=1;this.Jrj=1033}}Object(u.a)(rM,"WordCountCache",null,[]);class QJ extends Sys.EventArgs{constructor(b){super();this.state=b}}
Object(u.a)(QJ,"WordCountChangedEventArg",Sys.EventArgs,[]);class dO{constructor(){this.JBc=this.PIa=0}}Object(u.a)(dO,"CharsCountResult",null,[]);class PD{constructor(){this.cp=0;this.KBc=null;this.raa=this.saa=0}}Object(u.a)(PD,"TextChunkResult",null,[]);class RJ{constructor(){this.Vbk=this.saa=this.raa=this.wordCount=0}}Object(u.a)(RJ,"WordCountStateForParagraph",null,[]);class sM{constructor(){this.Zca=this.LL=this.saa=this.raa=this.dV=this.wordCount=0;this.currentNode=null;this.t_=-1;this.cp=
0;this.wkg=[];this.LNb=this.MNb=this.w6a=this.rkg=this.skg=0;this.CK=this.SYi=!1;this.OAb=new ob.a;this.Yab=new ob.a}}Object(u.a)(sM,"WordCountState",null,[]);class Mp{constructor(b,h,n,B,L,ba){this.zbp=1E3;this.sa=new mg.a;this.EJb=null;this.YJe=0;this.hwk="\ue000";this.GGc=!1;this.oPe=this.dPe=this.Fzd=0;this.Gdh=this.Odh=null;this.$Oe=this.ZOe=this.iPe=0;this.TWl=la=>{this.EJb=null;this.Uyf(la.Yl)};this.CH=h;this.tuk=new RegExp(Cn.AParagraphNode.oE,"g");this.Nd=b;this.Qi=B;this.hn=n;this.K5a=ba;
this.Z2a=L.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.pMk=L.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.pGj()}get uun(){return!!this.EJb}get dVa(){return this.GGc}set dVa(b){this.GGc=b}get PQd(){return this.YJe}set PQd(b){this.YJe=b}get XXa(){return!this.YJe}get Sz(){return this.Fzd}get RMb(){return this.dPe}get VMb(){return this.oPe}get AMl(){return this.Odh}get tvf(){return this.Gdh}get mYc(){return this.iPe}get kYc(){return this.ZOe}get lYc(){return this.$Oe}hmb(b){this.sa.addHandler(Mp.UGe,
b)}Eue(b){this.sa.removeHandler(Mp.UGe,b)}Ygf(b){this.sa.addHandler(Mp.dPg,b)}qBo(b){this.sa.removeHandler(Mp.dPg,b)}t_d(){this.s_d();this.pGj()}pGj(){this.iPe=this.$Oe=this.ZOe=this.oPe=this.dPe=this.Fzd=-1}xwf(){this.iBe(this.zbp)}Kqd(){const b=new sM;b.SYi=!0;this.s_d();this.Uyf(b)}iBe(b,h=null){this.XXa&&(this.uun&&(h=null,this.s_d()),h||(h=new sM),b=new Re.a(3,1,b,this.TWl,this.G_j),b.Yl=h,this.B_k(b))}s_d(){this.EJb&&(this.Qi.vf(this.EJb),this.EJb=null)}T9j(b,h,n,B,L,ba=!0,la=-1,La=-1,fb=-1,
Cb=1033){const Lb=new pM;Lb.r3b=n;Lb.yVd=L;Lb.zVd=B;if(!b.cp&&h.Mud&&ba&&!this.WFi(h))return Mp.MAp(b,h.Mud),Lb.a4i=!0,Lb;B=0<=La&&0<=fb?{Ad:La,endCp:fb}:void 0;n=this.Fgm(h,B);B&&(La=B.Ad,fb=B.endCp);n=0<=fb?n.substring(0,fb):n;fb=0<=La&&0<=fb?n.substring(La,fb):n;B=b.cp>=La?b.cp:La;L=b.wkg||[];ba=0<b.skg?b.skg:0;let $b=0<b.rkg?b.rkg:0,tc=[];b.CK=!1;do{this.K5a.update();if(!b.SYi&&(Lb.r3b+tc.length/2>Mp.pGp||this.K5a.cvb())){let Hd;L=(Hd=L).concat.apply(Hd,tc);b.cp=B;b.wkg=L;b.rkg=$b;b.skg=ba;b.t_=
la;b.currentNode=h;this.iBe(Mp.YJp,b);Lb.fDg=!0;b.CK=!0;return Lb}if((!B||B===La)&&0<n.length&&B<n.length){L.push(Hh.a.instance.dPf(n,B));var Nc=this.WFi(h);if(0<=la&&!B&&Nc){b.wordCount+=1;Lb.r3b+=1;const Hd=this.Nd.i3(Nc);Nc=this.CH.Ced(Hd,Nc);Nc=Mp.vYd(Nc);b.saa+=Nc.PIa+1;b.raa+=Nc.PIa-Nc.JBc}}Nc=this.CKi(n,B,Mp.oql);B=Nc.cp;let dd;tc=(dd=tc).concat.apply(dd,Nc.KBc);ba+=Nc.saa;$b+=Nc.raa}while(-1!==B);b=this.VTk(b,L,tc,n,fb,Lb.r3b,Lb.yVd,Lb.zVd,h,-1===la,Cb);Lb.r3b=b.wordCount;Lb.yVd=b.raa;Lb.zVd=
b.saa;Lb.tJp=b.Vbk;return Lb}Fhi(b,h){const n=ea.ParagraphReader.textLength(h,9);if(n){h=tn.e(h);var B=0;for(let L=0;L<h.length;L++)if(this.gsb&&5===h[L].Jh&&b.LL++,Mp.Z0o(h[L])){B++;break}h.length!==n?b.dV++:b.dV+=B}}oSj(b){this.PQd=this.z1o(b.w6a,b.wordCount)?1:0;return!!this.PQd}qpj(b){this.Fzd=b.wordCount;this.dPe=b.LL;this.oPe=b.Zca;this.$Oe=b.saa;this.ZOe=b.raa;this.iPe=b.dV;this.Odh=b.OAb;this.Gdh=b.Yab;this.ryj(b)}ryj(b){this.sa.raiseEvent(Mp.UGe,new QJ(b))}qyj(){this.sa.raiseEvent(Mp.dPg,
new qM(!1))}z1o(b,h){if(X.a.Mt||X.a.ju||X.a.HF)return!1;(h/=2)||(h=1);return(h?b/h:0)>Mp.DJn?!0:!1}get gsb(){const b=!this.d8f||1===this.d8f&&this.pMk;return this.Z2a&&b}ECi(b,h){let n=1033,B=0;b=h.jLf(b);h=new qg;for(let L=0;L<b.length;L++){const ba=h.ZVk(b[L].lcid,b[L].end-b[L].Fc);B<ba&&(B=ba,n=b[L].lcid)}return n}VTk(b,h,n,B,L,ba,la,La,fb,Cb,Lb){var $b;h=($b=h).concat.apply($b,n);n=Hh.a.instance.EKi(h,B);b.wordCount+=n.wordCount;L=Mp.vYd(L);$b=L.PIa-L.JBc;const tc=L.PIa;b.raa+=$b;b.saa+=tc;ba+=
n.wordCount;la+=L.PIa-L.JBc;La+=L.PIa;b.w6a+=n.w6a;const {VYl:Nc,Flp:dd}=Mp.UTk(h,B);b.MNb+=Nc;b.LNb+=dd;b.Yab.add(Lb);b.OAb.add(n.wordCount);Cb&&Mp.Bil(tc,$b,fb,n,Nc,dd,Lb);b.cp=0;b.wkg=[];b=new RJ;b.raa=la;b.saa=La;b.wordCount=ba;b.Vbk=n.wordCount;return b}Fgm(b,h){let n=this.bDo(b);n=ea.ParagraphReader.Ipb(b,9,n,h);return this.cyo(n)}bDo(b){var h=ea.ParagraphReader.text(b);b=tn.e(b);if(0<b.length){h=h.split("");for(let B=0;B<b.length;++B){let L=!0;var n=!0;const ba=b[B];if(1===ba.Jh)n=ba,n=22!==
n.kind&&2!==n.kind;else if(5===ba.Jh)L=!1;else if(7===ba.Jh||10===ba.Jh)h[ba.Jb.cp]=this.hwk,L=!1;if(L){if(ba.Jb.cp>=h.length)return"";h[ba.Jb.cp]=n?" ":"C"}}h=h.join("")}return h}cyo(b){return b.replace(this.tuk,"")}CKi(b,h,n){const B=b.length-h<=n;var L=B?b.length:h+n;const ba=new PD;if(L<h)return ba.cp=-1,ba;ba.KBc=Hh.a.instance.JHf(b,h,L);L=Mp.vYd(b.substr(h,L));ba.saa=L.PIa;ba.raa=L.PIa-L.JBc;if(!ba.KBc.length&&!B)return n===b.length-h?ba:this.CKi(b,h,b.length-h);ba.cp=B||!ba.KBc.length?-1:ba.KBc[ba.KBc.length-
1].cp;return ba}B_k(b){this.EJb=b;this.Qi.Zb(this.EJb)}WFi(b){b=Gf.ListItemReader.Of?b:b.sF;if(Gf.ListItemReader.isListItem(b)){const h=this.Nd.i3(b);if(null===h||void 0===h?0:h.aC)return b}return null}static Z0o(b){return 11===b.Jh}static MAp(b,h){b.wordCount+=h.wordCount;b.raa+=h.l1h;b.saa+=h.m1h;b.w6a+=h.BXh;b.MNb+=h.MNb;b.LNb+=h.LNb;b.Yab.add(h.Jrj);b.OAb.add(h.wordCount)}static Bil(b,h,n,B,L,ba,la){const La=new rM;La.wordCount=B.wordCount;La.m1h=b;La.l1h=h;La.BXh=B.w6a;La.MNb=L;La.LNb=ba;La.Jrj=
la;n.Mud=La}static vYd(b){const h=b.length,n=new dO;for(let L=0;L<h;L++){var B=b.charCodeAt(L);n.PIa++;if(55296<=B&&56319>=B&&(B=L+1<h?b.charCodeAt(L+1):0,56320<=B&&57343>=B)){L++;continue}F.a.qga(b.charAt(L))&&n.JBc++}return n}static UTk(b,h){let n=0,B=0;for(let L=0;L<b.length;++L){const ba=b[L],la=ba.dO;(3===la||2===la)&&ba.cp<h.length&&(++n,F.a.aoc(h.charCodeAt(ba.cp))&&++B)}return{VYl:B,Flp:n}}}Mp.UGe="wctek";Mp.dPg="wcac";Mp.YJp=1;Mp.oql=400;Mp.pGp=90;Mp.DJn=.1;Object(u.a)(Mp,"WordCountManagerBase",
null,[456]);class tM extends Mp{constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb){super(b,h,n,L,fb,Cb);this.Rqi=this.gOd=this.kqa=null;this.Jua=()=>{this.xwf()};this.hb=B;this.vd=la;this.xHh=La;this.WK=Lb;this.hb.Cw(this.Jua);this.xYe=fb.$("ReadingTimeIsEnabled")}get G_j(){return 66}W7m(){if(this.kqa)return!0;if(!this.hb||!this.hb.gb)return this.vd&&($e.App.isClosing||A.AFrameworkApplication.ol?this.vd.$b("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):
this.vd.$b("SelectionWordCountSelectionNullWhenAppAlive")),!1;const b=this.hb.gb.clone();this.kqa=b.bR(!0);if(!this.kqa||!this.kqa.L0())return this.s_d(),!1;this.xHh&&(this.gOd=this.xHh.create(h=>b.bR(h),this.hn));this.kqa.moveNext();return!0}get d8f(){return 1}pAl(b){return b===oc.a.Bd||b===oc.a.paragraph?!0:this.gsb&&(b===oc.a.LOb||b===oc.a.image||b===oc.a.caa)}Uyf(b){this.K5a.reset();if(this.W7m()){for(this.gsb&&this.gOd&&(this.gOd.OWl(b,this.K5a)||this.iBe(1,b));this.kqa.current;){const B=-1===
b.t_?0:b.t_;let L=0;var h=this.kqa.current;if(!this.pAl(h.contextId)){this.kqa.moveNext();continue}if(this.gsb&&Ad.ImageReader.N$a(h)){b.LL++;this.kqa.moveNext();continue}if(!ea.ParagraphReader.Xb(h.node)){this.kqa.moveNext();continue}const ba=h.node;if(this.dVa&&this.Rqi&&this.Rqi.i9a(ba))this.kqa.moveNext();else{if(this.gsb&&h.isValid){var n=ve.GraphIterator.eb(ba);for(n.Ub(6);!n.Es;)Ad.ImageReader.Lt(n.currentNode)&&b.LL++,n.Cj(6)}n=this.xYe?this.ECi(ba,this.WK):1033;h=this.T9j(b,ba,0,0,0,this.Aee(h),
B,h.cpBegin,h.cpEnd,n);if(h.a4i&&(L+=1,100<L)){b.t_=B+1;this.iBe(1,b);return}if(h.fDg)return;this.Fhi(b,ba);this.kqa.moveNext()}}this.gOd=this.kqa=null;this.oSj(b)?(this.Fzd=-1,this.qyj()):this.qpj(b)}}Aee(b){let h=!1;b.contextId===oc.a.paragraph?h=!0:b.contextId===oc.a.Bd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);return h}}Object(u.a)(tM,"SelectionWordCountManager",Mp,[]);class GA{constructor(b,h){this.c8b=!1;this.LIb=null;b&&h&&(this.abc=b(!1),this.Zc=h,this.abc.moveNext())}OWl(b,h){if(!b||
!this.abc||!this.abc.current)return!0;do{const n=this.abc.current;if(n.contextId===oc.a.qv||n.contextId===oc.a.Sx){for(this.LIb||this.f8m(n.node);this.LIb.moveNext();)if(14===this.LIb.currentNode.type&&b.Zca++,h.update(),h.cvb())return!1;this.RCl(n,b);this.LIb=null}this.abc.moveNext()}while(this.abc.current);return!0}RCl(b,h){const n=this.Zc.jg(b.node);n.zb(14);b.contextId===oc.a.qv&&(Le.a.FYi(n)&&(this.c8b=!0),Le.a.cfe(n)&&this.c8b&&(this.c8b=!1,h.Zca++));b.contextId===oc.a.Sx&&(Ng.TableCellReader.q9c(n)&&
(this.c8b=!0),Ng.TableCellReader.BXa(n)&&this.c8b&&(this.c8b=!1,h.Zca++))}f8m(b){this.LIb=Ff.a.iq(b);14===b.type?this.LIb.vp(GA.y0c,b):this.LIb.vp(GA.y0c,null)}static y0c(b){return b.parentNode?!0:!1}}Object(u.a)(GA,"TableCountSelectionTraverser",null,[457]);class uM{constructor(b){this.Z2a=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,h){return this.Z2a?new GA(b,h):null}}Object(u.a)(uM,"TableCountSelectionTraverserFactory",null,[445]);class cG extends Mp{constructor(b,h,n,
B,L,ba,la,La,fb,Cb,Lb){super(b,h,n,L,fb,Cb);this.rGp=$b=>{if($b.Es)return!0;$b=$b.role;return 1===$b||2===$b||this.gsb&&6===$b||3===$b||4===$b||5===$b||!this.dVa&&(7===$b||8===$b)};this.ga=B;this.cIk=ba;this.dRk=la;this.odh=La;this.WK=Lb;this.ga.fb(Dc.a.Tbk,oc.a.application,Ce.ActionManager.Zf,64);this.ga.fb(Dc.a.Ubk,oc.a.application,Ce.ActionManager.Zf,64);this.xYe=fb.$("ReadingTimeIsEnabled")}get G_j(){return 63}get d8f(){return 0}Uyf(b){this.K5a.reset();b.CK=!1;var h=this.cIk();Gm.PageReader.instance.mTb(h)||
(this.t_d(),this.qyj());h=this.hn.Ksa(h,7,7).currentNode;var n=this.NGl(b.currentNode,h);h=this.dRk(n,h);h.vp(this.rGp,null);let B=n=0;for(var L=0;h.moveNext();){if(h.currentNode&&(!Gf.ListItemReader.Of||!Rz.a.f0i(h.currentNode))&&Gf.ListItemReader.isListItem(h.currentNode)){var ba=this.Nd.i3(h.currentNode);if(ba.aC){var la=Gf.ListItemReader.Of?h.currentNode:this.Nd.gWa(h.currentNode);if(la&&(la=la.qa.last,(null===la||void 0===la?0:la.mi)&&(Eh.a.V8&&la.Uh||la.KU)))continue;b.wordCount+=1;if(ba=this.CH.Ced(ba,
h.currentNode))ba=Mp.vYd(ba),b.saa+=ba.PIa+1,b.raa+=ba.PIa-ba.JBc;n+=1;B+=b.saa;L+=b.raa}if(!Gf.ListItemReader.Of)continue}if(this.gsb&&h.currentNode&&Ad.ImageReader.Lt(h.currentNode))b.LL++;else if(this.gsb&&h.currentNode&&xh.TableReader.HU(h.currentNode))b.Zca++;else if(h.currentNode&&ea.ParagraphReader.Xb(h.currentNode)){ba=h.currentNode;la=this.xYe?this.ECi(ba,this.WK):1033;L=this.T9j(b,ba,n,B,L,!0,-1,-1,-1,la);if(L.fDg){b.CK=!0;return}this.Fhi(b,ba);n=L.r3b;B=L.zVd;L=L.yVd}}this.oSj(b)?(this.t_d(),
this.VDo(),this.ryj(b)):this.qpj(b)}NGl(b,h){b?(b=this.odh(b),b.zb(7)):b=this.odh(h);return b}VDo(){switch(this.PQd){case 1:this.ga.Ob(Dc.a.Tbk,2);break;case 2:this.ga.Ob(Dc.a.Ubk,2)}}}Object(u.a)(cG,"TotalWordCountManager",Mp,[]);class eO{constructor(){this.kLj=this.jLj=this.Rxg=this.lLj=this.R1j=this.S1j=this.P1j=this.Q1j=0}get sij(){return this.wkc(this.lLj,this.S1j,"WC")}get uSn(){return this.wkc(this.jLj,this.P1j,"NumCharsNoSp")}get vSn(){return this.wkc(this.Rxg,this.Q1j,"NumCharsWithSp")}get ASn(){return this.wkc(this.kLj,
this.R1j,"NumParagraphs")}wkc(b,h,n){const B=this.tud(h,n).toLocaleString();return 0<this.Rxg?(b=this.dOg(b,h,n),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),B)):B}dOg(b,h,n){b=this.tud(b,n);return b>h?(x.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",n),h):b}tud(b,h){0>b&&x.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,0)}}Object(u.a)(eO,"DocumentStats",null,[]);class SJ{static ttf(b){return Ge.a.az(SJ.Mn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,
b.sij,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.uSn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.vSn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.ASn)}}SJ.Mn="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(u.a)(SJ,"DocumentStatsDialogHtml",null,[]);class fO extends Ge.a{constructor(b){super();this.UV=!1;this.wXl=()=>{};this.KH=b}b6o(){this.Qg="DocumentStatsDialog";this.kh=SJ.ttf(this.KH);this.Gd=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.wXl);this.L8("DocumentStatsTable")}Zba(){}dispose(){this.UV||(super.dispose(),this.UV=!0)}}Object(u.a)(fO,"DocumentStatsDialog",Ge.a,[]);class vM{constructor(b,h,n,B,L,ba,la,La,fb){this.zGh=this.tIc=this.GGc=this.b8b=this.zZe=
!1;this.ftc=()=>{this.FFe()};this.Sga=()=>{this.FFe()};this.CYo=()=>{this.zGh=!0;return 32};this.xpg=()=>this.wu.XXa?32:8;this.tjd=(Cb,Lb,$b,tc,Nc)=>{if(1===$b)return this.wu.XXa?32:8;Nc[$g.a.On]=this.f2f;return 32};this.pDe=(Cb,Lb,$b)=>{if(1===$b)return this.wu.XXa?32:8;this.f2f?this.tUl():this.U_l();Ua.StaticActiveAppFrame.za().hJ({ShowWordCount:"CheckboxModel"});return 32};this.myc=(Cb,Lb,$b)=>{if(1===$b)return Ve.a.Sla(Lb)?8:this.wu.XXa?32:8;if(this.zGh)return A.AFrameworkApplication.va.Ob(Dc.a.Roe,
2),32;Cb=this.Vd.Vf("UserAction","Show Word Count Dialog");Cb.start();this.wu.Kqd();this.wT.Kqd();this.wu.Sz!==this.wT.Sz?x.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):x.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");Lb=this.fFl();(new fO(Lb)).b6o();Cb.stop();return 32};this.Kid=(Cb,Lb,$b,tc,Nc)=>{Nc||x.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===$b)return 32;if(!this.wu.XXa)return Nc[Dl.a.Visible]=
!1,32;Nc[Dl.a.Visible]=!0;this.f2f?(Cb=this.wu.Sz,0>Cb?Cb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Cb?(Lb=this.wT?this.wT.Sz:-1,Cb=0<Lb?this.mKm(Cb,Lb):String.format(1===Cb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.kwe(Cb))):Cb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.kwe(Cb))):Cb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;Nc[Dl.a.LabelText]=Cb;return 32};
this.HOe=la;this.IOe=ba;this.wu=b;this.wT=h;this.xIb=n;this.ROk=L;this.wT.Ygf(this.ftc);this.wu.Ygf(this.ftc);this.wT.hmb(this.Sga);this.wu.hmb(this.Sga);this.Vd=La;this.dVa=B;this.Z2a=fb.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get nwf(){return!X.a.Q7}Wb(){const b=A.AFrameworkApplication.va;b.ra(Dc.a.pDe,oc.a.application,this.pDe);b.ra(Dc.a.myc,oc.a.view,this.myc);b.fb(Dc.a.tjd,oc.a.application,this.tjd,96);b.fb(Dc.a.Kid,oc.a.application,this.Kid,96);b.fb(Dc.a.xpg,oc.a.application,
this.xpg,96);b.ra(Dc.a.Sji,oc.a.application,this.CYo)}get dVa(){return this.GGc}set dVa(b){this.GGc=b;this.wu.dVa=b;this.wT.dVa=b}U_l(){this.wu.XXa&&(this.aRj(!0),this.FFe(),this.wu.Kqd())}fFl(){const b=new eO;b.S1j=this.wu.Sz;b.Q1j=this.wu.lYc;b.P1j=this.wu.kYc;b.R1j=this.wu.mYc;b.lLj=this.wT.Sz;b.jLj=this.wT.kYc;b.Rxg=this.wT.lYc;b.kLj=this.wT.mYc;return b}Sqm(){return this.HOe("WACWordCountEnabled",this.nwf)}Exe(b){this.IOe("WACWordCountEnabled",b?"true":"false",fc.a.xMa)}get f2f(){this.b8b||(this.zZe=
this.Sqm(),this.b8b=!0);return this.zZe}aRj(b){this.Exe(b);this.zZe=b;this.b8b=!0}tUl(){this.wu.t_d();this.wT.t_d();this.aRj(!1);this.FFe()}get tH(){return null!=this.x4g?this.x4g:this.x4g=(()=>this.xIb())()}FFe(){this.tIc||(x.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.oLl()),this.tIc=!0);this.tH&&this.tH.nS(this.ROk)}oLl(){const b={["words"]:this.wu.Sz,["charsWithSpaces"]:this.wu.lYc,["charsWithNoSpaces"]:this.wu.kYc,["paragraphs"]:this.wu.mYc};this.Z2a&&(b.images=this.wu.RMb,
b.tables=this.wu.VMb);return b}kwe(b){try{return b.toLocaleString()}catch(h){x.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}mKm(b,h){h>b&&(x.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.kwe(h),this.kwe(b))}}Object(u.a)(vM,"WordCountActor",
null,[]);class TJ extends hv.a{constructor(b,h,n,B){super();this.LN=(L,ba)=>{if(ba.property===Hf.a.Un||ba.property===Hf.a.Vn)L=ba.node,ba=Eh.a.en.ib.sc,ba.lw&&ba.jd&&ba.jd.Lc&&L.Lc&&L.Lc.id===ba.jd.Lc.id&&this.gli(L)};this.Dmj=(L,ba)=>{this.gli(ba.node)};this.A_n=(L,ba)=>{ba.property!==zd.a.cC&&ba.property!==Lc.a.Tw||this.D0()};this.Qme=()=>{this.D0()};this.g$=b;this.wu=h;this.Xm=n;this.Z2a=B.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}eB(){var b=this.Xm.Ve(12);b.fo(this.LN);b.Zt(this.Dmj);
b.Bw(this.Dmj);b=this.Xm.Ve(22);b.fo(this.A_n);b.Zt(this.Qme);b.Bw(this.Qme);this.Z2a&&this.Muo();this.g$.Ava(this,7)}Muo(){var b=[19,14];for(const h of b)b=this.Xm.Ve(h),b.Zt(this.Qme),b.Bw(this.Qme)}get index(){return 1}run(){this.wu.xwf()}gli(b){b.Mud=null;this.D0()}}Object(u.a)(TJ,"WordCountAppEventCoordinator",hv.a,[]);class xv{}xv.WTk="AccurateWordCountButton";Object(u.a)(xv,"WordCountConstants",null,[]);class uw{constructor(b,h){this.wu=b;this.wT=h}getInstance(b){switch(b){case 1:return this.wT;
case 0:return this.wu;default:return this.wu}}}Object(u.a)(uw,"WordCountManagerFactory",null,[202]);class rI{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}wc(b){this.W=b;const h=this.W.resolve("Common.IAppSettingsManager");this.W.ia("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new uM(h)).ha();this.W.ia("WordEditor.WordCount.IWordCountManagerFactory",()=>{var n=new rd.a(10,$c.a.Ee);const B=new cG(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),
new Vl.a,A.AFrameworkApplication.va,A.AFrameworkApplication.mc,()=>Eh.a.en.ib.sc.jd,Ff.a.Ft,ve.GraphIterator.eb,h,n,Ya.a.instance.resolve("Box4.ILanguageReader"));n=new tM(Ya.a.instance.resolve("Box4.List.IListReader"),Ya.a.instance.resolve("Box4.IListMarkerUtility"),new Vl.a,Zb.a.instance,A.AFrameworkApplication.mc,aw.a.instance,Yc.a.instance,Ya.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),h,n,Ya.a.instance.resolve("Box4.ILanguageReader"));return new uw(B,n)}).ha();
this.W.ia("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new oM(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").ha()}init(){const b=Ua.StaticActiveAppFrame.za().ib;b.lCa?this.Uva():b.Eja(()=>{this.Uva()})}Uva(){if($e.App.jf){var b=$e.App.jf.Il;if(b){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var h=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),n=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
B=Ya.a.instance.resolve("Common.IAppSettingsManager");(new vM(h,n,()=>Ya.a.instance.Oa("WordEditor.IStatusBarUser"),this.Rpm(),xv.WTk,fc.a.vOa,fc.a.Bfa,Ya.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),B)).Wb();(new TJ(ap.GraphTransactionManager.instance,h,b,B)).eB();h.xwf()}else x.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else x.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}Rpm(){var b=
Eh.a.en.ib;if(!b)return x.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.sc;if(!b)return x.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.jd;return b?b.ja(Lc.a.dVa,!1):(x.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){M.a.instance.Jc(new rI)}}Object(u.a)(rI,"PackageManager",null,[0,1]);var gO=d(2179);class wM{constructor(b){this.d8e=null;b.Qa("Common.App.SearchCommon.SearchHostRuntime").execute(h=>{this.d8e=h})}DNj(b){this.d8e&&this.d8e.HKf().handleDocumentContentAugloopAnnotation(b)}}
Object(u.a)(wM,"DocumentContentExtractionManager",null,[378]);class Wh{}Wh.f$o="mso_smartLookup";Wh.channelId="SmartLookup";Wh.e$o="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";Wh.pWj="https://uci.edog.cdn.office.net/mirrored/smartlookup/";Wh.qWj="https://uci.cdn.office.net/mirrored/smartlookup/";Wh.d$o="https://hedwigtestserver.blob.core.windows.net/builds/";Wh.c$o="http://localhost:8080/";Wh.jqd="current";Wh.oWj="next";Wh.m8n=2;Wh.xtc=1;Wh.ytc=CommonUIStrings.L_SmartLookupPaneTitle;
Wh.MD="InsightsTaskPane";Wh.PHg="InsightsTaskPaneData";Wh.YTf="InsightsContentFrame";Wh.width=400;Wh.fMn="ApplicationPropertiesRequest";Wh.qMn="SelectionRequest";Wh.lMn="PageRendered";Wh.eMn="ApplicationProperties";Wh.pMn="Selection";Wh.sMn="Telemetry";Wh.rMn="TakeFocus";Wh.kMn="LostFocus";Wh.hMn="Keyboard";Wh.iMn="LegalAgreed";Wh.pJp="WordWac";Wh.H4n="OneNoteWAC";Wh.Rjg="yes";Wh.S_j="appCorrelationId";Wh.Xhp="clientCorrelationId";Wh.T_j="message";Wh.X6i="Microsoft::Office::Insights::LegalAgreed";
Object(u.a)(Wh,"InsightsConstants",null,[]);var dG=d(1694);class QD{}Object(u.a)(QD,"ActivityContractInfo",null,[]);class ds{}Object(u.a)(ds,"BrowserPaneDataField",null,[]);class eG{}Object(u.a)(eG,"BrowserPaneTelemetryEvent",null,[]);class Pl{static jB(b,h){const n=new eG;n.eventName="Diagnostics";n.isActivity=!1;n.activityContract=Object.assign(new QD,{success:!0});const B=[],L=new ds;L.name="Message";L.dataType=0;L.value=b;b=new ds;b.name="Level";b.dataType=0;b.value=Pl.getLevelString(h);Array.add(B,
L);Array.add(B,b);n.dataFields=B;Pl.sendTelemetryEvent(n)}static DLj(b,h){const n=new eG;n.eventName=b;n.isActivity=!1;n.activityContract=Object.assign(new QD,{success:!0});b=[];const B=new ds;B.name="AppCorrelationId";B.dataType=0;B.value=h;Array.add(b,B);n.dataFields=b;Pl.sendTelemetryEvent(n)}static xOo(b,h,n,B,L,ba){const la=new eG;la.eventName="LaunchPaneWithError";la.isActivity=!1;la.activityContract=Object.assign(new QD,{success:!0});const La=[],fb=new ds;fb.name="IsNetworkConnected";fb.dataType=
0;fb.value=b?"true":"false";b=new ds;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new ds;h.name="EntryPoint";h.dataType=0;h.value=n;n=new ds;n.name="RuntimeVersion";n.dataType=0;n.value=B;B=new ds;B.name="IsFirstRelease";B.dataType=1;B.value=L?"true":"false";L=new ds;L.name="IsZeroTerm";L.dataType=1;L.value=ba?"true":"false";ba=new ds;ba.name="IsClientSideRendering";ba.dataType=1;ba.value="false";Array.add(La,fb);Array.add(La,h);Array.add(La,b);Array.add(La,n);Array.add(La,
B);Array.add(La,L);Array.add(La,ba);la.dataFields=La;Pl.sendTelemetryEvent(la)}static Vxg(b,h,n){const B=new eG;B.eventName="CDNDownloadLatency";B.isActivity=!0;B.activityContract=Object.assign(new QD,{duration:n,success:!0});n=[];const L=new ds;L.name="CDNHostname";L.dataType=0;L.value=b;b=new ds;b.name="Filename";b.dataType=0;b.value=h;Array.add(n,L);Array.add(n,b);B.dataFields=n;Pl.sendTelemetryEvent(B,1)}static Gwc(b,h,n,B,L,ba,la,La){const fb=new eG;fb.eventName="LaunchPane";fb.isActivity=!0;
fb.activityContract=Object.assign(new QD,{duration:h,success:!0});h=[];const Cb=new ds;Cb.name="AppCorrelationId";Cb.dataType=0;Cb.value=b;b=new ds;b.name="EntryPoint";b.dataType=0;b.value=n;n=new ds;n.name="IsServerSideRendering";n.dataType=1;n.value="true";const Lb=new ds;Lb.name="UxVersion";Lb.dataType=0;Lb.value=B;B=new ds;B.name="FeatureGates";B.dataType=0;B.value=L;L=new ds;L.name="IsFirstRelease";L.dataType=1;L.value=ba?"true":"false";ba=new ds;ba.name="IsZeroTerm";ba.dataType=1;ba.value=la?
"true":"false";la=new ds;la.name="IsClientSideRendering";la.dataType=1;la.value=La?"true":"false";Array.add(h,Cb);Array.add(h,b);Array.add(h,n);Array.add(h,Lb);Array.add(h,B);Array.add(h,L);Array.add(h,ba);Array.add(h,la);fb.dataFields=h;Pl.sendTelemetryEvent(fb)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)Pl.WCn(b.eventName);else{var n=-1<b.eventName.indexOf(Pl.R_j)?b.eventName:Pl.R_j+b.eventName,B=Pl.Som(b.dataFields);b.isActivity?(b=Object.assign(new sg.a,{name:n,samplingPolicy:h,
dataFields:B,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),aa.a.sendActivityEvent(b)):(b=Object.assign(new wa.a,{name:n,samplingPolicy:h,dataFields:B}),aa.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static Som(b){const h=[];if(b&&0<b.length)for(const n of b)(b=Wc.a.bba(n.name,n.value,Pl.MBl(n.dataType)))&&Array.add(h,b);return h}static MBl(b){switch(b){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static WCn(b){const h=Ya.a.instance.Oa("Common.ISystemInitiatedFeedback");h?h.logActivity(b,null):x.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}Pl.R_j="Office.Insights.SmartLookup.";Object(u.a)(Pl,"TelemetryUtils",null,[]);var HA;(function(b){b[b.other=0]="other";b[b.wjq=1]="searchBoxSearch";b[b.qjq=2]="searchBoxDictionary";b[b.vjq=3]="searchBoxQuickAnswer";b[b.Rlq=4]="smartLookupRibbon";b[b.Qlq=5]="smartLookupContextMenu";
b[b.entity=6]="entity";b[b.LXp=7]="dictionary";b[b.web=8]="web";b[b.Sfq=9]="pictures";b[b.files=10]="files";b[b.nUp=11]="bookmarks";b[b.emc=12]="help";b[b.ZUp=13]="chartRecommendation";b[b.w6p=14]="linkSkill";b[b.sjq=15]="searchBoxFindInDocument";b[b.rjq=16]="searchBoxEntity";b[b.yjq=17]="searchSkill";b[b.sWp=18]="controlF";b[b.qiq=19]="ribbonFindButton";b[b.liq=20]="reuseSlides";b[b.data=21]="data";b[b.iWp=22]="contextMenuDictionary";b[b.lWp=23]="contextMenuSearchSuggestion";b[b.oWp=24]="contextMenuSynonyms";
b[b.kWp=25]="contextMenuSearchBoxSearch";b[b.xjq=26]="searchBoxSearchZeroTerm";b[b.mWp=27]="contextMenuSearchZeroTerm";b[b.fdq=28]="note";b[b.Plq=29]="smartLookupAutoLaunch";b[b.nWp=30]="contextMenuSmartLookupInSubMenu";b[b.cXp=31]="dataDisambiguate";b[b.v6p=32]="linkFiles";b[b.ujq=33]="searchBoxNoteL2";b[b.jWp=34]="contextMenuLaunchL2Document";b[b.xSp=35]="actionAI";b[b.Dfq=36]="pasteAsNewSlide";b[b.Klq=37]="slidesCompression";b[b.tjq=38]="searchBoxGenerateDeck";b[b.cgq=39]="powerPointCopilot";b[b.Rmq=
40]="tellMeService";b[b.mgq=99]="prefetch"})(HA||(HA={}));Object(u.b)("EntryPoint",HA);var ws=d(1623),Yu=d(1635);class lt{static k0(b,h,n,B,L,ba){if(1===n)return hc.SessionStatusManager.instance.ZA?32:8;if(L.value.C4o())return Pl.jB("Skipping Serplet launch",10),32;h=ba;if(!h)return 8;b=lt.jPb();if(n=h.CommandValueId)try{h=D.a(n)}catch(la){return x.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",n),8}n=h;h.selection||(h.neighborhood?n=Object.assign(new ws.a,
{selection:h}):(h=L.value.RPb(),n.selection=Object.assign(new Yu.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));n.selection.clientDetectedLanguage=L.value.IAi();return lt.nic(ba,null,n,b,0,L)}static nic(b,h,n,B,L,ba){const la={};la.controlId=b?b.SourceControlId:"shortcut";n&&(la.entryPoint=HA[n.entryPoint]);x.ULS.sendTraceTag(594044172,1303,50,lt.dX("Show insights",B,la));h?ba.value.Y6o(h,B,L):n&&(A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",
!1)?ba.value.p5o(n,B):ba.value.Z6o(n,B,L));return 32}static dX(b,h,n=null){b={["appCorrelationId"]:h,["message"]:b};if(n)for(const B in n)b[B]=n[B];return D.c(b)}static jPb(){return yb.a.create().toString()}}Object(u.a)(lt,"InvokingPaneUtils",null,[]);class xM{}Object(u.a)(xM,"LaunchDataInDoc",null,[]);class yM{}Object(u.a)(yM,"LaunchDataPasteAsSlide",null,[]);class IA{}Object(u.a)(IA,"LaunchDataSlidesCompression",null,[]);var xs=d(1611);class zM{constructor(b,h,n,B,L,ba,la,La,fb){this.IGc=this.iDd=
this.hx=null;this.gQb=Cb=>{this.hx||3!==Cb.state||(this.hx=Cb,this.iDd=this.hx.Wga)};this.YD=b;this.ga=h||A.AFrameworkApplication.va;this.aq=n;this.Yb=B;this.yqh=La;this.wMc=L;this.Ga=ba;this.Gb=la;this.Z6m();this.S2a=new Rf.a(()=>new Ni.a(fb.value,this.gQb))}Wb(){this.ga.ra(Pa.a.Kan,id.a.frame,Object(z.a)(this,this.W6o,"showInsights"));this.ga.ra(Pa.a.Lan,id.a.frame,Object(z.a)(this,this.X6o,"showInsightsForTellMe"));this.ga.ra(Pa.a.definitions,id.a.frame,Object(z.a)(this,this.S5o,"showDefinitions"));
this.ga.ra(Pa.a.uwf,id.a.frame,Object(z.a)(this,this.T5o,"showDefinitionsForTellMe"));this.ga.ra(Pa.a.HDg,id.a.frame,Object(z.a)(this,this.HDg,"showInsightsForSuggestion"));this.yqh&&(this.ga.ra(Pa.a.uba,id.a.frame,Object(z.a)(this,this.k0,"invokeSmartLookupPane")),this.ga.ra(Pa.a.B8c,id.a.frame,Object(z.a)(this,this.B8c,"invokeInDocSerplet")),this.ga.ra(Pa.a.ade,id.a.frame,Object(z.a)(this,this.ade,"invokeSerpletRibbon")),this.ga.ra(Pa.a.C8c,id.a.frame,Object(z.a)(this,this.C8c,"invokeSerpletContextMenu")),
this.ga.ra(Pa.a.pXf,id.a.frame,Object(z.a)(this,this.pXf,"invokeSerpletTellMeZeroTerm")),this.ga.ra(Pa.a.oXf,id.a.frame,Object(z.a)(this,this.oXf,"invokeSerpletTellMeNotes")),this.ga.ra(Pa.a.Xce,id.a.frame,Object(z.a)(this,this.Xce,"invokeImageSerpletContextMenu")),this.ga.ra(Pa.a.bde,id.a.frame,Object(z.a)(this,this.bde,"invokeSynonymsSerpletContextMenu")),this.ga.ra(Pa.a.Wce,id.a.frame,Object(z.a)(this,this.Wce,"invokeDictionarySerpletContextMenu")),this.ga.ra(Pa.a.dde,id.a.frame,Object(z.a)(this,
this.dde,"invokeZeroTermSerpletContextMenu")),this.ga.ra(Pa.a.Vce,id.a.frame,Object(z.a)(this,this.Vce,"invokeDefinitionSearchFromFloatie")),this.ga.ra(Pa.a.$ce,id.a.frame,Object(z.a)(this,this.$ce,"invokeSerpletBrowseFiles")),this.ga.ra(Pa.a.Yce,id.a.frame,Object(z.a)(this,this.Yce,"invokeInDocSerpletWithLaunchData")),this.ga.ra(Pa.a.Tse,id.a.frame,Object(z.a)(this,this.Tse,"queryToggleSerplet")),this.ga.ra(Pa.a.Txe,id.a.frame,Object(z.a)(this,this.Txe,"setInDocSearchParameter")),this.ga.ra(Pa.a.nXf,
id.a.frame,Object(z.a)(this,this.nXf,"invokeSerpletSlidesCompression")),this.ga.ra(Pa.a.mXf,id.a.frame,Object(z.a)(this,this.mXf,"invokeSerpletPasteAsNewSlide")),A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.ra(Pa.a.gVi,id.a.frame,Object(z.a)(this,this.Mcn,"invokeSmartLookupPaneConversations")),this.ga.ra(Pa.a.Uce,id.a.frame,Object(z.a)(this,this.Uce,"invokeAutoLaunchSearchRequest"))),this.qto().continueWith(()=>{A.AFrameworkApplication.ua&&
A.AFrameworkApplication.ua.Ie(!0)}))}yNh(){this.ga.fb(Pa.a.GLa,id.a.frame,Object(z.a)(this,this.GLa,"invokeFilesSerplet"),4);this.ga.fb(Pa.a.gXf,id.a.frame,Object(z.a)(this,this.GLa,"invokeFilesSerplet"),4);this.ga.fb(Pa.a.aVi,id.a.frame,Object(z.a)(this,this.Acn,"invokeLinkFilesSerplet"),4);if(this.Ga.$("IsTellMeUpSellEnterpriseEnabled")&&this.Ga.$("SmartLookupTokenPrefetchIsEnabled")){const b=Re.a.Haa(0,Object(z.a)(this,this.Cuj,"prefetchToken"),0,177);this.Gb.Zb(b)}}Yff(){kh.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.ga.ra(Pa.a.GLa,id.a.frame,Object(z.a)(this,this.hXf,"invokeFilesSerpletUnavailable")),this.ga.ra(Pa.a.gXf,id.a.frame,Object(z.a)(this,this.hXf,"invokeFilesSerpletUnavailable")),this.ga.ra(Pa.a.aVi,id.a.frame,Object(z.a)(this,this.hXf,"invokeFilesSerpletUnavailable")))}Cuj(b){x.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,
!!b.data);this.HAc().then(h=>{let n=1;if(h)x.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.yyg("SmartLookupFiles: Token prefetch succeeded",!0),h=6E4*this.Ga.ic("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{x.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.yyg("SmartLookupFiles: Token prefetch failed",!1);n=parseInt(b.data||"1");if(n>this.Ga.ic("SmartLookupTokenRenewalRetryThreshold",5)){x.ULS.sendTraceTag(577345097,
1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.yyg("SmartLookupFiles: Token prefetch max retry count reached",!1);return}h=6E4*this.Ga.ic("SmartLookupTokenRetryWaitDurationInMinutes",10);n++}h=new Re.a(3,1,h,Object(z.a)(this,this.Cuj,"prefetchToken"),177);h.data=n.toString();this.Gb.Zb(h)})}yyg(b="",h=!1){this.wMc.execute(n=>{n&&n.Ewc("PrefetchToken",h,0,"SmartLookup",b)})}HAc(){return this.wMc?new Promise(b=>{this.wMc.execute(h=>{if(h){var n=Date.now();h.getToken("SmartLookup",
this.Ga.kb("SmartLookupShredderServiceEndpoint")).then(B=>{b(!!B&&0<B.length);h.Ewc("TryGetTokenInternal",!!B&&0<B.length,Date.now()-n,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}qto(){const b=new Zf.a;if(this.Ga.$("BrowserSupportsInsightsPaneSSO"))this.yNh(),b.gg(!0);else{if(!this.wMc)return x.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.gg(!1),this.Yff(),b.task;this.wMc.execute(h=>{h?h.getToken("SmartLookup",this.Ga.kb("SmartLookupShredderServiceEndpoint")).then(n=>
{x.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!n&&0<n.length);n&&0<n.length?(this.yNh(),b.gg(!0)):this.Yff()}):(x.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),b.gg(!1),this.Yff())})}return b.task}W6o(b,h,n,B,L){if(1===n)return A.AFrameworkApplication.ua&&A.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!A.AFrameworkApplication.XWc?8:this.YD.value.IZi()?32:8;b=lt.jPb();h=this.YD.value.RPb();return this.yqh?(h=Object.assign(new Yu.a,{neighborhood:h.neighborhood,
mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new ws.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new xs.a,{landingTab:"All"})}),lt.nic(L,null,h,b,0,this.YD)):lt.nic(L,h,null,b,0,this.YD)}S5o(b,h,n,B,L){if(1===n)return this.YD.value.IZi()?32:8;b=lt.jPb();h=this.YD.value.RPb();return lt.nic(L,h,null,b,1,this.YD)}X6o(b,h,n,B,L){return 1===n?32:this.umi(L,0)}T5o(b,h,n,B,L){return 1===n?32:this.umi(L,1)}umi(b,h){const n=lt.jPb(),B=b.CommandValueId;
let L;try{L=D.a(B)}catch(ba){return x.ULS.sendTraceTag(6295941,1303,15,lt.dX(String.format("Insights parameters [{0}] is not in proper format.",B),n)),8}return lt.nic(b,L,null,n,h,this.YD)}HDg(b,h,n,B,L){if(1===n)return 32;if(!L)return 8;b=L.query?L.query:"";h=lt.jPb();n=new dG.a;n.neighborhood=b;n.mentionStart=0;n.mentionLength=b.length;return lt.nic(L,n,null,h,0,this.YD)}Acn(b,h,n,B){if(1===n)return hc.SessionStatusManager.instance.ZA?32:8;const L=A.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),
ba=this.YD.value.s9a();return this.k0(b,h,n,B,Object.assign(new ws.a,{selection:Object.assign(new Yu.a,{neighborhood:ba.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new xs.a,{landingTab:"File"}),entryPoint:L?32:10}))}GLa(b,h,n,B){if(1===n)return hc.SessionStatusManager.instance.ZA?32:8;const L=A.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),ba=this.YD.value.s9a();return this.k0(b,h,n,B,Object.assign(new ws.a,{selection:Object.assign(new Yu.a,{neighborhood:ba.neighborhood,
mentionStart:0,mentionLength:0}),launchData:Object.assign(new xs.a,{landingTab:L?"Slide":"File"}),entryPoint:L?20:10}))}hXf(){return 2}B8c(b,h,n,B,L){if(1===n)return hc.SessionStatusManager.instance.Gk?8:32;const ba=this.YD.value.s9a();L=void 0===L||null===L?18:19;return this.k0(b,h,n,B,Object.assign(new ws.a,{selection:Object.assign(new Yu.a,{neighborhood:ba.neighborhood,mentionStart:ba.mentionStart,mentionLength:ba.mentionLength}),launchData:Object.assign(new xs.a,{landingTab:"Indoc"}),entryPoint:L}))}Yce(b,
h,n,B,L){L=L.CommandValueId;if(!L||L&&this.IGc&&L.query===this.IGc.query&&L.matchCase===this.IGc.matchCase&&L.matchWholeWordOnly===this.IGc.matchWholeWordOnly)return 32;const ba=this.YD.value.s9a();return this.k0(b,h,n,B,Object.assign(new ws.a,{selection:Object.assign(new Yu.a,{neighborhood:ba.neighborhood,mentionStart:ba.mentionStart,mentionLength:ba.mentionLength}),launchData:Object.assign(new xs.a,{landingTab:"Indoc",data:Object.assign(new xM,{type:4,query:L.query,matchCase:L.matchCase,matchWholeWord:L.matchWholeWordOnly})}),
entryPoint:18}))}Tse(b,h,n,B,L){L&&(L[$g.a.On]=this.YD.value.nTb);return 32}Txe(b,h,n,B,L){if(b=L.CommandValueId)this.IGc=b;return 32}Mcn(b,h,n){if(1===n)return hc.SessionStatusManager.instance.ZA?32:8;b=this.YD.value.s9a();b=Object.assign(new ws.a,{selection:Object.assign(new Yu.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new xs.a,{landingTab:"All"})});this.YD.value.Jhe(b);return 32}Uce(b,h,n){if(1===n)return hc.SessionStatusManager.instance.ZA?
32:8;b=this.YD.value.s9a();b=Object.assign(new ws.a,{selection:Object.assign(new Yu.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new xs.a,{landingTab:"All",data:A.AFrameworkApplication.INb})});h=lt.jPb();this.YD.value.v_b(b,h);return 32}ade(b,h,n,B){if(1===n)return hc.SessionStatusManager.instance.ZA?32:8;const L=this.YD.value.KAi();return this.k0(b,h,n,B,Object.assign(new ws.a,{selection:Object.assign(new Yu.a,{neighborhood:L.neighborhood,
mentionStart:L.mentionStart,mentionLength:L.mentionLength}),entryPoint:4,launchData:Object.assign(new xs.a,{landingTab:"All"})}))}C8c(b,h,n,B){return this.k0(b,h,n,B,Object.assign(new ws.a,{entryPoint:5,launchData:Object.assign(new xs.a,{landingTab:"All"})}))}pXf(b,h,n,B){if(1===n)return hc.SessionStatusManager.instance.ZA?32:8;const L=this.YD.value.s9a();return this.k0(b,h,n,B,Object.assign(new ws.a,{selection:Object.assign(new Yu.a,{neighborhood:L.neighborhood,mentionStart:L.mentionStart,mentionLength:0}),
launchData:Object.assign(new xs.a,{landingTab:"All"}),entryPoint:26}))}Wce(b,h,n,B){return 1===n?(b=this.YD.value.RPb())&&0<b.mentionLength?32:8:this.k0(b,h,n,B,Object.assign(new ws.a,{entryPoint:22,launchData:Object.assign(new xs.a,{landingTab:"All"})}))}Vce(b,h,n,B){return 1===n?(b=this.YD.value.RPb())&&0<b.mentionLength?32:8:this.k0(b,h,n,B,Object.assign(new ws.a,{entryPoint:7,launchData:Object.assign(new xs.a,{landingTab:"All"})}))}Xce(b,h,n,B){return this.k0(b,h,n,B,Object.assign(new ws.a,{launchData:Object.assign(new xs.a,
{landingTab:"Image"}),entryPoint:9}))}bde(b,h,n,B){return this.k0(b,h,n,B,Object.assign(new ws.a,{launchData:Object.assign(new xs.a,{landingTab:"All"}),entryPoint:24}))}oXf(b,h,n,B){return this.k0(b,h,n,B,Object.assign(new ws.a,{launchData:Object.assign(new xs.a,{landingTab:"Notes"}),entryPoint:33}))}dde(b,h,n,B){if(1===n)return hc.SessionStatusManager.instance.ZA?32:8;const L=this.YD.value.s9a();return this.k0(b,h,n,B,Object.assign(new ws.a,{selection:Object.assign(new Yu.a,{neighborhood:L.neighborhood,
mentionStart:L.mentionStart,mentionLength:0}),launchData:Object.assign(new xs.a,{landingTab:"All"}),entryPoint:27}))}nXf(b,h,n,B,L){if(!L)return 8;const ba=L.url;L=L.selectedSlideIDs;return this.k0(b,h,n,B,Object.assign(new ws.a,{launchData:Object.assign(new xs.a,{landingTab:"All",data:Object.assign(new IA,{type:6,url:ba,selectedSlideIDs:L})}),entryPoint:37}))}mXf(b,h,n,B,L){if(!L)return 8;const ba=L.Selection;L=L.CurrentDocTitle;return this.k0(b,h,n,B,Object.assign(new ws.a,{launchData:Object.assign(new xs.a,
{landingTab:"All",data:Object.assign(new yM,{type:5,selection:ba,currentDocTitle:L})}),entryPoint:36}))}k0(b,h,n,B,L){return lt.k0(b,h,n,B,this.YD,L)}$ce(b,h,n){if(1===n)return 32;this.hx||this.S2a.value.HR("Browse File from Search pane",!0);if(!this.iDd||""===this.iDd)return x.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;$c.a.yn(this.iDd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}Z6m(){const b=this.Yb.ge(Wh.MD);b.parent=Dd.AFrame.mq;b.Bja(Object(z.a)(this,
this.Fwc,"sendIFrameTakeFocusMessage"));this.aq.xW(Wh.MD)}Fwc(){document.activeElement.blur();A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.ztb||(this.YD.value.nTo(),this.YD.value.vOo())}dispose(){this.YD.value&&this.YD.value.dispose()}}Object(u.a)(zM,"InsightsActor",null,[13]);const AM=b=>{b=b.split("-");return b[b.length-1]},JO=()=>{var b=tI();if(b)return Promise.resolve(b);b=RD().replace("SearchWeb","searchweb");b=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Wh.oWj+"/":b+Wh.jqd+"/";b+="version.json";if(X.a.Ita)return KO(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?(Pl.jB("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(n=>n.json()).catch(()=>{Pl.jB("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(n=>{n=D.b(JSON.stringify(n));
return n.version?n.version:""},n=>{Pl.jB("InsightsUtils - Failed to deserialize version: "+n.toString(),10);x.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+n.toString());return""}).then(n=>n)}catch(h){return Pl.jB("InsightsUtils - Failed to download version.json: "+h.toString(),10),x.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},KO=b=>{const h=A.AFrameworkApplication.Be;return new Promise(n=>{const B=
new aG.a(b,1,null,null,!0,2,null);h.send(B).UDa(L=>{L&&L.data?L.data.De||(Pl.jB("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+L.data.He,10),n("")):(Pl.jB("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),n(""));try{const ba=D.b(L.data.De);ba.version&&n(ba.version)}catch(ba){Pl.jB("InsightsUtils - Failed to deserialize version: "+ba.toString(),10),n("")}},L=>{L&&L.data?Pl.jB("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+
L.data.He,10):Pl.jB("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);n("")})})},sI=()=>A.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),il=()=>{const b=RD();return sI()||A.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")?b+tI()+"/":A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Wh.oWj:b+Wh.jqd},tI=()=>sI()?"dev":A.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")?A.AFrameworkApplication.K.kb("SmartLookupPRClientVersion").split("/")[1]:A.AFrameworkApplication.K.kb("SmartLookupClientVersion"),BM=b=>{var h=3===A.AFrameworkApplication.ua.Ib.Tk?"wordwac":2===A.AFrameworkApplication.ua.Ib.Tk?"pptwac":"excelwac";var n=hj.a.Cg(A.AFrameworkApplication.lcid);const B=n?n.name:"en-us";n=RD();const L=sy();h="main_ssr_wac.html?appName="+h+"&culture="+B;return"LOCAL"===L?
n+h:n+((""!==b?b:Wh.jqd)+"/")+h},uI=b=>RD()+(""!==b?b:Wh.jqd)+"/scripts/microsoft.office.smartlookup.host.runtime.js",RD=()=>{switch(sy()){case "LOCAL":return Wh.c$o;case "PR":const b=A.AFrameworkApplication.K.kb("SmartLookupPRClientVersion").split("/");return Wh.d$o+b[0]+"/";case "INT":return Wh.e$o;case "EDOG":return Wh.pWj;default:return Wh.qWj}},LO=()=>{if(!A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(sy()){case "EDOG":return Wh.pWj;
case "PROD":return Wh.qWj;default:return""}},sy=()=>{if(A.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(A.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(A.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||
A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(A.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")&&A.AFrameworkApplication.K.kb("SmartLookupPRIntentSvc"))return"PR";if(sI())return"LOCAL";switch(Object(ya.a)(String,A.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(A.AFrameworkApplication.K&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",
!1)){let b=A.AFrameworkApplication.K.kb("UserPrincipalName");b=F.a.xh(b);const h=A.AFrameworkApplication.K.jy("SmartLookupINTEnabledForSKITeam")?A.AFrameworkApplication.K.iD("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},hO=()=>{let b;b=A.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",
!1)?"EDOG":A.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":A.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":sy();const h=A.AFrameworkApplication.K.kb("IntentServiceEndpoint"),n=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return A.AFrameworkApplication.K.kb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(n?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(n?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},fG=()=>{const b=sy(),h=A.AFrameworkApplication.K.kb("IntentServiceEndpoint");switch(b){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===b&&""!==h?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class CM{sendTelemetryEvent(b){Pl.sendTelemetryEvent(b)}}
Object(u.a)(CM,"OtelTelemetrySink",null,[419]);class DM{}Object(u.a)(DM,"ApplicationProperties",null,[]);class iO{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(u.a)(iO,"CurrentDocumentProperties",null,[]);class SD{}Object(u.a)(SD,"EnterpriseUserInfo",null,[]);class vI{}Object(u.a)(vI,"FeatureGates",null,[]);class TD{constructor(b,h){this.ow=this.oj=null;this.eQa="Search";this.Rbj=!0;this.tJb=h;this.tu=b;this.tu.execute(n=>{n.isFeatureEnabled("mso_sendASmile",!0).then(B=>
{this.Rbj=B}).catch(B=>{Pl.jB("SearchHelper - Failed to check if Feedback feature is enabled: "+B.toString(),15)})});b=hO();h=A.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(A.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.ow={};const n=this.wKm();if(n&&0<n.length)for(let B=0;B<n.length;B++){const L=n[B],ba=this.MKm(L);switch(ba.toLowerCase()){case "true":this.ow[L]=
!0;break;case "false":this.ow[L]=!1;break;default:this.ow[L]=ba}}this.ow.EnableInDocumentSearch=h;this.ow.EnableInDocumentSearchReplace=!0;this.ow.EnableInDocumentParamLocalSearch=!0;this.ow.EnableInDocumentQuerySuggest=h&&A.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.ow.EnableInDocumentQuestionGeneration=h&&A.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||
A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.ow.EnableInDocumentExperiment1=h&&A.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.ow.EnableInDocumentExperiment2=h&&A.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1);this.ow.EnableInDocumentExperiment3=h&&A.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.ow.EnableZeroTermAutoRefresh=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.ow.EnableTap3SZeroTerm=A.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.ow.EnableLocalSearch=!0;this.ow.EnableInDocumentStickyFilters=!0;this.ow.IntentServiceEndpoint=b;this.ow.EnablePDFShredding=A.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.ow.FilterNonPPTFilesForReuseSlides=A.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.ow.UXBundleVersion=tI();this.ow.SmartLookupServicePath=il();this.ow.EnableAcronymSearch=
!0;this.ow.UseAltAnswerEndpoint1=A.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.ow.UseAltAnswerEndpoint2=A.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.ow.UseAltAnswerEndpoint3=A.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.ow.UseNextUXVersion=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.ow.IgnoreNeighborhoodContext=A.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.ow.ShowDebugInfo="INT"===sy();this.ow.DebugCommands=A.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.ow.ChangeGates=A.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.ow.QnaInMixSection=!0;this.ow.EnableNoteSearch=A.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.ow.EnableWikiL2=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.ow.EnableFilteringOutRedundantKPE=
A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.ow.EnableZeroTermEntitySuggestion=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.ow.RankingModels=A.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.ow.EnableClientSideRendering=!0}else this.oj=new vI,this.oj.EnableInDocumentSearch=h,this.oj.EnableInDocumentSearchReplace=
!0,this.oj.EnableInDocumentParamLocalSearch=!0,this.oj.EnableInDocumentQuerySuggest=h&&A.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.oj.EnableInDocumentQuestionGeneration=h&&A.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.oj.EnableInDocumentExperiment1=h&&A.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.oj.EnableInDocumentExperiment2=h&&A.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.oj.EnableInDocumentExperiment3=
h&&A.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.oj.EnableZeroTermAutoRefresh=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.oj.EnableTap3SZeroTerm=A.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.oj.EnableLocalSearch=!0,this.oj.EnableInDocumentStickyFilters=!0,this.oj.IntentServiceEndpoint=b,this.oj.EnablePDFShredding=A.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.oj.FilterNonPPTFilesForReuseSlides=A.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.oj.UXBundleVersion=tI(),this.oj.SmartLookupServicePath=il(),this.oj.EnableAcronymSearch=
!0,this.oj.UseAltAnswerEndpoint1=A.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.oj.UseAltAnswerEndpoint2=A.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.oj.UseAltAnswerEndpoint3=A.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.oj.UseNextUXVersion=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.oj.IgnoreNeighborhoodContext=A.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.oj.ShowDebugInfo="INT"===sy(),this.oj.DebugCommands=A.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.oj.ChangeGates=A.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.oj.QnaInMixSection=!0,this.oj.EnableNoteSearch=A.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.oj.EnableWikiL2=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.oj.EnableFilteringOutRedundantKPE=
A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.oj.EnableZeroTermEntitySuggestion=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.oj.RankingModels=A.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.oj.EnableClientSideRendering=!0,this.oj.SharedSerpletFeatureGate1=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.oj.SharedSerpletFeatureGate2=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.oj.SharedSerpletFeatureGate3=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.oj.SharedSerpletFeatureGate4=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.oj.SharedSerpletFeatureGate5=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.oj.SharedSerpletFeatureGate6=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.oj.SharedSerpletFeatureGate7=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.oj.SharedSerpletFeatureGate8=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.oj.SharedSerpletFeatureGate9=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.oj.SharedSerpletFeatureGate10=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.oj.SharedSerpletFeatureGate11=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.oj.SharedSerpletFeatureGate12=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.oj.SharedSerpletFeatureGate13=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.oj.SharedSerpletFeatureGate14=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.oj.SharedSerpletFeatureGate15=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.oj.SharedSerpletFeatureGate16=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.oj.SharedSerpletFeatureGate17=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.oj.SharedSerpletFeatureGate18=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.oj.SharedSerpletFeatureGate19=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.oj.SharedSerpletFeatureGate20=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.oj.SharedSerpletFeatureGate21=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.oj.SharedSerpletFeatureGate22=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.oj.SharedSerpletFeatureGate23=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.oj.SharedSerpletFeatureGate24=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.oj.SharedSerpletFeatureGate25=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.oj.SharedSerpletFeatureGate26=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.oj.SharedSerpletFeatureGate27=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.oj.SharedSerpletFeatureGate28=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.oj.SharedSerpletFeatureGate29=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.oj.SharedSerpletFeatureGate30=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.oj.SharedSerpletFeatureGate31=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.oj.SharedSerpletFeatureGate32=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.oj.SharedSerpletFeatureGate33=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.oj.SharedSerpletFeatureGate34=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.oj.SharedSerpletFeatureGate35=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.oj.SharedSerpletFeatureGate36=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.oj.SharedSerpletFeatureGate37=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.oj.SharedSerpletFeatureGate38=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.oj.SharedSerpletFeatureGate39=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.oj.SharedSerpletFeatureGate40=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.nLc=Ya.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.Fub=TD.isEnterpriseUser();this.rYa=A.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.U7f=za.a.rU(A.AFrameworkApplication.K.kb("AppCatalogUrl")||"");this.kHn=A.AFrameworkApplication.K.kb("UserPrincipalName");this.Fub&&this.vHi()}MKm(b){return A.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+b,"")}wKm(){const b=A.AFrameworkApplication.K.E8a,h=A.AFrameworkApplication.K.iD("SmartLookupFlightKeywordList"),n=[];if(b&&h&&0<h.length)for(const L in b){var B=
{key:L,value:b[L]};B=B&&B.key?B.key:"";for(let ba=0;ba<h.length;ba++)if(-1<B.toLowerCase().indexOf(h[ba].toLowerCase())){const la=B.split(".");la&&4===la.length&&Array.add(n,la[la.length-1])}}return n}hOf(b,h,n,B){return new Promise(L=>{this.rrn().then(ba=>{const la=new DM;la.anid="";la.applicationName=3===A.AFrameworkApplication.ua.Ib.Tk?"WORD":"POWERPNT";la.applicationVersion=A.AFrameworkApplication.buildVersion;la.appCorrelationId=b?b:lt.jPb();la.themePlatform="web";la.lcid=A.AFrameworkApplication.lcid;
la.launchUtcTime=(new Date).toUTCString();A.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?la.featureGates=D.c(this.ow):la.featureGates=D.c(this.oj);var La=hj.a.Cg(A.AFrameworkApplication.lcid);La=La?La.name:null;la.market=AM(La);la.uiLanguage=La;la.sessionId=A.AFrameworkApplication.userSessionId;la.themeId=n;la.parentalControl="yes";la.processorOnlyMode=ba;la.isEditingAllowed=h.isEditingAllowed();la.isFeedbackEnabled=this.Rbj;la.isClientSideRendering=18===B||19===B||15===B;la.disableClipboard=
A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&A.AFrameworkApplication.lH&&!A.AFrameworkApplication.UNb;la.accessToken=this.Fub?this.vHi():"";ba=new SD;ba.CountryCode=AM(La);ba.ServiceEndpoint=this.rYa;ba.IsGoLocal=A.AFrameworkApplication.K.$("IsGoLocalEnvironment");ba.IsEnabled=this.Fub;ba.IsEnterpriseEnabled=this.Fub;ba.TenantRoot=this.U7f;ba.Upn=this.kHn;La=sy();ba.IsEUDB="PROD"===La&&""!==A.AFrameworkApplication.K.kb("IntentServiceEndpoint");
la.enterpriseUserInfo=ba;ba=new iO;ba.filePath=A.AFrameworkApplication.K.kb("EditDocInClientUrl");ba.docName=A.AFrameworkApplication.K.kb("FileName");ba.author=99!==B?h.author():null;ba.createdDate=99!==B?h.createdDate():null;la.currentDocument=ba;L(la)})})}rrn(){return new Promise(b=>{this.tu?this.tu.execute(h=>{h.isFeatureEnabled(Wh.f$o,!0).then(n=>{b(!n)}).catch(n=>{Pl.jB("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+n.toString(),10);b(!0)})}):b(!0)})}bao(b){this.nLc&&
this.Fub&&this.a$d(this.rYa).then(h=>{b(h)})}vHi(){return"Dev Box"===A.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.nLc?this.nLc.zOm(this.eQa,this.rYa):""}a$d(b){return"Dev Box"===A.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(h=>
{h(window.SearchPaneShredderTokenOverride)}):this.nLc?this.nLc.getToken(this.eQa,b):Promise.resolve("")}E4c(){return this.tJb?this.tJb.getVersion():""}Krm(){return A.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?D.c(this.ow):D.c(this.oj)}static isEnterpriseUser(){const b=A.AFrameworkApplication.K.kb("SovereignEnvironmentName"),h=A.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(u.a)(TD,"SearchHelper",null,[379]);class iC{constructor(){iC._instance=
""}getVersion(){return iC._instance}OZo(b){iC._instance=b}}iC._instance=null;Object(u.a)(iC,"SmartLookupVersion",null,[]);class vw{}Object(u.a)(vw,"ConfigurationProvider",null,[]);class UD{constructor(b){UD._instance=b}HKf(){return UD._instance}}UD._instance=null;Object(u.a)(UD,"SearchHostRuntime",null,[]);class UJ{constructor(){this.Iia=this.h4b=this.W=null}get name(){return"Common.App.Insights"}wc(b){this.W=b;const h=Di.a.$p(Ya.a.instance.Qa("Common.IEventEmitter<Common.IGetMoreInfoResult>")),n=
A.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||A.AFrameworkApplication.K.$("SmartLookupIsEnabled");b.register(zM,"Common.App.Insights.InsightsActor").ha().Rd(()=>new zM(b.rf("Common.App.Insights.IInsightsManager"),A.AFrameworkApplication.va,kc.a.instance,Ph.FocusManager.instance(),b.Qa("Common.App.SearchCommon.ISearchOAuthManager"),A.AFrameworkApplication.K,ph.a.instance,n,new Rf.a(()=>h.result)));b.register(378,"Common.App.Insights.IDocumentContentExtractionManager").ha().Rd(()=>new wM(b));
n&&(b.register(iC,"Common.App.Insights.SmartLookupVersion").ha().Rd(()=>new iC),b.register(379,"Common.App.SearchCommon.ISearchHelper").ha().Rd(()=>new TD(Ya.a.instance.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Oa("Common.App.Insights.SmartLookupVersion"))))}init(){A.AFrameworkApplication.v3&&(this.h4b=this.W.Oa("Common.App.Insights.InsightsActor"),this.h4b.Wb())}Vro(){if(A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",
!1)){var b=A.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.W.resolve("Common.App.SearchCommon.ISearchHelper").a$d(b).then(h=>{var n={};n.Authorization="Bearer "+h;h=fG();const B=A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);n=new aG.a(h+("?isTelemetryOnly="+B),1,null,n,!0,2,null);A.AFrameworkApplication.Be.send(n).UDa(()=>{Pl.jB("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+
B,50)},L=>{Pl.jB("InsightsPackage - Failed to send refreshmemory API request. Error: "+L.toString(),10)})})}}mYl(){this.ubn();this.Vro()}ubn(){JO().then(b=>{if(""!==b){const h=this.W.Oa("Common.App.Insights.SmartLookupVersion");h&&h.OZo(b)}this.I0d();this.h4b=this.W.resolve("Common.App.Insights.InsightsActor");b=uI(b);b=cb.a.create(b);b.w2((h,n)=>{n.succeeded?this.O_o()&&this.prefetchZeroTerm():Pl.jB("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+n.WF,10);this.h4b.Wb()});
ab.a.D_(b)})}O_o(){const b=Object.assign(new vw,{channelId:Wh.channelId,approvedOriginPattern:sI()?"^(http)?://(localhost:8080)$":A.AFrameworkApplication.K.kb("SmartLookupApprovedOriginPattern")});var h=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const n=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),B=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),L=new ob.a;h&&L.add(h);n&&L.add(n);B&&L.add(B);h=hO();try{const ba=new CM,la=SmartLookupHostRuntime.setup(b,
L.toArray(),!0,h,ba);this.W.register(UD,"Common.App.SearchCommon.SearchHostRuntime").ha().Rd(()=>new UD(la));return!0}catch(ba){return Pl.jB("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+ba,10),!1}}prefetchZeroTerm(){if(A.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=Ya.a.instance.Oa("Common.App.SearchCommon.SearchHostRuntime");
if(b){const h=this.W.resolve("Common.App.SearchCommon.ISearchHelper"),n=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");h.hOf(null,n,0,99).then(B=>{b.HKf().prefetchZeroTerm(B,A.AFrameworkApplication.userSessionId,il(),!0,"Indoc",null)})}else Pl.jB("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}I0d(){var b=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const h=BM(b.E4c());b=b.E4c();b=RD()+(""!==b?b:Wh.jqd)+"/scripts/microsoft.office.smartlookup.ssr.js";
const n=LO();X.a.Ita?this.lYl(h,b):(this.jYl(h,n),this.kYl(b,n))}jYl(b,h){const n=new Sys.Net.WebRequest;n.set_httpVerb("GET");const B={};B.method=n.get_httpVerb();n.set_url(b);const L=(new Date).getTime();try{window.fetch(n.getResolvedUrl(),B).then(()=>{""!==h&&Pl.Vxg(h,b,(new Date).getTime()-L);this.W.Oa("Common.App.Insights.SmartLookupVersion")})}catch(ba){Pl.jB("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+ba.toString(),10)}}kYl(b,h){var n=new Sys.Net.WebRequest;
n.set_httpVerb("GET");const B={};B.method=n.get_httpVerb();n.set_url(b);let L=-1;if(A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))n=A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),ph.a.instance.Zb(new Re.a(5,1,n,()=>{const ba=cb.a.create(b);ba.sgf(()=>{L=Date.now()});ba.w2((la,La)=>{La.succeeded?""!==h&&Pl.Vxg(h,b,Date.now()-L):Pl.jB("InsightsPackage - Failed to prefetch JS file.",
10)});ab.a.D_(ba)}));else{L=Date.now();try{window.fetch(n.getResolvedUrl(),B).then(()=>{""!==h&&Pl.Vxg(h,b,Date.now()-L)})}catch(ba){Pl.jB("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+ba.toString(),10)}}}lYl(b,h){if(X.a.Ita){var n=A.AFrameworkApplication.Be;b=new aG.a(b,1,null,null,!0,2,null);n.send(b).UDa(B=>{B&&B.data?B.data.De?this.W.Oa("Common.App.Insights.SmartLookupVersion"):Pl.jB("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
B.data.He,10):Pl.jB("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},B=>{B&&B.data?Pl.jB("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+B.data.He,10):Pl.jB("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});A.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(h=new aG.a(h,1,null,null,!0,2,null),n.send(h).UDa(B=>{B&&B.data?B.data.De||Pl.jB("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
B.data.He,10):Pl.jB("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},B=>{B&&B.data?Pl.jB("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+B.data.He,10):Pl.jB("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.h4b&&this.h4b.dispose()}}Object(u.a)(UJ,"InsightsPackage",null,[0,1]);var gG=d(1676);class ty{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(u.a)(ty,"DocumentContentParams",null,[]);var JA=d(1986),EM=d(481),jO=d(2186),FM=d(1540),wI;(function(b){b.BlockedByClassifier="BlockedByClassifier";b.BlockedByLanguage="BlockedByLanguage";b.BlockedByPostfilter="BlockedByPostfilter";b.BlockedByPostfilterProcessError="BlockedByPostfilterProcessError";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.DocumentLengthTooShort="DocumentLengthTooShort";b.InvalidRequestForm="InvalidRequestForm";
b.NthParagraphSummaryNotSupported="NthParagraphSummaryNotSupported";b.OffensiveContentInUserInput="OffensiveContentInUserInput";b.OutOfScopeRequestInUserInput="OutOfScopeRequestInUserInput";b.ResourceUnavailable="ResourceUnavailable";b.Success="Success";b.Timeout="Timeout";b.UnknownError="UnknownError";b.UnknownErrorInParser="UnknownErrorInParser";b.UserNotAuthorized="UserNotAuthorized"})(wI||(wI={}));var hG;(function(b){b.FailedTTS="FailedTTS";b.NotRequestedTTS="NotRequestedTTS";b.Success="Success";
b.UnknownError="UnknownError"})(hG||(hG={}));var ys;(function(b){b.q1a="SearchProvider";b.ngb="TextSummarization"})(ys||(ys={}));Object(u.b)("WorkflowType",ys);var Xt;(function(b){b.Success="Success";b.nRg="Invoked";b.Error="Error"})(Xt||(Xt={}));Object(u.b)("LogType",Xt);var Yt;(function(b){b.Ldk="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.BlockedByClassifier="BlockedByClassifier";b.mRg="InvalidAnnotation";b.sjk="StaleAnnotation";
b.Timeout="Timeout";b.Other="Other"})(Yt||(Yt={}));Object(u.b)("ErrorReason",Yt);class iG{constructor(b){this.Shi=b;this.$eg=this.$eg.bind(this);this.TWb=this.TWb.bind(this);this.Sip=A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3)}async submitDocumentContentExtractionSignal(){try{this.qMo=Date.now();this.Sxb=yb.a.create().toString();this.log({wM:ys.q1a,logType:Xt.nRg,success:!0,correlationId:this.Sxb});var b=sy().toLowerCase();b="int"===
b||"local"===b;await this.activateAnnotation();const h=new Kq.l({parentPath:["Signal",JA.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new JA.SearchProviderSignal({correlationId:this.Sxb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});this.mKj=window.setTimeout(()=>{this.onError(ys.q1a,Xt.Error,Yt.Timeout)},1500)}catch(h){window.clearTimeout(this.mKj),this.onError(ys.q1a,Xt.Error,Yt.Other,this.Zxi(h))}}async generateDocumentSummaryDetails(){try{if(!iG.fad)return null;
this.Rip=Date.now();this.log({wM:ys.ngb,logType:Xt.nRg,success:!0});await this.activateAnnotation();const b=new Kq.l({parentPath:["Signal",jO.a.getTypeName()],items:[{id:"TextSummarization",body:new jO.a}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});this.o0j=window.setTimeout(()=>{this.onError(ys.ngb,Xt.Error,Yt.Timeout)},this.Sip);return new Promise(h=>{this.Xyc=h})}catch(b){window.clearTimeout(this.o0j),this.onError(ys.ngb,Xt.Error,Yt.Other,this.Zxi(b))}}async generateDocumentSummary(){var b;
return null===(b=await this.generateDocumentSummaryDetails())||void 0===b?void 0:b.summary}static get fad(){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}static get vrn(){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableVoiceSummarization",!1)}async activateAnnotation(){if(!this.znc){await Es.a.Pl();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,
h=[b(Object.assign(new EM.a,{annotationType:JA.SearchProviderAnnotation.getTypeName(),handler:this.$eg}))];iG.fad&&h.push(b(Object.assign(new EM.a,{annotationType:FM.b.getTypeName(),handler:this.TWb})));await Promise.all(h);this.znc=!0}}TWb(b){var h,n,B;if(this.Xyc)if(this.o0i(b)){if(b=b.items[0],FM.b.typeGuard(b.body))if(window.clearTimeout(this.o0j),b=b.body,b.status!==wI.Success)this.onError(ys.ngb,Xt.Error,this.mrm(b),`[TextSummary] workflow failed with status: ${b.status}`);else{this.log({wM:ys.ngb,
logType:Xt.Success,success:!0});var L=null!==b.summary&&""!==b.summary,ba=iG.vrn&&(null===(h=b.tts)||void 0===h?void 0:h.requestStatus)===hG.Success&&null!==(null===(n=b.tts)||void 0===n?void 0:n.base64Audio)&&""!==(null===(B=b.tts)||void 0===B?void 0:B.base64Audio);this.Xyc({succeeded:L,summary:L?b.summary:null,audioSucceeded:ba,audioBase64:ba?b.tts.base64Audio:null});this.Xyc=null}}else this.log({wM:ys.ngb,logType:Xt.Error,success:!1,Z1d:Yt.mRg})}$eg(b){if(this.o0i(b)&&(b=b.items[0],JA.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.mKj),
(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.Sxb)this.log({wM:ys.q1a,logType:Xt.Error,Z1d:Yt.Ldk,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});else if(this.Sxb!==b.correlationId)this.log({wM:ys.q1a,logType:Xt.Error,Z1d:Yt.sjk,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",
workflowExecutionTime:b.workflowExecutionTime});else{var h=this.i$h(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.log({wM:ys.q1a,logType:Xt.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.Sxb=void 0;this.Shi.DNj(h)}else this.onError(ys.q1a,Xt.Error,Yt.mRg)}mrm(b){switch(b.status){case "BlockedByPrefilter":return Yt.BlockedByPrefilter;case "BlockedByQualityCheck":case "BlockedByPostfilter":return Yt.BlockedByQualityCheck;
default:return Yt.Other}}o0i(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){switch(b.wM){case ys.q1a:var h=this.qMo;break;case ys.ngb:h=this.Rip;break;default:h=-1}const n=Date.now(),B=h?n-h:-1;h=[Object.assign(new ia.a,{name:"WorkflowType",string:b.wM}),Object.assign(new ia.a,{name:"LogType",string:b.logType}),Object.assign(new ia.a,{name:"ErrorReason",string:b.Z1d}),Object.assign(new ia.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new ia.a,{name:"Message",string:b.message}),
Object.assign(new ia.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new ia.a,{name:"StartTime",int64:h}),Object.assign(new ia.a,{name:"EndTime",int64:n}),Object.assign(new ia.a,{name:"Duration",int64:B})];Object(Pe.a)("AugloopSearchProviderData",b.success,B,h)}Zxi(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}i$h(b="",h="",n=""){return Object.assign(new ty,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:n})}onError(b,h,n,B){h={wM:b,
logType:h,success:!1,message:B,Z1d:n};switch(b){case ys.q1a:if(!this.Sxb)break;h.correlationId=this.Sxb;this.log(h);this.Sxb=void 0;this.Q5l();break;case ys.ngb:if(!this.Xyc)break;this.log(h);this.Xyc(null);this.Xyc=null;break;default:return null}}Q5l(){this.Shi.DNj(this.i$h())}}Object(u.a)(iG,"AugloopSearchProviderManager",null,[]);class xI{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(u.a)(xI,"DocumentContentSearchResults",null,[]);class VJ{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,
h,n,B,L){this.selectRange(h,n,B,L)}selectRangeV3(){}search(){}searchV2(b,h){this.search(b,n=>{h(Object.assign(new xI,{results:n,totalResultCount:n.length,hasTooManyResults:100<n.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,n=>{h(Object.assign(new xI,{results:n,totalResultCount:n.length,hasTooManyResults:n.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(u.a)(VJ,"BaseDocumentContentExecutor",null,[1492,240]);var WJ=d(2230),GM=d(1536);class nx{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(u.a)(nx,"DocumentContentSearchParams",null,[]);class XJ{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(u.a)(XJ,"DocumentSelection",null,[]);class HM{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(u.a)(HM,"IAuthorProperties",null,[]);var jC=d(733);class YJ{constructor(){this.M0c=this.Dqf=0}}Object(u.a)(YJ,"CommentFindResultIndexInfo",null,[]);const ZJ=b=>{b.Ic(re.SelectionEditor.Wj(b.gb.currentSelection,!0,!1))},IM=b=>{b=WJ.a.N8d(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class JM{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(u.a)(JM,"DocumentContentSearchResult",null,[]);var kO=d(1946);class KM{constructor(){this.authorEmail=this.authorName=this.BOb=this.Jqf=null}}Object(u.a)(KM,"CommentFindResults",null,[]);class yI{constructor(){this.end=this.Fc=0}}Object(u.a)(yI,"FindResultOffset",null,[]);class Ct{constructor(b,h,n,B,L,ba,la,La,fb,Cb){this.BMe=this.tw=this.PSe=this.zC=null;this.EIh=0;this.yO=null;this.WEc=new ob.a;this.gch=null;this.yt=b;this.jb=h;this.Skb=n;this.dja=
L;this.c7b=ba;this.xDb=la;this.ti=La;this.ga=fb;this.hb=Cb}avm(b,h){var n;const B=[];if(12!=b.type)return B;const L=Va.FormattingReader.mti(b);let ba=null,la=-1;var La=Nl.a.auto;for(let Cb=0;Cb<=L.length;Cb++){let Lb=-1;var fb=Nl.a.auto;Cb<L.length&&(fb=L[Cb],Lb=fb.cp,fb=null===(n=fb.formatting)||void 0===n?void 0:n.cache,fb=(null===fb||void 0===fb?0:fb.jRb)?fb.highlight:(null===fb||void 0===fb?0:fb.FWa)?fb.Qx:Nl.a.auto);if(La!=fb){if(La!=Nl.a.auto){ba||(ba=this.xDb.$Va(b.id));-1==Lb&&(Lb=ba.length);
La=this.Skb.cZd(ba,la,Lb,"");const $b={};$b.context=La.SXd;$b.startOffsetInContext=La.zve;$b.endOffsetInContext=La.xve-1;B.push({data:$b,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:la,endOffsetInParagraph:Lb-1})}la=Lb;La=fb}}return B}get Sea(){return this.gch}initialize(){this.zC=it.FindManager.createInstance(this,this.dja,Qu.a.instance,!1,!0)}search(b,h){this.zC.F6a();this.l0f(b)?(this.tw=h,this.yO=new ob.a,b=this.tuf(b),this.zC.find(b)):h(null)}searchV2(b,h){this.zC.F6a();if(this.l0f(b)){this.uZi()&&
this.ga.Pb(Pa.a.Txe,2,{CommandValueId:b});this.BMe=h;this.EIh=b.totalResultLimit;this.yO=new ob.a;b=this.tuf(b);this.gch=new gp.a;this.zC.find(b);h=this.dja.Yhd(b.text);h=this.dja.uXb(h);b=this.c7b.Ykc(h.join("|"),b);h=this.ti.xR();for(let B=0;B<h.length;B++){const L=h[B],ba=IM(L);var n=this.xDb.$Qb(ba,b);const la=this.xDb.$Qb(L.author,b);if(!n&&!la){x.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!ba,!b);continue}n=la&&0<la.length?la:n;let La="",fb="";la&&0<la.length&&
(La=L.author,fb=L.authorId);for(const Cb of n)n=kO.a.createInstance(Cb.Fc,Cb.end,S.a.Cf(L.objectId),B,32,!1),this.WEc.add(n),this.Sea.mb(B)||this.Sea.add(B,Object.assign(new KM,{Jqf:ba,BOb:[],authorName:La,authorEmail:fb}))}}else h(null)}get Loi(){null==this.PSe&&(this.PSe=it.FindManager.createInstance(this,this.dja,Qu.a.instance));return this.PSe}uZi(){var b;return null===(b=A.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",
!1)}voc(){var b;return null===(b=A.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}highlight(b){var h=this.l0f(b);b=h?this.tuf(b):null;var n={};this.uZi()&&this.ga.Pb(Dc.a.wpg,2,n);if(n[$g.a.On]){if(h){h={};n={};var B={};this.ga.Pb(Dc.a.Xre,2,h);this.ga.Pb(Pa.a.Wre,2,n);this.ga.Pb(Pa.a.Yre,2,B);if(b.text!=h.CommandValueId||b.matchCase!=n[$g.a.On]||b.matchWholeWord!=B[$g.a.On])ZJ(this.hb),this.ga.Pb(Pa.a.Hic,
2,{CommandValueId:b.text,MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else n=this.Loi,n.F6a(),h&&n.find(b)}selectNextPrevHighlight(b){const h=this.Loi;return 0<h.zk.doa?(b?h.uLi():h.zLi(),h.zk.oef-1):-1}tuf(b){let h=fy.a.none;b.matchCase&&(h|=fy.a.matchCase);b.matchWholeWordOnly&&(h|=fy.a.ZOg);return Yr.a.createQuery(b.query,h)}l0f(b){return b&&!!b.query&&0<b.query.length}Lye(){}hxe(){}reset(){}eEf(){}Fic(){if(this.tw){var b=this.j$h(this.yO);this.tw(b)}if(this.BMe){b=new xI;const h=this.yO.count+
this.WEc.count>this.EIh;b.totalResultCount=this.yO.count+this.WEc.count;b.hasTooManyResults=h;h||(this.yO.pD(this.yO.count,this.WEc),b.results=this.j$h(this.yO));this.BMe(b);this.WEc.clear()}}j$h(b){var h;const n=[];var B=Object.assign(new jC.a,{LR:!1,$fa:!0,nta:this.voc(),MR:!0});B=this.jb.JKa(this.yt.value,B);for(const la of b){var L=la.Fc;let La=la.end;var ba=void 0;b=-1;let fb=null,Cb=0;if(32===la.type){fb=Ct.Iqf;Cb=3;b=B.count+la.LWa;const Lb=({Fc:L,end:La}=gG.a.fCj(this.Sea.J(la.LWa).Jqf,L,
La)).returnValue;ba=this.Skb.cZd(Lb,L,La,iw.a(la.type));this.Sea.J(la.LWa).Jqf=Lb;this.Sea.J(la.LWa).BOb.push(Object.assign(new yI,{Fc:L,end:La}))}else{if(2===la.type||4===la.type)Cb=2===la.type?1:2,fb=Ct.ZSf;if(8===la.type||16===la.type)Cb=8===la.type?6:5,fb=Ct.Bcg;for(ba=0;ba<B.count;ba++)if(B.J(ba).id===la.nodeId){b=ba;break}ba=this.Skb.dZd(la)}L=(null===(h=this.Sea)||void 0===h?0:h.mb(la.LWa))?this.Sea.J(la.LWa):null;if(0<=b||(null===L||void 0===L?0:L.authorName))b=Object.assign(new JM,{snippet:ba.SXd,
subdocumentId:fb,subdocumentType:Cb,startOffsetInSnippet:ba.zve,endOffsetInSnippet:ba.xve-1,paragraphIndex:b,startOffsetInParagraph:la.Fc-ba.zve,endOffsetInParagraph:la.end-ba.xve-1,authorName:L?L.authorName:"",authorEmail:L?L.authorEmail:""}),n.push(b)}n.sort((la,La)=>la.paragraphIndex===La.paragraphIndex?la.startOffsetInParagraph-La.startOffsetInParagraph:la.paragraphIndex-La.paragraphIndex);return n}update(){}AVa(b,h){switch(b){case 0:h&&0<h.length&&!this.yO&&(x.ULS.sendTraceTag(570975814,313,
15,"Results container list is null"),this.yO=new ob.a);for(const n of h)this.yO.add(n)}}vyb(){}dispose(){}}Ct.Iqf="Comment";Ct.ZSf="HeaderFooter";Ct.Bcg="Note";Ct.HQi="Image";Object(u.a)(Ct,"WordDocumentSearchProcessor",null,[241,13,242]);class $J extends VJ{get sS(){return!this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",!1)}voc(){var b;return null===(b=A.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",
!1)}constructor(b,h,n,B,L,ba,la,La,fb,Cb,Lb,$b,tc,Nc){super();this.Ga=Cb;this.DHa=null;this.LN=(dd,Hd)=>{dd=Hd.node;Hd=Hd.property;this.oCg(dd)&&Hd===Hf.a.Un&&this.cRb(dd,3)};this.Hma=(dd,Hd)=>{dd=Hd.node;!Hd.aee&&this.oCg(dd)&&this.cRb(dd,1)};this.Mvb=(dd,Hd)=>{dd=Hd.node;this.oCg(dd)&&this.cRb(dd,2)};this.yt=b;this.jb=h;this.nd=n;this.hb=B;this.tG=L;this.im=La;this.Yb=fb;this.S$=ba;this.$D=la;this.ti=Lb;this.Nzk=$b;this.QCh=S.a.create();this.Xte(this.LN,this.Hma,this.Mvb);Nc&&Nc.execute(dd=>this.Ypa=
dd);tc.execute(dd=>{this.X4a=dd})}submitDocumentContentExtractionSignal(){this.X4a&&this.X4a.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.X4a?this.X4a.generateDocumentSummary():Promise.resolve(null)}generateDocumentSummaryDetails(){return this.X4a?this.X4a.generateDocumentSummaryDetails():Promise.resolve(null)}getAllParagraphsInDocument(){const b=this.uU(this.xEm());for(const n of this.ti.xR()){var h=WJ.a.N8d(n.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");
b.add(h)}return b.toArray()}extractDocumentObjects(b){var h=Object.assign(new jC.a,{LR:!1,$fa:!1,MR:!0}),n=this.jb.JKa(this.yt.value,h);h=[];const B=[];for(var L=0;L<n.count;++L){var ba=n.J(L);h.push(...this.Xvm(ba,L));B.push(...this.S$.avm(ba,L))}n=[];L=this.ti.xR();for(ba=0;ba<L.length;ba++)n.push(this.jmm(L[ba]));L={};L.images=h;L.comments=n;L.highlights=B;b(L)}selectRange(b,h,n,B,L){const ba=Date.now(),la={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};
try{this.B_a();if(0>b||0>h||0>n||0>B||b>n||b===n&&h>B)throw Error("Provided select range offsets incorrect");const Nc=Object.assign(new jC.a,{LR:!1,$fa:!0,nta:this.voc(),MR:!0}),dd=this.jb.JKa(this.yt.value,Nc);if(n>=dd.count){const Hd=Ya.a.instance.resolve("Common.Comments.ICommentModel").xR(),xe=n-dd.count;if(xe<Hd.length){L=-1;if(this.S$.Sea.mb(xe)){const he=this.S$.Sea.J(xe).BOb;for(var La=0;La<he.length;La++)if(he[La].Fc===h){L=La;break}}this.DHa=-1!==L?Object.assign(new YJ,{Dqf:xe,M0c:L}):null;
const je=Hd[xe];A.AFrameworkApplication.va.Ob(Dc.a.VW,2);A.AFrameworkApplication.va.Pb(Dc.a.Z6,2,null);A.AFrameworkApplication.va.Pb(Dc.a.selectComment,2,Object.assign(new GM.a,{commentId:je.id,Gca:2,sS:this.sS}))}}else{this.DHa=null;var fb=dd.J(b),Cb=dd.J(n);if(!this.Xge(fb,h)||!this.Xge(Cb,B))throw Error("Provided select range offsets incorrect");A.AFrameworkApplication.va.Ob(Dc.a.VW,2);this.Xkp(fb);var Lb=this.tG.se(fb,h);La=this.tG.$y(Lb,Nd.a.Tc(Cb,B+1));if(L){const Hd=La.toArray();h=[];for(const xe of Hd)h.push(this.z8d(xe.node));
h.join(" ").includes(L)||(la.success=!1,la.message="The text in clicked passage does not match the selected hit")}var $b=this.im.value.Vu,tc=this.hb.gb.currentSelection;tc&&tc.equals(La)&&this.nd.zha($b,null);this.nd.zha($b,La);la.duration=Date.now()-ba;this.logMessage(la)}}catch(Nc){la.success=!1,la.message=Nc.stack,la.duration=Date.now()-ba,this.logMessage(la)}}search(b,h){this.B_a();this.S$.search(Object.assign(new nx,{query:b}),h)}searchV2(b,h){this.B_a();this.S$.searchV2(Object.assign(new nx,
{query:b}),h)}selectNextPrevHighlight(b){this.B_a();return this.S$.selectNextPrevHighlight(b)}searchWithParam(b,h){this.B_a();this.S$.search(b,h)}searchWithParamV2(b,h){this.B_a();this.S$.searchV2(b,h)}highlight(b){this.B_a();this.S$.highlight(Object.assign(new nx,{query:b}))}highlightWithParam(b){this.B_a();this.S$.highlight(b)}getRevision(){return this.QCh.toString()}getSelectedText(){const b=this.Nzk.getSelectedText();return Object.assign(new Yu.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,
mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new jC.a,{LR:!1,$fa:!0,nta:this.voc(),MR:!0}),h=({jt:ba}=this.hKm(b)).returnValue;if(h)return h;var n=this.hb.gb.currentSelection;if(!n||!n.length)return null;h=n.Ra;n=n.Uc;let B=-1,L=-1;var ba=ba||this.jb.JKa(this.yt.value,b);b=null;for(let la=0;la<ba.count;la++){const La=ba.J(la);-1===B&&h.node.id===La.id&&(B=la,b=La);-1===L&&n.node.id===La.id&&(L=la)}ba=null;5===(null===b||void 0===b?void 0:b.esa)&&(ba=Ct.ZSf);if(1===(null===
b||void 0===b?void 0:b.esa)||2===(null===b||void 0===b?void 0:b.esa))ba=Ct.Bcg;return Object.assign(new XJ,{subdocumentId:ba,startParagraphIndex:B,startParagraphOffset:h.lk,endParagraphIndex:L,endParagraphOffset:n.Ep})}clearDocumentSelection(){ZJ(this.hb)}selectRangeV2(b,h,n,B,L,ba){const la=Date.now(),La={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.B_a();if(0>h||0>n||0>B||0>L||h>B||h===B&&n>L)throw Error("Provided select range offsets incorrect");
var fb=Object.assign(new jC.a,{LR:!1,$fa:!0,nta:this.voc(),MR:!0});const tc=this.jb.JKa(this.yt.value,fb);if(b==Ct.Iqf)this.BKj(n,B,tc.count);else{fb=this.DHa=null;var Cb={};Cb.subdocumentId=b;Cb.startParagraphIndex=h;Cb.startParagraphOffset=n;Cb.endParagraphIndex=B;Cb.endParagraphOffset=L;fb=b==Ct.HQi?this.lAi(tc.J(h),{isFloatingImage:!1,imageId:"",...Cb}):this.iJi(tc.J(h),tc.J(B),{clickedPassage:ba,...Cb},La);var Lb=this.im.value.Vu,$b=this.hb.gb.currentSelection;(null===$b||void 0===$b?0:$b.equals(fb))&&
this.nd.zha(Lb,null);this.nd.zha(Lb,fb)}La.duration=Date.now()-la;this.logMessage(La)}catch(tc){La.success=!1,La.message=tc.stack,La.duration=Date.now()-la,this.logMessage(La)}}selectRangeV3(b){const h=Date.now(),n={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.B_a();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&
b.startParagraphOffset>b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var B=Object.assign(new jC.a,{LR:!1,$fa:!0,nta:this.voc(),MR:!0});const la=this.jb.JKa(this.yt.value,B);if(b.subdocumentId==Ct.Iqf)this.BKj(b.startParagraphOffset,b.endParagraphIndex,la.count);else{B=this.DHa=null;B=b.subdocumentId==Ct.HQi?this.lAi(la.J(b.startParagraphIndex),b):this.iJi(la.J(b.startParagraphIndex),la.J(b.endParagraphIndex),b,n);var L=this.im.value.Vu,ba=this.hb.gb.currentSelection;
(null===ba||void 0===ba?0:ba.equals(B))&&this.nd.zha(L,null);this.nd.zha(L,B)}n.duration=Date.now()-h;this.logMessage(n)}catch(la){n.success=!1,n.message=la.stack,n.duration=Date.now()-h,this.logMessage(n)}}xEm(){const b=Date.now(),h={activityName:"GetParagraphNodes",success:!0,message:"",duration:0},n=Object.assign(new jC.a,{LR:!1,$fa:!1,MR:!0});h.duration=Date.now()-b;this.logMessage(h);return this.jb.JKa(this.yt.value,n)}uU(b){const h=Date.now(),n={activityName:"GetParagraphContent",success:!0,
message:"",duration:0},B=new ob.a;for(const L of b)B.add(this.z8d(L));n.duration=Date.now()-h;this.logMessage(n);return B}lAi(b,h){if(h.isFloatingImage)return h=S.a.Cf(h.imageId),b=b.Lc.Eb(h),b=Oe.SelectionFactory.lr(b);const n=this.tG.se(b,h.startParagraphOffset);return b=this.tG.$y(n,Nd.a.Tc(b,h.startParagraphOffset+1))}async getAuthorImageUrlFromClient(b,h){b=new Ir.a(b,"O365",h,b);if(!this.Ypa||!this.Ypa.getPersonaIconPropertiesArray)return null;b=await this.Ypa.getPersonaIconPropertiesArray([b]);
return 0<b.length&&b[0].authorImageURL?Object.assign(new HM,{authorImageURL:b[0].authorImageURL,authorColor:b[0].authorColor,authorID:b[0].authorID}):null}iJi(b,h,n,B){if(!this.Xge(b,n.startParagraphOffset)||!this.Xge(h,n.endParagraphOffset))throw Error("Provided select range offsets incorrect");n.subdocumentId==Ct.ZSf?A.AFrameworkApplication.va.Pb(Dc.a.kub,2,new bw.a(b)):A.AFrameworkApplication.va.Ob(Dc.a.VW,2);n.subdocumentId==Ct.Bcg?32===A.AFrameworkApplication.va.Pb(Dc.a.lcb,2,new bw.a(b))&&A.AFrameworkApplication.va.Ob(Dc.a.u4d,
2):A.AFrameworkApplication.va.Pb(Dc.a.Z6,2,null);b=this.tG.se(b,n.startParagraphOffset);h=this.tG.$y(b,Nd.a.Tc(h,n.endParagraphOffset+1));if(n.clickedPassage){b=h.toArray();const L=[];for(const ba of b)L.push(this.z8d(ba.node));L.join(" ").includes(n.clickedPassage)||(B.success=!1,B.message="The text in clicked passage does not match the selected hit")}return h}BKj(b,h,n){const B=Ya.a.instance.resolve("Common.Comments.ICommentModel").xR();h-=n;if(h<B.length){n=-1;if(this.S$.Sea.mb(h)){const L=this.S$.Sea.J(h).BOb;
for(let ba=0;ba<L.length;ba++)if(L[ba].Fc===b){n=ba;break}}this.DHa=-1!==n?Object.assign(new YJ,{Dqf:h,M0c:n}):null;b=B[h];A.AFrameworkApplication.va.Ob(Dc.a.VW,2);A.AFrameworkApplication.va.Pb(Dc.a.Z6,2,null);A.AFrameworkApplication.va.Pb(Dc.a.selectComment,2,Object.assign(new GM.a,{commentId:b.id,Gca:2,sS:this.sS}))}}B_a(){this.Yb&&(this.Yb.currentScope&&this.Yb.currentScope.name===Wh.MD||this.Yb.Bg(Wh.MD))}hzp(){this.QCh=S.a.create()}z8d(b){if(b.LSb)return"";b=this.jb.text(b);return Cn.AParagraphNode.iV(b,
" ")}Xge(b,h){b=this.z8d(b);return h<b.length}cRb(b,h){switch(h){case 1:case 2:case 3:this.hzp()}}logMessage(b){const h=[Object.assign(new ia.a,{name:"Message",string:b.message})];Object(Pe.a)(b.activityName,b.success,b.duration,h)}oCg(b){return!b.LSb&&this.i$c(b)}i$c(b){const h=this.yt.value;return!!h&&!!h.td&&!!b.Lc&&b.Lc.id.equals(h.td.id)}Xkp(b){this.jb.moc(b)?32===A.AFrameworkApplication.va.Pb(Dc.a.lcb,2,new bw.a(b))&&A.AFrameworkApplication.va.Ob(Dc.a.u4d,2):A.AFrameworkApplication.va.Pb(Dc.a.Z6,
2,null)}Xte(b,h,n){this.$D&&(this.$D.fo(b),this.$D.Zt(h),this.$D.Bw(n))}hKm(b){let h=null;var n=this.Yb?this.Yb.currentScope.name:"";if(this.sS?!this.ti.Pt||n!==Dd.AFrame.Us&&n!==Dd.AFrame.jP:!this.ti.Pt||!this.DHa)return{returnValue:null,jt:h};n=Array.indexOf(this.ti.xR(),this.ti.Pt);if(0>n)return{returnValue:null,jt:h};h=this.jb.JKa(this.yt.value,b);var B=WJ.a.N8d(this.ti.Pt.text[0]).split("\n");b=0;B=(1===B.length?B[0]:B.join(" ")).length-1;this.DHa&&n===this.DHa.Dqf&&this.S$.Sea.mb(n)&&this.S$.Sea.J(n).BOb.length>
this.DHa.M0c&&(b=this.S$.Sea.J(n).BOb[this.DHa.M0c].Fc,B=this.S$.Sea.J(n).BOb[this.DHa.M0c].end);return{returnValue:Object.assign(new XJ,{startParagraphIndex:h.count+n,startParagraphOffset:b,endParagraphIndex:h.count+n,endParagraphOffset:B,subdocumentId:"Comment"}),jt:h}}Xvm(b,h){const n=[];if(12!=b.type)return n;n.push(...this.wwm(b,h));n.push(...this.Wsm(b,h));return n}Wsm(b,h){const n=[],B=ve.GraphIterator.eb(b);if(!B.WA())return n;let L=B.Xd();for(;L;){if(!this.sXa(L)){L=B.Cu();continue}const ba=
L.properties;ba&&Ad.ImageReader.I9c(ba)&&n.push(this.x2j(ba,h,0,b.Lc,!0,L.id.toString()));L=B.Cu()}return n}sXa(b){if(19!==b.type||5!==Ad.ImageReader.Ek(b))return!1;b=ve.GraphIterator.eb(b);if(!b.WA())return!0;let h=b.Xd();for(;h;){if(59===h.type)return!1;h=b.Cu()}return!0}wwm(b,h){const n=[],B=b.Lc;if(B){if(!b.hasProperty(Hf.a.Vn))return n;var L=b.ja(Hf.a.Vn,null);if(!L)return n;b=b.ja(Hf.a.zn,null);for(let la=0;la<L.length;++la){var ba=L[la];if(!ba)continue;ba=B.Eb(ba);if(!ba||!Ad.ImageReader.I9c(ba)||
5!==Ad.ImageReader.Ek(ba))continue;let La=0;0!=la&&b&&la-1<b.length&&(La=b[la-1]);n.push(this.x2j(ba,h,La,B,!1,""))}return n}}x2j(b,h,n,B,L,ba){B=(new Sys.Net.WebRequest).getResolvedUrl()+Ad.ImageReader.WCm(b,B);const la=b.ja(zd.a.iu,""),La={};La.base64Encoding=la;La.url=B;La.width=Ad.ImageReader.tE(b);La.height=Ad.ImageReader.YJ(b);La.altText=Ad.ImageReader.O_(b);La.description=Ad.ImageReader.eWa(b);La.imageId=ba;La.isFloatingImage=L;return{data:La,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:n,
endOffsetInParagraph:n+1}}jmm(b){return{data:{comment:IM(b),authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},startParagraphIndex:-1,endParagraphIndex:-1,startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(u.a)($J,"WordDocumentContentExecutor",VJ,[]);class jG{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(u.a)(jG,"BaseDocumentHelper",null,[368]);class LM extends jG{constructor(b){super();this.fem=b}get nhc(){const b=this.fem.instance;
b&&b.loadDocumentProperty();return b}isEditingAllowed(){return Ua.StaticActiveAppFrame.za().ib.isEditingAllowed}author(){var b;return null===(b=this.nhc)||void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.nhc)||void 0===b?void 0:b.creationDate}}Object(u.a)(LM,"WordDocumentHelper",jG,[]);class KA{constructor(b){this.nbj=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.XVf(b.htmlText)}getId(){return"InsertContentExecutor"}XVf(b){return this.executeCommand(wb.a.Yqa,b)}executeCommand(b,
h){const n=new Og.DictionaryPropertySet;n.setValue(zd.a.mS,h);n.setValue(zd.a.zna,!1);h=this.nbj.Ob(b,1);32===h&&(h=this.nbj.Pb(b,2,n));return h}}Object(u.a)(KA,"WordInsertContentExecutor",null,[239,240]);var lO=d(1811),MM=d(1812);class aK{constructor(b,h,n,B,L){this.LFc="undefined";this.IBg="Something went wrong with retrieving a summary. Please try again.";this.Ncn=(ba,la,La,fb,Cb)=>lt.k0(ba,la,La,fb,this.YD,Cb);this.Jze=(ba,la,La,fb,Cb)=>{if(1===La)return this.RAk?32:8;ba=oq.getSelectedText();
ba=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,oq.b9d(ba));Cb[Dl.a.LabelText]=ba;return 32};this.BGf=(ba,la,La)=>{if(1===La)return 32;const fb={};this.X4a?this.X4a.generateDocumentSummary().then(Cb=>{Cb||(Cb=this.IBg,x.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));fb.additionalData=this.Ysf(Cb);this.ga.Pb(Pa.a.Uaa,2,fb)}).catch(()=>{x.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");
fb.additionalData=this.Ysf(this.IBg);this.ga.Pb(Pa.a.Uaa,2,fb)}):(x.ULS.sendTraceTag(509723397,1303,15,"Share with summary: Search provider manager is unavailable."),fb.additionalData=this.Ysf(this.IBg),this.ga.Pb(Pa.a.Uaa,2,fb));return 32};this.Pmp=(ba,la,La)=>{if(!this.bcj)return x.ULS.sendTraceTag(508929473,1303,15,"Cannot get a token for Transform to Slides action."),8;if(1===La)return this.Vsn()?32:2;if(2===La)this.bcj.a$d(this.Ga.kb("SmartLookupShredderServiceEndpoint")).then(fb=>{fb={token:fb,
files:D.c(this.Trm()),type:"MultiFilesDeckGeneration"};fb=Object.assign(new lO.a,{selection:Object.assign(new Yu.a,{neighborhood:"",mentionStart:0,mentionLength:0}),launchData:Object.assign(new xs.a,{landingTab:"All",data:fb}),entryPoint:38});this.ga.Pb(Pa.a.uba,2,fb);return 32}).catch(()=>{x.ULS.sendTraceTag(508929472,1303,15,"Error in getting a token for Transform to Slides action.");return 8});else return 32};this.YD=b;this.ga=h||A.AFrameworkApplication.va;this.Ga=n;this.yAk=(this.Zx=!!A.AFrameworkApplication.ua&&
A.AFrameworkApplication.ua.Ib.q0)&&!!this.Ga&&this.Ga.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");this.RAk=!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1);B&&B.execute(ba=>{this.X4a=ba});this.bcj=L}Wb(){this.ga.fb(Dc.a.TVh,id.a.frame,this.Ncn,1028);this.ga.fb(Dc.a.Jze,id.a.frame,this.Jze,1028);this.ga.fb(Dc.a.tsi,id.a.frame,this.BGf,1028);this.ga.fb(Dc.a.y2j,id.a.frame,this.Pmp,1028);this.yAk&&(this.LFc=Ua.StaticActiveAppFrame.za().cL.getWindowMode(),
this.Fki(this.LFc),Ua.StaticActiveAppFrame.za().cL.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.LFc&&(this.LFc=h,this.Fki(this.LFc))}))}Vsn(){return A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableTransformToSlidesInRibbon",!1)&&A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableContentTransformInL2",!1)}Fki(b){"DP"===b&&Wk.UISurfaces.Hv().then(h=>{h.selectors.getTabbedTaskPaneCount()||
this.ga.Pb(Dc.a.TVh,2,{SourceControlId:"smartlookupAuto"});return null})}Ysf(b){return{["documentSummary"]:b}}Trm(){const b=new MM.a("docx",A.AFrameworkApplication.K.kb("EditDocInClientUrl"),A.AFrameworkApplication.K.kb("BreadcrumbBrandUrl"),"",A.AFrameworkApplication.sessionStartInfoSettings.FileSizeBytes,(new Date).toLocaleString()),h=[];Array.add(h,b);return h}}Object(u.a)(aK,"WordInsightsActor",null,[]);class kC{constructor(){this.dzd=this.hT=null}s9a(){return this.RPb()}KAi(){return this.RPb()}IAi(){return null}Y6o(b,
h,n){this.hT||(this.hT=this.OYd());this.hT.tS(b,h,n)}Z6o(b,h,n){this.hT||(this.hT=this.OYd());this.hT.SDg(b,h,n)}p5o(b,h){this.dzd||(this.dzd=null);this.dzd&&this.dzd.SDg(b,h)}v_b(b,h){this.hT||(this.hT=this.OYd());this.hT.v_b(b,h)}Jhe(b){this.hT||(this.hT=this.OYd());this.hT.Jhe(b)}vOo(){this.hT&&this.hT.Fwc()}nTo(){this.hT&&this.hT.Gxe()}C4o(){var b=A.AFrameworkApplication.K.ic("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);b=window.performance.now()-kC.a6i<=b;b||(kC.a6i=window.performance.now());
return b}dispose(){this.hT&&(this.hT.dispose(),this.hT=null)}get nTb(){return this.hT?this.hT.isVisible:!1}}kC.a6i=0;Object(u.a)(kC,"InsightsManager",null,[1564,13]);class VD{constructor(b,h,n,B,L,ba=!0,la=null,La=null){this.D9=this.sG=this.SRa=null;this.gKc=!1;this.Iia=null;this.Yb=h;this.s8b=ba;this.zfh=La?La:new jG;this.tu=la;this.aq=b;this.s8b&&(Ya.a.instance.Oa("Common.App.SearchCommon.SearchHostRuntime")&&(this.Iia=Ya.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").HKf()),this.Tkb=
Ya.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.tJb=this.Tkb.E4c())}Ivb(b){if(this.s8b){b=b.rawEvent;try{var h=D.a(b.data)}catch(n){x.ULS.sendTraceTag(595161728,1303,15,this.dX("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=0;this.sG&&(b=this.sG.entryPoint);this.Tkb.hOf(this.D9,this.zfh,this.vlc(),b).then(n=>{h.data=n;this.Fwb(h)});break;case 118:h.data=this.sG?this.sG:Object.assign(new ws.a,{selection:Object.assign(new Yu.a,
{neighborhood:this.SRa.neighborhood,mentionStart:this.SRa.mentionStart,mentionLength:this.SRa.mentionLength})});this.Fwb(h);break;case 103:b=D.a(Object(ya.a)(String,h.data));Pl.sendTelemetryEvent(b);break;case 206:this.Tkb.a$d(h.data).then(n=>{h.data=n;this.Fwb(h)});break;case 112:h.data.shiftPressed?(X.a.uj&&document.activeElement.blur(),this.aq.T$d(0,null,2,null,null),x.ULS.sendTraceTag(592545156,1303,50,this.dX("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.aq.C5c(0,null,2,null,null),
x.ULS.sendTraceTag(592545155,1303,50,this.dX("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.fta()}}}Ymd(b){if(this.Iia){var h=0;this.sG&&(h=this.sG.entryPoint);this.Tkb.hOf(this.D9,this.zfh,this.vlc(),h).then(n=>{Pl.DLj("SearchFromHost",this.D9);this.sG.launchData||(this.sG.launchData=new xs.a);const B=il();try{this.Iia.search(this.sG,n,A.AFrameworkApplication.userSessionId,B,b),this.Tkb.bao(L=>{Pl.DLj("SearchFromHostWithToken",this.D9);this.Iia.searchAuthenticatedProviders(this.sG,
n,A.AFrameworkApplication.userSessionId,B,null,L)})}catch(L){Pl.jB("BaseSmartLookupPane - Fail to search from host. Error: "+L,10)}}).catch(n=>{Pl.jB("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+n.toString(),10)})}}Gwc(b){if(this.s8b){var h=Pl,n=h.Gwc,B=this.D9;b=Math.round(window.performance.now()-b);var L=this.sG?HA[this.sG.entryPoint]:"",ba=this.Tkb.E4c(),la=this.Tkb.Krm(),La=this.sG?this.sG.entryPoint:0;n.call(h,B,b,L,ba,la,A.AFrameworkApplication.Whf,this.gKc,
18===La||19===La||15===La)}}}Object(u.a)(VD,"BaseSmartLookupPane",null,[358,13]);class zI{constructor(b){this.messageType=null;this.messageType=b}}Object(u.a)(zI,"InsightsMessage",null,[]);class ox extends zI{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(u.a)(ox,"InsightsMessageWithContent",zI,[]);class NM extends ox{constructor(b){super(Wh.eMn,b)}}Object(u.a)(NM,"InsightsMessageAppProperties",ox,[]);class bK extends ox{constructor(b){super(Wh.pMn,b)}}Object(u.a)(bK,
"InsightsMessageSelection",ox,[]);class cK extends zI{constructor(){super(Wh.rMn)}}Object(u.a)(cK,"InsightsMessageTakeFocus",zI,[]);class WD extends VD{constructor(b,h,n,B,L=null,ba=null,la=null,La=!0,fb=null,Cb=null){super(h,n,L,ba,la,La,fb,Cb);this.fyd=this.HC=this.Nj=null;this.bJd=!1;this.iZn=Lb=>{Lb===this.Nj&&this.fta()};this.Fsc=()=>{x.ULS.sendTraceTag(6295951,1303,50,this.dX("The iframe is successfully loaded in Insights task pane"))};this.Hvb=()=>{x.ULS.sendTraceTag(6295952,1303,15,this.dX("The iframe failed to load in Insights task pane"))};
this.ZDd=b;this.OIc=this.s8b?BM(this.tJb):A.AFrameworkApplication.Man;this.H2();this.trg();this.Rp=B;this.leh=0}get isVisible(){return!1}H2(){this.Nj=this.ZDd.bYc();A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib.ztb&&this.Nj.Zuo(b=>{b===this.Nj&&(this.Gxe(),this.Fwc())});this.yVf(this.Nj.Y_a.FWh);this.Nj.wn()}yVf(b){b.style.overflow="hidden";const h=ng.a.createElement("iframe");Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.HC=h;b.appendChild(this.HC);
this.HC.id=Wh.YTf}trg(){Nb.a.addHandler(this.HC,"load",this.Fsc);Nb.a.addHandler(this.HC,"error",this.Hvb);$addHandler(window,"message",Object(z.a)(this,this.Ivb,"onIFrameMessage"))}rLg(){Nb.a.removeHandler(this.HC,"load",this.Fsc);Nb.a.removeHandler(this.HC,"error",this.Hvb);$removeHandler(window,"message",Object(z.a)(this,this.Ivb,"onIFrameMessage"))}dispose(){this.HC&&(this.rLg(),this.HC.parentNode.removeChild(this.HC),this.HC=null);this.Nj&&(this.ZDd.ghc(this.Nj),this.Nj=null)}tS(b,h,n){this.D9=
h;this.fyd=null;this.leh=n;this.gKc=!b.mentionLength;this.bJd=!1;x.ULS.sendTraceTag(6295947,1303,50,this.dX("Start to show Insights"));this.SRa=b;this.OIc&&this.OIc.length?this.HC.src=this.OIc:(this.HC.src=WD.mij,x.ULS.sendTraceTag(6295948,1303,15,this.dX("The Insights URL config setting is null or empty")));this.Rp.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.Nj.t0||this.Nj.Arg(this.iZn);this.s8b&&this.Ymd(!1);b=window.performance.now();this.ZDd.showTaskPane(this.Nj);this.Nj.wn();
this.Gwc(b)}SDg(b,h,n){this.sG=b;this.tS(Object.assign(new dG.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,n)}v_b(){}Jhe(){}Fwc(){this.HC.src===this.OIc&&this.bJd&&(this.Yb.Bg(Wh.MD),this.Fwb(new cK))}Gxe(){this.HC&&Ph.FocusManager.ZN(this.HC.contentWindow)}hwf(){this.HC.src=WD.mij;this.Nj.xn()}fta(){this.ZDd.hideTaskPane(this.Nj);this.hwf()}Ivb(b){const h=b.rawEvent;if(h.source===this.HC.contentWindow)if(this.s8b)super.Ivb(b);
else{let n;try{n=D.a(h.data)}catch(B){x.ULS.sendTraceTag(6295953,1303,15,this.dX("Message data [{0}] failed to deserialize.",h.data));return}if(Kf.c(n.messageType))x.ULS.sendTraceTag(6295954,1303,15,this.dX("Message data [{0}] is in wrong format.",h.data));else switch(n.messageType){case Wh.fMn:this.Fwb(new NM(this.Gwm()));break;case Wh.qMn:this.Fwb(new bK(this.SRa));break;case Wh.lMn:this.bJd=!0;this.Gxe();this.Fwc();x.ULS.sendTraceTag(6295955,1303,50,this.dX("Insights pane rendering is completed"));
break;case Wh.sMn:b=n.messageContent;this.fyd=b.clientCorrelationId;this.D9!==b.appCorrelationId&&x.ULS.sendTraceTag(6403778,1303,15,this.dX("App correlation ID on client {0} does not match one on server {1}",this.D9,b.appCorrelationId));break;case Wh.kMn:n.messageContent?(X.a.uj&&document.activeElement.blur(),this.aq.T$d(0,null,2,null,null),x.ULS.sendTraceTag(6604741,1303,50,this.dX("Insights UX lost focus through Ctrl + Shift + F6"))):(this.aq.C5c(0,null,2,null,null),x.ULS.sendTraceTag(6604742,
1303,50,this.dX("Insights UX lost focus through Ctrl + F6")));break;case Wh.hMn:n.messageContent.keyCode===Jd.a.Sfb&&this.fta();break;case Wh.iMn:try{this.bJd=!1,localStorage.setItem(Wh.X6i,"true")}catch(B){x.ULS.sendTraceTag(17961859,1303,10,this.dX("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}Gwm(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=this.D9;3===A.AFrameworkApplication.ua.Ib.Tk?b.applicationName=Wh.pJp:4===A.AFrameworkApplication.ua.Ib.Tk&&(b.applicationName=
Wh.H4n);b.applicationVersion=A.AFrameworkApplication.buildVersion;var h=hj.a.Cg(A.AFrameworkApplication.lcid);h=h?h.name:null;b.market=AM(h);b.uiLanguage=h;b.sessionId=A.AFrameworkApplication.userSessionId;b.parentalControl=Wh.Rjg;b.clientType="user";b.legalAgreed=this.Txm();b.defaultDefineTab=1===this.leh?"true":null;return b}dX(b,...h){const n={};this.D9&&(n[Wh.S_j]=this.D9);this.fyd&&(n[Wh.Xhp]=this.fyd);n[Wh.T_j]=String.format.apply(null,[b].concat(h));return D.c(n)}vlc(){return 5}Txm(){try{const b=
localStorage.getItem(Wh.X6i);return!!b&&"true"===b}catch(b){return x.ULS.sendTraceTag(17961860,1303,10,this.dX("Failed to GetItem in LocalStorage for LegalAgreed")),!1}}Fwb(b){b=D.c(b);this.HC.contentWindow.postMessage(b,za.a.getOrigin(this.OIc))}}WD.mij="about:blank";Object(u.a)(WD,"InsightsPane",VD,[]);class OM{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(u.a)(OM,"SmartLookupTaskPaneProps",null,[]);class PM{}Object(u.a)(PM,"ActionDescriptor",null,[]);class dK extends VD{constructor(b,
h,n,B=null,L=null,ba=null,la=!0,La=null,fb=null){super(h,n,B,L,ba,la,La,fb);this.oaf=!!A.AFrameworkApplication.ua&&!!A.AFrameworkApplication.ua.Ib&&A.AFrameworkApplication.ua.Ib.z1f;this.Wt=this.p6e=!1;this.FEk=A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.DEk=A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.IEk=A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",
1366);this.HEk=A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);this.Uoj=()=>{if(this.Iia)this.Iia.onPaneThemeChanged(this.vlc());return kh.a("getTheme")?appChrome.api.getTheme():null};this.Hvb=()=>{Pl.jB("ReactSmartLookupPane - Iframe component failed to load.",10)};this.Fsc=()=>{A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||Pl.jB("ReactSmartLookupPane - Onload detected no network.",
50)};la||Pl.jB("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.mHa=b;this.hmh=BM(this.tJb)}get isVisible(){return this.Wt}v_b(b,h){this.sG=b;this.SRa=b=Object.assign(new dG.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength});this.gKc=!b.mentionLength;this.D9=h;this.Ymd(!1)}Jhe(b){this.sG=b;this.hyc(Object.assign(new dG.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,
mentionLength:b.selection.mentionLength}),!1)}tS(b,h){this.D9=h;this.hyc(b,!0)}SDg(b,h,n){this.sG=b;this.tS(Object.assign(new dG.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,n)}fta(){this.sha();this.mHa.hideTaskPane()}hyc(b,h){hc.SessionStatusManager.instance.ZA&&this.Iia?(this.SRa=b,this.gKc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?A.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?
(this.mHa.updateTaskPane(null),h&&this.cPo()):(h&&this.Ymd(!1),this.p6e=!this.p6e,this.mHa.updateTaskPane(this.MB())):(h&&this.Ymd(this.isVisible),this.mHa.showTaskPane(this.MB())),this.Gwc(b)):(this.mHa.showTaskPane(this.MB()),Pl.xOo(hc.SessionStatusManager.instance.ZA,!!this.Iia,this.sG?HA[this.sG.entryPoint]:"",this.Tkb.E4c(),A.AFrameworkApplication.Whf,this.gKc))}cPo(){if(!this.sG){const b=Object.assign(new Yu.a,{neighborhood:this.SRa.neighborhood,mentionStart:this.SRa.mentionStart,mentionLength:this.SRa.mentionLength});
this.sG=Object.assign(new ws.a,{selection:b,userIntent:null,entryPoint:0,launchData:null})}this.Ymd(this.isVisible)}JOo(){const b=new PM;b.transactionId=this.D9;b.actionType=15;b.channelId=Wh.channelId;this.Fwb(b)}Ivb(b){const h=b.rawEvent;document.getElementById(Wh.MD)&&h.source!==document.getElementById(Wh.MD).contentWindow||this.Hno(b)}Hno(b){const h=b.rawEvent;let n;try{n=D.b(h.data)}catch(B){x.ULS.sendTraceTag(545604257,1303,15,this.dX("Message data from Serplet [{0}] failed to deserialize.",
h.data));return}switch(n.actionType){case 32:A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(Lh.a.srb()>=this.FEk?this.mHa.updateTaskPane(this.Kuf(this.DEk)):Lh.a.srb()>=this.IEk&&this.mHa.updateTaskPane(this.Kuf(this.HEk)));break;case 33:A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.mHa.updateTaskPane(this.Kuf(n.data));break;case 42:this.mHa.updateTaskPane(this.DKl(n.data));
break;case 43:this.mHa.updateTaskPane(this.MB());break;default:super.Ivb(b)}}dispose(){}initialize(){this.H2();this.Ina()}H2(){this.mHa.bYc()}Ina(){const b=this.Yb.ge(Wh.MD);b.parent=Dd.AFrame.mq;b.iK=!0}uTo(){this.Yb.Bg(Wh.MD)}sha(){this.Oab()&&this.Yb.Bg(this.Yb.RW)}trg(){$addHandler(window,"message",Object(z.a)(this,this.Ivb,"onIFrameMessage"))}rLg(){$removeHandler(window,"message",Object(z.a)(this,this.Ivb,"onIFrameMessage"))}Oab(){return!!this.Yb.currentScope&&this.Yb.currentScope.name===Wh.MD}Fwb(b){b=
D.c(b);document.getElementById(Wh.MD)&&document.getElementById(Wh.MD).contentWindow.postMessage(b,za.a.getOrigin(this.hmh))}dX(b,...h){const n={};this.D9&&(n[Wh.S_j]=this.D9);n[Wh.T_j]=String.format.apply(null,[b].concat(h));return D.c(n)}vlc(){return kh.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}Fwc(){}Gxe(){document.getElementById(Wh.MD)&&Ph.FocusManager.ZN(document.getElementById(Wh.MD).contentWindow)}sqm(){return this.sG?10===this.sG.entryPoint?2===A.AFrameworkApplication.ua.Ib.Tk?
CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.sG.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.sG.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.sG.entryPoint||38===this.sG.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}MB(){var b=CommonUIStrings.L_SmartLookupPaneTitle;A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&
(b=this.sqm());const h=new OM;h.src=this.hmh;h.id=Wh.MD;h.refreshPane=this.p6e;h.onError=this.Hvb;h.onLoad=this.Fsc;h.title=b;hc.SessionStatusManager.instance.ZA?this.Iia||(h.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,h.errorType=1):(h.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,h.errorType=0);b=Object.assign(new jp.a,{title:b,hideHeader:!1,width:Wh.width,location:Wh.m8n,contentProps:h,isModernPane:!0,onOpen:()=>{this.uTo();this.Wt=!0;this.trg();kh.a("registerOnThemeChangeCallback")&&
appChrome.api.registerOnThemeChangeCallback(this.Uoj);A.AFrameworkApplication.ua.Ie();if(this.Iia)this.Iia.onPaneStateChanged(!0)},onClose:()=>{this.JOo();this.sha();this.Wt=!1;this.rLg();kh.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(this.Uoj);A.AFrameworkApplication.ua.Ie();if(this.Iia)this.Iia.onPaneStateChanged(!1)}});this.oaf&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}DKl(b){const h=this.MB();h.title=b;h.contentProps.title=b;return h}Kuf(b){const h=
this.MB();h.resizeWidth=b;return h}}Object(u.a)(dK,"ReactSmartLookupPane",VD,[]);class QM{bYc(){const b=new Kl.a(sk.a.v6a,WordEditorIntl.WordEditorStrings);return Hq.a.instance.ybi(Wh.MD,Wh.xtc,Wh.width,Wh.PHg,b)}showTaskPane(b){Hq.a.instance.showTaskPane(b)}hideTaskPane(b){Hq.a.instance.hideTaskPane(b)}ghc(b){Hq.a.instance.ghc(Wh.MD,b)}}Object(u.a)(QM,"WordInsightsPaneHandler",null,[322]);class RM{bYc(){Hq.a.instance.NUa()}showTaskPane(b){Wk.UISurfaces.Hv().then(h=>{h.showTaskPane(Wh.MD,b);return null})}updateTaskPane(b=
null){Wk.UISurfaces.Hv().then(h=>{h.setSelectedTaskPane(Wh.MD);b&&h.updateTaskPane(Wh.MD,b);return null})}hideTaskPane(){Wk.UISurfaces.Hv().then(b=>{b.hideTaskPane(Wh.MD,2);return null})}}Object(u.a)(RM,"WordReactSmartLookupPaneHandler",null,[270]);class SM extends kC{constructor(b,h){super();this.Qy=b;this.hb=h}OYd(){const b=!!A.AFrameworkApplication.ua&&!!A.AFrameworkApplication.ua.Ib&&A.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return A.AFrameworkApplication.ua&&A.AFrameworkApplication.ua.Ib&&
A.AFrameworkApplication.ua.Ib.r0f?new dK(new RM,kc.a.instance,Ph.FocusManager.instance(),Ya.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Ya.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Ya.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Ya.a.instance.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ya.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new WD(new QM,kc.a.instance,Ph.FocusManager.instance(),
Ya.a.instance.resolve("Common.Utils.IAriaNotifier"),Ya.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Ya.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Ya.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Ya.a.instance.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ya.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}RPb(){return this.Qy.getSelectedText()}IAi(){if(!this.hb||!this.hb.gb||1>this.hb.gb.length)return null;
var b=this.hb.gb.currentSelection.Ra;b=null==b?null:Va.FormattingReader.Cs(b);return(b=null==b?null:hj.a.Cg(Va.FormattingReader.language(b)))?b.name:""}s9a(){return this.Qy.WNf()}KAi(){return this.Qy.WNf()}IZi(){return this.Qy.Bgn()}}Object(u.a)(SM,"WordInsightsManager",kC,[]);var MO=d(227);class lC{}Object(u.a)(lC,"CommandMetadataResponse",null,[]);class LA{constructor(){this.$Tf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){MO.PrivacyDialogManager.Hze()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=
new lC;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));if(!b.commandId||""===b.commandId)return h.isVisible=!1,h;try{h.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);h.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const n=appChrome.selectors.getControlIconSet(b.commandId),B=Array(2);B[0]=n["default"];B[1]=n.icon32;h.svgData=this.getCommandIconSvg(B)}catch(n){return null}return h}getCommandIconSvg(b){if(!this.$Tf)return"";
for(let h=0;h<b.length;h++){const n=b[h];if(n in this.$Tf)return this.$Tf[n]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const n={};n.featureArea=LA.j6l;h.telemetryGroup=n;h.appData=b;return h}}LA.POi="FA000000012";LA.queryPrefix="AssetID=";LA.j6l="SearchPane";Object(u.a)(LA,"BaseSerpletExecutor",null,[273,240]);
class c extends LA{constructor(b,h){super();this.ga=b;this.hb=h}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Pb(wb.a.qUb,2,null);break;case 1:this.ga.Pb(Dc.a.N0b,2,null);break;case 2:this.ga.Pb(wb.a.mZc,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Pb(Pa.a.$ce,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Pb(Pa.a.n_b,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Pb(Pa.a.$Df,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};ZJ(this.hb);this.ga.Pb(Pa.a.$Df,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Pb(Pa.a.Hic,2,h)}openNavigationPane(){this.ga.Pb(Dc.a.cyc,2,null)}openSerpletTaskPane(){this.ga.Pb(Pa.a.gVi,2,null)}sendAutoLaunchSearchRequest(){this.ga.Pb(Pa.a.Uce,2,null)}getAllIcons(){const b=
{};for(const n of Object.keys(window))if(n.startsWith("word")){var h=window[n];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(B=>b[B.id]=JSON.stringify(B)))}return b}}Object(u.a)(c,"WordSerpletExecutor",LA,[]);class k extends UJ{constructor(){super();this.D3e=null;this.pz=()=>{A.AFrameworkApplication.v3&&(this.mYl(),Es.a.Pl().then(()=>this.D3e.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){A.AFrameworkApplication.v3&&(this.D3e.Oa("WordEditor.Insights.WordInsightsActor").Wb(),
A.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&A.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?A.AFrameworkApplication.K.Rn(this.pz):super.init())}wc(b){super.wc(b);this.D3e=b;b.ia("Box4.Insights.Box4InsightsSelection",()=>new ca.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha();b.ia("WordEditor.Insights.WordInsertContentExecutor",()=>new KA(A.AFrameworkApplication.va)).as("Common.App.SearchCommon.IInsertContentExecutor").ha();
b.ia("WordEditor.Insights.WordSerpletExecutor",()=>new c(A.AFrameworkApplication.va,Zb.a.instance)).as("Common.App.SearchCommon.ISerpletExecutor").ha();b.ia("WordEditor.Insights.AugloopSearchProviderManager",()=>new iG(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").ha();b.ia("WordEditor.Insights.WordDocumentContentExecutor",()=>{const h=new Ct(new Rf.a(()=>Ua.StaticActiveAppFrame.za()?Ua.StaticActiveAppFrame.za().ib.$c:
null),b.resolve("Box4.IParagraphReader"),gG.a.instance,A.AFrameworkApplication.K,qH.a.instance,gO.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),A.AFrameworkApplication.va,Zb.a.instance,b.resolve("Box4.ISelectionFactory"));h.initialize();return new $J(new Rf.a(()=>Ua.StaticActiveAppFrame.za()?Ua.StaticActiveAppFrame.za().ib.$c:null),b.resolve("Box4.IParagraphReader"),Object(Pb.a)(),Zb.a.instance,b.resolve("Box4.ISelectionFactory"),h,$e.App.jf.Il.Ve(12),
new Rf.a(()=>Ua.StaticActiveAppFrame.za().ib),Ph.FocusManager.instance(),A.AFrameworkApplication.K,b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Qa("WordEditor.Insights.IAugloopSearchProviderManager"),b.Qa("Common.App.People.IExternalPeopleAPI"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").ha();b.ia("WordEditor.Insights.WordInsightsManager",()=>new SM(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").ha();
b.ia("WordEditor.Insights.WordInsightsActor",()=>new aK(b.rf("Common.App.Insights.IInsightsManager"),A.AFrameworkApplication.va,A.AFrameworkApplication.K,b.Qa("WordEditor.Insights.IAugloopSearchProviderManager"),b.resolve("Common.App.SearchCommon.ISearchHelper"))).ha();b.ia("Common.App.SearchCommon.IDocumentHelper",()=>new LM(b.Qa("WordEditor.Extension.DocumentProperties"))).ha()}}Object(u.a)(k,"WordInsightsPackage",UJ,[]);class r{}Object(u.a)(r,"ScalingStep",null,[]);class C{constructor(b,h,n){this.sJc=
!1;this.QS=null;this.GQc=this.d8b=!1;this.f5a=[];this.lve=B=>{this.Eda&&this.Eda!==B&&appChrome.api.dispatch(this.KGi(!1))};h.execute(B=>{this.QS=B});b.Cw(Object(z.a)(this,this.w2n,"onProcessSetSelectionFinished"));this.Rq=n}elc(b,h,n){const B=[];for(const L of b)B.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:L},n));return B}dFi(b){const h=[];for(let n=0;4>n;n++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>n?0:void 0));
h.push(appChrome.actions.addScalingStepInTab("Home",{type:"GalleryToFlyout",controlId:b},void 0));return h}KGi(b){const h=[];if(b)switch(this.Eda){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.dFi("PictureStyles"));h.push(...this.elc("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),"DropLabel"));b=this.f5a.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.elc(b,
"MoveToOverflow"));break;case "Table":this.GQc||h.push(...this.dFi("TableStyles"));h.push(...this.elc(this.f5a,"DropLabel",this.GQc?0:void 0));b=this.f5a.slice().reverse();h.push(...this.elc(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.elc(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.f5a.slice().reverse(),h.push(...this.elc(b,"MoveToOverflow"))}else for(const n of this.f5a)h.push(appChrome.actions.removeControlScalingStepsFromTab(n,"Home"));return h}ptd(b){const h={};for(const n of b)try{h[n]=
appChrome.selectors.getModelType(n)}catch(B){this.FI("Error","GetModelType failed for "+n)}Ua.StaticActiveAppFrame.za().I4d(h)}Btp(b){if(0!==b.length){var h=[],n={},B=!1;for(const L of b)try{if(appChrome.selectors.isControlDefined(L))n[L]=appChrome.selectors.getModelType(L);else{B=!0;break}}catch(ba){this.FI("Error","GetModelType failed for "+L);B=!0;break}if(B)this.Eda=void 0,this.UEe(!1);else{if("Image"===this.Eda&&!this.d8b)h.push(appChrome.actions.updateGroupHiddenState("Font",!0)),this.d8b=!0;
else if(this.d8b){h.push(appChrome.actions.updateGroupHiddenState("Font",!1));B=appChrome.selectors.getVisibleControlsInGroup("Font");for(const L of B)n[L]=appChrome.selectors.getModelType(L);this.d8b=!1}Ua.StaticActiveAppFrame.za().I4d(n);this.f5a=b;n=[];for(const L of b)appChrome.selectors.isControlDisabled(L)&&n.push(L);0<n.length&&this.FI("Disabled",n.join(","));0<this.f5a.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",
this.f5a)),h.push(...this.KGi(!0)),this.sJc=!0);appChrome.api.dispatch(h)}}}UEe(b){if(b||this.sJc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.sJc=b;if("Image"===this.Eda||this.d8b){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const n=appChrome.selectors.getVisibleControlsInGroup("Font");this.ptd(n)}this.d8b=!b}appChrome.api.dispatch(h)}}yAc(){this.sJc&&this.Rq&&this.Rq.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}w2n(b,
h){!A.AFrameworkApplication.ua.Ib.Pxc&&"Home"===appChrome.selectors.getSelectedTabId()&&this.QS&&h.Gm&&h.Gm.currentSelection&&0!==h.Gm.length?(b=()=>{let n=[],B=!1;var L=this.QS.contentType,ba=appChrome.selectors.getActiveContextualTabIds();L.includes("Image")?(this.lve("Image"),this.Eda&&"Image"===this.Eda?B=!0:(n="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),
this.Eda="Image")):L.includes("Table")&&0<=ba.indexOf("Table")?(L=!(dt.a.instance.currentSelection.eMa||dt.a.instance.currentSelection.Pw||dt.a.instance.currentSelection.Nab),(ba="Table"===this.Eda&&L!==this.GQc)?this.lve("TableCellEdit"):this.lve("Table"),!this.Eda||"Table"!==this.Eda||ba?(L?(n=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.GQc=!0):(n="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),
this.GQc=!1),this.Eda="Table"):B=!0):L.includes("Hyperlink")&&(this.lve("Hyperlink"),this.Eda&&"Hyperlink"===this.Eda?B=!0:(n=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.Eda="Hyperlink"));B?this.sJc||(this.ptd(this.f5a),this.UEe(!0),this.yAc()):0<n.length?(this.Btp(n),this.yAc()):this.UEe(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.UEe(!1)}FI(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};
h=new sg.a;h.name="Events";h.dataFields=Wc.a.fI(b);h.durationMs=window.performance.now();aa.a.jOa(h,"TellMeWAC.")}}Object(u.a)(C,"AdaptiveTabGroupUpdater",null,[]);class R{constructor(){this.W=null;this.BUn=()=>{A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ia("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new C(this.W.resolve("Box4.ISelectionManager"),this.W.Qa("Common.IActionContextProvider"),this.W.Qa("Common.ISystemInitiatedFeedback"))).ha(),
this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}wc(b){this.W=b}init(){Zw.a(1,this.BUn)}dispose(){}}Object(u.a)(R,"PackageManager",null,[0,1]);var da=d(762),va=d(1944),Ra=d(830),db=d(1941);const Kb=(b,h,n)=>1===n?32:2===n?(d.e(4).then(d.bind(null,2212)).then(B=>{B.createAndShowDevToolsMenu()}),32):2;class gc{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))A.AFrameworkApplication.va.ra(Dc.a.pDg,id.a.frame,Kb),null!==sessionStorage.getItem("devToolsRefresh")&&d.e(4).then(d.bind(null,2212))}dispose(){}wc(b){v(b)}static main(){M.a.instance.Jc(new gc)}}Object(u.a)(gc,"WordDevToolsPackage",null,[0,1]);d(628);class Ac{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(u.a)(Ac,"FormattingData",null,[]);class jd extends Ac{constructor(){super();this.hyperlinkData=null}}Object(u.a)(jd,"RichContentCommandData",
Ac,[]);class gd{constructor(){gd.Fj.add(Dc.a.Ueb);gd.Fj.add(Dc.a.l1b);gd.Fj.add(Dc.a.ezc);gd.Fj.add(Dc.a.EY);gd.Fj.add(Dc.a.ecg);gd.Fj.add(Dc.a.zmg);gd.Fj.add(Dc.a.deleteComment);gd.Fj.add(Dc.a.NYc);gd.Fj.add(Dc.a.Gwf);gd.Fj.add(Dc.a.Zze);gd.Fj.add(Dc.a.t0a);gd.Fj.add(Dc.a.pDg);gd.Fj.add(Dc.a.N0b);gd.Fj.add(Dc.a.xDg);gd.Fj.add(Dc.a.OZc);gd.Fj.add(Dc.a.F0d);gd.Fj.add(wb.a.mZc);gd.Fj.add(wb.a.YX);gd.Fj.add(wb.a.print);gd.Fj.add(wb.a.Kre);gd.Fj.add(wb.a.hpg);gd.Fj.add(wb.a.readingMode);gd.Fj.add(wb.a.qUb);
gd.Fj.add(Pa.a.n1j);gd.Fj.add(Pa.a.su);gd.Fj.add(Pa.a.Brd);gd.Fj.add(Pa.a.n_b);gd.Fj.add(Pa.a.vla);gd.Fj.add(Pa.a.Gpd);gd.Fj.add(Pa.a.hDg);gd.Fj.add(Pa.a.XOg);gd.Fj.add(Pa.a.Uaa);gd.Fj.add(Pa.a.IMa);gd.Fj.add(Pa.a.dqf);gd.Fj.add(Pa.a.gYa);gd.Fj.add(Pa.a.mug);gd.Fj.add(Pa.a.lug);gd.Fj.add(Pa.a.nug);gd.Fj.add(Pa.a.O_d);gd.Fj.add(Pa.a.mza);gd.Fj.add(Pa.a.mAe);gd.Fj.add(Pa.a.iUj);gd.Fj.add(Pa.a.close);gd.Fj.add(Pa.a.Ise);gd.Fj.add(Pa.a.Sre);gd.Fj.add(Pa.a.$oe);gd.Fj.add(Pa.a.hAe);gd.Fj.add(Pa.a.lAe);
gd.Fj.add(Pa.a.ZXb);gd.Fj.add(Pa.a.lva);gd.Fj.add(Pa.a.Zmc);gd.Fj.add(Pa.a.ZDg);gd.Fj.add(Pa.a.kyc);gd.Fj.add(Pa.a.lfa);gd.Fj.add(Pa.a.owc);gd.Fj.add(Pa.a.Mqe);gd.Fj.add(Pa.a.DYb);gd.Fj.add(Pa.a.xxj);gd.Fj.add(Pa.a.t4h);gd.Fj.add(Pa.a.AWd);gd.Fj.add(Pa.a.cqf);gd.Fj.add(Pa.a.v4h);gd.Fj.add(Pa.a.u4h);gd.Fj.add(Pa.a.dqf);gd.Fj.add(Pa.a.BWd);gd.Fj.add(Dc.a.tHe);gd.Fj.add(Dc.a.NPg);gd.Fj.add(Dc.a.s3b);gd.Fj.add(Dc.a.Hxg);gd.Fj.add(Dc.a.Rwb);gd.Fj.add(Dc.a.ate);gd.Fj.add(Dc.a.noa);gd.Fj.add(Pa.a.osb);gd.Fj.add(Pa.a.rob);
gd.Fj.add(Pa.a.nyc);gd.Fj.add(Pa.a.Uck);gd.Fj.add(Pa.a.Exj);gd.Fj.add(Dc.a.pjd);gd.Fj.add(wb.a.KXb);gd.Fj.add(wb.a.hca)}}gd.Fj=new Set;Object(u.a)(gd,"CommentRibbonCommands",null,[]);class Kd{constructor(b,h,n,B,L){this.zhj=b;this.Tg=h;this.Ip=n;this.Ui=B;this.rjp=L;this.P$b=null;this.KFa=new Lf.a(0);this.GBb=new Lf.a(0);this.$Le=new Lf.a(0);this.jcf=!1;this.k6m();this.Jvo()}yfn(b){return this.P$b&&this.Ip.hz?!gd.Fj.has(b):!1}Mlc(b,h,n){if(b===Pa.a.Vg)return 32;if(!this.KFa.mb(b)&&!this.GBb.mb(b)||
!this.P$b)return 2;const B=this.GBb.mb(b);var L=B?this.GBb.J(b):this.KFa.J(b);const ba=B?2:this.$Le.J(n);B||1!==ba||(this.ljn(Ua.StaticActiveAppFrame.za().sq.currentScope.name)||Ua.StaticActiveAppFrame.za().sq.Bg(this.Tg.kn?Dd.AFrame.Us:Dd.AFrame.jP),Ua.StaticActiveAppFrame.za().Ie(!0));n=new jd;switch(L){case 1:n.highlight={color:this.HFi(h.Color)};break;case 6:n.fontColor={color:this.HFi(h.Color)}}L=this.P$b.executeCommand(L,ba,n);2===L&&B&&(b===wb.a.Auc?h[$g.a.On]=!!n.bold:b===wb.a.Huc?h[$g.a.On]=
!!n.italic:b===wb.a.Uuc?h[$g.a.On]=!!n.underline:b===wb.a.Muc?h[$g.a.On]=!!n.strikethrough:b===wb.a.vY?h[$g.a.On]=!!n.highlight:b===wb.a.ax&&(h[$g.a.On]=!!n.fontColor));return 2===L?32:1===L?2:8}Jso(b){this.P$b=b;this.P$b.registerSelectionChangeHandler(()=>{this.jcf||(this.jcf=!0,Ua.StaticActiveAppFrame.za().Ie(!0),this.jcf=!1)});this.P$b.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case Jd.a.Q3b:case Jd.a.KCc:case Jd.a.nJe:case Jd.a.t1a:Ua.StaticActiveAppFrame.za().Ie(!0)}h.key!==Jd.a.PD&&
h.key!==Jd.a.Y4||Ua.StaticActiveAppFrame.za().Ie(!0)})}Jvo(){this.zhj.gBj(Dd.AFrame.Us,this);this.zhj.gBj(Dd.AFrame.jP,this)}k6m(){this.KFa.Z(wb.a.bold,0);this.KFa.Z(wb.a.kA,3);this.KFa.Z(wb.a.strikethrough,4);this.KFa.Z(wb.a.underline,5);this.KFa.Z(wb.a.vY,1);this.KFa.Z(wb.a.Kza,1);this.KFa.Z(wb.a.ax,6);this.KFa.Z(wb.a.$ja,6);this.KFa.Z(wb.a.Gva,6);this.GBb.Z(wb.a.Auc,0);this.GBb.Z(wb.a.Huc,3);this.GBb.Z(wb.a.Muc,4);this.GBb.Z(wb.a.Uuc,5);this.$Le.Z(1,0);this.$Le.Z(2,1)}ljn(b){return b===Dd.AFrame.Us||
b===Dd.AFrame.jP}HFi(b){return b?Nl.a.VC(this.rjp.sra(this.Ui.jd,b)):""}}Object(u.a)(Kd,"CommentRibbonCommandHandler",null,[200,201]);class se{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").bqg?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").o4("OnCommentRenderedOnce",()=>
{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}wc(b){this.W=b;this.W.ia("WordEditor.Comments.CommentRibbonCommandHandler",()=>new Kd(this.W.Oa("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),Eh.a.en.ib.sc,tp.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").ha();this.W.ia("WordEditor.Comments.CommentRibbonCommands",()=>new gd).ha()}static main(){M.a.instance.Jc(new se)}}Object(u.a)(se,
"PackageManager",null,[0,1]);var Xe=d(2081);class ff{constructor(b,h){this.rOl=2E3;this.kMh=null;this.Fjg=b.Krj;this.maxLength=A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.rOl);h&&h.execute(n=>{this.kMh=n})}THf(b){b=this.qkm(b,this.maxLength);return{semantic:Uh.ObjectSemantic.CanvasContext,type:Uh.ObjectSchemaType.WordCanvasContext,value:b}}qkm(b,h){try{return this.pkm(b,h)}catch(n){return x.ULS.sendTraceTag(522725067,1303,15,"Error processing selection for Canvas Context: {0}",
n),null}}nKm(b,h){const n={h8a:[],fDa:0,selection:{start:null,end:null},cursor:null,tiles:[]},B=b.length;for(let ba=0;ba<B;ba++){const la=b.J(ba);var L=la.node;if(!ea.ParagraphReader.Xb(L)||Array.contains(n.h8a,L.Uj))continue;n.h8a.push(L.Uj);const La=ea.ParagraphReader.textLength(L);if(n.fDa+La>h)break;L=this.Fjg.kMb(L);n.tiles.push(L);n.fDa+=La;1!==B||n.cursor||(n.cursor=ff.Dom(la,n.tiles.length-1));null===n.selection.start&&0===ba&&(n.selection.start=this.mJi(la,!0,n.tiles.length-1));null===n.selection.end&&
ba===B-1&&(n.selection.end=this.mJi(la,!1,n.tiles.length-1))}return n}OAm(b,h,n){const B={Srd:[],P0j:[],fDa:0};var L=b.J(0).node;let ba=b.J(b.length-1).node;for(b=h;0<b&&(L||ba);){var la=ff.ewj(L,!0,b,n);if(L=la.node)L=this.Fjg.kMb(L),B.Srd.push(L),b-=la.fDa,L=la.node,n=la.h8a;la=ff.ewj(ba,!1,b,n);if(ba=la.node)n=this.Fjg.kMb(ba),B.P0j.push(n),b-=la.fDa,ba=la.node,n=la.h8a}B.fDa=h-b;return B}rkm(b,h){let n=0;var B=this.nKm(b,h);const L={tiles:B.tiles,selection:B.selection,cursor:B.cursor};n+=B.fDa;
B=B.h8a;n<h&&(b=this.OAm(b,h-n,B),L.tiles.unshift.apply(L.tiles,b.Srd),L.tiles.push.apply(L.tiles,b.P0j),L.selection.start&&(L.selection.start.index+=b.Srd.length),L.selection.end&&(L.selection.end.index+=b.Srd.length),L.cursor&&(L.cursor.index+=b.Srd.length));return L}pkm(b,h){var n;if(!b)return null;b=this.rkm(b,h);return{contentType:null===(n=this.kMh)||void 0===n?void 0:n.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}mJi(b,h,n){if(b.contextId===oc.a.Bd||b.contextId===
oc.a.paragraph||b.contextId===oc.a.Xc){if(h&&-1!==b.lk)return{index:n,offset:b.lk};if(!h&&-1!==b.Ep)return{index:n,offset:b.Ep}}return null}static Dom(b,h){return b.contextId===oc.a.Xc?{index:h,offset:b.lk}:null}static ewj(b,h,n,B){B={node:null,fDa:0,h8a:B};if(!b||0>=n||!B.h8a)return B;do B.node=ea.ParagraphReader.zg(b,h,!1,!1),B.fDa=B.node?ea.ParagraphReader.textLength(B.node):0,b=B.node;while(B.node&&(Array.contains(B.h8a,B.node.Uj)||!ea.ParagraphReader.Xb(B.node)||!B.fDa));B.node&&(B.fDa>n?B.node=
null:B.h8a.push(B.node.Uj));return B}}Object(u.a)(ff,"Box4CanvasContextProvider",null,[199]);class nd{get name(){return"Box4.CanvasContext"}init(){}dispose(){}wc(b){b.ia("Box4.CanvasContext.Box4CanvasContextProvider",()=>new ff(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Qa("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").ha()}static main(){M.a.instance.Jc(new nd)}}Object(u.a)(nd,"Box4CanvasContextPackage",null,[0,1]);class be{constructor(b,h,
n,B){this.NK={};this.Ubc=this.TLd=0;this.$Zd=3E4;this.start=()=>{0!=this.AJb.size&&0===this.Ubc&&(this.Ubc=window.setInterval(this.TJo,this.$Zd),x.ULS.sendTraceTag(509215365,306,50,"Starting watchdog task"))};this.TJo=()=>{0!=this.AJb.size&&(this.tf.Ko?(x.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop()):(this.NK.ScanTime=Date.now(),this.NK.NumWatchDogs=this.AJb.size,this.NK.WatchDogManagerScanNumber=++this.TLd,this.AJb.forEach(async(L,ba)=>{this.NK[ba]=await L.sNn();"KickoutComponent"==
this.NK[ba].ComponentStatus&&this.Q2f(this.hrm(ba));L.eun()||x.ULS.sendTraceTag(520974674,306,20,JSON.stringify(this.NK))})))};this.tf=b;this.iqa=n;this.W1=B;this.ldf=new Map;this.AJb=new Map;h.execute(L=>{this.uk=L;this.uk.nIa((ba,la)=>{this.U_(la)})})}U_(b){2!==b.oldState&&3!==b.oldState||1!==b.newState&&0!==b.newState?2!==b.newState&&3!==b.newState||0===this.Ubc||(x.ULS.sendTraceTag(509215698,306,50,"WatchDogManager stopping for {0}",b.newState),this.stop()):(this.stop(),this.start(),this.eGo(),
x.ULS.sendTraceTag(509219479,306,50,"WatchDogManager returning from {0} to {1}",b.oldState,b.newState))}stop(){0!==this.Ubc&&(window.clearInterval(this.Ubc),this.Ubc=0);x.ULS.sendTraceTag(509215696,306,50,"Stopping watchdog task")}xZk(b,h){this.ldf.set(b,h)}IGo(){this.ieo(this.ldf)}get z4k(){return this.ldf.size===this.AJb.size}ieo(b){b.forEach((h,n)=>{h.execute(B=>{B?(this.AJb.set(n,B),this.start()):x.ULS.sendTraceTag(512550848,306,10,"WatchDog {0} resolved to null",n)})})}eGo(){this.AJb.forEach(b=>
{b&&b.bEa()});x.ULS.sendTraceTag(509138259,306,50,"WatchDogs reset")}Q2f(b){0<this.iqa.F0a&&this.W1.$Tb(b)}hrm(b){return"WordEditor.RunawayDataLossMonitorWatchDog"==b?yd.a.rJp:"WordEditor.LastSavedToHostDetailsManagerWatchDog"==b?yd.a.qJp:null}}Object(u.a)(be,"WatchDogManager",null,[198]);class rh{constructor(){this.W=this.zJb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.zJb=this.W.resolve(this.name);this.r8m()}dispose(){this.zJb&&this.zJb.stop()}wc(b){this.W=b;b.ia(this.name,
this.lLl.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").ha()}static main(){M.a.instance.Jc(new rh)}KDp(){if(!this.zJb.z4k){const b=[];let h=0;this.OLd.forEach((n,B)=>{n&&(this.W.Oa(B)||(b[h++]=B))});if(0<b.length){const n=!this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager").JU;x.ULS.sendTraceTag(508965916,306,10,"{0} did not resolve. HasDataLoss: {1}",b,n)}}}lLl(){return new be(this.W.resolve("Common.ISessionStatus")||hc.SessionStatusManager.instance,this.W.Qa("Common.App.VisibilityManagement.IVisibilityManager"),
this.W.resolve("Box4.Revision.RevisionSequenceNumberManager"),this.W.resolve("Wonca.KickoutExecutor"))}r_k(){window.setTimeout(this.KDp.bind(this),this.nFp)}y_k(){this.OLd=new Map;this.OLd.set("WordEditor.RunawayDataLossMonitorWatchDog",$e.App.pn||$e.App.Et);this.OLd.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",!0)}r8m(){this.y_k();this.x_k(this.OLd,this.zJb.xZk.bind(this.zJb));this.zJb.IGo();this.r_k()}x_k(b,h){b.forEach((n,B)=>{n&&h(B,this.W.Qa(B))})}get nFp(){return null!=this.c8g?this.c8g:
this.c8g=A.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.WatchdogResolveIntervalMs",3E5)}}Object(u.a)(rh,"WatchDogManagerPackage",null,[0,1]);class li{constructor(b){this.qNa=b;this.Upi=!1;this.Tpb=void 0}L_o(){this.Upi||(this.HFl(),this.gyl(),this.h1l(),this.Uco(),this.Upi=!0)}A6o(){Wk.UISurfaces.Vsm().then(b=>{b.renderFloatingHelp(this.Tpb.Fla,{["actionCallback"]:(h,n=2,B=null)=>{A.AFrameworkApplication.va.Pb(h,n,B)}});return null})}gyl(){this.Tpb.ugd.appendChild(this.Tpb.Fla)}h1l(){this.qNa.appendChild(this.Tpb.ugd)}HFl(){this.Tpb=
{ugd:this.g$h(li.v6n),Fla:this.g$h(li.$8m)}}g$h(b){const h=document.createElement("div");h.id=b;return h}Uco(){this.Tpb.ugd.style.position="fixed";this.Tpb.ugd.style.bottom="47px";this.Tpb.ugd.style.right="24px"}}li.v6n="FloatingHelpOuterContainer";li.$8m="FloatingHelpInnerHost";Object(u.a)(li,"FloatingHelpManager",null,[197]);class Gh{constructor(){this.container=void 0}get name(){return"WordEditor.FloatingHelp"}wc(b){this.container=b;const h=Eh.a.en.aG;this.container.ia("WordEditor.FloatingHelp.FloatingHelpManager",
()=>new li(h)).as("WordEditor.FloatingHelp.IFloatingHelpManager").ha()}init(){if(A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FloatingHelpExperiment",!1)&&void 0!==this.container){const b=this.container.resolve("WordEditor.FloatingHelp.IFloatingHelpManager");b.L_o();b.A6o()}}dispose(){}static main(){M.a.instance.Jc(new Gh)}}Object(u.a)(Gh,"FloatingHelpPackage",null,[0,1]);class Qf{constructor(b,h){this.id=b;this.altText=h}}Object(u.a)(Qf,"ParagraphBorderPropertiesItem",
null,[]);class Qj{constructor(b,h,n,B,L,ba){this.T4d=b;this.gallerySectionId=h;this.QCf=n;this.Qhf=B;this.commandId=L;this.queryCommandId=ba}}Object(u.a)(Qj,"ParagraphBorderPropertiesMenuPropsArgs",null,[]);class nk{constructor(b,h,n,B){this.size=b;this.space=h;this.style=n;this.color=B}}Object(u.a)(nk,"ParagraphBorderStyleProperties",null,[]);class xi{constructor(b,h,n,B,L,ba){this.s6a=b;this.Qqd=h;this.width=n;this.Ded=B;this.height=L;this.Hbd=ba}}Object(u.a)(xi,"ParagraphBorderPropertiesDefinition",
null,[]);class ne{constructor(){this.Udl=[new Qf(ne.Xyb,WordEditorIntl.WordEditorStrings.L_ParagraphBorderSolidLine),new Qf(ne.eNb,WordEditorIntl.WordEditorStrings.L_ParagraphBorderDashedLine),new Qf(ne.FNb,WordEditorIntl.WordEditorStrings.L_ParagraphBorderDottedLine),new Qf(ne.HNb,WordEditorIntl.WordEditorStrings.L_ParagraphBorderDoubleLine)];this.eel=[new Qf(ne.NKb,"0.25 pt"),new Qf(ne.MKb,"0.5 pt"),new Qf(ne.QKb,"0.75 pt"),new Qf(ne.Nmb,"1 pt"),new Qf(ne.LKb,"1.5 pt"),new Qf(ne.RKb,"2.25 pt"),
new Qf(ne.PKb,"3 pt"),new Qf(ne.KKb,"4.5 pt"),new Qf(ne.OKb,"6 pt")];this.Qdl=[new Qf(ne.Hlf,"0 pt"),new Qf(ne.Blf,"1 pt"),new Qf(ne.Glf,"2 pt"),new Qf(ne.Flf,"3 pt"),new Qf(ne.YTd,"4 pt"),new Qf(ne.ylf,"5 pt"),new Qf(ne.Dlf,"6 pt"),new Qf(ne.Clf,"7 pt"),new Qf(ne.xlf,"8 pt"),new Qf(ne.Alf,"9 pt"),new Qf(ne.Elf,"10 pt")]}initialize(){this.j6m();this.lkd()}j6m(){this.WTd=[new xi(ne.Xyb,"","2",1,8,0),new xi(ne.eNb,"5,3","1",1,8,0),new xi(ne.FNb,"1,1","1",1,8,0),new xi(ne.HNb,"","1",2,8,3)];this.XTd=
[new xi(ne.NKb,"","0.25",1,8,0),new xi(ne.MKb,"","0.5",1,8,0),new xi(ne.QKb,"","0.75",1,8,0),new xi(ne.Nmb,"","1",1,8,0),new xi(ne.LKb,"","1.5",1,8,0),new xi(ne.RKb,"","2.25",1,8,0),new xi(ne.PKb,"","3",1,8,0),new xi(ne.KKb,"","4.5",1,8,0),new xi(ne.OKb,"","6",1,8,0)]}lkd(){const b={};for(const h of this.WTd)b[h.s6a]=appChrome.buildBorderStyleIcon(h.Qqd,h.width,h.Ded,h.height,h.Hbd);for(const h of this.XTd)b[h.s6a]=appChrome.buildBorderStyleIcon(h.Qqd,h.width,h.Ded,h.height,h.Hbd);appChrome.api.registerIconProvider(()=>
b)}R2c(){return new nk(ne.Fgc,ne.udi,ne.Egc,ne.DYc)}wui(b){var h=this.xui(b);if(0!==h.length){for(const B of h)if(n){if(h=this.vui(b,B),!this.kUh(n,h))return}else var n=this.vui(b,B);return n}}vui(b,h){const n=this.R2c();switch(h){case 0:return{size:ea.ParagraphReader.Bj(b,ye.a.eV,n.size),space:ea.ParagraphReader.Bj(b,ye.a.oNa,n.space),style:ea.ParagraphReader.Bj(b,ye.a.uwb,n.style),color:ea.ParagraphReader.Bj(b,ye.a.twb,n.color)};case 1:return{size:ea.ParagraphReader.Bj(b,ye.a.I0,n.size),space:ea.ParagraphReader.Bj(b,
ye.a.nNa,n.space),style:ea.ParagraphReader.Bj(b,ye.a.nwb,n.style),color:ea.ParagraphReader.Bj(b,ye.a.mwb,n.color)};case 2:return{size:ea.ParagraphReader.Bj(b,ye.a.w8,n.size),space:ea.ParagraphReader.Bj(b,ye.a.kZa,n.space),style:ea.ParagraphReader.Bj(b,ye.a.qwb,n.style),color:ea.ParagraphReader.Bj(b,ye.a.pwb,n.color)};case 3:return{size:ea.ParagraphReader.Bj(b,ye.a.lca,n.size),space:ea.ParagraphReader.Bj(b,ye.a.Acb,n.space),style:ea.ParagraphReader.Bj(b,ye.a.pXb,n.style),color:ea.ParagraphReader.Bj(b,
ye.a.zcb,n.color)};case 4:return{size:ea.ParagraphReader.Bj(b,ye.a.dY,n.size),space:ea.ParagraphReader.Bj(b,ye.a.mNa,n.space),style:ea.ParagraphReader.Bj(b,ye.a.mXb,n.style),color:ea.ParagraphReader.Bj(b,ye.a.lXb,n.color)}}return n}Fjm(b){switch(b){case ne.NKb:return ne.hUc;case ne.MKb:return ne.UWh;case ne.QKb:return ne.q6a;case ne.Nmb:return ne.fra;case ne.LKb:return ne.maa;case ne.RKb:return ne.Qja;case ne.PKb:return ne.I6;case ne.KKb:return ne.Bza;case ne.OKb:return ne.Pja;default:return ne.Fgc}}Cjm(b){switch(b){case ne.Xyb:return"single";
case ne.eNb:return"dashed";case ne.FNb:return"dotted";case ne.HNb:return"double";default:return ne.Egc}}zjm(b){switch(b){case ne.Hlf:return ne.eXh;case ne.Blf:return ne.ZWh;case ne.Glf:return ne.dXh;case ne.Flf:return ne.cXh;case ne.YTd:return ne.zlf;case ne.ylf:return ne.XWh;case ne.Dlf:return ne.aXh;case ne.Clf:return ne.$Wh;case ne.xlf:return ne.WWh;case ne.Alf:return ne.YWh;case ne.Elf:return ne.bXh;default:return ne.udi}}Gjm(b){switch(b){case ne.hUc:return ne.NKb;case ne.UWh:return ne.MKb;case ne.q6a:return ne.QKb;
case ne.fra:return ne.Nmb;case ne.maa:return ne.LKb;case ne.Qja:return ne.RKb;case ne.I6:return ne.PKb;case ne.Bza:return ne.KKb;case ne.Pja:return ne.OKb;default:return ne.Nmb}}Djm(b){switch(b){case "single":return ne.Xyb;case "dashed":return ne.eNb;case "dotted":return ne.FNb;case "double":return ne.HNb;default:return ne.Xyb}}Ajm(b){switch(b){case ne.eXh:return ne.Hlf;case ne.ZWh:return ne.Blf;case ne.dXh:return ne.Glf;case ne.cXh:return ne.Flf;case ne.zlf:return ne.YTd;case ne.XWh:return ne.ylf;
case ne.aXh:return ne.Dlf;case ne.$Wh:return ne.Clf;case ne.WWh:return ne.xlf;case ne.YWh:return ne.Alf;case ne.bXh:return ne.Elf;default:return ne.YTd}}xui(b){const h=[];void 0!==ea.ParagraphReader.Bj(b,ye.a.eV,void 0)&&h.push(0);void 0!==ea.ParagraphReader.Bj(b,ye.a.I0,void 0)&&h.push(1);void 0!==ea.ParagraphReader.Bj(b,ye.a.w8,void 0)&&h.push(2);void 0!==ea.ParagraphReader.Bj(b,ye.a.lca,void 0)&&h.push(3);void 0!==ea.ParagraphReader.Bj(b,ye.a.dY,void 0)&&h.push(4);return h}tGf(){const b=new Qj("ParagraphBorderLineStyleOptionsGallery",
"DefaultBorderStyleOptions","ParagraphBorderLineStyleOptionsGallery",this.Udl,Dc.a.pxc,Dc.a.yse);return this.pjc(b,ne.Vdl,ne.Wdl)}uGf(){const b=new Qj("ParagraphBorderLineWeightOptionsGallery","DefaultBorderWeightOptions","ParagraphBorderLineWeightOptionsGallery",this.eel,Dc.a.qxc,Dc.a.zse);return this.pjc(b,ne.fel,ne.gel)}Pem(){const b=new Qj("ParagraphBorderLinePaddingOptionsGallery","DefaultBorderPaddingOptions","ParagraphBorderLinePaddingOptionsGallery",this.Qdl,Dc.a.Q_b,Dc.a.xse);return this.pjc(b,
"0px","0px")}pjc(b,h="20px",n="50px"){const B=new vh.a,L=new te.a,ba=Object.assign(new fl.a,{Id:b.T4d,ExternalId:b.gallerySectionId,ExternalGalleryId:b.QCf,Type:4,Width:10,GalleryItems:[]});for(const La of b.Qhf){var la={};const fb={};fb.width=n;fb.height=h;fb.marginRight="auto";la.root=fb;la=Object.assign(new Lq.a,{Id:String.format("{0}_Button",La.id),ExternalId:String.format("{0}_ExternalID",La.id),Icon:La.id,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:La.id,
P0p:fb,FullIconStyle:la,ShouldSetTitle:"true",Alt:La.altText,LabelText:La.altText});ba.GalleryItems.push(la)}L.ControlList=[];B.MenuSectionList=[];L.ControlList.push(ba);B.MenuSectionList.push(L);B.UpdateDynamically=!0;return B}kUh(b,h){return!b&&!h||b&&h&&b.color===h.color&&b.size===h.size&&b.style===h.style&&b.space===h.space}}var gj=ne;ne.Xyb="SolidLineStyle";ne.eNb="DashedLineStyle";ne.FNb="DottedLineStyle";ne.HNb="DoubleLineStyle";ne.hUc=2;ne.NKb="BorderPointSizeOneQuarter";ne.UWh=4;ne.MKb="BorderPointSizeOneHalf";
ne.q6a=6;ne.QKb="BorderPointSizeThreeQuarters";ne.fra=8;ne.Nmb="BorderPointSizeOne";ne.maa=12;ne.LKb="BorderPointSizeOneAndHalf";ne.Qja=18;ne.RKb="BorderPointSizeTwoAndQuarter";ne.I6=24;ne.PKb="BorderPointSizeThree";ne.Bza=36;ne.KKb="BorderPointSizeFourAndHalf";ne.Pja=48;ne.OKb="BorderPointSizeSix";ne.eXh=0;ne.Hlf="BorderSpaceZero";ne.ZWh=1;ne.Blf="BorderSpaceOne";ne.dXh=2;ne.Glf="BorderSpaceTwo";ne.cXh=3;ne.Flf="BorderSpaceThree";ne.zlf=4;ne.YTd="BorderSpaceFour";ne.XWh=5;ne.ylf="BorderSpaceFive";
ne.aXh=6;ne.Dlf="BorderSpaceSix";ne.$Wh=7;ne.Clf="BorderSpaceSeven";ne.WWh=8;ne.xlf="BorderSpaceEight";ne.YWh=9;ne.Alf="BorderSpaceNine";ne.bXh=10;ne.Elf="BorderSpaceTen";ne.Egc="single";ne.Fgc=ne.fra;ne.DYc=0;ne.udi=gj.zlf;ne.Wdl="50px";ne.Vdl="20px";ne.gel="60px";ne.fel="20px";Object(u.a)(ne,"ParagraphBorderManager",null,[151]);class Li{constructor(){this.Fue={size:0,space:0,color:0,style:"none"}}eyb(b,h,n){for(const B of h)this.gRo(b,B,n)}gRo(b,h,n){switch(h){case 0:b.properties.setValue(ye.a.oNa,
n.space);b.properties.setValue(ye.a.eV,n.size);b.properties.setValue(ye.a.twb,n.color);b.properties.setValue(ye.a.uwb,n.style);break;case 1:b.properties.setValue(ye.a.nNa,n.space);b.properties.setValue(ye.a.I0,n.size);b.properties.setValue(ye.a.mwb,n.color);b.properties.setValue(ye.a.nwb,n.style);break;case 2:b.properties.setValue(ye.a.kZa,n.space);b.properties.setValue(ye.a.w8,n.size);b.properties.setValue(ye.a.pwb,n.color);b.properties.setValue(ye.a.qwb,n.style);break;case 3:b.properties.setValue(ye.a.Acb,
n.space);b.properties.setValue(ye.a.lca,n.size);b.properties.setValue(ye.a.zcb,n.color);b.properties.setValue(ye.a.pXb,n.style);break;case 4:b.properties.setValue(ye.a.mNa,n.space),b.properties.setValue(ye.a.dY,n.size),b.properties.setValue(ye.a.lXb,n.color),b.properties.setValue(ye.a.mXb,n.style)}}Xql(b){var h=[0,1,2,3,4];for(const n of h)this.Yql(b,n)}Yql(b,h){switch(h){case 0:this.Ekd(b,Li.wlp);break;case 1:this.Ekd(b,Li.hel);break;case 2:this.Ekd(b,Li.kyn);break;case 3:this.Ekd(b,Li.JIo);break;
case 4:this.Ekd(b,Li.pcl)}}Ekd(b,h){const [n,B,L,ba]=h;h=ea.ParagraphReader.Vb.Eq(b);h.hasProperty(n)?b.properties.setValue(n,this.Fue.space):b.properties.hasProperty(n)&&b.properties.removeProperty(n);h.hasProperty(B)?b.properties.setValue(B,this.Fue.size):b.properties.hasProperty(B)&&b.properties.removeProperty(B);h.hasProperty(L)?b.properties.setValue(L,this.Fue.color):b.properties.hasProperty(L)&&b.properties.removeProperty(L);h.hasProperty(ba)?b.properties.setValue(ba,this.Fue.style):b.properties.hasProperty(ba)&&
b.properties.removeProperty(ba)}}Li.wlp=[ye.a.oNa,ye.a.eV,ye.a.twb,ye.a.uwb];Li.hel=[ye.a.nNa,ye.a.I0,ye.a.mwb,ye.a.nwb];Li.kyn=[ye.a.kZa,ye.a.w8,ye.a.pwb,ye.a.qwb];Li.JIo=[ye.a.Acb,ye.a.lca,ye.a.zcb,ye.a.pXb];Li.pcl=[ye.a.mNa,ye.a.dY,ye.a.lXb,ye.a.mXb];Object(u.a)(Li,"ParagraphBorderEditor",null,[150]);class Ij{get name(){return"WordEditor.ParagraphEditor"}wc(b){this.container=b;A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1)&&(this.container.ia("WordEditor.ParagraphEditors.IParagraphBorderEditor",
()=>new Li).ha(),this.container.ia("WordEditor.ParagraphEditors.IParagraphBorderManager",()=>new ne).ha())}init(){this.container.resolve("WordEditor.ParagraphEditors.IParagraphBorderManager").initialize()}dispose(){}static main(){A.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1)&&M.a.instance.Jc(new Ij)}}Object(u.a)(Ij,"WordEditorParagraphEditorsPackage",null,[0,1]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");
Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");
Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");
Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");
Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");
Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");
Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");
Type.registerNamespace("WordEditor.TableStyle");Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");U.main();Type.registerNamespace("Common.App.WopiIdentity");na.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");
nc.main();Object(Xe.a)(!1);qD.main();pD.main();pb.main();vb.main();Ia.main();gc.main();Gh.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");me.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");Ae.main();Type.registerNamespace("Common.App.WildFire");ic.main();Type.registerNamespace("Common.App.BrowserInfoLogger");
ie.main();Type.registerNamespace("Common.App.HostNotification");bj.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");Ih.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");Type.registerNamespace("Common.App.LivePersonaUtils");Xh.main();Type.registerNamespace("CNT");ak.main();Type.registerNamespace("Common.App.NewAndOpen.Core");M.a.instance.Jc(new wg);Type.registerNamespace("Common.App.NewAndOpen.UX");
M.a.instance.Jc(new Sg);Type.registerNamespace("Common.App.OneDriveFilePickerApi");nm.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");wc.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");kl.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");wi.main();
Type.registerNamespace("CADWLTR");Bk.main();Type.registerNamespace("Common.App.DirectPrint");M.a.instance.Jc(new vf);Type.registerNamespace("Common.App.SearchOAuthManager");Qk.main();mc.main();Me.main();Eg.main();Hj.main();mf.main();M.a.instance.Jc(new $f);ih.main();bi.main();zm.main();M.a.instance.Jc(new Pm);Type.registerNamespace("Common.App.SaveStatus");M.a.instance.Jc(new To);Type.registerNamespace("Common.App.EventsCacheManager");go.main();Type.registerNamespace("CUIB");fn.main();Type.registerNamespace("CommandUI.TaskPane");
try{M.a.instance.Jc(new zu(Ua.StaticActiveAppFrame.za().ib))}catch(b){x.ULS.shipAssertTag(575930383,3016,!1,b.message)}bq.main();Type.registerNamespace("Common.App.Insights");uo;M.a.instance.Jc(new ra);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");Eb("Begin");M.a.instance.Jc(new Cv);
try{M.a.instance.Jc(new Gv(ml.a.get_instance(),Ua.StaticActiveAppFrame.za().ib,Ua.StaticActiveAppFrame.za().Ib))}catch(b){x.ULS.shipAssertTag(575930384,3016,!1,b.message)}qc.main();M.a.instance.Jc(new le);Gt.main();Eu.main();hm.main();Pr.main();sz.main();xy.main();qn.main();Lz.main();M.a.instance.Jc(new SG);FC.main();GC.main();HC.main();Oz.main();nd.main();se.main();M.a.instance.Jc(new jB);M.a.instance.Jc(new cw);mB.main();Qz.main();iv.main();Ij.main();M.a.instance.Jc(new rB);M.a.instance.Jc(new YE);
ZE;Zx.main();Al.main();pv.main();kq.main();yo;M.a.instance.Jc(new Br);M.a.instance.Jc(new Zr);tF.main();$d.main();Yw.main();M.a.instance.Jc(new lD);M.a.instance.Jc(new OB);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=sv;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");SB.main();tK.main();iz.main();hJ;fL.main();HO;window.MSOJS=XB;PJ.main();rI.main();M.a.instance.Jc(new k);
M.a.instance.Jc(new R);(async()=>{A.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&await d.e(30).then(d.bind(null,2223)).then(b=>{b.initializeOnDemandPackage()})})();rh.main();af.main()},2230:function(G,J,d){G=d(0);var m=d(7),f=d(1690);class a{static get cKn(){return 50}static N8d(w){if(""===w)return"";let y=0,v="";try{const u=f.a.Iqb(w);for(const x of u.ops)if(a.wI(x))y||(v+=a.xsm(x.attributes.atmention.fullName)),y+=1;else{const z=x.insert?x.insert:"";" "!==z&&0<z.length&&(y=0,v+=z)}}catch(u){m.ULS.sendTraceTag(558428681,
327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return v}static smm(w){w=a.N8d(w);return 0<w.length&&w.split(" ").length<=a.cKn?w:null}static xsm(w){let y="";w&&(w=w.split(" "),0<w.length&&(y=w[0]));return y}static wI(w){return!!w.attributes&&!!w.attributes.atmention}}Object(G.a)(a,"BaseCommentSmartReplyHelpers",null,[]);d.d(J,"a",function(){return l});class l extends a{constructor(){super()}static uPb(w,y,v=!1){if(!w)return null;w=w.text&&0<w.text.length?
w.text[0]:"";y=!y||!y.Mf||""===y.Mf;return 0<w.length&&y&&!v?a.smm(w):null}}Object(G.a)(l,"CommentSmartReplyHelpers",a,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/22137596/wdjs/WordEditorDS.box4.dll1.js.map