'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1561:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);var m=d(1669);class f{constructor(){this.Gr=null;this.gr=!1}Wq(){this.gr||(this.gr=!0,this.Gr=m.a.instance.OHm(),m.a.instance.Wq(this.Gr,this))}skj(){this.zkd();this.gr=!1}zkd(){}}Object(G.a)(f,"Base",null,[])},1583:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.XIc=this.WIc=this.tLc=this.sLc=this.uLc=this.u$=this.v$=
!1}get ignorePunct(){return this.WIc}set ignorePunct(f){this.WIc=f}get ignoreSpace(){return this.XIc}set ignoreSpace(f){this.XIc=f}get matchCase(){return this.u$}set matchCase(f){this.u$=f}get matchPrefix(){return this.sLc}set matchPrefix(f){this.sLc=f}get matchSuffix(){return this.tLc}set matchSuffix(f){this.tLc=f}get matchWholeWord(){return this.v$}set matchWholeWord(f){this.v$=f}get matchWildcards(){return this.uLc}set matchWildcards(f){this.uLc=f}getTypeName(){return"Microsoft.WordServices.SearchOptions"}invokePropertyGet(f){switch(f){case 1:return this.ignorePunct;
case 2:return this.ignoreSpace;case 3:return this.matchCase;case 4:return this.matchPrefix;case 6:return this.matchSuffix;case 8:return this.matchWholeWord;case 7:return this.matchWildcards}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f,a){switch(f){case 1:this.ignorePunct=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,
0,"boolean");return;case 2:this.ignoreSpace=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 3:this.matchCase=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 4:this.matchPrefix=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 6:this.matchSuffix=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 8:this.matchWholeWord=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,
0,"boolean");return;case 7:this.matchWildcards=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,a){this.invokePropertySet(f,a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,a){f=this.invokeMethod(f,a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}}
Object(G.a)(m,"SearchOptions",null,[])},1602:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);var m;(function(f){f[f.before=0]="before";f[f.after=1]="after";f[f.start=2]="start";f[f.end=3]="end";f[f.replace=4]="replace"})(m||(m={}));Object(G.b)("InsertLocation",m)},1669:function(G,J,d){d.d(J,"a",function(){return y});G=d(0);var m=d(54),f=d(7),a=d(543),l=d(298),w=d(1557);class y{constructor(){this.Tjb=new a.a(l.a.th())}OHm(){return m.a.create().toString()}Wq(v,u){v&&u||(f.ULS.sendTraceTag(17168157,
369,10,"Cannot keep reference for null object."),w.a.ng());this.$Zk(v,u)}$Zk(v,u){try{this.Tjb.add(v,u)}catch(x){f.ULS.sendTraceTag(17168158,369,10,"Failed to add object into the cache with exception message {0}.",x.message)}}v3d(v){let u=null;({value:u}=this.Tjb.Dc(v,u));u||f.ULS.sendTraceTag(17168159,369,15,"This object with reference Id {0} hasn't been added to the cache yet.",v);return u}myo(v){try{let u=null;({value:u}=this.Tjb.Dc(v,u));u&&(u.skj(),this.Tjb.remove(v))}catch(u){f.ULS.sendTraceTag(17168160,
369,10,"Failed to remove the object from the cache with exception message {0}.",u.message)}}Krl(){if(this.Tjb&&this.Tjb.values){for(const v of this.Tjb.values)v.skj();this.Tjb=new a.a(l.a.th())}}static get instance(){return y._instance||(y._instance=new y)}}y._instance=null;Object(G.a)(y,"ObjectCache",null,[])},1718:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}m.h0c="extId";m.X5h="ComponentType";m.ofc="ComponentId";m.t1m="HostProps";m.ogd="OptionalProps";Object(G.a)(m,"ActionPropertyNames",
null,[])},1845:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);var m;(function(f){f[f.unknown=0]="unknown";f[f.ddq=1]="notYetImplemented";f[f.Uoq=2]="unsupportedSelection";f[f.eri=3]="forceSaveFailed";f[f.Oeq=4]="ooxmlStringIsNull";f[f.yXp=5]="dependencyNotReady";f[f.dYp=6]="documentNotSupported";f[f.Neq=7]="ooxmlIsMalformated";f[f.aTp=8]="anchoredObjectSelection";f[f.Q4p=9]="invalidParameter"})(m||(m={}));Object(G.b)("OoxmlApiInvocationError",m)},1846:function(G,J,d){d.d(J,"a",function(){return m});
G=d(0);class m{}m.taskPaneWidth="TaskPaneWidth";m.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";m.xS="TaskPaneTitle";m.gS="NonPersistedSettings";m.onTaskPaneClose="OnTaskPaneClose";m.onExtensionLaunchCallback="OnExtensionLaunchCallback";m.jMh="ActionArgs";m.dialogWidth="DialogWidth";m.dialogHeight="DialogHeight";m.dialogLeft="DialogLeft";m.dialogTop="DialogTop";m.dialogTitle="DialogTitle";m.dZc="DialogCloseCallback";m.showLoadingSpinner="ShowLoadingSpinner";Object(G.a)(m,"PropertyNames",
null,[])},1848:function(G,J,d){d.d(J,"a",function(){return x});G=d(0);var m=d(2020),f=d(2022),a=d(1718),l=d(2019),w=d(2021),y=d(2),v=d(54),u=d(12);class x{constructor(){this.ga=y.AFrameworkApplication.va}v3f(z,A,D,F,I){this.lxn(z,A,D,F,I)}lxn(z,A,D,F,I){const {ExtensionComponentInstance:H}=d(2018),N={};N[a.a.h0c]=z;N[a.a.X5h]=A;N[a.a.ofc]=D;N[a.a.t1m]=F;N[a.a.ogd]=I;F=8;if(y.AFrameworkApplication.d2i(z.getId()))switch(A){case l.a.action:F=this.ga.Pb(u.a.n2d,2,N);break;case l.a.J_j:F=this.ga.Pb(u.a.fUj,
2,N);break;case l.a.dMo:F=this.ga.Pb(u.a.Khe,2,N);break;default:F=16}32===F?(F=v.a.create().toString(),I.optionalProperties.InstanceToken&&(F=I.optionalProperties.InstanceToken),z=new H(z,A,D,F),x.xJ[F]=z):z=new H(z,A,D,null);z.rQo(N)}kxn(z){var A=z.ExtId;const D=z.ComponentType,F=z.ComponentId;var I=z.HostProps;z=z.OptionalProps;A=new m.a(A.Id,A.StoreId,A.StoreType,A.AppVersion);I=new w.a(I.HostType,I.FormFactor,I.Locale);const H=new f.a;H.optionalProperties=z.OptionalProperties;H.bZc=z.DevProperties;
x.instance.v3f(A,D,F,I,H)}getInstance(z){return x.xJ[z]}Cyo(z){delete x.xJ[z]}static get instance(){x.lSe||(x.lSe=new x);return x.lSe}}x.lSe=null;x.xJ={};Object(G.a)(x,"ExtensionLifeCycleManager",null,[1367])},1851:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,l,w,y){void 0===y&&(y=w);var v=Object.getOwnPropertyDescriptor(l,w);if(!v||("get"in v?!l.mJ:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,y,v)}:function(a,l,w,y){void 0===
y&&(y=w);a[y]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(2028),J);f(d(2029),J);f(d(2030),J);f(d(2031),J)},2014:function(G,J,d){(function(m){d.d(J,"a",function(){return P});var f=d(0),a=d(2),l=d(28),w=d(6),y=d(11),v=d(386),u=d(37),x=d(656),z=d(79),A=d(574),D=d(3),F=d(2085),I=d(5),H=d(7),N=d(77),M=d(104),U=d(15),O=d(1845),V=d(2016),Y=d(1602),Q=d(1557),S=d(2015);
class P{constructor(T,Z,X,aa,ia,wa,ma,na,Fa,Qa,ya,ta,Aa,oa,za,ja){this.dqa=this.rT=this._context=this.fd=this.$g=null;this.r5=0;this.ga=T;this.Qd=Z;this.Oh=X;this.jb=aa;this.Eoa=ia;this.fHa=wa;this.ul=ma;this.Wd=na;this.aL=Fa;this.lG=Qa;this.uxa=ya;this.UY=ta;this.Rjb=Aa;this.hb=oa;this.uDb=za;this.GSe=ja}zv(T,Z){this.$g=T;this.fd=Z}eTi(T,Z,X){var aa;({ML:aa}=this.nN(T.J(0),T.J(T.count-1),1));T=Object.assign(new S.a,{HLa:aa,fpc:!0,keepCurrentFocus:!0});if(32!==this.ga.Pb(0===X?U.a.insertFootnote:
U.a.insertEndnote,2,T))return Q.a.rC(),null;X=new N.a;(aa=this.UY.zHf(aa.node,aa.cpBegin))||Q.a.ng();aa=aa.x7();aa=this.Hsm(aa);X.add(l.a.zx(aa));Z||(Z="");this.insertText(X,Z,1);return T.Khj}vQl(T){var Z=this.hb.gb;if(Z&&Z.currentSelection&&Z.currentSelection.Ra&&(Z=Z.currentSelection.Ra.node,12===Z.type&&this.lG.i9a(Z)===T&&32!==this.ga.Pb(U.a.Z6,2,null))){Q.a.ng();return}Z=new N.a;if(T=T.zsa)T=T.Jb,Z.add(l.a.createTextRange(T.paragraph,T.cp,T.cp+1));this.Ogc(Z)}w7(T){T=this.lG.w7(T);if(1===T)return 0;
if(0===T)return 1}kBm(T,Z){if(T=T.zsa)if(T=T.Jb,Z=this.uxa.PCi(T.paragraph,T.cp+1,0===Z?1:0))return Z.x7();return null}Hsm(T){T&&38===T.type||Q.a.ng();T=w.GraphIterator.eb(T);T.Xd();return T.Xd()}dkc(T,Z){var X=new w.GraphIterator;X.set(T);T=new N.a;this.jb.vQb(X,!0,!1,T);X=new N.a;for(const aa of T)T=this.nKf(aa,Z),X.addRange(T);return X}nKf(T,Z){var X=this.UY.g2c(T,7);T=new N.a;Z=0===Z?1:0;for(const aa of X)X=aa.x7(),aa.w7()===Z&&T.add(X);return T}$6d(T,Z){const X=new N.a,aa=T.count;if(this.L1f(T.J(0).node))return T=
this.WEm(T.J(0).node,Z),X.add(T),X;for(let na=0;na<aa;na++){var ia=T.J(na);if(ia.contextId==y.a.Vc)continue;var wa=ia.node;let Fa=0,Qa=wa.characterData.length;0===na&&0<=ia.cpBegin&&(Fa=ia.cpBegin);na===aa-1&&0<=ia.cpEnd&&(Qa=ia.cpEnd);ia=wa.qa;for(wa=0;wa<ia.length;wa++)if(!(ia.J(wa).cp<Fa)){if(ia.J(wa).cp>Qa)break;var ma=ia.J(wa).blob;if(ma&&7==ma.Jh){const ya=0===Z?1:0;ma.w7()===ya&&(ma=ma.x7(),X.add(ma))}}}return X}iAa(T,Z){const X=new N.a;let aa=0;for(const ia of T)X.add(this.Rjb.create(ia,Z,
aa++));return X}nN(T,Z,X,aa=!1){let ia=0,wa=null;switch(X){case 2:case 0:if(T.contextId===y.a.paragraph)Z=0,this.r9c(T.node)&&(aa=this.S6d(T.node),-1!==aa&&(Z=aa+2>this.jb.textLength(T.node)?this.jb.textLength(T.node):aa+2)),wa=l.a.Tc(T.node,Z),ia=2===X?0:4;else if(T.contextId===y.a.Vc)wa=l.a.zx(T.node),ia=this.jb.textLength(T.node)?2===X?2:6:2===X?1:5;else if(T.contextId===y.a.Bd||T.contextId===y.a.Xc)wa=l.a.Tc(T.node,T.cpBegin),ia=2===X?3:7;else{if(T.contextId===y.a.table)return{returnValue:8,ML:T};
Q.a.qd()}wa.Fb=wa.Tb=T.vo();break;case 3:case 1:Z.contextId===y.a.paragraph||Z.contextId===y.a.Vc?(3===X?(wa=l.a.zx(Z.node),wa.Fb=wa.Tb=Z.wo()):(wa=this.hnm(Z,aa),0<this.jb.Cm(wa.node,0)?wa.Fb=wa.Tb=this.jb.ry(wa.node):wa.Fb=wa.Tb=-1),ia=3===X?9:11):Z.contextId===y.a.Bd||Z.contextId===y.a.Xc?(wa=l.a.Tc(Z.node,Z.cpEnd),wa.Fb=wa.Tb=Z.wo(),ia=3===X?10:12):Q.a.qd();break;case 4:({ML:wa}=this.nN(T,Z,0));ia=13;break;default:H.ULS.sendTraceTag(17339329,369,15,"Undefined insert location: {0}",Y.a[X]),Q.a.qd()}return{returnValue:ia,
ML:wa}}Nte(T,Z){if(1<T.count){const X=T.J(0);let aa=T.J(T.count-1);switch(Z){case 2:if(aa.contextId===y.a.Xc)T.remove(aa),aa=T.J(T.count-1),aa.contextId===y.a.paragraph&&(T.Z(T.count-1,l.a.createTextRange(aa.node,0,this.jb.textLength(aa.node))),this.Uv(T.J(T.count-1),2));else for(const ia of T)if(ia.contextId===y.a.Vc){T.remove(ia);T.insert(0,ia);break}break;case 0:case 4:2===T.count&&aa.contextId===y.a.Xc?(T.remove(aa),T.Z(0,l.a.zx(X.node)),this.Uv(T.J(0),2,aa)):Z||T.J(1).contextId!==y.a.Vc?T.remove(X):
T.removeAt(1);break;case 3:X.contextId===y.a.Xc&&(T.remove(X),aa.contextId===y.a.paragraph&&(T.Z(T.count-1,l.a.createTextRange(aa.node,0,this.jb.textLength(aa.node))),this.Uv(T.J(T.count-1),2)));break;case 1:2===T.count&&X.contextId===y.a.Xc?T.remove(X):T.remove(aa)}}}hFe(T,Z,X,aa,ia){if(!aa)return 13===X&&(T.clear(),T.add(Z)),Z;let wa=null;const ma=T.J(0),na=T.J(T.count-1);switch(X){case 0:wa=l.a.createTextRange(Z.node,0,aa);T.Z(0,l.a.create(Z.node));T.J(0).Tb=ma.wo();this.Uv(T.J(0),0);break;case 1:wa=
l.a.createTextRange(Z.node,0,aa);T.Z(0,l.a.create(Z.node));T.J(0).Fb=0<this.jb.Cm(Z.node,0)?this.jb.Cm(Z.node,0):-1;T.J(0).Tb=0<this.jb.Cm(Z.node,aa)?this.jb.Bx(Z.node):-1;break;case 2:wa=l.a.createTextRange(Z.node,ia,ia+aa);T.insert(0,wa);this.Uv(T.J(0),2);break;case 3:wa=l.a.createTextRange(Z.node,ma.cpBegin,ma.cpBegin+aa);T.Z(0,l.a.createTextRange(Z.node,ma.cpBegin,ma.cpEnd+aa));ma.contextId===y.a.Bd?(T.J(0).Tb=ma.wo(),this.Uv(T.J(0),0)):this.Uv(T.J(0),2);break;case 4:wa=l.a.createTextRange(Z.node,
0,aa);T.Z(0,l.a.Xl(Z.node));X=this.jb.Cm(Z.node,aa+ia);0<ia?(T.insert(0,l.a.createTextRange(Z.node,aa,aa+ia)),T.J(0).Tb=ma.wo(),this.gFa(T.J(0))):(T.J(0).Fb=0<X?0:-1,T.J(0).Tb=0<X?this.jb.Bx(Z.node):-1);break;case 5:case 6:this.gFa(T.J(0));T.J(0).Tb=0<this.jb.Cm(T.J(0).node,this.jb.textLength(T.J(0).node))?this.jb.Bx(Z.node):-1;6===X&&this.aFf(Z.node,ia);wa=l.a.createTextRange(Z.node,ia,ia+aa);break;case 7:ma.cpBegin&&this.aFf(Z.node,ma.cpBegin);wa=l.a.createTextRange(Z.node,ma.cpBegin,ma.cpBegin+
aa);ma.contextId===y.a.Bd?(T.Z(0,l.a.createTextRange(Z.node,ma.cpBegin+aa,ma.cpEnd+aa)),this.gFa(T.J(0)),T.J(0).Tb=ma.wo()):(T.Z(0,l.a.Tc(Z.node,ma.cpBegin+aa)),this.gFa(T.J(0)),T.J(0).Tb=T.J(0).vo()+ma.wo()-ma.vo());break;case 9:wa=l.a.createTextRange(Z.node,ia,ia+aa);T.removeAt(T.count-1);na.contextId===y.a.paragraph?(T.add(l.a.create(Z.node)),T.J(T.count-1).Fb=na.vo(),this.Uv(T.J(T.count-1),1)):(T.add(l.a.createTextRange(Z.node,ia,ia+aa)),T.add(l.a.Xl(Z.node)),aa=this.jb.Cm(Z.node,aa+ia),T.J(T.count-
1).Fb=0<aa?0:-1,T.J(T.count-1).Tb=0<aa?this.jb.Bx(Z.node):-1);break;case 10:wa=l.a.createTextRange(Z.node,na.cpEnd,na.cpEnd+aa);na.cpEnd&&this.aFf(Z.node,na.cpEnd);T.Z(T.count-1,l.a.createTextRange(Z.node,na.cpBegin,na.cpEnd+aa));na.contextId!==y.a.Xc||na.vo()?T.J(T.count-1).Fb=na.vo():T.J(T.count-1).Fb=-1;this.Uv(T.J(T.count-1),1);break;case 11:wa=ia?l.a.createTextRange(Z.node,0,aa):l.a.create(Z.node);break;case 12:wa=l.a.createTextRange(Z.node,na.cpEnd,na.cpEnd+aa);break;case 13:wa=l.a.createTextRange(T.J(0).node,
T.J(0).cpBegin,T.J(0).cpBegin+aa),T.Z(0,wa),this.Uv(T.J(0),2)}this.Uv(wa,2);return wa}zPa(T,Z,X=2){if(2===X||!X){var aa=T.node.qa;0<aa.length&&((aa=aa.first)&&-1!==T.vo()?T.Fb=aa.Rx:T.Fb=-1)}if(2===X||1===X)T=Z.node.qa,0<T.length&&((T=T.last)&&-1!==Z.wo()?Z.Tb=T.Rx+T.dQ+T.C_:Z.Tb=-1)}APa(T,Z=null){switch(T.contextId){case y.a.paragraph:this.pup(T);break;case y.a.Bd:this.rup(T,Z);break;case y.a.Xc:this.mup(T,Z)}}mup(T,Z=null){0<this.jb.Cm(T.node,T.cpBegin)?T.Fb=T.Tb=this.jb.ry(T.node):T.Fb=T.Tb=-1;
T.Tb=T.Fb+(Z?Z.wo()-Z.vo():0)}rup(T,Z){const X=this.jb.Cm(T.node,T.cpBegin);T.Tb=Z.wo();T.Fb=0<X?this.jb.ry(T.node):-1}pup(T){var Z=this.jb.textLength(T.node);const X=this.jb.Cm(T.node,0);Z=this.jb.Cm(T.node,Z);T.Fb=0<X?this.jb.ry(T.node):-1;T.Tb=0<Z?this.jb.Bx(T.node):-1}Uv(T,Z=2,X=null){switch(T.contextId){case y.a.paragraph:this.oup(T,Z);break;case y.a.Bd:this.qup(T,Z);break;case y.a.Xc:this.nup(T,X)}}gFa(T){const Z=T.contextId!==y.a.Vc?T.cpBegin:this.jb.textLength(T.node);T.Fb=0<this.jb.Cm(T.node,
Z)?0:-1}nup(T,Z=null){0<this.jb.Cm(T.node,T.cpBegin)?T.Fb=0:T.Fb=-1;T.Tb=T.Fb+(Z?Z.wo()-Z.vo():0)}qup(T,Z=2){const X=this.jb.Cm(T.node,T.cpBegin),aa=this.jb.Cm(T.node,T.cpEnd);switch(Z){case 2:T.Fb=0<X?X:-1;T.Tb=0<aa?0:-1;break;case 0:T.Fb=0<X?X:-1;break;case 1:T.Tb=0<aa?0:-1}}oup(T,Z=2){const X=this.jb.textLength(T.node);var aa=this.jb.Cm(T.node,0),ia=this.jb.Cm(T.node,X);const wa=0<aa?aa:-1;ia=0<ia?0:-1;const ma=0<aa?aa/2:-1;aa=0<aa?aa/2:-1;switch(Z){case 2:T.Fb=0<X?wa:ma;T.Tb=0<X?ia:aa;break;case 0:T.Fb=
0<X?wa:ma;break;case 1:T.Tb=0<X?ia:aa}}hnm(T,Z=!1){const X=T.node;var aa=this.jb.zg(X,!1);if(!aa)aa=l.a.Tc(X,this.jb.textLength(X)),aa.Fb=aa.Tb=T.wo(),{Bgc:aa}=this.dnc(aa,!1),aa=aa.Ub(2);else if(Z){T=this.fd.m3(aa);for(Z=null;T&&aa===this.jb.Zl(T);)Z=T,T=this.fd.m3(T);Z&&(aa=this.fd.nTi(Z,!0))}return l.a.Tc(aa,0)}insertBreak(T,Z,X,aa,ia,wa,ma,na=null,Fa=!1){this.GW(T,X,6===Z?0:1);let Qa=null,ya=({ML:Qa}=this.nN(T.J(0),T.J(T.count-1),X)).returnValue;const ta=new w.GraphIterator;ta.set(Qa.node);ta.zb(23)||
6===Z||(H.ULS.sendTraceTag(17577860,369,15,"Inserting Break (excpect LineBreak) is only allowed in the main document."),Q.a.ng());na&&na.exb();switch(Z){case 0:Qa=this.$g.pPa(Qa,T);32!==this.ga.lg(Qa,U.a.vLa,2,!1,null,null)&&Q.a.ng();Fa&&this.u7j(T,Z,ya);na&&na.jAa(T);ia(null);break;case 6:(aa=this.Yee(T,X))&&({ML:Qa,returnValue:ya}=this.nN(T.J(0),T.J(T.count-1),X));this.Qd.Gla(Qa,Aa=>new v.a(Aa));Fa&&this.u7j(T,Z,ya);aa&&this.Nte(T,X);na&&na.jAa(T);ia(null);break;case 2:case 1002:case 3:case 4:case 5:(X=
this.$g.tEi(Qa,Qa))&&0<X.count&&(na&&na.jAa(T),Q.a.Wzc(aa.appId,"Insert section break in content control is not allowed on wac currently.",void 0,V.a[Z]));this.N7c(aa,ia,wa,ma);this.gan(Qa,Z,T,ya,Object(M.a)(this,this.nwp,"updateGncListForInsertSectionBreak"),na);break;default:H.ULS.sendTraceTag(17179037,369,15,"The breakType parameter is invalid: {0}.",V.a[Z]),Q.a.qd()}}gan(T,Z,X,aa,ia,wa){let ma=0;switch(Z){case 2:case 1002:ma=2;break;case 3:ma=3;break;case 4:ma=4;break;case 5:ma=5;break;default:H.ULS.sendTraceTag(18957145,
369,15,"The breakType parameter is undefined: {0}.",V.a[Z]),Q.a.qd()}this._context.An.BF();this.fHa.lye([T],"<w:p xmlns:w='http://schemas.microsoft.com/office/word/2003/wordml'><w:r><w:rPr><w:b/><w:b-cs/><w:color w:val='FF0000'/><w:sz w:val='28'/><w:sz-cs w:val='28'/></w:rPr><w:t>H</w:t></w:r></w:p>",0,0,ma,null,()=>{ia&&ia(X,aa);this.rT(null);this._context.An.yv();wa&&wa.jAa(X);Q.a.vP("InsertApiOperations.InsertSectionBreakUsingOoxml",Q.a.fQ(this.r5),191)},na=>{H.ULS.sendTraceTag(18957146,369,10,
"AppId:{0}, {1}",this._context.appId,O.a[na]);this.dqa(O.a[na]);this._context.An.yv();wa&&wa.jAa(X);Q.a.vP("InsertApiOperations.InsertSectionBreakUsingOoxml",Q.a.fQ(this.r5),191,!1)})}nwp(T,Z){const X=T.J(0),aa=T.J(T.count-1);if(7===Z)T.Z(0,l.a.bU(0,X.cpEnd-X.cpBegin,!1,X.node));else if(12===Z){const ia=this.jb.zg(aa.node,!0,!0);T.Z(T.count-1,l.a.bU(aa.cpBegin,aa.cpEnd,!1,ia))}this.p6j(X,T,Z)}u7j(T,Z,X){const aa=T.J(0);var ia=aa.node;switch(Z){case 6:4===X?(Z=this.jb.textLength(ia),T.Z(0,l.a.Xl(ia)),
1<Z&&T.insert(0,l.a.createTextRange(ia,1,Z))):7===X&&((Z=aa.cpEnd-aa.cpBegin)?T.Z(0,l.a.createTextRange(ia,aa.cpBegin+1,aa.cpEnd+1)):T.Z(0,l.a.Tc(ia,aa.cpBegin+1)));this.eup(aa,T,X);break;case 0:7===X&&aa.cpBegin?(ia=this.jb.zg(this.jb.zg(ia,!1),!1),Z=aa.cpEnd-aa.cpBegin,T.Z(0,Z?l.a.createTextRange(ia,0,Z):l.a.Tc(ia,0)),1<T.count&&T.J(1).contextId===y.a.Vc&&T.Z(1,l.a.Xl(ia))):6===X&&(ia=this.jb.zg(this.jb.zg(ia,!1),!1),T.Z(0,l.a.Xl(ia))),this.p6j(aa,T,X)}}p6j(T,Z,X){7===X||6===X||5===X?(X=Z.J(0).node.qa,
0<X.length?(X=X.first)&&-1!==Z.J(0).vo()&&0<X.Rx&&(Z.J(0).Fb=X.Rx):Z.J(0).Fb=-1,this.s6j(Z.J(0),T)):12===X&&(T=Z.J(Z.count-1),Z=this.jb.Cm(T.node,T.cpEnd),T.Tb=0<Z?T.wo():-1,T.contextId===y.a.Xc&&(T.Fb=0<Z?T.vo():-1))}eup(T,Z,X){4===X||7===X||5===X||6===X?(X=Z.J(0).contextId===y.a.Xc||Z.J(0).contextId===y.a.Bd?Z.J(0).cpBegin:this.jb.textLength(Z.J(0).node),X=this.jb.Cm(Z.J(0).node,X),Z.J(0).Fb=0<X?0:-1,this.s6j(Z.J(0),T)):12===X&&(T=Z.J(Z.count-1),Z=T.wo()-T.vo(),X=this.jb.Cm(T.node,T.cpEnd),T.Tb=
0<X?X:-1,T.contextId===y.a.Xc&&(T.Fb=T.wo()-Z))}s6j(T,Z){T&&Z&&(T.Tb=T.contextId===y.a.Xc||T.contextId===y.a.Vc?T.vo()+(Z.wo()-Z.vo()):Z.wo())}N7c(T,Z,X,aa){this._context=T;this.rT=Z;this.dqa=X;this.r5=aa}r7a(T,Z=!0){var X=0;if(this.r9c(T)){const aa=this.S6d(T);-1!==aa&&(X=aa+2>this.jb.textLength(T)?this.jb.textLength(T):aa+2)}X=Z?X:this.jb.textLength(T);X=l.a.Tc(T,X);X.Fb=X.Tb=Z?this.jb.ry(T):this.jb.Bx(T);return X}L1f(T){return Q.a.C1c()?w.GraphIterator.eb(T).zb(37)?!0:!1:!1}r9c(T){const Z=this.lG.i9a(T);
if(Z&&this.jb.Zl(Z)==T)return!0}i9a(T){return this.lG.i9a(T)}S6d(T){T=T.qa;for(let Z=0;Z<T.length;Z++){const X=T.J(Z),aa=X.blob;if(null!==aa&&10===aa.Jh)return X.cp}return-1}insertParagraph(T,Z,X){this.GW(T,X,1);var aa=!1;switch(X){case 0:aa=!0;break;case 1:aa=!1}Z=Q.a.aXc(Z);const ia=aa?T.J(0):T.J(T.count-1),wa=this.jb.textLength(ia.node);let ma;var na=this.jb.zg(T.J(T.count-1).node,!1);({ML:ma}=this.nN(T.J(0),T.J(T.count-1),X,!0));ma=this.$g.pPa(ma,T);if(ia.contextId===y.a.paragraph||ia.contextId===
y.a.Vc){aa=this.fd.m3(ia.node);const Fa=this.fd.m3(na);na=!na;aa=!na&&!!Fa&&Fa!==aa;if(1===X&&(na||aa)){let Qa;X=this.j8c((Qa=new N.a,Qa.add(ma),Qa),Z,3).J(0).node}else!X&&ia.contextId===y.a.Vc&&0<wa?(X=this.aXa(ma,Z,!1),T.Z(0,l.a.Xl(X)),T.J(0).Fb=T.J(0).Tb=this.jb.Bx(X)):X=this.aXa(ma,Z,!0)}else aa?ia.cpBegin?ia.cpBegin===wa?(X=this.aXa(ma,Z,!1),T.Z(0,l.a.zx(X)),0<Z.length?this.Uv(T.J(0),2,ia):(Z=this.jb.Cm(X,0),T.J(0).Fb=0<Z?Z/2:-1,T.J(0).Tb=T.J(0).Fb+ia.wo()-ia.vo())):X=this.jWf(ma,Z,aa,T):X=this.aXa(ma,
Z,!0):ia.cpEnd===wa?X=this.aXa(ma,Z,!1):ia.cpEnd?X=this.jWf(ma,Z,aa):(X=this.aXa(ma,Z,!0),T.Z(0,l.a.Tc(X,0)),0<Z.length?this.APa(T.J(0),ia):(Z=this.jb.Cm(X,0),T.J(0).Fb=0<Z?Z/2:-1,T.J(0).Tb=T.J(0).Fb+ia.wo()-ia.vo()));return X}jWf(T,Z,X,aa=null){let ia;({$Jo:ma,Bgc:ia}=this.dnc(T));T=this.Oh.tta(ma);if(X){X=ia.Ub(2);var wa=aa.J(0).vo();var ma=aa.J(0).wo();aa.J(0).contextId===y.a.Bd?(wa=aa.J(0).cpEnd-aa.J(0).cpBegin,aa.Z(0,l.a.createTextRange(X,0,wa)),0<this.jb.Cm(X,aa.J(0).cpBegin)?aa.J(0).Fb=this.jb.ry(X):
aa.J(0).Fb=-1,aa.J(0).Tb=ma):(aa.Z(0,l.a.Tc(X,0)),0<this.jb.Cm(X,aa.J(0).cpBegin)?(aa.J(0).Fb=wa+this.jb.ry(X),aa.J(0).Tb=aa.J(0).Fb+ma-wa):aa.J(0).Fb=aa.J(0).Tb=-1);1<aa.count&&aa.J(1).contextId===y.a.Vc&&aa.Z(1,l.a.Xl(X));ia.uc();aa=l.a.Tc(X,0);0<this.jb.Cm(X,aa.cpBegin)&&(aa.Fb=aa.Tb=this.jb.ry(X));this.Oh.Tca(ia,T,aa,!0,!0,!1)}else X=ma.Ub(2),ma.uc(),aa=l.a.zx(X),0<this.jb.Cm(X,aa.cpBegin)?aa.Fb=aa.Tb=this.jb.Bx(X):aa.Fb=aa.Tb=-1,this.Oh.Tca(ma,T,aa,!0,!0,!0);T=T.Ub(2);aa=l.a.Tc(T,0);0<this.jb.Cm(T,
0)?aa.Fb=aa.Tb=this.jb.ry(T):aa.Fb=aa.Tb=-1;this.Qd.Ne(aa,Z);return T}aXa(T,Z,X,aa=!1){({Bgc:T}=this.dnc(T,X,aa));T=T.Ub(2);X=l.a.Tc(T,0);0<this.jb.Cm(T,0)&&(X.Fb=X.Tb=this.jb.Cm(T,0)/2);this.Qd.Ne(X,Z);return T}dnc(T,Z=!1,X=!1){var aa=null,ia=new w.GraphIterator;ia.set(T.node);ia.zb(11)&&(aa=ia.yp(11));X?(X=w.GraphIterator.eb(aa),X.zb(40),X.ld(40),ia=new x.a,X.fK(ia,aa,1),X=w.GraphIterator.eb(ia),aa=w.GraphIterator.eb(aa)):(aa=w.GraphIterator.eb(aa),aa.Jd(),u.OutlineElementNavigator.he(aa),X=Z?this.Oh.K$m(aa):
this.Oh.tta(aa));this.Oh.Tca(aa,X,T,!0,!0,!Z);return{$Jo:aa,Bgc:X}}GW(T,Z,X){T&&T.count||(H.ULS.sendTraceTag(22577489,369,10,"The gncList shouldn't be null or empty."),Q.a.ng());if(Q.a.C1c()){var aa=this.fd.pEi(T.J(0).node,T.J(T.count-1).node);aa&&4===Z&&0===X&&37===aa.type&&Q.a.PIg()}if(1!==T.count||T.J(0).contextId!==y.a.table){aa=new N.a;var ia=3;if(X&&1!==X)2===X?aa=T:Q.a.ng();else switch(ia=1,Z){case 2:case 0:T=this.ivi(T.J(0));aa.add(T);1===X&&(ia=5);break;case 3:case 1:T=this.ivi(T.J(T.count-
1),!1);aa.add(T);1===X&&(ia=5);break;case 4:aa=T,ia=4,1===X&&(ia=6)}(z.a.Taa?this.Eoa.pVc(aa,ia):this.Eoa.pVc(aa,ia)&&!this.X6l(aa))||(H.ULS.sendTraceTag(21033307,369,15,"The inserting operation here is not allowed due to conflict with non-deletable or non-editable content control or field range."),Q.a.rC())}}X6l(T){for(let Z=0;Z<T.count;Z++){const X=T.J(Z);if(X.contextId===y.a.Xc||X.contextId===y.a.Bd){if(this.Y6l(X))return!0}else if((X.contextId===y.a.Vc||X.contextId===y.a.paragraph)&&this.W6l(X))return!0}return!1}Y6l(T){const Z=
T.cpBegin,X=T.cpEnd;T=this.jb.aWa(T.node);let aa=0;for(;aa<T.length;){const ia=T[aa];if(ia.end<=Z)aa++;else{if(X<=ia.Fc)break;return Z>ia.Fc||ia.end>X}}return!1}W6l(T){T=T.node;return T.ja(I.a.FCa,!1)||this.ul.yab(T)}insertText(T,Z,X,aa=-1,ia=null,wa=null){if(void 0===Z||null===Z)H.ULS.sendTraceTag(18477965,369,15,"Inserted text can not be null"),Q.a.qd();this.GW(T,X,0);const ma=4!==X&&this.Yee(T,X);var na=Q.a.Byc(Z),Fa=na.length;if(1<Fa){this.GW(T,X,1);var Qa=null;T.J(0).contextId===y.a.paragraph&&
4===X?Qa=l.a.Tc(T.J(T.count-1).node,0):{ML:Qa}=this.nN(T.J(0),T.J(T.count-1),X);Z=na.shift();const Aa=na.pop();var ya=" "+Z;const oa=Aa+" ";4!==X&&(Qa=this.$g.pPa(Qa,T));var ta=new N.a;ta.addRange(T);this.j8c(ta,ya+oa,X,!1,aa,ia,wa);ia=l.a.Tc(Qa.node,Qa.cpBegin+ya.length);ia.Fb=ia.Tb=-1;4===X&&(wa=this.$g.ybl(Qa,ia),ia=this.$g.pPa(ia,ta),Qa=l.a.Tc(ia.node,Math.max(ia.cpBegin-ya.length,0)),this.$g.TGo(Qa,wa,Qa,ia));({Bgc:ta}=this.dnc(ia,!1));ya=Qa.node;ta=ta.Ub(2);ia=null;if(2<Fa&&(ia=this.sff(na,
Qa.node,!1),z.a.xVa&&1===aa&&(aa=ia.count,Fa=ta.qa.first,na=this.GSe.pIi(ya.qa.last),Fa=this.GSe.oIi(Fa),Fa.length!==na.length&&(H.ULS.sendTraceTag(508654922,324,15,"Number of field begins and ends that should be copied should be the same, but it's not."),Q.a.qd()),0!==Fa.length&&0!==na.length)))for(wa=1;wa<aa;wa++)this.GSe.V8h(ia.J(wa).node,Fa,na);aa=l.a.createTextRange(ya,Qa.cpBegin,Qa.cpBegin+1);this.Uv(aa,2);this.Qd.Ne(aa,"");Qa.cpBegin||this.jb.textLength(ya)!==Z.length?Z.length?(na=l.a.createTextRange(ya,
Qa.cpBegin,Qa.cpBegin+Z.length),this.Uv(na,2)):(na=l.a.Xl(ya),na.Fb=na.Tb=this.jb.Bx(ya)):(na=l.a.create(ya),this.Uv(na,2));Qa=l.a.createTextRange(ta,Aa.length,Aa.length+1);this.Uv(Qa,2);this.Qd.Ne(Qa,"");Fa=l.a.bU(0,Aa.length,!1,ta);this.jb.textLength(ta)===Aa.length&&(Fa=l.a.create(ta),this.Uv(Fa,2));Qa=new N.a;aa=new N.a;aa.add(na);aa.J(aa.count-1).contextId===y.a.Bd&&(na=l.a.Xl(ya),na.Fb=na.Tb=this.jb.Bx(ya),aa.add(na));ia&&aa.addRange(ia);aa.add(Fa);ia=T.J(0);na=T.J(T.count-1);switch(X){case 2:Qa.addRange(aa);
T.J(0).contextId===y.a.paragraph||T.J(0).contextId===y.a.Vc?(Qa.removeAt(Qa.count-1),T.Z(0,l.a.create(ta)),T.J(0).Tb=ia.wo(),this.Uv(T.J(0),0)):T.J(0).contextId===y.a.Bd?(Qa.removeAt(Qa.count-1),1<T.count&&T.J(0).node.id.equals(T.J(1).node.id)&&T.J(1).contextId===y.a.Vc?(T.Z(0,l.a.create(ta)),T.J(0).Tb=ia.wo(),this.Uv(T.J(0),0),T.removeAt(1)):(T.Z(0,l.a.createTextRange(ta,0,T.J(0).cpEnd-T.J(0).cpBegin+Aa.length)),T.J(0).Tb=ia.wo(),this.Uv(T.J(0),0))):T.J(0).contextId===y.a.Xc&&T.removeAt(0);Qa.addRange(T);
break;case 3:if(na.contextId===y.a.paragraph||na.contextId===y.a.Vc||na.contextId===y.a.Bd&&!na.cpBegin)T.Z(T.count-1,l.a.create(ya)),T.J(T.count-1).Fb=na.vo(),this.Uv(T.J(T.count-1),1);else if(na.contextId===y.a.Bd||na.contextId===y.a.Xc)na.cpBegin!==na.cpEnd||na.cpBegin===na.cpEnd&&Z.length?(T.Z(T.count-1,l.a.createTextRange(ya,na.cpBegin,na.cpEnd+Z.length)),T.J(T.count-1).Fb=na.vo(),this.Uv(T.J(T.count-1),1)):T.removeAt(T.count-1),T.add(l.a.Xl(ya)),T.J(T.count-1).Fb=T.J(T.count-1).Tb=0<this.jb.Cm(ya,
this.jb.textLength(ya))?this.jb.Bx(ya):-1;Qa.addRange(T);Z=aa.J(0);aa.removeAt(0);Qa.addRange(aa);aa.insert(0,Z);break;case 0:T.J(0).contextId===y.a.Bd?(T.Z(0,l.a.createTextRange(ta,Aa.length,Aa.length+T.J(0).cpEnd-T.J(0).cpBegin)),T.J(0).Tb=ia.wo(),this.Uv(T.J(0),0),1<T.count&&T.J(1).contextId===y.a.Vc&&(Z=T.J(1),T.Z(1,l.a.Xl(ta)),T.J(1).Fb=Z.vo(),T.J(1).Tb=Z.wo())):T.J(0).contextId===y.a.Xc?(T.Z(0,l.a.Tc(ta,Aa.length+T.J(0).cpBegin)),this.Uv(T.J(0),0),T.J(0).Tb=T.J(0).Fb+ia.wo()-ia.vo()):T.J(0).contextId===
y.a.Vc?(T.Z(0,l.a.Xl(ta)),T.J(0).Fb=-1!==ia.wo()?0:-1,T.J(0).Tb=0<this.jb.Cm(ta,this.jb.textLength(ta))?this.jb.Bx(ta):-1):T.J(0).contextId===y.a.paragraph&&(Aa.length&&this.jb.textLength(ta)?(T.Z(0,l.a.bU(Aa.length,this.jb.textLength(ta),!1,ta)),T.J(0).Tb=ia.wo(),this.Uv(T.J(0),0),1<T.count&&(T.insert(1,l.a.Xl(ta)),T.J(1).Fb=T.J(1).Tb=ia.wo(),T.J(0).contextId===y.a.Xc&&T.removeAt(0))):(T.Z(0,l.a.create(ta)),T.J(0).Tb=ia.wo(),this.Uv(T.J(0),0)));Qa.addRange(T);break;case 1:Qa.addRange(T);break;case 4:Qa.addRange(aa)}ma&&
this.Nte(Qa,X);T.clear();T.addRange(Qa);return aa}return this.j8c(T,Z,X,ma,aa,ia,wa)}Yee(T,Z){let X;({ML:X}=this.nN(T.J(0),T.J(T.count-1),Z));var aa=this.$g.iab(X);aa&&(this.$g.Vsd(X),aa=this.$g.iab(X));if(!aa)return!1;aa=null;let ia=0;var wa=T.J(T.count-1);if(1===Z&&(wa.contextId===y.a.Vc||wa.contextId===y.a.paragraph)&&(wa=this.jb.zg(wa.node,!1))){const ma=l.a.Tc(wa,0);this.$g.iab(ma)||(aa=ma,aa.Fb=aa.Tb=0<this.jb.Cm(wa,0)?this.jb.ry(wa):-1,ia=T.count)}if(!aa){let ma;wa=this.insertParagraph((ma=
new N.a,ma.add(X),ma),"",0);2!==Z&&Z&&4!==Z?(aa=l.a.Tc(wa,0),ia=T.count):(aa=l.a.create(wa),ia=0);Z=this.jb.Cm(wa,0);aa.Fb=aa.Tb=0<Z?Z/2:-1}T.insert(ia,aa);return!0}j8c(T,Z,X,aa=!1,ia=-1,wa=null,ma=null){const na=Z.length;let Fa=new N.a;var Qa=T.J(0);var ya=T.J(T.count-1);const ta=({ML:ya}=this.nN(Qa,ya,X)).returnValue,Aa=ya.node.characterData.length;if(13===ta)return this.$g.uNb(),this.ELb(T),this.$g.bKa(),Qa.contextId!==y.a.Xc&&this.$g.iab(T.J(0))&&this.R7j(T.J(0)),Fa=this.insertText(T,Z,0,ia,wa,
ma),T.clear(),T.addRange(Fa),Fa;if(z.a.xVa&&1===ia){if((ia=ya.node.qa.sh(ya.cpBegin))&&ia.fc)if(0===X)if(Qa=ia.fc.Kpb(2))wa=ia.EG.indexOf(Qa),-1!==wa&&(ya.nfa=wa+1,ya.isa=ya.nfa),this.Qd.Ne(ya,Z,this.KTb);else for(ma?this.uDb.insertField(ya,ma,Z):this.uDb.insertField(ya," ADDIN \\* MERGEFORMAT ",Z),Z=ia.fc.length-1;0<=Z;Z--)ma=ia.fc.J(Z),0===ma.ve&&wa&&(ma.data=m.from(wa,"utf8").toString("base64"));else Qa=2===X?ia.fc.Kpb(2):ia.fc.Kpb(3),wa=ia.EG.indexOf(Qa),-1!==wa&&(ya.nfa=2===X?wa+1:wa,ya.isa=
ya.nfa),this.Qd.Ne(ya,Z,this.KTb)}else this.Qd.Ne(ya,Z,this.KTb);Fa.add(this.hFe(T,ya,ta,na,Aa));aa&&this.Nte(T,X);return Fa}sff(T,Z,X){const aa=new N.a;var ia=T.length;if(0<ia&&Z){Z=l.a.create(Z);this.Uv(Z);aa.add(Z);if(X)for(--ia;0<=ia;ia--)X=this.insertParagraph(aa,T[ia],0),X=l.a.create(X),this.Uv(X),aa.insert(0,X);else for(let wa=0;wa<ia;wa++)X=this.insertParagraph(aa,T[wa],1),X=l.a.create(X),this.Uv(X),aa.add(X);aa.remove(Z)}return aa}oQl(T){let Z;this.GW((Z=new N.a,Z.add(T),Z),4,2);this.Qd.Ne(T,
"")}Wql(T,Z,X,aa,ia){this.GW(T,4,2);this.N7c(Z,X,aa,ia);this._context.An.BF();this.fHa.lye(T.toArray(),"<pkg:package xmlns:pkg='http://schemas.microsoft.com/office/2006/xmlPackage'><pkg:part pkg:name='/_rels/.rels' pkg:contentType='application/vnd.openxmlformats-package.relationships+xml' pkg:padding='512'><pkg:xmlData><Relationships xmlns='http://schemas.openxmlformats.org/package/2006/relationships'><Relationship Id='rId1' Type='http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument' Target='word/document.xml'/></Relationships></pkg:xmlData></pkg:part><pkg:part pkg:name='/word/document.xml' pkg:contentType='application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml'><pkg:xmlData><w:document xmlns:w='http://schemas.openxmlformats.org/wordprocessingml/2006/main' ><w:body></w:body></w:document></pkg:xmlData></pkg:part></pkg:package>",
0,0,0,null,()=>{this.rT(null);this._context.An.yv();Q.a.vP("InsertApiOperations.ClearBody",Q.a.fQ(this.r5),void 0,!0)},wa=>{H.ULS.sendTraceTag(19170978,369,10,"AppId:{0}, {1}",this._context.appId,O.a[wa]);this.dqa(O.a[wa]);this._context.An.yv();Q.a.vP("InsertApiOperations.ClearBody",Q.a.fQ(this.r5),void 0,!1)})}Tfc(T,Z){const X=l.a.create(T);Z?X.Fb=this.jb.ry(T):X.Tb=this.jb.Bx(T);return X}aFf(T,Z){T=T.qa;for(let X=0;X<T.length;X++)if(T.J(X).cp===Z){1<=X&&(!T.J(X-1).blob||T.J(X-1).formatting)&&(T.J(X).formatting=
T.J(X-1).formatting?T.J(X-1).formatting.Bf(T.J(X)):null);break}}ivi(T,Z=!0){if(!T)return null;let X=null;switch(T.contextId){case y.a.paragraph:X=Z?l.a.Tc(T.node,0):l.a.zx(T.node);break;case y.a.Vc:X=l.a.zx(T.node);break;case y.a.Bd:case y.a.Xc:X=l.a.Tc(T.node,Z?T.cpBegin:T.cpEnd)}X.Fb=Z?X.Tb=T.vo():X.Tb=T.wo();return X}q_d(T){const Z=[];for(var X of T)if(X&&X.contextId!==y.a.Xc){if(X.contextId===y.a.Vc){const aa=X.iterator;aa.Jd();aa.uc();if(aa.wCa(1))continue}Z.push(X)}X=32;0<Z.length&&(X=this.ga.lg(new A.a(null),
D.a.wAa,2,!0,null,T.toArray()));return 32===X}ELb(T){if(T.count&&(1!==T.count||T.J(0).contextId!==y.a.Xc)){this.GW(T,4,2);var Z=new N.a;Z.addRange(T);var X=T.J(T.count-1),aa=this.hpn(T);if(aa)this.fd.y3h(aa),T.clear(),T.addRange(this.jb.SA(aa,!0,!1));else{aa=this.u1i(T);this.w1i(T)||aa||!this.v1i(T)||Q.a.ng();if(X.contextId===y.a.Vc)if(1<T.count)T.removeAt(T.count-1);else return;else X.contextId!==y.a.paragraph||aa||(T.Z(T.count-1,l.a.bU(0,this.jb.textLength(X.node),!1,X.node)),T.J(T.count-1).Tb=
X.wo(),1===T.count&&(T.J(T.count-1).Fb=X.vo()));this.uei(T,Z);Q.a.xEf()&&this.ian(Z)}}}Ogc(T){if(T.count&&(1!==T.count||T.J(0).contextId!==y.a.Xc)){this.GW(T,4,2);var Z=new N.a;Z.addRange(T);var X=T.J(T.count-1);this.w1i(T)||this.u1i(T)||!this.v1i(T)||Q.a.ng();this.epn(T)&&(X.contextId===y.a.Vc?T.removeAt(T.count-1):X.contextId===y.a.paragraph&&(T.Z(T.count-1,l.a.createTextRange(X.node,0,this.jb.textLength(X.node))),this.APa(T.J(T.count-1),X),1===T.count&&(T.J(T.count-1).Fb=X.vo())));this.uei(T,Z)}}uei(T,
Z){const X=T.J(0),aa=T.J(T.count-1);let ia=null,wa=!1,ma=!1;X.contextId===y.a.paragraph?({ML:ia}=this.nN(X,aa,1),wa=aa.contextId===y.a.Bd&&!this.KTb):this.KTb&&1===T.count&&X.contextId===y.a.Bd?(ma=!0,ia=this.aPm(X,ia)):({ML:ia}=this.nN(X,aa,this.KTb?1:2),ma=this.KTb);this.q_d(T)||(T.clear(),T.addRange(Z),H.ULS.sendTraceTag(21641408,369,15,"AppId:{0}, Clear or Delete is not allowed on the current object.",this._context.appId),Q.a.ng());ma&&!this.aL.Crf(aa)&&({ML:ia}=this.nN(X,aa,0));wa&&(ia=l.a.Tc(ia.node,
0),this.R7j(ia));this.jb.Cm(ia.node,ia.cpBegin)||(ia.Fb=ia.Tb=-1);T.clear();T.add(ia)}aPm(T,Z){Z=0;const X=this.aL.nWa(T.node,T.cpBegin,T.cpEnd);for(const aa of X)aa.Kd.authorName===a.AFrameworkApplication.userName&&1===aa.Kd.changeType&&(Z=T.cpBegin<=aa.Ad?aa.endCp>=T.cpEnd?Z+T.cpEnd-aa.Ad:Z+aa.endCp-aa.Ad:aa.endCp<=T.cpEnd?Z+aa.endCp-T.cpBegin:Z+T.cpEnd-T.cpBegin);Z=l.a.Tc(T.node,T.cpBegin+(T.cpEnd-T.cpBegin-Z));Z.Fb=T.vo();Z.Tb=T.vo();return Z}R7j(T){var Z=T.node.qa;if(0<Z.length){if(Z=Z.sh(T.cpBegin))Z=
Z.Rx+Z.dQ,T.Fb=T.Tb=0<Z?Z:-1}else T.Fb=T.Tb=-1}hpn(T){const Z=T.J(0);T=T.J(T.count-1);const X=this.fd.lla(Z.node,!0),aa=this.jb.Zl(X),ia=this.jb.hD(X);return Z.contextId!==y.a.paragraph&&Z.contextId!==y.a.Vc||T.contextId!==y.a.paragraph&&T.contextId!==y.a.Vc||!aa||aa.id!==Z.node.id||!ia||ia.id!==T.node.id?null:X}w1i(T){const Z=T.J(0);var X=T.J(T.count-1);T=this.fd.lla(Z.node,!0);const aa=this.jb.Zl(T);X=this.fd.lla(X.node,!0);return!aa||aa.id!==Z.node.id||X&&T.id===X.id?!1:!0}u1i(T){var Z=T.J(0);
T=T.J(T.count-1);const X=this.fd.lla(T.node,!0),aa=this.jb.hD(X);Z=this.fd.lla(Z.node,!0);return!aa||aa.id!==T.node.id||Z&&X.id===Z.id?!1:!0}epn(T){var Z=T.J(0),X=T.J(T.count-1);Z=this.jb.zg(Z.node,!0);T=this.fd.lla(Z,!0);T=this.jb.hD(T);X=this.jb.zg(X.node,!1);var aa=this.fd.lla(X,!0);aa=this.jb.Zl(aa);return T&&T.id===Z.id&&aa&&aa.id===X.id?!0:!1}v1i(T){const Z=T.J(0);T=T.J(T.count-1);const X=this.fd.lla(Z.node,!0),aa=this.fd.lla(T.node,!0),ia=this.fd.lla(Z.node,!1),wa=this.fd.lla(T.node,!1),ma=
this.jb.Zl(X),na=this.jb.hD(aa);return!X&&!aa||ma&&ma.id===Z.node.id&&na&&na.id===T.node.id||ia&&wa&&ia.id===wa.id?!1:!0}get KTb(){return this.Wd.Mg}u$m(T,Z,X){var aa=Q.a.Byc(Z),ia=aa.length;if(1<ia){var wa=null;T.J(0).contextId===y.a.paragraph&&4===X?wa=l.a.Tc(T.J(T.count-1).node,0):{ML:wa}=this.nN(T.J(0),T.J(T.count-1),X);Z=aa.shift();const Qa=aa.pop();var ma=" "+Z,na=Qa+" ",Fa=new N.a;Fa.addRange(T);this.j8c(Fa,ma+na,X,!1);na=l.a.Tc(wa.node,wa.cpBegin+ma.length);na.Fb=na.Tb=-1;4===X&&(wa=l.a.Tc(na.node,
Math.max(na.cpBegin-ma.length,0)));({Bgc:na}=this.dnc(na,!1,!0));ma=wa.node;na=na.Ub(2);Fa=null;2<ia&&(Fa=this.jYk(aa,wa.node));aa=l.a.createTextRange(ma,wa.cpBegin,wa.cpBegin+1);aa.Fb=aa.Tb=-1;this.Qd.Ne(aa,"");ia=wa.cpBegin||this.jb.textLength(ma)!==Z.length?Z.length?l.a.createTextRange(ma,wa.cpBegin,wa.cpBegin+Z.length):l.a.Xl(ma):l.a.create(ma);wa=l.a.createTextRange(na,Qa.length,Qa.length+1);this.Qd.Ne(wa,"");let ya=l.a.bU(0,Qa.length,!1,na);this.jb.textLength(na)===Qa.length&&(ya=l.a.create(na));
wa=new N.a;aa=new N.a;aa.add(ia);aa.J(aa.count-1).contextId===y.a.Bd&&(ia=l.a.Xl(ma),aa.add(ia));Fa&&aa.addRange(Fa);aa.add(ya);Fa=T.J(T.count-1);switch(X){case 2:wa.addRange(aa);T.J(0).contextId===y.a.paragraph||T.J(0).contextId===y.a.Vc?(wa.removeAt(wa.count-1),T.Z(0,l.a.create(na))):T.J(0).contextId===y.a.Bd?(wa.removeAt(wa.count-1),1<T.count&&T.J(0).node.id.equals(T.J(1).node.id)&&T.J(1).contextId===y.a.Vc?(T.Z(0,l.a.create(na)),T.removeAt(1)):T.Z(0,l.a.createTextRange(na,0,T.J(0).cpEnd-T.J(0).cpBegin+
Qa.length))):T.J(0).contextId===y.a.Xc&&T.removeAt(0);wa.addRange(T);break;case 3:if(Fa.contextId===y.a.paragraph||Fa.contextId===y.a.Vc||Fa.contextId===y.a.Bd&&!Fa.cpBegin)T.Z(T.count-1,l.a.create(ma));else if(Fa.contextId===y.a.Bd||Fa.contextId===y.a.Xc)Fa.cpBegin!==Fa.cpEnd||Fa.cpBegin===Fa.cpEnd&&Z.length?T.Z(T.count-1,l.a.createTextRange(ma,Fa.cpBegin,Fa.cpEnd+Z.length)):T.removeAt(T.count-1),T.add(l.a.Xl(ma));wa.addRange(T);X=aa.J(0);aa.removeAt(0);wa.addRange(aa);aa.insert(0,X);break;case 0:T.J(0).contextId===
y.a.Bd?(T.Z(0,l.a.createTextRange(na,Qa.length,Qa.length+T.J(0).cpEnd-T.J(0).cpBegin)),1<T.count&&T.J(1).contextId===y.a.Vc&&T.Z(1,l.a.Xl(na))):T.J(0).contextId===y.a.Xc?T.Z(0,l.a.Tc(na,Qa.length+T.J(0).cpBegin)):T.J(0).contextId===y.a.Vc?T.Z(0,l.a.Xl(na)):T.J(0).contextId===y.a.paragraph&&(Qa.length&&this.jb.textLength(na)?(T.Z(0,l.a.bU(Qa.length,this.jb.textLength(na),!1,na)),1<T.count&&(T.insert(1,l.a.Xl(na)),T.J(0).contextId===y.a.Xc&&T.removeAt(0))):T.Z(0,l.a.create(na)));wa.addRange(T);break;
case 1:wa.addRange(T);break;case 4:for(X=0;X<T.count-1;++X)Z=T.J(X).node,Z=w.GraphIterator.eb(Z),Z.zb(40),Z.uc(),Z.eh();wa.addRange(aa)}T.clear();T.addRange(wa);return aa}}jYk(T,Z){const X=new N.a,aa=T.length;if(0<aa&&Z){Z=l.a.create(Z);X.add(Z);for(let wa=0;wa<aa;wa++){var ia=this.C9m(X,T[wa]);ia=l.a.create(ia);X.add(ia)}X.remove(Z)}return X}C9m(T,Z){Z=Q.a.aXc(Z);var X=T.J(T.count-1);const aa=this.jb.textLength(X.node);let ia;const wa=this.jb.zg(T.J(T.count-1).node,!1);ia=this.Twm(T.J(T.count-1));
if(X.contextId===y.a.paragraph||X.contextId===y.a.Vc)if(wa)X.contextId===y.a.Vc&&0<aa?(X=this.aXa(ia,Z,!1,!0),T.Z(0,l.a.Xl(X))):X=this.aXa(ia,Z,!0,!0);else{let ma;X=this.j8c((ma=new N.a,ma.add(ia),ma),Z,3).J(0).node}else X.cpEnd===aa?X=this.aXa(ia,Z,!1,!0):X.cpEnd?X=this.jWf(ia,Z,!1):(X=this.aXa(ia,Z,!0,!0),T.Z(0,l.a.Tc(X,0)));return X}Twm(T){var Z=null;T.contextId===y.a.paragraph||T.contextId===y.a.Vc?(T=T.node,Z=this.jb.zg(T,!1),Z||(T=l.a.Tc(T,this.jb.textLength(T)),Z=this.D$m(T).Ub(2)),Z=l.a.Tc(Z,
0)):T.contextId===y.a.Bd||T.contextId===y.a.Xc?Z=l.a.Tc(T.node,T.cpEnd):Q.a.qd();return Z}D$m(T){var Z=null,X=new w.GraphIterator;X.set(T.node);X.zb(11)&&(Z=X.yp(11));X=w.GraphIterator.eb(Z);var aa=w.GraphIterator.eb(Z);aa.zb(40);aa.ld(40);const ia=new x.a;aa.fK(ia,Z,1);Z=w.GraphIterator.eb(ia);aa.Yj(ia);aa=this.Oh.QJ(Z,void 0,!0);F.a.rl.V_a(w.GraphIterator.eb(X.Ub(2)),w.GraphIterator.eb(aa),T,!0,!0,!0,!1);u.OutlineElementNavigator.he(Z);return Z}ian(T){for(const Z of T)this.r9c(Z.node)&&this.insertText(new N.a([Z]),
" ",2)}WEm(T,Z){return(T=this.i9a(T))&&this.w7(T)===Z?T:null}}Object(f.a)(P,"InsertApiOperations",null,[1301])}).call(this,d(1662).dCc)},2015:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.HLa=this.Khj=null;this.keepCurrentFocus=this.fpc=!1}}Object(G.a)(m,"NoteItemActionData",null,[])},2016:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);var m;(function(f){f[f.page=0]="page";f[f.next=2]="next";f[f.Gjq=1002]="sectionNext";f[f.Djq=3]="sectionContinuous";f[f.Ejq=
4]="sectionEven";f[f.Hjq=5]="sectionOdd";f[f.line=6]="line"})(m||(m={}));Object(G.b)("BreakType",m)},2017:function(G,J,d){(function(m){d.d(J,"a",function(){return v});var f=d(0),a=d(79),l=d(1277),w=d(1561),y=d(1557);class v extends w.a{constructor(u,x,z,A,D,F,I,H,N,M){super();this.Cd=u;this._context=x;this._id=z;this.emh=A;this.$k=D;this.Wx=F;this.fd=I;this.$g=H;this.od=N;this.Qq=M}get WTf(){return this.emh}set WTf(u){this.emh=u}get _Id(){return this._id}get _ReferenceId(){return this.gr?this.Gr:
null}get code(){return this.Wx.Nrm(this)}set code(u){81===this.type&&(null===u||void 0===u?0:u.trim().toLowerCase().startsWith("addin"))?this.Wx.$So(this,u):y.a.PIg()}get result(){if(this.Cd){const u=this.$k.create(this.Cd,this._context);81===this.type?(u.f3d=1,u.Gpb=this.data,u.$2d=this.code):(u.f3d=0,u.Gpb=null,u.$2d=null);return u}return null}get parentBody(){return this.fd.RMf(this.Cd.J(0).node,this.Cd.J(this.Cd.count-1).node,this._context)}get parentContentControl(){const u=this.parentContentControlOrNullObject;
u||y.a.hl();return u}get parentContentControlOrNullObject(){const u=this.Cd.J(0),x=this.Cd.J(this.Cd.count-1);return this.$g.olc(u,x,this._context)}get parentTable(){const u=this.parentTableOrNullObject;u||y.a.hl();return u}get parentTableCell(){const u=this.parentTableCellOrNullObject;u||y.a.hl();return u}get parentTableCellOrNullObject(){const u=this.Cd.J(0),x=this.Cd.J(this.Cd.count-1);return this.fd.Rkc(u.node,this._context,x.node)}get parentTableOrNullObject(){const u=this.Cd.J(0),x=this.Cd.J(this.Cd.count-
1);return this.fd.frb(u.node,this._context,x.node)}get data(){a.a.Taa||y.a.il();if(81!==this.type)return null;const u=this.Wx.N6d(this);return u.data?m.from(u.data,"base64").toString("utf8"):null}set data(u){a.a.Taa||y.a.il();81!==this.type&&y.a.ng();1E6<(null===u||void 0===u?void 0:u.length)&&y.a.qd();u=m.from(u,"utf8").toString("base64");this.Wx.N6d(this).data=u}get kind(){a.a.Taa||y.a.il();switch(this.type){case 81:case 88:case 13:case 31:return 2;default:return 0}}get locked(){a.a.Taa||y.a.il();
return 88===this.type?!0:this.Wx.N6d(this).CXa}set locked(u){a.a.Taa||y.a.il();88!==this.type&&(this.Wx.N6d(this).CXa=u)}get showCodes(){return null}set showCodes(u){}get type(){a.a.Taa||y.a.il();const u=l.a.wic(this.code);return"addin"===u?81:"toc"===u?13:"hyperlink"===u?88:"date"===u?31:100}_KeepReference(){this.Wq()}_OnAccess(){}delete(){a.a.Taa||y.a.il();this.od.Ogc(this.Cd)}getNext(){const u=this.getNextOrNullObject();u||y.a.hl();return u}getNextOrNullObject(){return this.Wx.getNextOrNullObject(this,
this._context)}getRange(){return this.Cd?this.$k.create(this.Cd,this._context):null}select(u){a.a.Taa||y.a.il();this.Qq.select(this.Cd,u)}updateResult(){a.a.Taa||y.a.il();this.Wx.updateResult(this)}getTypeName(){return"Microsoft.WordServices.Field"}invokePropertyGet(u){switch(u){case 1:return this._Id;case 2:return this._ReferenceId;case 3:return this.code;case 16:return this.data;case 13:return this.kind;case 15:return this.locked;case 5:return this.parentBody;case 6:return this.parentContentControl;
case 7:return this.parentContentControlOrNullObject;case 8:return this.parentTable;case 10:return this.parentTableCell;case 11:return this.parentTableCellOrNullObject;case 9:return this.parentTableOrNullObject;case 4:return this.result;case 14:return this.showCodes;case 12:return this.type}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u,
x){switch(u){case 3:this.code=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return;case 16:this.data=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return;case 15:this.locked=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"boolean");return;case 14:this.showCodes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertySetAsync(u,
x){this.invokePropertySet(u,x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u,x){switch(u){case 1002:return this.ri();case 1001:return this.si();case 1003:return this.yF(x);case 1004:return this.Jfa();case 1005:return this.Kfa();case 1007:return this.oha(x);case 1006:return this.fzp()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokeMethodAsync(u,x){u=this.invokeMethod(u,x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}ri(){this._KeepReference();
return null}si(){this._OnAccess();return null}yF(){return this.delete()}Jfa(){return this.getNext()}Kfa(){return this.getNextOrNullObject()}oha(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"int");this.select(u);return null}fzp(){this.updateResult();return null}}Object(f.a)(v,"Field",w.a,[1143])}).call(this,d(1662).dCc)},2018:function(G,J,d){d.r(J);d.d(J,"ExtensionComponentInstance",function(){return l});G=d(0);d(1846);var m=d(1848);d(1718);var f=d(2),a=d(12);class l{constructor(w,
y,v,u){this.v4b=this.hO=null;this._id=w;this.srk=v;this.Pzk=u;this.ga=f.AFrameworkApplication.va?f.AFrameworkApplication.va:null}oIf(){return this.srk}get appVersion(){return this.v4b}rQo(w){this.hO=w}stop(){const w=this.ga.Pb(a.a.a4h,2,this.hO);m.a.instance.Cyo(this.Pzk);return 32===w}restart(){return 32===this.ga.Pb(a.a.UGj,2,this.hO)}}Object(G.a)(l,"ExtensionComponentInstance",null,[1401])},2019:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}m.J_j="Taskpane";m.action="Action";
m.dMo="SDXDialog";Object(G.a)(m,"ComponentTypeNames",null,[])},2020:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a,l,w){this._id=f;this.WOk=a;this.ENd=l;this.v4b=w}getId(){return this._id}getStoreId(){return this.WOk}getStoreType(){return this.ENd}}Object(G.a)(m,"ExtensionIdentity",null,[1403])},2021:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a,l){this.Dth=l}}Object(G.a)(m,"HostProperties",null,[])},2022:function(G,J,d){d.d(J,"a",function(){return m});
G=d(0);class m{constructor(){this.optionalProperties={};this.bZc={}}}Object(G.a)(m,"ExtensionLaunchProperties",null,[])},2028:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},2029:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.RoamingSettingsExampleAnotherCustomAnnotation=J.RoamingSettingsExampleCustomAnnotation=J.RoamingSettingAnnotation=void 0;const m=d(277);class f{constructor(w){m.SchemaObject.assign(f,this,w)}get metadata(){return this.M_}set metadata(w){this.M_=
w}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[f.getTypeName()])}}J.RoamingSettingAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(w){m.SchemaObject.assign(a,this,w)}get metadata(){return this.M_}set metadata(w){this.M_=w}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsExampleCustomAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,
[a.getTypeName()])}}J.RoamingSettingsExampleCustomAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(w){m.SchemaObject.assign(l,this,w)}get metadata(){return this.M_}set metadata(w){this.M_=w}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsExampleAnotherCustomAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[l.getTypeName()])}}J.RoamingSettingsExampleAnotherCustomAnnotation=
l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},2030:function(G,J){Object.defineProperty(J,"__esModule",{value:!0});J.RoamingSettingType=void 0;G=J.RoamingSettingType||(J.RoamingSettingType={});G.SingleValue="SingleValue";G.Dictionary="Dictionary"},2031:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.RoamingSettingsWriteSignal=J.RoamingSettingsReadSignal=J.RoamingSettingsSignal=void 0;const m=d(277);class f{constructor(w){m.SchemaObject.assign(f,this,w)}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,
[f.getTypeName()])}}J.RoamingSettingsSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(w){m.SchemaObject.assign(a,this,w)}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsReadSignal"}static getBaseTypes(){return["AugLoop_RoamingSettings_RoamingSettingsSignal","AugLoop_Signals_Signal"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[a.getTypeName()])}}J.RoamingSettingsReadSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(w){m.SchemaObject.assign(l,
this,w)}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsWriteSignal"}static getBaseTypes(){return["AugLoop_RoamingSettings_RoamingSettingsSignal","AugLoop_Signals_Signal"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[l.getTypeName()])}}J.RoamingSettingsWriteSignal=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},2032:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,l,w,y){void 0===y&&(y=w);var v=Object.getOwnPropertyDescriptor(l,w);if(!v||("get"in v?
!l.mJ:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,y,v)}:function(a,l,w,y){void 0===y&&(y=w);a[y]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(2033),J);f(d(2034),J);f(d(2035),J);f(d(2036),J);f(d(2037),J);f(d(2038),J);f(d(2039),J);f(d(2040),J)},2033:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},
2034:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},2035:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},2036:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},2037:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.BasicChatResponse=void 0;const m=d(277);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_BasicChat_BasicChatResponse"}static getBaseTypes(){return["AugLoop_GenerativeAi_TextChatResponse",
"AugLoop_Chat_ChatResponse","AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}J.BasicChatResponse=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},2038:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.DslResponse=void 0;const m=d(277);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_BasicChat_DslResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])}}J.DslResponse=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},2039:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.BasicChat=void 0;const m=d(277);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_BasicChat_BasicChat"}static getBaseTypes(){return["AugLoop_Chat_Chat"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}J.BasicChat=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},2040:function(G,
J,d){Object.defineProperty(J,"__esModule",{value:!0});J.DslInput=void 0;const m=d(277);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_BasicChat_DslInput"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}J.DslInput=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},2210:function(G,J,d){function m(e,t,E,W,ha,Ka,sb,dc){let xc=!1;(e.PL||1===t.Fq.count&&1===t.text.length)&&0===
E&&1===t.XMf(t.Fq.J(0)).count&&(xc=!0,!sb&&ha&&Ka&&(ha.Values.type="ImageSelection",ha.Values.payload="ImageSelection",ha.Values.Action="SuccessfulSelectionV2",dc&&(ha.Values.payload=JSON.stringify({text:"ImageSelection",typeOfField:{regular:!0,conditional:!1}})),W.flag=!0,window.parent.postMessage(JSON.stringify(ha),Ka)));return xc}async function f(e,t){var E=e.APb();E=e.getRange(0).XMf(E.J(0));1===E.count&&Gg.ImageReader.Y0i(E.J(0))&&(E=Gg.ImageReader.Qn(E.J(0)),E=Gg.ImageReader.dAi(E),E={height:E.height,
width:E.width,imageSelection:!0,useSourceImageProps:!1,altText:t.altText},t.useSourceImageProps||(E.useSourceImageProps=!0),Object(tj.w)(e,"Filled"),e.a8c(t.imageUrl,4,E))}function a(e,t,E,W){var ha,Ka;if(W&&t.tag.startsWith("mscacr"))if(W=t.APb(),t.fg)for(Ka=0;Ka<W.count;Ka++){var sb=null===(ha=W.J(Ka))||void 0===ha?void 0:ha.node;t=e;var dc=E;for(let xc=0;xc<sb.qa.length;xc++){const Rc=sb.qa.J(xc).formatting;t.EQj(Rc,dc)}}else{ha=null===(Ka=t.APb().J(0))||void 0===Ka?void 0:Ka.node;W=t.APb().J(0).cpBegin;
Ka=t=t.APb().J(0).cpEnd;t=[];for(sb=0;sb<ha.qa.length;sb++)dc=ha.qa.J(sb).cp,dc>=W&&dc<Ka&&t.push(ha.qa.J(sb));for(ha=0;ha<t.length;ha++)t[ha].blob||e.EQj(t[ha].formatting,E)}}d.r(J);var l={};d.r(l);d.d(l,"getDocument",function(){return JG});var w=d(1157),y=d(0),v=d(2);class u{get name(){return"AppLoadStateTracker"}wc(){}init(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MarkAppFullyLoadedExplicitly",!1)||w.a.get_instance().ycj()}dispose(){}}Object(y.a)(u,"AppLoadStateTrackerPackage",
null,[0,1]);var x=d(193),z=d(7),A=d(49);class D{constructor(){this.doj=e=>{e=e.rawEvent;let t=e.blockedURI;t=A.a.xca(t);const E={};E.effectiveDirective=e.effectiveDirective;E.violatedDirective=e.violatedDirective;E.originalPolicy=e.originalPolicy;E.blockedURI=t;E.disposition=e.disposition;z.ULS.sendTraceTag(588084128,306,15,"{0}",E)};$addHandler(document,"securitypolicyviolation",this.doj)}dispose(){$removeHandler(document,"securitypolicyviolation",this.doj)}}Object(y.a)(D,"ContentSecurityPolicyListener",
null,[13]);class F{constructor(){this.W=null}get name(){return"Common.App.ContentSecurityPolicy"}init(){this.W.resolve("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener")}dispose(){const e=this.W.Oa("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener");e&&e.dispose()}wc(e){this.W=e;this.W.register(D,"Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener").ha().Rd(()=>new D)}static main(){x.a.instance.Jc(new F)}}Object(y.a)(F,"ContentSecurityPolicyPackage",null,[0,
1]);var I=d(75),H=d(1156),N=d(267),M=d(12);class U{constructor(e,t){this.aHc=null;this.Ovp=(E,W,ha,Ka,sb)=>{if(1===ha)return 32;sb[H.a.Value]=this.aHc;sb[N.a.labelText]=this.aHc;sb[H.a.Visible]=!0;return 32};this.ga=e;this.Ga=t}Wb(){(this.aHc=this.Ga.kb("StatusBarEnvironmentNameToUse"))&&""!==this.aHc&&this.ga.fb(M.a.$wj,I.a.frame,this.Ovp,96)}}Object(y.a)(U,"DisplayEnvironmentName",null,[]);class O{constructor(){this.W=null}get name(){return"Common.App.DisplayEnvironmentName"}wc(e){this.W=e;this.W.register(U,
"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ha().Rd(()=>new U(v.AFrameworkApplication.va,v.AFrameworkApplication.K))}init(){this.W.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Wb()}dispose(){}static main(){x.a.instance.Jc(new O)}}Object(y.a)(O,"DisplayEnvironmentNamePackage",null,[0,1]);var V=d(1872),Y=d(194),Q=d(621),S=d(22),P=d(640),T=d(477),Z=d(273);class X extends Z.a{constructor(){super();this.Offset=this.Top=this.CollectionId=this.Authorization=this.FileId=
this.Language=null}lm(){return T.a.templates}static construct(e,t,E,W,ha,Ka){const sb=new X;sb.Language=E;sb.FileId=t;sb.Authorization=e;sb.CollectionId=W;sb.Top=ha;sb.Offset=Ka;return sb}}Object(y.a)(X,"TemplatesRequest",Z.a,[]);class aa{constructor(e,t,E){this.RT=e;this.K=t;this.$Sn=E;this.w7i=async(W,ha,Ka,sb)=>{var dc;let xc=X.construct(null,v.AFrameworkApplication.rootQuerySignature,W,ha,Ka,sb);this.$Sn.wV("ContentPlatform",null!==(dc=this.K.kb("ContentPlatformUrl"))&&void 0!==dc?dc:"https://contentplatform.office.net").then(Rc=>
{Rc.IsSuccess?xc=X.construct(Rc.Token,W,v.AFrameworkApplication.rootQuerySignature):z.ULS.sendTraceTag(509693953,3042,15,"Failed to acquire access token for Content Platform [OAuthResult Error: {0}]",Rc.ErrorMessage)}).catch(()=>{z.ULS.sendTraceTag(509693952,3042,15,"Failed to acquire access token for Content Platform")});return this.LZk(xc)}}LZk(e){return new Promise((t,E)=>{this.RT.Ij(`${S.App.webServiceBase}OfficeTemplatesMetadata.ashx?perfTag=Templates`,2,P.b(e),{["Content-Type"]:"application/json; charset=utf-8"},
!1,2,W=>{var ha,Ka;if(null===(ha=null===W||void 0===W?void 0:W.data)||void 0===ha||!ha.De)return E("No response data!");if(W.data.He!==Y.a.zz)return E(`Bad Http Status ${W.data.He}`);if(!({group:W}=Q.a.R4(W.data.De)).returnValue)return E("Empty Server response!");ha=null;if(null===(Ka=null===W||void 0===W?void 0:W.Responses)||void 0===Ka||!Ka.length||!(ha=W.Responses[0]))return E("No valid response!");t(ha.Templates)},W=>{var ha,Ka;z.ULS.sendTraceTag(509692131,3042,10,"Templates request failed [Status: {0}]",
null===(ha=null===W||void 0===W?void 0:W.data)||void 0===ha?void 0:ha.status);E(null===(Ka=null===W||void 0===W?void 0:W.data)||void 0===Ka?void 0:Ka.status)},e)})}}Object(y.a)(aa,"OfficeTemplatesDiscoveryService",null,[]);class ia{get name(){return"Box4.OfficeTemplates"}init(){}dispose(){}wc(e){this.container=e;this.container.register(aa,"Box4.OfficeTemplates.OfficeTemplatesDiscoveryService").ha().Rd(()=>new aa(v.AFrameworkApplication.Be,this.container.resolve("Common.IAppSettingsManager"),this.container.resolve("Common.App.OAuth.IOAuthManager")))}static main(){x.a.instance.Jc(new ia);
z.ULS.sendTraceTag(509692130,3042,50,"Box4 Office Templates package registered.")}}Object(y.a)(ia,"OfficeTemplatesPackage",null,[0,1]);var wa=d(1423),ma=d(47),na=d(11),Fa=d(15);class Qa{constructor(e,t){this.ga=e;this.WCc=t}Wb(){z.ULS.sendTraceTag(558965411,390,50,"Registering AcronymsWeb actions");try{this.ga.fb(Fa.a.F0b,I.a.frame,this.WCc.ZMi,1028),this.ga.fb(Fa.a.upg,na.a.view,this.WCc.iNi,1124)}catch(e){z.ULS.sendTraceTag(558965440,390,10,"Registering actions failed",e.message)}}Bfb(){z.ULS.sendTraceTag(558965441,
390,50,"Unregistering AcronymsWeb actions");this.ga.Zw(Fa.a.F0b,I.a.frame,this.WCc.ZMi);this.ga.Zw(Fa.a.upg,na.a.view,this.WCc.iNi)}dispose(){this.WCc=this.ga=null}}Object(y.a)(Qa,"AcronymsWebActionDelegator",null,[13]);var ya=d(327);class ta{constructor(e){this.XCc=e;this.ZMi=(t,E,W)=>{if(1===W)return 32;try{this.XCc.isVisible()?this.XCc.hide():this.XCc.show()}catch(ha){return z.ULS.sendTraceTag(558965410,390,10,"Show/hide pane failed",ha.message),8}return 32};this.iNi=(t,E,W,ha,Ka)=>{if(1===W)return 32;
Ka&&(Ka[ya.a.On]=this.XCc.isVisible(),Ka[ya.a.Visible]=!0);return 32}}dispose(){this.XCc=null}}Object(y.a)(ta,"AcronymsWebActionHandler",null,[13]);var Aa=d(1447);class oa{constructor(e,t,E,W){this.Ch=e;this.hNd=t;this.zTe=E;this.IId=Object.assign(new Aa.a,{isModernPane:!0,sourceLocationOverrideResourceId:this.hNd,xS:WordEditorIntl.WordEditorStrings.L_AcronymsPaneTitle});W(this)}static kol(){return e=>{e.zTe.execute(async t=>{t=await t.isFeatureEnabled("mso_sendASmile",!0)&&v.AFrameworkApplication.sH;
const E={};E.EnableFeedback=t;e.IId.gS=E})}}isVisible(){return this.Ch.CU(`${"FA000000085"}.${this.hNd}`)}show(){if(this.isVisible())return z.ULS.sendTraceTag(558965405,390,10,"Show pane called when already shown"),!0;ma.c(Fa.a.F0b,void 0,void 0,void 0,2);let e=!1;try{e=this.Ch.B4("FA000000085",this.IId,!0)}catch(t){z.ULS.sendTraceTag(558965406,390,10,"Show pane failed due to exception",t.message)}e||z.ULS.sendTraceTag(558965407,390,10,"Show pane failed");return e}hide(){if(this.isVisible()){ma.c(Fa.a.F0b,
void 0,void 0,void 0,2);try{this.Ch.unb("FA000000085",this.IId)}catch(e){z.ULS.sendTraceTag(558965409,390,10,"Hide pane failed",e.message)}}else z.ULS.sendTraceTag(558965408,390,10,"Hide pane called when already hidden")}dispose(){this.IId=this.Ch=null}}Object(y.a)(oa,"AcronymsWebPane",null,[13]);var za=d(1015);class ja extends za.a{constructor(){super(...arguments);this.W=null}get name(){return"WordEditor.AcronymsWeb"}ifa(e){this.W=e;this.W.ia("WordEditor.AcronymsWeb.IAcronymsWebPane",()=>new oa(this.W.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),
v.AFrameworkApplication.K.kb("WordEditorAcronymsWebSourceLocationOverrideResourceId"),this.W.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),oa.kol())).ha();this.W.ia("WordEditor.AcronymsWeb.IAcronymsWebActionHandler",()=>new ta(this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebPane"))).ha();this.W.ia("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator",()=>new Qa(v.AFrameworkApplication.va,this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionHandler"))).ha()}kfa(){let e=
!1;try{this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator").Wb(),e=!0}catch(t){z.ULS.sendTraceTag(558965404,390,10,"Initializing package failed",t.message)}ma.a("InitializeAcronymsWebPackage",e)}jfa(){this.W&&(this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator").Bfb(),this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebPane").dispose(),this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionHandler").dispose(),this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator").dispose(),
this.W=null)}static get adn(){return Object(wa.a)(v.AFrameworkApplication.K,v.AFrameworkApplication.uiCulture)}static main(){v.AFrameworkApplication.rL||ja.adn&&x.a.instance.Jc(new ja)}}Object(y.a)(ja,"WordEditorAcronymsWebPackage",za.a,[]);var fa=d(77),Ca=d(366);class xa{constructor(){this.Upk=new fa.a}get zUd(){return this.Upk}tCm(e){z.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",e);const t=new fa.a;for(const E of this.zUd)for(const W of E.Led)W.id===e&&t.add(W);return t}Bfl(e){var t=
this.tCm(e);if(t&&0<t.count){e=Object.assign(new Ca.a,{ControlList:[]});for(const E of t)t=E.Zrd(),0<t.length&&Array.addRange(e.ControlList,t);return e}return null}lNh(e){this.zUd.add(e)}Kxo(e){for(const t of this.zUd)if(t.nRh===e.nRh){this.zUd.remove(t);break}}static $Tl(e,t,E=null){e=xa.lnm(e);0<e.length&&(xa.Dxe(e,!1),E&&E(t,e))}static lnm(e){const t=[];if(e&&e.Led&&0<e.Led.count)for(const E of e.Led)if(E.controls&&0<E.controls.count)for(const W of E.controls)if(W.menuItems&&0<W.menuItems.count)for(const ha of W.menuItems)Array.add(t,
ha.id);return t}static Dxe(e,t){if(e.length){var E=[];for(const W of e)E.push(appChrome.actions.updateControlEnabledDisabledState(W,t));appChrome.api.dispatch(E)}}}Object(y.a)(xa,"ContextMenuExtensibilityCache",null,[1597,1598]);var ua=d(89);class sa{constructor(){this.RYl=this.displayName=this.UWc=this.kC=this.ZX=null;this.isUpgraded=!1}a2i(e,t){return this.ZX.getStoreType().toLowerCase()===e.toLowerCase()&&this.ZX.getSolutionId().toLowerCase()===t.toLowerCase()}}Object(y.a)(sa,"AddinCommandsResourceItem",
null,[]);class Ea{constructor(){this.oKe=null;this.uUe=0;this.pXe=!1;this.sa=new ua.a;this.Ozk=new fa.a}L_k(e){this.sa.addHandler("AddinCommandsLoadingMessageChanged",e)}get PSc(){return this.oKe}zxc(e){e!==this.oKe&&(this.oKe=e,this.sa.raiseEvent("AddinCommandsLoadingMessageChanged"))}VQo(){this.uUe++;this.PSc||this.zxc(CommonUIStrings.l_LoadingAddInsTitle)}Azg(){this.uUe--;this.sie()&&(this.pXe?this.PSc!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.zxc(CommonUIStrings.l_ErrorLoadingAddInsTitle):
this.zxc(null))}ZSo(){this.pXe=!0;this.zxc(CommonUIStrings.l_ErrorLoadingAddInsTitle)}G2h(){this.pXe=!1;this.sie()?this.zxc(null):this.zxc(CommonUIStrings.l_LoadingAddInsTitle)}sie(){return 0>=this.uUe}get inc(){return this.Ozk}Iic(e,t,E=0){for(const W of this.inc)if(W.a2i(e,t)&&(!W.kC||W.kC.wfm===E))return W;return null}YNh(e,t,E,W){const ha=new sa;ha.ZX=e;ha.kC=t;ha.UWc=E;ha.displayName=W;this.inc.add(ha)}NXk(e,t,E,W){const ha=new sa;ha.ZX=e;ha.kC=t;ha.UWc=null;ha.RYl=E;ha.displayName=W;this.inc.add(ha)}fxo(e,
t){let E=0;for(const W of this.inc)W.ZX.getStoreType()===e&&W.ZX.getSolutionId()===t?this.inc.removeAt(E):E++}static getInstance(){Ea._instance||(Ea._instance=new Ea);return Ea._instance}}Ea._instance=null;Object(y.a)(Ea,"AddinCommandsResourceManager",null,[]);var Ja=d(2088),nb=d(50),ub=d(1430),Yb=d(833),yb=d(580),Za=d(1431),Ya=d(189),Pa=d(188),rb=d(60),tb=d(41),ob=d(21);class Oa{constructor(){this.title=this.id=this.tabs=null}}Object(y.a)(Oa,"AddInDataTransferObject",null,[]);class Xa{constructor(e,
t,E){this.Hwd=e;this.Jmk=t;this.Lmk=E}get IJ(){return this.Hwd}get iXk(){return this.Jmk}get kXk(){return this.Lmk}static G1c(e){return(e=e.tDa)?Object.assign(new Oa,{tabs:e.IJ.toArray(),id:e.iXk,title:e.kXk}):null}}Object(y.a)(Xa,"OneLineRibbonExtensibility",null,[]);var ab=d(29);class cb{static get Dw(){return cb.Rp||(cb.Rp=ob.a.instance.Oa("Common.Utils.IAriaNotifier"))}static B9h(e,t,E,W){cb.vZ&&cb.vZ.gK&&cb.vZ.dismiss();cb.vZ=Ja.a.hai(t,e,e,3);cb.vZ.content=E;ab.b(W)||(cb.vZ.title=W,cb.vZ.yae=
!0);e=new Sys.UI.Bounds(0,0,rb.a.srb(),rb.a.nX());cb.vZ.Nja=cb.RHf(e,t,cb.vZ.woa,1);cb.vZ.show();cb.Dw&&cb.Dw.sendNotification(E.innerText,!0)}static vXc(e,t,E,W=null){Ya.UISurfaces.kP().then(ha=>{let Ka=null;cb.jya&&(ha.removeNotification(cb.jya),cb.jya=null);const sb=ha.callout(Object.assign(new ub.a,{target:e,title:t,content:E,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new Za.a,{onDismiss:()=>{ha.removeNotification(Ka)},directionalHint:null!=
W?W:null})})),dc=Object.assign(new yb.a,{expirationOptions:Object.assign(new Yb.a,{displayTimeoutSeconds:7,onExpire:()=>{ha.removeNotification(cb.jya)}})});Ka=cb.jya=ha.addNotification(sb,dc);return null},ha=>{z.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",ha);return null})}static iDg(e){cb.vZ&&cb.vZ.gK&&cb.vZ.dismiss();const t=new Pa.StandardDialog;t.BOa=!1;t.Gd=0;t.Gy(nb.a.Vwn,CommonUIStrings.l_DialogError,ab.b(e)?cb.wxi():e,null)}static o5o(e){cb.vZ&&cb.vZ.gK&&cb.vZ.dismiss();
z.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",e.errorCode));const t=ab.b(e.description)?cb.wxi():e.description,E=new Pa.StandardDialog;let W=null;e.BUc?(E.Gd=1,E.Pe(1,e.buttonText),E.uY(1)):E.Gd=0;W=ha=>{1===ha?e.BUc():e.asa&&e.asa()};E.BOa=!1;0===e.bga?E.Gy(e.errorCode,e.title?e.title:CommonUIStrings.l_DialogError,t,W):1===e.bga?E.yY(e.title?e.title:CommonUIStrings.l_DialogWarning,t,W):E.Nna(e.title?e.title:CommonUIStrings.l_DialogInfo,t,W)}static RHf(e,
t,E,W){let ha=0===W?0:4;const Ka=e.x+e.width-t.x-t.width;t.x-e.x+t.width/2<=E/2?ha=0===W?2:5:Ka+t.width/2<=E/2&&(ha=0===W?3:6);return ha}static C5o(e,t,E,W=!1){(t=Xa.G1c(t))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(t,ha=>{ha&&(W||cb.vXc(ha,E,e,5))})}static D5o(e,t,E=!1){cb.C5o(t.startedNode?t.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,e),t,t.startedNode?t.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,
e),E)}static B5o(e,t,E,W){if(cb.p$j)e=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,E,W,CommonUIStrings.l_InsertionDialogRefresh)),cb.vXc(t,e,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{t=tb.a.getElementBounds(t);var ha=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),Ka=document.createElement("span");Ka.innerText=ha[0];var sb=document.createElement("span");sb.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,
E,W,CommonUIStrings.l_InsertionDialogRefresh);sb.className="UIFontBold";E=document.createElement("span");E.innerText=ha[1];W=document.createElement("div");Sys.UI.DomElement.addCssClass(W,"ModalCalloutControl");W.appendChild(Ka);W.appendChild(sb);W.appendChild(E);cb.B9h(e,t,W,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static e7o(e,t){var E=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,W=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;cb.p$j?cb.vXc(t,E,W):(t=tb.a.getElementBounds(t),
cb.B9h(e,t,cb.thl(W),E))}static PUl(){cb.vZ&&cb.vZ.gK&&cb.vZ.dismiss()}static thl(e){const t=document.createElement("div");Sys.UI.DomElement.addCssClass(t,"ModalCalloutControl");t.innerText=e;return t}static wxi(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get p$j(){return v.AFrameworkApplication.ua.Ib.Hs&&v.AFrameworkApplication.ua.Ib.MXa}}cb.vZ=null;cb.jya=null;cb.Rp=null;Object(y.a)(cb,"AddInCommandsNotificationFactory",null,[]);var ib=d(104);class Ub{constructor(e,
t){this.B0a=(E,W,ha,Ka,sb)=>{if(W.contextId!==na.a.application)return 2;if(1===ha)return E!==M.a.zcc||this.Fwa&&this.Fwa.WTm(sb)?32:8;if(!sb)return 8;switch(E){case M.a.pUb:this.Fwa.pUb(sb);break;case M.a.zcc:this.Fwa.O$d(sb);break;case M.a.Lid:this.Fwa.Lid(sb);break;case M.a.Vxc:this.Fwa.Vxc(sb);break;case M.a.NP:this.Fwa.wjo(sb);break;case M.a.Nvc:this.Fwa.Nvc(sb);break;case M.a.Wqg:this.Fwa.Gro();break;case M.a.G0b:this.Fwa.G0b(sb);break;case M.a.DOa:this.Fwa.DOa(sb);break;case M.a.fLa:this.Fwa.fLa(sb)}return 32};
this.ga=e;this.Fwa=t}Wb(){this.ga.ra(M.a.pUb,na.a.application,this.B0a);this.ga.fb(M.a.zcc,na.a.application,this.B0a,64);this.ga.fb(M.a.Lid,na.a.application,this.B0a,96);this.ga.ra(M.a.Vxc,na.a.application,this.B0a);this.ga.fb(M.a.Nvc,na.a.application,this.B0a,64);this.ga.fb(M.a.NP,na.a.application,this.B0a,64);this.ga.ra(M.a.Wqg,na.a.application,this.B0a);this.ga.ra(M.a.G0b,na.a.application,this.B0a);this.ga.ra(M.a.DOa,na.a.application,this.B0a);this.ga.ra(M.a.fLa,na.a.application,this.B0a)}}Object(y.a)(Ub,
"AddInCommandsActor",null,[]);class lb{constructor(){this.nLh={["tabhome"]:"tabHome",["tabinsert"]:"tabInsert",["tabpagelayoutword"]:"tabPageLayout",["tabreviewword"]:"tabReview",["tabview"]:"tabView",["tabhelp"]:"tabHelp"};this.jLh={["tabworddesign"]:["tabWordDesign",WoncaIntl.WoncaStrings.L_TabWordDesign,CommonUIStrings.l_TabWordDesignKeytip],["tabreferences"]:["tabReferences",WoncaIntl.WoncaStrings.L_TabReferences,CommonUIStrings.l_TabReferencesKeytip],["tabmailings"]:["tabMailings",WoncaIntl.WoncaStrings.L_TabMailings,
CommonUIStrings.l_TabMailingsKeytip],["tabdeveloper"]:["tabDeveloper",WoncaIntl.WoncaStrings.L_TabDeveloper,CommonUIStrings.l_TabDeveloperKeytip],["tabaddins"]:["tabAddIns",WoncaIntl.WoncaStrings.L_TabAddIns,CommonUIStrings.l_TabAddInsKeytip]};this.pQd=null}get X7h(){return"SourceControlId"}get d0(){return"Document"}get formFactor(){return"DesktopFormFactor"}Pzm(){if(!this.pQd){this.pQd={};for(const e of Object.keys(this.nLh))this.pQd[e]=this.nLh[e];for(const e of Object.keys(this.jLh))this.pQd[e]=
this.jLh[e][0]}}}Object(y.a)(lb,"AddInCommandsStringProvider",null,[1172]);var Qb=d(1928),fc;(function(e){e[e.Ile=0]="notSupported";e[e.b6p=1]="launchByLocalCacheInitializer";e[e.Y5p=2]="launchByAnonymousApiInitializer";e[e.$5p=3]="launchByInsertion";e[e.c6p=4]="launchByRefresh";e[e.a6p=5]="launchByLastUpdateInitializer";e[e.Z5p=6]="launchByDynamicCall"})(fc||(fc={}));Object(y.b)("AddinCommandsLaunchOperationType",fc);class Fc{}Fc.Njp=864E5;Fc.E2k=3;Fc.DTn=144E5;Object(y.a)(Fc,"AddinConstantsNum",
null,[]);var nc=d(1573),zb;(function(e){e[e.Ile=-1]="notSupported";e[e.OMEX=0]="OMEX";e[e.Xlq=1]="spCatalog";e[e.Wlq=2]="spApp";e[e.S_p=3]="fileSystem";e[e.exchange=4]="exchange";e[e.oneDrive=5]="oneDrive";e[e.Qrg=6]="registry";e[e.S3p=7]="inMemory";e[e.$oq=8]="uploadFileDevCatalog";e[e.v2p=9]="hardCodedPreinstall";e[e.pre=10]="privateCatalog";e[e.Rpq=16]="wopiCatalog"})(zb||(zb={}));Object(y.b)("AddinProviderType",zb);class Vb{static q3o(e){return parseInt(Vb.e2b(nc.a.LQh,e)||"-1")<=(new Date).getTime()}static eti(e){return parseInt(Vb.e2b(nc.a.Wcc,
e)||"-1")}static lNi(e){return Boolean.parse(Vb.e2b(nc.a.chf,e)||"false")}static e2b(e,t){let E=null;try{const W=Vb.W7d();if(void 0!==W&&W){const ha=nc.a.d5d(e)+t;E=W.getItem(ha)}else z.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(W){z.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",e,t)}return E}static dAb(e,t,E){try{const W=Vb.W7d();if(void 0!==W&&W){const ha=nc.a.d5d(e)+E;W.setItem(ha,t)}else z.ULS.sendTraceTag(42074647,
220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(W){z.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",e,E)}}static W7d(){if(!Vb.e$a)return null;let e=null;try{e=localStorage}catch(t){Vb.e$a=!1,e=null}return e}}Vb.e$a=!0;Object(y.a)(Vb,"AddinUtil",null,[]);class rc{constructor(e,t,E,W=null){this.K=W?W:v.AFrameworkApplication.K;this.lWe=2;this.VRb=e;this.eSk=t;this.Pp=E}get v$a(){return this.lWe}get bCp(){return this.eSk}Gvg(e){if(this.K.$("AgaveSupportsLiveIdSpoofing")){var t=
(new Date).getTime();this.VRb(e,this.v$a,{["ak0"]:t})}else if(Vb.q3o(e)){t=String.format(v.AFrameworkApplication.ua.Ib.HYa+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",v.AFrameworkApplication.ua.Ib.Tk,this.bCp,v.AFrameworkApplication.jm);const E=v.AFrameworkApplication.Be;let W=null;this.Pp&&(W=this.Pp.Vf("ComponentAttach",zb[e]+fc[this.v$a]));E.Ij(t,1,null,null,!0,4,ha=>{this.q4n(e,ha.data.De);W&&W.stop()},ha=>{z.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",
ha.data.He);this.Xsc(e,1,"request failed");W&&W.stop()},null)}else Vb.lNi(e)?(t=Vb.eti(e),this.VRb(e,this.v$a,{["ak0"]:t})):this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(this.tR?this.Xsc(e,1,"no local timestamp"):this.VRb(e,this.v$a,null))}q4n(e,t){if(t&&""!==t)if(t=Sys.Net.XMLDOM(t)){Vb.dAb(nc.a.LQh,((new Date).getTime()+Fc.DTn).toString(),e);let E=t.getElementsByTagName("update");E&&E.length||(E=t.getElementsByTagName("o:update"));E&&0<E.length?
(t=Date.parse(E[0].firstChild.nodeValue),Vb.eti(e)<t||Vb.lNi(e)?this.VRb(e,this.v$a,{["ak0"]:t}):this.Xsc(e,1,"outdate timestamp in reponse")):this.Xsc(e,2,"no timestamp in response")}else this.Xsc(e,1,"response data is invalid");else this.Xsc(e,1,"no responseData")}Xsc(e,t,E){this.tR&&this.VRb(e,this.v$a,{["AddinServiceUserState"]:t,["DiagnosticInfo"]:E})}get tR(){return this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",
!1)}}Object(y.a)(rc,"AddinCommandsAnonymousAPIInitializer",null,[824]);class pb{constructor(e,t,E){this.lWe=E;this.VRb=e;this.Vd=t}get v$a(){return this.lWe}Gvg(e){let t=null;this.Vd&&(t=this.Vd.Vf("ComponentAttach",zb[e]+fc[this.v$a]));if(null==this.JCg(e)?0:this.JCg(e)){const E=(new Date).getTime()-Fc.E2k*Fc.Njp;this.VRb(e,this.v$a,{["ak0"]:E})}t&&t.stop()}}Object(y.a)(pb,"AddinCommandsInitializerBase",null,[824]);class bb extends pb{constructor(e,t){super(e,t,5)}JCg(){return!0}}Object(y.a)(bb,
"AddinCommandsInitializer",pb,[]);class Pb extends pb{constructor(e,t){super(e,t,1)}JCg(e){try{const t=nc.a.Oyi()+e;return Boolean.parse(this.ikm(t)||"false")}catch(t){z.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",t.toString())}return null}ikm(e){const t=localStorage;return void 0!==t&&null!==t?t.getItem(e):null}}Object(y.a)(Pb,"AddinCommandsLocalCacheInitializer",pb,[]);var mb=d(814);class Ua{constructor(e,t=null){this.Pp=e;this.K=t?t:v.AFrameworkApplication.K}get appUILocale(){return mb.a.Cg(v.AFrameworkApplication.lcid).name}h6m(){if(this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",
!1)&&this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)&&this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var e={};e[nc.a.OYl]="TeachingCallout";this.qre(M.a.Inp,e)}const t=this.aui();if(t)if(this.K.$("OcpsIsEnabled"))ob.a.instance.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(E=>{E.isFeatureEnabled("ConnectedServices",
!0).then(W=>{for(const ha of t){if(!W&&0===ha.key){this.tR&&this.Y2j(0,ha.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});continue}const Ka=this.zsi(ha.value);Ka&&Ka.Gvg(ha.key)}return null})});else for(const E of t)(e=this.zsi(E.value))&&e.Gvg(E.key)}Hvg(e,t,E){E&&E[nc.a.Wcc]?(E[nc.a.pIa]=e,E[nc.a.oIa]=t,this.qre(M.a.Nvc,E),Vb.dAb(nc.a.Wcc,E[nc.a.Wcc].toString(),e)):this.tR?this.Y2j(e,t,E):this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&0===e&&(E={},E[nc.a.pIa]=e,E[nc.a.oIa]=t,this.qre(M.a.NP,E))}zsi(e){let t=null;switch(e){case 1:t=new Pb(Object(ib.a)(this,this.Hvg,"retrieveAddinFlagCompleted"),this.Pp);break;case 2:t=new rc(Object(ib.a)(this,this.Hvg,"retrieveAddinFlagCompleted"),this.appUILocale,this.Pp,this.K);break;case 5:t=new bb(Object(ib.a)(this,this.Hvg,"retrieveAddinFlagCompleted"),this.Pp)}return t}Y2j(e,t,E){0===e&&E&&E[nc.a.aSd]&&(E[nc.a.pIa]=e,E[nc.a.oIa]=t,z.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",
E[nc.a.aSd].toString(),JSON.stringify(E)),this.qre(M.a.NP,E))}get tR(){return this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}}Object(y.a)(Ua,"AddinCommandsInitializerHost",null,[]);var vb=d(163);class Ia extends Ua{constructor(e,t){super(t);this.ga=e}ppp(){this.h6m()}mhm(){return this.aui()}aui(){const e=new vb.a;v.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&
(v.AFrameworkApplication.K.$("AddInCommandsRoamingStoreIsEnabled")?e.Z(0,2):e.Z(0,1),e.Z(16,5));v.AFrameworkApplication.K.$("InsertAgaveMyOrgEnabledForHost")&&e.Z(1,1);v.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled")&&e.Z(10,5);v.AFrameworkApplication.K.$("AddInCommandsIsEnabled")&&e.Z(8,1);return e}qre(e,t){this.ga.Pb(e,2,t)}}Object(y.a)(Ia,"AddInCommandsInitService",Ua,[805]);class Ma extends Ia{constructor(e,t){super(e,t);Qb.a.A6c=Qb.a.Dck}}Object(y.a)(Ma,"WordEditorAddInCommandsInitService",
Ia,[]);class qb{constructor(){this.labelText=null;this.visible=!1}}Object(y.a)(qb,"AddinStatusCommandValues",null,[]);class Xb{static $jo(e){const t=new qb;t.labelText=e.PSc;t.visible=t.labelText?!0:!1;return t}static Yze(e,t,E,W,ha){const Ka=document.getElementById(E);Ka?Xb.a7o(e,t,Ka,W,ha):z.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",E))}static a7o(e,t,E,W,ha){E?e.PSc===CommonUIStrings.l_ErrorLoadingAddInsTitle?cb.B5o(t,E,W,ha):e.PSc===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&
cb.e7o(t,E):z.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(y.a)(Xb,"AddinCommandsStatusHandler",null,[]);var Cc=d(23),Ec=d(816),Wb=d(1445),Hb=d(54),Sb=d(129),cc=d(198);class Gc extends Sys.EventArgs{constructor(){super();this.kC=this.Hq=null}}Object(y.a)(Gc,"InsertionParamEventArgs",Sys.EventArgs,[]);class Oc{constructor(e,t,E,W,ha,Ka){this.dH=e;this.Hq=t;this.dEa=E;this.displayName=ha;this.y5i=Ka}}Object(y.a)(Oc,"PostLaunchAddinCommandsParameters",
null,[]);var Zc=d(209),kb=d(372);class wd{}Object(y.a)(wd,"AppsForOfficeEntitlementQueryInfo",null,[]);var qe=d(34),Qd=d(19);class me{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(y.a)(me,"AddinAbstract",null,[]);var Ne=d(84);class Cd{constructor(e,t,E,W=null){this.zQb=ha=>{let Ka=!1,sb=null;try{if(0<ha.data.De.length){const dc=Object(Ne.a)(Object,qe.a(ha.data.De)),xc=dc?dc[this.appName]:null;xc&&(sb=Object(Ne.a)(Object,qe.a(xc.toString())))}Ka=!0}catch(dc){this.J9a(null)}Ka&&
this.kIc&&this.kIc(sb)};this.J9a=ha=>{this.eIc&&this.eIc(ha?ha.data:null)};this.Jcb=ha=>{this.QNc&&this.QNc(ha?ha.data:null)};this.tmd=v.AFrameworkApplication.K.kb("RoamingServiceHandlerWebServiceBase");this.appName=e;this.kIc=t;this.eIc=E;this.QNc=W}pCf(e){this.H3l(e,this.zQb,this.J9a)}H3l(e,t,E){const W=new Sys.StringBuilder(this.tmd);W.append("RoamingServiceHandler.ashx?action=");W.append("getAddinTeachingCalloutSettings");W.append("&");W.append(this.lNf(e));W.append("&");W.append(v.AFrameworkApplication.jm);
v.AFrameworkApplication.Be.Ij(W.toString(),1,null,null,!0,2,t,E,null)}r2d(e){this.M3l(e)}M3l(e){var t=new Sys.StringBuilder(this.tmd);t.append("RoamingServiceHandler.ashx?action=");t.append("saveAddinTeachingCalloutSettings");t.append("&");t.append(v.AFrameworkApplication.jm);t=t.toString();e=qe.c(e);v.AFrameworkApplication.Be.Ij(t,2,e,null,!0,4,null,this.Jcb,null)}lNf(e){const t=new Sys.StringBuilder("requestedsettings=");for(let E=0;E<e.count;E++)t.append(e.J(E)),E<e.count-1&&t.append(";");return t.toString()}}
Object(y.a)(Cd,"AddinTeachingUIRoamingRequestHandler",null,[]);class Pf extends Sys.EventArgs{constructor(e){super();this.solutionId=e.solutionId;this.assetId=e.assetId;this.storeType=e.storeType;this.storeId=e.storeId;this.assetStoreId=e.assetStoreId;this.targetType=e.targetType;this.width=e.width;this.height=e.height;this.displayName=e.displayName;this.version=e.version}}Object(y.a)(Pf,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var cg=d(167);class mg{constructor(e){this.Xcc=
this.Hq=null;this.cIj=!1;this.mhb=this.Lwd=this.FZa=this.au=this.kBb=this.cwc=null;this.CZn=()=>{const t=new Zc.ScriptSharpLegacyMap;this.Xcc&&this.Xcc.tabs&&!this.Xcc.tabs[0].isOfficeTab&&t.Z("SDX.FeatureFlags","NonOfficeTab");this.Xqc(mg.z7(this.Hq),"ClickOnLaunch",t);this.Jje();this.Xcc?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Xcc,()=>{const E=new Gc;E.Hq=this.Hq;this.ed.raiseEvent(nc.a.l6i,E)}):z.ULS.sendTraceTag(508625355,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};
this.NVn=()=>{this.Xqc(mg.z7(this.Hq),"ClickOnClose");this.Jje()};this.bXn=()=>{this.Xqc(mg.z7(this.Hq),"ClickOnDismiss");this.Jje()};this.Qjj=t=>{if(t&&(t=t.detail)&&t.id&&this.Qen(t.id)){const E=(t.action||"").toLowerCase();if(t.success&&"opened"===E)this.Xqc(mg.z7(this.Hq),"CampaignLaunched"),z.ULS.sendTraceTag(508625354,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.Jje(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",this.Qjj,!0);else{let W;
try{W=JSON.stringify(t),z.ULS.sendTraceTag(508625353,220,15,"Campaign launch failure. Event:"+W)}catch(ha){W="id : "+t.id+" telemetryEventName: "+t.telemetryEventName,z.ULS.sendTraceTag(508625352,220,50,"Error serializing campaign event. "+W+" Error: "+(ha?ha.toString():""))}}}};this.zQb=t=>{t?this.d4o(t)?(z.ULS.sendTraceTag(508625348,220,50,"should show teaching UI"),this.cwc="AddinHasShown"in t&&t.AddinHasShown?t.AddinHasShown.toString():null,this.b6h()):(z.ULS.sendTraceTag(508625347,220,50,"Not Show TeachingUI this time"),
this.FZa(this.imb,null)):(z.ULS.sendTraceTag(508625349,220,50,"userSettings is null"),this.cwc=null,this.b6h())};this.J9a=t=>{z.ULS.sendTraceTag(508625346,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",t?t.He:-1);this.FZa(this.imb,null)};this.Jcb=t=>{z.ULS.sendTraceTag(508625345,220,10,"failed to POST data to Roaming Settings Service with status: {0}",t?t.He:-1)};this.ed=e}get appName(){return v.AFrameworkApplication.K.kb("WebAppShortName")}get RQh(){this.kBb||(this.kBb=
new Cd(this.appName,this.zQb,this.J9a,this.Jcb));return this.kBb}get imb(){this.Lwd||(this.Lwd=new fa.a);return this.Lwd}set imb(e){this.Lwd=e}get cMb(){this.mhb||(this.mhb=new fa.a);return this.mhb}set cMb(e){this.mhb=e}iRd(e,t){window.addEventListener?(this.Hq=e,this.Xcc=t,window.addEventListener("LaunchAddinTaskpane",this.CZn,!0),window.addEventListener("DismissCallout",this.bXn,!0),window.addEventListener("CloseCallout",this.NVn,!0),window.addEventListener("FGWebSurfaceEvent",this.Qjj,!0)):z.ULS.sendTraceTag(508625357,
220,15,"AddEventListenerForTeachingCallout failed to get Window")}yAc(e,t,E,W){this.au=e;this.imb=t;this.cMb=E;this.FZa=W;z.ULS.sendTraceTag(508625356,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",t?t.count.toString():"null",E?E.count.toString():"null");0<this.imb.count||0<this.cMb.count?(e=new fa.a,e.add(this.appName),this.RQh.pCf(e)):this.FZa(new fa.a,null)}Qen(e){e=Qd.a.xh(e);return-1!==e.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||
-1!==e.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==e.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==e.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==e.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==e.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}mwe(e){if(this.appName){const t={},E={};E.LastTeachingUIShowTime=(new Date).toUTCString();E.AddinHasShown=e;t[this.appName]=qe.c(E);this.RQh.r2d(t);z.ULS.sendTraceTag(508625351,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else z.ULS.sendTraceTag(508625350,
220,10,"Fail to save roaming service since AppName is null")}Jje(){if(!this.cIj){const e=window.g_roamingAddinList;e&&(this.mwe(e),this.cIj=!0)}}b6h(){const e=this.jSl();0===e.targetType?(e.solutionId?this.Ejo(e):this.Xqc(null,"NoSolutionId"),this.Z8j(e),this.FZa(this.imb,null)):this.FZa(this.imb,e);z.ULS.sendTraceTag(508625344,220,50,"Show teaching callout for: {0}",e.addinId)}Ejo(e){const t=new wd;t.callbackFunc=E=>{if(E.errorCode){this.Xqc(e.solutionId,"FailToGetAppDetails");var W=window.g_roamingAddinList;
W&&this.mwe(W)}else if(E.value)for(W of E.value)if(E=W[1],E===e.solutionId){const ha={};ha.solutionId=E;ha.assetId=W[5];ha.storeType=W[12];ha.storeId=W[11];ha.assetStoreId=W[6];ha.targetType=W[3];ha.width=W[7];ha.height=W[8];ha.displayName=W[0];ha.version=W[4];z.ULS.sendTraceTag(508625315,220,50,"Raise a teaching callout event for content addin: {0}.",e.solutionId);W=new Pf(ha);this.ed.raiseEvent(nc.a.A5o,W);break}};t.storeType=OSF.StoreTypeEnum.PrivateCatalog;t.fromInsertDialog=!1;t.refresh=!1;this.au.queryEntitlementDetails(t)}d4o(e){if("LastTeachingUIShowTime"in
e){if(e=+new Date-+new Date(e.LastTeachingUIShowTime.toString()),e<v.AFrameworkApplication.K.j3("AddinShowTeachingUIIntervalInMS",864E5))return z.ULS.sendTraceTag(508625314,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",e),!1}else z.ULS.sendTraceTag(508625313,220,50,"userSetting has no date key");return!0}jSl(){let e=new kb.a(new me,0),t=new kb.a(new me,0),E=0,W=0,ha=0;var Ka=new fa.a;for(var sb of this.imb)Ka.add(sb);for(const dc of this.cMb)Ka.add(dc);for(const dc of Ka)if(!("excatalog"!==
dc.storeType||ab.c(dc.installTimeInMS)||!dc.installTimeInMS||dc.installTimeInMS<=v.AFrameworkApplication.K.j3("DateTimeInMSForNewAddin",16409952E5))){Ka=mg.fti(dc);if(this.cwc&&(sb=this.cwc.split(","),0<sb.length&&Array.contains(sb,Ka))){ha++;z.ULS.sendTraceTag(508625312,220,50,"This addin has shown teaching UI before");continue}Ka.startsWith("private_")?(e=mg.sBi(dc,e),W++):(t=mg.sBi(dc,t),E++)}z.ULS.sendTraceTag(508625311,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",
W,E,ha);return 0<t.value?t.key:0<e.value?e.key:Object.assign(new me,{addinId:null,targetType:-1,solutionId:null})}Xqc(e,t,E=null){e={["AppTeachingUICalloutAction"]:t,["SDX.Id"]:e,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(E)for(const W of E.keys)e[W]=E.J(W);cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.fI(e)}))}Z8j(e){e&&(window.g_roamingAddinList=this.cwc?this.cwc+","+e.addinId:
e.addinId)}static z7(e){return Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.storeType,e.assetId,null,null,e.storeId)}static sBi(e,t){return t.value<e.installTimeInMS?new kb.a(Object.assign(new me,{addinId:mg.fti(e),targetType:e.targetType,solutionId:e.solutionId}),e.installTimeInMS):t}static fti(e){return Telemetry.PrivacyRules.IsPrivateAddin(e.storeType,e.assetId,null,null,e.storeId)?"private_"+e.installTimeInMS:e.solutionId}}Object(y.a)(mg,"PrivateCatalogTeachingCalloutHandler",null,
[]);class ci{constructor(e){this.XZe=null;this.gnh=e}get dUb(){return this.XZe}Gcc(e,t=null){this.gnh.Gcc(e,t);this.XZe=e}Hsg(e){this.gnh.Hsg(e)}AOj(e){this.XZe=e}}Object(y.a)(ci,"RibbonExtensibilityManagerWithChangeDetection",null,[1599]);const Dd=()=>{const e=A.a.crb(window.location.href.toLowerCase(),"wdomexsrctype");return!!e&&"4"===e},Xc=()=>A.a.crb(window.location.href.toLowerCase(),"wdtpl"),Jd=()=>{const e=A.a.crb(window.location.href.toLowerCase(),"wdomexsrctype");return!!e&&"1"===e},pf=e=>
{let t=null;switch(e){case 0:t="omex";break;case 1:t="spcatalog";break;case 2:t="spapp";break;case 3:t="filesystem";break;case 4:t="exchange";break;case 6:t="registry";break;case 7:t="inmemory";break;case 8:t="uploadfiledevcatalog";break;case 9:t="hardcodedpreinstall";break;case 10:t="excatalog";break;case 16:t="wopicatalog"}return t},Ce=e=>{let t=-1;switch(e.toLowerCase()){case "omex":t=0;break;case "spcatalog":t=1;break;case "spapp":t=2;break;case "filesystem":t=3;break;case "exchange":t=4;break;
case "registry":t=6;break;case "inmemory":t=7;break;case "uploadfiledevcatalog":t=8;break;case "hardcodedpreinstall":t=9;break;case "excatalog":t=10;break;case "wopicatalog":t=16}return t};class pc{Gcc(e,t=null){if(e=Xa.G1c(e)){appChrome.addInApi.dispatchActionsToInstallAddIn(e,t);for(const E of e.tabs)if(E.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(e,()=>{});break}}}Hsg(e){(e=Xa.G1c(e))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(e)}AOj(){}static mUl(e,t,E=null){e=pc.AIm(e);
0<e.length&&(pc.Dxe(e,!1),E&&E(t,e))}static AIm(e){const t=[];if(e&&(e=e.tDa,e.IJ&&0<e.IJ.count))for(const E of e.IJ)if(E.groups&&0<E.groups.length)for(const W of E.groups)if(W.controls&&0<W.controls.length)for(const ha of W.controls)Array.add(t,ha.id);return t}static Dxe(e){if(e.length){var t=[];for(const E of e)t.push(appChrome.actions.updateControlEnabledDisabledState(E,!0));appChrome.api.dispatch(t)}}}Object(y.a)(pc,"OneLineRibbonExtensibilityManager",null,[1599]);class $c{constructor(){this.Ver=
1}}Object(y.a)($c,"CacheItem",null,[]);class id{constructor(e){this.hW=e}}Object(y.a)(id,"AppsDataCacheManager",null,[1541]);var de=d(1425);class Ae{constructor(){new id(de.a.instance)}xMj(e,t){e=nc.a.Oyi()+e;de.a.instance.setItem(e,t.toString())}rGm(){var e=nc.a.sFi();z.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",e);e=de.a.instance.getItem(e);return qe.a(e)}TWo(e){const t=nc.a.sFi();z.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",t);de.a.instance.setItem(t,qe.c(e))}emn(){return!!de.a.instance.localStorage}static get instance(){Ae._instance||
(Ae._instance=new Ae);return Ae._instance}}Ae._instance=null;Object(y.a)(Ae,"AddInCommandsCacheManager",null,[1512]);var gf=d(95);class uf{static Szi(e){const t=new fa.a;if(uf.I5h)for(var E of uf.I5h)t.add(E);E=null;switch(e){case "Workbook":E=uf.wJp;break;case "Document":E=uf.aXl;break;case "Presentation":E=uf.cfo}if(E)for(const W of E)t.add(W);return t}}uf.I5h=["PrimaryCommandSurface","ContextMenu"];uf.wJp=null;uf.aXl=null;uf.cfo=null;Object(y.a)(uf,"ExtensionPointType",null,[]);class Lf{constructor(e){this.Nwh=
null;if(ab.c(e))throw z.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.Zmk=e}get Led(){return this.Nwh||(this.Nwh=new fa.a)}get nRh(){return this.Zmk}}Object(y.a)(Lf,"ContextMenuExtensibility",null,[1606]);class hg{constructor(e,t=null,E=0){if(ab.c(e))throw z.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");
this.uHk=e;this.KOk=t;this.wwk=E}get tDa(){return this.uHk}get startedNode(){return this.KOk}get wfm(){return this.wwk}}Object(y.a)(hg,"RibbonExtensibility",null,[1627]);class Vf{constructor(e){this.Juk=e.entitlement}get entitlement(){return this.Juk}createActionContext(e,t){e={};e.ownerAddinInfo=this.entitlement;e.action=t;return e}}Object(y.a)(Vf,"AddInCommandsContextProvider",null,[]);class ic{constructor(e,t,E){this.L8g=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=
this.commandSurface=null;this.ribbonBuilder=e;this.eventBuilder=t;this.contextMenuBuilder=E}get addinInfo(){return this.L8g}vEl(e){return new Vf(e)}createActionBuilder(e,t){return OfficeExt.DefaultControlActionBinder.createActionBuilder(e,t.entitlement,t.manifest)}startApplyAddin(e){this.L8g=e;const t=this.vEl(e);this.actionBuilder=this.createActionBuilder(t,e)}endApplyAddin(){}xGf(e,t,E=0){return this.ribbonBuilder.IJ&&0<this.ribbonBuilder.IJ.count?new hg(this.Vem(e,t),this.addinInfo.startedNode,
E):null}qsi(){var e=null;if(this.contextMenuBuilder.cke&&0<this.contextMenuBuilder.cke.count){e||(e=this.addinInfo.entitlement.solutionId);e=new Lf(e);for(const t of this.contextMenuBuilder.cke)e.Led.add(t);return e}return null}Vem(e,t){return this.ribbonBuilder.IJ&&0<this.ribbonBuilder.IJ.count?new Xa(this.ribbonBuilder.IJ,e,t):null}}Object(y.a)(ic,"AddinCommandsBuilder",null,[]);class yc{constructor(e,t,E,W,ha,Ka,sb){this.b1b=new gf.a;this.dH=e;this.au=t;this.B6=E;this.awc=W;this.qsf=ha;this.wdb=
Ka;this.Tcc=sb;this.pV=v.AFrameworkApplication.ua.hs}Wwn(e,t,E,W,ha,Ka,sb){const dc=(xc,Rc,md,ud)=>{ha(xc,Rc,md,ud);xc=fc[this.dH]+Rc.assetId;({value:Rc}=this.b1b.Dc(xc)).returnValue&&(Rc.stop(),this.b1b.remove(xc))};if(0!==this.dH&&e){z.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",e.count);4===this.dH&&(z.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",W)),this.Tql(e,W),Ka());for(const xc of e)if(e=xc,z.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",
this.B6.d0,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId))),this.xak(e))if(sb&&e.requireConsent)sb(e,Rc=>{try{if(this.pV){const ud=fc[this.dH]+Rc.solutionId,Ud=this.pV.Vf("ComponentAttach",ud);this.b1b.Z(ud,Ud)}const md=this.wdb.Iic(Rc.storeType,Rc.solutionId);6!==this.dH&&(md&&(this.$Vd(md),md.ZX.purge(!1)),this.au.insertOsfControl(this.Xhd(Rc,t,E,dc)),md&&this.au.ownerAddinControlRecreated(Rc.solutionId,Rc.storeType))}catch(md){z.ULS.sendTraceTag(572839882,
220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.B6.d0,Telemetry.PrivacyRules.GetPrivacyCompliantId(Rc.solutionId,Rc.ownerAddinStoreType||Rc.storeType,Rc.assetId,null,null,Rc.storeId),Rc.version,Rc.storeType,Rc.storeId,md.message)),dc(!1,Rc,null,null)}});else try{if(this.pV){const md=fc[this.dH]+e.solutionId,ud=this.pV.Vf("ComponentAttach",md);this.b1b.Z(md,ud)}const Rc=this.wdb.Iic(e.storeType,e.solutionId);
!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFAddinLaunchRefactor",!1)||3!==v.AFrameworkApplication.ua.Ib.Tk&&1!==v.AFrameworkApplication.ua.Ib.Tk&&2!==v.AFrameworkApplication.ua.Ib.Tk||3!==this.dH||"excatalog"===e.storeType||!Rc||Rc.isUpgraded?6!==this.dH&&(Rc&&(this.$Vd(Rc),Rc.ZX.purge(!1)),this.au.insertOsfControl(this.Xhd(e,t,E,dc)),Rc&&this.au.ownerAddinControlRecreated(e.solutionId,e.storeType)):(this.awc.AOj(Rc.kC),dc(!0,e,null,Rc.displayName))}catch(Rc){z.ULS.sendTraceTag(17388185,
220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.B6.d0,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId),e.version,e.storeType,e.storeId,Rc.message)),dc(!1,e,null,null)}else dc(!1,e,null,null)}}hxn(e,t,E,W,ha,Ka){const sb=(dc,xc,Rc,md)=>{Ka(dc,xc,Rc,md);dc=fc[this.dH]+xc.solutionId;({value:xc}=this.b1b.Dc(dc)).returnValue&&(xc.stop(),
this.b1b.remove(dc))};if(6===this.dH&&e)if(z.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.B6.d0,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId))),this.xak(e))try{if(this.pV){const xc=fc[this.dH]+e.solutionId,Rc=this.pV.Vf("ComponentAttach",xc);this.b1b.Z(xc,Rc)}const dc=this.wdb.Iic(e.storeType,e.solutionId);dc||sb(!1,e,null,null);v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Ib.lei?
this.Ssi(e,t,W,ha,E,xc=>{sb(xc,e,E,dc.displayName)}):(this.Ssi(e,t,W,ha,E),sb(!0,e,E,dc.displayName))}catch(dc){z.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.B6.d0,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId),e.version,e.storeType,e.storeId,dc.message)),sb(!1,e,null,null)}else sb(!1,
e,null,null)}PTn(e,t,E,W,ha,Ka){if(Ka)if(Ka._isAddinCommandsManifest(this.B6.d0))try{v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Ib.lei?this.Rsi(e,t,E,ha,Ka,sb=>{W(sb,e,Ka,Ka.getDefaultDisplayName())}):(this.Rsi(e,t,E,ha,Ka),W(!0,e,Ka,Ka.getDefaultDisplayName()))}catch(sb){z.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.B6.d0,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,
e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId),e.version,e.storeType,e.storeId,sb.message)),W(!1,e,Ka,Ka.getDefaultDisplayName())}else z.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.B6.d0,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId),e.version,e.storeType,e.storeId)),W(!1,
e,null,null);else z.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.B6.d0,Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId),e.version,e.storeType,e.storeId)),W(!1,e,null,null)}Xhd(e,t,E,W){const ha={},Ka=document.createElement("div");Ka.setAttribute("visible","false");ha.div=Ka;ha.id=e.solutionId;ha.solutionId=e.solutionId;
ha.version=e.version;ha.storeType=e.storeType;ha.storeId=e.storeId;ha.assetId=e.assetId;ha.assetStoreId=e.assetStoreId;ha.isvirtualOsfControl=!0;ha.virtualOsfControlActivationCallback=(sb,dc)=>{const xc=this.wdb.Iic(e.storeType,e.solutionId);xc&&(xc.isUpgraded&&(e.isUpgraded=!0),this.$Vd(xc));this.PTn(e,t,E,W,sb,dc)};ha.reason=3===this.dH?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return ha}Rsi(e,t,E,W,ha,Ka=null){const sb=
{};sb.solutionId=W.getSolutionId();sb.version=W.getVersion();sb.storeType=W.getStoreType();sb.storeId=W.getStoreId();sb.assetId=W.getAssetId();sb.assetStoreId=W.getAssetStoreId();sb.targetType=W.getOsfControlType();let dc=null,xc=null;if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))dc=(new OfficeExt.Parser.AddinCommandsManifestParser(this.B6.d0,this.B6.formFactor)).parseExtensions(sb,ha,this.Tcc),xc=uf.Szi(this.B6.d0);
else try{dc=(new OfficeExt.Parser.AddinCommandsManifestParser(this.B6.d0,this.B6.formFactor)).parseExtensions(sb,ha,this.Tcc),xc=uf.Szi(this.B6.d0)}catch(md){throw z.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+md.message),md;}if(xc&&0<xc.count){if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Rc=t(e);t=E(e);E=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AddinCommandsMultipleCustomTabsEnabled");
Rc=new ic(Rc,null,t);for(const md of xc)Rc.commandSurface=md,dc.apply(Rc,this.Tcc,E)}else try{const md=t(e),ud=E(e),Ud=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AddinCommandsMultipleCustomTabsEnabled");Rc=new ic(md,null,ud);for(const Id of xc)Rc.commandSurface=Id,dc.apply(Rc,this.Tcc,Ud)}catch(md){throw z.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+md.message),md;}if(OSF.OUtil.checkFlight(14))try{const md=Rc.xGf(e.solutionId,ha.getDefaultDisplayName()),
ud=Rc.qsi();md&&this.awc.Gcc(md,Ka);ud&&this.qsf.lNh(ud);this.wdb.YNh(W,md,ud,ha.getDefaultDisplayName());z.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",ha.getDefaultDisplayName())}catch(md){throw OfficeExt.DevConsole.log(md),z.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+md.message),md;}else try{const md=Rc.xGf(e.solutionId,ha.getDefaultDisplayName()),ud=Rc.qsi();md&&this.awc.Gcc(md);ud&&this.qsf.lNh(ud);this.wdb.YNh(W,md,ud,ha.getDefaultDisplayName());
z.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",ha.getDefaultDisplayName())}catch(md){throw z.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+md.message),md;}}}Ssi(e,t,E,W,ha,Ka=null){const sb={};sb.solutionId=e.solutionId;sb.version=e.version;sb.storeType=e.storeType;sb.storeId=e.storeId;sb.assetId=e.assetId;sb.assetStoreId=e.assetStoreId;sb.targetType=e.targetType;const dc=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.B6.d0,this.B6.formFactor);
try{const xc=t.getManifest(),Rc=dc.parse(sb,xc,ha,this.Tcc,t.getSharedRuntimeId(),t),md=E(e),ud=W(e),Ud=new ic(md,null,ud);Ud.commandSurface="PrimaryCommandSurface";Rc.apply(Ud,this.Tcc,!0);if(Ud.ribbonBuilder.IJ&&0<Ud.ribbonBuilder.IJ.count){const Id=Ud.xGf(e.solutionId,t.getManifest().getDefaultDisplayName(),1);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.awc.Gcc(Id,Ka):Id&&this.awc.Gcc(Id,Ka);this.wdb.NXk(t,Id,ha,
t.getManifest().getDefaultDisplayName());z.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",t.getManifest().getDefaultDisplayName())}}catch(xc){z.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",t.getManifest().getDefaultDisplayName(),xc.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(xc)}}$Vd(e){e.kC&&this.awc.Hsg(e.kC);e.UWc&&this.qsf.Kxo(e.UWc);this.wdb.fxo(e.ZX.getStoreType(),e.ZX.getSolutionId())}Tql(e,t){t=pf(t);
for(const E of this.wdb.inc){if(E.ZX.getStoreType()!==t)continue;let W=!0;for(const ha of e){const Ka=ha;if(Ka&&E.a2i(Ka.storeType,Ka.solutionId)){W=!1;break}}W&&(this.$Vd(E),E.ZX.purge(!1))}}xak(e){return!!e&&!!e.solutionId&&!!e.version&&!!e.storeType&&!!e.storeId}}Object(y.a)(yc,"AddInCommandsIntegration",null,[]);class bd{constructor(e,t,E,W,ha,Ka,sb,dc=null){this.sa=new ua.a;this.bQa=e;this.ask=t;this.tk=E;this.fJh=W;this.E$b=ha;this.Nmk=Ka;this.Mwd=sb;this.hGk=dc}K_k(e){this.sa.addHandler(nc.a.HQh,
e)}g0k(e){this.sa.addHandler(nc.a.l6i,e)}m2k(e){this.sa.addHandler(nc.a.STj,e)}S_k(e){this.sa.addHandler(nc.a.nkf,e)}Axn(e,t,E){const W=E[nc.a.WRd],ha=void 0===E[nc.a.oIa]?0:E[nc.a.oIa];if(W&&0!==ha)if(0>=W.count&&4!==ha)this.muj(new Oc(ha,null,null,t,null,!0));else{var Ka=W.count,sb=new ci(new pc),dc=void 0===E[nc.a.pIa]?-1:E[nc.a.pIa],xc=new yc(ha,this.tk,this.bQa,sb,this.ask,this.E$b,this.Mwd),Rc=Ee=>this.fJh.Dgl(Ee.solutionId,this.Mwd,this.bQa,e),md=Ee=>this.fJh.Afl(Ee.solutionId),ud=(Ee,kf,Ke)=>
{Ka--;Ke=new Oc(ha,kf,sb,t,Ke,0>=Ka);if(Ee&&kf)this.muj(Ke);else{if(3===ha||kf&&kf.isUpgraded)Ee="",kf&&(Ee=Telemetry.PrivacyRules.GetPrivacyCompliantId(kf.solutionId,kf.ownerAddinStoreType||kf.storeType,kf.assetId,null,null,kf.storeId)),kf={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:Ee},cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Sb.a.fI(kf)}));this.luj(Ke)}Ka||v.AFrameworkApplication.ua.Ie()},
Ud=(Ee,kf,Ke,dh)=>{ud(Ee,kf,dh)},Id=()=>{this.Pcg();0>=W.count&&4===ha&&this.E$b.Azg()};6===ha?(dc=E[nc.a.MYl],E=E[nc.a.NYl],xc.hxn(W.J(0),dc,E,Rc,md,(Ee,kf,Ke,dh)=>{ud(Ee,kf,dh)})):xc.Wwn(W,Rc,md,dc,Ud,Id,this.hGk)}else cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Sb.a.fI({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),z.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",
this.bQa.d0)),this.luj(new Oc(ha,null,null,t,null,!0))}luj(e){this.Pcg(e);this.QUj(!1,e)}muj(e){const t=e.Hq;let E=null;null!==t&&(E=t.storeType,E=E.toLowerCase());if(e&&"omex"===E&&(3===e.dH||t.isUpgraded)){var W={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(t.solutionId,t.ownerAddinStoreType||t.storeType,t.assetId,null,null,t.storeId)};cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:Sb.a.fI(W)}))}this.Pcg(e);W=Jd()&&"omex"===E&&!!e.dEa&&!!t.solutionId&&2===e.dH&&t.solutionId.toLowerCase()===Xc().toLowerCase();var ha="excatalog"===E&&3===e.dH;if("omex"===E&&e.dEa&&(3===e.dH&&"hardcodedpreinstall"!==E||t.isUpgraded)||W||ha)W=new Gc,W.Hq=t,W.kC=e.dEa.dUb,this.sa.raiseEvent(nc.a.nkf,W);W=Dd();ha=Xc();W&&t&&"excatalog"===t.storeType&&e.dEa&&5===e.dH&&ha&&(t.storeId&&t.storeId.toLowerCase()===ha.toLowerCase()||t.assetId&&t.assetId.toLowerCase()===ha.toLowerCase())&&(W=new Gc,
W.Hq=t,W.kC=e.dEa.dUb,this.sa.raiseEvent(nc.a.nkf,W),z.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));t&&(Ae.instance.xMj(Ce(E),!0),"uploadfiledevcatalog"===E&&(W=this.Nmk.createAddinDataProvider(E,this.tk))&&W.localCacheAddinCommands(this.tk.cZa,t.solutionId,t.version,t.storeId),Vb.dAb(nc.a.chf,"true",Ce(E)));this.QUj(!0,e)}QUj(e,t){e?t.dEa&&5===t.dH&&t.dEa.dUb&&void 0!==t.Hq.showCallout&&null!==t.Hq.showCallout&&t.Hq.showCallout?((new mg(this.sa)).iRd(t.Hq,Xa.G1c(t.dEa.dUb)),
e=new Gc,e.kC=t.dEa.dUb,e.Hq=t.Hq,this.sa.raiseEvent(nc.a.STj,e)):3!==t.dH?t.y5i&&this.E$b.Azg():t.dEa&&t.dEa.dUb&&"hardcodedpreinstall"!==t.Hq.storeType&&cb.D5o(t.displayName,t.dEa.dUb,t.Hq.isAutoLaunched):3===t.dH?t.Hq&&"uploadfiledevcatalog"===t.Hq.storeType.toLowerCase()?(t=this.Mwd.lrm(t.Hq.solutionId),cb.iDg(t?t:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.E$b.ZSo():t.y5i&&this.E$b.Azg()}Pcg(e=null){var t=e?e.Hq:null;const E=new Gc;if(E.Hq=t){var W=this.E$b.Iic(t.storeType,
t.solutionId,6===e.dH?1:0);if(W&&W.kC){E.kC=W.kC;var ha=Xc();ha=Jd()&&!!t.solutionId&&!!ha&&t.solutionId.toLowerCase()===ha.toLowerCase()&&2===e.dH;if(3===e.dH&&"hardcodedpreinstall"!==t.storeType||ha)e="",W.kC.tDa&&W.kC.tDa.IJ&&(W=W.kC.tDa.IJ.J(0))&&(e=W.id),t={["SDX_CommandPlacement"]:e,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(t.solutionId,t.ownerAddinStoreType||t.storeType,t.assetId,null,null,t.storeId)},cc.a.sendTelemetryEvent(Object.assign(new cg.a,
{name:"Office.Extensibility.Host.AppPinning",dataFields:Sb.a.fI(t)}))}}this.sa.raiseEvent(nc.a.HQh,E)}}Object(y.a)(bd,"LaunchAddinCommandsHandler",null,[1605]);class sd{constructor(e){this.IHk=e}get cZa(){return this.IHk}insertOsfControl(e){return this.cZa.insertOsfControl(e)}getManifestInvaildErrorString(){return this.cZa.getManifestInvaildErrorString()}isAddinCommandsAsync(e,t){this.cZa.isAddinCommandsAsync(e,t)}isAddinCommandsExAsync(e,t){this.cZa.isAddinCommandsExAsync(e,t)}ownerAddinControlRecreated(e,
t){this.cZa.ownerAddinControlRecreated(e,t)}queryEntitlementDetails(e){this.cZa.queryEntitlementDetails(e)}}Object(y.a)(sd,"ContextActivationMgrWrapper",null,[1607]);class ie{}ie.cgb="Alt";ie.m1a="Command";ie.id="Id";ie.jgb="Image16by16";ie.kgb="LabelText";ie.r1a="Title";ie.WHe="Groups";ie.RAb="Controls";ie.button="Button";ie.pKa="FlyoutAnchor";Object(y.a)(ie,"AddinDataNodeConstants",null,[]);var We=d(218),Pe=d(818),Re=d(439),Sf=d(142);class vg{constructor(e,t){this.I3a=this.Nch=null;if(ab.c(e)||
ab.c(t))throw z.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.COe=t;this._id=e;this.r_[ie.id]=this._id}get id(){return this._id||""}get r_(){return this.Nch||(this.Nch={})}get controlType(){return this.COe||""}get menuItems(){return this.I3a||(this.I3a=new fa.a)}Zrd(){let e=null;this.COe===ie.pKa?e=Object.assign(new Pe.a,{Menu:this.RKn()}):this.COe===ie.button&&(e=Object.assign(new We.a,
{}));e&&(this.r_[ie.id]&&(e.ExternalId=this.r_[ie.id]),this.r_[ie.m1a]&&(e.Command=this.r_[ie.m1a].toString()),this.r_[ie.kgb]&&(e.LabelText=this.r_[ie.kgb]),this.r_[ie.cgb]&&(e.Alt=this.r_[ie.cgb]),this.r_[ie.jgb]&&(Sf.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.r_[ie.jgb]),e.ExternalImageId=this._id));return e}RKn(){const e=Object.assign(new Re.a,{UpdateDynamically:!0,MenuSectionList:[]});if(this.I3a){const t=Object.assign(new Ca.a,{ControlList:[]});
for(const E of this.I3a)Array.add(t.ControlList,E.Zrd());Array.add(e.MenuSectionList,t)}return e}}Object(y.a)(vg,"ControlDefinition",null,[1556]);class Yg{constructor(e){this.Qxa=null;if(ab.c(e))throw z.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=e;this.wdd[ie.id]=this._id}get wdd(){return this.Qxa||(this.Qxa={})}get id(){return this._id||""}Zrd(){const e=Object.assign(new We.a,
{});this.Qxa[ie.id]&&(e.ExternalId=this.Qxa[ie.id]);this.Qxa[ie.m1a]&&(e.Command=this.Qxa[ie.m1a].toString());this.Qxa[ie.kgb]&&(e.LabelText=this.Qxa[ie.kgb]);this.Qxa[ie.cgb]&&(e.Alt=this.Qxa[ie.cgb]);this.Qxa[ie.jgb]&&(Sf.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.Qxa[ie.jgb]),e.ExternalImageId=this._id);return e}}Object(y.a)(Yg,"MenuItemDefinition",null,[1555]);class ph{constructor(e){this.JQa=null;if(ab.c(e))throw z.ULS.sendTraceTag(9175314,220,
10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=e}get id(){return this._id}get controls(){return this.JQa||(this.JQa=new fa.a)}Zrd(){const e=[];if(this.JQa)for(const t of this.JQa){const E=t.Zrd();E&&e.push(E)}return e}}Object(y.a)(ph,"OfficeMenuDefinition",null,[1554]);class Di{constructor(e,t,E){this.Q9=this.Q5b=null;this.C1e=e;this.r5b=t;this.Y3b=E;this.KEk=new fa.a}get ele(){return this.C1e}get fWc(){return this.r5b}get Xdf(){return this.Y3b}addButton(e){z.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",e.actionType);this.Q9=new vg(this.Smb(e.id),ie.button);this.Q9.r_[ie.kgb]=e.label;this.Q9.r_[ie.cgb]=e.label;this.Q9.r_[ie.jgb]=e.icon["16"];this.XTc(this.Q9.r_[ie.id],e.action);this.RJb(this.Q9.r_);this.Q5b.controls.add(this.Q9);this.Q9=null}startBuildMenu(e){if(ab.c(this.Q5b))this.Q5b=new ph(e.id);else{const t=this.Smb(e.id);this.Q9=new vg(t,ie.pKa);this.dec(this.Q9.r_,e);this.Q9.r_[ie.jgb]=e.icon["16"];this.Q9.r_[ie.m1a]=M.a.mza}}addMenuItem(e){z.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",e.actionType);const t=new Yg(this.Smb(e.id));this.dec(t.wdd,e);e.icon&&(t.wdd[ie.jgb]=e.icon["16"]);this.XTc(t.wdd[ie.id],e.action);this.RJb(t.wdd);this.Q9.menuItems.add(t)}endBuildMenu(){ab.c(this.Q9)?(this.cke.add(this.Q5b),this.Q5b=null):(this.Q5b.controls.add(this.Q9),this.Q9=null)}get cke(){return this.KEk}XTc(e,t){this.Xdf.bindAction(e,t)}RJb(e){this.fWc.RJb(e)}Smb(e){return this.ele.Ojc(e)}dec(e,t){e[ie.kgb]=t.label;e[ie.cgb]=t.label}}Object(y.a)(Di,
"ContextMenuExtensibilityCreator",null,[1543,1536]);class bj{constructor(e){this.XLc=e}get Zdd(){return this.XLc}Ojc(e){return this.Zdd+e}}Object(y.a)(bj,"DefaultContextMenuNamingProvider",null,[1542]);class gi{constructor(e,t,E,W){this.XLc=e;v.AFrameworkApplication.K.$("AddInCommandsMissingTabIsEnabled")&&E.Pzm();this.YFh=t;this.zNk=W}get Zdd(){return this.XLc}get solutionId(){return this.YFh}get xCg(){return this.zNk}Ojc(e){e=this.Zdd+this.solutionId+e;return this.xCg?(e in gi.ZRd||(gi.ZRd[e]="AddinControl"+
gi.G2k++),gi.ZRd[e]):e}Sci(e){if(this.xCg){const E=gi.ZRd;for(const W in E){var t=W;if(e===E[W])return t.substr(this.Zdd.length+this.solutionId.length)}}return e}JMm(e){e=this.Zdd+this.solutionId+e;return this.xCg?(e in gi.ohf||(gi.ohf[e]="AddinTab"+gi.O2k++),gi.ohf[e]):e}}gi.ZRd={};gi.ohf={};gi.O2k=0;gi.G2k=0;Object(y.a)(gi,"DefaultRibbonNamingProvider",null,[1539]);class Zg{bindAction(e,t){OfficeExt.DefaultControlActionBinder.bindAction(e,t)}}Object(y.a)(Zg,"DefaultUIControlActionBinder",null,[1540]);
class Bb{constructor(e){this.XBb=e}get command(){return this.XBb}RJb(e){e[ie.m1a]=this.command}}Object(y.a)(Bb,"DefaultUIControlCommandBinder",null,[1538]);var Nb=d(53);class Bc{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(y.a)(Bc,"AddInControl",null,[]);class td{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(y.a)(td,"AddInGroup",null,[]);class Je{constructor(){this.iconLocation=
this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(y.a)(Je,"AddInMenuItem",null,[]);class Ef{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(y.a)(Ef,"AddInTab",null,[]);class Ih{constructor(e,t,E,W,ha,Ka){this.Hwd=new fa.a;this.EFc=this.d2a=this.T5b=null;this.C1e=e;this.Y3b=t;this.r5b=E;this.YFh=W;this.Mwd=ha;this.qhh=Ka}get ele(){return this.C1e}get IJ(){return this.Hwd}get Xdf(){return this.Y3b}get fWc(){return this.r5b}startBuildTab(e){const t=
e.isOfficeTab?e.id:this.ele.JMm(e.id),E=e.isOfficeTab?null:e.label;this.T5b=Object.assign(new Ef,{id:t,title:E,isOfficeTab:e.isOfficeTab,visible:e.visible,groups:[],tabType:e.tabType,insertBefore:e.insertBefore,insertAfter:e.insertAfter,autoFocus:e.autoFocus})}startBuildGroup(e){const t=this.Smb(e.id);this.d2a=Object.assign(new td,{id:t,mlrId:e.mlrId,title:e.label,controls:[],groupType:0})}addNativeGroup(e){this.d2a=Object.assign(new td,{id:e.id,mlrId:e.mlrId,title:e.label,controls:[],groupType:1});
this.T5b.groups.push(this.d2a)}addButton(e){const t=this.Smb(e.id);t&&(this.XTc(t,e.action),z.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",e.actionType),e=Object.assign(new Bc,{id:t,title:e.label,iconLocation:this.MKf(e),enabled:e.enabled,controlType:0,attributes:this.dec()}),this.qhh.MMh(new Nb.a(t,this.fWc.command.toString())),this.d2a.controls.push(e))}addNativeControl(e){e.id&&(z.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",
e.actionType),e=Object.assign(new Bc,{id:e.id,title:"",iconLocation:"",enabled:e.enabled,controlType:2,attributes:this.dec()}),this.d2a.controls.push(e))}startBuildMenu(e){const t=this.Smb(e.id);t&&(this.EFc=Object.assign(new Bc,{id:t,title:e.label,iconLocation:this.MKf(e),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(e){const t=this.Smb(e.id);t&&(this.XTc(t,e.action),z.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",e.actionType),e=Object.assign(new Je,
{id:t,title:e.label,iconLocation:this.MKf(e),enabled:e.enabled,attributes:this.dec()}),this.qhh.MMh(new Nb.a(t,this.fWc.command.toString())),this.EFc.menuItems.push(e))}endBuildMenu(){ab.c(this.EFc.id)||this.d2a.controls.push(this.EFc);this.EFc=null}endBuildGroup(){ab.c(this.d2a.id)||this.T5b.groups.push(this.d2a);this.d2a=null}endBuildTab(){ab.c(this.T5b.id)||this.Hwd.add(this.T5b);this.T5b=null}dec(){const e={};this.RJb(e);return e}MKf(e){return e.icon["80"]?e.icon["80"]:e.icon["32"]}RJb(e){this.fWc.RJb(e)}Smb(e){return this.ele.Ojc(e)}XTc(e,
t){this.Xdf.bindAction(e,t)}}Object(y.a)(Ih,"OneLineRibbonExtensibilityCreator",null,[1535,1536]);class tg{constructor(e,t){this.XLc=e;this.Y3b=new Zg;this.r5b=new Bb(t)}Afl(e){e=new bj(e);return new Di(e,this.r5b,this.Y3b)}Dgl(e,t,E,W){E=new gi(this.XLc,e,E,!0);return new Ih(E,this.Y3b,this.r5b,e,t,W)}}Object(y.a)(tg,"UIExtensibilityFactory",null,[1518]);class Dh{createAddinDataProvider(e,t){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(e,t.cZa)}static get instance(){Dh._instance||
(Dh._instance=new Dh);return Dh._instance}}Dh._instance=null;Object(y.a)(Dh,"OSFAddinDataProviderFactory",null,[1604]);class Jh{constructor(){this.Ucc=null}setErrorMessageForAddin(e,t){this.Ucc||(this.Ucc={});this.Ucc[e]=t}lrm(e){return this.Ucc&&e in this.Ucc?this.Ucc[e]:null}}Object(y.a)(Jh,"AddinCommandsErrorManager",null,[]);var Xh=d(140);class Mf{constructor(){this.bga=0;this.BUc=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.gPi=!1;this.s2m=this.asa=null}}Object(y.a)(Mf,
"AddInCommandsNotificationParameters",null,[]);class Jg{constructor(){this.d$g=this.QJe=null;this.ORi=(e,t)=>{let E=null;E=()=>{e.getIsUpgrading()?window.setTimeout(E,1E3):e.getUpgradingFailed()?pc.Dxe(t,!0):v.AFrameworkApplication.ua.Ie()};window.setTimeout(E,1E3)}}get Ydf(){return this.QJe||(this.QJe=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set Ydf(e){this.QJe=e}get ibl(){return this.d$g||(this.d$g=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(e,
t){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(e,t)}$Tm(e,t,E,W,ha){z.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",e);if((e=t.Iic(ha.ownerAddinInfo.storeType,ha.ownerAddinInfo.solutionId))&&e.ZX&&!e.ZX.getIsUpgrading())if(t=null,0<e.ZX.getNotificationParams().length&&(t=this.hYh(e.ZX.getNotificationParams()[0]))&&2147758681===t.errorCode&&(e.isUpgraded=!0),2!==e.ZX.getStatus()&&(1!==e.ZX.getStatus()||t&&2147758681===t.errorCode))t&&this.OTj(e,t,null);
else try{E.setOwnerAddinEToken(e.ZX.getEToken()),ha.action(E,W.cZa)}catch(Ka){z.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Ka.stack:Ka.message)),cb.iDg(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}OTj(e,t,E=null){const W=e.ZX;if(1===W.getNotificationParams().length||t.gPi){const ha=t.BUc,Ka=t.asa;t.BUc=()=>{W.removeFirstNotification();
if(0<W.getNotificationParams().length){const sb=this.hYh(W.getNotificationParams()[0]);this.OTj(e,sb)}2147758681===t.errorCode&&(pc.mUl(e.kC,W,this.ORi),xa.$Tl(e.UWc,W,this.ORi));ha&&ha()};t.asa=()=>{Ka&&Ka();E&&E()};cb.o5o(t)}}hYh(e){const t=new Mf;t.bga=e.infoType;t.id=e.id;t.title=e.title;t.description=e.description;t.buttonText=e.buttonTxt;t.BUc=e.buttonCallback;t.gPi=e.highPriority;t.asa=e.dismissCallback;t.errorCode=e.errorCode;t.s2m=e.iframeNotificationUrl;return t}}Object(y.a)(Jg,"AddinCommandsActionHandler",
null,[1581]);var ug=d(663);class ze{constructor(){this.dH=this.Vcb=0;this.dhf=null;this.vre=this.EDe=0;this.mhb=this.tTe=this.nKe=null}get YRd(){this.nKe||(this.nKe=new fa.a);return this.nKe}get YFf(){this.tTe||(this.tTe=new fa.a);return this.tTe}get cMb(){this.mhb||(this.mhb=new fa.a);return this.mhb}}Object(y.a)(ze,"AddinCommandsListLoaderContext",null,[]);class pi{constructor(e,t){this.entitlement=e;this.metadata=t}aAc(){var e=this.entitlement;const t={};t.solutionId=e.solutionId;t.version=e.version;
t.storeType=e.storeType;t.storeId=e.storeId;t.assetId=e.assetId;t.assetStoreId=e.assetStoreId;t.targetType=e.targetType;t.requireConsent=e.requireConsent||!1;t.isAddinCommands=!0;t.addinCommandsActionType=0;t.targetType=this.targetType;return t}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(y.a)(pi,"AddinEntitlementEx",null,[]);class og extends Sys.EventArgs{constructor(e){super();this.properties=e}}Object(y.a)(og,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class Jk{constructor(e,t,E){this.ed=new ua.a;this.context=
new ze;this.qaf=null;this.oZn=(W,ha,Ka,sb)=>{W?(W=new pi(Ka.targetData,sb),ha&&this.context.YRd.add(W),10===this.context.Vcb&&(this.context.YFf.add(W),0===W.targetType&&this.context.cMb.add(W))):(ha=Ka.targetData,z.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ha.solutionId,ha.storeType,ha.assetId,null,null,ha.storeId),ha.storeType));this.Ddg()};this.contextActivationMgr=e;this.H2k=t;this.XRd=E;this.appName=v.AFrameworkApplication.K.kb("WebAppShortName")}get K_j(){this.qaf||
(this.qaf=new mg(this.ed));return this.qaf}J_k(e){this.ed.addHandler(nc.a.GQh,e)}eqp(e){null!==e&&(this.context.Vcb=e[nc.a.pIa],this.context.dH=e[nc.a.oIa],this.context.EDe=this.context.vre=0,e=nc.a.Wcc in e?e[nc.a.Wcc]:0,-1!==this.context.Vcb&&0!==this.context.dH&&(this.context.dhf=this.H2k.createAddinDataProvider(pf(this.context.Vcb),this.contextActivationMgr),this.context.dhf?this.context.dhf.getEntitlementsAsync(this.contextActivationMgr.cZa,!0,e,t=>{this.LZn(t)}):z.ULS.sendTraceTag(17638145,
220,10,"Create AddinDataProvider fails for {0}",this.context.Vcb)))}LZn(e){if(e&&0<e.length){this.context.EDe=e.length;const E=Xc();for(let W=0;W<e.length;W++){const ha=e[W];if(Jd()&&ha&&ha.storeType&&"omex"===ha.storeType.toLowerCase()&&ha.assetId&&E&&ha.assetId.toLowerCase()===E.toLowerCase()){var t={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:Jk.z7(ha)};cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Sb.a.fI(t)}))}!ha||1!==ha.targetType&&
-1!==ha.targetType?this.Ddg():(t={},v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(t.solutionId=ha.solutionId,t.version=ha.version):(t.marketplaceId=ha.solutionId,t.marketplaceVersion=ha.version),t.storeType=ha.storeType,t.storeId=ha.storeId,t.targetData=ha,this.contextActivationMgr.isAddinCommandsExAsync(t,this.oZn))}}else this.Ddg()}Ddg(){var e;(e=this.context).vre=e.vre+1;this.context.vre>=this.context.EDe&&
(this.XRd.xMj(this.context.Vcb,!1),0<this.context.EDe&&10===this.context.Vcb&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(e=!1,Dd()&&(e=this.ECn(this.context.YFf)),this.MBn(this.context.YFf),e?this.FZa(this.a6h(this.context.YRd)):this.K_j.yAc(this.contextActivationMgr,this.context.YRd,this.context.cMb,(t,E)=>{const W=new fa.a;for(const ha of t)t=ha.aAc(),E&&E.solutionId===ha.solutionId&&(t.showCallout=!0,this.K_j.Z8j(E)),W.add(t);this.FZa(W)})):this.FZa(this.a6h(this.context.YRd)))}a6h(e){const t=
new fa.a;if(e)for(const E of e)t.add(E.aAc());return t}FZa(e){e&&e.count||Vb.dAb(nc.a.chf,"false",this.context.Vcb);e={["ack2"]:e};e[nc.a.pIa]=this.context.Vcb;e[nc.a.oIa]=this.context.dH;this.ed.raiseEvent(nc.a.GQh,new og(e),this)}ECn(e){let t=!1;if(e&&1>e.count)return t;const E=Xc();if(!E)return t;for(const W of e)if(W.storeId&&W.storeId.toLowerCase()===E.toLowerCase()||W.assetId&&W.assetId.toLowerCase()===E.toLowerCase())e={["SDX_Id"]:Jk.rFi(W),["SDX_TargetType"]:ab.c(W.targetType)?"":W.targetType.toString()},
cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Sb.a.fI(e)})),t=!0;return t}MBn(e){if(!(e&&1>e.count))if(this.XRd.emn()){var t=this.XRd.rGm();t?(e=this.Swi(e,t),z.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(e=this.Swi(e,null),z.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.XRd.TWo(e)}else z.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}Swi(e,t){const E={};let W=!1;for(const ha of e)if(e=
Jk.rFi(ha))!t||e in t||(this.GI(ha,e),z.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===e.toLowerCase()?W||(W=!0,E[e]=null):E[e]=null;return E}GI(e,t){var E=e.installTimeInMS?(new Date(e.installTimeInMS)).toISOString():"";E={["SDX.Id"]:t,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:ab.c(e.targetType)?"":e.targetType.toString(),["SDX.AdminDeploymentTime"]:E};cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:Sb.a.fI(E)}));1===e.targetType&&(e={["SDX.Id"]:t,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Sb.a.fI(e)})))}static z7(e){return Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.storeType,e.assetId,null,null,e.storeId)}static rFi(e){return Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.storeType,e.assetId,null,null,e.storeId)}}Object(y.a)(Jk,
"AddInCommandsListLoader",null,[]);var zk;(function(e){e[e.Dbe=0]="inactive";e[e.background=1]="background"})(zk||(zk={}));Object(y.b)("AppBackgroundState",zk);var Xf=d(8),Gg=d(13),Lg=d(82),ak=d(122);class Rf{}Rf.text=1;Rf.image=2;Rf.table=4;Object(y.a)(Rf,"ContentCatagory",null,[]);class Bg{}Object(y.a)(Bg,"AddinCommandsHost",null,[]);var bk=d(182),Kk=d(33);class Pi extends bk.a{constructor(){super(void 0,void 0,void 0,!0);this.pGc="AddinCommandsUILessDialog";this.bbf="WACDialogTitleText";this.Twa=
"0";this.H1=380;this.fZ=190;this.Qg=this.pGc;this.Gd=5;this.Erk=String.format("{0}px",this.H1);this.Swa=String.format("{0}px",this.fZ);this.qNi=this.Du=!1;this.gV()}gV(){super.gV();this.Nq.style.width=this.Erk;this.Nq.style.height=this.Swa;this.Nq.style.padding=this.Twa}u_a(e){this.WN();document.getElementById(this.Sj(this.bbf)).innerText=e}WN(){super.WN();this.Oc.style.width=String.format("{0}px",this.H1);this.Oc.style.height=String.format("{0}px",this.fZ);this.Oc.removeAttribute(Kk.a.Ph);this.Oc.removeAttribute(Kk.a.Kja)}hide(){this.Kae()}get Cob(){return this.Nq}initializeAndShowWithTitle(){this.pi(CommonUIStrings.l_NotificationUITitle,
null,null)}}Object(y.a)(Pi,"AddinCommandsUILessDialog",bk.a,[1609]);class Uj extends Bg{constructor(e,t){super();this.Ch=e;this.UId=t}setOwnerAddinEToken(e){this.UId.eToken=e}showTaskpane(e,t,E){z.ULS.sendTraceTag(19507426,220,50,"ShowTaskpane action called.");t=this.ggl(e,this.UId,t);t.addinCommandsActionType=2;this.Ch.dSb(t);(e=this.Ch.BVa(e.solutionId))?(E(e,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess),v.AFrameworkApplication.K.isChangeGateEnabled("TelemetryForActiveAddinSuccessOnWordWacEnabled")&&
z.ULS.sendTraceTag(526410901,220,50,"ShowTaskpane: succeed to call.")):(z.ULS.sendTraceTag(19507427,220,10,"ShowTaskpane: instance id is null."),E(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}showDialog(){}createUILessSandbox(e,t,E){z.ULS.sendTraceTag(19509248,220,50,"UILess action called.");var W=e.solutionId,ha=this.UId.solutionId;const Ka=this.getSharedRuntimeId(t,!0,W,ha);W=Ka?ha:W;ha=this.Ch.BVa(W);ha||(e=this.jfl(e,this.UId),e.addinCommandsActionType=3,e.isForUILessAction=!0,
e.sharedRuntimeId=Ka,e.solutionId=W,t=t.getDefaultDisplayName(),Uj.zbc.Z(e.id,new Pi),e.div=Uj.zbc.J(e.id).Cob,this.Ch.createUILessSandbox(W,t,e),ha=this.Ch.BVa(W));ha?E(ha,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):(z.ULS.sendTraceTag(19509249,220,10,"UILess: instance id is null."),E(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}disposeHost(){}ggl(e,t,E){const W={};W.solutionId=e.solutionId;W.version=e.version;W.storeType=e.storeType;W.storeId=e.storeId;W.assetId=e.assetId;W.assetStoreId=
e.assetStoreId;W.targetType=OSF.OsfControlTarget.TaskPane;W.displayName=E.getDefaultDisplayName();W.ownerAddinSolutionId=t.solutionId;W.ownerAddinStoreType=t.storeType;W.isAddinCommands=!0;W.sharedRuntimeId=this.getSharedRuntimeId(E,!1,e.solutionId,t.solutionId);v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.SharedRuntimeParameterRefactoring")&&W.sharedRuntimeId&&(W.solutionId=W.ownerAddinSolutionId,W.storeType=W.ownerAddinStoreType);return W}getSharedRuntimeId(e,t,E,
W){if(!e)return null;const ha=ob.a.instance.resolve("CommandUI.AddInCommands.IAddinCommandsStringProvider");if(!ha)return null;if(t)return e.getSharedRuntimeId(ha.d0,t,null);E=(new gi("",W,ha,!0)).Sci(E.substr(W.length));return e.getSharedRuntimeId(ha.d0,t,E)}jfl(e,t){var E=Hb.a.create().toString();E=new Wb.a(E,e.solutionId,e.version,e.storeId,e.storeType,{});E.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;E.osfControlType=OSF.OsfControlTarget.TaskPane;E.assetId=e.assetId;E.assetStoreId=
e.assetStoreId;E.ownerAddinSolutionId=t.solutionId;E.ownerAddinStoreType=t.storeType;E.isAddinCommands=!0;return E}static DOa(e){Uj.zbc.mb(e)&&Uj.zbc.J(e).initializeAndShowWithTitle()}static fLa(e){Uj.zbc.mb(e)&&Uj.zbc.J(e).hide()}}Uj.zbc=new gf.a;Object(y.a)(Uj,"Box4AddInCommandsHost",Bg,[]);class jk{constructor(e){this.iKb=this.Bea=this.Hq=this.kC=null;this.jDj=this.lsg=0;this.kBb=this.appName=null;this.Jcb=t=>{z.ULS.sendTraceTag(523319329,306,10,"failed to POST data to Roaming Settings Service with status: {0}",
t?t.He:-1)};this.cff=e;this.appName=v.AFrameworkApplication.K.kb("WebAppShortName")||"Word"}static GetPrivacyCompliantId(e){return Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.storeType,e.assetId,null,null,e.storeId)}AZn(){this.Hq&&this.iKb&&(this.cff.O$d({["SourceControlId"]:this.iKb}),z.ULS.sendTraceTag(529110620,220,50,"Launch addin command has been triggered"))}mDg(e,t){e=null;t?(e=t,this.Hq=e.Hq,(this.kC=e.kC)&&this.kC.tDa&&this.kC.tDa.IJ&&(this.Bea=this.kC.tDa.IJ.J(0)),this.Bea&&
this.Bea.id?this.Bea.isOfficeTab?(t=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),e=this.Hq.solutionId,e in t?this.iKb=t[e]:(z.ULS.sendTraceTag(529110622,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",jk.GetPrivacyCompliantId(this.Hq)),this.iKb=this.TGf(this.kC)),this.iKb?"TabHome"===this.Bea.id?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Xa.G1c(this.kC),()=>{this.gAe(this.G9a(this.iKb))}):v.AFrameworkApplication.va.ra(M.a.g0a,
na.a.application,Object(ib.a)(this,this.g0a,"tabSwitch2")):(this.GI("NoEnabledButtonFound"),z.ULS.sendTraceTag(529110623,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),this.rrc())):this.lVj(this.G9a(this.Bea.id),0):(this.GI("NoTabFound"),z.ULS.sendTraceTag(529110621,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.rrc())):this.rrc()}g0a(e,t,E,W,ha){this.Bea.id.includes(ha.NewContextId)&&(v.AFrameworkApplication.va.Zw(M.a.g0a,na.a.application,
Object(ib.a)(this,this.g0a,"tabSwitch2")),this.l2h(ha.NewContextId,v.AFrameworkApplication.K.ic("AddinMaxTabSwitchDetectionTimesForTeachingUI",10)));return 32}l2h(e,t){if(0>=t)this.GI("TabSwitchTimeOut");else{var E=document.querySelector("button"+this.G9a(e));E.hasAttribute("aria-selected")&&"false"!==E.getAttribute("aria-selected")?(window.clearTimeout(this.jDj),this.gAe(this.G9a(this.iKb))):this.jDj=window.setTimeout(()=>{this.l2h(e,t-1)},1E3)}}G9a(e){return"[id="+e+"]"}lVj(e,t){t>v.AFrameworkApplication.K.ic("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)?(window.clearTimeout(this.lsg),this.Zpd("[data-unique-id='pivotOverflowButton']"),z.ULS.sendTraceTag(529110624,220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time")):document.querySelector("button"+e)?(window.clearTimeout(this.lsg),this.Zpd(e)):this.lsg=window.setTimeout(()=>{this.lVj(e,t+1)},1E3)}gAe(e){let t=document.querySelector("button[data-unique-id='RightPaddle']");if(t)this.GI("RightPaddlePresent");else if(t=document.querySelector("button"+e),!t||"none"===window.getComputedStyle(t).display)if(t=
document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!t){this.GI("NoAnchor");z.ULS.sendTraceTag(529110625,220,15,"ShowTeachingCalloutToAddinButton failed to get an anchorElement");this.rrc();return}this.$zb(t,"ShowTeachingUIForAddinButton")}Zpd(e){let t=document.querySelector("button"+e);if(!t&&("[data-unique-id='pivotOverflowButton']"!==e&&(t=document.querySelector("button[data-unique-id='pivotOverflowButton']")),!t)){this.GI("NoAnchor");z.ULS.sendTraceTag(529110626,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");
this.rrc();return}this.$zb(t,"ShowTeachingUIForAddinTab")}$zb(e,t){e.setAttribute("lpp-id","latestAddin");const E=ob.a.instance.Qa("Common.ISystemInitiatedFeedback");E&&e?(E.execute(W=>{W.logActivity(t,null)}),this.GI("Show"),z.ULS.sendTraceTag(529110656,220,50,"triggerLPPActivity triggered an LPP activity")):(this.GI("NoSifFutureObject"),z.ULS.sendTraceTag(529110627,220,15,"triggerLPPActivity failed to get a sifFuture"),this.rrc())}TGf(e){if(!e)return null;if((e=e.tDa)&&e.IJ&&0<e.IJ.count)for(const t of e.IJ)if(t.groups&&
0<t.groups.length)for(const E of t.groups)if(E.controls&&0<E.controls.length)for(const W of E.controls){if(W.attributes&&!W.controlType&&W.enabled)return W.id;if(W.menuItems)for(const ha of W.menuItems)if(ha.attributes&&ha.enabled)return W.id}return null}GI(e){cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:[{name:"AppTeachingUICalloutAction",string:e},{name:"SDX.Id",string:jk.GetPrivacyCompliantId(this.Hq)},{name:"AppTeachingUICalloutGoal",
string:"NewAdminDeployment"},{name:"SDX.AppInstallOrigin",string:"Organization"}]}))}mwe(e){const t={},E={};E.LastTeachingUIShowTime=(new Date).toUTCString();E.AddinHasShown=e;t[this.appName]=qe.c(E);this.kBb=new Cd(this.appName,null,null,this.Jcb),this.kBb.r2d(t),z.ULS.sendTraceTag(523319328,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}rrc(){this.mwe(window.g_roamingAddinList)}}Object(y.a)(jk,"AddinTeachingCalloutHandler",null,[]);
var Bj=d(1464);class Vj{constructor(e,t,E,W,ha,Ka,sb,dc=null){this.xOe=e;this.tk=t;this.w1a=E;this.bQa=W;this.KLk=ha;this.Ch=Ka;this.Vl=dc;this.Ch&&this.Ch.W0k(this.Drl.bind(this))}efl(e,t,E){if(e){switch(this.kKm(t,E)){case Rf.text:t="ContextMenuText";break;case Rf.image:t="ContextMenuImage";break;default:return}(t=this.xOe.Bfl(t))&&e.push(t)}}Ygi(e){let t;switch(e){case 22:var E=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;t=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:E=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;
t=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;break;default:return}E=new Ec.a(E,t,null);E.id=e;E.image=1;E.closeable=!0;v.AFrameworkApplication.ua.Ib.cza(E,!0)||z.ULS.sendTraceTag(36790731,306,10,"Failed to add entry to business bar. Addin disabled message could not be shown to user.")}pUb(e){z.ULS.sendTraceTag(19507423,220,50,"LaunchAddInCommands log: {0}",{["HostType"]:this.bQa.d0,["LaunchOperationType"]:e[nc.a.oIa]});if(v.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")||
!v.AFrameworkApplication.i6a){var t=e[nc.a.WRd];if(t&&0<t.count){const ha=t.count;for(let Ka=ha-1;0<=Ka;Ka--){const sb=t.J(Ka);OSF.OsfControl.isFirstPartyStoreString(sb.storeType)||t.remove(t.J(Ka))}t.count<ha&&v.AFrameworkApplication.ua&&(v.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&!v.AFrameworkApplication.ua.Ib.C3(22)&&this.Ygi(22),v.AFrameworkApplication.i6a||v.AFrameworkApplication.ua.Ib.C3(36)||this.Ygi(36));if(!t.count)return}}let E=null;if(v.AFrameworkApplication.K.$("HostInstallAddInsIsEnabled")){const ha=
this;E=new bd(this.bQa,this.xOe,new sd(this.tk.value),new tg("",M.a.zcc),this.w1a,Dh.instance,new Jh,(Ka,sb)=>{const dc=new Wb.a(Hb.a.create().toString(),Ka.solutionId,Ka.version,Ka.storeId,Ka.storeType,null);dc.assetId=Ka.assetId;dc.assetStoreId=Ka.assetStoreId;dc.osfControlType=1;ha.Ch.oVj(dc,()=>{sb(Ka)})})}else E=new bd(this.bQa,this.xOe,new sd(this.tk.value),new tg("",M.a.zcc),this.w1a,Dh.instance,new Jh);E.S_k(this.KUn.bind(this));E.K_k(this.BZn.bind(this));t=new jk(this);E.g0k(t.AZn.bind(t));
E.m2k(t.mDg.bind(t));const W=this;this.KLk.continueWith(()=>{try{Xh.a.get_instance().Lk(10,null).continueWith(()=>{E.Axn(W.Vl,Cc.StaticActiveAppFrame.za().Gsa(),e)},3)}catch(ha){z.ULS.sendTraceTag(19507424,220,10,"LaunchAddInCommands failure log: {0}",{["HostType"]:W.bQa.d0,["ExceptionMessage"]:ha.message})}},11)}KUn(e,t){t?t?Jd()||Dd()?(e=ob.a.instance.resolve("Box4.AppsForOffice.IInitializeHelper"))?e.jXf(()=>{ob.a.instance.Qa("Common.App.AppsForOfficeCommon.IAppsForOfficeModel").execute(E=>{E.p5d(t.Hq.solutionId)?
this.fQg(t):z.ULS.sendTraceTag(512274763,220,15,"No ref for current add-in.")})}):z.ULS.sendTraceTag(512274764,220,15,"initializeHelper isn't ready."):this.fQg(t):z.ULS.sendTraceTag(528544852,220,15,"agaveParams is null"):z.ULS.sendTraceTag(529110619,220,15,"No args for OnAutoLaunchAddin event")}WTm(e){var t=null;e&&(t=e[this.bQa.X7h]);if(t){if(e=(new Jg).Ydf(t))return v.AFrameworkApplication.i6a||OSF.OsfControl.isFirstPartyStoreString(e.ownerAddinInfo.storeType);t='Failed to look up ActionContext for buttonId "'+
t+'" in HandleAddInCommandsActionEnabled.'}else t="Failed to retrieve required buttonId property in HandleAddInCommandsActionEnabled.";z.ULS.sendTraceTag(561816859,306,10,t);return v.AFrameworkApplication.i6a}O$d(e){let t=null;e&&(t=e[this.bQa.X7h]);t?(e=new Jg,this.HRf(e,t)):z.ULS.sendTraceTag(561816861,306,10,"Failed to retrieve required buttonId property in HandleAddInCommandsAction.")}HRf(e,t){const E=e.Ydf(t);if(E){const W=new Uj(this.Ch,E.ownerAddinInfo);e.$Tm(t,this.w1a,W,new sd(this.tk.value),
E);Bj.b.pCc()&&E.ownerAddinInfo&&Bj.b.NRn(E.ownerAddinInfo)}else z.ULS.sendTraceTag(561816863,306,10,'Failed to look up ActionContext for buttonId "'+t+'" in HandleAddInCommandsActionInternal.')}Lid(e){const t=Xb.$jo(this.w1a);e[ug.a.Visible]=t.visible;e[ug.a.LabelText]=t.visible?t.labelText:""}Vxc(){}get tR(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",
!1)}wjo(e){if(e&&nc.a.pIa in e)if(this.Ch){var t=e[nc.a.pIa];this.tR?nc.a.aSd in e&&(e=e[nc.a.aSd],this.Ch.gZb(t,e),1===e&&this.NP(t,!0)):this.NP(t,!0)}else z.ULS.sendTraceTag(508625026,220,10,"queryAddinDetailsWithActionData: abort because _appsForOfficeUiActor is null.");else z.ULS.sendTraceTag(509695234,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}NP(e,t=!1){this.Ch?(z.ULS.sendTraceTag(509695232,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",e,t),this.Ch.NP(e,
t)):z.ULS.sendTraceTag(509695233,220,10,"QueryAddinDetails: abort because _appsForOfficeUiActor is null.")}Nvc(e){z.ULS.sendTraceTag(19507425,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",e[nc.a.oIa],e[nc.a.pIa]);this.w1a.VQo();window.setTimeout(()=>{const t=new Jk(new sd(this.tk.value),Dh.instance,Ae.instance);t.J_k((E,W)=>{this.pUb(W.properties);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.NP(e[nc.a.pIa])});t.eqp(e)},0)}Gro(){if(this.w1a.sie()){this.w1a.G2h();var e=ob.a.instance.resolve("Wonca.AddInCommands.IAddInCommandsInitService").mhm();if(e)for(const t of e)e={["ack1"]:t.key,["ack0"]:4,["ak0"]:(new Date).getTime()},this.Nvc(e)}else v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(z.ULS.sendTraceTag(509695235,220,50,"RefreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.w1a.sie()),
this.NP(10,!0),this.NP(0,!0))}G0b(e){cb.iDg(e[nc.a.J2k].toString())}DOa(e){Uj.DOa(e[nc.a.$Rd].toString())}fLa(e){Uj.fLa(e[nc.a.$Rd].toString())}fQg(e){var t=e.Hq;const E=e.kC,W=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&t.solutionId in W)t=W[t.solutionId];else if(t.assetId in W)t=W[t.assetId];else if(t=this.unm(E),void 0===t||null===t){z.ULS.sendTraceTag(528544853,
220,15,"addinCommandControlId is NullOrUndefined");return}this.O$d({["SourceControlId"]:t});e.Hq.isAutoLaunched=!0}unm(e){if(!e)return z.ULS.sendTraceTag(528561871,220,10,"Failed to get button id for addin"),null;if((e=e.tDa)&&e.IJ&&0<e.IJ.count)for(const t of e.IJ){if(t.groups&&1===t.groups.length){e=t.groups[0];if(e.controls&&1===e.controls.length){const E=e.controls[0];if(E.attributes&&!E.controlType&&E.enabled)return E.id}e.controls&&z.ULS.sendTraceTag(528261908,220,15,"It has multiple buttons")}t.groups&&
z.ULS.sendTraceTag(528261909,220,15,"It has multiple groups")}return null}kKm(e,t){let E=0;if(!e||!t)return E;for(var W=0;W<t.Dq();W++){if(t.WG(W)){if(t.Xd()&&14===t.lf){E|=Rf.table;break}t.uc()}t.uc()}for(t=0;t<e.length;++t)if(W=e.J(t),W.contextId===na.a.Bd||W.contextId===na.a.paragraph||W.contextId===na.a.image)Xf.ParagraphReader.Xb(W.node)?E=Lg.a(W.node,5)?E|Rf.image:E|Rf.text:Gg.ImageReader.Lt(W.node)&&(E|=Rf.image);return E}Drl(){this.w1a.G2h()}hbl(e){if(e&&e.solutionId){var t=ob.a.instance.resolve("Box4.AppsForOffice.IInitializeHelper");
t?t.jXf(()=>{ob.a.instance.Qa("Common.App.AppsForOfficeCommon.IAppsForOfficeModel").execute(E=>{var W=e.solutionId,ha=E.p5d(W);ha?ha.sharedRuntimeId&&ha.backgroundState===zk.background?this.Wal(ha.sharedRuntimeId,W):(E=E.mqg(ha),(E=nc.a.FQh in E?E[nc.a.FQh]:null)&&"true"===E.toLowerCase()?(E=new Jg,ha=E.ibl,ha=W in ha?ha[W]:null,W=Telemetry.PrivacyRules.GetPrivacyCompliantId(W,e.storeType,e.assetId,null,null,e.storeId),ha?(this.HRf(E,ha),z.ULS.sendTraceTag(22360455,220,100,"LaunchAddInCommands AutoShowTaskPane Success for app "+
W)):z.ULS.sendTraceTag(22360454,220,15,"LaunchAddInCommands AutoShowTaskPane: No TaskPane set to autoshow for app "+W)):z.ULS.sendTraceTag(22360453,220,50,"LaunchAddInCommands AutoShowTaskPane: Document settings don't set AddinCommandsAutoShowTaskPaneWithDocument = true.")):z.ULS.sendTraceTag(22360452,220,50,"LaunchAddInCommands AutoShowTaskPane failed for afoRefData is null.")})}):z.ULS.sendTraceTag(22360451,220,10,"LaunchAddInCommands AutoShowTaskPane failed for initializeHelper is null.")}else z.ULS.sendTraceTag(571248988,
220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid asset id.")}Wal(e,t){const E=new Jg;(e=E.getTaskPaneControlIdFromSolutionIdRuntimeId(t,e))&&this.HRf(E,e)}BZn(e,t){Object(ak.a)(Gc,t);v.AFrameworkApplication.K.$("AddInCommandsAutoShowTaskPaneIsEnabled")&&(t?window.setTimeout(()=>{t.Hq&&this.hbl(t.Hq)},0):z.ULS.sendTraceTag(21546839,220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null.")));Bj.b.pCc()&&t&&Bj.b.ORn(this,t)}}Object(y.a)(Vj,"AddInCommandsManager",null,[806]);
class Cl extends Vj{constructor(e,t,E,W,ha,Ka,sb,dc,xc){super(e,t,E,W,ha,Ka,sb,dc);this.aUm=()=>{ob.a.instance.Oa("WordEditor.IStatusBarUser").HXb();this.Yze()};(this.pKe=E)&&this.pKe.L_k(this.aUm);Qb.a.A6c=Qb.a.Dck;this.Ga=xc}Vxc(){this.Yze()}Yze(){const e=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)||this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1);Xb.Yze(this.pKe,Cc.StaticActiveAppFrame.za().Gsa(),"AddInCommandsLoadStatus-Medium14",
e?WoncaIntl.WoncaStrings.L_TabHome:WoncaIntl.WoncaStrings.L_TabInsert,CommonUIStrings.L_ButtonOfficeAddins)}}Object(y.a)(Cl,"WordEditorAddInCommandsManager",Vj,[]);class ah{get name(){return"WordEditor.AddInCommands"}wc(e){this.W=e;this.W.ia("CommandUI.AddInCommands.ContextMenuExtensibilityCache",()=>new xa).ha();this.W.ia("CommandUI.AddInCommands.AddinCommandsResourceManager",()=>v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddinResourceManagerGetInstance",!0)?Ea.getInstance():
new Ea).ha();this.W.ia("CommandUI.AddInCommands.IAddinCommandsStringProvider",()=>new lb).ha();this.W.ia("Wonca.AddInCommands.IAddInCommandsManager",()=>new Cl(e.resolve("CommandUI.AddInCommands.ContextMenuExtensibilityCache"),e.rf("Common.App.AppsForOfficeCommon.IContextActivationManager"),e.resolve("CommandUI.AddInCommands.AddinCommandsResourceManager"),e.resolve("CommandUI.AddInCommands.IAddinCommandsStringProvider"),e.resolve("Wonca.ICommandUiManager").XP,e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),
e.resolve("Common.ISharedDependencyLoader"),e.resolve("Common.IExternalUICommandDefinitionMapping"),e.resolve("Common.IAppSettingsManager"))).ha();this.W.ia("Wonca.AddInCommands.AddInCommandsActor",()=>new Ub(v.AFrameworkApplication.va,e.resolve("Wonca.AddInCommands.IAddInCommandsManager"))).ha();this.W.ia("Wonca.AddInCommands.IAddInCommandsInitService",()=>new Ma(v.AFrameworkApplication.va,v.AFrameworkApplication.ua.hs)).ha()}init(){v.AFrameworkApplication.K.$("AddInCommandsIsEnabled")&&(this.W.resolve("Wonca.AddInCommands.AddInCommandsActor").Wb(),
this.W.resolve("WordEditor.UI.EditSurfaceContextMenu"),Object(ib.a)(this.W.resolve("Wonca.AddInCommands.IAddInCommandsManager"),this.W.resolve("Wonca.AddInCommands.IAddInCommandsManager").efl,"buildAddInCommandsContextMenuProps"),v.AFrameworkApplication.K.$("AddInCommandsLoadedInBootingIsEnabled")&&this.W.resolve("Wonca.AddInCommands.IAddInCommandsInitService").ppp())}dispose(){cb.PUl()}static main(){v.AFrameworkApplication.rL||x.a.instance.Jc(new ah)}}Object(y.a)(ah,"PackageManager",null,[0,1]);
class zh{constructor(e,t){this.GB=e;this.appId=t}}Object(y.a)(zh,"ActivatedAfoData",null,[]);class Ql{constructor(e,t,E,W,ha,Ka,sb,dc=!0,xc=null,Rc=0,md=null,ud=null){this.settings=null;this.Pnk=e;this.$Dd=t;this.tKk=E;this.tJb=W;this.rW=ha;this.ENd=Ka;this.lTc=sb;this.GP=null;this.isToBePersisted=dc;this.sharedRuntimeId=xc;this.backgroundState=Rc;this.z4b=md;this.kok=ud}get lSh(){return this.Pnk}get instanceId(){return this.$Dd}get yo(){return this.tKk}get version(){return this.tJb}get store(){return this.rW}get storeType(){return this.ENd}get assetId(){return this.z4b}get assetStoreId(){return this.kok}get Zla(){return"inmemory"===
this.storeType||this.GP&&!this.GP.Zla||!this.isToBePersisted?!1:!0}uUh(e){return e.yo.toLowerCase()===this.yo.toLowerCase()&&e.store.toLowerCase()===this.store.toLowerCase()&&e.storeType.toLowerCase()===this.storeType.toLowerCase()}}Object(y.a)(Ql,"AppsForOfficeReferenceData",null,[]);class al{constructor(){this.Dwa=new gf.a}add(e,t){this.Dwa.mb(e.id)&&z.ULS.sendTraceTag(7143680,344,15,"instance Id {0} already exists when adding new activated apps for office info",e.id);t=new zh(e,t);this.Dwa.Z(e.id,
t)}KVa(e){return this.Dwa.mb(e)?this.Dwa.J(e).appId:(z.ULS.sendTraceTag(7143681,344,15,"instance Id {0} not exists when trying to get App Id",e),null)}TPb(e){for(const t of this.Dwa)if(e===t.value.appId)return t.key;return null}S1c(e){return this.Dwa.J(e).GB.addinCommandsActionType}fJf(e){e=this.Dwa.J(e).GB;const t=new Ql(null,e.id,e.solutionId,e.version,e.storeId,e.storeType,!0,e.isToBePersisted);e.ownerAddinSolutionId&&(t.GP=new Ql(e.ownerAddinSolutionId,e.ownerAddinSolutionId,e.ownerAddinSolutionId,
e.version,e.storeId,e.ownerAddinStoreType,!1,e.isToBePersisted,e.sharedRuntimeId,e.backgroundState,e.assetId,e.assetStoreId));return t}JNm(e){return this.Dwa.J(e).GB.onTaskPaneClose}yPb(e){return this.Dwa.J(e).GB.div}Lom(e){return this.Dwa.J(e).GB.customizedActionDic}LAi(e){const t=new fa.a;for(const E of this.Dwa){const W=E.value.GB;W.ownerAddinSolutionId&&e.toLowerCase()===W.ownerAddinSolutionId.toLowerCase()&&t.add(W.id)}return t}$hm(e){const t=new fa.a;for(const E of this.Dwa){const W=E.value.GB;
W.ownerAddinSolutionId&&e.toLowerCase()===W.ownerAddinSolutionId.toLowerCase()&&t.add(E.value.appId)}return t}}Object(y.a)(al,"ActivatedAfoDataManager",null,[30]);class ji{constructor(e,t,E,W,ha){this.Pli=e;this.controlId=t;this.x1b=E;this.handler=W;this.callback=ha}}Object(y.a)(ji,"EventRegistrationParams",null,[]);var kh=d(96);class bh{constructor(e,t,E){this.lto=W=>{this.Svj(W.Yl,(ha,Ka)=>{ha.addHandler(Ka.controlId,Ka.handler,Ka.callback,Ka.x1b)})};this.osp=W=>{this.Svj(W.Yl,(ha,Ka)=>{ha.removeHandler(Ka.controlId,
Ka.callback,Ka.x1b)})};this.Gb=e;this.cxd=t;this.P8g=E}invokeDdaMethod(e,t,E){const W=e.DdaMethod.DispatchId,ha=this.cxd.K5k.lHf(W);ha?(ha.parameters=e,ha.callback=t,ha.V2k=E,ha.controlId=e.DdaMethod.ControlId,ha.Sk=this.P8g.fJf(ha.controlId),ha.customizedActionDic=this.P8g.Lom(ha.controlId),this.Qff(Object(ib.a)(ha,ha.go,"go"),null)):(z.ULS.sendTraceTag(5902750,341,10,"API Call for method ID {0} does not exist.",W),this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}registerDdaEventAsync(e,
t,E,W,ha){this.Qff(this.lto,new ji(e,t,E,W,ha))}unregisterDdaEventAsync(e,t,E,W,ha){this.Qff(this.osp,new ji(e,t,E,W,ha))}getThrottleForCall(e){return this.cxd.L5k.pOm(e)}Qff(e,t){e=new kh.a(2,1,0,e,116);e.Yl=t;this.Gb.Zb(e)}Svj(e,t){const E=this.cxd.J5k.xjc(e.Pli);E?t(E,e):(z.ULS.sendTraceTag(5902751,341,10,"Event for dispatch ID {0} does not exist.",e.Pli),this.Kr(e.callback,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}UH(e){this.Kr(e,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}Kr(e,
t){if(e){var E={};E.Error=t;e(E)}}}Object(y.a)(bh,"AppsForOfficeApiAdapter",null,[1356]);class hj{constructor(){this.x4b=this.W=null}wc(e){this.W=e;e.register(al,"Common.App.AppsForOfficeCommon.ActivatedAfoDataManager").as("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager").ha().Rd(()=>new al);e.register(bh,"Common.App.AppsForOfficeCommon.AppsForOfficeApiAdapter").as("Common.App.AppsForOfficeCommon.IHostApi").ha().Rd(()=>new bh(v.AFrameworkApplication.mc,e.resolve("Common.App.AppsForOfficeCommon.ApiManager"),
e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager")))}init(){}dispose(){this.x4b&&(this.x4b.dispose(),this.x4b=null)}}Object(y.a)(hj,"AppsForOfficeCommonPackage",null,[0,1]);var uj=d(1550);class wg{constructor(e,t,E){this.Enk=e;this.Dnk=t;this.Fnk=E}get K5k(){return this.Enk}get J5k(){return this.Dnk}get L5k(){return this.Fnk}}Object(y.a)(wg,"ApiManager",null,[1358]);var Ni=d(73),Md=d(438),nf=d(200),bn=d(250);class Wi extends Pa.StandardDialog{constructor(e,t){super();this.fbh=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;
this.thh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.uhh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.j3e=!1;this.Ldc=()=>{this.hide();this.j3e&&this.sVj()};this.IVn=()=>{de.a.instance.getItem("optedIntoAddinDeveloperMode")?(de.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.j3e=!1):(de.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.j3e=!0)};this.JVn=(E,W)=>{1===E&&W.optInCheckbox&&(de.a.instance.getItem("optedIntoAddinDeveloperMode")?de.a.instance.removeItem("optedIntoAddinDeveloperMode"):
(de.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.sVj()))};this.r2a=e;this.oGc=t}showDialog(e,t){this.Qg=void 0===this.Qg||null===this.Qg?bn.a.Zuc(0,Number.MAX_VALUE).toString():this.Qg;v.AFrameworkApplication.ua.Ib.cH?this.Eno(e,t):this.xyn(e,t)}xyn(e,t){const E=new bk.a(void 0,void 0,!1);E.Gd=0;E.Qg=bn.a.Zuc(0,Number.MAX_VALUE).toString();E.kh=String.format("<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",
t,this.uhh,this.thh,this.fbh);E.pi(e,this.JVn,{optInCheckbox:!1})}Eno(e,t){this.J3a=this.Ldc;this.show({["type"]:"StandardDialogProps",["id"]:this.Qg,["dialogIcon"]:3,["headerText"]:e,["titleText"]:t,["resultHandler"]:this.J3a,["messageAreaLink"]:this.aJl(),["permanentDismissCheckbox"]:this.YIl(),["renderMicrosoftLogoInHeader"]:!1})}aJl(){return{["type"]:"AppLinkProps",["id"]:"WACDialogExtraLink",["text"]:this.thh,["handler"]:{["href"]:this.uhh,["target"]:"_blank"},["onExecute"]:null}}YIl(){return{["type"]:"AppCheckboxProps",
["id"]:"WACDialogOptInCheckbox",["label"]:this.fbh,["onExecute"]:this.IVn}}sVj(){const e=new Pa.StandardDialog;e.Gd=4;const t=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.r2a)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;e.yY(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,t,this.oGc)}}Object(y.a)(Wi,"AppsForOfficeDeveloperModeOptInDialog",Pa.StandardDialog,[]);var ee=
d(139);class qd{constructor(e,t){this.r2a=this.$zd=null;this.EAj=E=>{1===E&&this.r2a&&this.Yso()};this.o2=e;this.hia=t}initialize(){this.hia&&(this.hia.initialize(),this.q5o())}q5o(){if(this.hia){var e=this.hia.jti();if(e){for(let E=0;E<e.count;E++){var t=!OSF.OsfControl.isFirstPartyStoreString(e.J(E).storeType);if(v.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&t)v.AFrameworkApplication.ua&&!v.AFrameworkApplication.ua.Ib.C3(22)&&(t=new Ec.a(CommonUIStrings.l_ThirdPartyAddinDisabledTitle,
CommonUIStrings.l_ThirdPartyAddinDisabledMessage,null),t.id=22,t.image=1,t.closeable=!0,v.AFrameworkApplication.ua.Ib.cza(t,!0)||z.ULS.sendTraceTag(36790730,306,10,"Failed to add entry to business bar. Third party addin disabled message could not be shown to user."));else if(e.J(E).lTc||"registry"===e.J(E).storeType)if(t=new Wb.a(e.J(E).instanceId,e.J(E).yo,e.J(E).version,e.J(E).store,e.J(E).storeType,e.J(E).settings),t.assetId=e.J(E).assetId,t.assetStoreId=e.J(E).assetStoreId,t.reason=Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,
t.osfControlType=1,v.AFrameworkApplication.K.$("AddInCommandsIsEnabled")){const W={};v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(W.solutionId=t.solutionId,W.version=t.version):(W.marketplaceId=t.solutionId,W.marketplaceVersion=t.version);W.storeType=t.storeType;W.storeId=t.storeId;W.targetData=t;this.o2.n3i(W,(ha,Ka,sb)=>{const dc=sb.targetData;if(!Ka)this.o2.showTaskPane(dc.solutionId,null,dc);else if(v.AFrameworkApplication.K.$("InstallVisibleAddinCommandsEnabled")){if("omex"!==
W.storeType.toLowerCase())return;let xc=!1;this.zog(Rc=>{if(!Rc[nc.a.I2k]){if(Rc[nc.a.JQh])for(const md of Rc[nc.a.JQh])if(xc=ee.e(md[1])===ee.e(dc.solutionId))break;xc||this.o2.oMh(dc)}})}ha||z.ULS.sendTraceTag(542978530,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(dc.solutionId,dc.storeType,dc.assetId,null,null,dc.storeId),dc.storeType)})}else this.o2.showTaskPane(e.J(E).yo,null,t)}this.bqp()}}}zog(e){const t={};t.callback=e;v.AFrameworkApplication.va.Pb(M.a.pYb,
2,t)}vsb(e){if(this.hia){var t=new Ql(e.id,e.id,e.solutionId,e.version,e.storeId,e.storeType,!0,e.isToBePersisted,null,0,e.assetId,e.assetStoreId);e.ownerAddinSolutionId&&(t.GP=new Ql(e.ownerAddinSolutionId,e.ownerAddinSolutionId,e.ownerAddinSolutionId,e.version,e.storeId,e.ownerAddinStoreType,!1,e.isToBePersisted));this.hia.vsb(t)}}TVf(e,t,E,W){this.hia&&(W=new Ql(W.id,W.id,W.solutionId,W.version,W.storeId,W.storeType,!0),this.hia.TVf(e,t,E,W))}LUl(e){this.hia&&(e=this.hia.o5d(e))&&(e.lTc=!1,this.hia.MQo(e))}dispose(){this.o2&&
(this.o2.dispose(),this.o2=null);this.hia&&(this.hia.dispose(),this.hia=null)}bqp(){this.r2a=v.AFrameworkApplication.K.kb("DevAddinManifestFileUrl");this.$zd=v.AFrameworkApplication.K.kb("DevAddinManifestGuid");var e=v.AFrameworkApplication.K.kb("IsDevAddinTest");if(this.r2a&&this.$zd&&e){e="true"===e;var t=de.a.instance.getItem("optedIntoAddinDeveloperMode");const E=de.a.instance.getItem(this.$zd);t||e&&v.AFrameworkApplication.K.$("RegisterAddinManifestFromQueryParamSuppressDialogsIsEnabled")?E||
e&&v.AFrameworkApplication.K.$("RegisterAddinManifestFromQueryParamSuppressDialogsIsEnabled")?this.o2.au.validateAndCacheNewDevAddinManifest(this.r2a):(e=new Pa.StandardDialog,e.Gd=4,t=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.r2a)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,e.yY(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,t,this.EAj)):(e=new Wi(this.r2a,this.EAj),
e.Gd=0,e.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}Yso(){this.o2.au.validateAndCacheNewDevAddinManifest(this.r2a);de.a.instance.setItem(this.$zd,"true")}}Object(y.a)(qd,"AppsForOfficeManager",null,[1354,13]);class Il{constructor(e,t){this.hostControl=e;this.controlStatusChanged=t.Zhm();this.notifyHost=t.Nnk}}Object(y.a)(Il,"HostControlInfo",null,[]);class Vg{constructor(e){this.Ykb=e}create(){return new OSF.ContextActivationManagerBuilder(this.Ykb.Tzi(),
this.Ykb.UBi())}}Object(y.a)(Vg,"ContextActivationManagerBuilderFactory",null,[1352]);var oi=d(298);class Ah{constructor(e,t,E){this.Frb=W=>{try{if(W&&W.rawEvent&&W.rawEvent.origin&&this.KRb&&this.KRb.id){var ha=this.Xrj(W.rawEvent.origin);const Ka=this.Xrj(document.domain);if(oi.a.th().equals(Ka,ha))if(W.rawEvent.source&&W.rawEvent.source.frameElement&&W.rawEvent.source.frameElement.id&&oi.a.th().equals(W.rawEvent.source.frameElement.id,this.KRb.id)){ha=null;try{ha=JSON.parse(W.rawEvent.data)}catch(sb){z.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",sb.message)}ha?(ha.statusCode!==Y.a.zz||void 0!==ha.error&&ha.error?(z.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",ha.statusCode,ha.error),this.onError()):(z.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.BE(ha.authorizationCode?ha.authorizationCode:
ha.signInUrl)),$removeHandler(window,"message",this.Frb),this.KRb?document.body.contains(this.KRb)?document.body.removeChild(this.KRb):z.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):z.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):z.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else z.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else z.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else z.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Ka){z.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Ka.message)}};this.KRb=e;this.BE=t;this.onError=E;$addHandler(window,"message",this.Frb)}Xrj(e){let t="";try{e&&(t=-1<e.indexOf("//")?e.split("/")[2]:
e.split("/")[0])&&(t=t.split(":")[0],t=t.split("?")[0])}catch(E){z.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",E.message)}return t}static qF(e,t,E){new Ah(e,t,E)}}Object(y.a)(Ah,"ResponseHandler",null,[]);var ag=d(205);class Cg{constructor(e){this.BJb=e}tryAuthenticate(e,t){this.pqe(Cg.Uyk,()=>{e()},t)}tryAuthorize(e,t){this.pqe(Cg.Eok,e,t)}getSignInUrl(e,t){this.pqe(Cg.KFh,e,t)}signOut(e,t){this.pqe(Cg.$Nk,e,t)}pqe(e,t,E){var W=new ag.QueryStringBuilder("AuthenticationProxyHandler.aspx");
W.ze("responseType",e);v.AFrameworkApplication.Aja(W);W=String.format("{0}{1}&{2}",this.BJb,W.toString(),v.AFrameworkApplication.jm);const ha=document.createElement("iframe");ha.setAttribute("id","privateCatalogIframe");ha.setAttribute("name","privateCatalogIframe");ha.setAttribute("style","display: none");oi.a.th().equals(e,Cg.KFh)||ha.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Ah.qF(ha,t,E);ha.setAttribute("src",W);document.body.appendChild(ha)}}
Cg.Eok="authcode";Cg.Uyk="identitytoken";Cg.KFh="signinurl";Cg.$Nk="signout";Object(y.a)(Cg,"AuthenticationProxy",null,[]);class Sg{}Sg.getUserId="getUserId";Sg.getLastStoreUpdate="laststoreupdate";Sg.getEntitlement="getEntitlements";Sg.getEToken="getEToken";Sg.getManifest="getManifest";Sg.getAppState="getAppState";Sg.getKilledApps="getRemovedAddins";Sg.getAppDetails="getAppDetails";Sg.removeApps="removeAddin";Sg.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Sg.getPrivateCatalogAddIns=
"getAddIns";Sg.getPrivateCatalogManifests="getAppManifests";Sg.isStoreDisabled="isStoreDisabled";Object(y.a)(Sg,"S2SWebRequestActions",null,[]);var ui=d(1137);class ck{getUserId(e,t){const E=new fa.a;E.add(new kb.a("corr",e));this.pu(Sg.getUserId,E,1,t)}getLastStoreUpdate(e,t,E){const W=new fa.a;W.add(new kb.a("lc",e));W.add(new kb.a("corr",t));this.pu(Sg.getLastStoreUpdate,W,1,E)}getEntitlement(e,t,E,W){e=new fa.a;e.add(new kb.a("av",t));e.add(new kb.a("corr",E));this.pu(Sg.getEntitlement,e,1,W)}getEToken(e,
t,E,W,ha,Ka){const sb=new fa.a;sb.add(new kb.a("cmu",e));sb.add(new kb.a("cmf",t));sb.add(new kb.a("assetid",E));sb.add(new kb.a("expver",W));sb.add(new kb.a("corr",ha));this.pu(Sg.getEToken,sb,1,Ka)}getManifest(e,t,E,W){const ha=new fa.a;ha.add(new kb.a("cmu",e));ha.add(new kb.a("assetid",t));ha.add(new kb.a("corr",E));this.pu(Sg.getManifest,ha,1,W)}getAppState(e,t,E){const W=new fa.a;W.add(new kb.a("ma",e));W.add(new kb.a("corr",t));this.pu(Sg.getAppState,W,1,E)}getKilledApps(e,t){const E=new fa.a;
E.add(new kb.a("corr",e));this.pu(Sg.getKilledApps,E,1,t)}getAppDetails(e,t,E,W){const ha=new fa.a;ha.add(new kb.a("cmo",e));ha.add(new kb.a("corr",E));this.sendWithBody(Sg.getAppDetails,ha,t,2,W,!1)}removeApps(e,t,E){const W=new fa.a;W.add(new kb.a("corr",t));this.sendWithBody(Sg.removeApps,W,e,2,E,!1)}getLastPrivateCatalogUpdate(e,t,E,W,ha,Ka){const sb=new fa.a;sb.add(new kb.a("catalog","privatecatalog"));sb.add(new kb.a("clientCode",e));sb.add(new kb.a("clientVersion",t));sb.add(new kb.a("corr",
ha));e=String.format("authorizationCode={0}&refreshToken={1}",E?Qd.a.ej(E):"",W?Qd.a.ej(W):"");this.sendWithBody(Sg.getLastPrivateCatalogUpdate,sb,e,2,Ka,!0)}getPrivateCatalogAddIns(e,t,E,W,ha,Ka){const sb=new fa.a;sb.add(new kb.a("catalog","privatecatalog"));sb.add(new kb.a("clientCode",e));sb.add(new kb.a("clientVersion",t));sb.add(new kb.a("corr",ha));e=String.format("authorizationCode={0}&refreshToken={1}",E?Qd.a.ej(E):"",W?Qd.a.ej(W):"");this.sendWithBody(Sg.getPrivateCatalogAddIns,sb,e,2,Ka,
!0)}getPrivateCatalogManifests(e,t,E,W,ha){const Ka=new fa.a;Ka.add(new kb.a("catalog","privatecatalog"));Ka.add(new kb.a("corr",W));e=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Qd.a.ej(e),t?Qd.a.ej(t):"",E?Qd.a.ej(E):"");this.sendWithBody(Sg.getPrivateCatalogManifests,Ka,e,2,ha,!0)}isStoreDisabled(e,t){const E=new fa.a;E.add(new kb.a("corr",e));this.pu(Sg.isStoreDisabled,E,2,t)}pu(e,t,E,W){this.sendWithBody(e,t,null,E,W,!1)}sendWithBody(e,t,E,W,ha,Ka){const sb=new ag.QueryStringBuilder("AddinServiceHandler.ashx");
sb.ze("action",e);sb.ze("app",ui.a[v.AFrameworkApplication.ua.Ib.Tk]);for(const dc of t)sb.ze(dc.key,dc.value);t=String.format("{0}{1}&{2}",v.AFrameworkApplication.ua.Ib.HYa,sb.toString(),v.AFrameworkApplication.jm);v.AFrameworkApplication.Be.Ij(t,W,E,null,!1,2,dc=>{let xc=null,Rc=null;dc&&dc.data&&(dc.data.vi["X-BlockedForMinor"]&&"1"===dc.data.vi["X-BlockedForMinor"].toString()&&(dc.data.He=451),xc=dc.data.De,Rc=dc.data.vi);ha(dc.data.He,xc,Rc)},dc=>{var xc=null;let Rc=null;Ka&&dc&&dc.data&&dc.data.De&&
(xc=dc.data.De,Rc=dc.data.vi);ha(dc.data.He,xc,Rc);if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){xc={message:"AddinServiceHandler request failed"};xc.code=dc.data.He;xc.action=e;if(dc.data.request||dc.data.request.get_headers())xc["X-UserSessionId"]=dc.data.request.get_headers()["X-UserSessionId"];408===dc.data.He||503===dc.data.He?z.ULS.sendTraceTag(538784582,220,10,JSON.stringify(xc)):z.ULS.sendTraceTag(18392345,220,50,JSON.stringify(xc))}else z.ULS.sendTraceTag(538736349,
220,50,"S2S web request failed with {0}.",dc.data.He)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+e,void 0,void 0,void 0,["X-UserKey"])}}Object(y.a)(ck,"S2SWebRequestManager",null,[]);class Zf{constructor(e,t,E){this.Qyd=null;this.ZDc=e;this.Ykb=t;this.Ayk=E}create(){if(!this.Qyd){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AppsForOfficeServerToServerIsEnabled")&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new ck);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled")&&
OfficeExt.PrivateCatalogService.initRequestHandler(new ck,new Cg(v.AFrameworkApplication.K.appSettings.WebServiceBase),v.AFrameworkApplication.K.$("PrivateCatalogThirdPartyHostsEnabled"),v.AFrameworkApplication.K.$("PrivateCatalogIsResultCodesEnabled"));"undefined"!==typeof OfficeExt.MosRequestHandler&&"undefined"!==typeof OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new ck);"undefined"!==typeof OfficeExt.ProxyBasedCatalogService&&"undefined"!==typeof OfficeExt.ProxyBasedCatalogService.initRequestHandler&&
OfficeExt.ProxyBasedCatalogService.initRequestHandler(new ck);const e=this.Qyd=this.ZDc.setHostInfo(this.Ykb.Tzi()).setLocaleInfo(this.Ykb.UBi()).setUrlInfo(this.Ykb.XPm()).setMiscellaneousActivationParameters(this.Ykb.Yzm()).setHostControlInfo(this.Ayk).setUserInfo(this.Ykb.iQm()).construct();void 0!==e&&null!==e&&"undefined"!==typeof e.hostCheckReadyHandler?v.AFrameworkApplication.f0k(Object(ib.a)(e,e.hostCheckReadyHandler,"hostCheckReadyHandler")):z.ULS.sendTraceTag(594613527,1403,15,"ContextActivationManager or its hostCheckReadyHandler is null")}return this.Qyd}}
Object(y.a)(Zf,"ContextActivationManagerFactory",null,[1349]);var ij=d(2020),mj=d(2021),Jl=d(2022),Xi=d(1846),Sh=d(1848),Vk=d(2019),nj=d(767),dk=d(144);class mm{constructor(e,t,E){this._id=e;this.Qmk=t;this.Xqk=E;this.dVi=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get kKb(){return this.Qmk}get ovl(){return this.Xqk}execute(e,t,E){E=E||{};E.commandMode=this.dVi;t.invokeAppCommand(this.kKb,this.ovl,E,()=>{e.o_n(this.id)})}}Object(y.a)(mm,"AddinNativeActionBase",null,[112]);class Ai extends mm{constructor(e,
t){super(1,e,t);this.dVi=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(y.a)(Ai,"AddinTakeSnapshotAction",mm,[]);class nm{fDl(e){return new mm(3,e,this.ygm().getNativeActionName(3))}ygm(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(y.a)(nm,"AddinNativeActionManager",null,[83]);class rm{invokeAppCommand(e,t,E,W){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(e,t,E,W)}static getInstance(){rm._instance||(rm._instance=new rm);return rm._instance}}rm._instance=null;
Object(y.a)(rm,"OSFAddinCommandsRuntimeManager",null,[84]);var qi=d(211),Yi=d(20);class Zl extends bk.a{constructor(e,t,E){super();this.uTa=null;this.bbf="WACDialogTitleText";this.Twa="0";this.BQa="15px";this.Drk="0px";this.Swa="calc(100% - 30px)";this.Crk="100%";this.JBh=0;this.sa=new ua.a;this.Smk=new nm;this.Gd=5;this.Qg=this.pGc=E;this.jQe=e;this.Seh=t;this.FRe=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("OfficeAddinEnableInsertDialogAccessibilityFix")}ygf(e){this.sa.addHandler("OnDialogClosedEventKey",
e)}QDj(e){this.sa.removeHandler("OnDialogClosedEventKey",e)}DVo(){this.J3a=null}gV(){super.gV();this.Nq.style.width="100%";this.Nq.style.height=this.j6c?this.Swa:this.Crk;this.Nq.style.marginTop=this.j6c?this.BQa:this.Drk;this.Nq.style.padding=this.Twa}WN(){super.WN();this.Oc.style.width=String.format("{0}px",this.jQe*window.innerWidth/100);this.Oc.style.height=String.format("{0}px",this.Seh*window.innerHeight/100);this.Oc.style.minWidth="0px";this.FRe&&v.AFrameworkApplication.isRtl&&100===this.jQe&&
(this.Oc.style.right="0px",this.Oc.style.marginRight="0px");this.uTa=document.getElementById(this.Sj(this.bbf));this.uTa.style.position="absolute";this.uTa.style.whiteSpace="nowrap";this.uTa.style.textOverflow="ellipsis";v.AFrameworkApplication.isRtl?(this.uTa.style.right="14px",this.uTa.style.left="44px"):(this.uTa.style.right="44px",this.uTa.style.left="14px")}u_a(e){super.u_a(e);this.uTa&&this.uTa.setAttribute("title",e)}get Cob(){return this.Nq}Xug(){this.Oc.style.width=String.format("{0}px",
this.jQe*window.innerWidth/100);this.Oc.style.height=String.format("{0}px",this.Seh*window.innerHeight/100);this.Oc.style.overflowY="hidden";this.Oc.style.overflowX="hidden";this.Oc.style.marginTop="";this.Oc.style.top="";Yi.a.sCa&&v.AFrameworkApplication.isRtl?(this.Oc.style.right="",this.Oc.style.marginRight=""):(this.Oc.style.left="",this.Oc.style.marginLeft="")}hide(){this.Smk.fDl(this.pGc).execute(this,rm.getInstance(),{});this.JBh=window.setTimeout(()=>{this.sa.raiseEvent("OnDialogClosedEventKey",
this.pGc);qi.a.prototype.hide.call(this)},500)}o_n(e){3===e&&(window.clearTimeout(this.JBh),this.sa.raiseEvent("OnDialogClosedEventKey",this.pGc),super.hide())}}Object(y.a)(Zl,"AppsForOfficeDialog",bk.a,[60,61]);class Qi{constructor(){this.dialog=this.Qg=null}}Object(y.a)(Qi,"DialogInfo",null,[]);class Oh{}Oh.url="url";Oh.height="height";Oh.width="width";Oh.xyf="displayInIframe";Oh.Nae="hideTitle";Object(y.a)(Oh,"DialogSettings",null,[]);class hb{constructor(){this.height=this.width=0;this.Qg=this.controlId=
this.pageUrl=null;this.Nae=this.xyf=!1}}Object(y.a)(hb,"DisplayDialogParams",null,[]);class wc extends Sys.EventArgs{constructor(e,t,E=null,W="",ha=""){super();this.controlId=e;this.messageType=t;this.messageContent=E;this.g9f=W;this.$eb=ha}}Object(y.a)(wc,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class cd extends Sys.EventArgs{constructor(e,t,E=null,W="",ha=""){super();this.controlId=e;this.messageType=t;this.messageContent=E;this.g9f=W;this.$eb=ha}}Object(y.a)(cd,"OnMessageParentEventArgs",Sys.EventArgs,
[]);var Rd=d(123);class cf{constructor(e){this.sa=new ua.a;this.MWn=(t,E)=>{if(t=this.Ojc(E))this.tk.purgeDialogControl(E),cf.cQa.remove(t),this.sa.raiseEvent("OnMessageParentEventKey",new cd(t,OSF.DialogMessageType.DialogClosed,null,null,"*"))};this.tk=e}f1k(e){this.sa.addHandler("OnMessageParentEventKey",e)}ZDj(e){this.sa.removeHandler("OnMessageParentEventKey",e)}e1k(e){this.sa.addHandler("OnMessageDialogEventKey",e)}OAo(e){this.sa.removeHandler("OnMessageDialogEventKey",e)}showDialog(e,t,E,W){if(cf.cQa.mb(t))z.ULS.sendTraceTag(18896285,
344,100,"ShowDialog: agave dialog map already has dialog info for this control."),E(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const md=qe.b(e),ud=md[Oh.url];if(this.tk.getOsfControl(t).checkAppDomains(ud)){var ha=new hb;ha.width=md[Oh.width];ha.height=md[Oh.height];ha.pageUrl=ud;ha.xyf=md[Oh.xyf];ha.Nae=md[Oh.Nae];ha.controlId=t;ha.Qg=Rd.a.create().toString();var Ka=new Qi;Ka.Qg=ha.Qg;var sb=this.tk.getOsfControl(ha.controlId).getManifest().getDefaultDisplayName(),dc=this.tk.getOsfControl(ha.controlId).getStoreType().toLowerCase();
e=null;e=(4===v.AFrameworkApplication.ua.Ib.Tk&&"hardcodedpreinstall"===dc||"sdxcatalog"===dc)&&ha.Nae?this.createAndShowAppsForOfficeDialog(ha.width,ha.height,ha.Qg,!0,sb):this.createAndShowAppsForOfficeDialog(ha.width,ha.height,ha.Qg,!1,sb);var xc=this.tk.getOsfControl(ha.controlId),Rc=xc.getManifest();t={};t.id=ha.Qg;t.solutionId=xc.getSolutionId();t.version=xc.getVersion();t.storeType=dc;t.storeId=xc.getStoreId();t.assetId=xc.getAssetId();t.assetStoreId=xc.getAssetStoreId();t.ownerAddinSolutionId=
xc.getOwnerAddinSolutionId();t.ownerAddinStoreType=xc.getOwnerAddinStoreType();t.appDomains=Rc.getAppDomains();t.dialogUrl=ud;t.osfControlType=1;t.agaveName=sb;t.div=e.Cob;z.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(t.solutionId,t.ownerAddinStoreType||t.storeType,t.assetId,null,null,t.storeId),Qd.a.MT(ha.pageUrl));this.tk.insertDialogControl(t);e.ygf(this.MWn);Ka.dialog=e;cf.cQa.Z(ha.controlId,Ka);W&&W(t);E(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else z.ULS.sendTraceTag(19940611,
344,10,"ShowDialog: dialog url not in app domains list."),E(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(md){z.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",md.message),E(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}nMn(e,t,E,W){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===W&&(W=E);try{const ha=this.Ojc(e);ha&&this.sa.raiseEvent("OnMessageParentEventKey",new cd(ha,
OSF.DialogMessageType.DialogMessageReceived,t,E,W))}catch(ha){return z.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",ha.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Pza(e,t){if(cf.cQa.mb(e))try{const E=cf.cQa.J(e);E.dialog&&E.dialog.hide();this.tk.purgeDialogControl(E.Qg);cf.cQa.remove(e);t(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(E){z.ULS.sendTraceTag(18371106,344,
10,"CloseDialog: action failed. Exception message: {0}",E.message),t(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else z.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),t(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}DOo(e,t,E,W){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===W&&(W=E);if(cf.cQa.mb(e)&&(e=cf.cQa.J(e),e.dialog))try{this.sa.raiseEvent("OnMessageDialogEventKey",
new wc(e.Qg,OSF.DialogMessageType.DialogParentMessageReceived,t,E,W))}catch(ha){z.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",ha.message)}}Ojc(e){let t=null;for(const E of cf.cQa)if(E.value.Qg===e){t=E.key;break}return t}createAndShowAppsForOfficeDialog(e,t,E,W,ha){e=new Zl(e,t,E);ha=W?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,ha);W&&(e.j6c=!1,e.Du=!1);e.pi(ha,null,null);e.DVo();return e}static aSm(){return cf.cQa}static getInstance(e){cf._instance||
(cf._instance=new cf(e));return cf._instance}}cf._instance=null;cf.cQa=new gf.a;Object(y.a)(cf,"AppsForOfficeDialogManager",null,[33]);class Ge{constructor(e,t,E){this.tk=this.eLe=null;this.Ch=t;this.A9=E}get contextActivationMgr(){!this.tk&&this.Ch&&(this.tk=this.Ch.au);return this.tk}get P7a(){this.eLe||(this.eLe=cf.getInstance(this.contextActivationMgr));return this.eLe}showDialog(e,t,E){try{this.P7a.showDialog(t,e,E,W=>{this.A9.add(this.dfl(W),W.id)})}catch(W){z.ULS.sendTraceTag(19670552,344,
10,"ShowDialogApiHelper: show dialog failed. Exception message: {0}",W.message),E(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}jej(e,t,E,W){return this.P7a.nMn(e,t,E,W)}Pza(e,t){this.P7a.Pza(e,t)}DOa(e){return this.Ch.DOa(e)}fLa(e){return this.Ch.fLa(e)}sendMessage(e,t,E,W){this.P7a.DOo(e,t,E,W)}dfl(e){return e?new Wb.a(e.id,e.solutionId,e.version,e.storeId,e.storeType,null):null}}Object(y.a)(Ge,"ShowDialogApiHelper",null,[1789]);var Wg=d(52),ge=d(362),oj=d(252),uh=d(590),Pj=d(287),eh=d(1232),
xf=d(256),gh=d(111),Ue=d(286),gb=d(46),Mb=d(363),hc=d(345),Kc=d(57),Vc=d(529),od=d(1037),Od=d(44),Ld=d(6),Af=d(120),Tb=d(16),Dg=d(1097),Kh=d(773);class rg{constructor(e,t){this.Ck=e;rg.Flb=t}i9m(e,t,E,W){const ha=Rd.a.create(),Ka=new hc.DictionaryPropertySet;Ka.setValue(Tb.a.lma,Kc.a.em(t,0));Ka.setValue(Tb.a.kma,Kc.a.em(E,1));Ka.setValue(gb.a.h0,Dg.a.KPa);E=e.view;t=new Od.GraphTransaction(15);t.Ab(E.jd);E=null;const sb=({UVb:E}=this.Ck.yhi(e,Ka,ha)).returnValue;if(!sb)return null;var dc=new Ld.GraphIterator;
dc.set(sb.node);dc=this.j9m(dc,W);t.dispose();E&&e.view.lb.Ic(E);rg.Flb&&rg.Flb.$fc(e,Ka,W,sb.node,dc.id.toString(),sb.blob,ha);return dc}j9m(e,t){if(!e||!e.currentNode||19!==e.lf)return null;const E=new Kh.a,W=new hc.DictionaryPropertySet;W.setValue(gb.a.NQh,t.id);W.setValue(gb.a.QQh,t.version);W.setValue(gb.a.OQh,t.store);W.setValue(gb.a.PQh,t.storeType);E.setValue(gb.a.xmc,20);E.setValue(gb.a.kKb,t.instanceId);E.setValue(gb.a.MQh,W);E.setValue(gb.a.KQh,t.isContent);e.Uf(E,2);e.Yj(E);return E}saveSettings(e,
t,E){var W=e.ja(gb.a.ihf,null);let ha=0;var Ka=W?W.length:0;const sb=[];for(var dc=0;dc<Ka;dc++){var xc=W.J(dc),Rc=xc.wf(gb.a.fhf);if(Rc in t){const md=e.Lc,ud=new Af.a;ud.setValue(gb.a.ghf,t[Rc]);Rc=md.ou(ud,null);xc.setValue(gb.a.hhf,Rc);ha+=1}sb.push(xc)}if(E&&ha!==E.length)for(W=0;W<E.length-ha;W++)Ka=new hc.DictionaryPropertySet,dc=E[ha+W],xc=e.Lc,Rc=new Af.a,Rc.setValue(gb.a.ghf,t[dc]),xc=xc.ou(Rc,null),Ka.setValue(gb.a.fhf,dc),Ka.setValue(gb.a.hhf,xc),sb.push(Ka);return new Vc.a(od.CommonProperties.qf.id,
sb)}}rg.Flb=null;Object(y.a)(rg,"AddinEditor",null,[758]);var ai=d(943);class kl{constructor(e){this.cbe={};this.Pc=e}cXk(e){if(e){var t=e.properties.ja(gb.a.kKb,"");this.cbe[t]=e}}saveSettings(e,t){if(!t||!Mb.a(t))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(!(e.instanceId in this.cbe))return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;this.YKo(this.cbe[e.instanceId],t);return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}YKo(e,t){const E=this.Pc.Mc(15);E.Ab(e);t=
(new rg(null,null)).saveSettings(e,t,Mb.a(t));e.setValue(gb.a.ihf,t);E.dispose()}oHf(e){if(!e)return null;e=this.cbe[e.instanceId];let t={};e&&(t=(new ai.a(e)).getSettings());return t}}Object(y.a)(kl,"SaveSettingsHelper",null,[]);class Fe{constructor(e,t,E){this.tk=e;this.PY=t;this.bMk=E}activate(e,t){var E=t.ja(gb.a.kKb,null);E||(E=String.format("{{{0}}}",Rd.a.create()),t.setValue(gb.a.kKb,E));var W=new ai.a(t);E=W.getSettings();W=W.s7d();E=new Wb.a(W.instanceId,W.id,W.version,W.store,W.storeType,
E);E.div=e;E.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;E.osfControlType=W.isContent?OSF.OsfControlType.DocumentLevel:OSF.OsfControlType.ContainerLevel;this.PY.add(E,W.id);this.bMk.cXk(t);this.tk.value.insertOsfControl(E)}}Object(y.a)(Fe,"AddinActivator",null,[103]);var vh=d(119),te=d(1778),jj=d(1751),ek=d(925),pg=d(1692),Ak=d(102),Ri=d(492),wi=d(538);const Bk=()=>{};class Ph extends te.a{constructor(e,t,E,W,ha,Ka,sb,dc,xc){super(e,t,E);this.Lgg=Rc=>{if(pg.c(this.Qf)){var md=
{},ud=this.nJ?this.nJ.properties.yc.toString():this.Qf.yc.toString();md[Ri.a.nodeId]=this.nJ?this.nJ.id.toString():this.Qf.id.toString();md[Ri.a.classId]=ud;md[wi.a.ymc]=this.Wyk;ud=Kc.a.nf(Gg.ImageReader.tE(this.Qf),0);var Ud=Kc.a.nf(Gg.ImageReader.YJ(this.Qf),1);md[wi.a.width]=ud;md[wi.a.height]=Ud;pg.d(Rc,this.Qf,this.Km,md)&&Rc.Zqd()}};this.$td=!1;this.Qf=Ka;this.Wyk=sb;this.nJ=dc;this.Km=xc;this.g4n=this.Yvb.bind(this);this.ZAp=this.ooa.bind(this)}$fc(){new jj.a(document.body,this.g4n,this.ZAp,
this.K,!1,null)}WAa(e){this.tld(e)}tld(e){ek.a.instance.oNg(this.Qf.Jj());this.Qf.Jj().yg.CF(this.Lgg,Bk,e)}ooa(e){e&&!e.StatusCode&&this.Qf.CL().yg.nsb(e,Ak.b(e.RevisionList[0].BaseId),!1,new Date,"");this.Qf&&e?ek.a.instance.jBc(this.Qf.Jj(),e.StatusCode):z.ULS.sendTraceTag(594929294,339,50,"Not able to notify upload notifier for completion")}qoa(){return!0}}Object(y.a)(Ph,"BackCompatImageUploader",te.a,[]);class po{$fc(e,t,E,W,ha,Ka,sb){(new Ph(e,vh.a.instance,v.AFrameworkApplication.K,t,E,W,ha,
Ka,sb)).$fc()}}Object(y.a)(po,"BackCompatImageUploaderWrapper",null,[804]);var Lh=d(748),qa=d(1192);class Jb{create(){return new qa.a}}Object(y.a)(Jb,"AppNodeFactory",null,[296]);var Rb=d(1193);class Tc{create(){return new Rb.a}}Object(y.a)(Tc,"AppPropNodeFactory",null,[296]);class vd{constructor(){this.g3e=[]}avo(e){this.g3e.push(e)}pVc(e,t){if(!e||!e.count)return z.ULS.sendTraceTag(17356047,341,15,"The GNC list passed into CheckOperation() should not be null or empty"),!1;for(let E=0;E<this.g3e.length;++E)if(!(0,this.g3e[E])(e,
t))return!1;return!0}}Object(y.a)(vd,"ApiOperationChecker",null,[1298]);var Td=d(980);class Ed{constructor(){this.sa=new ua.a;this.Pxj=()=>{var e=(new Date).getTime();this.yVi()&&this.sa&&(this.sa.raiseEvent("GraphSpaceLoadContentReadyEventKey"),this.sa.dispose(),this.sa=null,Td.a.FBj("GraphSpaceLoadContentReadyEventKey"));e=(new Date).getTime()-e;z.ULS.sendTraceTag(17585671,341,50,"{0}",e)}}jXf(e){this.yVi()?(Td.a.FBj(),e()):this.sa&&(this.sa.addHandler("GraphSpaceLoadContentReadyEventKey",e),Td.a.KUk(this.Pxj))}yVi(){let e=
null;const t=Lh.a.en.ib.$c;t&&(e=new Ld.GraphIterator,e.set(t),this.T9f(e)||(e=null));return e&&e.Ub(19)?!0:!1}T9f(e){Object(gh.a)().dS(e);return e.Ub(18)}}Object(y.a)(Ed,"InitializeHelper",null,[1299]);var lf=d(546);class Bf{setTimeout(e,t=0){return window.setTimeout(e,t)}clearTimeout(e){window.clearTimeout(e)}setInterval(e,t=0){return window.setInterval(e,t)}clearInterval(e){window.clearInterval(e)}}Object(y.a)(Bf,"WindowTimer",null,[1297]);var vf=d(32),fd=d(5);class Wc{}Wc.text="text";Wc.table=
"table";Wc.rVb="matrix";Object(y.a)(Wc,"AppBindingType",null,[]);class sg{}sg.bSh="appBindingData";sg.jdc="appInstanceId";sg.FSd="appReferenceId";Object(y.a)(sg,"AppConstants",null,[]);class Jf{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc=null){this.Bz=this.dBd=null;this.Qeg=(md,ud)=>{if(this.ZXf){md=this.oQ.jti();var Ud=new fa.a;for(var Id=0;Id<md.count;++Id){var Ee=md.J(Id);Ee=this.oQ.yjc(Ee);Ud.add(Ee)}Id=new fa.a;Ee=new fa.a;for(var kf of ud.Wci){ud=this.xHf(kf.id);for(let dh=0;dh<Ud.count;++dh){const $h=
new fa.a;for(var Ke of Ud.J(dh))ud===Ke.RQ&&$h.add(Ke);0<$h.count&&(Id.add(md.J(dh)),Ee.add($h))}}if(0<Ee.count){kf=this.Pc.Mc(15);kf.Ab(this.oQ.kla());for(Ke=0;Ke<Ee.count;++Ke)for(const dh of Ee.J(Ke))(md=this.e2d.xjc(OSF.DDA.EventDispId.dispidBindingDataChangedEvent))&&Id.J(Ke)&&md.Txj(Id.J(Ke).instanceId,dh.zW),this.oQ.bsg(Id.J(Ke),dh.zW);kf.dispose()}}};this.oQ=e;this.Tp=t;this.hb=E;this.Pc=W;this.Ei=ha;this.o6=Ka;this.HRa=dc;this.vG=sb;this.A9=Rc;this.ZXf=!0;this.qh=xc}get a3i(){return v.AFrameworkApplication.K.$("TableCellRowSelectionIsEnabled")}get Ej(){return this.Ei.value}get e2d(){this.dBd||
(this.dBd=ob.a.instance.resolve("WordEditor.AppsForOffice.WordEditorEventStore"));return this.dBd}set e2d(e){this.dBd=e}get Pde(){this.Bz||(this.Bz=ob.a.instance.Oa("Box4.ContentControlConfigSettings"));return this.Bz?this.Bz.vh:!1}get WVi(){return v.AFrameworkApplication.K.$("WordEditorAppsForOfficeAppBindingDataChangedEventIsEnabled")}cBa(e,t){const E={};t=this.oQ.yjc(t);for(var W of t)if(W.zW===e){e={};W=({sWh:e}=this.jui(W)).returnValue;if(W!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:W,
hL:E};E[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties]=e;return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,hL:E}}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,hL:E}}Kti(e,t){t=this.oQ.yjc(t);for(const E of t)if(E.zW===e)return e=E,{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Vkf:e};return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,Vkf:null}}jui(e){const t={};let E=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;
t[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=e.zW;t[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=e.MO;if(e.MO===Wc.table||e.MO===Wc.rVb){let W=null;({root:W,returnValue:E}=this.AIi(e));E===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(t[OSF.DDA.Marshaling.AppBindingKeys.ColumnCount]=vf.TableReader.Fh(W),t[OSF.DDA.Marshaling.AppBindingKeys.RowCount]=vf.TableReader.xg(W),e.MO===Wc.table&&(e=this.vG.m9a(W),t[OSF.DDA.Marshaling.AppBindingKeys.HasHeaders]=0<e,t[OSF.DDA.Marshaling.AppBindingKeys.RowCount]=
vf.TableReader.xg(W)-e))}return{returnValue:E,sWh:t}}Abl(e){let t=null;const E=({Bra:e}=this.wIf(e)).returnValue;if(E!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:E,graphNode:t};t=e.Ud.WO();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,graphNode:t}}fNm(e,t){let E=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,W=null;(e=this.oQ.cBa(e,t))?{root:W,returnValue:E}=this.AIi(e):E=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return{returnValue:E,root:W}}AIi(e){let t=
null,E=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;e?e.MO!==Wc.table&&e.MO!==Wc.rVb?E=OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnThisBindingType:(e=this.Tp.getById(this.LVa(e.RQ)))?{xp:t,returnValue:E}=this.M9d(e):E=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:E=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return{returnValue:E,root:t}}M9d(e){let t=null;var E=e.pv;e=e.MA;E=E&&e&&E.equals(e)?(t=this.Ej.Eb(E))&&14===t.type?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;return{returnValue:E,xp:t}}B2c(e,t,E){var W=null;e=({Bra:W}=this.A2c(t,e)).returnValue;return e!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?e:(W=W.TG(!0))?(E.push(...W.toArray()),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}XGf(e){const t=[];if(e=this.oQ.yjc(e))for(const E of e){let W;({sWh:W}=this.jui(E)).returnValue===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
t.push(W)}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,rWh:t}}sBj(e,t,E=null){var W=this.oQ.cBa(t,e);if(!W)return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;var ha=W.RQ;W=this.LVa(ha);const Ka=this.Tp.getById(W);if(!Ka)return z.ULS.sendTraceTag(17581638,341,10,"The content control bound id : {0} did not exist.",W),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;ha=this.oQ.Yhm(ha);e=this.oQ.bsg(t,e);e===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(E&&E(),Ka.wfe&&
1===ha.count?this.Tp.mZb(W):Ka.Poc&&1===ha.count&&(Ka.Poc=!1));return e}VDa(e){let t=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;e=this.LVa(e.RQ);this.Tp.getById(e)?this.Tp.mZb(e)&&(t=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):t=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return t}hIl(){let e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType;var t=2;let E=0;const W=[];for(var ha of this.hb.gb)W.push(...ha.toArray());const Ka=W[0];ha=W[W.length-1];2===W.length&&
Ka.contextId===na.a.Bd&&ha.contextId===na.a.Vc&&(ha=Ka);const sb=this.Tp.mN(Ka,ha,0);if(sb&&0<sb.count)return E=sb.J(0).id,sb.J(0).Poc=!0,{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Iw:E};if(Ka.contextId===na.a.Bd&&(1===W.length||2===W.length))e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,{id:E,returnValue:t}=this.Tp.U5a(Ka);else if((this.a3i||1===this.hb.gb.length)&&Ka.contextId===na.a.paragraph&&ha.contextId===na.a.paragraph){let dc;if(!({kCe:t}=this.J4j(Ka.node)).returnValue||
!({kCe:dc}=this.J4j(ha.node)).returnValue)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType,Iw:E};e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;({id:E,returnValue:t}=this.Tp.Nqa(t.id,dc.id))}if(e!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:e,Iw:E};if(t)return z.ULS.sendTraceTag(17585562,341,15,"{0}",{["ccError"]:t,["errMsg"]:"Unable to create content control for selection"}),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType,
Iw:E};this.Tp.getById(E).wfe=!0;return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Iw:E}}vro(e,t){this.qh.iJ(t.id,e.Ra.node.id,!0);this.qh.iJ(t.id,e.Uc.node.id,!1);({returnValue:e}=this.Tp.Nqa(e.Ra.node.id,e.Uc.node.id));return e?OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}J4j(e){let t=e;if(!e||12!==e.type)return{returnValue:!1,kCe:t};e=Ld.GraphIterator.eb(e);if(e.zb(14))if(this.o6.zge(e.ld(14)))t=e.currentNode;else return{returnValue:!1,
kCe:t};return{returnValue:!0,kCe:t}}Zmm(e){var t;return(t=this.Tp.getById(e))?(e=this.Ej.Eb(t.pv),t=this.Ej.Eb(t.MA),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,BXj:e,mki:t}):{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,BXj:null,mki:null}}Smm(e){const t=this.Tp.getByTitle(e);if(!t.count)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeNamedItemNotFound,Iw:0};if(1<t.count)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeMultipleNamedItemFound,
Iw:0};e=t.J(0).id;t.J(0).Poc=!0;return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Iw:e}}A2c(e,t){e=this.oQ.cBa(e,t);return this.wIf(e)}WMh(e,t){const E=this.oQ.cBa(e,t.zW);let W=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;if(E){if(!this.Tp.getById(this.LVa(t.RQ)))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(E.RQ===t.RQ){if(t.MO===E.MO)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else W=this.sBj(t.zW,e);if(W!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return W}return this.oQ.iTi(e,
t)}yHf(e,t){if(e=this.oQ.cBa(e,t)){if(e=this.Tp.getById(this.LVa(e.RQ)))return e=e.getText(),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,text:e};e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return{returnValue:e,text:null}}dzg(e,t,E){(e=this.oQ.cBa(e,t))?e.MO!==Wc.text?E=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingType:(e=this.LVa(e.RQ),E=(e=this.Tp.getById(e))?e.Gye(E)?OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):E=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return E}iui(e,t,E,W){let ha=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Ka,sb={};({root:Ka}=this.fNm(e,t)).returnValue===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(W.isPartialTable&&this.o6.f3i(Ka)?ha=OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialGetNotSupported:{hNl:sb,returnValue:ha}=this.o6.gNm(Ka,E,W));return{returnValue:ha,
o_j:sb}}Rim(e,t){let E="";const W=[];(e=this.B2c(t,e,W))===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&({NWa:E,returnValue:e}=this.HRa.tJf(W,!0));return{returnValue:e,NWa:E}}HMj(e,t,E,W,ha,Ka,sb){let dc=null,xc=null;if((e=({Bra:dc}=this.A2c(e,t)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(e=({xp:xc}=this.M9d(dc)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)if(Ka.isPartialTable&&this.o6.f3i(xc))e=OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialSetNotSupported;
else if({Rgp:Ka,returnValue:e}=this.o6.dpp(xc,E,Ka),e===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.o6.psn(E,xc,Ka,ha,W)){if({ghp:W,returnValue:e}=this.o6.keo(Ka,ha,W),e===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){sb(this.vG.hSo(dc,W[0],W[1])?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,E?"table":"matrix");return}}else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize;sb(e,E?"table":"matrix")}DJm(){const e=new fa.a;
var t=new fa.a;for(var E of this.hb.gb)t.addRange(this.Tp.mN(E.Ra,E.Uc,1));if(0<t.count){E=this.oQ.Lti();Ld.GraphIterator.eb(this.hb.N4);const Ka=this.Lqn(),sb={};for(var W of t)sb[W.id.toString()]=W;for(const dc of Object.keys(sb)){t=sb[dc];for(const xc of E){var ha=xc[sg.bSh];if(this.LVa(ha.RQ)===t.id){W={["appInstanceId"]:xc[sg.jdc]};const Rc=this.oQ.o5d(xc[sg.jdc]);Rc&&(W[sg.FSd]=Rc.yo);W[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=ha.zW;W[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=ha.MO;
ha.MO===Wc.table&&t.pv&&this.a3i&&Ka&&(ha=null,{eZj:ha}=this.o6.TJm(this.Ej.Eb(t.pv)),W[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]=ha);e.add(W)}}}}return e}Xhm(e){const t=new fa.a;var E=this.oQ.Lti();for(const W of E)if(E=W[sg.bSh],this.LVa(E.RQ)===e){const ha={["appInstanceId"]:W[sg.jdc]},Ka=this.oQ.o5d(W[sg.jdc]);ha[sg.FSd]=Ka.yo;ha[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=E.zW;ha[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=E.MO;t.add(ha)}return t}uxo(e,t){e&&(e=e.instanceId,this.e2d.xjc(OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent).removeHandler(e,
null,t))}txo(e,t){e&&(e=e.instanceId,this.e2d.xjc(OSF.DDA.EventDispId.dispidBindingDataChangedEvent).removeHandler(e,null,t))}Bie(e,t,E){e=this.oQ.o5d(e);t=this.oQ.cBa(e,t);z.ULS.sendTraceTag(16798856,341,50,"{0}",{["method"]:E,["appId"]:e?e.yo:null,["bindingType"]:t?t.MO:null})}LVa(e){e=Number.parseInvariant(e);return 2147483648>e?e:e+-4294967296}xHf(e){return-1<e?e.toString():(e- -4294967296).toString()}fkm(e){let t=0;(e=this.Ej.Eb(e))&&(t=e.ja(fd.a.Iw,0));return t}Kso(){this.Tp.kWk(this.Qeg)}$qn(e){let t=
null;return({Bra:t}=this.wIf(e)).returnValue!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess||!t.fg&&!this.Pde?!1:t.isEditable&&t.isSupported}Lqn(){const e=Ld.GraphIterator.eb(this.hb.N4);if(1>=e.Dq())return!0;var t=e.Xd();let E=null;for(;t;){t=Ld.GraphIterator.eb(t);if(!t.zb(16))return!1;if(!E)E=t.ld(16);else if(E!==t.ld(16))return!1;t=e.Cu()}return!0}wIf(e){let t=null;if(!e)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,Bra:t};e=this.LVa(e.RQ);return(t=this.Tp.getById(e))?
{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Bra:t}:{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,Bra:t}}Dwf(e,t,E){let W=null;(e=({Bra:W}=this.A2c(t,e)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(e=this.vG.DPl(W)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);E(e)}Gff(e,t,E,W){let ha=null;var Ka=null;(e=({Bra:ha}=this.A2c(t,e)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
(e=({xp:Ka}=this.M9d(ha)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(Ka=vf.TableReader.Fh(Ka),e=this.o6.ndn(Ka,E)?this.vG.R6k(ha,E)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize);W(e)}Hef(e,t,E,W,ha,Ka){let sb=null;var dc=null;(e=({Bra:sb}=this.A2c(t,e)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(e=({xp:dc}=this.M9d(sb)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
(e=vf.TableReader.xg(dc),t=this.vG.m9a(dc),dc=null,e=({i_j:dc}=this.o6.mdn(t,e-t,E,W,ha)).returnValue?this.vG.z6k(sb,dc)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize);Ka(e)}jvi(e){return e?this.A9.LAi(e):new fa.a}v3c(e,t){if(e.mb(t))return e.J(t);const E=RegExp("\t","g");for(const W of e)if(W.key.replace(E," ")===t)return W.value;return null}}Object(y.a)(Jf,"AppBindingHelper",null,
[1296]);class Qk extends Sys.EventArgs{constructor(e,t,E){super();this.Agc=e;this.Cbe=t;this.Tbg=E}}Object(y.a)(Qk,"OnDataNodeInsertedEventArgs",Sys.EventArgs,[]);class $e extends Sys.EventArgs{constructor(e,t,E,W){super();this.Agc=e;this.Cbe=t;this.Yij=E;this.Tbg=W}}Object(y.a)($e,"OnDataNodeReplacedEventArgs",Sys.EventArgs,[]);var Ei=d(381);class ve{constructor(e,t,E){this.EJa=E.VVa(e);this.avd=t}get Agc(){return this.EJa.id}}Object(y.a)(ve,"CustomXmlNodeList",null,[]);class Ad{constructor(e,t){this.Ar=
new Ei.a;this.qDd=new fa.a;this.yyh=new fa.a;this.ghh=new fa.a;this.Rpk=e;this.sl=t}add(e,t){if(!t)return null;if(this.qDd.count>=this.Rpk.value){var E=this.qDd.J(0);this.wei(E);this.ghh.add(E);z.ULS.sendTraceTag(9187593,341,50,"Put the first custom xml node list id: {0} in exceeded quota array as the added custom xml touches the quota which is 1024",E)}E=Rd.a.create().toString();this.Ar.add(E,new ve(e,t,this.sl));this.qDd.add(E);return E}get(e){const t=this.Ar.J(e);if(void 0===t||null===t){if(-1<
this.yyh.indexOf(e))throw z.ULS.sendTraceTag(9187594,341,50,"Custom xml node list id: {0} is in out of date array",e),Error.invalidOperation(Ad.zig);if(-1<this.ghh.indexOf(e))throw z.ULS.sendTraceTag(9187595,341,50,"Custom xml node list id: {0} is in exceeded quota array where the quota is 1024",e),Error.invalidOperation(Ad.$li);return null}if(this.sl.VVa(t.Agc)!==t.EJa)throw this.ncj(e),z.ULS.sendTraceTag(9187596,341,50,"Put custom xml node list id: {0} in out of date array as the custom xml document has been changed",
e),Error.invalidOperation(Ad.zig);return t.avd}ncj(e){this.wei(e);this.yyh.add(e)}wei(e){this.Ar.remove(e);this.qDd.remove(e)}}Ad.$li="exceedQuota";Ad.zig="outOfDate";Object(y.a)(Ad,"CustomXmlNodeListCache",null,[1279]);class re{constructor(){this.NodeListCacheId=this.CustomXmlId=null;this.NodeIndex=0}}Object(y.a)(re,"CustomXmlNodePointer",null,[]);class ea{constructor(e,t){this.sa=new ua.a;this.sl=e;this.a6b=t}TQb(e){let t,E=null,W=null;const ha=({avd:t}=this.OKi(e)).returnValue;if(void 0===t||null===
t)return{returnValue:ha,EJa:W,QAb:E};E=t[e.NodeIndex];W=this.sl.VVa(e.CustomXmlId);return{returnValue:void 0!==W&&null!==W&&void 0!==E&&null!==E?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,EJa:W,QAb:E}}OKi(e){let t=null;try{t=this.a6b.get(e.NodeListCacheId)}catch(E){return{returnValue:this.irm(E),avd:t}}return{returnValue:t?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,avd:t}}t2j(e,t){const E=
[],W=this.a6b.add(e,t);let ha;for(let Ka=0;Ka<t.length;Ka++){ha=t[Ka];const sb=new re;sb.CustomXmlId=e;sb.NodeListCacheId=W;sb.NodeIndex=Ka;E.push(this.p6d(sb,ha))}return E}p6d(e,t){const E=this.sl.VVa(e.CustomXmlId),W={};W[OSF.DDA.Marshaling.DataNodeProperties.Handle]=e;W[OSF.DDA.Marshaling.DataNodeProperties.BaseName]=E.getNodeBaseName(t);W[OSF.DDA.Marshaling.DataNodeProperties.NamespaceUri]=E.getNodeNamespaceURI(t);W[OSF.DDA.Marshaling.DataNodeProperties.NodeType]=E.getNodeType(t);return W}kff(e,
t){this.sa.addHandler(e,t)}wsg(e,t){this.sa.removeHandler(e,t)}qmo(e,t){e=this.p6d(t,e);t=new Qk(t.CustomXmlId,!1,e);return this.Yxj(ea.ogg,t)}zjd(e,t,E){t=this.p6d(E,t);t[OSF.DDA.Marshaling.DataNodeProperties.Handle]=null;e=this.p6d(E,e);E=new $e(E.CustomXmlId,!1,t,e);return this.Yxj(ea.qgg,E)}Yxj(e,t){try{this.sa.raiseEvent(e,t)}catch(E){return z.ULS.sendTraceTag(19489935,344,10,"RaiseNodeEvent({0}): action failed. Exception message: {1}",e,E.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}irm(e){return 0>
e.message.indexOf(":")?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:e.message.split(":")[1].trim()===Ad.zig?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlOutOfDate:e.message.split(":")[1].trim()===Ad.$li?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlExceedQuota:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}ea.ogg="OnNodeInsertedInfoReceivedHandlerKey";ea.qgg="OnNodeReplacedInfoReceivedHandlerKey";ea.lmj="OnNodeDeletedInfoReceivedHandlerKey";Object(y.a)(ea,"CustomXmlHelper",null,
[1252]);var eb=d(555),Ob=d(906),Zb=d(1101),mc=d(1519),Yc=d(270);class ld extends Z.a{constructor(){super();this.FileId=null;this.IsSecondaryRevision=!1}lm(){return T.a.Atl}static construct(e,t){const E=new ld;E.FileId=e;E.IsSecondaryRevision=t;return E}}Object(y.a)(ld,"CloseFileAgaveAsyncRequest",Z.a,[]);class oe extends Z.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.SliceSize=this.FileType=0}lm(){return T.a.b3c}static construct(e,t,E,W){const ha=new oe;ha.FileId=e;ha.IsCoauthorable=
t;ha.FileType=E;ha.SliceSize=W;return ha}}Object(y.a)(oe,"GetFileAgaveApiRequest",Z.a,[]);class Vd extends Z.a{constructor(){super();this.FileId=null;this.SliceIndex=0;this.IsSecondaryRevision=!1}lm(){return T.a.Yrm}static construct(e,t,E){const W=new Vd;W.FileId=e;W.SliceIndex=t;W.IsSecondaryRevision=E;return W}}Object(y.a)(Vd,"GetFileSliceRequest",Z.a,[]);class ce{constructor(e,t){this.lpc=e;this.handler=t}}Object(y.a)(ce,"CloseAsyncRequestData",null,[]);class pe{constructor(e,t,E,W,ha=!1){this.C1f=
!1;this.Sni=e;this.fileSize=t;this.yEg=E;this.qDf=W;this.lpc=ha}}Object(y.a)(pe,"DocumentFile",null,[]);class Sd{constructor(e,t,E,W){this.mif=e;this.fileType=t;this.yEg=E;this.handler=W}}Object(y.a)(Sd,"GetFileRequestData",null,[]);class Oe{constructor(e,t,E,W){this.controlId=e;this.K9o=t;this.lpc=E;this.handler=W}}Object(y.a)(Oe,"GetFileSliceRequestData",null,[]);class ef{constructor(e,t,E,W,ha,Ka,sb){this.an=this.fhb=this.R2a=this.yRa=null;this.pOo=dc=>{if(this.gT&&this.lHa){var xc=oe.construct(this.gT(),
this.lHa.z7d(this.Cmk),dc.fileType,dc.yEg);this.yRa=new Ob.a;this.yRa.ar=xc;this.yRa.status=Zb.a.nH;this.yRa.GE="GetFileAgave";xc=this.q1(()=>{this.v_c();if(2===this.yRa.statusCode&&this.yRa.gk&&this.yRa.gk.length&&this.yRa.gk[0]){var Rc=this.yRa.gk[0];this.IXi(dc.mif)?(z.ULS.sendTraceTag(7123615,344,15,"App {0} has reach the limit of number of cached files.",dc.mif),dc.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit,null)):(Rc=this.k$h(dc.mif,Rc.FileSize,dc.yEg,null,Rc.IsSecondaryRevision),
dc.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Rc))}else z.ULS.sendTraceTag(7123614,344,15,"Fail to obtain the file."),dc.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,null)});xc.CG(this.yRa);xc.w_()}else this.v_c(),dc.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null)};this.qOo=dc=>{if(this.gT&&this.lHa){var xc=Vd.construct(this.gT(),dc.K9o,dc.lpc);this.R2a=new Ob.a;this.R2a.ar=xc;this.R2a.status=Zb.a.nH;xc=this.q1(()=>{this.v_c();if(2===this.R2a.statusCode&&
this.R2a.gk&&this.R2a.gk.length&&this.R2a.gk[0]){var Rc=this.R2a.gk[0];"undefined"===typeof Rc.SliceData?(z.ULS.sendTraceTag(20711200,344,15,"Undefined error possibly because we failed to get the file slice data"),dc.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,null)):dc.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Rc.SliceData)}else z.ULS.sendTraceTag(20711199,344,15,"Fail to obtain the file."),dc.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,
null)});xc.CG(this.R2a);xc.w_()}};this.XNo=dc=>{var xc=dc.lpc;this.gT&&this.lHa&&(xc=ld.construct(this.gT(),xc),this.fhb=new Ob.a,this.fhb.ar=xc,this.fhb.status=Zb.a.nH,xc=this.q1(()=>{this.v_c();2===this.fhb.statusCode&&this.fhb.gk&&this.fhb.gk.length&&this.fhb.gk[0]?dc.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):z.ULS.sendTraceTag(20854626,344,15,"Fail to obtain the file.")}),xc.CG(this.fhb),xc.w_())};this.AWb=dc=>{this.v_c();z.ULS.sendTraceTag(7123616,344,15,"Fail to force save the file.");
dc.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null)};this.Kwo=(dc,xc)=>{this.kGa.mb(xc)&&this.kGa.remove(xc)};this.q1=e;this.gT=t;this.lHa=E;this.Cmk=W;this.kGa=new gf.a;this.Vd=ha;this.Ga=Ka;this.Ch=sb;this.Ch.vgf(this.Kwo)}$pm(e,t,E,W){this.Vd&&(this.an=this.Vd.Vf("UserAction","GetFileAgaveApi"));e=new Sd(e,t,E,W);this.vFf(e)}dqm(e,t,E,W){this.Vd&&(this.an=this.Vd.Vf("UserAction","GetFileSliceAgaveApi"));e=new Oe(e,t,E,W);this.Gcm(e)}WNo(e,t,E,W){this.Vd&&(this.an=this.Vd.Vf("UserAction",
"CloseFileAsyncApi"));t=new ce(t,W);this.Ecm(t);this.uBj(e,E)}vFf(e){lf.a.mU(mc.a.b3c,!1,this.pOo,this.AWb,e)}Gcm(e){lf.a.mU(mc.a.b3c,!1,this.qOo,this.AWb,e)}Ecm(e){lf.a.mU(mc.a.b3c,!1,this.XNo,this.AWb,e)}k$h(e,t,E,W,ha=!1){const Ka=ef.Tpk++;t=new pe(Ka,t,E,W,ha);this.rWk(e,t);return t}v_c(){this.an&&(this.an.stop(),this.an=null)}rWk(e,t){this.kGa.mb(e)||this.kGa.Z(e,new Yc.a);this.kGa.J(e).Z(t.Sni,t)}Cxi(e,t){let E=null;this.kGa.mb(e)&&({value:E}=this.kGa.J(e).Dc(t,E));E||z.ULS.sendTraceTag(7123617,
344,15,"File {0}:{1} doesn't exist",e,t);return E}IXi(e){return this.kGa.mb(e)?2<=this.kGa.J(e).count:!1}uBj(e,t){return this.kGa.mb(e)?this.kGa.J(e).remove(t)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}static Hkf(e){return(new eb.a).Yaa(0,e)}}ef.Tpk=0;Object(y.a)(ef,"GetFileApiHelper",null,[1295]);var Nd=d(178),wb=d(3),ki=d(66),cj=d(645),Pd=d(64),Me=d(1285),Eg=d(424),Hj=d(107),Ui=d(1186),
Wj=d(217),dj=d(187),kk=d(63),Gb=d(929),Pc=d(753),xd=d(210),He=d(696);class af extends xd.a{constructor(e,t){super(new He.a,e,t);this.Ybc=null}get Lla(){return 192}createElement(e){e=super.createElement(e);this.Ybc.appendChild(e);return e}ml(e){e=super.ml(e);this.Ybc.appendChild(e);return e}get Zip(){return this.Ybc.cloneNode(!0)}rWb(){super.rWb();this.Ybc=Gb.a.createElement(this.container.ownerDocument,Pc.a.div)}xsc(){super.xsc();this.Ybc=null}dispose(){super.dispose();this.Ybc=null}}Object(y.a)(af,
"HtmlDataRenderingView",xd.a,[]);class mf{get ei(){return null!=this.I4g?this.I4g:this.I4g=ob.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(e,t,E,W,ha){this.hb=e;this.ehb=t;this.ga=E;this.Lyk=W;this.TQc=ha}Bxe(e,t,E,W){if(!e.length||!E)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;const ha=new Nd.Selection(e,t);try{this.hb.d_b(()=>{this.hb.Ic(ha)})}catch(sb){return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}const Ka=new hc.DictionaryPropertySet;Ka.setValue(dj.a.mS,
E);Ka.setValue(dj.a.Q0a,!0);return 32===this.ga.Pb(wb.a.Yqa,1,Ka)?(this.ga.ava(null,wb.a.Yqa,Ka,sb=>{const dc=Ka.ja(dj.a.tsj,null);W(32===sb.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,dc)}),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}tJf(e,t){let E="";if(!e.length)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,NWa:E};if(!this.ehb.ltn)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
NWa:E};let W=new Od.GraphTransaction(7);const ha=new Nd.Selection(e,t);let Ka=null,sb=null;try{this.hb.d_b(()=>{this.hb.Ic(ha,void 0,!0);this.ehb.w$j();W.Ab(this.ehb.coa);Ka=e[0].node.Lc;sb=this.ehb.coa.Lc;this.ehb.oYd(Object(ki.a)().Ke.me);this.ehb.v$j()})}catch(Ud){return W.dispose(),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,NWa:E}}W.dispose();var dc=[];t=new Ld.GraphIterator;t.set(this.ehb.u0j);for(var xc=t.Xd();xc;)dc.push(xc),xc=t.gyf();if(0<dc.length){this.nCl(Ka,sb);
var Rc=new Ld.GraphIterator;Rc.set(e[0].node);if(!Rc.zb(7))return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,NWa:E};xc=Rc.qt(8);t=this.LTm(this.ehb.u0j,dc);W=new Od.GraphTransaction(7);W.Ab(t);Rc=new Ld.GraphIterator;Rc.set(dc[0]);if(!Rc.zb(8))return W.dispose(),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,NWa:E};dc=Rc.qt(8);if(this.ei.qr){xc=(new cj.WACStyleSet).cla(xc);Rc=(new cj.WACStyleSet).cla(dc);for(var md=0;md<xc.JG;md++){var ud=xc.rla(md);Rc.Ref(Pd.a.YLm(ud))}Rc.uJj(dc)}else{xc=
(new cj.WACStyleSet).iba(xc);Rc=(new cj.WACStyleSet).iba(dc);for(md=0;md<xc.JG;md++)ud=xc.yBa(md),Rc.ROh(Pd.a.VLm(ud));Rc.RAg(dc)}dc=new af(this.Lyk,this.TQc);xc=document.createElement("div");dc.Odc(xc);dc.qF(t);W.Tod(dc.oc);W.dispose();E+=dc.Zip.innerHTML.replace('\\"','"');dc.dispose();dc=null}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,NWa:"<HTML>\r\n<HEAD></HEAD>\r\n<BODY>\r\n"+E+"\r\n</BODY>\r\n</HTML>"}}LTm(e,t){const E=new Me.a;Ld.GraphIterator.eb(e).Uf(E,1);return this.KTm(E,
t)}KTm(e,t){var E=!1;let W,ha=null;1===t.length&&10===t[0].type?(E=!0,ha=W=t[0]):W=new Eg.a(new Hj.a(10,kk.a.xoa));e=Ld.GraphIterator.eb(e);e.Uf(W,1);e.Yj(W);if(E)return W;E=[];for(e=0;e<t.length;e++){const Ka=t[e];23===Ka.type?0<E.length&&(ha=this.dMi(W,E),E=[]):E.push(Ka)}0<E.length&&(t=this.dMi(W,E),ha=ha?W:t);return ha}dMi(e,t){var E=!1;let W;1===t.length&&23===t[0].type?(E=!0,W=t[0]):W=new Ui.a;e=Ld.GraphIterator.eb(e);e.Uf(W,1);e.Yj(W);if(E)return W;for(E=0;E<t.length;E++){const ha=t[E];ha.id=
Hb.a.nil;e.Uf(ha,1)}return W}nCl(e,t){e=e.Bm;e=Object(Wj.d)(e).m4f();var E=t.oFg();for(var W=0;W<e.length;W++){var ha=e[W];if(ha.yc===kk.a.Vma){if(!t.zla(ha.id)){var Ka=ha.clone();t.ou(Ka,ha.id)}}else ha.yc===kk.a.H_a?(Ka=ha.clone(),Ka.id=ha.id,E.gza(Ka)):ha.yc===kk.a.hzb&&(Ka=ha.clone(),Ka.id=ha.id,E.gza(Ka))}e=t.iEf();e=Object(Wj.d)(e).m4f();for(E=0;E<e.length;E++)W=e[E],W.yc===kk.a.H_a?t.zla(W.id)||(ha=W.clone(),ha.id=W.id,t.QP(ha)):W.yc!==kk.a.hzb||t.zla(W.id)||(ha=W.clone(),ha.id=W.id,t.pkd(ha))}}
Object(y.a)(mf,"HtmlDataGetSetProvider",null,[1294]);var dg=d(202),$f=d(161);class ih{constructor(e){this.V3a=e}getOoxml(e,t,E){e=this.oYh(e);this.V3a.zDi(e,t,E)}Jvg(e,t,E,W){this.V3a.Jvg(e,t,E,W)}lye(e,t,E,W,ha,Ka,sb,dc){e=this.oYh(e);this.V3a.XOj(e,t,E,W,ha,Ka,sb,dc)}pkc(e,t){return this.V3a.pkc(e,t)}oYh(e){if(dg.a.Tf(e))return null;e=[new Nd.Selection(e,!0)];return new $f.SelectionCollection(e,0)}}Object(y.a)(ih,"OoxmlRangeManager",null,[1293]);var bi=d(540);class Hg extends bi.a{constructor(){super();
this.FileId=null;this.IsCoauthorable=!1;this.AnchorData=null;this.WordOperationId=this.InsertLocationWithContentControl=this.ContentControlId=0}lm(){return T.a.N4n}static construct(e,t,E,W,ha,Ka){const sb=new Hg;sb.FileId=e;sb.IsCoauthorable=t;sb.AnchorData=E;sb.ContentControlId=W;sb.InsertLocationWithContentControl=ha;sb.WordOperationId=Ka;return sb}}Object(y.a)(Hg,"OoXmlGetRequest",bi.a,[]);class Og extends bi.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.AnchorData=this.Ooxml=
null;this.WordOperationId=0}lm(){return T.a.O4n}static construct(e,t,E,W,ha){const Ka=new Og;Ka.FileId=e;Ka.IsCoauthorable=t;Ka.Ooxml=W;Ka.AnchorData=E;Ka.WordOperationId=ha;return Ka}}Object(y.a)(Og,"OoXmlRetrieveStylesRequest",bi.a,[]);class zd extends bi.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.AnchorData=this.Ooxml=null;this.WordOperationId=this.InsertLocationWithContentControl=this.ContentControlId=0;this.InsertFileOptions=null}lm(){return T.a.P4n}static construct(e,
t,E,W,ha,Ka,sb,dc){const xc=new zd;xc.FileId=e;xc.IsCoauthorable=t;xc.Ooxml=W;xc.AnchorData=E;xc.ContentControlId=ha;xc.InsertLocationWithContentControl=Ka;xc.WordOperationId=sb;xc.InsertFileOptions=dc;return xc}}Object(y.a)(zd,"OoXmlSetRequest",bi.a,[]);var Zd=d(28),df=d(17),An;(function(e){e[e.unknown=-1]="unknown";e[e.main=0]="main";e[e.C0p=1]="footnote";e[e.fZp=2]="endnote";e[e.rnq=3]="textbox";e[e.comment=4]="comment";e[e.YSf=5]="headerFooter"})(An||(An={}));Object(y.b)("DocumentKindType",An);
var Fg=d(1600),ym=d(1678);class dm{constructor(e,t,E,W,ha,Ka){this.xK=e;this.l7=t;this.Gnd=E;this.IEa=W;this.ooxml=ha;this.qdo=Ka}}Object(y.a)(dm,"OoxmlSelectionManagerCallBackData",null,[]);class zm{constructor(e){this.AN=null;this.AN=e}}Object(y.a)(zm,"SerializableOoxmlData",null,[]);class Mh{constructor(e,t,E,W,ha,Ka){this.IEh=WordEditorIntl.WordEditorStrings.L_Inserting;this.onFailure=sb=>{this.m_(sb.IEa);sb.l7&&sb.l7(3)};this.BE=sb=>{var dc=sb.Gnd.gk;dc?dc.length?(dc=sb.Gnd.gk[0])?dc.StatusCode?
this.Aun(sb.ooxml)?this.JWb("ooxml failed for an unknown reason",sb,0):this.JWb("Agave sent malformated OOXML",sb,7):sb.qdo(sb):this.JWb("ooxml response is null",sb,0):this.JWb("response list is empty",sb,0):this.JWb("response list is null",sb,0)};this.odo=sb=>{const dc=sb.Gnd.gk[0];dc.RetrievedStyles?(sb.xK&&sb.xK(dc.RetrievedStyles),this.m_(sb.IEa)):this.JWb("retrieved styles is null",sb,0)};this.$co=sb=>{const dc=sb.Gnd.gk[0];dc.OoXml?(sb.xK&&sb.xK(dc.OoXml),this.m_(sb.IEa)):this.JWb("ooxml is null",
sb,0)};this.pdo=sb=>{const dc=sb.Gnd.gk[0];vh.a.instance.Zb(new kh.a(0,1,0,()=>{this.HDb(mc.a.hig,!0,()=>{S.App.jf.YBe(()=>{var xc=dc.InsertedContentInfo;if(""!==xc){xc=qe.b(xc);var Rc=ym.a(xc.AN);xc=Rc.iZa;const md=ym.d(Rc.ZU),ud=Rc.jNa;Rc=ym.d(Rc.h8);xc=xc.toString()+"|"+qe.c(md)+"|"+ud.toString()+"|"+qe.c(Rc);sb.xK(xc)}else sb.xK(xc)});this.m_(sb.IEa)},(xc,Rc)=>{this.m_(sb.IEa);this.oMa("we succeeded to set ooxml but failed in the second save, most likely, the user can't see the change yet. [errorCode: {0}]",
Rc);sb.xK(null)},null,this.IEh,null)}))};this.qW=e;this.cjb=t;this.gT=E;this.Tya=W;this.HDb=ha;this.Woh=Ka}zDi(e,t,E){this.mmi(e,t,E,"ForceSaveAndGetOoXmlForSelection",!1,this.$co,null,null,0,0,0,null,(W,ha,Ka)=>Hg.construct(W,ha,Ka,0,0,0))}Jvg(e,t,E,W){const ha=this.qW.Vf("Task","ForceSaveAndRetrieveStyles");try{const Ka=Og.construct(this.gT(),this.cjb(),"{}",e,t),sb=Object.assign(new Ob.a,{ar:Ka,status:Zb.a.nH,GE:"OoxmlRetrieveStyles"}),dc=new dm(E,W,sb,ha,e,this.odo);this.HDb(mc.a.hig,!1,this.BE,
this.onFailure,dc,null,sb)}catch(Ka){this.oMa("failed in the call to retrieveStyles. most likely during ForceSave. [e:{0}] [callstack: {1}]",Ka.message,Ka.stack),this.m_(ha),W(0)}}XOj(e,t,E,W,ha,Ka,sb,dc){void 0===t||null===t?(this.oMa("Agave sent NULL OOXML"),dc(4)):this.cjb()?this.mmi(e,sb,dc,"ForceSaveAndSetOoXmlForSelection",!0,this.pdo,t,this.IEh,E,W,ha,Ka,zd.construct):(this.oMa("Document is non-coauthorable. Disabled for SET OOXML"),dc(6))}pkc(e,t){if(!e)return new fa.a;var E=e.split("|");
if(4!==E.length)return new fa.a;e=Number.parseLocale(E[0]);var W=qe.b(E[1]);W=ym.b(W);const ha=Number.parseLocale(E[2]);E=qe.b(E[3]);const Ka=ym.b(E);E=new fa.a;let sb=!1,dc=!1,xc=!1,Rc=null,md,ud=-1;for(let Ud=0;Ud<t.count;Ud++)if(md=t.J(Ud).ja(fd.a.Yc,0),sb)if(xc||(ud?(ud!==Rc.characterData.length&&E.add(Zd.a.createTextRange(Rc,ud,Rc.characterData.length)),E.add(Zd.a.Xl(Rc))):E.add(Zd.a.create(Rc)),xc=!0),ha===md){dc=!0;(e=this.QIf(t.J(Ud),Ka))&&E.add(Zd.a.createTextRange(t.J(Ud),0,e));break}else E.add(Zd.a.create(t.J(Ud)));
else if(e===md&&(sb=!0,Rc=t.J(Ud),ud=this.QIf(Rc,W),ha===md)){dc=!0;e=this.QIf(Rc,Ka);e===ud?E.add(Zd.a.Tc(t.J(Ud),ud)):E.add(Zd.a.createTextRange(t.J(Ud),ud,e));break}return sb&&dc?E:new fa.a}QIf(e,t){e=this.Tya.lZa(e.characterData,e.qa);return this.Tya.pMb(e,t)}mmi(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud){W=this.qW.Vf("Task",W);const Id={};try{let ao=0,yj=0,Up=0,hA=0;if(e){var Ee=e.currentSelection;if(Ee)if(df.SelectionEditor.KLa(Ee))this.oMa("User has selected an anchored object and it's not yet supported."),
this.m_(W),E(8);else{var kf=Ee.Ra.node,Ke=Ee.Uc.node;ao=kf.ja(fd.a.Yc,0);Up=Ke.ja(fd.a.Yc,0);yj=Pj.a.Gqb(Ee,!0);hA=Pj.a.Gqb(Ee,!1);Id.startParaId=ao;Id.endParaId=Up;Id.cpBegin=yj;Id.cpEnd=hA;if(this.Tya){var dh=this.Tya.lZa(kf.characterData,kf.qa),$h=this.Tya.SBc(dh,yj,this.Woh);e=$h;dh=this.Tya.lZa(Ke.characterData,Ke.qa);dh=$h=this.Tya.SBc(dh,hA,this.Woh);var rj=kf.ja(fd.a.Tj,2147483646),zl=Ke.ja(fd.a.Tj,2147483646);Id.textIdStart=rj;Id.textIdEnd=zl;var Wl=kf.esa;Id.documentKind=An[Wl];if(-1===
Wl||1===Wl||2===Wl)this.oMa("Unsupported DocumentKind is "+Wl),this.m_(W),E(2);else{var Rh=new Fg.a(1,ao,rj,e,Up,zl,dh,Wl),Mg=new zm(ym.c(Rh)),Xl=qe.c(Mg),ql=ud?JSON.stringify({["_importChangeTrackingMode"]:ud.importChangeTrackingMode,["_importCustomProperties"]:ud.importCustomProperties,["_importCustomXmlParts"]:ud.importCustomXmlParts,["_importPageColor"]:ud.importPageColor,["_importParagraphSpacing"]:ud.importParagraphSpacing,["_importStyles"]:ud.importStyles,["_importTheme"]:ud.importTheme}):
"",Al=Ud(this.gT(),this.cjb(),Xl,sb,xc,Rc,md,ql),Hk=Object.assign(new Ob.a,{ar:Al,status:Zb.a.nH,GE:"OoxmlSelection"}),Dj=new dm(t,E,Hk,W,sb,Ka);this.HDb(mc.a.hig,ha,this.BE,this.onFailure,Dj,dc,Hk)}}else this.oMa("IWordTextOffsetTranslator is null as it did not resolve"),this.m_(W),E(5)}else this.m_(W),E(2)}else this.oMa("SelectionCollection is null"),this.m_(W),E(9)}catch(ao){this.oMa("failed in the call to GetOoxmlForSelection. most likely during ForceSave. [e:{0}] [logData: {1}] [callstack: {2}]",
ao.message,Id,ao.stack),this.m_(W),E(0)}}JWb(e,t,E){this.oMa("[reason:{0}].",e);t.l7&&t.l7(E)}Aun(e){let t=!0;const E=this.qW.Vf("Task","SetOoxmlIsValidXML");try{const W=Sys.Net.XMLDOM(e);if(0<W.getElementsByTagName("parsererror").length)t=!1;else{const ha=W.parseError;void 0!==ha&&null!==ha&&ha.errorCode&&(t=!1)}}catch(W){t=!0,this.oMa("Failed in parsing the xml string: [message: {0}] [callstack: {1}]",W.message,W.stack)}finally{E.stop()}return t}m_(e){e&&e.stop()}oMa(e,...t){z.ULS.sendTraceTag.apply(null,
[7902996,341,15,"OoXml Operation Failed. "+e].concat(t))}}Object(y.a)(Mh,"OoxmlSelectionManager",null,[1292]);var hi=d(25),Lc=d(85),wh=d(126),lg=d(37);class ii{xCi(e,t,E){({xNo:e,cpBegin:W,DNo:t,cpEnd:E}=this.Lil(e,t,E));if(e===t)e=hi.SelectionFactory.eN(e,W,E);else{var W=hi.SelectionFactory.se(e,W);t=hi.SelectionFactory.se(t,E);e=Lc.OutlineReader.M_f(e)?W:hi.SelectionFactory.$y(W,t.Xe?t.Xe.Ra:t.Ra)}return e}Lil(e,t,E){let W;e=ii.FFf(e);t=ii.FFf(t);E=ii.FFf(E);if(e.contains(t)){var ha=ii.loc(e.Ra)?
e.Ra.node:E.Ra.node;W=e.Ra.contextId===na.a.Vc?Xf.ParagraphReader.textLength(ha):e.Ra.contextId===na.a.paragraph?0:e.Ra.cpBegin;if(ii.loc(e.Uc))if(1===e.length||2===e.length&&e.Ra.node.id===e.Uc.node.id&&e.Ra.contextId===na.a.Bd&&e.Uc.contextId===na.a.Vc)if(E.Uc.contextId===na.a.paragraph||E.Uc.contextId===na.a.Vc){var Ka=wh.a.eb(E.Uc.node);Ka.tq();Ka.qt(11);lg.OutlineElementNavigator.ht(Ka,!0,!1)?(lg.OutlineElementNavigator.Le(Ka),Ka=Ka.currentNode):Ka=E.Uc.node}else Ka=E.Uc.node;else Ka=e.Uc.node;
else E.Uc.contextId===na.a.paragraph||E.Uc.contextId===na.a.Vc?(Ka=wh.a.eb(E.Uc.node),Ka.tq(),Ka.qt(11),lg.OutlineElementNavigator.ht(Ka,!0,!1)?(lg.OutlineElementNavigator.Le(Ka),Ka=Ka.currentNode):Ka=E.Uc.node):Ka=E.Uc.node;e=e.Uc.contextId===na.a.paragraph||e.Uc.contextId===na.a.Vc?E.Uc.contextId!==na.a.paragraph&&E.Uc.contextId!==na.a.Vc||E.Uc.node.id===Ka.id?Xf.ParagraphReader.textLength(Ka):0:e.Uc.node.id===t.Uc.node.id?E.Uc.contextId===na.a.paragraph||E.Uc.contextId===na.a.Vc?Ka===E.Uc.node?
Xf.ParagraphReader.textLength(E.Uc.node):e.Uc.cpEnd-t.Uc.cpEnd:E.Uc.cpEnd+e.Uc.cpEnd-t.Uc.cpEnd:e.Uc.cpEnd}else t.contains(e)?(e=df.SelectionEditor.Dm(E)?E:df.SelectionEditor.XAa(E,{jC:!0,Kt:!1,qE:!1,$F:!0}),ha=Ka=e.Ra.node,W=e=e.Ra.cpBegin):ii.$ol(e,t)?e.Ra.node.id===e.Uc.node.id?t.Ra.node.id===e.Ra.node.id&&e.Ra.cpBegin<t.Ra.cpBegin?(ha=Ka=e.Ra.node,W=e.Ra.contextId===na.a.paragraph?0:e.Ra.cpBegin,e=t.Ra.contextId===na.a.Vc?Xf.ParagraphReader.textLength(Ka):t.Ra.cpBegin):(E.Uc.contextId===na.a.paragraph||
E.Uc.contextId===na.a.Vc?(ha=wh.a.eb(E.Uc.node),ha.tq(),ha.qt(11),lg.OutlineElementNavigator.ht(ha,!0,!1),lg.OutlineElementNavigator.Le(ha),ha=ha.currentNode,W=0):(ha=E.Uc.node,W=E.Uc.cpEnd),Ka=ha,e=e.Uc.contextId===na.a.paragraph||e.Uc.contextId===na.a.Vc?Xf.ParagraphReader.textLength(Ka):W+e.Uc.cpEnd-t.Uc.cpEnd):ii.loc(e.Ra)&&(e.Ra.node.id!==t.Ra.node.id||e.Ra.contextId===na.a.paragraph||t.Ra.contextId===na.a.Vc||e.Ra.contextId!==na.a.Vc&&e.Ra.cpBegin<=t.Ra.cpBegin)?(ha=e.Ra.node,W=e.Ra.contextId===
na.a.paragraph?0:e.Ra.contextId===na.a.Vc?t.Ra.node.id===e.Ra.node.id?E.Ra.contextId===na.a.paragraph||E.Ra.contextId===na.a.Vc?Xf.ParagraphReader.textLength(ha):E.Ra.cpBegin:Xf.ParagraphReader.textLength(ha):e.Ra.cpBegin,e=ii.X9l(e),Ka=e.node,e=t.Ra.contextId===na.a.paragraph||t.Ra.contextId===na.a.Vc?Xf.ParagraphReader.textLength(e.node):t.Ra.cpBegin):ii.loc(e.Uc)?(E.Uc.contextId===na.a.paragraph||E.Uc.contextId===na.a.Vc?(t=wh.a.eb(E.Uc.node),t.tq(),t.qt(11),lg.OutlineElementNavigator.ht(t,!0,
!1),lg.OutlineElementNavigator.Le(t),ha=t.currentNode,W=0):(ha=E.Uc.node,W=E.Uc.cpEnd),Ka=e.Uc.node,e=e.Uc.contextId===na.a.paragraph||e.Uc.contextId===na.a.Vc?Xf.ParagraphReader.textLength(Ka):e.Uc.cpEnd):(E.Uc.contextId===na.a.paragraph||E.Uc.contextId===na.a.Vc?(ha=wh.a.eb(E.Uc.node),ha.tq(),ha.qt(11),lg.OutlineElementNavigator.ht(ha,!0,!1),lg.OutlineElementNavigator.Le(ha),ha=ha.currentNode,W=0):(ha=E.Uc.node,W=E.Uc.cpEnd),Ka=ha,e=e.Uc.contextId===na.a.paragraph||e.Uc.contextId===na.a.Vc?Xf.ParagraphReader.textLength(ha):
W+e.Uc.cpEnd-t.Uc.cpEnd):e.Ra.node.id===t.Uc.node.id&&(e.Ra.cpBegin>=t.Uc.cpEnd||e.Ra.contextId===na.a.Vc)?(E.Uc.contextId===na.a.Vc||E.Uc.contextId===na.a.paragraph?(ha=wh.a.eb(E.Uc.node),ha.tq(),ha.qt(11),lg.OutlineElementNavigator.ht(ha,!0,!1),lg.OutlineElementNavigator.Le(ha),ha=ha.currentNode,W=e.Ra.contextId===na.a.Vc?Xf.ParagraphReader.textLength(e.Ra.node)-t.Uc.cpEnd:e.Ra.cpBegin-t.Uc.cpEnd):(ha=E.Uc.node,W=e.Ra.contextId===na.a.Vc?Xf.ParagraphReader.textLength(ha):e.Ra.cpBegin-t.Uc.cpEnd+
E.Uc.cpEnd),Ka=e.Ra.node.id===e.Uc.node.id?ha:e.Uc.node,e=ha===Ka?W+e.Uc.cpEnd-e.Uc.cpBegin:e.Uc.contextId===na.a.paragraph||e.Uc.contextId===na.a.Vc?Xf.ParagraphReader.textLength(Ka):e.Uc.cpEnd):(ha=e.Ra.node,W=e.Ra.contextId===na.a.paragraph?0:e.Ra.contextId===na.a.Vc?Xf.ParagraphReader.textLength(e.Ra.node):e.Ra.cpBegin,Ka=e.Uc.node,e=e.Uc.contextId===na.a.paragraph||e.Uc.contextId===na.a.Vc?Xf.ParagraphReader.textLength(e.Uc.node):e.Uc.cpEnd);return{xNo:ha,cpBegin:W,DNo:Ka,cpEnd:e}}static FFf(e){e.isForward||
(e=e.toArray(),e.reverse(),e=new Nd.Selection(e,!0));return e}static $ol(e,t){const E=e.toArray(),W=t.toArray();let ha,Ka;if(e.contains(t)||t.contains(e))return!1;for(let sb=0;sb<e.length;sb++){ha=E[sb];for(let dc=0;dc<t.length;dc++)if(Ka=W[dc],ha.node.id===Ka.node.id&&(ha.contextId===na.a.paragraph||Ka.contextId===na.a.paragraph||ha.contextId===na.a.Vc&&Ka.contextId===na.a.Vc||ha.contextId===na.a.Bd&&Ka.contextId===na.a.Bd&&(ha.cpBegin>=Ka.cpBegin&&ha.cpBegin<Ka.cpEnd||Ka.cpBegin>=ha.cpBegin&&Ka.cpBegin<
ha.cpEnd)))return!0}return!1}static loc(e){return!!e.node.anchor&&!e.node.anchor.FU&&e.node.cA}static X9l(e){if(!ii.loc(e.Ra))return null;let t=e.Ra;e=e.bR();for(e.moveNext();e.moveNext();)if(ii.loc(e.current))t=e.current;else break;return t}}Object(y.a)(ii,"SetDataVirtualSelectionMerger",null,[1291]);var Qh=d(27),fk=d(18);class bl{constructor(e,t,E){this.ga=e;this.hb=t;this.vG=E}Emn(){this.hb.N4||z.ULS.sendTraceTag(8452246,341,15,"Unexpected error to selectionManager and the selectionRoot cannot return");
return 1<Ld.GraphIterator.eb(this.hb.N4).Dq()}BKg(){let e=null;const t=Ld.GraphIterator.eb(this.hb.N4);if(t.Xd()){const E=Ld.GraphIterator.eb(t.currentNode);t.XLa&&t.Xd()&&vf.TableReader.isTable(t)?e=t.currentNode:E.zb(14)&&(e=E.ld(14))}return e?{returnValue:!0,lCe:e}:{returnValue:!1,lCe:e}}fpp(e,t){let E="";var W=null;for(let ha=0;ha<t.length;ha++)if(e.equals(t[ha].node)){W=t[ha];break}if(W){e=Xf.ParagraphReader.text(W.node);switch(W.contextId){case na.a.paragraph:E+=e;break;case na.a.Bd:t=W.cpBegin;
W=W.cpEnd-t;0<W&&(E+=e.substr(t,W));break;case na.a.Vc:break;default:return z.ULS.sendTraceTag(8452249,341,15,"Unexpected context type when trying get selected text of paragraph node, context type is:"+W.contextId),{returnValue:!1,Cwc:E}}return{returnValue:!0,Cwc:E}}return{returnValue:!1,Cwc:E}}V3j(e,t,E){let W="",ha=!1;e=Ld.GraphIterator.eb(e);const Ka=e.Dq();for(let dc=0;dc<Ka;dc++){if(e.WG(dc)){e.Xd();if(12===e.lf){if(E)W+=Xf.ParagraphReader.text(e.currentNode);else{var sb=void 0;({Cwc:sb}=this.fpp(e.currentNode,
t)).returnValue&&(W+=sb,ha=!0)}dc!==Ka-1&&(W+="\r")}else if(14===e.lf)for(sb=e.Ub(1);sb;){for(sb=e.Ub(1);sb;)ha=({dVc:sb}=this.V3j(sb,t,E)).returnValue||ha,W+=sb,e.XLa||(W+="\t"),sb=e.Cu();W+="\r\n";sb=e.Cu()}e.uc()}e.uc()}return{returnValue:ha,dVc:W}}YGi(e){const t={rows:[],headers:[]};if(!({lCe:dc}=this.BKg()).returnValue)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSelectionNotSupportCoercionType,Kwe:t};const E=Ld.GraphIterator.eb(dc),W=[];var ha={};if((ha.isSelectionManagerNull=!this.hb)||
(ha.isSelectionCollectionNull=!this.hb.gb))return z.ULS.sendTraceTag(8452252,341,10,"Unexpected error to selectionManager and contigousSelection data cannot return.{0}",ha),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Kwe:t};for(var Ka of this.hb.gb)W.push(...Ka.toArray());ha=[];var sb;var dc=this.vG.m9a(dc);Ka=0;for(sb=E.Ub(1);sb;){sb=!1;e===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&Ka<dc&&(sb=!0);for(var xc=E.Ub(1);xc;){if(!Qh.TableCellReader.$s(xc)){let Rc="";(({dVc:Rc}=this.V3j(xc,
W,sb)).returnValue||sb)&&ha.push(Rc)}xc=E.Cu()}0<ha.length&&(xc=Array.clone(ha),sb?Array.add(t.headers,xc):Array.add(t.rows,xc),Array.clear(ha));sb=E.Cu();Ka++}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Kwe:t}}IPj(e,t,E){if(this.Emn())this.Xin()?this.Iuf(e,t,E,!1):E(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection);else{let W;if(({lCe:W}=this.BKg()).returnValue){let ha,Ka;({hon:ha,pNo:Ka}=this.SJm(W));ha?(z.ULS.sendTraceTag(8458370,344,15,"SetSelectedTable failed due to the attempt to set data in a partially selected table"),
E(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)):this.Aqn(Ka,t,e)?this.z7l(W,Ka,e,t,E):this.Iuf(e,t,E,!0)}else this.Iuf(e,t,E,!1)}}$Nm(e){let t="";if(Qh.TableCellReader.$s(e))return{returnValue:!1,dVc:t};e=Ld.GraphIterator.eb(e);const E=e.Dq();for(let W=0;W<E;W++)e.WG(W)&&(e.Xd(),12===e.lf&&(t+=Xf.ParagraphReader.text(e.currentNode),W!==E-1&&(t+="\r")),e.uc()),e.uc();return{returnValue:!0,dVc:t}}f3i(e){let t=!1;vf.TableReader.kri(e,E=>{Qh.TableCellReader.$s(E)&&(t=!0)});return t}gNm(e,
t,E){let W=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;const ha={},Ka=this.vG.m9a(e),sb=vf.TableReader.xg(e)-(t?Ka:0),dc=vf.TableReader.Fh(e);let xc,Rc,md,ud,Ud;xc=E[OSF.DDA.Marshaling.BindingParameterKeys.StartRow];Rc=E[OSF.DDA.Marshaling.BindingParameterKeys.RowCount];md=E[OSF.DDA.Marshaling.BindingParameterKeys.StartCol];E=E[OSF.DDA.Marshaling.BindingParameterKeys.ColCount];if(0>xc||xc>=sb||xc+Rc>sb||0>md||md>=dc||md+E>dc)W=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetStartRowColumn;else{ud=
Rc?xc+Rc-1:sb;Ud=E?md+E-1:dc;e=Ld.GraphIterator.eb(e);const Id=[];let Ee;ha.rows=[];ha.headers=[];fk.forEachCellInTable(e,(kf,Ke,dh)=>{const $h=t&&Ke<Ka,rj=t?Ka:0;Ke=Ke>=xc+rj&&Ke<=ud+rj;dh=dh>=md&&dh<=Ud;($h||Ke)&&dh&&({dVc:Ee}=this.$Nm(kf.currentNode)).returnValue&&Id.push(Ee);kf.XLa&&0<Id.length&&(kf=Array.clone(Id),Array.add($h?ha.headers:ha.rows,kf),Array.clear(Id));return!0})}return{returnValue:W,hNl:ha}}isTable(e,t){return e.id===t.id&&14===e.type?!0:!1}zge(e){if(!e||14!==e.type)return!1;let t=
!0;const E=this.cHf(),W=new Ld.GraphIterator;W.set(e);fk.forEachCellInTable(W,ha=>Qh.TableCellReader.$s(ha.currentNode)||this.Aee(ha.currentNode,E)?!0:t=!1);return t}Bqn(){let e;return({lCe:e}=this.BKg()).returnValue?this.zge(e):!1}z7l(e,t,E,W,ha){const Ka=Fa.a.gUh,sb=[];sb.push(t);sb.push(E);sb.push(W);sb.push(e);32===this.ga.Ob(Ka,1)?this.ga.ava(null,Ka,sb,dc=>{32!==dc.response&&z.ULS.sendTraceTag(8458371,344,10,"SetSelectedTable failed with error {0}",dc.response);ha(32===dc.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}):(z.ULS.sendTraceTag(8458372,344,10,"SetSelectedTable failed due to the action is not enabled"),ha(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection))}Iuf(e,t,E,W){W?this.ga.Ob(wb.a.SW,2):this.ga.Ob(wb.a.SJ,2);t=this.EBl(e,t);e=new hc.DictionaryPropertySet;e.setValue(dj.a.mS,t);e.setValue(dj.a.zna,!0);t=wb.a.Yqa;32===this.ga.Ob(t,1)?this.ga.ava(null,t,e,ha=>{E(32===ha.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}):
E(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)}EBl(e,t){const E=document.createElement("div"),W=document.createElement("table");var ha=document.createAttribute("border");ha.value="1";W.attributes.setNamedItem(ha);E.appendChild(W);if(e&&e.length){ha=document.createElement("tr");W.appendChild(ha);for(var Ka=0;Ka<e.length;++Ka){var sb=document.createElement("th");sb.innerText=e[Ka]?e[Ka].toString():"";ha.appendChild(sb)}}for(e=0;e<t.length;++e)for(ha=t[e],Ka=document.createElement("tr"),
W.appendChild(Ka),sb=0;sb<ha.length;++sb){const dc=document.createElement("td");dc.innerText=ha[sb]?ha[sb].toString():"";Ka.appendChild(dc)}return E.innerHTML}Aqn(e,t,E){if(e.length!==t.length+(E?1:0))return!1;if(E){if(e[0].length<E.length)return!1;for(E=1;E<e.length;++E)if(e[E].length<t[E-1].length)return!1}else for(E=0;E<e.length;++E)if(e[E].length<t[E].length)return!1;return!0}cHf(){const e=[];for(const t of this.hb.gb)e.push(...t.toArray());return e}SJm(e){let t=!1,E=!1,W=!1;const ha=[],Ka=this.cHf();
e=Ld.GraphIterator.eb(e);var sb=e.Ub(1);let dc=!0;for(;sb;){sb=[];let xc=e.Ub(1);for(;xc;)Qh.TableCellReader.$s(xc)?E=!0:this.Aee(xc,Ka)?(dc&&(W=!0),sb.push(xc)):t=!0,xc=e.Fk();dc=!1;ha.push(sb);e.uc();sb=e.Fk()}return{hon:t,l5p:E,i5p:W,pNo:ha}}Aee(e,t){var E=this.Jyi(e);e=this.lBi(e);let W=0,ha=!1;for(;W<t.length;++W){const Ka=t[W];if(Ka.node===E)if(Ka.contextId===na.a.paragraph||Ka.contextId===na.a.Vc){ha=!0;++W;break}else return!1}if(!ha||E===e)return ha;for(;W<t.length;++W)if(E=t[W],E.node===
e)if(E.contextId===na.a.paragraph||E.contextId===na.a.Vc){ha=!0;break}else return!1;return ha}isSelected(e,t){let E;for(let W=0;W<t.length;++W)if(E=Ld.GraphIterator.eb(t[W].node),E.zb(16)&&E.ld(16)===e)return!0;return!1}lBi(e){e=Ld.GraphIterator.eb(e);var t=e.Dq();for(--t;-1<t;--t){if(e.WG(t)){e.Xd();if(12===e.lf)return e.currentNode;if(14===e.lf){const E=this.lBi(e.currentNode);if(E)return E}e.uc()}e.uc()}return null}Jyi(e){e=Ld.GraphIterator.eb(e);const t=e.Dq();for(let E=0;E<t;++E){if(e.WG(E)){e.Xd();
if(12===e.lf)return e.currentNode;if(14===e.lf){const W=this.Jyi(e.currentNode);if(W)return W}e.uc()}e.uc()}return null}Xin(){let e=null,t=null,E=Ld.GraphIterator.eb(this.hb.N4);0<E.Dq()&&E.Xd()&&E.Xd()&&14===E.lf&&(e=E.currentNode);E=Ld.GraphIterator.eb(this.hb.N4);1<E.Dq()&&E.S_()&&E.Xd()&&14===E.lf&&(t=E.currentNode);return e&&!this.zge(e)||t&&!this.zge(t)?!1:!0}TJm(e){const t={},E=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;if(e.Ide())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialGetNotSupported,
eZj:t};const W=this.cHf(),ha=Ld.GraphIterator.eb(e);let Ka=-1,sb=-1,dc=-1,xc=-1;fk.forEachCellInTable(ha,(Rc,md,ud)=>{if(this.isSelected(Rc.currentNode,W)){if(-1===Ka||-1===sb)Ka=md,sb=ud;dc=dc<md?md:dc;xc=xc<ud?ud:xc}else if(-1<sb&&ud>=sb&&ud<=xc)return!1;return!0});E===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(e=this.vG.m9a(e),dc>=e&&(Ka=Ka>=e?Ka-e:0,t[OSF.DDA.Marshaling.TableSubsetKeys.StartRow]=Ka,t[OSF.DDA.Marshaling.TableSubsetKeys.RowCount]=dc-e-Ka+1),t[OSF.DDA.Marshaling.TableSubsetKeys.StartColumn]=
sb,t[OSF.DDA.Marshaling.TableSubsetKeys.ColumnCount]=xc-sb+1);return{returnValue:E,eZj:t}}ndn(e,t){let E=0;for(let W=0;W<t.length;W++)t[W].length>E&&(E=t[W].length);return E===e}mdn(e,t,E,W,ha){let Ka=[];ha||(E=Array(e));return(!E&&!e||E&&E.length===e)&&t===W.length?(Ka=E.concat(W),{returnValue:!0,i_j:Ka}):{returnValue:!1,i_j:Ka}}psn(e,t,E,W,ha){e=e?this.vG.m9a(t):0;if(!E||!W||E.length<W.length+e)return!1;if(ha){if(ha.length!==e)return!1;for(t=0;t<W.length+e;t++)if(E[t].length<(t<e?ha[t]:W[t-e]).length)return!1}else for(ha=
0;ha<W.length;ha++)if(E[ha].length<W[ha].length)return!1;return!0}dpp(e,t,E){const W=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;let ha=0,Ka=0;ha=E.startRow;Ka=E.startCol;const sb=this.vG.m9a(e),dc=t?sb:0,xc=[],Rc=[],md=Ld.GraphIterator.eb(e);fk.forEachCellInTable(md,(ud,Ud,Id)=>{if(!Qh.TableCellReader.Wg(md)){const Ee=Ud>=ha+dc;Id=Id>=Ka;(t&&Ud<sb||Ee)&&Id&&xc.push(ud.currentNode);ud.XLa&&0<xc.length&&(ud=Array.clone(xc),Rc.push(ud),Array.clear(xc))}return!0});return{returnValue:W,Rgp:Rc}}keo(e,
t,E){const W=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,ha=[],Ka=[],sb=[],dc=E?E.length:0;for(let xc=0;xc<t.length+dc;xc++){const Rc=xc<dc?E[xc]:t[xc-dc],md=e[xc];for(let ud=0;ud<Rc.length;ud++)Ka.push(md[ud]),sb.push(Rc[ud])}ha.push(Ka);ha.push(sb);return{returnValue:W,ghp:ha}}}Object(y.a)(bl,"TableMatrixHelper",null,[]);var Ji=d(1965),yl=d(90),ej=d(88),ch=d(67),gk=d(1655);class ri extends gk.a{constructor(e,t,E){super(e,t,E)}IDp(){return Yi.a.HBe}KAc(e){let t=null;if(this.xT&&!e)return z.ULS.sendTraceTag(594408837,
307,10,"No htmlDomContent"),{returnValue:!1,Cka:t};if(!this.IDp())return this.Ec.$b(ej.a.usa,{["Reason"]:ch.a.HXh}),{returnValue:!1,Cka:t};try{const E=ri.Myl(e);t=jSanity.sanitize(E)}catch(E){return z.ULS.shipAssertTag(6423694,307,!1),this.Ec.$b(ej.a.usa,{["Reason"]:ch.a.kmf}),{returnValue:!1,Cka:t}}return{returnValue:!0,Cka:t}}static Myl(e){const t={};t.inputString=e;t.allowLinks=!0;t.customProtocols={};t.customProtocols["data:image/"]=1;t.externalContentCallback=(E,W,ha,Ka)=>{let sb=!1;if("attribute"===
E&&"src"===W){W=yl.a.FR(Ka);for(const dc of W)if(ha.startsWith(dc)){sb=!0;break}W=yl.a.FR(t.customProtocols);for(const dc of W)if(ha.startsWith(dc)){sb=!0;break}}sb||(ha="CSSURL"===E?'url("about:blank")':"about:blank");return ha};return t}}Object(y.a)(ri,"ExternalHtmlStringImportStrategy",gk.a,[]);var Hf=d(245);class lk{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc=null){var md;this.xRc=!1;this.SYo=4;this.RYo=(ud,Ud,Id,Ee,kf)=>{if(1===Id)return 32;if(!kf||kf.length!==this.SYo)return 8;ud=kf[0];Ee=kf[1];Ud=
kf[2];Id=kf[3];kf=this.Pc.Mc(15);kf.Ab(Id);if(32!==this.ga.Ob(wb.a.Wra,2))return 8;Id=0;if(Ee){for(var Ke=0;Ke<Ee.length;++Ke){var dh=ud[Id];Ee[Ke]&&this.iQj(dh[Ke],Ee[Ke].toString())}Id++}for(Ee=0;Ee<Ud.length;++Ee){Ke=Ud[Ee];dh=ud[Id];for(let $h=0;$h<Ke.length;++$h)Ke[$h]&&this.iQj(dh[$h],Ke[$h].toString());Id++}kf.dispose();return 32};this.QQi=(ud,Ud,Id,Ee,kf,Ke)=>{var dh,$h;if(Ud===wb.a.Yqa&&(null===(dh=Id.view)||void 0===dh?0:dh.te)&&(dh=Id.view,dh.lb&&(null===($h=this.ul)||void 0===$h?0:$h.Vla(dh.lb.Og))))return null;
$h=this.Fz.J(Ud.toString());this.pja&&Ke&&Object(ak.a)(97,Ke)&&(dh=this.pja.Fqd(),dh.qdc("ImportDataAction"),Ke.setValue(dj.a.Oza,dh));return this.rWd.create(ud,Ud,$h,new Ue.a(()=>this.$Yc(Ud,Ke)),Id,Ee,kf,Ke)};this.ga=e;this.vd=t;this.Qd=W;this.Kqk=Ka;this.Pc=ha;this.Pk=sb;this.pja=Rc;this.pT=E;this.ul=xc;dc&&(this.xRc=dc.$("UseClipboardDataHelperInMultiLineImportIsEnabled"));this.Fz=new gf.a;this.Fz.Z(wb.a.eTd.toString(),262145);this.Fz.Z(wb.a.Yqa.toString(),262145);if(null===(md=null===v.AFrameworkApplication||
void 0===v.AFrameworkApplication?void 0:v.AFrameworkApplication.K)||void 0===md?0:md.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveEmptyParagraphAfterPasteIsEnabled",!1))e=this.Fz.J(wb.a.Yqa.toString()),this.Fz.Z(wb.a.Yqa.toString(),e|524288)}get rWd(){return this.Kqk.value}Wb(){this.ga.wW(wb.a.eTd,na.a.view,this.QQi,1028);this.ga.wW(wb.a.Yqa,na.a.view,this.QQi,4|(v.AFrameworkApplication.$u&&16384));this.ga.fb(Fa.a.gUh,na.a.view,this.RYo,4)}iQj(e,t){e=Ld.GraphIterator.eb(e);e.Ub(1)||this.pT.Hja(e,
!0);e=lg.OutlineElementNavigator.Le(e);this.Qd.Ne(Zd.a.Tc(e,0),t)}$Yc(e,t){if(e===wb.a.eTd)return new Ji.a(t,this.vd,this.Pk,this.xRc,Hf.WoncaApp.instance.J_a);if(e===wb.a.Yqa)return new ri(t,this.vd,Hf.WoncaApp.instance.J_a);z.ULS.shipAssertTag(6348963,341,!1,"Could not find an import strategy for action {0}",e);return null}}Object(y.a)(lk,"AppsForOfficeApiActor",null,[]);class fi{constructor(e,t,E,W=null){this.appName=e;this.appVersion=t;this.clientMode=E;this.formFactor=W||"DefaultSettings"}}Object(y.a)(fi,
"HostInfo",null,[]);class Ab{constructor(e,t,E=null){this.appUILocale=e;this.dataLocale=t;this.lcid=E}}Object(y.a)(Ab,"LocaleInfo",null,[]);var jc=d(1510);class Jc{constructor(){this.startTime=0;this.callback=null}}Object(y.a)(Jc,"SSOCallbackInfo",null,[]);class yd{constructor(){this.accessToken=null}}Object(y.a)(yd,"AccessTokenInformation",null,[847]);class Be{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.o6a=this.P1b=this.JKf=this.oPf=this.S4c=this.ZHg=null}}Object(y.a)(Be,
"AppsForOfficeOauthResult",null,[]);class we{constructor(){this.token=null;this.expiresOn=0;this.o6a=this.authChallenge=null}}Object(y.a)(we,"CachedTokenInfo",null,[]);class wf{constructor(){this.kia=new fa.a;this.RTa=this.QTa=!1;this.ifb=this.authChallenge=null;this.startTime=this.retryCount=0;this.SQh=null}get callbacks(){return this.kia}}Object(y.a)(wf,"SSORequestInfo",null,[]);class rf extends wf{constructor(){super();this.errorCode=0}}Object(y.a)(rf,"SSOFailedRequestInfo",wf,[]);class xg{static nMa(e,
t,E,W){var ha=e.startTime;let Ka=0;0<ha&&(Ka=xg.Yp()-ha);ha={["callInstanceId"]:ha.toString(),["callDuration"]:Ka.toString(),["errorCode"]:t.toString()};if(W)for(const sb in W)ha[sb]=W[sb];z.ULS.sendTraceTag(51401116,344,50,"{0}",ha);cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:Sb.a.fI(ha)}));e.callback(t,E)}static Yp(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(e){}return Date.now()}}
Object(y.a)(xg,"AppsForOfficeSingleSignOnManagerStatic",null,[]);class Nh{constructor(e,t,E,W){this.fqa=new fa.a;this.L5=new fa.a;this.Zgb=null;this.mOc=new fa.a;this.zsh=Promise.resolve(null);this.HFh=!1;this.lLd=t;this.IQa=e;this.ENd=E;this.Rmk=W}p3o(e){if(this.Zgb&&this.Zgb.authChallenge===e.authChallenge){if(Date.now()/1E3+Nh.MJn>this.Zgb.expiresOn)return this.Zgb=null,!1;e=new Be;e.token=this.Zgb.token;e.expiresOn=this.Zgb.expiresOn;e.o6a=this.Zgb.o6a;e.P1b=!0;e.S4c=0;this.O5c(e);return!0}return!1}q1o(e){for(let t=
0;t<this.L5.count;t++)if(this.L5.J(t).authChallenge===e.authChallenge&&this.L5.J(t).ifb===e.ifb){let E;(E=this.L5.J(t)).retryCount=E.retryCount+1;e.retryCount=this.L5.J(t).retryCount;if(this.L5.J(t).retryCount<Nh.B8f||!this.L5.J(t).QTa&&e.QTa||!this.L5.J(t).RTa&&e.RTa){if(!this.L5.J(t).QTa&&e.QTa||!this.L5.J(t).RTa&&e.RTa)e.retryCount=0;this.L5.removeAt(t);break}e=new Be;e.errorCode=this.L5.J(t).errorCode;this.O5c(e);return!0}return!1}UZk(e,t){for(let E=0;E<this.L5.count;E++)if(this.L5.J(E).ifb===
e.ifb&&this.L5.J(E).authChallenge===e.authChallenge)return;this.L5.add(Object.assign(new rf,{QTa:e.QTa,RTa:e.RTa,authChallenge:e.authChallenge,ifb:e.ifb,errorCode:t,retryCount:e.retryCount}))}get resource(){return this.lLd}LGf(e,t,E,W,ha,Ka){""===E&&(E=null);if(this.HFh)xg.nMa(Ka,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var sb=null;for(const dc of this.fqa)if(dc.QTa===e&&dc.RTa===t&&dc.authChallenge===E&&dc.ifb===ha){sb=dc;break}sb||(sb=Object.assign(new wf,{QTa:e,RTa:t,
authChallenge:E,SQh:W,ifb:ha,retryCount:0,startTime:xg.Yp()}),this.fqa.add(sb));sb.retryCount=0;sb.callbacks.add(Ka);this.zsh=this.zsh.then(()=>{if(0<this.fqa.count){var dc=this.fqa.J(0);if(this.p3o(dc)||this.q1o(dc))return null;for(var xc=0;xc<this.mOc.count;)this.mOc.J(xc)+Nh.vjp<xg.Yp()?this.mOc.removeAt(xc):xc++;if(this.mOc.count>=Nh.jKn||this.fqa.count>=Nh.GJn)return dc=new Be,dc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.O5c(dc),null;let Rc=null;v.AFrameworkApplication.ua&&
(xc=v.AFrameworkApplication.ua.hs)&&(Rc=xc.Vf("ComponentAttach",this.IQa+Nh.VOk));return dc.ifb.cUk(this.resource,dc.QTa,dc.RTa,dc.authChallenge,this.Rmk,dc.SQh).then(md=>{Rc&&Rc.stop();this.O5c(md)},()=>{Rc&&Rc.stop();const md=new Be;md.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.O5c(md)})}return null})}}O5c(e){try{if(this.fqa.count){var t=this.fqa.J(0);this.fqa.removeAt(0);var E=null;e.errorCode||(E=new yd,E.accessToken=e.token);e.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&
e.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&e.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&e.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.UZk(t,e.errorCode);var W={};null!=e.S4c&&(W.getTokenSilentTime=e.S4c.toString());null!=e.oPf&&(W.getTokenPopupTime=e.oPf.toString());null!=e.JKf&&(W.getIDTokenTime=e.JKf.toString());null!=e.P1b&&(W.tokenCached=e.P1b.toString());e.ZHg&&(W.detailedError=e.ZHg);e.o6a&&(W.authLibrary=e.o6a);
t.retryCount&&(W.retryCount=t.retryCount);for(var ha of t.callbacks)xg.nMa(ha,e.errorCode,E,W);null!=e.P1b&&e.P1b||this.mOc.add(t.startTime);if(!e.errorCode)for(null!=e.expiresOn&&(this.Zgb=Object.assign(new we,{token:e.token,expiresOn:e.expiresOn,authChallenge:t.authChallenge,o6a:e.o6a})),this.L5.clear(),ha=0;ha<this.fqa.count;)if(this.fqa.J(ha).authChallenge===t.authChallenge){for(const Ka of this.fqa.J(ha).callbacks)xg.nMa(Ka,e.errorCode,E,W);this.fqa.removeAt(ha)}else ha++}}catch(Ka){z.ULS.sendTraceTag(21628945,
344,10,"ReceivedAccessTokenHandler: exception message: {0}",Ka.message)}}shutdown(){this.HFh=!0;this.fqa.clear()}}Nh.vjp=6E4;Nh.jKn=6;Nh.GJn=6;Nh.B8f=3;Nh.MJn=300;Nh.VOk="GetAccessToken";Object(y.a)(Nh,"SSOCallbackManager",null,[]);var Rj=d(671);class Ig{constructor(e,t,E=null){this.j4b=new gf.a;const W=new fa.a;t&&W.add(t.iHn);E&&W.addRange(E);this.tk=e;this.MQk=W}xxo(e){this.j4b.mb(e)&&(this.j4b.J(e).shutdown(),this.j4b.remove(e))}MGf(e,t,E,W,ha,Ka,sb,dc,xc,Rc){Rc=Object.assign(new Jc,{startTime:xg.Yp(),
callback:Rc});try{const Ud=!!E&&""!==E;var md=Rc.startTime;const Id=this.getOsfControl(e);let Ee=Id.getStoreType()||"",kf=Id.getOwnerAddinStoreType()||"",Ke=Id.getSolutionId()||"";const dh=Id.getVersion()||"";Ee=Ee.toLowerCase();kf=kf.toLowerCase();Ke=Ke.toLowerCase();var ud=A.a.GKf(t)||"";const $h=A.a.GKf(Id.getIframeUrl())||"",rj=ud.toLowerCase()===$h.toLowerCase();ud=Ee;"inmemory"===Ee&&(ud=kf);const zl=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ke,ud,Id.getAssetId(),null,null,Id.getStoreId()),
Wl={["callInstanceId"]:md.toString(),["controlSolutionId"]:zl,["controlVersion"]:dh,["storeType"]:Ee,["ownerStoreType"]:kf,["allowConsentPrompt"]:W.toString(),["forMSGraphAccess"]:ha.toString(),["allowSignInPrompt"]:Ka.toString(),["hasAddinAuthChallenge"]:Ud.toString(),["securityOriginEqualsSourceLocation"]:rj.toString(),["singleSignOnEnabled"]:sb.toString(),["accountTypeFilter"]:dc||""};z.ULS.sendTraceTag(51401115,344,50,"{0}",Wl);cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",
dataFields:Sb.a.fI(Wl)}));md=!0;const Rh=v.AFrameworkApplication.K.kb("HostAuthType");switch(dc){case "aad":md="aad"===Rh;break;case "msa":md="msa"===Rh;break;default:md=!dc||"noFilter"===dc}if(md){dc=null;if(sb)for(const Mg of this.MQk)if(Mg.cin(Ke)){dc=Mg;break}dc?this.isSSOAddin(e)?(sb=!0,"omex"===ud&&(sb=!1),"spapp"===ud||"spcatalog"===ud?(z.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),xg.nMa(Rc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)):ha&&!sb?(z.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),xg.nMa(Rc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(ha&&"exchange"===ud&&(W=!1),this.LGf(e,t,E,ud,W,Ka,xc,dc,Rc))):(z.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),xg.nMa(Rc,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):xg.nMa(Rc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)}else xg.nMa(Rc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(Ud){this.zie(),z.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",Ud.message),xg.nMa(Rc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(e,t,E,W){this.MGf(e,E[nc.a.jhf]||null,E[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,E[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||
!1,E[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,E[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,t,E[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,E[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,W)}LGf(e,t,E,W,ha,Ka,sb,dc,xc){this.j4b.mb(e)?W=this.j4b.J(e):(W=new Nh(e,this.getWebApplicationResource(e).split(",")[0],W,this.getDefaultDisplayName(e)),this.j4b.add(e,W));const Rc=W.resource;
e=Ig.lIm(Rc,this.getWebApplicationId(e));const md=OfficeExt.WACUtils.getHostSecure(t);e&&md?e.toLowerCase()===md.toLowerCase()?W.LGf(ha,Ka,E,sb,dc,xc):(Ig.$Ub('SSO Resource "'+Rc+'" cannot be used from "'+t+'" origin due to domain mismatch.'),z.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),xg.nMa(xc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(e||z.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),
md||z.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),xg.nMa(xc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}zie(){z.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(e){return this.tk.getOsfControl(e)}isSSOAddin(e){return this.getOsfControl(e).getManifest().isSSOAddin()}getWebApplicationId(e){return this.getOsfControl(e).getManifest().getWebApplicationId()}getWebApplicationResource(e){return this.getOsfControl(e).getManifest().getWebApplicationResource()}getDefaultDisplayName(e){return this.getOsfControl(e).getManifest().getDefaultDisplayName()}static YKm(){try{const e=
{};Yi.a.RXa&&Rj.a.E6c&&(e.UiHostSupportsAuthTokenAddinList=Ig.upi);e.UiHostSupportsAuthToken=Rj.a.E6c;return e}catch(e){z.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",e.message)}return null}static getInstance(e,t,E=null){Ig._instance||(Ig._instance=new Ig(e,E));return Ig._instance}static Qnl(e){Ig._instance&&Ig._instance.xxo(e)}static $Ub(e){window.console.warn&&window.console.warn(e)}static lIm(e,t){if(!e)return"";t||(t="");let E=e.toLowerCase();var W=
t.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(W)||(Ig.$Ub('SSO App Id "'+t+'" is not a valid format. It will be rejected from store submission.'),z.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));E.endsWith(W)||(Ig.$Ub('SSO Resource "'+e+'" does not end with App Id "'+t+'". It will be rejected from store submission.'),z.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!E.startsWith("https://")&&!E.startsWith("api://"))return Ig.$Ub('SSO Resource "'+
e+'" must be https:// or api:// protocol.'),z.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(t=0;t<e.length;t++){W=e.charAt(t);const ha=Qd.a.charCodeAt(e,t);if(33>ha||126<ha||"&"===W||"?"===W||"#"===W||"%"===W||"\\"===W)return Ig.$Ub('SSO Resource "'+e+'" contains an invalid character "'+W+'".'),z.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+W+"' in resource URI."),""}if(0<=e.indexOf("::"))return Ig.$Ub('SSO Resource "'+e+'" contains an invalid string "::".'),
z.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<e.length)return Ig.$Ub('SSO Resource "'+e+'" is '+e.length+" characters and exceeds the max length of 120 characters."),z.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+e.length+"."),"";E.startsWith("api://")&&(E="https://"+E.substring(6,E.length));return 8===E.length?"":OfficeExt.WACUtils.getHostSecure(E)||""}}Ig.upi="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
Ig._instance=null;Object(y.a)(Ig,"AppsForOfficeSingleSignOnManager",null,[42]);var ll=d(103);class mk{constructor(e=null,t=null,E,W=null,ha=null,Ka=null,sb=null,dc=null,xc=null,Rc=null,md=null,ud=null,Ud=null,Id=null,Ee=null,kf=null){this.osfOmexBaseUrl=e;this.devCatalogUrl=t;this.spBaseUrl=W;this.docUrl=ha;this.pageBaseUrl=Ka;this.localizedScriptsUrl=sb;this.localizedImagesUrl=dc;this.localizedStylesUrl=xc;this.localizedResourcesUrl=Rc;this.firstPartyManifestCDNUrl=md;this.sdxCdnUrl=ud;this.sdx1CdnUrl=
Id;this.sdxDmsUrl=Ud;this.sovereignFederationDMSToken=Ee;this.sovereignFederationDMSTokenSuffix=kf}}Object(y.a)(mk,"UrlInfo",null,[]);class Bh{constructor(e,t=null){this.userNameHashCode=e;this.loggableUserId=t}}Object(y.a)(Bh,"UserInfo",null,[]);class rp{constructor(){this.hostFeatureGateFlag=0;this.XWc=!1}Tzi(){return new fi(OSF.AppName.WordWebApp,"16",OSF.ClientMode.ReadWrite)}UBi(){const e=mb.a.Cg(v.AFrameworkApplication.lcid);return new Ab(e?e.name:null,jc.a.dataCulture.name,v.AFrameworkApplication.lcid.toString())}Yzm(){v.AFrameworkApplication.K.$("SetAppContextInIframeNameIsEnabled")&&
(this.hostFeatureGateFlag|=1);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SetAppContextInIframeEnabledFor3rdPartyIsEnabled",!1)&&(this.hostFeatureGateFlag|=2);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InitFlightingTreatmentAppSettings",!1)&&(v.AFrameworkApplication.K.appSettings.FlightingTreatmentVariables=v.AFrameworkApplication.K.E8a);return{["omexForceAnonymous"]:!1,["allowExternalMarketplace"]:v.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&
this.XWc,["approvedAddIns"]:v.AFrameworkApplication.K.kb("ApprovedAddIns"),["enableAddinCommands"]:v.AFrameworkApplication.K.$("AddInCommandsIsEnabled"),["enableBlackForestRedirect"]:v.AFrameworkApplication.K.$("BlackForestRedirectIsEnabled"),["enableMyApps"]:v.AFrameworkApplication.K.$("InsertAgaveEnableMyAppsForHost"),["enableMyOrg"]:v.AFrameworkApplication.K.$("InsertAgaveMyOrgEnabledForHost"),["enableDevCatalog"]:v.AFrameworkApplication.K.$("AppsForOfficeDevCatalogIsEnabled"),["enableTaskpaneUpgradeToAppCommand"]:v.AFrameworkApplication.K.$("WordEditorTaskpaneUpgradeToAppCommandIsEnabled"),
["enableUploadFileDevCatalog"]:v.AFrameworkApplication.K.$("AddInCommandsIsEnabled")&&!v.AFrameworkApplication.K.$("UploadFileDevCatalogIsDisabled"),["enablePrivateCatalog"]:v.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled"),["showSignOutFromPrivateCatalogMessage"]:v.AFrameworkApplication.K.$("ShowSignOutFromPrivateCatalogMessage"),["envCode"]:v.AFrameworkApplication.K.appSettings.OfficeAddinTelemetryDataSourceCode,["enableFirstPartySSO"]:v.AFrameworkApplication.K.$("WordEditorAppsForOfficeFirstPartySSO"),
["enableSingleSignOnForAddin"]:v.AFrameworkApplication.K.$("WordEditorAppsForOfficeSingleSignOnIsEnabled")&&v.AFrameworkApplication.Sdn,["hideAppsExtensionUrl"]:v.AFrameworkApplication.hideAppsExtensionUrl,["enableAnonymousUseLegacyCatalogService"]:v.AFrameworkApplication.K.$("AnonymousUseLegacyCatalogServiceIsEnabled"),["enableInsertDialogAccessibilityFix"]:v.AFrameworkApplication.K.$("OfficeAddinEnableInsertDialogAccessibilityFix"),["FollowDestinationFormattingPasteIsEnabled"]:!1,["enableDisplayBlockedMinorError"]:v.AFrameworkApplication.K.$("WordEditorDisplayBlockedMinorErrorIsEnabled"),
["disableAppsForOfficeThirdParty"]:v.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled"),["wacSessionId"]:v.AFrameworkApplication.userSessionId,["disableLogging"]:!v.AFrameworkApplication.K.$("AriaLoggingIsEnabled"),["enableFirstPartySDXErrorMessages"]:v.AFrameworkApplication.K.$("OfficeAddinEnableFirstPartySDXErrorMessages"),["isHostDocumentDomain"]:v.AFrameworkApplication.K.$("AppsForOfficeIsJSHostDocumentDomain"),["sessionStartInfoJson"]:v.AFrameworkApplication.K.kb("SessionStartInfoJson"),
["FollowDestinationThemePasteIsEnabled"]:!1,["sdxAssetsToPrefetchMapping"]:v.AFrameworkApplication.K.kb("SdxAssetsToPrefetchMapping"),["wopiHostOriginFromPostMessage"]:v.AFrameworkApplication.wopiHostOriginFromPostMessage,["wopiHostOriginFromWacPropBag"]:v.AFrameworkApplication.K.kb("PostMessageOrigin"),["wacIsEmbedded"]:v.AFrameworkApplication.K.$("IsEmbedded"),["accessibilityAllowFocusAddinTaskpane"]:v.AFrameworkApplication.K.$("AccessibilityAllowFocusAddinTaskpane"),["isHostFrameTrustCheckEnabledForAddIns"]:v.AFrameworkApplication.K.$("HostFrameTrustCheckIsEnabledForAddIns"),
["isHostFrameTrusted"]:v.AFrameworkApplication.isHostFrameTrusted,["isUpnCheckEnabled"]:v.AFrameworkApplication.K.$("IsUpnCheckEnabled"),["wacUpn"]:v.AFrameworkApplication.K.kb("UserPrincipalName"),["hostInstallAddIns"]:v.AFrameworkApplication.K.kb("HostInstallAddIns"),["hostInstallAddInsIsEnabled"]:v.AFrameworkApplication.K.$("HostInstallAddInsIsEnabled"),["hostAllowedOfficeStore"]:v.AFrameworkApplication.K.$("HostAllowedOfficeStore"),["hostAllowedSdxEmbedding"]:v.AFrameworkApplication.K.$("HostAllowedSdxEmbedding"),
["addinEnforceHttpsIsEnabled"]:v.AFrameworkApplication.K.$("AddinEnforceHttpsIsEnabled"),["hostFeatureGateFlag"]:this.hostFeatureGateFlag,["appSettings"]:v.AFrameworkApplication.K.appSettings,["singleSignOnSettings"]:Ig.YKm(),["flightingTreatmentVariables"]:v.AFrameworkApplication.K.E8a,["addinActionDefinitionHybridModeIsEnabled"]:v.AFrameworkApplication.K.$("AddinActionDefinitionHybridModeIsEnabled"),["AllowStorageAccessByUserActivationOnIFrame"]:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AllowStorageAccessByUserActivationOnIFrame",
!1),["enableSetFocusOnTaskpaneOnUserAction"]:!0,["officeJsUrl"]:v.AFrameworkApplication.lC("OfficeJs/word.js",5),["enableOfficeJsUrlParam"]:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableOfficeJsUrlParam",!1)}}XPm(){var e=v.AFrameworkApplication.TOg?v.AFrameworkApplication.K.kb("StaticContentHostNonOverriden"):ll.a.E4;const t=e+ll.a.Tqf,E=e+ll.a.oWc;e+=ll.a.H5h;const W=ll.a.vTk(ll.a.oWc);return new mk(v.AFrameworkApplication.K.appSettings.AppsForOfficeOmexBaseUrl,
v.AFrameworkApplication.K.appSettings.AppsForOfficeDevCatalogUrl,null,v.AFrameworkApplication.dSh,v.AFrameworkApplication.K.appSettings.EditDocInClientUrl,v.AFrameworkApplication.K.appSettings.StaticContentHost,t,E,e,W,v.AFrameworkApplication.K.appSettings.AppsForOfficeFirstPartyManifestUrl,v.AFrameworkApplication.K.kb("SdxCdnUrl"),v.AFrameworkApplication.K.appSettings.SdxDmsUrl,v.AFrameworkApplication.K.kb("Sdx1CdnUrl"),v.AFrameworkApplication.K.kb("SovereignFederationDMSToken"),v.AFrameworkApplication.K.kb("SovereignFederationDMSTokenSuffix"))}iQm(){const e=
v.AFrameworkApplication.K.kb("LoggableUserId");return new Bh(Qd.a.MT(v.AFrameworkApplication.userName),e)}}Object(y.a)(rp,"WordEditorActivationSettingsProvider",null,[1290]);class Ck{constructor(e){this.aLe=e}oHf(e){const t={};e=this.mHf(e);if(!e)return z.ULS.sendTraceTag(7143683,344,15,"propertyIterator is null"),t;if(!e.Ub(21))return t;do{var E=e.currentNode;const W=E.getValue(fd.a.jTc);E=E.getValue(fd.a.kdc);t[W]=E}while(e.Lf(21));return t}pKo(e,t){t||(z.ULS.sendTraceTag(7143684,344,15,"property is null, assume it means empty setting"),
t={});let E=this.mHf(e);if(!E)return z.ULS.sendTraceTag(7143685,344,15,"propertyIterator is null"),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const W=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorSettingsChangedEventIsEnabled");for(;E.Ub(21);)E.S7a(!W);E=this.mHf(e);for(const ha in t){const Ka=this.Auf(ha,t[ha]),sb=Rd.a.create();E.w6(Ka,21,new Hb.a(sb,1),!W)}W&&(Object(ak.a)(66,e)?e.fC(21):z.ULS.sendTraceTag(22024345,344,15,"appObj is not a graph node"));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}dispose(){}Auf(e,
t){const E=this.aLe.create(kk.a.mKb);E.setValue(fd.a.jTc,e);E.setValue(fd.a.kdc,t);return E}mHf(e){if(!Object(ak.a)(66,e))return z.ULS.sendTraceTag(7143686,344,15,"appObj is not a graph node"),null;let t=null;e&&(t=new Ld.GraphIterator,t.set(e));return t}}Object(y.a)(Ck,"WordEditorAfoSettingsModel",null,[1287,13]);class $l{constructor(e,t,E){this.zW=e;this.MO=t;this.RQ=E}}Object(y.a)($l,"AppBindingData",null,[]);var sn=d(128);class sk{constructor(e,t,E,W,ha){this.NE=ha;this.dDd=0;this.BP=()=>{this.ed.raiseEvent(sk.Nxg)};
this.ed=new ua.a;this.lb=e;this.Sb=t;this.SNk=E;this.Eea=W}get yOa(){return this.SNk}BQh(e){this.dDd||this.lb.Cw(this.BP);this.ed.addHandler(sk.Nxg,e);this.dDd++}ptg(e){this.ed.removeHandler(sk.Nxg,e);this.dDd--;this.dDd||this.lb.nY(this.BP)}getSelectedText(){let e="";for(const t of this.lb.gb)e+=this.r9d(t);if(e===sn.AParagraphNode.oE)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,Cwc:e};e=sn.AParagraphNode.iV(e);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
Cwc:e}}r9d(e){var t=8|(S.App.V8?4:0);if(0!==t)return this.NE.getSelectedText(t,e);t="";if(e)for(const E of e){e=E.cpBegin;const W=E.cpEnd-e;let ha="";Xf.ParagraphReader.Xb(E.node)&&(ha=E.node.characterData);switch(E.contextId){case na.a.paragraph:t+=ha+"\r";break;case na.a.Bd:0<W&&(t+=ha.substr(e,W));break;case na.a.Vc:t+="\r"}}return t}$Xo(e,t){this.yng(wb.a.eTd,e,t)}UXo(e,t,E,W){const ha=document.createElement("img");e=e.trim();var Ka=new He.a;let sb=Ka.Zfa(t/72,0),dc=Ka.Zfa(E/72,0),xc="";t=()=>
{var Rc=ha.width;const md=ha.height;if(md&&Rc){if(sb&&!dc||!sb&&dc)Rc/=md,sb?dc=sb/Rc:sb=dc*Rc;xc=this.O$h(e,sb,dc);this.yng(wb.a.Yqa,xc,W)}else W(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)};E=()=>{W(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)};Ka=!1;(Ka=void 0!==ha.onload&&void 0!==ha.onerror)?(ha.onload=t,ha.onerror=E,ha.src=String.format("data:image/png;base64,{0}",e)):(xc=this.O$h(e,sb,dc),this.yng(wb.a.Yqa,xc,W))}O$h(e,t,E){return String.format("<img src='data:image/png;base64,{0}'{1}{2} />",
e,t?String.format(" width='{0}px'",t):"",E?String.format(" height='{0}px'",E):"")}yng(e,t,E){const W=new hc.DictionaryPropertySet;W.setValue(dj.a.mS,t);W.setValue(dj.a.zna,!0);W.setValue(Tb.a.xCa,!0);32===this.Sb.Ob(e,1)?this.Sb.ava(null,e,W,ha=>{E(32===ha.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}):E(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)}}sk.Nxg="SelectionChangedEventKey";Object(y.a)(sk,"ApiObjectModel",
null,[1289]);var Bp=d(40),Hc=d(87);const Dk=e=>{switch(e){case 1:case 2:case 3:case 4:case 6:case 7:case 8:case 9:return!0;default:return!1}};class Tq{constructor(e){this.zB=e}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.zB)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){switch(e){case 1:return this.LRn()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}LRn(){this.notifyActionHandlerReady();return null}}Object(y.a)(Tq,"AddinInternalService",null,[]);class oc{constructor(e,t,E,W){this.menuItemId=
e;this.HOa=t;this.Gdp=E;this.q7l=W}}Object(y.a)(oc,"NewDocumentParameters",null,[]);var vc=d(1557);class Jo{constructor(e,t,E,W,ha){this._context=e;this.Utk=t;this.Ga=E;this.sFk=W;this.jx=ha}createDocument(e){vc.a.fj()||vc.a.il();e&&e.length>this.Ga.ic("WordEditorCreateDocumentApiMaxAllowedBase64",52428800)&&(z.ULS.sendTraceTag(36714716,369,15,"Too large base64 stream size:{0}",e.length),vc.a.qd());this._context.An.BF();const t=new oc("blank","agave",e?"streamBase64":"streamEmpty",e);return OfficeExtension.WacRuntime.Utility.createPromise((E,
W)=>{const ha=new Pa.StandardDialog;ha.Gd=4;ha.Ix(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,Ka=>{2!==Ka&&Ka?this.sFk.create(E,W,t).SXc():W("Cancelled")})}).then(E=>{this._context.An.yv();return E?OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.Utk.create(E)):(vc.a.ng(),null)},E=>{this._context.An.yv();"Cancelled"===E?vc.a.Bjp():vc.a.ng();return null})}getEnterpriseUserInfo(){return null}getMruFriendlyPath(){return null}getSharePointTenantRoot(){return null}isTapEnabled(){vc.a.il();
return!1}launchFileUrlInOfficeApp(){return!1}getTypeName(){return"Microsoft.WordServices.Application"}retrieveStylesFromBase64(e){vc.a.GGp()||vc.a.il();return OfficeExtension.WacRuntime.Utility.createPromise((t,E)=>{this.jx.DHo(e,t,E)})}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1004:return this.crm();case 1005:return this.xAm(t);case 1003:return this.IKm();case 1002:return this.ssn();case 1006:return this.pxn(t)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1001:return this.dFl(t);case 1007:return this.EHo(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}dFl(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.createDocument(e)}crm(){return this.getEnterpriseUserInfo()}xAm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getMruFriendlyPath(e)}IKm(){return this.getSharePointTenantRoot()}ssn(){return this.isTapEnabled()}pxn(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.launchFileUrlInOfficeApp(t,
e)}EHo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.retrieveStylesFromBase64(e)}}Object(y.a)(Jo,"Application",null,[]);class Pm{constructor(){this.FJ=null}get types(){return this.FJ}set types(e){this.FJ=e}getTypeName(){return"Microsoft.WordServices.ContentControlOptions"}invokePropertyGet(e){switch(e){case 1:return this.types}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,
t){switch(e){case 1:this.types=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"Array<int>");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}
Object(y.a)(Pm,"ContentControlOptions",null,[1249]);class Co{constructor(){this.Amh=this.zmh=this.Emh=this.Dmh=this.Cmh=this.Bmh=this.ymh=!1}get importChangeTrackingMode(){return this.ymh}set importChangeTrackingMode(e){this.ymh=e}get importCustomProperties(){return this.zmh}set importCustomProperties(e){this.zmh=e}get importCustomXmlParts(){return this.Amh}set importCustomXmlParts(e){this.Amh=e}get importPageColor(){return this.Bmh}set importPageColor(e){this.Bmh=e}get importParagraphSpacing(){return this.Cmh}set importParagraphSpacing(e){this.Cmh=
e}get importStyles(){return this.Dmh}set importStyles(e){this.Dmh=e}get importTheme(){return this.Emh}set importTheme(e){this.Emh=e}getTypeName(){return"Microsoft.WordServices.InsertFileOptions"}invokePropertyGet(e){switch(e){case 5:return this.importChangeTrackingMode;case 6:return this.importCustomProperties;case 7:return this.importCustomXmlParts;case 4:return this.importPageColor;case 3:return this.importParagraphSpacing;case 2:return this.importStyles;case 1:return this.importTheme}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 5:this.importChangeTrackingMode=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 6:this.importCustomProperties=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 7:this.importCustomXmlParts=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;
case 4:this.importPageColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 3:this.importParagraphSpacing=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 2:this.importStyles=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 1:this.importTheme=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(y.a)(Co,"InsertFileOptions",null,[]);var jl=d(1583);class Kl{constructor(){this.lLd=this.O9g=null;this.pA=this.W4a="";this.MFh=!0;this.options=null}get authChallenge(){return this.O9g}set authChallenge(e){this.O9g=
e}get correlationId(){return this.pA}set correlationId(e){this.pA=e}get policy(){return null}set policy(e){}get resource(){return this.lLd}set resource(e){this.lLd=e}get scope(){return this.W4a}set scope(e){this.W4a=e}get silentLogin(){return this.MFh}set silentLogin(e){this.MFh=e}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(e){switch(e){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;
case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(y.a)(Kl,"TokenParameters",null,[302]);class fo{constructor(e){if(!e)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.W7f=e}areShortcutsInUse(e){return OfficeExtension.WacRuntime.Utility.createPromise((t,E)=>{this.W7f.checkShortcutsInUse(e).then(W=>{t(W)}).catch(W=>{E(W)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((e,
t)=>{this.W7f.getShortcuts().then(E=>{e(E)}).catch(E=>{t(E)})})}replaceShortcuts(e){return OfficeExtension.WacRuntime.Utility.createPromise((t,E)=>{this.W7f.replaceShortcuts(e).then(()=>{t(null)}).catch(W=>{E(W)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 3:return this.a$k(t);case 1:return this.PKm();case 2:return this.tDo(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}a$k(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>");
return this.areShortcutsInUse(e)}PKm(){return this.getShortcuts()}tDo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this.replaceShortcuts(e)}}Object(y.a)(fo,"ActionService",null,[]);class cn{constructor(){this.data=null}}Object(y.a)(cn,"AugLoopHostMessageReceivedEventArgs",null,[]);var Uq=d(1077);class To{constructor(e,t=!1,E=null){this.IQa=e;this.JEb=t;this.hRa=E||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(e){this.JEb||Uq.a.bPo(e)}_RegisterHostMessageReceivedEvent(){this.JEb||
(To.pBj||(Uq.a.euo(e=>{this.hRa.fireEvent("",65542,Object.assign(new cn,{data:e}))}),To.pBj=!0),this.hRa.register(this.IQa,"",65542))}_UnregisterHostMessageReceivedEvent(){this.JEb||this.hRa.unregister(this.IQa,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1:return this.COo(t);case 2:return this.Klk();case 3:return this.Vlk()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}COo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");
this.sendMessage(e);return null}Klk(){this._RegisterHostMessageReceivedEvent();return null}Vlk(){this._UnregisterHostMessageReceivedEvent();return null}}To.pBj=!1;Object(y.a)(To,"AugLoopEventService",null,[]);var sm=d(1621),go=d(577);class ml{constructor(e,t,E){this.Sjb=this.Gjh=null;this.IQa=e;this.syh=t;if(this.Ga=E)this.Gjh=this.Ga.kb("GetAccessTokenOAuthFirstPartyAllowList")}kCm(){this.Sjb||(this.Sjb=go.a.$p(ob.a.instance.Qa("Common.App.OAuth.IOAuthManager")));return this.Sjb}Ijn(e,t){if(!this.syh||
""===this.IQa||!this.Ga)return!1;const E=this.syh.getOsfControl(this.IQa);if(!E)return!1;let W=!1;this.Gjh.split(";").forEach(ha=>{t===ha&&(W=!0)});return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)&&1===v.AFrameworkApplication.ua.Ib.Tk&&E.isFirstParty()&&e===ml.L4k&&W&&ee.d(E.getSolutionId())===ml.S4k}getAccessTokenFirstPartyOAuth(e,t){let E;E=this.Ijn(e,t)?W=>{const ha=this.kCm();ha.continueWith(()=>{ha.result.wV(e,t).then(Ka=>{W(Ka);return Ka})})}:W=>{W(Object.assign(new sm.a,
{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(E)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1:return this.Qfm(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Qfm(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"string");return this.getAccessTokenFirstPartyOAuth(t,e)}}ml.L4k="Maker";ml.S4k="fa000000043";Object(y.a)(ml,"Auth",null,[]);var ul=d(143);class Ko{constructor(){this.Zkb=null}LKm(){this.Zkb||(this.Zkb=go.a.$p(ob.a.instance.Qa("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Zkb}getSharedFilePickerResponse(e){return OfficeExtension.WacRuntime.Utility.createPromise((t,E)=>{try{const W=this.LKm();ul.Task.WAA.call(null,W).continueWith(()=>{const ha=W.result;if(ha){let Ka={};({Zu:Ka}=
qe.d(e)).returnValue?ha.P6d(Ka).then(sb=>{sb&&0<sb.length?t(sb):E(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(sb=>{E(sb)}):E(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else E(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(W){E(W)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1:return this.KKm(t)}e=this.invokeMethod(e,
t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}KKm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getSharedFilePickerResponse(e)}}Object(y.a)(Ko,"SharedFilePicker",null,[]);class Dl{createInstance(e,t,E="",W=null,ha=null){switch(e){case "Microsoft.Office.ActionService":return new fo(t);case "Microsoft.Office.SharedFilePicker":return new Ko;case "Microsoft.Office.Auth":return new ml(E,W,ha);case "Microsoft.Office.AugLoopEventService":return new To(E)}return null}}
Object(y.a)(Dl,"WacApiHost",null,[]);class $g{constructor(e,t,E,W,ha,Ka=null){this.zB=e;this.sRk=t;this.ga=E;this.xKk=W;this.ARk=ha;this.B5b=Ka}endCopilotOperation(e){return this.B5b.endCopilotOperation(e)}startCopilotOperation(e){return this.B5b.startCopilotOperation(e)}undo(){return 32===this.ga.Ob(this.sRk,2)}_RegisterUndoStackChangedEvent(){const e=OfficeExtension.WacRuntime.RichApi.getEventManager();e.isEventRegistered("",65543)||this.xKk($g.npi);e.register(this.zB,"",65543)}_UnregisterUndoStackChangedEvent(){const e=
OfficeExtension.WacRuntime.RichApi.getEventManager();e.unregister(this.zB,"",65543);e.isEventRegistered("",65543)||this.ARk($g.npi)}getTypeName(){return"Microsoft.Office.UndoService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,
t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){switch(e){case 1:return this.srp();case 2:return this.Mlk();case 3:return this.Xlk()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 5:return this.e0l(t);case 4:return this.wbp(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}e0l(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");return this.endCopilotOperation(e)}wbp(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.startCopilotOperation(e)}srp(){return this.undo()}Mlk(){this._RegisterUndoStackChangedEvent();return null}Xlk(){this._UnregisterUndoStackChangedEvent();return null}static npi(){OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent("",65543,null)}}Object(y.a)($g,"UndoService",null,[]);class ep{constructor(){this.isFeedbackSent=!1}}Object(y.a)(ep,"UserFeedbackUIDismissedEventArgs",
null,[]);class Lk{constructor(e,t,E=!1,W=null){this.IQa=e;this.CCb=t;this.JEb=E;this.hRa=W||OfficeExtension.WacRuntime.RichApi.getEventManager()}onDismiss(e){this.hRa.fireEvent("",65546,Object.assign(new ep,{isFeedbackSent:e}))}onError(){}qCm(e){switch(e){case 0:return"Smile";case 1:return"Frown";case 2:return"Idea";case 3:return"Unclassified";default:return"Unclassified"}}rCm(e){switch(e){case 0:return"Modal";case 1:return"SidePane";default:return"Modal"}}pCm(e){const t={};t.isScenarioEnabled=e.isScenarioEnabled;
t.scenarioType=e.scenarioType;if(e=e.question){const E={};E.questionUiType=e.questionUIType;E.questionUiBehavior=e.questionUIBehavior;E.questionInstruction=e.questionInstruction;E.questionOptions=e.questionOptions;t.questionDetails=E}return t}ERd(e,t,E){"True"===E?e[t]=!0:"False"===E&&(e[t]=!1)}collectUserFeedback(e,t,E,W){if(!this.JEb){const ha={};v.AFrameworkApplication.K.jRd(ha);const Ka=this.CCb.getContext(ha);Ka.initialFeedbackType=this.qCm(e);Ka.uiType=this.rCm(t);Ka.telemetryGroup.featureArea=
E;W.v2Config.contextDataFiles&&(Ka.isShareContextDataEnabled=!0,Ka.getContextData=()=>Promise.all(dg.a.map(W.v2Config.contextDataFiles,sb=>window.fetch("data:application/octet-stream;base64,"+sb.base64Data).then(dc=>dc.blob()).then(dc=>new File([dc],sb.fileName,{type:sb.fileType})))));(e=W.v2Config.scenarioConfig)&&(Ka.scenarioConfig=this.pCm(e));this.ERd(Ka,"showEmailAddress",W.v2Config.isEmailCollectionEnabled);this.ERd(Ka,"isFileUploadEnabled",W.v2Config.isFileUploadEnabled);this.ERd(Ka,"screenshot",
W.v2Config.isScreenshotEnabled);this.ERd(Ka,"isThankYouPageDisabled",W.v2Config.isThankYouPageDisabled);Ya.UISurfaces.sMf().then(sb=>{sb.initializeFeedbackModal(Ka,Object(ib.a)(this,this.onDismiss,"onDismiss"),Object(ib.a)(this,this.onError,"onError"));return sb})}}_RegisterUserFeedbackUIDismissedEvent(){this.JEb||this.hRa.register(this.IQa,"",65546)}_UnregisterUserFeedbackUIDismissedEvent(){this.JEb||this.hRa.unregister(this.IQa,"",65546)}getTypeName(){return"Microsoft.Office.UserFeedbackService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1:return this.Dul(t);case 18:return this.Nlk();case 19:return this.Ylk()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Dul(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"object");this.collectUserFeedback(t,E,W,e);return null}Nlk(){this._RegisterUserFeedbackUIDismissedEvent();
return null}Ylk(){this._UnregisterUserFeedbackUIDismissedEvent();return null}}Object(y.a)(Lk,"UserFeedbackService",null,[]);class Kf{constructor(e,t,E){this.adf=null;this.Ggb=t;this.zB=E;this._context=e}hostName(){return"WordOnline"}appId(){return this.Ggb}createInstance(e){switch(e){case "Microsoft.WordServices.Application":return new Jo(ob.a.instance.resolve("WordEditor.Extension.RequestContext"),ob.a.instance.resolve("WordEditor.Extension.DocumentCreatedFactory"),v.AFrameworkApplication.K,ob.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory"),
ob.a.instance.resolve("WordEditor.Extension.FileApiOperations"));case "Microsoft.WordServices.SearchOptions":return new jl.a;case "Microsoft.WordServices.ContentControlOptions":return new Pm;case "Microsoft.WordServices.InsertFileOptions":return new Co;case "Microsoft.Authentication.AuthenticationService":return ob.a.instance.resolve("WordEditor.Extension.AuthenticationServiceFactory").create(this._context,this.zB);case "Microsoft.Authentication.TokenParameters":return new Kl;case "Microsoft.Office.Licensing.License":return ob.a.instance.resolve("WordEditor.Extension.LicenseFactory").create(this.zB);
case "Microsoft.AppRuntime.AppRuntimePersistenceService":return ob.a.instance.resolve("WordEditor.Extension.AppRuntimePersistenceServiceFactory").create(this._context,this.zB);case "Microsoft.AppRuntime.AppRuntimeService":return ob.a.instance.resolve("WordEditor.Extension.AppRuntimeServiceFactory").create(this._context,this.zB);case "Microsoft.InternalService.AddinInternalService":return new Tq(this.zB);case "Microsoft.Office.AugLoopEventService":var t=ob.a.instance.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").au.getOsfControl(this.zB);
if(null===t||void 0===t?0:t.isFirstParty())return this.adf||(this.adf=new Dl),this.adf.createInstance(e,null,this.zB);break;case "Microsoft.Office.UndoService":t=ob.a.instance.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").au.getOsfControl(this.zB);if(null===t||void 0===t?0:t.isFirstParty()){const E=ob.a.instance.resolve("Box4.IUndoManager");e=ob.a.instance.resolve("WordEditor.CopilotOperationLifecycleHandler");return new $g(this.zB,wb.a.undo,ob.a.instance.resolve("Common.IActionManager"),
W=>E.a1k(W),W=>E.NAo(W),e)}break;case "Microsoft.Office.UserFeedbackService":if(t=ob.a.instance.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").au.getOsfControl(this.zB),null===t||void 0===t?0:t.isFirstParty())return new Lk(this.zB,ob.a.instance.resolve("Common.App.ICustomerFeedbackUiWrapper"),!1)}z.ULS.sendTraceTag(17359129,369,10,"Typename: {0} is an invalid parameter. Only instance for Application or SearchOptions can be created through this method.",e);vc.a.ng();return null}}Object(y.a)(Kf,
"RichApiHost",null,[1320]);var Yh;(function(e){e[e.none=0]="none";e[e.xgq=1]="primitive";e[e.rpq=2]="valueObject";e[e.kVp=3]="classObject"})(Yh||(Yh={}));Object(y.b)("TypeCategory_Deprecated",Yh);const ng=e=>{if(v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.WordOnline.IncludeWacApiHostTypeRegister")){let Ln,Go;Ln=e.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);Go=Ln.addMethod("AreShortcutsInUse",3,
"Object[]",1,0,"AreShortcutsInUse",0);Go.addParameter("shortcuts","String[]",1,null,0);Go=Ln.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Go=Ln.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Go.addParameter("shortcuts","Object",1,null,0);Ln=e.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Go=Ln.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Go.addParameter("pickerCustomizationJsonString",
"String",1,null,0);Ln=e.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);Go=Ln.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);Go.addParameter("appName","String",1,null,0);Go.addParameter("target","String",1,null,0);Ln=e.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);Ln.addProperty("Data",
4,"String",1,!1,null,0);Ln=e.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",3,2);Go=Ln.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);Go.addParameter("data","String",1,null,0);Go=Ln.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);Go=Ln.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4);Ln=e.addType("Microsoft.Office.CopilotOperationStartedEventArgs",
"{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);Ln.addProperty("BatchId",6,"String",1,!1,null,0);Ln=e.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);Go=Ln.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",4);Go.addParameter("batchId","String",1,null,0);Go=Ln.addMethod("StartCopilotOperation",4,"Boolean",1,0,"StartCopilotOperation",4);Go.addParameter("batchId","String",
1,null,0);Go=Ln.addMethod("Undo",1,"Boolean",1,0,"Undo",4);Go=Ln.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",4);Go=Ln.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);Ln=e.addEnumType("Microsoft.Office.UserFeedbackType");Ln.addEnumField("Like",0);Ln.addEnumField("Dislike",1);Ln.addEnumField("Idea",2);Ln.addEnumField("Unclassified",3);Ln=e.addEnumType("Microsoft.Office.UserFeedbackUIType");Ln.addEnumField("ModalDialog",
0);Ln.addEnumField("Taskpane",1);Ln=e.addType("Microsoft.Office.UserFeedbackService","{92a3da31-eaf9-4225-b909-6c696483a7fb}","{c6f22ae8-52fa-45d5-a1bf-6b7b67f60f8b}",3,2);Go=Ln.addMethod("CollectUserFeedback",1,"Void",0,1,"CollectUserFeedback",4);Go.addParameter("feedbacktype","Microsoft.Office.UserFeedbackType",1,null,0);Go.addParameter("UIType","Microsoft.Office.UserFeedbackUIType",1,null,0);Go.addParameter("featureArea","String",1,null,0);Go.addParameter("options","Object",1,null,0);Go=Ln.addMethod("_RegisterUserFeedbackUIDismissedEvent",
18,"Void",0,1,"_RegisterUserFeedbackUIDismissedEvent",4);Go=Ln.addMethod("_UnregisterUserFeedbackUIDismissedEvent",19,"Void",0,1,"_UnregisterUserFeedbackUIDismissedEvent",4)}const t=e.addType("Microsoft.WordServices.Annotation","{4a0f635f-767e-4a07-b75e-80e8432ca12c}","",3,0);t.addProperty("Content",1,"Object",1,!0,null,0);t.addProperty("Id",2,"String",1,!0,null,0);t.addProperty("_ReferenceId",3,"String",1,!0,null,0);t.addProperty("_State",4,"Microsoft.WordServices.AnnotationState",1,!1,null,0);t.addMethod("Delete",
1006,"Void",0,0,"Delete",0);t.addMethod("GetParentAsAnnotation",1005,"Microsoft.WordServices.Annotation",3,1,"ParentAsAnnotation",0);t.addMethod("GetParentAsParagraph",1004,"Microsoft.WordServices.Paragraph",3,1,"ParentAsParagraph",0);t.addMethod("GetParentType",1003,"Microsoft.WordServices.AnnotationParentType",1,1,"ParentType",0);t.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);t.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);const E=e.addType("Microsoft.WordServices.AnnotationCollection",
"{0b4dc55f-db0a-4fda-93fe-2a32432b87d3}","",3,0);E.addProperty("_ReferenceId",2,"String",1,!0,null,0);E.addMethod("GetFirst",1003,"Microsoft.WordServices.Annotation",3,1,"First",0);E.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Annotation",3,1,"FirstOrNullObject",0);E.addIndexerMethod(1,"Microsoft.WordServices.Annotation",3,0).addParameter("index","Object",1,null,0);E.addMethod("Refresh",1005,"Void",0,1,"Refresh",0);E.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);
E.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);E.setCollectionInfo("Microsoft.WordServices.Annotation",!0);const W=e.addType("Microsoft.WordServices.Application","{e033f092-ac87-40f7-a865-769c9fdacd72}","{2c000fc1-c973-41fc-b5e3-8f3a0cc65c12}",3,0);W.addMethod("CreateDocument",1001,"Microsoft.WordServices.DocumentCreated",3,1,"CreateDocument",0).addParameter("base64File","String",1,null,0);W.addMethod("GetEnterpriseUserInfo",1004,"String",1,1,"EnterpriseUserInfo",4);W.addMethod("GetMruFriendlyPath",
1005,"String",1,1,"MruFriendlyPath",4).addParameter("documentUrl","String",1,null,0);W.addMethod("GetSharePointTenantRoot",1003,"String",1,1,"SharePointTenantRoot",4);W.addMethod("IsTapEnabled",1002,"Boolean",1,1,"IsTapEnabled",4);const ha=W.addMethod("LaunchFileUrlInOfficeApp",1006,"Boolean",1,1,"LaunchFileUrlInOfficeApp",4);ha.addParameter("documentUrl","String",1,null,0);ha.addParameter("useUniversalAsBackUp","Boolean",1,null,0);W.addMethod("RetrieveStylesFromBase64",1007,"String",1,1,"RetrieveStylesFromBase64",
0).addParameter("base64File","String",1,null,0);const Ka=e.addType("Microsoft.WordServices.Body","{5516bb1d-cf31-4aa9-97cd-ccebc2ee9e6d}","",3,0);Ka.addProperty("ContentControls",3,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Ka.addProperty("Endnotes",19,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Ka.addProperty("Fields",20,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Ka.addProperty("Font",5,"Microsoft.WordServices.Font",3,!0,null,0);Ka.addProperty("Footnotes",
18,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Ka.addProperty("InlinePictures",7,"Microsoft.WordServices.InlinePictureCollection",3,!0,null,0);Ka.addProperty("Lists",11,"Microsoft.WordServices.ListCollection",3,!0,null,0);Ka.addProperty("Paragraphs",2,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);Ka.addProperty("ParentBody",10,"Microsoft.WordServices.Body",3,!0,null,0);Ka.addProperty("ParentBodyOrNullObject",16,"Microsoft.WordServices.Body",3,!0,null,0);Ka.addProperty("ParentContentControl",
4,"Microsoft.WordServices.ContentControl",3,!0,null,0);Ka.addProperty("ParentContentControlOrNullObject",15,"Microsoft.WordServices.ContentControl",3,!0,null,0);Ka.addProperty("ParentSection",13,"Microsoft.WordServices.Section",3,!0,null,0);Ka.addProperty("ParentSectionOrNullObject",17,"Microsoft.WordServices.Section",3,!0,null,0);Ka.addProperty("Style",6,"String",1,!1,null,0);Ka.addProperty("StyleBuiltIn",14,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Ka.addProperty("Tables",12,"Microsoft.WordServices.TableCollection",
3,!0,null,0);Ka.addProperty("Text",8,"String",1,!0,null,0);Ka.addProperty("Type",9,"Microsoft.WordServices.BodyType",1,!0,null,0);Ka.addProperty("_ReferenceId",1,"String",1,!0,null,0);Ka.addMethod("Clear",1011,"Void",0,0,"Clear",0);Ka.addMethod("GetComments",1019,"Microsoft.WordServices.CommentCollection",3,1,"Comments",0);Ka.addMethod("GetContentControls",1021,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",
2,"Microsoft.WordServices.ContentControlOptions",0);Ka.addMethod("GetHtml",1013,"String",1,1,"Html",0);Ka.addMethod("GetOoxml",1014,"String",1,1,"Ooxml",0);Ka.addMethod("GetRange",1016,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);const sb=Ka.addMethod("InsertBreak",1009,"Void",0,0,"InsertBreak",0);sb.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);sb.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);Ka.addMethod("InsertContentControl",1007,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0).addParameter("type","Microsoft.WordServices.ContentControlType",1,null,0);const dc=Ka.addMethod("InsertFileFromBase64",1008,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",0);dc.addParameter("base64File","String",1,null,0);dc.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const xc=Ka.addMethod("InsertHtml",1004,"Microsoft.WordServices.Range",
3,0,"InsertHtml",0);xc.addParameter("html","String",1,null,0);xc.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Rc=Ka.addMethod("InsertInlinePictureFromBase64",1010,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);Rc.addParameter("base64EncodedImage","String",1,null,0);Rc.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const md=Ka.addMethod("InsertOoxml",1005,"Microsoft.WordServices.Range",3,0,"InsertOoxml",
0);md.addParameter("ooxml","String",1,null,0);md.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const ud=Ka.addMethod("InsertParagraph",1006,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);ud.addParameter("paragraphText","String",1,null,0);ud.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Ka.addMethod("GetReviewedText",1020,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",
1,null,0);const Ud=Ka.addMethod("InsertTable",1017,"Microsoft.WordServices.Table",3,0,"InsertTable",0);Ud.addParameter("rowCount","Int32",1,null,0);Ud.addParameter("columnCount","Int32",1,null,0);Ud.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Ud.addParameter("values","String[][]",1,null,0);const Id=Ka.addMethod("InsertText",1003,"Microsoft.WordServices.Range",3,0,"InsertText",0);Id.addParameter("text","String",1,null,0);Id.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);const Ee=Ka.addMethod("Search",1012,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);Ee.addParameter("searchText","String",1,null,0);Ee.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Ka.addMethod("Select",1015,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);Ka.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Ka.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const kf=Ka.addMethod("_Search2",
1018,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);kf.addParameter("searchText","String",1,null,0);kf.addParameter("searchFlags","Int32",1,null,0);const Ke=e.addType("Microsoft.WordServices.ContentControl","{b86e5ae1-476e-4e56-825d-885468e549f3}","",3,0);Ke.addProperty("Appearance",7,"Microsoft.WordServices.ContentControlAppearance",1,!1,null,0);Ke.addProperty("CannotDelete",10,"Boolean",1,!1,null,0);Ke.addProperty("CannotEdit",11,"Boolean",1,!1,null,0);Ke.addProperty("CheckboxContentControl",
32,"Microsoft.WordServices.CheckboxContentControl",2,!0,null,0);Ke.addProperty("Color",8,"String",1,!1,null,0);Ke.addProperty("ContentControls",15,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Ke.addProperty("Endnotes",30,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Ke.addProperty("Fields",31,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Ke.addProperty("Font",12,"Microsoft.WordServices.Font",3,!0,null,0);Ke.addProperty("Footnotes",29,"Microsoft.WordServices.NoteItemCollection",
3,!0,null,0);Ke.addProperty("Id",1,"UInt32",1,!0,null,0);Ke.addProperty("InlinePictures",17,"Microsoft.WordServices.InlinePictureCollection",3,!0,null,0);Ke.addProperty("Lists",19,"Microsoft.WordServices.ListCollection",3,!0,null,0);Ke.addProperty("Paragraphs",14,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);Ke.addProperty("ParentBody",25,"Microsoft.WordServices.Body",3,!0,null,0);Ke.addProperty("ParentContentControl",16,"Microsoft.WordServices.ContentControl",3,!0,null,0);Ke.addProperty("ParentContentControlOrNullObject",
26,"Microsoft.WordServices.ContentControl",3,!0,null,0);Ke.addProperty("ParentTable",22,"Microsoft.WordServices.Table",3,!0,null,0);Ke.addProperty("ParentTableCell",21,"Microsoft.WordServices.TableCell",3,!0,null,0);Ke.addProperty("ParentTableCellOrNullObject",27,"Microsoft.WordServices.TableCell",3,!0,null,0);Ke.addProperty("ParentTableOrNullObject",28,"Microsoft.WordServices.Table",3,!0,null,0);Ke.addProperty("PlaceholderText",5,"String",1,!1,null,0);Ke.addProperty("RemoveWhenEdited",9,"Boolean",
1,!1,null,0);Ke.addProperty("Style",13,"String",1,!1,null,0);Ke.addProperty("StyleBuiltIn",24,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Ke.addProperty("Subtype",23,"Microsoft.WordServices.ContentControlType",1,!0,null,0);Ke.addProperty("Tables",20,"Microsoft.WordServices.TableCollection",3,!0,null,0);Ke.addProperty("Tag",4,"String",1,!1,null,0);Ke.addProperty("Text",18,"String",1,!0,null,0);Ke.addProperty("Title",3,"String",1,!1,null,0);Ke.addProperty("Type",6,"Microsoft.WordServices.ContentControlType",
1,!0,null,0);Ke.addProperty("_ReferenceId",2,"String",1,!0,null,0);Ke.addMethod("Clear",1010,"Void",0,0,"Clear",0);Ke.addMethod("Delete",1011,"Void",0,0,"Delete",0).addParameter("keepContent","Boolean",1,null,0);Ke.addMethod("GetComments",1021,"Microsoft.WordServices.CommentCollection",3,1,"Comments",0);Ke.addMethod("GetContentControls",1023,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",
0);Ke.addMethod("GetHtml",1013,"String",1,1,"Html",0);Ke.addMethod("GetOoxml",1014,"String",1,1,"Ooxml",0);Ke.addMethod("GetRange",1016,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);const dh=Ke.addMethod("GetTextRanges",1019,"Microsoft.WordServices.RangeCollection",3,1,"TextRanges",0);dh.addParameter("endingMarks","String[]",1,null,0);dh.addParameter("trimSpacing","Boolean",1,null,0);const $h=Ke.addMethod("InsertBreak",
1008,"Void",0,0,"InsertBreak",0);$h.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);$h.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const rj=Ke.addMethod("InsertFileFromBase64",1006,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",0);rj.addParameter("base64File","String",1,null,0);rj.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const zl=Ke.addMethod("InsertHtml",1004,"Microsoft.WordServices.Range",
3,0,"InsertHtml",0);zl.addParameter("html","String",1,null,0);zl.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Wl=Ke.addMethod("InsertInlinePictureFromBase64",1009,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);Wl.addParameter("base64EncodedImage","String",1,null,0);Wl.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Rh=Ke.addMethod("InsertOoxml",1005,"Microsoft.WordServices.Range",3,0,"InsertOoxml",
0);Rh.addParameter("ooxml","String",1,null,0);Rh.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Mg=Ke.addMethod("InsertParagraph",1007,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);Mg.addParameter("paragraphText","String",1,null,0);Mg.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Xl=Ke.addMethod("InsertTable",1018,"Microsoft.WordServices.Table",3,0,"InsertTable",0);Xl.addParameter("rowCount","Int32",1,null,
0);Xl.addParameter("columnCount","Int32",1,null,0);Xl.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Xl.addParameter("values","String[][]",1,null,0);const ql=Ke.addMethod("InsertText",1003,"Microsoft.WordServices.Range",3,0,"InsertText",0);ql.addParameter("text","String",1,null,0);ql.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Al=Ke.addMethod("Search",1015,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);Al.addParameter("searchText",
"String",1,null,0);Al.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Ke.addMethod("Select",1012,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const Hk=Ke.addMethod("Split",1017,"Microsoft.WordServices.RangeCollection",3,1,"Split",0);Hk.addParameter("delimiters","String[]",1,null,0);Hk.addParameter("multiParagraphs","Boolean",1,null,0);Hk.addParameter("trimDelimiters","Boolean",1,null,0);Hk.addParameter("trimSpacing",
"Boolean",1,null,0);Ke.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Ke.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Dj=Ke.addMethod("_Search2",1020,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);Dj.addParameter("searchText","String",1,null,0);Dj.addParameter("searchFlags","Int32",1,null,0);Ke.addMethod("GetReviewedText",1022,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);const ao=
e.addType("Microsoft.WordServices.ContentControlCollection","{a6a87ba8-6037-4625-ba4b-ece14e708219}","",3,0);ao.addProperty("_ReferenceId",2,"String",1,!0,null,0);ao.addMethod("GetByChangeTrackingStates",1010,"Microsoft.WordServices.ContentControlCollection",3,1,"ByChangeTrackingStates",0).addParameter("types","Microsoft.WordServices.ChangeTrackingState[]",1,null,0);ao.addMethod("GetById",1002,"Microsoft.WordServices.ContentControl",3,1,"ById",0).addParameter("id","Int32",1,null,0);ao.addMethod("GetByIdOrNullObject",
1008,"Microsoft.WordServices.ContentControl",3,1,"ByIdOrNullObject",0).addParameter("id","Int32",1,null,0);ao.addMethod("GetByTag",1004,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTag",0).addParameter("tag","String",1,null,0);ao.addMethod("GetByTitle",1003,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTitle",0).addParameter("title","String",1,null,0);ao.addMethod("GetByTypes",1006,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTypes",0).addParameter("types","Microsoft.WordServices.ContentControlType[]",
1,null,0);ao.addMethod("GetFirst",1007,"Microsoft.WordServices.ContentControl",3,1,"First",0);ao.addMethod("GetFirstOrNullObject",1009,"Microsoft.WordServices.ContentControl",3,1,"FirstOrNullObject",0);ao.addIndexerMethod(1,"Microsoft.WordServices.ContentControl",3,0).addParameter("index","Object",1,null,0);ao.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);ao.addMethod("_OnAccess",1005,"Void",0,1,"_OnAccess",0);ao.setCollectionInfo("Microsoft.WordServices.ContentControl",!0);e.addType("Microsoft.WordServices.ContentControlOptions",
"{dc3307d1-f680-40be-94b4-c50e53399d0e}","{81d9e31a-cd15-43a2-8ee0-614fb6e37a0a}",2,0).addProperty("types",1,"Microsoft.WordServices.ContentControlType[]",1,!1,null,0);e.addType("Microsoft.WordServices.CheckboxContentControl","{70b1363a-da4f-4cf0-a688-cafd68052109}","{fd0a2f05-9b08-4525-9321-664b43f2cd51}",2,0).addProperty("IsChecked",1,"Boolean",1,!1,null,0);const yj=e.addType("Microsoft.WordServices.Comment","{9446f5cf-2bce-46d3-ae41-2a70c1398270}","",3,0);yj.addProperty("AuthorEmail",1,"String",
1,!0,null,0);yj.addProperty("AuthorName",2,"String",1,!0,null,0);yj.addProperty("Content",3,"String",1,!1,null,0);yj.addProperty("CreationDate",4,"DateTime",1,!1,null,0);yj.addProperty("Id",5,"String",1,!0,null,0);yj.addProperty("_ReferenceId",6,"String",1,!0,null,0);yj.addProperty("Replies",7,"Microsoft.WordServices.CommentReplyCollection",3,!0,null,0);yj.addProperty("Resolved",8,"Boolean",1,!1,null,0);yj.addProperty("ContentRange",9,"Microsoft.WordServices.CommentContentRange",3,!1,null,0);yj.addMethod("GetRange",
1001,"Microsoft.WordServices.Range",3,0,"GetRange",0);yj.addMethod("Reply",1002,"Microsoft.WordServices.CommentReply",3,0,"Reply",0).addParameter("replyText","String",1,null,0);yj.addMethod("Delete",1003,"Void",0,0,"Delete",0);yj.addMethod("_KeepReference",1005,"Void",0,1,"_KeepReference",0);yj.addMethod("_OnAccess",1004,"Void",0,1,"_OnAccess",0);const Up=e.addType("Microsoft.WordServices.CommentContentRange","{fc4ae520-29e9-45ee-82ae-c0b29f2feefc}","",3,0);Up.addProperty("_ReferenceId",1,"String",
1,!0,null,0);Up.addProperty("Text",2,"String",1,!0,null,0);Up.addProperty("IsEmpty",3,"Boolean",1,!0,null,0);Up.addProperty("Hyperlink",4,"String",1,!1,null,0);Up.addProperty("Bold",5,"Boolean",1,!1,null,0);Up.addProperty("Italic",6,"Boolean",1,!1,null,0);Up.addProperty("StrikeThrough",7,"Boolean",1,!1,null,0);Up.addProperty("Underline",8,"Microsoft.WordServices.UnderlineType",1,!1,null,0);Up.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Up.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",
0);const hA=Up.addMethod("InsertText",1003,"Microsoft.WordServices.CommentContentRange",3,0,"InsertText",0);hA.addParameter("text","String",1,null,0);hA.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const by=e.addType("Microsoft.WordServices.CommentCollection","{f1054c20-9d4b-4c62-9c80-e0e57ac4df64}","",3,0);by.addProperty("_ReferenceId",2,"String",1,!0,null,0);by.addMethod("GetFirst",1003,"Microsoft.WordServices.Comment",3,1,"First",0);by.addMethod("GetFirstOrNullObject",
1004,"Microsoft.WordServices.Comment",3,1,"FirstOrNullObject",0);by.addIndexerMethod(1,"Microsoft.WordServices.Comment",3,0).addParameter("index","object",1,null,0);by.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);by.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);by.setCollectionInfo("Microsoft.WordServices.Comment",!0);const Ou=e.addType("Microsoft.WordServices.CommentReply","{cd697f4e-f862-b2b3-bfa1-5a5a2231b3d4}","",3,0);Ou.addProperty("AuthorEmail",1,"String",1,!0,null,
0);Ou.addProperty("AuthorName",2,"String",1,!0,null,0);Ou.addProperty("Content",3,"String",1,!1,null,0);Ou.addProperty("CreationDate",4,"DateTime",1,!1,null,0);Ou.addProperty("ParentComment",7,"Microsoft.WordServices.Comment",3,!0,null,0);Ou.addProperty("Id",5,"String",1,!0,null,0);Ou.addProperty("_ReferenceId",6,"String",1,!0,null,0);Ou.addProperty("ContentRange",8,"Microsoft.WordServices.CommentContentRange",3,!1,null,0);Ou.addMethod("Delete",1002,"Void",0,0,"Delete",0);Ou.addMethod("_KeepReference",
1001,"Void",0,1,"_KeepReference",0);Ou.addMethod("_OnAccess",1003,"Void",0,1,"_OnAccess",0);const hw=e.addType("Microsoft.WordServices.CommentReplyCollection","{bfce5553-cb82-aa57-dec3-0c164055f29e}","",3,0);hw.addProperty("_ReferenceId",2,"String",1,!0,null,0);hw.addMethod("GetFirst",1003,"Microsoft.WordServices.CommentReply",3,1,"First",0);hw.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.CommentReply",3,1,"FirstOrNullObject",0);hw.addIndexerMethod(1,"Microsoft.WordServices.CommentReply",
3,0).addParameter("index","object",1,null,0);hw.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);hw.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);hw.setCollectionInfo("Microsoft.WordServices.CommentReply",!0);const Dn=e.addType("Microsoft.WordServices.CustomProperty","{5edbd9c9-449f-440c-bfae-d59d2db340bb}","",3,0);Dn.addProperty("Key",2,"String",1,!0,null,0);Dn.addProperty("Type",4,"Microsoft.WordServices.DocumentPropertyType",1,!0,null,0);Dn.addProperty("Value",3,"Object",1,
!1,null,0);Dn.addProperty("_Id",5,"String",1,!0,null,0);Dn.addProperty("_ReferenceId",1,"String",1,!0,null,0);Dn.addMethod("Delete",1003,"Void",0,0,"Delete",0);Dn.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Dn.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const pv=e.addType("Microsoft.WordServices.CustomPropertyCollection","{85869847-ef5b-4377-9a0b-0eb6da2059e5}","",3,0);pv.addProperty("_ReferenceId",2,"String",1,!0,null,0);const mF=pv.addMethod("Add",1003,"Microsoft.WordServices.CustomProperty",
3,0,"Add",0);mF.addParameter("key","String",1,null,0);mF.addParameter("value","Object",1,null,0);pv.addMethod("DeleteAll",1005,"Void",0,0,"DeleteAll",0);pv.addMethod("GetCount",1004,"Int32",1,1,"Count",0);pv.addIndexerMethod(1,"Microsoft.WordServices.CustomProperty",3,0).addParameter("key","String",1,null,0);pv.addMethod("GetItemOrNullObject",1006,"Microsoft.WordServices.CustomProperty",3,1,"ItemOrNullObject",0).addParameter("key","String",1,null,0);pv.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",
0);pv.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);pv.setCollectionInfo("Microsoft.WordServices.CustomProperty",!0);const wt=e.addType("Microsoft.WordServices.CustomXmlPart","{e0f5b881-5a49-403f-adc1-627b9479ad11}","",3,0);wt.addProperty("Id",2,"String",1,!0,null,0);wt.addProperty("NamespaceUri",3,"String",1,!0,null,0);wt.addProperty("_ReferenceId",1,"String",1,!0,null,0);wt.addMethod("Delete",1003,"Void",0,0,"Delete",0);const Vw=wt.addMethod("DeleteAttribute",1012,"Void",0,0,"DeleteAttribute",
0);Vw.addParameter("xpath","String",1,null,0);Vw.addParameter("namespaceMappings","Object",1,null,0);Vw.addParameter("name","String",1,null,0);const pH=wt.addMethod("DeleteElement",1009,"Void",0,0,"DeleteElement",0);pH.addParameter("xpath","String",1,null,0);pH.addParameter("namespaceMappings","Object",1,null,0);wt.addMethod("GetXml",1004,"String",1,1,"Xml",0);const cy=wt.addMethod("InsertAttribute",1010,"Void",0,0,"InsertAttribute",0);cy.addParameter("xpath","String",1,null,0);cy.addParameter("namespaceMappings",
"Object",1,null,0);cy.addParameter("name","String",1,null,0);cy.addParameter("value","String",1,null,0);const nF=wt.addMethod("InsertElement",1007,"Void",0,0,"InsertElement",0);nF.addParameter("xpath","String",1,null,0);nF.addParameter("xml","String",1,null,0);nF.addParameter("namespaceMappings","Object",1,null,0);nF.addParameter("index","Int32?",1,null,0);const eJ=wt.addMethod("Query",1006,"String[]",1,0,"Query",0);eJ.addParameter("xpath","String",1,null,0);eJ.addParameter("namespaceMappings","Object",
1,null,0);wt.addMethod("SetXml",1005,"Void",0,0,"SetXml",0).addParameter("xml","String",1,null,0);const AB=wt.addMethod("UpdateAttribute",1011,"Void",0,0,"UpdateAttribute",0);AB.addParameter("xpath","String",1,null,0);AB.addParameter("namespaceMappings","Object",1,null,0);AB.addParameter("name","String",1,null,0);AB.addParameter("value","String",1,null,0);const oF=wt.addMethod("UpdateElement",1008,"Void",0,0,"UpdateElement",0);oF.addParameter("xpath","String",1,null,0);oF.addParameter("xml","String",
1,null,0);oF.addParameter("namespaceMappings","Object",1,null,0);wt.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);wt.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const dy=e.addType("Microsoft.WordServices.CustomXmlPartCollection","{cf95a7e8-7b45-4a7a-9de5-db47e5f9b66b}","",3,0);dy.addProperty("_ReferenceId",1,"String",1,!0,null,0);dy.addMethod("Add",1004,"Microsoft.WordServices.CustomXmlPart",3,0,"Add",0).addParameter("xml","String",1,null,0);dy.addMethod("GetByNamespace",
1005,"Microsoft.WordServices.CustomXmlPartScopedCollection",3,1,"ByNamespace",0).addParameter("namespaceUri","String",1,null,0);dy.addMethod("GetCount",1003,"Int32",1,1,"Count",0);dy.addIndexerMethod(2,"Microsoft.WordServices.CustomXmlPart",3,0).addParameter("id","String",1,null,0);dy.addMethod("GetItemOrNullObject",1006,"Microsoft.WordServices.CustomXmlPart",3,1,"",0).addParameter("id","String",1,null,0);dy.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);dy.addMethod("_OnAccess",1001,
"Void",0,1,"_OnAccess",0);dy.setCollectionInfo("Microsoft.WordServices.CustomXmlPart",!0);const Om=e.addType("Microsoft.WordServices.CustomXmlPartScopedCollection","{9fc07322-b3a6-407b-827e-c40e6e188f68}","",3,0);Om.addProperty("_ReferenceId",1,"String",1,!0,null,0);Om.addMethod("GetCount",1003,"Int32",1,1,"Count",0);Om.addIndexerMethod(2,"Microsoft.WordServices.CustomXmlPart",3,0).addParameter("id","String",1,null,0);Om.addMethod("GetItemOrNullObject",1004,"Microsoft.WordServices.CustomXmlPart",
3,1,"",0).addParameter("id","String",1,null,0);Om.addMethod("GetOnlyItem",1005,"Microsoft.WordServices.CustomXmlPart",3,1,"OnlyItem",0);Om.addMethod("GetOnlyItemOrNullObject",1006,"Microsoft.WordServices.CustomXmlPart",3,1,"",0);Om.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Om.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Om.setCollectionInfo("Microsoft.WordServices.CustomXmlPart",!0);const Ch=e.addType("Microsoft.WordServices.Document","{1fd33ae5-86f2-4770-95f1-8bba5b1dce15}",
"",3,0);Ch.addProperty("AllowCloseOnUntitled",9,"Boolean",1,!1,null,0);Ch.addProperty("ChangeTrackingMode",10,"Microsoft.WordServices.ChangeTrackingMode",1,!1,null,0);Ch.addProperty("Body",3,"Microsoft.WordServices.Body",3,!0,null,0);Ch.addProperty("ContentControls",4,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Ch.addProperty("CustomXmlParts",8,"Microsoft.WordServices.CustomXmlPartCollection",3,!0,null,0);Ch.addProperty("Properties",6,"Microsoft.WordServices.DocumentProperties",
3,!0,null,0);Ch.addProperty("Saved",1,"Boolean",1,!0,null,0);Ch.addProperty("Sections",2,"Microsoft.WordServices.SectionCollection",3,!0,null,0);Ch.addProperty("Settings",7,"Microsoft.WordServices.SettingCollection",3,!0,null,0);Ch.addProperty("_ReferenceId",5,"String",1,!0,null,0);const ey=Ch.addMethod("AddStyle",1028,"Microsoft.WordServices.Style",Yh.ClassObject,0,"AddStyle",0);ey.addParameter("name","String",1,null,0);ey.addParameter("type","Microsoft.WordServices.StyleType",1,null,0);Ch.addMethod("DeleteBookmark",
1011,"Void",0,0,"DeleteBookmark",0).addParameter("name","String",1,null,0);Ch.addMethod("GetAnnotationsByType",1020,"Microsoft.WordServices.AnnotationCollection",3,1,"AnnotationsByType",0).addParameter("annotationType","String",1,null,0);Ch.addMethod("GetBookmarkRange",1010,"Microsoft.WordServices.Range",3,1,"BookmarkRange",0).addParameter("name","String",1,null,0);Ch.addMethod("GetBookmarkRangeOrNullObject",1012,"Microsoft.WordServices.Range",3,1,"BookmarkRangeOrNullObject",0).addParameter("name",
"String",1,null,0);Ch.addMethod("GetContentControls",1026,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);Ch.addMethod("GetEndnoteBody",1025,"Microsoft.WordServices.Body",3,1,"EndnoteBody",0);Ch.addMethod("GetFootnoteBody",1024,"Microsoft.WordServices.Body",3,1,"FootnoteBody",0);Ch.addMethod("GetMetadata",1013,"Object",1,1,"Metadata",0).addParameter("propertyGUID",
"String",1,null,0);Ch.addMethod("GetNeighborhoodTextAroundSelection",1017,"String",1,1,"NeighborhoodTextAroundSelection",4).addParameter("maxLength","Int32?",1,null,0);Ch.addMethod("GetSelection",1006,"Microsoft.WordServices.Range",3,1,"Selection",0);Ch.addMethod("GetStyles",1029,"Microsoft.WordServices.StyleCollection",Yh.ClassObject,1,"GetStyles",0);Ch.addMethod("LaunchTapPane",1016,"Void",0,1,"LaunchTapPane",4).addParameter("documentUrl","String",1,null,0);const iA=Ch.addMethod("Save",1005,"Void",
0,0,"Save",0);iA.addParameter("saveBehavior","Microsoft.WordServices.SaveBehavior",1,null,0);iA.addParameter("fileName","String",1,null,0);Ch.addMethod("Close",1027,"Void",0,0,"Close",0).addParameter("closeBehavior","Microsoft.WordServices.CloseBehavior",1,null,0);const pF=Ch.addMethod("Search",1022,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);pF.addParameter("searchText","String",1,null,0);pF.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);const aD=Ch.addMethod("SetMetadata",
1014,"Void",0,0,"SetMetadata",0);aD.addParameter("propertyGUID","String",1,null,0);aD.addParameter("propertyValue","Object",1,null,0);const bD=Ch.addMethod("SetMetadataOnTile",1015,"Void",0,0,"SetMetadataOnTile",0);bD.addParameter("tileID","String",1,null,0);bD.addParameter("propertyGUID","String",1,null,0);bD.addParameter("propertyValue","Object",1,null,0);Ch.addMethod("SetNavigationPaneVisibility",1021,"Void",0,0,"SetNavigationPaneVisibility",4).addParameter("visible","Boolean",1,null,0);Ch.addMethod("_GetObjectByReferenceId",
1001,"Object",1,1,"_GetObjectByReferenceId",0).addParameter("referenceId","String",1,null,0);Ch.addMethod("_GetObjectTypeNameByReferenceId",1002,"String",1,1,"_GetObjectTypeNameByReferenceId",0).addParameter("referenceId","String",1,null,0);Ch.addMethod("_KeepReference",1008,"Void",0,1,"_KeepReference",0);Ch.addMethod("_OnAccess",1007,"Void",0,1,"_OnAccess",0);const BB=Ch.addMethod("_RegisterEvent",1018,"Void",0,1,"_RegisterEvent",0);BB.addParameter("referenceId","String",1,null,0);BB.addParameter("eventType",
"Microsoft.WordServices.EventType",1,null,0);Ch.addMethod("_RemoveAllReferences",1004,"Void",0,1,"_RemoveAllReferences",0);Ch.addMethod("_RemoveReference",1003,"Void",0,1,"_RemoveReference",0).addParameter("referenceId","String",1,null,0);const qF=Ch.addMethod("_Search2",1023,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);qF.addParameter("searchText","String",1,null,0);qF.addParameter("searchFlags","Int32",1,null,0);const Ls=Ch.addMethod("_UnregisterEvent",1019,"Void",0,1,"_UnregisterEvent",
0);Ls.addParameter("referenceId","String",1,null,0);Ls.addParameter("eventType","Microsoft.WordServices.EventType",1,null,0);const jq=Ch.addMethod("InsertFileFromBase64",1030,"Microsoft.WordServices.SectionCollection",3,0,"InsertFileFromBase64",0);jq.addParameter("base64File","String",1,null,0);jq.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);jq.addParameter("insertFileOptions","Microsoft.WordServices.InsertFileOptions",2,"Microsoft.WordServices.InsertFileOptions",
0);Ch.addMethod("GetParagraphByUniqueLocalId",1031,"Microsoft.WordServices.Paragraph",3,1,"ParagraphById",0).addParameter("id","String",1,null,0);const dr=e.addType("Microsoft.WordServices.DocumentCreated","{1a6e7a8e-fa7a-4f86-b7d0-b50a3c10f515}","",3,0);dr.addProperty("Body",3,"Microsoft.WordServices.Body",3,!0,null,0);dr.addProperty("ContentControls",4,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);dr.addProperty("CustomXmlParts",8,"Microsoft.WordServices.CustomXmlPartCollection",
3,!0,null,0);dr.addProperty("Properties",6,"Microsoft.WordServices.DocumentProperties",3,!0,null,0);dr.addProperty("Saved",1,"Boolean",1,!0,null,0);dr.addProperty("Sections",2,"Microsoft.WordServices.SectionCollection",3,!0,null,0);dr.addProperty("Settings",7,"Microsoft.WordServices.SettingCollection",3,!0,null,0);dr.addProperty("_ReferenceId",5,"String",1,!0,null,0);dr.addMethod("DeleteBookmark",1011,"Void",0,0,"DeleteBookmark",0).addParameter("name","String",1,null,0);dr.addMethod("GetBookmarkRange",
1010,"Microsoft.WordServices.Range",3,1,"BookmarkRange",0).addParameter("name","String",1,null,0);dr.addMethod("GetBookmarkRangeOrNullObject",1012,"Microsoft.WordServices.Range",3,1,"BookmarkRangeOrNullObject",0).addParameter("name","String",1,null,0);dr.addMethod("GetContentControls",1013,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);const CB=dr.addMethod("InsertFileFromBase64",
1014,"Microsoft.WordServices.SectionCollection",3,0,"InsertFileFromBase64",0);CB.addParameter("base64File","String",1,null,0);CB.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);CB.addParameter("insertFileOptions","Microsoft.WordServices.InsertFileOptions",2,"Microsoft.WordServices.InsertFileOptions",0);dr.addMethod("Open",1009,"Void",0,1,"Open",0);const cD=dr.addMethod("Save",1005,"Void",0,0,"Save",0);cD.addParameter("saveBehavior","Microsoft.WordServices.SaveBehavior",
1,null,0);cD.addParameter("fileName","String",1,null,0);dr.addMethod("_KeepReference",1008,"Void",0,1,"_KeepReference",0);dr.addMethod("_OnAccess",1007,"Void",0,1,"_OnAccess",0);const Bq=e.addType("Microsoft.WordServices.DocumentProperties","{642e1471-0cac-4dd2-bc76-1d1d0a3e130f}","",3,0);Bq.addProperty("ApplicationName",11,"String",1,!0,null,0);Bq.addProperty("Author",5,"String",1,!1,null,0);Bq.addProperty("Category",20,"String",1,!1,null,0);Bq.addProperty("Comments",7,"String",1,!1,null,0);Bq.addProperty("Company",
23,"String",1,!1,null,0);Bq.addProperty("CreationDate",13,"DateTime",1,!0,null,0);Bq.addProperty("CustomProperties",2,"Microsoft.WordServices.CustomPropertyCollection",3,!0,null,0);Bq.addProperty("Format",21,"String",1,!1,null,0);Bq.addProperty("Keywords",6,"String",1,!1,null,0);Bq.addProperty("LastAuthor",9,"String",1,!0,null,0);Bq.addProperty("LastPrintDate",12,"DateTime?",1,!0,null,0);Bq.addProperty("LastSaveTime",14,"DateTime?",1,!0,null,0);Bq.addProperty("Manager",22,"String",1,!1,null,0);Bq.addProperty("RevisionNumber",
10,"String",1,!0,null,0);Bq.addProperty("Security",19,"Int32?",1,!0,null,0);Bq.addProperty("Subject",4,"String",1,!1,null,0);Bq.addProperty("Template",8,"String",1,!0,null,0);Bq.addProperty("Title",3,"String",1,!1,null,0);Bq.addProperty("_ReferenceId",1,"String",1,!0,null,0);Bq.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Bq.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Ip=e.addType("Microsoft.WordServices.Field","{5109ffb2-cad2-4420-8f1d-edf33916127a}","",3,0);Ip.addProperty("_Id",
1,"Int32",1,!0,null,0);Ip.addProperty("_ReferenceId",2,"String",1,!0,null,0);Ip.addProperty("Code",3,"String",1,!0,null,0);Ip.addProperty("Result",4,"Microsoft.WordServices.Range",3,!0,null,0);Ip.addProperty("ParentBody",5,"Microsoft.WordServices.Body",3,!0,null,0);Ip.addProperty("ParentContentControl",6,"Microsoft.WordServices.ContentControl",3,!0,null,0);Ip.addProperty("ParentContentControlOrNullObject",7,"Microsoft.WordServices.ContentControl",3,!0,null,0);Ip.addProperty("ParentTable",8,"Microsoft.WordServices.Table",
3,!0,null,0);Ip.addProperty("ParentTableOrNullObject",9,"Microsoft.WordServices.Table",3,!0,null,0);Ip.addProperty("ParentTableCell",10,"Microsoft.WordServices.TableCell",3,!0,null,0);Ip.addProperty("ParentTableCellOrNullObject",11,"Microsoft.WordServices.TableCell",3,!0,null,0);Ip.addProperty("Data",16,"String",1,!1,null,0);Ip.addProperty("Kind",13,"Microsoft.WordServices.FieldKind",1,!0,null,0);Ip.addProperty("Locked",15,"Boolean",1,!1,null,0);Ip.addProperty("ShowCodes",14,"Boolean",1,!1,null,0);
Ip.addProperty("Type",12,"Microsoft.WordServices.FieldType",1,!0,null,0);Ip.addMethod("GetNextOrNullObject",1005,"Microsoft.WordServices.Field",3,1,"NextOrNullObject",0);Ip.addMethod("GetNext",1004,"Microsoft.WordServices.Field",3,1,"Next",0);Ip.addMethod("Delete",1003,"Void",0,0,"Delete",0);Ip.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Ip.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Ip.addMethod("Select",1007,"Void",Yh.None,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",
1,null,0);Ip.addMethod("UpdateResult",1006,"Void",Yh.None,0,"UpdateResult",0);const ts=e.addType("Microsoft.WordServices.FieldCollection","{1eb67e75-ccdb-483a-afb0-03a447729113}","",3,0);ts.addProperty("_ReferenceId",2,"String",1,!0,null,0);ts.addMethod("GetFirst",1003,"Microsoft.WordServices.Field",3,1,"First",0);ts.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Field",3,1,"FirstOrNullObject",0);ts.addIndexerMethod(1,"Microsoft.WordServices.Field",3,0).addParameter("index","Object",
1,null,0);ts.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);ts.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);ts.addMethod("getByTypes",1005,"Microsoft.WordServices.FieldCollection",Yh.ClassObject,1,"getByTypes",0).addParameter("types","Microsoft.WordServices.FieldType[]",1,null,0);ts.setCollectionInfo("Microsoft.WordServices.Field",!0);const kq=e.addType("Microsoft.WordServices.Font","{896a961f-e647-4b59-82da-5f1143b5afc1}","",3,0);kq.addProperty("Bold",4,"Boolean?",1,!1,null,
0);kq.addProperty("Color",6,"String",1,!1,null,0);kq.addProperty("DoubleStrikeThrough",11,"Boolean?",1,!1,null,0);kq.addProperty("HighlightColor",12,"String",1,!1,null,0);kq.addProperty("Italic",5,"Boolean?",1,!1,null,0);kq.addProperty("Name",2,"String",1,!1,null,0);kq.addProperty("Size",3,"Single?",1,!1,null,0);kq.addProperty("StrikeThrough",10,"Boolean?",1,!1,null,0);kq.addProperty("Subscript",8,"Boolean?",1,!1,null,0);kq.addProperty("Superscript",9,"Boolean?",1,!1,null,0);kq.addProperty("Underline",
7,"Microsoft.WordServices.UnderlineType",1,!1,null,0);kq.addProperty("_ReferenceId",1,"String",1,!0,null,0);kq.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);kq.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const yo=e.addType("Microsoft.WordServices.InlinePicture","{ef524552-be9e-413b-8030-e5eb3db24f19}","",3,0);yo.addProperty("AltTextDescription",3,"String",1,!1,null,0);yo.addProperty("AltTextTitle",4,"String",1,!1,null,0);yo.addProperty("Height",5,"Single",1,!1,null,0);yo.addProperty("Hyperlink",
6,"String",1,!1,null,0);yo.addProperty("ImageFormat",11,"Microsoft.WordServices.ImageFormat",1,!0,null,0);yo.addProperty("LockAspectRatio",7,"Boolean",1,!1,null,0);yo.addProperty("Paragraph",10,"Microsoft.WordServices.Paragraph",3,!0,null,0);yo.addProperty("ParentContentControl",9,"Microsoft.WordServices.ContentControl",3,!0,null,0);yo.addProperty("ParentContentControlOrNullObject",15,"Microsoft.WordServices.ContentControl",3,!0,null,0);yo.addProperty("ParentTable",14,"Microsoft.WordServices.Table",
3,!0,null,0);yo.addProperty("ParentTableCell",13,"Microsoft.WordServices.TableCell",3,!0,null,0);yo.addProperty("ParentTableCellOrNullObject",16,"Microsoft.WordServices.TableCell",3,!0,null,0);yo.addProperty("ParentTableOrNullObject",17,"Microsoft.WordServices.Table",3,!0,null,0);yo.addProperty("Width",8,"Single",1,!1,null,0);yo.addProperty("_Id",1,"Int32",1,!0,null,0);yo.addProperty("_ReferenceId",2,"String",1,!0,null,0);yo.addMethod("Delete",1012,"Void",0,0,"Delete",0);yo.addMethod("GetBase64ImageSrc",
1003,"String",1,1,"Base64ImageSrc",0);yo.addMethod("GetNext",1015,"Microsoft.WordServices.InlinePicture",3,1,"Next",0);yo.addMethod("GetNextOrNullObject",1016,"Microsoft.WordServices.InlinePicture",3,1,"NextOrNullObject",0);yo.addMethod("GetRange",1014,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);const qH=yo.addMethod("InsertBreak",1006,"Void",0,0,"InsertBreak",0);qH.addParameter("breakType","Microsoft.WordServices.BreakType",
1,null,0);qH.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);yo.addMethod("InsertContentControl",1004,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0);const it=yo.addMethod("InsertFileFromBase64",1011,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",0);it.addParameter("base64File","String",1,null,0);it.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Rt=yo.addMethod("InsertHtml",1008,"Microsoft.WordServices.Range",
3,0,"InsertHtml",0);Rt.addParameter("html","String",1,null,0);Rt.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const bz=yo.addMethod("InsertInlinePictureFromBase64",1005,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);bz.addParameter("base64EncodedImage","String",1,null,0);bz.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Yr=yo.addMethod("InsertOoxml",1009,"Microsoft.WordServices.Range",3,0,"InsertOoxml",
0);Yr.addParameter("ooxml","String",1,null,0);Yr.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const fy=yo.addMethod("InsertParagraph",1010,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);fy.addParameter("paragraphText","String",1,null,0);fy.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Ww=yo.addMethod("InsertText",1007,"Microsoft.WordServices.Range",3,0,"InsertText",0);Ww.addParameter("text","String",1,null,0);
Ww.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);yo.addMethod("Select",1013,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);yo.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);yo.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const qv=e.addType("Microsoft.WordServices.InlinePictureCollection","{ea74232b-e74b-4a8b-9d30-04d181c29cfa}","",3,0);qv.addProperty("_ReferenceId",2,"String",1,!0,null,
0);qv.addMethod("GetFirst",1003,"Microsoft.WordServices.InlinePicture",3,1,"First",0);qv.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.InlinePicture",3,1,"FirstOrNullObject",0);qv.addIndexerMethod(1,"Microsoft.WordServices.InlinePicture",3,0).addParameter("index","Object",1,null,0);qv.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);qv.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);qv.setCollectionInfo("Microsoft.WordServices.InlinePicture",!0);const lq=e.addType("Microsoft.WordServices.List",
"{92cb59a8-b889-4985-840c-42b2f740ef33}","",3,0);lq.addProperty("Id",1,"Int32",1,!0,null,0);lq.addProperty("LevelExistences",5,"Boolean[]",1,!0,null,0);lq.addProperty("LevelTypes",4,"Microsoft.WordServices.ListLevelType[]",1,!0,null,0);lq.addProperty("Paragraphs",3,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);lq.addProperty("_ReferenceId",2,"String",1,!0,null,0);lq.addMethod("GetLevelFont",1010,"Microsoft.WordServices.Font",3,1,"LevelFont",0).addParameter("level","Int32",1,null,0);lq.addMethod("GetLevelParagraphs",
1004,"Microsoft.WordServices.ParagraphCollection",3,1,"LevelParagraphs",0).addParameter("level","Int32",1,null,0);lq.addMethod("GetLevelPicture",1009,"String",1,1,"LevelPicture",0).addParameter("level","Int32",1,null,0);lq.addMethod("GetLevelString",1007,"String",1,1,"LevelString",0).addParameter("level","Int32",1,null,0);const iw=lq.addMethod("InsertParagraph",1003,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);iw.addParameter("paragraphText","String",1,null,0);iw.addParameter("insertLocation",
"Microsoft.WordServices.InsertLocation",1,null,0);const rF=lq.addMethod("ResetLevelFont",1011,"Void",0,0,"ResetLevelFont",0);rF.addParameter("level","Int32",1,null,0);rF.addParameter("resetFontName","Boolean",1,null,0);const pu=lq.addMethod("SetLevelAlignment",1012,"Void",0,0,"SetLevelAlignment",0);pu.addParameter("level","Int32",1,null,0);pu.addParameter("alignment","Microsoft.WordServices.Alignment",1,null,0);const Pu=lq.addMethod("SetLevelBullet",1005,"Void",0,0,"SetLevelBullet",0);Pu.addParameter("level",
"Int32",1,null,0);Pu.addParameter("listBullet","Microsoft.WordServices.ListBullet",1,null,0);Pu.addParameter("charCode","Int32",1,null,0);Pu.addParameter("fontName","String",1,null,0);const bo=lq.addMethod("SetLevelIndents",1013,"Void",0,0,"SetLevelIndents",0);bo.addParameter("level","Int32",1,null,0);bo.addParameter("textIndent","Single",1,null,0);bo.addParameter("bulletNumberPictureIndent","Single",1,null,0);const jA=lq.addMethod("SetLevelNumbering",1006,"Void",0,0,"SetLevelNumbering",0);jA.addParameter("level",
"Int32",1,null,0);jA.addParameter("listNumbering","Microsoft.WordServices.ListNumbering",1,null,0);jA.addParameter("formatString","Object[]",1,null,0);const dD=lq.addMethod("SetLevelPicture",1008,"Void",0,0,"SetLevelPicture",0);dD.addParameter("level","Int32",1,null,0);dD.addParameter("base64EncodedImage","String",1,null,0);const sF=lq.addMethod("SetLevelStartingNumber",1014,"Void",0,0,"SetLevelStartingNumber",0);sF.addParameter("level","Int32",1,null,0);sF.addParameter("startingNumber","Int32",1,
null,0);lq.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);lq.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);const jw=e.addType("Microsoft.WordServices.ListCollection","{d36f169f-d0b0-44e9-a933-62c4dcb1964f}","",3,0);jw.addProperty("_ReferenceId",2,"String",1,!0,null,0);jw.addMethod("GetById",1002,"Microsoft.WordServices.List",3,1,"ById",0).addParameter("id","Int32",1,null,0);jw.addMethod("GetByIdOrNullObject",1005,"Microsoft.WordServices.List",3,1,"ByIdOrNullObject",0).addParameter("id",
"Int32",1,null,0);jw.addMethod("GetFirst",1004,"Microsoft.WordServices.List",3,1,"First",0);jw.addMethod("GetFirstOrNullObject",1006,"Microsoft.WordServices.List",3,1,"FirstOrNullObject",0);jw.addIndexerMethod(1,"Microsoft.WordServices.List",3,0).addParameter("index","Object",1,null,0);jw.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);jw.addMethod("_OnAccess",1003,"Void",0,1,"_OnAccess",0);jw.setCollectionInfo("Microsoft.WordServices.List",!0);const Qu=e.addType("Microsoft.WordServices.ListItem",
"{f32748c0-d8dd-44ae-a550-92ed26a085a8}","",3,0);Qu.addProperty("Level",4,"Int32",1,!1,null,0);Qu.addProperty("ListString",3,"String",1,!0,null,0);Qu.addProperty("SiblingIndex",2,"Int32",1,!0,null,0);Qu.addProperty("_ReferenceId",1,"String",1,!0,null,0);Qu.addMethod("GetAncestor",1003,"Microsoft.WordServices.Paragraph",3,1,"Ancestor",0).addParameter("parentOnly","Boolean",1,null,0);Qu.addMethod("GetAncestorOrNullObject",1005,"Microsoft.WordServices.Paragraph",3,1,"AncestorOrNullObject",0).addParameter("parentOnly",
"Boolean",1,null,0);Qu.addMethod("GetDescendants",1004,"Microsoft.WordServices.ParagraphCollection",3,1,"Descendants",0).addParameter("directChildrenOnly","Boolean",1,null,0);Qu.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Qu.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Br=e.addType("Microsoft.WordServices.ListLevel","{533c4bba-63a4-4254-b249-2a6cf843330f}","",3,0);Br.addProperty("Alignment",3,"Microsoft.WordServices.Alignment",1,!1,null,0);Br.addProperty("Font",4,
"Microsoft.WordServices.Font",Yh.ClassObject,!0,null,0);Br.addProperty("LinkedStyle",5,"String",1,!1,null,0);Br.addProperty("NumberFormat",6,"String",1,!1,null,0);Br.addProperty("NumberPosition",7,"Single",1,!1,null,0);Br.addProperty("NumberStyle",8,"Microsoft.WordServices.ListBuiltInNumberStyle",1,!1,null,0);Br.addProperty("ResetOnHigher",9,"Int32",1,!1,null,0);Br.addProperty("StartAt",10,"Int32",1,!1,null,0);Br.addProperty("TabPosition",11,"Single",1,!1,null,0);Br.addProperty("TextPosition",12,
"Single",1,!1,null,0);Br.addProperty("TrailingCharacter",13,"Microsoft.WordServices.TrailingCharacter",1,!1,null,0);Br.addProperty("_Id",1,"Int32",1,!0,null,0);Br.addProperty("_ReferenceId",2,"String",1,!0,null,0);Br.addMethod("_KeepReference",1002,"Void",Yh.None,1,"_KeepReference",0);Br.addMethod("_OnAccess",1001,"Void",Yh.None,1,"_OnAccess",0);const kw=e.addType("Microsoft.WordServices.ListLevelCollection","{0bb00b5d-0a29-41f6-a0d8-f74c3a153600}","",3,0);kw.addProperty("_ReferenceId",2,"String",
1,!0,null,0);kw.addMethod("GetFirst",1003,"Microsoft.WordServices.ListLevel",Yh.ClassObject,1,"First",0);kw.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.ListLevel",Yh.ClassObject,1,"FirstOrNullObject",0);kw.addIndexerMethod(1,"Microsoft.WordServices.ListLevel",Yh.ClassObject,0).addParameter("index","Object",1,null,0);kw.addMethod("_KeepReference",1001,"Void",Yh.None,1,"_KeepReference",0);kw.addMethod("_OnAccess",1002,"Void",Yh.None,1,"_OnAccess",0);kw.setCollectionInfo("Microsoft.WordServices.ListLevel",
!0);const lw=e.addType("Microsoft.WordServices.ListTemplate","{6f2e0a54-8e99-420c-9716-81cae154ac0e}","",3,0);lw.addProperty("ListLevels",2,"Microsoft.WordServices.ListLevelCollection",Yh.ClassObject,!0,null,0);lw.addProperty("OutlineNumbered",3,"Boolean",1,!1,null,0);lw.addProperty("_ReferenceId",1,"String",1,!0,null,0);lw.addMethod("_KeepReference",1002,"Void",Yh.None,1,"_KeepReference",0);lw.addMethod("_OnAccess",1001,"Void",Yh.None,1,"_OnAccess",0);const Ru=e.addType("Microsoft.WordServices.NoteItem",
"{4869fd78-c024-4e18-9405-ffa60e9bfd51}","",3,0);Ru.addProperty("Body",4,"Microsoft.WordServices.Body",3,!0,null,0);Ru.addProperty("Reference",5,"Microsoft.WordServices.Range",3,!0,null,0);Ru.addProperty("Type",3,"Microsoft.WordServices.NoteItemType",1,!0,null,0);Ru.addProperty("_Id",1,"String",1,!0,null,0);Ru.addProperty("_ReferenceId",2,"String",1,!0,null,0);Ru.addMethod("Delete",1003,"Void",0,0,"Delete",0);Ru.addMethod("GetNext",1004,"Microsoft.WordServices.NoteItem",3,1,"Next",0);Ru.addMethod("GetNextOrNullObject",
1005,"Microsoft.WordServices.NoteItem",3,1,"NextOrNullObject",0);Ru.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Ru.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Zr=e.addType("Microsoft.WordServices.NoteItemCollection","{38a0db4c-d855-40aa-879e-2251a0f17b11}","",3,0);Zr.addProperty("_ReferenceId",2,"String",1,!0,null,0);Zr.addMethod("GetFirst",1003,"Microsoft.WordServices.NoteItem",3,1,"First",0);Zr.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.NoteItem",
3,1,"FirstOrNullObject",0);Zr.addIndexerMethod(1,"Microsoft.WordServices.NoteItem",3,0).addParameter("index","Object",1,null,0);Zr.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Zr.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);Zr.setCollectionInfo("Microsoft.WordServices.NoteItem",!0);const Uh=e.addType("Microsoft.WordServices.Paragraph","{d0c9772c-becf-4961-a582-8024ebdc614c}","",3,0);Uh.addProperty("Alignment",7,"Microsoft.WordServices.Alignment",1,!1,null,0);Uh.addProperty("ContentControls",
5,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Uh.addProperty("Endnotes",36,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Uh.addProperty("FirstLineIndent",8,"Single",1,!1,null,0);Uh.addProperty("Font",3,"Microsoft.WordServices.Font",3,!0,null,0);Uh.addProperty("Footnotes",35,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Uh.addProperty("Fields",37,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Uh.addProperty("InlinePictures",17,"Microsoft.WordServices.InlinePictureCollection",
3,!0,null,0);Uh.addProperty("IsLastParagraph",28,"Boolean",1,!0,null,0);Uh.addProperty("IsListItem",19,"Boolean",1,!0,null,0);Uh.addProperty("LeftIndent",9,"Single",1,!1,null,0);Uh.addProperty("LineSpacing",11,"Single",1,!1,null,0);Uh.addProperty("LineUnitAfter",16,"Single",1,!1,null,0);Uh.addProperty("LineUnitBefore",15,"Single",1,!1,null,0);Uh.addProperty("List",24,"Microsoft.WordServices.List",3,!0,null,0);Uh.addProperty("ListItem",27,"Microsoft.WordServices.ListItem",3,!0,null,0);Uh.addProperty("ListItemOrNullObject",
34,"Microsoft.WordServices.ListItem",3,!0,null,0);Uh.addProperty("ListOrNullObject",33,"Microsoft.WordServices.List",3,!0,null,0);Uh.addProperty("OutlineLevel",12,"Int32",1,!1,null,0);Uh.addProperty("ParentBody",23,"Microsoft.WordServices.Body",3,!0,null,0);Uh.addProperty("ParentContentControl",6,"Microsoft.WordServices.ContentControl",3,!0,null,0);Uh.addProperty("ParentContentControlOrNullObject",30,"Microsoft.WordServices.ContentControl",3,!0,null,0);Uh.addProperty("ParentTable",26,"Microsoft.WordServices.Table",
3,!0,null,0);Uh.addProperty("ParentTableCell",25,"Microsoft.WordServices.TableCell",3,!0,null,0);Uh.addProperty("ParentTableCellOrNullObject",31,"Microsoft.WordServices.TableCell",3,!0,null,0);Uh.addProperty("ParentTableOrNullObject",32,"Microsoft.WordServices.Table",3,!0,null,0);Uh.addProperty("RightIndent",10,"Single",1,!1,null,0);Uh.addProperty("SpaceAfter",14,"Single",1,!1,null,0);Uh.addProperty("SpaceBefore",13,"Single",1,!1,null,0);Uh.addProperty("Style",4,"String",1,!1,null,0);Uh.addProperty("StyleBuiltIn",
29,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Uh.addProperty("TableNestingLevel",22,"Int32",1,!0,null,0);Uh.addProperty("Text",18,"String",1,!0,null,0);Uh.addProperty("_Id",1,"Int32",1,!0,null,0);Uh.addProperty("_ReferenceId",2,"String",1,!0,null,0);Uh.addProperty("UniqueLocalId",38,"String",1,!0,null,0);const dp=Uh.addMethod("AttachToList",1022,"Microsoft.WordServices.List",3,0,"AttachToList",0);dp.addParameter("listId","Int32",1,null,0);dp.addParameter("level","Int32",1,null,0);Uh.addMethod("Clear",
1011,"Void",0,0,"Clear",0);Uh.addMethod("Delete",1012,"Void",0,0,"Delete",0);Uh.addMethod("DetachFromList",1023,"Void",0,0,"DetachFromList",0);Uh.addMethod("GetComments",1032,"Microsoft.WordServices.CommentCollection",3,1,"Comments",0);Uh.addMethod("GetContentControls",1034,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);Uh.addMethod("GetHtml",1014,
"String",1,1,"Html",0);Uh.addMethod("GetMetadata",1028,"Object",1,1,"Metadata",0).addParameter("propertyGUID","String",1,null,0);Uh.addMethod("GetNext",1024,"Microsoft.WordServices.Paragraph",3,1,"Next",0);Uh.addMethod("GetNextOrNullObject",1026,"Microsoft.WordServices.Paragraph",3,1,"NextOrNullObject",0);Uh.addMethod("GetOoxml",1015,"String",1,1,"Ooxml",0);Uh.addMethod("GetPrevious",1025,"Microsoft.WordServices.Paragraph",3,1,"Previous",0);Uh.addMethod("GetPreviousOrNullObject",1027,"Microsoft.WordServices.Paragraph",
3,1,"PreviousOrNullObject",0);Uh.addMethod("GetRange",1017,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);Uh.addMethod("GetReviewedText",1033,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);const rH=Uh.addMethod("GetSubrange",1030,"Microsoft.WordServices.Range",3,1,"Subrange",0);rH.addParameter("start","Int32",1,null,0);rH.addParameter("length",
"Int32",1,null,0);const tF=Uh.addMethod("GetTextRanges",1020,"Microsoft.WordServices.RangeCollection",3,1,"TextRanges",0);tF.addParameter("endingMarks","String[]",1,null,0);tF.addParameter("trimSpacing","Boolean",1,null,0);const eD=Uh.addMethod("InsertBreak",1010,"Void",0,0,"InsertBreak",0);eD.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);eD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Uh.addMethod("InsertContentControl",1004,"Microsoft.WordServices.ContentControl",
3,0,"InsertContentControl",0).addParameter("type","Microsoft.WordServices.ContentControlType",1,null,0);const er=Uh.addMethod("InsertFileFromBase64",1008,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",0);er.addParameter("base64File","String",1,null,0);er.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const uF=Uh.addMethod("InsertHtml",1006,"Microsoft.WordServices.Range",3,0,"InsertHtml",0);uF.addParameter("html","String",1,null,0);uF.addParameter("insertLocation",
"Microsoft.WordServices.InsertLocation",1,null,0);const vF=Uh.addMethod("InsertInlinePictureFromBase64",1003,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);vF.addParameter("base64EncodedImage","String",1,null,0);vF.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const fD=Uh.addMethod("InsertOoxml",1007,"Microsoft.WordServices.Range",3,0,"InsertOoxml",0);fD.addParameter("ooxml","String",1,null,0);fD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);const wF=Uh.addMethod("InsertParagraph",1009,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);wF.addParameter("paragraphText","String",1,null,0);wF.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const DB=Uh.addMethod("InsertTable",1019,"Microsoft.WordServices.Table",3,0,"InsertTable",0);DB.addParameter("rowCount","Int32",1,null,0);DB.addParameter("columnCount","Int32",1,null,0);DB.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);DB.addParameter("values","String[][]",1,null,0);const gD=Uh.addMethod("InsertText",1005,"Microsoft.WordServices.Range",3,0,"InsertText",0);gD.addParameter("text","String",1,null,0);gD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Su=Uh.addMethod("Search",1016,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);Su.addParameter("searchText","String",1,null,0);Su.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Uh.addMethod("Select",
1013,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const sH=Uh.addMethod("SetMetadata",1029,"Void",0,0,"SetMetadata",0);sH.addParameter("propertyGUID","String",1,null,0);sH.addParameter("propertyValue","Object",1,null,0);const xF=Uh.addMethod("Split",1018,"Microsoft.WordServices.RangeCollection",3,1,"Split",0);xF.addParameter("delimiters","String[]",1,null,0);xF.addParameter("trimDelimiters","Boolean",1,null,0);xF.addParameter("trimSpacing","Boolean",
1,null,0);Uh.addMethod("StartNewList",1021,"Microsoft.WordServices.List",3,0,"StartNewList",0);Uh.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Uh.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const yF=Uh.addMethod("_Search2",1031,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);yF.addParameter("searchText","String",1,null,0);yF.addParameter("searchFlags","Int32",1,null,0);const Ms=e.addType("Microsoft.WordServices.ParagraphCollection","{20a0d5b4-fb08-460c-96aa-6af4afe8f1ba}",
"",3,0);Ms.addProperty("_ReferenceId",2,"String",1,!0,null,0);Ms.addMethod("GetFirst",1003,"Microsoft.WordServices.Paragraph",3,1,"First",0);Ms.addMethod("GetFirstOrNullObject",1005,"Microsoft.WordServices.Paragraph",3,1,"FirstOrNullObject",0);Ms.addMethod("GetLast",1004,"Microsoft.WordServices.Paragraph",3,1,"Last",0);Ms.addMethod("GetLastOrNullObject",1006,"Microsoft.WordServices.Paragraph",3,1,"LastOrNullObject",0);Ms.addMethod("GetById",1007,"Microsoft.WordServices.Paragraph",3,1,"ById",4).addParameter("id",
"String",1,null,0);Ms.addMethod("GetByIdOrNullObject",1008,"Microsoft.WordServices.Paragraph",3,1,"ByIdOrNullObject",4).addParameter("id","String",1,null,0);Ms.addIndexerMethod(1,"Microsoft.WordServices.Paragraph",3,0).addParameter("index","Object",1,null,0);Ms.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Ms.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);Ms.setCollectionInfo("Microsoft.WordServices.Paragraph",!0);const Ns=e.addType("Microsoft.WordServices.ParagraphFormat",
"{83717b74-133d-406e-b769-670eb67c577c}","",3,0);Ns.addProperty("Alignment",2,"Microsoft.WordServices.Alignment",1,!1,null,0);Ns.addProperty("FirstLineIndent",3,"Single",1,!1,null,0);Ns.addProperty("KeepTogether",4,"Boolean",1,!1,null,0);Ns.addProperty("KeepWithNext",5,"Boolean",1,!1,null,0);Ns.addProperty("LeftIndent",6,"Single",1,!1,null,0);Ns.addProperty("LineSpacing",7,"Single",1,!1,null,0);Ns.addProperty("LineUnitAfter",8,"Single",1,!1,null,0);Ns.addProperty("LineUnitBefore",9,"Single",1,!1,
null,0);Ns.addProperty("MirrorIndents",10,"Boolean",1,!1,null,0);Ns.addProperty("OutlineLevel",11,"Microsoft.WordServices.OutlineLevel",1,!1,null,0);Ns.addProperty("RightIndent",12,"Single",1,!1,null,0);Ns.addProperty("SpaceAfter",13,"Single",1,!1,null,0);Ns.addProperty("SpaceBefore",14,"Single",1,!1,null,0);Ns.addProperty("WidowControl",15,"Boolean",1,!1,null,0);Ns.addProperty("_ReferenceId",1,"String",1,!0,null,0);Ns.addMethod("_KeepReference",1002,"Void",Yh.None,1,"_KeepReference",0);Ns.addMethod("_OnAccess",
1001,"Void",Yh.None,1,"_OnAccess",0);const Kj=e.addType("Microsoft.WordServices.Range","{4869fd78-c024-4e18-9405-ffa60e9bfd50}","",3,0);Kj.addProperty("ContentControls",6,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Kj.addProperty("Endnotes",22,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Kj.addProperty("Fields",23,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Kj.addProperty("Font",3,"Microsoft.WordServices.Font",3,!0,null,0);Kj.addProperty("Footnotes",21,"Microsoft.WordServices.NoteItemCollection",
3,!0,null,0);Kj.addProperty("Hyperlink",11,"String",1,!1,null,0);Kj.addProperty("InlinePictures",8,"Microsoft.WordServices.InlinePictureCollection",3,!0,null,0);Kj.addProperty("IsEmpty",10,"Boolean",1,!0,null,0);Kj.addProperty("Lists",12,"Microsoft.WordServices.ListCollection",3,!0,null,0);Kj.addProperty("Paragraphs",5,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);Kj.addProperty("ParentBody",16,"Microsoft.WordServices.Body",3,!0,null,0);Kj.addProperty("ParentContentControl",7,"Microsoft.WordServices.ContentControl",
3,!0,null,0);Kj.addProperty("ParentContentControlOrNullObject",18,"Microsoft.WordServices.ContentControl",3,!0,null,0);Kj.addProperty("ParentTable",15,"Microsoft.WordServices.Table",3,!0,null,0);Kj.addProperty("ParentTableCell",14,"Microsoft.WordServices.TableCell",3,!0,null,0);Kj.addProperty("ParentTableCellOrNullObject",19,"Microsoft.WordServices.TableCell",3,!0,null,0);Kj.addProperty("ParentTableOrNullObject",20,"Microsoft.WordServices.Table",3,!0,null,0);Kj.addProperty("Style",4,"String",1,!1,
null,0);Kj.addProperty("StyleBuiltIn",17,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Kj.addProperty("Tables",13,"Microsoft.WordServices.TableCollection",3,!0,null,0);Kj.addProperty("Text",9,"String",1,!0,null,0);Kj.addProperty("_Id",1,"Int32",1,!0,null,0);Kj.addProperty("_ReferenceId",2,"String",1,!0,null,0);Kj.addMethod("GetReviewedText",1041,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);Kj.addMethod("Clear",
1011,"Void",0,0,"Clear",0);Kj.addMethod("CompareLocationWith",1019,"Microsoft.WordServices.LocationRelation",1,1,"CompareLocationWith",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Kj.addMethod("Delete",1012,"Void",0,0,"Delete",0);Kj.addMethod("EndPreview",1035,"Void",0,1,"EndPreview",0);Kj.addMethod("ExpandTo",1020,"Microsoft.WordServices.Range",3,0,"ExpandTo",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Kj.addMethod("ExpandToOrNullObject",1028,"Microsoft.WordServices.Range",
3,0,"ExpandToOrNullObject",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);const hD=Kj.addMethod("GetBookmarks",1026,"String[]",1,1,"Bookmarks",0);hD.addParameter("includeHidden","Boolean",1,null,0);hD.addParameter("includeAdjacent","Boolean",1,null,0);Kj.addMethod("GetComments",1040,"Microsoft.WordServices.CommentCollection",3,1,"Comments",0);Kj.addMethod("GetContentControls",1042,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options",
"Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);Kj.addMethod("GetHtml",1014,"String",1,1,"Html",0);Kj.addMethod("GetHyperlinkRanges",1023,"Microsoft.WordServices.RangeCollection",3,1,"HyperlinkRanges",0);const Ej=Kj.addMethod("GetNextTextRange",1022,"Microsoft.WordServices.Range",3,1,"NextTextRange",0);Ej.addParameter("endingMarks","String[]",1,null,0);Ej.addParameter("trimSpacing","Boolean",1,null,0);const Jn=Kj.addMethod("GetNextTextRangeOrNullObject",
1030,"Microsoft.WordServices.Range",3,1,"NextTextRangeOrNullObject",0);Jn.addParameter("endingMarks","String[]",1,null,0);Jn.addParameter("trimSpacing","Boolean",1,null,0);Kj.addMethod("GetOoxml",1015,"String",1,1,"Ooxml",0);Kj.addMethod("GetRange",1017,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);const xt=Kj.addMethod("GetTextRanges",1025,"Microsoft.WordServices.RangeCollection",3,1,"TextRanges",0);xt.addParameter("endingMarks",
"String[]",1,null,0);xt.addParameter("trimSpacing","Boolean",1,null,0);Kj.addMethod("Highlight",1032,"Void",0,1,"Highlight",0).addParameter("color","String",1,null,0);Kj.addMethod("InsertBookmark",1027,"Void",0,0,"InsertBookmark",0).addParameter("name","String",1,null,0);const tH=Kj.addMethod("InsertBreak",1009,"Void",0,0,"InsertBreak",0);tH.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);tH.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Kj.addMethod("InsertComment",
1039,"Microsoft.WordServices.Comment",3,0,"InsertComment",0).addParameter("commentText","String",1,null,0);Kj.addMethod("InsertContentControl",1003,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0).addParameter("type","Microsoft.WordServices.ContentControlType",1,null,0);Kj.addMethod("InsertEndnote",1038,"Microsoft.WordServices.NoteItem",3,0,"InsertEndnote",0).addParameter("insertText","String",1,null,0);const Qg=Kj.addMethod("InsertField",1043,"Microsoft.WordServices.Field",Yh.ClassObject,
0,"InsertField",0);Qg.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Qg.addParameter("fieldType","Microsoft.WordServices.FieldType",1,null,0);Qg.addParameter("text","String",1,null,0);Qg.addParameter("removeFormatting","Boolean",1,null,0);const EB=Kj.addMethod("InsertFileFromBase64",1007,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",0);EB.addParameter("base64File","String",1,null,0);EB.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);Kj.addMethod("InsertFootnote",1037,"Microsoft.WordServices.NoteItem",3,0,"InsertFootnote",0).addParameter("insertText","String",1,null,0);const zF=Kj.addMethod("InsertHtml",1005,"Microsoft.WordServices.Range",3,0,"InsertHtml",0);zF.addParameter("html","String",1,null,0);zF.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const uH=Kj.addMethod("InsertInlinePictureFromBase64",1010,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);
uH.addParameter("base64EncodedImage","String",1,null,0);uH.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const vH=Kj.addMethod("InsertOoxml",1006,"Microsoft.WordServices.Range",3,0,"InsertOoxml",0);vH.addParameter("ooxml","String",1,null,0);vH.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const $d=Kj.addMethod("InsertParagraph",1008,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);$d.addParameter("paragraphText","String",
1,null,0);$d.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const kA=Kj.addMethod("InsertTable",1024,"Microsoft.WordServices.Table",3,0,"InsertTable",0);kA.addParameter("rowCount","Int32",1,null,0);kA.addParameter("columnCount","Int32",1,null,0);kA.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);kA.addParameter("values","String[][]",1,null,0);const iD=Kj.addMethod("InsertTapObjectFromFileContent",1031,"Microsoft.WordServices.Range",
3,0,"InsertTapObjectFromFileContent",4);iD.addParameter("fileContent","String",1,null,0);iD.addParameter("objectType","Microsoft.WordServices.TapObjectType",1,null,0);iD.addParameter("contentFormat","Microsoft.WordServices.FileContentFormat",1,null,0);const FB=Kj.addMethod("InsertText",1004,"Microsoft.WordServices.Range",3,0,"InsertText",0);FB.addParameter("text","String",1,null,0);FB.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Kj.addMethod("IntersectWith",1021,
"Microsoft.WordServices.Range",3,0,"IntersectWith",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Kj.addMethod("IntersectWithOrNullObject",1029,"Microsoft.WordServices.Range",3,0,"IntersectWithOrNullObject",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Kj.addMethod("PreviewTextReplacement",1034,"Void",0,1,"PreviewTextReplacement",0).addParameter("replacement","String",1,null,0);Kj.addMethod("RemoveHighlight",1033,"Void",0,1,"RemoveHighlight",0);const GB=Kj.addMethod("Search",
1016,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);GB.addParameter("searchText","String",1,null,0);GB.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Kj.addMethod("Select",1013,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const HB=Kj.addMethod("Split",1018,"Microsoft.WordServices.RangeCollection",3,1,"Split",0);HB.addParameter("delimiters","String[]",1,null,0);HB.addParameter("multiParagraphs","Boolean",
1,null,0);HB.addParameter("trimDelimiters","Boolean",1,null,0);HB.addParameter("trimSpacing","Boolean",1,null,0);Kj.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Kj.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const AF=Kj.addMethod("_Search2",1036,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);AF.addParameter("searchText","String",1,null,0);AF.addParameter("searchFlags","Int32",1,null,0);const gy=e.addType("Microsoft.WordServices.RangeCollection","{38a0db4c-d855-40aa-879e-2251a0f17b1f}",
"",3,0);gy.addProperty("_ReferenceId",2,"String",1,!0,null,0);gy.addMethod("GetFirst",1003,"Microsoft.WordServices.Range",3,1,"First",0);gy.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Range",3,1,"FirstOrNullObject",0);gy.addIndexerMethod(1,"Microsoft.WordServices.Range",3,0).addParameter("index","Object",1,null,0);gy.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);gy.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);gy.setCollectionInfo("Microsoft.WordServices.Range",
!0);const hy=e.addType("Microsoft.WordServices.InsertFileOptions","{d396444d-d57f-45bb-a6b1-656f573b250f}","{0ad8e799-7550-4095-aa56-c0c6171febe8}",2,0);hy.addProperty("importCustomXmlParts",7,"Boolean",1,!1,null,0);hy.addProperty("importCustomProperties",6,"Boolean",1,!1,null,0);hy.addProperty("importChangeTrackingMode",5,"Boolean",1,!1,null,0);hy.addProperty("importPageColor",4,"Boolean",1,!1,null,0);hy.addProperty("importParagraphSpacing",3,"Boolean",1,!1,null,0);hy.addProperty("importStyles",
2,"Boolean",1,!1,null,0);hy.addProperty("importTheme",1,"Boolean",1,!1,null,0);const cz=e.addType("Microsoft.WordServices.SearchOptions","{957e194f-14af-462d-bd95-e29a55de3b4a}","{88b0a400-950b-42b1-b183-258f504bf71f}",3,0);cz.addProperty("IgnorePunct",1,"Boolean",1,!1,null,0);cz.addProperty("IgnoreSpace",2,"Boolean",1,!1,null,0);cz.addProperty("MatchCase",3,"Boolean",1,!1,null,0);cz.addProperty("MatchPrefix",4,"Boolean",1,!1,null,0);cz.addProperty("MatchSuffix",6,"Boolean",1,!1,null,0);cz.addProperty("MatchWholeWord",
8,"Boolean",1,!1,null,0);cz.addProperty("MatchWildcards",7,"Boolean",1,!1,null,0);const yt=e.addType("Microsoft.WordServices.Section","{a9d1403c-908b-4178-aa45-6b406aeb8cbf}","",3,0);yt.addProperty("Body",3,"Microsoft.WordServices.Body",3,!0,null,0);yt.addProperty("_Id",1,"Int32",1,!0,null,0);yt.addProperty("_ReferenceId",2,"String",1,!0,null,0);yt.addMethod("GetFooter",1004,"Microsoft.WordServices.Body",3,1,"Footer",0).addParameter("type","Microsoft.WordServices.HeaderFooterType",1,null,0);yt.addMethod("GetHeader",
1003,"Microsoft.WordServices.Body",3,1,"Header",0).addParameter("type","Microsoft.WordServices.HeaderFooterType",1,null,0);yt.addMethod("GetNext",1005,"Microsoft.WordServices.Section",3,1,"Next",0);yt.addMethod("GetNextOrNullObject",1006,"Microsoft.WordServices.Section",3,1,"NextOrNullObject",0);yt.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);yt.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const us=e.addType("Microsoft.WordServices.SectionCollection","{23ef4423-1c46-48ee-951a-cec1d21d3a5b}",
"",3,0);us.addProperty("_ReferenceId",2,"String",1,!0,null,0);us.addMethod("GetFirst",1003,"Microsoft.WordServices.Section",3,1,"First",0);us.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Section",3,1,"FirstOrNullObject",0);us.addIndexerMethod(1,"Microsoft.WordServices.Section",3,0).addParameter("index","Object",1,null,0);us.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);us.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);us.setCollectionInfo("Microsoft.WordServices.Section",
!0);const St=e.addType("Microsoft.WordServices.Setting","{03764d8a-7c3a-4a5f-82ec-029fbc6f57ee}","",3,0);St.addProperty("Key",2,"String",1,!0,null,0);St.addProperty("Value",3,"Object",1,!1,null,0);St.addProperty("_Id",4,"String",1,!0,null,0);St.addProperty("_ReferenceId",1,"String",1,!0,null,0);St.addMethod("Delete",1003,"Void",0,0,"Delete",0);St.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);St.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const $r=e.addType("Microsoft.WordServices.SettingCollection",
"{02c3b0b1-2468-48c1-8c30-c1e38c6734f7}","",3,0);$r.addProperty("_ReferenceId",2,"String",1,!0,null,0);const th=$r.addMethod("Add",1003,"Microsoft.WordServices.Setting",3,0,"Add",0);th.addParameter("key","String",1,null,0);th.addParameter("value","Object",1,null,0);$r.addMethod("DeleteAll",1005,"Void",0,0,"DeleteAll",0);$r.addMethod("GetCount",1004,"Int32",1,1,"Count",0);$r.addIndexerMethod(1,"Microsoft.WordServices.Setting",3,0).addParameter("key","String",1,null,0);$r.addMethod("GetItemOrNullObject",
1006,"Microsoft.WordServices.Setting",3,1,"ItemOrNullObject",0).addParameter("key","String",1,null,0);$r.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);$r.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);$r.setCollectionInfo("Microsoft.WordServices.Setting",!0);const qu=e.addType("Microsoft.WordServices.StyleCollection","{fee8d15d-a953-4906-aa80-af8d02008719}","",3,0);qu.addProperty("_ReferenceId",2,"String",1,!0,null,0);qu.addMethod("GetByName",1003,"Microsoft.WordServices.Style",
Yh.ClassObject,1,"GetByName",0).addParameter("name","String",1,null,0);qu.addMethod("GetByNameOrNullObject",1004,"Microsoft.WordServices.Style",Yh.ClassObject,1,"GetByNameOrNullObject",0).addParameter("name","String",1,null,0);qu.addMethod("GetCount",1005,"Int32",1,1,"Count",0);qu.addIndexerMethod(1,"Microsoft.WordServices.Style",Yh.ClassObject,0).addParameter("index","Object",1,null,0);qu.addMethod("_KeepReference",1002,"Void",Yh.None,1,"_KeepReference",0);qu.addMethod("_OnAccess",1001,"Void",Yh.None,
1,"_OnAccess",0);qu.setCollectionInfo("Microsoft.WordServices.Style",!0);const Cr=e.addType("Microsoft.WordServices.Style","{c2b96925-a089-4d9d-b70e-9a842277a864}","",3,0);Cr.addProperty("BaseStyle",2,"String",1,!0,null,0);Cr.addProperty("BuiltIn",3,"Boolean",1,!0,null,0);Cr.addProperty("Description",4,"String",1,!0,null,0);Cr.addProperty("Font",5,"Microsoft.WordServices.Font",Yh.ClassObject,!0,null,0);Cr.addProperty("InUse",6,"Boolean",1,!0,null,0);Cr.addProperty("Linked",7,"Boolean",1,!0,null,0);
Cr.addProperty("ListTemplate",16,"Microsoft.WordServices.ListTemplate",Yh.ClassObject,!0,null,0);Cr.addProperty("NameLocal",8,"String",1,!0,null,0);Cr.addProperty("NextParagraphStyle",9,"String",1,!0,null,0);Cr.addProperty("ParagraphFormat",15,"Microsoft.WordServices.ParagraphFormat",Yh.ClassObject,!0,null,0);Cr.addProperty("Priority",10,"Int32",1,!1,null,0);Cr.addProperty("QuickStyle",11,"Boolean",1,!1,null,0);Cr.addProperty("Type",12,"Microsoft.WordServices.StyleType",1,!0,null,0);Cr.addProperty("UnhideWhenUsed",
13,"Boolean",1,!1,null,0);Cr.addProperty("Visibility",14,"Boolean",1,!1,null,0);Cr.addProperty("_ReferenceId",1,"String",1,!0,null,0);Cr.addMethod("Delete",1003,"Void",Yh.None,0,"Delete",0);Cr.addMethod("_KeepReference",1002,"Void",Yh.None,1,"_KeepReference",0);Cr.addMethod("_OnAccess",1001,"Void",Yh.None,1,"_OnAccess",0);const xk=e.addType("Microsoft.WordServices.Table","{55eb3bc4-acec-4fed-b8d3-10414e633465}","",3,0);xk.addProperty("Alignment",33,"Microsoft.WordServices.Alignment",1,!1,null,0);
xk.addProperty("Endnotes",38,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);xk.addProperty("Fields",39,"Microsoft.WordServices.FieldCollection",3,!0,null,0);xk.addProperty("Font",24,"Microsoft.WordServices.Font",3,!0,null,0);xk.addProperty("Footnotes",37,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);xk.addProperty("HeaderRowCount",12,"Int32",1,!1,null,0);xk.addProperty("HorizontalAlignment",22,"Microsoft.WordServices.Alignment",1,!1,null,0);xk.addProperty("IsUniform",4,"Boolean",
1,!0,null,0);xk.addProperty("NestingLevel",6,"Int32",1,!0,null,0);xk.addProperty("ParentBody",32,"Microsoft.WordServices.Body",3,!0,null,0);xk.addProperty("ParentContentControl",25,"Microsoft.WordServices.ContentControl",3,!0,null,0);xk.addProperty("ParentContentControlOrNullObject",36,"Microsoft.WordServices.ContentControl",3,!0,null,0);xk.addProperty("ParentTable",8,"Microsoft.WordServices.Table",3,!0,null,0);xk.addProperty("ParentTableCell",7,"Microsoft.WordServices.TableCell",3,!0,null,0);xk.addProperty("ParentTableCellOrNullObject",
34,"Microsoft.WordServices.TableCell",3,!0,null,0);xk.addProperty("ParentTableOrNullObject",35,"Microsoft.WordServices.Table",3,!0,null,0);xk.addProperty("RowCount",11,"Int32",1,!0,null,0);xk.addProperty("Rows",3,"Microsoft.WordServices.TableRowCollection",3,!0,null,0);xk.addProperty("ShadingColor",18,"String",1,!1,null,0);xk.addProperty("Style",10,"String",1,!1,null,0);xk.addProperty("StyleBandedColumns",17,"Boolean",1,!1,null,0);xk.addProperty("StyleBandedRows",16,"Boolean",1,!1,null,0);xk.addProperty("StyleBuiltIn",
31,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);xk.addProperty("StyleFirstColumn",14,"Boolean",1,!1,null,0);xk.addProperty("StyleLastColumn",15,"Boolean",1,!1,null,0);xk.addProperty("StyleTotalRow",13,"Boolean",1,!1,null,0);xk.addProperty("Tables",5,"Microsoft.WordServices.TableCollection",3,!0,null,0);xk.addProperty("Values",9,"String[][]",1,!1,null,0);xk.addProperty("VerticalAlignment",23,"Microsoft.WordServices.VerticalAlignment",1,!1,null,0);xk.addProperty("Width",27,"Single",1,!1,null,
0);xk.addProperty("_Id",1,"Int32",1,!0,null,0);xk.addProperty("_ReferenceId",2,"String",1,!0,null,0);const BF=xk.addMethod("AddColumns",1004,"Void",0,0,"AddColumns",0);BF.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);BF.addParameter("columnCount","Int32",1,null,0);BF.addParameter("values","String[][]",1,null,0);const dz=xk.addMethod("AddRows",1003,"Microsoft.WordServices.TableRowCollection",3,0,"AddRows",0);dz.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);dz.addParameter("rowCount","Int32",1,null,0);dz.addParameter("values","String[][]",1,null,0);xk.addMethod("AutoFitWindow",1012,"Void",0,0,"AutoFitWindow",0);xk.addMethod("Clear",1008,"Void",0,0,"Clear",0);xk.addMethod("Delete",1007,"Void",0,0,"Delete",0);const jD=xk.addMethod("DeleteColumns",1010,"Void",0,0,"DeleteColumns",0);jD.addParameter("columnIndex","Int32",1,null,0);jD.addParameter("columnCount","Int32?",1,null,0);const Bl=xk.addMethod("DeleteRows",1009,"Void",0,0,"DeleteRows",0);
Bl.addParameter("rowIndex","Int32",1,null,0);Bl.addParameter("rowCount","Int32?",1,null,0);xk.addMethod("DistributeColumns",1014,"Void",0,0,"DistributeColumns",0);xk.addMethod("GetBorder",1015,"Microsoft.WordServices.TableBorder",3,1,"Border",0).addParameter("borderLocation","Microsoft.WordServices.BorderLocation",1,null,0);const Xw=xk.addMethod("GetCell",1005,"Microsoft.WordServices.TableCell",3,1,"Cell",0);Xw.addParameter("rowIndex","Int32",1,null,0);Xw.addParameter("cellIndex","Int32",1,null,0);
const IB=xk.addMethod("GetCellOrNullObject",1028,"Microsoft.WordServices.TableCell",3,1,"CellOrNullObject",0);IB.addParameter("rowIndex","Int32",1,null,0);IB.addParameter("cellIndex","Int32",1,null,0);xk.addMethod("GetCellPadding",1023,"Single?",1,1,"CellPadding",0).addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);xk.addMethod("GetNext",1025,"Microsoft.WordServices.Table",3,1,"Next",0);xk.addMethod("GetNextOrNullObject",1029,"Microsoft.WordServices.Table",
3,1,"NextOrNullObject",0);xk.addMethod("GetParagraphAfter",1027,"Microsoft.WordServices.Paragraph",3,1,"ParagraphAfter",0);xk.addMethod("GetParagraphAfterOrNullObject",1031,"Microsoft.WordServices.Paragraph",3,1,"ParagraphAfterOrNullObject",0);xk.addMethod("GetParagraphBefore",1026,"Microsoft.WordServices.Paragraph",3,1,"ParagraphBefore",0);xk.addMethod("GetParagraphBeforeOrNullObject",1030,"Microsoft.WordServices.Paragraph",3,1,"ParagraphBeforeOrNullObject",0);xk.addMethod("GetRange",1019,"Microsoft.WordServices.Range",
3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);xk.addMethod("InsertContentControl",1020,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0);const ru=xk.addMethod("InsertParagraph",1022,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);ru.addParameter("paragraphText","String",1,null,0);ru.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const ez=xk.addMethod("InsertTable",1021,"Microsoft.WordServices.Table",
3,0,"InsertTable",0);ez.addParameter("rowCount","Int32",1,null,0);ez.addParameter("columnCount","Int32",1,null,0);ez.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);ez.addParameter("values","String[][]",1,null,0);const CF=xk.addMethod("MergeCells",1006,"Microsoft.WordServices.TableCell",3,0,"MergeCells",0);CF.addParameter("topRow","Int32",1,null,0);CF.addParameter("firstCell","Int32",1,null,0);CF.addParameter("bottomRow","Int32",1,null,0);CF.addParameter("lastCell",
"Int32",1,null,0);const pp=xk.addMethod("Search",1018,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);pp.addParameter("searchText","String",1,null,0);pp.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);xk.addMethod("Select",1017,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const kD=xk.addMethod("SetCellPadding",1024,"Void",0,0,"SetCellPadding",0);kD.addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",
1,null,0);kD.addParameter("cellPadding","Single",1,null,0);xk.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);xk.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Np=xk.addMethod("_Search2",1032,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);Np.addParameter("searchText","String",1,null,0);Np.addParameter("searchFlags","Int32",1,null,0);const Tu=e.addType("Microsoft.WordServices.TableCollection","{793ca292-e6dc-48f7-b0e6-16311394a5b2}","",3,0);Tu.addProperty("_ReferenceId",
2,"String",1,!0,null,0);Tu.addMethod("GetFirst",1003,"Microsoft.WordServices.Table",3,1,"First",0);Tu.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Table",3,1,"FirstOrNullObject",0);Tu.addIndexerMethod(1,"Microsoft.WordServices.Table",3,0).addParameter("index","Object",1,null,0);Tu.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Tu.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);Tu.setCollectionInfo("Microsoft.WordServices.Table",!0);const zo=e.addType("Microsoft.WordServices.TableRow",
"{7a28087b-2d9c-4db1-95af-b1ce69d1d4db}","",3,0);zo.addProperty("CellCount",4,"Int32",1,!0,null,0);zo.addProperty("Cells",3,"Microsoft.WordServices.TableCellCollection",3,!0,null,0);zo.addProperty("Endnotes",20,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);zo.addProperty("Font",14,"Microsoft.WordServices.Font",3,!0,null,0);zo.addProperty("Fields",21,"Microsoft.WordServices.FieldCollection",3,!0,null,0);zo.addProperty("Footnotes",19,"Microsoft.WordServices.NoteItemCollection",3,!0,null,
0);zo.addProperty("HorizontalAlignment",12,"Microsoft.WordServices.Alignment",1,!1,null,0);zo.addProperty("IsHeader",16,"Boolean",1,!0,null,0);zo.addProperty("ParentTable",5,"Microsoft.WordServices.Table",3,!0,null,0);zo.addProperty("PreferredHeight",17,"Single",1,!1,null,0);zo.addProperty("RowIndex",6,"Int32",1,!0,null,0);zo.addProperty("ShadingColor",8,"String",1,!1,null,0);zo.addProperty("Values",7,"String[][]",1,!1,null,0);zo.addProperty("VerticalAlignment",13,"Microsoft.WordServices.VerticalAlignment",
1,!1,null,0);zo.addProperty("_Id",1,"Int32",1,!0,null,0);zo.addProperty("_ReferenceId",2,"String",1,!0,null,0);zo.addMethod("Clear",1006,"Void",0,0,"Clear",0);zo.addMethod("Delete",1005,"Void",0,0,"Delete",0);zo.addMethod("GetBorder",1009,"Microsoft.WordServices.TableBorder",3,1,"Border",0).addParameter("borderLocation","Microsoft.WordServices.BorderLocation",1,null,0);zo.addMethod("GetCellPadding",1023,"Single?",1,1,"CellPadding",0).addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",
1,null,0);zo.addMethod("GetNext",1012,"Microsoft.WordServices.TableRow",3,1,"Next",0);zo.addMethod("GetNextOrNullObject",1013,"Microsoft.WordServices.TableRow",3,1,"NextOrNullObject",0);zo.addMethod("InsertContentControl",1025,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0);const fz=zo.addMethod("InsertRows",1003,"Microsoft.WordServices.TableRowCollection",3,1,"InsertRows",0);fz.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);fz.addParameter("rowCount",
"Int32",1,null,0);fz.addParameter("values","String[][]",1,null,0);zo.addMethod("Merge",1004,"Microsoft.WordServices.TableCell",3,0,"Merge",0);const Tt=zo.addMethod("Search",1008,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);Tt.addParameter("searchText","String",1,null,0);Tt.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);zo.addMethod("Select",1007,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const DF=
zo.addMethod("SetCellPadding",1024,"Void",0,0,"SetCellPadding",0);DF.addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);DF.addParameter("cellPadding","Single",1,null,0);zo.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);zo.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Fj=zo.addMethod("_Search2",1026,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);Fj.addParameter("searchText","String",1,null,0);Fj.addParameter("searchFlags",
"Int32",1,null,0);const Yw=e.addType("Microsoft.WordServices.TableRowCollection","{f752737f-a469-460b-a2c1-08b958efb48f}","",3,0);Yw.addProperty("_ReferenceId",2,"String",1,!0,null,0);Yw.addMethod("GetFirst",1003,"Microsoft.WordServices.TableRow",3,1,"First",0);Yw.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.TableRow",3,1,"FirstOrNullObject",0);Yw.addIndexerMethod(1,"Microsoft.WordServices.TableRow",3,0).addParameter("index","Object",1,null,0);Yw.addMethod("_KeepReference",1002,"Void",
0,1,"_KeepReference",0);Yw.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Yw.setCollectionInfo("Microsoft.WordServices.TableRow",!0);const Kn=e.addType("Microsoft.WordServices.TableCell","{276a08f8-2afc-42fd-a336-8890d712e195}","",3,0);Kn.addProperty("Body",8,"Microsoft.WordServices.Body",3,!0,null,0);Kn.addProperty("CellIndex",6,"Int32",1,!0,null,0);Kn.addProperty("ColumnWidth",15,"Single?",1,!1,null,0);Kn.addProperty("HorizontalAlignment",12,"Microsoft.WordServices.Alignment",1,!1,null,0);
Kn.addProperty("ParentRow",4,"Microsoft.WordServices.TableRow",3,!0,null,0);Kn.addProperty("ParentTable",3,"Microsoft.WordServices.Table",3,!0,null,0);Kn.addProperty("RowIndex",5,"Int32",1,!0,null,0);Kn.addProperty("ShadingColor",9,"String",1,!1,null,0);Kn.addProperty("Value",7,"String",1,!1,null,0);Kn.addProperty("VerticalAlignment",14,"Microsoft.WordServices.VerticalAlignment",1,!1,null,0);Kn.addProperty("Width",16,"Single",1,!0,null,0);Kn.addProperty("_Id",1,"Int32",1,!0,null,0);Kn.addProperty("_ReferenceId",
2,"String",1,!0,null,0);Kn.addMethod("DeleteColumn",1007,"Void",0,0,"DeleteColumn",0);Kn.addMethod("DeleteRow",1006,"Void",0,0,"DeleteRow",0);Kn.addMethod("GetBorder",1008,"Microsoft.WordServices.TableBorder",3,1,"Border",0).addParameter("borderLocation","Microsoft.WordServices.BorderLocation",1,null,0);Kn.addMethod("GetCellPadding",1023,"Single?",1,1,"CellPadding",0).addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);Kn.addMethod("GetNext",1011,"Microsoft.WordServices.TableCell",
3,1,"Next",0);Kn.addMethod("GetNextOrNullObject",1012,"Microsoft.WordServices.TableCell",3,1,"NextOrNullObject",0);const co=Kn.addMethod("InsertColumns",1004,"Void",0,0,"InsertColumns",0);co.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);co.addParameter("columnCount","Int32",1,null,0);co.addParameter("values","String[][]",1,null,0);const JB=Kn.addMethod("InsertRows",1003,"Microsoft.WordServices.TableRowCollection",3,0,"InsertRows",0);JB.addParameter("insertLocation",
"Microsoft.WordServices.InsertLocation",1,null,0);JB.addParameter("rowCount","Int32",1,null,0);JB.addParameter("values","String[][]",1,null,0);const Cq=Kn.addMethod("SetCellPadding",1024,"Void",0,0,"SetCellPadding",0);Cq.addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);Cq.addParameter("cellPadding","Single",1,null,0);const wH=Kn.addMethod("Split",1005,"Void",0,0,"Split",0);wH.addParameter("rowCount","Int32",1,null,0);wH.addParameter("columnCount","Int32",1,
null,0);Kn.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Kn.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const gz=e.addType("Microsoft.WordServices.TableCellCollection","{67dffdfa-3a5c-431b-8ea7-9600e82453e3}","",3,0);gz.addProperty("_ReferenceId",2,"String",1,!0,null,0);gz.addMethod("GetFirst",1003,"Microsoft.WordServices.TableCell",3,1,"First",0);gz.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.TableCell",3,1,"FirstOrNullObject",0);gz.addIndexerMethod(1,
"Microsoft.WordServices.TableCell",3,0).addParameter("index","Object",1,null,0);gz.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);gz.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);gz.setCollectionInfo("Microsoft.WordServices.TableCell",!0);const Zw=e.addType("Microsoft.WordServices.TableBorder","{3e45a91b-f887-4feb-8fef-21e1e40f6fb6}","",3,0);Zw.addProperty("Color",2,"String",1,!1,null,0);Zw.addProperty("Type",3,"Microsoft.WordServices.BorderType",1,!1,null,0);Zw.addProperty("Width",
4,"Single",1,!1,null,0);Zw.addProperty("_ReferenceId",1,"String",1,!0,null,0);Zw.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Zw.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Os=e.addEnumType("Microsoft.WordServices.EventType");Os.addEnumField("ContentControlDeleted",0);Os.addEnumField("ContentControlSelectionChanged",1);Os.addEnumField("ContentControlDataChanged",2);Os.addEnumField("ContentControlAdded",3);Os.addEnumField("AnnotationAdded",4);Os.addEnumField("AnnotationChanged",
5);Os.addEnumField("AnnotationDeleted",6);Os.addEnumField("CommentDeleted",7);Os.addEnumField("CommentSelected",8);Os.addEnumField("CommentDeselected",9);Os.addEnumField("CommentChanged",10);Os.addEnumField("CommentAdded",11);Os.addEnumField("ContentControlEntered",12);Os.addEnumField("ContentControlExited",13);Os.addEnumField("DocumentWordCountChanged",14);Os.addEnumField("ParagraphAdded",15);Os.addEnumField("ParagraphChanged",16);Os.addEnumField("ParagraphDeleted",17);const jt=e.addEnumType("Microsoft.WordServices.ContentControlType");
jt.addEnumField("Unknown",0);jt.addEnumField("RichTextInline",1);jt.addEnumField("RichTextParagraphs",2);jt.addEnumField("RichTextTableCell",4);jt.addEnumField("RichTextTableRow",8);jt.addEnumField("RichTextTable",16);jt.addEnumField("PlainTextInline",32);jt.addEnumField("PlainTextParagraph",64);jt.addEnumField("Picture",128);jt.addEnumField("BuildingBlockGallery",256);jt.addEnumField("CheckBox",512);jt.addEnumField("ComboBox",1024);jt.addEnumField("DropDownList",2048);jt.addEnumField("DatePicker",
4096);jt.addEnumField("RepeatingSection",8192);jt.addEnumField("RichText",31);jt.addEnumField("PlainText",96);const as=e.addEnumType("Microsoft.WordServices.ContentControlAppearance");as.addEnumField("BoundingBox",0);as.addEnumField("Tags",1);as.addEnumField("Hidden",2);const mq=e.addEnumType("Microsoft.WordServices.UnderlineType");mq.addEnumField("Mixed",-1);mq.addEnumField("None",0);mq.addEnumField("Hidden",5);mq.addEnumField("DotLine",8);mq.addEnumField("Single",1);mq.addEnumField("Word",2);mq.addEnumField("Double",
3);mq.addEnumField("Thick",6);mq.addEnumField("Dotted",4);mq.addEnumField("DottedHeavy",20);mq.addEnumField("DashLine",7);mq.addEnumField("DashLineHeavy",23);mq.addEnumField("DashLineLong",39);mq.addEnumField("DashLineLongHeavy",55);mq.addEnumField("DotDashLine",9);mq.addEnumField("DotDashLineHeavy",25);mq.addEnumField("TwoDotDashLine",10);mq.addEnumField("TwoDotDashLineHeavy",26);mq.addEnumField("Wave",11);mq.addEnumField("WaveHeavy",27);mq.addEnumField("WaveDouble",43);const zp=e.addEnumType("Microsoft.WordServices.BreakType");
zp.addEnumField("Page",0);zp.addEnumField("Next",2);zp.addEnumField("SectionNext",1002);zp.addEnumField("SectionContinuous",3);zp.addEnumField("SectionEven",4);zp.addEnumField("SectionOdd",5);zp.addEnumField("Line",6);const iy=e.addEnumType("Microsoft.WordServices.InsertLocation");iy.addEnumField("Before",0);iy.addEnumField("After",1);iy.addEnumField("Start",2);iy.addEnumField("End",3);iy.addEnumField("Replace",4);const nq=e.addEnumType("Microsoft.WordServices.Alignment");nq.addEnumField("Mixed",
-2);nq.addEnumField("Unknown",-1);nq.addEnumField("Left",0);nq.addEnumField("Centered",1);nq.addEnumField("Right",2);nq.addEnumField("Justified",3);const Yl=e.addEnumType("Microsoft.WordServices.HeaderFooterType");Yl.addEnumField("Primary",0);Yl.addEnumField("FirstPage",1);Yl.addEnumField("EvenPages",2);const rv=e.addEnumType("Microsoft.WordServices.BodyType");rv.addEnumField("Unknown",-1);rv.addEnumField("MainDoc",0);rv.addEnumField("Section",1);rv.addEnumField("Header",2);rv.addEnumField("Footer",
3);rv.addEnumField("TableCell",4);rv.addEnumField("Footnote",5);rv.addEnumField("Endnote",6);rv.addEnumField("NoteItem",7);const lD=e.addEnumType("Microsoft.WordServices.SelectionMode");lD.addEnumField("Select",0);lD.addEnumField("Start",1);lD.addEnumField("End",2);const vs=e.addEnumType("Microsoft.WordServices.ImageFormat");vs.addEnumField("Unsupported",-2);vs.addEnumField("Undefined",-1);vs.addEnumField("Bmp",0);vs.addEnumField("Jpeg",1);vs.addEnumField("Gif",2);vs.addEnumField("Tiff",3);vs.addEnumField("Png",
4);vs.addEnumField("Icon",5);vs.addEnumField("Exif",6);vs.addEnumField("Wmf",7);vs.addEnumField("Emf",8);vs.addEnumField("Pict",9);vs.addEnumField("Pdf",10);vs.addEnumField("Svg",11);const $w=e.addEnumType("Microsoft.WordServices.RangeLocation");$w.addEnumField("Whole",0);$w.addEnumField("Start",1);$w.addEnumField("End",2);$w.addEnumField("Before",3);$w.addEnumField("After",4);$w.addEnumField("Content",5);const Ps=e.addEnumType("Microsoft.WordServices.LocationRelation");Ps.addEnumField("Unrelated",
0);Ps.addEnumField("Equal",1);Ps.addEnumField("ContainsStart",2);Ps.addEnumField("ContainsEnd",3);Ps.addEnumField("Contains",4);Ps.addEnumField("InsideStart",5);Ps.addEnumField("InsideEnd",6);Ps.addEnumField("Inside",7);Ps.addEnumField("AdjacentBefore",8);Ps.addEnumField("OverlapsBefore",9);Ps.addEnumField("Before",10);Ps.addEnumField("AdjacentAfter",11);Ps.addEnumField("OverlapsAfter",12);Ps.addEnumField("After",13);const zt=e.addEnumType("Microsoft.WordServices.BorderLocation");zt.addEnumField("Top",
0);zt.addEnumField("Left",1);zt.addEnumField("Bottom",2);zt.addEnumField("Right",3);zt.addEnumField("InsideHorizontal",4);zt.addEnumField("InsideVertical",5);zt.addEnumField("Inside",6);zt.addEnumField("Outside",7);zt.addEnumField("All",8);const KB=e.addEnumType("Microsoft.WordServices.CellPaddingLocation");KB.addEnumField("Top",0);KB.addEnumField("Left",1);KB.addEnumField("Bottom",2);KB.addEnumField("Right",3);const Vp=e.addEnumType("Microsoft.WordServices.BorderType");Vp.addEnumField("Mixed",-1);
Vp.addEnumField("None",0);Vp.addEnumField("Single",1);Vp.addEnumField("Double",3);Vp.addEnumField("Dotted",6);Vp.addEnumField("Dashed",7);Vp.addEnumField("DotDashed",8);Vp.addEnumField("Dot2Dashed",9);Vp.addEnumField("Triple",10);Vp.addEnumField("ThinThickSmall",11);Vp.addEnumField("ThickThinSmall",12);Vp.addEnumField("ThinThickThinSmall",13);Vp.addEnumField("ThinThickMed",14);Vp.addEnumField("ThickThinMed",15);Vp.addEnumField("ThinThickThinMed",16);Vp.addEnumField("ThinThickLarge",17);Vp.addEnumField("ThickThinLarge",
18);Vp.addEnumField("ThinThickThinLarge",19);Vp.addEnumField("Wave",20);Vp.addEnumField("DoubleWave",21);Vp.addEnumField("DashedSmall",22);Vp.addEnumField("DashDotStroked",23);Vp.addEnumField("ThreeDEmboss",24);Vp.addEnumField("ThreeDEngrave",25);const LB=e.addEnumType("Microsoft.WordServices.VerticalAlignment");LB.addEnumField("Mixed",-1);LB.addEnumField("Top",0);LB.addEnumField("Center",1);LB.addEnumField("Bottom",2);const lA=e.addEnumType("Microsoft.WordServices.ListLevelType");lA.addEnumField("Bullet",
0);lA.addEnumField("Number",1);lA.addEnumField("Picture",2);const Qs=e.addEnumType("Microsoft.WordServices.ListBullet");Qs.addEnumField("Custom",0);Qs.addEnumField("Solid",258231);Qs.addEnumField("Hollow",131183);Qs.addEnumField("Square",716967);Qs.addEnumField("Diamonds",716918);Qs.addEnumField("Arrow",717016);Qs.addEnumField("Checkmark",717052);const Uu=e.addEnumType("Microsoft.WordServices.ListNumbering");Uu.addEnumField("None",-1);Uu.addEnumField("Arabic",0);Uu.addEnumField("UpperRoman",1);Uu.addEnumField("LowerRoman",
2);Uu.addEnumField("UpperLetter",3);Uu.addEnumField("LowerLetter",4);const fg=e.addEnumType("Microsoft.WordServices.StyleBuiltIn");fg.addEnumField("Other",-1);fg.addEnumField("Normal",0);fg.addEnumField("Heading1",1);fg.addEnumField("Heading2",2);fg.addEnumField("Heading3",3);fg.addEnumField("Heading4",4);fg.addEnumField("Heading5",5);fg.addEnumField("Heading6",6);fg.addEnumField("Heading7",7);fg.addEnumField("Heading8",8);fg.addEnumField("Heading9",9);fg.addEnumField("Toc1",19);fg.addEnumField("Toc2",
20);fg.addEnumField("Toc3",21);fg.addEnumField("Toc4",22);fg.addEnumField("Toc5",23);fg.addEnumField("Toc6",24);fg.addEnumField("Toc7",25);fg.addEnumField("Toc8",26);fg.addEnumField("Toc9",27);fg.addEnumField("FootnoteText",29);fg.addEnumField("Header",31);fg.addEnumField("Footer",32);fg.addEnumField("Caption",34);fg.addEnumField("FootnoteReference",38);fg.addEnumField("EndnoteReference",42);fg.addEnumField("EndnoteText",43);fg.addEnumField("Title",62);fg.addEnumField("Subtitle",74);fg.addEnumField("Hyperlink",
85);fg.addEnumField("Strong",87);fg.addEnumField("Emphasis",88);fg.addEnumField("NoSpacing",157);fg.addEnumField("ListParagraph",179);fg.addEnumField("Quote",180);fg.addEnumField("IntenseQuote",181);fg.addEnumField("SubtleEmphasis",260);fg.addEnumField("IntenseEmphasis",261);fg.addEnumField("SubtleReference",262);fg.addEnumField("IntenseReference",263);fg.addEnumField("BookTitle",264);fg.addEnumField("Bibliography",265);fg.addEnumField("TocHeading",266);fg.addEnumField("TableGrid",154);fg.addEnumField("PlainTable1",
267);fg.addEnumField("PlainTable2",268);fg.addEnumField("PlainTable3",269);fg.addEnumField("PlainTable4",270);fg.addEnumField("PlainTable5",271);fg.addEnumField("TableGridLight",272);fg.addEnumField("GridTable1Light",111);fg.addEnumField("GridTable1Light_Accent1",280);fg.addEnumField("GridTable1Light_Accent2",287);fg.addEnumField("GridTable1Light_Accent3",294);fg.addEnumField("GridTable1Light_Accent4",301);fg.addEnumField("GridTable1Light_Accent5",308);fg.addEnumField("GridTable1Light_Accent6",315);
fg.addEnumField("GridTable2",274);fg.addEnumField("GridTable2_Accent1",281);fg.addEnumField("GridTable2_Accent2",288);fg.addEnumField("GridTable2_Accent3",295);fg.addEnumField("GridTable2_Accent4",302);fg.addEnumField("GridTable2_Accent5",309);fg.addEnumField("GridTable2_Accent6",316);fg.addEnumField("GridTable3",275);fg.addEnumField("GridTable3_Accent1",282);fg.addEnumField("GridTable3_Accent2",289);fg.addEnumField("GridTable3_Accent3",296);fg.addEnumField("GridTable3_Accent4",303);fg.addEnumField("GridTable3_Accent5",
310);fg.addEnumField("GridTable3_Accent6",317);fg.addEnumField("GridTable4",276);fg.addEnumField("GridTable4_Accent1",283);fg.addEnumField("GridTable4_Accent2",290);fg.addEnumField("GridTable4_Accent3",297);fg.addEnumField("GridTable4_Accent4",304);fg.addEnumField("GridTable4_Accent5",311);fg.addEnumField("GridTable4_Accent6",318);fg.addEnumField("GridTable5Dark",277);fg.addEnumField("GridTable5Dark_Accent1",284);fg.addEnumField("GridTable5Dark_Accent2",291);fg.addEnumField("GridTable5Dark_Accent3",
298);fg.addEnumField("GridTable5Dark_Accent4",305);fg.addEnumField("GridTable5Dark_Accent5",312);fg.addEnumField("GridTable5Dark_Accent6",319);fg.addEnumField("GridTable6Colorful",278);fg.addEnumField("GridTable6Colorful_Accent1",285);fg.addEnumField("GridTable6Colorful_Accent2",292);fg.addEnumField("GridTable6Colorful_Accent3",299);fg.addEnumField("GridTable6Colorful_Accent4",306);fg.addEnumField("GridTable6Colorful_Accent5",313);fg.addEnumField("GridTable6Colorful_Accent6",320);fg.addEnumField("GridTable7Colorful",
279);fg.addEnumField("GridTable7Colorful_Accent1",286);fg.addEnumField("GridTable7Colorful_Accent2",293);fg.addEnumField("GridTable7Colorful_Accent3",300);fg.addEnumField("GridTable7Colorful_Accent4",307);fg.addEnumField("GridTable7Colorful_Accent5",314);fg.addEnumField("GridTable7Colorful_Accent6",321);fg.addEnumField("ListTable1Light",322);fg.addEnumField("ListTable1Light_Accent1",329);fg.addEnumField("ListTable1Light_Accent2",336);fg.addEnumField("ListTable1Light_Accent3",343);fg.addEnumField("ListTable1Light_Accent4",
350);fg.addEnumField("ListTable1Light_Accent5",357);fg.addEnumField("ListTable1Light_Accent6",364);fg.addEnumField("ListTable2",323);fg.addEnumField("ListTable2_Accent1",330);fg.addEnumField("ListTable2_Accent2",337);fg.addEnumField("ListTable2_Accent3",344);fg.addEnumField("ListTable2_Accent4",351);fg.addEnumField("ListTable2_Accent5",358);fg.addEnumField("ListTable2_Accent6",365);fg.addEnumField("ListTable3",324);fg.addEnumField("ListTable3_Accent1",331);fg.addEnumField("ListTable3_Accent2",338);
fg.addEnumField("ListTable3_Accent3",345);fg.addEnumField("ListTable3_Accent4",352);fg.addEnumField("ListTable3_Accent5",359);fg.addEnumField("ListTable3_Accent6",366);fg.addEnumField("ListTable4",325);fg.addEnumField("ListTable4_Accent1",332);fg.addEnumField("ListTable4_Accent2",339);fg.addEnumField("ListTable4_Accent3",346);fg.addEnumField("ListTable4_Accent4",353);fg.addEnumField("ListTable4_Accent5",360);fg.addEnumField("ListTable4_Accent6",367);fg.addEnumField("ListTable5Dark",326);fg.addEnumField("ListTable5Dark_Accent1",
333);fg.addEnumField("ListTable5Dark_Accent2",340);fg.addEnumField("ListTable5Dark_Accent3",347);fg.addEnumField("ListTable5Dark_Accent4",354);fg.addEnumField("ListTable5Dark_Accent5",361);fg.addEnumField("ListTable5Dark_Accent6",368);fg.addEnumField("ListTable6Colorful",327);fg.addEnumField("ListTable6Colorful_Accent1",334);fg.addEnumField("ListTable6Colorful_Accent2",341);fg.addEnumField("ListTable6Colorful_Accent3",348);fg.addEnumField("ListTable6Colorful_Accent4",355);fg.addEnumField("ListTable6Colorful_Accent5",
362);fg.addEnumField("ListTable6Colorful_Accent6",369);fg.addEnumField("ListTable7Colorful",328);fg.addEnumField("ListTable7Colorful_Accent1",335);fg.addEnumField("ListTable7Colorful_Accent2",342);fg.addEnumField("ListTable7Colorful_Accent3",349);fg.addEnumField("ListTable7Colorful_Accent4",356);fg.addEnumField("ListTable7Colorful_Accent5",363);fg.addEnumField("ListTable7Colorful_Accent6",370);const MB=e.addEnumType("Microsoft.WordServices.DocumentPropertyType");MB.addEnumField("String",0);MB.addEnumField("Number",
1);MB.addEnumField("Date",2);MB.addEnumField("Boolean",3);const jy=e.addEnumType("Microsoft.WordServices.TapObjectType");jy.addEnumField("Chart",1);jy.addEnumField("SmartArt",2);jy.addEnumField("Table",3);jy.addEnumField("Image",4);jy.addEnumField("Slide",5);jy.addEnumField("OLE",6);jy.addEnumField("Text",7);const mD=e.addEnumType("Microsoft.WordServices.FileContentFormat");mD.addEnumField("Base64",0);mD.addEnumField("Html",7);mD.addEnumField("Ooxml",9);const NB=e.addEnumType("Microsoft.WordServices.AnnotationParentType");
NB.addEnumField("None",0);NB.addEnumField("Document",1);NB.addEnumField("Paragraph",2);NB.addEnumField("Annotation",3);const ax=e.addEnumType("Microsoft.WordServices.AnnotationState");ax.addEnumField("Undefined",0);ax.addEnumField("Created",10);ax.addEnumField("Sent",20);ax.addEnumField("Duplicated",30);ax.addEnumField("Seen",40);ax.addEnumField("Tried",50);ax.addEnumField("Kept",60);ax.addEnumField("Rejected",70);const hz=e.addEnumType("Microsoft.WordServices.StyleType");hz.addEnumField("Character",
0);hz.addEnumField("List",1);hz.addEnumField("Paragraph",2);hz.addEnumField("Table",3);const bx=e.addEnumType("Microsoft.WordServices.OutlineLevel");bx.addEnumField("OutlineLevel1",0);bx.addEnumField("OutlineLevel2",1);bx.addEnumField("OutlineLevel3",2);bx.addEnumField("OutlineLevel4",3);const ni=e.addEnumType("Microsoft.WordServices.FieldType");ni.addEnumField("Addin",81);ni.addEnumField("AddressBlock",93);ni.addEnumField("Advance",84);ni.addEnumField("Ask",38);ni.addEnumField("Author",17);ni.addEnumField("AutoText",
79);ni.addEnumField("AutoTextList",89);ni.addEnumField("BarCode",63);ni.addEnumField("Bibliography",97);ni.addEnumField("BidiOutline",92);ni.addEnumField("Citation",96);ni.addEnumField("Comments",19);ni.addEnumField("Compare",80);ni.addEnumField("CreateDate",21);ni.addEnumField("Data",40);ni.addEnumField("Database",78);ni.addEnumField("Date",31);ni.addEnumField("DisplayBarcode",99);ni.addEnumField("DocProperty",85);ni.addEnumField("DocVariable",64);ni.addEnumField("EditTime",25);ni.addEnumField("Embedded",
58);ni.addEnumField("EQ",49);ni.addEnumField("Expression",34);ni.addEnumField("FileName",29);ni.addEnumField("FileSize",69);ni.addEnumField("FillIn",39);ni.addEnumField("FormCheckbox",71);ni.addEnumField("FormDropdown",83);ni.addEnumField("FormText",70);ni.addEnumField("GotoButton",50);ni.addEnumField("GreetingLine",94);ni.addEnumField("Hyperlink",88);ni.addEnumField("If",7);ni.addEnumField("Import",55);ni.addEnumField("Include",36);ni.addEnumField("IncludePicture",67);ni.addEnumField("IncludeText",
68);ni.addEnumField("Index",8);ni.addEnumField("Info",14);ni.addEnumField("Keywords",18);ni.addEnumField("LastSavedBy",20);ni.addEnumField("Link",56);ni.addEnumField("ListNum",90);ni.addEnumField("MacroButton",51);ni.addEnumField("MergeBarcode",98);ni.addEnumField("MergeField",59);ni.addEnumField("MergeRec",44);ni.addEnumField("MergeSeq",75);ni.addEnumField("Next",41);ni.addEnumField("NextIf",42);ni.addEnumField("NoteRef",72);ni.addEnumField("NumChars",28);ni.addEnumField("NumPages",26);ni.addEnumField("NumWords",
27);ni.addEnumField("OCX",87);ni.addEnumField("Page",33);ni.addEnumField("PageRef",37);ni.addEnumField("Print",48);ni.addEnumField("PrintDate",23);ni.addEnumField("Private",77);ni.addEnumField("Quote",35);ni.addEnumField("RD",11);ni.addEnumField("Ref",3);ni.addEnumField("RevNum",24);ni.addEnumField("SaveDate",22);ni.addEnumField("Section",65);ni.addEnumField("SectionPages",66);ni.addEnumField("Seq",12);ni.addEnumField("Set",6);ni.addEnumField("Shape",95);ni.addEnumField("SkipIf",43);ni.addEnumField("StyleRef",
10);ni.addEnumField("Subject",16);ni.addEnumField("Subscriber",82);ni.addEnumField("Symbol",57);ni.addEnumField("TA",74);ni.addEnumField("TC",9);ni.addEnumField("Template",30);ni.addEnumField("Time",32);ni.addEnumField("Title",15);ni.addEnumField("TOA",73);ni.addEnumField("TOC",13);ni.addEnumField("UserAddress",62);ni.addEnumField("UserInitials",61);ni.addEnumField("UserName",60);ni.addEnumField("XE",4);ni.addEnumField("Empty",-1);ni.addEnumField("Others",100);ni.addEnumField("Undefined",0);const mA=
e.addEnumType("Microsoft.WordServices.FieldKind");mA.addEnumField("None",0);mA.addEnumField("Hot",1);mA.addEnumField("Warm",2);mA.addEnumField("Cold",3);const nD=e.addEnumType("Microsoft.WordServices.TrailingCharacter");nD.addEnumField("TrailingTab",0);nD.addEnumField("TrailingSpace",1);nD.addEnumField("TrailingNone",2);const Lj=e.addEnumType("Microsoft.WordServices.ListBuiltInNumberStyle");Lj.addEnumField("None",-1);Lj.addEnumField("Arabic",0);Lj.addEnumField("UpperRoman",1);Lj.addEnumField("LowerRoman",
2);Lj.addEnumField("UpperLetter",3);Lj.addEnumField("LowerLetter",4);Lj.addEnumField("Ordinal",5);Lj.addEnumField("CardinalText",6);Lj.addEnumField("OrdinalText",7);Lj.addEnumField("Kanji",10);Lj.addEnumField("KanjiDigit",11);Lj.addEnumField("AiueoHalfWidth",12);Lj.addEnumField("IrohaHalfWidth",13);Lj.addEnumField("ArabicFullWidth",14);Lj.addEnumField("KanjiTraditional",16);Lj.addEnumField("KanjiTraditional2",17);Lj.addEnumField("NumberInCircle",18);Lj.addEnumField("Aiueo",20);Lj.addEnumField("Iroha",
21);Lj.addEnumField("ArabicLZ",22);Lj.addEnumField("Bullet",23);Lj.addEnumField("Ganada",24);Lj.addEnumField("Chosung",25);Lj.addEnumField("GBNum1",26);Lj.addEnumField("GBNum2",27);Lj.addEnumField("GBNum3",28);Lj.addEnumField("GBNum4",29);Lj.addEnumField("Zodiac1",30);Lj.addEnumField("Zodiac2",31);Lj.addEnumField("Zodiac3",32);Lj.addEnumField("TradChinNum1",33);Lj.addEnumField("TradChinNum2",34);Lj.addEnumField("TradChinNum3",35);Lj.addEnumField("TradChinNum4",36);Lj.addEnumField("SimpChinNum1",37);
Lj.addEnumField("SimpChinNum2",38);Lj.addEnumField("SimpChinNum3",39);Lj.addEnumField("SimpChinNum4",40);Lj.addEnumField("HanjaRead",41);Lj.addEnumField("HanjaReadDigit",42);Lj.addEnumField("Hangul",43);Lj.addEnumField("Hanja",44);Lj.addEnumField("Hebrew1",45);Lj.addEnumField("Arabic1",46);Lj.addEnumField("Hebrew2",47);Lj.addEnumField("Arabic2",48);Lj.addEnumField("HindiLetter1",49);Lj.addEnumField("HindiLetter2",50);Lj.addEnumField("HindiArabic",51);Lj.addEnumField("HindiCardinalText",52);Lj.addEnumField("ThaiLetter",
53);Lj.addEnumField("ThaiArabic",54);Lj.addEnumField("ThaiCardinalText",55);Lj.addEnumField("VietCardinalText",56);Lj.addEnumField("LowercaseRussian",58);Lj.addEnumField("UppercaseRussian",59);Lj.addEnumField("LowercaseGreek",60);Lj.addEnumField("UppercaseGreek",61);Lj.addEnumField("ArabicLZ2",62);Lj.addEnumField("ArabicLZ3",63);Lj.addEnumField("ArabicLZ4",64);Lj.addEnumField("LowercaseTurkish",65);Lj.addEnumField("UppercaseTurkish",66);Lj.addEnumField("LowercaseBulgarian",67);Lj.addEnumField("UppercaseBulgarian",
68);Lj.addEnumField("PictureBullet",249);Lj.addEnumField("Legal",253);Lj.addEnumField("LegalLZ",254);const oD=e.addEnumType("Microsoft.WordServices.NoteItemType");oD.addEnumField("Footnote",0);oD.addEnumField("Endnote",1);const EF=e.addEnumType("Microsoft.WordServices.ChangeTrackingMode");EF.addEnumField("Off",0);EF.addEnumField("TrackAll",1);EF.addEnumField("TrackMineOnly",2);const OB=e.addEnumType("Microsoft.WordServices.ChangeTrackingState");OB.addEnumField("Unknown",0);OB.addEnumField("Normal",
1);OB.addEnumField("Added",2);OB.addEnumField("Deleted",4);const xH=e.addEnumType("Microsoft.WordServices.ChangeTrackingVersion");xH.addEnumField("Original",0);xH.addEnumField("Current",1);const pD=e.addEnumType("Microsoft.WordServices.SaveBehavior");pD.addEnumField("Save",0);pD.addEnumField("Prompt",1);const PB=e.addEnumType("Microsoft.WordServices.CloseBehavior");PB.addEnumField("Save",0);PB.addEnumField("SkipSave",1);const qD=e.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}",
"{43a4559c-806b-4e89-914e-da9256212148}",3,0);qD.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);qD.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0).addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);const Ut=e.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Ut.addEnumField("Inactive",0);Ut.addEnumField("Background",1);Ut.addEnumField("Visible",2);const sv=e.addEnumType("Microsoft.AppRuntime.Visibility");
sv.addEnumField("Hidden",1);sv.addEnumField("Visible",2);const FF=e.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}","{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);FF.addMethod("GetAppRuntimeStartState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeStartState",0);FF.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",0).addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);e.addType("Microsoft.InternalService.AddinInternalService",
"{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0).addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);const mw=e.addEnumType("Microsoft.Authentication.IdentityType");mw.addEnumField("OrganizationAccount",0);mw.addEnumField("MicrosoftAccount",1);const QB=e.addEnumType("Microsoft.Authentication.AuthorityType");QB.addEnumField("External",0);QB.addEnumField("Msa",1);QB.addEnumField("Aad",2);const GF=e.addType("Microsoft.Authentication.OfficeIdentityInfo",
"{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);GF.addProperty("DisplayName",4,"String",1,!1,null,0);GF.addProperty("Email",3,"String",1,!1,null,0);GF.addProperty("FederationProvider",2,"String",1,!1,null,0);GF.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);const nA=e.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);nA.addProperty("AppId",4,
"String",1,!1,null,0);nA.addProperty("Authority",2,"String",1,!1,null,0);nA.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);nA.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);nA.addProperty("TenantId",6,"String",1,!1,null,0);nA.addProperty("Upn",1,"String",1,!1,null,0);const rD=e.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);rD.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",
3,!0,null,0);rD.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4).addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);rD.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);rD.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);const oA=e.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}",
"{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);oA.addProperty("AuthChallenge",3,"String",1,!1,null,0);oA.addProperty("CorrelationId",7,"String",1,!1,null,0);oA.addProperty("Policy",4,"String",1,!1,null,0);oA.addProperty("Resource",2,"String",1,!1,null,0);oA.addProperty("Scope",5,"String",1,!1,null,0);oA.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);const yH=e.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",
2,0);yH.addProperty("AccessToken",2,"String",1,!1,null,0);yH.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);const HF=e.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);HF.addProperty("Id",1,"String",1,!0,null,0);HF.addProperty("Value",2,"Object",1,!1,null,0);const Rs=e.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Rs.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",
3,1,"Item",0).addParameter("id","String",1,null,0);Rs.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0).addParameter("id","String",1,null,0);const pA=e.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");pA.addEnumField("Unknown",0);pA.addEnumField("Basic",1);pA.addEnumField("Premium",2);const ky=e.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0),IF=ky.addMethod("GetFeatureTier",
2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);IF.addParameter("feature","String",1,null,0);IF.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);ky.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0).addParameter("feature","String",1,null,0);const RB=ky.addMethod("GetMsaDeviceTicket",7,"String",1,1,"MsaDeviceTicket",4);RB.addParameter("resource","String",1,null,0);RB.addParameter("policy",
"String",1,null,0);RB.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",3,null,0);const cx=ky.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);cx.addParameter("feature","String",1,null,0);cx.addParameter("fallbackValue","Boolean",1,null,0);ky.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);ky.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0).addParameter("experienceId","String",1,null,0);ky.addMethod("_TestFireStateChangedEvent",
6,"Void",0,0,"_TestFireStateChangedEvent",4).addParameter("feature","String",1,null,0);const SB=e.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);SB.addProperty("Id",5,"String",1,!0,null,0);SB.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);SB.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);e.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",
3,0).addProperty("Scopes",1,"String",1,!1,null,0)};class kj extends sk{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf){super(e,t,W,Ka,kf);this.Owk=E;this.Ez=ha;this.V3a=sb;this.fHa=dc;this.o6=Ud;this.Pc=Rc;this.ep=md;this.I1=ud;this.Zc=Id;this.HRa=xc;this.jb=Ee}get IKa(){return this.Owk}get zgc(){return this.Ez}RJm(){let e={};return{returnValue:({Kwe:e}=this.o6.YGi(OSF.DDA.Marshaling.CoercionTypeKeys.Table)).returnValue,uNo:e}}NJm(){let e={};return{returnValue:({Kwe:e}=this.o6.YGi(OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)).returnValue,
nNo:e.rows}}wHf(e,t){const E={};return t.yo?this.ep.cBa(e,t):{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,hL:E}}JSm(e,t,E,W){const ha=[];if(!this.ep)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;e=this.ep.B2c(e,W,ha);if(e===OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;if(e!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return e;e=ha[0];W=e.node;if(!Xf.ParagraphReader.Xb(W))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;
const Ka=this.Zc.jg(W);if(!Ka.zb(23))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(!Bp.OutlineElementReader.yIa(Ka.origin)){const sb=new Od.GraphTransaction(7);sb.Ab(Ka.origin);Bp.OutlineElementReader.U_b(Ka.origin);sb.dispose()}E=W.ue(E.oc).htmlElement;if(!E)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;E.scrollIntoView();t===OSF.DDA.Marshaling.SelectionMode.Selected?(t=new Nd.Selection(ha,!0),this.lb.Ic(t)):(t=e.cpBegin,e.contextId===na.a.paragraph?t=0:e.contextId===
na.a.Vc&&(t=Xf.ParagraphReader.textLength(W)),t=hi.SelectionFactory.se(W,t),this.lb.Ic(t));window.focus();return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Pgm(e){if(e.yo){var t=Ld.GraphIterator.eb(this.Eea.kla());for(t=Hc.a.Bq(t);t.moveNext();)Xf.ParagraphReader.Xb(t.currentNode);return this.ep.XGf(e)}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,rWh:[]}}YUk(e,t,E){const W=this.Pc.Mc(15);W.Ab(this.Eea.kla());E===OSF.DDA.Marshaling.BindingType.Text.toString()?{hL:e,returnValue:t}=
this.Zmg(e,t,Wc.text):E===OSF.DDA.Marshaling.BindingType.Matrix.toString()?{hL:e,returnValue:t}=this.Zmg(e,t,Wc.rVb):E===OSF.DDA.Marshaling.BindingType.Table.toString()?{hL:e,returnValue:t}=this.Zmg(e,t,Wc.table):(e=null,t=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnknownBindingType);W.dispose();return{returnValue:t,hL:e}}XUk(e,t,E,W){const ha=this.Pc.Mc(15);ha.Ab(this.Eea.kla());W===OSF.DDA.Marshaling.BindingType.Text.toString()?{hL:e,returnValue:t}=this.Ymg(e,t,Wc.text,E):W===OSF.DDA.Marshaling.BindingType.Matrix.toString()?
{hL:e,returnValue:t}=this.Ymg(e,t,Wc.rVb,E):W===OSF.DDA.Marshaling.BindingType.Table.toString()?{hL:e,returnValue:t}=this.Ymg(e,t,Wc.table,E):(e=null,t=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnknownBindingType);ha.dispose();return{returnValue:t,hL:e}}yHf(e,t){return this.ep.yHf(e,t)}Wim(e,t,E){return this.ep.iui(e,t,!0,E)}Tim(e,t,E){let W;return{returnValue:({o_j:W}=this.ep.iui(e,t,!1,E)).returnValue,vJn:W.rows}}Sim(e,t){return this.ep.Rim(e,t)}dzg(e,t,E){const W=this.Pc.Mc(15);W.Ab(this.Eea.kla());
e=this.ep.dzg(e,t,E);W.dispose();return e}Vim(e,t,E){const W=[];e=this.ep.B2c(t,e,W);e!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?E(e,null):0>=W.length?E(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null):this.fHa.getOoxml(W,ha=>{E(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,ha)},ha=>{const Ka=this.Eje(ha);this.Sie(ha,3);E(Ka,null)})}aRo(e,t,E,W,ha){const Ka=E.TableHeaders;E=E.TableRows;if(Ka&&Ka.length||E&&E.length){var sb=this.Pc.Mc(15);sb.Ab(this.Eea.kla());this.ep.HMj(e,t,!0,
Ka,E,W,ha);sb.dispose()}else ha(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType,"table")}ZQo(e,t,E,W,ha){if(E&&E.length){var Ka=this.Pc.Mc(15);Ka.Ab(this.Eea.kla());this.ep.HMj(e,t,!1,null,E,W,ha);Ka.dispose()}else ha(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType,"matrix")}Iwo(e,t,E){return t.yo?(E(this.zho(e,t)),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}Dwf(e,t,E){if(t.yo){const W=this.Pc.Mc(15);W.Ab(this.Eea.kla());
this.ep.Dwf(e,t,E);W.dispose()}else E(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}Gff(e,t,E,W){if(E&&E.length)if(t.yo){const ha=this.Pc.Mc(15);ha.Ab(this.Eea.kla());this.ep.Gff(e,t,E,W);ha.dispose()}else W(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else W(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam)}Hef(e,t,E,W,ha,Ka){if(E&&E.length||W&&W.length)if(t.yo){const sb=this.Pc.Mc(15);sb.Ab(this.Eea.kla());this.ep.Hef(e,t,E,W,ha,Ka);sb.dispose()}else Ka(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else Ka(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam)}Sie(e,t){switch(t){case 0:Dk(e)?z.ULS.sendTraceTag(8159503,341,50,"SetSelectedOoxml failed with error code: {0}",e):z.ULS.sendTraceTag(7611806,341,10,"SetSelectedOoxml failed with error code: {0}",e);break;case 1:Dk(e)?z.ULS.sendTraceTag(8159504,341,50,"GetSelectedOoxml failed with error code: {0}",e):z.ULS.sendTraceTag(7151686,341,10,"GetSelectedOoxml failed with error code: {0}",e);break;case 2:Dk(e)?z.ULS.sendTraceTag(17385219,341,50,
"SetBindingOoxml failed with error code: {0}",e):z.ULS.sendTraceTag(17385220,341,10,"SetBindingOoxml failed with error code: {0}",e);break;case 3:Dk(e)?z.ULS.sendTraceTag(17331611,341,50,"GetBindingOoxml failed with error code: {0}",e):z.ULS.sendTraceTag(17331612,341,10,"GetBindingOoxml failed with error code: {0}",e)}}OJm(e){this.V3a.zDi(this.lb.gb,t=>{e(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,t)},t=>{const E=this.Eje(t);this.Sie(t,1);e(E,null)})}HJm(){let e="";const t=this.lb.gb.currentSelection;
return 1<this.lb.gb.length||!t||!t.length?{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,TKj:e}:{returnValue:({NWa:e}=this.HRa.tJf(t.toArray(),t.isForward)).returnValue,TKj:e}}TXo(e,t){const E=this.lb.gb.currentSelection;!e||1<this.lb.gb.length||!E||!E.length||this.HRa.Bxe(E.toArray(),E.isForward,e,W=>{t&&t(W)})}XXo(e,t){const E=this.zMf(this.lb.gb.J(0).Ra.node);this.V3a.XOj(this.lb.gb,e,0,0,0,null,W=>{var ha=this.V3a.pkc(W,this.jb.Gv(E,!0,!0));ha.count||(ha=this.V3a.pkc(W,this.AEm()));
if(ha.count){var Ka=[];for(let sb=0;sb<ha.count;sb++)W=new Nd.Selection([ha.J(sb)],!0),Ka.push(W);ha=new $f.SelectionCollection(Ka,0);this.lb.Y0(ha);t(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else z.ULS.sendTraceTag(19994848,341,10,"AppId:{0}, Can't find the inserted ooxml when invoking SetSelectedOoxml"),t(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)},W=>{const ha=this.Eje(W);this.Sie(W,0);t(ha)})}YQo(e,t,E,W){let ha=null,Ka=({Vkf:ha}=this.ep.Kti(t,e)).returnValue;if(Ka!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)W(Ka);
else if(ha.MO!==Wc.text)W(OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding);else if(this.ep.$qn(ha)){var sb=[];Ka=this.ep.B2c(t,e,sb);if(Ka!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)W(Ka);else if(0>=sb.length)W(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else{var dc=null;if(!this.ep.Pde&&({graphNode:dc,returnValue:Ka}=this.ep.Abl(ha),Ka!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)){W(Ka);return}var xc=this.Pc.Mc(15);xc.Ab(this.Eea.kla());if(!this.ep.Pde&&(this.ep.ZXf=
!1,Ka=this.ep.VDa(ha),this.ep.ZXf=!0,Ka!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)){W(Ka);return}e=(Rc,md)=>{if(!this.ep.Pde){if(Rc!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){let ud=!0;for(const Ud of sb)if(!Ud.isValid){ud=!1;break}ud&&(md=new Nd.Selection(sb,!0))}md&&(md=this.ep.vro(md,dc),Rc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(Rc=md))}xc.dispose();W(Rc)};Ka=this.HRa.Bxe(sb,!0,E,e);Ka!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&e(Ka,null)}}else W(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnThisBindingType)}ZXo(e,
t){let E=e[OSF.DDA.Marshaling.TableBindingParameterKeys.TableHeaders];e=e[OSF.DDA.Marshaling.TableBindingParameterKeys.TableRows];E&&E.length||e&&e.length?E&&1<E.length?(z.ULS.sendTraceTag(8458368,344,15,"SetSelectedTable failed for app want to add multi-row header table"),t(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)):(E=E[0],this.o6.IPj(E,e,t)):t(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)}WXo(e,t){e&&e.length?this.o6.IPj(null,e,t):t(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)}$Qo(e,
t,E,W){let ha=null,Ka=({Vkf:ha}=this.ep.Kti(t,e)).returnValue;if(Ka!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)W(Ka);else if(ha.MO!==Wc.text)W(OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding);else{var sb=[];Ka=this.ep.B2c(t,e,sb);Ka!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?W(Ka):0>=sb.length?W(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(e=this.ep.LVa(ha.RQ),this.fHa.lye(sb,E,e,4,0,null,()=>{W(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)},dc=>{const xc=
this.Eje(dc);this.Sie(dc,2);W(xc)}))}}zMf(e){const t=new Ld.GraphIterator;t.set(e);e=null;t.zb(10)&&(e=t.yp(10));return e}AEm(){const e=this.Eea.FDm();return this.jb.Gv(e,!0,!0)}zho(e,t){let E=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const W=this.Pc.Mc(15);W.Ab(this.Eea.kla());E=this.ep.sBj(e,t,()=>{this.ep.uxo(t,e);this.ep.txo(t,e)});W.dispose();return E}Zmg(e,t,E){if(!t||""===t)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,hL:null};if((E===Wc.rVb||E===Wc.table)&&
!this.o6.Bqn())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType,hL:null};let W,ha=({Iw:W}=this.ep.hIl()).returnValue;if(ha!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:ha,hL:null};E=new $l(t,E,this.ep.xHf(W));ha=this.ep.WMh(e,E);return ha!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?{returnValue:ha,hL:null}:this.ep.cBa(t,e)}Ymg(e,t,E,W){if(!t||""===t)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,hL:null};
let ha=({Iw:W}=this.ep.Smm(W)).returnValue;if(ha!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:ha,hL:null};if(E!==Wc.text){let Ka,sb;({BXj:Ka,mki:sb,returnValue:ha}=this.ep.Zmm(W));if(ha!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:ha,hL:null};if(!this.o6.isTable(Ka,sb))return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingType,hL:null}}E=new $l(t,E,this.ep.xHf(W));ha=this.ep.WMh(e,E);return ha!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?
{returnValue:ha,hL:null}:this.ep.cBa(t,e)}Eje(e){switch(e){case 1:return OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;case 7:return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidDataFormat;default:return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}R3l(e,t,E,W=null,ha=null){z.ULS.sendTraceTag(18354818,369,50,"A Word Rich API batch execution is requested.");const Ka=this.Eea.kla(),sb=this.I1.create(),dc=!!(e[6]&1);sb.context.An.yv(Ka);sb.context.appId=t;sb.context.controlId=
W;sb.context.Lad=dc;sb.context.Sk=ha;W=new Kf(sb.context,t,W);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(W,ng,sb,e).then(xc=>{sb.context.An.BF();if(!xc)return z.ULS.sendTraceTag(9204820,344,10,"The rich api executor call failed."),E(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),null;E(xc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{z.ULS.sendTraceTag(35733829,369,10,"A Word Rich API batch execution was failed, AppId:{0}",t);sb.context.An.BF();E(null,
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})}Vop(){let e;return S.App.PVc?(e=S.App.PVc,{returnValue:!0,url:e}):{returnValue:!1,url:null}}S3l(e,t,E,W,ha){this.R3l(e,t,ha,E,W)}saveSettings(e,t){return this.Eea.rJj(e,t)}kbb(e){return this.Eea.mqg(e)}}Object(y.a)(kj,"WordEditorApiObjectModel",sk,[1288,1289]);class tk{static $De(e,...t){for(let E=0;E<t.length;E++){if(!e||!e.hasOwnProperty(t[E]))return e=null,{returnValue:!1,value:e};e=e[t[E]]}return{returnValue:!0,value:e}}}Object(y.a)(tk,
"AppsForOfficeCommonUtils",null,[]);class Mm{constructor(e,t){this.c3e=null;this.Maf=e;this.Ga=t}pOm(e){return Mm.Npn(e)?this.Q4n:null}get Q4n(){if(!this.c3e){const e=[];e.push(this.Maf.createIncompleteRequestThrottle(this.Ga.ic("WordEditorAppsForOfficeSelectionOoxmlMaxIncompleteRequests",1),this.Ga.ic("WordEditorAppsForOfficeSelectionOoxmlRequestTimeoutMilliSec",3E4)));e.push(this.Maf.createTokenBucketThrottle(this.Ga.ic("WordEditorAppsForOfficeSelectionOoxmlTokenBucketCapacity",3),this.Ga.ic("WordEditorAppsForOfficeSelectionOoxmlTokenBucketFillingIntervalMilliSec",
2E3)));this.c3e=this.Maf.createChainedThrottle(e)}return this.c3e}static Npn(e){const t=e.DdaMethod.DispatchId;let E=null,W=t===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod&&({value:E}=tk.$De(e,OSF.DDA.Marshaling.UniqueArgumentKeys.GetData,OSF.DDA.Marshaling.GetDataKeys.CoercionType)).returnValue;return W=(W=(W=(W=W||t===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod&&({value:E}=tk.$De(e,OSF.DDA.Marshaling.UniqueArgumentKeys.SetData,OSF.DDA.Marshaling.SetDataKeys.CoercionType)).returnValue)||
t===OSF.DDA.MethodDispId.dispidGetBindingDataMethod&&({value:E}=tk.$De(e,OSF.DDA.Marshaling.UniqueArgumentKeys.GetData,OSF.DDA.Marshaling.GetDataKeys.CoercionType)).returnValue)||t===OSF.DDA.MethodDispId.dispidSetBindingDataMethod&&({value:E}=tk.$De(e,OSF.DDA.Marshaling.UniqueArgumentKeys.SetData,OSF.DDA.Marshaling.SetDataKeys.CoercionType)).returnValue)&&!!E&&E===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml}}Object(y.a)(Mm,"WordEditorApiThrottleStore",null,[1286]);class ka{constructor(e,t,E,W,ha){this.pda=
e;this.cxd=E;this.o1=ha}get vdc(){return this.o1}initialize(){this.pda.initialize();this.vdc.Wb()}dispose(){this.pda&&(this.pda.dispose(),this.pda=null);this.vdc&&(this.vdc.dispose(),this.o1=null)}}Object(y.a)(ka,"AppsForOfficeIntegrationManager",null,[13]);class $a extends ka{constructor(e,t,E,W,ha,Ka,sb,dc){super(e,t,E,W,ha);this.kg=null;this.Cnk=dc;this.ep=Ka}initialize(){super.initialize();this.Cnk.Wb();this.ep&&this.ep.Kso()}}Object(y.a)($a,"WordEditorAppsForOfficeIntegrationManager",ka,[]);
var Db=d(1434),ec=d(617),sc=d(574),ad=d(43),Xd=d(1260),ue=d(1194);class ae{create(){return new ue.a}}Object(y.a)(ae,"AppBindingNodeFactory",null,[296]);class Te{constructor(e,t,E,W,ha,Ka,sb){this.Pc=t;this.exd=E;this.J8e=W;this.pG=e;this.Omk=ha;this.ga=Ka;Te.vd=sb}initialize(){}kla(){const e=Ld.GraphIterator.eb(Lh.a.en.ib.$c);this.pG.dS(e);return e.currentNode}FDm(){const e=this.kla(),t=new Ld.GraphIterator;t.set(e);return this.pG.EMf(t.currentNode)}o5d(e){return this.Pti(e,!1)}Pti(e,t){let E=null;
const W=this.rqb();if(W&&W.Ub(19)){do{var ha=W.currentNode;if(!ha.getValue(fd.a.iTc)){const Ka=ha.getValue(fd.a.WTa);ha=ha.id.toString();if(t&&Ka.toLowerCase()===e.toLowerCase()||ha===e){E=this.wXc(W);break}}}while(W.Lf(19))}return E}p5d(e){return this.Pti(e,!0)}yjc(e){if(e&&e.GP)return this.yBf(e),this.yjc(e.GP);const t=new fa.a;if(e&&e.Zla)for(e=this.dBa(e),e=Hc.a.iq(e);e.moveNext();){const E=e.currentNode;50===E.type&&t.add(new $l(E.getValue(fd.a.zW),E.getValue(fd.a.MO),E.getValue(fd.a.RQ)))}return t}XGf(){const e=
new fa.a;var t=this.rqb();for(t=Hc.a.iq(t.currentNode);t.moveNext();){const E=t.currentNode;50===E.type&&e.add(new $l(E.getValue(fd.a.zW),E.getValue(fd.a.MO),E.getValue(fd.a.RQ)))}return e}Lti(){const e=new fa.a,t=this.rqb();this.mcm(t,E=>{const W=E.currentNode.id.toString();this.lcm(E,ha=>{e.add({["appInstanceId"]:W,["appBindingData"]:new $l(ha.getValue(fd.a.zW),ha.getValue(fd.a.MO),ha.getValue(fd.a.RQ))})})});return e}mcm(e,t){if(e&&e.Ub(19)){do t(e);while(e.Cj(19))}}lcm(e,t){if(e&&e.Ub(22)){do t(e.currentNode);
while(e.Cj(22))}}bsg(e,t){if(!e||!t)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(e.GP)return this.bsg(e.GP,t);if(e.Zla&&(e=this.dBa(e))){const E=Ld.GraphIterator.eb(e);let W=E.Ub(22);for(;W;){if(W.getValue(fd.a.zW)===t)return E.eh(),e.setValue(Tb.a.NU,new Date),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;W=E.Cj(22)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist}return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}cBa(e,t){e=this.yjc(e);for(const E of e)if(E.zW===
t)return E;return null}Yhm(e){const t=this.XGf(),E=new fa.a;for(const W of t)W.RQ===e&&E.add(W);return E}iTi(e,t){if(!e)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(e.GP)return this.yBf(e),this.iTi(e.GP,t);if(e.Zla){const E=this.dBa(e);if(!E)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.cBa(e,t.zW))return this.Qtp(e,t);e=this.DDl(t);this.ZUk(E,e)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}jti(){const e=new fa.a,t=this.rqb();if(t&&t.Ub(19)){do{const E=
this.wXc(t);E&&e.add(E)}while(t.Lf(19))}return e}vsb(e){var t;if(e&&e.Zla&&!this.dBa(e)){const E=this.luf(e);this.Aef(E,e);if(null===(t=e.assetId)||void 0===t?0:t.toLowerCase().startsWith("wa"))e=this.hDl(e),this.LUk(E,e)}}TVf(e,t,E,W){if(v.AFrameworkApplication.K.$("ContentAppIsEnabled")){for(;e&&!Object(ak.a)(sc.a,e);)e=e.Hk;e?this.bll(e)?(W=Object.assign(new Xd.a,{id:W.yo,version:W.version,store:W.store,storeType:W.storeType,instanceId:String.format("{{{0}}}",Rd.a.create()),isContent:!0}),e=this.Omk.i9m(e,
t,E,W),ai.a.vXf(e)&&this.Scd(e)):this.ga.Pb(M.a.G0b,2,{["ak1"]:WordEditorIntl.WordEditorStrings.L_ContentAppError}):z.ULS.sendTraceTag(593876625,344,15,"Context is null")}}Scd(e){e=Ld.GraphIterator.eb(e);e.zb(12);e.ld(12);e.io.ZT=!0}bll(e){e.contextId===na.a.view&&e.view.te&&e.view.lb&&(e=e.view.lb.Og);return e?e.Gl?!0:!1:(Te.vd.$b(Db.a.Te,{["Reason"]:ec.a.oo}),!1)}MQo(e){const t=this.dBa(e);if(t){const E=this.Pc.Mc(15);E.Ab(t);t.setValue(fd.a.pmb,e.lTc);t.setValue(Tb.a.NU,new Date);E.dispose()}}EQo(e){const t=
this.dBa(e);if(t){const E=this.Pc.Mc(4);E.Ab(t);t.setValue(ad.a.xkf,e.sharedRuntimeId);t.setValue(ad.a.ykf,e.backgroundState);t.setValue(Tb.a.NU,new Date);E.dispose()}}mqg(e){return e?e.GP?this.mqg(e.GP):e.Zla&&(e=this.dBa(e))?this.J8e.oHf(e):null:null}rJj(e,t){if(!e)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(e.GP)return this.yBf(e),this.rJj(e.GP,t);if(e.Zla&&(e=this.dBa(e))){const E=this.Pc.Mc(15);E.Ab(e);t=this.J8e.pKo(e,t);e.setValue(Tb.a.NU,new Date);E.dispose();return t}z.ULS.sendTraceTag(7143687,
344,15,"App Node not found when trying to save settings");return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}dispose(){}dBa(e){const t=this.rqb();if(t&&t.Ub(19)){do if(this.wXc(t).uUh(e))return t.currentNode;while(t.Lf(19))}return null}wXc(e){var t=e.currentNode;const E=this.J8e.oHf(t),W=t.getValue(fd.a.WTa),ha=t.getValue(fd.a.kTc),Ka=t.getValue(fd.a.omb),sb=t.getValue(fd.a.nKb);let dc;if(e.Ub(20)){var xc=e.currentNode;dc=xc.getValue(fd.a.WTa);xc=xc.getValue(fd.a.omb);e.uc()}e=t.getValue(fd.a.iTc);
const Rc=t.getValue(fd.a.pmb),md=t.ja(ad.a.xkf,null),ud=t.ja(ad.a.ykf,0);t=t.id.toString();let Ud=null;e||(Ud=new Ql(t,t,W,ha,Ka,sb,Rc,!0,md,ud,dc,xc),Ud.settings=E);return Ud}T9f(e){this.pG.dS(e);return e.Ub(18)}rqb(){let e=null;const t=Lh.a.en.ib.$c;t&&(e=new Ld.GraphIterator,e.set(t),this.T9f(e)||(e=null));return e}luf(e){const t=this.exd.create(kk.a.tIa);t.setValue(fd.a.WTa,e.yo);t.setValue(fd.a.nKb,e.storeType);t.setValue(fd.a.kTc,e.version);t.setValue(fd.a.omb,e.store);t.setValue(fd.a.pmb,e.lTc);
t.setValue(fd.a.iTc,!1);t.setValue(fd.a.gSh,!1);t.setValue(fd.a.nSh,"");t.setValue(fd.a.sSh,"right");t.setValue(fd.a.vSh,350);t.setValue(fd.a.uSh,1);t.setValue(fd.a.tSh,!1);return t}hDl(e){const t=this.exd.create(kk.a.ldc);t.setValue(fd.a.WTa,e.assetId);t.setValue(fd.a.kTc,e.version);t.setValue(fd.a.omb,e.assetStoreId);t.setValue(fd.a.nKb,"omex");return t}LUk(e,t){t&&Ld.GraphIterator.eb(e).Uf(t,20)}Uim(e,t){if((e=Ld.GraphIterator.eb(e))&&e.Ub(22)){do{const E=e.currentNode,W=E.getValue(fd.a.zW);if(t===
W)return E}while(e.Lf(22))}return null}DDl(e){const t=(new ae).create(kk.a.idc);t.setValue(fd.a.zW,e.zW);t.setValue(fd.a.MO,e.MO);t.setValue(fd.a.RQ,e.RQ);return t}Qtp(e,t){e=this.dBa(e);if(!e)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const E=this.Uim(e,t.zW);if(!E)return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;E.setValue(fd.a.MO,t.MO);E.setValue(fd.a.RQ,t.RQ);e.setValue(Tb.a.NU,new Date);return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}ZUk(e,t){Ld.GraphIterator.eb(e).Uf(t,
22);e.setValue(Tb.a.NU,new Date)}Aef(e,t){const E=this.rqb();E&&!e.anchor&&(t=Hb.a.Cf(t.lSh),Rd.a.compare(t.hu,Rd.a.nil)&&(z.ULS.sendTraceTag(20796771,344,15,"Instance id is not a extended guid. Create a new extended guid for app node."),t=new Hb.a(Rd.a.create(),1)),E.w6(e,19,t))}yBf(e){this.vsb(e.GP)}}Te.vd=null;Object(y.a)(Te,"WordEditorAppsForOfficeModel",null,[1205,13]);var sf;(function(e){e[e.Zcq=0]="notRegistered";e[e.Jgq=1]="queryStarted";e[e.ihq=2]="registrationFailed";e[e.hhq=3]="registered"})(sf||
(sf={}));Object(y.b)("CommandRegistrationStatus",sf);var kg=d(636);class qf{constructor(){this.addInDetails=this.title=null}}Object(y.a)(qf,"AddInCategoryData",null,[]);class fh{constructor(){this.links=this.description=this.displayName=this.uniqueId=this.solutionId=null}}Object(y.a)(fh,"AddInDetailData",null,[]);class Fi{constructor(){this.href=this.text=null}}Object(y.a)(Fi,"AddInLinkData",null,[]);class Nj{constructor(e,t,E){this.aQa=0;this.Jkh=!1;this.iQc=[];this.Ga=e;this.$Pa=t;this.aAh=E;z.ULS.sendTraceTag(508396508,
220,50,"AddInCategoryManager Initialized")}MMa(e,t){e&&t&&this.X2o(t)&&this.Ntj()}X2o(e){0===e.LO&&(this.aQa|=1);1===e.LO&&(this.aQa|=2);2===e.LO&&(this.aQa|=4);return!!this.aQa}Ntj(){let e=null;const t={},E=this.Lon,W=this.sOn;var ha=this.$Pa.fX(0);const Ka=this.$Pa.fX(1),sb=this.$Pa.fX(2);2!==ha.errorCode||W.length?3===ha.errorCode&&3===Ka.errorCode?e={label:CommonUIStrings.l_AddinPickerGeneralError,iconName:"Common",ariaDescription:CommonUIStrings.l_AddinPickerGeneralError}:4!==ha.errorCode||W.length?
!this.a1i&&(!this.Yla||0!==sb.errorCode&&5!==sb.errorCode)||sb.pF.length||z.ULS.sendTraceTag(508396506,220,50,"get popular add-ins for backstage error: empty category, Flag: {0} Popular error code: {1}",this.aQa,sb.errorCode):e={label:CommonUIStrings.l_AddinPickerServiceDisconnectedError,iconName:"StoreDisabled",ariaDescription:CommonUIStrings.l_AddinPickerServiceDisconnectedError}:e={label:CommonUIStrings.l_AddinPickerDisableError,iconName:"StoreDisabled",ariaDescription:CommonUIStrings.l_AddinPickerDisableError};
ha=!e;if(!ha||E||W.length)ha?(t.mruAddIns=W,E&&(t.categories=this.Vbo)):t.errorViewProps=e,appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData(t,ha)),E&&ha&&!this.Jkh&&(this.Jkh=!0,z.ULS.sendTraceTag(508396504,220,50,"Set Popular Add-ins List to Backstage Success. Flag: {0}",this.aQa))}get a1i(){return!!(this.aQa&4)}get Lon(){const e=this.$Pa.fX(2);return(this.a1i||this.Yla)&&(0===e.errorCode||5===e.errorCode)&&!!e.pF.length}get Vbo(){if(ab.c(this.aAh))return[];var e=JSON.parse(this.aAh);
const t=[];for(var E of e)e=Object.assign(new qf,{title:E.title,addInDetails:[]}),this.qfl(e,E.solutionIds),0<e.addInDetails.length&&Array.add(t,e);0<this.iQc.length&&(E=this.$Pa.fX(2),z.ULS.sendTraceTag(508396503,220,15,"{0} SolutionIds not found in mapping: {1}, collection length: {2}",this.iQc.length,this.iQc,E.pF.length),this.iQc=[]);return t}get sOn(){var e=[],t=this.$Pa.fX(0);Array.addRange(e,t.pF);t=this.$Pa.fX(1);Array.addRange(e,t.pF);e.sort((E,W)=>{E=ee.d(E.displayName);W=ee.d(W.displayName);
return Qd.a.localeCompare(E,W)});t=[];for(const E of e)e=Object.assign(new fh,{description:E.description,displayName:E.displayName,solutionId:E.solutionId,uniqueId:this.H1c(E)}),Array.add(t,e);return t}qfl(e,t){const E=this.tOn;let W=0;for(const ha of t){if(4===W)break;if(E.contains(ha))continue;t=this.$Pa.P8a(ha);if(!t){this.iQc.push(ha);continue}const Ka=Object.assign(new fh,{description:t.description,displayName:t.displayName,solutionId:t.solutionId,uniqueId:this.H1c(t)});Ka.links=[Object.assign(new Fi,
{text:CommonUIStrings.l_AddinOneLink,href:"https://appsource.microsoft.com/en-us/product/office/"+t.solutionId})];Array.add(e.addInDetails,Ka);++W}}get tOn(){const e=[];var t=this.$Pa.fX(0);Array.addRange(e,t.pF);t=this.$Pa.fX(1);Array.addRange(e,t.pF);t=new kg.a(oi.a.th());for(const E of e)t.add(E.solutionId);return t}H1c(e){return this.Yla?String.format("{0}#{1}",e.solutionId,e.storeId):e.solutionId}get Yla(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",
!1)&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}}Object(y.a)(Nj,"AddInCategoryManager",null,[]);var Zh;(function(e){e[e.jcq=0]="myAddins";e[e.RSp=1]="adminManaged";e[e.Zfq=2]="popular"})(Zh||(Zh={}));Object(y.b)("AddinCollectionType",Zh);var hk=d(543);class km{constructor(){this.AUP=this.priority=0}}Object(y.a)(km,"AddinDetailInfo",null,[]);class lm{constructor(e){this.solutionIds=null;this.errorCode=0;this.Zj=null;this.rra=e}}Object(y.a)(lm,
"AddinCollection",null,[]);class Rl extends Sys.EventArgs{constructor(e,t,E,W=null){super();this.LO=e;this.errorCode=t;this.pF=E;this.Zj=W}}Object(y.a)(Rl,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class Oj{constructor(e){this.errorCode=e;this.pF=[];this.Zj=null}}Object(y.a)(Oj,"GetAddinDetailsResult",null,[]);class Fn{}Object(y.a)(Fn,"GetEntitlementDetailsParameters",null,[]);var em=d(114);class dn{constructor(e,t,E=null){this.sa=new ua.a;this.uC=new hk.a(oi.a.th());this.ns=new vb.a;this.VGb=
null;this.Qvb=(W,ha,Ka)=>{if(Ka)if(dn.qcd(W,Ka,window.performance.now()-ha),0===Ka.errorCode){let dc;if(Ka.value){let xc=0;dc=Array(Ka.value.length);Ka.value.forEach(Rc=>{dc[xc++]=Rc})}else dc=[];this.YL(W,dc)}else if(-1===Ka.errorCode||10===Ka.errorCode)this.YL(W,[]);else{var sb={};sb.collectionType=Zh[W];sb.invokeResultCode=Ka.errorCode;sb["queryResult.Value"]=Ka.value?String.format("Length: {0}",Ka.value.length):"null";sb.queryStart=ha;sb.queryDuration=window.performance.now()-ha;this.ns.Z(W,Object.assign(new lm(W),
{errorCode:3,Zj:Error.create("QueryAddinDetails hit an invocation failure",sb)}));z.ULS.sendTraceTag(512231324,220,15,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Zh[W],this.ns.J(W).Zj.toString(),JSON.stringify(this.ns.J(W).Zj))}else sb={},sb.collectionType=Zh[W],sb.queryResult=Ka?"not null":"null",sb.queryStart=ha,sb.queryDuration=window.performance.now()-ha,this.ns.Z(W,Object.assign(new lm(W),{errorCode:3,Zj:Error.create("QueryAddinDetails hit an invocation failure",
sb)})),z.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Zh[W],this.ns.J(W).Zj.toString(),JSON.stringify(this.ns.J(W).Zj))};this.MMa=(W,ha)=>{W=Object.assign(new lm(ha.LO),{solutionIds:new fa.a});var Ka=ha.pF;for(const sb of Ka)Ka=sb.solutionId,this.uC.mb(Ka)?this.uC.Z(Ka,this.ydd(this.uC.J(Ka),ha.LO,sb)):this.uC.add(Ka,sb),W.solutionIds.add(Ka);this.ns.Z(ha.LO,W)};this.tqa=new Yc.a;this.tqa.add(OSF.StoreTypeEnum.MarketPlace,
0);this.tqa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ga=e;this.tk=t;this.Qu=E;this.eJc=dn.D3c(e,"https://store-images.s-microsoft.com");this.cmb(this.MMa)}get w9c(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get au(){return this.tk.value}fX(e){if(!this.ILa(e))return e=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Zh[e]}),Object.assign(new Oj(1),{Zj:e});if(this.ns.J(e).Zj)return Object.assign(new Oj(this.ns.J(e).errorCode),
{Zj:this.ns.J(e).Zj});z.ULS.shipAssertTag(509870082,220,!!this.ns.J(e).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",e);const t=new Oj(0);for(const E of this.ns.J(e).solutionIds)this.uC.mb(E)&&Array.add(t.pF,this.uC.J(E));return t}P8a(e){return this.uC.mb(e)?this.uC.J(e):null}MNa(e){if(e){this.cmb(e);for(const E of this.ns.keys)if(this.ILa(E)&&!this.ns.J(E).Zj){z.ULS.shipAssertTag(509870081,220,!!this.ns.J(E).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
E);var t=[];for(const W of this.ns.J(E).solutionIds)Array.add(t,this.uC.J(W));t=new Rl(E,this.ns.J(E).errorCode,t);e(null,t)}}}get name(){return"AddinDetailsManager"}gZb(){}NP(e,t=!1){0!==e&&10!==e?z.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",zb[e]):this.Mid(e,this.Qvb,t)}cmb(e){this.sa.addHandler(nc.a.Vcc,e)}cSf(e){const t={};t.collectionType=Zh[e];this.ns.Z(e,Object.assign(new lm(e),{errorCode:2,Zj:Error.create("The store is disabled.",t)}));z.ULS.sendTraceTag(510253056,
220,50,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Zh[e],this.ns.J(e).Zj.toString(),JSON.stringify(this.ns.J(e).Zj))}CCg(){return this.ILa(2)?this.Ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.ns.J(2).Zj:!1:!0}Mid(e,t,E=!1){z.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",e);e!==OSF.StoreTypeEnum.MarketPlace&&e!==OSF.StoreTypeEnum.PrivateCatalog?z.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",
e):(this.CCg()&&this.queryStoreDisabled(0,(W,ha)=>{ha?this.cSf(2):(W=window.performance.now(),t(2,W,this.aNf()))}),this.queryStoreDisabled(e,(W,ha)=>{if(W===OSF.StoreTypeEnum.MarketPlace&&ha)this.cSf(0);else if(W===OSF.StoreTypeEnum.PrivateCatalog&&ha)this.cSf(1);else{var Ka=window.performance.now();this.au.getEntitlementDetails(Object.assign(new Fn,{storeType:W,refresh:E}),sb=>{t(this.tqa.J(W),Ka,sb)})}}))}YL(e,t){e=new Rl(e,0,t);this.sa.raiseEvent(nc.a.Vcc,e)}ILa(e){return this.ns.mb(e)?!!this.uC:
!1}get DTc(){return this.Qu?!this.Qu.AreThirdPartyAddInsAllowed||this.Qu.AppsForOfficeThirdPartyIsDisabled:!this.Ga.$("AreThirdPartyAddInsAllowed")||this.Ga.$("AppsForOfficeThirdPartyIsDisabled")}get Y9c(){return this.Qu?!this.Qu.AppsForOfficeAllowExternalMarketplace:!this.Ga.$("AppsForOfficeAllowExternalMarketplace")}get Hcb(){return this.Qu?this.Qu.PopularAddinDetailsJsonString:this.Ga.kb("PopularAddinDetailsJsonString")}queryStoreDisabled(e,t){if(this.DTc)t(e,!0);else if(e===OSF.StoreTypeEnum.MarketPlace&&
this.Y9c)t(e,!0);else{const E=dn.asd(e);if(E){const W=window.performance.now();this.au.queryStoreDisabled(E,ha=>{z.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",e,ha,W,window.performance.now()-W);t(e,ha)})}else t(e,!1)}}ydd(e,t,E){return e?E?2===t?dn.Oub(E,e):dn.Oub(e,E):e:E}aNf(){if(!this.VGb){const e=JSON.parse(this.Hcb);this.Pic(e);this.VGb=e}return dn.fec(0,this.VGb)}Pic(e){dn.qTc(e);this.sdc(e);this.$0c(e)}sdc(e){const t=
this.yUc();for(var E=0;E<e.length&&0<t.count;E++){const W=e[E];if(t.mb(W.solutionId)){let ha=String.format("Found an override, solutionId: {0}",W.solutionId);const Ka=t.J(W.solutionId);Ka&&(isNaN(Ka.addinInfo.priority)||(ha=String.format("{0}; AddinInfo.Priority: update {1} to {2}",ha,W.addinInfo.priority,Ka.addinInfo.priority),W.addinInfo.priority=Ka.addinInfo.priority),isNaN(Ka.addinInfo.AUP)||(ha=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ha,W.addinInfo.AUP,Ka.addinInfo.AUP),W.addinInfo.AUP=
Ka.addinInfo.AUP),Ka.displayName&&(ha=String.format("{0}; DisplayName: update {1} to {2}",ha,W.displayName,Ka.displayName),W.displayName=Ka.displayName),Ka.iconUrl&&(ha=String.format("{0}; IconUrl: update {1} to {2}",ha,W.iconUrl,Ka.iconUrl),W.iconUrl=Ka.iconUrl),Ka.description&&(ha=String.format("{0}; Description: update {1} to {2}",ha,W.description,Ka.description),W.description=Ka.description));t.remove(W.solutionId);this.w9c&&z.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",
ha)}}for(const W of t.keys)E=t.J(W),E.displayName&&E.iconUrl&&E.addinInfo&&(e.push(E),this.w9c&&z.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(E)))}yUc(){const e=new hk.a(oi.a.th());let t=this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!t)return e;t=t.trim();if(12>=t.length)return 0<t.length&&z.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",
t),e;this.w9c&&z.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",t);try{const E=[],W=t.split("|");for(let ha=W.length-1;0<=ha;ha--){const Ka=W[ha],sb=Ka.split("\\");if(2>sb.length){E.push(Ka);continue}const dc=dn.bhd(sb);dc?e.mb(dc.solutionId)||e.add(dc.solutionId,dc):E.push(Ka)}this.w9c&&0<E.length&&z.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",E.join("|"));this.w9c&&0<e.count&&z.ULS.sendTraceTag(509379103,
220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",e.count,JSON.stringify(em.toArray(e.values)));return e}catch(E){z.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",t,E.toString())}return e}$0c(e){for(let t=0;t<e.length;t++)ee.c(e[t].iconUrl.toLowerCase(),"http",0)||(e[t].iconUrl=String.format("{0}/image/apps.{1}",this.eJc,e[t].iconUrl))}static qcd(e,t,E){const W={};W.AddinCollectionType=Zh[e];W.ErrorCode=
t.errorCode;W.AddinCount=t.value?t.value.length:0;z.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",E,JSON.stringify(W))}static fec(e,t){const E={};E.errorCode=e;E.value=t;return E}static asd(e){return e===OSF.StoreTypeEnum.MarketPlace?"omex":e===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static Oub(e,t){t.solutionId=t.solutionId||e.solutionId;t.version=t.version||e.version;t.storeType=t.storeType||e.storeType;t.storeId=t.storeId||
e.storeId;t.assetId=t.assetId||e.assetId;t.assetStoreId=t.assetStoreId||e.assetStoreId;t.displayName=t.displayName||e.displayName;t.provider=t.provider||e.provider;t.description=t.description||e.description;t.iconUrl=t.iconUrl||e.iconUrl;t.webApplicationId=t.webApplicationId||e.webApplicationId;t.highResolutionIconUrl=t.highResolutionIconUrl||e.highResolutionIconUrl;t.licenseUrl=t.licenseUrl||e.licenseUrl;t.privacyUrl=t.privacyUrl||e.privacyUrl;t.addinInfo=t.addinInfo||e.addinInfo;isNaN(t.targetType)&&
(t.targetType=e.targetType);isNaN(t.height)&&(t.height=e.height);isNaN(t.width)&&(t.width=e.width);return t}static qTc(e){for(const t of e)isNaN(t.targetType)&&(t.targetType=1),t.assetId=t.assetId||t.solutionId,t.storeId=t.storeId||"en-US",t.storeType=t.storeType||"omex",t.assetStoreId=t.assetStoreId||"omex",isNaN(t.width)&&(t.width=0),isNaN(t.height)&&(t.height=0)}static bhd(e){const t={};let E=0;E<e.length&&0<e[E].trim().length&&e[E].trim().toLowerCase().startsWith("wa")&&(t.solutionId=e[E].trim(),
t.addinInfo=Object.assign(new km,{priority:Number.NaN,AUP:Number.NaN}),++E<e.length&&0<e[E].trim().length&&(t.addinInfo.priority=parseInt(e[E].trim())),++E<e.length&&0<e[E].trim().length&&(t.addinInfo.AUP=parseInt(e[E].trim())),++E<e.length&&0<e[E].trim().length&&(t.displayName=e[E].trim()),++E<e.length&&0<e[E].trim().length&&(t.iconUrl=e[E].trim()),++E<e.length&&0<e[E].trim().length&&(t.description=e[E].trim()));return t.solutionId?t:null}static D3c(e,t){e=e.kb("AddinImageStoreServiceUrl");if(!e)return t;
e=e.toLowerCase();return e.startsWith("http://")||e.startsWith("https://")?e:t}}Object(y.a)(dn,"AddinDetailsManager",null,[1361,1362]);class Lo{constructor(e,t=0){this.Zj=null;this.rra=e;this.errorCode=t}}Object(y.a)(Lo,"AddinQueryResult",null,[]);class Gi extends Lo{constructor(e,t=0){super(e,t);this.solutionIds=null}}Object(y.a)(Gi,"AddinCollection",Lo,[]);var en;(function(e){e[e.stop=-1]="stop";e[e.skip=0]="skip";e[e.query=1]="query"})(en||(en={}));Object(y.b)("QueryStrategy",en);var uk;(function(e){e[e.OK=
0]="OK";e[e.Ycq=1]="notReady";e[e.nmq=2]="storeDisabled";e[e.a5p=3]="invokeFailure";e[e.akq=4]="serviceDisabled";e[e.wUp=5]="builtinAddinDetails"})(uk||(uk={}));Object(y.b)("AddinDetailsQueryError",uk);class pj{constructor(e,t,E=null){this.sa=new ua.a;this.uC=new hk.a(oi.a.th());this.ns=new vb.a;this.kea=new vb.a;this.VGb=null;this.Qvb=(W,ha,Ka)=>{if(Ka)if(pj.qcd(W,Ka,window.performance.now()-ha),0===Ka.errorCode){let sb;if(Ka.value){let dc=0;sb=Array(Ka.value.length);Ka.value.forEach(xc=>{sb[dc++]=
xc})}else sb=[];this.YL(new Lo(W),sb)}else-1===Ka.errorCode||10===Ka.errorCode?this.YL(new Lo(W),[]):(W=this.Gmf(W,ha,Ka),this.YL(W));else W=pj.Hmf(W,ha),this.YL(W)};this.MMa=(W,ha)=>{if(0!==ha.errorCode)this.ns.Z(ha.LO,Object.assign(new Gi(ha.LO,ha.errorCode),{Zj:ha.Zj}));else{W=Object.assign(new Gi(ha.LO),{solutionIds:new fa.a});var Ka=ha.pF;for(const sb of Ka)Ka=sb.solutionId,this.uC.mb(Ka)?this.uC.Z(Ka,this.ydd(this.uC.J(Ka),ha.LO,sb)):this.uC.add(Ka,sb),W.solutionIds.add(Ka);this.ns.Z(ha.LO,
W);this.KNa(W.rra,1)}};this.tqa=new Yc.a;this.tqa.add(OSF.StoreTypeEnum.MarketPlace,0);this.tqa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ga=e;this.tk=t;this.Qu=E;this.eJc=pj.D3c(e,"https://store-images.s-microsoft.com");this.cmb(this.MMa)}get epg(){return!!this.Ga&&this.Ga.isChangeGateEnabled("QueryPopularForOmexOnlyEnabled")}get tR(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get isAnonymousUser(){return!!this.Ga&&this.Ga.$("IsAnonymousUser")}get REf(){return!!this.Ga&&
this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get l1c(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get qKa(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get au(){return this.tk.value}fX(e){if(this.tR&&!this.L$a(e))return new Oj(0);if(!this.ILa(e))return e=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Zh[e]}),
Object.assign(new Oj(1),{Zj:e});if(this.ns.J(e).Zj)return Object.assign(new Oj(this.ns.J(e).errorCode),{Zj:this.ns.J(e).Zj});z.ULS.shipAssertTag(509870082,220,!!this.ns.J(e).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",e);const t=new Oj(0);for(const E of this.ns.J(e).solutionIds)this.uC.mb(E)&&Array.add(t.pF,this.uC.J(E));return t}P8a(e){return this.uC.mb(e)?this.uC.J(e):null}MNa(e){if(e){this.cmb(e);for(const t of this.ns.keys){if(this.tR&&!this.L$a(t))continue;
if(!this.ILa(t)||this.ns.J(t).Zj)continue;z.ULS.shipAssertTag(509870081,220,!!this.ns.J(t).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",t);const E=[],W=this.ns.J(t);for(const ha of W.solutionIds)Array.add(E,this.uC.J(ha));e(null,new Rl(t,W.errorCode,E,W.Zj))}}}get name(){return"AddinDetailsManager1"}gZb(e,t){if(this.tR&&pj.Mtb(e)){var E=ha=>{this.YL(pj.bLb(ha,4,"The connected service is disabled."));this.KNa(ha,-1)},W=ha=>{this.YL(pj.bLb(ha,0,
"The user doesn't have any addin installed."),[]);this.KNa(ha,0)};0===e?(this.I7c(0,t,E,W),this.I7c(2,t,E,()=>{this.xYb(this.Qvb)})):10===e&&this.KNa(1,1)}}NP(e,t=!1){pj.Mtb(e)?this.Mid(e,this.Qvb,t):z.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",zb[e])}cmb(e){this.sa.addHandler(nc.a.Vcc,e)}I7c(e,t,E,W){this.L$a(e)||(3===t&&E?E(e):2===t&&W?W(e):this.KNa(e,1))}L$a(e){return this.kea.mb(e)}KNa(e,t){if(this.tR){var E=this.L$a(e);if(!E||-1!==this.kea.J(e)&&this.kea.J(e)!==
t)z.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",Zh[e],E?en[this.kea.J(e)]:"undefined",en[t]),this.kea.Z(e,t)}}Gmf(e,t,E){const W={};W.collectionType=Zh[e];W.invokeResultCode=E.errorCode;W["queryResult.Value"]=E.value?String.format("Length: {0}",E.value.length):"null";W.queryStart=t;W.queryDuration=window.performance.now()-t;return Object.assign(new Lo(e,3),{Zj:Error.create("QueryAddinDetails hit an invocation failure",W)})}$2o(){return this.ILa(2)?
this.Ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?3===this.ns.J(2).errorCode:!1:!0}vpd(e){return this.tR&&this.kea.mb(e)?1===this.kea.J(e):!0}Mid(e,t,E=!1){z.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",e);if(e!==OSF.StoreTypeEnum.MarketPlace&&e!==OSF.StoreTypeEnum.PrivateCatalog)z.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",e);else{var W=this.tqa.J(e);this.a3o(e)&&this.vpd(2)&&this.xYb(t);this.vpd(W)&&(this.l1c&&
this.isAnonymousUser?(e=pj.xmf(W),this.YL(e)):this.hog(e,t,E))}}a3o(e){return this.epg?e===OSF.StoreTypeEnum.MarketPlace:!0}hog(e,t,E){this.queryStoreDisabled(e,(W,ha)=>{if(W===OSF.StoreTypeEnum.MarketPlace&&ha)ha=pj.dLb(0),this.YL(ha);else if(W===OSF.StoreTypeEnum.PrivateCatalog&&ha)ha=pj.dLb(1),this.YL(ha);else{var Ka=window.performance.now();this.au.getEntitlementDetails(Object.assign(new Fn,{storeType:W,refresh:E}),sb=>{t(this.tqa.J(W),Ka,sb)})}})}xYb(e){this.$2o()&&this.queryStoreDisabled(0,
(t,E)=>{E?(t=pj.dLb(2),this.YL(t)):(t=window.performance.now(),e(2,t,this.aNf()))})}YL(e,t=null){0!==e.errorCode?(z.ULS.shipAssertTag(509116673,220,!t,"The parameter addinDetails must be null for any failed queries"),z.ULS.shipAssertTag(509116672,220,!!e.Zj,"The result.Failure must not be available for any failed queries"),this.uCg(e)?z.ULS.sendTraceTag(510253056,220,10,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",Zh[e.rra],uk[e.errorCode],
e.Zj?e.Zj.toString():"null",JSON.stringify(e.Zj)):z.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",Zh[e.rra],uk[e.errorCode],e.Zj?e.Zj.toString():"null",JSON.stringify(e.Zj))):(z.ULS.shipAssertTag(509116643,220,!!t,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",Zh[e.rra]),z.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",
Zh[e.rra],t?t.length:-1));e=new Rl(e.rra,e.errorCode,t,e.Zj);this.sa.raiseEvent(nc.a.Vcc,e)}uCg(e){return 3===e.errorCode&&(this.l1c&&-2147208619===pj.H3c(e)||this.REf&&-2===pj.H3c(e))||4===e.errorCode?!1:2!==e.errorCode}ILa(e){return this.ns.mb(e)?!!this.uC:!1}get DTc(){return this.Qu?!this.Qu.AreThirdPartyAddInsAllowed||this.Qu.AppsForOfficeThirdPartyIsDisabled:!this.Ga.$("AreThirdPartyAddInsAllowed")||this.Ga.$("AppsForOfficeThirdPartyIsDisabled")}get Y9c(){return this.Qu?!this.Qu.AppsForOfficeAllowExternalMarketplace:
!this.Ga.$("AppsForOfficeAllowExternalMarketplace")}get Hcb(){return this.Qu?this.Qu.PopularAddinDetailsJsonString:this.Ga.kb("PopularAddinDetailsJsonString")}queryStoreDisabled(e,t){if(this.DTc)t(e,!0);else if(e===OSF.StoreTypeEnum.MarketPlace&&this.Y9c)t(e,!0);else{const E=pj.asd(e);if(E){const W=window.performance.now();this.au.queryStoreDisabled(E,ha=>{z.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",e,ha,W,window.performance.now()-
W);t(e,ha)})}else t(e,!1)}}ydd(e,t,E){return e?E?2===t?pj.Oub(E,e):pj.Oub(e,E):e:E}aNf(){if(!this.VGb){const e=JSON.parse(this.Hcb);this.Pic(e);this.VGb=e}return pj.fec(0,this.VGb)}Pic(e){pj.qTc(e);this.sdc(e);this.$0c(e)}sdc(e){const t=this.yUc();for(var E=0;E<e.length&&0<t.count;E++){const W=e[E];if(t.mb(W.solutionId)){let ha=String.format("Found an override, solutionId: {0}",W.solutionId);const Ka=t.J(W.solutionId);Ka&&(isNaN(Ka.addinInfo.priority)||(ha=String.format("{0}; AddinInfo.Priority: update {1} to {2}",
ha,W.addinInfo.priority,Ka.addinInfo.priority),W.addinInfo.priority=Ka.addinInfo.priority),isNaN(Ka.addinInfo.AUP)||(ha=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ha,W.addinInfo.AUP,Ka.addinInfo.AUP),W.addinInfo.AUP=Ka.addinInfo.AUP),Ka.displayName&&(ha=String.format("{0}; DisplayName: update {1} to {2}",ha,W.displayName,Ka.displayName),W.displayName=Ka.displayName),Ka.iconUrl&&(ha=String.format("{0}; IconUrl: update {1} to {2}",ha,W.iconUrl,Ka.iconUrl),W.iconUrl=Ka.iconUrl),Ka.description&&
(ha=String.format("{0}; Description: update {1} to {2}",ha,W.description,Ka.description),W.description=Ka.description));t.remove(W.solutionId);this.qKa&&z.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",ha)}}for(const W of t.keys)E=t.J(W),E.displayName&&E.iconUrl&&E.addinInfo&&(e.push(E),this.qKa&&z.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(E)))}yUc(){const e=new hk.a(oi.a.th());
let t=this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!t)return e;t=t.trim();if(12>=t.length)return 0<t.length&&z.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",t),e;this.qKa&&z.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",t);try{const E=[],W=t.split("|");for(let ha=W.length-1;0<=ha;ha--){const Ka=W[ha],sb=Ka.split("\\");if(2>sb.length){E.push(Ka);continue}const dc=
pj.bhd(sb);dc?e.mb(dc.solutionId)||e.add(dc.solutionId,dc):E.push(Ka)}this.qKa&&0<E.length&&z.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",E.join("|"));this.qKa&&0<e.count&&z.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",e.count,JSON.stringify(em.toArray(e.values)));return e}catch(E){z.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
t,E.toString())}return e}$0c(e){for(let t=0;t<e.length;t++)ee.c(e[t].iconUrl.toLowerCase(),"http",0)||(e[t].iconUrl=String.format("{0}/image/apps.{1}",this.eJc,e[t].iconUrl))}static Mtb(e){return 0===e||10===e}static Hmf(e,t){const E={};E.collectionType=Zh[e];E.queryResult="null";E.queryStart=t;E.queryDuration=window.performance.now()-t;return Object.assign(new Lo(e,3),{Zj:Error.create("QueryAddinDetails hit an invocation failure",E)})}static bLb(e,t,E){const W={};W.collectionType=Zh[e];e=new Lo(e,
t);0!==t&&(e.Zj=Error.create(E,W));return e}static dLb(e){return pj.bLb(e,2,"The store is disabled.")}static xmf(e){const t={};t.collectionType=Zh[e];t.invokeResultCode=-2147208619;t.queryDuration=0;return Object.assign(new Lo(e,3),{Zj:Error.create("Anonymous users do not have installed add-ins.",t)})}static H3c(e){return e.Zj?e.Zj.invokeResultCode:-1E3}static qcd(e,t,E){const W={};W.AddinCollectionType=Zh[e];W.ErrorCode=t.errorCode;W.AddinCount=t.value?t.value.length:0;z.ULS.sendTraceTag(512231322,
220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",E,JSON.stringify(W))}static fec(e,t){const E={};E.errorCode=e;E.value=t;return E}static asd(e){return e===OSF.StoreTypeEnum.MarketPlace?"omex":e===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static Oub(e,t){t.solutionId=t.solutionId||e.solutionId;t.version=t.version||e.version;t.storeType=t.storeType||e.storeType;t.storeId=t.storeId||e.storeId;t.assetId=t.assetId||e.assetId;t.assetStoreId=t.assetStoreId||
e.assetStoreId;t.displayName=t.displayName||e.displayName;t.provider=t.provider||e.provider;t.description=t.description||e.description;t.iconUrl=t.iconUrl||e.iconUrl;t.webApplicationId=t.webApplicationId||e.webApplicationId;t.highResolutionIconUrl=t.highResolutionIconUrl||e.highResolutionIconUrl;t.licenseUrl=t.licenseUrl||e.licenseUrl;t.privacyUrl=t.privacyUrl||e.privacyUrl;t.addinInfo=t.addinInfo||e.addinInfo;isNaN(t.targetType)&&(t.targetType=e.targetType);isNaN(t.height)&&(t.height=e.height);isNaN(t.width)&&
(t.width=e.width);return t}static qTc(e){for(const t of e)isNaN(t.targetType)&&(t.targetType=1),t.assetId=t.assetId||t.solutionId,t.storeId=t.storeId||"en-US",t.storeType=t.storeType||"omex",t.assetStoreId=t.assetStoreId||"omex",isNaN(t.width)&&(t.width=0),isNaN(t.height)&&(t.height=0)}static bhd(e){const t={};let E=0;E<e.length&&0<e[E].trim().length&&e[E].trim().toLowerCase().startsWith("wa")&&(t.solutionId=e[E].trim(),t.addinInfo=Object.assign(new km,{priority:Number.NaN,AUP:Number.NaN}),++E<e.length&&
0<e[E].trim().length&&(t.addinInfo.priority=parseInt(e[E].trim())),++E<e.length&&0<e[E].trim().length&&(t.addinInfo.AUP=parseInt(e[E].trim())),++E<e.length&&0<e[E].trim().length&&(t.displayName=e[E].trim()),++E<e.length&&0<e[E].trim().length&&(t.iconUrl=e[E].trim()),++E<e.length&&0<e[E].trim().length&&(t.description=e[E].trim()));return t.solutionId?t:null}static D3c(e,t){e=e.kb("AddinImageStoreServiceUrl");if(!e)return t;e=e.toLowerCase();return e.startsWith("http://")||e.startsWith("https://")?
e:t}}Object(y.a)(pj,"AddinDetailsManager1",null,[1361,1362]);class Jj{constructor(e,t=null){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=e.solutionId;this.version=e.version;this.storeType=e.storeType;this.storeId=e.storeId;this.assetId=
e.assetId;this.assetStoreId=e.assetStoreId;this.displayName=e.displayName;this.provider=e.provider;this.description=e.description;this.targetType=e.targetType;this.height=e.height;this.width=e.width;this.iconUrl=e.iconUrl;this.webApplicationId=e.webApplicationId;this.highResolutionIconUrl=e.highResolutionIconUrl;this.licenseUrl=e.licenseUrl;this.privacyUrl=e.privacyUrl;this.addinInfo=t}aAc(){const e={};e.solutionId=this.solutionId;e.version=this.version;e.storeType=this.storeType;e.storeId=this.storeId;
e.assetId=this.assetId;e.assetStoreId=this.assetStoreId;e.targetType=this.targetType;e.displayName=this.displayName;e.width=this.width;e.height=this.height;return e}}Object(y.a)(Jj,"AddinDetail",null,[]);class Uo{constructor(e,t,E,W,ha){this.gNd=null;this.Ga=e;this.tk=t;this.WGb=E;this.UJk=W;this.Chb=ha}NP(e,t){this.au.queryAppDetails(this.UJk,this.Chb,this.solutionIds,e,(E,W)=>{let ha=null;if(W){ha=Array(W.length);for(let Ka=0;Ka<W.length;Ka++)ha[Ka]=new Jj(W[Ka],this.yGn(W[Ka].solutionId))}t(E,
ha||[])})}get Fjn(){return!!this.au.queryAppDetails}yGn(e){return this.WGb.J(e)}get solutionIds(){if(!this.gNd){this.gNd=new fa.a;for(const e of this.WGb.keys)this.gNd.add(ee.d(e))}return this.gNd.toArray()}get au(){return this.tk.value}}Object(y.a)(Uo,"AddinDetailsLoader",null,[]);class Sn{constructor(e,t=0){this.Zj=null;this.rra=e;this.errorCode=t}}Object(y.a)(Sn,"AddinQueryResult",null,[]);class Vo extends Sn{constructor(e,t=0){super(e,t);this.SFg=this.solutionIds=null}}Object(y.a)(Vo,"AddinCollection",
Sn,[]);var Tn=d(1306);class Qm extends Tn.a{constructor(){super(oi.a.th())}}Object(y.a)(Qm,"AddinDetailTable",Tn.a,[]);var Bn;(function(e){e[e.stop=-1]="stop";e[e.skip=0]="skip";e[e.query=1]="query"})(Bn||(Bn={}));Object(y.b)("QueryStrategy",Bn);class Am{constructor(e,t,E=null){this.sa=new ua.a;this.uC=new hk.a(oi.a.th());this.ns=new vb.a;this.kea=new vb.a;this.WGb=this.fMe=null;this.Qvb=(W,ha,Ka)=>{Ka?(Am.qcd(W,Ka,window.performance.now()-ha),0===Ka.errorCode?(ha=Ka.value?Am.T5k(Ka.value):[],this.YL(new Sn(W),
ha)):-1===Ka.errorCode||10===Ka.errorCode?this.YL(new Sn(W),[]):(W=this.Gmf(W,ha,Ka),this.YL(W))):(W=Am.Hmf(W,ha),this.YL(W))};this.MMa=(W,ha)=>{if(0!==ha.errorCode&&5!==ha.errorCode)this.T5j(ha.LO,Object.assign(new Vo(ha.LO,ha.errorCode),{Zj:ha.Zj}));else{W=Object.assign(new Vo(ha.LO,ha.errorCode),{solutionIds:new fa.a,SFg:new fa.a});var Ka=ha.pF;for(const dc of Ka){Ka=dc.solutionId;const xc=dc.storeId;if(this.uC.mb(Ka)){var sb=this.uC.J(Ka);sb.mb(xc)?sb.Z(xc,this.ydd(sb.J(xc),ha.LO,dc)):sb.add(xc,
dc)}else sb=new Qm,sb.add(xc,dc),this.uC.add(Ka,sb);W.solutionIds.add(Ka);W.SFg.add(xc)}this.T5j(ha.LO,W)}};this.tqa=new Yc.a;this.tqa.add(OSF.StoreTypeEnum.MarketPlace,0);this.tqa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ga=e;this.tk=t;this.Qu=E;this.eJc=Am.D3c(e,"https://store-images.s-microsoft.com");this.R4e=null;this.cmb(this.MMa)}get sUd(){if(!this.fMe){const e=JSON.parse(this.Hcb);this.Pic(e);this.fMe=e}return this.fMe}get epg(){return!!this.Ga&&this.Ga.isChangeGateEnabled("QueryPopularForOmexOnlyEnabled")}get tR(){return!!this.Ga&&
this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get isAnonymousUser(){return!!this.Ga&&this.Ga.$("IsAnonymousUser")}get REf(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get l1c(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get qKa(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get au(){return this.tk.value}get tlg(){this.R4e||(this.R4e=new Uo(this.Ga,this.tk,this.Wbo,0,this.au.getAppUILocale()));return this.R4e}fX(e){if(this.tR&&!this.L$a(e))return new Oj(0);if(!this.ILa(e))return e=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Zh[e]}),Object.assign(new Oj(1),{Zj:e});const t=this.ns.J(e);if(t.Zj)return Object.assign(new Oj(t.errorCode),{Zj:t.Zj});z.ULS.shipAssertTag(509870082,220,!!t.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
e);const E=new Oj(t.errorCode);for(let W=0;W<t.solutionIds.count;W++){const ha=t.solutionIds.J(W),Ka=t.SFg.J(W);if(this.uC.mb(ha)){const sb=this.uC.J(ha);sb.mb(Ka)?Array.add(E.pF,sb.J(Ka)):z.ULS.sendTraceTag(508610437,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",ha,e,Ka)}else z.ULS.sendTraceTag(508610436,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",ha,e)}return E}P8a(e,t=null){if(e=this.wgm(e))if(t||
(t=this.uiCulture),e.mb(t))return e.J(t);return null}wgm(e){return this.uC.mb(e)?this.uC.J(e):null}MNa(e){if(e){this.cmb(e);for(const t of this.ns.keys){if(this.tR&&!this.L$a(t))continue;if(!this.ILa(t)||this.ns.J(t).Zj)continue;z.ULS.shipAssertTag(509870081,220,!!this.ns.J(t).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",t);const E=[],W=this.ns.J(t);for(const ha of W.solutionIds)Array.add(E,this.uC.J(ha));e(null,new Rl(t,W.errorCode,E,W.Zj))}}}get name(){return"AddinDetailsManager2"}gZb(e,
t){if(this.tR&&Am.Mtb(e)){var E=ha=>{this.YL(Am.bLb(ha,4,"The connected service is disabled."));this.KNa(ha,-1)},W=ha=>{this.YL(Am.bLb(ha,0,"The user doesn't have any addin installed."),[]);this.KNa(ha,0)};0===e?(this.I7c(0,t,E,W),this.I7c(2,t,E,()=>{this.xYb(this.Qvb,this.sUd)})):10===e&&this.KNa(1,1)}}NP(e,t=!1){Am.Mtb(e)?this.Mid(e,this.Qvb,t):z.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",zb[e])}cmb(e){this.sa.addHandler(nc.a.Vcc,e)}I7c(e,t,E,W){this.L$a(e)||
(3===t&&E?E(e):2===t&&W?W(e):this.KNa(e,1))}L$a(e){return this.kea.mb(e)}KNa(e,t){if(this.tR){var E=this.L$a(e);if(!E||-1!==this.kea.J(e)&&this.kea.J(e)!==t)z.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",Zh[e],E?Bn[this.kea.J(e)]:"undefined",Bn[t]),this.kea.Z(e,t)}}Gmf(e,t,E){const W={};W.collectionType=Zh[e];W.invokeResultCode=E.errorCode;W["queryResult.Value"]=E.value?String.format("Length: {0}",E.value.length):"null";W.queryStart=t;W.queryDuration=
window.performance.now()-t;return Object.assign(new Sn(e,3),{Zj:Error.create("QueryAddinDetails hit an invocation failure",W)})}CCg(e){if(this.epg&&e!==OSF.StoreTypeEnum.MarketPlace)return!1;if(this.vpd(2)){if(!this.ILa(2))return!0;if(this.Ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins"))return 3===this.ns.J(2).errorCode}return!1}vpd(e){return this.tR&&this.kea.mb(e)?1===this.kea.J(e):!0}Mid(e,t,E=!1){z.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",
e);if(e!==OSF.StoreTypeEnum.MarketPlace&&e!==OSF.StoreTypeEnum.PrivateCatalog)z.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",e);else{var W=this.tqa.J(e);this.CCg(e)&&this.xYb(t,this.Tdo);this.vpd(W)&&(this.l1c&&this.isAnonymousUser?(e=Am.xmf(W),this.YL(e)):this.hog(e,t,E))}}get Tdo(){return this.ns.mb(2)?null:this.sUd}hog(e,t,E){this.queryStoreDisabled(e,(W,ha)=>{if(W===OSF.StoreTypeEnum.MarketPlace&&ha)ha=Am.dLb(0),this.YL(ha);else if(W===OSF.StoreTypeEnum.PrivateCatalog&&ha)ha=
Am.dLb(1),this.YL(ha);else{var Ka=window.performance.now();this.au.getEntitlementDetails(Object.assign(new Fn,{storeType:W,refresh:E}),sb=>{t(this.tqa.J(W),Ka,sb)})}})}xYb(e=null,t=null){null===e&&(e=this.Qvb);this.queryStoreDisabled(0,(E,W)=>{W?(E=Am.dLb(2),this.YL(E)):null!=t?this.YL(new Sn(2,5),t):this.gko(e)})}YL(e,t=null){0!==e.errorCode&&5!==e.errorCode?(z.ULS.shipAssertTag(509116673,220,!t,"The parameter addinDetails must be null for any failed queries"),z.ULS.shipAssertTag(509116672,220,!!e.Zj,
"The result.Failure must not be available for any failed queries"),this.uCg(e)?z.ULS.sendTraceTag(510253056,220,10,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",Zh[e.rra],uk[e.errorCode],e.Zj?e.Zj.toString():"null",JSON.stringify(e.Zj)):z.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",Zh[e.rra],uk[e.errorCode],e.Zj?e.Zj.toString():
"null",JSON.stringify(e.Zj))):(z.ULS.shipAssertTag(509116643,220,!!t,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",Zh[e.rra]),z.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails, errorCode: {2}",Zh[e.rra],t?t.length:-1,uk[e.errorCode]));e=new Rl(e.rra,e.errorCode,t,e.Zj);this.sa.raiseEvent(nc.a.Vcc,e)}uCg(e){return 3===e.errorCode&&(this.l1c&&-2147208619===Am.H3c(e)||this.REf&&
-2===Am.H3c(e))||4===e.errorCode?!1:2!==e.errorCode}T5j(e,t){this.ns.Z(e,t);this.KNa(e,1)}ILa(e){return this.ns.mb(e)?!!this.uC:!1}get uiCulture(){return this.Qu&&this.Qu.UICulture?this.Qu.UICulture:v.AFrameworkApplication.uiCulture}get DTc(){return this.Qu?!this.Qu.AreThirdPartyAddInsAllowed||this.Qu.AppsForOfficeThirdPartyIsDisabled:!this.Ga.$("AreThirdPartyAddInsAllowed")||this.Ga.$("AppsForOfficeThirdPartyIsDisabled")}get Y9c(){return this.Qu?!this.Qu.AppsForOfficeAllowExternalMarketplace:!this.Ga.$("AppsForOfficeAllowExternalMarketplace")}get Wbo(){if(!this.WGb){this.WGb=
new hk.a(oi.a.th());const e=JSON.parse(this.Hcb);for(const t of e)this.WGb.add(t.solutionId,t.addinInfo)}return this.WGb}get Hcb(){return this.Qu?this.Qu.PopularAddinDetailsJsonString:this.Ga.kb("PopularAddinDetailsJsonString")}queryStoreDisabled(e,t){if(this.DTc)t(e,!0);else if(e===OSF.StoreTypeEnum.MarketPlace&&this.Y9c)t(e,!0);else{const E=Am.asd(e);if(E){const W=window.performance.now();this.au.queryStoreDisabled(E,ha=>{z.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
e,ha,W,window.performance.now()-W);t(e,ha)})}else t(e,!1)}}ydd(e,t,E){return e?E?2===t?Am.Oub(E,e):Am.Oub(e,E):e:E}gko(e){const t=window.performance.now();if(this.tlg&&this.tlg.Fjn)this.tlg.NP(!1,(W,ha)=>{this.sdc(ha);e(2,t,Am.fec(W,ha))});else{var E=JSON.parse(this.Hcb);this.Pic(E);e(2,t,Am.fec(0,E))}}Pic(e){Am.qTc(e);this.sdc(e);this.$0c(e)}sdc(e){const t=this.yUc();for(var E=0;E<e.length&&0<t.count;E++){const W=e[E];if(t.mb(W.solutionId)){let ha=String.format("Found an override, solutionId: {0}",
W.solutionId);const Ka=t.J(W.solutionId);Ka&&(isNaN(Ka.addinInfo.priority)||(ha=String.format("{0}; AddinInfo.Priority: update {1} to {2}",ha,W.addinInfo.priority,Ka.addinInfo.priority),W.addinInfo.priority=Ka.addinInfo.priority),isNaN(Ka.addinInfo.AUP)||(ha=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ha,W.addinInfo.AUP,Ka.addinInfo.AUP),W.addinInfo.AUP=Ka.addinInfo.AUP),Ka.displayName&&(ha=String.format("{0}; DisplayName: update {1} to {2}",ha,W.displayName,Ka.displayName),W.displayName=
Ka.displayName),Ka.iconUrl&&(ha=String.format("{0}; IconUrl: update {1} to {2}",ha,W.iconUrl,Ka.iconUrl),W.iconUrl=Ka.iconUrl),Ka.description&&(ha=String.format("{0}; Description: update {1} to {2}",ha,W.description,Ka.description),W.description=Ka.description));t.remove(W.solutionId);this.qKa&&z.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",ha)}}for(const W of t.keys)E=t.J(W),E.displayName&&E.iconUrl&&E.addinInfo&&(e.push(E),this.qKa&&z.ULS.sendTraceTag(509379107,
220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(E)))}yUc(){const e=new hk.a(oi.a.th());let t=this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!t)return e;t=t.trim();if(12>=t.length)return 0<t.length&&z.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",t),e;this.qKa&&z.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",
t);try{const E=[],W=t.split("|");for(let ha=W.length-1;0<=ha;ha--){const Ka=W[ha],sb=Ka.split("\\");if(2>sb.length){E.push(Ka);continue}const dc=Am.bhd(sb);dc?e.mb(dc.solutionId)||e.add(dc.solutionId,dc):E.push(Ka)}this.qKa&&0<E.length&&z.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",E.join("|"));this.qKa&&0<e.count&&z.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",e.count,JSON.stringify(em.toArray(e.values)));
return e}catch(E){z.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",t,E.toString())}return e}$0c(e){for(let t=0;t<e.length;t++)ee.c(e[t].iconUrl.toLowerCase(),"http",0)||(e[t].iconUrl=String.format("{0}/image/apps.{1}",this.eJc,e[t].iconUrl))}static Mtb(e){return 0===e||10===e}static Hmf(e,t){const E={};E.collectionType=Zh[e];E.queryResult="null";E.queryStart=t;E.queryDuration=window.performance.now()-t;return Object.assign(new Sn(e,
3),{Zj:Error.create("QueryAddinDetails hit an invocation failure",E)})}static bLb(e,t,E){const W={};W.collectionType=Zh[e];e=new Sn(e,t);0!==t&&(e.Zj=Error.create(E,W));return e}static dLb(e){return Am.bLb(e,2,"The store is disabled.")}static xmf(e){const t={};t.collectionType=Zh[e];t.invokeResultCode=-2147208619;t.queryDuration=0;return Object.assign(new Sn(e,3),{Zj:Error.create("Anonymous users do not have installed add-ins.",t)})}static H3c(e){return e.Zj?e.Zj.invokeResultCode:-1E3}static qcd(e,
t,E){const W={};W.AddinCollectionType=Zh[e];W.ErrorCode=t.errorCode;W.AddinCount=t.value?t.value.length:0;z.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",E,JSON.stringify(W))}static fec(e,t){const E={};E.errorCode=e;E.value=t;return E}static asd(e){return e===OSF.StoreTypeEnum.MarketPlace?"omex":e===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static Oub(e,t){t.solutionId=t.solutionId||e.solutionId;t.version=t.version||e.version;
t.storeType=t.storeType||e.storeType;t.storeId=t.storeId||e.storeId;t.assetId=t.assetId||e.assetId;t.assetStoreId=t.assetStoreId||e.assetStoreId;t.displayName=t.displayName||e.displayName;t.provider=t.provider||e.provider;t.description=t.description||e.description;t.iconUrl=t.iconUrl||e.iconUrl;t.webApplicationId=t.webApplicationId||e.webApplicationId;t.highResolutionIconUrl=t.highResolutionIconUrl||e.highResolutionIconUrl;t.licenseUrl=t.licenseUrl||e.licenseUrl;t.privacyUrl=t.privacyUrl||e.privacyUrl;
t.addinInfo=t.addinInfo||e.addinInfo;isNaN(t.targetType)&&(t.targetType=e.targetType);isNaN(t.height)&&(t.height=e.height);isNaN(t.width)&&(t.width=e.width);return t}static T5k(e){const t=Array(e.length);for(let E=0;E<t.length;E++)t[E]=new Jj(e[E],e[E].addinInfo);return t}static qTc(e){for(const t of e)isNaN(t.targetType)&&(t.targetType=1),t.assetId=t.assetId||t.solutionId,t.storeId=t.storeId||"en-US",t.storeType=t.storeType||"omex",t.assetStoreId=t.assetStoreId||"omex",isNaN(t.width)&&(t.width=0),
isNaN(t.height)&&(t.height=0)}static bhd(e){const t={};let E=0;E<e.length&&0<e[E].trim().length&&e[E].trim().toLowerCase().startsWith("wa")&&(t.solutionId=e[E].trim(),t.addinInfo=Object.assign(new km,{priority:Number.NaN,AUP:Number.NaN}),++E<e.length&&0<e[E].trim().length&&(t.addinInfo.priority=parseInt(e[E].trim())),++E<e.length&&0<e[E].trim().length&&(t.addinInfo.AUP=parseInt(e[E].trim())),++E<e.length&&0<e[E].trim().length&&(t.displayName=e[E].trim()),++E<e.length&&0<e[E].trim().length&&(t.iconUrl=
e[E].trim()),++E<e.length&&0<e[E].trim().length&&(t.description=e[E].trim()));return t.solutionId?t:null}static D3c(e,t){e=e.kb("AddinImageStoreServiceUrl");if(!e)return t;e=e.toLowerCase();return e.startsWith("http://")||e.startsWith("https://")?e:t}}Object(y.a)(Am,"AddinDetailsManager2",null,[1360]);class Mo{constructor(e,t){this.fuc="popular";this.IQh="addinDetails";this.CZh="cache-lastUpdate";this.yYh="builtin-lastUpdate";this.Mtj=144E5;this.Ga=this.oda=null;this.QTn=(E,W)=>{2===W.LO&&0===W.errorCode&&
(this.enf=W.pF,this.AUd=this.now,z.ULS.sendTraceTag(508352221,220,50,"AddinDetailsCacheManager.onAddinDetailsUpdated: cached popular addins were refreshed."))};this.oda=t;this.Ga=e;this.oda.MNa(this.QTn);this.Mtj=this.Ga.getIntFeatureGate("Microsoft.Office.SharedOnline.PopularCacheExpirationTime",144E5)}get Kon(){return this.AUd?this.now.getTime()-this.AUd.getTime()>=this.Mtj:!0}fX(e){var t=this.oda.fX(e);2===e&&this.Jon(t.errorCode)&&(e=this.enf,null!=e?(this.Kon&&this.oda.xYb(null,null),t=this.toDateString(this.now),
t=this.toDateString(this.Nmf)===t?this.umf(5,this.oda.sUd):this.umf(0,e)):(Mo.e$a&&(t=this.umf(5,this.oda.sUd)),this.Nmf=this.now,this.oda.xYb(null,null)));return t}umf(e,t){return Object.assign(new Oj(e),{pF:t,Zj:null})}toDateString(e){return e.toISOString().substring(2,16)}get Nmf(){const e=Mo.e2b(this.fuc,this.yYh);return null!==e?new Date(e):new Date(0)}set Nmf(e){Mo.dAb(this.fuc,e.toISOString(),this.yYh)}get AUd(){const e=Mo.e2b(this.fuc,this.CZh);return null!==e?new Date(e):new Date(0)}set AUd(e){Mo.dAb(this.fuc,
e.toISOString(),this.CZh)}get enf(){const e=Mo.e2b(this.fuc,this.IQh);let t=null;e&&(t=JSON.parse(e));return t}set enf(e){e=JSON.stringify(e);Mo.dAb(this.fuc,e,this.IQh)}get now(){return new Date}Jon(e){return 2!==e&&4!==e}P8a(e,t=null){return this.oda.P8a(e,t)}MNa(e){this.oda.MNa(e)}get name(){return"AddinDetailsCacheManager"}gZb(e,t){this.oda.gZb(e,t)}NP(e,t=!1){this.oda.NP(e,t)}static e2b(e,t){let E=null;try{const W=Mo.s0j;if(void 0!==W&&W){const ha=nc.a.d5d(e)+"_"+t;E=W.getItem(ha)}else z.ULS.sendTraceTag(508352219,
220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(W){z.ULS.sendTraceTag(508352218,220,10,"Failed to get AddinCommands Cache {0} for suffix {1}.",e,t)}return E}static dAb(e,t,E){try{const W=Mo.s0j;if(void 0!==W&&W){const ha=nc.a.d5d(e)+"_"+E;W.setItem(ha,t)}else z.ULS.sendTraceTag(508352217,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(W){z.ULS.sendTraceTag(508352216,220,10,"Failed to set AddinCommands Cache {0} for suffix {1}.",e,E)}}static get s0j(){if(!Mo.e$a)return null;
let e=null;try{e=localStorage}catch(t){Mo.e$a=!1,e=null,z.ULS.sendTraceTag(508352215,220,10,`Failed to use localStorage: error name: ${t.name}; message: ${t.message}; stack: ${t.stack}`)}return e}}Mo.e$a=!0;Object(y.a)(Mo,"AddinDetailsCacheManager",null,[1361]);class lr{static createInstance(e,t,E=null){e=lr.Moc(e)?lr.ehf(e)?new Mo(e,new Am(e,t,E)):new pj(e,t,E):new dn(e,t,E);z.ULS.sendTraceTag(508352212,220,50,`AddinDetailsManagerFactory.CreateInstance: Creating an instance of ${e.name}`);return e}static Moc(e){return(e||
v.AFrameworkApplication.K).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}static ehf(e){return(e||v.AFrameworkApplication.K).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}}Object(y.a)(lr,"AddinDetailsManagerFactory",null,[]);class Gn{constructor(e){this.h8e=e}next(e){this.h8e=(9301*this.h8e+49297)%233280;return Math.floor(this.h8e/233280*e)}}Object(y.a)(Gn,"Random",null,[]);var vn=d(1803),Vq=d(683);class ho{constructor(){this.InsertionPoint=
this.GalleryButtons=this.Title=this.SectionId=null}}Object(y.a)(ho,"GallerySectionProps",null,[]);var Er=d(1963);class Ki{constructor(){this.text=this.href=null}}Object(y.a)(Ki,"LinkProps",null,[]);var Bs=d(1804),Wo=d(150);class If{constructor(e,t){this.tFh=!0;this.mPk=e;this.nPk=t}n6i(){null==de.a.instance.getItem("AddinEntryPointSurveyShowed")&&this.tFh&&(this.tFh=!1,window.setTimeout(()=>{this.nHh=ob.a.instance.Qa("Common.ISystemInitiatedFeedback");null!=this.nHh&&this.nHh.execute(e=>{const t=
this.atm();this.zim()||t&&(!t||"hidden"!==t.visibility)||(e.O_a(this.mPk,null),de.a.instance.setItem("AddinEntryPointSurveyShowed","1"))})},this.nPk))}atm(){let e=null;try{const t=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");t&&(e=Wo.a.WB(t.parentNode.parentNode.parentNode))}catch(t){z.ULS.sendTraceTag(508343957,220,10,"AddinFlyout get parent and parent get exception "+(t?t.toString():""))}return e}zim(){let e=null;try{e=document.getElementById("BackstageGetAddIns")}catch(t){z.ULS.sendTraceTag(508343956,
220,10,"Backstage get parent and parent get exception "+(t?t.toString():""))}return e}}Object(y.a)(If,"FpsHelper",null,[]);class Wq{constructor(e,t,E,W,ha,Ka=null,sb=null){this.CTe={};this.IDk={};this.nCd={};this.fgh=this.vjh=0;this.gCd=null;this.Yvk=6E4;this.MMa=(dc,xc)=>{this.Yla?this.muo(xc):(this.lkd(xc),this.i4b&&this.i4b.MMa(dc,xc))};this.x1a=t;this.k4a=null;this.XCk=E;this.ZCk=W;this.kMk=ha;this.i4b=sb;this.Ga=Ka||v.AFrameworkApplication.K;this.x1a.MNa(this.MMa);appChrome.addInApi.loadOfficeAddInIcons()}get vsf(){return this.nCd}lkd(e){if(e.pF)for(let t=
0;t<e.pF.length;t++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+e.pF[t].solutionId,e.pF[t].iconUrl);else 0===e.errorCode&&z.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get IUl(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get Yla(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",
!1)}s1h(){if(this.AWh)return!0;let e=this.x1a.fX(0);if(1!==e.errorCode)return!0;e=this.x1a.fX(1);return 1!==e.errorCode}Pao(e){const t=[];var E=new Gn((new Date).getDate());for(var W=0;30>W;W++)Array.add(t,E.next(e.count));E=0;for(const ha of e){W=!1;for(const Ka of t)if(E===Ka){W=!0;break}E++;if(W){let Ka;(Ka=ha.addinInfo).AUP=20*Ka.AUP}else if(1===ha.addinInfo.priority){let Ka;(Ka=ha.addinInfo).AUP=4*Ka.AUP}else if(2===ha.addinInfo.priority){let Ka;(Ka=ha.addinInfo).AUP=2*Ka.AUP}}e.Sc((ha,Ka)=>
ha.addinInfo.AUP<Ka.addinInfo.AUP?1:-1);return e}Rtm(){const e={},t={},E={};t.root={margin:"0px","margin-left":"12px",width:"100%",maxWidth:"unset"};t.inner={margin:"-4px","margin-left":"18px"};E.root={width:100,height:100,backgroundColor:"transparent"};E.flexContainer={flexDirection:"column"};E.label={"margin-top":"4px","max-width":"86px","font-size":"12px","text-overflow":"ellipsis"};e.galleryButtonInExpanded=E;e.galleryStack=t;return e}gfm(){return Object.assign(new Er.a,{Id:"AddinFlyoutMoreButton",
ExternalId:"AddinFlyoutMoreButton",Icon:"AllApps_16",Command:this.kMk,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid var(--border-color, #c8c8c8)","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Role:"menuitem",Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}Lem(e,t,E){const W={},ha={width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",
padding:"7px",border:"1px solid var(--border-color, #c8c8c8)"};v.AFrameworkApplication.isRtl&&(ha.direction="ltr");W.root=ha;return Object.assign(new Er.a,{Id:E,ExternalId:E,Icon:"AddinFlyoutControl"+t.solutionId,Command:e===CommonUIStrings.l_PopularAddins?this.XCk:this.ZCk,LabelText:t.displayName,Role:"menuitem",FullIconStyle:W,Alt:t.description})}pco(e,t,E){const W=Object.assign(new ho,{SectionId:e,GalleryButtons:[]});for(let ha=0;ha<E;ha++)Array.add(W.GalleryButtons,this.Lem(e,t[ha],this.CTe[t[ha].solutionId]));
return W}zHm(){var e=[];const t=this.x1a.fX(0);Array.addRange(e,t.pF);const E=this.x1a.fX(1);Array.addRange(e,E.pF);let W=e.length;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&z.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",W,uk[t.errorCode],t.pF.length,uk[E.errorCode],E.pF.length);e.sort((Rc,md)=>{Rc=ee.d(Rc.displayName);md=ee.d(md.displayName);return Qd.a.localeCompare(Rc,
md)});const ha=3<W;ha&&(W=2);for(var Ka=0;Ka<W;Ka++)this.YXh(e[Ka]);let sb=[];Ka=null;!this.Yla&&this.k4a?sb=this.k4a:(Ka=this.x1a.fX(2),0!==Ka.errorCode&&5!==Ka.errorCode||Ka.pF.forEach(Rc=>{-1!==Rc.addinInfo.priority&&(this.YXh(Rc),sb.push(Rc))}));let dc=!0;sb.length||(dc=!1);dc&&(sb=this.Yla?this.EOm(sb,e):this.D8k(sb,e),this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyEnabled",!1)&&(this.gCd=new If("AddinFlyoutFeedbackSurvey",this.Ga.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutSurveyTriggerTime",
this.Yvk)),this.gCd.n6i()));Ka=Object.assign(new Ca.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});const xc=Object.assign(new We.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});Array.add(Ka.ControlList,xc);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));Ka=Object.assign(new Re.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],
MenuFooterSection:Ka,UpdateDynamically:!0,IsFlexLayout:!0});2!==t.errorCode||e.length?3===t.errorCode&&3===E.errorCode?(z.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),e=this.mGf("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(Ka.MenuSectionList,e)):this.IUl&&4===t.errorCode&&!e.length?(z.ULS.sendTraceTag(508598107,220,10,"dataProvider disconnecteddisabled error hit"),e=this.mGf("StoreDisabled",CommonUIStrings.l_AddinPickerServiceDisconnectedError),Array.add(Ka.MenuSectionList,
e)):(0<W&&this.gDl(Ka,e,W,ha),dc&&(this.fgh=30<sb.length?30:sb.length,Array.add(Ka.MenuSectionList,this.afm(sb,this.fgh)))):(z.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),e=this.mGf("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(Ka.MenuSectionList,e));this.Bpl();0===Ka.MenuSectionList.length&&(Ka.IsFlexLayout=!1,z.ULS.sendTraceTag(508340124,220,15,"The menu section list length is 0"));return Ka}ppl(){const e=[],t=this.x1a.fX(0);Array.addRange(e,t.pF);const E=this.x1a.fX(1);
Array.addRange(e,E.pF);if(2!==t.errorCode||e.length){if(3===t.errorCode&&3===E.errorCode)return z.ULS.sendTraceTag(508360459,220,10,"dataProvider invoke error hit, launch survey fail."),!1;if(4===t.errorCode&&!e.length)return z.ULS.sendTraceTag(508360458,220,10,"dataProvider disconnecteddisabled error hit, launch survey fail."),!1}else return z.ULS.sendTraceTag(508360460,220,10,"store disabled hit, launch survey fail."),!1;return!0}Bpl(){window.setTimeout(()=>{var e=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");
e&&e.firstChild&&e.firstChild.firstChild&&e.firstChild.firstChild.firstChild&&(e=e.firstChild.firstChild.firstChild.scrollTop,0<e&&(e={["scrollTopValue"]:e.toString()},cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.ScrollableListView",dataFields:Sb.a.fI(e)}))))},6E4)}afm(e,t){const E=Object.assign(new Ca.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[],Title:CommonUIStrings.l_PopularAddins});for(let W=0;W<0+t&&W<e.length;W++)this.IDk.PopularAddInsListItem0=
e[W].solutionId,this.qem(E.ControlList,W.toString(),e[W]);return E}qem(e,t,E){t=this.Ztf("PopularAddInsListItem",t,E);Array.add(e,t)}Ztf(e,t,E){const W=[];var ha=Object.assign(new Ki,{text:CommonUIStrings.l_AddinOneLink,href:"https://appsource.microsoft.com/en-us/product/office/"+E.solutionId});Array.add(W,ha);ha={};ha["default"]="AddinFlyoutControl"+E.solutionId;const Ka=this.H1c(E);return Object.assign(new Bs.a,{Id:e+t,ExternalId:e+t,CommandId:e+t,CommandIdMapped:"1497204054",iconSet:ha,SecondaryLabel:null,
Details:null,Label:E.displayName,ActionText:CommonUIStrings.l_AddinListAdd,Description:E.description,Links:W,ActionId:e+"Add"+t,ActionIdMapped:"2882601901",ActionCommandValueId:Ka,CommandValueId:Ka})}H1c(e){return this.Yla?String.format("{0}#{1}",e.solutionId,e.storeId):e.solutionId}e5d(e){if(!e)return null;var t=e.split("#");if(1!==t.length&&2!==t.length)return z.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;e=t[0].trim();t=2===t.length?t[1].trim():
v.AFrameworkApplication.uiCulture;return this.x1a.P8a(e,t)}YXh(e){if(!(e.solutionId in this.CTe)){const t="AddinGalleryButton"+this.vjh.toString();this.CTe[e.solutionId]=t;e=this.H1c(e);this.nCd[t]=e;this.nCd[t+"Add"]=e;this.vjh++}}cKi(e){return e?this.nCd[e]:null}mGf(e,t){const E=Object.assign(new Ca.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});e=Object.assign(new vn.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:e,Label:t,RetryButtonTitle:"",OnRetryCommandId:"ReloadAddInPicker",
AriaDescription:"StoreDisabled"===e?t:CommonUIStrings.l_AddinPickerTryAgainAriaLabel});Array.add(E.ControlList,e);return E}D8k(e,t){var E=new fa.a;for(let W=0;W<e.length;W++)E.add(e[W]);this.k4a||(30<E.count&&(E=this.Pao(E)),this.k4a=E.toArray());for(e=0;e<this.k4a.length;e++)for(E=0;E<t.length;E++)if(this.k4a[e].solutionId.toLowerCase()===t[E].solutionId.toLowerCase()){Array.remove(this.k4a,this.k4a[e--]);break}return this.k4a}RFm(e){var t=30,E=(new Date).getDate();t>e.length&&(t=e.length);var W=
new Gn(E);for(E=new Set;E.size<t;){const ha=W.next(e.length);E.add(ha)}for(t=0;t<e.length;t++)W=e[t].addinInfo,E.has(t)?W.AUP*=20:W.AUP=1===W.priority?4*W.AUP:2===W.priority?2*W.AUP:1*W.AUP;e.sort((ha,Ka)=>ha.addinInfo.AUP<Ka.addinInfo.AUP?1:-1);return e}EOm(e,t){e=e.filter(E=>!t.some(W=>W.solutionId.toLowerCase()===E.solutionId.toLowerCase()));return this.RFm(e).slice(0,30)}muo(e){if(0===e.errorCode||2===e.LO&&5===e.errorCode)e.pF?this.luo(e.pF):z.ULS.sendTraceTag(509687429,220,10,`fail to register icons for addin collection: ${Zh[e.LO]}`)}luo(e){var t,
E,W,ha;for(let Ka=0;Ka<e.length;Ka++)e[Ka]&&e[Ka].solutionId&&e[Ka].iconUrl?appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+e[Ka].solutionId,e[Ka].iconUrl):z.ULS.sendTraceTag(508352214,220,10,"failed to register icon for addin: solutionId: {1}, iconUrl: {2}",null!==(E=null===(t=e[Ka])||void 0===t?void 0:t.solutionId)&&void 0!==E?E:"null",null!==(ha=null===(W=e[Ka])||void 0===W?void 0:W.iconUrl)&&void 0!==ha?ha:"null")}gDl(e,t,E,W=!1){var ha=CommonUIStrings.l_MyAddinSection;const Ka=Object.assign(new Ca.a,
{Id:"MRUAddinsSection",ControlsId:"MRUAddinsSection.Controls",ControlList:[],Title:ha}),sb=Object.assign(new Vq.a,{Id:"MRUAddinsGalleryControl",ExternalId:"MRUAddinsGalleryControl",GalleryStyle:this.Rtm(),Width:3,Type:4,GallerySections:[]});Array.add(e.MenuSectionList,Ka);Array.add(Ka.ControlList,sb);e=this.pco(ha,t,E);W&&Array.add(e.GalleryButtons,this.gfm());sb.GallerySections.push(e)}wco(e){if(e)try{e.MenuItems=this.zHm()}catch(t){z.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+
(t?t.toString():""))}else z.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}get AWh(){return"Dev Box"===v.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")}}Object(y.a)(Wq,"AppsFlyoutGenerator",null,[13]);var Mn=d(892);class Rk{}Rk.solutionId="solutionId";Rk.version="version";Rk.storeType="storeType";Rk.storeId="storeId";Rk.assetId="assetId";Rk.assetStoreId="assetStoreId";Rk.displayName="displayName";Rk.targetType="targetType";Rk.isAddinCommands="isAddinCommands";
Rk.height="height";Rk.width="width";Rk.sharedRuntimeId="sharedRuntimeId";Rk.backgroundState="backgroundState";Object(y.a)(Rk,"InsertAgaveParametersConstantsString",null,[]);var qo=d(1784),vj=d(1026);class Cp extends vj.a{constructor(e){super("TextAboveImage");this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=e.paragraphs;this.image=e.image;this.imageWidth=e.imageWidth;this.imageHeight=e.imageHeight}}Object(y.a)(Cp,"TextAboveImage",vj.a,[]);class fp{constructor(e,t){this.imageHeight=
this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=e;this.image=t}}Object(y.a)(fp,"TextAboveImageCustomProps",null,[]);var Zp=d(1847);class Bm{constructor(){this.xgd=null;this.wqj=()=>{const e=new kh.a(0,1,500,()=>{const t=document.getElementsByName("Add-ins")[0];t&&(t.click(),z.ULS.sendTraceTag(509645900,341,50,"Launch flyout in overflow"));this.xgd.removeEventListener("click",this.wqj,!0)});vh.a.instance.Zb(e)}}vXc(){const e=this;Ya.UISurfaces.kP().then(t=>{Bm.jya&&(t.removeNotification(Bm.jya),
Bm.jya=null);var E="[data-unique-id=Ribbon-InsertAddinTransitionEntry]",W=document.getElementById("InsertAddinTransitionEntry");W&&"none"!==window.getComputedStyle(W,"").display||(E=v.AFrameworkApplication.K.isChangeGateEnabled("ChangeAnchorToHomeWhenOverflow")?"[data-unique-id=Home]":"[data-unique-id=Overflow-RibbonOverflowMenu-overflow]");W=CommonUIStrings.l_BetterEntryPointTUI_Title;var ha=CommonUIStrings.l_BetterEntryPointTUI_Content,Ka=new Zp.a("https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE5elF0");
ha=ha.split("\n");Ka=new fp(ha,Ka);ha=new Cp(Ka);ha.imageWidth=280;ha.imageHeight=192;const sb=new qo.a;sb.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;sb.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;sb.onExecute=()=>{e.FWm();e.GI("ClickOnLaunch")};const dc=new qo.a;dc.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;dc.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;dc.onExecute=()=>{t.removeNotification(Bm.jya);e.GI("ClickOnDismiss")};let xc;
Ka=t.callout((xc=new ub.a,xc.target=E,xc.title=W,xc.content=ha,xc.showCloseIcon=!0,xc.hasDynamicSizing=!1,xc.preventLightDismiss=!1,xc.useTeachingStyles=!0,xc.primaryButtonProps=sb,xc.secondaryButtonProps=dc,xc.calloutProps=Object.assign(new Za.a,{onDismiss:()=>{t.removeNotification(Bm.jya)},setInitialFocus:!0}),xc));let Rc;E=(Rc=new yb.a,Rc.onShow=()=>{e.GI("Show")},Rc);Bm.jya=t.addNotification(Ka,E);return null},t=>{z.ULS.sendTraceTag(509645912,341,15,"Failed to GetNotificationsAPIAsync: {0}",t);
return null})}FWm(){appChrome.api.dispatch(appChrome.actions.setCurrentTab("Home"));const e=new kh.a(0,1,500,()=>{this.qxn()});vh.a.instance.Zb(e)}qxn(){const e=document.getElementById("InsertAddInFlyout");e&&"none"!==window.getComputedStyle(e,"").display?(e.click(),z.ULS.sendTraceTag(509645901,341,50,"Launch flyout in ribbon button")):(this.xgd=document.getElementById("RibbonOverflowMenu-overflow"))?(this.xgd.addEventListener("click",this.wqj,!0),this.xgd.click()):z.ULS.sendTraceTag(509645902,341,
10,"Neither ribbon nor overflow can launch flyout")}GI(e){e={["AppTeachingUICalloutAction"]:e,["AppTeachingUICalloutGoal"]:"BetterEntryPoint_InsertTab"};cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sb.a.fI(e)}))}}Bm.jya=null;Object(y.a)(Bm,"WordBetterEntryTeachingCallout",null,[]);class $p extends bk.a{constructor(e,t,E,W){super();this.Swa="calc(100% - 46px)";this.BQa="15px";this.Twa="0";this.BGc="WACDialogPanel";this.H1=695;this.CGc=
462;this.fZ="80%";this.QDc=350;this.Tgb="100%";this._frame=null;this.Gd=5;this.Qg="AddinInstallDialog";this.z4b=e;this.Axa=t;this.oRk=E;this.DGk=W}gV(){super.gV();this.Nq.style.width=this.Tgb;this.Nq.style.height=this.Swa;this.Nq.style.marginTop=this.BQa;this.Nq.style.padding=this.Twa;document.getElementById(this.Sj("WACDialogButtonPanel")).style.display="none";this.tnb.setAttribute("tabindex","0");$addHandler(this.tnb,"keyup",Object(ib.a)(this,this.fA,"onKeyUp"));const e=document.createElement("iframe");
e.setAttribute("id","InstallAddinDialog");e.setAttribute("src","about:blank");e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("marginHeight","0");e.setAttribute("marginWidth","0");e.setAttribute("frameBorder","0");e.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const t=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.z4b,this.Axa,this.oRk);e.setAttribute("src",
t);this._frame=e;$addHandler(e,"load",Object(ib.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(ib.a)(this,this.onMessage,"onMessage"));this.Nq.appendChild(e);this.Nq.appendChild(this.LFl())}LFl(){const e=document.createElement("div");e.setAttribute("tabindex","0");$addHandler(e,"focus",Object(ib.a)(this,this.SZn,"onLoopPivotFocus"));return e}fA(e){13!==e.keyCode&&32!==e.keyCode||this.hide()}SZn(){this.tnb.focus()}onLoad(){this._frame.focus()}onMessage(e){e=e.rawEvent;if(e.source===
this._frame.contentWindow&&(e=(e=e.data)?e.split("|"):null)&&0<e.length&&("REFRESH_REQUIRED"===e[0]||"PRELOAD_MANIFEST"===e[0])){de.a.instance.setItem("refreshRequired","true");const t={};t.solutionId=e[1];t.version=$p.cRn(e[3]);t.storeType=e[4];t.storeId=e[5];t.assetId=e[6];t.targetType=$p.X9n(e[2]);t.assetStoreId=e[7];t.width=parseInt(e[8]);t.height=parseInt(e[9]);this.DGk(t)}}$ga(){this.Nq.style.width=this.Tgb;this.Nq.style.height=this.Swa;this.Nq.style.marginTop=this.BQa;this.Nq.style.padding=
this.Twa;this.H1>qi.a.rp?(this.Oc.style.width=String.format("{0}px",qi.a.rp),this.Oc.style.overflowX="scroll",v.AFrameworkApplication.isRtl?this.Oc.style.right="0":this.Oc.style.left="0"):(this.Oc.style.width=String.format("{0}px",this.H1),this.Oc.style.overflowX="hidden");this.Oc.offsetHeight>qi.a.qw||this.CGc+50>qi.a.qw?(this.Oc.style.height=String.format("{0}px",qi.a.qw),this.Oc.style.overflowY="scroll",this.Oc.style.top="0",v.AFrameworkApplication.isRtl?this.Oc.style.right="0":this.Oc.style.left=
"0",this.Nq.style.minHeight=String.format("{0}px",this.QDc)):(this.Oc.style.overflowY="hidden",this.Oc.style.top="10%",this.Oc.style.height=this.fZ);this.MIa()}MIa(){if(this.Oc){var e=this.Oc.style.zIndex;this.Oc.style.zIndex="-9999";if(this.H1>qi.a.rp)v.AFrameworkApplication.isRtl?this.Oc.style.marginRight="0":this.Oc.style.marginLeft="0";else{const t=String.format("{0}px",Math.floor(-this.Oc.offsetWidth/2));v.AFrameworkApplication.isRtl?this.Oc.style.marginRight=t:this.Oc.style.marginLeft=t;v.AFrameworkApplication.isRtl?
this.Oc.style.right="50%":this.Oc.style.left="50%"}this.Oc.style.zIndex=String(e)}else z.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}WN(){super.WN();const e=document.getElementById(this.Sj(this.BGc));e.style.width=String.format("{0}px",this.H1);e.style.height=this.fZ}get Cob(){return this.Nq}dispose(){super.dispose();$removeHandler(window,"message",Object(ib.a)(this,this.onMessage,"onMessage"))}static X9n(e){switch(e){case "1":return 0;case "2":return 1;default:return 0}}static cRn(e){const t=
e.split(".");for(let E=0;E<4-t.length;E++)e+=".0";return e}}Object(y.a)($p,"AddinInstallDialog",bk.a,[]);class lh extends bk.a{constructor(){super();this.Swa="calc(100% - 46px)";this.BQa="15px";this.Twa="0";this.BGc="WACDialogPanel";this.H1=695;this.CGc=462;this.fZ="80%";this.QDc=350;this.Tgb="100%";this.Gd=5;this.Qg="AppsForOfficeInsertionDialog";this.FRe=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("OfficeAddinEnableInsertDialogAccessibilityFix")}gV(){super.gV();this.Nq.style.width=
this.Tgb;this.Nq.style.height=this.Swa;this.Nq.style.marginTop=this.BQa;this.Nq.style.padding=this.Twa}$ga(){this.Nq.style.width=this.Tgb;this.Nq.style.height=this.Swa;this.Nq.style.marginTop=this.BQa;this.Nq.style.padding=this.Twa;this.H1>qi.a.rp?(this.Oc.style.width=String.format("{0}px",qi.a.rp),this.Oc.style.overflowX="scroll",v.AFrameworkApplication.isRtl?this.Oc.style.right="0":this.Oc.style.left="0"):(this.Oc.style.width=String.format("{0}px",this.H1),this.Oc.style.overflowX="hidden");this.Oc.offsetHeight>
qi.a.qw||this.CGc+50>qi.a.qw?(this.Oc.style.height=String.format("{0}px",qi.a.qw),this.Oc.style.overflowY="scroll",this.Oc.style.top="0",v.AFrameworkApplication.isRtl?this.Oc.style.right="0":this.Oc.style.left="0",this.FRe||(this.Oc.style.marginTop="-48px"),this.Nq.style.minHeight=String.format("{0}px",this.QDc)):(this.Oc.style.overflowY="hidden",this.Oc.style.top="10%",this.Oc.style.height=this.fZ);this.MIa()}MIa(){if(this.Oc){var e=this.Oc.style.zIndex;this.Oc.style.zIndex="-9999";if(this.H1>qi.a.rp)v.AFrameworkApplication.isRtl?
this.Oc.style.marginRight="0":this.Oc.style.marginLeft="0";else{const t=String.format("{0}px",Math.floor(-this.Oc.offsetWidth/2));v.AFrameworkApplication.isRtl?this.Oc.style.marginRight=t:this.Oc.style.marginLeft=t;v.AFrameworkApplication.isRtl?this.Oc.style.right="50%":this.Oc.style.left="50%"}this.Oc.style.zIndex=String(e)}else z.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}WN(){super.WN();const e=document.getElementById(this.Sj(this.BGc));e.style.width=String.format("{0}px",
this.H1);e.style.height=this.fZ}get Cob(){return this.Nq}}Object(y.a)(lh,"AppsForOfficeInsertionDialog",bk.a,[1355]);var Fr=d(836);class Zi extends bk.a{constructor(e=!0,t=!0,E=null){super();this.Swa="calc(100% - 46px)";this.BQa="15px";this.Twa="0";this.BGc="WACDialogPanel";this.H1=695;this.CGc=462;this.fZ="80%";this.QDc=350;this.Tgb="100%";this.Peh=this.$Dd=null;this.Mtk="auto";this.Ntk="5px";this.Otk="auto";this.Ltk="40px";this.kAd="100px";this.DGc="200px";this.Gd=5;this.Qg="SDXDialog";this.hjb=
e;this.j6c=t;this.bAd=E}gV(){super.gV();this.Nq.style.width=this.Tgb;this.Nq.style.height=this.Swa;this.Nq.style.marginTop=this.BQa;this.Nq.style.padding=this.Twa}$ga(){this.Nq.style.width=this.Tgb;this.Nq.style.height=this.hjb?this.Swa:"100%";this.Nq.style.marginTop=this.hjb?this.BQa:"0px";this.Nq.style.padding=this.Twa;if(this.hjb){this.kAd&&this.DGc&&(this.H1=parseInt(this.DGc.substring(0,this.DGc.length-2)),this.fZ=this.kAd);this.H1>qi.a.rp?(this.Oc.style.width=String.format("{0}px",qi.a.rp),
this.Oc.style.overflowX="scroll",v.AFrameworkApplication.isRtl?this.Oc.style.right="0":this.Oc.style.left="0"):(this.Oc.style.width=String.format("{0}px",this.H1),this.Oc.style.overflowX="hidden");if(this.Oc.offsetHeight>qi.a.qw||this.CGc+50>qi.a.qw)this.Oc.style.height=String.format("{0}px",qi.a.qw),this.Oc.style.overflowY="scroll",this.Oc.style.top="0",v.AFrameworkApplication.isRtl?this.Oc.style.right="0":this.Oc.style.left="0",this.Nq.style.minHeight=String.format("{0}px",this.QDc);else{this.Oc.style.overflowY=
"hidden";const e="%"===this.fZ.substring(this.fZ.length-1,this.fZ.length),t=e?parseInt(this.fZ.substring(0,this.fZ.length-1)):parseInt(this.fZ.substring(0,this.fZ.length-2));this.Oc.style.top=e?(100-t)/2+"%":100*(qi.a.qw-t)/qi.a.qw/2+"%";this.Oc.style.height=this.fZ}this.MIa()}else this.Oc.style.left=this.Mtk,this.Oc.style.right=this.Ntk,this.Oc.style.top=this.Otk,this.Oc.style.bottom=this.Ltk,this.Oc.style.width=this.DGc,this.Oc.style.height=this.kAd,this.Oc.style.overflowX="hidden",this.Oc.style.overflowY=
"hidden"}MIa(){if(this.Oc){var e=this.Oc.style.zIndex;this.Oc.style.zIndex="-9999";if(this.H1>qi.a.rp)v.AFrameworkApplication.isRtl?this.Oc.style.marginRight="0":this.Oc.style.marginLeft="0";else{const t=String.format("{0}px",Math.floor(-this.Oc.offsetWidth/2));v.AFrameworkApplication.isRtl?this.Oc.style.marginRight=t:this.Oc.style.marginLeft=t;v.AFrameworkApplication.isRtl?this.Oc.style.right="50%":this.Oc.style.left="50%"}this.Oc.style.zIndex=String(e)}else z.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}WN(){super.WN();
const e=document.getElementById(this.Sj(this.BGc));e.style.width=String.format("{0}px",this.H1);e.style.height=this.fZ}get c$c(){return this.hjb}get Cob(){return this.Nq}get instanceId(){return this.$Dd}set instanceId(e){this.$Dd=e}get dZc(){return this.Peh}set dZc(e){this.Peh=e}rSo(e,t){this.kAd=e;this.DGc=t}}Object(y.a)(Zi,"SDXDialog",bk.a,[]);var Xj=d(1718),Us=d(361),Si=d(91),Un=d(112),mr=d(1018);class fn{constructor(e,t,E,W,ha,Ka,sb,dc,xc=null){this.zDc=null;this.Sok=6E4;this.k5=this.fFb=null;
this.K8g=6E4;this.j8b=!1;this.RNe=3E3;this.lHc=this.QNe=0;this.i4b=this.oda=this.HHa=this.fLh=null;this.MMa=(Rc,md)=>{this.Dmi&&this.E2o(md.LO)&&(z.ULS.sendTraceTag(508867086,220,15,"OnAddinDetailsRefreshed: collectionType {0}, errorCode: {1}, failure: {2}, errorInfo: {3}",Zh[md.LO],uk[md.errorCode],md.Zj?md.Zj.toString():"n/a",JSON.stringify(md.Zj)),this.edp(md.LO));!this.Drg||this.tR?this.j8b||(this.j8b=!0,this.okd()):2!==md.LO&&3!==this.Qea&&this.okd()};this.jMi=(Rc,md,ud,Ud,Id)=>{if(!this.Yla)return this.XTm(ud,
Id);if(2!==ud)return 32;Rc=Id.Href;md=this.k5.e5d(this.EPf(Id));if(!md)return z.ULS.sendTraceTag(508913680,220,10,"Failed to get a valid AddinDetail object in LaunchAddinInstallDialog"),8;md=md.aAc();md={["solutionId"]:fn.z7(md)};md.href=Rc;md.UILocation=Id.UILocation;cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:Sb.a.fI(md)}));return 32};this.B3f=(Rc,md,ud,Ud,Id)=>{if(!this.Yla)return this.Exn(ud,Id);if(2!==ud)return 32;
Rc=Id.SourceControlId;Rc=this.k5.e5d(this.San?this.EPf(Id):this.k5.cKi(Rc));if(!Rc)return z.ULS.sendTraceTag(509751330,344,10,"No add-in details."),8;Rc=Rc.aAc();this.dSb(Rc);v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled")&&(Rc={["solutionId"]:fn.z7(Rc)},Rc.UILocation=Id.UILocation,cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:Sb.a.fI(Rc)})));return 32};this.LVm=
(Rc,md,ud,Ud,Id)=>{if(!this.Yla)return this.MVm(ud,Id);if(2!==ud)return 32;Rc=this.k5.e5d(Id.CommandValueId);if(!Rc)return z.ULS.sendTraceTag(508913679,344,10,"No add-in details."),8;Rc=Rc.aAc();this.nBc("InstalledByListView",41,Rc);this.dSb(Rc);Rc={["solutionId"]:fn.z7(Rc)};Rc.UILocation=Id.UILocation;cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:Sb.a.fI(Rc)}));return 32};this.u3n=()=>{this.zDc=Sf.a("getTheme")?appChrome.api.getTheme():
null;this.tk.value.setAppTheme(this.zDc);return this.zDc};this.pYb=(Rc,md,ud,Ud,Id)=>{if(2===ud){Rc=Id.callback;if(!Rc)return 16;this.s1i()&&Id.storeType?this.Zwj(Rc,Id.storeType):this.Djo(Rc)}return 32};this.oso=(Rc,md,ud,Ud,Id)=>{if(2===ud)if(this.Pqa)Id&&Id.Observer?this.Pqa.MNa(Id.Observer):z.ULS.sendTraceTag(510248469,220,10,"RegisterAddinDetailObserver: invalid actionData: {0}",JSON.stringify(Id));else return z.ULS.sendTraceTag(512231321,220,10,"RegisterAddinDetailObserver: this.AddinDetailsManager is null."),
8;return 32};this.DFn=(Rc,md,ud,Ud,Id)=>{2===ud&&z.ULS.sendTraceTag(16847762,341,50,String.format("[TellMeForOfficeAddIn-FlyoutRendered]: AppName:{0} | SessionId:{1} | Lcid:{2}",Id.LabelText,v.AFrameworkApplication.userSessionId,v.AFrameworkApplication.lcid));return 32};this.crg=(Rc,md,ud,Ud,Id)=>{2===ud&&(Rc=Id.callback)&&this.p0k(Rc);return 32};this.JSi=(Rc,md,ud,Ud,Id)=>{Ud=Id.ownerAddinSolutionId||Id.solutionId;Rc=v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.SharedRuntimeParameterRefactoring");
ud=Id.targetType;Ud=this.kxd.p5d(Ud);var Ee=1===ud&&Ud&&Ud.settings?Ud.settings:{};Rc||!Ud||fn.Tf(Ud.sharedRuntimeId)||(Id.sharedRuntimeId=Ud.sharedRuntimeId,Id.backgroundState=Ud.backgroundState);const kf=!fn.Tf(Id.sharedRuntimeId);var Ke=Id.storeType;const dh=Id.ownerAddinStoreType;let $h;!Rc&&kf?($h=Id.ownerAddinSolutionId||Id.solutionId,Ke=dh||Ke):$h=Id.solutionId;const rj=(new Hb.a(Rd.a.create(),1)).toString();Ee=new Wb.a(rj,$h,Id.version,Id.storeId,Ke,Ee);Ee.assetId=Id.assetId;Ee.assetStoreId=
Id.assetStoreId;Ee.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Ee.osfControlType=ud;Ee.sharedRuntimeId=Id.sharedRuntimeId;Ee.backgroundState=Rc?Ud?Ud.backgroundState:Ee.backgroundState:Id.backgroundState;Ee.isPreload=kf&&1===Ee.backgroundState;void 0!==Id.isAddinCommands&&(Ee.isAddinCommands=Id.isAddinCommands);void 0!==Id.addinCommandsActionType&&(Ee.addinCommandsActionType=Id.addinCommandsActionType);Ee.isAddinCommands&&(Ee.ownerAddinSolutionId=Id.ownerAddinSolutionId,Ee.ownerAddinStoreType=
dh);Ee.isResizable=!0;Ee.resizeMinWidth=Mn.a.taskPaneWidth;1===ud?this.yan(Ee,Id.displayName):0===ud&&this.pda.value.TVf(md,Id.width,Id.height,Ee);this.sa.raiseEvent("OnAppForOfficeActivated",this.QAl(Ee));return 32};this.pda=e;this.tk=E;this.Yb=W;this.aq=ha;this.ga=Ka;this.Ga=sb;this.kxd=dc;this.N7b=xc;this.DFk=!xc;this.jKb&&(this.Pqa?(this.k5=new Wq(this.ga,this.Pqa,"3935259562","2544406033","1945259303",this.Ga,this.JNh),this.Moc()&&(this.Pqa.MNa(this.MMa),this.tR?window.setTimeout(()=>{this.j8b||
(this.j8b=!0,this.okd(),z.ULS.sendTraceTag(508630613,220,15,"Timeout occurs even when the initializer's fix is applied."))},this.K8g):this.Drg?this.zBf(this.RNe):window.setTimeout(()=>{this.j8b||(this.j8b=!0,this.okd(),z.ULS.sendTraceTag(509088386,220,15,"AddinDetailsManager not triggered"),this.Dmi&&(this.lHc=7,this.NP(0,!0)))},this.K8g))):z.ULS.sendTraceTag(509749262,220,10,"AddinDetailsManger is null"));this.$wa=null;this.Nnk=Object(ib.a)(this,this.nBc,"userActionHandler");this.sa=new ua.a;this.k4b=
this.qya=this.Vwh=null;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorAddinThemeSupportEnabled",!1)&&(this.zDc=Sf.a("getTheme")?appChrome.api.getTheme():null)}zBf(e){window.setTimeout(()=>{this.rvo()},e)}get tR(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}rvo(){0===this.Qea?(z.ULS.sendTraceTag(508830284,220,15,"commandRegistrationState: {0}, the 1st attempt was timeout, explicitly call queryAddinDetails.",
sf[this.Qea]),this.lHc=7,this.NP(0,!0),this.zBf(this.RNe)):1===this.Qea?(z.ULS.sendTraceTag(508830283,220,50,"commandRegistrationState: {0}, wait for queryAddinDetails for a few more seconds to complete.",sf[this.Qea]),this.Qea=2,this.zBf(3*this.RNe)):2===this.Qea?(z.ULS.sendTraceTag(508839687,220,15,"commandRegistrationState: {0}, the 2nd attempt was timeout, register the command anyway and complete.",sf[this.Qea]),this.okd()):z.ULS.sendTraceTag(508839686,220,50,"commandRegistrationState: {0}, registration completed.",
sf[this.Qea])}get Pqa(){this.iSd&&!this.oda&&(this.oda=lr.createInstance(this.Ga,this.tk,{["AppsForOfficeAllowExternalMarketplace"]:this.Ga.$("AppsForOfficeAllowExternalMarketplace"),["AppsForOfficeThirdPartyIsDisabled"]:this.Ga.$("AppsForOfficeThirdPartyIsDisabled"),["AreThirdPartyAddInsAllowed"]:v.AFrameworkApplication.i6a,["PopularAddinDetailsJsonString"]:this.Hcb,["UICulture"]:v.AFrameworkApplication.uiCulture}));return this.oda}get JNh(){this.Kbg&&!this.i4b&&(this.i4b=new Nj(this.Ga,this.Pqa,
this.Ubo));return this.i4b}get Yla(){return this.Moc&&this.ehf}get ehf(){return(this.Ga||v.AFrameworkApplication.K).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}Moc(){return(this.Ga||v.AFrameworkApplication.K).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}get Ubo(){return`[{"title":"${CommonUIStrings.l_AddInCategoryTitleWritingFluently}","solutionIds":["wa200001011","wa200000368","wa104381714","wa200002281","wa200005107","wa200003478","wa104380050","wa104380449","wa104380140","wa104380519","wa104380278"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleEducationalPurpose}","solutionIds":["wa104099688","wa104382081","wa104381909","wa104379370","wa200001482","wa200002534","wa104380848","wa200001486","wa104380917","wa104380429"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndDiagrams}","solutionIds":["wa104380121","wa104051163","wa200000113","wa104379279","wa104218065","wa104381063","wa104379997","wa200000729","wa200001486","wa104178141","wa104380118"]}]`}get Drg(){return(this.Ga||
v.AFrameworkApplication.K).getBooleanFeatureGate("Microsoft.Office.SharedOnline.RegisterPopulateCommandRefactorEnabled",!1)}get Dmi(){return this.Drg?!0:(this.Ga||v.AFrameworkApplication.K).getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExperimentalQueryAddinDetailsEnabled",!1)}get iSd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get jKb(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",
!1)&&this.iSd}get Kbg(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",!1)}get au(){return this.tk.value}get A$o(){this.HHa||(this.HHa={},this.HHa.InsertAddInsFromBackstage="Backstage",this.HHa.InsertMoreAddInsFromBackstageFooter="InsertMoreAddInsFromBackstageFooter",this.HHa.LaunchMyAddInsFromBackstage="BackstageSeeAll",this.HHa.InsertAddIns="Ribbon",this.HHa.LaunchAddinDialogFromTellMe="TellMe",this.HHa.TeachingCallout="TeachingCallout",this.HHa.AddinFlyoutMoreButton=
"AddinFlyoutSeeAll",this.HHa.InsertMoreAddInsFromFooter="InsertMoreAddInsFromFooter");return this.HHa}Wb(){this.ga.fb(M.a.lbd,I.a.frame,Object(ib.a)(this,this.lbd,"launchAppForOfficeDialog"),4);this.ga.fb(M.a.pYb,I.a.frame,this.pYb,96);this.ga.fb(M.a.pso,I.a.frame,this.oso,96);this.ga.ra(M.a.aip,I.a.frame,this.DFn);this.ga.ra(M.a.crg,I.a.frame,this.crg);this.ga.ra(M.a.eWf,I.a.frame,this.JSi);this.ga.ra(M.a.gTi,I.a.frame,this.JSi);this.ga.ra(M.a.n2d,I.a.frame,Object(ib.a)(this,this.nVm,"handleExecuteAddinAction"));
this.ga.ra(M.a.fUj,I.a.frame,Object(ib.a)(this,this.cXm,"handleShowExtensionTaskPane"));this.ga.ra(M.a.a4h,I.a.frame,Object(ib.a)(this,this.zUm,"handleCloseExtensionTaskPane"));this.ga.ra(M.a.UGj,I.a.frame,Object(ib.a)(this,this.OWm,"handleRestartExtensionTaskPane"));this.ga.ra(M.a.Khe,I.a.frame,Object(ib.a)(this,this.UVm,"handleLaunchSDXDialog"));this.ga.ra(M.a.p2l,I.a.frame,Object(ib.a)(this,this.iVm,"handleEnterAddinBackstageAction"));this.jKb&&(this.ga.ra(M.a.Xwn,I.a.frame,Object(ib.a)(this,this.FMi,
"handleLaunchAddinInstallDialog")),this.ga.ra(M.a.B3f,I.a.frame,this.B3f),this.Moc()||this.ga.ra(M.a.Otj,I.a.frame,Object(ib.a)(this,this.RMi,"handlePopulateAddInGallery")),this.ga.fb(M.a.vjo,I.a.frame,Object(ib.a)(this,this.JWm,"handleQueryAddInFlyout"),100),this.ga.ra(M.a.jXk,I.a.frame,this.jMi));if(this.Kbg||this.jKb)this.ga.ra(M.a.Ywn,I.a.frame,Object(ib.a)(this,this.TVm,"handleLaunchAddinInstallDialogFromList")),this.ga.ra(M.a.Oan,I.a.frame,this.LVm);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinTransitionEntranceEnabled",
!1)&&this.ga.ra(M.a.k9m,I.a.frame,Object(ib.a)(this,this.Zwn,"launchAddinTransitionTeachingCallout"));v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorAddinThemeSupportEnabled",!1)&&Sf.a("registerOnThemeChangeCallback")&&(this.tk.value.setAppTheme(this.zDc),appChrome.api.registerOnThemeChangeCallback(this.u3n))}okd(){this.Qea=3;this.ga.ra(M.a.Otj,I.a.frame,Object(ib.a)(this,this.RMi,"handlePopulateAddInGallery"))}Euj(){return new fa.a}nVm(e,t,E,W,ha){if(2!==E)return 32;
e=ha[Xj.a.h0c];if("Action"!==ha[Xj.a.X5h])return 8;t=ha[Xj.a.ofc];E=ha[Xj.a.ogd];W=E.optionalProperties[Xi.a.jMh];var Ka=(ha=this.yMf(ha))?this.BVa(ha):null;Ka||(ha=new Aa.a,Ka=E.optionalProperties[Xi.a.taskPaneWidth],0<=Ka&&(ha.taskPaneWidth=Ka),ha.xS=E.optionalProperties[Xi.a.xS],ha.sourceLocationOverrideResourceId=E.optionalProperties[Xi.a.sourceLocationOverrideResourceId],ha.gS=E.bZc,ha.onTaskPaneClose=E.optionalProperties[Xi.a.onTaskPaneClose],ha.onExtensionLaunchCallback=E.optionalProperties[Xi.a.onExtensionLaunchCallback],
ha.l8c=E.optionalProperties.InstanceToken?E.optionalProperties.InstanceToken:(new Hb.a(Rd.a.create(),1)).toString(),ha.isPreload=!0,Ka=ha.l8c,this.B4(e.getId(),ha,!0));return this.iCf(Ka,t,W)?32:8}edp(e){this.lHc&=~(1<<e)}E2o(e){return!!(this.lHc&1<<e)}TVm(e,t,E,W,ha){return 2!==E?32:ha&&"LinkClickedPayload"===ha.Type?this.jMi(e,t,E,W,ha):this.FMi(e,t,E,W,ha)}FMi(e,t,E,W,ha){if(2!==E)return 32;e=this.hLm(ha);if(!e)return z.ULS.sendTraceTag(509687395,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),
8;t=this.tk.value?this.tk.value.getAppUILocale()||"en-US":"en-US";this.k4b=new $p(e,"wac_word",t,Ka=>{Ka.fromInstallDialog=!0;Ka.UILocation=ha.UILocation;this.nBc("0",3,Ka)});this.k4b.pi("",null,null);return 32}hLm(e){var t=null;if(!e)return t;if(this.Yla){if(e=this.k5.e5d(this.EPf(e)))t=e.solutionId}else t=e.CommandValueId,t=ab.c(t)?this.k5.vsf[e.SourceControlId]:t;return t}EPf(e){let t;if(!e)return null;(t=e.CommandValueId)||(t=this.k5.cKi(e.SourceControlId));return t}UVm(e,t,E,W,ha){return 2!==
E?32:this.Khe(ha[Xj.a.h0c],ha[Xj.a.ogd])?32:8}iVm(e,t,E){var W;if(2!==E)return 32;this.Yla&&(null===(W=this.JNh)||void 0===W?void 0:W.Ntj());this.k5.ppl()&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowBackstageSurveyEnabled",!1)&&(this.gCd=new If("AddinBackstageFeedbackSurvey",this.Ga.getIntFeatureGate("Microsoft.Office.SharedOnline.BackstageSurveyTriggerTime",this.Sok)),this.gCd.n6i());return 32}cXm(e,t,E,W,ha){if(2!==E)return 32;e=ha[Xj.a.h0c];t=ha[Xj.a.ofc];ha=ha[Xj.a.ogd];
E=new Aa.a;W=ha.optionalProperties[Xi.a.taskPaneWidth];0<=W&&(E.taskPaneWidth=W);E.xS=ha.optionalProperties[Xi.a.xS];E.sourceLocationOverrideResourceId=ha.optionalProperties[Xi.a.sourceLocationOverrideResourceId];E.gS=ha.bZc;E.onTaskPaneClose=ha.optionalProperties[Xi.a.onTaskPaneClose];E.onExtensionLaunchCallback=ha.optionalProperties[Xi.a.onExtensionLaunchCallback];E.showLoadingSpinner=ha.optionalProperties[Xi.a.showLoadingSpinner];E.ofc=t;ha.optionalProperties.InstanceToken&&(E.l8c=ha.optionalProperties.InstanceToken);
return this.B4(e.getId(),E,!0)?32:8}JWm(e,t,E){return 2!==E||this.k5.AWh?32:(e=!v.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&v.AFrameworkApplication.i6a)&&this.k5&&!this.Moc()&&this.k5.s1h()||e&&this.k5?32:8}Zwn(e,t,E){if(2!==E)return 32;this.fLh=new Bm;this.fLh.vXc();return 32}RMi(e,t,E,W,ha){if(2!==E)return this.k5.s1h()?32:8;cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.HandlePopulateAddInGallery"}));this.k5.wco(ha);return 32}XTm(e,t){if(2!==
e)return 32;e=t.Href;var E=t.CommandValueId;E=ab.c(E)?this.k5.vsf[t.SourceControlId]:E;if(!E)return z.ULS.sendTraceTag(508887646,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;const W=this.Pqa.P8a(E);if(W){const ha={};ha.solutionId=E;ha.storeType=W.storeType;ha.storeId=W.storeId;ha.assetId=W.assetId;ha.assetStoreId=W.assetStoreId;E={["solutionId"]:fn.z7(ha)};E.href=e;E.UILocation=t.UILocation;cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",
dataFields:Sb.a.fI(E)}))}return 32}MVm(e,t){if(2!==e)return 32;e=t.CommandValueId;if(!e)return z.ULS.sendTraceTag(509219802,344,10,"No solutionId."),8;const E=this.Pqa.P8a(e),W={};if(E)W.solutionId=e,W.version=E.version,W.storeType=E.storeType,W.storeId=E.storeId,W.assetId=E.assetId,W.assetStoreId=E.assetStoreId,W.targetType=E.targetType,W.displayName=E.displayName,W.width=E.width,W.height=E.height,this.nBc("InstalledByListView",41,W),this.dSb(W),e={["solutionId"]:fn.z7(W)},e.UILocation=t.UILocation,
cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:Sb.a.fI(e)}));else return z.ULS.sendTraceTag(509219801,344,10,"No add-in details."),8;return 32}zUm(e,t,E,W,ha){return 2!==E?32:(e=this.yMf(ha))?(this.tUa(e),32):8}OWm(e,t,E,W,ha){if(2!==E)return 32;if(e=this.yMf(ha))if(e=this.tk.value.getOsfControl(e))return e.refresh(),32;return 8}yMf(e){let t=null;const E=e[Xj.a.h0c].getId();e=e[Xj.a.ogd].optionalProperties[Xi.a.sourceLocationOverrideResourceId];
E&&(t=this.I1c(E,e));return t}yan(e,t){const E=ha=>{var Ka={};Ka.solutionId=ha.solutionId;Ka.version=ha.version;Ka.storeType=ha.storeType;Ka.storeId=ha.storeId;Ka.assetId=ha.assetId;Ka.assetStoreId=ha.assetStoreId;Ka.targetType=1;ha=new fa.a;ha.add(Ka);Ka={};Ka[nc.a.WRd]=ha;Ka[nc.a.oIa]=3;this.ga.Pb(M.a.pUb,2,Ka)},W=(ha,Ka)=>{this.showTaskPane(ha.solutionId,Ka,ha);this.pda&&this.pda.value&&this.pda.value.vsb(ha)};v.AFrameworkApplication.K.$("OfficeJsUseExperimentHostJsIsEnabled")&&(e.hostInfoFlags|=
8);if(v.AFrameworkApplication.K.$("AddInCommandsIsEnabled"))if(e.isAddinCommands)0===e.addinCommandsActionType?E(e):2===e.addinCommandsActionType?W(e,t):3===e.addinCommandsActionType&&(this.createUILessSandbox(e.solutionId,t,e),this.pda&&this.pda.value&&this.pda.value.vsb(e));else{const ha={};v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(ha.solutionId=e.solutionId,ha.version=e.version):(ha.marketplaceId=e.solutionId,
ha.marketplaceVersion=e.version);ha.storeType=e.storeType;ha.storeId=e.storeId;ha.targetData=e;this.n3i(ha,(Ka,sb,dc)=>{dc=dc.targetData;sb?E(dc):W(dc,t);Ka||z.ULS.sendTraceTag(542978529,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(dc.solutionId,dc.storeType,dc.assetId,null,null,dc.storeId),dc.storeType)})}else W(e,t)}lbd(e,t,E,W,ha){if(1===E)return v.AFrameworkApplication.i6a?32:8;2===E&&(this.sa.raiseEvent("OnInsertionDialogOpened"),e=ha.SourceControlId,
ha=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)?ha.Query:ha.CommandValueId,window.g_InstallOrigin=this.A$o[e]||"Unknown",t=this.k9n(e),v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.TellMeLaunchAddinDialogSetTabIdEnabled")&&"LaunchAddinDialogFromTellMe"===e&&!fn.Tf(ha)?(t.navigationMode=0,t.assetId=ha,this.Ppd("{98143890-AC66-440E-A448-ED8771A02D52}",t)):v.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&
(this.jKb||this.Kbg)?"InsertMoreAddInsFromFooter"===e||"InsertMoreAddInsFromBackstageFooter"===e?(this.Ppd("{98143890-AC66-440E-A448-ED8771A02D52}",t),"InsertMoreAddInsFromFooter"===e&&cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.ShowStoreDialog",dataFields:Sb.a.fI({["controlId"]:"Footer"})}))):"AddinFlyoutMoreButton"===e?(this.Ppd("0",t),cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.ShowStoreDialog",dataFields:Sb.a.fI({["controlId"]:"SeeAll"})}))):
this.Ppd(null,t):this.Ppd(null,t));return 32}s1i(){return v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.AllowQueryEntitledAppsForSpecificStoreType")}n2d(){return!1}iCf(){return!1}B4(e,t=null,E=!1){if(!v.AFrameworkApplication.d2i(e))return z.ULS.sendTraceTag(527720961,1403,15,"First Party Taskpane blocked: Not in allow list: {0}",e),!1;t||(t=new Aa.a);t.gS||(t.gS={});t.gS.ShowFeedback=v.AFrameworkApplication.sH;const W=t.l8c?t.l8c:(new Hb.a(Rd.a.create(),1)).toString();
E=new Wb.a(W,e,"","",E?"sdxcatalog":"firstparty",null,!1,{showResizeChatButton:t.showResizeChatButton,titleTag:t.QHg});E.activationStart=window.performance.now();E.taskPaneWidth=t.taskPaneWidth;E.sourceLocationOverrideResourceId=t.sourceLocationOverrideResourceId;E.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;E.osfControlType=1;E.onTaskPaneClose=t.onTaskPaneClose;E.onExtensionLaunchCallback=t.onExtensionLaunchCallback;E.isModernPane=t.isModernPane;E.isResizable=t.isResizable;
E.resizeMinWidth=t.resizeMinWidth;E.resizeMaxWidth=t.resizeMaxWidth;E.hostSettings=OSF.OUtil.serializeSettings(t.gS);E.settings=OSF.OUtil.serializeSettings(t.gS);E.featureGates=v.AFrameworkApplication.K.fKf(e);E.sharedRuntimeId=t.sharedRuntimeId;E.isPreload=t.isPreload;E.showLoadingSpinner=t.showLoadingSpinner;E.isPaneAutoOpened=t.isPaneAutoOpened;e=this.I1c(E.solutionId,t.sourceLocationOverrideResourceId);return this.showTaskPane(e,t.xS,E)}unb(e,t=null){e=t?this.I1c(e,t.sourceLocationOverrideResourceId):
this.I1c(e,null);this.tUa(e)}tUa(){}CU(){return!1}showTaskPane(){return!0}S9d(){return null}nHf(){return 0}BMj(){}oMh(){}oVj(){}createUILessSandbox(){}BVa(){return null}DOa(e){var t=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const E=this.ePb();E&&(3===E.S1c(e)?(t={},t[nc.a.$Rd]=e,this.ga.Pb(M.a.DOa,2,t),t=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):t=OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog);return t}fLa(e){var t=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const E=
this.ePb();E&&(3===E.S1c(e)?(t={},t[nc.a.$Rd]=e,this.ga.Pb(M.a.fLa,2,t),t=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):t=OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog);return t}X_m(e){for(const t of cf.aSm())if(t.value.Qg===e)return t.value.dialog.hide(),t.key;return null}dispose(){this.tk&&this.tk.value&&"undefined"!==typeof this.tk.value.hostCheckReadyHandler&&(v.AFrameworkApplication.sAo(Object(ib.a)(this.tk.value,this.tk.value.hostCheckReadyHandler,"hostCheckReadyHandler")),z.ULS.sendTraceTag(590943260,
1403,100,"ContextActivationManager::HostCheckReadyHandler is unregistered"))}n3i(e,t){this.tk.value.isAddinCommandsAsync(e,t)}Zhm(){return Object(ib.a)(this,this.fSh,"appForOfficeStatusChangedHandler")}pMh(e){this.tk.value||z.ULS.shipAssertTag(6068437,341,!1,"ContextActivationManager unavailable while trying to activate app: {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.ownerAddinStoreType||e.storeType,e.assetId,null,null,e.storeId));this.tk.value.insertOsfControl(e)}yyj(e){this.tk.value?
this.tk.value.activateOsfControl(e):z.ULS.shipAssertTag(6431491,341,!1,"ContextActivationManager unavailable while trying to reactivate app: {0}",e)}lNl(e){this.tk.value?this.tk.value.deActivateOsfControl(e):z.ULS.shipAssertTag(6431492,341,!1,"ContextActivationManager unavailable while trying to deactivate app: {0}",e)}Ndn(e){return this.tk.value?2===this.tk.value.getOsfControlStatus(e):(z.ULS.shipAssertTag(18114241,341,!1,"ContextActivationManager unavailable while trying to firgure out if app is active: {0}",
e),!1)}ePb(){return null}nBc(e,t,E=null){if(5===t)this.KBj(!1);else if(6===t)this.KBj(!0);else if(0===t)this.G1h(e,!1),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Ib.GCa&&mr.ShyRibbon.hnb(1,0);else if(7===t)this.G1h(e,!0);else if(1===t)this.U5k();else if(2===t)this.UUd();else if(3===t)this.N7b&&this.N7b.hide(),this.jKb&&this.k4b&&this.k4b.hide(),E?(this.fFb=e=this.mUd(E),z.ULS.sendTraceTag(509679069,220,50,"UserActionEnum.InsertAgave: the _lastInsertedAgaveParams' PrivacyCompliantId: {0}",
fn.z7(this.fFb)),this.jKb&&"fromInstallDialog"in E&&E.fromInstallDialog?this.m9m(e,E):this.dSb(e)):z.ULS.sendTraceTag(17113349,344,10,"InsertAgave: should have valid insert agave parameters");else if(41===t)this.iSd&&E&&(this.fFb=this.mUd(E),z.ULS.sendTraceTag(509674968,220,50,"UserActionEnum.ClickTrust: the _lastInsertedAgaveParams' PrivacyCompliantId: {0}",fn.z7(this.fFb)));else if(40===t)this.iSd&&this.fFb&&E&&(e=this.mUd(E),this.Z9k(this.fFb,e)&&(z.ULS.sendTraceTag(509679068,220,50,"UserActionEnum.OsfControlLoad: the loadedAgaveParams' PrivacyCompliantId: {0}",
fn.z7(e)),this.fFb=null,this.NP(0)));else if(36===t)E?this.dSb(this.mUd(E)):z.ULS.sendTraceTag(587579545,344,10,"InsertDevManifest: should have valid insert agave parameters");else if(37===t)e={["ak1"]:this.tk.value.getDevManifestInvalidUrlErrorString(E.manifestUrl)},this.ga.Pb(M.a.G0b,2,e);else if(9===t)v.AFrameworkApplication.K.$("AddInCommandsIsEnabled")&&v.AFrameworkApplication.K.$("AddInCommandsLoadedInBootingIsEnabled")&&this.ga.Pb(M.a.Wqg,2,E);else if(8===t)e={["ak1"]:this.tk.value.getManifestInvaildErrorString()},
this.ga.Pb(M.a.G0b,2,e);else if(13===t||14===t)(E=this.ePb())&&3===E.S1c(e)&&this.tk.value.notifyAgave(e,11);else if(15===t)(e=this.X_m(e))?(E=this.ePb())&&3!==E.S1c(e)&&this.au.notifyAgave(e,11):(v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.SdxDialogHandleEscKey")&&this.qya&&this.qya.hide(),this.jKb&&this.k4b&&this.k4b.hide());else if(23===t)cc.a.sendOtelEvent(Object.assign(new Fr.a,{otelEvent:E}));else if(38===t)cc.a.sendOtelCustomerContent(Object.assign(new Fr.a,
{otelEvent:E}));else if(26===t)Sh.a.instance.kxn(E);else if(27===t)(e=E.Id.Id)&&this.tUa(e);else if(32===t){e=this.ePb().$hm(E.solutionId);for(const W of e)this.tUa(W)}else t===OSF.AgaveHostAction.CloseSDXDialog&&this.qya&&E.InstanceId===this.qya.instanceId&&(this.qya.hide(),this.qya.dZc(E.DialogCloseCallbackParam,!0))}Z9k(e,t){return oi.a.th().equals(e.solutionId,t.solutionId)&&oi.a.th().equals(e.storeType,t.storeType)&&oi.a.th().equals(e.storeType,"OMEX")}fSh(){}GQo(e,t){e!==this.$wa&&(t&&this.blur(),
this.tk.value&&(this.tk.value.notifyAgave(e,4),this.$wa=e))}IQo(e){this.tk.value.appHasNotifications(e)&&(this.$wa=null)}I1c(e,t=null){return e?t?String.format("{0}.{1}",e,t):e:""}KBj(e){e?(document.activeElement.blur(),this.aq.T$d(0,null,2,null,null)):(document.activeElement.blur(),this.aq.C5c(0,null,2,null,null));this.$wa=null}U5k(){this.$wa=null}G1h(e,t){this.$wa=e;const E=this.TOf(e);if(E){var W=this.Yb.ge(E);t&&!this.Yb.getRegion(W.name)&&(t=new Us.DOMFocusListing(()=>document.getElementById(this.B3c(e))),
t.lna=!0,t.Gn(3),t.Gn(2),t.Gn(1),t=this.Yb.jra(()=>document.getElementById(this.B3c(e)),this.Yb.ge(E),t),t.aS=!0,t.SZa(),W.tt(Un.KeyInputManager.lc(Si.a.xz,0)),W.tt(Un.KeyInputManager.lc(Si.a.xz,4)));this.Yb.Bg(E)}}B3c(e){return e}blur(){document.activeElement.blur()}vgf(e){this.sa.addHandler("OnAppForOfficeClose",e)}W0k(e){this.sa.addHandler("OnInsertionDialogOpened",e)}ccb(e,t=!1){t||(this.lNl(e),this.sa.raiseEvent("OnAppForOfficeClose",e));this.pda&&this.pda.value&&this.pda.value.LUl(e);this.$wa=
null}TOf(){return null}Ppd(e,t){this.DFk&&(this.N7b=new lh);this.N7b.pi("",null,null);this.tk.value.launchInsertDialog(this.N7b.Cob,e,t)}UUd(){this.N7b.hide()}Khe(e,t){const E=t.optionalProperties.InstanceToken?t.optionalProperties.InstanceToken:(new Hb.a(Rd.a.create(),1)).toString(),W=new Wb.a(E,e.getId(),"","","sdxcatalog",null,!1);W.sourceLocationOverrideResourceId=t.optionalProperties[Xi.a.sourceLocationOverrideResourceId];W.onExtensionLaunchCallback=t.optionalProperties[Xi.a.onExtensionLaunchCallback];
W.settings=OSF.OUtil.serializeSettings(t.bZc?t.bZc:{});W.featureGates=v.AFrameworkApplication.K.fKf(e.getId());this.I1c(W.solutionId,W.sourceLocationOverrideResourceId);e=t.optionalProperties[Xi.a.dZc];this.qya=new Zi(!0,!0);const ha=t.optionalProperties[Xi.a.dialogTitle];this.qya.rSo(t.optionalProperties[Xi.a.dialogHeight],t.optionalProperties[Xi.a.dialogWidth]);this.qya.instanceId=E;this.qya.dZc=e;this.qya.pi(ha,null,null);W.div=this.qya.Cob;W.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;
W.osfControlType=1;this.tk.value.insertOsfControl(W);return!0}dSb(e){this.ga.Pb(M.a.eWf,2,e)}m9m(e,t){this.ga.Pb(M.a.gTi,2,e);v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled")&&(e={["solutionId"]:fn.z7(e)},e.UILocation=t.UILocation,cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:Sb.a.fI(e)})))}Exn(e,t){if(2!==e)return 32;e=t.CommandValueId;var E=ab.c(e)?this.k5.vsf[t.SourceControlId]:
e;if(!E)return z.ULS.sendTraceTag(508913678,344,10,"No solutionId."),8;e={};e.solutionId=E;if(E=this.Pqa.P8a(E))e.version=E.version,e.storeType=E.storeType,e.storeId=E.storeId,e.assetId=E.assetId,e.assetStoreId=E.assetStoreId,e.targetType=E.targetType,e.displayName=E.displayName,e.width=E.width,e.height=E.height,this.dSb(e),v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled")&&(e={["solutionId"]:fn.z7(e)},e.UILocation=t.UILocation,cc.a.sendTelemetryEvent(Object.assign(new cg.a,
{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:Sb.a.fI(e)})));else return z.ULS.sendTraceTag(509724485,344,10,"No add-in details."),8;return 32}Djo(e){if(this.s1i())this.Zwj(e,OSF.StoreTypeEnum.MarketPlace);else{const t=new wd;t.callbackFunc=e;t.storeType=OSF.StoreTypeEnum.MarketPlace;t.fromInsertDialog=!1;t.refresh="true"===de.a.instance.getItem("refreshRequired");this.tk.value.queryEntitlementDetails(t)}}Zwj(e,t){const E=new wd;E.callbackFunc=e;E.storeType=t;E.fromInsertDialog=
!1;E.refresh="true"===de.a.instance.getItem("refreshRequired");this.tk.value.queryEntitlementDetails(E)}k9n(e){const t={navigationMode:0,assetId:null,category:null};if(!e)return t;e=e.split("|");z.ULS.sendTraceTag(16847763,344,50,"LaunchInsertionDialog with parameters: {0}",JSON.stringify(e));if(3>e.length)return t;e[0]&&1===e[0].length&&(t.navigationMode=parseInt(e[0]));e[1]&&0<e[1].length&&(t.assetId=e[1]);e[2]&&0<e[2].length&&(t.category=e[2]);return t}mUd(e){const t={};t.solutionId=e[Rk.solutionId];
t.version=e[Rk.version];t.storeType=e[Rk.storeType];t.storeId=e[Rk.storeId];t.assetId=e[Rk.assetId];t.assetStoreId=e[Rk.assetStoreId];t.targetType=e[Rk.targetType]?e[Rk.targetType]:0;t.displayName=e[Rk.displayName];t.isAddinCommands=e[Rk.isAddinCommands];t.width=e[Rk.width]?e[Rk.width]:0;t.height=e[Rk.height]?e[Rk.height]:0;t.sharedRuntimeId=e[Rk.sharedRuntimeId];t.backgroundState=e[Rk.backgroundState]?e[Rk.backgroundState]:0;return t}QAl(e){return[e.solutionId,e.version,e.storeId,e.storeType,e.osfControlType]}p0k(e){this.sa.addHandler("OnAppForOfficeActivated",
e)}A2b(){}CFe(){}gZb(e,t){this.Pqa&&(0===this.Qea&&fn.Mtb(e)&&(this.Qea=1),this.Pqa.gZb(e,t))}NP(e,t=!1){this.Pqa&&(0===this.Qea&&fn.Mtb(e)&&(this.Qea=1),this.Pqa.NP(e,t))}get Hcb(){return'[{"displayName":"Vertex42 Template Gallery","solutionId":"wa103296784","version":"1.1.0.0","description":"Browse over 300 templates created by Vertex42.com for Excel and Word","iconUrl":"18364.a3e7eafc-7761-4c16-8f90-68c3819a47e4.54117612-5f8b-47b0-a844-684631c459ca.131ca4d3-9ef1-4788-93e9-08aef4a16490.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":-1,"AUP":101}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com","addinInfo":{"priority":2,"AUP":3726}},{"displayName":"Wikipedia","solutionId":"wa104099688","version":"1.5.0.0","description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1529}},{"displayName":"Pickit | Make impactful presentations in minutes","solutionId":"wa104178141","version":"4.3.3.0","description":"Unlimited access to licensed photos, clipart and your company\u2019s images in PowerPoint.","iconUrl":"52119.865d61ab-6329-4325-ab0d-d26b79dacfb7.7c9712b0-85a4-4901-839e-2ac101b87124.5e9898d6-d6c2-49a0-8098-1eb30d35701b.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickit.com/en/privacy-policy","addinInfo":{"priority":3,"AUP":1187}},{"displayName":"DocuSign for Word","solutionId":"wa104218065","version":"4.2.0.0","description":"Enhance productivity by electronically signing or sending any document from Microsoft Word","iconUrl":"18865.cc9ae10a-ba5e-4ca5-8ece-5bf0bbacdeaf.b1c97a18-3e7f-49b2-8024-46db9b8faebd.b566087e-eda0-4453-880e-f47a7d848eb9.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.docusign.com/company/privacy-policy","addinInfo":{"priority":3,"AUP":1970}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":2,"AUP":893}},{"displayName":"LessonPix Symbols","solutionId":"wa104379370","version":"2.0.0.0","description":"Access your LessonPix Account and over 50K clipart symbols from within Microsoft Office.","iconUrl":"52104.453267e0-c2e7-43b0-b9d8-1a14024ce16f.bf27c658-00f3-4406-81ca-374c6f1bd24b.9ef3504f-30b7-4fd3-b135-7931280a8d74.png","licenseUrl":"https://lessonpix.com/articles/11/299/LessonPix%20Office%20Add-In%20Terms%20and%20Conditions","privacyUrl":"https://lessonpix.com/articles/11/26/LessonPix+Privacy+Policy","addinInfo":{"priority":1,"AUP":534}},{"displayName":"JAGGAER Contract Authoring","solutionId":"wa104379585","version":"3.0.0.0","description":"Author and review contracts faster than ever directly in Word with JAGGAER Contract Authoring.","iconUrl":"559.1462f0c6-f61c-42fe-ad1d-dc4d87b45174.2dc5016b-cdbc-41af-abd9-7c915ae43c4e.06280d94-a345-4639-ae39-da11227674ac.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474843308/Product_42949677815/Asset_52e3d4a8-11b7-420e-802b-a0ff29736a82/JAGGAERMasterAgreementTermsand.doc","privacyUrl":"https://www.jaggaer.com/about/privacy-policy","addinInfo":{"priority":-1,"AUP":244}},{"displayName":"Pexels - Free Stock Photos","solutionId":"wa104379997","version":"2.0.0.0","description":"Get great looking free stock photos for your documents and presentations.","iconUrl":"42183.883a975e-b768-42b6-804b-7440e32d8a14.594bab1e-71b2-4309-b08a-27d3d8832a91.9373d154-174d-40db-873f-11b8a2e636a4.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://officeconsult.no/en/pexels-office-add-in/#privacy","addinInfo":{"priority":1,"AUP":453}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":2,"AUP":2464}},{"displayName":"Lucidchart Diagrams for Word","solutionId":"wa104380118","version":"2.0.0.0","description":"The easiest way to create and insert flowcharts, mockups, UML, mind maps and more in Microsoft Word.","iconUrl":"21470.8707174d-9346-4e3b-89fb-42a1eae7a042.2a02cd8e-edc2-44c8-9dca-10b7e851ac5a.eab30db5-84fe-4e19-b983-6d66f961dcff.png","licenseUrl":"https://lucid.co/tos","privacyUrl":"https://lucid.co/privacy","addinInfo":{"priority":3,"AUP":937}},{"displayName":"Emoji Keyboard","solutionId":"wa104380121","version":"2.0.0.0","description":"Emoji for Microsoft Word, PowerPoint and OneNote","iconUrl":"59740.f26acde8-b516-46ad-8220-2984e6945380.2f899a00-04c7-483e-9ee2-e1b35c2b080f.12545571-342a-4850-b117-43d02783ed9d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://emoji.patbu.xyz/#/privacy","addinInfo":{"priority":1,"AUP":916}},{"displayName":"RefWorks Citation Manager","solutionId":"wa104380122","version":"2.1.0.1","description":"Access your reference collection when writing for quick formatting of citations and a bibliography.","iconUrl":"65260.65124d22-f776-49df-bc00-7feb775be86b.9c8232a6-57b5-45f6-9998-520f920cffe1.a28c4b83-5b94-4239-a8b2-1dc4fdf62abd.png","licenseUrl":"https://www.proquest.com/about/terms-and-conditions.html","privacyUrl":"https://www.proquest.com/about/privacy-home.html","addinInfo":{"priority":3,"AUP":3304}},{"displayName":"PDFfiller \u2013 edit your PDFs","solutionId":"wa104380140","version":"1.0.0.0","description":"Instantly add a document from Office365 to PDFfiller! Edit, sign, save, and share anytime, anywhere,","iconUrl":"14229.ae6bc553-5473-4b85-b0ea-714f7ce7f7b9.4763b6eb-4228-47cb-a466-650454ba5fe1.50b4e5e1-1ed9-4d90-9151-3b6be2f4bbb4.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.pdffiller.com/en/privacy_policy.htm","addinInfo":{"priority":2,"AUP":216}},{"displayName":"Templafy Company Templates","solutionId":"wa104380278","version":"1.0.0.6","description":"Access best practice professional templates and digital assets within your Office applications","iconUrl":"39478.da1eadf9-2005-4a37-9f41-d99acc46197e.5e0830db-920f-4070-b60e-bbd8de8c498c.6e4a303a-5acd-4946-9a57-53715948ec92.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.templafy.com/privacy","addinInfo":{"priority":3,"AUP":91}},{"displayName":"Fejlretter - Powerful feedback","solutionId":"wa104380429","version":"2.0.0.0","description":"Save time when correcting student assignments with the critically acclaimed feedback tool.","iconUrl":"48038.4a8f5705-cdd6-4d3d-9ea1-eb6001a61fcf.e50840ee-5e4b-445e-8253-d4b06f278dd1.bd226b93-2fc4-4ecd-a04d-950b408fd15d.png","licenseUrl":"https://fejlretter.squarespace.com/betingelser","privacyUrl":"https://fejlretter.squarespace.com/privacy-policy","addinInfo":{"priority":3,"AUP":44}},{"displayName":"officeatwork | Wizard for Office","solutionId":"wa104380519","version":"3.5.0.0","description":"Create personalized documents and insert personalized content with just a few clicks.","iconUrl":"21517.0e251595-714f-4044-bf20-b68cba626477.4a09e61b-6aa7-4911-b267-164255e59dcf.c0787172-1cc0-41f2-8885-5fd04ccf297d.png","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":3,"AUP":3517}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":3,"AUP":1926}},{"displayName":"LEAP for Word","solutionId":"wa104380529","version":"3.0.0.0","description":"LEAP for Word helps automate documents and keep them up-to-date.","iconUrl":"11128.dc087b8a-bb43-477e-80a5-4d417ca5c857.dc25a14c-c04d-44cd-ac74-27e3a6537bd0.9630b45c-ae56-4630-8203-50fa08daa9b6.png","licenseUrl":"https://leap.us/terms.html","privacyUrl":"https://www.leap.us/privacy.html","addinInfo":{"priority":-1,"AUP":62}},{"displayName":"FMath Editor","solutionId":"wa104380848","version":"2.1.0.1","description":"Allow users to insert equations into documents.","iconUrl":"21513.6a3c2fa6-ade2-4929-a881-1dd4c188f978.63d347ef-61d0-4ddb-a5af-5102243732ae.0ad9963c-9d43-4f1d-b599-319229de2eda.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://math-on-web.com/privacy_policy.html","addinInfo":{"priority":2,"AUP":169}},{"displayName":"SmartCite for Papers","solutionId":"wa104380917","version":"1.0.1.0","description":"Cite references and generate bibliographies automatically from your ReadCube Papers library!","iconUrl":"37206.29ea90e8-6e48-40d7-a6f6-0e3c479febca.1a063694-e16a-4c0c-a2e9-08030cb75f3f.18a6c2f3-4683-4297-be90-d077e8cc1e08.png","licenseUrl":"https://www.papersapp.com/terms","privacyUrl":"https://www.papersapp.com/privacy","addinInfo":{"priority":3,"AUP":1696}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":-1,"AUP":332}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":-1,"AUP":273}},{"displayName":"Icons by Noun Project","solutionId":"wa104381063","version":"1.0.0.1","description":"Over 1 million high-quality icons to choose from, perfect for presentations.","iconUrl":"43800.2d301a6f-7f58-486a-aa28-60900de38763.afe578dd-fbdd-497d-b1e4-66a6217bfb17.c7c39ea5-5370-437d-8e9d-f9fe1fa77b09.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://thenounproject.com/legal/#!privacy-policy","addinInfo":{"priority":2,"AUP":336}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint","solutionId":"wa104381155","version":"1.1.1.0","description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"31139.c4694bde-161e-42b4-8b8f-87f0c1b5010e.4a78185a-5a69-438c-99c2-80f85f7092a3.39897ffc-7ed4-4e29-bd29-b748bc14ae57.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":3,"AUP":10474}},{"displayName":"IconScout - Icons, Illustrations & 3D Assets","solutionId":"wa104381411","version":"2.4.1.0","description":"Seamlessly access over 4.5 Million+ Design assets within Microsoft Office Applications","iconUrl":"36684.41fa480b-3128-4253-a7ae-3e7c1406bfb6.07fc268d-eaaa-4f81-b6b3-911c8b2d104d.5b4a7a13-0f35-4b05-a07e-7b5c347ad154.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://iconscout.com/legal/privacy-policy","addinInfo":{"priority":2,"AUP":144}},{"displayName":"SiteMap","solutionId":"wa104381519","version":"1.0.0.0","description":"Create SiteMaps and UI flows for Office document","iconUrl":"53703.e16f30a8-c796-46a0-8144-87f78c1714fc.0179cf34-ff8d-44ab-909e-62d8ca7404b7.16f23b12-05ab-4080-b531-395b75fa6046.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://mockflow.com/privacy_policy","addinInfo":{"priority":-1,"AUP":107}},{"displayName":"Stava Rex","solutionId":"wa104381613","version":"3.1.0.0","description":"Stava Rex \u00e4r ett r\u00e4ttstavningsprogram som r\u00e4ttar stavfel och grammatikfel i svensk text.","iconUrl":"6657.d163e868-f594-4452-9c43-a8e27b9d84b7.0033d815-1490-4021-b259-c8d11fa928f7.571b8cbb-7e92-41a2-a8ae-edf3c143c467.png","licenseUrl":"https://oribi.se/tos","privacyUrl":"https://oribi.se/gdpr/tillagg-for-office","addinInfo":{"priority":-1,"AUP":1049}},{"displayName":"Visual Paradigm Online for Office","solutionId":"wa104381637","version":"1.0.0.0","description":"Draw and insert flowcharts, UML, mind maps, BPMN, Venn, ERD, ArchiMate and more in Office documents.","iconUrl":"37179.b19e18e4-8129-4f14-9c5f-94ff9f478a8e.7039006e-f2b2-4482-98db-255ae2f58628.bd478170-6d94-42f7-b043-44f31827a0d2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://online.visual-paradigm.com/privacy.jsp","addinInfo":{"priority":-1,"AUP":100}},{"displayName":"SpellRight","solutionId":"wa104381658","version":"3.2.1.0","description":"Advanced spellchecker, specially designed for people with reading and writing difficulties.","iconUrl":"44740.a94c453b-9a33-4274-bbd3-812c98659aa6.6f414cd6-fdfa-4f0d-981d-e4ab7d165a01.d68a7473-2a11-46c9-8fb4-1532d54df637.png","licenseUrl":"https://oribi.se/tos","privacyUrl":"https://oribi.se/gdpr","addinInfo":{"priority":-1,"AUP":612}},{"displayName":"Outwrite - AI Writing Assistant","solutionId":"wa104381714","version":"4.2.0.0","description":"Write better everywhere with Outwrite\'s proofreading and paraphrasing tool","iconUrl":"24265.44fd0c0a-670c-4940-9d4a-ed3b74576b95.005f9722-a130-46d4-8ebf-c65a5bc3ef81.d1dd5745-4742-4a49-86b9-d9cc20daa98e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://outwrite.com/privacy","addinInfo":{"priority":3,"AUP":270}},{"displayName":"LanguageTool","solutionId":"wa104381727","version":"1.0.0.9","description":"Advanced spell and grammar checker","iconUrl":"30578.091db8b2-7164-4fa1-ba0e-12b186fa9d3f.69a95916-c102-4f4e-9fe0-d891c84d0925.9dbc2d81-9492-4743-824a-db1a191f4605.png","licenseUrl":"https://languagetool.org/legal/terms","privacyUrl":"https://languagetool.org/legal/privacy","addinInfo":{"priority":1,"AUP":704}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":-1,"AUP":206}},{"displayName":"MathType","solutionId":"wa104381909","version":"3.5.1.0","description":"Write math equations and chemical formulas in your documents and presentations with MathType.","iconUrl":"44741.813eee75-3ca3-4574-8852-d4a1ee5fd6fb.a6600903-ad52-41cc-a277-a99d413f741b.18009730-067c-46f9-a8f7-539cd53cbd6b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.wiris.com/en/mathtype-privacy-policy","addinInfo":{"priority":2,"AUP":2855}},{"displayName":"PolicyTech\u00ae Tools","solutionId":"wa104382046","version":"1.0.0.5","description":"Insert always up-to-date fields and links into securely stored PolicyTech\u00ae documents","iconUrl":"16192.0cc4c2a8-ba9f-46fd-843f-0da849b0a778.96177cd9-9568-4427-9e9c-3d4f85b12c3a.aafbd44f-5f1b-4745-96cf-86e320c1ab28.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.navexglobal.com/en-us/privacy-statement","addinInfo":{"priority":3,"AUP":1171}},{"displayName":"Mendeley Cite","solutionId":"wa104382081","version":"1.55.1.0","description":"Cite as you write. Generate citations and bibliographies and change your citation style.","iconUrl":"43392.23c5ae3a-3551-42b6-9ba6-5a9ac6c8ade4.14de091f-6544-45e8-b3a6-4a222e2ca359.f3ef8ae0-fa4a-46f7-9f22-7cb0e2e90fcd.png","licenseUrl":"https://www.mendeley.com/terms","privacyUrl":"https://www.elsevier.com/legal/privacy-policy","addinInfo":{"priority":1,"AUP":37759}},{"displayName":"Easy Syntax Highlighter","solutionId":"wa200000011","version":"1.0.1.0","description":"Code Syntax Highlighting for Word","iconUrl":"46879.e5d00319-8175-4ba7-9d6e-fdc1ea53abc5.228f1720-24bd-47ed-bbd3-59c73c454e5d.99fe41bb-6c5b-43f9-bc6d-585e984740bc.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://app.pyxll.com/word-syntax-highlighter/privacy.html","addinInfo":{"priority":3,"AUP":411}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":1512}},{"displayName":"PERRLA","solutionId":"wa200000199","version":"8.1.0.0","description":"Create perfect APA & MLA papers. We\u2019ve helped students write perfectly formatted papers since 1998.","iconUrl":"7448.ce605f46-4369-4795-8a16-68d19f80e425.1917fc48-bfda-4ecf-9fb8-aa43ce0dbed9.a79b9edf-f0d2-477c-b0c4-ba812278c907.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.perrlacomplete.com/PrivacyPolicy/WordAddIn","addinInfo":{"priority":3,"AUP":1663}},{"displayName":"QuillBot","solutionId":"wa200000368","version":"1.0.0.0","description":"Save time and immediately improve your writing with QuillBot\u2019s Paraphrasing and Summarizing Tool. ","iconUrl":"5821.0c33b03b-ab2a-4712-ba09-d11a2edcbca7.e48cfd16-849a-473d-bfaa-746249630244.a00131df-ab1c-47cc-bef5-8d22f76e49dc.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://word.quillbot.com/privacy.html","addinInfo":{"priority":1,"AUP":2949}},{"displayName":"Adobe Creative Cloud for Word and PowerPoint","solutionId":"wa200000729","version":"3.19.222.0","description":"Bring your creative elements into Microsoft Office. Creative Cloud app is required for this add-in.","iconUrl":"18500.2f664073-3b83-4944-804c-69c30f0e9064.600364c5-532a-4bb4-8ea4-627757d016c6.9c5597d2-2156-401e-8697-18cb65b7c13c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.adobe.com/go/privacy-policy","addinInfo":{"priority":2,"AUP":908}},{"displayName":"Grammarly for Microsoft Word","solutionId":"wa200001011","version":"1.2.0.0","description":"Compose clear, mistake-free writing with Grammarly for Microsoft Word on Mac.","iconUrl":"44160.caa10083-95fd-4aa5-9299-a40c68cdc829.9e6b7934-9a4d-4e0f-948d-4f54dafab3f8.df43bd30-714e-4369-803a-00c9491be63b.png","licenseUrl":"https://www.grammarly.com/terms","privacyUrl":"https://www.grammarly.com/privacy-policy","addinInfo":{"priority":1,"AUP":23962}},{"displayName":"Writefull","solutionId":"wa200001482","version":"1.0.5.0","description":"Writefull is automated proofreading for science.","iconUrl":"15661.6e967273-a217-48f5-afd0-9c2b8e777bb9.c564a228-3fcf-4b0c-a7f3-a972b79c328c.25cff90e-9ce9-4a8f-8745-6e60c4b9b659.png","licenseUrl":"https://www.writefull.com/terms.html","privacyUrl":"https://www.writefull.com/privacy.html","addinInfo":{"priority":2,"AUP":400}},{"displayName":"Corinth Screenshots","solutionId":"wa200001486","version":"1.0.0.0","description":"Sync the visual content of the Corinth app with your Office teaching materials","iconUrl":"51869.9a32c413-7910-4eea-8110-596bd8a40a09.a203af63-a892-4e73-b9ad-dcb325ba30f2.16ceca3f-8b79-45b4-8593-4dae5d022848.png","licenseUrl":"https://www.corinth3d.com/EULA","privacyUrl":"https://www.corinth3d.com/corinth-privacy-policy","addinInfo":{"priority":2,"AUP":21}},{"displayName":"Spell checker and Grammar checker by Scribens","solutionId":"wa200001841","version":"1.0.0.0","description":"A powerful spelling and grammar checker. Scribens corrects 250 types of grammar mistakes.","iconUrl":"26848.b2f1ecc7-4017-4115-ae79-09c086924cf5.3c1daf8c-bc5d-4ffb-b4eb-160b11006f27.68175203-816b-48fd-ac79-99d7038badec.png","licenseUrl":"https://www.scribens.fr/download/CGV_Scribens_MSOfficeExtension.txt","privacyUrl":"https://www.scribens.fr/download/CGV_Scribens_MSOfficeExtension.txt","addinInfo":{"priority":-1,"AUP":255}},{"displayName":"ProWritingAid for Microsoft Word","solutionId":"wa200002281","version":"1.0.0.0","description":"The best writing style and grammar checker for everything you write.","iconUrl":"47676.90dd7d5f-0d94-454f-b4f8-247593fefda6.32a96d9b-d1fb-487e-b93a-532357aec0f1.6355c122-c3b0-4f89-8f7a-e3e9a6c0adff.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://prowritingaid.com/en/Home/PrivacyWord","addinInfo":{"priority":2,"AUP":226}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":2517}},{"displayName":"Sciwheel","solutionId":"wa200002534","version":"6.0.0.0","description":"Cite effortlessly and format your bibliography with 7000+ styles, all without leaving Word. ","iconUrl":"53370.9d5750e6-7257-4e5e-9f38-9d2986f4b795.5095e0db-395b-4d89-8298-0231f31340b2.f4c9aecf-00d0-422f-ba8a-40f9991fa55f.png","licenseUrl":"https://sciwheel.com/work/legal/sciwheel-word-365-add-in-download-installation-terms-and-conditions/software-license-agreement","privacyUrl":"https://sciwheel.com/work/legal/sciwheel-word-365-add-in-privacy-notice","addinInfo":{"priority":2,"AUP":381}},{"displayName":"Citavi Assistant","solutionId":"wa200002891","version":"2021.3.29.10","description":"The Citavi Assistant automatically formats citations and bibliographies.","iconUrl":"41528.46a7367a-a31d-4175-9c32-fc8e30e8855a.21681137-d1cf-4b73-b8fb-15b7d87b6ef1.72153cd3-7603-49c4-b7d8-6895767a69a6.png","licenseUrl":"https://citavi.com/eula","privacyUrl":"https://citavi.com/privacy","addinInfo":{"priority":-1,"AUP":391}},{"displayName":"Impression Signatures","solutionId":"wa200003216","version":"1.0.0.0","description":"Securely sign and send documents for signature directly from Word and Excel.","iconUrl":"10171.55569ba6-8707-48a8-b3df-6e6413574914.d131bcfb-dba2-4b50-bccb-a2ad4f770edc.75c9fdcb-00dd-41b7-81f5-2637d24ad344.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.iubenda.com/privacy-policy/8039352/full-legal","addinInfo":{"priority":-1,"AUP":114}},{"displayName":"Personalised QR Code Generator","solutionId":"wa200003220","version":"1.0.0.0","description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":-1,"AUP":101}},{"displayName":"Wordtune","solutionId":"wa200003478","version":"1.0.0.0","description":"Wordtune helps you rewrite your text into a concise, engaging and well-written message.","iconUrl":"24151.f6b24171-2782-4f28-8af6-e38438631fbe.91ba765d-d20e-4d2e-9486-a3a498a5b3a1.7e060834-f678-403e-8cc9-4b80c9f87d7f.png","licenseUrl":"https://www.wordtune.com/terms-of-use","privacyUrl":"https://www.wordtune.com/privacy-policy","addinInfo":{"priority":1,"AUP":476}},{"displayName":"Read on reMarkable","solutionId":"wa200003915","version":"2.0.0.0","description":"Easily send Word and PowerPoint documents to your reMarkable.","iconUrl":"7364.f24d322e-3985-4b36-9f2b-d1a92a90534c.43df7b3a-e5a9-4d72-ad4c-53ba599d45c7.1c530b09-8be4-40d7-878f-1bacd2fd0bce.png","licenseUrl":"https://support.remarkable.com/hc/en-us/articles/360000282757-reMarkable-End-User-License-Agreement","privacyUrl":"https://support.remarkable.com/hc/en-us/sections/360000090338-Privacy-Policy","addinInfo":{"priority":-1,"AUP":549}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint - Government","solutionId":"wa200003944","version":"1.1.0.1","description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"36564.aa7b92f6-ad15-4d7f-9951-1891d6c9b744.bab76294-ed68-4ac6-b148-791343322826.105c41f6-ff06-4b30-8a37-a9168d40cfee.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":-1,"AUP":10144}},{"displayName":"Draft Coach","solutionId":"wa200004257","version":"1.1.121.0","description":"Formative writing feedback for students: available for Turnitin customers","iconUrl":"32351.26374e0d-06e7-47bd-b6cb-0a1e5e54f167.a165e027-3385-42db-bc1e-38bcbb939a51.ffef3075-692f-4d29-a0e2-b1ca1925b0d4.png","licenseUrl":"https://help.turnitin.com/Privacy_and_Security/Privacy_and_Security.htm#Usage_Policy","privacyUrl":"https://help.turnitin.com/Privacy_and_Security/Privacy_and_Security.htm","addinInfo":{"priority":3,"AUP":17823}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.1.0.0","description":"Introducing Ghostwriter OpenAI ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":1,"AUP":533}},{"displayName":"Legal AI Assistant","solutionId":"wa200005260","version":"1.0.0.0","description":"This add-in is designed to assist users in generating contracts and adding missing clauses using AI","iconUrl":"63548.f4c25bf7-14f2-46fe-9e82-501e47cf4e22.89c55224-07c3-47f2-ad1c-74f01a5391f8.c3bdc80b-1ae3-468f-adbe-d1bf1206b422.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://e-arbitrator.com/legal-ai-privacy-policy","addinInfo":{"priority":2,"AUP":111}},{"displayName":"GenText AI Assistant","solutionId":"wa200005287","version":"1.0.0.2","description":"GenText is an AI Assistant developed to help business professionals write reports","iconUrl":"39094.562d3128-5997-43ce-aded-f5b52b966432.c9dbaa0c-35ee-443a-8942-03744376197e.97368fc6-d794-4d0e-8282-a96670ef2828.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://gentext.ai/privacy","addinInfo":{"priority":2,"AUP":138}},{"displayName":"TrustSigner","solutionId":"wa200005298","version":"1.0.0.0","description":"Sign documents fast, secure and affordable. Made in EU with legal binding.","iconUrl":"24353.f2399955-265f-4d0e-9e27-45e114545472.ebc76c58-2921-4d53-84bc-fefad793b03d.fc65492d-5b37-41f9-aca4-ca5b72c3a5a9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://trustsigner.eu/privacy","addinInfo":{"priority":2,"AUP":23}},{"displayName":"Ghostwriter Consultant Edition","solutionId":"wa200005312","version":"1.5.0.0","description":"Ghostwriter Consultant with ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"36233.163ead30-016b-4591-a5b9-f2d2930e5403.bdc1efa7-a706-48f0-baf7-d76c2c5222ef.601d7792-1b34-4021-b4e7-15435a733bf1.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":2,"AUP":355}},{"displayName":"Dall-e Image Generator","solutionId":"wa200005313","version":"1.0.0.2","description":"Use AI to generate unique and stunning images based on the descriptive text within a document. ","iconUrl":"31431.4f416b91-4c5c-4aa1-b737-8aa50d8c65dc.bde80e16-2c77-4064-9ad7-a99a077ef64a.c508525c-965d-44b5-aec8-deb21c6941df.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.pegamento.nl/en/terms-conditions-text-to-image-extension","addinInfo":{"priority":2,"AUP":56}},{"displayName":"DrillBit-Plagiarism","solutionId":"wa200005339","version":"1.0.0.4","description":"Plagiarism detection software to detect similar or copied content.","iconUrl":"23545.e4fc7991-8bb7-408e-ad63-b9ab3b164d86.5c4bfb60-fbec-489d-a4dd-d294bfea0c0e.d48a04e3-6609-4d98-bcda-7e70107b93bc.png","licenseUrl":"https://drillbitplagiarism.com/termsCondition","privacyUrl":"https://drillbitplagiarism.com/customerHelp","addinInfo":{"priority":2,"AUP":17}},{"displayName":"Ghostwriter Legal","solutionId":"wa200005348","version":"1.5.0.0","description":"Ghostwriter Legal with ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"19401.a89bf831-da40-48cb-aea0-9fdb99d2dfb6.24bb5297-c19d-4109-9ddc-4233c6565136.3d1468c5-2f55-4362-815a-846fdf9c7167.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":2,"AUP":34}},{"displayName":"Ghostwriter Education","solutionId":"wa200005360","version":"1.5.0.0","description":"Ghostwriter Education with ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"64228.96000578-f337-4e2a-9458-bf4f19bfed19.965f3cd0-f0cb-4f83-b18e-a1bba1290eab.8dd5e85f-59af-439e-9136-92bebf18e1d6.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":2,"AUP":23}},{"displayName":"Spellbook","solutionId":"WA200004774","version":"1.2.0.0","description":"AI assistant for contract drafting & reviews","iconUrl":"https://store-images.s-microsoft.com/image/apps.2248.98a244f3-017a-4ff1-9a57-51c9bcb8dc52.3da7c824-0fd2-42df-9da5-5512230625d7.0dbc3752-ca78-4b17-a8be-82dc9cd273e7.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://spellbook.legal/privacy-policy","addinInfo":{"priority":3,"AUP":320}},{"displayName":"GPTZero","solutionId":"WA200005444","version":"1.0.0.0","description":"GPTZero detects AI-generated text right inside Word. Just highlight and get results!","iconUrl":"https://store-images.s-microsoft.com/image/apps.50366.6301eda2-a871-4076-b79c-e43711f93b87.450815d6-a39d-4d11-8105-54c6a6fcf733.6a7be30c-a1db-4b14-834e-4b6d149bb1fa.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://gptzero.me/privacy-policy.html","addinInfo":{"priority":1,"AUP":227}}]'}get San(){return!!this.Ga&&
this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UserInstalledAddinCommandValueIdEnabled",!0)}get Qea(){return this.QNe}set Qea(e){z.ULS.sendTraceTag(508830282,220,50,"commandRegistrationState: {0} --\x3e {1}",sf[this.QNe],sf[e]);this.QNe=e}static Mtb(e){return 0===e||10===e}static z7(e){return Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.storeType,e.assetId,null,null,e.storeId)}static Tf(e){return!e||!e.length}}Object(y.a)(fn,"AppsForOfficeUIActor",null,[13,1353]);var aq=
d(417),Hq=d(127),cl=d(36);class Iq{constructor(){this.onTabKeyDown=this.onExecute=this.icon=this.label=null}}Object(y.a)(Iq,"TaskPaneHeaderButtonProps",null,[]);var pq=d(242);class Xq{constructor(e,t,E){this.D7a=E;this.RJh=this.PJh=null;this.wGo=()=>{this.Zxn();this.hyc(this.RJh,this.PJh)};this.foc=W=>W===M.a.vla;this.o2=e;this.CCb=t}tS(e,t){this.RJh=e;this.PJh=t;this.D7a.Y_c(this.wGo)}Zxn(){this.CCb=ob.a.instance.Oa("Common.App.ICustomerFeedbackUiWrapper")}hyc(e,t){e={};t&&(e.query=t.Yg);if(this.o2){const E=
Object.assign(new Aa.a,{taskPaneWidth:352});v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Ib&&v.AFrameworkApplication.ua.Ib.mee&&(E.isResizable=!0,E.resizeMinWidth=352,E.resizeMaxWidth=920);switch(t.actionId){case M.a.M6h:e.query="contactsupport";E.xS=WoncaIntl.WoncaStrings.L_ContactSupport;E.sourceLocationOverrideResourceId="Help.ContactSupport.Url";break;case M.a.vla:E.xS=WoncaIntl.WoncaStrings.L_GiveFeedback;E.sourceLocationOverrideResourceId="Help.GiveFeedback.Url";e.feedback=this.myi(t);
break;case M.a.q2j:e.query="showtraining";E.xS=WoncaIntl.WoncaStrings.L_Training;break;case M.a.XOg:e.query="whatsnew";E.xS=WoncaIntl.WoncaStrings.L_WhatsNew;break;default:E.xS=WoncaIntl.WoncaStrings.L_Help}E.gS=e;v.AFrameworkApplication.K&&v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.WordOnline.OcvFeedbackDelayTaskpane")?this.foc(t.actionId)?this.hUj("FA000000012",E,t):(E.isModernPane=!0,this.o2.B4("FA000000012",E)):this.o2.B4("FA000000012",E)}}myi(e){e=e.rd;v.AFrameworkApplication.K.jRd(e);
e=this.CCb.getContext(e);let t={};"telemetryGroup"in e&&(t=e.telemetryGroup);t.processSessionId=e.sessionId;t.officeBuild=e.build;e.telemetryGroup=t;if(void 0===e.feedbackType||null===e.feedbackType)e.feedbackType=-1;e.disableIncludeScreenshot="disableIncludeScreenshot"in e?e.disableIncludeScreenshot:!1;e.screenshot="screenshot"in e?e.screenshot:!0;e.disableScreenshotPreview=!1;e.includeScreenshotSelectedDefault=!0;return e}hUj(e,t,E,W=300){this.CCb.vjf()?(t.gS.feedback=this.myi(E),this.o2.B4(e,t)):
this.ePl(W).then(()=>{this.hUj(e,t,E,2*W)})}fta(){this.o2&&this.o2.unb("FA000000012")}dispose(){}ePl(e){return new Promise(t=>{window.setTimeout(()=>{t(null)},e)})}}Object(y.a)(Xq,"AgaveAssistancePane",null,[974,13]);class Dp{constructor(e){this.LLk=e}onRegisterRichApiEvent(){}onUnregisterRichApiEvent(){}sendRichApiMessageEventEntriesToControl(e,t){this.LLk.rpb(e,t)}}Object(y.a)(Dp,"RichApiEventManagerHost",null,[1251]);class io{constructor(){this.Fg=new gf.a}UH(e){this.Kr(e,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}Kr(e,
t){if(e){var E={};E.Error=t;e(E)}}}Object(y.a)(io,"ApiEvent",null,[]);class dl extends io{constructor(){super();this.kg=null}}Object(y.a)(dl,"WordEditorApiEvent",io,[]);class Nn extends dl{constructor(){super();this.r7e=null}addHandler(e,t,E,W){this.kg&&ab.b(W)?(this.r7e||(this.r7e=new Dp(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.r7e)),this.Fg.Z(e,t),z.ULS.sendTraceTag(41513415,341,50,"Add RichApiMessage event handler for control: {0}.",e),this.UH(E)):this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(e,
t,E){this.kg&&ab.b(E)&&this.Fg.mb(e)?(this.Fg.remove(e),z.ULS.sendTraceTag(41513416,341,50,"Remove RichApiMessage event for control: {0}.",e),this.UH(t)):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}gC(){}rpb(e,t){const E={};E[OSF.DDA.Marshaling.UniqueArgumentKeys.ArrayData]=t;this.Fg.mb(e)&&this.Fg.J(e)(E)}N3d(e,t){this.rpb(e,[[65536,65539,"",Nn.EDl(t),-1,!1]])}bDl(e,t){return[[2,1E3,"",JSON.stringify([e,t]),0,!1]]}static EDl(e){const t={};t.visibility=e?"Visible":"Hidden";return JSON.stringify(t)}static get instance(){return null!=
Nn.DZg?Nn.DZg:Nn.DZg=new Nn}}Object(y.a)(Nn,"RichApiMessageEvent",dl,[]);class sj{constructor(){this.iconUrl=this.title=this.id=null;this.isVisible=!1;this.oWb=this.A1b=this.Uvb=this.GB=null;this.nae=!1}}Object(y.a)(sj,"ReactAppsForOfficeTaskPaneData",null,[]);var ig=d(1139),om=d(317),xh=d(149);class sl{constructor(e,t,E){this.PNc=0;this.lya=e;this.Ch=t;this.wTg=E}start(){this.PNc||(this.PNc=window.setInterval(()=>{OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(this.Ch.BVa(this.wTg),sl.YAm,
null,(e,t)=>{e?z.ULS.sendTraceTag(591177106,3011,10,"Failed to send message to transcription pane, status: {0}.",e):this.YTm(t)})},sl.oMn))}stop(){this.PNc&&(window.clearInterval(this.PNc),this.PNc=0)}YTm(e){if(e&&e.completedContext){var t;if(({Zu:t}=qe.d(e.completedContext)).returnValue&&t)for(e=0;e<t.length;e++)this.JXm(t[e])}}JXm(e){if(e[sl.h9f]&&e[sl.h9f]===sl.DEo&&e[sl.Hld]&&e[sl.eGj])this.lya.KXm(e[sl.eGj],e).then(t=>{this.zo(e[sl.Hld],t)}).catch(t=>{const E={};E[sl.Ili]=t;this.zo(e[sl.Hld],
E)});else{const t={};t[sl.Ili]=sl.Fbn;this.zo(e[sl.Hld],t)}}zo(e,t){t[sl.Hmp]=!0;t[sl.h9f]=sl.PGo;t[sl.Hld]=e;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(this.Ch.BVa(this.wTg),sl.Q5k,t,E=>{E&&z.ULS.sendTraceTag(591152963,3011,10,"Failed to send message to transcription pane, status: {0}.",E)})}}sl.Q5k="onTranscriptionHostMessage";sl.YAm="getNewTranscriptionMessages";sl.Hmp="transcription_message";sl.h9f="messageType";sl.eGj="requestType";sl.Hld="requestId";sl.DEo="request";sl.PGo="response";
sl.oMn=3E3;sl.Ili="error";sl.Fbn="invalidMessage";Object(y.a)(sl,"TranscriptionAddInMessaging",null,[]);var zg=d(1121);class Gr{constructor(e,t){this.Olb=e;this.WCb=t}L6l(e){let t;t=this.M6l(e);0==t.length&&(t=this.K6l(e));return t}K6l(e){if(!this.WCb||!this.WCb.customProperties)return"";var t=this.WCb.customProperties.getItemOrNullObject("StoredTranscription");t=t?t.value:"";if(isNullOrUndefined(t)||0==t.length)return"";z.ULS.sendTraceTag(512522206,3011,50,"Fetched Transcription From Custom property storage");
e(!0);return t}M6l(e){if(!this.Olb)return z.ULS.sendTraceTag(512522205,3011,10,"CustomXMLManager object is NULL"),"";var t=this.Olb.o6d("http://schemas.microsoft.com/office/transcription/2022");if(isNullOrUndefined(t)||0==t.length)return"";t=t[0].getValue(fd.a.C7a);if(isNullOrUndefined(t)||0==t.length)return z.ULS.sendTraceTag(512522204,3011,10,"Not able to get the transcription data from XML Node"),"";t=(new DOMParser).parseFromString(t,"text/xml");if(!isNullOrUndefined(t)&&!isNullOrUndefined(t.lastChild)){t=
t.lastChild.textContent;if(isNullOrUndefined(t)||0==t.length)return"";z.ULS.sendTraceTag(512522207,3011,50,"Fetched Transcription From XML Storage");e(!1);return t}return""}}Object(y.a)(Gr,"TranscriptionDocumentStorageManager",null,[]);class yh{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc){this.Olb=null;this.Oxa="TranscriptionPane";this.$If=()=>{const md=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse").toLowerCase();return"string"==typeof md&&md.includes("inner ring")?
"DOGFOOD":"string"==typeof md&&md.includes("outer ring")?"MICROSOFT":"PRODUCTION"};this.N3n=()=>{z.ULS.sendTraceTag(594331858,3011,50,"Transcription pane closed by user.");const md=this.OJi();md.PaneOpenDurationInSecs=((performance.now()-this.azh)/1E3).toFixed(2);this.q5a.IOo(md);this.azh=0;this.QIh.stop()};this.B5a=e;this.Ch=t;this.WCb=E;this.q5a=W;this.Ga=ha;this.nHb=Ka;this.YQk=sb;this.QIh=new sl(this.YQk,this.Ch,yh.vwc);this.Pya=dc;this.Olb=Rc;this.bJb=xc;this.Fe=om.a.getInstance(yh.Gmp)}load(){z.ULS.sendTraceTag(51667731,
3011,50,"Loading Transcription pane.");this.B5a&&(this.B5a.Toc=!0)}OJi(){const e={},t=window.navigator;if(t){const E=t.connection||t.mozConnection||t.webkitConnection;E&&(e.DeviceNetDownLink=E.downlink,e.EffectiveNetworkType=E.effectiveType);e.IsOnline=t.onLine}return e}v8o(e){if(1===e)return 32;z.ULS.sendTraceTag(51667732,3011,50,"User intended to show Transcription Pane.");this.Fe.logKpiUsage({kpiName:this.Oxa,kpiType:0});this.azh=performance.now();this.q5a.KOo(this.OJi());this.B5a&&!this.B5a.Toc&&
this.load();if(!this.Ch)return z.ULS.sendTraceTag(51667733,3011,10,"Failed to show Transcription pane, null object of AppsForOfficeUiActor"),this.Fe.logKpiFailure({kpiName:this.Oxa,errorName:"FailedToTriggerPaneLaunch"}),16;e=xh.a.get("TeachingUIShowCount");e=parseInt(e);if(isNaN(e)||!isFinite(e))e=0;const t={};t.IsProductionEnvironment=(2===v.AFrameworkApplication.Paa).toString();t.TranscriptionSessionId=this.q5a.Gbf;t.AugLoopCloudALServiceUrl=this.Ga.kb("AugLoopCloudALServiceUrl");t.DocumentStorageType=
"DocumentXmlStorage";let E=!1;const W=(new Gr(this.Olb,this.WCb)).L6l(Ka=>{E=Ka});t.HasStoredTranscription=(0!=W.length).toString();t.StoredTranscription=W;t.IsTranscriptionFetchedFromCustomProperties=E.toString();Object(zg.b)()?t.MonthlyMinutesUsed=this.bJb.G7c:t.MonthlyMinutesUsed=this.nHb.G7c;t.TeachingUIShowCount=e;t.FrontDoorBaseUrl=this.Ga.kb("DictationFrontdoorDomain");t.DefaultTranscriptionLocale=this.B5a.locale;t.EnableSetAnnotationsFromALVoiceClient=(!!v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableSetAnnotationsFromALVoiceClient",
!0)||v.AFrameworkApplication.K.$("SetAnnotationsFromALVoiceClient"))).toString();t.UnlimitedMins="true";t.ALSessionInitRetryEnabled=(!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.ALSessionInitRetryEnabled",!1)).toString();t.RoamingCallsRetry=(!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.RoamingCallsRetry",!1)).toString();t.FileSizeUploadLimit=3E8;t.isSharedUXDarkModeOn=
this.aLf().toString();t.UserTenantId=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.kb("TenantId").toString()||"";t.IsTranscriptionNewFlowEnabled=(!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.IsTranscriptionNewFlowEnabled",!1)).toString();t.ShouldSkipUpnCheck=(!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.ShouldSkipUpnCheck",!1)).toString();t.EnableFlightAuthVersion=
(!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.EnableFlightAuthVersion",!1)).toString();t.UseOfficeJsApiForLanguages=(!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.UseOfficeJsApiForLanguages",!1)).toString();t.IsAddToDocumentCallbackEnabled=(!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.IsAddToDocumentCallbackEnabled",
!1)).toString();t.Audience=this.$If();const ha=Object.assign(new Aa.a,{taskPaneWidth:330,isResizable:!0,resizeMinWidth:330,resizeMaxWidth:920,isModernPane:!0,xS:WordEditorIntl.WordEditorStrings.L_TranscriptionPaneTitle,onTaskPaneClose:this.N3n,gS:t,sourceLocationOverrideResourceId:this.bPm()});return this.Pya?(this.Pya.initialized.then(()=>{ha.gS.IsFreemiumUpsellEnabled=this.Pya.isFreemiumUpsellEnabled.toString();ha.gS.IsLicensedUser=this.Pya.a_f.toString();this.lpi(ha,!this.Pya.isFreemiumUpsellEnabled||
this.Pya.a_f)}),32):this.lpi(ha,!0)}aLf(){return Sf.a("isSharedUXDarkModeOn")?appChrome.api.isSharedUXDarkModeOn():!1}bPm(){return"DOGFOOD"==this.$If()||"MICROSOFT"==this.$If()?"Taskpane_Dogfood.Url":"Taskpane.Url"}lpi(e,t){this.q5a.lOo(t);if(e=this.Ch.B4(yh.vwc,e,!0))this.B5a.lZm=!0;else return this.q5a.LOo(e),z.ULS.sendTraceTag(587309125,3011,10,"Failed to show Transcription pane."),this.Fe.logKpiFailure({kpiName:this.Oxa,errorName:"FailedToShowPane"}),16;this.QIh.start();this.Fe.logKpiSuccess({kpiName:this.Oxa});
return 32}v0m(e){if(1===e)return 32;z.ULS.sendTraceTag(51667735,3011,50,"User intended to close Transcription pane.");if(!this.Ch)return z.ULS.sendTraceTag(51667736,3011,10,"Failed to close Transcription pane, null object of AppsForOfficeUiActor"),this.Fe.logKpiFailure({kpiName:this.Oxa,errorName:"FailedToClosePane"}),16;this.Ch.unb(yh.vwc);return 32}Tuc(e,t,E,W,ha){if(1===E)return 32;if(!this.Ch)return z.ULS.sendTraceTag(51667737,3011,10,"Failed to QueryToggle Transcription pane, null object of AppsForOfficeUiActor"),
16;ha&&(ha[ya.a.On]=this.Ch.CU(yh.vwc));return 32}kAj(){console.log("refreshMinutes minified");Object(zg.b)()?this.bJb.uOb():this.nHb.uOb()}}yh.vwc="FA000000051";yh.Gmp={topLevelKpiName:"TranscribeFeatureUsage",featureName:"Transcribe",crewAlias:"VoiceTransEngg",areaName:"ContentCreation"};Object(y.a)(yh,"TranscriptionAddIn",null,[1250]);class qq{constructor(){this.type="EmbeddedTaskPaneProps";this.uniqueID=this.getContent=null;this.isSharedRuntimePane=!1;this.feedbackTaskPaneProps=this.addinSharingTaskPaneProps=
null}}Object(y.a)(qq,"WordAddInTaskPaneProps",null,[]);class fm{constructor(){this.rightActionButtonProps=null;this.canBeShared=!0}}Object(y.a)(fm,"AddinSharingProps",null,[]);class nl{constructor(){this.type="AddinSharingTaskPaneProps";this.assetId=this.sharingLink=this.iconUrl="";this.copySuccessCallback=null}}Object(y.a)(nl,"AddinSharingTaskPaneProps",null,[]);var kn=d(147);class fs{constructor(e){this.lOe="AppsForOfficeReactContainer";this.Oqk="TaskPaneCloseBtn";this.SMk="TaskPaneRightActionButton";
this.Uok="FA000000012";this.q6=e||eh.a.instance;this.Do=new gf.a;this.wGa=new gf.a;this.wGa.add("FA000000012","Help");this.wGa.add("FA000000012.Help.GiveFeedback.Url","Feedback");this.wGa.add("FA000000002","Translator");this.wGa.add("FA000000006","Search");this.wGa.add("FA000000029","Editor");this.wGa.add("FA000000085","AcronymsWeb");this.wGa.add(yh.vwc,"Transcription")}t0(e){return this.Do.mb(e)?this.Do.J(e).isVisible:!1}tUa(e){const t=this.Do.J(e);t.isVisible&&(t.isVisible=!1,Ya.UISurfaces.Hv().then(E=>
{E.hideTaskPane(t.id,2);return null}))}Rzo(e){this.Do.remove(e)}rlc(e){return this.Do.mb(e)?this.Do.J(e).id:null}showTaskPane(e,t,E,W,ha=null,Ka=null){this.q6.NUa();if(this.Do.mb(e))this.Do.J(e).GB.isPaneAutoOpened=E.isPaneAutoOpened,v.AFrameworkApplication.K&&v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.WordOnline.OcvFeedbackRefreshActivationInfo")&&this.foc(e)&&(this.Do.J(e).GB.settings.feedback=E.settings.feedback);else{var sb=document.createElement("div");sb.className=this.lOe;
sb.id=this.lOe+E.id;E.div=sb;sb=String.format("AppForOfficePanel{0}",this.Do.count);let dc;for(const xc of this.Do.keys)if(dc=this.Do.J(xc),dc.id==sb){sb=String.format("AppForOfficePanel{0}|{1}",this.Do.count,E.id);break}this.Do.add(e,Object.assign(new sj,{id:sb,title:t,GB:E,isVisible:!1,Uvb:Ka,oWb:ha,nae:!1}))}this.Upd(e,W)}INm(e){return this.Do.mb(e)?this.Do.J(e).GB.backgroundState:zk.Dbe}ZYo(e,t){this.Do.mb(e)&&(this.Do.J(e).GB.backgroundState=t)}S9d(e){return this.Do.mb(e)?this.Do.J(e).GB:null}iUm(e,
t){t===OSF.AgaveHostAction.TabExitShift?this.f4d(e):t===OSF.AgaveHostAction.TabExit&&(e=this.Do.J(e),this.isResizable(e)?Ya.UISurfaces.Hv().then(E=>{E.focusResizeHandle();return null}):Ni.FocusManager.instance().Bod(kn.a.hzc))}J8l(e){if(this.wGa.mb(e))return this.wGa.J(e);for(const t of this.wGa.keys)if(!e.indexOf(t))return this.wGa.J(t);return null}f4d(e){(e=this.Do.J(e).A1b)&&e.querySelector("[data-unique-id^='"+this.Oqk+"']").focus()}getContent(e){return()=>this.Do.J(e).GB.div}egm(e){return this.Do.J(e).GB}getAssetId(e){const t=
this.Do.J(e).GB,E=/^WA\d{9}/i;let W;E.test(t.ownerAddinSolutionId)?W=E.exec(t.ownerAddinSolutionId)[0]:E.test(t.solutionId)?W=E.exec(t.solutionId)[0]:E.test(t.assetId)?W=E.exec(t.assetId)[0]:E.test(t.storeId)?W=E.exec(t.storeId)[0]:E.test(e)&&(W=E.exec(e)[0]);return W}WIi(e,t,E,W){return()=>{cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:"Office.Extensibility.Host.AddinSharing",dataFields:[{name:"AssetId",string:Telemetry.PrivacyRules.GetPrivacyCompliantId(e.solutionId,e.storeType,t,null,null,
e.storeId)},{name:"ActionType",string:E},{name:"CorrelationId",string:W}]}))}}Upd(e,t){const E=this.Do.J(e).id,W=ha=>{ha=this.Do.J(ha).A1b.querySelector("[data-unique-id^='"+this.SMk+"']");this.$zb(ha)};Ya.UISurfaces.Hv().then(ha=>{t?ha.doNotUse_InitializePersistedTaskPane(E,this.MB(e,t)):(this.Do.J(e).isVisible?ha.setSelectedTaskPane(E):ha.showTaskPane(E,this.MB(e)),this.Do.J(e).GB.isPaneAutoOpened||(this.foc(e)?(ha=document.getElementById(this.Do.J(e).A1b.id),Ni.FocusManager.ZN(ha)):(ha=document.getElementById(this.Do.J(e).GB.id),
Ni.FocusManager.ZN(ha.contentWindow))),v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowAddInSharingTeachingCalloutIsEnabled",!1)&&W(e));return null})}$zb(e){const t=ob.a.instance.Qa("Common.ISystemInitiatedFeedback");t&&e?(e.setAttribute("lpp-id","addInTaskPaneShareButton"),t.execute(E=>{E.logActivity("ShowTeachingCalloutForAddinSharingButton",null);z.ULS.sendTraceTag(526989395,341,50,"triggerLPPActivity triggered an LPP activity")})):z.ULS.sendTraceTag(526989394,
341,15,"triggerLPPActivity failed to get a sifFuture")}MB(e,t=!1){var E=new qq;E.getContent=this.getContent(e);E.uniqueID=this.J8l(e);const W=this.Do.J(e);W.GB.sharedRuntimeId&&(E.isSharedRuntimePane=!0);var ha=this.getAssetId(e);const Ka=this.egm(e),sb=Hb.a.create().hu.toString();ha&&(E.addinSharingTaskPaneProps={type:"AddinSharingTaskPaneProps",iconUrl:this.Do.J(e).iconUrl,sharingLink:`https://appsource.microsoft.com/product/office/${ha}?ocid=PROD_OfficeApps_CONS_OCMA_ACQ_OfficeOnline_shareViaLinkOnWacWord&correlationId=${sb}`,
assetId:ha,copySuccessCallback:this.WIi(Ka,ha,"copy",sb)});const dc=new fm;dc.canBeShared=!!ha;dc.rightActionButtonProps=ha?{onExecute:this.WIi(Ka,ha,"share",sb)}:void 0;E=Object.assign(new ig.a,dc,{title:this.Do.J(e).title,titleTag:this.Do.J(e).GB.titleTag,iconUrl:this.Do.J(e).iconUrl,hideHeader:!1,width:this.Do.J(e).GB.taskPaneWidth,location:2,contentProps:E,isModernPane:W.GB.isModernPane,onOpen:xc=>{t||(W.isVisible=!0);this.Do.J(e).A1b=xc;Cc.StaticActiveAppFrame.za().Ie()},onClose:()=>{if(!t){W.nae=
!1;const xc=W.Uvb;xc&&xc(e);W.isVisible=!1}Cc.StaticActiveAppFrame.za().Ie()},onCloseButtonTabKeyDown:xc=>{if(W.oWb){const Rc=xc.shiftKey?OSF.AgaveHostAction.TabInShift:OSF.AgaveHostAction.TabIn;Rc===OSF.AgaveHostAction.TabIn?this.foc(e)?(xc=document.getElementById(this.Do.J(e).A1b.id),Ni.FocusManager.ZN(xc)):(xc.preventDefault(),W.oWb(e,Rc)):W.nae||(xc.preventDefault(),Ya.UISurfaces.Hv().then(md=>{this.dfj(md,W,e,Rc);return null}))}},enableResize:W.GB.isResizable,minResizeWidth:W.GB.resizeMinWidth,
maxResizeWidth:W.GB.resizeMaxWidth,showResizeChatButton:this.Do.J(e).GB.showResizeChatButton,isPaneAutoOpened:W.GB.isPaneAutoOpened||t});v.AFrameworkApplication.K&&!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddingSharingIsEnabled",!1)&&(E.canBeShared=void 0,E.rightActionButtonProps=void 0,E.contentProps.addinSharingTaskPaneProps=void 0);this.foc(e)&&(ha=JSON.parse(W.GB.settings.feedback),ha={...E.contentProps,type:"OcvFeedbackTaskPaneProps",hideHeader:!1,feedbackTaskPaneProps:{customerUiWrapperFeedbackData:ha,
taskPaneLocation:E.location,taskPaneIdToClose:this.Do.J(e).id}},E.contentProps=ha);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.WordOnline.HeaderIconURL")&&"fa000000125"==e.toLowerCase()&&(E.iconId="fa000000125",E.headerIconUrl="https://fa000000121.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.1.2303.9002/en-us_web/assets/M365Blue.svg");return E}foc(e){return this.Do.mb(e)?"Help.GiveFeedback.Url"===this.Do.J(e).GB.sourceLocationOverrideResourceId:
!1}A2b(e,t){this.Do.mb(e)&&(this.Do.J(e).title=t,this.C9j(e))}CFe(e,t){this.Do.mb(e)&&(this.Do.J(e).iconUrl=t,this.C9j(e))}C9j(e){Ya.UISurfaces.Hv().then(t=>{t.updateTaskPane(this.Do.J(e).id,this.MB(e));return null})}B9j(e,t){if(this.Do.mb(e)){const E=this.Do.J(e);E.nae=!0;Ya.UISurfaces.Hv().then(W=>{const ha=this.MB(e);ha.actionButtonProps=t;ha.actionButtonProps.onTabKeyDown=Ka=>{Ka.shiftKey&&E.oWb&&(Ka.preventDefault(),this.dfj(W,E,e,OSF.AgaveHostAction.TabInShift))};W.updateTaskPane(this.Do.J(e).id,
ha);return null})}}dfj(e,t,E,W){2<=e.selectors.getTabbedTaskPaneCount()?e.focusTabbedTaskPaneArea():this.isResizable(t)?e.focusResizeHandle():t.oWb(E,W)}M4c(e){return this.Do.mb(e)?this.Do.J(e).title:null}VIi(e){return this.Do.mb(e)?this.Do.J(e).iconUrl:null}dispose(){}cEe(e){let t=null;e=e.toLowerCase();for(const E of this.Do.keys){let W=e;E.toLowerCase()!==this.Uok.toLowerCase()&&(W=e.substring(0,E.length));if(W===E.toLowerCase())return t=E,{returnValue:!0,XUc:t}}return{returnValue:!1,XUc:t}}B3c(e){return this.lOe+
e}isResizable(e){return!!e&&!!e.GB&&e.GB.isResizable}}Object(y.a)(fs,"ReactWordEditorAppsForOfficeUIManager",null,[1243]);class vk extends fn{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id=null){super(e,t,E,W,ha,Ka,sb,xc,md);this.rdm={["fa000000059"]:!0,["FA000000002"]:!0};this.QJd=new fa.a;this.JWl=()=>{for(const Ee of this.QJd)this.Zdo(Ee)};this.gef=(Ee,kf,Ke)=>{if(2!==Ke)return Ee!==Fa.a.$ze||this.sTj()?aq.SessionStatusManager.instance.Gk||pq.a.Sla(kf.Hk)?8:32:16;kf=this.CU("FA000000002.Ogma.Document.Url")?
"FA000000002.Ogma.Document.Url":this.CU("FA000000002.Ogma.Settings.Url")?"FA000000002.Ogma.Settings.Url":"FA000000002.Ogma.Lookup.Url";Ee=Ee===Fa.a.Zze?"Ogma.Cdn.Document.Url":Ee===Fa.a.$ze?"Ogma.Cdn.Settings.Url":"Ogma.Cdn.Lookup.Url";kf!=="FA000000002."+Ee&&this.CU(kf)&&(z.ULS.sendTraceTag(39145870,399,50,"Closing Modern Translator task pane with Office CDN is used"),this.unb(kf));z.ULS.sendTraceTag(39145871,399,50,"Opening Modern Translator task pane with Office CDN is used");kf={};kf.Locale=v.AFrameworkApplication.K.kb("ModernTranslatorLocale");
kf.SessionId=v.AFrameworkApplication.userSessionId;kf.UserId=v.AFrameworkApplication.K.kb("ModernTranslatorLoggableUserId");kf.MachineId=v.AFrameworkApplication.K.kb("ModernTranslatorMachineId");kf.AugLoopUrl=v.AFrameworkApplication.K.kb("AugLoopCloudALServiceUrl");kf.ReadingMode=2===Hf.WoncaApp.instance.Dma?"true":"false";kf.DocProtected=v.AFrameworkApplication.O0?"true":"false";kf.DisableEdit=!S.App.Et||S.App.pn||S.App.K3&&v.AFrameworkApplication.nw?"true":"false";kf.DisableCopyCut=v.AFrameworkApplication.K.$("DisablePrint")&&
v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")?"true":"false";kf.Reason=(0).toString();kf.UseGoToTranslatedDocument="true";kf.MicrofeedbackWacEnabled=v.AFrameworkApplication.K.$("MicrofeedbackSurveyIsEnabled");Ke=ob.a.instance.Oa("WordEditor.TranslatorRoamingServiceManager");kf.SettingsEnabled=Ke?v.AFrameworkApplication.K.$("LanguageIntelligentSuggestionIsEnabled")&&void 0!==Ke.A0a&&null!==Ke.A0a&&""!==Ke.A0a.trim()?"true":"false":"false";Ke=new Aa.a;Ke.gS=kf;Ke.sourceLocationOverrideResourceId=
Ee;Ke.xS=WordEditorIntl.WordEditorStrings.L_ModernTranslatorTaskPaneTitle;Ke.isModernPane=!0;Ee=v.AFrameworkApplication.K.$("LanguageTranslationIsEnabled");(Ee=this.B4("FA000000002",Ke,Ee))||z.ULS.sendTraceTag(42074889,399,10,"Modern Translator task pane failed to display with Office CDN is used");return Ee?32:16};this.Sse=(Ee,kf,Ke,dh,$h)=>{if(1===Ke)return 32;Ee=this.CU("FA000000002.Ogma.Document.Url")||this.CU("FA000000002.Ogma.Lookup.Url");$h&&($h[ya.a.On]=Ee);return 32};this.glo=(Ee,kf,Ke,dh,
$h)=>{if(1===Ke)return 32;$h&&($h[ug.a.Visible]=this.sTj());return 32};this.g8o=(Ee,kf,Ke)=>{if(2!==Ke)return 32;this.ga.Ob(Fa.a.AFj,2);Ee=new Aa.a;Ee.xS="Suggested Tasks (Preview)";return this.B4("FA000000030",Ee,!0)?32:16};this.QNo=(Ee,kf)=>{Nn.instance.rpb(Ee,kf)};this.Uvb=Ee=>{const kf=this.PY.TPb(Ee);Ig.Qnl(kf);const Ke=this.Dhi(kf)||this.WYf(kf);Ke&&this.wt.t0(Ee)&&Nn.instance.N3d(kf,!1);if(this.bjn(kf)){const dh=this.PY.JNm(kf);dh&&dh()}this.ccb(kf,Ke);this.wt.tUa(Ee);this.Yb.fV(this.TOf(kf))};
this.oWb=(Ee,kf)=>{let Ke=null;Ee&&(Ke=this.PY.TPb(Ee));if(!Ke)return z.ULS.sendTraceTag(19138189,344,10,"Add-in instanceId not found when pressing {Tab} on close button."),!1;this.au.notifyAgave(Ke,kf);this.$wa=Ke;return!0};this.PY=dc;this.qW=Rc;this.wt=Id||new fs(ud)}Wb(){super.Wb();this.ga.ra(Fa.a.N0b,I.a.frame,this.gef);this.ga.ra(Fa.a.Zze,I.a.frame,this.gef);this.ga.ra(Fa.a.$ze,I.a.frame,this.gef);this.ga.ra(Fa.a.iVj,na.a.view,this.g8o);this.ga.fb(Fa.a.Sse,na.a.view,this.Sse,96);this.ga.ra(Fa.a.AFj,
I.a.frame,Hq.ActionManager.Zf);this.ga.fb(Fa.a.Axj,I.a.frame,this.glo,96)}Euj(){const e=this.hJm();this.XAg(()=>{this.requestIdleCallback(this.JWl,0)},vk.jKj);return e}hJm(){var e=!1;const t={};this.QJd.clear();var E=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.OEP.SdxAssetIdsToPreload","");if(!Qd.a.taa(E)){e=!0;for(var W of E.split("_"))t[Qd.a.xh(W)]=!0}if(e&&(E=this.bFi(),!yl.a.isEmpty(E))){W=Date.now()-6048E5;for(const ha in E)e=ha,E[ha]>W&&(t[Qd.a.xh(e)]=!0)}if(!yl.a.isEmpty(t))for(const ha in t)this.QJd.add(ha);
return this.QJd}Zdo(e){switch(e){case vk.ric:this.Ydo();break;case "FA000000002":this.$do();break;default:this.cmg(e,new Aa.a)}}Ydo(){const e=Object.assign(new Aa.a,{xS:"Experimentation SDX",taskPaneWidth:0});this.SSo(e);this.cmg(vk.ric,e)}$do(){const e=Object.assign(new Aa.a,{sourceLocationOverrideResourceId:"Ogma.Cdn.Lookup.Url",sharedRuntimeId:"Ogma.Cdn.Lookup.Url"});this.cmg("FA000000002",e)}cmg(e,t){t.isPreload=!0;this.XAg(()=>{this.requestIdleCallback(()=>{this.B4(e,t,!0)},0)},200)}SSo(e){e.sourceLocationOverrideResourceId=
vk.BCf;e.sharedRuntimeId=vk.BCf}requestIdleCallback(e,t){let E=!1;try{window.self.requestIdleCallback(e)}catch(W){E=!0}E&&this.XAg(e,t)}XAg(e,t){t=new kh.a(2,1,t,()=>{e()});v.AFrameworkApplication.mc.Zb(t)}sTj(){const e=ob.a.instance.Oa("WordEditor.TranslatorRoamingServiceManager");return!!e&&e.Non()}CU(e){return this.wt.t0(e)}tUa(e){let t=null;({XUc:t}=this.wt.cEe(e)).returnValue&&this.Uvb(t)}WYf(e){if(!e)return!1;e=this.xMf(e);return!!e&&!!e.getSharedRuntimeId()}nHf(e){return this.wt.INm(e)}BMj(e,
t){if(this.kxd&&this.nHf(e)!=t){var E=this.PY.TPb(e);if(E=(E=this.xMf(E))?E.getSharedRuntimeId():null){var W=this.kxd.p5d(e);W?(W.sharedRuntimeId=E,W.backgroundState=t,this.kxd.EQo(W),this.wt.ZYo(e,t)):cl.Debug.J$k("No appRef in setAppTaskPaneBackgroundState.",544318937)}else cl.Debug.J$k("Not shared runtime in setAppTaskPaneBackgroundState.",544318859)}}S9d(e){return this.wt.S9d(e)}n2d(e,t,E){let W=null;return({XUc:W}=this.wt.cEe(e)).returnValue?(e=this.PY.TPb(W))?this.iCf(e,t,E):!1:!1}iCf(e,t,E){t=
Nn.instance.bDl(t,E);OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(e,t,this.QNo);return!0}Opo(e){let t="none";Qd.a.taa(e)||(t=Qd.a.xh(e.split(".")[0]));if(t in this.rdm){e=this.bFi();e[t]=Date.now();try{localStorage.setItem("_OSF_Word_Preload_FPA_List",JSON.stringify(e))}catch(E){}}}bFi(){let e={},t=null;try{t=localStorage.getItem("_OSF_Word_Preload_FPA_List")}catch(E){}Qd.a.taa(t)||(e=JSON.parse(t));return e}showTaskPane(e,t,E){let W=null;var ha=({XUc:W}=this.wt.cEe(e)).returnValue,
Ka=null;Ka=E.isPreload;const sb=E.isForUILessAction||Qd.a.xh(e)===vk.ric;var dc=!Qd.a.taa(E.sharedRuntimeId);Ka?E.initialDisplayMode=1:(this.Opo(e),dc&&(E.initialDisplayMode=sb?1:2));dc&&(E.hostInfoFlags=1,t||(t=this.wt.M4c(e)));if(ha){ha=this.PY.TPb(W);if(dc=this.xMf(ha))E.settings&&(dc.setSettings(E.settings),dc.setHostSettings(E.hostSettings)),t&&v.AFrameworkApplication.K.$("WordEditorAppsForOFficeRefreshTaskPaneTitleIsEnabled")&&"Help.GiveFeedback.Url"!==E.sourceLocationOverrideResourceId&&this.wt.A2b(W,
t);const xc=this.wt.t0(W),Rc=this.wt.rlc(W);this.Dhi(ha)?(this.AWl(ha)&&(z.ULS.sendTraceTag(50685986,344,50,"Reactivating app before showing because it's in an error state."),this.yyj(ha)),xc||(this.wt.showTaskPane(W,t,E,Ka,null,this.Uvb),Nn.instance.N3d(ha,!0))):(xc||this.WYf(ha))&&this.Ndn(ha)?dc&&(dc.isFirstParty()&&!this.WYf(ha)&&dc.refresh(),this.wt.showTaskPane(e,t,E,sb),Nn.instance.N3d(ha,!0)):(this.yyj(ha),this.wt.showTaskPane(W,t,E,sb,null,this.Uvb),Nn.instance.N3d(ha,!0));Ka=this.Yb.ge(Rc)}else v.AFrameworkApplication.K.$("AddInCommandsIsEnabled")&&
v.AFrameworkApplication.K.$("WordEditorTaskpaneUpgradeToAppCommandIsEnabled")&&!E.isAddinCommands&&(E.virtualOsfControlActivationCallback=()=>{this.Uvb(e);this.U2j(E)}),this.u9h(e,t,E,sb||Ka),t=this.wt.rlc(e),Ka=this.Yb.ge(t),this.TMh(Ka,E.id);Ka?(Ka.tt(Un.KeyInputManager.lc(Si.a.xz,0)),Ka.tt(Un.KeyInputManager.lc(Si.a.xz,4))):z.ULS.sendTraceTag(36767389,344,10,"FocusScope should be initialized.");sb||(this.Yb.Bg(this.Yb.RW),this.$wa=null);return!0}oMh(e){const t=()=>{this.wt.tUa(e.solutionId);this.Yb.Bg(this.Yb.RW);
de.a.instance.setItem("refreshRequired","true");this.U2j(e);this.wt.Rzo(e.solutionId)};let E=null;const W=e.solutionId;({XUc:E}=this.wt.cEe(W)).returnValue?this.wt.t0(E)||this.wt.showTaskPane(E,"",e,!1):(this.wt.showTaskPane(W,"",e,this.Oyf(W)),this.tk.value.insertBlankControlWithErrorUX(this.Xhd(e),t));this.Yb.Bg(this.Yb.RW);this.$wa=null}oVj(e,t){const E=e.solutionId;this.wt.showTaskPane(E,"",e,this.Oyf(E));this.tk.value.insertBlankControlWithErrorUX(this.Xhd(e),()=>{this.wt.tUa(e.solutionId);this.Yb.Bg(this.Yb.RW);
t()});this.Yb.Bg(this.Yb.RW);this.$wa=null}U2j(e){var t={};t.solutionId=e.solutionId;t.version=e.version;t.storeType=e.storeType;t.storeId=e.storeId;t.assetId=e.assetId;t.assetStoreId=e.assetStoreId;t.targetType=OSF.OsfControlType.ContainerLevel;v.AFrameworkApplication.K.$("AppsForOfficeSharedRuntimeIsEnabled")&&(t.sharedRuntimeId=e.sharedRuntimeId);e=new fa.a;e.add(t);t={};t[nc.a.WRd]=e;t[nc.a.oIa]=3;this.ga.Pb(M.a.pUb,2,t)}Xhd(e){const t={};t.div=e.div;t.id=e.id;t.solutionId=e.solutionId;t.version=
e.version;t.storeType=e.storeType;t.storeId=e.storeId;t.osfControlType=e.osfControlType;v.AFrameworkApplication.K.$("AppsForOfficeSharedRuntimeIsEnabled")&&(t.sharedRuntimeId=e.sharedRuntimeId);return t}createUILessSandbox(e,t,E){this.Oyf(e)?(this.u9h(e,t,E,!0),e=this.wt.rlc(e),e=this.Yb.ge(e),this.TMh(e,E.id)):E.sharedRuntimeId?this.showTaskPane(e,t,E):(this.pMh(E),this.PY.add(E,e))}BVa(e){return this.PY.TPb(e)}dispose(){super.dispose();this.wt.dispose()}nBc(e,t,E=null){if(t===OSF.AgaveHostAction.TabExit||
t===OSF.AgaveHostAction.TabExitShift){if(E=this.ePb())3===E.S1c(e)?this.tk.value.notifyAgave(e,OSF.AgaveHostAction.TabIn):(Yi.a.uj&&this.blur(),this.wt.iUm(this.PY.KVa(e),t))}else if(t===OSF.AgaveHostAction.EnableTaskPaneHeaderButton){const W=this.PY.KVa(e);E=Object.assign(new Iq,{label:E.Label,icon:E.Icon,onExecute:()=>{this.n3n(W)}});this.wt.B9j(W,E)}else t===OSF.AgaveHostAction.DisableTaskPaneHeaderButton?(E=this.PY.KVa(e),this.wt.B9j(E,null)):t===OSF.AgaveHostAction.GetOriginalControlId?(e=E.controlId,
t=new gi("",E.ownerAddinSolutionId,new lb,!0),E.originalControlId=null==t?e:t.Sci(e)):t===OSF.AgaveHostAction.PageIsReady?this.Vwh&&this.Vwh(e):super.nBc(e,t,E)}TOf(e){e=this.PY.KVa(e);return this.wt.rlc(e)}ePb(){return this.PY}M4c(e){return this.wt.M4c(e)}fSh(e){if(e){var t=e.getSolutionId();e=e.getVersion();var E=this.wt.M4c(t);if(!E||""===E)if(E=OSF.OsfManifestManager.getCachedManifest(t,e)){let W=null;const ha=this.tk.value.getAppUILocale();ha&&""!==ha&&(W=E.getDisplayName(ha));W&&""!==W||(W=
E.getDefaultDisplayName());this.wt.A2b(t,W)}E=this.wt.VIi(t);if(!E||""===E)if(e=OSF.OsfManifestManager.getCachedManifest(t,e))e=e.getDefaultIconUrl(),this.wt.CFe(t,e)}}TMh(e,t){e.Bja(()=>{this.GQo(t,Yi.a.uj)});e.KTa(()=>{this.IQo(t)})}AWl(e){if(!this.tk.value)return z.ULS.shipAssertTag(50685987,341,!1,"ContextActivationManager unavailable while trying to figure out if app is one of the error states: {0}",e),!1;e=this.tk.value.getOsfControlStatus(e);return e!==OSF.OsfControlStatus.Activated&&e!==OSF.OsfControlStatus.NotActivated}Dhi(e){return this.Qdn(e)}Oyf(e){return"FA000000029"===
e}u9h(e,t,E,W){v.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&!OSF.OsfControl.isFirstPartyStoreString(E.storeType)?v.AFrameworkApplication.ua&&!v.AFrameworkApplication.ua.Ib.C3(22)&&(e=new Ec.a(CommonUIStrings.l_ThirdPartyAddinDisabledTitle,CommonUIStrings.l_ThirdPartyAddinDisabledMessage,null),e.id=22,e.image=1,e.closeable=!0,v.AFrameworkApplication.ua.Ib.cza(e,!0)||z.ULS.sendTraceTag(36962447,306,10,"Failed to add entry to business bar. Third party addin disabled message could not be shown to user.")):
v.AFrameworkApplication.i6a||OSF.OsfControl.isFirstPartyStoreString(E.storeType)?(this.wt.showTaskPane(e,t,E,W,this.oWb,this.Uvb),this.pMh(E),this.PY.add(E,e)):(z.ULS.sendTraceTag(571860445,344,50,"Taskpane web add-in disabled by doc IRM"),v.AFrameworkApplication.ua&&!v.AFrameworkApplication.ua.Ib.C3(36)&&(e=new Ec.a(CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle,CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage,null),e.id=36,e.image=1,e.closeable=!0,v.AFrameworkApplication.ua.Ib.cza(e,
!0)||z.ULS.sendTraceTag(573388438,306,10,"Failed to add entry to business bar. CLP protected doc addins disabled message could not be shown to user.")))}B3c(e){return this.wt.B3c(e)}n3n(e){let t=null;e&&(t=this.PY.TPb(e));t?(this.au.notifyAgave(t,OSF.AgaveHostAction.TaskPaneHeaderButtonClicked),this.$wa=t):z.ULS.sendTraceTag(50738267,344,10,"Add-in instanceId not found when clicking on TaskPaneAction button.")}Qdn(e){e=this.PY.fJf(e);return!!e&&"FA000000029"===e.yo}bjn(e){e=this.PY.fJf(e).storeType.toLowerCase();
return e===OSF.StoreType.FirstParty.toLowerCase()||e===OSF.StoreType.Sdx.toLowerCase()}xMf(e){return this.tk.value?this.tk.value.getOsfControl(e):null}A2b(e,t){this.wt.rlc(e);this.wt.M4c(e)!==t&&this.wt.A2b(e,t)}CFe(e,t){this.wt.rlc(e);this.wt.VIi(e)!==t&&this.wt.CFe(e,t)}}vk.ric="fa000000059";vk.BCf="FA59SharedRuntime.Url";vk.jKj=1E4;Object(y.a)(vk,"WordEditorAppsForOfficeUIActor",fn,[]);class ok{constructor(e,t){this.Ch=e;this.Ch.vgf(Object(ib.a)(this,this.srl,"clearHandlersForApp"));this.Ruk=t}get bCf(){return this.Ruk}xjc(e){z.ULS.shipAssertTag(5902748,
341,!!this.bCf);let t;return({value:t}=this.bCf.Dc(e)).returnValue?t:null}srl(e,t){for(const E of this.bCf)E.value&&E.value.removeHandler(t,null)}}Object(y.a)(ok,"ApiEventStore",null,[1359]);var ln=d(669),mn;(function(e){e[e.I1p=1]="getSelectedDataAsync";e[e.jkq=2]="setSelectedDataAsync";e[e.GSp=3]="addAppBindingFromSelectionAsync";e[e.FSp=4]="addAppBindingFromNamedItemAsync";e[e.p1p=5]="getDataAsync";e[e.fkq=6]="setDataAsync";e[e.WTp=7]="bindingSelectionChangedEvent";e[e.r1p=8]="getFileAsync";e[e.NSp=
9]="addTableBindingRowsAsync";e[e.MSp=10]="addTableBindingColumnsAsync";e[e.uXp=11]="deleteAllDataValuesAsync";e[e.d1p=12]="getAllAsync";e[e.h1p=13]="getByIdAsync";e[e.lhq=14]="releaseByIdAsync";e[e.Q1p=15]="goToByIdAsync";e[e.jej=16]="messageParent";e[e.Tjq=17]="sendMessageToDialog";e[e.getAccessToken=18]="getAccessToken";e[e.VTp=19]="bindingDataChangedEvent";e[e.WXp=20]="displayRibbonCalloutAsync";e[e.okq=21]="setTextAsync";e[e.ISp=22]="addCustomXmlNodeAsync"})(mn||(mn={}));Object(y.b)("ApiName",
mn);const On=(e,t,E,W=null)=>{W||(W={});W.ApiName=mn[e];W.ApiCode=e;W.AppId=t;W.Result=E;z.ULS.sendTraceTag(17131735,341,50,"{0}",W)};class Vn extends dl{constructor(){super();this.JK=this.ep=null;this.jeg=(e,t)=>{t.pe&&(e=this.c_.fkm(t.pe),this.Xci=this.c_.Xhm(e),this.gC())};this.Xci=new fa.a}get c_(){this.ep||(this.ep=ob.a.instance.Oa("WordEditor.AppsForOffice.IAppBindingHelper"));return this.ep}set c_(e){this.ep=e}get e7a(){this.JK||(this.JK=ob.a.instance.Oa("Box4.IContentControlDataChangedManager"));
return this.JK}set e7a(e){this.JK=e}addHandler(e,t,E,W=null){this.e7a&&this.c_?this.c_.WVi?(this.Fg.count||this.e7a.addHandler(ln.a.lZb,this.jeg),this.Fg.Z(this.l6a(e,W),t),this.c_.Bie(e,W,"Binidng.AddHandler for BindingDataChangedEvent"),this.UH(E)):this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(e,t,E=null){this.e7a&&this.c_?this.c_.WVi?E?this.c_.v3c(this.Fg,this.l6a(e,E))?(this.Fg.remove(this.l6a(e,
E)),this.Fg.count||this.e7a.removeHandler(ln.a.lZb,this.jeg),this.c_.Bie(e,E,"Binidng.RemoveHandler for BindingDataChangedEvent"),this.UH(t)):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.csg(e,t):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}Txj(e,t=null){if(this.c_&&(e=this.c_.v3c(this.Fg,this.l6a(e,t)))){const E={};E[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=t;t={};t[OSF.DDA.Marshaling.AppBindingKeys.BindingEventSource]=
E;e(t)}}csg(e,t){if(this.e7a){const E=new fa.a;for(const W of this.Fg.keys)W.startsWith(e)&&E.add(W);for(const W of E)this.Fg.remove(W);this.Fg.count||this.e7a.removeHandler(ln.a.lZb,this.jeg);this.UH(t)}else this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}l6a(e,t){return e+"-"+t}gC(){for(const e of this.Xci){const t=e[sg.jdc],E=e[sg.FSd],W=e[OSF.DDA.Marshaling.AppBindingKeys.BindingId];let ha=this.c_.jvi(E);ha=ha?ha:new fa.a;ha.add(t);for(const Ka of ha)this.Txj(Ka,W),On(19,E,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}static get instance(){return null!=
Vn.hZg?Vn.hZg:Vn.hZg=new Vn}}Object(y.a)(Vn,"BindingDataChangedEvent",dl,[]);class gp extends dl{constructor(e){super();this.YFa=this.ep=null;this.Zsc=()=>{this.SKj=this.c_.DJm();this.YFa?this.Gb.vf(this.YFa):this.YFa=new kh.a(4,1,gp.Fcl,()=>{this.YFa=null;this.gC()});this.Gb.Zb(this.YFa)};this.Gb=e;this.SKj=new fa.a}get c_(){this.ep||(this.ep=ob.a.instance.resolve("WordEditor.AppsForOffice.IAppBindingHelper"));return this.ep}set c_(e){this.ep=e}addHandler(e,t,E,W=null){this.kg?(this.Fg.count||this.kg.BQh(this.Zsc),
this.Fg.Z(this.l6a(e,W),t),this.c_.Bie(e,W,"Binidng.AddHandler for bindingSelectionChangedEvent"),this.UH(E)):this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(e,t,E=null){E?this.kg&&this.v3c(this.Fg,this.l6a(e,E))?(this.Fg.remove(this.l6a(e,E)),this.Fg.count||this.kg.ptg(this.Zsc),this.c_.Bie(e,E,"Binidng.RemoveHandler for bindingSelectionChangedEvent"),this.UH(t)):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.csg(e,t)}csg(e,t){if(this.kg){const E=
new fa.a;for(const W of this.Fg.keys)W.startsWith(e)&&E.add(W);for(const W of E)this.Fg.remove(W);this.Fg.count||this.kg.ptg(this.Zsc);this.UH(t)}else this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}l6a(e,t){return e+"-"+t}gC(){for(const E of this.SKj){var e=E[sg.jdc];const W=E[sg.FSd],ha=E[OSF.DDA.Marshaling.AppBindingKeys.BindingId]?E[OSF.DDA.Marshaling.AppBindingKeys.BindingId]:null,Ka=E[OSF.DDA.Marshaling.AppBindingKeys.BindingType]?E[OSF.DDA.Marshaling.AppBindingKeys.BindingType]:
null;var t=this.c_.jvi(W);t=t?t:new fa.a;t.add(e);for(const sb of t)if(e=this.v3c(this.Fg,this.l6a(sb,ha))){On(7,W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,{["BindingType"]:Ka});t={};t[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=ha;t[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=Ka;const dc={};dc[OSF.DDA.Marshaling.AppBindingKeys.BindingEventSource]=t;Ka===Wc.table&&(dc[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]=E[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]);e(dc)}}}v3c(e,t){if(e.mb(t))return e.J(t);
const E=RegExp("\t","g");for(const W of e)if(W.key.replace(E," ")===t)return W.value;return null}static get instance(){return null!=gp.mZg?gp.mZg:gp.mZg=new gp(v.AFrameworkApplication.mc)}}gp.Fcl=100;Object(y.a)(gp,"BindingSelectionChangedEvent",dl,[]);const Sl=(e,t,E)=>{for(const W of t.keys)-1<W.indexOf(e)&&t.J(W)(E)};class No extends dl{constructor(){super();this.txh=this.w_n=(e,t)=>{e={};e[OSF.DDA.Marshaling.DataNodeEventProperties.InUndoRedo]=t.Cbe;e[OSF.DDA.Marshaling.DataNodeEventProperties.OldNode]=
t.Yij;e[OSF.DDA.Marshaling.DataNodeEventProperties.NextSiblingNode]=t.zcq;Sl(t.Agc,this.Fg,e)}}addHandler(e,t,E,W){this.kg&&W?(this.Fg.count||this.kg.zgc.kff(ea.lmj,this.txh),this.Fg.Z(e+"-"+W,t),z.ULS.sendTraceTag(19489929,341,50,"Add handler for nodeDeleted event on custom xml file whose id is: {0}.",W),this.UH(E)):this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(e,t,E){e=e+"-"+E;this.kg&&E&&this.Fg.mb(e)?(this.Fg.remove(e),this.Fg.count||this.kg.zgc.wsg(ea.lmj,this.txh),
z.ULS.sendTraceTag(19489930,341,50,"Remove handler for nodeDeleted event on custom xml file whose id is: {0}.",E),this.UH(t)):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}gC(){}static get instance(){return null!=No.i_g?No.i_g:No.i_g=new No}}Object(y.a)(No,"DataNodeDeletedEvent",dl,[]);class hp extends dl{constructor(){super();this.uxh=this.x_n=(e,t)=>{e={};e[OSF.DDA.Marshaling.DataNodeEventProperties.InUndoRedo]=t.Cbe;e[OSF.DDA.Marshaling.DataNodeEventProperties.NewNode]=t.Tbg;
Sl(t.Agc,this.Fg,e)}}addHandler(e,t,E,W){this.kg&&W?(this.Fg.count||this.kg.zgc.kff(ea.ogg,this.uxh),this.Fg.Z(e+"-"+W,t),z.ULS.sendTraceTag(19489931,341,50,"Add handler for nodeInserted event on custom xml file whose id is: {0}.",W),this.UH(E)):this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(e,t,E){e=e+"-"+E;this.kg&&E&&this.Fg.mb(e)?(this.Fg.remove(e),this.Fg.count||this.kg.zgc.wsg(ea.ogg,this.uxh),z.ULS.sendTraceTag(19489932,341,50,"Remove handler for nodeInserted event on custom xml file whose id is: {0}.",
E),this.UH(t)):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}gC(){}static get instance(){return null!=hp.e_g?hp.e_g:hp.e_g=new hp}}Object(y.a)(hp,"DataNodeInsertedEvent",dl,[]);class ro extends dl{constructor(){super();this.vxh=this.y_n=(e,t)=>{e={};e[OSF.DDA.Marshaling.DataNodeEventProperties.InUndoRedo]=t.Cbe;e[OSF.DDA.Marshaling.DataNodeEventProperties.OldNode]=t.Yij;e[OSF.DDA.Marshaling.DataNodeEventProperties.NewNode]=t.Tbg;Sl(t.Agc,this.Fg,e)}}addHandler(e,t,E,W){this.kg&&
W?(this.Fg.count||this.kg.zgc.kff(ea.qgg,this.vxh),this.Fg.Z(e+"-"+W,t),z.ULS.sendTraceTag(19489933,341,50,"Add handler for nodeReplaced event on custom xml file whose id is: {0}.",W),this.UH(E)):this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(e,t,E){e=e+"-"+E;this.kg&&E&&this.Fg.mb(e)?(this.Fg.remove(e),this.Fg.count||this.kg.zgc.wsg(ea.qgg,this.vxh),z.ULS.sendTraceTag(19489934,341,50,"Remove handler for nodeReplaced event on custom xml file whose id is: {0}.",E),this.UH(t)):
this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}gC(){}static get instance(){return null!=ro.kZg?ro.kZg:ro.kZg=new ro}}Object(y.a)(ro,"DataNodeReplacedEvent",dl,[]);class el extends dl{constructor(e){super();this.ggg=(t,E)=>{this.Fg.mb(E.controlId)&&(t={},t[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=E.messageType,t[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=E.messageContent,t[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=
E.g9f,t[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=E.$eb,this.Fg.J(E.controlId)(t),E.messageType===OSF.DialogMessageType.DialogClosed&&(this.Fg.remove(E.controlId),this.Fg.count||this.kg.yOa.P7a.ZDj(this.ggg)))};this.Kxa=e}addHandler(e,t,E,W=null){if(this.Kxa)if(this.kg){z.ULS.sendTraceTag(19787875,341,50,"DialogMessageReceivedEvent.AddHandler called!");const ha=Ka=>{Ka===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.Fg.count||this.kg.yOa.P7a.f1k(this.ggg),this.Fg.Z(e,
t),this.UH(E)):(Ka!==OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains&&z.ULS.sendTraceTag(19787904,341,10,"DialogMessageReceivedEvent.AddHandler failed!"),this.Kr(E,Ka))};this.Fg.mb(e)?ha(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.kg.yOa.showDialog(e,W,ha)}else this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(e,t){this.Kxa?this.kg&&this.Fg.mb(e)?(z.ULS.sendTraceTag(19787905,
341,50,"DialogMessageReceivedEvent.RemoveHandler called!"),this.kg.yOa.Pza(e,E=>{this.Fg.remove(e);this.Fg.count||this.kg.yOa.P7a.ZDj(this.ggg);E===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.UH(t):(z.ULS.sendTraceTag(19787906,341,10,"DialogMessageReceivedEvent.RemoveHandler failed!"),this.Kr(t,E))})):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}gC(){}static get instance(){const e=v.AFrameworkApplication.K?
v.AFrameworkApplication.K.$("WordEditorAppsForOfficeShowDialogApiIsEnabled"):!1;return el._instance||(el._instance=new el(e))}}el._instance=null;Object(y.a)(el,"DialogMessageReceivedEvent",dl,[]);class tm extends dl{constructor(e){super();this.Kxa=e}addHandler(e,t,E){if(this.Kxa)if(this.kg){z.ULS.sendTraceTag(19787907,344,50,"DialogNotificationShownInAddinEvent.AddHandler called!");try{const W=this.kg.yOa.DOa(e);W===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.UH(E):this.Kr(E,W)}catch(W){z.ULS.sendTraceTag(19787908,
344,10,"DialogNotificationShownInAddinEvent.AddHandler failed. Error message: {0}.",W.message),this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}else this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(e,t){if(this.Kxa)if(this.kg){z.ULS.sendTraceTag(19787909,344,50,"DialogNotificationShownInAddinEvent.RemoveHandler called!");try{const E=this.kg.yOa.fLa(e);E===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?
this.UH(t):this.Kr(t,E)}catch(E){z.ULS.sendTraceTag(19787910,344,10,"DialogNotificationShownInAddinEvent.RemoveHandler failed. Error message: {0}.",E.message),this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}else this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}gC(){}static get instance(){const e=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("WordEditorAppsForOfficeShowDialogApiIsEnabled"):
!1;return tm._instance||(tm._instance=new tm(e))}}tm._instance=null;Object(y.a)(tm,"DialogNotificationShownInAddinEvent",dl,[]);class Wk extends dl{constructor(e){super();this.Wlj=(t,E)=>{this.Fg.mb(E.controlId)&&(t={},t[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=E.messageType,t[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=E.messageContent,t[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=E.g9f,t[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=
E.$eb,this.Fg.J(E.controlId)(t))};this.Kxa=e}addHandler(e,t,E){this.Kxa?this.kg?(z.ULS.sendTraceTag(595130066,341,50,"DialogParentMessageReceivedEvent.AddHandler called!"),this.Fg.count||this.kg.yOa.P7a.e1k(this.Wlj),this.Fg.Z(e,t),this.UH(E)):this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(e,t){this.Kxa?this.kg&&this.Fg.mb(e)?(z.ULS.sendTraceTag(595130065,341,50,"DialogParentMessageReceivedEvent.RemoveHandler called!"),
this.Fg.remove(e),this.Fg.count||this.kg.yOa.P7a.OAo(this.Wlj),this.UH(t)):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}gC(){}static get instance(){const e=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("WordEditorAppsForOfficeShowDialogApiIsEnabled"):!1;return Wk._instance||(Wk._instance=new Wk(e))}}Wk._instance=null;Object(y.a)(Wk,"DialogParentMessageReceivedEventWord",dl,[]);class nr extends dl{constructor(e){super();
this.YFa=null;this.Zsc=()=>{this.YFa?this.Gb.vf(this.YFa):this.YFa=new kh.a(4,1,nr.sXl,()=>{this.YFa=null;this.gC()});this.Gb.Zb(this.YFa)};this.Gb=e}addHandler(e,t,E){this.kg?(this.Fg.count||this.kg.BQh(this.Zsc),this.Fg.Z(e,t),this.UH(E)):this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(e,t){this.kg&&this.Fg.mb(e)?(this.Fg.remove(e),this.Fg.count||this.kg.ptg(this.Zsc),this.UH(t)):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}gC(){for(const e of this.Fg.values)e&&
e({})}static get instance(){return null!=nr.vZg?nr.vZg:nr.vZg=new nr(v.AFrameworkApplication.mc)}}nr.sXl=100;Object(y.a)(nr,"DocumentSelectionChangedEvent",dl,[]);class ip extends dl{constructor(e,t,E,W){super();this.xDc=null;this.moj=(ha,Ka)=>{if(Ka)if(ha=Ka.node,!ha)z.ULS.sendTraceTag(22024347,341,10,"node is null");else{if(47===ha.type&&21===Ka.u2h){if((Ka=this.Zc.jg(ha))&&Ka.Ub(21))for(;Ka.Lf(21););Ka=new fa.a;this.A9&&(Ka=ha.getValue(fd.a.WTa),Ka=this.A9.LAi(Ka));Ka.add(ha.id.toString());for(const sb of Ka)this.Fg.mb(sb)&&
(ha=this.Fg.J(sb))&&ha({})}}else z.ULS.sendTraceTag(22024346,341,10,"TopologyChangedEventArgs is null")};e&&(this.xDc=e.Ve(47));this.Zc=t;this.MEh=W;this.A9=E}addHandler(e,t,E){this.MEh?this.xDc?(this.Fg.count||this.xDc.SPh(this.moj),this.Fg.Z(e,t),this.UH(E)):this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.Kr(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(e,t){this.MEh?this.xDc&&this.Fg.mb(e)?(this.Fg.remove(e),this.Fg.count||this.xDc.MDj(this.moj),
this.UH(t)):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}gC(){}static get instance(){try{const e=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorSettingsChangedEventIsEnabled");return ip._instance||(ip._instance=new ip(S.App.jf.Il,new uh.a,ob.a.instance.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"),e))}catch(e){return z.ULS.sendTraceTag(22024348,341,10,"Failed to get SettingsChangedEvent Instance: {0}.",
e),null}}}ip._instance=null;Object(y.a)(ip,"SettingsChangedEvent",dl,[]);class Mk extends dl{gC(){throw Error("Method not implemented.");}constructor(e){super();this.tk=e}addHandler(e,t,E){this.Fg.count||this.tk.value.setOfficeThemeChangedHandler(this.D_n);this.Fg.Z(e,t);this.UH(E)}D_n(e){for(const t of Mk._instance.Fg.values)t&&t(e)}removeHandler(e,t){this.Fg.mb(e)?(this.Fg.remove(e),this.UH(t)):this.Kr(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}static get instance(){try{return Mk._instance||
(Mk._instance=new Mk(ob.a.instance.rf("Common.App.AppsForOfficeCommon.IContextActivationManager")))}catch(e){return z.ULS.sendTraceTag(512300628,341,10,"Failed to get OfficeThemeChangedEvent Instance: {0}.",e),null}}}Mk._instance=null;Object(y.a)(Mk,"OfficeThemeChangedEvent",dl,[]);class or extends ok{constructor(e,t,E){super(e,t);this.kVe=E}xjc(e){if(e=super.xjc(e))e.kg=this.kVe;return e}static wFl(e,t){const E=new Yc.a;E.Z(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,nr.instance);E.Z(OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent,
gp.instance);E.Z(OSF.DDA.EventDispId.dispidBindingDataChangedEvent,Vn.instance);E.Z(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,el.instance);E.Z(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Wk.instance);E.Z(OSF.DDA.EventDispId.dispidDataNodeAddedEvent,hp.instance);E.Z(OSF.DDA.EventDispId.dispidDataNodeReplacedEvent,ro.instance);E.Z(OSF.DDA.EventDispId.dispidDataNodeDeletedEvent,No.instance);E.Z(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,tm.instance);E.Z(OSF.DDA.EventDispId.dispidSettingsChangedEvent,
ip.instance);E.Z(OSF.DDA.EventDispId.dispidRichApiMessageEvent,Nn.instance);E.Z(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,Mk.instance);return new or(e,E,t)}}Object(y.a)(or,"WordEditorEventStore",ok,[]);class rq{constructor(){this.QEk=new Ue.a(()=>this.yco())}get nej(){return this.QEk.value}lHf(e){z.ULS.shipAssertTag(5902749,341,!!this.nej);let t;return({value:t}=this.nej.Dc(e)).returnValue?t():null}}Object(y.a)(rq,"ApiMethodFactory",null,[1357]);class Rm{constructor(e,t,E){this.customizedActionDic=
this.Sk=this.controlId=null;this.parameters=e;this.callback=t;this.V2k=E;this.Xp={};this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get errorCode(){return this.we}get result(){return this.Xp}go(){this.execute();this.zo()}execute(){}zo(){this.callback&&(this.result.Error=this.errorCode,this.callback(this.result))}}Object(y.a)(Rm,"ApiMethod",null,[]);class gm extends Rm{constructor(){super();this.kg=null}static TYd(e){const t=new gm;t.we=e;return t}}Object(y.a)(gm,"LiveBooksApiMethod",
Rm,[]);class so extends gm{constructor(e){super();this.Kxa=e}go(){let e;this.Kxa?this.kg?(this.kg.yOa.sendMessage(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[nc.a.jhf],this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:e=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.BOo(e)}BOo(e){this.we=e;this.zo()}}Object(y.a)(so,
"SendMessageMethod",gm,[]);var Xo=d(1926);class Tl extends gm{constructor(e){super();this.Ch=e}go(){var e=this.Ch.au.getOsfControl(this.controlId);if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!1)||e.isFirstParty()){e=e.getManifest();var t=e.getMarketplaceID(),E=e.getWebApplicationId(),W=e.getWebApplicationMsaId();ob.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(t).then(ha=>{this.we=0;const Ka={};Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
ha.upn;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=ha.userId;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=E;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=W?W:E;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=ha.authority;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Xo.a.Zti(ha.authorityType);Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=ha.isAnonymous;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=
ha.tenantId;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=ha.supportsAuthToken;this.result[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ka;this.zo()},ha=>{const Ka={},sb=new Xo.a;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=sb.upn;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=sb.userId;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=E;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=W?W:E;
Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=sb.authority;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Xo.a.Zti(sb.authorityType);Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=sb.isAnonymous;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=sb.tenantId;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=sb.supportsAuthToken;Ka[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=ha;this.we=
1;this.result[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ka;this.zo()})}}}Object(y.a)(Tl,"GetAuthContextMethod",gm,[]);class Tg extends Rm{constructor(){super();this.kg=null}static TYd(e){const t=new Tg;t.we=e;return t}}Object(y.a)(Tg,"WordEditorApiMethod",Rm,[]);class um extends Tg{constructor(e){super();this.pZ=e}go(){let e="";if(this.pZ)if(this.kg){var t=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(t[OSF.DDA.Marshaling.BindingParameterKeys.BindingType]&&
t[OSF.DDA.Marshaling.BindingParameterKeys.ItemName]){let E=null;t[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&(E=t[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString());e=t[OSF.DDA.Marshaling.BindingParameterKeys.BindingType].toString();this.we=({hL:t}=this.kg.XUk(this.Sk,E,t[OSF.DDA.Marshaling.BindingParameterKeys.ItemName].toString(),e)).returnValue;this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=t}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else this.we=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;On(4,this.Sk.yo,this.errorCode,{["BindingType"]:e});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&z.ULS.sendTraceTag(16795283,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Sk.yo,["errMsg"]:"unexpected error to AddAppBindingFromNamedItem api"});this.zo()}}Object(y.a)(um,"AddAppBindingFromNamedItemMethod",Tg,[]);class Cm extends Tg{constructor(e){super();
this.pZ=e}go(){let e="";if(this.pZ)if(this.kg){var t=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(t[OSF.DDA.Marshaling.BindingParameterKeys.BindingType]){let E=null;t[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&(E=t[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString());e=t[OSF.DDA.Marshaling.BindingParameterKeys.BindingType].toString();this.we=({hL:t}=this.kg.YUk(this.Sk,E,e)).returnValue;this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=t}else this.we=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;On(3,this.Sk.yo,this.errorCode,{["BindingType"]:e});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&z.ULS.sendTraceTag(16795285,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Sk.yo,["errMsg"]:"unexpected error to AddAppBindingFromSelection api"});this.zo()}}Object(y.a)(Cm,"AddAppBindingFromSelectionMethod",
Tg,[]);class pr extends Tg{constructor(e,t){super();this.MGa=e;this.sl=t}execute(){if(this.MGa){var e=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Prefix],t=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],E=this.sl.VVa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);this.we=void 0===E||null===E||E.builtIn?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:E.XNh(e,t)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}else this.we=
OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.zo()}}Object(y.a)(pr,"AddDataNamespaceMethod",Tg,[]);const jp=(e,t,E)=>{let W=E.yo||"00000000-0000-0000-0000-000000000000";E=E.GP?E.GP:E;E.storeType&&E.store&&E.yo&&(W=Telemetry.PrivacyRules.GetPrivacyCompliantId(E.yo,E.storeType,null,null,null,null));z.ULS.sendTraceTag(509368257,341,10,"{0}",{["ApiCode"]:e,["AppId"]:W,["Result"]:t});t!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&z.ULS.sendTraceTag(509368256,341,10,"{0}",{["error"]:t,
["apiName"]:e,["appId"]:W})};class wn extends Tg{constructor(e,t){super();this.MGa=e;this.sl=t}execute(){if(this.MGa){var e=null;this.we=({qed:e}=this.sl.Lef(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Xml])).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){const t={};t[OSF.DDA.Marshaling.DataPartProperties.Id]="{"+e.id.hu.toString().toUpperCase()+"}";t[OSF.DDA.Marshaling.DataPartProperties.BuiltIn]=!1;this.result[OSF.DDA.Marshaling.PropertyDescriptors.DataPartProperties]=
t}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;jp(22,this.errorCode,this.Sk);this.zo()}}Object(y.a)(wn,"AddDataPartMethod",Tg,[]);class Ep extends Tg{constructor(e){super();this.TOh=t=>{this.we=t;this.OX();this.zo()};this.pZ=e}go(){if(this.pZ)if(this.kg){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.AddRowsColumns];if(e[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&e[OSF.DDA.Marshaling.SetDataKeys.Data]){var t=e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();
let E,W;0<e[OSF.DDA.Marshaling.SetDataKeys.Data].length?(E=null,e=e[OSF.DDA.Marshaling.SetDataKeys.Data],W=!1):(e=e[OSF.DDA.Marshaling.SetDataKeys.Data],E=e[OSF.DDA.Marshaling.TableBindingParameterKeys.TableHeaders],e=e[OSF.DDA.Marshaling.TableBindingParameterKeys.TableRows],W=!0);this.kg.Hef(t,this.Sk,E,e,W,this.TOh);return}t=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else t=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else t=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;
this.TOh(t)}OX(){On(10,this.Sk.yo,this.errorCode,null);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&z.ULS.sendTraceTag(17580612,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Sk.yo,["errMsg"]:"unexpected error to AddTableBindingColumnsAsync API"})}}Object(y.a)(Ep,"AddTableBindingColumnsMethod",Tg,[]);class Ul extends Tg{constructor(e){super();this.UOh=t=>{this.we=t;this.OX();this.zo()};this.pZ=e}go(){if(this.pZ)if(this.kg){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.AddRowsColumns];
if(e[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&e[OSF.DDA.Marshaling.SetDataKeys.Data]){this.kg.Gff(e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.Sk,e[OSF.DDA.Marshaling.SetDataKeys.Data],this.UOh);return}e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.UOh(e)}OX(){On(9,this.Sk.yo,this.errorCode,null);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&
z.ULS.sendTraceTag(17580613,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Sk.yo,["errMsg"]:"unexpected error to AddTableBindingRowsAsync API"})}}Object(y.a)(Ul,"AddTableBindingRowsMethod",Tg,[]);class to extends Tg{constructor(){super()}execute(){try{OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[nc.a.D2k][nc.a.C2k],this.parameters),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}catch(e){z.ULS.sendTraceTag(17306273,341,10,"AppCommandInvocationCompletedMethod: unexpected exception {0}",
e.message),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}this.zo()}}Object(y.a)(to,"AppCommandInvocationCompletedMethod",Tg,[]);class vm extends Tg{constructor(){super()}go(){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;z.ULS.shipAssertTag(20854624,341,!!this.kg.IKa);if(this.kg&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]){const t=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle],
E=this.kg.IKa.Cxi(this.controlId,t);if(E){var e=E.lpc;if(E.C1f)this.we=this.kg.IKa.uBj(this.controlId,t),this.zo();else try{this.kg.IKa.WNo(this.controlId,e,t,W=>{this.we=W;this.zo()})}catch(W){z.ULS.sendTraceTag(20854625,341,15,"Error happens when send close document request. "+W.message)}}}}}Object(y.a)(vm,"CloseDocumentCopyMethod",Tg,[]);class bq extends Tg{constructor(e,t){super();this.MGa=e;this.sl=t}execute(){this.we=this.MGa?this.sl.Gei(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]):
OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.zo()}}Object(y.a)(bq,"DeleteDataPartMethod",Tg,[]);class uo extends Tg{constructor(e){super();this.Xei=t=>{this.we=t;this.OX();this.zo()};this.pZ=e}go(){if(this.pZ)if(this.kg){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(e[OSF.DDA.Marshaling.BindingParameterKeys.Id]){this.kg.Dwf(e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.Sk,this.Xei);return}e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else e=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.Xei(e)}OX(){On(11,this.Sk.yo,this.errorCode,null);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&z.ULS.sendTraceTag(17580614,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Sk.yo,["errMsg"]:"unexpected error to deleteAllDataValuesAsync API"})}}Object(y.a)(uo,"DeleteTableBindingRowsMethod",Tg,[]);class ca extends Tg{constructor(e){super();this.Q3l=
(t,E)=>{this.we=E;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=t);this.zo()};this.QBk=e}go(){if(this.QBk)if(this.kg){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.ArrayData];if(e)try{let t=this.Sk.yo||"00000000-0000-0000-0000-000000000000";const E=this.Sk.GP?this.Sk.GP:this.Sk;E.storeType&&E.store&&E.yo&&(t=Telemetry.PrivacyRules.GetPrivacyCompliantId(E.yo,E.storeType,null,null,null,null));this.kg.S3l(e,t,this.controlId,
this.Sk,this.Q3l)}catch(t){z.ULS.sendTraceTag(17126306,344,10,"{0}",t.message),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.zo()}else z.ULS.sendTraceTag(9204821,344,10,"The rich api executor input parameter should not be null."),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.zo()}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.zo();else z.ULS.sendTraceTag(9291534,341,15,"The Rich App API feature is not enabled."),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
this.zo()}}Object(y.a)(ca,"ExecuteRichApiRequestMethod",Tg,[]);var ra=d(1752);class Eb{}Eb.N8a="generalException";Eb.Nce="invalidArgument";Eb.xcg="notAllowed";Eb.kif="apiNotAvailable";Eb.Xsp="unresolvedPendingRequest";Eb.timeout="timeout";Eb.xef="adalTimeout";Eb.H$j="userNotSignedIn";Eb.iud="userAborted";Eb.FVj="silentSignInFailed";Eb.v8c="invalidResourceUrl";Eb.MWf="invalidGrant";Eb.B6h="connectionLost";Eb.Dpf="clientError";Eb.Lyg="serverError";Object(y.a)(Eb,"WopiHostErrorCodes",null,[]);class kc{}
Object(y.a)(kc,"OAuthCallerMetadata",null,[]);class zc{constructor(e){this.Tba=e;this.Auk=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}cUk(e,t,E,W,ha,Ka){if(!this.Tba)return W=new Be,W.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(W);const sb=new kc;sb.AddinName=ha;sb.AddinTrustId=Ka;let dc=-1;Ka=null;if(W&&this.KZi())Ka=this.Tba.X3j(nc.a.YCe,e,W,zc.vFi(ha),sb);else{const xc=Date.now();Ka=this.Tba.wV(nc.a.YCe,
e,sb).then(Rc=>{dc=Date.now()-xc;const md=(t||E)&&"login_required"===Rc.ErrorCode;return(t&&("interaction_required"===Rc.ErrorCode||"consent_required"===Rc.ErrorCode||"invalid_grant"===Rc.ErrorCode)||md)&&this.KZi()?this.Tba.X3j(nc.a.YCe,e,null,zc.vFi(ha),sb):Promise.resolve(Rc)})}return Ka.then(xc=>{const Rc=new Be;xc.IsSuccess?(Rc.token=xc.Token,xc.Telemetry&&(Rc.P1b=xc.Telemetry.fromCache,Rc.expiresOn=xc.Telemetry.expiresOn)):(Rc.errorCode=this.fIn(xc),Rc.ZHg=this.g9n(xc));return Rc}).catch(()=>
{const xc=new Be;xc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(xc)}).then(xc=>{xc.o6a="OauthManager";0<=dc&&(xc.S4c=dc);return xc})}cin(e){const t=(v.AFrameworkApplication.K.kb(v.AFrameworkApplication.mwa)||"").toLowerCase();return(Yi.a.RXa||"teams"===t&&Rj.a.E6c)&&!zc.Ahn(e)||!this.Tba||!this.Tba.aen()?!1:!0}KZi(){return this.Auk||1!==ra.a.s5d()}fIn(e){switch(e.ErrorCode){case "UserCancelled":case "interaction_required":e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;
break;case "consent_required":case "invalid_grant":e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;
default:e=e.ErrorCode===Eb.iud?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:e.ErrorCode===Eb.FVj?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:e.ErrorCode===Eb.v8c?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:e.ErrorCode===Eb.MWf?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:e.ErrorCode===Eb.B6h?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return e}g9n(e){let t="";(e=RegExp("AADSTS(\\d+)").exec(e.ErrorMessage))&&
1<e.length&&(t=e[1]);return t}static vFi(e){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,e)}static Ahn(e){if(!e)return!1;e=e.toLowerCase();for(const t of Ig.upi)if(t===e)return!0;return!1}}Object(y.a)(zc,"AppsforOfficeTokenFromOauthManager",null,[59]);class ed{constructor(e){this.iHn=e}static FKg(){if(v.AFrameworkApplication.K.$("AppForOfficeSSOV2IsEnabled")){var e=null;try{e=ob.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(t){z.ULS.sendTraceTag(592061330,
1300,10,"Unable to resolve IOAuthManager: "+t)}e=new zc(e);ed._instance=new ed(e)}}static getInstance(){ed.Umh||(ed.FKg(),ed.Umh=!0);return ed._instance}}ed._instance=null;ed.Umh=!1;Object(y.a)(ed,"AppsForOfficeOauthManagerFactory",null,[34]);class rd extends Tg{constructor(e,t){super();this.vAk=e;this.Ch=t}go(){z.ULS.sendTraceTag(22402398,341,50,"GetAccessToken was called!");const e=(t,E)=>{t===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(E=E.accessToken,this.result[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=
E):z.ULS.sendTraceTag(22402399,341,10,"{0}",{["errorCode"]:t.toString(),["appId"]:this.Sk.yo,["storeType"]:this.Sk.storeType});this.we=t;this.zo()};ob.a.instance.Qa("Postmessage.IHostPostmessenger").execute(t=>{const E=this.Ch.au,W=ed.getInstance();Ig.getInstance(E,t,W).getAccessToken(this.controlId,this.vAk,this.parameters,e)})}}Object(y.a)(rd,"GetAccessTokenMethod",Tg,[]);class Wd extends Tg{constructor(e){super();this.pZ=e}go(){if(this.pZ)if(this.kg){let e=[];this.we=({rWh:e}=this.kg.Pgm(this.Sk)).returnValue;
this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=e}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;On(12,this.Sk.yo,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&z.ULS.sendTraceTag(9049033,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Sk.yo,["errMsg"]:"unexpected error to getAllAsync api"});this.zo()}}Object(y.a)(Wd,"GetAllAppBindingsMethod",
Tg,[]);const Ze=(e,t,E,W,ha)=>{z.ULS.sendTraceTag(7886233,341,50,"{0}",{["type"]:e?"get":"set",["error"]:t,["xmlSize"]:E,["latency"]:Math.max(W,0),["appId"]:ha})},jg=(e,t)=>{z.ULS.sendTraceTag(7886234,341,50,"{0}",{["type"]:t?"get":"set",["delay"]:Math.max(e,0)})},Ag=e=>(new Date).getTime()-e;class Eh{constructor(e,t){this.yea=e;this.IQk=t;this.Qxd=this.r5=this.Nya=0}fBe(e){this.r5=(new Date).getTime();this.Qxd=0;this.Nya=this.yea.setTimeout(()=>{this.Qxd=(new Date).getTime();e()},this.IQk)}clearTimeout(){this.yea.clearTimeout(this.Nya)}get Ige(){return!!this.Qxd}get Wmb(){return this.r5}get HUd(){return this.Qxd}}
Object(y.a)(Eh,"TimeoutMethodHelper",null,[]);class Dc extends Tg{constructor(e,t,E,W){super();this.TYe=e;this.pZ=t;this.rGb=E;this.yea=W}go(){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.GetData];let t=null;if(this.pZ)if(this.kg)if(void 0===e[OSF.DDA.Marshaling.GetDataKeys.CoercionType]||null===e[OSF.DDA.Marshaling.GetDataKeys.CoercionType]||void 0===e[OSF.DDA.Marshaling.BindingParameterKeys.Id]||null===e[OSF.DDA.Marshaling.BindingParameterKeys.Id])this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;
else{t=e[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString();const W=e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();let ha;({hL:E}=this.kg.wHf(W,this.Sk));if(E&&(ha=E[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties])){var E=ha[OSF.DDA.Marshaling.AppBindingKeys.BindingType];if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Text)this.we=({text:e}=this.kg.yHf(this.Sk,W)).returnValue,this.aNa(e);else if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Table)E===OSF.DDA.Marshaling.CoercionTypeKeys.Table?
(this.DIi(e),this.we=({o_j:e}=this.kg.Wim(this.Sk,W,e)).returnValue,this.aNa(e)):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)E===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix||E===OSF.DDA.Marshaling.CoercionTypeKeys.Table?(this.DIi(e),this.we=({vJn:e}=this.kg.Tim(this.Sk,W,e)).returnValue,this.aNa(e)):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else{if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&
this.TYe){this.ICm(W);return}t===OSF.DDA.Marshaling.CoercionTypeKeys.Html?(this.we=({NWa:e}=this.kg.Sim(this.Sk,W)).returnValue,this.aNa(e)):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.y0(t)}DIi(e){e.isPartialTable=!!e&&(!!e[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]||
!!e[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]||!!e[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]||!!e[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]);e[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]=e[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]?e[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]:0;e[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]=e[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]?e[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]:0;e[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]=
e[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]?e[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]:0;e[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]=e[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]?e[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]:0}ICm(e){const t=new Eh(this.yea,this.rGb);t.fBe(()=>{this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.Lvb(null,t.Wmb)});this.kg.Vim(this.Sk,e,(E,W)=>{t.Ige?jg(Ag(t.HUd),!0):(t.clearTimeout(),this.we=E,this.Lvb(W,t.Wmb))})}y0(e){On(5,
this.Sk.yo,this.errorCode,{["CoercionType"]:e});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&z.ULS.sendTraceTag(16795287,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Sk.yo,["errMsg"]:"unexpected error to GetAppBindingData api",["CoercionType"]:e});this.zo()}aNa(e){this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=e)}Lvb(e,t){Ze(!0,this.errorCode,(e||"").length,Ag(t),this.Sk.yo);this.aNa(e);this.y0(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}}
Object(y.a)(Dc,"GetAppBindingDataMethod",Tg,[]);class yg extends Tg{constructor(e){super();this.pZ=e}go(){if(this.kg){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(e[OSF.DDA.Marshaling.BindingParameterKeys.Id])if(e=e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.pZ){let t={};this.we=({hL:t}=this.kg.wHf(e,this.Sk)).returnValue;this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=t}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;
else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;On(13,this.Sk.yo,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&z.ULS.sendTraceTag(9000010,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Sk.yo,["errMsg"]:"unexpected error to getAppBindingById api"});this.zo()}}Object(y.a)(yg,"GetAppBindingMethod",Tg,[]);class qj extends Tg{constructor(e){super();this.Ez=e}execute(){const e=
this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],t=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.XPath];let E,W;this.we=({EJa:E,QAb:W}=this.Ez.TQb(e)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)try{const ha=E.selectNodes(t,W);this.result[OSF.DDA.Marshaling.ListDescriptors.DataNodeList]=this.Ez.t2j(e.CustomXmlId,ha)}catch(ha){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}this.zo()}}Object(y.a)(qj,"GetDataNodesMethod",Tg,[]);class Mi extends Tg{constructor(e){super();
this.Ez=e}execute(){let e,t;this.we=({EJa:e,QAb:t}=this.Ez.TQb(this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle])).returnValue;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=e.getNodeText(t));this.zo()}}Object(y.a)(Mi,"GetDataNodeTextMethod",Tg,[]);class jh extends Tg{constructor(e){super();this.Ez=e}execute(){let e,t;this.we=({EJa:e,QAb:t}=this.Ez.TQb(this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle])).returnValue;
this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=9===t.nodeType||1===t.nodeType?e.getNodeXml(t):e.getNodeText(t));this.zo()}}Object(y.a)(jh,"GetDataNodeValueMethod",Tg,[]);class mi extends Tg{constructor(e){super();this.Ez=e}execute(){let e,t;this.we=({EJa:e,QAb:t}=this.Ez.TQb(this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle])).returnValue;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=
e.getNodeXml(t));this.zo()}}Object(y.a)(mi,"GetDataNodeXmlMethod",Tg,[]);class Sj extends Tg{constructor(e){super();this.sl=e}execute(){const e=this.sl.VVa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);if(void 0===e||null===e||this.sl.qYf(e))this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlNodeNotFound;else{const t={};t.id=e.id;t.DataPartBuiltIn=e.builtIn;this.result[OSF.DDA.Marshaling.PropertyDescriptors.DataPartProperties]=t;this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}this.zo()}}
Object(y.a)(Sj,"GetDataPartByIdMethod",Tg,[]);class wj extends Tg{constructor(e,t){super();this.sl=e;this.Ez=t}execute(){const e=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id],t=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.XPath],E=this.sl.VVa(e);if(void 0!==E&&null!==E)try{const W=E.selectNodes(t,null);this.result[OSF.DDA.Marshaling.ListDescriptors.DataNodeList]=this.Ez.t2j(e,W);this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}catch(W){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}else this.we=
OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.zo()}}Object(y.a)(wj,"GetDataPartNodesMethod",Tg,[]);class pm extends Tg{constructor(e){super();this.sl=e}execute(){const e=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],t=this.sl.W1c(),E=[];this.result[OSF.DDA.Marshaling.ListDescriptors.DataPartList]=E;this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;for(let W=0;W<t.length;W++){const ha=t[W];if(e===ha.namespace&&!this.sl.qYf(ha)){const Ka={};Ka.id=ha.id;Ka.DataPartBuiltIn=
ha.builtIn;E.push(Ka)}}this.zo()}}Object(y.a)(pm,"GetDataPartsByNamespaceMethod",Tg,[]);class jo extends Tg{constructor(e){super();this.sl=e}execute(){const e=this.sl.VVa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=void 0===e||null===e?null:e.j1a;this.we=void 0===e||null===e?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.zo()}}Object(y.a)(jo,"GetDataPartXmlMethod",Tg,[]);
class Oi extends Tg{constructor(e){super();this.sl=e}execute(){const e=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],t=this.sl.VVa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);void 0!==t&&null!==t?(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=t.T3c(e),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.zo()}}Object(y.a)(Oi,"GetDataPrefixByUriMethod",Tg,[]);class Fp extends Tg{constructor(e){super();
this.sl=e}execute(){const e=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Prefix],t=this.sl.VVa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);void 0!==t&&null!==t?(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=t.YLf(e),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.zo()}}Object(y.a)(Fp,"GetDataUriByPrefixMethod",Tg,[]);var Ek=d(789);class Yq{constructor(){this.transaction=this.Fxi=this.nob=this.FS=
null}}Object(y.a)(Yq,"GetDocumentTextOperationContext",null,[]);class vo extends Tg{constructor(){super();this.nIj=null;this.wEk=100;this.fqm=(e,t)=>{for(e=0;e<this.wEk;e++)if(t.FS.moveNext()){if(t.FS.currentNode.jz){var E=hi.SelectionFactory.lr(t.FS.currentNode);E=this.kg.r9d(E);E!==sn.AParagraphNode.oE&&(t.nob+=sn.AParagraphNode.iV(E))}}else return t.transaction&&t.transaction.dispose(),t.Fxi(t.nob),!1;return!0}}go(){let e=!1;this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.kg&&
this.kg.IKa&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType]&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize]){const t=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType],E=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize];this.kg.IKa.IXi(this.controlId)?this.we=
OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:0>=E?(z.ULS.sendTraceTag(7123611,341,15,"Invalid slice size. It should be greater than 0."),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize):this.Urn(t)?e=this.hIm(t,E):(z.ULS.sendTraceTag(7123612,341,15,"Requested file type {0} is not supported.",t),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported)}e||this.zo()}Urn(e){return e===OSF.DDA.Marshaling.File.FileType.Compressed||e===OSF.DDA.Marshaling.File.FileType.Pdf||
e===OSF.DDA.Marshaling.File.FileType.Text}hIm(e,t){const E=(W,ha)=>{const Ka={};Ka.FileType=e;Ka.SliceSize=t;On(8,this.Sk.yo,W,Ka);this.Kgo(ha);this.Upm(W)};if(e===OSF.DDA.Marshaling.File.FileType.Text)return this.eqm(t,E);this.kg.IKa.$pm(this.controlId,e,t,E);return!0}eqm(e,t){z.ULS.sendTraceTag(8914013,341,100,"Started to get document content in text format; sliceSize is "+e);const E=this.gPm();if(!E)return!1;this.XKm(e,t,E).run();return!0}XKm(e,t,E){const W=new Yq;W.FS=E;W.nob="";W.transaction=
this.Ztm(E);W.Fxi=ha=>{(ha=this.Xpm(ha,e))?(t(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,ha),z.ULS.sendTraceTag(8914015,341,100,"Finished getting text content.")):(t(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize,null),z.ULS.sendTraceTag(8914014,341,10,"Cannot get DocumentFile object."))};E=new Ek.a(null,this.fqm,W);E.vm("GetDocumentCopyInText");this.G0f()&&(E.ni=!0);return E}G0f(){return!!this.nIj}Ztm(e){if(this.G0f())return null;const t=(new ge.a).Mc(3);t.Ab(e.currentNode);return t}gPm(){if(this.G0f())var e=
this.nIj;else{if(!Lh.a.en||!Lh.a.en.ib||!Lh.a.en.ib.sc)return z.ULS.sendTraceTag(8914016,341,10,"Cannot find ContentView in workspace of word frame."),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext,null;e=(new uh.a).Ksa(Lh.a.en.ib.sc.jd,7,7).currentNode}const t=new wh.a;t.set(e);e=Hc.a.Bq(t);e.vp(df.SelectionEditor.Iob,null);return e}Xpm(e,t){if(!e&&""!==e)return null;const E=vo.dkm(e);if(!this.Fpl(t,E))return null;e=vo.eLm(e,t);if(!e)return null;t=this.kg.IKa.k$h(this.controlId,
E,t,e);t.C1f=!0;z.ULS.sendTraceTag(8914017,341,100,"Got DocumentFile; total bytes are "+E);return t}Fpl(e,t){return e<t&&e%2?(z.ULS.sendTraceTag(8914018,341,15,"Invalid slice size. It should not be odd number."),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize,!1):!0}Kgo(e){e&&(this.result[""+OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle]=e.Sni,this.result[""+OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize]=e.fileSize)}Upm(e){this.we=e;this.zo()}static dkm(e){return 2*e.length+
2}static eLm(e,t){const E=new fa.a;var W=0;t/=2;do{const ha=W+(E.count?t:t-1);W=Qd.a.substring(e,W,ha);E.add(W);W=ha}while(W<e.length);return E}}Object(y.a)(vo,"GetDocumentCopyMethod",Tg,[]);class xn extends Tg{constructor(){super()}go(){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;z.ULS.shipAssertTag(20711197,341,!!this.kg.IKa);if(this.kg&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]&&
void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex]){const E=this.kg.IKa.Cxi(this.controlId,this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]);if(E){var e=E.lpc,t=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex];if(E.C1f)this.result[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data]=E.qDf.J(t),this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.zo();else try{this.kg.IKa.dqm(this.controlId,
t,e,(W,ha)=>{if(ha){ha=window.self.atob(ha);const Ka=Array(ha.length);for(let sb=0;sb<ha.length;sb++)Ka[sb]=ha.charCodeAt(sb);this.result[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data]=Ka;this.result[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize]=ha.length;this.we=W;this.zo()}})}catch(W){z.ULS.sendTraceTag(20711198,341,15,"Error happens when converting string data to binary data. "+W.message)}}}}}Object(y.a)(xn,"GetDocumentCopySliceMethod",Tg,[]);class qr extends Tg{constructor(){super()}execute(){let e=
null;if(this.kg&&({url:e}=this.kg.Vop()).returnValue){const t={};t[""+OSF.DDA.Marshaling.FilePropertiesKeys.Url]=e;this.result[""+OSF.DDA.Marshaling.FilePropertiesKeys.Properties]=t;this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}}Object(y.a)(qr,"GetFilePropertiesMethod",Tg,[]);class gn{constructor(){this.context=null;this.errorCode=0}}Object(y.a)(gn,"NestedAppAuthContextResult",null,[]);class Cs{static PAm(e,t){const E=new gn;(e=e.getOsfControl(t))&&e.isFirstParty()?(E.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
e={},t=v.AFrameworkApplication.K.kb("AADUserObjectId"),e.userObjectId=t?t:v.AFrameworkApplication.K.kb("HostUserId"),e.userPrincipalName=v.AFrameworkApplication.K.kb("UserPrincipalName"),e.tenantId=v.AFrameworkApplication.K.kb("TenantId"),t=(v.AFrameworkApplication.K.kb("HostAuthType")||"").toLowerCase(),e.authorityType="aad"===t?"aad":"msa"===t?"msa":"other",E.context=e):E.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;return E}}Object(y.a)(Cs,"NestedAppAuthUtil",null,[]);class Hi extends Tg{constructor(e){super();
this.Ch=e}go(){const e=Cs.PAm(this.Ch.au,this.controlId||"");this.we=e.errorCode;if(e.errorCode==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)for(const [t,E]of Object.entries(e.context))this.result[t]=E;this.zo()}}Object(y.a)(Hi,"GetNestedAppAuthContextMethod",Tg,[]);class Tm extends Tg{constructor(e,t,E,W,ha,Ka){super();this.jBk=e;this.fBk=t;this.jCk=E;this.wBk=W;this.rGb=ha;this.yea=Ka}go(){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.GetData];let t=null;if(this.kg)if(void 0===
e[OSF.DDA.Marshaling.GetDataKeys.CoercionType]||null===e[OSF.DDA.Marshaling.GetDataKeys.CoercionType])this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;else if(t=e[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString(),t===OSF.DDA.Marshaling.CoercionTypeKeys.Text)this.we=({Cwc:e}=this.kg.getSelectedText()).returnValue,this.aNa(e);else if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&this.jCk)this.we=({uNo:e}=this.kg.RJm()).returnValue,this.aNa(e);else if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix&&
this.wBk)this.we=({nNo:e}=this.kg.NJm()).returnValue,this.aNa(e);else{if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.fBk){this.PJm();return}t===OSF.DDA.Marshaling.CoercionTypeKeys.Html&&this.jBk?(this.we=({TKj:e}=this.kg.HJm()).returnValue,this.aNa(e)):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.y0(t)}PJm(){const e=new Eh(this.yea,this.rGb);e.fBe(()=>{this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;
this.Lvb(null,e.Wmb)});this.kg.OJm((t,E)=>{e.Ige?jg(Ag(e.HUd),!0):(e.clearTimeout(),this.we=t,this.Lvb(E,e.Wmb))})}aNa(e){this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=e)}Lvb(e,t){Ze(!0,this.errorCode,(e||"").length,Ag(t),this.Sk.yo);this.aNa(e);this.y0(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}y0(e){On(1,this.Sk.yo,this.errorCode,{["CoercionType"]:e});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&
z.ULS.sendTraceTag(17385222,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Sk.yo,["errMsg"]:"unexpected error to GetSelectedDataAsync api",["CoercionType"]:e});this.zo()}execute(){}}Object(y.a)(Tm,"GetSelectedDataMethod",Tg,[]);class gs{constructor(){this.languageId=0;this.displayName=this.name=null}}Object(y.a)(gs,"TranslationLanguageInfo",null,[]);class pk{constructor(e,t){this.RIh=null;this.Hbf=!1;this.ssc=E=>{E={["Status"]:E.data.status,["HttpStatus"]:E.data.He,["ResponseData"]:Qd.a.j3j(E.data.De)};
z.ULS.sendTraceTag(42295809,301,10,"Failed to get the supported translation languages. The translation languages from BRS setting will be used. Error: {0}",E)};this.Xed=E=>{z.ULS.sendTraceTag(42295810,301,50,"Retrieved the supported translation languages successfully.");let W;try{W=qe.b(E.data.De)}catch(ha){z.ULS.sendTraceTag(42295811,301,10,"Failed to deserialize the supported translation languages. The translation languages from BRS setting will be used. Exception: {0}",ha);return}this.Rtp(W)};
this.gLk=e;this.Tsk=t}PEo(){v.AFrameworkApplication.Be.Ij(this.gLk(),1,null,null,!1,2,this.Xed,this.ssc,null)}txm(){const e=(this.RIh||this.Tsk()).split(","),t=this.Hbf?e.length/3:e.length/2,E=Array(t);for(let W=0;W<t;W++){E[W]=new gs;E[W].name=e[W];const ha=parseInt(e[W+t]);E[W].languageId=ha;E[W].displayName=this.Hbf?e[W+2*t]:mb.a.ZKi()[ha]}return E}Rtp(e){this.RIh=e.TranslationLanguages;this.Hbf=Boolean.parse(e.TranslationLanguagesLocalized||"false")}}Object(y.a)(pk,"TranslationLanguagesManager",
null,[]);var Yo=d(1294),Hr=d(2095);class Wn{constructor(){this.oEc=!1}start(e){Wn.Beb(this.$Ep,Object(ib.a)(this,this.onCancel,"onCancel"));Hr.a.Laa(this.SEo,Object(ib.a)(this,this.hWn,"onComplete"),e)}onCancel(){this.oEc=!0;Wn.bsa()}hWn(e,t,E){this.oEc||(t||(t=e?"Success":"UnknownError"),"Success"===t?(this.Sgi&&Wn.bsa(),this.BE(E)):(this.vhn(t)?z.ULS.sendTraceTag(51708544,301,15,"Translation failed due to an issue in the document: "+t):z.ULS.sendTraceTag(39387393,301,10,"WordViewer translation failed: "+
t),Wn.bsa(),e=this.Ffa(t),1!==v.AFrameworkApplication.ua.state&&(v.AFrameworkApplication.K.$("ReportConversionFailedErrorUnderAdditionalVetoes")&&v.AFrameworkApplication.qS(nb.a.Z7h,void 0,["TranslationFailed"]),t=new Pa.StandardDialog,t.Gd=0,t.Pe(1,CommonUIStrings.l_DialogClose),t.Gy(nb.a.Z7h,CommonUIStrings.l_DefaultDialogTitle,e,null))))}static Beb(e,t){const E=new Yo.a;Wn.kl=E.create();Wn.kl.message=e;Wn.kl.lM(CommonUIStrings.l_DefaultDialogTitle,t,null)}static bsa(){Wn.kl&&(Wn.kl.close(),Wn.kl=
null)}}Wn.kl=null;Object(y.a)(Wn,"TranslationRequest",null,[]);class Fq extends Wn{constructor(e,t=0){super();this.QFd=e;this.eIk=t;this.ji=(new Date).getTime();v.AFrameworkApplication.wm.s$a(9984)}start(e){z.ULS.sendTraceTag(23184016,301,50,"Translation started");super.start(e)}onCancel(e){super.onCancel(e);v.AFrameworkApplication.wm.s$a(9986);z.ULS.sendTraceTag(40953793,301,50,"Translation canceled")}BE(){const e=(new Date).getTime()-this.ji;v.AFrameworkApplication.wm.setDw(9985,e);this.redirect();
z.ULS.sendTraceTag(23184017,301,50,"Translation succeeded")}get $Ep(){return 10<=this.eIk?CommonUIStrings.l_WaitForLongTranslation:CommonUIStrings.l_WaitForTranslation}get Sgi(){return!1}Ffa(e){return"TranslationServiceUnavailable"===e?CommonUIStrings.l_TranslationServiceUnavailable:"DocumentCannotBeTranslated"===e?CommonUIStrings.l_DocumentCannotBeTranslated:"DocumentHasOCX"===e?CommonUIStrings.l_DocumentCannotBeTranslatedOCX:"DocumentTooLong"===e?CommonUIStrings.l_DocumentCannotBeTranslatedLength:
CommonUIStrings.l_GenericTranslationError}vhn(e){return"DocumentCannotBeTranslated"===e||"DocumentHasOCX"===e||"DocumentTooLong"===e}}Object(y.a)(Fq,"TranslateDocumentRequest",Wn,[]);var Vs=d(455);class kp extends Fq{constructor(e){super(e)}redirect(){z.ULS.sendTraceTag(592255192,324,100,"Navigate to view mode for translation");if(Vs.b(v.AFrameworkApplication.K)){var e=new gf.a;e.add("language",this.QFd);e.add("fromeditor","1");Vs.d("view",e,Vs.e)}else e=A.a.lp(Lh.a.en.CAb,"language",this.QFd)+"&fromeditor=1",
tb.a.openWindow(1,e)}get Sgi(){return!0}get SEo(){return S.App.webServiceBase+"docdatahandler.ashx?"+v.AFrameworkApplication.jm+"&language="+Qd.a.ej(this.QFd)+"&languagename="+Qd.a.ej(this.QFd)+"&type=png&o15=1"}}Object(y.a)(kp,"TranslateDocumentRequestFromEditor",Fq,[]);class xl{static B2j(e){(new kp(e)).start(Cc.StaticActiveAppFrame.za().nK)}static uxm(){return S.App.webServiceBase+"translation.ashx?"+v.AFrameworkApplication.jm+"&uilang="+Qd.a.ej(v.AFrameworkApplication.uiCulture)}static lpm(){return S.App.Csd}}
xl.Csd=new pk(xl.uxm,xl.lpm);Object(y.a)(xl,"TranslationManager",null,[]);class Um extends Tg{constructor(e,t,E){super();this.Uip=t;this.enabled=E}go(){if(this.enabled){var e=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],t=e[OSF.DDA.Marshaling.NavigationKeys.Id].toString(),E=e[OSF.DDA.Marshaling.NavigationKeys.GoToType];e=e[OSF.DDA.Marshaling.NavigationKeys.SelectionMode];var W=null;t&&t.startsWith("TranslatedDocument")&&(W=t.split("|"),W=2===W.length?W[1]:null);W?(xl.B2j(W),
this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.we=this.Ctn(E)&&this.Rtn(e)?this.kg.JSm(t,e,this.Uip,this.Sk):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration;On(15,this.Sk.yo,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&z.ULS.sendTraceTag(17585945,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Sk.yo,["errMsg"]:"unexpected error to goToByIdAsync api"})}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}Ctn(e){return e===
OSF.DDA.Marshaling.GoToType.Binding}Rtn(e){return e===OSF.DDA.Marshaling.SelectionMode.Default||e===OSF.DDA.Marshaling.SelectionMode.Selected||e===OSF.DDA.Marshaling.SelectionMode.None}}Object(y.a)(Um,"GoToByIdAsyncMethod",Tg,[]);class Ga extends Tg{constructor(){super()}execute(){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.kg){const e=this.GFf(this.kg.kbb(this.Sk));if(e){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;const t={};t.Settings=e;this.result[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=
t}}}GFf(e){const t={};let E=0;for(const W in e)t[""+E]=[W,e[W]],E++;return t}}Object(y.a)(Ga,"LoadSettingsMethod",Tg,[]);class Ib extends Tg{constructor(e){super();this.Kxa=e}go(){let e;e=this.Kxa?this.kg?this.kg.yOa.jej(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],this.parameters[nc.a.jhf],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]):OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;
this.mMn(e)}OX(){On(16,this.Sk.yo,this.errorCode,null);this.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&z.ULS.sendTraceTag(18376392,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Sk.yo,["errMsg"]:"MessageParent API failed!"})}mMn(e){this.we=e;this.OX();this.zo()}}Object(y.a)(Ib,"MessageParentMethod",Tg,[]);class lc extends Tg{constructor(e){super();this.Hwo=t=>{this.we=t;this.zo()};this.pZ=e}go(){if(this.pZ)if(this.kg){var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];
e=e[OSF.DDA.Marshaling.BindingParameterKeys.Id]?this.kg.Iwo(e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.Sk,this.Hwo):OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else e=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;On(14,this.Sk.yo,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&z.ULS.sendTraceTag(9225408,341,10,"{0}",{["error"]:e,["appId"]:this.Sk.yo,["errMsg"]:"unexpected error to releaseAppBindingById api"});
e!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.we=e,this.zo())}}Object(y.a)(lc,"ReleaseAppBindingMethod",Tg,[]);class Mc extends Tg{constructor(){super()}execute(){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.SettingsRequest];e=Array.isArray(e[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?e[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null;this.kg&&(this.we=this.kg.saveSettings(this.Sk,this.GFf(e)))}GFf(e){const t=
{};if(e)for(let E=0;E<e.length;E++){const W=Array.isArray(e[E])?e[E]:null;W&&1<W.length&&(t[W[0]]=W[1])}return t}}Object(y.a)(Mc,"SaveSettingsMethod",Tg,[]);class Bd extends Tg{constructor(e,t,E,W,ha){super();this.AMj=(Ka,sb)=>{this.we=Ka;this.y0(sb)};this.TYe=e;this.IKe=t;this.pZ=E;this.rGb=W;this.yea=ha}go(){const e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.SetData];let t=null;if(this.pZ)if(this.kg)if(void 0===e[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||null===e[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||
void 0===e[OSF.DDA.Marshaling.SetDataKeys.Data]||null===e[OSF.DDA.Marshaling.SetDataKeys.Data]||void 0===e[OSF.DDA.Marshaling.BindingParameterKeys.Id]||null===e[OSF.DDA.Marshaling.BindingParameterKeys.Id])this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;else{t=e[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString();var E=e[OSF.DDA.Marshaling.SetDataKeys.Data].toString();const ha=e[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();let Ka;({hL:W}=this.kg.wHf(ha,this.Sk));if(W&&(Ka=
W[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties])){var W=Ka[OSF.DDA.Marshaling.AppBindingKeys.BindingType];if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Text)this.we=this.kg.dzg(this.Sk,ha,E);else if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.TYe){if(E.startsWith("<")){this.eWo(ha,E);return}this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else{if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Html&&this.IKe){this.$To(ha,E);return}if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Table)if(W===
OSF.DDA.Marshaling.CoercionTypeKeys.Table){if((this.we=({Kwj:E}=this.H4j(e,Ka)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){this.kg.aRo(this.Sk,ha,e[OSF.DDA.Marshaling.SetDataKeys.Data],E,this.AMj);return}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)if(W===OSF.DDA.Marshaling.CoercionTypeKeys.Table||W===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix){if((this.we=({Kwj:E}=this.H4j(e,Ka)).returnValue)===
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){this.kg.ZQo(this.Sk,ha,e[OSF.DDA.Marshaling.SetDataKeys.Data],E,this.AMj);return}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.y0(t)}H4j(e,
t){let E=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;const W=t[OSF.DDA.Marshaling.AppBindingKeys.RowCount];t=t[OSF.DDA.Marshaling.AppBindingKeys.ColumnCount];var ha=!!e&&(!!e[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]||!!e[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]);const Ka={};(Ka.isPartialTable=ha)?(ha=e[OSF.DDA.Marshaling.BindingParameterKeys.StartRow],e=e[OSF.DDA.Marshaling.BindingParameterKeys.StartCol],0>ha||ha>=W||0>e||e>=t?E=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetStartRowColumn:
(Ka.startRow=ha,Ka.startCol=e)):(Ka.startRow=0,Ka.startCol=0);return{returnValue:E,Kwj:Ka}}y0(e){On(6,this.Sk.yo,this.errorCode,{["CoercionType"]:e});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&z.ULS.sendTraceTag(16795289,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Sk.yo,["errMsg"]:"unexpected error to SetAppBindingData API",["CoercionType"]:e});this.zo()}$To(e,t){this.kg.YQo(this.Sk,e,t,E=>{this.we=E;this.y0(OSF.DDA.Marshaling.CoercionTypeKeys.Html)})}eWo(e,t){const E=
new Eh(this.yea,this.rGb);E.fBe(()=>{this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.Lvb(E.Wmb,t.length)});this.kg.$Qo(this.Sk,e,t,W=>{E.Ige?jg(Ag(E.HUd),!1):(E.clearTimeout(),this.we=W,this.Lvb(E.Wmb,t.length))})}Lvb(e,t){Ze(!1,this.errorCode,t,Ag(e),this.Sk.yo);this.y0(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}}Object(y.a)(Bd,"SetAppBindingDataMethod",Tg,[]);class Ie extends Tg{constructor(e,t){super();this.MGa=e;this.Ez=t}execute(){if(this.MGa){var e=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],
t=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Text],E,W;this.we=({EJa:E,QAb:W}=this.Ez.TQb(e)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){if(E.builtIn){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;jp(21,this.errorCode,this.Sk);this.zo();return}const ha=W.cloneNode(!0);E.setNodeText(W,t)?1!==W.nodeType?this.Ez.zjd(W,ha,e):(t=ha.childNodes,this.we=void 0!==t&&null!==t&&t.length?1===t.length&&3===t[0].nodeType?this.Ez.zjd(W.firstChild,t[0],
e):this.Ez.zjd(W.firstChild,ha,e):this.Ez.qmo(W.firstChild,e)):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;jp(6,this.errorCode,this.Sk);this.zo()}}Object(y.a)(Ie,"SetDataNodeTextMethod",Tg,[]);class zf extends Tg{constructor(e,t){super();this.MGa=e;this.Ez=t}execute(){if(this.MGa){var e=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],t=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.Data],
E,W;this.we=({EJa:E,QAb:W}=this.Ez.TQb(e)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){if(E.builtIn){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.zo();return}const ha=W.cloneNode(!0);9!==W.nodeType&&1!==W.nodeType&&E.setNodeText(W,t)?this.we=this.Ez.zjd(W,ha,e):this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.zo()}}Object(y.a)(zf,"SetDataNodeValueMethod",
Tg,[]);class Qe extends Tg{constructor(e,t,E){super();this.MGa=e;this.Ez=t;this.a6b=E}execute(){if(this.MGa){var e=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],t=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Xml],E,W;this.we=({EJa:E,QAb:W}=this.Ez.TQb(e)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){if(E.builtIn){this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.zo();return}const ha=W.cloneNode(!0);if(t=E.setNodeXml(W,t)){({avd:E}=
this.Ez.OKi(e));if(void 0!==E&&null!==E&&E[e.NodeIndex]===W)try{E[e.NodeIndex]=t}catch(Ka){this.a6b.ncj(e.NodeListCacheId)}this.we=this.Ez.zjd(t,ha,e)}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.zo()}}Object(y.a)(Qe,"SetDataNodeXmlMethod",Tg,[]);class bg extends Tg{constructor(e,t,E,W,ha){super();this.IKe=e;this.nnk=t;this.rGb=E;this.yea=W;this.WBk=ha.$("WordEditorAppsForOfficeSetSelectedDataAsyncCoercionTypeTableIsEnabled");
this.VBk=ha.$("WordEditorAppsForOfficeSetSelectedDataAsyncCoercionTypeMatrixIsEnabled");this.UBk=ha.$("WordEditorAppsForOfficeImageCoercionTypeIsEnabled")}go(){const e=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.SetData];let t="";if(this.kg)if(void 0===e[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||null===e[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||void 0===e[OSF.DDA.Marshaling.SetDataKeys.Data]||null===e[OSF.DDA.Marshaling.SetDataKeys.Data])this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;
else{t=e[OSF.DDA.Marshaling.SetDataKeys.CoercionType].toString();if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Text){this.Kho(e);return}if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Html&&this.IKe){this.Fho(e);return}if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.nnk){if(e[OSF.DDA.Marshaling.SetDataKeys.Data].toString().startsWith("<")){this.Iho(e);return}this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else{if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&this.WBk){this.Jho(e);return}if(t===
OSF.DDA.Marshaling.CoercionTypeKeys.Matrix&&this.VBk){this.Hho(e);return}if(t===OSF.DDA.Marshaling.CoercionTypeKeys.Image&&this.UBk){this.Gho(e);return}this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}else this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.y0(t)}Jho(e){this.kg.ZXo(e[OSF.DDA.Marshaling.SetDataKeys.Data],t=>{this.we=t;this.y0(OSF.DDA.Marshaling.CoercionTypeKeys.Table)})}Hho(e){this.kg.WXo(e[OSF.DDA.Marshaling.SetDataKeys.Data],t=>{this.we=t;this.y0(OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)})}Kho(e){this.kg.$Xo(e[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),
t=>{this.we=t;this.y0(OSF.DDA.Marshaling.CoercionTypeKeys.Text)})}Fho(e){this.kg.TXo(e[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),t=>{this.we=t;this.y0(OSF.DDA.Marshaling.CoercionTypeKeys.Html)})}Iho(e){const t=e[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),E=new Eh(this.yea,this.rGb);E.fBe(()=>{this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.HPj(E.Wmb,t.length)});this.kg.XXo(t,W=>{E.Ige?jg(Ag(E.HUd),!1):(E.clearTimeout(),this.we=W,this.HPj(E.Wmb,t.length))})}Gho(e){const t=
e[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),E=e[OSF.DDA.Marshaling.SetDataKeys.ImageWidth];e=e[OSF.DDA.Marshaling.SetDataKeys.ImageHeight];0>E||0>e?(this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.y0(OSF.DDA.Marshaling.CoercionTypeKeys.Image)):this.kg.UXo(t,E,e,W=>{this.we=W;this.y0(OSF.DDA.Marshaling.CoercionTypeKeys.Image)})}HPj(e,t){Ze(!1,this.errorCode,t,Ag(e),this.Sk.yo);this.y0(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}y0(e){On(2,this.Sk.yo,this.errorCode,{["CoercionType"]:e});
this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&z.ULS.sendTraceTag(17585946,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.Sk.yo,["errMsg"]:"unexpected error to setSelectedDataAsync API",["CoercionType"]:e});this.zo()}}Object(y.a)(bg,"SetSelectedDataMethod",Tg,[]);class Rg extends Tg{constructor(){super()}go(){32===v.AFrameworkApplication.va.Ob(this.parameters[0],2)?this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
this.zo()}}Object(y.a)(Rg,"ExecuteFeature",Tg,[]);class di extends Tg{constructor(){super()}go(){const e=v.AFrameworkApplication.va.Ob(this.parameters[0],1);this.we=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.Xp[0]=32===e;this.Xp[1]=!0;this.zo()}}Object(y.a)(di,"QueryFeature",Tg,[]);class mh extends rq{constructor(e,t,E,W,ha,Ka,sb){super();this.kVe=e;this.Ga=t;this.yea=E;this.sl=W;this.a6b=ha;this.Ez=Ka;this.Ch=sb}lHf(e){if(e=super.lHf(e))e.kg=this.kVe;return e}yco(){const e=this.Ga.$("WordEditorAppsForOfficeImportExternalHtmlDataIsEnabled")&&
Yi.a.HBe,t=this.Ga.$("WordEditorAppsForOfficeSelectionOoxmlIsEnabled"),E=this.Ga.ic("WordEditorAppsForOfficeSelectionOoxmlRequestTimeoutMilliSec",3E4),W=this.Ga.$("WordEditorAppsForOfficeCustomXmlWriteIsEnabled"),ha=new Yc.a;ha.Z(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>{const dc=this.Ga.$("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeHtmlIsEnabled"),xc=this.Ga.$("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeTableIsEnabled"),Rc=this.Ga.$("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeMatrixIsEnabled");
return new Tm(dc,t,xc,Rc,E,this.yea)});ha.Z(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,()=>new bg(e,t,E,this.yea,this.Ga));ha.Z(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new qr);ha.Z(OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod,()=>new Hi(this.Ch));ha.Z(OSF.DDA.MethodDispId.dispidAddDataPartMethod,()=>new wn(W,this.sl));ha.Z(OSF.DDA.MethodDispId.dispidGetDataPartByIdMethod,()=>new Sj(this.sl));ha.Z(OSF.DDA.MethodDispId.dispidGetDataPartsByNamespaceMethod,()=>new pm(this.sl));
ha.Z(OSF.DDA.MethodDispId.dispidGetDataPartXmlMethod,()=>new jo(this.sl));ha.Z(OSF.DDA.MethodDispId.dispidGetDataPartNodesMethod,()=>new wj(this.sl,this.Ez));ha.Z(OSF.DDA.MethodDispId.dispidDeleteDataPartMethod,()=>new bq(W,this.sl));ha.Z(OSF.DDA.MethodDispId.dispidGetDataNodeValueMethod,()=>new jh(this.Ez));ha.Z(OSF.DDA.MethodDispId.dispidGetDataNodeXmlMethod,()=>new mi(this.Ez));ha.Z(OSF.DDA.MethodDispId.dispidGetDataNodeTextMethod,()=>new Mi(this.Ez));ha.Z(OSF.DDA.MethodDispId.dispidGetDataNodesMethod,
()=>new qj(this.Ez));ha.Z(OSF.DDA.MethodDispId.dispidSetDataNodeValueMethod,()=>new zf(W,this.Ez));ha.Z(OSF.DDA.MethodDispId.dispidSetDataNodeXmlMethod,()=>new Qe(W,this.Ez,this.a6b));ha.Z(OSF.DDA.MethodDispId.dispidSetDataNodeTextMethod,()=>new Ie(W,this.Ez));ha.Z(OSF.DDA.MethodDispId.dispidAddDataNamespaceMethod,()=>new pr(W,this.sl));ha.Z(OSF.DDA.MethodDispId.dispidGetDataUriByPrefixMethod,()=>new Fp(this.sl));ha.Z(OSF.DDA.MethodDispId.dispidGetDataPrefixByUriMethod,()=>new Oi(this.sl));const Ka=
this.Ga.$(mh.cSh),sb=this.Ga.$(mh.M5k);ha.Z(OSF.DDA.MethodDispId.dispidGetBindingMethod,()=>new yg(Ka));ha.Z(OSF.DDA.MethodDispId.dispidGetAllBindingsMethod,()=>new Wd(Ka));ha.Z(OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod,()=>new Cm(sb));ha.Z(OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod,()=>new um(sb));ha.Z(OSF.DDA.MethodDispId.dispidSetBindingDataMethod,()=>new Bd(t,e,sb,E,this.yea));ha.Z(OSF.DDA.MethodDispId.dispidGetBindingDataMethod,()=>new Dc(t,Ka,E,this.yea));ha.Z(OSF.DDA.MethodDispId.dispidReleaseBindingMethod,
()=>new lc(sb));ha.Z(OSF.DDA.MethodDispId.dispidAddColumnsMethod,()=>new Ep(sb));ha.Z(OSF.DDA.MethodDispId.dispidAddRowsMethod,()=>new Ul(sb));ha.Z(OSF.DDA.MethodDispId.dispidClearAllRowsMethod,()=>new uo(sb));Yi.a.QBe?(ha.Z(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>new xn),ha.Z(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new vm),ha.Z(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new vo)):(ha.Z(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>Tg.TYd(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)),
ha.Z(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>Tg.TYd(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)),ha.Z(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>Tg.TYd(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)));ha.Z(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>{const dc=this.Ga.$("WordEditorExtensionRichAPIIsEnabled");return new ca(dc)});ha.Z(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,()=>new Ga);ha.Z(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,
()=>new Mc);ha.Z(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>{const dc=this.Ga.$(mh.cSh);return new Um(Wg.a.instance,Object(ki.a)().Ke.me,dc)});ha.Z(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>{const dc=this.Ga.$("WordEditorAppsForOfficeShowDialogApiIsEnabled");return new Ib(dc)});ha.Z(OSF.DDA.MethodDispId.dispidSendMessageMethod,()=>{const dc=this.Ga.$("WordEditorAppsForOfficeShowDialogApiIsEnabled");return new so(dc)});ha.Z(OSF.DDA.MethodDispId.dispidExecuteFeature,()=>new Rg);ha.Z(OSF.DDA.MethodDispId.dispidQueryFeature,
()=>new di);ha.Z(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>new to);ha.Z(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,()=>{const dc=this.Ga.$("WordEditorAppsForOfficeSingleSignOnIsEnabled");return new rd(dc,this.Ch)});ha.Z(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new Tl(this.Ch));return ha}}mh.cSh="WordEditorAppsForOfficeAppBindingReadFeatureIsEnabled";mh.M5k="WordEditorAppsForOfficeAppBindingWriteFeatureIsEnabled";Object(y.a)(mh,"WordEditorMethodFactory",rq,
[]);class Fk extends hj{constructor(){super()}wc(e){if(Lh.a.Pud||Lh.a.X3f||nj.a.aTb||v.AFrameworkApplication.wKb||v.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")||v.AFrameworkApplication.K.$("AddInCommandsIsEnabled")){super.wc(e);var t=v.AFrameworkApplication.K.$("WordEditorAppsForOfficeAppBindingReadFeatureIsEnabled"),E=v.AFrameworkApplication.K.$("WordEditorAppsForOfficeAppBindingWriteFeatureIsEnabled"),W=v.AFrameworkApplication.K.$("WordEditorContentControlReadIsEnabled"),ha=v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled");
e.ia("WordEditor.AppsForOffice.GetFileApiHelper",()=>new ef(ef.Hkf,()=>v.AFrameworkApplication.rootQuerySignature,dk.PageReader.instance,Cc.StaticActiveAppFrame.za().ib.$c,new uj.a,v.AFrameworkApplication.K,e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"))).as("WordEditor.AppsForOffice.IGetFileApiHelper").ha();e.ia("Box4.AppsForOffice.ShowDialogApiHelper",()=>new Ge(Cc.StaticActiveAppFrame.za(),e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"),e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).as("Box4.AppsForOffice.IShowDialogApiHelper").ha();
W&&t&&e.ia("WordEditor.AppsForOffice.AppBindingHelper",()=>new Jf(e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeModel"),e.resolve("WordEditor.ContentControl.IContentControlManager"),Wg.a.instance,new ge.a,new Ue.a(()=>Cc.StaticActiveAppFrame.za().ib.$c.td),e.resolve("WordEditor.AppsForOffice.TableMatrixHelper"),e.resolve("WordEditor.ITableEditor"),e.resolve("WordEditor.AppsForOffice.IHtmlDataGetSetProvider"),e.resolve("Box4.ContentControlParagraphMapping"),e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).as("WordEditor.AppsForOffice.IAppBindingHelper").ha();
e.ia("WordEditor.AppsForOffice.TableMatrixHelper",()=>new bl(v.AFrameworkApplication.va,Wg.a.instance,e.resolve("WordEditor.ITableEditor"))).ha();e.ia("WordEditor.AppsForOffice.CustomXmlHelper",()=>new ea(e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),e.resolve("WordEditor.AppsForOffice.ICustomXmlNodeListCache"))).as("WordEditor.AppsForOffice.ICustomXmlHelper").ha();e.ia("WordEditor.AppsForOffice.CustomXmlNodeListCache",()=>new Ad(new Ue.a(()=>v.AFrameworkApplication.K.ic("WordEditorCustomXmlMaximumDataCollectionNumber",
1024)),e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"))).as("WordEditor.AppsForOffice.ICustomXmlNodeListCache").ha();e.ia("WordEditor.AppsForOffice.OoxmlSelectionManager",()=>new Mh(v.AFrameworkApplication.ua.hs,()=>dk.PageReader.instance.z7d(Cc.StaticActiveAppFrame.za().ib.$c),()=>v.AFrameworkApplication.rootQuerySignature,e.Oa("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),lf.a.mU,v.AFrameworkApplication.K.$("AppsForOfficeFixIpIssueForInsertOoxmlIsEnabled"))).as("WordEditor.AppsForOffice.IOoxmlSelectionManager").ha();
e.ia("WordEditor.AppsForOffice.OoxmlRangeManager",()=>new ih(e.resolve("WordEditor.AppsForOffice.IOoxmlSelectionManager"))).as("WordEditor.AppsForOffice.IOoxmlRangeManager").ha();e.ia("WordEditor.AppsForOffice.HtmlDataGetSetProvider",()=>new mf(Wg.a.instance,e.Oa("Box4.Actors.InternalClipboard"),v.AFrameworkApplication.va,e.resolve("Box4.IHtmlViewRootFactory"),oj.a.$sa())).as("WordEditor.AppsForOffice.IHtmlDataGetSetProvider").ha();e.ia("WordEditor.AppsForOffice.WordEditorApiObjectModel",()=>new kj(Wg.a.instance,
v.AFrameworkApplication.va,e.resolve("WordEditor.AppsForOffice.GetFileApiHelper"),e.resolve("Box4.AppsForOffice.IShowDialogApiHelper"),e.resolve("WordEditor.AppsForOffice.ICustomXmlHelper"),e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeModel"),e.resolve("WordEditor.AppsForOffice.IOoxmlSelectionManager"),e.resolve("WordEditor.AppsForOffice.IOoxmlRangeManager"),e.resolve("WordEditor.AppsForOffice.IHtmlDataGetSetProvider"),new ge.a,W&&t?e.resolve("WordEditor.AppsForOffice.IAppBindingHelper"):
null,e.resolve("WordEditor.Extension.DocumentFactory"),e.resolve("WordEditor.AppsForOffice.TableMatrixHelper"),new uh.a,e.resolve("Box4.IParagraphReader"),Pj.a.instance)).as("WordEditor.AppsForOffice.IWordEditorApiObjectModel").ha();e.ia("WordEditor.AppsForOffice.WindowTimer",()=>new Bf).as("WordEditor.AppsForOffice.IWindowTimers").ha();e.ia("WordEditor.AppsForOffice.WordEditorMethodFactory",()=>new mh(e.resolve("WordEditor.AppsForOffice.WordEditorApiObjectModel"),v.AFrameworkApplication.K,e.resolve("WordEditor.AppsForOffice.IWindowTimers"),
e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),e.resolve("WordEditor.AppsForOffice.ICustomXmlNodeListCache"),e.resolve("WordEditor.AppsForOffice.ICustomXmlHelper"),e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"))).as("Common.App.AppsForOfficeCommon.IApiMethodFactory").ha();e.ia("WordEditor.AppsForOffice.WordEditorEventStore",()=>or.wFl(e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"),e.resolve("WordEditor.AppsForOffice.WordEditorApiObjectModel"))).as("Common.App.AppsForOfficeCommon.IApiEventStore").ha();
e.ia("WordEditor.AppsForOffice.WordEditorApiThrottleStore",()=>new Mm(new OsfRuntime.Throttling.ThrottleFactory,v.AFrameworkApplication.K)).as("Common.App.AppsForOfficeCommon.IApiThrottleStore").ha();e.ia("Common.App.AppsForOfficeCommon.ApiManager",()=>new wg(e.resolve("WordEditor.AppsForOffice.WordEditorMethodFactory"),e.resolve("WordEditor.AppsForOffice.WordEditorEventStore"),e.resolve("WordEditor.AppsForOffice.WordEditorApiThrottleStore"))).as("Common.App.AppsForOfficeCommon.IApiManager").ha();
e.ia("Box4.SetDataVirtualSelectionMerger",()=>new ii).as("Box4.Actors.IVirtualSelectionMerger").ha();e.ia("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor",()=>new vk(e.rf("Common.App.AppsForOfficeCommon.IAppsForOfficeManager"),null,e.rf("Common.App.AppsForOfficeCommon.IContextActivationManager"),Ni.FocusManager.instance(),Md.a.instance,v.AFrameworkApplication.va,v.AFrameworkApplication.K,e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"),e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeModel"),
e.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),null,eh.a.instance,e.resolve("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager"),null)).as("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").ha();e.ia("Wonca.AppsForOffice.SaveSettingsHelper",()=>new kl(new ge.a)).ha();e.ia("Wonca.AppsForOffice.AddinActivator",()=>new Fe(e.rf("Common.App.AppsForOfficeCommon.IContextActivationManager"),e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"),e.resolve("Wonca.AppsForOffice.SaveSettingsHelper"))).as("Wonca.IAddinActivator").ha();
e.ia("WordEditor.AppsForOffice.AppsForOfficeApiActor",()=>new lk(v.AFrameworkApplication.va,nf.a.instance,e.resolve("Box4.IOutlineEditor"),e.resolve("Box4.ICharacterPropertiesEditor"),new ge.a,e.rf("Box4.Actors.IClipboardOperationFactory"),e.resolve("Box4.IClipboardDataHelper"),v.AFrameworkApplication.K,xf.a.instance,e.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();e.ia("WordEditor.AppsForOffice.WordEditorAfoSettingsModel",()=>new Ck(new Tc)).as("Common.App.AppsForOfficeCommon.IAppsForOfficeSettingsModel").ha();
e.ia("Wonca.AppsForOffice.BackCompatImageUploaderWrapper",()=>new po).as("Wonca.IFrameEditors.IBackCompatImageUploaderWrapper").ha();e.ia("Wonca.IFrameEditors.AddinEditor",()=>new rg(e.resolve("WordEditor.IImageEditor"),e.resolve("Wonca.IFrameEditors.IBackCompatImageUploaderWrapper"))).as("Wonca.IFrameEditors.IAddinEditor").ha();e.ia("WordEditor.AppsForOffice.WordEditorAppsForOfficeModel",()=>new Te(Object(gh.a)(),new ge.a,new Jb,e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeSettingsModel"),
e.resolve("Wonca.IFrameEditors.IAddinEditor"),v.AFrameworkApplication.va,nf.a.instance)).as("Common.App.AppsForOfficeCommon.IAppsForOfficeModel").ha();e.ia("Common.App.AppsForOfficeCommon.AppsForOfficeManager",()=>new qd(e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeModel"))).as("Common.App.AppsForOfficeCommon.IAppsForOfficeManager").ha();e.ia("Common.App.AppsForOfficeCommon.HostControlInfo",()=>new Il(e.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeApiAdapter"),
e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"))).ha();e.register(rp,"WordEditor.AppsForOffice.WordEditorActivationSettingsProvider").as("Common.App.AppsForOfficeCommon.IActivationSettingsProvider").ha();e.ia("Common.App.AppsForOfficeCommon.IContextActivationManagerBuilderFactory",()=>new Vg(e.resolve("WordEditor.AppsForOffice.WordEditorActivationSettingsProvider"))).ha();e.ia("Common.App.AppsForOfficeCommon.IContextActivationManagerFactory",()=>new Zf(e.resolve("Common.App.AppsForOfficeCommon.IContextActivationManagerBuilderFactory").create(),
e.resolve("WordEditor.AppsForOffice.WordEditorActivationSettingsProvider"),e.resolve("Common.App.AppsForOfficeCommon.HostControlInfo"))).ha();e.ia("Common.App.AppsForOfficeCommon.IContextActivationManager",()=>{const Ka=e.resolve("Common.App.AppsForOfficeCommon.IContextActivationManagerFactory").create();Ka.setOAuthManager(e.resolve("Common.App.OAuth.IOAuthManager"));return Ka});e.ia("WordEditor.AppsForOffice.WordEditorAppsForOfficeIntegrationManager",()=>new $a(e.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeManager"),
null,e.resolve("Common.App.AppsForOfficeCommon.ApiManager"),e.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeApiAdapter"),e.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"),ha&&E?e.resolve("WordEditor.AppsForOffice.IAppBindingHelper"):null,v.AFrameworkApplication.K,e.resolve("WordEditor.AppsForOffice.AppsForOfficeApiActor"))).ha();this.W.ia("WordEditor.AppsForOffice.ApiOperationChecker",()=>new vd).as("WordEditor.AppsForOffice.IApiOperationChecker").ha();this.W.ia("Box4.AppsForOffice.IInitializeHelper",
()=>new Ed).ha()}}get name(){return"WordEditor.AppsForOffice"}init(){if(Lh.a.Pud){var e=this.W.resolve("WordEditor.AppsForOffice.WordEditorActivationSettingsProvider");e.XWc=!0;v.AFrameworkApplication.K.$("OcpsIsEnabled")?this.W.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{t.isFeatureEnabled("ConnectedServices",!0).then(E=>{e.XWc=E;this.initInternal();return null})}):this.initInternal()}}initInternal(){this.x4b=this.W.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeIntegrationManager");
v.AFrameworkApplication.K.Rn(()=>{this.x4b.initialize();Cc.StaticActiveAppFrame.za().Ie();if(v.AFrameworkApplication.K.$("SdxIsEnabled")){var t={};t.Application=v.AFrameworkApplication.K.kb("Application");t.SdxDmsUrl=v.AFrameworkApplication.K.kb("SdxDmsUrl");t.SovereignFederationDMSToken=v.AFrameworkApplication.K.kb("SovereignFederationDMSToken");t.SovereignFederationDMSTokenSuffix=v.AFrameworkApplication.K.kb("SovereignFederationDMSTokenSuffix");t.SdxCdnUrl=v.AFrameworkApplication.K.kb("SdxCdnUrl");
t.Sdx1CdnUrl=v.AFrameworkApplication.K.kb("Sdx1CdnUrl");t.ForceUseSdx1Cdn=v.AFrameworkApplication.K.$("ForceUseSdx1Cdn");t.UICulture=v.AFrameworkApplication.K.kb("UICulture");t.LoggableUserId=v.AFrameworkApplication.K.kb("LoggableUserId");t.SessionStartInfoJson=v.AFrameworkApplication.K.kb("SessionStartInfoJson");t.StaticContentUrl=v.AFrameworkApplication.K.kb("StaticContentUrl");t.DmsSdxList=v.AFrameworkApplication.ohi;var E={};E.generalParameters=t;E.flightingTreatmentVariables=v.AFrameworkApplication.K.E8a;
OfficeExt.SDXCatalog.InitializeSdx(E);let ha=!1;t=0;if(v.AFrameworkApplication.K.$("AppsForOfficeSharedRuntimeIsEnabled")){E=this.x4b.vdc.Euj();for(var W of E)OfficeExt.SDXCatalog.MarkSdxPreloadStart(W),vk.ric===Qd.a.xh(W)&&(ha=!0,t=vk.jKj)}OfficeExt.SDXCatalog.PrefetchSdxAssets(v.AFrameworkApplication.K.appSettings,v.AFrameworkApplication.K.E8a,v.AFrameworkApplication.K.kb("Application"),"*");nj.a.aTb&&OfficeExt.SDXCatalog.PrefetchSdxAssets(v.AFrameworkApplication.K.appSettings,v.AFrameworkApplication.K.E8a,
v.AFrameworkApplication.K.kb("Application"),"fa000000029");W=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.OEP.FA000000059.AutoActivationDelayInMilliseconds",1E4);W+=t;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000059.AutoActivationIsEnabled",!1)&&(OfficeExt.SDXCatalog.PrefetchSdxAssets(v.AFrameworkApplication.K.appSettings,v.AFrameworkApplication.K.E8a,v.AFrameworkApplication.K.kb("Application"),vk.ric),window.setTimeout(()=>{const Ka=new ij.a(vk.ric,
OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0"),sb=new mj.a("WordOnline","Web","en-Us"),dc=new Jl.a;dc.optionalProperties[Xi.a.xS]="Experimentation SDX";dc.optionalProperties[Xi.a.taskPaneWidth]=0;if(ha){const xc={};xc.hostAddinActivationTimeStamp=Date.now();dc.optionalProperties[Xi.a.jMh]=xc;dc.optionalProperties[Xi.a.sourceLocationOverrideResourceId]=vk.BCf;Sh.a.instance.v3f(Ka,Vk.a.J_j,"",sb,dc)}Sh.a.instance.v3f(Ka,Vk.a.action,"AddinActivationAction",sb,dc)},W))}});const e=this.W.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeManager");
this.W.resolve("Box4.AppsForOffice.IInitializeHelper").jXf(()=>{e.initialize()});this.W.resolve("WordEditor.ContentControl.IContentControlManager").tcl(this.W.resolve("WordEditor.AppsForOffice.IApiOperationChecker"))}}Object(y.a)(Fk,"AppsForOfficePackage",hj,[]);class Cj{constructor(){this.correlationId=this.sessionId=this.N5e=null;this.actionId=0;this.rd=null}get Yg(){return this.N5e?this.N5e:""}set Yg(e){this.N5e=e}}Object(y.a)(Cj,"AssistanceSearchVariableUrlParameterSet",null,[]);var Na=d(191);
class Wa{constructor(){this.ui=!1;this.V1=!0;this.MDh=this.CDc=null}get isInitialized(){return this.ui}initialize(e,t){const E=!!e&&!!t;E&&(this.CDc=e,this.MDh=t);this.ui=E;v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)||ob.a.instance.Qa("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(W=>{W.AL("Enabled").then(ha=>{this.V1=ha;return null},()=>null)})}Wb(e){e||
(e=v.AFrameworkApplication.va);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.V1=v.AFrameworkApplication.sH,ob.a.instance.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{t.isFeatureEnabled("mso_sendASmile",!0).then(E=>{this.V1=v.AFrameworkApplication.sH&&E;(E=v.AFrameworkApplication.ua)&&E.Ie();return null},()=>null)}));e.ra(M.a.n_b,I.a.frame,Object(ib.a)(this,
this.T7o,"showSearchResults"))}T7o(e,t,E,W,ha){if(1===E)return v.AFrameworkApplication.K.$("IsFeedbackExperiencesAvailable")||(this.V1=!1),ha&&"SourceControlId"in ha&&(ha=ha.SourceControlId,("GiveFeedback"===ha||"btnFeedback"===ha||"btnFeedbackPane"===ha||"PptEditingStatusBar.GiveFeedbackPane"===ha||"GiveFeedbackPane"===ha)&&!this.V1)?8:aq.SessionStatusManager.instance.Gk?8:32;z.ULS.sendTraceTag(4761738,1302,50,"");Na.a.mark(4771);if(this.isInitialized){e=ha.CommandValueId;t=ha.SourceControlId;ha=
Object.assign(new Cj,{actionId:M.a.n_b,rd:ha});if(void 0!==e&&null!==e)ha=Wa.YPm(e);else if(void 0!==t&&null!==t)switch(t){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":ha.actionId=M.a.vla;break;case "btnContactSupport":case "ContactSupport":ha.actionId=M.a.M6h;break;case "btnShowTraining":case "Training":ha.actionId=M.a.q2j;break;case "btnWhatsNew":case "WhatsNew":ha.actionId=M.a.XOg}this.CDc.M5o(this.MDh,ha);Na.a.mark(4772);
return 32}Na.a.mark(4772);return 8}dispose(){this.CDc&&(this.CDc.dispose(),this.CDc=null)}static get instance(){Wa._instance||(Wa._instance=new Wa);return Wa._instance}static YPm(e){const t=new Cj,E=e.indexOf("|");t.sessionId=e.substring(0,E);const W=e.indexOf("|",E+1);t.correlationId=e.substring(E+1,W);t.Yg=e.substr(W+1);return t}}Wa._instance=null;Object(y.a)(Wa,"AssistanceActor",null,[13]);class Fb{constructor(){this.G9g=this.Ga=this.A4b=null;this.T3e=!1}M5o(e,t){if(t.actionId!==M.a.vla||v.AFrameworkApplication.sH)if(this.T3e&&
!v.AFrameworkApplication.rL)this.A4b||(this.A4b=this.G9g()),this.A4b.tS(e,t);else if(t.actionId===M.a.vla)this.v5o();else{e=e.getUrl(t);t=null;try{Qd.a.IX(e)&&(t=tb.a.yn(e,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no","AssistanceDisplayManager:HelpWindow"))}catch(E){throw z.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+
E.message),E;}t?z.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",e):z.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",e,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else z.ULS.sendTraceTag(554295451,356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.A4b&&
(this.A4b.dispose(),this.A4b=null)}hRj(e,t,E){E&&ab.c(e)?this.T3e=!1:(this.G9g=e,this.T3e=E);this.Ga=t}v5o(){v.AFrameworkApplication.va.Ob(M.a.vla,2)}static createInstance(e,t,E=null){const W=new Fb;null==E?W.hRj(e,t,v.AFrameworkApplication.dVh||t.$("HelpTabIsEnabled")):W.hRj(e,t,E);return W}}Object(y.a)(Fb,"AssistanceDisplayManager",null,[975,13]);class uc{constructor(e,t,E,W,ha){this.q$=e;this.DHd=t;this.PGd=E;this.Unk=W;this.Dth=ha}get lcid(){return this.q$}get namespace(){return this.DHd}get zbb(){return this.PGd}get C9k(){return this.Unk}get locale(){return this.Dth}static nPm(e){const t=
e.indexOf(".");return 0<=t&&t<e.length&&(e=parseInt(e.substring(0,t)),!isNaN(e))?e:uc.O$k}static createInstance(e){return new uc(v.AFrameworkApplication.lcid,e,uc.nPm(v.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",mb.a.Cg(v.AFrameworkApplication.lcid).name)}}uc.O$k=16;Object(y.a)(uc,"AssistanceSearchUrlParameterSet",null,[]);class Sc{constructor(e,t){e=new ag.QueryStringBuilder(e);e.ze("clid",t.lcid.toString());e.ze("p1",t.namespace);e.ze("ver",t.zbb.toString());
e.ze("apps",t.C9k);e.ze("lc",t.locale);this._url=e.toString()}getUrl(e){const t=new ag.QueryStringBuilder(this._url);t.ze("src","TellMe");t.ze("query",e.Yg);t.ze("sessionid",e.sessionId);t.ze("correlationid",e.correlationId);return t.toString()}static createInstance(e){return new Sc(v.AFrameworkApplication.eVh,e)}}Object(y.a)(Sc,"AssistanceSearchUrlProvider",null,[973]);class hd{wc(){}init(){v.AFrameworkApplication.wKb&&!v.AFrameworkApplication.SBe&&Wa.instance.Wb(v.AFrameworkApplication.va)}dispose(){Wa.instance.dispose()}XRi(e){Wa.instance.initialize(Fb.createInstance(e,
v.AFrameworkApplication.K),Sc.createInstance(uc.createInstance("WDWAEndUser")))}}Object(y.a)(hd,"AssistancePackage",null,[0,1]);class Gd{}Gd.xtc=1;Gd.MD="AssistanceTaskPane";Gd.width=330;Gd.PHg="AssistanceTaskPaneData";Gd.YTf="AssistanceContentFrame";Object(y.a)(Gd,"AssistanceConstants",null,[]);var ke=d(42),Ye=d(24);class Nf{constructor(e){this.K2e=this.L2e=this.HC=this.Nj=null;this.HUn=t=>{t===this.Nj&&this.fta()};this.Fsc=t=>{z.ULS.sendTraceTag(4474517,1302,50,"The resource at {0} is loaded successfully in assistance task pane",
t.target.src);Na.a.mark(4776)};this.Hvb=t=>{z.ULS.sendTraceTag(4474518,1302,15,"Loading the resource at {0} failed in assistance task pane",t.target.src);Na.a.mark(4776)};Na.a.mark(4773);this.tOd=e;this.H2();this.eB();Na.a.mark(4774)}H2(){this.Nj=this.tOd.bYc();this.yVf(this.Nj.Y_a.FWh);this.Nj.Arg(this.HUn);this.Nj.wn()}eB(){ke.a.addHandler(this.HC,"load",this.L2e=this.Fsc);ke.a.addHandler(this.HC,"error",this.K2e=this.Hvb)}fda(){ke.a.removeHandler(this.HC,"load",this.L2e);this.L2e=null;ke.a.removeHandler(this.HC,
"error",this.K2e);this.K2e=null}dispose(){this.fda();this.HC.parentNode.removeChild(this.HC);this.HC=null;this.Nj&&(this.tOd.ghc(Gd.MD,this.Nj),this.Nj=null)}hwf(){this.HC.src=Nf.vwh;this.Nj.xn()}tS(e,t){e=e.getUrl(t);Na.a.mark(4775);this.HC.src=e;this.Nj.t0?this.Nj.wn():this.tOd.showTaskPane(this.Nj)}fta(){this.tOd.hideTaskPane(this.Nj);this.hwf()}yVf(e){const t=Ye.a.createElement("iframe");t.src=Nf.vwh;t.style.height="100%";this.HC=t;e.appendChild(this.HC);t.id=Gd.YTf}}Nf.vwh="about:blank";Object(y.a)(Nf,
"AssistancePane",null,[974,13]);var Bi=d(942),Sk=d(255),Ff=d(155);class Th{bYc(){const e=new Sk.a(Ff.a.v6a,Box4Intl.Box4Strings);return eh.a.instance.ybi(Gd.MD,Gd.xtc,Gd.width,Gd.PHg,e)}showTaskPane(e){e.t0||(Cc.StaticActiveAppFrame.za().afb.kVj(e.id),e.show(),Lh.a.en.$5a(Object(ib.a)(e,e.wn,"pollForStateAndUpdate")),Lh.a.en.Ie())}hideTaskPane(e){eh.a.instance.hideTaskPane(e)}ghc(e,t){eh.a.instance.ghc(e,t)}}Object(y.a)(Th,"WordEditorTaskPaneHandler",null,[1203]);class Tk extends hd{constructor(){super();
this.CCb=this.eJh=null}get name(){return"WordEditor.Assistance"}wc(e){this.W=e}init(){super.init();v.AFrameworkApplication.wKb&&(v.AFrameworkApplication.K.$("HelpTabIsEnabled")&&v.AFrameworkApplication.sH&&!v.AFrameworkApplication.rL?(this.eJh=this.W.Oa("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.XRi(()=>new Xq(this.eJh,this.CCb,Bi.a.Q2c()))):this.XRi(()=>new Nf(new Th)))}}Object(y.a)(Tk,"WordEditorAssistancePackage",hd,[]);var Nk=d(1195);class Of{create(){return new Nk.a}}Object(y.a)(Of,
"CustomXmlPartNodeFactory",null,[296]);class bf{constructor(e){this.$1e=0;this.m6a=new gf.a;this.KJb=e}dMf(){if(this.$1e===Number.MAX_VALUE)throw z.ULS.sendTraceTag(19276675,366,10,"The namespace count reach the maximum allowed number"),Error.create("The namespaces count is larger than the maximum allowed number");const e="ns"+this.$1e.toString();this.$1e++;return e}S_i(e){return void 0===e||null===e?!1:""!==this.T3c(e)?!0:!1}isDefaultNamespace(e){return void 0===e||null===e?!1:"http://www.w3.org/XML/1998/namespace"===
e}Bsi(){if(void 0!==this.KJb&&null!==this.KJb){var e=RegExp('xmlns=["\']([^"]*)["\']|xmlns:([^=]*)="([^"]*)"',"g"),t,E="";for(this.S_i("http://www.w3.org/XML/1998/namespace")||this.m6a.add("xml","http://www.w3.org/XML/1998/namespace");t=e.exec(this.KJb);)void 0!==t[1]&&null!==t[1]?E=t[1]:void 0!==t[3]&&null!==t[3]&&(E=t[3]),""===E||this.S_i(E)||this.m6a.add(this.dMf(),E)}}addNamespaceMapping(e,t){if(void 0===t||null===t||""===t||void 0===e||null===e||""===e)return z.ULS.sendTraceTag(19276676,366,
10,"The namespace or prefix is empty"),!1;if(this.m6a.mb(e))return z.ULS.sendTraceTag(19714131,366,10,"The prefix is already exists"),!1;this.m6a.add(e,t);return!0}YLf(e){if(void 0===e||null===e||""===e)return"";let t;({value:t}=this.m6a.Dc(e,t));return void 0===t||null===t?"":t}T3c(e){if(void 0===e||null===e||""===e)return"";let t="";for(const E of this.m6a)if(E.value===e){t=E.key;break}return t}vKm(){this.Bsi();let e=" ";for(const t of this.m6a)e=e+"xmlns:"+t.key+'="'+t.value+'" ';return e.trim()}}
Object(y.a)(bf,"XmlNamespaceManager",null,[]);class Cf{constructor(e,t){this.KJb=this.P3a=this.Pc=this.b6b=this._id=this.fya=null;this.P$g=!1;this.DHd=null;this.init(e,t)}get j1a(){return this.KJb}get builtIn(){return this.P$g}get namespace(){return this.DHd}get id(){return this._id}get eR(){return this.b6b}selectNodes(e,t){return this.fya.value.selectNodesByXPath(e,t)}getNodeXml(e){return this.fya.value.getNodeXml(e)}setNodeXml(e,t){if(void 0!==t&&null!==t&&t.length>Cf.C8f)return null;e=this.fya.value.setNodeXml(e,
t);void 0!==e&&null!==e&&(this.save(),this.i8j(t));return e}getNodeText(e){return this.fya.value.getNodeText(e)}setNodeText(e,t){return void 0!==t&&null!==t&&t.length>Cf.C8f?!1:this.fya.value.setNodeText(e,t)?(this.save(),!0):!1}getNodeBaseName(e){return this.fya.value.getNodeBaseName(e)}getNodeNamespaceURI(e){return this.fya.value.getNodeNamespaceURI(e)||""}getNodeType(e){return this.fya.value.getNodeType(e)}T3c(e){return this.P3a.T3c(e)}YLf(e){return this.P3a.YLf(e)}XNh(e,t){const E=this.P3a.addNamespaceMapping(e,
t);E&&this.fya.value.addNamespaceMapping(e,t);return E}appendChild(e,t){if(void 0!==t&&null!==t&&t.length>Cf.C8f)return null;e=this.fya.value.appendChild(e,t);void 0!==e&&null!==e&&(this.save(),this.i8j(t));return e}YZf(){return this.j1a===this.b6b.getValue(fd.a.C7a)}$Mg(){this.init(this.b6b,this.Pc)}save(){const e=this.Pc.Mc(4);e.Ab(this.b6b);const t=this.fya.value.getDocumentElement();this.KJb=this.getNodeXml(t);this.b6b.setValue(fd.a.C7a,this.j1a);e.dispose()}init(e,t){this._id=e.getValue(fd.a.bNb);
this.KJb=e.getValue(fd.a.C7a);this.P$g=e.getValue(fd.a.ygc);this.DHd=e.getValue(fd.a.LZd);this.P3a=new bf(this.j1a);const E=this.P3a.vKm();this.fya=new Ue.a(()=>new OSF.XmlProcessor(this.j1a,E));this.b6b=e;this.Pc=t}i8j(e){e=new bf(e);e.Bsi();e=e.m6a;for(const t of e.keys)if(!this.P3a.isDefaultNamespace(e.J(t)))try{let E=this.P3a.dMf();for(;this.P3a.m6a.mb(E);)E=this.P3a.dMf();this.XNh(E,e.J(t))}catch(E){z.ULS.sendTraceTag(20306075,366,10,"Cannot update namespace mapping as the namespace count has reached the maximum allowed number")}}}
Cf.C8f=1048576;Object(y.a)(Cf,"CustomXmlDocument",null,[1204]);class Pg{constructor(e,t,E){this.QFc=null;this.vLh=new Ei.a;this.Oy=e;this.PFc=t;this.Pc=E}get uka(){if(void 0===this.QFc||null===this.QFc||23!==this.QFc.role)this.QFc=this.Jom();return this.QFc}Jom(){const e=new Ld.GraphIterator;e.set(this.Oy.value);Object(gh.a)().dS(e);e.Ub(23);return void 0!==e&&null!==e&&52===e.lf?e:null}o6d(e,t=!1){const E=[],W=this.uka;if(W){let ha=W.Ub(24);for(;ha;){const Ka=ha.getValue(fd.a.LZd),sb=ha.getValue(fd.a.ygc);
Ka===e&&sb===t&&E.push(ha);ha=W.Lf(24)}}return E}dJf(e){let t=null;const E=this.uka;if(E)for(var W=E.Ub(24);W;){W=W.getValue(fd.a.bNb);if(oi.a.th().equals(W,e)){t=E;break}W=E.Lf(24)}return t}bxi(e){const t=e.getValue(fd.a.bNb),E=e.getValue(fd.a.C7a),W=this.vLh.J(t);void 0!==W&&null!==W&&W.j1a===E?e=W:(e=new Cf(e,this.Pc),this.vLh.add(e.id,e),void 0!==W&&null!==W&&W.j1a!==E&&z.ULS.sendTraceTag(9187598,366,50,"Custom xml id: {0} is out of date",t));return e}W1c(){const e=[],t=this.uka;if(t)for(var E=
t.Ub(24);E;)E=this.bxi(E),e.push(E),E=t.Lf(24);return e}VVa(e){let t=null;if(e=this.dJf(e))t=e.currentNode;return t?this.bxi(t):null}Lef(e){let t=null;if(e.length>Pg.NJn)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,qed:t};var E=new OSF.XmlProcessor(e,"");if(E.isValidXml()){const W=this.Pc.Mc(4);W.qu(this.uka);E=E.getNodeNamespaceURI(E.getDocumentElement());const ha=this.uka;t=this.PFc.create(kk.a.eR);const Ka=new Hb.a(Rd.a.create(),1);t.setValue(fd.a.bNb,"{"+ee.e(Ka.hu.toString())+
"}");t.setValue(fd.a.C7a,e);t.setValue(fd.a.LZd,E||"");t.setValue(fd.a.ygc,!1);ha.w6(t,24,Ka);W.dispose();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,qed:t}}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,qed:t}}Gei(e){if(e=this.dJf(e)){if(e.currentNode.getValue(fd.a.ygc))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;const t=this.Pc.Mc(4);t.qu(this.uka);e.eh();t.dispose();return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}eSo(e,
t){if(e=this.dJf(e)){const E=e.currentNode;E.getValue(fd.a.ygc)||(e=this.Pc.Mc(4),e.qu(this.uka),E.setValue(fd.a.C7a,t),e.dispose())}}qYf(e){return e.builtIn&&"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties"===e.namespace}}Pg.NJn=1048576;Object(y.a)(Pg,"WordEditorCustomXmlManager",null,[1171]);class Ug{get name(){return"WordEditor.CustomXml"}init(){}dispose(){}wc(e){e.ia("WordEditor.CustomXmlPartNodeFactory",()=>new Of).ha();e.ia("WordEditor.CustomXml.WordEditorCustomXmlManager",
()=>new Pg(new Ue.a(()=>Cc.StaticActiveAppFrame.za().ib.$c),ob.a.instance.resolve("WordEditor.CustomXmlPartNodeFactory"),new ge.a)).as("WordEditor.CustomXml.IWordEditorCustomXmlManager").ha()}static main(){x.a.instance.Jc(new Ug)}}Object(y.a)(Ug,"CustomXmlPackage",null,[0,1]);var Gk;(function(e){e[e.kQg=0]="Boot";e[e.iQg=1]="BeforeOpen";e[e.ORg=2]="OnPaneOpen";e[e.NRg=3]="OnPaneClose"})(Gk||(Gk={}));Object(y.b)("ReadyTime",Gk);class $i{constructor(e,t,E,W,ha){this.container=e;this.Nv=t;this.actors=
E;this.bM=W;this.Agg=(Ka,sb)=>{sb.data?this.bM.Yd(()=>{this.Pd(this.Nv.get(Gk.NRg));this.initialize(this.Nv.get(Gk.ORg))},"WD:IOO"):this.bM.Yd(()=>{this.Pd(this.Nv.get(Gk.iQg));this.Pd(this.Nv.get(Gk.ORg));this.initialize(this.Nv.get(Gk.NRg))},"WD:DOC")};this.VUn=()=>{this.bM.Yd(()=>this.initialize(this.Nv.get(Gk.iQg)),"WD:IBO")};ha.Rcc(this.Agg);ha.PPh(this.VUn)}qlf(){this.neg()}neg(){this.bM.Yd(()=>{this.initialize(this.Nv.get(Gk.kQg));this.actors.forEach(e=>e.Wb())},"WD:BOOT")}initialize(e){e.forEach(t=>
this.container.resolve(t).initialize())}Pd(e){e.forEach(t=>this.container.resolve(t).Pd())}}Object(y.a)($i,"DesignerPackageInitializer",null,[]);class ol{VEl(e,t,E,W,ha){return new $i(e,t,E,W,ha)}}Object(y.a)(ol,"DesignerInitializerFactory",null,[]);var wm=d(196),Ll=d(249),Ir=d(185),$t=d(1120),wu=d(94);class Bv extends Z.a{constructor(e,t,E){super();this.DesiredRevisionId=this.FileId=this.TemplateUrl=null;this.TemplateUrl=e;this.FileId=t;this.DesiredRevisionId=E}lm(){return T.a.cTd}static construct(e,
t,E){return new Bv(e,t,E)}}Object(y.a)(Bv,"ApplyTemplateRequest",Z.a,[]);class xu{constructor(e){this.RT=e}cTd(e,t){return new Promise((E,W)=>{const ha=Bv.construct(e,v.AFrameworkApplication.rootQuerySignature,t),Ka=String.format("{0}/we/OneNote.ashx?perfTag=ApplyTemplate&{1}",S.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature);this.RT.Ij(Ka,2,P.b(ha),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,sb=>{var dc,xc;if(null===(dc=null===sb||void 0===sb?void 0:sb.data)||void 0===
dc||!dc.De)return W("No response data!");if(sb.data.He!==Y.a.zz)return W(`Bad Http Status ${sb.data.He}`);if(!({group:sb}=Q.a.R4(sb.data.De)).returnValue)return W("Empty ServerResponse!");dc=null;if(null===(xc=null===sb||void 0===sb?void 0:sb.Responses)||void 0===xc||!xc.length||!(dc=sb.Responses[0])||dc.classId!=T.a.cTd)return W("No valid response!");z.ULS.sendTraceTag(509642067,3016,50,"ApplyTemplate call successful.");E(dc)},sb=>{var dc,xc;z.ULS.sendTraceTag(509642066,3042,10,"ApplyTemplates request failed [Status: {0}]",
null===(dc=null===sb||void 0===sb?void 0:sb.data)||void 0===dc?void 0:dc.status);W(null===(xc=null===sb||void 0===sb?void 0:sb.data)||void 0===xc?void 0:xc.status)},ha)})}}Object(y.a)(xu,"ApplyTemplatesProxyImplementation",null,[]);var Op=d(491),rr=d(1798),Jr=d(1843),sp=d(1150),Ws=d(1191),yw=d(1127),Kr=d(1014);class Et extends Kr.a{constructor(e,t,E=0,W=!0){super("DocumentEditedConditionId");this.Qob=e;this.tg=t;this.wwf=E;this.ltp=W;this.bdg=this.aDe=0;this.ifd=()=>{setTimeout(()=>{var ha,Ka;++this.bdg;
0==this.aDe&&(this.aDe=(new Date).getTime());if(this.tg.X_){const sb=null===(ha=this.tg.HO)||void 0===ha?void 0:ha.uMl;ha=null===(Ka=null===sb||void 0===sb?void 0:sb.YNb)||void 0===Ka?void 0:Ka.EUb();null!==ha&&void 0!==ha&&ha.some(dc=>dc instanceof Ws.a||dc instanceof yw.a||dc instanceof sp.a)||(0==this.wwf?this.Uhj():(clearTimeout(this.Uha),this.Uha=setTimeout(()=>{this.yYj();this.Uhj();z.ULS.sendTraceTag(521446627,3016,50,"User stopped editing {0} seconds ago. Document has been edited {1} times. The last action was: {2}.                 {3} milliseconds have passed since the change began",
this.wwf/1E3,this.bdg,sb.actionId,(new Date).getTime()-this.aDe);this.aDe=this.bdg=0},this.wwf)))}},1E3)};this.Uha=void 0}initialize(){super.initialize();this.Qob.emb(this.ifd)}Pd(){this.Qob.ald(this.ifd);this.yYj();super.Pd()}yYj(){this.Uha&&(clearTimeout(this.Uha),this.Uha=void 0)}Uhj(){this.Jg(!0);this.ltp&&this.Qob.ald(this.ifd)}}Object(y.a)(Et,"DocumentEditedCondition",Kr.a,[]);class rx extends Kr.a{constructor(e,t,E){super("LocalStorageConditionId");this.Z9i=e;this.Mnp=t;this.defaultValue=E}initialize(){var e;
super.initialize();v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.Designer.LocalStorageConditionOverride",void 0)===this.Z9i?this.Jg(!0):this.Jg((null!==(e=localStorage.getItem(this.Z9i))&&void 0!==e?e:this.defaultValue)===this.Mnp)}}Object(y.a)(rx,"LocalStorageCondition",Kr.a,[]);var nt=d(759),zw=d(1158),yi=d(35),Vm=d(586),Xk=d(62);class Ds{constructor(e,t,E){this.hn=e;this.gXb=t;this.x0d=E;this.Hkj=(W,ha)=>{this.documentType=ha.documentType;Ds.s_i||this.mbb();this.x0d.IAo(this.Hkj)};
this.x0d.M0k(this.Hkj)}mbb(){if(void 0===this.documentType||null===this.documentType)this.documentType=-1;this.userType=this.pQm();this.Pyf();const e=new Vm.a;e.name=Ds.xXl;e.dataFields=this.IEl();e.dnmInterval=1;e.dnmAllowedPartA=[1,3,4,2,5];cc.a.sendDirectNumericEvent(e);Ds.s_i=!0}IEl(){const e=[];[this.pL("isBlank",this.YVi),this.pL("DocumentType",this.documentType),this.pL("UserType",this.userType),this.pL("TableCount",this.Zca),this.pL("CharacterCount",this.characterCount),this.pL("ParagraphCount",
this.dV),this.pL("ImageCount",this.LL),this.pL("ListElementsCount",this.m7i),this.pL("BlobsCount",this.YTc),this.pL("PageCount",this.Xw)].forEach(t=>{e.push(t)});return e}pL(e,t){const E=new yi.a;E.name=e;"number"===typeof t?E.int64=t:"boolean"===typeof t&&(E.bool=t);return E}Pyf(){this.dV=this.YTc=this.m7i=this.Zca=this.LL=this.characterCount=0;this.Xw=this.gXb.getTotalPageCount();var e=Lh.a.en.ib.sc.jd;this.YVi=Xf.ParagraphReader.Fea(e);if(!this.YVi){e=this.hn.Ksa(e,7,7).currentNode;var t=Ld.GraphIterator.eb(e);
for(e=Hc.a.Ft(t,e);e.moveNext();)if(t=e.currentNode)if(Gg.ImageReader.Lt(t))this.LL++;else if(vf.TableReader.HU(t))this.Zca++;else if(Xk.ListItemReader.Hg(t))this.m7i++;else if(Xf.ParagraphReader.Xb(t)){var E=Lg.e(t);for(let W=0;W<E.length;W++)5===E[W].Jh?this.LL++:this.YTc++;E=sn.AParagraphNode.iV(t.characterData);E=E.trim();this.characterCount+=E.length;0<E.length&&!Xf.ParagraphReader.E3(t)&&!Xf.ParagraphReader.GX(t)&&this.dV++}}}pQm(){return!0===v.AFrameworkApplication.K.$("IsO365ConsumerHost")?
1:!0===v.AFrameworkApplication.K.$("IsO365CommercialHost")?2:!0===v.AFrameworkApplication.K.$("IsEduUser")?3:0}}Ds.xXl="Office.DNM.Word.Online.Designer.DocumentStatsEvent";Ds.s_i=!1;Object(y.a)(Ds,"DocumentStatsDnmLogger",null,[]);class Cv{constructor(e){this.fsf=e;this.brh=!1;this.sUn=()=>{this.brh=!0};this.fsf.execute(t=>{var E;null===(E=t.add_onAiMakerTriggeredHandler)||void 0===E?void 0:E.call(t,this.sUn)})}get I1f(){return this.brh}}Object(y.a)(Cv,"AiMakerEngagement",null,[]);var Jq=d(670),Es=
d(1637),yu=d(436),Hn;(function(e){e[e.initial=0]="initial";e[e.left=1]="left";e[e.center=2]="center";e[e.right=3]="right";e[e.justify=4]="justify"})(Hn||(Hn={}));var Xs;(function(e){e[e.initial=0]="initial";e[e.firstLine=1]="firstLine";e[e.hanging=2]="hanging"})(Xs||(Xs={}));var Pn;(function(e){e[e.none=0]="none";e[e.unknownError=1]="unknownError";e[e.nonTargetDocument=2]="nonTargetDocument";e[e.trackChangesNotSupported=3]="trackChangesNotSupported";e[e.lowConfidenceDocument=4]="lowConfidenceDocument";
e[e.documentTooLarge=5]="documentTooLarge";e[e.multipleAuthorsNotSupported=6]="multipleAuthorsNotSupported"})(Pn||(Pn={}));var Oo;(function(e){e[e.table=0]="table";e[e.themeImage=1]="themeImage";e[e.complexDecorator=2]="complexDecorator";e[e.text2Image=3]="text2Image"})(Oo||(Oo={}));var am;(function(e){e[e.main=0]="main";e[e.coverPage=1]="coverPage";e[e.text2Image=2]="text2Image";e[e.letter=3]="letter";e[e.generalDocument=4]="generalDocument";e[e.toDoList=5]="toDoList";e[e.resume=6]="resume";e[e.coverLetter=
7]="coverLetter";e[e.notes=8]="notes";e[e.journal=9]="journal";e[e.letterhead=10]="letterhead";e[e.report=11]="report";e[e.article=12]="article";e[e.invoice=13]="invoice";e[e.favorites=14]="favorites";e[e.other=15]="other";e[e.none=16]="none"})(am||(am={}));var sq;(function(e){e[e.letters=0]="letters";e[e.writing=1]="writing";e[e.lists=2]="lists";e[e.resumes=3]="resumes";e[e.business=4]="business";e[e.education=5]="education";e[e.newsletters=6]="newsletters"})(sq||(sq={}));(function(){function e(t,
E){void 0===t&&(t=am.none);void 0===E&&(E="");this.labelId=t;this.Iha=E}e.prototype.getLabel=function(){var t;return null!==(t=this.labelId)&&void 0!==t?t:void 0};e.prototype.getStringId=function(){return this.Iha};e.prototype.equals=function(t){return this.Iha||t.Iha?this.Iha===t.Iha:this.labelId===t.labelId};e.equals=function(t,E){return t||E?t&&E?t.equals(E):!1:t===E};e.prototype.toString=function(){return null!==this.Iha?this.Iha:null!==this.labelId?this.labelId.toString():""};return e})();var au;
(function(e){e[e.main=0]="main";e[e.templates=1]="templates";e[e.templateStyles=2]="templateStyles"})(au||(au={}));var Pp;(function(e){e[e.theme=0]="theme";e[e.templateTheme=1]="templateTheme";e[e.officeTemplate=2]="officeTemplate"})(Pp||(Pp={}));var sr;(function(e){e[e.BetweenLeftAndRightMargin=0]="BetweenLeftAndRightMargin";e[e.BetweenLeftAndRightEdge=1]="BetweenLeftAndRightEdge"})(sr||(sr={}));var Nm;(function(e){e[e.stretchInsideMargins=0]="stretchInsideMargins";e[e.stretchEdgeToEdge=1]="stretchEdgeToEdge";
e[e.original=2]="original"})(Nm||(Nm={}));var Lr;(function(e){e[e.stretchInsideMargins=0]="stretchInsideMargins";e[e.original=1]="original"})(Lr||(Lr={}));var Dv;(function(e){e[e.plain=0]="plain";e[e.predefined=1]="predefined";e[e.generatedByAI=2]="generatedByAI"})(Dv||(Dv={}));var lp=d(680),Aw=d(1610),Df=d(151);class bm{}Object(y.a)(bm,"DesignerInfo",null,[]);class Ev{constructor(e,t,E,W,ha,Ka){this.sNb=e;this.assetId=t;this.isPremium=E;this.isL2Template=W;this.collectionId=ha;this.collectionName=
Ka}}Object(y.a)(Ev,"DesignInfo",null,[]);class Gf{}Gf.Qsh="";Gf.V6f=e=>{var t;e.ptb()&&bm.WC&&ma.a(Df.a.tlk,!0,void 0,[{name:"CollectionID",string:bm.WC.collectionId},{name:"TemplateID",string:bm.WC.assetId},{name:"TemplateType",string:null===(t=bm.WC.sNb)||void 0===t?void 0:t.toString()},{name:"IsPremium",bool:bm.WC.isPremium},{name:"IsProactivePane",bool:bm.B$c},{name:"IsL2Template",bool:bm.WC.isL2Template}])};Gf.Baj=(e,t)=>{var E;t.ptb()&&(bm.WC?ma.a(Df.a.ulk,!0,null,[{name:"CollectionID",string:bm.WC.collectionId},
{name:"TemplateID",string:bm.WC.assetId},{name:"TemplateType",string:null===(E=bm.WC.sNb)||void 0===E?void 0:E.toString()},{name:"IsPremium",bool:bm.WC.isPremium},{name:"IsProactivePane",bool:bm.B$c},{name:"IsL2Template",bool:bm.WC.isL2Template},{name:"IsTemplateApplied",bool:e}]):z.ULS.shipAssertTag(509125727,3016,!1,"Could not log tried event because template is not set in DesignerInfo.currentlyAppliedDesign!"))};Gf.EFn=e=>{var t,E;e.ptb()&&(bm.WC?Gf.Qsh!==bm.WC.assetId&&(Gf.Qsh=bm.WC.assetId,ma.a(Df.a.slk,
!0,void 0,[{name:"CollectionID",string:bm.WC.collectionId},{name:"TemplateID",string:bm.WC.assetId},{name:"TemplateType",string:null===(t=bm.WC.sNb)||void 0===t?void 0:t.toString()},{name:"IsPremium",bool:bm.WC.isPremium},{name:"IsProactivePane",bool:bm.B$c},{name:"IsL2Template",bool:null===(E=bm.WC)||void 0===E?void 0:E.isL2Template}])):z.ULS.shipAssertTag(509096994,3016,!1,"Could not log edited event because template is not set in DesignerInfo.currentlyAppliedDesign!"))};Object(y.a)(Gf,"TemplateLogger",
null,[]);class Cn{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj,zl,Wl,Rh,Mg){this.Sb=e;this.Om=t;this.CWc=E;this.fid=W;this.lhc=ha;this.Qaa=Ka;this.fIo=sb;this.Cdb=dc;this.FD=xc;this.VP=Rc;this.Pp=md;this.Qi=ud;this.vV=Ud;this.pjp=Id;this.v0j=Ee;this.$d=kf;this.Lw=Ke;this.O_m=dh;this.zWh=$h;this.tL=rj;this.Z8k=zl;this.Ezc=Wl;this.$c=Rh;this.tg=Mg;this.applyTheme=(Xl,ql,Al,Hk,Dj)=>{if(!Dj)return z.ULS.shipAssertTag(578856856,3016,!1),2;this.CWc.Gie();this.fid.qkd();this.Om.Aq||
z.ULS.sendTraceTag(573608067,3016,50,"Applying theme while not alone {{ AmITheOnlyCoauthor: {0}, IsWebToWeb: {1} }}",this.Om.Gja,this.Om.nB.gMa);const ao=Dj.theme.id;this.Wnb(163,()=>{this.$d.Isn()&&yu.a.JAa(new lp.ThemeOperationSignal({operation:lp.IThemeOperation.Apply,themeId:ao}));bm.WC&&Gf.V6f(this.$d);this.pjp.applyTheme(Dj.theme,!1);const yj=Dj.theme,Up=bm.WC&&0!=bm.WC.sNb;bm.WC=new Ev(yj.type==Pp.templateTheme?1:0,yj.id.toString(),!1,yj.IsL2Template,yj.collectionId,yj.collectionName);Gf.Baj(Up,
this.$d);this.tg.Qcc(this.ctc);Dj.callback&&Dj.callback(this.VP.Rm.WZb)});Hk&&(Hk.Gt=ao,Hk.lE=Dj.theme.isThemeInFavorites?1:0);2!=this.$d.bSl()&&this.v0j.Caj(Dj.theme);return 32};this.fixInconsistencies=(Xl,ql,Al,Hk,Dj)=>{if(!Dj)return z.ULS.shipAssertTag(578856857,3016,!1),2;this.CWc.Gie();this.fid.qkd();this.Om.Aq||z.ULS.sendTraceTag(573608068,3016,50,"Fixing inconsistencies while not alone {{ AmITheOnlyCoauthor: {0}, IsWebToWeb: {1} }}",this.Om.Gja,this.Om.nB.gMa);this.Wnb(162,async()=>{try{const ao=
this.Pp.Vf("UserAction",Df.a.fixInconsistencies),yj=Date.now();this.lhc.A7k().then(()=>{Dj.callback&&Dj.callback(this.VP.Rm.WZb);ma.a(Df.a.Z$l,!0,Date.now()-yj);ao.stop()})}catch(ao){z.ULS.sendTraceTag(538240195,3016,10,ao)}});return 32};this.accept=(Xl,ql,Al,Hk,Dj)=>{if(!Dj)return z.ULS.shipAssertTag(578856858,3016,!1),2;this.Lw.isVisible&&this.fid.qkd();this.Wnb(171,()=>{this.Cdb.accept(Dj.paragraphNode,Dj.fWj)});Hk&&(Hk.Gt=Dj.role,Hk.lE=this.Lw.isVisible?0:1);this.$d.uYf()&&28==Dj.role&&this.O_m.QYn();
return 32};this.acceptAll=(Xl,ql,Al,Hk,Dj)=>{if(!Dj)return z.ULS.shipAssertTag(578856859,3016,!1),2;this.Wnb(167,()=>{this.Cdb.acceptAll()});1!==Dj.source&&this.fid.qkd();Hk&&(Hk.Gt=Dj.source,Hk.lE=this.Lw.isVisible?0:1);return 32};this.reject=(Xl,ql,Al,Hk,Dj)=>{if(!Dj)return z.ULS.shipAssertTag(578856860,3016,!1),2;this.Cdb.reject(Dj.paragraphNode,Dj.fWj);Hk&&(Hk.Gt=Dj.role,Hk.lE=this.Lw.isVisible?0:1);return 32};this.rejectAll=(Xl,ql,Al,Hk)=>{this.Wnb(168,()=>{this.Cdb.rejectAll()});Hk&&(Hk.lE=
this.Lw.isVisible?0:1);return 32};this.kqd=(Xl,ql,Al,Hk)=>{this.Wnb(211,()=>{this.Cdb.kqd()});Hk&&(Hk.lE=this.Lw.isVisible?0:1);return 32};this.reviewChanges=(Xl,ql,Al,Hk)=>{this.Wnb(169,()=>{const Dj=this.VP.rIm();Dj&&this.FD.Ajd(Aw.a.create(Dj))});Hk&&(Hk.lE=this.Lw.isVisible?0:1);return 32};this.tryAnyway=()=>{this.Qaa.RUl();return 32};this.showMoreThemes=(Xl,ql,Al,Hk)=>{Xl=this.vV.xAn();Hk&&(Hk.Gt=Xl);return 32};this.logThemeInfo=(Xl,ql,Al,Hk,Dj)=>{if(!Dj)return z.ULS.shipAssertTag(546109061,
3016,!1),2;this.v0j.Caj(Dj.theme);return 32};this.gnb=(Xl,ql,Al,Hk,Dj)=>{Dj&&this.Cdb.gnb(Dj);this.Lw.isVisible&&this.fid.qkd();Hk&&(Hk.Gt=Dj.role,Hk.lE=this.Lw.isVisible?0:1);return 32};this.vPa=(Xl,ql,Al,Hk,Dj)=>{Dj&&this.Cdb.vPa(Dj.paragraphNode);Hk&&(Hk.Gt=Dj.role,Hk.lE=this.Lw.isVisible?0:1);return 32};this.sOg=(Xl,ql,Al,Hk,Dj)=>{Dj.QTb?this.Cdb.vPa(Dj.paragraphNode):this.Cdb.sOg(Dj.paragraphNode);Hk&&(Hk.Gt=Dj.QTb?1:0,Hk.lE=this.Lw.isVisible?0:1);return 32};this.h5n=()=>Qd.a.IX(Df.a.YLi)?(tb.a.yn(Df.a.YLi,
void 0,void 0,"WordDesigner.OpenGreenroomPanel"),32):2;this.revertTheme=()=>{this.Wnb(208,()=>{this.fIo.revertTheme()});return 32};this.toggleFavorite=(Xl,ql,Al,Hk,Dj)=>{if(!Dj)return z.ULS.shipAssertTag(520488720,3016,!1),2;Hk&&(Hk.Gt=Dj.theme.id,Hk.lE=Dj.Hkn?1:0);this.vV.toggleFavorite(Dj.theme);return 32};this.applyOfficeTemplate=(Xl,ql,Al,Hk,Dj)=>{var ao;if(!Dj)return z.ULS.shipAssertTag(509693955,3016,!1),2;if(!Dj)return z.ULS.shipAssertTag(509642068,3016,!1),2;null===(ao=this.tL)||void 0===
ao?void 0:ao.mFg();this.zWh.showDialog();Xl=Rd.a.create();this.Ezc.v_=Xl;this.Ezc.tTn=Dj;this.Ezc.eSl=this.EPg;this.$c.addListener(this.Ezc);this.Z8k.cTd(Dj.template.binaryUrl,Xl.toString()).then(yj=>{if(0!=yj.StatusCode)z.ULS.shipAssertTag(509436170,3016,!1,`ApplyTemplate response not successful. OperationResult ${yj.StatusCode}`),this.EPg(this.Ezc,Dj),this.Gy();else{bm.WC&&Gf.V6f(this.$d);yj=bm.WC&&0!=bm.WC.sNb;const Up=Dj.template;bm.WC=new Ev(2,Up.templateId,Up.isPremium,Up.isL2Template,Up.collectionId,
Up.collectionName);Gf.Baj(yj,this.$d);this.tg.Qcc(this.ctc)}}).catch(yj=>{z.ULS.shipAssertTag(509638114,3016,!1,yj);this.EPg(this.Ezc,Dj)});return 32};this.ctc=(Xl,ql)=>{if(ql.actionId===wb.a.rza||this.tg.wba(ql.actionId))Gf.V6f(this.$d),bm.WC=null,this.tg.jtg(this.ctc)};this.EPg=(Xl,ql)=>{var Al;this.$c.removeListener(Xl);this.zWh.Pza();null===(Al=this.tL)||void 0===Al?void 0:Al.q1d();ql.mXn(this.VP.Rm.WZb)};this.Gy=()=>{const Xl=new Pa.StandardDialog;Xl.Gd=0;Xl.Ix(WordRibbonStrings.ApplyTemplateErrorDialogTitle,
WordRibbonStrings.ApplyTemplateErrorDialogMessage,0)}}Wb(){this.Sb.fb(wb.a.f6a,na.a.view,this.applyTheme,1036);this.Sb.fb(Fa.a.T3d,na.a.view,this.fixInconsistencies,1028);this.Sb.fb(Fa.a.wQd,na.a.view,this.accept,1036);this.Sb.fb(wb.a.Tlb,na.a.view,this.acceptAll,1036);this.Sb.fb(Fa.a.$te,na.a.view,this.reject,1036);this.Sb.fb(Fa.a.vkd,na.a.view,this.rejectAll,1036);this.Sb.fb(Fa.a.qxf,na.a.view,this.kqd,1036);this.Sb.fb(Fa.a.nxf,na.a.view,this.reviewChanges,1036);this.Sb.fb(Fa.a.zfi,na.a.view,this.tryAnyway,
1028);this.Sb.fb(Fa.a.xfi,na.a.view,this.showMoreThemes,1036);this.Sb.fb(Fa.a.sfi,na.a.view,this.logThemeInfo,1124);this.Sb.fb(Fa.a.gnb,na.a.view,this.gnb,1036);this.Sb.fb(Fa.a.vPa,na.a.view,this.vPa,1036);this.Sb.fb(Fa.a.sxf,na.a.view,this.sOg,1036);this.Sb.fb(Fa.a.tfi,na.a.view,this.h5n,1028);this.Sb.fb(Fa.a.Vvg,na.a.view,this.revertTheme,1028);this.Sb.fb(Fa.a.nni,na.a.view,this.toggleFavorite,1036);this.Sb.fb(wb.a.rza,na.a.view,this.applyOfficeTemplate,1036)}Wnb(e,t){e=this.eob(e,t);this.Qi.Zb(e)}eob(e,
t){return new kh.a(2,1,0,t,e)}}Object(y.a)(Cn,"DesignerActionActor",null,[1285]);const tn=e=>{Na.a.rmf&&window.performance.mark(e)};var Kq=d(1658);class Do{constructor(e,t,E,W,ha,Ka,sb,dc){this.Sb=e;this.Lw=t;this.hYa=E;this.rIo=W;this.sIo=ha;this.ro=Ka;this.Wu=sb;this.$d=dc;this.hYa.h0k(this.Zfg.bind(this))}Wb(){this.Sb.fb(Fa.a.ePa,I.a.frame,this.ePa.bind(this),1036);this.Sb.fb(Fa.a.Suc,na.a.view,this.Suc.bind(this),1124);this.Sb.fb(Fa.a.wog,na.a.view,this.ljd.bind(this),1124);this.Sb.fb(Fa.a.uog,
na.a.view,this.ljd.bind(this),1124);this.Sb.fb(Fa.a.vog,na.a.view,this.ljd.bind(this),1124);this.Sb.fb(Fa.a.tog,na.a.view,this.ljd.bind(this),1124);this.Sb.fb(Fa.a.xog,na.a.view,this.ljd.bind(this),1124);this.Sb.fb(Fa.a.lxf,na.a.view,this.B_d.bind(this),1028);this.Sb.fb(Fa.a.jxf,na.a.view,this.B_d.bind(this),1028);this.Sb.fb(Fa.a.kxf,na.a.view,this.B_d.bind(this),1028);this.Sb.fb(Fa.a.ixf,na.a.view,this.B_d.bind(this),1028);this.Sb.fb(Fa.a.yfi,na.a.view,this.ePa.bind(this),1028);this.ro.Pcc(this.b4.bind(this))}Zfg(){this.rIo.dispatch(this.sIo.updateControlHiddenState(Df.a.Eyj,
!1));tn(Df.a.Psj);window.performance&&"function"===typeof window.performance.measure&&window.performance.measure(Df.a.$$n,Df.a.Qsj,Df.a.Psj)}ePa(e,t,E,W,ha){return 1===E?32:2===E?(e=Object(ak.a)(Kq.a,ha)?ha.id:0,bm.B$c=0!=e,W&&(W.Gt=this.Lw.isVisible?0:1,W.lE=e),this.Lw.isVisible?this.Lw.hide():this.Lw.show(e),32):2}Suc(e,t,E,W,ha){if(1===E)return 32;if(!ha)return 2;ha&&(ha[ya.a.On]=this.Lw.isVisible);return 32}ljd(e,t,E,W,ha){if(1===E)return 32;if(!ha)return 2;if(ha)if(e===Fa.a.wog)ha[ug.a.Visible]=
!this.ro.Zqa();else if(e===Fa.a.uog)ha[ug.a.Visible]=this.ro.Zqa();else if(e===Fa.a.vog)ha[ug.a.Visible]=this.$d.l1f()&&this.ro.g9c(2);else if(e===Fa.a.tog)ha[ug.a.Visible]=this.$d.l1f()&&!this.ro.g9c(2);else if(e!=Fa.a.xog)return z.ULS.shipAssertTag(523850504,3016,!1,`unexpected actionId: ${e}`),8;return 32}B_d(e,t,E){if(1===E)return 32;z.ULS.sendTraceTag(523850505,3016,50,`designerChangeSettings actionId: ${e}`);if(e===Fa.a.lxf)this.ro.D_l();else if(e===Fa.a.jxf)this.ro.B2()?this.ro.wgi():(z.ULS.sendTraceTag(509137224,
3016,15,"designerDisableSuggestionsUntilUpdate fallback to local disable since roaming data is not ready"),this.ro.$xf());else if(e===Fa.a.ARl)this.ro.$xf();else if(e===Fa.a.kxf)this.ro.E5j(2);else if(e===Fa.a.ixf)this.ro.zNj(2),this.Lw.isVisible&&this.Lw.hide();else return z.ULS.shipAssertTag(523850506,3016,!1,`unexpected actionId: ${e}`),8;return 32}b4(){this.Wu.Ie()}}Object(y.a)(Do,"DesignerActor",null,[1285]);var Mr=d(1184);class zu{constructor(e,t,E){this.Sb=e;this.Qva=t;this.mca=E;this.SDa=
(W,ha,Ka)=>{var sb,dc,xc,Rc,md;return 1===Ka?(0===this.Qva.Pna&&this.Qva.eBc(0),z.ULS.sendTraceTag(524149770,3016,50,"CCP floatie opened or refreshed. Designer paste state: {0}. CorrelationId: {1}",null===(sb=this.Qva.Pna)||void 0===sb?void 0:sb.toString(),null===(dc=this.Qva.iUb)||void 0===dc?void 0:dc.toString()),ma.a("Box4PasteFloatieOpenedOrRefreshed",!0,void 0,[Object.assign(new yi.a,{name:"DesignerPasteState",string:null===(xc=this.Qva.Pna)||void 0===xc?void 0:xc.toString()}),Object.assign(new yi.a,
{name:"CorrelationId",string:null===(Rc=this.Qva.iUb)||void 0===Rc?void 0:Rc.toString()})]),1===this.Qva.Pna?32:2):2===Ka?(this.Qva.R0i(this.Qva.cfa())&&!this.Qva.R0i(null===(md=this.Qva.FOa)||void 0===md?void 0:md.h$n)&&v.AFrameworkApplication.va.Pb(wb.a.LZa,2,null),this.Qva.NUo(W),this.mca.Yuc(Object.assign(new Mr.a,{t9c:!0,K0:"reformatPastedContentToDesignerPaste"})),W=this.Qva.J8k(),z.ULS.sendTraceTag(524149771,3016,50,`Suggestions applied: ${W}`),S.App.hvc(()=>{this.mca.Yuc(Object.assign(new Mr.a,
{t9c:!1,XCg:!0}))}),32):2}}Wb(){this.Sb.fb(wb.a.SDa,na.a.view,this.SDa,1036)}}Object(y.a)(zu,"DesignerPasteActor",null,[1285]);class Au{set v_(e){this.Km=e}set eSl(e){this.rtk=e}set tTn(e){this.aGk=e}constructor(e){this.tg=e}BWb(){}QMa(){}acb(e){e.td.Bm.id.hu.equals(this.Km)&&(this.yeo(),this.rtk(this,this.aGk))}yeo(){this.tg.vrc(wb.a.rza,this.tg.CR(),!0)}}Object(y.a)(Au,"TemplateAppliedListener",null,[]);class Fv{constructor(e,t){this.ui=!1;this.LWn=(E,W)=>{W.data?this.start():this.stop()};this.h9g=
t;this.Zzd=e}initialize(){this.ui||(this.Zzd.Rcc(this.LWn),this.ui=!0)}Pd(){}start(){for(const e of this.h9g)e.register()}stop(){for(const e of this.h9g)e.unregister()}}Object(y.a)(Fv,"WorkflowManager",null,[1284,511]);class Ft{setTimeout(e,t){return window.setTimeout(e,t)}clearTimeout(e){window.clearTimeout(e)}}Object(y.a)(Ft,"WindowTimeout",null,[1283]);class mp extends Kr.a{constructor(e,t,E){super(Df.a.Stl);this.Tm=e;this.Om=t;this.pbg=E}static oRg(e,t){return!t||e.Aq?!0:e.nB.gMa&&0<(t&1)?0<(t&
2)?!1:e.Gja:!e.nB.gMa&&0<(t&4)?0<(t&8)?!1:e.Gja:!0}initialize(){super.initialize();mp.oRg(this.Om,this.pbg)&&(this.cma||z.ULS.sendTraceTag(540116318,3016,50,this.aR(this.Tm,!0)),this.Jg(!0))}Pd(){super.Pd()}}Object(y.a)(mp,"CoAuthCondition",Kr.a,[]);class Zo extends Kr.a{Jg(e){this.q8b===e&&e||super.Jg(e)}}Object(y.a)(Zo,"AOnChangeOrUnsatisfiedConditionProcessor",Kr.a,[]);class Bw extends Zo{constructor(e,t,E){super("DocumentHasHeadingConditionId");this.tV=e;this.gR=t;this.YBa=E;this.isInitialized=
!1}initialize(){if(!this.isInitialized){super.initialize();this.isInitialized=!0;var e=this.tV.Oum();for(const t of e)t&&!this.gR.E0d(t)&&this.YBa.qff(t,!1);this.YBa.size&&(z.ULS.sendTraceTag(509649924,3016,50,"Document has headings suitable for image suggestions"),this.Jg(!0))}}Pd(){this.isInitialized&&(this.isInitialized=!1,super.Pd())}}Object(y.a)(Bw,"DocumentHasHeadingCondition",Zo,[]);class Nr extends Zo{constructor(e,t,E,W){super(Df.a.Vhi);this.gIj=e;this.CNb=t;this.tV=E;this.YBa=W;this.iHe=
this.isInitialized=!1;this.Qga=()=>{const ha=this.tV.nPf();ha&&this.YBa.qff(ha,!0);this.Jg(!!ha)};this.ffd=()=>{v.AFrameworkApplication.mc.Zb(new kh.a(2,1,500,this.Qga));this.Pd()}}initialize(){super.initialize();if(!this.isInitialized){this.isInitialized=!0;var e=this.tV.nPf();e?(this.YBa.qff(e,!0),this.Jg(!0)):this.iHe||(this.iHe=!0,this.gIj.register(),this.CNb.register(),this.CNb.MH(this.ffd))}}Pd(){this.isInitialized&&(this.isInitialized=!1,this.iHe&&(this.iHe=!1,this.CNb.sK(this.ffd),this.CNb.unregister(),
this.gIj.unregister()));super.Pd()}}Object(y.a)(Nr,"DocumentHasTitleCondition",Zo,[]);class sx extends Zo{constructor(){super("HeadingsImageConditionId")}QYn(){this.Jg(!0)}}Object(y.a)(sx,"HeadingsImageCondition",Zo,[1282]);var Bu=d(116);class Zu extends Kr.a{constructor(e,t,E,W,ha=2E3){super(Df.a.wbk);this.Qob=e;this.tK=t;this.YBa=E;this.sc=W;this.$ak=ha;this.isInitialized=!1;this.I5i=1;this.Oof=()=>{if(!this.YBa.H1f){var Ka=Xf.ParagraphReader.Zl(this.sc.jd),sb=this.YBa.Esm();null===Ka||void 0===
Ka||!Ka.characterData||sb&&Ka.characterData===sb.m3f||100<=Ka.characterData.length||this.tK.O$c(Ka)||(sb=Bu.FormattingReader.Cs(Zd.a.create(Ka)),sb=Bu.FormattingReader.Bj(sb,Tb.a.fontSize,this.tpi),Ka!==this.Q3d||this.tpi!==sb||this.B$l!==Ka.characterData?(this.Q3d=Ka,this.tpi=sb,this.B$l=Ka.characterData,this.Jhi()):(Ka=Xf.ParagraphReader.Gv(this.sc.jd,!1,!1).count,10>Ka&&Ka>this.I5i&&(this.Jhi(),this.I5i=Ka)))}}}XHl(){return new kh.a(2,1,this.$ak,()=>{this.YBa.H1f=!0;this.Jg(!0);this.Nle=null})}initialize(){super.initialize();
this.isInitialized||(this.isInitialized=!0,this.Qob.emb(this.Oof),this.Oof())}Pd(){this.isInitialized&&(this.isInitialized=!1,this.Qob.ald(this.Oof));super.Pd()}Jhi(){this.Nle?v.AFrameworkApplication.mc.q4(this.Nle,this.$ak):(this.Nle=this.XHl(),v.AFrameworkApplication.mc.Zb(this.Nle))}}Object(y.a)(Zu,"ImageSuggestionWholeSessionTriggerCondition",Kr.a,[]);class Gv extends Zo{constructor(e,t){super(Df.a.jhj);this.gR=e;this.sc=t}initialize(){super.initialize();const e=Xf.ParagraphReader.Zl(this.sc.jd);
this.Jg(!this.gR.E0d(e))}}Object(y.a)(Gv,"NoCoverPhotoCondition",Zo,[]);class tr extends Kr.a{constructor(e,t){super(Df.a.k$n);this.context=t;this.Z3=(E,W)=>{this.context.uff(W.node);W.$Zi&&(this.context.k$l(),this.Jg(!0))};this.Qgd=e.Ve(12);this.context=t}initialize(){super.initialize();this.Qgd.JPh(this.Z3)}Pd(){this.Qgd.IDj(this.Z3);super.Pd()}}Object(y.a)(tr,"PasteCondition",Kr.a,[]);class Cu extends Kr.a{constructor(e){super(Df.a.h7n);this.hYa=e;this.lie=this.isInitialized=!1;this.xmj=()=>{this.Jg(this.hYa.sUh)}}initialize(){this.isInitialized||
(super.initialize(),this.isInitialized=!0,this.hYa.sUh?this.Jg(!0):this.lie||(this.lie=!0,this.hYa.E_k(this.xmj)))}Pd(){this.isInitialized&&(this.isInitialized=!1,this.lie&&(this.hYa.hAo(this.xmj),this.lie=!1),super.Pd())}}Object(y.a)(Cu,"PQLicenseCondition",Kr.a,[]);var Qn=d(1693);class Da extends Zo{constructor(e,t,E,W,ha,Ka){super(Df.a.ijo);this.ohc=e;this.hYb=t;this.rGn=E;this.sc=W;this.lb=ha;this.i4=Ka;this.isInitialized=!1;this.knj=(sb,dc)=>{dc.data.annotation?dc.data.annotation.annotationType!==
Qn.DocumentPullQuoteAnnotation.getTypeName()?(z.ULS.shipAssertTag(542500387,3016,!1),this.Jg(!1)):(sb=dc.data.annotation.content)?(z.ULS.sendTraceTag(541446528,3016,50,"PullQuotes received; Number of detected pull quotes: {0}",sb.numberOfDetectedPullQuotes),this.Jg(0<sb.numberOfDetectedPullQuotes)):(z.ULS.shipAssertTag(542500416,3016,!1),this.Jg(!1)):(z.ULS.shipAssertTag(542500386,3016,!1),this.Jg(!1))}}initialize(){if(!this.isInitialized){super.initialize();var e=this.rGn.s7d();let t=!1;75>e.paragraphCount&&
10>e.listElementsCount&&10>e.blobsCount&&2>e.tableCount&&(this.hYb.register(),this.ohc.register(),this.ohc.MH(this.knj),e=this.xom(),-1==e&&z.ULS.sendTraceTag(536941664,3016,15,"Current paragraph index for PQ signal could not be obtained."),e=new Qn.PullQuotesSignal({currentParagraphIndex:e}),this.ohc.JAa(e),this.hYb.JAa(e),this.isInitialized=t=!0);z.ULS.sendTraceTag(541446499,3016,50,"PullQuotes signal sent: {0}",t)}}Pd(){this.isInitialized&&(this.ohc.sK(this.knj),this.isInitialized=!1,super.Pd())}xom(){var e=
this.lb.gb.currentSelection;if(!e)return-1;e=e.isForward?e.Uc:e.Ra;if(!e||0>e.cpBegin)return-1;e=e.node;let t=0;if(this.q4i(e)){var E=Xf.ParagraphReader.Zl(this.sc.jd);E=this.i4.Jra(E,!1,!1);do if(this.q4i(E.my)){if(E.my===e)return t;t++}while(E.lba())}return-1}q4i(e){return Xf.ParagraphReader.Xb(e)&&!Xf.ParagraphReader.GX(e)&&!Xf.ParagraphReader.E3(e)&&Xf.ParagraphReader.Dee(e)}}Object(y.a)(Da,"PullQuotesCondition",Zo,[]);var Sa=d(1699),Ha=d(1598);class Ba extends Zo{constructor(e,t,E,W){super(Df.a.p0j);
this.tV=e;this.ORb=t;this.LD=E;this.$d=W;this.isInitialized=!1;this.Ajg=0;this.Kde=!1;this.ulj=(ha,Ka)=>{var sb;if(!Ka)z.ULS.shipAssertTag(520986718,3016,!1,"Got images for a non-existent paragraph");else if(this.ORb.has(Ka))if(++this.Ajg,ha=this.tV.getImages(Ka))if((null===(sb=ha.zU)||void 0===sb?void 0:sb.length)<Df.a.Rje)z.ULS.shipAssertTag(543269218,3016,!1),this.Ple(!1);else{for(sb=0;sb<Df.a.Rje&&ha.zU[sb].category===Sa.SuggestionCategory.TextRelatedImage;)sb++;z.ULS.sendTraceTag(527210448,3016,
50,`${sb} TextRelated image suggestions returned by workflow`);0<sb?(Ka=this.ORb.get(Ka),Ka.suggestion=new Ha.b(Hb.a.create(),ha.zU,ha.baseUrl,this.LD,this.$d,Ka.Jge),this.Ple(!0)):this.Ple(!1)}else z.ULS.shipAssertTag(543269217,3016,!1),this.Ple(!1)}}initialize(){var e;super.initialize();if(!this.isInitialized){this.isInitialized=!0;var t=[];for(const [E,W]of this.ORb)(null===(e=W.paragraph)||void 0===e?0:e.characterData)?(W.m3f=W.paragraph.characterData,t.push({id:E,text:W.m3f})):(z.ULS.shipAssertTag(543269214,
3016,!1),this.ORb.delete(E));this.ORb.size?(this.B3i()||z.ULS.sendTraceTag(509649923,3016,50,"Request images for headings"),this.tV.initialize(),this.tV.Agf(this.ulj),this.tV.FZb(t)):(z.ULS.shipAssertTag(521184916,3016,!1),this.Jg(!1))}}Pd(){this.isInitialized&&(this.tV.WDj(this.ulj),this.tV.Pd(),this.isInitialized=!1);super.Pd()}Ple(e){this.Kde||(this.Kde=e);this.Ajg==this.ORb.size&&(this.Jg(this.Kde),this.Ajg=0,this.Kde=!1,this.B3i()||z.ULS.sendTraceTag(509649922,3016,50,"Received all images requested for headings"))}B3i(){return this.ORb.values().next().value.Jge}}
Object(y.a)(Ba,"TextToImageCondition",Zo,[]);var Va=d(828),xb=d(1575);class ac{constructor(e,t,E,W,ha){this.$d=e;this.lhc=t;this.Bsa=E;this.Rm=W;this.context=ha;this.isInitialized=!1;this.xfa=0;this.Bvb=(Ka,sb)=>{var dc=sb.data.annotation;if(dc)if(dc.annotationType!==xb.FormattingSuggestionsAnnotation.getTypeName())z.ULS.shipAssertTag(523068247,3016,!1);else if(Ka=this.Bsa.getParent(dc))if(sb.data.operationType===Va.b.getTypeName())this.lhc.$_m(Ka);else if(sb.data.operationType!==Va.a.getTypeName())z.ULS.shipAssertTag(523068249,
3016,!1,`unexpected operationType: ${sb.data.operationType}`);else{if(!this.$d.u0f()&&!this.context.CDa.includes(Ka))if((dc=dc.content)&&dc.range===xb.FormattingSuggestionsRange.List&&this.context.qzl(Ka))z.ULS.sendTraceTag(509870788,3016,50,`Don't skip list paragraph: ${null===Ka||void 0===Ka?void 0:Ka.id}`);else{z.ULS.sendTraceTag(523068251,3016,50,`Skip paragraph not in pastedNodes: ${null===Ka||void 0===Ka?void 0:Ka.id}`);return}this.xfa&&(dc=[Object.assign(new yi.a,{name:Df.a.vqg,string:this.$d.u0f()?
"RealTimeInconsistencies":"BlueDiamondSmartPaste"})],ma.a(Df.a.uqg,!0,Date.now()-this.xfa,dc),this.xfa=0);0<this.$d.Wyb()&&this.context.CDa.includes(Ka)?z.ULS.sendTraceTag(521483353,3016,50,`Skip paragraph for SmartPaste CCP: ${null===Ka||void 0===Ka?void 0:Ka.id}`):this.lhc.a6o(Ka,sb.data.annotation)}else z.ULS.shipAssertTag(523068248,3016,!1);else z.ULS.shipAssertTag(523068246,3016,!1)}}initialize(){this.isInitialized||(z.ULS.sendTraceTag(545874375,3016,50,"ConsistencySuggestionsProvider - initialize"),
this.xfa=Date.now(),this.Bsa.MH(this.Bvb),this.Rm.register(),this.Bsa.register(),this.isInitialized=!0)}Pd(){this.isInitialized&&(z.ULS.sendTraceTag(545874376,3016,50,"ConsistencySuggestionsProvider - deinitialize"),this.Rm.unregister(),this.Bsa.unregister(),this.Bsa.sK(this.Bvb),this.isInitialized=!1)}}Object(y.a)(ac,"ConsistencySuggestionsProvider",null,[511]);class qc{constructor(e,t,E,W=!0){this.vOk=e;this.nKk=t;this.YGh=E;this.rJd=W;this.a3j=(ha,Ka)=>{Ka.z4?this.rJd&&this._timer?(clearTimeout(this._timer),
this.H9j()):this.Rbp():this.Pd()};this._timer=void 0}initialize(){z.ULS.sendTraceTag(545874373,3016,50,"ConsistencySuggestionsTriggerManager - initialize");const e=this.VJi();for(const t of e)t.aaa(this.a3j),t.initialize()}Pd(){z.ULS.sendTraceTag(545874374,3016,50,"ConsistencySuggestionsTriggerManager - deinitialize");this.fYj();const e=this.VJi();for(const t of e)t.Pd(),t.pna(this.a3j)}fYj(){if(this.rJd){if(!this._timer)return;clearTimeout(this._timer);this._timer=void 0}this.YGh.Pd()}Rbp(){this.YGh.initialize();
this.rJd&&this.H9j()}VJi(){return this.rJd?this.vOk:this.nKk}H9j(){this._timer=setTimeout(()=>{this.fYj()},3E4)}}Object(y.a)(qc,"ConsistencySuggestionsTriggerManager",null,[1210]);class Qc{constructor(e){this.Nd=e;this.PKc=new Set;this.clear()}clear(){this.Prl()}get CDa(){return this.Bzh}Prl(){this.Bzh=[];this.PKc.clear();this.zzh=!1}uff(e){this.zzh&&this.clear();this.Bzh.push(e);Xk.ListItemReader.Of?Xk.ListItemReader.isListItem(e)&&({listId:e}=Xk.ListItemReader.av(e),this.PKc.add(e)):this.Nd&&(e=
this.Nd.Hfa(e))&&e.hasProperty(fd.a.listID)&&(e=e.getValue(fd.a.listID),this.PKc.add(e))}k$l(){this.zzh=!0}qzl(e){if(Xk.ListItemReader.Of){if(Xk.ListItemReader.isListItem(e))return{listId:e}=Xk.ListItemReader.av(e),this.PKc.has(e)}else if((e=this.Nd.Hfa(e))&&e.hasProperty(fd.a.listID))return e=e.ja(fd.a.listID,-1),this.PKc.has(e);return!1}}Object(y.a)(Qc,"ContextualSuggestionsContext",null,[]);var K=d(1615);class pa{constructor(e,t,E){this.gR=e;this.VP=t;this.FD=E;this.RYn=W=>{this.FD.Xuc({role:28,
paragraphNode:W.Jb.paragraph,placeholder:!1,ita:W});v.AFrameworkApplication.mc.Zb(new kh.a(2,1,0,()=>{this.FD.Ajd(Aw.a.create(W.Jb.paragraph))},void 0,void 0,!0))}}S6o(e){e.paragraphNode?e.suggestion?e.suggestion.Nsa(e.kta)?null==e.suggestion.O_(e.kta)?z.ULS.shipAssertTag(541435532,3016,!1):3===this.VP.Ize(new K.b(e.suggestion,[e.paragraphNode],0,Xf.ParagraphReader.textLength(e.paragraphNode),()=>this.wTh(e)))&&z.ULS.sendTraceTag(541435533,3016,50,"Contextual image suggestion offered"):z.ULS.shipAssertTag(541435531,
3016,!1):z.ULS.shipAssertTag(540389592,3016,!1):z.ULS.shipAssertTag(541435530,3016,!1)}wTh(e){if(e.paragraphNode)if(e.suggestion)if(e.suggestion.Nsa(e.kta))if(null==e.suggestion.O_(e.kta))z.ULS.shipAssertTag(527521920,3016,!1);else return z.ULS.sendTraceTag(527210447,3016,50,"Applying image suggestion. {0}",{["imageIndex"]:e.kta,["imageConfidence"]:e.suggestion.Cvm(e.kta)}),3===this.VP.Qvj(e,t=>{t.suggestion.selectedIndex=t.kta;if(t=this.gR.YVf(t.suggestion.Nsa(t.kta),t.paragraphNode,!0,wb.a.pKb,
wb.a.Rif,{Rld:{d1b:0,cropAspectRatio:Df.a.IQi},altText:t.suggestion.O_(t.kta),nbe:wb.a.RSd},this.RYn))return{role:28,paragraphNode:t.Jb.paragraph,ita:t,placeholder:!0}});else z.ULS.shipAssertTag(527521891,3016,!1);else z.ULS.shipAssertTag(527521890,3016,!1);else z.ULS.shipAssertTag(527521889,3016,!1)}}Object(y.a)(pa,"ImageSuggestionHandlerImpl",null,[1281]);class Ta{constructor(e,t,E,W){this.Lw=e;this.gR=t;this.sc=E;this.Khf=W}initialize(){}T8(){return this.Lw.isVisible?(z.ULS.sendTraceTag(543269248,
3016,50,"Auto launch suppressed: pane already visible"),!0):Object(Jq.c)()&&this.Khf.I1f?(z.ULS.sendTraceTag(509101060,3016,50,"Auto launch suppressed: AiMaker triggered"),!0):this.gR.E0d(Xf.ParagraphReader.Zl(this.sc.jd))?(z.ULS.sendTraceTag(543269249,3016,50,"Auto launch suppressed: first paragraph is an image"),!0):!1}WX(){}}Object(y.a)(Ta,"ImageSuggestionSuppressionModel",null,[1260]);class jb extends Map{constructor(){super(...arguments);this.H1f=!1}qff(e,t){if(e){var E=e.id.toString();this.has(E)?
this.get(E).paragraph=e:this.set(E,{suggestion:null,paragraph:e,m3f:"",Jge:t})}}Esm(){return this.values().next().value}}Object(y.a)(jb,"ImageSuggestionContextMap",Map,[]);class bc{constructor(e,t,E){this.goa=e;this.yUf=t;this.YBa=E;this.isInitialized=!1;this.T2j=(W,ha)=>{if(ha.z4)for(const Ka of this.YBa.values())Ka.suggestion&&this.yUf.S6o(new K.a(Ka.suggestion,Ka.paragraph,0));this.YBa.H1f=!1}}initialize(){if(!this.isInitialized){for(const e of this.goa)e.aaa(this.T2j),e.initialize();this.isInitialized=
!0}}Pd(){if(this.isInitialized){for(const e of this.goa)e.Pd(),e.pna(this.T2j);this.isInitialized=!1}}}Object(y.a)(bc,"ImageSuggestionTriggerManager",null,[1210]);class Ic{constructor(e,t){this.Lw=e;this.Khf=t}initialize(){}T8(){return this.Lw.isVisible?(z.ULS.sendTraceTag(542500385,3016,50,"Auto launch suppressed: pane already visible"),!0):Object(Jq.c)()&&this.Khf.I1f?(z.ULS.sendTraceTag(509101059,3016,50,"Auto launch suppressed: AiMaker triggered"),!0):!1}WX(){}}Object(y.a)(Ic,"PullQuotesSuppressionModel",
null,[1260]);var Uc=d(1849);class kd{constructor(e,t,E,W,ha,Ka,sb=null,dc){this.goa=e;this.kjo=t;this.hYb=E;this.oxf=W;this.VP=ha;this.Rm=Ka;this.LD=sb;this.$d=dc;this.a9d=(xc,Rc)=>{Rc.z4&&this.J7o().then(md=>{z.ULS.sendTraceTag(542500378,3016,50,`PullQuotes showed: ${md}`)});this.Pd()}}initialize(){z.ULS.sendTraceTag(542500376,3016,50,"PullQuotesTriggerManager.ts - initialize");for(const e of this.goa)e.aaa(this.a9d),e.initialize()}Pd(){z.ULS.sendTraceTag(542500377,3016,50,"PullQuotesTriggerManager.ts - deinitialize");
for(const e of this.goa)e.Pd(),e.pna(this.a9d)}J7o(){return this.hYb.vjc().then(e=>{let t=0;try{for(const E of e){if(!E)return z.ULS.shipAssertTag(542500379,3016,!1),t;if(E.annotationType!==Qn.PullQuoteAnnotation.getTypeName())return z.ULS.shipAssertTag(542500380,3016,!1),t;const W=E.content;if(!W)return z.ULS.shipAssertTag(542500381,3016,!1),t;if(0<W.confidence){const ha=E.parent;if(!ha)return z.ULS.sendTraceTag(512239202,3016,50,"Paragraph node is null."),t;const Ka=this.Rm.YB(ha);if(!Ka||27===
Ka.role||Ka.Ula)continue;let sb=Xf.ParagraphReader.text(ha);if(!sb)return z.ULS.shipAssertTag(512323934,3016,!1),t;const dc=W.range.start,xc=W.range.length;z.ULS.sendTraceTag(538730699,3016,50,"PQ annotation info: {0}",{["annStart"]:dc,["annLength"]:xc,["orgTextLength"]:sb.length,["paragraphLength"]:Xf.ParagraphReader.textLength(ha)});0<xc&&(sb=sb.substr(dc,xc));const Rc=Math.floor(Math.random()*Uc.a.YIj),md=Hb.a.create();z.ULS.sendTraceTag(541446497,3016,50,"Detected pull quote info: {0}",{["suggestionId"]:md,
["confidence"]:W.confidence,["textLength"]:sb.length,["paragraphLength"]:Xf.ParagraphReader.textLength(ha),["paragraphRole"]:Ka.role});this.oxf.Xuc({role:27,paragraphNode:ha,placeholder:!1});const ud=this.VP.Ize(new K.b(new Ha.d(md,1,this.LD,this.$d,!0,Rc,sb),[ha],dc,dc+xc,(Ud,Id)=>{if(!Id||1!=Id.length)return z.ULS.shipAssertTag(509744530,3016,!1,`Wrong paragraph count when applying pull quote ${null===Id||void 0===Id?void 0:Id.length} suggestionId:${md}`),!1;Id=Id[0];z.ULS.sendTraceTag(541446498,
3016,50,"Blue dot clicked, creating pull quote with info: {0}",{["suggestionId"]:md,["textLength"]:sb.length,["paragraphLength"]:Xf.ParagraphReader.textLength(Id),["paragraphRole"]:Ud.role,["styleId"]:Rc});Ud=[new K.c(new Ha.d(md,1,this.LD,this.$d,!0,Rc,sb),Id,Rc,sb,Ee=>{this.oxf.Ajd(Aw.a.create(Ee));this.oxf.Xuc({role:27,paragraphNode:Ee,placeholder:!1})})];this.kjo.XSd(Ud);return!0}));ud&&1!==ud&&t++}}}catch(E){z.ULS.shipAssertTag(542500383,3016,!1,"Exception occurred: {0}",String.format("{0} {1}",
E.message,E.stack))}finally{return t}}).catch(()=>{z.ULS.shipAssertTag(542500384,3016,!1);return Promise.resolve(0)})}}Object(y.a)(kd,"PullQuotesTriggerManager",null,[1210]);class pd{constructor(e,t,E){this.source=e;this.event=t;this.target=E}}Object(y.a)(pd,"Transition",null,[]);class Fd{constructor(){this.z2j=[new pd(0,0,1),new pd(1,0,1),new pd(1,1,2),new pd(0,1,3),new pd(3,2,0),new pd(1,2,0),new pd(2,2,0)];this.isInitialized=!1}LFn(e){const t=new yi.a,E=new yi.a;t.name=Df.a.tXl;t.int64=e.event;
E.name=Df.a.vXl;E.int64=e.target;ma.a(Df.a.uXl,!0,void 0,[t,E])}transition(e,t){if(this.isInitialized&&this.z2j)for(const E of this.z2j)if(E.event===e&&E.source===this.state)return t&&(this.LFn(E),this.state=E.target),!0;return!1}initialize(e){this.isInitialized||(this.state=e,this.isInitialized=!0)}getState(){return this.state}m0d(e){return this.transition(e,!0)}}Object(y.a)(Fd,"DocumentStateMachine",null,[]);var le=d(1586);class jf{constructor(e,t){this.f0j=e;this.sbe=t}equals(e){return!!e&&this.f0j===
e.f0j&&this.sbe.length===e.sbe.length&&this.sbe.every((t,E)=>t===e.sbe[E])}}Object(y.a)(jf,"TemplateContent",null,[]);class of{jAp(e){this.Nwn=this.nzi(e)}zsn(e){var t;return!(null===(t=this.Nwn)||void 0===t?0:t.equals(this.nzi(e)))}nzi(e){var t,E;let W=0;const ha=[];e=Xf.ParagraphReader.Gv(e,!0,!0);for(const Ka of e)if(e=Ka)Xf.ParagraphReader.kRb(e)&&ha.push(e.id.toString()),W+=null!==(E=null===(t=e.characterData)||void 0===t?void 0:t.length)&&void 0!==E?E:0;return new jf(W,ha)}}Object(y.a)(of,"TemplateContentComparer",
null,[]);class tf{constructor(e,t,E,W,ha,Ka){this.Dg=e;this.view=t;this.Qob=E;this.tg=W;this.phc=ha;this.$d=Ka;this.ed=new ua.a;this.b0j=new of;this.d1n=(sb,dc)=>{this.tg.wba(dc.actionId)&&this.mFg()};this.Ohg=(sb,dc)=>{this.VYi||(this.Ekj(sb,dc),this.dTd&&this.q1d())};this.Ekj=()=>{if(!this.dTd){let sb=!1;this.HXi()?sb=this.phc.m0d(2):1===this.WVa()?this.b0j.zsn(this.view.jd)&&(sb=this.phc.m0d(1),Gf.EFn(this.$d)):sb=this.phc.m0d(1);sb&&this.ed.raiseEvent("OnDocumentStateChanged",new le.a(this.WVa()))}};
this.upp();this.Qob.emb(this.Ekj);this.tg.vQh(this.Ohg);this.tg.s1k(this.d1n)}HXi(){return this.Dg.Fea(this.view.jd)}upp(){const e=this.HXi()?0:3;this.phc.initialize(e)}sxi(){switch(this.WVa()){case 0:case 1:return au.templates;case 2:return au.templateStyles;default:return au.main}}mFg(){this.dTd=!0}q1d(){this.dTd=!1;this.phc.m0d(0)&&this.Avp();this.b0j.jAp(this.view.jd)}Avp(){this.ed.raiseEvent("OnDocumentStateChanged",new le.a(this.WVa()))}WVa(){return this.phc.getState()}ZPh(e){this.ed.addHandler("OnDocumentStateChanged",
e)}freeze(){this.VYi=!0}Hrp(){this.VYi=!1}}Object(y.a)(tf,"DocumentStateMonitor",null,[1280]);var Se=d(278);class ye extends Se.a{constructor(e,t,E){super(t);this.jXe=!1;this.errorState=e;this.U$a=E}get cma(){return this.U$a&&this.jXe?!1:super.cma}dismiss(){this.U$a&&!this.jXe&&(this.jXe=!0,this.Jg(!1))}}Object(y.a)(ye,"AErrorStateConditionProcessor",Se.a,[1309,1043,511]);class Uf extends ye{constructor(e){super(Pn.nonTargetDocument,"DocumentLanguageErrorConditionId",!0);this.x6b=e;this.ZLe=this.jXn.bind(this)}initialize(){super.initialize();
void 0===this.x6b.i9c?this.x6b.b0k(this.ZLe):this.KZa()}Pd(){this.x6b.zDj(this.ZLe);super.Pd()}KZa(){this.Jg(void 0!==this.x6b.i9c&&!this.x6b.i9c)}jXn(){this.KZa();this.x6b.zDj(this.ZLe)}}Object(y.a)(Uf,"DocumentLanguageErrorCondition",ye,[]);var sh=d(360);class Tf extends ye{constructor(e){super(Pn.documentTooLarge,"DocumentTooLargeErrorConditionId",!1);this.Cvb=(t,E)=>{E.data.operationType===sh.a.getTypeName()&&(E.data.annotation?E.data.annotation.annotationType!==xb.FormattingSuggestionsSummaryAnnotation.getTypeName()?
z.ULS.shipAssertTag(570781981,3016,!1):(t=E.data.annotation.content)?this.Jg(t.errorCode===xb.ErrorCode.DocumentTooLarge):z.ULS.shipAssertTag(570781982,3016,!1):z.ULS.shipAssertTag(570781980,3016,!1))};this.ijh=e}initialize(){super.initialize();this.ijh.MH(this.Cvb)}Pd(){super.Pd();this.ijh.sK(this.Cvb)}KZa(){}}Object(y.a)(Tf,"DocumentTooLargeErrorCondition",ye,[]);var hf=d(1582);class zi extends ye{constructor(e,t,E){super(Pn.lowConfidenceDocument,"LowConfidenceErrorConditionId",!0);this.tch=-1;
this.fjb=!1;this.afg=(W,ha)=>{ha.data.operationType===sh.a.getTypeName()&&(ha.data.annotation?ha.data.annotation.annotationType!==hf.DocumentRoleDetectionAnnotation.getTypeName()?z.ULS.shipAssertTag(570781977,3016,!1):(W=ha.data.annotation.content,W)?W.errorCode||(this.tch=W.isTarget?1:0,this.fjb||this.KZa(),this.QQe.sK(this.afg)):z.ULS.shipAssertTag(570781978,3016,!1):z.ULS.shipAssertTag(570781976,3016,!1))};this.QQe=e;this.jb=t;this.Oj=E}initialize(){super.initialize();this.QQe.MH(this.afg)}Pd(){super.Pd();
this.QQe.sK(this.afg)}KZa(){this.fjb=this.jb.Fea(this.Oj.jd);this.Jg(!this.tch&&!this.fjb)}}Object(y.a)(zi,"LowConfidenceErrorCondition",ye,[]);var El=d(1328),Yk=d(1329);class lj extends ye{constructor(e,t){super(Pn.multipleAuthorsNotSupported,"MultipleAuthorsErrorConditionId",!1);this.Om=e;this.pbg=t;this.hfh=!1}KZa(){const e=!mp.oRg(this.Om,this.pbg);this.Jg(e);e&&!this.hfh&&(this.hfh=!0,z.ULS.sendTraceTag(556888910,El.a.mbg,Yk.a.info,"Coauthoring error satisfied: {{ AmIAlone: {0}, AmITheOnlyCoauthor: {1}, IsWebToWeb: {2} }}",
this.Om.Aq,this.Om.Gja,this.Om.nB.gMa))}}Object(y.a)(lj,"MultipleAuthorsErrorCondition",ye,[]);class In extends ye{constructor(e,t){super(Pn.trackChangesNotSupported,"TrackChangeErrorConditionId",!1);this.Md=e;this.iPa=t;this.apj=()=>{this.KZa()}}initialize(){super.initialize();this.iPa.Zte("OnTrackChangesStatusUpdatedEventKey",this.apj);this.KZa()}Pd(){super.Pd();this.iPa.Xzo(this.apj)}KZa(){this.Jg(this.Md.Mg)}}Object(y.a)(In,"TrackChangeErrorCondition",ye,[]);class Gm{constructor(e){this.ui=!1;
this.pzd=Pn.none;this.PLe=!1;this.TYa=()=>{this.$Lg()};this.sa=new ua.a;this.YY=e}initialize(){if(!this.YY.count)z.ULS.shipAssertTag(570781983,3016,!1);else if(!this.ui){for(const e of this.YY)e.initialize(),e.IRd(this.TYa);this.ui=!0;this.$Lg()}}Pd(){if(this.ui){for(const e of this.YY)e.zue(this.TYa),e.Pd();this.ui=!1}}vPh(e){this.sa.addHandler("CurrentErrorStateChangedEventKey",e)}mAo(e){this.sa.removeHandler("CurrentErrorStateChangedEventKey",e)}get PMb(){return this.pzd}OQj(e){this.pzd!==e&&(this.pzd=
e,this.sa.raiseEvent("CurrentErrorStateChangedEventKey",new le.a(this.pzd)))}RUl(){for(const e of this.YY)e.U$a&&e.dismiss()}H4d(){this.PLe=!1;for(const e of this.YY)e.KZa();this.$Lg();return this.PMb}x4o(e){return e.U$a&&this.PLe&&this.PMb!==e.errorState}$Lg(){for(const e of this.YY)if(e.cma&&!this.x4o(e)){this.OQj(e.errorState);this.PLe=!0;return}this.OQj(Pn.none)}}Object(y.a)(Gm,"ErrorStateManagerV2",null,[1278,511]);class Wm{constructor(e,t,E,W,ha,Ka){this.taskPane=e;this.K4=t;this.Ahp=E;this.Qaa=
W;this.FD=ha;this.zY=Ka;this.isInitialized=!1;this.xAc=()=>{this.taskPane.isVisible&&this.Ahp.Toc&&!this.Qaa.PMb&&(this.R2j(11===this.taskPane.Tm?Df.a.llk:Df.a.j8n),this.i8n=tb.a.Ee(),window.addEventListener("FGWebSurfaceEvent",this.laj,!0),this.K4.dEj(this.xAc),this.K4.YDj(this.xAc),this.Qaa.mAo(this.xAc))};this.laj=sb=>{var dc;"d7c04a5a-c5ed-43b1-a927-d2f31717f7ee"===(null===(dc=null===sb||void 0===sb?void 0:sb.detail)||void 0===dc?void 0:dc.id)&&(sb=tb.a.Ee()-this.i8n,z.ULS.sendTraceTag(529348737,
3016,50,`Pane FRE shown after: ${sb}`));window.removeEventListener("FGWebSurfaceEvent",this.laj,!0)};this.Jnj=()=>{this.R2j(Df.a.rVn);this.FD.SAo(this.Jnj)}}initialize(){this.isInitialized||(this.isInitialized=!0,this.K4.Rcc(this.xAc),this.K4.Dgf(this.xAc),this.Qaa.vPh(this.xAc),this.FD.Fgf(this.Jnj))}Pd(){}R2j(e){this.zY.execute(t=>{t.logActivity(e,null)})}}Object(y.a)(Wm,"DesignerFirstRunExperienceManager",null,[1277,511]);var Ve=d(138),Yj=d(692),Zj=d(56),pl=d(241),qh=d(243),Ok=d(86),Gp=d(1149);
class cq{get state(){return this._state}constructor(){this._state="pending";this.fHb=new Promise((e,t)=>{this.rT=e;this.dqa=t})}finally(e){return this.fHb.finally(e)}then(e,t){return this.fHb.then(e,t)}catch(e){return this.fHb.catch(e)}resolve(e){this.rT(e);this._state="fulfilled"}reject(e){this.dqa(e);this._state="rejected"}}Symbol.toStringTag;Object(y.a)(cq,"DeferredPromise",null,[]);var Ml=d(1889),$o=d(1802),dq=d(181),Eo=d(1596);const ap=(e,t,E=!0,W=()=>!0)=>{const ha=new Ld.GraphIterator;ha.set(e);
fk.forEachCellInTable(ha,Ka=>{(Ka=Ka.currentNode)&&W(Ka)&&(Ka.setValue(fd.a.zzb,dq.a.Dza),Ka.setValue(fd.a.wzb,dq.a.Dza),Ka.setValue(fd.a.xzb,dq.a.Dza),Ka.setValue(fd.a.yzb,dq.a.Dza));return!0});E&&(e.setValue(fd.a.ob,0),e.setValue(fd.a.pb,dq.a.Dza),e.setValue(fd.a.qb,0),e.setValue(fd.a.rb,dq.a.Dza),e.setValue(fd.a.Xa,0),e.setValue(fd.a.Ya,dq.a.Dza),e.setValue(fd.a.Va,0),e.setValue(fd.a.Wa,dq.a.Dza));ha.set(e);t.O9j(ha)},Fs=(e,t)=>(null===e||void 0===e?void 0:e.type)===t,nn=e=>{if(!e.Jd())return!1;
e.ld(11);return!0},hs=e=>{if(!e)return z.ULS.shipAssertTag(528779278,3016,!1),null;if(e=pl.WordSectionNavigator.instance.FN(e)){const t=new $o.a;t.marginTop=qh.a.instance.Qsa(e);t.marginBottom=qh.a.instance.qBa(e);t.marginLeft=qh.a.instance.$J(e);t.marginRight=qh.a.instance.FL(e);t.rp=qh.a.instance.ev(e);t.qw=qh.a.instance.jD(e);t.vCa=qh.a.instance.R9c(e);return t}z.ULS.shipAssertTag(529008003,3016,!1);return null},Zq=(e,t,E)=>{var W;const ha=new hc.DictionaryPropertySet;ha.setValue(dj.a.mS,e);ha.setValue(dj.a.zna,
!0);ha.setValue(dj.a.L7,!0);t.Pb(wb.a.uIa,2,ha);e=[];for(E=E.gb.currentSelection.bR(!0);E.moveNext();)(t=null===(W=E.current)||void 0===W?void 0:W.node)&&e.push(t);return e},$k=()=>{var e=dk.PageReader.instance.Mkc();e=Xf.ParagraphReader.Zl(e,!0,!0);if(!e)return z.ULS.shipAssertTag(527212705,3016,!1),!1;if(Du())return!1;e=hs(e);if(!e)return!1;var t=Ml.a.Zua[3].b4a,E=Ml.a.Zua[0].a4a,W=Ml.a.Zua[0].b4a;if(!(e.qw===Ml.a.Zua[3].a4a&&e.rp===t||e.qw===E&&e.rp===W))return!1;t=Ml.a.l4[0].l9b;E=Ml.a.l4[0]._marginLeft;
W=Ml.a.l4[0].m9b;return e.marginTop===Ml.a.l4[0].FFb&&e.marginBottom===t&&e.marginLeft===E&&e.marginRight&&W},Du=()=>{const e=Ld.GraphIterator.eb(Lh.a.en.ib.$c);Object(gh.a)().dS(e);if(!e.currentNode)return z.ULS.shipAssertTag(527212706,3016,!1),!1;if(!e.tWa(0,t=>t instanceof Gp.a))return!1;e.Xd();do{const t=e.currentNode;if(t&&t.ja(fd.a.dMb,void 0)===Df.a.SCl)return!0}while(e.Fk());return!1},Gt=(e,t)=>{e=Xf.ParagraphReader.Gv(e,!1,!1);return null===e||void 0===e?void 0:e.toArray().filter(E=>{var W;
const ha=null===(W=null===E||void 0===E?void 0:E.characterData)||void 0===W?void 0:W.trim();return 0!==(null===ha||void 0===ha?void 0:ha.length)&&!(null===t||void 0===t?0:t.find(Ka=>Ka===ha))})},ot=(e,t,E,W,ha,Ka,sb,dc)=>{let xc=E.jg(e);if(!xc.zb(14)||!xc.ld(14))return z.ULS.shipAssertTag(524115976,3016,!1),!1;if(!nn(xc))return z.ULS.shipAssertTag(524115977,3016,!1),!1;t.$z(xc,!1,!1);t=t.QJ(xc);js(e,t,W,ha,Ka,sb,dc,!0);xc=E.jg(e);xc.Jd();xc.eh();xc.eh();return!0},is=(e,t)=>{e=t.jg(e);nn(e)?e.Fk()&&
t.mzi(e).Fk()&&(e.tWa(0,E=>Fs(E,12)),null!==e&&Xf.ParagraphReader.isEmpty(e)&&(e.eh(),e.eh())):z.ULS.shipAssertTag(527462685,3016,!1)},$u=(e,t,E,W,ha=60)=>{var Ka,sb=Xf.ParagraphReader.Gv(t,!1,!1);if(sb&&0!==sb.count){t=[];for(const dc of sb)if(sb=dc,0===(null===(Ka=null===sb||void 0===sb?void 0:sb.characterData)||void 0===Ka?void 0:Ka.trim().length)&&(t.push(sb),2===t.length))break;for(const dc of e)Eu(dc,E,W,ha);for(const dc of t)Eu(dc,E,W,ha)}},Eu=(e,t,E,W=60)=>{t.Ttc(e,0,Xf.ParagraphReader.textLength(e),
E,W)},Or=(e,t,E,W,ha)=>{W=W.jg(e);W.zb(14);const Ka=W.ld(14),sb=new cq;E.zXf(e,0,Xf.ParagraphReader.textLength(e),ha,dc=>{var xc;if(60===dc){if(!t.read(Ka)){dc=t.write;a:{switch(ha){case Eo.a.mGg:var Rc={type:Oo.table};break a;case Eo.a.nfc:Rc={type:Oo.complexDecorator};break a}Rc=void 0}dc.call(t,Ka,Rc)}0!==(null===(xc=null===e||void 0===e?void 0:e.characterData)||void 0===xc?void 0:xc.trim().length)&&t.JJp(Ka,e)}sb.resolve()});return sb},js=(e,t,E,W,ha,Ka,sb,dc=!1)=>{var xc;const Rc=e.iQ,md=E.fEi(e),
ud=sb.YB(e);e=Xf.ParagraphReader.rca(e);const Ud=Zd.a.createTextRange(t,0,Xf.ParagraphReader.textLength(t));W.Ne(Ud,e);E.qTh(t,md);E=null!==(xc=null===ud||void 0===ud?void 0:ud.role)&&void 0!==xc?xc:1;dc&&1===E&&(ha=ha.Ae(Rc),ha===Zj.StyleReader.KAb&&(E=2),ha===Zj.StyleReader.Xud&&(E=3));1!==E&&(Ka.Ija(t,E),sb.jod(t,E,ud.Hpc,!1,ud.Pcd,ud.Bje,ud.listItemPrefix))},Zk=(e,t,E)=>{(e=e.properties)&&t.TAg(e,E)},nh=e=>e?e.replace(/((rgb\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}\s*\))|(#[0-9a-fA-F]{6}))/g,t=>Ok.a.XXd(t)):
(z.ULS.shipAssertTag(523104409,3016,!1),e),Ys=(e,t)=>{e=t.jg(e);return nn(e)?!0:(z.ULS.shipAssertTag(509207309,3016,!1),!1)};class Ii{constructor(e,t,E,W,ha,Ka,sb,dc,xc){this.Kf=e;this.hn=t;this.lb=E;this.kUc=W;this.KR=ha;this.Vb=Ka;this.IA=sb;this.sc=dc;this.jr=xc;this.ZVf=(Rc,md,ud,Ud,Id)=>null!==md&&void 0!==md&&md.properties?(null===Rc||void 0===Rc?void 0:Rc.property)===dj.a.iu?(z.ULS.sendTraceTag(524076488,3016,50,`Image loaded after ${tb.a.Ee()-ud}`),Ud&&this.Wii(md,Ud),Id&&Id(md),!0):!1:(z.ULS.shipAssertTag(524076485,
3016,!1),!1)}YVf(e,t,E,W=wb.a.G2,ha=wb.a.Rif,Ka,sb){var dc,xc,Rc,md;try{if(e&&""!==e){t||z.ULS.shipAssertTag(544011278,3016,!1,"Paragraph is not valid");var ud=String.format('<img src="{0}"/>',e),Ud=this.vGl(t,E,ha);if(Ud){const Id=null===(dc=this.lb.gb)||void 0===dc?void 0:dc.currentSelection;this.lb.Ic(new Nd.Selection([Zd.a.Tc(Ud,0)],!0));const Ee=new hc.DictionaryPropertySet;Ee.setValue(dj.a.mS,ud);Ee.setValue(dj.a.L7,!0);v.AFrameworkApplication.va.Pb(W,2,Ee);const kf=Xf.ParagraphReader.zg(t,
E);null===(xc=this.jr)||void 0===xc?void 0:xc.V0(0);null===(Rc=this.jr)||void 0===Rc?void 0:Rc.JEa();this.lb.Ic(Id);null===(md=this.jr)||void 0===md?void 0:md.lza();const Ke=Ii.l7d(kf);if(sb||Ka){const dh=tb.a.Ee();Ii.oRd(Ke,$h=>this.ZVf($h,Ke,dh,Ka,sb))}return Ke}z.ULS.shipAssertTag(545814281,3016,!1,"Unsuccessful node creation")}else z.ULS.shipAssertTag(545814280,3016,!1,"Invalid image URL")}catch(Id){z.ULS.shipAssertTag(545814282,3016,!1,String.format("{0} {1}",Id.message,Id.stack))}}Wii(e,t){const E=
null===e||void 0===e?void 0:e.properties;if(E)if(t){var W=this.IA.Mc(15,t.nbe);try{W.Xz.Ab(this.sc.jd),t.Rld&&this.lGo(e,t.Rld),t.altText&&this.KR.x_a(E,t.altText)}finally{W.dispose()}}else z.ULS.shipAssertTag(523572621,3016,!1);else z.ULS.shipAssertTag(523572620,3016,!1)}vGl(e,t,E){E=this.IA.Mc(15,E,!1);try{E.Xz.Ab(this.sc.jd);const W=this.hn.jg(e);if(!W.Jd())return null;lg.OutlineElementNavigator.he(W);this.Kf.$z(W,t,!1,void 0,void 0,!1);const ha=new Yj.a,Ka=this.Vb.EF(e);Ka&&(ha.uoa=Ka.gh(Zj.StyleReader.p3b));
return this.Kf.QJ(W,ha)}finally{E.dispose()}}E0d(e){return null!=this.hn.jg(e).tWa(0,t=>Gg.ImageReader.DSb(t.properties))?!0:!!Ii.l7d(e)}bjl(e,t,E){if(0>=E)z.ULS.shipAssertTag(545367367,3016,!1,String.format("Aspect ratio:{0} must be bigger than 0",E));else{var W=e/t;if(E>W)return t=Math.floor((t-e/E)/t*5E4),{width:e,height:e/E,oAa:t,lAa:t};if(E<W)return e=Math.floor((e-t*E)/e*5E4),{width:t*E,height:t,mAa:e,nAa:e}}}onf(e,t,E,W){let ha={width:e,height:t};W.cropAspectRatio&&(e=this.bjl(e,t,W.cropAspectRatio),
ha={...ha,...e},e=ha.width,t=ha.height);if(0===W.d1b&&E)return ha.width=2*Ve.a.oB(E.rp-E.marginLeft-E.marginRight)-.08,ha.height=ha.width/e*t,ha;if(1===W.d1b&&E)return ha.width=2*Ve.a.oB(E.rp),ha.height=ha.width/e*t,ha.lRi=-E.marginLeft,ha;if(2===W.d1b&&0<W.vXh&&0<W.rXh)return E=Math.min(1*W.vXh/e,1*W.rXh/t),ha.width=e*E,ha.height=t*E,ha;-1!==W.d1b&&z.ULS.shipAssertTag(524105118,3016,!1,"Couldn't stretch image for stretchType {0}",W.d1b);return ha}k8k(e,t){var E,W,ha,Ka,sb,dc;const xc=e.properties;
this.kUc.pOa(xc,t.width);this.kUc.oOa(xc,t.height);t.lRi&&(null===(E=e.Jb)||void 0===E?0:E.paragraph)&&$t.a.iWa.qOa(null===(W=e.Jb)||void 0===W?void 0:W.paragraph,1,t.lRi);(t.oAa||t.lAa||t.mAa||t.nAa)&&this.KR.Tzg(xc,null!==(ha=t.oAa)&&void 0!==ha?ha:0,null!==(Ka=t.lAa)&&void 0!==Ka?Ka:0,null!==(sb=t.mAa)&&void 0!==sb?sb:0,null!==(dc=t.nAa)&&void 0!==dc?dc:0)}lGo(e,t){var E;if(e){var W=e.properties;if(W){var ha=Gg.ImageReader.tE(W);W=Gg.ImageReader.YJ(W);if(0>=ha)z.ULS.shipAssertTag(545814284,3016,
!1,String.format("Image width:{0} must be bigger than 0",ha));else if(0>=W)z.ULS.shipAssertTag(545814285,3016,!1,String.format("Image height:{0} must be bigger than 0",W));else{var Ka=hs(null===(E=e.Jb)||void 0===E?void 0:E.paragraph);t=this.onf(ha,W,Ka,t);this.k8k(e,t)}}else z.ULS.shipAssertTag(545814283,3016,!1,"Image properties should not be null")}else z.ULS.shipAssertTag(539772548,3016,!1,"Image blob should not be null")}ovc(e,t){this.kUc.Asg(t,e);e=this.hn.jg(t);Xf.ParagraphReader.isEmpty(e)&&
this.Kf.YDa(e.currentNode)}static l7d(e){var t;const E=(null===e||void 0===e?0:e.qa)?e.qa.length:0;for(let W=0;W<E;W++){const ha=e.qa.J(W);if(5==(null===(t=ha.blob)||void 0===t?void 0:t.Jh))return ha.blob}return null}static oRd(e,t){const E=(W,ha)=>{t(ha)&&(e.properties.remove_propertyChanged(E),e.properties.fEj(E))};e.properties.add_propertyChanged(E);e.properties.zQh(E)}static kDo(e){if(!e)return z.ULS.shipAssertTag(538996813,3016,!1),[e,!1];const t=/src="([\w\W]+?)"/g;let E,W=e,ha=!1;for(;null!==
(E=t.exec(e));)W=W.replace(E[1],Ff.a.ki(E[1])),ha=!0;return[W,ha]}}Object(y.a)(Ii,"DesignerImageManagerImpl",null,[1262]);var Dm=d(1780),tl=d(1568);class ur{constructor(e,t,E,W){this.Rm=e;this.G1b=t;this.sc=E;this.Vb=W;this.isInitialized=!1;this.Nzc=new Map;this.Xgd=new Map;this.ed=new ua.a;this.Toj=(ha,Ka)=>{var sb;Ka.data.operationType===sh.a.getTypeName()&&(Ka.data.annotation?(ha=this.qEm(Ka.data.annotation.parentPath),ha.id&&ha.text?Ka.data.annotation.annotationType!==Dm.TextToImageAnnotation.getTypeName()?
z.ULS.shipAssertTag(526424277,3016,!1):(Ka=Ka.data.annotation.content)?null!==(sb=Ka.images)&&void 0!==sb&&sb.length?this.Nzc.set(ha.text,{zU:Ka.images,baseUrl:Ka.baseUrl}):z.ULS.shipAssertTag(526424279,3016,!1):z.ULS.shipAssertTag(526424278,3016,!1):z.ULS.shipAssertTag(521184640,3016,!1),this.ed.raiseEvent("OnImagesChanged",ha.id)):(z.ULS.shipAssertTag(526424276,3016,!1),this.ed.raiseEvent("OnImagesChanged",null)))}}initialize(){this.isInitialized||(this.isInitialized=!0,this.G1b.register(),this.G1b.MH(this.Toj))}Pd(){this.isInitialized&&
(this.isInitialized=!1,this.G1b.sK(this.Toj),this.G1b.unregister())}XFj(){const e=this.nPf();return e?this.FZb([{id:e.id.toString(),text:e.characterData}]):!0}FZb(e){e=e.filter(t=>{const E=t.id;t=t.text;return t?this.Nzc.has(t)?(this.Xgd.get(E)!==t&&this.Xgd.set(E,t),this.ed.raiseEvent("OnImagesChanged",E),!1):!0:(z.ULS.sendTraceTag(512267554,3016,50,""===t?"DesignerTextToImageManager.RequestImages - paragraphText is empty":"DesignerTextToImageManager.RequestImages - paragraphText is null"),this.ed.raiseEvent("OnImagesChanged",
E),!1)});if(!e.length)return!0;e.forEach(t=>{this.Xgd.set(t.id,t.text);this.Nzc.set(t.text,null)});this.nPo(e);return!1}Agf(e){this.ed.addHandler("OnImagesChanged",e)}WDj(e){this.ed.removeHandler("OnImagesChanged",e)}nPf(){var e;const t=Xf.ParagraphReader.Zl(this.sc.jd);return null===t||void 0===t||!t.characterData||t.YH?null:2===(null===(e=this.Rm.YB(t))||void 0===e?void 0:e.role)||this.Rm.R_f(t)&&this.Vb.Ae(this.Vb.Eq(t))===Zj.StyleReader.KAb?t:null}Oum(){return Xf.ParagraphReader.Gv(this.sc.jd,
!1,!1,!1).toArray().filter(e=>{var t;const E=null===(t=this.Rm.YB(e))||void 0===t?void 0:t.role;return Object(tl.b)(E)||this.Rm.R_f(e)&&this.Vb.Ae(this.Vb.Eq(e))===Zj.StyleReader.wordStyleIdHeader?!0:!1})}Wvm(){return this.Nzc.get(this.Nzc.keys().next().value)}getImages(e){e=this.Xgd.get(e);return this.Nzc.get(e)}nPo(e){e=e.map(t=>({id:t.id,body:new Dm.TextToImageSignal({content:t.text})}));this.G1b.m_l(e,Dm.TextToImageSignal.getTypeName())}qEm(e){let t="";e&&(e=e.split("\\",3),3<=e.length&&(t=e[2]));
e=this.Xgd.get(t);return{id:t,text:e}}}Object(y.a)(ur,"DesignerTextToImageManagerImpl",null,[1275]);class tq{constructor(e){this.sa=new ua.a;this.B9g=this.woh=this.ui=!1;this.tu=e}get ehn(){return this.woh}get sUh(){return this.B9g}h0k(e){this.sa.addHandler("LicenseStateChanged",e)}E_k(e){this.sa.addHandler("PQLicenseStateChanged",e)}hAo(e){this.sa.removeHandler("PQLicenseStateChanged",e)}initialize(){this.ui||(this.tu.execute(e=>{e.isFeatureEnabled(Df.a.dDf,Df.a.a7i).then(t=>{t?e.getFeatureTier(Df.a.dDf,
0).then(E=>{E=[Object.assign(new yi.a,{name:"tier",int64:E})];ma.a(Df.a.xGp,!0,0,E)}):ma.a(Df.a.zGp);this.r9j(t);return null});e.hva(Df.a.dDf,t=>{this.r9j(t.isEnabled)});e.isFeatureEnabled(Df.a.Iwj,Df.a.a7i).then(t=>{this.t8j(t);return null});e.hva(Df.a.Iwj,t=>{this.t8j(t.isEnabled)})}),this.ui=!0)}Pd(){}r9j(e){this.woh=e;this.sa.raiseEvent("LicenseStateChanged",new le.a(e))}t8j(e){this.B9g=e;this.sa.raiseEvent("PQLicenseStateChanged",new le.a(e))}}Object(y.a)(tq,"LicenseManager",null,[1276,511]);
class wy{constructor(e,t){this.Dg=e;this.sc=t}initialize(){const e=this.Dg.Fea(this.sc.jd);z.ULS.sendTraceTag(541701569,3016,50,`isDocumentEmpty=${e}`)}Pd(){}}Object(y.a)(wy,"BlankDocumentLogger",null,[1274]);class aj{constructor(e,t,E){this.c3=e;this.Bsa=t;this.K4=E;this.cef=!1;this.tbb=null;this.xfa=0;this.Ete=!1;this.Rdg=(W,ha)=>{try{if(ha.data.operationType===sh.a.getTypeName()){if(!this.Ete){const Ka=[Object.assign(new yi.a,{name:Df.a.vqg,string:"PaneInconsistencies"})];ma.a(Df.a.uqg,!0,Date.now()-
this.xfa,Ka);this.Ete=!0}if(this.tbb){let Ka;(Ka=this.tbb).interval=Ka.interval+Df.a.C6h}else this.cef||(this.tbb=new kh.a(3,1,Df.a.C6h,()=>{this.Gie();this.tbb=null}),vh.a.instance.Zb(this.tbb))}}catch(Ka){z.ULS.shipAssertTag(575930784,3016,!1,String.format("{0} {1}",Ka.message,Ka.stack))}};this.Ipe=(W,ha)=>{ha.data&&this.xfa&&ma.a(Df.a.k8n,!0,Date.now()-this.xfa)}}initialize(){this.xfa=Date.now();this.Ete=!1;this.c3.MH(this.Rdg);this.K4.Dgf(this.Ipe)}Pd(){this.c3.sK(this.Rdg);this.K4.YDj(this.Ipe);
this.Ete=!0;this.xfa=0}Gie(){try{this.cef||this.Bsa.vjc().then(e=>{z.ULS.sendTraceTag(575930781,3016,50,"Consistency fix actions: {0}",e.count);ma.a(Df.a.flk,!0,void 0,[Object.assign(new yi.a,{name:"FormattingSuggestionsCount",int64:e.count})]);const t={};for(const E of e){e=E.content;for(const W of e.suggestions)t[W.type.toString()]=W.type.toString()in t?t[W.type.toString()]+1:1}z.ULS.sendTraceTag(575930782,3016,50,"Consistency fix actions: {0} ",JSON.stringify(t));this.cef=!0;this.tbb=null;this.c3.sK(this.Rdg)})}catch(e){z.ULS.shipAssertTag(575930783,
3016,!1,String.format("{0} {1}",e.message,e.stack))}}}Object(y.a)(aj,"ConsistencyFixActionsLogger",null,[1273,511]);class hm{constructor(e){this.sL=e;this.gfh=this.ui=!1;this.vvb=(t,E)=>{E.data.operationType===sh.a.getTypeName()&&(E.data.annotation?E.data.annotation.annotationType!==hf.DocumentRoleDetectionAnnotation.getTypeName()?z.ULS.shipAssertTag(544035804,3016,!1):(t=E.data.annotation.content,t)?t.errorCode||(z.ULS.sendTraceTag(575248462,3016,50,"Document confidence: {0}",t.isTarget?1:0),z.ULS.sendTraceTag(544012318,
3016,50,"Is well-formatted document: {0}",t.isWellFormatted?1:0),t=[Object.assign(new yi.a,{name:Df.a.kXl,double:t.isTarget?1:0}),Object.assign(new yi.a,{name:Df.a.lXl,double:t.isWellFormatted?1:0})],ma.a(Df.a.jXl,!0,void 0,t),this.gfh=!0,this.Pd()):z.ULS.shipAssertTag(544035805,3016,!1):z.ULS.shipAssertTag(544035803,3016,!1))}}initialize(){this.ui||this.gfh||(this.sL.MH(this.vvb),this.ui=!0)}Pd(){this.ui&&(this.sL.sK(this.vvb),this.ui=!1)}}Object(y.a)(hm,"DocumentRoleDetectionLogger",null,[1272,
511]);class Vl{constructor(e=null,t,E){this.LD=e;this.aPg=t;this.$d=E;this.wZd=0}PEn(){0===this.$d.Wmg()&&this.LD&&0<this.wZd&&(this.LD.execute(e=>{for(let t=0;t<Math.min(this.wZd,Df.a.aKn);t++)e.logActivity(Df.a.Vmg,null)}),this.wZd=0)}qkd(){0===this.$d.Wmg()?this.wZd++:this.LD&&this.LD.execute(e=>{this.aPg.setTimeout(()=>{e.logActivity(Df.a.Vmg,null);2===this.$d.Wmg()&&e.logActivity(Df.a.Vmg,null)},Df.a.ago)})}}Object(y.a)(Vl,"ProactiveSurveyEventLogger",null,[1269]);var fl=d(1884),Lq=d(1545),Hm=
d(2175),Ng=d(38),Xm=d(121),Nl=d(757),tp=d(1801),vi=d(131);class ko extends Lq.a{constructor(e,t,E,W){super();this.Zoa=e;this.Yn=t;this.XQe=E;this.Ifh=W;this.fpk=[Df.a.dlf,Df.a.elf]}get Ufa(){return this.Zoa.isEnabled()}get Yrb(){return 3}get k$a(){return null!=this.xYg?this.xYg:this.xYg=[new Hm.a(Ng.a.ack,null),new Hm.a(Ng.a.fPg,null)]}bNa(e,t){const E=this.Gq.vJa;var W=this.Gq.dbd;if(E)if(3===E.type){if(E.dM&&(W=E.dM,this.Y2h(W.aUc),1===E.action&&W.jt.includes(e))){e=t.Nh.querySelectorAll("*");for(let ha=
0,Ka=e.length;ha<Ka;ha++)this.Ifh(e[ha],Ng.a.fPg);return}(W=E.ZB)&&W.jt.includes(e)&&(W.jt[0]===e&&this.bRo(W.aUc,E.action),this.qyb(t.Nh,E.action,e))}else W&&3===W.type&&3===E.action&&W.ZB.jt.includes(e)&&this.qyb(t.Nh,0,e)}TXa(e){return Object(ak.a)(tp.a,e)}E9a(e,t){(e=Object(Ne.a)(tp.a,e))&&e.jt.forEach(E=>{t.add(E)})}qyb(e,t,E){if(2===t||!t){e=e.querySelectorAll("*");t=2===t?Ng.a.ack:Ng.a.fPg;for(let W=0,ha=e.length;W<ha;W++){const Ka=e[W];1===Nl.a(Ka)&&this.hpl(E,Ka)&&this.XQe(Ka,t)}}}hpl(e,
t){var E=this.Yn.G3c(Zd.a.create(e),1);if(!E||!E.count)return!0;e=E.J(0).Fc;E=E.J(0).end;const W=vi.a.Eb(t,Xm.a.ska);t=vi.a.Eb(t,Xm.a.Dua);return Math.max(e,W)<Math.min(E,t)}bRo(e,t){switch(t){case 4:case 1:case 3:this.Y2h(e);break;case 0:this.XQe(e,Df.a.elf);break;case 2:this.XQe(e,Df.a.dlf)}}Y2h(e){for(const t of this.fpk)this.Ifh(e,t)}}Object(y.a)(ko,"HighlightActor",Lq.a,[]);var ks=d(1131);class Qp{constructor(e,t){this.s2e=this.psh=this.tQ=null;this.jb=e;this.J$=t}get key(){return"DESIGNER REVIEW"}get Av(){return WordEditorIntl.WordEditorStrings.L_DesignerReview}reset(e){this.jb.Xb(e.node)?
this.tQ=e.node:this.tQ=null}$Ea(){let e=null;if(!this.tQ)return{returnValue:!1,zG:e};if(this.psh!==this.tQ){const t=this.J$.YB(this.tQ);this.s2e=t.Ula?t:null;this.psh=this.tQ}if(!this.s2e)return{returnValue:!1,zG:e};e=Object.assign(new ks.a,{UF:this.key,contentObject:this.s2e,description:Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress});return{returnValue:!0,zG:e}}}Object(y.a)(Qp,"ReviewDetailsProvider",null,[405,406]);class Xg{constructor(e,t,E,W,ha,Ka,sb,dc){this.bCa=e;this.Gq=t;this.gLa=
E;this.BWh=W;this.AHj=ha;this.Udf=Ka;this.Dg=sb;this.Rm=dc}initialize(){this.Gq.idb(this.gLa);this.bCa.QZa(this.BWh);this.AHj.initialize();this.Udf.execute(e=>{e.kY(new Qp(this.Dg,this.Rm))})}Pd(){this.Gq.qLg(this.gLa);this.bCa.NEe(this.BWh);this.AHj.Pd()}}Object(y.a)(Xg,"OnCanvasInitializer",null,[511]);class wo{constructor(e,t,E){this.ui=!1;this.o8=(W,ha)=>{if(ha&&ha.Gm&&ha.Gm.currentSelection&&ha.Gm.currentSelection.Ra&&ha.Gm.currentSelection.Ra.node){W=ha.Gm.currentSelection;var Ka=W.Ra.node;
1!==ha.iz&&ha.iz||!df.SelectionEditor.Dm(W)||!this.ALk.O$c(Ka)?this.v$g.wrl():this.v$g.ZTo(Ka)}};this.v$g=e;this.hb=t;this.ALk=E}initialize(){this.ui||(this.hb.Cw(this.o8),this.ui=!0)}Pd(){}}Object(y.a)(wo,"ReviewSelectionManager",null,[511]);var Le=d(109),Ht=d(159),up=d(333);const Uk=e=>0>e.indexOf(",")?Ht.FontUtils.vSc(e,Ht.FontUtils.$za(e)):e,It=e=>{e=Ht.FontUtils.e3c(e).returnValue;return e.startsWith("'")||e.startsWith('"')?e.slice(1,-1):e},vr=[WordRibbonStrings.DesignerStyleFontAvenirNextDemiBold,
WordRibbonStrings.DesignerStyleFontAvenir,WordRibbonStrings.DesignerStyleFontCentury,WordRibbonStrings.DesignerStyleFontSitka,WordRibbonStrings.DesignerStyleFontWalbaum,WordRibbonStrings.DesignerStyleFontRockwellNova,WordRibbonStrings.DesignerStyleFontUnivers,WordRibbonStrings.DesignerStyleFontSagonaBook,WordRibbonStrings.DesignerStyleFontSagona,WordRibbonStrings.DesignerStyleFontFranklin,WordRibbonStrings.DesignerStyleFontPerpetua,WordRibbonStrings.DesignerStyleFontAmasisMTPro,WordRibbonStrings.DesignerStyleFontSabonNextLT,
WordRibbonStrings.DesignerStyleFontTradeGothicNext,WordRibbonStrings.DesignerStyleFontCooperBlack,WordRibbonStrings.DesignerStyleFontNeueHaasGroteskTextPro,WordRibbonStrings.DesignerStyleFontTisaOffcSerifPro,WordRibbonStrings.DesignerStyleFontQuireSans,WordRibbonStrings.DesignerStyleFontGillSansNova,WordRibbonStrings.DesignerStyleFontTheHand,WordRibbonStrings.DesignerStyleFontGoudyType,WordRibbonStrings.DesignerStyleFontPlantagenetCherokee,WordRibbonStrings.DesignerStyleFontFootlightMTLight,WordRibbonStrings.DesignerStyleFontBaskervilleOldFace,
WordRibbonStrings.DesignerStyleFontLucidaCalligraphy,WordRibbonStrings.DesignerStyleFontEbrima,WordRibbonStrings.DesignerStyleFontCorbel,WordRibbonStrings.DesignerStyleFontElephantPro,WordRibbonStrings.DesignerStyleFontDaytona,WordRibbonStrings.DesignerStyleFontBierstadt,WordRibbonStrings.DesignerStyleFontSitkaBanner,WordRibbonStrings.DesignerStyleFontGrandview,WordRibbonStrings.DesignerStyleFontSkeenaDisplay,WordRibbonStrings.DesignerStyleFontTenorite,WordRibbonStrings.DesignerStyleFontGadugi,WordRibbonStrings.DesignerStyleFontSeaford,
WordRibbonStrings.DesignerStyleFontWalbaumDisplay,WordRibbonStrings.DesignerStyleFontAgencyFB,WordRibbonStrings.DesignerStyleFontAharoni,WordRibbonStrings.DesignerStyleFontArial,WordRibbonStrings.DesignerStyleFontArialNova,WordRibbonStrings.DesignerStyleFontArialNovaBold,WordRibbonStrings.DesignerStyleFontArialNovaCondBold,WordRibbonStrings.DesignerStyleFontAvenirNextLTProBold,WordRibbonStrings.DesignerStyleFontAvenirNextLTProDemi,WordRibbonStrings.DesignerStyleFontBaguetScript,WordRibbonStrings.DesignerStyleFontBaguetScriptRegular,
WordRibbonStrings.DesignerStyleFontBahnschrifr,WordRibbonStrings.DesignerStyleFontBahnschrift,WordRibbonStrings.DesignerStyleFontBierstadtRegular,WordRibbonStrings.DesignerStyleFontBiome,WordRibbonStrings.DesignerStyleFontBodoniMT,WordRibbonStrings.DesignerStyleFontBritannic,WordRibbonStrings.DesignerStyleFontCalibri,WordRibbonStrings.DesignerStyleFontCalistoMT,WordRibbonStrings.DesignerStyleFontCavolini,WordRibbonStrings.DesignerStyleFontDubai,WordRibbonStrings.DesignerStyleFontElephantProRegular,
WordRibbonStrings.DesignerStyleFontErasBoldITC,WordRibbonStrings.DesignerStyleFontGeorgia,WordRibbonStrings.DesignerStyleFontGeorgiaPro,WordRibbonStrings.DesignerStyleFontJumble,WordRibbonStrings.DesignerStyleFontMVBoli,WordRibbonStrings.DesignerStyleFontNewsGothicMT,WordRibbonStrings.DesignerStyleFontPerpetuaBoldItalic,WordRibbonStrings.DesignerStyleFontPerpetuaItalic,WordRibbonStrings.DesignerStyleFontRastantyCortez,WordRibbonStrings.DesignerStyleFontSegoe,WordRibbonStrings.DesignerStyleFontSegoeScript,
WordRibbonStrings.DesignerStyleFontSegoeUI,WordRibbonStrings.DesignerStyleFontSegoeUIBold,WordRibbonStrings.DesignerStyleFontSitkaHeading,WordRibbonStrings.DesignerStyleFontSitkaText,WordRibbonStrings.DesignerStyleFontTenoriteBold,WordRibbonStrings.DesignerStyleFontTenoriteRegular,WordRibbonStrings.DesignerStyleFontTradeGothic,WordRibbonStrings.DesignerStyleFontTradeGothicInline,WordRibbonStrings.DesignerStyleFontVijaya,WordRibbonStrings.DesignerStyleFontWideLatin,WordRibbonStrings.DesignerStyleFontNordiqueInlineRegular];
class uq{constructor(e,t){this.vr=e;this.title=t}}Object(y.a)(uq,"TriageOption",null,[]);class Po extends uq{constructor(e,t,E,W,ha,Ka,sb,dc,xc){super(e,t);this.fontSize=W;this.color=ha;this.bold=Ka;this.italic=sb;this.underline=dc;this.backgroundImg=xc;this.font=Uk(E)}}Object(y.a)(Po,"FormattedRangeTriageOption",uq,[]);class Gs extends Po{constructor(e,t,E,W,ha,Ka,sb,dc,xc){super(0,t,E,W,ha,Ka,sb,dc,xc);this.role=e}}Object(y.a)(Gs,"RoleTriageOption",Po,[]);class tx extends Po{constructor(e,t,E,W,
ha,Ka,sb,dc,xc){super(1,t,E,W,ha,Ka,sb,dc,xc);this.Wcb=e}}Object(y.a)(tx,"PullQuoteTriageOption",Po,[]);class bu extends uq{constructor(e,t,E){super(2,void 0);this.imageUrl=e;this.altText=t;this.kta=E}}Object(y.a)(bu,"ImageTriageOption",uq,[]);class wr{constructor(e,t,E,W){this.Etc=e;this.K8n=t;this.Vb=E;this.$d=W}XCm(e){if(!e)return z.ULS.shipAssertTag(574424853,3016,!1),this.kJf(1,WordEditorIntl.WordEditorStrings.L_OriginalOptionTitle);let t=null;return({sWj:t}=this.K8n.bEe(e.id)).returnValue?new Gs(1,
WordEditorIntl.WordEditorStrings.L_OriginalOptionTitle,this.Etc.getPropertyValue(t,Tb.a.font,Le.a.RJ),Math.min(this.Bsf(this.Etc.getPropertyValue(t,Tb.a.fontSize,Df.a.twf)),wr.qKn),Ok.a.VC(this.Etc.getPropertyValue(t,Tb.a.fontColor,Ok.a.Ggc.dgb)),this.Etc.getPropertyValue(t,Tb.a.bold,!1),this.Etc.getPropertyValue(t,Tb.a.italic,!1),this.Etc.getPropertyValue(t,Tb.a.underline,!1),null):(z.ULS.sendTraceTag(512276631,3016,50,"No formatting information for paragraph. Showing Title style in the triage menu."),
this.kJf(1,WordEditorIntl.WordEditorStrings.L_OriginalOptionTitle))}kPm(e,t){const E=this.Vb.ko(),W=E.gh(tl.j(e));if(!W){if(14===e&&this.$d.Bta()&&(z.ULS.sendTraceTag(541446534,3018,15,"No Caption style in the document."),t=this.hPm(E.gh(tl.j(13)),t),null!=t))return t;z.ULS.shipAssertTag(574424855,3016,!1);return this.kJf(e)}return new Gs(e,W.ja(gb.a.nZa,tl.k(e)),W.ja(Tb.a.font,Le.a.RJ),t,Ok.a.VC(W.ja(Tb.a.fontColor,Ok.a.Ggc.dgb)),W.ja(Tb.a.bold,!1),W.ja(Tb.a.italic,!1),W.ja(Tb.a.underline,!1),null)}jPm(e,
t){let E=Le.a.RJ,W=Ok.a.VC(Ok.a.Ggc.dgb),ha=!1,Ka="";switch(e){case 0:W="#201f1e";Ka="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="175" height="42" rx="2" fill="none"/><line x1="5" y1="4" x2="169" y2="4.00001" stroke="#EA6B14" stroke-width="2"/></svg>');break;case 1:W="#ffffff";E="Helvetica Neue";ha=!0;Ka="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="4" width="160" height="37" fill="#5066DB"/><path d="M151 24V28.3178H152.859C152.859 29.0093 152.727 29.5981 152.464 30.0841C152.202 30.5514 151.713 30.9065 151 31.1495V33C151.582 32.9252 152.117 32.757 152.605 32.4953C153.112 32.215 153.544 31.8692 153.901 31.4579C154.257 31.0467 154.53 30.5701 154.717 30.028C154.924 29.486 155.018 28.9065 154.999 28.2897V24H151ZM156.999 14V28.3178H158.857C158.857 29.0093 158.726 29.5981 158.463 30.0841C158.2 30.5514 157.712 30.9065 156.999 31.1495V33C157.581 32.9252 158.116 32.757 158.604 32.4953C159.111 32.215 159.543 31.8692 159.899 31.4579C160.256 31.0467 160.528 30.5701 160.716 30.028C160.923 29.486 161.016 28.9065 160.998 28.2897V24H156.999Z" fill="white"/><rect x="5.6" y="0.6" width="158.8" height="35.8" stroke="black" stroke-width="1.2"/></svg>');
break;case 2:W="#007fac";E="SF Pro Display";Ka="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="6" y="3" width="162" height="34" fill="#EAEFF6"/><path d="M162 37H168V3H6V37H87H107.25H147.5" stroke="#007FAC" stroke-width="2"/><path d="M155.998 33V37.3178H157.857C157.857 38.0093 157.726 38.5888 157.463 39.0561C157.2 39.5421 156.712 39.9065 155.998 40.1495V42C156.58 41.9252 157.125 41.7477 157.632 41.4673C158.12 41.2056 158.542 40.8692 158.899 40.4579C159.256 40.0467 159.537 39.5701 159.744 39.028C159.932 38.486 160.016 37.9065 159.997 37.2897V33H155.998ZM150 33V37.3178H151.859C151.859 38.0093 151.727 38.5888 151.464 39.0561C151.202 39.5421 150.713 39.9065 150 40.1495V42C150.582 41.9252 151.126 41.7477 151.633 41.4673C152.122 41.2056 152.544 40.8692 152.901 40.4579C153.257 40.0467 153.539 39.5701 153.746 39.028C153.933 38.486 154.018 37.9065 153.999 37.2897V33H150Z" fill="#007FAC"/></svg>');
break;case 3:W="#3865a8";E="Avenir";Ka="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><svg x="0" y="2"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 0C5.89543 0 5 0.895431 5 2V25C5 36.1046 5.89543 37 7 37H83.0061C83.1025 37.2646 83.2556 37.5127 83.4655 37.7252L85.8929 40.1821C86.6692 40.9679 87.9278 40.9679 88.7041 40.1821L91.1314 37.7252C91.3413 37.5127 91.4945 37.2646 91.5909 37H167C168.105 37 169 36.1046 169 35V2C169 0.895431 168.105 0 167 0H7Z" fill="#E9EBF4"/></svg></svg>');
break;case 4:W="#201f1e",Ka="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="3" width="2" height="6" fill="#548235"/><rect x="5" y="5" width="2" height="6" transform="rotate(-90 5 5)" fill="#548235"/><rect x="-5" y="29" width="2" height="6" transform="rotate(-90 5 29)" fill="#548235"/><rect x="7" y="19" width="2" height="6" transform="rotate(180 7 29)" fill="#548235"/><rect x="169" y="19" width="2" height="6" transform="rotate(-180 169 29)" fill="#548235"/><rect x="179" y="27" width="2" height="6" transform="rotate(90 169 27)" fill="#548235"/><rect x="169" y="3" width="2" height="6" transform="rotate(90 169 3)" fill="#548235"/><rect x="167" y="3" width="2" height="6" fill="#548235"/></svg>')}return new tx(e,
t,E,this.Bsf(Df.a.twf),W,ha,!1,!1,Ka)}iPm(e,t){return new bu(null===e||void 0===e?void 0:e.jPf(t),null===e||void 0===e?void 0:e.O_(t),t)}kJf(e,t=null){return new Gs(e,t||tl.k(e),Le.a.RJ,this.Bsf(Df.a.twf),Ok.a.VC(Ok.a.Ggc.dgb),!1,!1,!1,null)}hPm(e,t){return null==e?null:new Gs(14,tl.k(14),e.ja(Tb.a.font,Le.a.RJ),t,Ok.a.VC(e.ja(Tb.a.fontColor,Ok.a.Ggc.dgb)),!1,!0,!1,null)}Bsf(e){return e/2}}wr.qKn=25;Object(y.a)(wr,"TriageOptionFactory",null,[1271]);class on{constructor(e,t){this.options=e;this.selectedIndex=
t}}Object(y.a)(on,"TriageOptions",null,[]);class Pr{constructor(e,t,E,W){this.Rm=e;this.PDe=t;this.$d=E;this.tK=W}QCm(e){var t;if(!e)return z.ULS.shipAssertTag(574424851,3016,!1),null;const E=null===(t=this.tK.lX(e))||void 0===t?void 0:t.suggestion;t=this.Rm.YB(e);return Object(Ha.e)(E)?this.mHm(E):2===(null===E||void 0===E?void 0:E.vr)?this.Svm(E):this.gpm(e,t)}gpm(e,t){const E=Pr.lPm(t.role,this.$d.Bta()),W=Array(E.count-9+Math.max(3,this.Rm.tTf+1)+1);W[Pr.original]=this.PDe.XCm(e);e=Pr.original;
let ha=1;for(let Ka=0;Ka<E.count;Ka++){const sb=E.J(Ka);if(this.P2o(sb)){ha--;continue}const dc=Ka+ha;sb.role===t.role&&(e=dc);W[dc]=this.PDe.kPm(sb.role,sb.eL)}return new on(W,e)}mHm(e){const t=Pr.nHm();let E,W=Pr.original;E=Array(t.count);for(let ha=0;ha<t.count;ha++){const Ka=t.J(ha);Ka.eL==e.Wcb&&(W=ha);E[ha]=this.PDe.jPm(Ka.eL,e.Hid)}return new on(E,W)}Svm(e){let t;t=Array(e.Vyc);for(let E=0;E<e.Vyc;E++)t[E]=this.PDe.iPm(e,E);return new on(t,e.selectedIndex)}IJm(e,t){var E;if(!e)return z.ULS.shipAssertTag(572301728,
3016,!1),Pr.original;if(!t)return z.ULS.shipAssertTag(572301729,3016,!1),Pr.original;const W=null===(E=this.tK.lX(t))||void 0===E?void 0:E.suggestion;if(Object(Ha.e)(W))return W.Wcb;if(2===(null===W||void 0===W?void 0:W.vr))return W.selectedIndex;if(0===(null===W||void 0===W?void 0:W.vr))for(t=this.Rm.YB(t),E=0;E<e.length;E++)if(0!==e[E].vr)z.ULS.shipAssertTag(527569926,3016,!1,`${e[E].vr}`);else if(e[E].role===t.role)return E;return Pr.original}P2o(e){return 6<e.role&&12>=e.role&&4+this.Rm.tTf<e.role}static lPm(e,
t=!1){const E=new fa.a;E.add({role:13,eL:12});E.add({role:4,eL:19});E.add({role:5,eL:18});E.add({role:6,eL:17});E.add({role:7,eL:16});E.add({role:8,eL:15});E.add({role:9,eL:14});E.add({role:10,eL:13});E.add({role:11,eL:12});E.add({role:12,eL:12});E.add({role:2,eL:25});E.add({role:3,eL:19});t&&E.insert(Pr.dml,{role:14,eL:11});15===e&&E.insert(Pr.pzn,{role:15,eL:12});return E}static nHm(){const e=new fa.a;e.add({role:27,eL:0});e.add({role:27,eL:1});e.add({role:27,eL:2});e.add({role:27,eL:3});e.add({role:27,
eL:4});return e}}Pr.original=0;Pr.dml=1;Pr.pzn=4;Object(y.a)(Pr,"TriageOptionProvider",null,[1270]);class sz extends Se.a{constructor(e){super("FormattingSuggestionsReadyConditionId");this.sL=e;this.ofg=(t,E)=>{E.data.operationType===sh.a.getTypeName()&&E.data.annotation&&E.data.annotation.annotationType===xb.FormattingSuggestionsSummaryAnnotation.getTypeName()&&(t=E.data.annotation.content)&&!t.errorCode&&(this.Jg(!0),this.sL.sK(this.ofg))}}initialize(){super.initialize();this.sL.MH(this.ofg)}Pd(){this.sL.sK(this.ofg);
super.Pd()}}Object(y.a)(sz,"FormattingSuggestionsReadyCondition",Se.a,[]);class ux extends Se.a{constructor(e){super("RoleDetectionReadyCondition");this.sL=e;this.bhg=(t,E)=>{E.data.operationType===sh.a.getTypeName()&&E.data.annotation&&E.data.annotation.annotationType===hf.DocumentRoleDetectionAnnotation.getTypeName()&&(t=E.data.annotation.content)&&!t.errorCode&&(this.Jg(!0),this.sL.sK(this.bhg))}}initialize(){super.initialize();this.sL.MH(this.bhg)}Pd(){this.sL.sK(this.bhg);super.Pd()}}Object(y.a)(ux,
"RoleDetectionReadyCondition",Se.a,[]);class tz extends Se.a{constructor(e){super("ThemeGeneratorReadyCondition");this.O4=e;this.Ahg=(t,E)=>{E.data.operationType===sh.a.getTypeName()&&E.data.annotation&&E.data.annotation.annotationType===lp.ThemeGeneratorAnnotation.getTypeName()&&E.data.annotation.content&&(this.Jg(!0),this.O4.sK(this.Ahg))}}initialize(){super.initialize();this.O4.MH(this.Ahg)}Pd(){this.O4.sK(this.Ahg);super.Pd()}}Object(y.a)(tz,"ThemeGeneratorReadyCondition",Se.a,[]);var Fu=d(184);
class Cw{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc){this.Wu=e;this.OJa=t;this.K4=E;this.Qaa=W;this.focusManager=ha;this.I_j=Ka;this.aLg=sb;this.CWc=dc;this.hYa=xc;this.bgo=Rc;this.iFd=this.Wt=this.ui=!1;this.wbc=0;this.Wio=(md,ud)=>{ud?ud.data?this.Htd(ud.data):z.ULS.shipAssertTag(556373976,3016,!1):z.ULS.shipAssertTag(556373975,3016,!1)};this.iqg=()=>{this.G_a(!0);this.iFd||this.Ica();this.Wu.Ie()};this.hqg=()=>{this.CWc.Gie();this.CWc.Pd();this.bgo.PEn();this.G_a(!1);this.sha();this.Wu.Ie();ma.c(Fa.a.utl,
void 0,void 0,void 0,12)}}get isVisible(){return this.Wt}get Tm(){return this.wbc}G_a(e){e!==this.Wt&&(this.Wt=e,this.K4.Bmo(this.Wt))}show(e=0){this.isVisible?this.Ica():(this.K4.zmo(),this.initialize(),this.Qaa.H4d(),this.iFd=!!e,this.wbc=e,this.YDg())}hide(){this.aLg().then(e=>{e.hideTaskPane(Df.a.wS,Df.a.taskPaneLocation);return null})}initialize(){this.ui||(this.OJa.c2k(this.Wio),this.H2(),this.Ina(),this.ui=!0)}H2(){this.I_j.NUa();this.I_j.ggc(this.focusManager)}Ina(){const e=this.focusManager.ge(Df.a.wS);
e.parent=Fu.AFrame.mq;e.bindAction(Un.KeyInputManager.sI(Box4Intl.Box4Strings.l_HK_Undo),wb.a.undo);e.bindAction(Un.KeyInputManager.sI(Box4Intl.Box4Strings.l_HK_Redo),wb.a.fna)}Ica(){this.focusManager.Bg(Df.a.wS)}sha(){this.focusManager.Bg(Fu.AFrame.Ho)}YDg(){const e=this.OJa.pla();e.isPaneAutoOpened=this.iFd;e.Tm=this.wbc;this.aLg().then(t=>{t.showTaskPane(Df.a.wS,this.MB(e));return null})}Htd(e){this.isVisible&&this.aLg().then(t=>{t.updateTaskPane(Df.a.wS,this.MB(e));return null})}MB(e){return Object.assign(new ig.a,
{title:this.hYa.ehn?WordEditorIntl.WordEditorStrings.L_Designer:String.format("{0} ({1})",WordEditorIntl.WordEditorStrings.L_Designer,WordEditorIntl.WordEditorStrings.L_Preview),hideHeader:!1,width:Df.a.taskPaneWidth,location:Df.a.taskPaneLocation,contentProps:e,onOpen:this.iqg,onClose:this.hqg,enableResize:!1,isModernPane:!0,isPaneAutoOpened:this.iFd,Tm:this.wbc})}}Object(y.a)(Cw,"DesignerTaskPane",null,[1267]);class Ym{constructor(){this.sa=new ua.a}Rcc(e){this.sa.addHandler("OnVisibilityChanged",
e)}dEj(e){this.sa.removeHandler("OnVisibilityChanged",e)}Dgf(e){this.sa.addHandler("OnLoadingStateChanged",e)}YDj(e){this.sa.removeHandler("OnLoadingStateChanged",e)}PPh(e){this.sa.addHandler("OnBeforeOpen",e)}Bmo(e){this.sa.raiseEvent("OnVisibilityChanged",new le.a(e))}Amo(e){this.sa.raiseEvent("OnLoadingStateChanged",new le.a(e))}zmo(){this.sa.raiseEvent("OnBeforeOpen",new Sys.EventArgs)}}Object(y.a)(Ym,"DesignerTaskPaneEvents",null,[1265,1266]);class vq{constructor(e,t){this.K4=e;this.conditions=
t;this.IEb=this.isInitialized=!1;this.TYa=()=>{this.Y1h()}}initialize(){if(0==this.conditions.count)z.ULS.shipAssertTag(556619356,3016,!1);else if(!this.isInitialized){for(const e of this.conditions)e.initialize(),e.IRd(this.TYa);this.isInitialized=!0;this.Y1h()}}Pd(){if(this.isInitialized){for(const e of this.conditions)e.zue(this.TYa),e.Pd();this.isInitialized=!1}}get Toc(){return this.IEb}ZQj(e){this.IEb!==e&&(this.IEb=e,this.K4.Amo(this.IEb))}Y1h(){for(const e of this.conditions)if(!e.cma){this.ZQj(!1);
return}this.ZQj(!0)}}Object(y.a)(vq,"PaneLoadingManager",null,[1264]);class uz{constructor(e,t){this.ii=!1;this.cAk=e;this.Xz=t}dispose(){var e;this.ii||(this.Xz.dispose(),null===(e=this.cAk)||void 0===e?void 0:e.dispose(),this.ii=!0)}}Object(y.a)(uz,"DesignerTransaction",null,[1300,13]);class vx{constructor(e,t){this.Pc=e;this.J$=t}Mc(e,t,E=!0){e=this.Pc.Mc(e);e.yi=t;return new uz(E?this.J$.AEo():null,e)}}Object(y.a)(vx,"DesignerTransactionFactory",null,[1263]);class xy{constructor(e,t){this.KQd=
e;this.gid=t}trigger(e,t){t?(z.ULS.sendTraceTag(554742742,3016,50,`DesignerProactiveTriggerManager.triggerDesigner - shouldStart=${t.z4}`),t.z4&&this.gid.ckf(1,()=>{this.KQd.Pb(Fa.a.ePa,2,new Kq.a(t.id))})):z.ULS.shipAssertTag(521172809,3016,!1)}}Object(y.a)(xy,"OpenDesignerPaneTriggerAction",null,[1268]);class yy{constructor(e,t,E){this.RQd=e;this.uef=t;this.Tm=E}}Object(y.a)(yy,"TeachingCalloutButtonEventAction",null,[]);class wx{constructor(e,t,...E){this.zY=e;this.UHg=t;this.c3j=W=>{for(const ha of this.OYh)(null===
W||void 0===W?void 0:W.type)===ha.RQd&&ha.uef&&(z.ULS.sendTraceTag(520127499,3016,50,`TeachingCalloutTriggerAction.triggerTeachingActivityEventAction - buttonAction=${ha.uef}`),ma.a(ha.RQd),ha.uef.trigger(this,{id:ha.Tm,z4:!0}),window.removeEventListener(ha.RQd,this.c3j,!0))};if(E){this.OYh=E;for(const W of this.OYh)window.addEventListener(W.RQd,this.c3j,!0)}}trigger(e,t){t?(z.ULS.sendTraceTag(521172628,3016,50,`TeachingCalloutTriggerAction.trigger - shouldStart=${t.z4}`),t.z4&&this.zY&&this.UHg&&
(ma.a(this.UHg),this.zY.execute(E=>{E.logActivity(this.UHg,null)}))):z.ULS.shipAssertTag(521172808,3016,!1)}}Object(y.a)(wx,"TeachingCalloutTriggerAction",null,[1268]);class ik extends nt.a{constructor(e,t,E,W){super(e,t,E,3016,"OnTriggerImageSuggestionEventKey");this.FGj=W}$9a(e){super.$9a(e);super.qSd()&&super.Erb(this.FGj)}Erb(e){super.Erb(e);this.iEa(!1);super.Erb(this.FGj)}iEa(e=!0){var t;super.iEa(e&&!(null===(t=this.wqa)||void 0===t?0:t.T8()))}}Object(y.a)(ik,"AutoResetSequentialTriggerModel",
nt.a,[]);class Hs extends Se.a{constructor(e){super(Df.a.A_d);this.JJ=e}initialize(){super.initialize();this.iSh=this.JJ.Lk(19,()=>{this.Jg(!0)})}Pd(){this.iSh&&this.iSh.hoa(!0);this.VEa&&v.AFrameworkApplication.mc.vf(this.VEa);super.Pd()}}Object(y.a)(Hs,"DesignerAfterApplicationBootCondition",Se.a,[]);class xx extends Se.a{constructor(e){super(Df.a.zRl);this.nei=e}initialize(){super.initialize();0<=this.nei&&(this.VEa=new kh.a(2,1,1E3*this.nei,()=>{this.Jg(!0)}),v.AFrameworkApplication.mc.Zb(this.VEa))}Pd(){this.VEa&&
v.AFrameworkApplication.mc.vf(this.VEa);super.Pd()}}Object(y.a)(xx,"DesignerDelayCondition",Se.a,[]);class Em extends Zo{constructor(e,t,E){super(Df.a.ERl);this.ro=e;this.Mpi=t;this.Bfi=E;this.b4=()=>{this.ro.B2()&&(this.Jg(this.ro.g9c(this.Mpi)===this.Bfi),this.ro.vZb(this.b4))}}initialize(){super.initialize();this.ro.B2()?this.Jg(this.ro.g9c(this.Mpi)===this.Bfi):this.ro.Pcc(this.b4)}Pd(){this.ro.vZb(this.b4);super.Pd()}}Object(y.a)(Em,"DesignerFlagsSettingCondition",Zo,[]);var Hv=d(1074);class vz extends Se.a{constructor(){super(Df.a.xUl)}initialize(){super.initialize();
Object(Hv.a)().then(e=>{this.Jg(!e)}).catch(()=>{this.Jg(!0)})}}Object(y.a)(vz,"DisabledCopilotCondition",Se.a,[]);var Im=d(1163);class wq extends Sys.EventArgs{constructor(e){super();this.documentType=e}}Object(y.a)(wq,"DocumentTypeObtainedEventArgs",Sys.EventArgs,[]);class qm{constructor(){this.ed=new ua.a}M0k(e){this.ed.addHandler("DocumentTypeObtainedEventId",e)}IAo(e){this.ed.removeHandler("DocumentTypeObtainedEventId",e)}Zlo(e){this.ed.raiseEvent("DocumentTypeObtainedEventId",e)}}Object(y.a)(qm,
"DocumentTypeEventSource",null,[]);class Xn extends Zo{constructor(e,t,E,W,ha,Ka=null){super(Df.a.Zhi);this.Tm=e;this.Naa=t;this.x0d=E;this.xJp=W;this.nhp=ha;this.o3f=null;this.lad=this.isInitialized=!1;this.Avb=(sb,dc)=>{if(dc.data.operationType===sh.a.getTypeName()||dc.data.operationType===Va.n.getTypeName())dc.data.annotation?dc.data.annotation.annotationType!==Op.DocumentTypeClassifierAnnotation.getTypeName()?z.ULS.shipAssertTag(573907533,3016,!1):(sb=dc.data.annotation.content)?sb.documentTypeConfidences.length?
(this.o3f=this.Yp(),sb=sb.documentTypeConfidences[0].documentTypeLabel,this.lad=Array.contains(this.nhp,sb),this.x0d.Zlo(new wq(sb)),this.lad&&!this.cma&&z.ULS.sendTraceTag(561309448,3016,50,this.aR(this.Tm,!0)),this.Jg(this.lad)):z.ULS.shipAssertTag(573907535,3016,!1):z.ULS.shipAssertTag(573907534,3016,!1):z.ULS.shipAssertTag(573907532,3016,!1)};this.Yp=Ka?Ka:()=>new Date}get P1o(){return!this.o3f||+this.Yp()-+this.o3f>this.xJp}initialize(){super.initialize();this.isInitialized||(this.Naa.MH(this.Avb),
this.Naa.register(),this.isInitialized=!0);this.P1o?(this.Naa.JAa(new Im.a),z.ULS.sendTraceTag(509874258,3016,50,"DocumentTypeClassifierSignal emitted by the DocumentTypeCondition.")):(this.lad&&z.ULS.sendTraceTag(561109203,3016,50,this.aR(this.Tm,!0)),this.Jg(this.lad))}Pd(){this.isInitialized&&(this.Naa.sK(this.Avb),this.isInitialized=!1);super.Pd()}}Object(y.a)(Xn,"DocumentTypeCondition",Zo,[]);var lo=d(1019);class im extends Se.a{constructor(e,t,E,W,ha=null){super(Df.a.ddm);this.Tm=e;this.Syb=
t;this.JFf=E;this.Jdd=W;this.zsc=(Ka,sb)=>{Ka=this.Syb.Exi();sb.pC===lo.a.l4d&&(sb=Ka.values[lo.a.l4d],Ka=(sb-1)%this.Jdd,this.IFf[Ka]=this.Yp(),sb<this.Jdd||+this.IFf[Ka]-+this.IFf[sb%this.Jdd]>this.JFf||(z.ULS.sendTraceTag(561309447,3016,50,this.aR(this.Tm,!0)),this.Syb.htg(this.zsc),this.Jg(!0)))};this.Yp=ha?ha:()=>new Date;this.IFf=Array(W)}initialize(){super.initialize();this.Syb.YPh(this.zsc)}Pd(){this.Syb.htg(this.zsc);super.Pd()}}Object(y.a)(im,"FormattingActionsCondition",Se.a,[]);class NA extends Se.a{constructor(e,
t,E){super(Df.a.fdm);this.Tm=e;this.Sb=t;this.$d=E;this.Oaa=new Set;this.N5a=0;this.oXd=1}initialize(){super.initialize();this.tVf();this.Sb.P0(this)}Pd(){this.Sb.n2b(this);super.Pd()}l8(){}j8(e){2===e.behavior&&this.Oaa.has(e.actionId)&&(this.N5a+=1,this.N5a===this.oXd&&(z.ULS.sendTraceTag(523351776,3016,50,this.aR(this.Tm,!0)),this.Jg(!0)))}tVf(){switch(this.$d.y0d()){case 2:this.Oaa.add(wb.a.font);this.oXd=1;break;case 3:this.Oaa.add(wb.a.HT);this.oXd=1;break;case 4:this.Oaa.add(wb.a.font),this.Oaa.add(wb.a.oC),
this.Oaa.add(wb.a.p3),this.Oaa.add(wb.a.C4),this.Oaa.add(wb.a.hE),this.Oaa.add(wb.a.bold),this.Oaa.add(wb.a.kA),this.Oaa.add(wb.a.underline),this.Oaa.add(wb.a.strikethrough),this.Oaa.add(wb.a.vY),this.Oaa.add(wb.a.Jca),this.Oaa.add(wb.a.ax),this.Oaa.add(wb.a.Gva),this.oXd=3}}}Object(y.a)(NA,"FormattingChangeCondition",Se.a,[65]);class Kg extends Zo{constructor(e,t,E){super(Df.a.yri);this.Tm=e;this.c3=t;this.r9f=E;this.isInitialized=!1;this.Bvb=(W,ha)=>{ha.data.operationType===sh.a.getTypeName()&&
(ha.data.annotation?ha.data.annotation.annotationType!==xb.FormattingSuggestionsSummaryAnnotation.getTypeName()?(z.ULS.shipAssertTag(574912652,3016,!1),this.Jg(!1)):(W=ha.data.annotation.content)?W.errorCode?this.Jg(!1):((W=W.numberOfSuggestions>=this.r9f)&&!this.cma&&z.ULS.sendTraceTag(561309445,3016,50,this.aR(this.Tm,!0)),this.Jg(W)):(z.ULS.shipAssertTag(574912653,3016,!1),this.Jg(!1)):(z.ULS.shipAssertTag(574912651,3016,!1),this.Jg(!1)))}}initialize(){super.initialize();this.isInitialized||(this.c3.MH(this.Bvb),
this.c3.register(),this.isInitialized=!0)}Pd(){this.isInitialized&&(this.c3.unregister(),this.c3.sK(this.Bvb),this.isInitialized=!1);super.Pd()}}Object(y.a)(Kg,"FormattingSuggestionsCondition",Zo,[]);class ww extends Se.a{constructor(e,t,E){super(Df.a.A8n);this.Tm=e;this.Syb=t;this.s9f=E;this.zsc=(W,ha)=>{W=this.Syb.Exi();ha.pC===lo.a.dV&&((ha=W.values[lo.a.dV]>=this.s9f)&&!this.cma&&z.ULS.sendTraceTag(561309446,3016,50,this.aR(this.Tm,!0)),this.Jg(ha))}}initialize(){super.initialize();this.Syb.YPh(this.zsc)}Pd(){this.Syb.htg(this.zsc);
super.Pd()}}Object(y.a)(ww,"ParagraphCountCondition",Se.a,[]);class px extends Zo{constructor(e,t,E){super(Df.a.hIj);this.Tm=e;this.sL=t;this.HMn=E;this.Whi=this.Phi=this.isInitialized=!1;this.vvb=(W,ha)=>{ha.data.operationType===sh.a.getTypeName()&&(ha.data.annotation?ha.data.annotation.annotationType!==hf.DocumentRoleDetectionAnnotation.getTypeName()?(z.ULS.shipAssertTag(555812322,3016,!1),this.Jg(!1)):(ha=ha.data.annotation.content)?ha.errorCode?this.Jg(!1):((W=ha.isTarget)&&!this.Phi&&z.ULS.sendTraceTag(561309451,
3016,50,this.aR(this.Tm,!0,"subCondition=DocumentConfidenceCondition")),this.Phi=W,(ha=ha.supportedLanguagesCoverage>this.HMn)&&!this.Whi&&z.ULS.sendTraceTag(555812353,3016,50,this.aR(this.Tm,!0,"subCondition=DocumentLanguageCondition")),this.Whi=ha,(W=W&&ha)&&!this.cma&&z.ULS.sendTraceTag(555812354,3016,50,this.aR(this.Tm,!0)),this.Jg(W)):(z.ULS.shipAssertTag(555812323,3016,!1),this.Jg(!1)):(z.ULS.shipAssertTag(555812321,3016,!1),this.Jg(!1)))}}initialize(){super.initialize();this.isInitialized||
(this.sL.MH(this.vvb),this.sL.register(),this.isInitialized=!0)}Pd(){this.isInitialized&&(this.sL.unregister(),this.sL.sK(this.vvb),this.isInitialized=!1);super.Pd()}}Object(y.a)(px,"RoleDetectionCondition",Zo,[]);class wz extends Zo{constructor(e,t,E){super(Df.a.F0j);this.Tm=e;this.O4=t;this.WCe=E;this.ui=!1;this.zoe=()=>{z.ULS.sendTraceTag(541385729,3016,50,this.aR(this.Tm,!0));this.Jg(!0)}}initialize(){super.initialize();this.ui||(this.O4.register(),this.WCe.SRd(this.zoe),this.WCe.initialize(),
this.ui=!0)}Pd(){this.ui&&(this.WCe.cEj(this.zoe),this.WCe.Pd(),this.O4.unregister(),this.ui=!1);super.Pd()}}Object(y.a)(wz,"ThemesLoadedCondition",Zo,[]);class qC{constructor(e){this.engagement=e}initialize(){}T8(){return this.engagement.I1f?(z.ULS.sendTraceTag(509093536,3041,50,"Auto launch suppressed: AiMaker triggered"),!0):!1}WX(){}}Object(y.a)(qC,"DesignerContextualSuggestionsSuppressionModel",null,[1260]);class xz{constructor(e,t,E){this.goa=e;this.jfp=t;this.QDe=E;this.ui=!1;this.N2j=(W,ha)=>
{this.QDe&&this.QDe.trigger(W,ha);this.Pd()}}initialize(){z.ULS.sendTraceTag(554742740,3016,50,`DesignerProactiveTriggerManager.initialize - isInitialized=${this.ui}`);if(!this.ui){this.jfp.initialize();for(const e of this.goa)e.aaa(this.N2j),e.initialize();this.ui=!0}}Pd(){z.ULS.sendTraceTag(554742741,3016,50,`DesignerProactiveTriggerManager.deinitialize - isInitialized=${this.ui}`);if(this.ui){for(const e of this.goa)e.Pd(),e.pna(this.N2j);this.ui=!1}}}Object(y.a)(xz,"DesignerProactiveTriggerManager",
null,[1210,511]);class Jt extends nt.a{constructor(e,t,E,W=null,ha=null){super(e,t,E,3016,"OnTriggerDesigner");this.mao=ha;this.LIk=W}$9a(e){var t;super.$9a(e);null===(t=this.mao)||void 0===t?void 0:t.$9a(e)}Erb(e){Array.contains(Jt.jOk,e)?(z.ULS.sendTraceTag(546137305,3016,50,`DesignerSequentialTriggerModel.handleConditionUnsatisfied - conditionId=${e}`),this.iEa(!1)):super.Erb(e)}iEa(e=!0){var t,E;super.iEa(e&&!(null===(t=this.wqa)||void 0===t?0:t.T8())&&!(null===(E=this.LIk)||void 0===E?0:E.T8()))}}
Jt.jOk=[Df.a.hIj,Df.a.Zhi,Df.a.yri,Df.a.jhj,Df.a.Vhi,Df.a.p0j,Df.a.F0j];Object(y.a)(Jt,"DesignerSequentialTriggerModel",nt.a,[]);class Mq{constructor(e,t,E){this.Gdd=e;this.rcp=t;this.jdp=E}$9a(e){e===this.rcp&&(this.startTime=tb.a.Ee());e===this.jdp&&this.startTime&&(e=tb.a.Ee()-this.startTime,z.ULS.sendTraceTag(512492310,3016,50,`${this.Gdd} { elapsedTime: ${e} ms }`))}}Object(y.a)(Mq,"DesignerTriggerModelPerformanceMeter",null,[]);class aE{constructor(e,t,E){this.ptk=e;this.Zgh=t;this.Qvk=E}initialize(){}T8(){return this.Qvk?
this.ptk.isVisible?(z.ULS.sendTraceTag(555771225,3016,50,"Auto launch suppressed: pane already visible"),!0):this.Zgh.H4d()?(z.ULS.sendTraceTag(555771226,3016,50,"Auto launch suppressed: errorState {0}",this.Zgh.PMb),!0):!1:(z.ULS.sendTraceTag(508952729,3016,50,"Auto launch suppressed: flight is disabled"),!0)}WX(){}}Object(y.a)(aE,"HeuristicSuppressionModel",null,[1260]);class zy{constructor(e){this.Mzh=e;this.initialize()}initialize(){this.WYe=void 0;this.Mzh.crn(Eo.a.vfi).then(e=>{this.WYe=e})}T8(){if(void 0===
this.WYe)return z.ULS.sendTraceTag(521199813,3016,50,"Auto launch suppressed: No results from intelligence"),!0;if(this.WYe)return z.ULS.sendTraceTag(521199812,3016,50,"Auto launch suppressed: pane was already opened for this document"),!0;this.Mzh.yao(Eo.a.vfi);return!1}WX(){}}Object(y.a)(zy,"PersistenceSuppressionModel",null,[1260]);class Dw{constructor(e){this.Xmg=e}initialize(){z.ULS.sendTraceTag(554742739,3016,50,"ProactiveTriggerDeinitializer.initialize");this.Xmg.Pd()}Pd(){}}Object(y.a)(Dw,
"ProactiveTriggerDeinitializer",null,[511]);class Ay{constructor(e,t,E){this.F$j=e;this.gid=t;this.Xmg=E}initialize(){z.ULS.sendTraceTag(554742738,3016,50,"ProactiveTriggerInitializer.initialize");this.F$j.initialize();this.gid.KAj(this.F$j);this.Xmg.initialize()}Pd(){}}Object(y.a)(Ay,"ProactiveTriggerInitializer",null,[511]);var rC=d(652);class yz{constructor(e,t,E=null){this.SQa=new rC.a;this.u9e=!1;this.kDb=this.sGb=null;this.zkj=(W,ha)=>{ha.data?(this.sGb=this.dF(),this.u9e=!1):(this.sGb=this.kDb=
null,this.k_c())};this.ga=e;this.Zzd=t;this.dF=E?E:()=>new Date}initialize(){this.Zzd.Rcc(this.zkj);this.ga.P0(this);this.tVf()}Pd(){this.Zzd.dEj(this.zkj);this.ga.n2b(this)}get id(){return 1}get jtc(){return this.sGb}get x_c(){return this.kDb}l8(){}j8(e){2===e.behavior&&this.SQa.contains(e.actionId)&&(this.kDb=this.dF(),this.k_c())}k_c(){this.u9e||(this.u9e=!0)}tVf(){this.SQa.add(wb.a.f6a);this.SQa.add(Fa.a.T3d);this.SQa.add(Fa.a.nxf);this.SQa.add(wb.a.Tlb);this.SQa.add(Fa.a.vkd);this.SQa.add(Fa.a.wQd);
this.SQa.add(Fa.a.$te);this.SQa.add(Fa.a.gnb);this.SQa.add(Fa.a.vPa)}}Object(y.a)(yz,"UserEngagementMonitor",null,[65,1258,511,1259]);class bE extends Se.a{constructor(e){super("DocumentOwnerConditionId");this.Tm=e}initialize(){super.initialize();const e=v.AFrameworkApplication.K.$("IsDocumentOwner");z.ULS.sendTraceTag(521430743,3016,50,this.aR(this.Tm,e,e&&!this.cma?"The owner of the document has changed":""));this.Jg(e)}Pd(){super.Pd()}}Object(y.a)(bE,"DocumentOwnerCondition",Se.a,[]);class zz extends Se.a{constructor(e,
t){super("ProactiveV2AllowedBySettingsConditionId");this.ro=e;this.Tm=t;this.b4=()=>{if(this.ro.B2()){var E=this.ro.Zqa()&&this.ro.f1i();z.ULS.sendTraceTag(521446609,3016,50,this.aR(this.Tm,E));this.Jg(E)}else z.ULS.shipAssertTag(521446610,3016,!1)}}initialize(){super.initialize();this.ro.B2()?this.Jg(this.ro.Zqa()&&this.ro.f1i()):this.ro.Pcc(this.b4)}Pd(){this.ro.vZb(this.b4);super.Pd()}}Object(y.a)(zz,"ProactiveV2AllowedBySettingsCondition",Se.a,[]);class sC{constructor(e,t,E,W,ha,Ka){this.$d=e;
this.c3=t;this.KQd=E;this.gid=W;this.Qaa=ha;this.CRl=Ka;this.isInitialized=!1;this.Cvb=(sb,dc)=>{dc.data.operationType===sh.a.getTypeName()&&(dc.data.annotation?dc.data.annotation.annotationType!==xb.FormattingSuggestionsSummaryAnnotation.getTypeName()?z.ULS.shipAssertTag(521446622,3016,!1):(sb=dc.data.annotation.content)?this.Qaa.H4d()?(z.ULS.sendTraceTag(521446620,3016,50,`Auto launch suppressed by errorState ${this.Qaa.PMb}`),this.Pd()):(z.ULS.sendTraceTag(521446619,3016,50,"Other conditions for the opening of the panel have been satisfied, check numberOfSuggestions = {0}",
sb.numberOfSuggestions),!sb.errorCode&&sb.numberOfSuggestions>=this.$d.dgo()?(this.gid.ckf(1,()=>{this.KQd.Pb(Fa.a.ePa,2,new Kq.a(11))}),z.ULS.sendTraceTag(521446618,3016,50,"All conditions have been met. Open Designer")):this.Pd()):z.ULS.shipAssertTag(521446621,3016,!1):z.ULS.shipAssertTag(521446623,3016,!1))}}initialize(){this.isInitialized||(this.Qaa.H4d()?z.ULS.sendTraceTag(521446626,3016,50,`ProactiveSuggestionsChecker - initialize supressed by errorState ${this.Qaa.PMb}`):(z.ULS.sendTraceTag(521446625,
3016,50,"ProactiveSuggestionsChecker - initialize"),this.c3.MH(this.Cvb),this.c3.register(),this.CRl.initialize(),this.isInitialized=!0))}Pd(){this.isInitialized&&(z.ULS.sendTraceTag(521446624,3016,50,"ProactiveSuggestionsChecker - deinitialize"),this.c3.unregister(),this.c3.sK(this.Cvb),this.isInitialized=!1)}}Object(y.a)(sC,"ProactiveSuggestionsChecker",null,[511]);class Zs{constructor(e,t,E,W,ha){this.goa=e;this.nZj=t;this.Sb=W;this.ro=ha;this.isInitialized=this.Rxf=this.MOg=this.bbk=!1;this.zXj=
(Ka,sb)=>{z.ULS.sendTraceTag(521446614,3016,50,"ProactiveTriggerManagerV2 startNewChecker");sb.z4?this.nZj.initialize():this.eYj()};this.Agg=(Ka,sb)=>{sb.data?(z.ULS.sendTraceTag(521446613,3016,50,"Stop on pane opened"),this.Pd()):this.bbk&&(z.ULS.sendTraceTag(521446612,3016,50,"Restart due to AcceptAll from pane"),this.initialize())};E.Rcc(this.Agg);this.Sb.P0(this)}initialize(){if(!this.isInitialized){this.isInitialized=!0;z.ULS.sendTraceTag(521446617,3016,50,"ProactiveTriggerManagerV2 init");for(const e of this.goa)e.aaa(this.zXj),
e.initialize()}}Pd(){if(this.isInitialized){this.isInitialized=!1;z.ULS.sendTraceTag(521446616,3016,50,"ProactiveTriggerManagerV2 deinit");this.eYj();for(const e of this.goa)e.Pd(),e.pna(this.zXj)}}eYj(){z.ULS.sendTraceTag(521446615,3016,50,"ProactiveTriggerManagerV2 stopActiveChecker");this.nZj.Pd()}l8(){}j8(e){if(2===e.behavior)switch(e.actionId){case wb.a.Tlb:this.MOg=this.bbk=!0;this.Rxf&&this.ro.Xji();break;case Fa.a.ePa:e=e.rd;!this.MOg&&e&&11===e.id&&(this.ro.hUl(),this.Rxf=!0);break;case wb.a.f6a:case Fa.a.wQd:this.MOg=
!0,this.Rxf&&this.ro.Xji()}}}Object(y.a)(Zs,"ProactiveTriggerManagerV2",null,[1210,65]);var Rp=d(61),OA=d(137);class av{constructor(e,t,E,W,ha=null){this.paragraphFormat=e;this.m0j=t;this.textLength=E;this.gpe=W;this.Vak=ha}}Object(y.a)(av,"ParagraphFormattingFullSnapshot",null,[]);class By{constructor(e,t,E){this.fw=e;this.cpEnd=t;this.uo=E}}Object(y.a)(By,"TextRunFormattingFullSnapshot",null,[]);class Cy{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md){this.Qd=e;this.a$=t;this.Ge=E;this.uv=W;this.gJd=
ha;this.OZ=Ka;this.hUe=sb;this.JNd=dc;this.xe=xc;this.ig=md}nwc(e,t=!0){var E;if(e){this.Qd.LYa(e);var W=new fa.a;for(var ha=0;ha<e.qa.length-1;ha++){var Ka=e.qa.J(ha);Ka.formatting&&Ka.formatting.uo&&W.add(new By(Ka.cp,e.qa.J(ha+1).cp,Ka.formatting.uo.clone()))}Ka=e.qa.J(e.qa.length-1);Ka.formatting&&Ka.formatting.uo&&W.add(new By(Ka.cp,Ka.cp,Ka.formatting.uo.clone()));ha=Ka=null;t&&({$_a:Ka}=this.JNd.bEe(this.xe.uQb(e)),ha=null===(E=this.xe.Eq(e))||void 0===E?void 0:E.id);this.gJd.put(e.id,new av(e.sE(),
W,Xf.ParagraphReader.textLength(e),Ka,ha))}else z.ULS.shipAssertTag(556410145,3016,!1)}k_a(e,t=!0){if(e){var E=null;if(({sWj:E}=this.gJd.bEe(e.id)).returnValue){const ha=e.X2();try{this.uv.eWd(e);if(E.paragraphFormat&&E.Vak&&e.iQ&&e.iQ.id===E.Vak)for(var W of e.properties.fk())E.paragraphFormat.hasProperty(W)||e.iQ.hasProperty(W)&&e.properties.qg(W);this.uv.KTh(e,E.paragraphFormat);this.a$.u9();let Ka=W=null;({Vga:W,l0j:Ka}=this.fEm(E));this.vWo(e,W,E);for(const sb of E.m0j)this.cZo(sb,Ka,E),this.a9k(sb,
e);this.Qd.LYa(e);e.Jl();t&&this.gJd.remove(e.id)}finally{ha&&ha.dispose()}}}else z.ULS.shipAssertTag(556410146,3016,!1)}Owf(e){e?this.gJd.remove(e.id):z.ULS.shipAssertTag(556410147,3016,!1)}a9k(e,t){var E=t.qa.J(t.qa.length-1);if(E.cp===e.fw&&e.fw===e.cpEnd)this.lop(E,e,t);else for(E=0;E<t.qa.length-1;E++){const W=t.qa.J(E),ha=t.qa.J(E+1);if(W.cp>=e.fw&&W.cp<e.cpEnd){let Ka=!1;ha.cp<=e.cpEnd?Ka=!0:z.ULS.sendTraceTag(540652370,3016,15,"applyTextRunFormattingOnParagraph: textRunFormatting.cpEnd < next.cp");
Ka&&W.formatting&&(this.Ge.Zja(W.formatting),this.Ge.ZAg(W.formatting,e.uo))}}}lop(e,t,E){var W;E=Xk.ListItemReader.Of?E:this.ig.Hfa(E);let ha=null;if(Xk.ListItemReader.isListItem(E)&&t.uo&&(ha=t.uo.fk())&&(this.Ge.Zja(e.formatting),this.Ge.ZAg(e.formatting,t.uo),null===(W=Rp.a.getInstance())||void 0===W||!W.Fu))for(const Ka of ha)E.setValue(Ka,t.uo.wf(Ka))}fEm(e){const t=new fa.a,E=new fa.a;let W=null;if(!e.gpe||!(W=e.gpe.fk()))return{Vga:t,l0j:E};for(e=0;e<W.length;e++){const ha=W[e];dg.a.any(OA.a.$Ki(),
Ka=>Ka===ha)?t.add(ha):E.add(ha)}return{Vga:t,l0j:E}}vWo(e,t,E){this.OZ.e_(this.hUe(e,0,Xf.ParagraphReader.textLength(e)),W=>{for(const ha of t)this.Ge.Sm(W,ha,E.gpe.wf(ha))})}cZo(e,t,E){for(const W of t)e.uo.hasProperty(W)||e.uo.setValue(W,E.gpe.wf(W))}}Object(y.a)(Cy,"RestoreManager",null,[1257]);class Iv{constructor(e,t,E){this.NCb=e;this.mea=t;this.GQa=E}accept(e,t=!1){return e?Iv.Ksb(()=>{this.mea.uof(e,2,t)}):(z.ULS.shipAssertTag(590434823,3016,!1),!1)}acceptAll(){const e=this.NCb.Mc(15,wb.a.Tlb);
try{return e.Xz.Ab(this.GQa.jd),Iv.Ksb(()=>{this.mea.lTf(!1,0)})}finally{e&&e.dispose()}}reject(e,t=!1){if(!e)return z.ULS.shipAssertTag(590434824,3016,!1),!1;const E=this.NCb.Mc(15,Fa.a.$te);try{return E.Xz.Ab(e),Iv.Ksb(()=>{this.mea.uof(e,3,t)})}finally{E&&E.dispose()}}rejectAll(){const e=this.NCb.Mc(15,Fa.a.vkd);try{return e.Xz.Ab(this.GQa.jd),Iv.Ksb(()=>{this.mea.lTf(!0)})}finally{e&&e.dispose()}}sOg(e){if(!e)return z.ULS.shipAssertTag(529106274,3016,!1),!1;const t=this.NCb.Mc(15,Fa.a.sxf);try{return t.Xz.Ab(e),
Iv.Ksb(()=>{this.mea.uof(e,.1,!1)})}finally{t&&t.dispose()}}kqd(){const e=this.NCb.Mc(15,Fa.a.qxf);try{return e.Xz.Ab(this.GQa.jd),Iv.Ksb(()=>{this.mea.lTf(!0);this.mea.kqd()})}finally{e&&e.dispose()}return!1}gnb(e){if(null===e||void 0===e||!e.paragraphNode)return z.ULS.shipAssertTag(575484486,3016,!1),!1;const t=this.NCb.Mc(15,Fa.a.gnb);try{return t.Xz.Ab(e.paragraphNode),Iv.Ksb(()=>{1===e.vr&&t.Xz.sMa(e.v_,1);this.mea.knl(e)})}finally{t&&t.dispose()}}vPa(e){if(!e)return z.ULS.shipAssertTag(573850376,
3016,!1),!1;const t=this.NCb.Mc(15,Fa.a.vPa);try{return t.Xz.Ab(e),Iv.Ksb(()=>{this.mea.vPa(e)})}finally{t&&t.dispose()}}static Ksb(e){try{return e(),!0}catch(t){return z.ULS.shipAssertTag(572068186,3016,!1,String.format("{0} {1}",t.message,t.stack)),!1}}}Object(y.a)(Iv,"ReviewActions",null,[1256]);var cE=d(1300),Kt=d(1788),yx=d(1799),dE=d(1700);class eE{constructor(e,t,E,W,ha,Ka){this.D$e=e;this._state=t;this.iGc=E;this.Czk=W;this.Tnk=ha;this.Ymk=Ka;this.D$e.nYa(this._state)}get suggestion(){return this.D$e}get state(){return this._state}set state(e){e!==
this._state&&(this._state=e,this.suggestion.nYa(this._state))}get description(){return this.iGc}get tsb(){return this.Czk}get rKb(){return this.Tnk}get T0o(){return 0==this.D$e.vr}get QQ(){var e;return null!==(e=this.Ymk)&&void 0!==e?e:[]}}Object(y.a)(eE,"ReviewIntent",null,[]);class fE{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h=null,rj,zl,Wl,Rh,Mg,Xl){this.Sb=e;this.bM=t;this.K4=E;this.G7=W;this.qGn=ha;this.pK=Ka;this.Dg=sb;this.r4=dc;this.Wvc=xc;this.FD=Rc;this.tK=md;this.Rm=
ud;this.Mre=Ud;this.IA=Id;this.oca=Ee;this.gR=kf;this.bic=Ke;this.Ayl=dh;this.LD=$h;this.$d=rj;this.yUf=zl;this.ro=Wl;this.i4=Rh;this.Nd=Mg;this.sc=Xl;this.hmd=null;this.t0=!1;this.rBj=new Map;this.O1n=(ql,Al)=>{this.lfc(Al.data.paragraphNode,5)};this.W1n=(ql,Al)=>{this.hmd?this.hmd(Al.data):this.t0&&z.ULS.shipAssertTag(590434837,3016,!1)};this.b4=()=>{this.ro.Zqa()||this.t0||this.IUi()};this.p3n=(ql,Al)=>{(this.t0=Al.data)&&this.IUi();!Al.data&&0<this.Rm.WZb&&this.Sb.Pb(wb.a.Tlb,2,new dE.a(1))};
this.$gg=(ql,Al)=>{if(ql=this.tK.lX(Al.data.paragraphNode))if(Al.data.paragraphNode.dre=Al.data.isVisible){if(0==ql.state||.1==ql.state)ql.T0o?this.R7k(Al.data.paragraphNode,ql):ql.rKb(),z.ULS.sendTraceTag(540676563,3016,50,"Role: {0};",ql.tsb);this.uVd(Al.data.paragraphNode,1);this.hmd&&this.hmd(this.Rm.WZb)}else.1===ql.state?this.FD.Qpg(new Kt.a(Al.data.paragraphNode,ql.tsb)):1<ql.state&&this.lfc(Al.data.paragraphNode,ql.state)};this.WUn=(ql,Al)=>{(ql=this.tK.lX(Al.data.currentNode))&&1<ql.state&&
this.lfc(Al.data.currentNode,ql.state)};this.Rm.B1k(this.W1n);this.FD.x1k(this.O1n);this.FD.Fgf(this.$gg);this.FD.z0k(this.WUn);this.K4.Rcc(this.p3n);this.ro.Pcc(this.b4)}vXo(e){this.hmd=e}Ize(e){let t=0;if(!e.tYa)return z.ULS.sendTraceTag(521412957,3016,50,"Paragraph node not available."),t;if(!e.bTd)return z.ULS.shipAssertTag(545117584,3016,!1),t;const E=this.Rm.YB(e.tYa);if(!this.ro.Zqa())return z.ULS.sendTraceTag(537260062,3016,50,`type: ${e.annotationType} role: ${E.role}`),1;if(0==e.suggestion.vr&&
this.Rm.A_i(e.tYa,E))return z.ULS.sendTraceTag(529105475,3016,50,`type: ${e.annotationType} role: ${E.role}`),1;this.oca.zXf(e.tYa,e.nnc,e.p8c-e.nnc,e.annotationType,W=>{W||(t=this.eAe(new K.b(e.suggestion,e.jt,e.nnc,e.p8c,()=>{e.annotationType!==Eo.a.cog&&e.annotationType!==Eo.a.yGg||this.oca.Ttc(e.tYa,e.nnc,e.p8c-e.nnc,e.annotationType,60);const ha=e.bTd(E,e.jt);z.ULS.shipAssertTag(540676565,3016,ha,`Contextual suggestion failed to apply. annotationType: ${e.annotationType}`);return ha}),0,this.Wvc.zjc(E.role)))});
1<t&&(e.annotationType===Eo.a.cog||e.annotationType===Eo.a.yGg)&&this.LD&&this.LD.execute(W=>{W.logActivity(Df.a.rWn,null)});z.ULS.sendTraceTag(540653090,3016,50,"Role: {0}; Status {1};",E.role,t);return t}U1c(e,t=null){if(!t&&(t=Object(Ne.a)(sn.AParagraphNode,e.parent),!t))return[];e=e.content;if(!e||!e.range||e.range!==xb.FormattingSuggestionsRange.List)return[t];if(15!==this.Rm.YB(t).role)return[];if(Xk.ListItemReader.Of){if(!Xk.ListItemReader.isListItem(t))return[t];({listId:e}=Xk.ListItemReader.av(t))}else{e=
this.Nd.Hfa(t);if(!e||!e.hasProperty(fd.a.listID))return[t];e=e.getValue(fd.a.listID)}const E=this.i4.Jra(t,!0,!1),W=[];for(;t;)if(W.push(t),t=E.lba()?E.my:null,Xk.ListItemReader.Of){if(!Xk.ListItemReader.isListItem(t))break;if(Xk.ListItemReader.av(t).listId!==e)break}else{const ha=this.Nd.Hfa(t);if(!ha)break;if(!ha.hasProperty(fd.a.listID))break;if(ha.getValue(fd.a.listID)!==e)break}return W}Pgo(e,t,E=null){if(!e)return z.ULS.shipAssertTag(590434825,3016,!1),0;if(!t)return z.ULS.shipAssertTag(590434828,
3016,!1),0;const W=e.content;if(!W)return z.ULS.shipAssertTag(590434826,3016,!1),0;const ha=this.U1c(e);if(!ha||!ha.length)return z.ULS.shipAssertTag(590434827,3016,!1),0;const Ka=this.Rm.YB(ha[0]);if(15===Ka.role&&1!==e.content.range)return 1;let sb=!1;ha.forEach(dc=>{this.Rm.YB(dc).bab||(sb=!0)});return sb?this.aEg(new K.b(new Ha.c(Hb.a.create(),this.LD,this.$d,!1,E),ha,0,this.Dg.textLength(ha[0]),()=>t(W,ha)),this.Wvc.zjc(Ka.role),!1):1}eho(e,t,E){if(!e||0==e.length)return z.ULS.shipAssertTag(512603861,
3016,!1),0;if(!t)return z.ULS.shipAssertTag(590434833,3016,!1),0;let W=!1;e.forEach(Ka=>{this.Rm.YB(Ka).bab||(W=!0)});const ha=this.Rm.YB(e[0]);return W?this.aEg(new K.b(new Ha.c(Hb.a.create(),this.LD,this.$d,!1,E),e,0,this.Dg.textLength(e[0]),()=>t(ha,e)),this.Wvc.zjc(ha.role),!0):t(ha,e)?2:0}oho(e,t){if(!e)return z.ULS.shipAssertTag(589963425,3016,!1),0;if(!t)return z.ULS.shipAssertTag(512603860,3016,!1),0;const E=this.Rm.YB(e);return E.bab?t(E,e)?2:0:this.aEg(new K.b(new Ha.c(Hb.a.create(),this.LD,
this.$d,!1,null),[e],0,this.Dg.textLength(e),()=>t(E,e)),this.Wvc.zjc(E.role),!0)}Qvj(e,t){if(!e)return z.ULS.shipAssertTag(555055119,3016,!1),0;if(!t)return z.ULS.shipAssertTag(555055120,3016,!1),0;if(!e.paragraphNode)return z.ULS.shipAssertTag(555055121,3016,!1),0;t=t(e);const E=null===t||void 0===t?void 0:t.paragraphNode;if(!E)return z.ULS.shipAssertTag(541446668,3016,!1),0;this.FD.Xuc(t);this.bic.register(E,e.suggestion);return this.eAe(new K.b(e.suggestion,[E],0,1,null),(null===t||void 0===t?
0:t.placeholder)?.5:1,this.Wvc.zjc(t.role))}uof(e,t,E=!1){e?this.q5j(e,t,E):z.ULS.shipAssertTag(590434834,3016,!1)}lTf(e,t){const E=[];this.tK.forEach(W=>{const ha=this.tK.lX(W);if(void 0!==t&&ha.suggestion.vr!==t)return z.ULS.sendTraceTag(537796610,3016,50,`skiped role: ${ha.tsb} type: ${ha.suggestion.vr}`),!0;e||0!=ha.state&&.1!==ha.state||(z.ULS.sendTraceTag(540676562,3016,50,"Role: {0};",ha.tsb),ha.rKb());E.push(W);return!0},!e);E.length&&E.forEach(W=>{this.q5j(W,e?3:2,!0)});z.ULS.sendTraceTag(537796611,
3016,50,`reject: ${e} count: ${E.length}`)}kqd(){this.ro.Zqa()&&(z.ULS.sendTraceTag(537260063,3016,50,"snoozeContextualSuggestions"),this.ro.wgi())}n0m(e){const t=this.Rm.YB(e);t&&!t.Ula&&this.lfc(e,5)}knl(e){if(null!==e&&void 0!==e&&e.paragraphNode){var t=this.tK.lX(e.paragraphNode),E=this.tK.lX(e.paragraphNode).suggestion,W=this.Rm.YB(e.paragraphNode);switch(e.vr){case 1:case 3:this.bic.unregister(e.paragraphNode);const ha=Ka=>{this.FD.Xuc({role:27,paragraphNode:e.paragraphNode,placeholder:Ka})};
e.paragraphNode=this.Mre.xnl(e.paragraphNode,E,()=>{this.FD.Ajd(Aw.a.create(e.paragraphNode));ha(!1)},e.v_);ha(!0);this.bic.register(e.paragraphNode,E);this.eAe(new K.b(E,[e.paragraphNode],0,1,null),1,this.Wvc.zjc(e.role));break;case 2:this.bic.unregister(e.paragraphNode);t=Xf.ParagraphReader.zg(e.paragraphNode,!1);this.gR.ovc(W.ita,e.paragraphNode);this.yUf.instance.wTh(new K.a(E,t,e.kta));break;default:1===e.role?t&&t.QQ&&0<t.QQ.length?t.QQ.forEach(Ka=>{this.r4.k_a(Ka,!1)}):this.r4.k_a(e.paragraphNode,
!1):0!=e.role&&e.role===W.OSd?(this.r4.k_a(e.paragraphNode,!1),this.pK.rmb(e.paragraphNode,W.PSd)):t&&t.QQ&&0<t.QQ.length?t.QQ.forEach(Ka=>{this.pK.Ija(Ka,e.role)}):this.pK.Ija(e.paragraphNode,e.role)}this.FD.Qpg(new Kt.a(e.paragraphNode,e.role));this.uVd(e.paragraphNode,4)}else z.ULS.shipAssertTag(575484485,3016,!1)}vPa(e){if(e){var t=this.tK.lX(e);t?(this.FD.Qpg(new Kt.a(e,t.tsb)),3!==t.state&&.1!==t.state||t.rKb(),4===t.state&&(t&&t.QQ&&0<t.QQ.length?t.QQ.forEach(E=>{this.r4.k_a(E,!1)}):this.r4.k_a(e,
!1),t.rKb()),this.uVd(e,1)):z.ULS.shipAssertTag(573850382,3016,!1)}else z.ULS.shipAssertTag(573850381,3016,!1)}rIm(){let e=null;this.tK.forEach(t=>{e=t;return!1},!1);return e}Bkc(e,t){return e?this.tK.oBm(e,t):(z.ULS.shipAssertTag(590434835,3016,!1),null)}uVd(e,t){const E=this.tK.lX(e);E?(E.state=t,3===t&&27!=E.tsb&&28!=E.tsb&&1===E.QQ.length&&(this.oca.Ttc(e,0,e.characterData.length,Eo.a.tdi,70),this.rBj.set(e,Date.now()))):z.ULS.sendTraceTag(512239234,3016,50,"Review intent for given paragraph node is null.")}lfc(e,
t){const E=this.tK.lX(e);if(!e.dre||1<t)this.G7.G0a(e,1),E&&E.QQ&&0<E.QQ.length?E.QQ.forEach(W=>{this.r4.Owf(W)}):this.r4.Owf(e),this.FD.Zxj(new yx.a(e,t)),e=[Object.assign(new yi.a,{name:Df.a.qxl,int64:t})],this.qGn(Df.a.pxl,!0,void 0,e)}oxl(e){const t=this.tK.lX(e);let E=0;t?E=t.state:z.ULS.shipAssertTag(573687424,3016,!1);this.lfc(e,E)}q5j(e,t,E){const W=this.Rm.YB(e);if(W.Ula){var ha=this.tK.lX(e),Ka=null===ha||void 0===ha?void 0:ha.state;this.uVd(e,t);3===t||.1===t?27===W.role?(1===Ka&&(this.bic.unregister(e),
this.Mre.WBj(e)),E=!1):28===W.role?(this.bic.unregister(e),this.gR.ovc(W.ita,e),E=!1):(ha&&ha.QQ&&0<ha.QQ.length?ha.QQ.forEach(sb=>{this.r4.k_a(sb,!1)}):this.r4.k_a(e,!1),this.FD.wmo(new Kt.a(e))):2===t&&this.FD.umo(new Kt.a(e));E&&this.oxl(e)}}eAe(e,t,E,W=!1){const ha=this.Rm.YB(e.tYa);0<e.p8c&&!ha.Ula&&!this.n2o(e.tYa)?(this.G7.vMa(e.tYa,new cE.a(1,e.nnc,e.p8c,void 0,new eE(e.suggestion,t,E,ha.role,e.bTd,e.jt))),0==e.suggestion.vr&&this.Ayl.register(e.tYa,e.suggestion),this.FD.vmo(new Kt.a(e.tYa,
ha.role,W)),e=3):e=4;z.ULS.sendTraceTag(540653091,3016,50,"Role: {0}; Status {1}; State: {2};",ha.role,e,t);return e}n2o(e){var t=Date.now();return this.t0?!1:(e=this.rBj.get(e))?t-e<this.$d.bdl():!1}aEg(e,t,E){this.bM.Yd(()=>{e.jt.forEach(W=>{this.r4.nwc(W,E)})},"WD:SF");if(e.bTd())return this.eAe(e,1,t,!E);e.jt.forEach(W=>{this.r4.Owf(W)});return 0}IUi(){this.tK.forEach(e=>{if(1<this.tK.lX(e).state)return!0;this.lfc(e,5);return!0},!1)}R7k(e,t){const E=this.IA.Mc(15,wb.a.nTh);try{t&&t.QQ&&0<t.QQ.length?
(E.Xz.Ab(this.sc.jd),t.QQ.forEach(W=>{this.r4.nwc(W,!0)})):(E.Xz.Ab(e),this.r4.nwc(e,!0)),t.rKb()}finally{E&&E.dispose()}}}Object(y.a)(fE,"ReviewManager",null,[1255]);class tG{constructor(e,t,E,W){this.Yn=e;this.jb=t;this.ESa=E;this.GQa=W}forEach(e,t=!1){if(e){var E=Object(Ne.a)(sn.AParagraphNode,t?this.jb.hD(this.GQa.jd):this.jb.Zl(this.GQa.jd));t=this.ESa.Jra(E,!0,t);do if(this.O$c(t.my)&&!e(t.my))break;while(t.lba())}else z.ULS.shipAssertTag(590391060,3016,!1)}oBm(e,t){if(!e)return z.ULS.shipAssertTag(590391061,
3016,!1),null;for(e=this.ESa.Jra(e,!0,t);e.lba();)if(this.O$c(e.my))return e.my;return null}O$c(e){return e?0<this.Yn.fWa(e,1,()=>!0).count:(z.ULS.shipAssertTag(590391062,3016,!1),!1)}lX(e){if(!e)return z.ULS.sendTraceTag(522301513,3016,50,"Get null paragraphNode while trying to initialize ReviewIntent"),null;e=this.Yn.fWa(e,1,()=>!0);if(1===e.count)return e.J(0).intent;z.ULS.sendTraceTag(522301514,3016,50,"Return null ReviewIntent because of unexpected ranges.count: {0}",e.count);return null}}Object(y.a)(tG,
"ReviewTraverser",null,[1254]);var Jv;(function(e){e[e.None=0]="None";e[e.vik=1]="ProactivePaneOpeningDisabled";e[e.PNp=2]="JumpstartProactivePaneOpeningDisabled"})(Jv||(Jv={}));Object(y.b)("DesignerFlagSetting",Jv);const Ew=e=>{if(!e)return Jv.None;const t=e.split(".");return 2===t.length&&1===parseInt(t[0])?parseInt(t[1]):"0"===e?Jv.vik:Jv.None};class cu{constructor(){this.FavoriteThemesIDs=this.DesignerFlags=this.CSDisableDate=null}equals(e){return this.CSDisableDate===e.CSDisableDate&&this.DesignerFlags===
e.DesignerFlags&&this.FavoriteThemesIDs===e.FavoriteThemesIDs}}Object(y.a)(cu,"WordDesignerSettings",null,[864]);class uG{constructor(e,t){this.Oud=e;this.$d=t;this.roamingSettings=null;this.ujf=!0;this.ed=new ua.a}initialize(){if(this.Oud){z.ULS.sendTraceTag(523850467,3016,50,"DesignerSettingsManager - initialize with roaming");var e=Date.now();this.Oud.kbb().then(t=>{this.roamingSettings=t;this.ed.raiseEvent("OnSettingsChanged",new Sys.EventArgs);!0!==this.Zqa()&&(t=[Object.assign(new yi.a,{name:"CSEnabled",
bool:this.Zqa()})],ma.a(Df.a.aBn,!0,Date.now()-e,t));this.$d.$Bg()&&(t=new cu,t.CSDisableDate=new Date(0),t.DesignerFlags="",t.FavoriteThemesIDs=[],this.roamingSettings=t)}).catch(t=>{z.ULS.sendTraceTag(509137223,3016,15,`DesignerSettingsManager - failed loading from roaming with error ${JSON.stringify(t,["message","stack"],2)}`)})}else z.ULS.sendTraceTag(523850466,3016,50,"DesignerSettingsManager - initialize. No roaming")}Pd(){z.ULS.sendTraceTag(523850497,3016,50,`DesignerSettingsManager - deinitialize. CS_enabled: ${this.Zqa()}`)}Pcc(e){this.ed.addHandler("OnSettingsChanged",
e)}vZb(e){this.ed.removeHandler("OnSettingsChanged",e)}B2(){return this.$d.gze()||this.$d.$Bg()?!0:!(!this.roamingSettings||!this.Oud)}D_l(){this.Zqa()?z.ULS.shipAssertTag(523850498,3016,!1):(this.ujf=!0,this.roamingSettings&&(this.roamingSettings.CSDisableDate=new Date(0),this.Ltd()),this.ed.raiseEvent("OnSettingsChanged",new Sys.EventArgs),z.ULS.sendTraceTag(523850499,3016,50,"DesignerSettingsManager - enableContextualSuggestions."))}Zqa(){if(this.$d.gze())return!0;if(this.B2())return!1===this.ujf||
this.roamingSettings&&this.roamingSettings.CSDisableDate&&this.roamingSettings.CSDisableDate>new Date(0)?!1:!0}$xf(){const e=this.Zqa();this.ujf=!1;e&&this.ed.raiseEvent("OnSettingsChanged",new Sys.EventArgs);z.ULS.sendTraceTag(523850500,3016,50,`DesignerSettingsManager - disableForSession. Changed:${e}`)}wgi(){if(this.roamingSettings){var e=this.Zqa();this.roamingSettings.CSDisableDate=new Date;this.Ltd();e&&this.ed.raiseEvent("OnSettingsChanged",new Sys.EventArgs);z.ULS.sendTraceTag(523850502,3016,
50,`DesignerSettingsManager - disableUntilUpdate. Changed:${e}`)}else z.ULS.shipAssertTag(523850501,3016,!1),this.$xf()}g9c(e,t){return this.B2()?Ew(this.roamingSettings.DesignerFlags)&e?!0:!1:t}zNj(e){if(this.roamingSettings){var t=this.roamingSettings.DesignerFlags;e|=Ew(t);this.roamingSettings.DesignerFlags=`1.${e}`;t!==this.roamingSettings.DesignerFlags&&(this.Ltd(),this.ed.raiseEvent("OnSettingsChanged",new Sys.EventArgs))}else z.ULS.shipAssertTag(508944657,3016,!1)}E5j(e){if(this.roamingSettings){var t=
this.roamingSettings.DesignerFlags;e=Ew(t)&~e;this.roamingSettings.DesignerFlags=`1.${e}`;t!==this.roamingSettings.DesignerFlags&&(this.Ltd(),this.ed.raiseEvent("OnSettingsChanged",new Sys.EventArgs))}else z.ULS.shipAssertTag(508944656,3016,!1)}f1i(){return!this.g9c(1,!0)}hUl(){this.zNj(1)}Xji(){this.E5j(1)}Hym(){if(this.roamingSettings)return z.ULS.sendTraceTag(520488718,3016,50,`DesignerSettingsManager - getListOfFavoriteThemesIDs. IDs of favorite themes:${this.roamingSettings.FavoriteThemesIDs}`),
this.roamingSettings.FavoriteThemesIDs;z.ULS.shipAssertTag(520488719,3016,!1)}Ukp(e){var t,E;if(this.roamingSettings){var W=null!==(E=null===(t=this.roamingSettings.FavoriteThemesIDs)||void 0===t?void 0:t.indexOf(e,0))&&void 0!==E?E:-1;-1===W?(this.roamingSettings.FavoriteThemesIDs||(this.roamingSettings.FavoriteThemesIDs=[]),this.roamingSettings.FavoriteThemesIDs.unshift(e)):this.roamingSettings.FavoriteThemesIDs.splice(W,1);this.$d.$Bg()||this.Ltd();this.ed.raiseEvent("OnSettingsChanged",new Sys.EventArgs);
z.ULS.sendTraceTag(520488716,3016,50,`DesignerSettingsManager - toggleFavoriteTheme. IDs of favorite themes:${this.roamingSettings.FavoriteThemesIDs}`)}else z.ULS.shipAssertTag(520488717,3016,!1)}Ltd(){this.Oud&&(this.Oud.saveSettings(this.roamingSettings),z.ULS.sendTraceTag(523850503,3016,50,"DesignerSettingsManager - updateRoamingSettings"))}}Object(y.a)(uG,"DesignerSettingsManager",null,[1242]);class zx extends Se.a{constructor(e){super("DesignerSettingsReadyConditionId");this.ro=e;this.b4=()=>
{this.ro.B2()?(this.Jg(!0),this.ro.vZb(this.b4)):z.ULS.sendTraceTag(523850465,3016,15,"DesignerSettingsReadyCondition: settings changed, but not loaded")}}initialize(){super.initialize();this.ro.B2()?this.Jg(!0):this.ro.Pcc(this.b4)}Pd(){this.ro.vZb(this.b4);super.Pd()}}Object(y.a)(zx,"DesignerSettingsReadyCondition",Se.a,[]);var Kv=d(768),Az=d(940);class Bz{static pnn(e){return String(e).charAt(0)==String(e)}static $_l(e){return Bz.pnn(e)?"*"+e:e.toString()}static sNl(e){const t=[];for(let W=0;W<
e.length;W+=2){var E=e.substring(W,Math.min(e.length,W+2));E=E.startsWith("*")?Number(E.substring(1)):Number(E);t.push(E)}return t}static Rgn(e){return e instanceof Date&&!isNaN(e.getTime())}}Object(y.a)(Bz,"WordDesignerSettingsUtils",null,[]);var Cz=d(288);const mo=new Date(0);class Lv extends Kv.a{constructor(e,t,E,W,ha){super(e,t,E,W,ha);this.M$="Word Designer";this.xFb=["CSDisableDate","DesignerFlags","FavoriteThemesIDs"];this.a9b=Lv.olk;this.hIc="getWordDesignerSettings";this.X$b="saveWordDesignerSettings";
this.Jkb=Cz.a.WGe}WGe(){return this.Ki}async Vld(){return!0}Icc(){var e;return["CSDisableDate",this.Ki.CSDisableDate,"DesignerFlags",null!==(e=this.Ki.DesignerFlags)&&void 0!==e?e:"0","FavoriteThemesIDs",this.Ki.FavoriteThemesIDs]}Hcc(){var e,t=this.Ki.CSDisableDate?this.Ki.CSDisableDate.toISOString():"";t=this.Ki.CSDisableDate?t.substring(0,t.indexOf("T")):"";const E=this.Ki.FavoriteThemesIDs?this.Ki.FavoriteThemesIDs.map(Bz.$_l).join(""):"";return{["CSDisableDate"]:this.a_(t),["DesignerFlags"]:this.a_(null!==
(e=this.Ki.DesignerFlags)&&void 0!==e?e:"0"),["FavoriteThemesIDs"]:this.a_(E)}}ZXc(){return new Az.a(this.Ki)}get Igc(){return new cu}dhd(e){const t=new cu;if(e.CSDisableDate){const E=this.Ryj(e.CSDisableDate);t.CSDisableDate=Bz.Rgn(E)?E:mo}else t.CSDisableDate=null;t.DesignerFlags=e.DesignerFlags?this.Zkd(e.DesignerFlags):"0";t.FavoriteThemesIDs=e.FavoriteThemesIDs?Bz.sNl(this.Zkd(e.FavoriteThemesIDs)):[];return t}kbb(){return this.$bd()}saveSettings(e){this.Ki=e;return this.Qmd()}}Lv.olk="WordDesignerSettingsChangedEvent";
Object(y.a)(Lv,"WordDesignerSettingsHandler",Kv.a,[1241]);class Mv{constructor(e,t,E,W,ha,Ka,sb,dc,xc=null,Rc){this.$d=e;this.Qua=t;this.pWd=E;this.Bsa=W;this.c3=ha;this.tg=Ka;this.Rm=dc;this.LD=xc;this.lhc=Rc;this.xpc=this.isInitialized=!1;this.Pna=this.xfa=0;this.eqe="";this.Rua=new Map;this.kLb=new Map;this.GUc=0;this.K7a=new fa.a;this.FOa=null;this.iUb=Hb.a.nil;this.jTb=!1;this.CDa=[];this.ctc=(md,ud)=>{this.FOa&&ud.actionId===wb.a.SDa&&this.FOa.rcd()};this.Bvb=(md,ud)=>{if(null==this.CDa||0==
this.CDa.length)this.Pna=2;else if(ud.data.operationType!==Va.a.getTypeName())z.ULS.sendTraceTag(512350099,3016,50,`unexpected operationType: ${ud.data.operationType}`);else if(this.jTb)if(md=ud.data.annotation)if(md.annotationType!==xb.FormattingSuggestionsAnnotation.getTypeName())z.ULS.shipAssertTag(521429915,3016,!1);else if(ud=this.Bsa.getParent(md))if(this.CDa.includes(ud)){var Ud=this.CDa.indexOf(ud);-1!==Ud&&(this.kLb.set(md,{iIj:this.Rm.YB(ud),jkg:Ud}),this.GUc=this.CDa.length,this.Swf(213),
this.FOa||(this.FOa=new Ha.a(this.iUb,this.LD,this.$d,!1,this.tg.cfa),this.FOa.nYa(0)),1!==this.Pna&&(this.Pna=1,this.eBc(this.Pna)),this.kLb.size===this.GUc&&this.UAc(),this.Hnp())}else z.ULS.sendTraceTag(521483348,3016,50,`Skip non-pasted paragraph ${null===ud||void 0===ud?void 0:ud.id}`);else z.ULS.shipAssertTag(521429914,3016,!1);else z.ULS.shipAssertTag(521429916,3016,!1)};this.Cvb=(md,ud)=>{ud.data.operationType===Va.a.getTypeName()&&(ud.data.annotation?ud.data.annotation.annotationType!==xb.FormattingSuggestionsSummaryAnnotation.getTypeName()?
z.ULS.shipAssertTag(521429912,3016,!1):(this.xfa&&(md=[Object.assign(new yi.a,{name:Df.a.vqg,string:"CCPFloatieSmartPaste"})],ma.a(Df.a.uqg,!0,Date.now()-this.xfa,md),this.xfa=0),(ud=ud.data.annotation.content)?(ud.errorCode||0===ud.numberOfSuggestions)&&this.jTb&&0===this.Pna&&this.Cuf(213,5E3,!1):z.ULS.shipAssertTag(521429911,3016,!1)):z.ULS.shipAssertTag(521429913,3016,!1))};this.Z3=(md,ud)=>{var Ud;this.uff(ud.node);ud.$Zi&&(this.Tol()?(this.gcn(),this.yep(),this.eBc(0),this.Cuf(213,1E4)):(this.Cyp(this.CDa),
this.UAc(),this.FOa&&1===this.FOa.Fep&&this.FOa.rcd()),this.ksj=!0,ma.a("PasteActionHappened",!0,void 0,[Object.assign(new yi.a,{name:"IsNewPasteAction",Boolean:this.jTb}),Object.assign(new yi.a,{name:"CorrelationId",string:null===(Ud=this.iUb)||void 0===Ud?void 0:Ud.toString()})]))};this.Pna=0;this.pSi();this.Qgd=sb.Ve(12)}initialize(){this.isInitialized||(z.ULS.sendTraceTag(521483352,3016,50,"SmartPasteManager - initialize"),this.tg.Qcc(this.ctc),this.Qgd.JPh(this.Z3),this.isInitialized=!0)}Pd(){this.isInitialized&&
(z.ULS.sendTraceTag(521483351,3016,50,"SmartPasteManager - deinitialize"),this.tg.jtg(this.ctc),this.UAc(),this.Qgd.IDj(this.Z3),this.isInitialized=!1)}yep(){z.ULS.sendTraceTag(521483350,3016,50,`SmartPasteManager - subscribe to AL was called: ${this.xpc}`);this.xpc||(this.xfa=Date.now(),this.Bsa.MH(this.Bvb),this.c3.MH(this.Cvb),this.c3.register(),this.Bsa.register(),this.xpc=!0,this.Cuf(217,3E4))}UAc(){z.ULS.sendTraceTag(521483349,3016,50,`SmartPasteManager - unsub from AL was called: ${this.xpc}`);
this.xpc&&(this.c3.unregister(),this.Bsa.unregister(),this.Bsa.sK(this.Bvb),this.c3.sK(this.Cvb),this.xpc=!1,this.Swf())}pSi(){switch(this.$d.Wyb()){case 1:this.eqe="floatie.gbFormatWithDesignerButton-Menu16";this.Qua.MAg("floatie.gbFormatWithDesignerButton");this.Rua.set(0,{labelText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerAnalyzing,altText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerTooltipAvailable});this.Rua.set(1,{labelText:Box4Intl.Box4Strings.L_PasteFormatWithDesigner,altText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerTooltipAvailable});
this.Rua.set(2,{labelText:Box4Intl.Box4Strings.L_PasteFormatWithDesigner,altText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerTooltipUnavailable});break;case 2:this.eqe="floatie.gbMatchDocumentFormattingButton-Menu16";this.Qua.MAg("floatie.gbMatchDocumentFormattingButton");this.Rua.set(0,{labelText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingAnalyzing,altText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingTooltipAvailable});this.Rua.set(1,{labelText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormatting,
altText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingTooltipAvailable});this.Rua.set(2,{labelText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormatting,altText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingTooltipUnavailable});break;case 3:this.eqe="floatie.gbUseSmartPasteButton-Menu16",this.Qua.MAg("floatie.gbUseSmartPasteButton"),this.Rua.set(0,{labelText:Box4Intl.Box4Strings.L_PasteUseSmartPasteAnalyzing,altText:Box4Intl.Box4Strings.L_PasteUseSmartPasteTooltipAvailable}),this.Rua.set(1,
{labelText:Box4Intl.Box4Strings.L_PasteUseSmartPaste,altText:Box4Intl.Box4Strings.L_PasteUseSmartPasteTooltipAvailable}),this.Rua.set(2,{labelText:Box4Intl.Box4Strings.L_PasteUseSmartPaste,altText:Box4Intl.Box4Strings.L_PasteUseSmartPasteTooltipUnavailable})}}eBc(e){if(0!==this.Rua.size&&this.Rua.get(e)){this.Pna=e;var t=this.Rua.get(e).labelText;e=this.Rua.get(e).altText;var E=document.getElementById(this.eqe);this.Qua.eBc(t,e,E?!0:!1)}else this.pSi(),z.ULS.sendTraceTag(521416988,3016,50,`pasteStateStrings initialized in updateSmartPasteButton method. Correlation id:${this.iUb}`)}gcn(){this.FOa=
null;this.kLb.clear();this.Pna=this.GUc=0;this.Swf()}Cuf(e,t,E=!0){t=new kh.a(2,1,t,()=>{switch(e){case 213:0===this.Pna&&(this.eBc(2),E&&this.UAc());break;case 217:this.UAc()}},e);v.AFrameworkApplication.mc.Zb(t);this.K7a.add(t)}Swf(e=null){if(0!==this.K7a.count)if(e){let t=0;for(;t<this.K7a.count;)this.K7a.J(t).fwa===e?(v.AFrameworkApplication.mc.vf(this.K7a.J(t)),this.K7a.removeAt(t)):t++}else{for(e=0;e<this.K7a.count;e++)v.AFrameworkApplication.mc.vf(this.K7a.J(e));this.K7a.clear()}}Tol(){if(this.pWd.instance){const e=
this.pWd.instance.hFm();if(e!==Hb.a.nil&&e!==this.iUb)return this.iUb=e,this.jTb=!0}else return z.ULS.sendTraceTag(521483347,307,10,"ClipboardActor future not ready"),this.jTb=!0;return this.jTb=0===this.kLb.size}Cyp(e){1===this.Pna&&(this.GUc!==e.length?z.ULS.sendTraceTag(521483346,3016,50,`Missmatch in number of pasted paragraph. Number of cached pasted paragraphs:${this.GUc}. Number of pasted paragraphs:${e.length}`):this.kLb.forEach((t,E)=>{t.jkg<e.length&&(E.parent=e[t.jkg])}))}NUo(e){this.pWd.instance?
this.pWd.instance.J5i=e:z.ULS.sendTraceTag(521483345,307,10,"ClipboardActor future not ready")}uff(e){this.ksj&&(this.CDa=[],this.ksj=!1);this.CDa.push(e)}J8k(){this.UAc();if(0===this.kLb.size)return 0;const e=this.lhc.K8k(this.kLb,this.CDa);0<e?this.FOa.nYa(1):z.ULS.shipAssertTag(520646736,3016,!1);return e}R0i(e){return e?e===wb.a.MZa||e===wb.a.j4||e===wb.a.ywb:!1}cfa(){return this.tg.cfa}Hnp(){const e=ob.a.instance.Qa("Common.ISystemInitiatedFeedback");e&&e.execute(t=>{switch(this.$d.Wyb()){case 1:t.logActivity(Df.a.dlk,
null);break;case 2:t.logActivity(Df.a.jlk,null);break;case 3:t.logActivity(Df.a.wlk,null)}})}}Object(y.a)(Mv,"SmartPasteManager",null,[511,1240]);class tC{constructor(e){this.LKh=e}get ei(){return null!=this.O4g?this.O4g:this.O4g=ob.a.instance.Oa("Box4.Styles.StyleSettings")}getPropertyValue(e,t,E){if(!e)return z.ULS.shipAssertTag(574407567,3016,!1),E;var W=new Zc.ScriptSharpLegacyMap;for(var ha of e.m0j)if(ha.uo.hasProperty(t)){const Ka=ha.cpEnd-ha.fw,sb=ha.uo.getValue(t);if(W.mb(sb)){let dc;W.Z(dc=
sb,W.J(dc)+Ka)}else W.add(sb,Ka)}ha=e.textLength*Df.a.nnp;for(const Ka of W.keys)if(W.J(Ka)>ha)return Ka;if(e.paragraphFormat.hasProperty(t))return e.paragraphFormat.getValue(t);W=e.paragraphFormat.ja(gb.a.styleName,Df.a.mnp);e=this.LKh.ko();this.ei.qr?(W=e.uy().zBa(W),e=e.gh(this.LKh.Ae(W))):e=e.XKa(W);return e?e.ja(t,E):E}}Object(y.a)(tC,"ParagraphFormattingSnapshotReader",null,[1238]);class PA{constructor(){this.Cya=new Ei.a}put(e,t){this.Cya.add(e,t)}bEe(e){let t;return{returnValue:({value:t}=
this.Cya.Dc(e)).returnValue,sWj:t}}remove(e){this.Cya.remove(e)}}Object(y.a)(PA,"ParagraphFormattingStorage",null,[1239]);class Dz{constructor(){this.$Mc=new hk.a(oi.a.th())}put(e,t){this.$Mc.mb(e)?this.$Mc.Z(e,t):this.$Mc.add(e,t)}bEe(e){let t;return{returnValue:({value:t}=this.$Mc.Dc(e,t)).returnValue,$_a:t}}mb(e){return this.$Mc.mb(e)}}Object(y.a)(Dz,"StyleStorage",null,[]);var vG=d(281);class wG{constructor(e){this.Pp=e;this.T$a=!1;this.vz=this.dialog=null;this.bcd=this.LL=0;this.ed=new ua.a;
this.Udg="OnApplyThemeDialogClosed"}showDialog(){this.dialog=new bk.a(!1,!1,!0);this.dialog.Gd=5;this.dialog.pi(WordEditorIntl.WordEditorStrings.L_DesignerApplyThemeDialogTitle,null,this.BPb());this.vz=this.Pp.Vf("DialogShown","ApplyThemeBlockingDialog");this.T$a=!0;z.ULS.sendTraceTag(524121478,3016,50,"Apply theme blocking dialog is shown.");ma.a(Df.a.n9k,!0);this.bcd=this.LL=0;vG.a.delay(6E4).continueWith(()=>{z.ULS.sendTraceTag(509367262,3016,50,"Apply theme blocking dialog started closing after timeout.");
this.Pza(!0)})}R3o(e,t){var E,W;if(null===(E=e.decorators)||void 0===E?0:E.filter(Ka=>Ka.hasImages).length)return!0;const ha=new Set;for(const [Ka,sb]of e.styles)null===(W=sb.decorators)||void 0===W?void 0:W.forEach(dc=>{dc.hasImages&&ha.add(tl.g(Ka))});if(!ha.size)return!1;e=this.Pp.Vf("UserAction","ApplyThemeDialogShouldShow");E=!1;for(const Ka of t.keys())if(ha.has(Ka)){E=!0;break}e.stop();return E}Pza(e=!1){this.T$a&&(e||this.bcd==this.LL)&&(this.dialog.hide(),this.vz.stop(),this.T$a=!1,this.ed.raiseEvent(this.Udg),
z.ULS.sendTraceTag(524121479,3016,50,`Apply theme blocking dialog has closed, isForced: ${e}`),e=[Object.assign(new yi.a,{name:Df.a.l9k,boolean:e})],ma.a(Df.a.k9k,!0,void 0,e))}egf(){this.T$a&&(this.LL+=1)}Hcg(){if(this.T$a)return this.bcd+=1,this.bcd==this.LL?(this.Pza(),!0):!1}ygf(e){this.ed.addHandler(this.Udg,e)}QDj(e){this.ed.removeHandler(this.Udg,e)}BPb(){return{["id"]:"ApplyThemeDialog",["dialogButtonsOption"]:5,["hideCloseButton"]:!0}}}Object(y.a)(wG,"ApplyThemeDialogManagerImpl",null,[1237]);
class Qr{constructor(){this.sa=new ua.a}initialize(){}Pd(){}SRd(e){this.sa.addHandler(Qr.gNa,e)}cEj(e){this.sa.removeHandler(Qr.gNa,e)}}Qr.gNa="OnThemesChanged";Object(y.a)(Qr,"AThemeProvider",null,[1246,511]);class Rn{constructor(e=am.none,t=""){this.labelId=e;this.Iha=t}getLabel(){return this.labelId}getStringId(){return this.Iha}equals(e){return this.Iha||e.Iha?this.Iha===e.Iha:this.labelId===e.labelId}static equals(e,t){return e||t?e&&t?e.equals(t):!1:e===t}toString(){return null!==this.Iha?this.Iha:
null!==this.labelId?this.labelId.toString():""}}Object(y.a)(Rn,"SectionId",null,[]);class Gu extends Qr{constructor(e,t,E,W,ha){super();this.O4=e;this.tV=t;this.F7a=E;this.K4=W;this.$d=ha;this.Vgc=this.Kw=null;this.mvd=new Map([[lp.SectionLabel.Article,am.article],[lp.SectionLabel.CoverLetter,am.coverLetter],[lp.SectionLabel.CoverPage,am.coverPage],[lp.SectionLabel.GeneralDocument,am.generalDocument],[lp.SectionLabel.Invoice,am.invoice],[lp.SectionLabel.Journal,am.journal],[lp.SectionLabel.Letter,
am.letter],[lp.SectionLabel.Letterhead,am.letterhead],[lp.SectionLabel.Main,am.main],[lp.SectionLabel.Notes,am.notes],[lp.SectionLabel.Report,am.report],[lp.SectionLabel.Resume,am.resume],[lp.SectionLabel.Text2Image,am.text2Image],[lp.SectionLabel.ToDoList,am.toDoList]]);this.WAb=new Map([[sq.letters,{id:"817f4488-91de-4a44-842e-44670553632b",displayName:"Letters"}],[sq.writing,{id:"e3abc6aa-ea3f-4d0f-887d-e929caf85eaf",displayName:"Writing"}],[sq.lists,{id:"d9d2be59-6d2a-41b7-bd37-74507d741f9c",
displayName:"Lists"}],[sq.resumes,{id:"39b64df5-1fb2-4699-b467-028bb20986e3",displayName:"Resumes"}],[sq.business,{id:"f2015b9f-1a5f-4cdf-813a-3cbedcd28768",displayName:"Business"}],[sq.education,{id:"f9f17e14-9f18-4872-ab1d-c4e05a7e3446",displayName:"Education"}],[sq.newsletters,{id:"dd8a511d-30c7-4019-8cfe-611888ea2450",displayName:"Newsletters"}]]);this.activeSection=null;this.isInitialized=!1;this.WRh=(Ka,sb)=>{var dc;this.O4.sK(this.WRh);if(sb.data.annotation)if(sb.data.annotation.annotationType!==
lp.ThemeGeneratorAnnotation.getTypeName())z.ULS.shipAssertTag(545399813,3016,!1);else if(Ka=sb.data.annotation.content){if(null===(dc=Ka.sections)||void 0===dc?0:dc.length)this.Kw=this.rfm(Ka);this.sa.raiseEvent(Qr.gNa)}else z.ULS.shipAssertTag(545399814,3016,!1);else z.ULS.shipAssertTag(545399812,3016,!1)};this.whg=()=>{var Ka;this.Kw&&(this.CGf(this.Kw)||(this.Kw=null===(Ka=this.Kw)||void 0===Ka?void 0:Ka.map(sb=>{sb.id.getLabel()===am.text2Image&&(sb.isLoaded=!0,sb.items=[]);return sb})),this.sa.raiseEvent(Qr.gNa))};
this.aVn=()=>{var Ka;const sb=this.SGi(this.Kw,am.text2Image);null!==sb&&void 0!==sb&&sb.items&&(this.tV.initialize(),this.tV.Agf(this.whg),this.tV.XFj()?this.CGf(this.Kw)||(this.Kw=null===(Ka=this.Kw)||void 0===Ka?void 0:Ka.filter(dc=>dc.id.getLabel()!==am.text2Image)):sb.isLoaded=!1,this.sa.raiseEvent(Qr.gNa))}}Y9d(){return this.Kw}Q4c(){return this.Vgc}sjc(){return this.activeSection}V_(){return!1}nie(){}initialize(){this.isInitialized||(this.O4.MH(this.WRh),this.O4.JAa(new lp.ThemeGeneratorSignal),
this.K4.PPh(this.aVn),this.isInitialized=!0)}Pd(){}rfm(e){let t=[];this.Vgc=new hk.a(oi.a.th());this.activeSection=e.activeSection;for(const E of e.sections){if(E.label===lp.SectionLabel.CoverPage&&!$k())continue;e=[];for(const Ka of E.items){const sb=Ka;Yi.a.XR&&["D7ST","D14ST","D25ST"].some(dc=>dc===sb.name)||(this.Vgc.add(sb.name,sb.id),e.push(this.getTheme(sb,E)))}let W=null,ha=null;if(this.$d.ptb()){const Ka=this.Gwi(this.mvd.get(E.label));Ka&&(W=Ka.id,ha=Ka.displayName)}t.push({label:this.mvd.get(E.label),
labelDisplayName:ha,id:new Rn(this.mvd.get(E.label),W),displayName:ha,items:e,isLoaded:E.label!==lp.SectionLabel.Text2Image,V_:!1});E.label==lp.SectionLabel.Text2Image&&(this.tV.initialize(),this.tV.Agf(this.whg),this.tV.XFj()&&(this.CGf(t)||(t=null===t||void 0===t?void 0:t.filter(Ka=>Ka.id.getLabel()!==am.text2Image))))}return t}Gwi(e){switch(e){case am.letter:case am.coverLetter:case am.letterhead:return this.WAb.get(sq.letters);case am.generalDocument:case am.journal:return this.WAb.get(sq.writing);
case am.toDoList:return this.WAb.get(sq.lists);case am.resume:return this.WAb.get(sq.resumes);case am.notes:case am.invoice:return this.WAb.get(sq.business);case am.report:return this.WAb.get(sq.education);case am.article:return this.WAb.get(sq.newsletters)}}getTheme(e,t){const E=new Map;let W=!1;for(const Ka of e.roles){var ha=tl.f(Ka.type);E.set(tl.h(ha),{decorators:this.F7a.rsi(Ka.style.decorators),fontName:Uk(Ka.style.fontFamily),fontSize:Ka.style.fontSize,fontColor:Ka.style.fontColor,bold:Ka.style.bold,
italic:Ka.style.italic,underline:Ka.style.underline,alignment:Ka.style.alignment,lineSpacing:Ka.style.lineSpacing,beforeSpacing:Ka.style.beforeSpacing,afterSpacing:Ka.style.afterSpacing,specialIndentType:Ka.style.specialIndentType,specialIndentBy:Ka.style.specialIndentBy,fontKerning:Ka.style.fontKerning,allCaps:Ka.style.allCaps});Ka.style.decorators&&(W=!0);ha=Ka.style.fontFamily;up.a.tKa.isEnabled?up.a.tKa.Hra(ha):up.a.DJa.isEnabled&&up.a.DJa.Hra(ha)}t=this.Gwi(this.mvd.get(t.label));return{type:e.type,
name:e.name,id:e.id,styles:E,decorators:this.F7a.rsi(e.decorators),layout:e.layout,accentColor:e.accentColor,backgroundColor:e.backgroundColor,isSimpleTheme:!e.decorators&&!W,collectionId:null===t||void 0===t?void 0:t.id,collectionName:null===t||void 0===t?void 0:t.displayName,IsL2Template:!1}}SGi(e,t){if(!e)return null;for(const E of e)if(E.id.getLabel()===t)return E;return null}CGf(e){var t;const E=this.tV.Wvm();this.tV.WDj(this.whg);this.tV.Pd();if(!E||null===(t=E.zU)||void 0===t||!t.length||E.zU[0].category!==
Sa.SuggestionCategory.TextRelatedImage)return!1;e=this.SGi(e,am.text2Image);e.isLoaded=!0;null===e||void 0===e?void 0:e.items.forEach(W=>{var ha;W.decorators=null===(ha=W.decorators)||void 0===ha?void 0:ha.map(Ka=>Ka.type===Oo.text2Image?{...Ka,imageUrl:E.baseUrl+E.zU[0].imageId,thumbnailUrl:E.baseUrl+E.zU[0].thumbnailId,altText:E.zU[0].altText}:Ka)});return!0}}Object(y.a)(Gu,"AugLoopThemeProvider",Qr,[]);class gl{constructor(e,t){this.text=e;this.role=t}}Object(y.a)(gl,"BlankDocSentence",null,[]);
class Dy{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc){this.LYj=1;this.Qd=e;this.Tp=t;this.Ge=E;this.Zc=W;this.fF=ha;this.Oh=Ka;this.dkb=sb;this.jb=dc;this.OZ=xc;this.GQa=Rc}rce(e){var t=Object(Ne.a)(sn.AParagraphNode,this.jb.Zl(this.GQa.jd));t=this.aan(t);this.qep(t);e&&this.E9m(t)}N4j(e,t,E,W){let ha=Zd.a.createTextRange(t,e,e+this.LYj);this.Qd.Ne(ha,E);ha=Zd.a.createTextRange(t,e,e+E.length);t.F_(e);t.qa.sh(e).hyperlink=this.fF.vF(ha,W,!0);this.OZ.e_(ha,Ka=>{this.Ge.eod(Ka,!0)})}sEe(e,t,E){let W=Zd.a.createTextRange(t,
e,e+this.LYj);this.Qd.Ne(W,E);W=Zd.a.createTextRange(t,e,e+E.length);this.OZ.e_(W,ha=>{this.Ge.SN(ha,!0)})}aan(e){let t=Object(Ne.a)(Ld.GraphIterator,this.Zc.jg(e));t.Jd();const E=new fa.a;for(let W=0;10>W;W++){const ha=Dy.Xkf[W];lg.OutlineElementNavigator.he(t);this.Oh.$z(t,!1,!1);this.Oh.QJ(t);E.add(t.currentNode);const Ka=Zd.a.Tc(t.currentNode,0);this.Qd.Ne(Ka,ha.text,!0,!1);this.dkb.Ija(t.currentNode,ha.role)}t=Object(Ne.a)(Ld.GraphIterator,this.Zc.jg(e));t.Jd();lg.OutlineElementNavigator.he(t);
t.eh();return E}qep(e){let t=0;for(const E of e)e=E.characterData.indexOf("$"),-1!==e&&(3===t?this.N4j(e,E,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentLearnMoreDesigner,Df.a.Hcl):6===t?(this.sEe(e,E,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentHomeStylesBold),e=E.characterData.indexOf("$"),this.sEe(e,E,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentStylesBold),e=E.characterData.indexOf("$"),this.N4j(e,E,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentLearnMoreStyles,
Df.a.Icl)):7===t?this.sEe(e,E,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentHomeDesignerBold):9===t&&this.sEe(e,E,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentHomeDesignerBold)),t++}E9m(e){let t=0;for(;t<e.count;){var E=e.J(t);const ha=Dy.Xkf[t].role;for(;t+1<e.count&&Dy.Xkf[t+1].role==ha;)t++;var W=e.J(t);({id:E,returnValue:W}=this.Tp.Nqa(E.id,W.id));0===W?(E=this.Tp.getById(E),E.title=tl.i(ha),E.RL=!0,E.removeWhenEdited=!0):z.ULS.shipAssertTag(528312211,3016,!1);t++}}}Dy.Xkf=
[new gl(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentTitle,2),new gl(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentSubtitle,3),new gl(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentFirstHeading,4),new gl(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentFirstParagraph,13),new gl(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentSecondHeading,5),new gl(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentSecondParagraph,13),new gl(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentThirdParagraph,
13),new gl(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentFourthParagraph,13),new gl(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentThirdHeading,5),new gl(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentFifthParagraph,13)];Object(y.a)(Dy,"BlankDocumentEditor",null,[1236]);d(441);class du extends rC.a{constructor(){super();du.resolveInheritance();this.$$ge=this.getEnumerator}}Object(y.a)(du,"IntSet",rC.a,[18,19]);d(271);d(322);var bv=d(1781);const LI=[hf.RoleType.Title,
hf.RoleType.Subtitle,hf.RoleType.Heading1,hf.RoleType.Heading2,hf.RoleType.Heading3,hf.RoleType.Heading4,hf.RoleType.Heading5,hf.RoleType.Heading6,hf.RoleType.Heading7,hf.RoleType.Heading8,hf.RoleType.Heading9,hf.RoleType.BodyText,hf.RoleType.ListItem],uC=[xb.FormattingSuggestionType.FontSize,xb.FormattingSuggestionType.FontFamily,xb.FormattingSuggestionType.FontColor,xb.FormattingSuggestionType.Alignment,xb.FormattingSuggestionType.Indentation,xb.FormattingSuggestionType.Bold,xb.FormattingSuggestionType.RightIndentation,
xb.FormattingSuggestionType.Italic,xb.FormattingSuggestionType.Underline,xb.FormattingSuggestionType.AllCaps,xb.FormattingSuggestionType.LineSpacing,xb.FormattingSuggestionType.BeforeSpacing,xb.FormattingSuggestionType.AfterSpacing,xb.FormattingSuggestionType.SpecialIndentType,xb.FormattingSuggestionType.SpecialIndentBy];class wk extends Qr{static Mol(e){const t=e.map(E=>E.roleType);return LI.every(E=>t.includes(E))}static Nol(e){return e.every(t=>{const E=t.suggestions.map(W=>W.type);return uC.every(W=>
E.includes(W))})}}Object(y.a)(wk,"ACurrentThemeProvider",Qr,[]);class gE{constructor(){this.decorators=void 0;this.fontName=null;this.fontColor=this.fontSize=0;this.underline=this.italic=this.bold=!1;this.alignment=Hn.initial;this.allCaps=!1;this.rightIndent=this.leftIndent=this.afterSpacing=this.beforeSpacing=this.lineSpacing=0;this.specialIndentType=Xs.initial;this.fontKerning=this.specialIndentBy=0}}Object(y.a)(gE,"DesignerStyle",null,[]);class xG{constructor(){this.type=Pp.theme;this.styles=this.id=
this.name=null;this.decorators=void 0;this.layout=null;this.accentColor=0;this.colorLabel=this.fontLabel=null;this.backgroundColor=void 0;this.isThemeInFavorites=this.isSimpleTheme=!1;this.collectionName=this.collectionId=null;this.IsL2Template=!1}}Object(y.a)(xG,"DesignerTheme",null,[]);class Zm extends wk{constructor(e){super();this.qSe=null;this.kIh=0;this.IFc=void 0;this.ui=!1;this.y0j=(t,E)=>{E.data.operationType===sh.a.getTypeName()&&(E.data.annotation?E.data.annotation.annotationType!==bv.ThemeExtractorAnnotation.getTypeName()?
z.ULS.shipAssertTag(543745801,3016,!1):(t=E.data.annotation.content)?t.roleCommonProperties?(t=t.roleCommonProperties,this.qSe=Zm.Osi(t,!1),wk.Mol(t)&&wk.Nol(t)&&Zm.Osi(t,!0),this.kIh=tb.a.Ee(),this.uGo(),this.sa.raiseEvent(Qr.gNa),z.ULS.sendTraceTag(524105094,3016,50,"theme provided")):(this.Cwo(),z.ULS.sendTraceTag(524105093,3016,50,"no roleCommonProperties")):z.ULS.shipAssertTag(543745802,3016,!1):z.ULS.shipAssertTag(543745800,3016,!1))};this.UQc=e}get x5l(){return this.qSe}Y9d(){return[]}sjc(){return null}Q4c(){const e=
new hk.a(oi.a.th());this.qSe&&e.add(Zm.zci,255);return e}V_(){return!1}nie(){}initialize(){this.ui||(z.ULS.sendTraceTag(540312158,3016,50,"CurrentThemeProvider - initialize"),this.UQc.register(),this.UQc.MH(this.y0j),this.UQc.JAa(new bv.ThemeExtractorSignal),this.ui=!0)}Pd(){this.ui&&(z.ULS.sendTraceTag(540312159,3016,50,"CurrentThemeProvider - deinitialize"),this.UQc.sK(this.y0j),this.UQc.unregister(),this.ui=!1)}JU(){return 1E3>tb.a.Ee()-this.kIh}Cwo(){void 0!==this.IFc&&this.IFc.reject(Error("Theme was not extracted successfully"))}uGo(){void 0!==
this.IFc&&(this.IFc.resolve(this.x5l),this.IFc=void 0)}static Osi(e,t=!0){const E=new hk.a(oi.a.th());for(var W of e)if(t||!W.isGenerated){e=new gE;for(var ha of W.suggestions){var Ka=ha.fixedValue;switch(ha.type){case xb.FormattingSuggestionType.FontSize:e.fontSize=parseFloat(Ka)/2;break;case xb.FormattingSuggestionType.FontFamily:e.fontName=Ka;break;case xb.FormattingSuggestionType.FontColor:e.fontColor=parseInt(Ka);break;case xb.FormattingSuggestionType.Alignment:e.alignment=this.rRl(parseInt(Ka));
break;case xb.FormattingSuggestionType.Indentation:e.leftIndent=parseFloat(Ka);break;case xb.FormattingSuggestionType.Bold:e.bold="true"===Ka;break;case xb.FormattingSuggestionType.RightIndentation:e.rightIndent=parseFloat(Ka);break;case xb.FormattingSuggestionType.Italic:e.italic="true"===Ka;break;case xb.FormattingSuggestionType.Underline:e.underline="true"===Ka;break;case xb.FormattingSuggestionType.AllCaps:e.allCaps="true"===Ka;break;case xb.FormattingSuggestionType.LineSpacing:e.lineSpacing=
parseFloat(Ka);break;case xb.FormattingSuggestionType.BeforeSpacing:e.beforeSpacing=parseFloat(Ka);break;case xb.FormattingSuggestionType.AfterSpacing:e.afterSpacing=parseFloat(Ka);break;case xb.FormattingSuggestionType.SpecialIndentType:e.specialIndentType=this.Q$o(parseInt(Ka));break;case xb.FormattingSuggestionType.SpecialIndentBy:e.specialIndentBy=parseFloat(Ka)}}Ka=tl.f(W.roleType);E.add(tl.h(Ka),e)}t=Object;W=t.assign;ha=new xG;e=Zm.zci;Ka=new Map;for(const sb of E)Ka.set(sb.key,sb.value);return W.call(t,
ha,{name:e,styles:Ka})}static rRl(e){switch(e){case 0:return Hn.left;case 1:return Hn.right;case 2:return Hn.center;case 3:return Hn.justify;default:return Hn.left}}static Q$o(e){switch(e){case 0:return Xs.firstLine;case 1:return Xs.hanging;default:return Xs.firstLine}}}Zm.zci="CurrentTheme";Object(y.a)(Zm,"CurrentThemeProvider",wk,[]);var vp=d(55);class Yn{static Iul(e){let t;[e,E,t]=Ok.a.Wae(e);e=255*e/Ok.a.c8;t=255*t/Ok.a.c8;var E=255*E/Ok.a.c8;if(240<t)return WordEditorIntl.WordEditorStrings.L_ColorWhite;
if(20>t)return WordEditorIntl.WordEditorStrings.L_ColorBlack;if(20>=E)return 170<t?WordEditorIntl.WordEditorStrings.L_ColorGray25:100<t?WordEditorIntl.WordEditorStrings.L_ColorGray50:WordEditorIntl.WordEditorStrings.L_ColorGray80;E=20<E&&75>=E?Yn.jgk:75<E&&115>=E?Yn.kgk:115<E&&150>=E?Yn.lgk:150<E&&240>=E?Yn.mgk:Yn.ngk;let W=0;for(;W<E.length&&e>=E[W];)W++;if(W==E.length)z.ULS.sendTraceTag(512570762,3023,10,"Hue index out of bounds");else return t>Yn.shk[W]?Yn.uek[W]:t<Yn.thk[W]?Yn.tek[W]:Yn.vek[W]}}
Yn.uek=[WordEditorIntl.WordEditorStrings.L_ColorCoral,WordEditorIntl.WordEditorStrings.L_ColorRose,WordEditorIntl.WordEditorStrings.L_ColorLightOrange,WordEditorIntl.WordEditorStrings.L_ColorTan,WordEditorIntl.WordEditorStrings.L_ColorTan,WordEditorIntl.WordEditorStrings.L_ColorLightYellow,WordEditorIntl.WordEditorStrings.L_ColorLightYellow,WordEditorIntl.WordEditorStrings.L_ColorTan,WordEditorIntl.WordEditorStrings.L_ColorLightGreen,WordEditorIntl.WordEditorStrings.L_ColorLime,WordEditorIntl.WordEditorStrings.L_ColorLightGreen,
WordEditorIntl.WordEditorStrings.L_ColorLightGreen,WordEditorIntl.WordEditorStrings.L_ColorAqua,WordEditorIntl.WordEditorStrings.L_ColorSkyBlue,WordEditorIntl.WordEditorStrings.L_ColorLightTurquoise,WordEditorIntl.WordEditorStrings.L_ColorPaleBlue,WordEditorIntl.WordEditorStrings.L_ColorLightBlue,WordEditorIntl.WordEditorStrings.L_ColorIceBlue,WordEditorIntl.WordEditorStrings.L_ColorPeriwinkle,WordEditorIntl.WordEditorStrings.L_ColorLavender,WordEditorIntl.WordEditorStrings.L_ColorPink,WordEditorIntl.WordEditorStrings.L_ColorTan,
WordEditorIntl.WordEditorStrings.L_ColorRose];Yn.vek=[WordEditorIntl.WordEditorStrings.L_ColorCoral,WordEditorIntl.WordEditorStrings.L_ColorRed,WordEditorIntl.WordEditorStrings.L_ColorOrange,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorTan,WordEditorIntl.WordEditorStrings.L_ColorGold,WordEditorIntl.WordEditorStrings.L_ColorYellow,WordEditorIntl.WordEditorStrings.L_ColorOliveGreen,WordEditorIntl.WordEditorStrings.L_ColorOliveGreen,WordEditorIntl.WordEditorStrings.L_ColorGreen,
WordEditorIntl.WordEditorStrings.L_ColorGreen,WordEditorIntl.WordEditorStrings.L_ColorBrightGreen,WordEditorIntl.WordEditorStrings.L_ColorTeal,WordEditorIntl.WordEditorStrings.L_ColorAqua,WordEditorIntl.WordEditorStrings.L_ColorTurquoise,WordEditorIntl.WordEditorStrings.L_ColorPaleBlue,WordEditorIntl.WordEditorStrings.L_ColorBlue,WordEditorIntl.WordEditorStrings.L_ColorBlueGray,WordEditorIntl.WordEditorStrings.L_ColorIndigo,WordEditorIntl.WordEditorStrings.L_ColorGalleryStandardColor10,WordEditorIntl.WordEditorStrings.L_ColorPink,
WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorRed];Yn.tek=[WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorDarkRed,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorDarkYellow,WordEditorIntl.WordEditorStrings.L_ColorDarkYellow,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorDarkGreen,
WordEditorIntl.WordEditorStrings.L_ColorDarkGreen,WordEditorIntl.WordEditorStrings.L_ColorDarkGreen,WordEditorIntl.WordEditorStrings.L_ColorDarkGreen,WordEditorIntl.WordEditorStrings.L_ColorDarkTeal,WordEditorIntl.WordEditorStrings.L_ColorDarkTeal,WordEditorIntl.WordEditorStrings.L_ColorDarkTeal,WordEditorIntl.WordEditorStrings.L_ColorDarkBlue,WordEditorIntl.WordEditorStrings.L_ColorDarkBlue,WordEditorIntl.WordEditorStrings.L_ColorBlueGray,WordEditorIntl.WordEditorStrings.L_ColorIndigo,WordEditorIntl.WordEditorStrings.L_ColorDarkPurple,
WordEditorIntl.WordEditorStrings.L_ColorPlum,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorDarkRed];Yn.jgk=[8,0,0,44,0,0,0,63,0,0,122,0,134,0,0,0,0,166,176,241,0,256,0];Yn.kgk=[0,10,0,32,46,0,0,0,61,0,106,0,136,144,0,0,0,158,166,241,0,0,256];Yn.lgk=[0,8,0,0,39,46,0,0,0,71,120,0,131,144,0,0,163,0,177,211,249,0,256];Yn.mgk=[0,11,26,0,0,38,45,0,0,56,100,121,129,0,140,0,180,0,0,224,241,0,256];Yn.ngk=[0,13,27,0,0,36,45,0,0,59,118,0,127,136,142,0,185,0,0,216,239,
0,256];Yn.thk=[130,100,115,100,100,100,110,75,100,90,100,100,100,100,80,100,100,100,100,100,100,100,100];Yn.shk=[170,170,170,155,170,170,170,170,170,115,170,170,170,170,170,170,170,170,150,150,170,140,165];Object(y.a)(Yn,"ColorNaming",null,[]);const pt=new Map([[3044790,3044790],[5269211,5269211],[32684,32684],[15362836,8600587],[13977459,11348049],[169590,160089],[1596093,1596093]]),Ax=WordEditorIntl.WordEditorStrings.L_DesignerStyleTabularTitleDecoratorAltTextTitle,MI=WordRibbonStrings.DesignerStyleCoverPageDecoratorAriaLabel,
Is=new Map([[Ff.a.ki("D10TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD10TIAltTextTitle,width:624,height:193}],[Ff.a.ki("D1TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1TIAltTextTitle,width:624,height:190}],[Ff.a.ki("D6TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD6TIAltTextTitle,width:624,height:193}],[Ff.a.ki("D7TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD7TIAltTextTitle,width:1575,height:728}],
[Ff.a.ki("D31TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD31TIAltTextTitle,width:1428,height:390}],[Ff.a.ki("D3TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD3TIAltTextTitle,width:2216,height:720}],[Ff.a.ki("D8TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TIAltTextTitle,width:1852,height:694}],[Ff.a.ki("D2TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD2TIAltTextTitle,width:1299,height:471}],[Ff.a.ki("D8TI1.png"),
{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI1AltTextTitle,width:1661,height:785}],[Ff.a.ki("D8TI2.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI2AltTextTitle,width:1619,height:848}],[Ff.a.ki("D8TI3a.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI3aAltTextTitle,width:1602,height:473}],[Ff.a.ki("D8TI4a.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI4aAltTextTitle,width:1613,height:211}],[Ff.a.ki("D8TI5.png"),
{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI5AltTextTitle,width:1595,height:498}],[Ff.a.ki("D10TI2.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD10TI2AltTextTitle,width:1281,height:357}],[Ff.a.ki("D30TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD30TIAltTextTitle,width:1377,height:315}],[Ff.a.ki("DCL1TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageDCL1TIAltTextTitle,width:2017,height:800}],[Ff.a.ki("DCL3TI.png"),
{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageDCL3TIAltTextTitle,width:1246,height:551}],[Ff.a.ki("D1CP1.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1CP1AltTextTitle,width:2112,height:1364}],[Ff.a.ki("D1CP2.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1CP2AltTextTitle,width:624,height:624}],[Ff.a.ki("D1CP3.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1CP3AltTextTitle,width:624,height:433}],[Ff.a.ki("D1CP4.png"),
{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1CP4AltTextTitle,width:624,height:416}],[Ff.a.ki("DLT1.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:221}],[Ff.a.ki("DLT2.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:540}],[Ff.a.ki("DLT3.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2048,height:152}],[Ff.a.ki("DLT4.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,
width:2448,height:300}],[Ff.a.ki("DLT5.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:300}],[Ff.a.ki("DLT6.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:709}],[Ff.a.ki("DLT7.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:300}],[Ff.a.ki("DLT8.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:280}],[Ff.a.ki("DLT9.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,
width:2448,height:704}],[Ff.a.ki("DLT10.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:593}],[Ff.a.ki("DLT11.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:380}],[Ff.a.ki("DLT12.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:160}]]);var Hu=d(630),hE=d(1286),Nv=d(380);class Vi{static oSm(){Vi.Db||(Vi.Db=new Zc.ScriptSharpLegacyMap,Vi.Db.add(Tb.a.font,Le.a.RJ),Vi.Db.add(fd.a.Ue,
-1),Vi.Db.add(fd.a.Se,-1),Vi.Db.add(fd.a.pf,-1),Vi.Db.add(fd.a.We,-1),Vi.Db.add(fd.a.Qe,-1),Vi.Db.add(fd.a.DW,""),Vi.Db.add(fd.a.M2,""),Vi.Db.add(fd.a.nE,""),Vi.Db.add(fd.a.r3,""),Vi.Db.add(fd.a.G_,""),Vi.Db.add(Tb.a.fontSize,Le.a.gP),Vi.Db.add(Tb.a.fontColor,Ok.a.auto),Vi.Db.add(Tb.a.highlight,Ok.a.auto),Vi.Db.add(gb.a.Qx,Ok.a.auto),Vi.Db.add(Tb.a.DN,0),Vi.Db.add(Tb.a.bold,!1),Vi.Db.add(Tb.a.italic,!1),Vi.Db.add(Tb.a.underline,!1),Vi.Db.add(Tb.a.underlineType,Le.a.HS),Vi.Db.add(Tb.a.strikethrough,
!1),Vi.Db.add(gb.a.du,!1),Vi.Db.add(Tb.a.superscript,!1),Vi.Db.add(Tb.a.subscript,!1),Vi.Db.add(ad.a.X0a,!1),Vi.Db.add(fd.a.dw,""),Vi.Db.add(Tb.a.sD,!1),Vi.Db.add(Tb.a.O7,!1),Vi.Db.add(Tb.a.isHidden,!1),Vi.Db.add(fd.a.S$a,!1),Vi.Db.add(fd.a.Xpb,0),Vi.Db.add(fd.a.noProof,!1),Vi.Db.add(dj.a.mcg,!1),Vi.Db.add(gb.a.capitalization,0),Vi.Db.add(fd.a.fga,!1),Vi.Db.add(fd.a.f4,0),Vi.Db.add(fd.a.hC,0),Vi.Db.add(fd.a.Pma,0),Vi.Db.add(fd.a.mu,0),Vi.Db.add(fd.a.IP,0),Vi.Db.add(fd.a.fe,0),Vi.Db.add(fd.a.mv,0),
Vi.Db.add(fd.a.Qma,0),Vi.Db.add(gb.a.Wgd,0),Vi.Db.add(gb.a.Vgd,0),Vi.Db.add(fd.a.wj,Nv.a.MAe),Vi.Db.add(fd.a.ta,Nv.a.FEg),Vi.Db.add(fd.a.ya,Nv.a.ya),Vi.Db.add(fd.a.xa,Nv.a.lineSpacing),Vi.Db.add(fd.a.y8,Nv.a.sde),Vi.Db.add(fd.a.x8,Nv.a.nde),Vi.Db.add(fd.a.H0,Nv.a.GEg),Vi.Db.add(fd.a.G0,Nv.a.EEg),Vi.Db.add(Tb.a.Rh,0),Vi.Db.add(Tb.a.sr,0),Vi.Db.add(gb.a.Pjd,!1),Vi.Db.add(fd.a.Jx,null),Vi.Db.add(fd.a.cB,null),Vi.Db.add(fd.a.bB,null),Vi.Db.add(fd.a.vj,-1));return Vi.Db}}Vi.Db=null;Object(y.a)(Vi,"DefaultStyle",
null,[]);class Nq{constructor(e,t,E,W,ha){this.Zoa=e;this.xe=t;this.Rbc=E;this.JNd=W;this.TQe=ha}T0l(e){return this.pNn(e)}geb(e){var t=Pd.a.Mp();t=pl.WordSectionNavigator.instance.cKf(t);e.layout||(e.layout={marginTop:Df.a.ZZd,marginBottom:Df.a.ZZd,marginLeft:Df.a.ZZd,marginRight:Df.a.ZZd});t.properties.setValue(fd.a.marginTop,Ve.a.Ow(e.layout.marginTop));t.properties.setValue(fd.a.marginBottom,Ve.a.Ow(e.layout.marginBottom));t.properties.setValue(fd.a.marginLeft,Ve.a.Ow(e.layout.marginLeft));t.properties.setValue(fd.a.marginRight,
Ve.a.Ow(e.layout.marginRight))}pNn(e){if(!e)return z.ULS.shipAssertTag(574755655,3016,!1),!1;let t=!0;e.type===Pp.templateTheme&&this.geb(e);const E=this.xe.ko();if(e.styles.has("BodyText")){var W=e.styles.get("BodyText");t=this.Odd(W,13,E)}else z.ULS.shipAssertTag(543745807,3016,!1);e.styles.forEach((ha,Ka)=>{Ka=tl.g(Ka);if(13!==Ka&&14!==Ka||14===Ka&&this.Zoa.Bta())t=this.Odd(ha,Ka,E)});if(this.Zoa.yXi())for(W=16;25>=W;W++){const ha=tl.h(W);e.styles.has(ha)||this.Fup(W,e,E)||(t=!1)}return t}Odd(e,
t,E){var W;let ha=tl.j(t),Ka=E.gh(ha);!Ka&&14===t&&this.Zoa.Bta()&&(z.ULS.sendTraceTag(null,3018,15,"No Caption style in the document."),ha=tl.j(13),Ka=E.gh(ha));E=2===(null===(W=this.TQe)||void 0===W?void 0:W.WVa())?Nq.rxf(e,t,!0):this.wOf(t,e,Ka,!0);if(Ka){if(this.JNd.put(ha,Ka.clone().Qj()),E&&!this.Rbc.DYa(tl.j(t),E,null))return!1}else return z.ULS.shipAssertTag(571999311,3016,!1),!1;return!0}Fup(e,t,E){const W=tl.j(e);E=E.gh(W);if(!E)return z.ULS.shipAssertTag(571012639,3016,!1),!1;const ha=
new Zc.ScriptSharpLegacyMap;t=t.accentColor;e=tl.c(e)?pt.has(t)?pt.get(t):0:0;ha.add(Tb.a.fontColor,0===e?Ok.a.auto:Ok.a.T0(e));this.JNd.put(W,E.clone().Qj());return this.Rbc.DYa(W,ha,null)}wOf(e,t,E,W){if(W||!E){e=Nq.rxf(t,e);if(W&&E&&(E=E.fk()))for(W=0;W<E.length;W++)if(t=E[W],!e.mb(t)){let ha;({value:ha}=Vi.oSm().Dc(t,ha)).returnValue&&e.add(t,ha)}return e}return null}static rxf(e,t,E=!1){const W=new Zc.ScriptSharpLegacyMap;if(e.fontName){const ha=It(e.fontName);W.add(fd.a.DW,ha);W.add(Tb.a.font,
ha)}void 0!==e.fontColor&&W.add(Tb.a.fontColor,0===e.fontColor?Ok.a.auto:Ok.a.T0(e.fontColor));void 0!==e.bold&&W.add(Tb.a.bold,e.bold);void 0!==e.italic&&W.add(Tb.a.italic,e.italic);void 0!==e.underline&&W.add(Tb.a.underline,e.underline);void 0!==e.allCaps&&W.add(gb.a.capitalization,e.allCaps?2:0);if(E)return W;void 0!==e.fontSize&&W.add(Tb.a.fontSize,2*e.fontSize);void 0!==e.alignment&&W.add(Tb.a.Rh,Nq.sRl(e.alignment));void 0!==e.beforeSpacing&&W.add(fd.a.wj,Ve.a.RF(e.beforeSpacing));void 0!==
e.afterSpacing&&W.add(fd.a.ta,Ve.a.RF(e.afterSpacing));W.add(fd.a.yx,15===t);W.add(fd.a.vj,tl.a(t));e.lineSpacing&&(t=Object.assign(new Hu.a,{unit:2,value:e.lineSpacing}),({xa:t,nPg:E}=hE.a.tLf(t)).returnValue?(W.add(fd.a.ya,E),W.add(fd.a.xa,t)):z.ULS.shipAssertTag(592454611,3016,!1));switch(e.specialIndentType){case Xs.firstLine:W.add(fd.a.hC,Ve.a.Ow(e.specialIndentBy));break;case Xs.hanging:W.add(fd.a.mu,Ve.a.Ow(e.specialIndentBy))}return W}static sRl(e){switch(e){case Hn.left:return 1;case Hn.center:return 2;
case Hn.right:return 3;case Hn.justify:return 6;default:return z.ULS.shipAssertTag(592720768,3016,!1),null}}}Object(y.a)(Nq,"StyleManager",null,[1222]);class Jm{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj,zl,Wl,Rh){this.Sb=e;this.qL=t;this.hn=E;this.Kf=W;this.lb=ha;this.hk=Ka;this.Xna=sb;this.pK=dc;this.rg=xc;this.Om=Rc;this.gR=md;this.Rm=ud;this.IA=Ud;this.km=Id;this.Oua=Ee;this.Vb=kf;this.oca=Ke;this.A2=dh;this.$d=$h;this.nXb=rj;this.jr=zl;this.lo=Wl;this.tL=Rh;this.vdi=
36;this.Dej=20}Mif(e,t,E){var W,ha,Ka,sb,dc,xc,Rc;if(e)if(t){var md=!0,ud=null===(W=this.lb.gb)||void 0===W?void 0:W.currentSelection;e=Xf.ParagraphReader.Zl(e,!0,!0);null===(ha=this.jr)||void 0===ha?void 0:ha.JEa();ha=this.Z9m(e,t);null===(Ka=this.jr)||void 0===Ka?void 0:Ka.lza();md&&(md=0<(null===ha||void 0===ha?void 0:ha.length));if(md){E===Pp.templateTheme&&this.rQl(ha);Ka=new Set;md=new Map;for(const Ud of ha)Ud.YH&&Ka.add(Ud.YH);this.Sho(Ka,t,md)?this.Byp(ha,t,md,E)?(this.Tho(Ka,t),this.xao(ha,
t),this.scrollIntoView(ha,E===Pp.templateTheme),E!==Pp.templateTheme&&(null===(dc=null===(sb=null===ud||void 0===ud?void 0:ud.Ra)||void 0===sb?void 0:sb.node)||void 0===dc?0:dc.isConnected)&&(null===(xc=this.jr)||void 0===xc?void 0:xc.JEa(),this.lb.Ic(ud),null===(Rc=this.jr)||void 0===Rc?void 0:Rc.lza())):z.ULS.shipAssertTag(520937801,3016,!1):z.ULS.shipAssertTag(520937802,3016,!1)}else z.ULS.shipAssertTag(520937803,3016,!1)}else z.ULS.shipAssertTag(536941707,3016,!1);else z.ULS.shipAssertTag(536941706,
3016,!1)}rQl(e){if(0<(null===e||void 0===e?void 0:e.length)){const t=e[e.length-1];!this.hn.jg(t).zb(14)&&Xf.ParagraphReader.isEmpty(this.hn.jg(t))&&(this.Kf.YDa(t),e.pop())}}Sho(e,t,E){let W=void 0,ha=!0;try{W=this.IA.Mc(15,wb.a.A$a,!1);W.Xz.Ab(this.Sh);for(const Ka of e)ha&&(ha=this.mGo(Ka,t,E)),ap(Ka,this.hk,!1,sb=>sb.Wg),Zk(Ka,this.hk,MI),t.widthOption===Nm.stretchEdgeToEdge&&(this.Xna.setCellPadding(Ka,1,this.vdi),this.Xna.setCellPadding(Ka,3,this.vdi))}finally{W&&W.dispose()}return ha}xao(e,
t){for(const E of e)E.YH||this.qL.write(E,t)}Tho(e,t){var E;for(const W of e)t.heightOption===Lr.stretchInsideMargins&&this.Q$l(W),e=Gt(W,[]),this.qL.write(W,t,e),(null===(E=this.tL)||void 0===E?0:E.dTd)||this.sao(e,W)}sao(e,t){const E=this.IA.Mc(15,wb.a.C_d);try{E.Xz.Ab(this.Sh),$u(e,t,this.oca,Eo.a.nfc)}finally{E.dispose()}}izo(e){const t=this.IA.Mc(15,wb.a.ldb,!1);try{t.Xz.Ab(this.Sh);var E=this.hn,W=this.Kf;const ha=E.jg(e);null!==ha&&ha.Jd()&&(ha.eh(),E.mzi(ha).Fk()?ha.eh():W.QJ(ha))}finally{t&&
t.dispose()}}Qsg(e){const t=this.IA.Mc(15,wb.a.ldb,!1);try{t.Xz.Ab(this.Sh);is(e,this.hn);if(this.$d.K1i()){let E=void 0,W=void 0;const ha=Xf.ParagraphReader.Gv(e,!1,!1,!1);for(let Ka=ha.count-1;0<=Ka;Ka--){const sb=ha.J(Ka);if(!Xf.ParagraphReader.Xb(sb))continue;const dc=this.Vb.uQb(sb);E||dc!==tl.k(2)||Xf.ParagraphReader.rca(sb)===WordEditorIntl.WordEditorStrings.L_Designer_CoverPageTitle||(E=sb,this.wMi(E,2));W||dc!==tl.k(3)||Xf.ParagraphReader.rca(sb)===WordEditorIntl.WordEditorStrings.L_Designer_CoverPageSubtitle||
(W=sb,this.wMi(W,3));if(E&&W)break}}this.Xna.SW(e)}finally{t&&t.dispose()}}hsg(e){this.qL.read(e)&&(!Fs(e,12)||null!==e&&void 0!==e&&e.YH?Fs(e,14)&&Ys(e,this.hn)&&this.Qsg(e):this.izo(e))}lGf(e){var t,E,W,ha;if(!e)return null;const Ka=new Map,sb=atob(null===e||void 0===e?void 0:e.htmlToPaste),dc=nh(sb);if(e.styleOverrides)for(const xc of e.styleOverrides){const Rc=tl.f(xc.type);Ka.set(tl.h(Rc),{fontName:xc.style.fontFamily?Uk(xc.style.fontFamily):void 0,fontSize:xc.style.fontSize,fontColor:xc.style.fontColor,
bold:xc.style.bold,italic:xc.style.italic,underline:xc.style.underline,alignment:xc.style.alignment,lineSpacing:xc.style.lineSpacing,beforeSpacing:xc.style.beforeSpacing,afterSpacing:xc.style.afterSpacing,specialIndentType:xc.style.specialIndentType,specialIndentBy:xc.style.specialIndentBy,fontKerning:xc.style.fontKerning,allCaps:xc.style.allCaps})}return{htmlToPaste:sb,htmlToPasteDark:dc,imagePaths:null===(t=null===e||void 0===e?void 0:e.imagePaths)||void 0===t?void 0:t.map(xc=>Ff.a.ki(xc)),imageThumbnailPaths:null===
(E=null===e||void 0===e?void 0:e.imagePaths)||void 0===E?void 0:E.map(xc=>Ff.a.ki("Thumbnail_"+xc)),thumbnailImage:Ff.a.ki(null===e||void 0===e?void 0:e.thumbnailImage),widthOption:null===e||void 0===e?void 0:e.widthOption,heightOption:null===e||void 0===e?void 0:e.heightOption,type:Oo.complexDecorator,hasImages:null!==(ha=null===(W=null===e||void 0===e?void 0:e.imagePaths)||void 0===W?void 0:W.length)&&void 0!==ha?ha:!1,styleOverrides:Ka}}Zbd(e){return Or(e,this.qL,this.oca,this.hn,Eo.a.nfc)}Z9m(e,
t){var E=Xf.ParagraphReader.Zl(this.Sh,!0,!0);(new Ld.GraphIterator).set(E);E=this.IA.Mc(4,wb.a.uIa);try{E.Xz.Ab(this.Sh);const W=this.hn.jg(e);if(!nn(W)){z.ULS.shipAssertTag(536941711,3016,!1);return}this.Kf.$z(W,!0,!1,null,!1,!1);const ha=new Yj.a,Ka=this.Vb.ko();ha.uoa=Ka.gh(Zj.StyleReader.KAb);const sb=this.Kf.QJ(W,ha);this.lb.Ic(new Nd.Selection([Zd.a.Tc(sb,0)],!0))}finally{E&&E.dispose()}return Zq(t.htmlToPaste,this.Sb,this.lb)}mGo(e,t,E){const W=hs(e);if(!W)return z.ULS.shipAssertTag(536941712,
3016,!1),!1;t.heightOption===Lr.stretchInsideMargins&&this.Idp(e,W);t.widthOption!==Nm.stretchInsideMargins&&t.widthOption!==Nm.stretchEdgeToEdge||this.Jdp(e,W,t.widthOption===Nm.stretchEdgeToEdge);E.set(e,this.LOf(e));return!0}Idp(e,t){t=Kc.a.em(Kc.a.qj(t.qw-t.marginTop-t.marginBottom,1),1);const E=vf.TableReader.bHf(e);var W=new Ld.GraphIterator;W.set(e);W=vf.TableReader.m9d(W);var ha=W.reduce((Ka,sb)=>Ka+sb);ha=0<ha?t/ha:void 0;if(1!==ha)for(let Ka=0;Ka<E.count;Ka++){let sb;sb=ha?W[Ka]*ha:t/vf.TableReader.xg(e);
this.hk.W_b(E.J(Ka),sb-.5/vf.TableReader.xg(e))}}Jdp(e,t,E){var W=t.rp;E?(e.properties.setValue(fd.a.fe,-t.marginLeft),e.properties.setValue(fd.a.mv,-t.marginRight)):W=W-t.marginLeft-t.marginRight;E=Kc.a.em(Kc.a.qj(W,0),0);t=this.LOf(e);W=t.reduce((ha,Ka)=>ha+Ka);E/=W;for(W=0;W<t.length;W++)this.hk.Eva(e,W,t[W]*E)}kGo(e){var t,E,W,ha,Ka=e.currentNode;if(Ka&&!Ka.Wg){var sb=Xf.ParagraphReader.Gv(Ka,!1,!1,!1);if(e=fk.getContainingTableRow(e))if(e=vp.a.blc(e),0>=e)z.ULS.shipAssertTag(523551523,3016,!1);
else if(this.lo.zd){if(Ka=Ka.nl(this.lo.zd.oc))if(Ka=Kc.a.em(Ka.A5d(),1)/e,1<Ka)for(const dc of sb)if(Xf.ParagraphReader.Xb(dc)){sb=Zd.a.createTextRange(dc,0,Xf.ParagraphReader.textLength(dc));sb=Bu.FormattingReader.Cs(sb);e=null!==(ha=null===(W=null===(E=null===(t=null===sb||void 0===sb?void 0:sb.Jb)||void 0===t?void 0:t.formatting)||void 0===E?void 0:E.cache)||void 0===W?void 0:W.fontSize)&&void 0!==ha?ha:void 0;if(void 0===e){z.ULS.shipAssertTag(523548884,3016,!1);break}e=Math.floor(e/Ka);e<this.Dej&&
(z.ULS.sendTraceTag(523548885,3016,50,"Font size limit reached"),e=this.Dej);this.km.Sm(sb,Tb.a.fontSize,e)}}else z.ULS.shipAssertTag(509667290,3016,!1);else z.ULS.shipAssertTag(523551522,3016,!1)}}Byp(e,t,E,W){var ha=Xf.ParagraphReader.Gv(this.Sh,!1,!1,!1);const Ka=new fa.a;for(var sb of ha)e.includes(sb)||Ka.add(sb);ha=this.Rm.nEi(new Set([2,3]),Ka);for(const dc of e)if(Xf.ParagraphReader.Xb(dc))if(e=Xf.ParagraphReader.rca(dc).trim(),e.startsWith("Image"))this.A2.egf(),this.qvp(dc,t,E);else if(W!==
Pp.templateTheme)switch(e){case "Title":e=void 0;ha.has(2)&&(e=ha.get(2).J(0));!e&&1<Ka.count&&(sb=Ka.J(1),this.Vb.Ae(this.Vb.Eq(sb))===Zj.StyleReader.KAb&&(e=sb));this.qMi(dc,e,2,t);break;case "Subtitle":e=void 0;ha.has(3)&&(e=ha.get(3).J(0));!e&&2<Ka.count&&(sb=Ka.J(2),this.Vb.Ae(this.Vb.Eq(sb))===Zj.StyleReader.Xud&&(e=sb));this.qMi(dc,e,3,t);break;case "Author":e=this.Om.mz.IsAnonymous?WordEditorIntl.WordEditorStrings.L_Designer_CoverPageAuthorName:this.Om.mz.Name;e.endsWith(" \ud83c\udf0e")&&
(e=Array.from(e).slice(0,-2).join(""));this.aFe(dc,e,13,t);break;case "Company":this.aFe(dc,WordEditorIntl.WordEditorStrings.L_Designer_CoverPageCompanyName,13,t);break;case "Date":this.aFe(dc,(new Date).toLocaleDateString(),5,t)}return!0}VEj(e,t){e=Zd.a.createTextRange(e,0,Xf.ParagraphReader.textLength(e));this.rg.Ne(e,t)}P8k(e,t,E){if(E.styleOverrides&&E.styleOverrides.has(tl.h(t))){E=E.styleOverrides.get(tl.h(t));t=Nq.rxf(E,t);E=Zd.a.createTextRange(e,0,Xf.ParagraphReader.textLength(e));E=Bu.FormattingReader.Cs(E);
var W=new Set;W.add(Tb.a.Rh);W.add(fd.a.wj);W.add(fd.a.ta);W.add(fd.a.ya);W.add(fd.a.xa);W.add(fd.a.fe);W.add(fd.a.mv);for(const ha of t.keys)W.has(ha)?e.setValue(ha,t.J(ha)):this.km.Sm(E,ha,t.J(ha))}}aFe(e,t,E,W){const ha=this.IA.Mc(15,wb.a.uIa);try{ha.Xz.Ab(this.Sh),this.VEj(e,t),this.pK.Ija(e,E),this.P8k(e,E,W)}finally{ha&&ha.dispose()}}qvp(e,t,E){var W=Xf.ParagraphReader.rca(e).trim().split(" ");if(2!==W.length)z.ULS.shipAssertTag(536941713,3016,!1);else if(W=Number(W[1]),isNaN(W))z.ULS.shipAssertTag(536941714,
3016,!1);else{var ha=this.IA.Mc(15,wb.a.uIa);try{ha.Xz.Ab(this.Sh),this.VEj(e,""),this.mDo(e,t.imagePaths[W],E)}finally{ha&&ha.dispose()}}}wMi(e,t){ot(e,this.Kf,this.hn,this.nXb,this.rg,this.Vb,this.pK,this.Rm);this.pK.Ija(e,t)}HFm(e){switch(e){case 2:return WordEditorIntl.WordEditorStrings.L_Designer_CoverPageTitle;case 3:return WordEditorIntl.WordEditorStrings.L_Designer_CoverPageSubtitle;default:z.ULS.shipAssertTag(524115978,3016,!1)}}qMi(e,t,E,W){t||z.ULS.sendTraceTag(521413784,3016,50,`Using placeholder string for ${tl.h(E)}`);
this.aFe(e,t?Xf.ParagraphReader.rca(t):this.HFm(E),E,W);this.$d.K1i()&&t&&(e=new Ld.GraphIterator,e.set(t),nn(e),e.eh())}mDo(e,t,E){if(e.hJa&&e.YH){var W=e.hJa;this.Xna.setCellPadding(W,1,0);this.Xna.setCellPadding(W,3,0);this.Xna.setCellPadding(W,0,0);this.Xna.setCellPadding(W,2,0);var ha=this.Xna.Jt(W),Ka=new Ld.GraphIterator;Ka.set(e.YH);ha=vf.TableReader.m9d(Ka).slice(ha,ha+W.rowSpan).reduce((sb,dc)=>sb+dc,0);Ka=this.Xna.L9d(W);this.gR.YVf(t,e,!1,wb.a.A$a,wb.a.hce,{Rld:{d1b:2,vXh:Ka,rXh:ha},altText:Is.has(t)?
Is.get(t).altText:void 0,nbe:wb.a.$7c},()=>{this.A2.Hcg()&&this.bAp(E)});e=e.ja(Tb.a.Rh,2);t=this.hn.Ql();t.set(W);t.Xd();t.eh();t.Xd();W=t.Xd();W.setValue(Tb.a.Rh,e);W.setValue(fd.a.mv,0);W.setValue(fd.a.fe,0)}}bAp(e){for(const t of e.keys()){const E=this.LOf(t),W=e.get(t);if(E.length!==W.length){z.ULS.shipAssertTag(520644507,3016,!1);break}for(let ha=0;ha<W.length;ha++)E[ha]!==W[ha]&&this.hk.Eva(t,ha,W[ha])}}scrollIntoView(e,t){var E;e=t?e.filter(W=>""!==(null===W||void 0===W?void 0:W.characterData)):
e;if(e=e.length?e[0]:void 0)this.lb.Ic(new Nd.Selection([Zd.a.Tc(e,0)],!0)),null===(E=this.jr)||void 0===E?void 0:E.V0(0)}Q$l(e){const t=this.IA.Mc(15,wb.a.A$a,!1);try{t.Xz.Ab(e);const E=new Ld.GraphIterator;E.set(e);fk.forEachCellInTable(E,W=>{this.kGo(W);return!0})}finally{t.dispose()}}get Sh(){return this.Oua.value}LOf(e){const t=new Ld.GraphIterator;t.set(e);return vf.TableReader.$aa(t)}}Object(y.a)(Jm,"ComplexDecoratorEditor",null,[1247]);var $q=d(1967),Fl=d(2169);class QA{constructor(e,t,E,
W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id){var Ee;this.Jwg=[Tb.a.bold,Tb.a.fontColor,Tb.a.italic,Tb.a.strikethrough,gb.a.du,Tb.a.subscript,Tb.a.superscript,Tb.a.underline,ad.a.X0a,...((null===(Ee=Rp.a.getInstance())||void 0===Ee?0:Ee.Fu)?Xk.ListItemReader.Pbd:[])];this.Zoa=e;this.hUe=t;this.IM=E;this.Ge=W;this.uv=ha;this.gzh=Ka;this.Zv=sb;this.OZ=dc;this.ig=xc;this.uuh=Rc;this.xe=md;this.Qd=ud;this.cCd=Ud;this.TQe=Id;e=this.Jwg.indexOf(Tb.a.fontColor);-1<e&&this.Jwg.splice(e,1)}Ija(e,t){var E,W;if(e){var ha=
this.xe.ko().gh(tl.j(t));var Ka=!1;ha||14!==t||(ha=this.xe.ko().gh(tl.j(13)),Ka=!0);this.Zoa.mmn()&&15===t&&!this.uuh.eQb(e)&&this.uuh.IBl(e);if(this.Zoa.Lmn()){var sb=tl.b(t)||2===t||3===t||14===t;(14!==t||14===t&&this.Zoa.Bta())&&this.Zv.VN(ha,e,!1,void 0,void 0,void 0,new $q.a(this.Jwg,sb,!0,!0))}else sb=this.gzh.fEi(e),(14!==t||14===t&&this.Zoa.Bta())&&this.Zv.VN(ha,e,!1),this.gzh.qTh(e,sb);14===t&&this.Zoa.Bta()&&(Ka&&this.z7k(e,ha),this.kup(e));2===(null===(E=this.TQe)||void 0===E?void 0:E.WVa())&&
e.YH&&0!==(null===(W=e.characterData)||void 0===W?void 0:W.trim().length)&&this.T$l(e)}else z.ULS.shipAssertTag(592720725,3016,!1)}T$l(e){var t,E=e.hJa;if(null===E||void 0===E?0:E.hasProperty(Tb.a.MJ)){var W=E.wf(Tb.a.MJ);E=this.IM.Cs(Zd.a.create(e));null!==(t=null===E||void 0===E?void 0:E.uo)&&void 0!==t&&t.hasProperty(Tb.a.fontColor)||(t=this.xe.Ae(this.xe.Eq(e)),t=this.xe.ko().gh(t),t=null===t||void 0===t?void 0:t.getValue(Tb.a.fontColor),1!==Ok.a.V8a(Ok.a.Wkf,Ok.a.Emb(t))&&Ok.a.V8a(Ok.a.OGe,1!==
Ok.a.Emb(t))&&(W=Ok.a.V8a(Ok.a.Emb(t),Ok.a.Emb(W)),e=this.Uzm(e),W<e&&this.Ge.$ja(E)))}}Uzm(e){const t=e.qa?e.qa.length:0;let E=3;for(let Ka=0;Ka<t-1;Ka++){var W=e.qa.J(Ka);if(W.formatting){var ha=this.IM.Bj(W.formatting,Tb.a.fontSize,0);W=this.IM.Bj(W.formatting,Tb.a.bold,0);ha=18<=ha||14<=ha&&W?3:4.5;ha>E&&(E=ha)}}return E}rmb(e,t){if(e)if(t){var E=Xk.ListItemReader.Of?e:this.ig.Hfa(e),W=null;Xk.ListItemReader.isListItem(E)&&(W=this.ig.i3(E));this.OZ.e_(this.hUe(e,0,Xf.ParagraphReader.textLength(e)),
ha=>{for(const Ka of t)switch(Ka.type){case xb.FormattingSuggestionType.FontSize:this.oC(ha,Ka.fixedValue,E,e);break;case xb.FormattingSuggestionType.FontFamily:this.BTo(ha,Ka.fixedValue,E,W,e);break;case xb.FormattingSuggestionType.FontColor:this.ax(ha,Ka.fixedValue,E,e);break;case xb.FormattingSuggestionType.Bold:this.SN(ha,Ka.fixedValue,E,e);break;case xb.FormattingSuggestionType.Italic:this.kA(ha,Ka.fixedValue);break;case xb.FormattingSuggestionType.Underline:this.Q8(ha,Ka.fixedValue);break;case xb.FormattingSuggestionType.Indentation:case xb.FormattingSuggestionType.RightIndentation:this.fUo(e,
Ka.type,Ka.fixedValue);break;case xb.FormattingSuggestionType.Alignment:this.yQo(e,Ka.fixedValue);break;case xb.FormattingSuggestionType.BeforeSpacing:this.dyb(e,Ka.fixedValue);break;case xb.FormattingSuggestionType.AfterSpacing:this.cyb(e,Ka.fixedValue);break;case xb.FormattingSuggestionType.LineSpacing:this.QE(e,Ka.fixedValue)}})}else z.ULS.shipAssertTag(592720730,3016,!1);else z.ULS.shipAssertTag(592720729,3016,!1)}oC(e,t,E,W){t=Number.parseInvariant(t);isNaN(t)?z.ULS.shipAssertTag(592527906,3016,
!1):(this.Ge.oC(e,this.Ge.tfc(t)),Xk.ListItemReader.isListItem(E)&&this.gVo(W,t))}ax(e,t,E,W){t=Number.parseInvariant(t);isNaN(t)?z.ULS.shipAssertTag(592527907,3016,!1):(t=Qd.a.PJ(t,6),this.Ge.ax(e,t,null),Xk.ListItemReader.isListItem(E)&&this.fVo(W,t))}BTo(e,t,E,W,ha){t=t.split(",");if(0<t.length){t=t[0].trim();const Ka=this.IM.Bj(e,Tb.a.font,"");Array.contains(Df.a.xqi,Ka)||(this.Ge.tha(e,t),Xk.ListItemReader.isListItem(E)&&W&&!W.listType&&this.eVo(ha,t))}}SN(e,t,E,W){t=Boolean.parse(t);this.Ge.SN(e,
t);Xk.ListItemReader.isListItem(E)&&this.dVo(W,t)}kA(e,t){t=Boolean.parse(t);this.Ge.kA(e,t)}Q8(e,t){t=Boolean.parse(t);this.Ge.Q8(e,t)}fUo(e,t,E){var W=parseFloat(E);isNaN(W)?z.ULS.shipAssertTag(592454612,3016,!1):(E=this.uv.Sr,W=Ve.a.RF(W),t===xb.FormattingSuggestionType.Indentation?E.qOa(e,1,W):E.J_b(e,1,W))}static tRl(e){switch(e){case Hn.left:return Fl.a.Left;case Hn.center:return Fl.a.Center;case Hn.right:return Fl.a.Right;case Hn.justify:return Fl.a.Justified;default:return z.ULS.shipAssertTag(538240013,
3016,!1),null}}yQo(e,t){t=Number.parseInvariant(t);if(isNaN(t))z.ULS.shipAssertTag(592454613,3016,!1);else{switch(t){case Fl.a.Left:t=1;break;case Fl.a.Right:t=3;break;case Fl.a.Center:t=2;break;case Fl.a.Justified:t=6;break;case Fl.a.None:t=0;break;default:return}this.uv.rH(e,t)}}dyb(e,t){t=Number.parseInvariant(t);isNaN(t)?z.ULS.shipAssertTag(574433370,3016,!1):this.uv.dyb(e,new Hu.a(4,t))}cyb(e,t){t=Number.parseInvariant(t);isNaN(t)?z.ULS.shipAssertTag(574433371,3016,!1):this.uv.cyb(e,new Hu.a(4,
t))}QE(e,t){t=Number.parseInvariant(t);isNaN(t)?z.ULS.shipAssertTag(574433372,3016,!1):this.uv.QE(e,new Hu.a(2,t))}dVo(e,t){e=this.Qd.m8a(e);this.Ge.SN(e,t)}fVo(e,t){e=this.Qd.m8a(e);this.Ge.ax(e,t,null)}gVo(e,t){e=this.Qd.m8a(e);this.Ge.oC(e,t)}eVo(e,t){e=this.Qd.m8a(e);this.Ge.tha(e,t)}z7k(e,t){if(null!=e&&null!=t){if(t.hasProperty(Tb.a.fontSize)){var E=t.getValue(Tb.a.fontSize);12<=E/2&&(E-=2)}this.rmb(e,[{type:xb.FormattingSuggestionType.FontSize,fixedValue:E.toString()},{type:xb.FormattingSuggestionType.Italic,
fixedValue:"true"}])}}kup(e){var t=Xf.ParagraphReader.zg(e,!0);null!=t&&this.cCd.d7h(t)?this.uv.rH(e,Xf.ParagraphReader.ez(t)):(t=Xf.ParagraphReader.zg(e,!1),null!=t&&this.cCd.d7h(t)&&this.uv.rH(e,Xf.ParagraphReader.ez(t)))}}Object(y.a)(QA,"ParagraphDesigner",null,[1228]);class NI{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh){this.Sb=e;this.qL=t;this.hn=E;this.Kf=W;this.pK=ha;this.lb=Ka;this.Xna=sb;this.hk=dc;this.IA=xc;this.sc=Rc;this.jr=md;this.oca=ud;this.A2=Ud;this.rg=Id;this.nXb=
Ee;this.Vb=kf;this.Rm=Ke;this.gR=dh}Mif(e,t){var E,W,ha,Ka;if(e)if(t){var sb=null===(E=this.lb.gb)||void 0===E?void 0:E.currentSelection;if(this.insertTable(e,t)){E=this.IA.Mc(15,wb.a.uIa);var dc=void 0,xc=void 0;try{E.Xz.Ab(this.sc.jd);dc=this.aNm(e);if(!dc)return;xc=Gt(dc,["ParagraphPlaceholder"]);this.Ico(e,dc,t);Zk(dc,this.hk,Ax);this.quo(dc);$u(xc,dc,this.oca,Eo.a.mGg)}finally{E&&E.dispose()}this.lb.Ic(new Nd.Selection([Zd.a.Tc(e,0)],!0));null===(W=this.jr)||void 0===W?void 0:W.V0(0);null===
(ha=this.jr)||void 0===ha?void 0:ha.JEa();this.lb.Ic(sb);null===(Ka=this.jr)||void 0===Ka?void 0:Ka.lza();this.qL.write(dc,t,xc)}}else z.ULS.shipAssertTag(543737922,3016,!1);else z.ULS.shipAssertTag(543737921,3016,!1)}aNm(e){e=this.hn.jg(e);if(!nn(e))return z.ULS.shipAssertTag(527541731,3016,!1),null;if(!e.Fk())return z.ULS.shipAssertTag(527541760,3016,!1),null;const t=e.tWa(0,E=>Fs(E,14));return Fs(e.currentNode,14)?t:null}hsg(e,t){var E,W,ha;const Ka=null===(E=this.lb.gb)||void 0===E?void 0:E.currentSelection;
this.lb.Ic(null);E=this.IA.Mc(15,wb.a.ldb);try{E.Xz.Ab(this.sc.jd),this.Qsg(e,t)}finally{E&&E.dispose()}null===(W=this.jr)||void 0===W?void 0:W.JEa();this.lb.Ic(Ka);null===(ha=this.jr)||void 0===ha?void 0:ha.lza()}Qsg(e,t){var E;if(e&&t&&Ys(e,this.hn)){t=Xf.ParagraphReader.Gv(e,!1,!1);var W=void 0,ha=this.qL.read(e).bSd;for(let Ka=t.count-1;0<=Ka;Ka--){const sb=t.J(Ka),dc=sb;if(0!==(null===(E=null===dc||void 0===dc?void 0:dc.characterData)||void 0===E?void 0:E.trim().length)&&!ha.find(xc=>{var Rc,
md;return(null===(Rc=xc.id)||void 0===Rc?void 0:Rc.toString())===(null===(md=dc.id)||void 0===md?void 0:md.toString())})){if(!ot(sb,this.Kf,this.hn,this.nXb,this.rg,this.Vb,this.pK,this.Rm))return;W||(W=sb)}}is(null!==W&&void 0!==W?W:e,this.hn);this.Xna.SW(e)}}lGf(e){if(!e)return null;const t=Ii.kDo(atob(null===e||void 0===e?void 0:e.htmlTable)),E=nh(t[0]);return{htmlTable:t[0],htmlTableDark:E,hasImages:t[1],fontColor:null===e||void 0===e?void 0:e.fontColor,alignment:null===e||void 0===e?void 0:e.alignment,
paragraphRow:null===e||void 0===e?void 0:e.paragraphRow,paragraphCol:null===e||void 0===e?void 0:e.paragraphCol,beforeSpacing:null===e||void 0===e?void 0:e.beforeSpacing,afterSpacing:null===e||void 0===e?void 0:e.afterSpacing,type:null===e||void 0===e?void 0:e.type}}Zbd(e){return Or(e,this.qL,this.oca,this.hn,Eo.a.mGg)}insertTable(e,t){const E=this.hn.jg(e);if(!nn(E))return z.ULS.shipAssertTag(542766210,3016,!1),!1;const W=this.IA.Mc(4,wb.a.uIa);let ha;e=Xf.ParagraphReader.zg(e,!1);if(Xf.ParagraphReader.Xb(e)&&
""===Xf.ParagraphReader.rca(e))ha=e;else try{W.Xz.Ab(this.sc.jd),this.Kf.$z(E,!1,!1),ha=this.Kf.QJ(E)}finally{W&&W.dispose()}this.lb.Ic(new Nd.Selection([Zd.a.Tc(ha,0)],!0));Zq(t.htmlTable,this.Sb,this.lb);return!0}Ico(e,t,E){const W=this.hn.jg(t);W.zb(8)&&(fk.moveToCellContent(W,E.paragraphRow,E.paragraphCol),Fs(W.currentNode,11)?(W.Xd(),js(e,W.currentNode,this.nXb,this.rg,this.Vb,this.pK,this.Rm,!0),this.qKb(W.currentNode,t,E),e=this.hn.jg(e),e.zb(8)&&(e.eh(),e.eh())):z.ULS.shipAssertTag(524115975,
3016,!1))}quo(e){const t=new Ld.GraphIterator;t.set(e);fk.forEachCellInTable(t,E=>{if(!E.Jrb(11))return!0;E.Xd();if(!E.Jrb(12))return E.uc(),!0;E.Xd();const W=E.currentNode;Fs(W,12)&&this.ZVf(W);E.uc();E.uc();return!0})}ZVf(e){const t=Ii.l7d(e);t&&(this.A2.egf(),Ii.oRd(t,E=>{if((null===E||void 0===E?void 0:E.property)===dj.a.iu)return this.gR.Wii(t,{Rld:void 0,altText:Ax,nbe:wb.a.$7c}),this.A2.Hcg(),!0}))}qKb(e,t,E){this.pK.rmb(e,[{type:xb.FormattingSuggestionType.FontColor,fixedValue:E.fontColor.toString()},
{type:xb.FormattingSuggestionType.Alignment,fixedValue:QA.tRl(E.alignment).toString()}]);const W=null!==E.beforeSpacing&&void 0!==E.beforeSpacing,ha=null!==E.afterSpacing&&void 0!==E.afterSpacing;if(W||ha){const Ka=[];W&&Ka.push({type:xb.FormattingSuggestionType.BeforeSpacing,fixedValue:E.beforeSpacing.toString()});ha&&Ka.push({type:xb.FormattingSuggestionType.AfterSpacing,fixedValue:E.afterSpacing.toString()});for(const sb of Xf.ParagraphReader.Gv(t,!1,!1))sb!==e&&this.pK.rmb(sb,Ka)}ap(t,this.hk,
!1,Ka=>Ka.Wg)}}Object(y.a)(NI,"TableDecoratorEditor",null,[1247]);class yG{constructor(e,t,E,W,ha,Ka,sb,dc){this.qL=e;this.gR=t;this.IA=E;this.sc=W;this.i4=ha;this.hn=Ka;this.oca=sb;this.A2=dc}Mif(e,t){if(e)if(t){if(e=this.Dan(e,t))t.decoratorId=e.properties.id.hu.toString(),this.qL.write(e.Jb.paragraph,t)}else z.ULS.shipAssertTag(541735123,3016,!1,"Invalid decorator");else z.ULS.shipAssertTag(541735122,3016,!1,"Invalid node")}hsg(e,t){const E=this.IA.Mc(15,wb.a.ldb);try{E.Xz.Ab(this.sc.jd),this.zyo(e,
t)}finally{E&&E.dispose()}}zyo(e,t){var E,W;if(e)if(t)if(t=null===t||void 0===t?void 0:t.decoratorId){var ha=Ii.l7d(e),Ka=null===(E=null===ha||void 0===ha?void 0:ha.properties)||void 0===E?void 0:E.id;null!==(W=null===Ka||void 0===Ka?void 0:Ka.hu)&&void 0!==W&&W.toString()&&t===Ka.hu.toString()?this.H9k(e)?this.gR.ovc(ha,e):z.ULS.shipAssertTag(541735126,3016,!1,"Non-image and non-empty paragraphs before decorator"):z.ULS.shipAssertTag(538187611,3016,!1,"Decorator is not in its paragraph")}else z.ULS.shipAssertTag(538501596,
3016,!1,"Decorator id null or undefined");else z.ULS.shipAssertTag(541735125,3016,!1,"Invalid decorator");else z.ULS.shipAssertTag(541735124,3016,!1,"Invalid node")}H9k(e){e=this.i4.Jra(e,!0,!0);do if(!this.gR.E0d(e.my)){const t=this.hn.jg(e.my);if(!Xf.ParagraphReader.isEmpty(t))return!1}while(e.lba());return!0}lGf(e){return e?e.type===lp.DecoratorType.ThemeImage?{imageUrl:Ff.a.ki(null===e||void 0===e?void 0:e.imageName),thumbnailUrl:Ff.a.ki("Thumbnail_"+(null===e||void 0===e?void 0:e.imageName)),
imageType:null===e||void 0===e?void 0:e.imageType,type:null===e||void 0===e?void 0:e.type,hasImages:!0}:{imageUrl:"",thumbnailUrl:"",imageType:null===e||void 0===e?void 0:e.imageType,type:null===e||void 0===e?void 0:e.type,hasImages:!0,altText:""}:null}Zbd(e){const t=new cq;this.oca.zXf(e,0,Xf.ParagraphReader.textLength(e),Eo.a.A0j,E=>{var W,ha;60===E&&this.qL.write(e,{decoratorId:null===(ha=null===(W=e.id)||void 0===W?void 0:W.hu)||void 0===ha?void 0:ha.toString(),type:Oo.themeImage});t.resolve()});
return t}Dan(e,t){var E,W;if(null===t||void 0===t||!t.imageUrl)return z.ULS.shipAssertTag(541735129,3016,!1,"Image URL is not valid"),null;e=Xf.ParagraphReader.Zl(e,!0,!0);if(!e)return z.ULS.shipAssertTag(541735130,3016,!1,"Cannot find paragraph"),null;this.A2.egf();t=this.gR.YVf(t.imageUrl,e,!0,wb.a.A$a,wb.a.hce,{Rld:{d1b:this.Ek(t.imageType),cropAspectRatio:this.Avm(t)},altText:this.O_(t),nbe:wb.a.$7c},()=>{this.A2.Hcg()});if((e=null===(E=null===t||void 0===t?void 0:t.Jb)||void 0===E?void 0:E.paragraph)&&
(null===(W=t.properties)||void 0===W?0:W.id))return this.zao(e),t;z.ULS.shipAssertTag(541735131,3016,!1,"Problem with image blob object while inserting theme image");this.A2.Pza(!0);return null}zao(e){const t=this.IA.Mc(15,wb.a.C_d);try{t.Xz.Ab(this.sc.jd),this.oca.Ttc(e,0,Xf.ParagraphReader.textLength(e),Eo.a.A0j,60)}finally{t.dispose()}}Ek(e){switch(e){case sr.BetweenLeftAndRightMargin:return 0;case sr.BetweenLeftAndRightEdge:return 1}}Avm(e){if(e.type===Oo.text2Image)return Df.a.IQi}O_(e){let t=
"";e.type===Oo.text2Image?t=e.altText:Is.has(e.imageUrl)&&(t=Is.get(e.imageUrl).altText);return t?t:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage}}Object(y.a)(yG,"ThemeImageDecoratorEditor",null,[1247]);class Js{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj,zl,Wl,Rh,Mg,Xl){this.Sb=e;this.qL=t;this.hn=E;this.Kf=W;this.pK=ha;this.lb=Ka;this.Xna=sb;this.gR=dc;this.Rm=xc;this.IA=Rc;this.sc=md;this.hk=ud;this.rg=Ud;this.Om=Id;this.km=Ee;this.i4=kf;this.Oua=Ke;this.jr=
dh;this.oca=$h;this.A2=rj;this.$d=zl;this.nXb=Wl;this.Vb=Rh;this.lo=Mg;this.tL=Xl}create(e){if(e){var t=Array(e.length);e.forEach((E,W)=>{switch(E){case Oo.table:t[W]=new NI(this.Sb,this.qL,this.hn,this.Kf,this.pK,this.lb,this.Xna,this.hk,this.IA,this.sc,this.jr,this.oca,this.A2,this.rg,this.nXb,this.Vb,this.Rm,this.gR);break;case Oo.complexDecorator:t[W]=new Jm(this.Sb,this.qL,this.hn,this.Kf,this.lb,this.hk,this.Xna,this.pK,this.rg,this.Om,this.gR,this.Rm,this.IA,this.km,this.Oua,this.Vb,this.oca,
this.A2,this.$d,this.nXb,this.jr,this.lo,this.tL);break;case Oo.themeImage:case Oo.text2Image:t[W]=new yG(this.qL,this.gR,this.IA,this.sc,this.i4,this.hn,this.oca,this.A2);break;default:z.ULS.shipAssertTag(542945287,3016,!1)}});return t}z.ULS.shipAssertTag(543737925,3016,!1)}}Object(y.a)(Js,"DecoratorEditorFactoryImpl",null,[1234]);class zG{constructor(e,t,E,W,ha,Ka,sb,dc){var xc;this.WZd=e;this.qL=t;this.tg=E;this.hn=W;this.tL=ha;this.Mkg=Ka;this.IA=sb;this.Oua=dc;this.cfg=(Rc,md)=>{if(2===md.data){Rc=
void 0;try{Rc=this.IA.Mc(15,wb.a.Afi,!1),Rc.Xz.Ab(this.Oua.value),this.qL.map.forEach((ud,Ud)=>{ud.bSd.forEach(Id=>{Id&&this.Mkg.Ttc(Id,0,Xf.ParagraphReader.textLength(Id),Eo.a.nfc,70)});void 0!==Ud&&$u(ud.bSd,Ud,this.Mkg,Eo.a.nfc,70);Ud&&this.Mkg.Ttc(Ud,0,Xf.ParagraphReader.textLength(Ud),Eo.a.nfc,70)}),this.qL.clear()}finally{Rc.dispose()}}};null===(xc=this.tL)||void 0===xc?void 0:xc.ZPh(this.cfg)}mTh(e,t,E){if(!e)z.ULS.shipAssertTag(543737924,3016,!1);else if(t){var W=t.map(ha=>ha.type);this.WZd.create(W).forEach((ha,
Ka)=>{ha.Mif(e,t[Ka],E)})}}hxo(){this.qL.map.forEach((e,t)=>{if(null!==t&&void 0!==t&&t.isConnected){var E=this.tg.wba(),W=this.WZd.create([e.gdi.type]);1===W.length&&W[0].hsg(t,e.gdi);E&&this.qL.remove(t)}})}eYm(){var e;return(null===(e=this.tg)||void 0===e?void 0:e.cfa)===wb.a.rza}Wyo(){this.tL.freeze();this.tg.undo();this.tL.Hrp()}async Klg(e){if(e){var t=this.WZd.create([Oo.themeImage,Oo.table,Oo.complexDecorator]),E=t[0],W=t[1];t=t[2];var ha=[];for(const Ka of e)this.qL.read(Ka)||(this.hn.jg(Ka).zb(14)?
ha.push(W.Zbd(Ka)):ha.push(E.Zbd(Ka)),ha.push(t.Zbd(Ka)));return Promise.all(ha)}}rsi(e){if(!e)return null;const t=e.map(W=>W.type),E=[];this.WZd.create(t).forEach((W,ha)=>{E.push(W.lGf(e[ha]))});return E}}Object(y.a)(zG,"DecoratorManagerImpl",null,[1232]);class RA{constructor(e){this.bSd=[];this.gdi=e}NMh(e){this.bSd.push(e)}}Object(y.a)(RA,"DecoratorInfoHolder",null,[]);class iE{constructor(){this.map=new Map}write(e,t,E){if(this.map.size>=Df.a.yNl){z.ULS.sendTraceTag(526391136,3016,50,"Decorator storage capacity exceeded");
const ha=this.map.keys();for(let Ka=0;10>Ka;Ka++)this.map.delete(ha.next().value)}this.map.set(e,new RA(t));const W=this.map.get(e);null===E||void 0===E?void 0:E.forEach(ha=>{W.NMh(ha)})}JJp(e,t){this.map.has(e)&&this.map.get(e).NMh(t)}read(e){return this.map.has(e)?this.map.get(e):null}remove(e){this.map.has(e)&&this.map.delete(e)}clear(){this.map.clear()}dYm(){for(const e of this.map.keys())if(null===e||void 0===e?0:e.isConnected)return!0;return!1}}Object(y.a)(iE,"DecoratorStorageImpl",null,[1233]);
class hn{constructor(e,t,E,W,ha,Ka,sb=null,dc,xc,Rc,md){this.L8a=e;this.IA=t;this.pK=E;this.VP=W;this.sc=ha;this.Dg=Ka;this.LD=sb;this.$d=dc;this.Rm=xc;this.Vb=Rc;this.b3=md}A7k(){return this.L8a.vjc().then(e=>{let t=0,E=0;const W=this.IA.Mc(15,Fa.a.T3d);try{W.Xz.Ab(this.sc.jd);for(const ha of e){const Ka=this.lP(ha),sb=this.peb(ha),dc=this.iIi(ha,sb);if(sb){const xc=this.VP.eho(this.VP.U1c(ha,Ka),(Rc,md)=>{md.forEach(ud=>{this.pK.Ija(ud,Rc.role)});return!0},dc);xc&&1!==xc&&t++}else{const xc=this.VP.Pgo(ha,
(Rc,md)=>{md.forEach(ud=>{this.pK.rmb(ud,Rc.suggestions)});return!0},dc);xc&&1!==xc&&E++}}}finally{W&&W.dispose()}z.ULS.sendTraceTag(538190339,3016,50,`style:${t} df:${E} of total: ${e.count}`);return t+E}).catch(e=>{z.ULS.shipAssertTag(538468955,3016,!1,String.format("{0} {1}",e.message,e.stack));return Promise.resolve(0)})}lP(e){if(!e)return z.ULS.shipAssertTag(546137295,3016,!1),null;if(!e.content)return z.ULS.shipAssertTag(546137296,3016,!1),null;const t=e.parent;return t?t:this.L8a.getParent(e)}peb(e,
t=0){const E=this.VP.U1c(e,this.lP(e));if(!E.length)return!1;const W=this.Rm.YB(E[0]);if(!W)return!1;t=0===t?W.role:t;const ha=this.Vb.ko().gh(tl.j(t));if(!ha)return z.ULS.sendTraceTag(538190341,3016,50,`No WAC style for role: ${t}`),!1;var Ka=e.content;if(!Ka)return z.ULS.sendTraceTag(538190342,3016,50,`No formattingSuggestionsAnnotation for role: ${t}`),!1;e=new Set;let sb=!1;for(const dc of Ka.suggestions){E.forEach(xc=>{this.Orn(dc,ha,Xf.ParagraphReader.$4c(xc))||(sb=!0)});if(sb)return z.ULS.sendTraceTag(538468956,
3016,50,`type: ${dc.type} role: ${W.role}`),!1;e.add(dc.type)}t=this.qMm();for(const dc of t)if(!e.has(dc)&&(t=this.Qio(dc))&&(Ka=ha.getValue(t)))for(const xc of E){const Rc=this.b3.Bj(this.b3.Cs(Zd.a.create(xc)),t,null);if(Ka!==Rc)return z.ULS.sendTraceTag(512522202,3016,50,`type: ${dc} role: ${W.role}`),!1}z.ULS.sendTraceTag(538468957,3016,50,`role: ${W.role}`);return!0}getPropertyValue(e,t,E,W){return(t=t.getValue(e))?t:E?(e=E.getValue(e))?e:W:W}Orn(e,t,E){switch(e.type){case xb.FormattingSuggestionType.FontSize:return Number.parseInvariant(e.fixedValue)===
this.getPropertyValue(Tb.a.fontSize,t,E,Le.a.gP);case xb.FormattingSuggestionType.FontFamily:return e.fixedValue===this.getPropertyValue(Tb.a.font,t,E,"");case xb.FormattingSuggestionType.FontColor:return Number.parseInvariant(e.fixedValue)===this.getPropertyValue(Tb.a.fontColor,t,E,Ok.a.auto);case xb.FormattingSuggestionType.Bold:return Boolean.parse(e.fixedValue)===this.getPropertyValue(Tb.a.bold,t,E,!1);case xb.FormattingSuggestionType.Italic:return Boolean.parse(e.fixedValue)===this.getPropertyValue(Tb.a.italic,
t,E,!1);case xb.FormattingSuggestionType.Underline:return Boolean.parse(e.fixedValue)===this.getPropertyValue(Tb.a.underline,t,E,!1);case xb.FormattingSuggestionType.LineSpacing:return this.Sln(t,E,e.fixedValue);case xb.FormattingSuggestionType.BeforeSpacing:return this.getPropertyValue(fd.a.wj,t,E,0)===Ve.a.RF(Number.parseInvariant(e.fixedValue));case xb.FormattingSuggestionType.AfterSpacing:return this.getPropertyValue(fd.a.ta,t,E,0)===Ve.a.RF(Number.parseInvariant(e.fixedValue));case xb.FormattingSuggestionType.Indentation:return parseFloat(e.fixedValue)===
this.getPropertyValue(fd.a.fe,t,E,0);case xb.FormattingSuggestionType.RightIndentation:return parseFloat(e.fixedValue)===this.getPropertyValue(fd.a.mv,t,E,0);case xb.FormattingSuggestionType.Alignment:return this.vdn(t,E,e.fixedValue)}return!1}vdn(e,t,E){E=Number.parseInvariant(E);if(isNaN(E))return!0;e=this.getPropertyValue(Tb.a.Rh,e,t,1);switch(E){case Fl.a.Left:return 1===e;case Fl.a.Right:return 3===e;case Fl.a.Center:return 2===e;case Fl.a.Justified:return 6===e}return!0}Sln(e,t,E){const W=this.getPropertyValue(fd.a.ya,
e,t,void 0);e=this.getPropertyValue(fd.a.xa,e,t,0)/(0===W?240:20);return Number.parseFloat(E)===e}qMm(){return[xb.FormattingSuggestionType.FontSize,xb.FormattingSuggestionType.FontFamily,xb.FormattingSuggestionType.FontColor,xb.FormattingSuggestionType.Bold,xb.FormattingSuggestionType.Italic,xb.FormattingSuggestionType.Underline,xb.FormattingSuggestionType.LineSpacing,xb.FormattingSuggestionType.BeforeSpacing,xb.FormattingSuggestionType.AfterSpacing,xb.FormattingSuggestionType.Indentation,xb.FormattingSuggestionType.RightIndentation,
xb.FormattingSuggestionType.Alignment]}Qio(e){switch(e){case xb.FormattingSuggestionType.FontSize:return Tb.a.fontSize;case xb.FormattingSuggestionType.FontFamily:return Tb.a.font;case xb.FormattingSuggestionType.FontColor:return Tb.a.fontColor;case xb.FormattingSuggestionType.Bold:return Tb.a.bold;case xb.FormattingSuggestionType.Italic:return Tb.a.italic;case xb.FormattingSuggestionType.Underline:return Tb.a.underline;case xb.FormattingSuggestionType.LineSpacing:return fd.a.xa;case xb.FormattingSuggestionType.BeforeSpacing:return fd.a.wj;
case xb.FormattingSuggestionType.AfterSpacing:return fd.a.ta;case xb.FormattingSuggestionType.Indentation:return fd.a.fe;case xb.FormattingSuggestionType.RightIndentation:return fd.a.mv;case xb.FormattingSuggestionType.Alignment:return Tb.a.Rh;default:z.ULS.shipAssertTag(512522201,3016,!1,`type: ${e}`)}}K8k(e,t){let E=0,W=0;const ha=this.IA.Mc(15,wb.a.SDa);try{ha.Xz.Ab(this.sc.jd),e.forEach((Ka,sb)=>{if(this.peb(sb,Ka.iIj.role))this.pK.Ija(this.lP(sb),Ka.iIj.role),E++;else{const dc=sb.content;dc&&
(this.pK.rmb(t?t[Ka.jkg]:this.lP(sb),dc.suggestions),W++)}})}finally{ha&&ha.dispose()}z.ULS.sendTraceTag(524170564,3016,50,`style:${E} df:${W} of total: ${e.size}`);return E+W}k5l(e){let t=0;for(const E of e.suggestions)t+=Math.pow(2,E.type);return t}iIi(e,t){const E=this.lP(e);if(!E)return[];const W=this.Rm.YB(E);return W?(e=e.content)?[Object.assign(new yi.a,{name:"formatTypes",int64:this.k5l(e)}),Object.assign(new yi.a,{name:"role",int64:W.role}),Object.assign(new yi.a,{name:"textLength",int64:E.zxb.length}),
Object.assign(new yi.a,{name:"useStyles",bool:t})]:[]:[]}$_m(e){this.VP.n0m(e)}a6o(e,t){const E=this.peb(t),W=this.iIi(t,E);if(E)this.VP.Ize(new K.b(new Ha.c(Hb.a.create(),this.LD,this.$d,!0,W),this.VP.U1c(t,e),0,this.Dg.textLength(e),(ha,Ka)=>{Ka.forEach(sb=>{this.pK.Ija(sb,ha.role)});return!0}));else{const ha=t.content;ha&&this.VP.Ize(new K.b(new Ha.c(Hb.a.create(),this.LD,this.$d,!0,W),this.VP.U1c(t,e),0,this.Dg.textLength(e),(Ka,sb)=>{sb.forEach(dc=>{this.pK.rmb(dc,ha.suggestions)});return!0}))}}}
Object(y.a)(hn,"DocumentConsistencyManager",null,[1231]);var jE=d(758);class Iu{constructor(e){this.HEd=void 0;this.ui=!1;this.vvb=(t,E)=>{t=E.data.operationType;t!==sh.a.getTypeName()&&t!==jE.a.getTypeName()||this.update(E.data.annotation)};this.Dfh=e;this.sa=new ua.a}b0k(e){this.sa.addHandler(Iu.$yf,e)}zDj(e){this.sa.removeHandler(Iu.$yf,e)}get i9c(){return this.HEd}set i9c(e){this.HEd!==e&&(this.HEd=e,this.sa.raiseEvent(Iu.$yf,new le.a(this.HEd)))}initialize(){this.ui||(this.Dfh.MH(this.vvb),this.ui=
!0)}Pd(){this.ui&&(this.Dfh.sK(this.vvb),this.ui=!1)}update(e){this.i9c=e.content.supportedLanguagesCoverage>Df.a.rZj}}Iu.$yf="DocumentContentLanguageSupportChangedEventKey";Object(y.a)(Iu,"DocumentLanguageManager",null,[1230,511]);var AG=d(339),Fw=d(369);class Bx{constructor(e,t,E,W,ha,Ka){this.rg=e;this.rm=t;this.Nd=E;this.Rm=W;this.iC=ha;this.h4=Ka;this.s4f=new Ei.a}IBl(e){var t=this.Rm.YB(e);if(null==t.Pcd)z.ULS.shipAssertTag(556323523,3016,!1,"ListId not set in manual list item state!");else{var E=
t.Pcd,W=t.Pcd,ha=t.listItemPrefix,Ka=!1;this.s4f.mb(W)?E=this.s4f.get(W):Ka=!0;var sb=this.Rm.qzm(W);if(sb)if(sb.levelInfos&&sb.levelInfos.length){null==t.Bje&&z.ULS.shipAssertTag(556323526,3016,!1,"Manual List Item level is not set!");sb.fontFamily||z.ULS.shipAssertTag(556323527,3016,!1,"Font family not set for manual list item!");var dc=sb.fontFamily||Le.a.RJ,xc=t.Bje||0,Rc=Bx.rLf(sb,xc);t=Bx.Mym(sb,xc);var md=Bx.Yxm(sb,xc);if(42===t)z.ULS.shipAssertTag(556323528,3016,!1,"Cannot map ListStyle!");
else{E=this.bHl(E,dc,xc,Rc,t,md);if(ha)this.Lyo(e,ha);else if(sb.listType===Fl.e.Numbered){z.ULS.shipAssertTag(556323529,3016,!1,"No list prefix detected!");return}ha=new Ld.GraphIterator;sb=new hc.DictionaryPropertySet;this.seo(e,t,ha,sb);t=this.iC.iX(e);this.r7k(E,ha,sb,Ka);this.h4.qOa(e,t.unit,t.value);e=this.eQb(e);null!=e?this.s4f.Z(W,e):z.ULS.shipAssertTag(556323530,3016,!1,"Didn't get list id of converted list!")}}else z.ULS.shipAssertTag(556323525,3016,!1,"No level infos in manual list info!");
else z.ULS.shipAssertTag(556323524,3016,!1,"Cannot find manual list info!")}}eQb(e){if(Xk.ListItemReader.Of)return Xk.ListItemReader.isListItem(e)?Xk.ListItemReader.av(e).listId:null;e=this.Nd.Hfa(e);return(null===e||void 0===e?0:e.hasProperty(fd.a.listID))?e.getValue(fd.a.listID):null}r7k(e,t,E,W){this.rm.Tqa(E,t,e,W)}Lyo(e,t){if(t)try{const E=Zd.a.createTextRange(e,0,Bx.aGm(t,e.characterData));this.rg.Ne(E,"")}catch(E){z.ULS.shipAssertTag(556074240,3016,!0,`Remove list prefix failed! error ${E}`)}}seo(e,
t,E,W){E.set(e);E.zb(11)&&E.ld(11);E.set(E.currentNode);df.SelectionEditor.rv(E);W.setValue(dj.a.UL,0);W.setValue(dj.a.cC,6===t?1:0);W.setValue(fd.a.gt,AG.a.$ae)}bHl(e,t,E,W,ha,Ka){e=Fw.a.s_(6===ha?1:0,ha,null,e,E,W,t);Ka&&(e.ED=Ka);return e}static Mym(e,t){switch(Bx.dCm(e,t)){case "decimal":return 1;case "lowerLetter":return 2;case "lowerRoman":return 3;case "upperLetter":return 4;case "upperRoman":return 5;case "bullet":return 6;default:return 42}}static dCm(e,t){for(let E=0;E<e.levelInfos.length;E++){const W=
e.levelInfos[E];if(W.level===t)return W.numberFormat||e.listType!==Fl.e.Numbered?e.levelInfos[E].numberFormat:"decimal"}z.ULS.shipAssertTag(556323531,3016,!1,"No number format for given level!");return null}static rLf(e,t){for(let E=0;E<e.levelInfos.length;E++){const W=e.levelInfos[E];if(W.level===t)return W.levelText||e.listType!==Fl.e.Numbered?W.levelText:"%1."}z.ULS.shipAssertTag(556323532,3016,!1,"No level text for given level!");return null}static Yxm(e,t){for(let E=0;E<e.levelInfos.length;E++){const W=
e.levelInfos[E];if(W.level===t)return W.startAt}z.ULS.shipAssertTag(556323533,3016,!1,"No StartAt value for given level!");return null}static aGm(e,t){var E=t.indexOf(e);if(-1==E)return z.ULS.shipAssertTag(556074241,3016,!1,"Prefix not found in paragraph text!"),0;e=E+e.length;for(E=0;e+E<=t.length&&" "==t.charAt(e+E);)E++;return e+E}}Object(y.a)(Bx,"ManualListConverter",null,[1229]);class Rr extends Qr{constructor(e){super();this.Mij=e;this.cnd=10;this.activeSection=this.Vgc=this.Kw=null;this.isInitialized=
!1}Y9d(){return this.Kw}Q4c(){return this.Vgc}sjc(){return this.activeSection}V_(e){var t;const E=null===(t=this.Kw)||void 0===t?void 0:t.find(W=>W.id.equals(e));return E&&E.V_}nie(e,t){const E=e?this.Kw.find(W=>W.id.equals(e)):void 0;E&&this.Mij.w7i(v.AFrameworkApplication.uiCulture,e.toString(),this.cnd,E.items.length).then(W=>{var ha;if(W&&0!==W.length){for(const Ka of W)E.items.push({type:Pp.officeTemplate,name:Ka.Id,templateId:Ka.Id,previewImageUrl:Ka.ThumbnailUrl,binaryUrl:Ka.BinaryUrl,isPortraitOriented:null!==
(ha=Ka.IsPortraitLayout)&&void 0!==ha?ha:!0,isPremium:Ka.IsPremium,collectionId:E.id.toString(),collectionName:E.displayName,isL2Template:t});E.V_=0===E.items.length%this.cnd;E.V_&&(this.sa.raiseEvent(Qr.gNa),this.nie(E.id))}else E.V_=!1;this.sa.raiseEvent(Qr.gNa)}).catch(()=>{E.V_=!1;this.sa.raiseEvent(Qr.gNa)});Promise.resolve()}H7i(){var e;this.Mij.w7i(v.AFrameworkApplication.uiCulture,null,this.cnd,null===(e=this.Kw)||void 0===e?void 0:e.length).then(t=>{var E;this.Vgc=new hk.a(oi.a.th());let W=
new Map,ha=new Map;for(let Ka of t)W.has(Ka.CollectionId)||(W.set(Ka.CollectionId,[]),ha.set(Ka.CollectionId,Ka.CollectionDisplayName)),W.get(Ka.CollectionId).push({type:Pp.officeTemplate,name:Ka.Id,templateId:Ka.Id,previewImageUrl:Ka.ThumbnailUrl,binaryUrl:Ka.BinaryUrl,isPortraitOriented:null!==(E=Ka.IsPortraitLayout)&&void 0!==E?E:!0,isPremium:Ka.IsPremium,collectionId:Ka.CollectionId,collectionName:Ka.CollectionDisplayName,isL2Template:Ka.IsL2Template});for(let Ka of W.keys())this.Kw.push({label:am.none,
labelDisplayName:ha.get(Ka),id:new Rn(am.none,Ka),displayName:ha.get(Ka),items:W.get(Ka),isLoaded:!0,V_:0<W.get(Ka).length&&0===W.get(Ka).length%this.cnd});0===this.Kw.length%this.cnd&&(this.sa.raiseEvent(Qr.gNa),this.H7i());this.sa.raiseEvent(Qr.gNa)}).catch(t=>{z.ULS.shipAssertTag(509693954,3016,!1,`Office templates retrieval error: ${t}`)});Promise.resolve()}initialize(){this.isInitialized||(this.Kw=[],this.H7i(),this.isInitialized=!0)}Pd(){}}Object(y.a)(Rr,"OfficeTemplatesThemeProvider",Qr,[]);
var Ez=d(978);class $s{constructor(e=null,t=null){this.lz=e;this.Qip=t}}Object(y.a)($s,"ParagraphFormattingSnapshot",null,[]);class Gw{constructor(e,t){this.formatting=e;this.Xng=t}}Object(y.a)(Gw,"FormattingPropertyDefinitionPair",null,[]);class Fz{constructor(e,t){this._fontColor=this.pRc=this._formatting=0;this.jZ=null;this.fw=e;this.UCl=t}nwc(e,t){if(!e)return z.ULS.shipAssertTag(592307426,3016,!1),!1;this._formatting=0;for(const E of Fz.gjh)t.Bj(e,E.Xng,!1)&&(this.DNh(E.formatting),64===E.formatting&&
(this.pRc=t.Bj(e,Tb.a.underlineType,Le.a.fAb)),256===E.formatting&&(this._fontColor=t.Bj(e,Tb.a.fontColor,Ok.a.auto)));e=t.Bj(e,Tb.a.font,"");dg.a.contains(Df.a.xqi,e)&&(this.DNh(128),this.jZ=e);return!!this._formatting}k_a(e,t){if(!e)z.ULS.shipAssertTag(592307427,3016,!1);else if(!t)z.ULS.shipAssertTag(592307456,3016,!1);else if(this._formatting){for(const E of Fz.gjh)if(this.qVi(E.formatting))switch(E.formatting){case 1:t.SN(e,!0);break;case 8:t.Cxe(e,!0);break;case 256:t.ax(e,Qd.a.PJ(this._fontColor,
6),null);break;case 2:t.kA(e,!0);break;case 4:t.Gna(e,!0);break;case 16:t.uOa(e,!0);break;case 32:t.Kva(e,!0);break;case 64:t.yha(e,this.pRc)}this.qVi(128)&&t.tha(e,this.jZ)}}DNh(e){this._formatting|=e}qVi(e){return(this._formatting&e)===e}}Fz.gjh=[new Gw(1,Tb.a.bold),new Gw(256,Tb.a.fontColor),new Gw(2,Tb.a.italic),new Gw(4,Tb.a.strikethrough),new Gw(8,gb.a.du),new Gw(16,Tb.a.subscript),new Gw(32,Tb.a.superscript),new Gw(64,Tb.a.underline)];Object(y.a)(Fz,"TextRunFormattingSnapshot",null,[]);class kE{get Xr(){return null!=
this.z1g?this.z1g:this.z1g=Rp.a.getInstance()}constructor(e,t,E,W,ha,Ka,sb){this.$Sm=e;this.b3=t;this.km=E;this.Nd=W;this.r8=ha;this.h9=Ka;this.DI=sb}qTh(e,t){if(e)if(t){var E=t.lz;if(t=t.Qip){for(const W of t)this.h9.e_(this.$Sm(e,W.fw,W.UCl),ha=>{W.k_a(ha,this.km)});if(E){if(!this.Xr.Wr&&(t=new Ld.GraphIterator,t.set(e),t.Jd())){t.uc();const W=new Ez.a;t.Uf(W,4);t.Yj(W);W.setValue(fd.a.listID,E.listId);W.setValue(fd.a.listLevel,E.listLevel)}this.Xr.Fu&&this.DI.L_b(e,E.listId,E.listLevel)}}else z.ULS.shipAssertTag(590754180,
3016,!1)}else z.ULS.shipAssertTag(590754179,3016,!1);else z.ULS.shipAssertTag(590754178,3016,!1)}fEi(e){if(!e)return z.ULS.shipAssertTag(590754181,3016,!1),null;const t=new fa.a;for(var E=0;E<e.qa.length-1;E++){const W=e.qa.J(E);if(!W.formatting)continue;const ha=new Fz(W.cp,e.qa.J(E+1).cp);ha.nwc(W.formatting,this.b3)&&t.add(ha)}E=null;e=this.r8.nm(e);Xk.ListItemReader.Hg(e)&&(Xk.ListItemReader.Of?E=Xk.ListItemReader.Osa(e):(E=new Ld.GraphIterator,E.set(e),this.Nd.MVb(E),E=this.Nd.Q_(E.currentNode,
!1,!1)));return new $s(E,t)}}Object(y.a)(kE,"ParagraphFormattingSnapshotManager",null,[1226]);var BG=d(430),SA=d(1237),CG=d(1810),Gz=d(1750);class Zn{static pSm(){Zn.Lxb||(Zn.Lxb=new Zc.ScriptSharpLegacyMap,Zn.Lxb.add(0,{indent:.3,Xqd:(e,t,E)=>{const W=e.length+1,ha=Zn.lwc,Ka=Zn.mwc;t=Zn.dXc(t);const sb=t+66148;e=JSON.stringify(e).slice(1,-1);return`{"elements":[{"id":2,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":255,"g":255,"r":255}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":0,"y":0},"rot":10800000,"size":{"h":${sb},"w":${E}}}},"wordGc2Type":13000},{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":20,"g":107,"r":234}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":53734,"w":${E}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":0,"g":0,"r":0}}},"fontFamily":"${ha}","fontSize":${Ka}},"length":${W}}],"paraFormatRunArray":[{"length":${W},"paragraphFormat":{"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${e}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":164030,"y":82747},"rot":0,"size":{"h":${t},"w":${E-
295364}}}},"wordGc2Type":13000}]}`}}),Zn.Lxb.add(1,{indent:.9,Xqd:(e,t,E)=>{const W=e.length+1,ha=Zn.lwc,Ka=Zn.mwc;t=Zn.dXc(t);const sb=t+777476,dc=t+587852,xc=E-119350,Rc=E-1540438,md=t+59675,ud=E-453325;e=JSON.stringify(e).slice(1,-1);return`{"elements":[{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":219,"g":102,"r":80}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${sb},"w":${E}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":219,"g":102,"r":80}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":249996,"y":143249},"rot":0,"size":{"h":${dc},"w":${xc}}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":255,"g":255,"r":255}}},"fontFamily":"${ha}","fontSize":${Ka}},"length":${W}}],"paraFormatRunArray":[{"length":${W},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${e}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":837024,"y":430397},"rot":0,"size":{"h":${t},"w":${Rc}}}},"wordGc2Type":13000},{"id":6,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":1}}},"lineDash":0,"weight":42863},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":112627,"y":0},"rot":0,"size":{"h":${dc},"w":${xc}}}},"wordGc2Type":13000},{"id":7,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1},{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{"alignment":0,"indent":0,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":107},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":304366,"y":220893},"rot":0,"size":{"h":458066,"w":364157}}},"wordGc2Type":13000},{"id":8,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1},{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1}],"paraFormatRunArray":[{"length":2,"paragraphFormat":{"alignment":0,"indent":0,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":107},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":${ud},"y":${md}},"rot":10800000,"size":{"h":458066,"w":364157}}},"wordGc2Type":13000}],"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${sb},"w":${E}}}}`}}),
Zn.Lxb.add(2,{indent:.7,Xqd:(e,t,E)=>{const W=e.length+1,ha=Zn.lwc,Ka=Zn.mwc;t=Zn.dXc(t);const sb=t+80835,dc=E-999962,xc=t+444908,Rc=t+66148,md=t+66148,ud=13350-Math.round(md/2),Ud=142329+Math.round(md/2),Id=E-1134575,Ee=E-727217,kf=t+190818,Ke=E-Math.round(md/2);t-=77606;const dh=E-1149386;e=JSON.stringify(e).slice(1,-1);return`{"elements":[{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":246,"g":239,"r":234}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":0,"y":157851},"rot":10800000,"size":{"h":${Rc},"w":${E}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"fontFamily":"${ha}","fontSize":${Ka}},"length":${W}}],"paraFormatRunArray":[{"length":${W},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${e}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":443019,"y":244229},"rot":0,"size":{"h":${sb},"w":${dc}}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":8939,"y":159883},"rot":0,"size":{"h":37400,"w":671031}}},"wordGc2Type":13000},{"id":6,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${ud},"y":${Ud}},"rot":5400000,"size":{"h":34645,"w":${md}}}},"wordGc2Type":13000},{"id":7,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":25828,"y":${kf}},"rot":0,"size":{"h":34537,"w":${Id}}}},"wordGc2Type":13000},{"id":8,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${Ee},"y":${kf}},"rot":0,"size":{"h":34537,"w":729926}}},"wordGc2Type":13000},{"id":9,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${Ke},"y":${Ud}},"rot":5400000,"size":{"h":34645,"w":${md}}}},"wordGc2Type":13000},{"id":10,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":1149133,"y":159846},"rot":0,"size":{"h":37400,"w":${Id}}}},"wordGc2Type":13000},{"id":11,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"fontFamily":"Felix Titling","fontSize":4800},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{"alignment":0}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${dh},"y":${t}},"rot":0,"size":{"h":484389,"w":415634}}},"wordGc2Type":13000},{"id":12,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"fontFamily":"Felix Titling","fontSize":4800},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{"alignment":0}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":681162,"y":0},"rot":10800000,"size":{"h":484389,"w":415634}}},"wordGc2Type":13000}],"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${xc},"w":${E}}}}`}}),
Zn.Lxb.add(3,{indent:1,Xqd:(e,t,E)=>{const W=e.length+1,ha=Zn.lwc,Ka=Zn.mwc;t=Zn.dXc(t);const sb=E-1518499,dc=t+392522,xc=t,Rc=t-316115,md=E/2-256447;e=JSON.stringify(e).slice(1,-1);return`{"elements":[{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":244,"g":235,"r":233}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":158},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${md},"y":${Rc}},"rot":2700000,"size":{"h":512895,"w":512895}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":244,"g":235,"r":233}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":25},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${xc},"w":${E}}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":168,"g":101,"r":56}}},"fontFamily":"${ha}","fontSize":${Ka}},"length":${W}}],"paraFormatRunArray":[{"length":${W},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${e}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":726947,"y":71168},"rot":0,"size":{"h":${t},"w":${sb}}}},"wordGc2Type":13000}],"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${dc},"w":${E}}}}`}}),
Zn.Lxb.add(4,{indent:.3,Xqd:(e,t,E)=>{const W=e.length+1,ha=Zn.lwc,Ka=Zn.mwc;t=Zn.dXc(t);const sb=t+125516,dc=E-120310,xc=E-427001,Rc=t;E-=244619;e=JSON.stringify(e).slice(1,-1);return`{"elements":[{"id":2,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":255,"g":255,"r":255}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":0,"y":0},"rot":10800000,"size":{"h":${sb},"w":${dc}}}},"wordGc2Type":13000},{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fontFamily":"${ha}","fontSize":${Ka}},"length":${W}}],"paraFormatRunArray":[{"length":${W},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${e}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":101388,"y":81834},"rot":0,"size":{"h":${t},"w":${xc}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":${Rc}},"rot":0,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${E},"y":0},"rot":10800000,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000},{"id":6,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":5400000,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000},{"id":7,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${E},"y":${Rc}},"rot":16200000,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000}]}`}}));
return Zn.Lxb}static dXc(e){return Kc.a.vNa(e,0)*Ve.a.Phc+Zn.fKo}}Zn.Lxb=null;Zn.lwc="Calibri";Zn.mwc=1400;Zn.fKo=256E3;Object(y.a)(Zn,"PullQuoteStyles",null,[]);class ls{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke){this.KR=e;this.l_=t;this.tg=E;this.K=W;this.uTm=ha;this.m3m=Ka;this.lb=sb;this.rc=dc;this.rg=xc;this.h9=Rc;this.km=md;this.logger=ud;this.Kf=Ud;this.sc=Id;this.KWa=Ee;this.blf=kf;this.Vb=Ke;this.range=window.self.document.createRange()}rOh(e,t){var E;if(e)if(({value:dc}=
Zn.pSm().Dc(e.Wcb,dc)).returnValue){var W=this.VIl(e);if(W){var ha=pl.WordSectionNavigator.instance.FN(W),Ka=ha?Ve.a.WKg(qh.a.instance.$J(ha)):ls.XIj,sb=ha?Ve.a.WKg(qh.a.instance.FL(ha)):ls.XIj;ha=(ha?Ve.a.WKg(qh.a.instance.ev(ha)):ls.aKo)-Ka-sb;Ka=this.Tum(W,dc.indent);sb=dc.Xqd(e.Hid,Ka,ha);var dc=new sc.a(this.sc);this.lb.Ic(hi.SelectionFactory.lr(W));W=new CG.a(dc,this.KWa,!0,this.KR,this.K,Object(gh.a)());W=new Gz.a(W,sb,this.l_,this.tg,t,ge.a.instance,!1,null,this.KR,this.m3m,ha/ls.bKo,Ka+ls.dKo,
this.K,this.blf,this.rc,!1,[]);W.IYo(e.callback);W.YSo(xc=>{z.ULS.shipAssertTag(545271898,3016,!1,"PullQuote failed to create, error message: {0}",xc)});this.uTm.cyg(W,dc,!1,t);return null===(E=dc.Hk)||void 0===E?void 0:E.node}z.ULS.shipAssertTag(555034258,3016,!1,"Unsuccessful node creation")}else z.ULS.shipAssertTag(555034257,3016,!1,String.format("Non existing styleId: {0}",e.Wcb));else z.ULS.shipAssertTag(555034256,3016,!1,"No PullQuoteData")}Tum(e,t){this.h9.e_(Zd.a.createTextRange(e,0,Xf.ParagraphReader.textLength(e)),
W=>{this.km.oC(W,Zn.mwc/100*2);this.km.tha(W,Zn.lwc)});$t.a.iWa.qOa(e,1,Ve.a.Ow(t));$t.a.iWa.J_b(e,1,Ve.a.Ow(t));this.sc.Ufb();t=0;try{var E=e.nl(this.sc.oc);const W=BG.a.Kra(E,void 0,!1,!1),ha=SA.a.y$h(W.cJ,this.logger).aP;for(E=0;E<ha.jl.count-1;E++){const Ka=ha.b9a(E);this.range.setStart(Ka.htmlElement,0);this.range.setEnd(Ka.htmlElement,Ka.htmlElement.textContent.length);const sb=this.range.getBoundingClientRect();t+=sb.height}}catch(W){t=ls.cKo,z.ULS.shipAssertTag(555034259,3016,!1,"Couldn't calculate pull quote text height. Exception: {0}",
String.format("{0} {1}",W.message,W.stack))}finally{return this.h9.e_(Zd.a.createTextRange(e,0,Xf.ParagraphReader.textLength(e)),W=>{this.km.oC(W,22)}),$t.a.iWa.qOa(e,1,Ve.a.Ow(0)),$t.a.iWa.J_b(e,1,Ve.a.Ow(0)),t}}VIl(e){var t=new Ld.GraphIterator;t.set(e.paragraphNode);if(!t.Jd())return null;lg.OutlineElementNavigator.he(t);this.Kf.$z(t,!0,!1,void 0,void 0,!1);var E=new Yj.a;const W=this.Vb.EF(e.paragraphNode);W&&(E.uoa=W.gh(Zj.StyleReader.p3b));if(t=this.Kf.QJ(t,E))E=Zd.a.Tc(t,0),this.rg.Ne(E,e.Hid,
!0,!1);return t}xnl(e,t,E,W){if(e)if(t)if(E){if(e=this.WBj(e))return t=new K.c(t,e,t.Wcb,t.Hid,E),this.rOh(t,W);z.ULS.shipAssertTag(554443525,3016,!1,"No next node with pull quote")}else z.ULS.shipAssertTag(554443524,3016,!1,"No PullQuote success callback");else z.ULS.shipAssertTag(554443523,3016,!1,"No PullQuoteSuggestion");else z.ULS.shipAssertTag(554443522,3016,!1,"No PullQuoteNode")}WBj(e){if(e){var t=this.sBm(e);this.Kf.YDa(e);t&&this.lb.Ic(df.SelectionEditor.Wj(hi.SelectionFactory.Fo(Zd.a.create(t)),
!1,!1));return t}z.ULS.shipAssertTag(554443526,3016,!1,"No PullQuoteNode")}sBm(e){if(!e)return null;const t=new Ld.GraphIterator;t.set(e);t.Jd();t.uc();return t.Fk()?t.currentNode:null}}ls.bKo=9509.76;ls.dKo=50;ls.cKo=39;ls.XIj=914400;ls.aKo=7772400;Object(y.a)(ls,"PullQuotesDesignerImpl",null,[1227]);class TA{constructor(e,t,E,W){this.IA=e;this.Mre=t;this.VP=E;this.sc=W}XSd(e){const t=this.IA.Mc(15,Fa.a.XSd,!1),E=Rd.a.create();try{t.Xz.Ab(this.sc.jd);let W=!0;for(const ha of e)t.Xz.sMa(E,1),W=this.VP.Qvj(ha,
Ka=>({role:27,paragraphNode:this.Mre.rOh(Ka,E),placeholder:!0}))&&W;return W}catch(W){return z.ULS.shipAssertTag(555034255,3016,!1,String.format("Applying pull quotes failed. Exception: {0} {1}",W.message,W.stack)),!1}finally{t&&t.dispose()}}}Object(y.a)(TA,"PullQuotesManagerImpl",null,[1225]);class DG{constructor(e,t,E){this.Yo=e;this.tg=t;this.Vu=E;this.dialog=null;this.T$a=!1;this.Pza=W=>{1==W&&this.lwj(!0);this.T$a=!1}}revertTheme(){return this.tg.X_?this.tg.wba()?this.lwj():(this.openDialog(),
!1):(z.ULS.shipAssertTag(539829795,3016,!1),!1)}lwj(e=!1){var t=this.Vu;if(null===t||void 0===t||!t.jd)return z.ULS.shipAssertTag(539808770,3016,!1),!1;const E=this.Yo.Mc(7,Fa.a.Vvg);E.Ab(t.jd);t=!0;try{for(;t&&this.tg.X_&&!this.tg.wba();)t=this.tg.undo();t&&this.tg.X_&&this.tg.wba()?t=this.tg.undo():(z.ULS.shipAssertTag(539829824,3016,!1,String.format("Has undo entries:{0}",this.tg.X_)),t=!1)}finally{return null===E||void 0===E?void 0:E.dispose(),e=Object.assign(new yi.a,{name:"DialogShown",bool:e}),
ma.a(Df.a.fao,t,void 0,[e]),t}}openDialog(){this.T$a||(this.dialog=new Pa.StandardDialog,this.dialog.Gd=1,this.dialog.Pe(1,WordEditorIntl.WordEditorStrings.L_DesignerRevertDialogButtonLabel),this.dialog.Qg=Df.a.eIo,this.dialog.Ix(WordEditorIntl.WordEditorStrings.L_DesignerRevertDialogTitle,WordEditorIntl.WordEditorStrings.L_DesignerRevertDialogDescription,0,this.Pza),this.T$a=!0)}}Object(y.a)(DG,"RevertManager",null,[1224]);class lE{zjc(e){return 27===e?WordEditorIntl.WordEditorStrings.L_DesignerPullQuoteReviewTitle:
28===e?WordEditorIntl.WordEditorStrings.L_DesignerImageSuggestionV2ReviewTitle:WordEditorIntl.WordEditorStrings.L_DesignerFormattingFixesReviewTitle}}Object(y.a)(lE,"ReviewDescriptionBuilder",null,[1223]);class ei{constructor(e,t,E){E?(this.Xrd=Uk(e),this.bUc=Uk(t)):(this.Xrd=e,this.bUc=t)}}Object(y.a)(ei,"FontPairing",null,[]);class mE{pN(e){return e?Qd.a.MT(e.Xrd)^Qd.a.MT(e.bUc):0}equals(e,t){return e.Xrd===t.Xrd&&e.bUc===t.bUc}dla(e){return e.Xrd+":"+e.bUc}}Object(y.a)(mE,"EqualityComparer",null,
[15,16]);class hh{constructor(e,t){this.vV=e;this.bM=t;this.Lrd=null;hh.d7m();hh.k8m();hh.h7f=new kg.a(oi.a.th())}Caj(e){this.bM.Yd(()=>{this.GFn(e)},"WD:LTCI")}GFn(e){var t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h;if(e.styles&&!hh.h7f.contains(e.name)){hh.h7f.add(e.name);var rj=[Object.assign(new yi.a,{name:"themeId",int64:this.vV.vlc(e.name)}),Object.assign(new yi.a,{name:"formalInformalCategory",int64:hh.Zyi(e)}),Object.assign(new yi.a,{name:"traditionalModernCategory",int64:hh.MJi(e)}),
Object.assign(new yi.a,{name:"titleFontName",string:It(null===(t=e.styles.get("Title"))||void 0===t?void 0:t.fontName)}),Object.assign(new yi.a,{name:"bodyFontName",string:It(null===(E=e.styles.get("BodyText"))||void 0===E?void 0:E.fontName)}),Object.assign(new yi.a,{name:"titleFontColor",string:null===(W=e.styles.get("Title"))||void 0===W?void 0:W.fontColor.toString(16)}),Object.assign(new yi.a,{name:"subtitleFontColor",string:null===(ha=e.styles.get("Subtitle"))||void 0===ha?void 0:ha.fontColor.toString(16)}),
Object.assign(new yi.a,{name:"heading1FontColor",string:null===(Ka=e.styles.get("Heading1"))||void 0===Ka?void 0:Ka.fontColor.toString(16)}),Object.assign(new yi.a,{name:"titleAlignment",int64:null===(sb=e.styles.get("Title"))||void 0===sb?void 0:sb.alignment}),Object.assign(new yi.a,{name:"subtitleAlignment",int64:null===(dc=e.styles.get("Subtitle"))||void 0===dc?void 0:dc.alignment}),Object.assign(new yi.a,{name:"heading1Alignment",int64:null===(xc=e.styles.get("Heading1"))||void 0===xc?void 0:
xc.alignment}),Object.assign(new yi.a,{name:"bodyAlignment",int64:null===(Rc=e.styles.get("BodyText"))||void 0===Rc?void 0:Rc.alignment}),Object.assign(new yi.a,{name:"bodyFontSize",int64:null===(md=e.styles.get("BodyText"))||void 0===md?void 0:md.fontSize}),Object.assign(new yi.a,{name:"orderInThePane",int64:this.mOm(e.name)}),Object.assign(new yi.a,{name:"backgroundColor",string:null===(ud=e.backgroundColor)||void 0===ud?void 0:ud.toString(16)}),Object.assign(new yi.a,{name:"themeImageDecorator",
bool:null!==(Id=null===(Ud=e.decorators)||void 0===Ud?void 0:Ud.some(zl=>zl.type===Oo.themeImage))&&void 0!==Id?Id:!1}),Object.assign(new yi.a,{name:"titleTableDecorator",bool:null!==(Ke=null===(kf=null===(Ee=e.styles.get("Title"))||void 0===Ee?void 0:Ee.decorators)||void 0===kf?void 0:kf.some(zl=>zl.type===Oo.table))&&void 0!==Ke?Ke:!1}),Object.assign(new yi.a,{name:"complexThemeDecorator",bool:null!==($h=null===(dh=e.decorators)||void 0===dh?void 0:dh.some(zl=>zl.type===Oo.complexDecorator))&&void 0!==
$h?$h:!1})];ma.a(Df.a.djp,!0,void 0,rj)}}static Zyi(e){e=hh.qJi(e);return hh.Qr.mb(e)?hh.Qr.J(e):3}static MJi(e){e=hh.qJi(e);return hh.ks.mb(e)?hh.ks.J(e):3}static d7m(){hh.Qr=new hk.a(new mE);hh.Qr.add(new ei("Walbaum Display","Walbaum Text",!0),0);hh.Qr.add(new ei("Century Gothic","Century Gothic",!0),0);hh.Qr.add(new ei("Perpetua","Perpetua",!0),0);hh.Qr.add(new ei("Elephant Pro","Walbaum Text",!0),0);hh.Qr.add(new ei("Imprint MT Shadow","Sabon Next LT",!0),0);hh.Qr.add(new ei("Sitka Banner","Sitka Text",
!0),0);hh.Qr.add(new ei("Sitka Banner","Franklin Gothic Book",!0),0);hh.Qr.add(new ei("Avenir Next LT Pro Light","Avenir Next LT Pro",!0),0);hh.Qr.add(new ei("Univers Condensed Light","Univers",!0),0);hh.Qr.add(new ei("Univers","Univers",!0),0);hh.Qr.add(new ei("Walbaum Display Light","Avenir Next",!0),0);hh.Qr.add(new ei("Goudy Type","Dante",!0),0);hh.Qr.add(new ei("Lucida Calligraphy","Dante",!0),0);hh.Qr.add(new ei("Edwardian Script ITC","Sabon Next LT",!0),0);hh.Qr.add(new ei("Footlight MT Light",
"Goudy Old Style",!0),0);hh.Qr.add(new ei("Rockwell Nova Light","News Gothic MT",!0),1);hh.Qr.add(new ei("Walbaum Display","News Gothic MT",!0),1);hh.Qr.add(new ei("Cooper Black","Neue Haas Grotesk Text Pro",!0),1);hh.Qr.add(new ei("Franklin Gothic Heavy","Franklin Gothic Book",!0),0);hh.Qr.add(new ei("Calibri Light","Calibri Body",!0),0);hh.Qr.add(new ei("Impact","Neue Haas Grotesk Text Pro",!0),1);hh.Qr.add(new ei("Rockwell Nova","Trade Gothic Next",!0),1);hh.Qr.add(new ei("Trade Gothic Next Heavy",
"Georgia",!0),1);hh.Qr.add(new ei("Tisa Offc Serif Pro","Avenir Next",!0),1);hh.Qr.add(new ei("Quire Sans","Tisa Offc Serif Pro",!0),1);hh.Qr.add(new ei("Amasis MT Pro","Trade Gothic Next",!0),1);hh.Qr.add(new ei("Trade Gothic Next Cond","Trade Gothic Next",!0),1);hh.Qr.add(new ei("Plantagenet Cherokee","Calibri (Body)",!0),1);hh.Qr.add(new ei("Brush Script MT","Corbel",!0),1);hh.Qr.add(new ei("Elephant Pro","Amasis MT Pro",!0),2);hh.Qr.add(new ei("Rockwell Nova Extra Bold","Amasis MT Pro",!0),2);
hh.Qr.add(new ei("Cooper Black","Amasis MT Pro",!0),2);hh.Qr.add(new ei("Sagona ExtraLight","Quire Sans",!0),2);hh.Qr.add(new ei("Gill Sans Nova Ultra Bold","Gill Sans Nova",!0),2);hh.Qr.add(new ei("Sagona Book","Amasis MT Pro",!0),2);hh.Qr.add(new ei("Trade Gothic Next Inline","Avenir Next",!0),2);hh.Qr.add(new ei("Modern Love","Avenir Next LT Pro",!0),2);hh.Qr.add(new ei("The Serif Hand Black","Amasis MT Pro Light",!0),2);hh.Qr.add(new ei("The Hand Black","Avenir Next LT Pro",!0),2);hh.Qr.add(new ei("Tisa Offc Serif Pro",
"Selawik",!0),2);hh.Qr.add(new ei("Walbaum Display SemiBold","News Gothic MT",!0),2);hh.Qr.add(new ei("Baskerville Old Face","Franklin Gothic Book",!0),2);hh.Qr.add(new ei("Mistral","Univers",!0),2);hh.Qr.add(new ei("Magneto","Ebrima",!0),2)}static k8m(){hh.ks=new hk.a(new mE);hh.ks.add(new ei("Walbaum Display","Walbaum Text",!0),0);hh.ks.add(new ei("Perpetua","Perpetua",!0),0);hh.ks.add(new ei("Elephant Pro","Walbaum Text",!0),0);hh.ks.add(new ei("Imprint MT Shadow","Sabon Next LT",!0),0);hh.ks.add(new ei("Rockwell Nova Light",
"News Gothic MT",!0),0);hh.ks.add(new ei("Walbaum Display","News Gothic MT",!0),0);hh.ks.add(new ei("Cooper Black","Neue Haas Grotesk Text Pro",!0),0);hh.ks.add(new ei("Elephant Pro","Amasis MT Pro",!0),0);hh.ks.add(new ei("Rockwell Nova Extra Bold","Amasis MT Pro",!0),0);hh.ks.add(new ei("Cooper Black","Amasis MT Pro",!0),0);hh.ks.add(new ei("Goudy Type","Dante",!0),0);hh.ks.add(new ei("Lucida Calligraphy","Dante",!0),0);hh.ks.add(new ei("Century Gothic","Century Gothic",!0),1);hh.ks.add(new ei("Sitka Banner",
"Sitka Text",!0),1);hh.ks.add(new ei("Sitka Banner","Franklin Gothic Book",!0),1);hh.ks.add(new ei("Franklin Gothic Heavy","Franklin Gothic Book",!0),1);hh.ks.add(new ei("Impact","Neue Haas Grotesk Text Pro",!0),1);hh.ks.add(new ei("Rockwell Nova","Trade Gothic Next",!0),1);hh.ks.add(new ei("Trade Gothic Next Heavy","Georgia",!0),1);hh.ks.add(new ei("Sagona ExtraLight","Quire Sans",!0),1);hh.ks.add(new ei("Gill Sans Nova Ultra Bold","Gill Sans Nova",!0),1);hh.ks.add(new ei("Sagona Book","Amasis MT Pro",
!0),1);hh.ks.add(new ei("Trade Gothic Next Inline","Avenir Next",!0),1);hh.ks.add(new ei("Trade Gothic Next Cond","Trade Gothic Next",!0),1);hh.ks.add(new ei("Plantagenet Cherokee","Calibri (Body)",!0),1);hh.ks.add(new ei("Baskerville Old Face","Franklin Gothic Book",!0),1);hh.ks.add(new ei("Mistral","Univers",!0),1);hh.ks.add(new ei("Brush Script MT","Corbel",!0),1);hh.ks.add(new ei("Avenir Next LT Pro Light","Avenir Next LT Pro",!0),2);hh.ks.add(new ei("Univers Condensed Light","Univers",!0),2);
hh.ks.add(new ei("Univers","Univers",!0),2);hh.ks.add(new ei("Walbaum Display Light","Avenir Next",!0),2);hh.ks.add(new ei("Tisa Offc Serif Pro","Avenir Next",!0),2);hh.ks.add(new ei("Quire Sans","Tisa Offc Serif Pro",!0),2);hh.ks.add(new ei("Amasis MT Pro","Trade Gothic Next",!0),2);hh.ks.add(new ei("Modern Love","Avenir Next LT Pro",!0),2);hh.ks.add(new ei("The Serif Hand Black","Amasis MT Pro Light",!0),2);hh.ks.add(new ei("The Hand Black","Avenir Next LT Pro",!0),2);hh.ks.add(new ei("Tisa Offc Serif Pro",
"Selawik",!0),2);hh.ks.add(new ei("Calibri Light","Calibri Body",!0),2);hh.ks.add(new ei("Walbaum Display SemiBold","News Gothic MT",!0),2);hh.ks.add(new ei("Footlight MT Light","Goudy Old Style",!0),2);hh.ks.add(new ei("Magneto","Ebrima",!0),2);hh.ks.add(new ei("Edwardian Script ITC","Sabon Next LT",!0),2)}static qJi(e){var t,E;const W=null===(t=e.styles.get("Title"))||void 0===t?void 0:t.fontName;e=null===(E=e.styles.get("BodyText"))||void 0===E?void 0:E.fontName;return W&&e?new ei(W,e,!1):new ei("default",
"default",!1)}mOm(e){this.Lrd||this.i8m(this.vV.tti());return this.Lrd.has(e)?this.Lrd.get(e):(z.ULS.shipAssertTag(554995927,3016,!1),-1)}i8m(e){this.Lrd=new Map;for(let t=0;t<e.length;t++)this.Lrd.set(e[t].name,t)}}hh.Qr=null;hh.ks=null;hh.h7f=null;Object(y.a)(hh,"ThemeCategorizer",null,[1219]);class Cx{constructor(e,t){this.Zg=e;this.IGe=t}T9l(e){let t=null;const E=hh.Zyi(e),W=hh.MJi(e),ha=this.ufn();ha||z.ULS.sendTraceTag(523257814,3016,50,"applyThemeToTables - default color palette is changed");
0===E?ha&&1!==W?2===W?t="List Table 3 {0}":0===W&&(t="Grid Table 3 {0}"):t="Plain Table 3":2===E?ha&&2!==W?0===W?t="Grid Table 5 Dark {0}":1===W&&(t="List Table 5 Dark {0}"):t="Plain Table 5":1===E?ha&&1!==W?2===W?t="Grid Table 3 {0}":0===W&&(t="List Table 7 Colorful {0}"):t="Plain Table 5":t="Table Grid";e=this.a8l(e.colorLabel);return String.format(t,e)}a8l(e){return e.includes("Blue")?"Accent 1":e.includes("Orange")?"Accent 2":e.includes("Yellow")?"Accent 4":e.includes("Turquoise")?"Accent 5":
e.includes("Green")?"Accent 6":"Accent 3"}ufn(){var e=dk.PageReader.instance.Mkc();if(!e)return!1;e=e.ja(fd.a.cfb,null);return Ok.a.PSb(e)}Uin(e){return e.startsWith(Cx.qcn)?!1:!0}o9k(e,t){e=this.T9l(e);for(const W of t){t=this.Zg.k3(W);var E=this.Zg.VG(W);E=this.Zg.P9d(E);z.ULS.sendTraceTag(523572700,3016,50,`applyThemeToTables - current properties: preserveLook=${!0},
            tableLook=${t},
            currentStyle=${E}`);1696===t&&(this.Uin(E)||(t=32));this.IGe.TPj(e,t,W)}}}Cx.qcn="Table Grid";Object(y.a)(Cx,"TableDesigner",null,[1221]);var rz=d(1782);class nE{constructor(e,t){this.iif=e;this.qL=t;this.isInitialized=!1}initialize(){this.isInitialized||(this.isInitialized=!0,this.iif.register())}Pd(){this.isInitialized&&(this.iif.unregister(),this.isInitialized=!1)}zNm(e){if(e){var t=null,E=[],W=[],ha=[],Ka=[],sb=null;sb=Hc.a.iq(e);sb.vp(dc=>36!==dc.lf,null);for(e=null;sb.moveNext();)if(e=
sb.currentNode,14===e.type){t||(t=e);break}if(t){t=Ld.GraphIterator.eb(t);do{sb=t.currentNode;if(this.qL.read(sb))ha.push(sb);else if(e=this.xNm(sb))switch(e.type){case rz.TableType.SimpleHeaded:W.push(sb);break;case rz.TableType.Other:E.push(sb)}else z.ULS.sendTraceTag(524149721,3016,50,"No TableTypeAnnotation for table in document."),Ka.push(sb);t.Es||t.Qbo()}while(Object(fk.moveToNextTable)(t))}z.ULS.sendTraceTag(523902976,3016,50,`getTables stats: otherTables=${E.length},
      simpleHeadedTables=${W.length},
      decoratorTables=${ha.length},
      noAnnotationTables=${Ka.length}`);return{other:E,LVj:W,xNl:ha,rQn:Ka}}z.ULS.shipAssertTag(524113552,3016,!1,"No target node")}xNm(e){e=this.iif.Gti(e);for(const t of e)if(t.annotationType===rz.TableTypeAnnotation.getTypeName())return t.content}}Object(y.a)(nE,"TableManager",null,[1220,511]);class cv{constructor(e,t,E){this.Uzc=e;this.$d=t;this.ro=E;this.ed=new ua.a;this.pPe=this.Kw=null;this.areUserSettingsLoaded=this.isInitialized=!1;this.Jwe=null;this.b4=()=>{if(this.$d.Ujf())if(this.ro.B2()){this.areUserSettingsLoaded=
!0;var W=this.jHj();0<W.length&&this.Kw.unshift({label:am.favorites,labelDisplayName:null,id:new Rn(am.favorites),displayName:null,items:W,isLoaded:!0,V_:!1});this.Kw=null;this.ed.raiseEvent("OnThemesChanged");this.ro.vZb(this.b4)}else this.areUserSettingsLoaded=!1,z.ULS.shipAssertTag(512337434,3016,!1)};this.P0n=()=>{this.Kw=null;this.ed.raiseEvent("OnThemesChanged")};this.dWb=Df.a.W5m}get tMl(){if(!this.pPe){const e=this.Uzc.filter(t=>t instanceof wk);this.pPe=0===e.length?null:e[0]}return this.pPe}initialize(){this.isInitialized||
(this.Uzc.forEach(e=>{e.SRd(this.P0n);e!=this.tMl&&e.initialize()}),this.isInitialized=!0,this.$d.Ujf()&&!this.ro.B2()&&(this.areUserSettingsLoaded=!1,this.ro.Pcc(this.b4)))}Pd(){this.$d.Ujf()&&this.ro.vZb(this.b4)}SRd(e){this.ed.addHandler("OnThemesChanged",e)}cEj(e){this.ed.removeHandler("OnThemesChanged",e)}D1k(e){this.ed.addHandler("OnShowMoreThemes",e)}sjc(){var e;const t=null===(e=this.Uzc.find(E=>E instanceof Gu))||void 0===e?void 0:e.sjc();return t?new Rn(t):void 0}ZPf(){const e=this.INl(this.phm()),
t=this.fCi();e.forEach(E=>{E.id.getLabel()===am.main&&(E.items=t.items.slice(0,this.dWb))});return e}phm(){var e;if(this.Kw)return this.Kw;this.Kw=[];for(const t of this.Uzc)if(!(t instanceof wk)&&t.Y9d())for(const E of t.Y9d()){let W;if(this.$d.ptb())if(W=E.displayName?this.Kw.filter(ha=>{var Ka,sb;return(null===(Ka=ha.displayName)||void 0===Ka?void 0:Ka.toLowerCase())===(null===(sb=E.displayName)||void 0===sb?void 0:sb.toLowerCase())}):null,0<(null===W||void 0===W?void 0:W.length)){for(const ha of E.items){const Ka=
null===(e=W[0].items)||void 0===e?void 0:e.filter(sb=>sb.name===ha.name);Ka&&0!==Ka.length||W[0].items.push(ha)}E.V_&&E.V_!==W[0].V_&&(W[0].V_=E.V_)}else this.Kw.push(E);else W=this.Kw.filter(ha=>ha.label===E.label),0<(null===W||void 0===W?void 0:W.length)?W[0].items.push(...E.items):this.Kw.push(E)}this.$d.yXi()&&this.Kw.forEach(t=>{for(const E of t.items)E.type===Pp.theme&&E.styles.forEach(W=>{var ha=W.fontColor;const Ka=18<=W.fontSize||14<=W.fontSize&&W.bold?3:4.5;ha=Ok.a.P5d(ha)<Ka?pt.has(ha)?
pt.get(ha):0:ha;W.fontColor=ha})});this.Kw.forEach(t=>{for(const ha of t.items)if(ha.type===Pp.theme||ha.type===Pp.templateTheme||ha.type===Pp.officeTemplate){var E=void 0;t=ha;if(null===(E=t.styles)||void 0===E?0:E.has("Heading1")){E=t;a:{var W=t.styles.get("Heading1").fontName;W=It(W);for(const Ka of vr)if(void 0!==Ka&&W.startsWith(Ka)){W=Ka;break a}z.ULS.shipAssertTag(557672E3,3016,!1);W=void 0}E.fontLabel=W}t.colorLabel=Yn.Iul(t.accentColor)}});if(this.$d.vYf()){if(!this.ro.B2())return this.areUserSettingsLoaded=
!1,z.ULS.shipAssertTag(512522208,3016,!1),this.Kw;this.areUserSettingsLoaded=!0;e=this.jHj();0<e.length&&this.Kw.unshift({label:am.favorites,labelDisplayName:null,id:new Rn(am.favorites),displayName:null,items:e,isLoaded:!0,V_:!1})}return this.Kw}jHj(){const e=[];var t=this.ro.Hym();if(0<(null===t||void 0===t?void 0:t.length)){const E=this.tti();for(const W of t)if(t=E.find(ha=>ha.id==W))t.isThemeInFavorites=!0,e.push(t)}return e}tti(){var e;const t=[];null===(e=this.Kw)||void 0===e?void 0:e.forEach(E=>
{t.push(...E.items)});return t}vlc(e){for(const t of this.Uzc)if(t.Q4c()&&t.Q4c().mb(e))return t.Q4c().J(e);z.ULS.shipAssertTag(590386456,3016,!1);return 0}toggleFavorite(e){this.ro.Ukp(e.id);e.isThemeInFavorites=!e.isThemeInFavorites;this.Kw=null;this.ed.raiseEvent("OnThemesChanged")}xAn(){var e,t;this.dWb+=Df.a.LSn;const E=null!==(t=null===(e=this.fCi())||void 0===e?void 0:e.items.length)&&void 0!==t?t:0;e=this.dWb<E;this.dWb=Math.min(this.dWb,E);this.ed.raiseEvent("OnShowMoreThemes",new le.a(e));
return this.dWb}O7i(){if(null!==this.Jwe)for(const e of this.Uzc)e.V_(this.Jwe)&&e.nie(this.Jwe,!0)}setSelectedSection(e){this.Jwe=e;this.O7i()}fCi(){var e;if(null===(e=this.Kw)||void 0===e||!e.length)return null;for(const t of this.Kw)if(t.id.getLabel()===am.main)return t;return null}INl(e){const t=[];null===e||void 0===e?void 0:e.forEach(E=>{t.push({label:E.label,labelDisplayName:E.labelDisplayName,id:E.id,displayName:E.displayName,items:[...E.items],isLoaded:E.isLoaded,V_:E.V_})});return t}}Object(y.a)(cv,
"ThemeGenerator",null,[1218,511]);class EG{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj,zl){this.Jcl=e;this.F7a=t;this.$d=E;this.bM=W;this.IA=ha;this.fu=Ka;this.pK=sb;this.i4=dc;this.Dg=xc;this.VP=Rc;this.iep=md;this.Rrp=ud;this.sc=Ud;this.WIo=Id;this.Rm=Ee;this.A2=kf;this.qL=Ke;this.vgp=dh;this.pgp=$h;this.Pp=rj;this.tL=zl;this.ujj=()=>{var Wl;null===(Wl=this.tL)||void 0===Wl?void 0:Wl.q1d();this.A2.QDj(this.ujj)}}async applyTheme(e,t){var E,W,ha,Ka;if(!e)return z.ULS.shipAssertTag(593073563,
3016,!1),!1;const sb=this.Pp.Vf("UserAction",Df.a.applyTheme),dc=Date.now();let xc;try{const Rc=this.Dg.Fea(this.sc.jd),md=this.$d.qen();this.WIo.GUn();let ud=this.n4c();await this.Klg(ud);if(e.type===Pp.templateTheme||e.type===Pp.officeTemplate)null===(E=this.tL)||void 0===E?void 0:E.mFg();2!==(null===(W=this.tL)||void 0===W?void 0:W.WVa())&&(this.qL.dYm()?(this.bM.Yd(()=>this.F7a.hxo(),"WD:RAD"),ud=this.n4c()):this.$d.ptb()&&this.F7a.eYm()&&(this.F7a.Wyo(),this.CF(),ud=this.n4c()));const Ud=this.LEm(e,
ud);E=!1;let Id=wb.a.f6a;if(this.A2.R3o(e,Ud)){if(e.type===Pp.templateTheme||e.type===Pp.officeTemplate)E=!0,this.A2.ygf(this.ujj);this.A2.showDialog();Id=wb.a.Sif}let Ee;this.$d.pde()&&(Ee=this.vgp.zNm(this.sc.jd));const kf=null===Ee||void 0===Ee?void 0:Ee.LVj,Ke=this.Yho(e,ud,kf,Rc&&md,t,Id);this.Qho(e,Ud);this.Zho(e);e.type!==Pp.templateTheme||E||(null===(ha=this.tL)||void 0===ha?void 0:ha.q1d());z.ULS.sendTraceTag(543481999,3016,50,`applyTheme result=${Ke},
        isDocumentEmpty=${Rc},
        isBootstrappingEnabled=${md},
        areTablesEnabled=${this.$d.pde()},
        areSimpleHeadedTablesDetected=${0<(null===kf||void 0===kf?void 0:kf.length)}`);xc=[Object.assign(new yi.a,{name:Df.a.h9k,int64:Ee.other.length}),Object.assign(new yi.a,{name:Df.a.j9k,int64:Ee.LVj.length}),Object.assign(new yi.a,{name:Df.a.c9k,int64:Ee.xNl.length}),Object.assign(new yi.a,{name:Df.a.g9k,int64:Ee.rQn.length}),Object.assign(new yi.a,{name:Df.a.i9k,int64:Ke}),Object.assign(new yi.a,{name:Df.a.e9k,int64:Rc}),Object.assign(new yi.a,{name:Df.a.d9k,int64:md}),Object.assign(new yi.a,
{name:Df.a.b9k,int64:this.$d.pde()}),Object.assign(new yi.a,{name:"IsProactivePane",bool:bm.B$c}),Object.assign(new yi.a,{name:"DesignType",string:null===(Ka=null===bm||void 0===bm?void 0:bm.WC)||void 0===Ka?void 0:Ka.sNb.toString()}),Object.assign(new yi.a,{name:"IsTemplateApplied",string:bm.WC&&0!=bm.WC.sNb})];return Ke}catch(Rc){return z.ULS.shipAssertTag(592720733,3016,!1,String.format("{0} {1}",Rc.message,Rc.stack)),xc=[Object.assign(new yi.a,{name:"error",string:Rc.message})],!1}finally{ma.a(Df.a.f9k,
!0,Date.now()-dc,xc),sb.stop()}}Yho(e,t,E=[],W=!1,ha=!1,Ka=wb.a.f6a){var sb,dc,xc;let Rc=!0;Ka=this.IA.Mc(15,Ka);try{Ka.Xz.Ab(this.sc.jd);this.bM.Yd(()=>this.iep.T0l(e),"WD:MS");const md=this.Rrp.create(e,ha||2===(null===(sb=this.tL)||void 0===sb?void 0:sb.WVa()),2===(null===(dc=this.tL)||void 0===dc?void 0:dc.WVa()));md.F4h(t);this.bM.Yd(()=>{for(const ud of t)Rc=!!this.VP.oho(ud,(Ud,Id)=>{md.vuc(Id,Ud)||this.bM.Yd(()=>this.pK.Ija(Id,Ud.role),"WD:ASFR");return!0})&&Rc},"WD:PPFAT");this.bM.Yd(()=>
md.qKb(),"WD:URPAF");this.bM.Yd(()=>this.fu.u9(),"WD:ULN");this.bM.Yd(()=>this.Iif(e),"WD:ABC");W&&this.Jcl.rce(this.$d.Ben());2!==(null===(xc=this.tL)||void 0===xc?void 0:xc.WVa())&&(null===E||void 0===E?0:E.length)&&this.bM.Yd(()=>this.pgp.o9k(e,E),"WD:ATTT")}finally{Ka&&Ka.dispose()}return Rc}LEm(e,t){var E,W,ha,Ka,sb=new Set;for(const [dc,xc]of e.styles)(null===(E=xc.decorators)||void 0===E?0:E.length)&&sb.add(tl.g(dc));e=new fa.a(t.filter(dc=>Xf.ParagraphReader.Xb(dc)&&!dc.hJa));sb=this.Rm.nEi(sb,
e);if(!sb.has(2))for(const dc of e)e=null!==(ha=null===(W=this.Rm.YB(dc))||void 0===W?void 0:W.role)&&void 0!==ha?ha:1,t=null===dc||void 0===dc?void 0:dc.iQ,(null!==(Ka=null===t||void 0===t?void 0:t.ja(fd.a.ma,void 0))&&void 0!==Ka?Ka:void 0)==Zj.StyleReader.KAb&&1===e&&(this.Rm.jod(dc,2,!1),sb.set(2,new fa.a([dc])));return sb}Qho(e,t){this.bM.Yd(()=>{for(const E of t.keys())for(const W of t.get(E))this.bM.Yd(()=>{var ha;return this.F7a.mTh(W,null===(ha=e.styles.get(tl.h(E)))||void 0===ha?void 0:
ha.decorators,e.type)},"WD:ADFS")},"WD:PSD")}Zho(e){e.decorators&&this.bM.Yd(()=>this.F7a.mTh(this.sc.jd,e.decorators,e.type),"WD:ADFT")}async Klg(e){e=this.F7a.Klg(e);let t;const E=new Promise(W=>t=setTimeout(()=>{W();z.ULS.sendTraceTag(527202188,3016,50,"Reading intelligence timed out")},2E3));await Promise.race([e,E]);clearTimeout(t)}Iif(e){var t;const E=null===(t=this.sc)||void 0===t?void 0:t.jd;E?void 0===e.backgroundColor?E.hasProperty(Tb.a.kS)&&E.setValue(Tb.a.kS,Ok.a.vH):E.setValue(Tb.a.kS,
Ok.a.T0(e.backgroundColor)):z.ULS.shipAssertTag(541102279,3016,!1)}n4c(){const e=this.Dg.Zl(this.sc.jd),t=this.i4.Jra(e,!0,!1),E=[];this.bM.Yd(()=>{do E.push(t.my);while(t.lba())},"WD:IFAP");return E}CF(){this.Dg.Zl(this.sc.jd).Jj().yg.CF(null,()=>{z.ULS.sendTraceTag(508937036,3016,50,"forceOutbound failed")},null)}}Object(y.a)(EG,"ThemeManager",null,[1217]);class oE{constructor(e,t,E,W){this.y$g=null;this.IM=e;this.dkb=t;this.qtk=W;this.TLe=new fa.a;this.sJh=new fa.a}F4h(){}vuc(e,t){if(!e)return z.ULS.shipAssertTag(590206988,
3016,!1),!1;switch(t.role){case 1:return this.sJh.add(e),!0;case 13:return this.rgo(e,t.bab),!1;default:return!1}}qKb(){var e=this.qtk.styles.get(tl.h(13)),t=1;0<this.TLe.count&&(t=this.Bjl(this.TLe),t=2*e.fontSize/t);for(const E of this.sJh)if(e=Ld.GraphIterator.eb(E),Xf.ParagraphReader.isEmpty(e))this.dkb.Ija(E,13);else{e=[];if(1!==t){const W=Math.ceil(t*this.RZh(E));e.push({type:xb.FormattingSuggestionType.FontSize,fixedValue:W.toString()})}this.dkb.rmb(E,e)}}rgo(e,t){this.TLe.add(this.RZh(e));
!this.y$g&&t&&(this.y$g=this.Eni(e,Tb.a.font,null))}Eni(e,t,E){return(e=this.IM.Cs(Zd.a.create(e)))?this.IM.Bj(e,t,E):E}Bjl(e){e.Sc((E,W)=>E-W);const t=e.count>>1;return e.count%2?e.J(t):(e.J(t)+e.J(t-1))/2}RZh(e){const t=this.Eni(e,Tb.a.fontSize,Le.a.gP),E=(e.qa?e.qa.length:0)-1;let W=0,ha=0;for(let sb=0;sb<E;sb++){var Ka=e.qa.J(sb);const dc=e.qa.J(sb+1);let xc=t;Ka.formatting&&(xc=this.IM.Bj(Ka.formatting,Tb.a.fontSize,t));Ka=dc.cp-Ka.cp;W+=xc*Ka;ha+=Ka}return 0<ha?W/ha:t}}Object(y.a)(oE,"UnknownRoleProcessor",
null,[1245]);class UA{constructor(e,t,E=!1){this.pxf=e;this.r4=t;this.E2m=E;this.jLg=new Set}F4h(e){e.forEach(t=>{this.E2m&&(null===t||void 0===t?0:t.hJa)||1!==this.pxf.YB(t).role||(this.r4.nwc(t,!0),this.jLg.add(t))})}vuc(e){return this.jLg.has(e)}qKb(){this.jLg.forEach(e=>{this.r4.k_a(e,!0)})}}Object(y.a)(UA,"UnknownRoleProcessorPreserveStyle",null,[1245]);class FG{constructor(e,t,E,W,ha){this.pxf=e;this.b3=t;this.pK=E;this.$d=W;this.r4=ha}create(e,t,E=!1){return t?new UA(this.pxf,this.r4,E):new oE(this.b3,
this.pK,this.$d,e)}}Object(y.a)(FG,"UnknownRoleProcessorFactory",null,[1216]);class Dx{constructor(){this.initialized=!1;this.map=new Map}initialize(){this.initialized=!0}register(e,t){this.initialized||this.initialize();this.map.has(e)||this.map.set(e,[]);this.map.get(e).push(t)}unregister(e){this.map.delete(e)}}Object(y.a)(Dx,"ASuggestionLifecycleManager",null,[1213]);class vC extends Dx{constructor(e){super();this.xo=e;this.Fvb=(t,E)=>{if(E.property===Tb.a.lastModifiedTime&&this.map.has(E.node)){const W=
E.node.ja(Tb.a.lastModifiedTime,void 0);if(W){let ha=!0;this.map.get(E.node).forEach(Ka=>{Ka.ZTh&&Ka.ZTh>=W?Ka.rcd():ha=!1});ha&&this.map.delete(E.node)}}}}initialize(){this.xo.Ve(12).fo(this.Fvb);super.initialize()}register(e,t){super.register(e,t);t.ZTh=e.ja(Tb.a.lastModifiedTime,void 0)}}Object(y.a)(vC,"ConsistencySuggestionLifecycleManager",Dx,[1213]);class wC extends Dx{constructor(e){super();this.xo=e;this.Evb=(t,E)=>{this.map.has(E.node)&&(this.map.get(E.node).forEach(W=>{W.rcd()}),this.map.delete(E.node))};
this.tYn=(t,E)=>{this.map.has(E.node)&&!Object(Lg.a)(E.node,5)&&(this.map.get(E.node).forEach(W=>{(Object(Ha.e)(W)||2===(null===W||void 0===W?void 0:W.vr))&&W.rcd()}),this.map.delete(E.node))}}initialize(){const e=this.xo.Ve(12);e.Bw(this.Evb);e.fo(this.tYn);super.initialize()}}Object(y.a)(wC,"EnhancementSuggestionLifecycleManager",Dx,[1213]);class ms{constructor(e){this.tg=e;this.byf=this.Gxg=null;this.vge=this.isInitialized=!1;this.nDj=(t,E)=>{this.tg.wba(E.actionId)&&(this.Gxg?this.Gxg(null):z.ULS.shipAssertTag(574755666,
3016,!1))};this.h5j=()=>{this.byf?(this.byf(),ma.a(Df.a.lUl,!0),z.ULS.sendTraceTag(537794770,3016,50,"Revert button has been disabled")):z.ULS.shipAssertTag(537794769,3016,!1)}}initialize(){this.isInitialized||(this.rGg(),this.isInitialized=!0)}Pd(){this.isInitialized&&(this.FLg(),this.isInitialized=!1)}setSelectThemeButtonCallback(e){this.Gxg=e}setDisableRevertButtonCallback(e){this.byf=e}rGg(){this.vge||(this.tg.Qcc(this.nDj),this.tg.P1k(this.h5j),this.vge=!0)}FLg(){this.vge&&(this.tg.jtg(this.nDj),
this.tg.cBo(this.h5j),this.vge=!1)}}Object(y.a)(ms,"DesignerUndoTracker",null,[1212,511]);class hl extends bk.a{constructor(e,t){super(!1,!1,!0);this.Lw=e;this.Ht=t;this.eLb=void 0;this.kql=E=>{ma.a(Df.a.skk,!0,void 0,[{name:"chosenOption",string:E},{name:"index",int64:this.eLb.findIndex(W=>W.id===E)}]);this.hide();switch(E){case "Template":this.Lw.show(22);break;case "Upload":window.open("https://onedrive.live.com/");break;case "Learn":window.open("https://support.microsoft.com/en-us/word");break;
case "Other":this.Ht.invokeUserFeedback("WordUserIntentDialogSurvey")}}}n6m(){this.eLb=[{["id"]:"Explore",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogExplore,["imageSrc"]:Ff.a.ki("UserIntentExploreIcon.png")},{["id"]:"Template",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogTemplate,["imageSrc"]:Ff.a.ki("UserIntentTemplateIcon.png")},{["id"]:"Blank",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogBlank,["imageSrc"]:Ff.a.ki("UserIntentStartBlankIcon.png")},
{["id"]:"Upload",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogUpload,["imageSrc"]:Ff.a.ki("UserIntentUploadFileIcon.png")},{["id"]:"Learn",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogLearn,["imageSrc"]:Ff.a.ki("UserIntentHowToIcon.png")}];const e={["id"]:"Other",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogOther,["imageSrc"]:Ff.a.ki("UserIntentMoreItemsIcon.png")};hl.N8o(this.eLb);this.eLb.push(e)}m8o(){void 0===this.eLb&&this.n6m();localStorage.setItem(hl.Ufi,
"true");this.pi("",void 0,{["id"]:hl.id,["dialogButtonsOption"]:5,["bodyControls"]:{["dialogTitle"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogTitle,["dialogSubtitle"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogSubtitle,["chooseFunction"]:this.kql,["rowsInfo"]:[this.eLb.slice(0,3),this.eLb.slice(3,6)]}});ma.a(Df.a.tkk)}static N8o(e){for(let t=e.length-1;0<t;t--){const E=Math.floor(Math.random()*(t+1));[e[t],e[E]]=[e[E],e[t]]}}}hl.id="UserIntentDialog";hl.Ufi="UserIntentDialogShown";
Object(y.a)(hl,"UserIntentDialog",bk.a,[]);class pE{constructor(e,t){this.goa=e;this.G$j=t;this.isInitialized=!1;this.O2j=(E,W)=>{W.z4&&this.G$j&&this.G$j.m8o()}}initialize(){if(!this.isInitialized){for(const e of this.goa)e.aaa(this.O2j),e.initialize();this.isInitialized=!0}}Pd(){if(this.isInitialized){for(const e of this.goa)e.Pd(),e.pna(this.O2j);this.isInitialized=!1}}}Object(y.a)(pE,"UserIntentDialogTriggerManager",null,[1210]);var Oq=d(130);class at{constructor(e,t){this.theme=e;this.callback=
t}}Object(y.a)(at,"ApplyThemeActionData",null,[]);class pn{constructor(e){this.callback=e}}Object(y.a)(pn,"FixInconsistenciesActionData",null,[]);var VA=d(124);class xC{constructor(e,t){this.query=e;this.callback=t}}Object(y.a)(xC,"GenerateDocumentActionData",null,[]);class OI{constructor(e,t){this.template=e;this.mXn=t}}Object(y.a)(OI,"ApplyOfficeTemplateActionData",null,[]);class Hz{constructor(e,t,E,W,ha,Ka){this.D7a=ha;this.Cq=Ka;this.ga=e;this.mea=t;this.oJh=E}m9k(e,t){e=new at(e,t);this.ga.Pb(wb.a.f6a,
2,e)}o8k(e,t){e=new OI(e,t);this.ga.Pb(wb.a.rza,2,e)}generateDocument(e,t){e=new xC(e,t);this.ga.Pb(wb.a.FRl,2,e)}$$l(e){e=new pn(e);this.ga.Pb(Fa.a.T3d,2,e)}acceptAll(){const e=new dE.a(0);this.ga.Pb(wb.a.Tlb,2,e)}rejectAll(){this.ga.Ob(Fa.a.vkd,2)}showMoreThemes(){this.ga.Ob(Fa.a.xfi,2)}logThemeInfo(e){this.ga.Pb(Fa.a.sfi,2,{theme:e})}setReviewingCallback(e){this.mea.vXo(e)}setSelectThemeButtonCallback(e){this.oJh.setSelectThemeButtonCallback(e)}setDisableRevertButtonCallback(e){this.oJh.setDisableRevertButtonCallback(e)}reviewChanges(){this.ga.Ob(Fa.a.nxf,
2)}openGreenroomInNewTab(){this.ga.Ob(Fa.a.tfi,2)}invokeUserFeedback(e){this.D7a.Y_c(t=>{this.i8o(t,e)})}i8o(e,t){e.O_a(t,null)}tryAnyway(){this.ga.Ob(Fa.a.zfi,2)}revertTheme(){this.ga.Ob(Fa.a.Vvg,2)}getFontColorCssWithRespectTheming(e){return this.Cq.k6d(Ok.a.T0(e),new VA.a(Oq.a.jN()))}getColorCssWithRespectTheming(e){return this.Cq.f3(Ok.a.T0(e),new VA.a(Oq.a.jN()))}toggleFavorite(e,t){this.ga.Pb(Fa.a.nni,2,{theme:e,Hkn:t})}}Object(y.a)(Hz,"DesignerPropsActions",null,[1209]);class $m{constructor(){this.type=
null;this.isDataLoaded=!1;this.errorState=Pn.none;this.activeSection=this.sections=null;this.isPaneAutoOpened=!1;this.Tm=0;this.applyOfficeTemplate=this.applyTheme=this.reviewChanges=this.fixInconsistencies=null;this.inconsistenciesCount=0;this.rejectAll=this.acceptAll=null;this.hasMoreThemesToShow=!1;this.tryAnyway=this.logThemeInfo=this.tryAgain=this.showMoreThemes=null;this.errorTimeout=0;this.paneContent=this.revertTheme=this.openGreenroomInNewTab=this.invokeUserFeedback=this.setDisableRevertButtonCallback=
this.setSelectThemeButtonCallback=this.setReviewingCallback=null;this.canGetFocus=!0;this.generateDocument=this.toggleFavorite=null;this.areUserSettingsLoaded=!1;this.setSelectedSection=this.showMoreTemplates=null}}Object(y.a)($m,"DesignerTaskPaneData",null,[]);class bt{constructor(e,t,E,W,ha,Ka,sb,dc){this.$d=e;this.Ht=t;this.Qaa=E;this.l8n=W;this.vV=ha;this.Rm=Ka;this.fN=sb;this.tL=dc}Tmb(){var e,t;return Object.assign(new $m,{acceptAll:Object(ib.a)(this.Ht,this.Ht.acceptAll,"acceptAll"),applyTheme:Object(ib.a)(this.Ht,
this.Ht.m9k,"applyThemeHandler"),applyOfficeTemplate:Object(ib.a)(this.Ht,this.Ht.o8k,"applyOfficeTemplateHandler"),generateDocument:Object(ib.a)(this.Ht,this.Ht.generateDocument,"generateDocument"),isDataLoaded:this.l8n.Toc,errorState:this.Qaa.PMb,fixInconsistencies:Object(ib.a)(this.Ht,this.Ht.$$l,"fixInconsistenciesHandler"),inconsistenciesCount:this.Rm.inconsistenciesCount,invokeUserFeedback:void 0,rejectAll:Object(ib.a)(this.Ht,this.Ht.rejectAll,"rejectAll"),hasMoreThemesToShow:!0,showMoreThemes:Object(ib.a)(this.Ht,
this.Ht.showMoreThemes,"showMoreThemes"),logThemeInfo:Object(ib.a)(this.Ht,this.Ht.logThemeInfo,"logThemeInfo"),reviewChanges:Object(ib.a)(this.Ht,this.Ht.reviewChanges,"reviewChanges"),setReviewingCallback:Object(ib.a)(this.Ht,this.Ht.setReviewingCallback,"setReviewingCallback"),setSelectThemeButtonCallback:Object(ib.a)(this.Ht,this.Ht.setSelectThemeButtonCallback,"setSelectThemeButtonCallback"),setDisableRevertButtonCallback:Object(ib.a)(this.Ht,this.Ht.setDisableRevertButtonCallback,"setDisableRevertButtonCallback"),
sections:this.vV.ZPf(),activeSection:this.vV.sjc(),type:Df.a.H_j,tryAnyway:Object(ib.a)(this.Ht,this.Ht.tryAnyway,"tryAnyway"),openGreenroomInNewTab:this.$d.$gn()?Object(ib.a)(this.Ht,this.Ht.openGreenroomInNewTab,"openGreenroomInNewTab"):void 0,revertTheme:Object(ib.a)(this.Ht,this.Ht.revertTheme,"revertTheme"),isCanvasDarkModeOn:!!this.fN&&this.fN.N6,getFontColorCssWithRespectTheming:Object(ib.a)(this.Ht,this.Ht.getFontColorCssWithRespectTheming,"getFontColorCssWithRespectTheming"),getColorCssWithRespectTheming:Object(ib.a)(this.Ht,
this.Ht.getColorCssWithRespectTheming,"getColorCssWithRespectTheming"),paneContent:null!==(t=null===(e=this.tL)||void 0===e?void 0:e.sxi())&&void 0!==t?t:au.main,canGetFocus:!0,toggleFavorite:this.$d.vYf()?Object(ib.a)(this.Ht,this.Ht.toggleFavorite,"toggleFavorite"):void 0,areUserSettingsLoaded:this.vV.areUserSettingsLoaded,showMoreTemplates:Object(ib.a)(this.vV,this.vV.O7i,"loadMoreTemplates"),setSelectedSection:Object(ib.a)(this.vV,this.vV.setSelectedSection,"setSelectedSection")})}ctl(e){return Object.assign(new $m,
{acceptAll:e.acceptAll,applyTheme:e.applyTheme,applyOfficeTemplate:e.applyOfficeTemplate,generateDocument:e.generateDocument,isPaneAutoOpened:e.isPaneAutoOpened,errorState:e.errorState,isDataLoaded:e.isDataLoaded,fixInconsistencies:e.fixInconsistencies,inconsistenciesCount:e.inconsistenciesCount,invokeUserFeedback:e.invokeUserFeedback,rejectAll:e.rejectAll,hasMoreThemesToShow:e.hasMoreThemesToShow,showMoreThemes:e.showMoreThemes,logThemeInfo:e.logThemeInfo,reviewChanges:e.reviewChanges,setReviewingCallback:e.setReviewingCallback,
setSelectThemeButtonCallback:e.setSelectThemeButtonCallback,setDisableRevertButtonCallback:e.setDisableRevertButtonCallback,sections:e.sections,activeSection:e.activeSection,type:e.type,tryAnyway:e.tryAnyway,openGreenroomInNewTab:e.openGreenroomInNewTab,revertTheme:e.revertTheme,isCanvasDarkModeOn:e.isCanvasDarkModeOn,getFontColorCssWithRespectTheming:e.getFontColorCssWithRespectTheming,getColorCssWithRespectTheming:e.getColorCssWithRespectTheming,paneContent:e.paneContent,canGetFocus:e.canGetFocus,
toggleFavorite:this.$d.vYf()?e.toggleFavorite:void 0,areUserSettingsLoaded:e.areUserSettingsLoaded,showMoreTemplates:e.showMoreTemplates,setSelectedSection:e.setSelectedSection})}}Object(y.a)(bt,"DesignerPropsFactory",null,[1208]);class GG{constructor(e){this.exa=null;this.I5e=e;this.sa=new ua.a}c2k(e){this.sa.addHandler("PropsChangedEvent",e)}pla(){this.exa||(this.exa=this.I5e.Tmb());return this.exa}qxb(e,t=!1){if(e){this.exa||(z.ULS.shipAssertTag(592496460,3016,!1),this.exa=this.I5e.Tmb());var E=
this.I5e.ctl(this.exa);e(E);if(t||this.S4o(E))this.exa=E,e=new le.a(this.exa),this.sa.C7&&this.sa.raiseEvent("PropsChangedEvent",e)}else z.ULS.shipAssertTag(592496459,3016,!1)}S4o(e){return e.inconsistenciesCount!==this.exa.inconsistenciesCount||e.errorState!==this.exa.errorState||e.isDataLoaded!==this.exa.isDataLoaded||e.invokeUserFeedback!==this.exa.invokeUserFeedback}}Object(y.a)(GG,"DesignerPropsManager",null,[1207]);class qE{constructor(e,t,E,W,ha,Ka,sb,dc,xc=0,Rc,md){this.OJa=e;this.Qaa=t;this.Rm=
E;this.K4=W;this.vV=ha;this.aPg=Ka;this.Ht=sb;this.cGf=dc;this.Xio=xc;this.Vvf=Rc;this.tL=md;this.isInitialized=!1;this.Zng=0;this.Fid=null;this.UYn=(ud,Ud)=>{this.Byl(()=>{this.OJa.qxb(Id=>{Id.inconsistenciesCount=Ud.data;Id.canGetFocus=!0})})};this.zoe=()=>{this.OJa.qxb(ud=>{ud.sections=this.vV.ZPf();ud.activeSection=this.vV.sjc();ud.canGetFocus=!0;ud.areUserSettingsLoaded=this.vV.areUserSettingsLoaded},!0)};this.L2n=(ud,Ud)=>{this.OJa.qxb(Id=>{Id.sections=this.vV.ZPf();Id.hasMoreThemesToShow=Ud.data;
Id.canGetFocus=!0;Id.areUserSettingsLoaded=this.vV.areUserSettingsLoaded},!0)};this.cfg=()=>{this.OJa.qxb(ud=>{if(this.tL){const Ud=this.tL.sxi();ud.paneContent!==Ud&&(ud.activeSection=void 0,ud.paneContent=Ud,ud.canGetFocus=!1)}},!0)};this.Dhg=(ud,Ud)=>{this.OJa.qxb(Id=>{Id.isCanvasDarkModeOn=Ud.isCanvasDarkModeOn;Id.canGetFocus=!0},!0)};this.gMl=(ud,Ud)=>{this.OJa.qxb(Id=>{Id.errorState=Ud.data;Id.canGetFocus=!0})};this.Ipe=(ud,Ud)=>{this.OJa.qxb(Id=>{Id.isDataLoaded=Ud.data;Id.canGetFocus=!0;Id.isPaneAutoOpened=
bm.B$c})}}initialize(){this.isInitialized||(this.Rm.V0k(this.UYn),this.Qaa.vPh(this.gMl),this.vV.SRd(this.zoe),this.vV.D1k(this.L2n),this.K4.Dgf(this.Ipe),this.Vvf.MRd(this.Dhg),this.cGf.execute(async e=>{await e.isFeatureEnabled(Df.a.Mfj,!1)&&this.OJa.qxb(t=>{t.invokeUserFeedback=E=>this.Ht.invokeUserFeedback(E);t.canGetFocus=!0},!0)}),this.tL&&this.tL.ZPh(this.cfg),this.isInitialized=!0)}Pd(){}Byl(e){this.Fid?(this.Fid=e,this.Zng||(this.Zng=this.aPg.setTimeout(()=>{this.Fid();this.Zng=0},this.Xio))):
(this.Fid=e,this.Fid())}}Object(y.a)(qE,"DesignerPropsUpdater",null,[1206,511]);class qt{constructor(e,t,E){this.JJ=e;this.LRl=t;this.ib=E;this.a9=()=>{this.r8c();this.ib.pdb(this.a9)};if(!e)throw wm.a.argument("AppLifecycleManager is null");if(!E)throw wm.a.argument("Workspace is null");}get $d(){return null!=this.BVg?this.BVg:this.BVg=(()=>this.container.resolve("WordEditor.Designer.IDesignerControl"))()}get name(){return"WordEditor.Designer"}init(){this.container.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>
{this.Mo()})}wc(e){this.container=e;e.ia("WordEditor.Designer.Perf.IPerfLogger",()=>new rr.a(tb.a.Ee)).ha();e.ia("WordEditor.Designer.Persistence.IDesignerTransactionFactory",()=>new vx(e.resolve("Box4.Graph.IGraphTransactionFactory"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();e.ia("WordEditor.Designer.AL.IWorkflowManager",()=>{const ha=new fa.a;ha.add(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").sL);ha.add(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").XOb);
ha.add(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").L8a);ha.add(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Qve);ha.add(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").x0j);ha.add(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").O4);return new Fv(e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),ha)}).ha();e.ia("WordEditor.Designer.Style.IStyleManager",()=>new Nq(e.resolve("WordEditor.Designer.IDesignerControl"),
e.resolve("Box4.Styles.IWACStyleReader"),e.resolve("Box4.Styles.IWACStyleEditor"),e.resolve("WordEditor.Designer.Storage.StyleStorage"),this.$d.AXa()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();e.ia("WordEditor.Designer.Style.IParagraphFormattingSnapshotManager",()=>new kE(Zd.a.createTextRange,e.resolve("Box4.IFormattingReader"),e.resolve("Box4.IFormattingEditor"),e.resolve("Box4.List.IListReader"),e.resolve("Box4.IOutlineElementNavigator"),e.resolve("Box4.TextFormattingHelper"),
e.resolve("Box4.List.ListItemEditor"))).ha();e.ia("WordEditor.Designer.Style.IManualListConverter",()=>new Bx(e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("Box4.List.IListEditor"),e.resolve("Box4.List.IListReader"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("Box4.IParagraphIndentationReader"),$t.a.iWa)).ha();e.ia("WordEditor.Designer.Style.Decorator.DecoratorStorage",()=>new iE).ha();e.ia("WordEditor.Designer.Style.Decorator.DecoratorEditorFactory",
()=>new Js(v.AFrameworkApplication.va,e.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"),e.resolve("Box4.Graph.IGraphIteratorFactory"),e.resolve("Box4.IOutlineElementEditor"),e.resolve("WordEditor.Designer.Style.IParagraphDesigner"),e.resolve("Box4.ISelectionManager"),e.resolve("WordEditor.Extension.TableOperations"),e.resolve("WordEditor.Designer.Image.DesignerImageManager"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),
this.ib.sc,e.resolve("Box4.ITableEditor"),e.resolve("Box4.ICharacterPropertiesEditor"),wu.StaticTheCoauthManager.ud(),e.resolve("Box4.IFormattingEditor"),e.resolve("Box4.IParagraphIteratorFactory"),new Ue.a(()=>Cc.StaticActiveAppFrame.za().ib.sc.jd),this.H3j(),e.resolve("WordEditor.Designer.Persistence.PersistenceHelper"),e.resolve("WordEditor.Designer.Style.ApplyThemeDialogManager"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.Designer.Style.IParagraphFormattingSnapshotManager"),
e.resolve("Box4.Styles.IWACStyleReader"),Object(ki.a)(),this.$d.AXa()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();e.ia("WordEditor.Designer.Style.Decorator.DecoratorManager",()=>new zG(e.resolve("WordEditor.Designer.Style.Decorator.DecoratorEditorFactory"),e.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"),e.resolve("Box4.IUndoManager"),e.resolve("Box4.Graph.IGraphIteratorFactory"),this.$d.AXa()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):
null,e.resolve("WordEditor.Designer.Persistence.PersistenceHelper"),e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),new Ue.a(()=>Cc.StaticActiveAppFrame.za().ib.sc.jd))).ha();e.ia("WordEditor.Designer.Style.IParagraphDesigner",()=>new QA(e.resolve("WordEditor.Designer.IDesignerControl"),Zd.a.createTextRange,e.resolve("Box4.IFormattingReader"),e.resolve("Box4.IFormattingEditor"),e.resolve("Box4.IParagraphEditor"),e.resolve("WordEditor.Designer.Style.IParagraphFormattingSnapshotManager"),
e.resolve("Box4.Styles.IWACStyleEditor"),e.resolve("Box4.TextFormattingHelper"),e.resolve("Box4.List.IListReader"),e.resolve("WordEditor.Designer.Style.IManualListConverter"),e.resolve("Box4.Styles.IWACStyleReader"),e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("Box4.AugmentationLoop.IFormattingExtractor"),this.$d.AXa()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();e.ia("WordEditor.Designer.Style.IUnknownRoleProcessorFactory",()=>new FG(e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),
e.resolve("Box4.IFormattingReader"),e.resolve("WordEditor.Designer.Style.IParagraphDesigner"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.Designer.Review.IRestoreManager"))).ha();e.ia("WordEditor.Designer.Style.IBlankDocumentEditor",()=>new Dy(e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("WordEditor.ContentControl.IContentControlManager"),e.resolve("Box4.IFormattingEditor"),e.resolve("Box4.Graph.IGraphIteratorFactory"),e.resolve("Box4.IHyperlinkEditor"),e.resolve("Box4.IOutlineElementEditor"),
e.resolve("WordEditor.Designer.Style.IParagraphDesigner"),e.resolve("Box4.IParagraphReader"),e.resolve("Box4.TextFormattingHelper"),this.ib.sc)).ha();e.ia("WordEditor.Designer.Style.ITableDesigner",()=>new Cx(e.resolve("WordEditor.IWACTableStyleReader"),Es.a.instance)).ha();e.ia("WordEditor.Designer.Style.ITableManager",()=>new nE(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").dhp,e.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"))).ha();e.ia("WordEditor.Designer.Style.IThemeManager",
()=>new EG(e.resolve("WordEditor.Designer.Style.IBlankDocumentEditor"),e.resolve("WordEditor.Designer.Style.Decorator.DecoratorManager"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.Designer.Perf.IPerfLogger"),e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),e.resolve("WordEditor.IFlatListEditor"),e.resolve("WordEditor.Designer.Style.IParagraphDesigner"),e.resolve("Box4.IParagraphIteratorFactory"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Designer.Review.IReviewManager"),
e.resolve("WordEditor.Designer.Style.IStyleManager"),e.resolve("WordEditor.Designer.Style.IUnknownRoleProcessorFactory"),this.ib.sc,e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("WordEditor.Designer.Style.ApplyThemeDialogManager"),e.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"),e.resolve("WordEditor.Designer.Style.ITableManager"),e.resolve("WordEditor.Designer.Style.ITableDesigner"),
e.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.$d.AXa()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();e.ia("WordEditor.Designer.Image.DesignerImageManagerImpl",()=>new Ii(e.resolve("Box4.IOutlineElementEditor"),e.resolve("Box4.Graph.IGraphIteratorFactory"),e.resolve("Box4.ISelectionManager"),e.resolve("Box4.Images.IImageEditor"),e.resolve("WordEditor.IImageEditor"),e.resolve("Box4.Styles.IWACStyleReader"),e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),
this.ib.sc,this.H3j())).as("WordEditor.Designer.Image.DesignerImageManager").ha();e.ia("WordEditor.Designer.Image.DesignerTextToImageManagerImpl",()=>new ur(e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").G1b,this.ib.sc,e.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Designer.Image.DesignerTextToImageManager").ha();e.ia("WordEditor.Designer.Style.IDocumentLanguageManager",()=>new Iu(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").sL)).ha();
e.ia("WordEditor.Designer.Style.IRevertManager",()=>new DG(e.resolve("Box4.Graph.IGraphTransactionFactory"),e.resolve("Box4.IUndoManager"),this.ib.Vu)).ha();e.ia("WordEditor.Designer.Style.ApplyThemeDialogManager",()=>new wG(e.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"))).ha();this.gto();this.kvo();this.Rvo();this.ato();e.ia("WordEditor.Designer.FRE.IFirstRunExperienceManager",()=>new Wm(e.resolve("WordEditor.Designer.IDesignerTaskPane"),e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),
e.resolve("WordEditor.Designer.Pane.IPaneLoadingManager"),e.resolve("WordEditor.Designer.Errors.IErrorStateManager"),e.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),e.Qa("Common.ISystemInitiatedFeedback"))).ha();e.ia("WordEditor.Designer.Style.IThemeCategorizer",()=>new hh(e.resolve("WordEditor.Designer.Style.IThemeGenerator"),e.resolve("WordEditor.Designer.Perf.IPerfLogger"))).ha();e.ia("WordEditor.Designer.Style.CurrentThemeProvider",()=>new Zm(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").x0j)).ha();
e.ia("WordEditor.Designer.Style.AugLoopThemeProvider",()=>new Gu(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").O4,this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),e.resolve("WordEditor.Designer.Style.Decorator.DecoratorManager"),e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),e.resolve("WordEditor.Designer.IDesignerControl"))).ha();this.$d.ptb()&&e.ia("WordEditor.Designer.Style.OfficeTemplatesThemeProvider",()=>new Rr(e.resolve("Box4.OfficeTemplates.OfficeTemplatesDiscoveryService"))).ha();
const t=new Ue.a(()=>{const ha=[];ha.push(e.resolve("WordEditor.Designer.Style.CurrentThemeProvider"));ha.push(e.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"));this.$d.ptb()&&ha.push(e.resolve("WordEditor.Designer.Style.OfficeTemplatesThemeProvider"));return ha});e.ia("WordEditor.Designer.Style.IThemeGenerator",()=>new cv(t.value,e.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))).ha();e.ia("WordEditor.Designer.Trackers.IDesignerUndoTracker",
()=>new ms(e.resolve("Box4.IUndoManager"))).ha();e.ia("WordEditor.Designer.Wire.IDesignerPropsActions",()=>new Hz(v.AFrameworkApplication.va,e.resolve("WordEditor.Designer.Review.IReviewManager"),e.resolve("WordEditor.Designer.Trackers.IDesignerUndoTracker"),e.Qa("Common.ISystemInitiatedFeedback"),Bi.a.Q2c(),e.resolve("Box4.ICssColorProvider"))).ha();e.ia("WordEditor.Designer.Wire.IDesignerPropsFactory",()=>new bt(e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.Designer.Wire.IDesignerPropsActions"),
e.resolve("WordEditor.Designer.Errors.IErrorStateManager"),e.resolve("WordEditor.Designer.Pane.IPaneLoadingManager"),e.resolve("WordEditor.Designer.Style.IThemeGenerator"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("Box4.IDarkModeState"),this.$d.AXa()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();e.ia("WordEditor.Designer.BrowserApis.IWindowTimeout",()=>new Ft).ha();e.ia("WordEditor.Designer.Wire.IDesignerPropsUpdater",()=>
new qE(e.resolve("WordEditor.Designer.Wire.IDesignerPropsManager"),e.resolve("WordEditor.Designer.Errors.IErrorStateManager"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),e.resolve("WordEditor.Designer.Style.IThemeGenerator"),e.resolve("WordEditor.Designer.BrowserApis.IWindowTimeout"),e.resolve("WordEditor.Designer.Wire.IDesignerPropsActions"),e.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.$d.hHm(),e.resolve("Box4.DarkModeEventsManager"),this.$d.AXa()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();e.ia("WordEditor.Designer.Wire.IDesignerPropsManager",()=>new GG(e.resolve("WordEditor.Designer.Wire.IDesignerPropsFactory"))).ha();e.ia("WordEditor.Designer.Logging.IBlankDocumentLogger",()=>new wy(e.resolve("Box4.IParagraphReader"),this.ib.sc)).ha();e.ia("WordEditor.Designer.Logging.IConsistencyFixActionsLogger",()=>new aj(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").XOb,
e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").L8a,e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"))).ha();e.ia("WordEditor.Designer.Logging.IDocumentRoleDetectionLogger",()=>new hm(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").sL)).ha();e.ia("WordEditor.Designer.Logging.IProactiveSurveyEventLogger",()=>new Vl(e.Qa("Common.ISystemInitiatedFeedback"),e.resolve("WordEditor.Designer.BrowserApis.IWindowTimeout"),e.resolve("WordEditor.Designer.IDesignerControl"))).ha();
e.ia("WordEditor.Designer.IDesignerTaskPane",()=>new Cw(Cc.StaticActiveAppFrame.za(),e.resolve("WordEditor.Designer.Wire.IDesignerPropsManager"),e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),e.resolve("WordEditor.Designer.Errors.IErrorStateManager"),Ni.FocusManager.instance(),eh.a.instance,Ya.UISurfaces.Hv,e.resolve("WordEditor.Designer.Logging.IConsistencyFixActionsLogger"),e.resolve("WordEditor.Designer.License.ILicenseManager"),e.resolve("WordEditor.Designer.Logging.IProactiveSurveyEventLogger"))).ha();
const E=new Ue.a(()=>new Ym);e.ia("WordEditor.Designer.IDesignerTaskPaneEvents",()=>E.value).ha();e.ia("WordEditor.Designer.IDesignerTaskPaneEventsInternal",()=>E.value).ha();e.ia("WordEditor.Designer.License.ILicenseManager",()=>new tq(e.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();e.ia("WordEditor.Designer.Storage.IParagraphFormattingStorage",()=>new PA).ha();e.ia("WordEditor.Designer.Storage.StyleStorage",()=>new Dz).ha();e.ia("WordEditor.Designer.Review.IReviewTraverser",
()=>new tG(e.resolve("Box4.Intent.IIntentRangeEditor"),e.resolve("Box4.IParagraphReader"),e.resolve("Box4.IParagraphIteratorFactory"),this.ib.sc)).ha();e.ia("WordEditor.Designer.Review.IRestoreManager",()=>new Cy(e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("WordEditor.IFlatListEditor"),e.resolve("Box4.IFormattingEditor"),e.resolve("Box4.IParagraphEditor"),e.resolve("WordEditor.Designer.Storage.IParagraphFormattingStorage"),e.resolve("Box4.TextFormattingHelper"),Zd.a.createTextRange,e.resolve("WordEditor.Designer.Storage.StyleStorage"),
e.resolve("Box4.Styles.IWACStyleReader"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("Box4.List.IListReader"))).ha();this.container.ia("WordEditor.Designer.Style.PullQuotesDesigner",()=>new ls(e.resolve("WordEditor.IImageEditor"),e.resolve("Box4.CatchUpActivity.IChangeIdEditor"),e.resolve("Box4.IUndoManager"),v.AFrameworkApplication.K,e.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),e.resolve("Box4.Images.IImageReader"),e.resolve("Box4.ISelectionManager"),e.resolve("Box4.IFeatureHelper"),
e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("Box4.TextFormattingHelper"),e.resolve("Box4.IFormattingEditor"),e.resolve("WordEditor.ClientPagination.IClientPaginationUlsLogger"),e.resolve("Box4.IOutlineElementEditor"),Cc.StaticActiveAppFrame.za().ib.sc,v.AFrameworkApplication.ua.KWa,e.resolve("Box4.IBlobReader"),e.resolve("Box4.Styles.IWACStyleReader"))).ha();this.container.ia("WordEditor.Designer.Style.PullQuotesManager",()=>new TA(e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),
e.resolve("WordEditor.Designer.Style.PullQuotesDesigner"),e.resolve("WordEditor.Designer.Review.IReviewManager"),Cc.StaticActiveAppFrame.za().ib.sc)).ha();this.container.ia("WordEditor.Designer.Persistence.PersistenceHelper",()=>new Eo.a(new Ue.a(()=>Cc.StaticActiveAppFrame.za().ib.$c.td),e.resolve("Box4.IIntelligenceReader"),e.resolve("Box4.IIntelligenceEditor"),e.resolve("Box4.PersistenceSettingsManager"))).ha();e.ia("WordEditor.Designer.Review.IReviewManager",()=>new fE(v.AFrameworkApplication.va,
e.resolve("WordEditor.Designer.Perf.IPerfLogger"),e.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),e.resolve("Box4.Intent.IIntentRangeEditor"),ma.a,e.resolve("WordEditor.Designer.Style.IParagraphDesigner"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Designer.Review.IRestoreManager"),new lE,e.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),e.resolve("WordEditor.Designer.Review.IReviewTraverser"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),
e.resolve("WordEditor.Designer.Style.PullQuotesDesigner"),e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),e.resolve("WordEditor.Designer.Persistence.PersistenceHelper"),e.resolve("WordEditor.Designer.Image.DesignerImageManager"),e.resolve("WordEditor.Designer.SuggestionLifecycle.EnhancementSuggestionLifecycleManager"),e.resolve("WordEditor.Designer.SuggestionLifecycle.ConsistencySuggestionLifecycleManager"),e.Qa("Common.ISystemInitiatedFeedback"),e.resolve("WordEditor.Designer.IDesignerControl"),
e.Qa("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler"),e.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),e.resolve("Box4.IParagraphIteratorFactory"),e.resolve("Box4.List.IListReader"),this.ib.sc)).ha();e.ia("WordEditor.Designer.Review.IReviewActions",()=>new Iv(e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),e.resolve("WordEditor.Designer.Review.IReviewManager"),this.ib.Vu)).ha();e.ia("WordEditor.Designer.OnCanvas.ReviewSelectionManager",
()=>new wo(e.resolve("WordEditor.Designer.OnCanvas.IBlueDotActor"),e.resolve("Box4.ISelectionManager"),e.resolve("WordEditor.Designer.Review.IReviewTraverser"))).ha();e.ia("WordEditor.Designer.OnCanvas.HighlightActor",()=>new ko(e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("Box4.Intent.IIntentRangeEditor"),rb.a.pg,rb.a.Nx)).ha();e.ia("WordEditor.Designer.OnCanvas.IBlueDotActor",()=>new fl.a(e.resolve("Box4.Graph.IGraphIteratorFactory"),e.resolve("Box4.Highlight.IHighlightManager"),
Object(ib.a)(Ll.a.instance,Ll.a.instance.rK,"registerHandlerWithData"),Object(ib.a)(Ir.a.instance,Ir.a.instance.nb,"registerHandler"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),e.resolve("WordEditor.Designer.Review.IReviewTraverser"),this.ib.Vu)).ha();e.ia("WordEditor.Designer.Storage.IParagraphFormattingSnapshotReader",()=>new tC(e.resolve("Box4.Styles.IWACStyleReader"))).ha();e.ia("WordEditor.Designer.OnCanvas.ITriageOptionFactory",()=>new wr(e.resolve("WordEditor.Designer.Storage.IParagraphFormattingSnapshotReader"),
e.resolve("WordEditor.Designer.Storage.IParagraphFormattingStorage"),e.resolve("Box4.Styles.IWACStyleReader"),e.resolve("WordEditor.Designer.IDesignerControl"))).ha();e.ia("WordEditor.Designer.OnCanvas.ITriageOptionProvider",()=>new Pr(e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("WordEditor.Designer.OnCanvas.ITriageOptionFactory"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.Designer.Review.IReviewTraverser"))).ha();e.ia("WordEditor.Designer.Style.IDocumentConsistencyManager",
()=>new hn(e.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").L8a,e.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),e.resolve("WordEditor.Designer.Style.IParagraphDesigner"),e.resolve("WordEditor.Designer.Review.IReviewManager"),this.ib.sc,e.resolve("Box4.IParagraphReader"),e.Qa("Common.ISystemInitiatedFeedback"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),e.resolve("Box4.Styles.IWACStyleReader"),
e.resolve("Box4.IFormattingReader"))).ha();const W=new Ue.a(()=>new sx);e.ia("WordEditor.Designer.ContextualSuggestions.Conditions.HeadingsImageCondition",()=>W.value).ha();e.ia("Box4.OfficeTemplates.ApplyTemplatesProxy",()=>new xu(v.AFrameworkApplication.Be));e.ia("WordEditor.Designer.Style.ITemplateAppliedListener",()=>new Au(e.resolve("Box4.IUndoManager")));e.ia("WordEditor.Designer.Actors.DesignerActionActor",()=>new Cn(v.AFrameworkApplication.va,wu.StaticTheCoauthManager.ud(),e.resolve("WordEditor.Designer.Logging.IConsistencyFixActionsLogger"),
e.resolve("WordEditor.Designer.Logging.IProactiveSurveyEventLogger"),e.resolve("WordEditor.Designer.Style.IDocumentConsistencyManager"),e.resolve("WordEditor.Designer.Errors.IErrorStateManager"),e.resolve("WordEditor.Designer.Style.IRevertManager"),e.resolve("WordEditor.Designer.Review.IReviewActions"),e.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),e.resolve("WordEditor.Designer.Review.IReviewManager"),e.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),v.AFrameworkApplication.mc,
e.resolve("WordEditor.Designer.Style.IThemeGenerator"),e.resolve("WordEditor.Designer.Style.IThemeManager"),e.resolve("WordEditor.Designer.Style.IThemeCategorizer"),e.resolve("WordEditor.Designer.IDesignerControl"),e.resolve("WordEditor.Designer.IDesignerTaskPane"),e.resolve("WordEditor.Designer.ContextualSuggestions.Conditions.HeadingsImageCondition"),e.resolve("WordEditor.Designer.Style.ApplyThemeDialogManager"),this.$d.AXa()?e.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):
null,e.resolve("Box4.OfficeTemplates.ApplyTemplatesProxy"),e.resolve("WordEditor.Designer.Style.ITemplateAppliedListener"),this.ib.$c,this.container.resolve("Box4.IUndoManager"))).ha();e.ia("WordEditor.Designer.Actors.DesignerActor",()=>new Do(v.AFrameworkApplication.va,e.resolve("WordEditor.Designer.IDesignerTaskPane"),e.resolve("WordEditor.Designer.License.ILicenseManager"),appChrome.api,appChrome.actions,e.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),Cc.StaticActiveAppFrame.za(),
e.resolve("WordEditor.Designer.IDesignerControl"))).ha();e.ia("WordEditor.Designer.SuggestionLifecycle.EnhancementSuggestionLifecycleManager",()=>new wC(e.resolve("Box4.Graph.IGraphInstance"))).ha();e.ia("WordEditor.Designer.SuggestionLifecycle.ConsistencySuggestionLifecycleManager",()=>new vC(e.resolve("Box4.Graph.IGraphInstance"))).ha();e.ia("WordEditor.AiMaker.DocumentWizard.AiMakerEngagement",()=>new Cv(e.Qa("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentContentGenerator"))).ha();e.ia("WordEditor.Designer.DocumentTypeEventSource",
()=>new qm).ha();this.$d.bee()&&e.ia("WordEditor.Designer.DocumentStatsDnmLogger",()=>new Ds(e.resolve("Box4.Graph.IGraphIteratorFactory"),e.resolve("WordEditor.IPageNumberFinder"),e.resolve("WordEditor.Designer.DocumentTypeEventSource"))).ha();this.$d.Wyb()&&e.ia("WordEditor.Designer.Actors.DesignerPasteActor",()=>new zu(v.AFrameworkApplication.va,e.resolve("WordEditor.Designer.SmartPaste.SmartPasteManager"),e.resolve("Box4.IPasteFloatieEventSource"))).ha();this.$d.Wyb()?this.Xvo():this.$d.Sde()&&
this.Mso();this.$d.ECg()&&this.Frg();this.$d.$ee()&&this.xuo();this.$d.i1i()&&this.svo();this.$d.wXi()&&this.ouo();this.$d.uYf()&&this.auo();this.$d.q1i()&&this.vvo();this.$d.R1f()&&this.qwo()}dispose(){}ato(){this.$d.AXa()&&(this.container.ia("WordEditor.Designer.DocumentState.DocumentStateMachine",()=>new Fd).ha(),this.container.ia("WordEditor.Designer.DocumentState.IDocumentStateMonitor",()=>new tf(this.container.resolve("Box4.IParagraphReader"),this.ib.sc,this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.container.resolve("Box4.IUndoManager"),this.container.resolve("WordEditor.Designer.DocumentState.DocumentStateMachine"),this.container.resolve("WordEditor.Designer.IDesignerControl"))).ha())}kvo(){const e=new Ue.a(()=>new sz(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").XOb)),t=new Ue.a(()=>new ux(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").sL)),E=new Ue.a(()=>new tz(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").O4)),
W=new Ue.a(()=>{const ha=new fa.a;ha.add(e.value);ha.add(t.value);ha.add(E.value);return ha});this.container.ia("WordEditor.Designer.Pane.PaneLoadingManager",()=>new vq(this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),W.value)).as("WordEditor.Designer.Pane.IPaneLoadingManager").ha()}Rvo(){this.container.register(Lv,"WordEditor.Designer.WordDesignerSettingsHandler").as("WordEditor.Designer.IWordDesignerSettingsHandler").ha().Rd(()=>new Lv(this.container.resolve("Box4.IRoamingServiceRequestManager"),
this.container.resolve("Box4.RoamingSetting.IRoamingSettingCache"),this.container.resolve("Common.IAppSettingsManager"),new ua.a,this.container.resolve("Common.IUlsWrapper")));this.container.ia("WordEditor.Designer.Settings.DesignerSettingsManager",()=>new uG(this.container.resolve("WordEditor.Designer.WordDesignerSettingsHandler"),this.container.resolve("WordEditor.Designer.IDesignerControl"))).as("WordEditor.Designer.Settings.IDesignerSettingsManager").ha()}gto(){const e=new Ue.a(()=>new lj(wu.StaticTheCoauthManager.ud(),
this.$d.Ugc())),t=new Ue.a(()=>new In(this.container.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.container.resolve("Box4.TrackChange.ITrackChangeEventsActor"))),E=new Ue.a(()=>new Uf(this.container.resolve("WordEditor.Designer.Style.IDocumentLanguageManager"))),W=new Ue.a(()=>new Tf(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").XOb)),ha=new Ue.a(()=>new zi(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").sL,
this.container.resolve("Box4.IParagraphReader"),this.ib.sc)),Ka=new Ue.a(()=>{const sb=new fa.a;this.$d.Ugc()&&sb.add(e.value);this.$d.Ygn()&&sb.add(t.value);sb.add(W.value);sb.add(E.value);this.$d.jmn()&&sb.add(ha.value);return sb});this.container.ia("WordEditor.Designer.Errors.IErrorStateManager",()=>new Gm(Ka.value)).ha()}Xvo(){this.container.ia("WordEditor.Designer.SmartPaste.SmartPasteManager",()=>new Mv(this.container.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("Box4.UI.PasteFloatieManager"),
this.container.Qa("Box4.Actors.ClipboardActor"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").L8a,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").XOb,this.container.resolve("Box4.IUndoManager"),S.App.jf.Il,this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.Qa("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.Style.IDocumentConsistencyManager"))).ha()}Mso(){this.container.ia("WordEditor.Designer.ContextualSuggestions.ContextualSuggestionsContext",
()=>new Qc(this.container.resolve("Box4.List.IListReader"))).ha();this.container.ia("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsProvider",()=>new ac(this.container.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("WordEditor.Designer.Style.IDocumentConsistencyManager"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").L8a,this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.resolve("WordEditor.Designer.ContextualSuggestions.ContextualSuggestionsContext"))).ha();
const e=new Ue.a(()=>new mp(6,wu.StaticTheCoauthManager.ud(),this.$d.Ugc())),t=new Ue.a(()=>new tr(S.App.jf.Il,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ContextualSuggestionsContext"))),E=new Ue.a(()=>new zx(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),W=new Ue.a(()=>{const ud=new fa.a;ud.add(t.value);ud.add(E.value);ud.add(e.value);return ud}),ha=new Ue.a(()=>new qC(this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerEngagement"))),
Ka=new Ue.a(()=>new Jt(6,W.value,Object(Jq.c)()?ha.value:null)),sb=new Ue.a(()=>{const ud=[];ud.push(Ka.value);return ud}),dc=new Ue.a(()=>new Et(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),xc=new Ue.a(()=>{const ud=new fa.a;ud.add(dc.value);ud.add(E.value);return ud}),Rc=new Ue.a(()=>new Jt(6,xc.value,Object(Jq.c)()?ha.value:null)),md=new Ue.a(()=>{const ud=[];ud.push(Rc.value);return ud});this.container.ia("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsTriggerManager",
()=>new qc(sb.value,md.value,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsProvider"),!this.$d.u0f())).ha()}svo(){this.container.ia("WordEditor.Designer.ProactiveV2.ProactiveSuggestionsChecker",()=>new sC(this.container.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").XOb,v.AFrameworkApplication.va,this.container.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"),
this.container.resolve("WordEditor.Designer.Errors.IErrorStateManager"),this.container.resolve("WordEditor.Designer.FRE.IFirstRunExperienceManager")));const e=new Ue.a(()=>new bE(11)),t=new Ue.a(()=>new zz(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),11)),E=new Ue.a(()=>new Et(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"),this.$d.cgo(),!1)),W=new Ue.a(()=>{const sb=new fa.a;sb.add(e.value);
sb.add(t.value);sb.add(E.value);return sb}),ha=new Ue.a(()=>new nt.a(11,W.value,null,3016,Df.a.ggo)),Ka=new Ue.a(()=>{const sb=[];sb.push(ha.value);return sb});this.container.ia("WordEditor.Designer.ProactiveV2.ProactiveTriggerManagerV2",()=>new Zs(Ka.value,this.container.resolve("WordEditor.Designer.ProactiveV2.ProactiveSuggestionsChecker"),this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),v.AFrameworkApplication.va,this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))).ha()}xuo(){const e=
new Ue.a(()=>new Hs(this.JJ)),t=new Ue.a(()=>new vz),E=new Ue.a(()=>new wz(15,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").O4,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),W=new Ue.a(()=>new Jr.a(15,this.container.resolve("Box4.IParagraphReader"),this.ib.sc,{h_b:!0,MR:!1,Qmc:!0,Pmc:!0,LR:!0})),ha=new Ue.a(()=>{const xc=new fa.a;xc.add(e.value);xc.add(t.value);xc.add(E.value);xc.add(W.value);return xc}),Ka=new Ue.a(()=>new aE(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),
this.container.resolve("WordEditor.Designer.Errors.IErrorStateManager"),this.$d.$ee())),sb=new Ue.a(()=>new Jt(15,ha.value,Ka.value,null,new Mq("Jump-start templates loaded",Df.a.A_d,Jr.a.Ykf))),dc=new Ue.a(()=>{const xc=new fa.a;xc.add(sb.value);return xc});this.container.ia("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManagerCommercial",()=>new xz(dc.value,Ka.value,null)).ha()}qwo(){const e=new Ue.a(()=>new Hs(this.JJ)),t=new Ue.a(()=>new rx(hl.Ufi,"false","false")),E=new Ue.a(()=>
new Jr.a(2,this.container.resolve("Box4.IParagraphReader"),this.ib.sc,{h_b:!0,MR:!1,Qmc:!0,Pmc:!0,LR:!0})),W=new Ue.a(()=>new vz),ha=new Ue.a(()=>{const sb=new fa.a;sb.add(e.value);sb.add(t.value);sb.add(E.value);sb.add(W.value);return sb}),Ka=new Ue.a(()=>new nt.a(2,ha.value,null,3016,Df.a.A_d));this.container.ia("WordEditor.Designer.UserIntentDialog.UserIntentDialog",()=>new hl(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),this.container.resolve("WordEditor.Designer.Wire.IDesignerPropsActions"))).ha();
this.container.ia("WordEditor.Designer.UserIntentDialog.UserIntentDialogTriggerManager",()=>new pE([Ka.value],this.container.resolve("WordEditor.Designer.UserIntentDialog.UserIntentDialog"))).ha()}Frg(){const e=new Ue.a(()=>new mp(1,wu.StaticTheCoauthManager.ud(),this.$d.Ugc())),t=new Ue.a(()=>new px(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").sL,Df.a.rZj)),E=[Op.DocumentTypeLabel.ManualsAndGuidelines,Op.DocumentTypeLabel.ContractsAndPolicies,Op.DocumentTypeLabel.ArticlesAndReports,
Op.DocumentTypeLabel.JobDescription],W=new Ue.a(()=>new Xn(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Naa,this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),Df.a.y3m,E)),ha=new Ue.a(()=>new ww(1,this.container.resolve("WordEditor.SignalAggregator.SignalAggregator"),Df.a.s9f)),Ka=new Ue.a(()=>new im(1,this.container.resolve("WordEditor.SignalAggregator.SignalAggregator"),Df.a.JFf,Df.a.Jdd)),sb=new Ue.a(()=>new Kg(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").XOb,
Df.a.r9f)),dc=new Ue.a(()=>new wz(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").O4,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),xc=new Ue.a(()=>new Jr.a(2,this.container.resolve("Box4.IParagraphReader"),this.ib.sc,{h_b:!0,MR:!1,Qmc:!0,Pmc:!0,LR:!0})),Rc=new Ue.a(()=>new Et(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),md=new Ue.a(()=>new NA(10,v.AFrameworkApplication.va,
this.container.resolve("WordEditor.Designer.IDesignerControl"))),ud=new Ue.a(()=>new Xn(10,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Naa,this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),Df.a.gzf,[Op.DocumentTypeLabel.Letters])),Ud=new Ue.a(()=>new wz(10,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").O4,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),Id=new Ue.a(()=>new Hs(this.JJ)),
Ee=new Ue.a(()=>new vz),kf=new Ue.a(()=>new zx(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),Ke=new Ue.a(()=>new Em(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),2,!1)),dh=new Ue.a(()=>new xx(this.$d.Oad())),$h=new Ue.a(()=>new wz(13,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").O4,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),rj=new Ue.a(()=>new Jr.a(13,this.container.resolve("Box4.IParagraphReader"),
this.ib.sc,{h_b:!0,MR:!1,Qmc:!0,Pmc:!0,LR:!0})),zl=new Ue.a(()=>{const yj=new fa.a;yj.add(ha.value);yj.add(e.value);yj.add(Ka.value);this.$d.yhn()&&yj.add(W.value);yj.add(t.value);yj.add(sb.value);yj.add(dc.value);return yj}),Wl=new Ue.a(()=>{const yj=new fa.a;yj.add(ud.value);1===this.$d.y0d()?yj.add(Rc.value):yj.add(md.value);yj.add(Ud.value);return yj}),Rh=new Ue.a(()=>{const yj=new fa.a;yj.add(Id.value);yj.add(Ee.value);this.$d.l1f()&&(yj.add(kf.value),yj.add(Ke.value));yj.add(dh.value);yj.add($h.value);
yj.add(rj.value);return yj}),Mg=new Ue.a(()=>new aE(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),this.container.resolve("WordEditor.Designer.Errors.IErrorStateManager"),this.$d.h1i())),Xl=new Ue.a(()=>new zy(this.container.resolve("WordEditor.Designer.Persistence.PersistenceHelper"))),ql=new Ue.a(()=>new Jt(1,zl.value,Mg.value)),Al=new Ue.a(()=>{let yj;return new Jt(2,(yj=new fa.a,yj.add(xc.value),yj),Mg.value)}),Hk=new Ue.a(()=>new Jt(10,Wl.value,Mg.value,Xl.value)),Dj=new Ue.a(()=>
new Jt(13,Rh.value,Mg.value,null,new Mq("Jump-start proactive Designer Pane opening",Df.a.A_d,Jr.a.Ykf))),ao=new Ue.a(()=>{const yj=new fa.a;(this.$d.y0d()||this.$d.bee())&&yj.add(Hk.value);this.$d.oZf()&&yj.add(ql.value);this.$d.ZVi()&&yj.add(Al.value);this.$d.afe()&&yj.add(Dj.value);return yj});this.container.ia("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManager",()=>{let yj=new xy(v.AFrameworkApplication.va,this.container.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"));
this.$d.afe()&&this.$d.s2f()&&(yj=new wx(this.container.Qa("Common.ISystemInitiatedFeedback"),Df.a.kvn,new yy(Df.a.lvn,yj,13)));return new xz(ao.value,Mg.value,yj)}).ha();this.container.ia("WordEditor.Designer.Proactive.IUserEngagementMonitor",()=>new yz(v.AFrameworkApplication.va,this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"))).ha()}auo(){const e=new jb,t=new Ue.a(()=>new Bw(this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),this.container.resolve("WordEditor.Designer.Image.DesignerImageManager"),
e)),E=new Ue.a(()=>new Ba(this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),e,this.container.Qa("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.IDesignerControl"))),W=new Ue.a(()=>{const sb=new fa.a;sb.add(this.container.resolve("WordEditor.Designer.ContextualSuggestions.Conditions.HeadingsImageCondition"));sb.add(t.value);sb.add(E.value);return sb}),ha=new Ue.a(()=>new nt.a(14,W.value,null,3016,Df.a.P_m)),Ka=new Ue.a(()=>{const sb=new fa.a;
sb.push(ha.value);return sb});this.container.ia("WordEditor.Designer.ContextualSuggestions.HeadingsImageSuggestionTriggerManager",()=>new bc(Ka.value,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler"),e)).ha()}ouo(){const e=new jb,t=new Ue.a(()=>new Et(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),E=new Ue.a(()=>new Zu(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.container.resolve("WordEditor.Designer.Review.IReviewTraverser"),e,this.ib.sc)),W=new Ue.a(()=>new mp(8,wu.StaticTheCoauthManager.ud(),this.$d.Ugc())),ha=new Ue.a(()=>new Gv(this.container.resolve("WordEditor.Designer.Image.DesignerImageManager"),this.ib.sc)),Ka=new Ue.a(()=>new Nr(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Qve,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").sL,this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),
e)),sb=[Op.DocumentTypeLabel.ManualsAndGuidelines,Op.DocumentTypeLabel.ArticlesAndReports,Op.DocumentTypeLabel.DocumentsDesignedForPrinting,Op.DocumentTypeLabel.Forms,Op.DocumentTypeLabel.ListsAndNotes,Op.DocumentTypeLabel.Plans],dc=new Ue.a(()=>new Xn(8,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Naa,this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),Df.a.gzf,sb)),xc=new Ue.a(()=>new Ba(this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),
e,this.container.Qa("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.IDesignerControl"))),Rc=new Ue.a(()=>new zx(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),md=new Ue.a(()=>{const Ee=new fa.a;Ee.add(t.value);Ee.add(E.value);Ee.add(Rc.value);Ee.add(W.value);Ee.add(ha.value);Ee.add(Ka.value);Ee.add(xc.value);this.$d.esn()&&Ee.add(dc.value);return Ee}),ud=new Ue.a(()=>new Ta(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),
this.container.resolve("WordEditor.Designer.Image.DesignerImageManagerImpl"),this.ib.sc,this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerEngagement"))),Ud=new Ue.a(()=>new ik(8,md.value,ud.value,Df.a.wbk)),Id=new Ue.a(()=>{const Ee=new fa.a;Ee.add(Ud.value);return Ee});this.container.ia("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler",()=>new pa(this.container.resolve("WordEditor.Designer.Image.DesignerImageManager"),this.container.resolve("WordEditor.Designer.Review.IReviewManager"),
this.container.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).ha();this.container.ia("WordEditor.Designer.ContextualSuggestions.ImageSuggestionTriggerManager",()=>new bc(Id.value,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler"),e)).ha()}vvo(){const e=new Ue.a(()=>new Cu(this.container.resolve("WordEditor.Designer.License.ILicenseManager"))),t=new Ue.a(()=>new mp(9,wu.StaticTheCoauthManager.ud(),this.$d.Ugc())),E=new Ue.a(()=>new Et(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.container.resolve("Box4.IUndoManager"))),W=new Ue.a(()=>new Jr.a(9,this.container.resolve("Box4.IParagraphReader"),this.ib.sc,{h_b:!1,MR:!1,Qmc:!0,Pmc:!0,LR:!0})),ha=[Op.DocumentTypeLabel.ManualsAndGuidelines,Op.DocumentTypeLabel.ArticlesAndReports,Op.DocumentTypeLabel.DocumentsDesignedForPrinting,Op.DocumentTypeLabel.Forms,Op.DocumentTypeLabel.JobDescription,Op.DocumentTypeLabel.ListsAndNotes,Op.DocumentTypeLabel.Plans],Ka=new Ue.a(()=>new Xn(9,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Naa,
this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),Df.a.gzf,ha)),sb=new Ue.a(()=>new Da(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").ohc,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").hYb,this.container.resolve("WordEditor.Designer.DocumentInfo"),this.ib.sc,this.container.resolve("Box4.ISelectionManager"),this.container.resolve("Box4.IParagraphIteratorFactory"))),dc=new Ue.a(()=>new zx(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),
xc=new Ue.a(()=>{const Ud=new fa.a;Ud.add(e.value);Ud.add(E.value);Ud.add(t.value);Ud.add(dc.value);Ud.add(W.value);Ud.add(Ka.value);Ud.add(sb.value);return Ud}),Rc=new Ue.a(()=>new Ic(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerEngagement"))),md=new Ue.a(()=>new Jt(9,xc.value,Rc.value)),ud=new Ue.a(()=>{const Ud=[];Ud.push(md.value);return Ud});this.container.ia("WordEditor.Designer.ContextualSuggestions.PullQuotesTriggerManager",
()=>new kd(ud.value,this.container.resolve("WordEditor.Designer.Style.PullQuotesManager"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").hYb,this.container.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),this.container.resolve("WordEditor.Designer.Review.IReviewManager"),this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.Qa("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.IDesignerControl"))).ha()}H3j(){const e=
Cc.StaticActiveAppFrame.za().ib.sc;(null===e||void 0===e?0:e.jr)||z.ULS.sendTraceTag(529268809,3016,10,"AutoScroller not defined");return null===e||void 0===e?void 0:e.jr}Mo(){this.$d.BN()?this.JJ.Lk(16,()=>{this.J7c()}):this.J7c()}J7c(){tn(Df.a.Qsj);this.$d.isEnabled()!==zw.a.Qpc()&&z.ULS.shipAssertTag(541169756,3016,!1,`${this.$d.isEnabled()}, ${zw.a.Qpc()}`);this.$d.isEnabled()&&(this.ib.lCa?this.r8c():this.ib.Eja(this.a9))}ACm(){const e="WordEditor.Designer.License.ILicenseManager WordEditor.Designer.Style.IDocumentLanguageManager WordEditor.Designer.Errors.IErrorStateManager WordEditor.Designer.Pane.IPaneLoadingManager WordEditor.Designer.Settings.IDesignerSettingsManager WordEditor.Designer.AL.IWorkflowManager WordEditor.Designer.OnCanvas.OnCanvasInitializer WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager".split(" ");
this.container.ia("WordEditor.Designer.OnCanvas.OnCanvasInitializer",()=>new Xg(this.container.resolve("Box4.Indicator.IIndicatorManager"),this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.Designer.OnCanvas.HighlightActor"),this.container.resolve("WordEditor.Designer.OnCanvas.IBlueDotActor"),this.container.resolve("WordEditor.Designer.OnCanvas.ReviewSelectionManager"),this.container.Qa("Box4.Accessibility.IAccessibilityContextManager"),this.container.resolve("Box4.IParagraphReader"),
this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();this.$d.Zgn()&&e.push("WordEditor.Designer.FRE.IFirstRunExperienceManager");this.$d.Sde()&&!this.$d.Wyb()&&e.push("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsTriggerManager");this.$d.ECg()&&(e.push("WordEditor.Designer.Proactive.ProactiveTriggerInitializer"),this.container.ia("WordEditor.Designer.Proactive.ProactiveTriggerInitializer",()=>new Ay(this.container.resolve("WordEditor.Designer.Proactive.IUserEngagementMonitor"),
this.container.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"),this.container.resolve("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManager"))).ha());this.$d.$ee()&&e.push("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManagerCommercial");this.$d.i1i()&&e.push("WordEditor.Designer.ProactiveV2.ProactiveTriggerManagerV2");this.$d.wXi()&&e.push("WordEditor.Designer.ContextualSuggestions.ImageSuggestionTriggerManager");this.$d.uYf()&&e.push("WordEditor.Designer.ContextualSuggestions.HeadingsImageSuggestionTriggerManager");
this.$d.q1i()&&e.push("WordEditor.Designer.ContextualSuggestions.PullQuotesTriggerManager");this.$d.Wyb()&&e.push("WordEditor.Designer.SmartPaste.SmartPasteManager");this.$d.R1f()&&e.push("WordEditor.Designer.UserIntentDialog.UserIntentDialogTriggerManager");this.$d.bee()&&e.push("WordEditor.Designer.DocumentStatsDnmLogger");return e}BCm(){const e=["WordEditor.Designer.Wire.IDesignerPropsUpdater","WordEditor.Designer.Trackers.IDesignerUndoTracker","WordEditor.Designer.Logging.IDocumentRoleDetectionLogger",
"WordEditor.Designer.Logging.IConsistencyFixActionsLogger","WordEditor.Designer.Logging.IBlankDocumentLogger"];this.$d.pde()&&e.push("WordEditor.Designer.Style.ITableManager");return e}zCm(){const e=["WordEditor.Designer.Style.IThemeGenerator"];this.$d.ECg()&&(e.push("WordEditor.Designer.Proactive.ProactiveTriggerDeinitializer"),this.container.ia("WordEditor.Designer.Proactive.ProactiveTriggerDeinitializer",()=>new Dw(this.container.resolve("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManager"))).ha());
return e}r8c(){const e=this.container.resolve("WordEditor.Designer.Perf.IPerfLogger");e.Yd(()=>{const t=new Map;t.set(0,this.ACm());t.set(2,this.BCm());t.set(1,this.zCm());t.set(3,[]);const E=[this.container.resolve("WordEditor.Designer.Actors.DesignerActor"),this.container.resolve("WordEditor.Designer.Actors.DesignerActionActor")];this.$d.Wyb()&&E.push(this.container.resolve("WordEditor.Designer.Actors.DesignerPasteActor"));this.LRl.VEl(this.container,t,E,e,this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal")).qlf()},
"WD:II")}}Object(y.a)(qt,"DesignerPackageManager",null,[0,1]);var Ov=d(1051),Hw=d(1935),Pv=d(1024),rE=d(998),tj=d(506),dv=d(10),eu=d(920),HG=d(548);class ev{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh){this.y8e=()=>{setTimeout(()=>{this.xqh&&Object(tj.o)("SelectionPointerUp")},100);return!0};this.dyg=$h=>{$h&&$h.Kb.keyCode===Si.a.Y2b?this.o3a.flag&&(Object(tj.o)("FocusOnInputNotif"),this.o3a.flag=!1):$h&&$h.Kb.keyCode===Si.a.Z4&&Object(tj.o)("FocusOutOfEditor");return!0};this.rcf=
($h,rj)=>{$h=$h.getByTag(rj);const zl=[];for(let Wl=0;Wl<$h.length();Wl++){const Rh=$h._GetItem(Wl);zl.push(Rh.id)}this.ORa.set(rj,zl)};this.I1=t;this.fF=E;this.Jya=md;this.hb=kf;this.Gj=Ke;this.od=W;this.fd=ha;this.Ck=Ka;this.Ge=sb;this.e6=dc;this.tea=xc;this.Co=Rc;this.via=ud;this.c2=[];this.iPc=[];this.kXe=this.M6b=this.Igh=this.wJc=this.Alh=this.ERa=this.xqh=!1;this.o3a={flag:!1};this.eac=[];this.PGh=[];this.ORa=new Map;this.Q6b=new Map;this.P6b=new Map;this.$g=Ud;this.ESa=Id;this.jb=Ee;this.ga=
dh;this.K5c=this.K5c.bind(this);this.Twe=this.Twe.bind(this);this.QLg=this.QLg.bind(this);this.ekm();this.iJm();this.gOo();this._frame=v.AFrameworkApplication.ua;this.Gj.mode=0;this.via.emb(this.Twe);this.hb.Cw(this.K5c);this._frame&&(this._frame.VE.nb(dv.a.oi,this._frame.get_element(),tj.s),this._frame.VE.nb(dv.a.YKb,this._frame.get_element(),this.y8e));Object(tj.k)()&&this.ga.ra(Fa.a.vTi,I.a.frame,this.han.bind(this));v.AFrameworkApplication.igf(this.jNi)}ekm(){Object(tj.o)("GetCAAEPlaceholders",
JSON.stringify({["sessionId"]:v.AFrameworkApplication.userSessionId}))}han(e,t,E){2===E&&Object(tj.o)("InsertSnippetPanel");return 32}iJm(){Object(tj.o)("GetSPOReflowFlag")}Gup(e,t,E){(e=e.getByTag(E).getFirst())&&0<=t?(this.ERa=!0,Object(eu.g)(t,e)):this.ERa=!1}gOo(){Object(tj.o)("DocumentGenLoaded")}jNi(e,t){Object(tj.o)("SendWordErrorDetails",JSON.stringify(t))}Twe(){let e=new Pv.a("CAAEMessage");e.SendTime=Date.now();e=Object(tj.n)(e,JSON.stringify({editHappened:!0}),"EditHappenedInDocument");
window.parent.postMessage(JSON.stringify(e),this.Jya)}tOo(){const e=this.I1.create().body.getHtml();Object(tj.o)("HtmlForDocument",e)}mPo(){const e=this.I1.create().body.text;Object(tj.o)("DocTextForSuggestions",e)}MOo(){const e=this.I1.create(),t=[];if(e.body.paragraphs)for(let E=0;E<e.body.paragraphs.length();E++)e.body.paragraphs._GetItem(E).text&&t.push(e.body.paragraphs._GetItem(E).text);Object(tj.o)("DocTextForRePrompt",JSON.stringify(t))}OOo(){const e=this.I1.create(),t=this.xxa(e),E=[];[...this.Q6b.values()].forEach(W=>
{const ha=t.getByTag(W.tagId),Ka=[];for(let sb=0;sb<ha.length();sb++)Ka.push(ha._GetItem(sb).id);Ka&&Ka.length&&E.push({...W,QUp:Ka})});Object(tj.o)("SendPlaceholderSuggestions",JSON.stringify(E))}K5c(){if(!this.wJc){var e=this.I1.create(),t=new Pv.a("CAAEMessage");t.SendTime=Date.now();var E=e.dKm();if("NoSelection"!==E)if("TextBoxSelection"===E)t.Values.payload="TextBoxSelection",t.Values.Action="UnSuccessfulSelectionV2",window.parent.postMessage(JSON.stringify(t),this.Jya);else{E=e.getSelection();
var W=E.contentControls,ha=this.hb.gb.currentSelection,Ka=ha.length,sb=E.parentTableOrNullObject,dc=this.hb.Og,xc=ha.Xe;if(!(m(ha,E,W.length(),this.o3a,t,this.Jya,void 0,this.M6b)||null!==dc&&Object(eu.a)(dc,xc,W.length(),t,E,this.Jya,this.hb.gb,sb,this.ERa,this.fd,this.o3a,this.M6b)))if(sb=Object(tj.c)(ha),1<Ka&&!this.M6b)t=Object(tj.m)(t,"MultipleContext"),window.parent.postMessage(JSON.stringify(t),this.Jya);else if(Ka)if(dc=this.ERa?!0:""!==E.text&&E.UVf(!0),this.M6b)t=Object(tj.a)(t,ha,sb,dc,
E.text,W,this.o3a),(e=this.Jjh(E,e,ha))&&"UnSuccessfulSelectionV2"!==t.Values.Action&&(t.Values.payload=e.Values.payload,t.Values.Action=e.Values.Action),window.parent.postMessage(JSON.stringify(t),this.Jya);else if(1==Ka){t=Object(tj.e)(t,sb,dc,E.text,W.length(),this.o3a);if(e=this.Jjh(E,e,ha))t.Values.payload=e.Values.payload,t.Values.Action=e.Values.Action;window.parent.postMessage(JSON.stringify(t),this.Jya)}}}}Jjh(e,t,E){const W=new Pv.a("CAAEMessage");if(0===e.text.length&&E.J(0).contextId===
na.a.Xc||1===e.text.length&&("\r"===e.text||"\n"===e.text))return W.Values.Action="EmptySelection",this.o3a.flag=!1,W.Values.payload=this.iih(this.xxa(t)),this.hih(this.xxa(t)),W}Zxk(e){const t=new Pv.a("CAAEMessage");t.Values.Action="EmptySelection";this.o3a.flag=!1;t.Values.payload=this.iih(this.xxa(e));this.hih(this.xxa(e));return t}iih(e){const t=new Set;this.c2.forEach(E=>{let W=e.getByTag(E);for(let ha=0;ha<W.length();ha++){const Ka=W._GetItem(ha);void 0!==Ka.AXj&&""!==Ka.getRange(0).text||
Ka.deleteContentControl(!0)}W=e.getByTag(E);0===W.length()&&t.add(E)});0!==t.size&&(this.c2=this.c2.filter(E=>!t.has(E)));return Array.from(t)}hih(e){const t=new Map;let E=!1;for(const [W,ha]of this.ORa){const Ka=ha.filter(sb=>null!==e.getByIdOrNullObject(sb));ha.length!==Ka.length&&(E=!0);t.set(W,Ka)}E&&(this.ORa=t,Object(tj.v)(t))}rud(e){return e&&e.title&&e.tag?!0:(z.ULS.sendTraceTag(541403280,2250,10,"Malformed CaaeMessagePlaceholder"),!1)}quj(e){const t=new Pv.a("CAAEMessage");t.Values.payload=
e;t.SendTime=Date.now();window.parent.postMessage(JSON.stringify(t),this.Jya)}U9h(e,t,E,W,ha){if(this.rud(t)){var Ka=e.parentTableOrNullObject;const dc=Object(eu.e)(this.hb);var sb=!1;"Image"===E&&(sb=m(this.hb.gb.currentSelection,e,e.contentControls.length(),this.o3a,void 0,void 0,!0,this.M6b));if(!sb&&Ka&&"Table"===E&&dc)return E=Ka.getCell(0,0).body.getRange(2).insertContentControl(),E.text=" ",E.UR="Committed",E.title=t.title,E.appearance=2,E.tag=t.tag,this.c2.push(t.tag),!0;Ka=e.parentTableOrNullObject;
if(!sb&&Ka&&"TableCell"===E){E=e.text.trim();sb=vc.a.Byc(E);e.insertText(" ",4);E=e.getRange(2).insertContentControl();for(Ka=0;Ka<sb.length;Ka++)0==Ka?E.insertText(sb[Ka],4):E.insertText(" "+sb[Ka],3);E.UR=W?"Committed":"Highlighted";1===sb.length&&""===sb[0]?E.insertText(" ",2):E.insertText("",2);e.insertText("",4)}else E=e.insertContentControl(),W?Object(tj.w)(E,"Committed"):Object(tj.w)(E,"Highlighted"),Object(tj.y)(E,2,"");E.title=t.title;E.appearance=2;E.tag=t.tag;this.c2.push(t.tag);ha&&W&&
(ha.id=E.id);return!0}}QLg(e){const t=this.I1.create(),E=this.xxa(t);e.map(W=>{W=E.getByTag(W);for(let ha=0;ha<W.length();ha++){const Ka=W._GetItem(ha);Ka.appearance=2;Ka.insertText("",2);a(this.Ge,Ka,!0,this.kXe);Object(tj.w)(Ka,"Highlighted")}})}$Yl(e,t,E){if(this.rud(t)&&(e=e.getByTag(t.tag),1<=e.length()))for(let W=0;W<e.length();W++){const ha=e._GetItem(W);ha.title=t.title;E&&(this.iPc=[],Object(tj.w)(ha,"Highlighted"),ha.insertText("",2))}}J0m(e,t){if(this.Alh&&("hyperlink"===e.datatype||"email"===
e.datatype)){let E=t.getRange(0).Fq.J(0);t.fg&&(E=Zd.a.createTextRange(E.node,0,Xf.ParagraphReader.textLength(E.node)));this.fF.vF(E,"email"===e.datatype?"mailto:"+e.title:e.title,!1)}}D7l(e,t){t.map(E=>{var W;const ha=e.getByTag(E.tag);if(1<=ha.length())for(let Ka=0;Ka<ha.length();Ka++){const sb=ha._GetItem(Ka);E.title&&(a(this.Ge,sb,"true"===(null===(W=E.title)||void 0===W?void 0:W.toLowerCase())?!1:!0,this.kXe),Object(tj.w)(sb,"Filled"))}})}u7l(e,t){t.map(E=>{const W=e.getByTag(E.tag);if(1<=W.length()){let ha=
!1;for(let Ka=0;Ka<W.length();Ka++){const sb=W._GetItem(Ka);E.title?sb.tag.endsWith("TableSelection")?ha||(Object(eu.c)(sb,this.od,this.Ck,this.e6,this.tea,this.Co,this.fF,E.tableValues,E.tableValuesDataTypes),ha=!0,Object(tj.w)(sb,"Filled"),sb.insertText("",2),Object(tj.o)("FilledValueContentControl","Updated value")):"string"===typeof E.title&&E.tag===sb.tag?(sb.tag.endsWith("ImageSelection")&&E.imageProperties&&E.imageProperties.imageUrl?(E.imageProperties={...E.imageProperties,altText:E.title},
f(sb,E.imageProperties)):"RichMultiText"===E.datatype?(Object(tj.w)(sb,"Filled"),sb.insertHtml(E.title,4)):E.title!==sb.text&&(Object(tj.w)(sb,"Filled"),sb.text=E.title,this.J0m(E,sb)),Object(tj.o)("FilledValueContentControl","Updated value")):(Object(tj.w)(sb,"Filled"),Object(tj.o)("FilledValueContentControl")):(Object(tj.w)(sb,"Highlighted"),sb.insertText("",2))}}})}deleteContentControl(e,t){if(this.rud(t)&&(e=e.getByTag(t.tag),1<=e.length())){for(let E=0;E<e.length();E++)e._GetItem(E).deleteContentControl(!0);
this.c2=this.c2.filter(E=>E!==t.tag)}}LQl(){if(0<this.eac.length){const e=this.I1.create();for(let t=0;t<this.eac.length;t++){const E=e.contentControls.getByTag(this.eac[t]);E&&E.length()&&E._GetItem(0).deleteContentControl(!0)}}}$Lo(e,t){this.rud(t)&&(e=e.getByTag(t.tag),1<=e.length()&&(e=e._GetItem(0).AXj,e=hi.SelectionFactory.se(e,0),Wg.a.instance.Ic(e),Object(tj.o)("FilledValueContentControl","Updated value")))}Qae(e,t,E,W){if(this.rud(t))if(e=e.getByTag(t.tag),W){if(W=e.getByIdOrNullObject(W.id))"Hover"===
E?Object(eu.h)(W):"Highlight"===E&&Object(eu.f)(W),W.insertText("",2)}else if(1<=e.length())for(W=0;W<e.length();W++)t=e._GetItem(W),"Hover"===E?Object(eu.h)(t):"Highlight"===E&&Object(eu.f)(t),t.insertText("",2)}knp(e){let t=e.textOffset;var E=Pd.a.Mp();E=this.jb.Zl(E);E=this.ESa.Jra(E,!1,!1);let W;do{const ha=E.my;if(ha){const Ka=Xf.ParagraphReader.textLength(ha);t>Ka?0<Ka&&(t=t-Ka-2):Xf.ParagraphReader.text(ha).substring(t,t+e.name.length).toLowerCase()===e.name.toLowerCase()&&(W=Zd.a.createTextRange(ha,
t,t+e.name.length),this.jXm(W,e))}}while(E.lba()&&!W)}E0m(){this.Q6b.forEach(e=>{e.tagId&&(this.P6b.get(e.tagId).forEach(t=>{const E=new fa.a;E.add(t);this.$g.thf(E);this.$g.U5a(t,this.e6,void 0,!0)||(t=this.$g.U5a(t,this.e6),Object(tj.w)(t,"Highlighted"),Object(tj.y)(t,2,""),t.title=e.name,t.appearance=2,t.tag=e.tagId)}),this.c2.push(e.tagId))})}jXm(e,t){if(this.Q6b.has(t.name)){if({tagId:t}=this.Q6b.get(t.name),t&&this.P6b.has(t)){var E=this.P6b.get(t);E.push(e);this.P6b.delete(t);this.P6b.set(t,
E)}}else E=Math.floor(1E6*Math.random()+1).toString(),this.Q6b.set(t.name,{...t,tagId:E}),this.P6b.set(E,[e])}VA(e){const t=this.I1.create();var E=this.xxa(t),W={id:void 0};switch(e.Values.Action){case "RemoveContentControlAck":E=this.Zxk(t);window.parent.postMessage(JSON.stringify(E),this.Jya);break;case "CreateContentControlForTableCell":var ha=t.getSelection();E=e.Values.Placeholder;var Ka="PlaceholderV2"===e.Values.type;e=e.Values.source;this.ERa=!0;this.wJc=Ka;this.U9h(ha,E,"TableCell",Ka,W);
this.hb.Ic(df.SelectionEditor.Wj(this.hb.gb.currentSelection,!1,!0,void 0,!1));this.ERa=this.wJc=!1;Ka&&(ha=this.I1.create(),ha=this.xxa(ha),void 0===e||"Panel"===e?Object(tj.h)(ha,E,W.id):"PlaceholderCard"===e&&Object(tj.q)(ha,E),this.rcf(ha,E.tag));break;case "UpdateTableColumnHighlight":W=e.Values.MessageContent;e=e.Values.Placeholder;e.tag.endsWith("TableSelection")&&this.Gup(E,W,e.tag);break;case "GetTableColumnDetails":e=e.Values.Placeholder;e.tag.endsWith("TableSelection")&&Object(eu.d)(E,
e.tag);break;case "FetchSelection":E=e.Values.Placeholder;e=this.I1.create();e=this.xxa(e);Object(tj.h)(e,E,void 0);break;case "CreateContentControl":Ka=t.getSelection();E=e.Values.Placeholder;ha=e.Values.source;this.wJc=e="PlaceholderV2"===e.Values.type;var sb=Object(tj.g)(E.tag);Ka=this.U9h(Ka,E,sb,e,W);this.ERa=!0;Ka&&this.hb.Ic(df.SelectionEditor.Wj(this.hb.gb.currentSelection,!0,!1,void 0,!0));this.ERa=this.wJc=!1;e&&(e=this.I1.create(),e=this.xxa(e),void 0===ha||"Panel"===ha?Object(tj.h)(e,
E,W.id):"PlaceholderCard"===ha&&Object(tj.q)(e,E),this.rcf(e,E.tag));break;case "CancelWACContentControlCreation":this.ERa=!0;this.hb.Ic(df.SelectionEditor.Wj(this.hb.gb.currentSelection,!0,!1,void 0,!0));this.ERa=!1;break;case "EditContentControl":this.$Yl(E,e.Values.Placeholder,e.Values.type);break;case "FillConditionalAnswers":this.D7l(E,e.Values.Placeholder);break;case "FillValueForContentControl":this.u7l(E,e.Values.Placeholder);break;case "DeleteContentControl":e=e.Values.Placeholder;this.deleteContentControl(E,
e);this.ORa.delete(e.tag);break;case "RemoveSelections":W="AllCommited"===e.Values.type;ha="All"===e.Values.type;const dc=e.Values.Placeholder;if("Single"===e.Values.type&&e.Values.MessageContent){const xc=Object(tj.f)(JSON.parse(e.Values.MessageContent));this.c2=Object(tj.p)(dc,E,this.c2,this.iPc,void 0,xc);0===E.getByTag(dc.tag).length()?this.c2=this.c2.filter(Rc=>Rc!==dc.tag):(E=this.ORa.get(xc.tag))&&this.ORa.set(xc.tag,E.filter(Rc=>Rc!=xc.id))}else W?(this.c2=(e=e.Values.PreviousPlaceholderTag)?
Object(tj.p)(dc,E,this.c2,this.iPc,"Committed",void 0,e):Object(tj.p)(dc,E,this.c2,this.iPc,"Committed",void 0),E=this.I1.create(),E=this.xxa(E),e&&this.ORa.delete(dc.tag),this.rcf(E,e?e:dc.tag),Object(tj.u)(e?e:dc.tag,this.ORa.get(e?e:dc.tag))):ha&&(this.c2=Object(tj.p)(dc,E,this.c2,this.iPc,void 0,void 0),this.ORa.delete(dc.tag));break;case "GetHTML":this.quj(t.getSelection().getHtml());break;case "GetSelectedText":this.quj(t.getSelection().text);break;case "ScrollToContentControl":e=e.Values.Placeholder;
this.Igh&&this.$Lo(E,e);break;case "HighlightHoveredContentControl":W=e.Values.Placeholder;(e=e.Values.MessageContent)?(e=Object(tj.f)(JSON.parse(e)),this.Qae(E,W,"Hover",e)):this.Qae(E,W,"Hover");break;case "UnhighlightHoveredContentControl":W=e.Values.Placeholder;(e=e.Values.MessageContent)?(e=Object(tj.f)(JSON.parse(e)),this.Qae(E,W,"Highlight",e)):this.Qae(E,W,"Highlight");break;case "PublishSaveTemplate":lf.a.mU(mc.a.afc,!1,xc=>{xc={["data"]:xc,["sessionId"]:v.AFrameworkApplication.userSessionId,
["sortedPlaceholderTags"]:this.xxa(t).getContentControls().map(Rc=>Rc.tag)};Object(tj.o)("ReceiveSuccessPublishSaveTemplate",JSON.stringify(xc))},(xc,Rc)=>{Object(tj.o)("ReceiveFailurePublishSaveTemplate",JSON.stringify({["data"]:xc,["statusCode"]:HG.a[Rc],["sessionId"]:v.AFrameworkApplication.userSessionId}))},null);break;case "SendPlaceholderCCDetails":W=e.Values.MessageContent;this.Igh=e.Values.isScrollDocEnabled;this.Alh=e.Values.highlightHyperlinkAndEmail;this.M6b=e.Values.isConditionalFieldsEnabled;
this.kXe=e.Values.isDocGenLoaded;(this.c2=W)&&0<W.length&&this.QLg(W);Object(tj.o)("EditFlowContentControlsLoaded",JSON.stringify({["sessionId"]:v.AFrameworkApplication.userSessionId}));e=new Map;this._frame&&(this._frame.VE.xc(dv.a.oi,this._frame.get_element(),tj.s),this._frame.VE.nb(dv.a.oi,this._frame.get_element(),this.dyg));for(ha=0;ha<W.length;ha++){Ka=E.getByTag(W[ha]);sb=[];for(let xc=0;xc<Ka.length();xc++)sb.push(Ka._GetItem(xc).id);e.set(W[ha],sb)}this.ORa=new Map(e);Object(tj.r)(e);break;
case "CloseTemplateStudio":this.hb.nY(this.K5c);v.AFrameworkApplication.qAo(this.jNi);this._frame&&(this._frame.VE.xc(dv.a.oi,this._frame.get_element(),this.dyg),this._frame.VE.xc(dv.a.YKb,this._frame.get_element(),this.y8e));break;case "SendAckForDocGenLoaded":this.hb.nY(this.K5c);this._frame&&(this._frame.VE.xc(dv.a.oi,this._frame.get_element(),this.dyg),this._frame.VE.xc(dv.a.YKb,this._frame.get_element(),this.y8e),this._frame.VE.nb(dv.a.oi,this._frame.get_element(),tj.t));break;case "SPOInReflowMode":this.xqh=
e.Values.MessageContent;break;case "DisableEditDocCheck":this.via.ald(this.Twe);break;case "AddContentToDocument":this.I1.create().body.insertHtml(e.Values.Content,4);this.eac=e.Values.ContentControlIds;this.PGh=e.Values.BreaksCount;Object(tj.o)("UpdatedContent");break;case "ReceivedUpdatedContent":E=this.I1.create();for(e=0;e<this.eac.length;e++)for(W=0;W<this.PGh[e];W++)E.body.paragraphs._GetItem(e+W).text.length&&(ha=E.body.paragraphs._GetItem(e+W).insertContentControl(),ha.tag=this.eac[e],ha.appearance=
2);break;case "DeleteSectionFromTemplate":E=this.I1.create().contentControls.getByTag(e.Values.ContentControlId);for(e=0;e<E.length();e++)E._GetItem(e).deleteContentControl(!1);break;case "EditSectionInTemplate":E=this.I1.create();W=e.Values.ContentControlId;ha=E.contentControls.getByTag(W);for(Ka=1;Ka<ha.length();Ka++)ha._GetItem(Ka).deleteContentControl(!1);E.contentControls.getByTag(W)._GetItem(0).text=e.Values.NewSectionText;break;case "GetHtmlForDocument":this.tOo();break;case "GetDocTextForSuggestions":this.LQl();
this.mPo();break;case "GetDocTextForRePrompt":this.MOo();break;case "GetSuggestionsForFields":E=e.Values.MessageContent;this.Q6b=new Map;if(E&&0<E.length)for(e=0;e<E.length;e++)this.knp(E[e]);this.E0m();this.OOo()}}xxa(e){v.AFrameworkApplication.Ld("ccHeaderFooterTreatment;ccHeaderFooterControl");return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CAHeaderFooterCCEnabled",!1)?e.contentControls:e.body.contentControls}}Object(y.a)(ev,"CaaeMessageHandler",null,[1202]);
class ns{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh){this.Aqa=null;this.Er=e;this.gDd=t;this.Qpk=new ev(this,E,W,ha,Ka,sb,dc,xc,Rc,md,t,ud,Ud,Id,Ee,kf,Ke,dh);this.Er.zea(rE.a.eji);this.Er.zea(rE.a.bji);this.gDd!==Ov.a.nmb&&(this.Er.zea(this.gDd),this.$q("CAAEMessage",this.Qpk))}$q(e,t){z.ULS.sendTraceTag(541405831,2250,50,"Attempting to register a handler for MessageTypeId [{0}].",e);if(e&&""!==e)if("CAAEMessage"!==e)z.ULS.sendTraceTag(540357400,2250,10,"Attempted to register MessageTypeId other than CAAEMessage");
else if(t){var E=!1;this.Er.isEnabled()&&(this.Er.Aw(e),E=this.Er.BD(e,t.VA.bind(t)));E||z.ULS.sendTraceTag(541405834,2250,10,"Failed to register Messenger handler for MessageTypeId [{0}].",e)}else z.ULS.sendTraceTag(541405833,2250,10,"Attempted to register null IIncomingMessageHandler.");else z.ULS.sendTraceTag(541405832,2250,10,"Attempted to register null or empty MessageTypeId.")}sendMessage(e,t){if(this.Aqa){var E=this.Aqa.src;this.Er.vfe(E)?Array.contains(rE.a.uSd,e)?this.Er.r_a(Object.assign(new Pv.a,
{MessageId:e,SendTime:Date.now(),Values:{["Payload"]:t}}),this.Aqa.contentWindow,A.a.getOrigin(E))||z.ULS.sendTraceTag(541405838,2250,10,"Failed to send a message with MessageTypeId [{0}].",e):z.ULS.sendTraceTag(541405837,2250,10,"Attempted to send a message with unsupported MessageTypeId [{0}].",e):z.ULS.sendTraceTag(541405836,2250,10,"Attempted to send a message to origin that's not allowed.")}else z.ULS.sendTraceTag(541405835,2250,10,"Attempted to send a message with undefined target iframe element and MessageTypeId [{0}].",
e)}}Object(y.a)(ns,"DocumentAssemblyMessenger",null,[1168]);var xq=d(1424),IG=d(1543),WA=d(2176);class Qv{constructor(e,t,E,W,ha,Ka){this.j7h=this.l7h=null;this.jt=e;this.i7h=t;this.zzl=E;this.Azl=W;this.l7h=ha;this.j7h=Ka}}Object(y.a)(Qv,"ContentAssemblyHighlightContext",null,[]);class xr extends IG.a{constructor(e,t,E,W){super();this.Jrk=40;this.KNc="px";this.gLe="aria-label";this.Bzl="Field_20";this.jb=e;this.Pg=t;this.mZ=E;(this.vB=W)&&this.vB.JRd(this.zD.bind(this))}t7a(e){const t=[],E=e.D6a(0,
this.Jrk,this.zoom);t.push(this.Ira(e.s8,E,e.CBc[0].y-e.E7[0].y));return t}Ira(e,t,E){const W=e.uh.ownerDocument,ha=Gb.a.createElement(W,Pc.a.div);ha.className=xr.Irk;ha.style.left=t+this.KNc;ha.style.top=E+this.KNc;t=Gb.a.createElement(W,Pc.a.div);Sf.a("renderIcon")&&appChrome.api.renderIcon(this.Bzl,t);t.setAttribute("role","img");t.setAttribute("alt","Conditional section");t.title="Conditional section";t.setAttribute(this.gLe,"Conditional section");ha.appendChild(t);e={context:new Qv([],ha,new Set,
new Set,null,null),sdg:e,container:ha};this.Pg.rK(dv.a.click,ha,this.SMa.bind(this),e);return ha}qeb(e){e=this.jb.Zl(e.Cb);return Object(tj.d)(e,!1,e.YH)}cWd(){const e=Object.assign(new WA.a,{action:1,type:7,ZB:null,dM:this.nia});this.nia=null;this.mZ.qH(e)}zD(e,t){this.nia&&!t.o8a.Nf.classList.contains(tj.j)&&this.cWd()}SMa(e){if(!e)return!1;let t=e.Mq.context;if(xr.Hab(t,this.nia))return!0;t=this.CKf(e.Mq.sdg,t,e.Mq.container);e=Object.assign(new WA.a,{action:0,type:7,ZB:t,dM:this.nia});this.nia=
t;this.mZ.qH(e);return!0}CKf(e,t,E){t={k7h:new Set,jXb:new Set,m7h:null,Wrf:null};const W=this.jb.Gv(e.Cb,!0,!1),ha=[];if(W)for(const Ka of W)ha.push(Ka);this.hYk(e,t,ha);return t=new Qv(ha,E,t.k7h,t.jXb,t.m7h,t.Wrf)}hYk(e,t,E){if(e.Kj){var W=new Set;for(const Ka of e.$f.mj)Ka.querySelectorAll("*").forEach(W.add,W);e=Array.from(W.values())}else e=Array.prototype.slice.call(e.htmlElement.querySelectorAll("*"),0);let ha=[];t.jXb.add(E[0].id);t.m7h=E[0].id;t.Wrf=E[0].id;e.forEach(Ka=>{const sb=vi.a.Eb(Ka,
"CaaeContentControlStartGuids");if(sb)for(const dc of sb)ha.push(dc),t.k7h.add(dc);if(!ha.length)return!0;Ka=vi.a.Eb(Ka,"CaaeContentControlEndGuids");if(!Ka)return!0;ha=xq.a.mvc(ha,Ka)});for(W=e=this.jb.zg(E[E.length-1],!1,!0);ha.length&&e;){t.jXb.add(e.id);t.Wrf=e.id;E.push(e);for(const Ka of W.jJ)Ka.htmlElement.querySelectorAll(".CaaeContentControlEnd").forEach(sb=>{(sb=vi.a.Eb(sb,"CaaeContentControlEndGuids"))&&(ha=xq.a.mvc(ha,sb))});W=e=this.jb.zg(e,!1,!0)}}static Hab(e,t){return!!t&&!!e&&e.i7h===
t.i7h}}xr.Irk="WordBookmarkSvgIndicatorContainer";Object(y.a)(xr,"ContentAssemblyIndicatorActor",IG.a,[246]);class Iw extends Lq.a{constructor(){super()}get Ufa(){return!0}get Yrb(){return 7}get k$a(){if(null!=this.P5)return this.P5;this.P5=[];this.P5.push(new Hm.a(tj.j,tj.j));return this.P5}bNa(e,t){var E;if(this.Ufa){var W=this.Gq.vJa,ha=this.Gq.dbd,Ka=e.YH;if(W&&7===W.type){ha=t.BNa("*");const sb=W.ZB;if(null===(E=W.dM)||void 0===E?0:E.jt.includes(e))for(const dc of ha)this.Gq.TZa(dc);Ka&&Object(tj.d)(e,
!0,Ka)&&this.dQj(Ka,tj.j,!1);sb&&sb.jt.includes(e)&&this.qyb(t,W.action,sb,e,ha,Ka)}else W&&ha&&7===ha.type&&3===W.action&&ha.ZB.jt.includes(e)&&(E=t.BNa("*"),this.qyb(t,0,ha.ZB,e,E,Ka))}}TXa(e){return e instanceof Qv}E9a(e,t){if(e)for(const E of e.jt)t.add(E)}dQj(e,t,E){e=e.ue(Object(ki.a)().zd.oc).htmlElement.querySelectorAll("table");0!==e.length&&(E?e[0].classList.add(t):e[0].classList.remove(t))}qyb(e,t,E,W,ha,Ka){if(0===t&&e.htmlElement)if(Ka)this.dQj(Ka,tj.j,!0);else{e=ha.length;var sb=W.id===
E.l7h,dc=W.id===E.j7h;t=Array(e);var xc=[],Rc=0;Ka=!1;for(let ud=0;ud<e;ud++){const Ud=ha[ud];var md=Nl.a(Ud);t[ud]=md;md=Ud.classList;if(0!=t[ud]){const Id=!md.contains(Ng.a.jI),Ee=vi.a.Eb(Ud,"CaaeContentControlEndGuids");Ee&&xc.push(...Ee);if(sb){let kf;if(kf=vi.a.Eb(Ud,"CaaeContentControlStartGuids"))Rc+=kf.length,md.add(tj.j);if(Ee)for(const Ke of Ee)this.Ufn(E,Ke)&&Rc--;0!==Rc&&Id&&md.add(tj.j)}sb||dc||!E.Azl.has(W.id)||(vi.a.Eb(Ud,"CaaeContentControlEndGuids")&&Ka?md.add(tj.j):Id&&md.add(tj.j))}Ka=
!md.contains(Ng.a.f8a)}Ka=!1;if(dc&&!sb)for(E=0;E<e;E++)W=ha[E].classList,0!==t[E]&&!W.contains(Ng.a.jI)&&Ka&&W.add(tj.j),Ka=!W.contains(Ng.a.f8a)}}Ufn(e,t){for(const E of e.zzl)if(t.equals(E))return!0;return!1}}Object(y.a)(Iw,"ContentAssemblyHighlightActor",Lq.a,[438]);class Jw{constructor(){this.W=null}get name(){return"WordEditor.DocumentAssemblyEditor"}wc(e){this.W=e;const t=v.AFrameworkApplication.RXb||Ov.a.nmb;this.W.ia("WordEditor.DocumentAssemblyEditor.Messenger",()=>new ns(new Ov.a(null,
null),t,this.W.resolve("WordEditor.Extension.DocumentFactory"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("WordEditor.Extension.IInsertApiOperations"),this.W.resolve("WordEditor.Extension.TableOperations"),this.W.resolve("WordEditor.IImageEditor"),this.W.resolve("Box4.IFormattingEditor"),this.W.resolve("WordEditor.Extension.RequestContext"),this.W.resolve("WordEditor.Extension.TableCellFactory"),this.W.resolve("WordEditor.Extension.ParagraphFactory"),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.W.resolve("WordEditor.Extension.IContentControlOperations"),this.W.resolve("Box4.IParagraphIteratorFactory"),this.W.resolve("Box4.IParagraphReader"),Wg.a.instance,Hw.a.instance,v.AFrameworkApplication.va)).ha();this.W.ia("WordEditor.DocumentAssemblyEditor.Actors.ContentAssemblyIndicatorActor",()=>new xr(e.resolve("Box4.IParagraphReader"),Ll.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),e.resolve("Box4.IInteractiveEventHandler"))).ha()}init(){this.W.resolve("WordEditor.DocumentAssemblyEditor.Messenger");
v.AFrameworkApplication.$u&&(v.AFrameworkApplication.Ld("ccAnnotationsTreatment;ccAnnotationsControl"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.contentControlAnnotations",!1)&&(this.W.resolve("Box4.Indicator.IIndicatorManager").QZa(this.W.resolve("WordEditor.DocumentAssemblyEditor.Actors.ContentAssemblyIndicatorActor")),this.W.resolve("Box4.Highlight.IHighlightManager").idb(new Iw)))}dispose(){}static main(){if(!v.AFrameworkApplication.rL&&v.AFrameworkApplication.$u){x.a.instance.Jc(new Jw);
const e=v.AFrameworkApplication.ua;e&&(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",!1)&&"DocGen"!==v.AFrameworkApplication.$u&&"ContentAssemblyView"!==v.AFrameworkApplication.$u||!e.uva||e.uva.classList.add("HideRibbon"),e.h6c&&e.JFg.classList.add("hidePanel"))}}}Object(y.a)(Jw,"DocumentAssemblyPackageManager",null,[0,1]);var zs=d(936);class Ey extends Sys.EventArgs{constructor(e){super();this.wtb=e}}Object(y.a)(Ey,"LicenseStateChangeEventArgs",
Sys.EventArgs,[]);class XA{constructor(e,t,E){this.tu=e;this.Ga=t;this.Y_e=E;this.zUb=new Promise((W,ha)=>{this.kLk=W;this.BKk=ha});this.Kdm=W=>{if(W.featureName===zs.a.Xzf)switch(W.tierName){case 2:z.ULS.sendTraceTag(541332422,2250,50,"FreemiumCallback for {0} updated state to Premium",W.featureName);this.Y_e.raiseEvent("OnLicenseStateChange",new Ey(!0));this.tu.execute(ha=>{ha.rZb(W.featureName,this.LOk)});break;default:z.ULS.sendTraceTag(541332423,2250,10,"FreemiumCallback for {0} received with unexpected value {1}",
W.featureName,W.tierName)}else z.ULS.sendTraceTag(541332424,2250,10,"FreemiumCallback received with unexpected FeatureName {0}",W.featureName)}}DPh(e){this.Y_e.addHandler("OnLicenseStateChange",e)}R5m(){this.pNd=(e,t)=>{this.Y_e.raiseEvent("OnLicenseStateChange",new Ey(2!==e));this.kLk({mode:e,Cad:2!==e,o5p:t})};this.Btk=()=>{z.ULS.sendTraceTag(541131153,2250,50,"Disabling feature for reason: Tier name is basic");this.BKk("Tier name is basic")};this.tu.execute(e=>{e.getFeatureTier(zs.a.Xzf,0).then(t=>
{const E=e.isFreemiumUpsellEnabled();if(32===this.gVm(t,E))z.ULS.sendTraceTag(541332419,2250,50,"WordEditor HandleEnableDisable Licensing completed successfully");else return e.isFeatureEnabled(zs.a.Zzf,!0);return null}).then(t=>{null!==t&&(this.EWm(t,e),z.ULS.sendTraceTag(541332420,2250,50,"WordEditor HandlePremium Licensing completed successfully"));return null}).catch(t=>{z.ULS.sendTraceTag(541332421,2250,10,"Failed to initialize with licensing: Error {0}",t);t=e.isFreemiumUpsellEnabled();this.pNd(1,
t);return null})})}gVm(e,t){this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.FreeUserExperienceEnabled",!1)&&(e=0);switch(e){case 2:return this.pNd(0,t),32;case 1:return this.Btk(),32;default:return 2}}EWm(e,t){const E=t.isFreemiumUpsellEnabled(),W=this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.FreeUserExperienceEnabled",!1);e&&!W?this.pNd(1,E):(this.LOk=t.hva(zs.a.Xzf,this.Kdm),this.pNd(2,E||W))}}Object(y.a)(XA,"AddInLicensingManager",null,[1181]);const Rv=
(e,t,E,W,ha)=>{const Ka={state:3,daysRemaining:-1};e=Math.floor((+t-+e)/864E5);0>e?Ka.state=3:e>=E?(Ka.daysRemaining=E-e,Ka.state=e>E+30?2:5):(Ka.daysRemaining=E-e,Ka.state=1);if(2===Ka.state||5===Ka.state)Ka.state=W&&0<=ha?0:Ka.state;return Ka};class Iz{constructor(e,t=null){this.Ga=e;this.dF=null!==t&&void 0!==t?t:()=>new Date}NTb(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.IsWomppEnabled",!1)}SHf(){const e=new Date(this.Ga.getStringFeatureGate("Microsoft.Office.WordOnline.FA000000029.WomppUntilDate",
"2021/12/1")),t=this.dF();return Math.floor((+e-+t)/864E5)}thn(){const e=v.AFrameworkApplication.Cua;return e&&e.toLowerCase()===Iz.Zkk?!0:!1}}Iz.Zkk="tm67341774";Object(y.a)(Iz,"UpsellCampaignGate",null,[]);class yC{constructor(e){this.Ga=e}isEnabled(){const e=this.Ga.$("EditorBrowserExtensionPromo"),t=this.I_l();return e||t}I_l(){return"-4"===v.AFrameworkApplication.sessionStartInfoSettings.Ring}}Object(y.a)(yC,"BxPromoGate",null,[]);class Sr{constructor(){this.isDismissed=this.isInstalled=!1}}
Object(y.a)(Sr,"BxPromoSettings",null,[864]);class YA extends Kv.a{constructor(e,t,E,W,ha){super(e,t,E,W,ha);this.hIc="getEditorBxPromoSettings";this.X$b="saveEditorBxPromoSettings";this.a9b=YA.Wdk;this.xFb=["IsInstalled","IsDismissed"];this.M$="BX cross-promo";this.Jkb=Cz.a.Wzf}async DUo(){this.Ki||(this.Sg.sendTraceTag(557183135,2250,15,"BX cross-promo settings null when setting isDismissed"),this.Ki=new Sr);this.Ki.isDismissed=!0;await this.Qmd()}get Igc(){return new Sr}Icc(){return["IsInstalled",
this.Ki.isInstalled,"IsDismissed",this.Ki.isDismissed]}Hcc(){return{["IsInstalled"]:this.a_(this.Ki.isInstalled.toString()),["IsDismissed"]:this.a_(this.Ki.isDismissed.toString())}}async Vld(e){const t=this.Ki.isDismissed&&!e.isDismissed;this.Ki.isDismissed=this.Ki.isDismissed||e.isDismissed;this.Ki.isInstalled=this.Ki.isInstalled||e.isInstalled;return t}ZXc(){return new Az.a}dhd(e){const t=new Sr;t.isInstalled=this.Oyj(e.IsInstalled);t.isDismissed=this.Oyj(e.IsDismissed);return t}}YA.Wdk="BxPromoSettingsChangedEvent";
Object(y.a)(YA,"BxPromoSettingsHandler",Kv.a,[1179,1180,868]);const zC=[["363d7011-83dd-4cc0-bdec-ea4af4df4dbb",!1],["6d1d8c3d-62d5-45d1-b850-d8a98a24964b",!1]],PI=[["cfc8ef49-66b1-4ea0-8930-43d2ccd842e0",!1],["f55d29d6-efd4-4a51-8a01-e0a7bd549073",!0],["c1ed6a31-f439-4115-8272-7bbd2f663a84",!0],["d124712e-74ac-43eb-9bb6-373b2398f448",!0],["ca649e0f-48de-4f54-b687-2bda07e40728",!0],["9e5c572b-ec30-4f6b-b75c-ad9e60efe95e",!0],["12d7f72e-e53e-4b27-b1ed-4ee115f54994",!0],["f57c12d6-03e4-4f48-9b7b-f95802a6c669",
!1],["25714ab1-190b-4ef3-8d3d-e45bfd591c45",!0],["708198dd-ecbf-44fb-a428-ff2bc10e4d17",!0],["0fc5f67a-9d4e-41de-a1c6-ebe9b8b9046c",!0],["6c49e04e-c556-43f3-94dc-2fe5dc18d8e5",!0],["5d411ad2-a965-4c01-b425-ecce2b374dfa",!0],["e006985e-33eb-42e1-9196-1333c4ecad9c",!0],["e3391a10-ee05-41e7-984d-82e72981a099",!0],["520b6db9-9638-4266-aa31-dc2cadd19aa8",!0],["0124af9e-756d-4ab9-8cc6-d99a20c22897",!0],["b85a7205-ba3d-4afb-8187-86f8ea104c75",!0],["0941dabb-e993-4a10-8a92-70a95ca5389d",!0],["7c2ff4d7-41a9-4310-949b-863a0dfa4257",
!1],["0da5de95-d496-4d23-8f93-693ef6592ae6",!1],["04cc32b6-7af4-4778-8ce9-c32698169b6a",!0],["95647447-1670-4af1-868e-7266583f61ff",!0],["a7927082-e6bb-4061-a134-3051e5969222",!0],["c61cb624-820e-454a-b426-cdd4c0a7011b",!0],["26bdc172-02a8-4f0a-8ec0-6049906f1f7c",!0],["79dd443b-0b94-45a1-90ad-02807565324d",!1],["4ee98de6-ea40-48db-ae36-ca82fc8473f7",!0],["2948a1be-32f1-460e-84ef-8b89597af9f1",!0],["67718619-a6b1-43ec-af18-1c48bbc27acd",!0],["a9ca4ef4-12a5-4ad2-b8d5-b1310cc0d2af",!0],["19c926ad-f32d-42f8-996f-853c3ba00ab5",
!0],["5f1ea714-acc6-4b01-84d5-5a7666aa297b",!0],["296f8f65-02fb-45a7-b4ab-5dc137edc563",!0],["766428da-f41f-451d-818d-174eb99d84ba",!0],["8778ba37-ca99-4ab9-a964-55abd18f7eba",!0],["a44ac718-8213-42ff-87a5-1e5d6592c352",!1],["97e25aa1-c0cc-435f-adaa-e2d490553b6d",!0]],Fy=[["6d60d9da-9e38-4d1e-bfc5-05a04120eef9",!1],["63e72d3d-62d7-4e73-8d66-c137d8841121",!1],["27783a58-c44f-4778-9856-36d9eab63693",!1],["5cb7fc16-cd78-449c-86d9-5d047be21ac4",!1],["79405b77-e475-4f04-ba37-a3e6be66d3f2",!0],["7b3c279b-14c8-4e5f-83da-1cc446ed7f6a",
!0],["ba48d6ad-df91-4420-b26f-31c07765842d",!0],["d7746119-e7e5-4e97-9979-bcd2114f9fe9",!1],["50d4e435-dd52-4c0d-bb7a-9bb1c154a148",!0],["ef92c613-9224-424f-b391-748476b011cb",!0],["9aabeae7-bda2-44a7-a7f1-9c3d9089191e",!0],["39e466f1-6ebd-4ada-a7db-e0cc74048f1e",!0],["55178e46-8927-4b63-b19e-7c6fb5f8929b",!0],["aea1e72a-abf4-4cc8-8b7a-43d15be8fc55",!1],["8cf6f68e-f693-4e6f-b253-5092cd19b9e2",!0],["4f42f243-8cb5-4f1a-a5a6-58b60d303e02",!0],["012a7c1a-292a-4e17-b126-00191939cc0d",!0],["6cb8eda6-6cac-443a-8e3a-0df80ba725f6",
!0],["6dbfae4c-9818-4dec-a769-2595168927f2",!1],["02c15397-df70-4f00-aa4d-7269e6d4e712",!1],["bd326c9c-0e4a-4ddf-be36-1ef7bee200ca",!0],["49b2a4fe-b569-43fb-bb54-796eddc260b3",!0],["d1572a1d-58d1-443f-997e-2722cfc41afe",!0],["f1a2ad0b-0b26-4bb5-aede-e88c9fe47492",!1],["64213f24-0943-4585-8dd4-ee4f26b47a37",!0],["413425d5-5a64-4ea6-84df-aae06c596439",!0],["a127d2c9-2faf-491b-8d6a-e9b027fec098",!0],["999cc56a-caa5-4889-829e-7e249688e1cf",!0],["62540ee8-7f12-4c6e-be18-89268fa8a289",!1],["b3613809-76ab-4b7b-91e6-ee9b6b9b60b2",
!0],["c4301606-9bc2-4389-bb1a-c08370627172",!0],["75069b86-2fd8-4158-a9ab-2793fd1d6f8b",!0],["03522a58-4044-4bab-b796-0630ae2ad00a",!0],["9feebbfe-9e8d-4b59-8c7a-8b3c462d6697",!0],["e24fd819-cc17-4be9-afec-dd103055198e",!0],["72e604b0-a185-413b-bd45-ad555288c746",!1],["c1056d52-e69d-43a6-926c-662cb2228185",!0],["5b75d94a-856d-461b-9bb4-879f4502b4c3",!1],["6ae03cab-953e-4382-bd27-843c5d553b23",!1],["e8c121e0-1ecd-4e88-8694-2fb17acb519d",!0],["f4aa4a0a-f81a-41ac-b710-de4a60b99282",!1],["ff12bbbd-0795-409a-8ed0-c8d7b2793e3a",
!0],["e805847a-9050-45de-b767-f48ed68ad848",!0],["d96e4e94-041b-4389-861d-3cd4556d55f6",!0],["84275a90-df79-4b9e-a208-9ec8b5e59622",!1],["faa8f367-32d3-44cc-8eda-6e1e9de23efc",!1],["c68edc3b-9340-4b68-9d18-268bb82e2d94",!0],["8caa3b8f-202e-4a32-91a8-320b5272777e",!0],["3f2eda01-e8a5-4ed9-9494-6de566bc5333",!1],["6a0e1c97-430e-4d83-889d-8c4fea315a83",!0],["aa78ec66-2078-42bf-84f5-c241eb53a531",!0],["fd8f4ff7-fa09-492c-9c74-1a6b9f71e488",!1],["2d08dbe8-c11b-4190-a428-9a2c0a37bd68",!0],["3fd9c226-3925-4855-ba1e-49eb9ee46d24",
!0],["1c169b51-d9a5-4b69-9abc-2bcd5e9c5912",!0],["818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",!1],["79d4a5c7-11c0-4be1-8d3c-c322f9941323",!0],["b956d579-6d99-4278-8b7d-e281ab8c576b",!0],["55aa25a5-e28a-4f22-8410-34a4df965e30",!1],["d78a8ad6-bac7-47ff-8016-d75f7fcd8370",!0],["822bb35e-0608-466e-a771-a315fcf95821",!0],["0c576af1-54af-4acb-8065-4616bb73820d",!0],["e3994139-ff36-44da-ae72-500b70d9b80f",!0],["2700d569-bd6f-4806-9bf1-49abd64d9fd3",!0],["3f2e6b47-fc23-4f99-ad25-1758e7f179b6",!0],["352579fc-6ae6-4eb1-8d3b-895ab239714e",
!1],["985091e9-4b33-42f7-b2ff-191b03f2ba74",!0],["9d62fd01-8804-4485-a5f0-257131e4f6aa",!0],["e7c89ada-94b2-426a-b8ea-069712de5d9f",!1]];class fu{constructor(e,t,E){this.rHa=e;this.Z4e=t;this.jBb=E;this.kkb=new Map;this.Gqh=this.Vth=this.OEd=!1;this.Igf=W=>{this.Z4e.addHandler(fu.fmg,W)};this.GAp=(W,ha)=>{W=!ha.wtb;W!==this.OEd&&(this.OEd=W,this.rHa.f2i()&&this.Z4e.raiseEvent(fu.fmg))};this.kYf=(W,ha,Ka)=>this.rHa.f2i()?0===this.kkb.size?(this.Vth||(cc.a.sendTelemetryEvent(Object.assign(new cg.a,
{name:"Office.Word.Online.Ideas.PremiumPreviewCritiquesFilter.FilteringBeforeInitialization",dataFields:[]})),this.Vth=!0),!0):!this.OEd||"Spelling"===ha||Ka&&-1===Ka.toLowerCase().search("en")||this.Gqh?!0:void 0!==this.kkb.get(W)?!this.kkb.get(W):!1:!0;this.isCritiqueTypeUnderPaywall=(W,ha,Ka)=>Ka&&-1===Ka.toLowerCase().search("en")?!1:void 0!==this.kkb.get(W)?this.kkb.get(W):!0}DRi(e,t=!1){this.OEd=!e.Cad;this.Gqh=t;this.jBb.DPh(this.GAp);Fy.forEach(([E,W])=>this.kkb.set(E,W));zC.forEach(([E,W])=>
this.kkb.set(E,W));this.rHa.zqn()||PI.forEach(([E,W])=>this.kkb.set(E,W));this.Z4e.raiseEvent(fu.fmg)}}fu.fmg="PremiumPreviewFilterChangedEvent";Object(y.a)(fu,"PremiumPreviewCritiquesFilter",null,[1178]);class Jz{constructor(){this.startDate=null;this.allPpTypes=this.currentPpType=this.acceptedSimilarityCitations=this.acceptedTextPredictions=this.acceptedRefinements=this.acceptedSpellingAndGrammar=this.autoCorrectedErrors=this.totalDays=0}}Object(y.a)(Jz,"PremiumPreviewSettings",null,[864]);class ct extends Jz{constructor(){super(...arguments);
this.state=this.premiumSuggestionsCount=this.totalDays=this.daysRemaining=0;this.startDate=null;this.cardType=1}}Object(y.a)(ct,"PremiumPreviewData",Jz,[]);var QI=d(1228),ZA;(function(e){e[e.initial=0]="initial";e[e.Xfa=1]="inProgress";e[e.x4l=2]="expired";e[e.error=3]="error";e[e.Hhj=4]="notInitialized";e[e.DZp=5]="expiredWithMetrics";e[e.Vlq=6]="softPaywallInProgress"})(ZA||(ZA={}));Object(y.b)("PremiumPreviewState",ZA);var Gy;(function(e){e[e.EPp=1]="Regular";e[e.yRp=2]="Wompp";e[e.qQp=4]="SoftPaywall"})(Gy||
(Gy={}));Object(y.b)("PremiumPreviewType",Gy);class Sv{constructor(e,t,E,W,ha,Ka,sb=null){this.h$b=e;this.Glb=t;this.rHa=E;this.zPe=W;this.Sg=ha;this.iHa=Ka;this.BPe=!1;this.LMe=this.Glb.NTb()?2:1;this.E0n=(dc,xc)=>{this.D7c(xc.settings)};this.dF=sb?sb:()=>new Date;this.Cl=Object.assign(new ct,{state:4});this.h$b.rgf(this.E0n)}async start(e){const t=await this.swm(),E=this.$Ei(e);if(1===t.state&&2===t.currentPpType)this.Sg.sendTraceTag(545293637,2250,15,"User tried to enter WOMPP but already inProgress");
else{switch(e){case 1:if(this.eCp(t,e)){this.Sg.sendTraceTag(545293638,2250,15,"Trying to start Premium Preview but already in PP.");return}this.h$b.vGj();break;case 2:if(1===t.state&&1===t.currentPpType){if(t.daysRemaining>E){this.Sg.sendTraceTag(545293639,2250,15,"User tried to enter WOMPP but regular PP is longer.");return}}else this.h$b.vGj();break;default:this.Sg.sendTraceTag(545116506,2250,10,`Premium Preview started with type; ${Gy[e]}`);return}this.setState(1,e);this.iHa.rua(Fa.a.OKg,!0,null,
null,null,null,[{...(new yi.a),name:"ppType",string:Gy[e]},{...(new yi.a),name:"ppDuration",int64:E}])}}eCp(e,t){const E=e.allPpTypes,W=e.startDate;e=e.totalDays;return 1===t&&0===E?!!W&&!!e:0!==(E&t)}$Ei(e){switch(e){case 1:return this.rHa.eNf();case 2:return this.Glb.SHf()}}swm(){return new Promise(e=>{if(this.BPe&&4!==this.Cl.state)e(this.Cl);else{const t=(E,W)=>{4!==W.Cl.state&&(this.BPe=!0,this.iBo(t),e(W.Cl))};this.hKb(t)}})}D7c(e){this.BPe=!0;e?4===e.currentPpType?this.Cl={...(new ct),cardType:4,
state:6}:e.startDate||e.totalDays?(this.Cl={...Rv(e.startDate,this.dF(),e.totalDays,this.Glb.NTb(),this.Glb.SHf()),...e,premiumSuggestionsCount:0,cardType:this.LMe},3===this.Cl.state&&this.Sg.sendTraceTag(559256014,2250,10,"Premium preview start date greater than current date"),1!==this.Cl.state||2!==this.Cl.currentPpType||this.Glb.NTb()||(this.Sg.sendTraceTag(540674119,2250,15,"Tried to start WOMPP but it is disabled. Defaulting to expired state."),this.Cl.state=2)):(this.Sg.sendTraceTag(559256013,
2250,50,"Premium preview not yet started"),this.Cl=Object.assign(new ct,{daysRemaining:this.rHa.eNf(),state:0,totalDays:this.rHa.eNf(),startDate:null,cardType:this.LMe})):(this.Sg.sendTraceTag(559256012,2250,15,"Trying to intialize premium preview data with null settings"),this.Cl=Object.assign(new ct,{state:3}));this.raiseEvent()}jSo(e){this.Sg.sendTraceTag(559256015,2250,50,"Setting premium preview remaining days: {0}",e);this.Cl.daysRemaining=e;this.raiseEvent()}async xQo(e){await this.h$b.Ifp(e,
this.Cl)}setState(e,t){this.Sg.sendTraceTag(559256016,2250,50,"Setting premium preview state: {0}",e);this.Cl||(this.Sg.sendTraceTag(559256017,2250,15,"Premium preview data null when setting state: {0}",e),this.Cl=new ct,this.Cl.cardType=this.LMe);switch(e){case 1:const E=this.dF();this.h$b.wYo(new Date(E.toUTCString()),this.$Ei(t),t);void 0!==t&&(this.Cl.allPpTypes|=t,this.Cl.currentPpType=t);break;case 0:this.Sg.sendTraceTag(559256019,2250,50,"Setting premium preview state to Initial from {0}",
this.Cl.state),this.h$b.RFo(),this.raiseEvent()}this.Cl.state=e;this.raiseEvent()}raiseEvent(){this.iHa.rua(Fa.a.TXb,!0,null,null,null,null,[{...(new yi.a),name:"AllPpTypes",int64:this.Cl.allPpTypes},{...(new yi.a),name:"CurrentPpType",string:Gy[this.Cl.currentPpType]},{...(new yi.a),name:"PremiumPreviewState",string:ZA[this.Cl.state]},{...(new yi.a),name:"DaysRemaining",int64:this.Cl.daysRemaining},{...(new yi.a),name:"TotalDays",int64:this.Cl.totalDays},{...(new yi.a),name:"PremiumSuggestionsCount",
int64:this.Cl.premiumSuggestionsCount},{...(new yi.a),name:"AcceptedRefinements",int64:this.Cl.acceptedRefinements},{...(new yi.a),name:"AcceptedSimilarityCitations",int64:this.Cl.acceptedSimilarityCitations},{...(new yi.a),name:"AcceptedSpellingAndGrammar",int64:this.Cl.acceptedSpellingAndGrammar},{...(new yi.a),name:"AcceptedTextPredictions",int64:this.Cl.acceptedTextPredictions},{...(new yi.a),name:"AutoCorrectedErrors",int64:this.Cl.autoCorrectedErrors}]);this.zPe.raiseEvent(Sv.emg,new QI.a(this.Cl))}hKb(e){this.zPe.addHandler(Sv.emg,
e)}iBo(e){this.zPe.removeHandler(Sv.emg,e)}}Sv.emg="PremiumPreviewDataChangedEvent";Object(y.a)(Sv,"PremiumPreviewDataHandler",null,[]);class gu{constructor(e,t){this.Ga=e;this.jBb=t}eNf(){return this.Ga.getIntFeatureGate("Microsoft.Office.WordOnline.FA000000029.PremiumPreviewDuration",7)}async b0f(){if(!this.Ga.$("EditorPremiumPreviewEnabled"))return!1;try{return!(await this.jBb.zUb).Cad}catch(e){return!1}}Qon(){return this.Ga.$("EditorPremiumPreviewStateUpdateEnabled")}f2i(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.SelectedCritiquesDuringPremiumPreview",
!1)}zqn(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.IsSelectedCritiquesDuringPremiumPReviewAcceptRateHigh",!1)}}Object(y.a)(gu,"PremiumPreviewGate",null,[1176]);const Kw=new Map([["E_Refinements","acceptedRefinements"],["E_Similarity","acceptedSimilarityCitations"],["E_Spelling_Grammar","acceptedSpellingAndGrammar"],["E_TextPrediction","acceptedTextPredictions"],["E_AutoCorrect","autoCorrectedErrors"]]);class Tr extends Kv.a{constructor(e,t,E,W,ha){super(e,t,E,
W,ha);this.hIc="getPremiumPreviewSettings";this.X$b="savePremiumPreviewSettings";this.a9b=Tr.ceo;this.xFb="StartDate TotalDays AcceptedRefinements AcceptedSimilarity AcceptedSpellingAndGrammar AcceptedTextPrediction AutoCorrectErrors CurrentPpType AllPpTypes".split(" ");this.M$="Premium preview";this.Jkb=Cz.a.$zf}async wYo(e,t,E){this.Ki||(this.Sg.sendTraceTag(559255966,2250,15,"Premium preview settings null when setting date and total days "),this.Ki=new Jz);let W=this.Ki.allPpTypes|E;this.Ki.startDate&&
this.Ki.totalDays&&(W|=1);this.Ki={...this.Ki,startDate:e,totalDays:t,currentPpType:E,allPpTypes:W};await this.Qmd()}async Ifp(e,t){var E=await this.rHi();E=this.jlj(E);for(const W of lo.a.Ihc)this.wtp(e,t,E,W);this.Ki=E;this.yJj(this.Hcc())}vGj(){this.Ki||(this.Sg.sendTraceTag(545338245,2250,15,"Premium preview settings null when setting date and total days "),this.Ki=new Jz);this.Ki={...this.Ki,acceptedRefinements:0,acceptedSimilarityCitations:0,acceptedSpellingAndGrammar:0,acceptedTextPredictions:0,
autoCorrectedErrors:0}}wtp(e,t,E,W){const ha=Kw.get(W);t[ha]=E[ha]+=void 0==e.get(W)?0:e.get(W)}get Igc(){return new Jz}Icc(){return["StartDate",this.Ki.startDate,"TotalDays",this.Ki.totalDays,"AcceptedRefinements",this.Ki.acceptedRefinements,"AcceptedSimilarity",this.Ki.acceptedSimilarityCitations,"AcceptedSpellingAndGrammar",this.Ki.acceptedSpellingAndGrammar,"AcceptedTextPrediction",this.Ki.acceptedTextPredictions,"AutoCorrectErrors",this.Ki.autoCorrectedErrors,"CurrentPpType",this.Ki.currentPpType,
"AllPpTypes",this.Ki.allPpTypes]}Hcc(){var e=this.Ki.startDate.toISOString();e=e.substring(0,e.indexOf("T"));return{["StartDate"]:this.a_(e),["TotalDays"]:this.a_(this.Ki.totalDays.toString()),["AcceptedRefinements"]:this.a_(this.Ki.acceptedRefinements.toString()),["AcceptedSimilarity"]:this.a_(this.Ki.acceptedSimilarityCitations.toString()),["AcceptedSpellingAndGrammar"]:this.a_(this.Ki.acceptedSpellingAndGrammar.toString()),["AcceptedTextPrediction"]:this.a_(this.Ki.acceptedTextPredictions.toString()),
["AutoCorrectErrors"]:this.a_(this.Ki.autoCorrectedErrors.toString()),["CurrentPpType"]:this.a_(this.Ki.currentPpType.toString()),["AllPpTypes"]:this.a_(this.Ki.allPpTypes.toString())}}async Vld(e){if(e.startDate!==this.Ki.startDate||e.currentPpType!==this.Ki.currentPpType)return!0;this.Ki=e;return!1}ZXc(){return new Az.a}dhd(e){let t=null;e.StartDate&&(t=this.Ryj(e.StartDate));const E=this.ddb(e.TotalDays);return{startDate:t,totalDays:E,acceptedRefinements:this.ddb(e.AcceptedRefinements,!0),acceptedSimilarityCitations:this.ddb(e.AcceptedSimilarity,
!0),acceptedSpellingAndGrammar:this.ddb(e.AcceptedSpellingAndGrammar,!0),acceptedTextPredictions:this.ddb(e.AcceptedTextPrediction,!0),autoCorrectedErrors:this.ddb(e.AutoCorrectErrors,!0),currentPpType:this.ddb(e.CurrentPpType,!0),allPpTypes:this.ddb(e.AllPpTypes,!0)}}}Tr.ceo="PremiumPreviewSettingsChangedEvent";Object(y.a)(Tr,"PremiumPreviewSettingsHandler",Kv.a,[1177]);class AC{constructor(e,t,E,W,ha,Ka=null){this.ga=e;this.Sg=t;this.rHa=E;this.NSa=W;this.Glb=ha;this.bbh=!1;this.Pfd=(sb,dc)=>{if(!dc||
!dc.Cl)this.Sg.sendTraceTag(559255960,2250,10,"PremiumPreviewStateUpdater: premium preview data is null");else if(dc.Cl.state!==this.Cl.state||dc.Cl.currentPpType!==this.Cl.currentPpType)this.Cl=dc.Cl,this.WLj(this.Cl),this.HLo()};this.Gpl=()=>{if(1===this.Cl.state||5===this.Cl.state){const sb=Rv(this.Cl.startDate,this.dF(),this.Cl.totalDays,this.Glb.NTb(),this.Glb.SHf());this.Cl={...this.Cl,...sb};switch(this.Cl.state){case 2:case 5:this.Sg.sendTraceTag(559255963,2250,50,"Premium preview state check: preview expired");
this.NSa.setState(this.Cl.state);break;case 3:this.Sg.sendTraceTag(559255964,2250,10,"Premium preview state check: start date greater than current date");this.NSa.setState(this.Cl.state);break;case 1:this.Sg.sendTraceTag(559255965,2250,50,"Premium preview state check: days remaining updated",this.Cl.daysRemaining),this.NSa.jSo(this.Cl.daysRemaining)}this.WLj(this.Cl)}};this.dF=Ka?Ka:()=>new Date;this.Cl=this.NSa.Cl;this.a8m()}a8m(){this.rHa.Qon()?this.NSa.hKb(this.Pfd):this.Sg.sendTraceTag(559255959,
2250,10,"PremiumPreviewStateUpdater: premium preview update disabled")}WLj(e){this.Sg.sendTraceTag(559255961,2250,50,"Premium preview state change message sent");this.ga.Pb(Fa.a.TXb,2,e)}HLo(){1!==this.Cl.state||this.bbh||(this.bbh=!0,window.setInterval(this.Gpl,36E5),this.Sg.sendTraceTag(559255962,2250,50,"Premium preview state check initiated"))}}Object(y.a)(AC,"PremiumPreviewStateUpdater",null,[]);class Hy{constructor(e){this.Ga=e}UYi(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.FreeUserExperienceEnabled",
!1)}}Object(y.a)(Hy,"SimulateFreeUserGate",null,[]);var Ks=d(262),jn=d(1851);class RI{constructor(e,t,E,W){this.Re=e;this.Sg=t;this.wOk=E;this.MC=W}async initialize(){try{await this.MC.Pl(),this.Re.nb(this,jn.RoamingSettingAnnotation.getTypeName())}catch(e){this.Sg.sendTraceTag(0,2250,10,"Soft Paywall annotation registration failed.",e)}}lD(e,t){t!==sh.a.getTypeName()?this.Sg.sendTraceTag(0,2250,10,"Handled Soft Paywall Roaming Settings with wrong operation type",t):null!==e&&void 0!==e&&e.content&&
Ks.a.getTypeNameFor(e.content)===jn.RoamingSettingAnnotation.getTypeName()?(t=e.content,t.settingValueJson?(e=JSON.parse(t.settingValueJson),this.wOk.updateAndPersistState(e),this.Sg.sendTraceTag(0,383,50,"SoftPaywall annotation initialized "+JSON.stringify(e))):this.Sg.sendTraceTag(0,2250,10,"Handled Soft Paywall Roaming Settings annotation setting is invalid",e)):this.Sg.sendTraceTag(0,2250,10,"Handled Soft Paywall Roaming Settings annotation is invalid",e)}}Object(y.a)(RI,"SoftPaywallAnnotationHandler",
null,[223]);class Hh{constructor(e,t,E,W){this.WFh=e;this.XFh=t;this.iHa=E;this.Sg=W;this.initialCredits=20;this.isEnabled=!1;this.P9e=0}updateAndPersistState(e){this.softPaywallData=this.odp(e)}get softPaywallData(){return{credits:this.credits,receivedCredits:this.receivedCredits,receivedCreditsDate:this.receivedCreditsDate,isEnabled:this.isEnabled}}set softPaywallData(e){this.credits=e.credits;this.receivedCredits=e.receivedCredits;this.receivedCreditsDate=e.receivedCreditsDate}spendCredit(){0>=
this.credits?this.Sg.sendTraceTag(512234826,2250,10,"Spend credits are called with no credits left",this.softPaywallData):(this.P9e++,this.credits--,this.WFh.NLj(),this.iHa.rua(Fa.a.hap,!0,null,null,null,null,[{...(new yi.a),name:"newData",string:JSON.stringify(this.softPaywallData)}]))}odp(e){let t={...e},E=!1;this.XFh.m3o(e)&&(t=this.QCo(e),E=!0);this.P9e&&(0<t.credits&&(t.credits--,E=!0),this.P9e--);E&&this.WFh.CPo(t);return t}QCo(e){const t={credits:this.initialCredits,receivedCredits:this.initialCredits,
receivedCreditsDate:this.XFh.tWj(),isEnabled:this.isEnabled};this.iHa.rua(Fa.a.Ezp,!0,null,null,null,null,[{...(new yi.a),name:"oldData",string:JSON.stringify(e)},{...(new yi.a),name:"newData",int64:JSON.stringify(t)}]);return t}}Object(y.a)(Hh,"SoftPaywallState",null,[]);class mC{constructor(e,t){this.Ga=e;this.jBb=t}async isEnabled(){if(!this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.EditorSoftPaywallEnabled",!1))return!1;try{return!(await this.jBb.zUb).Cad}catch(e){return!1}}}
Object(y.a)(mC,"SoftPaywallGate",null,[1175]);var Tv=d(416),Uv=d(396);class kG{constructor(e,t,E,W){this.Re=e;this.Sg=t;this.MC=E;this.QY=W;this.Ank="SoftPaywall";this.cDh=10014}CPo(e){e=new jn.RoamingSettingsWriteSignal({id:this.cDh,valueJson:JSON.stringify(e),settingType:jn.RoamingSettingType.Dictionary});const t=new Tv.a;t.body=e;e=Object.assign(new sh.a,{parentPath:["Signal",jn.RoamingSettingsWriteSignal.getTypeName()],items:[t]});this.x1d(e)}NLj(){var e=new jn.RoamingSettingsReadSignal({ids:[this.cDh]});
const t=new Tv.a;t.body=e;e=Object.assign(new sh.a,{parentPath:["Signal",jn.RoamingSettingsReadSignal.getTypeName()],items:[t]});this.x1d(e)}async x1d(e){try{await this.MC.Pl(),this.fef(e)}catch(t){this.Sg.sendTraceTag(0,2250,10,"EnsureAugLoopRuntimeManager exception.",t)}}async fef(e){try{await this.Re.activateAnnotation(jn.RoamingSettingAnnotation.getTypeName(),this.Ank),this.QY.getAugLoopRuntimeManager().submitOperation(Object.assign(new Uv.a,{operation:e}))}catch(t){this.Sg.sendTraceTag(0,2250,
10,"Activating RoamingSettingAnnotation threw exception.",t)}}}Object(y.a)(kG,"SoftPaywallSignalSender",null,[1174]);class Bo{tWj(){var e=new Date;return 100*e.getFullYear()+e.getMonth()+1}m3o(e){return null!==e&&void 0!==e&&e.receivedCreditsDate?Number(e.receivedCreditsDate)<this.tWj():!0}}Object(y.a)(Bo,"SoftPaywallUtils",null,[1173]);class Iy extends za.a{constructor(){super(...arguments);this.W=null}get name(){return"WordEditor.EditorUpsell"}ifa(e){this.W=e;this.W.ia("WordEditor.Ideas.AddInLoader.IAddInLicensingManager",
()=>new XA(this.W.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),v.AFrameworkApplication.K,new ua.a)).ha();this.W.ia("WordEditor.EditorUpsell.IPremiumPreviewGate",()=>new gu(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).ha();this.W.ia("WordEditor.EditorUpsell.ISimulateFreeUserGate",()=>new Hy(this.W.resolve("Common.IAppSettingsManager"))).ha();this.W.ia("WordEditor.EditorUpsell.IUpsellCampaignGate",()=>new Iz(this.W.resolve("Common.IAppSettingsManager"))).ha();
this.W.ia("WordEditor.EditorUpsell.IPremiumPreviewSettingsHandler",()=>new Tr(this.W.resolve("Box4.IRoamingServiceRequestManager"),this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"),this.W.resolve("Common.IAppSettingsManager"),new ua.a,this.W.resolve("Common.IUlsWrapper"))).ha();this.W.ia("WordEditor.EditorUpsell.PremiumPreviewDataHandler",()=>new Sv(this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewSettingsHandler"),this.W.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate"),this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),
new ua.a,this.W.resolve("Common.IUlsWrapper"),this.W.resolve("Wac.Common.Utils.IOtelWrapper"))).as("WordEditor.EditorUpsell.IPremiumPreviewDataProvider").as("WordEditor.EditorUpsell.IPremiumPreviewDataUpdater").as("WordEditor.EditorUpsell.IPremiumPreviewDataHandler").as("WordEditor.EditorUpsell.IPremiumPreviewAPI").ha();this.W.ia("WordEditor.EditorUpsell.PremiumPreviewCritiquesFilter",()=>new fu(this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),new ua.a,this.W.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).as("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter").ha();
this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter");this.W.register(AC,"WordEditor.EditorUpsell.PremiumPreviewStateUpdater").ha().Rd(()=>new AC(v.AFrameworkApplication.va,this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataHandler"),this.W.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate"))).ha();this.W.ia("WordEditor.Ideas.EditorUpsell.BxPromoSettingsHandler",()=>new YA(this.W.resolve("Box4.IRoamingServiceRequestManager"),
e.resolve("Box4.RoamingSetting.IRoamingSettingCache"),this.W.resolve("Common.IAppSettingsManager"),new ua.a,this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Ideas.EditorUpsell.IBxPromoSettingsUpdater").as("WordEditor.Ideas.EditorUpsell.IBxPromoSettingsReader").ha();this.W.ia("WordEditor.Ideas.EditorUpsell.IBxPromoGate",()=>new yC(this.W.resolve("Common.IAppSettingsManager"))).ha();this.W.ia("WordEditor.EditorUpsell.ISoftPaywallGate",()=>new mC(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).ha();
this.W.ia("WordEditor.EditorUpsell.SoftPaywallUtils",()=>new Bo).ha();this.W.ia("WordEditor.EditorUpsell.SoftPaywallSignalSender",()=>new kG(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).ha();this.W.ia("WordEditor.EditorUpsell.ISoftPaywallData",()=>new Hh(this.W.resolve("WordEditor.EditorUpsell.SoftPaywallSignalSender"),this.W.resolve("WordEditor.EditorUpsell.SoftPaywallUtils"),
this.W.resolve("Wac.Common.Utils.IOtelWrapper"),this.W.resolve("Common.IUlsWrapper"))).ha();this.W.ia("WordEditor.EditorUpsell.SoftPaywallAnnotationHandler",()=>new RI(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"))).ha()}async kfa(){var e=this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),t=this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallGate"),
E=this.W.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager");E.R5m();var W=this.W.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate");e=await e.b0f();t=await t.isEnabled();nj.a.aTb&&t?(await this.aVf(),this.H5m(E,t)):nj.a.aTb&&(e||W.NTb())?(W=this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewSettingsHandler"),this.W.resolve("WordEditor.EditorUpsell.PremiumPreviewStateUpdater"),await this.aVf(),W=await W.$bd(),this.D7c(W),E=await E.zUb,this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter").DRi(E)):
this.aVf()}aVf(){this.W.resolve("WordEditor.Ideas.EditorUpsell.IBxPromoGate").isEnabled()&&this.W.resolve("WordEditor.Ideas.EditorUpsell.BxPromoSettingsHandler").$bd()}D7c(e){this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataUpdater").D7c(e)}H5m(e,t){this.W.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(async E=>{if(E.isFreemiumUpsellEnabled()){E=this.W.resolve("WordEditor.EditorUpsell.SoftPaywallSignalSender");var W=this.W.resolve("WordEditor.EditorUpsell.SoftPaywallAnnotationHandler"),
ha=this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),Ka=this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData");W.initialize();this.D7c({currentPpType:4});W=await e.zUb;ha.DRi(W,t);Ka.isEnabled=!0;E.NLj()}})}jfa(){}static main(){x.a.instance.Jc(new Iy)}}Object(y.a)(Iy,"WordEditorEditorUpsellPackage",za.a,[]);var $A=d(857);class Jy{constructor(e,t,E){this.ga=e;this.Sg=t;this.X3a=E;this.zi=null;this.Reh={["id"]:Jy.YQg,["bodyControls"]:{["id"]:Jy.YQg,["isModal"]:!0,["isBlocking"]:!1,
["dialogType"]:0}};this.G5n=()=>{try{this.zi=this.TAm(),this.zi.Gd=5,this.Reh.bodyControls.dialogType=4,this.zi.pi("",this.Pza,this.Reh)}catch(W){this.Sg.sendTraceTag(542749407,2250,10,`Upsell share dialog failed to open. Error message: ${W.message}, error stack trace ${W.stack}`);return}this.X3a.Vw(Fa.a.V4n,!0)};this.Pza=W=>{this.X3a.rua(Fa.a.qtl,!0,null,null,null,null,[{...(new yi.a),name:"ClosedWithDialogButtonType",string:$A.a[W]}]);this.ga.Pb(Fa.a.Adb,2,"tell-a-friend-button")};this.ga.ra(Fa.a.DXm,
na.a.view,this.G5n)}dispose(){this.zi&&this.zi.dispose()}TAm(){return new bk.a(!1,!1,!0)}}Jy.YQg="GenericDialog";Object(y.a)(Jy,"UpsellCampaignActor",null,[]);class BC extends za.a{constructor(){super(...arguments);this.NJh=this.W=null}get name(){return"WordEditor.UpsellCampaign"}ifa(e){this.W=e}kfa(){const e=this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewAPI"),t=this.W.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate");this.NJh=new Jy(v.AFrameworkApplication.va,this.W.resolve("Common.IUlsWrapper"),
this.W.resolve("Wac.Common.Utils.IOtelWrapper"));t.thn()&&(e.start(2),this.W.resolve("Wac.Common.Utils.IOtelWrapper").Vw(Fa.a.W4n,!0))}jfa(){this.NJh.dispose()}static main(){(new Iz(v.AFrameworkApplication.K)).NTb()&&x.a.instance.Jc(new BC)}}Object(y.a)(BC,"WordEditorUpsellCampaignPackage",za.a,[]);class yv{constructor(){this.qx=(new ge.a).Mc(15);const e=Cc.StaticActiveAppFrame.za().ib.$c;this.qx.Ab(e)}dispose(){this.qx.dispose()}}Object(y.a)(yv,"AutomationTransaction",null,[13]);const JG=()=>ob.a.instance.resolve("WordEditor.Extension.DocumentFactory").create();
var aB=d(2231),KG=d(2179),SI=d(2181),sE=d(1945),oK=d(244),Ju=d(347),Ku=d(576),bB=d(1624),Ex=d(1118),LG=d(365),Kz=d(1932),MG=d(760),si=d(1561);class Fx extends si.a{constructor(e,t,E,W){super();this.pB=e;this._context=t;this.Co=E;this.Re=W}get content(){return void 0===this.pB.content||null===this.pB.content?{}:this.pB.content}get id(){return this.pB.id}get _ReferenceId(){return this.gr?this.Gr:null}get _State(){return void 0===this.pB.content||null===this.pB.content||void 0===this.pB.content.M_||
null===this.pB.content.M_||void 0===this.pB.content.M_.state||null===this.pB.content.M_.state?0:this.pB.content.M_.state}set _State(e){void 0!==this.pB.content&&null!==this.pB.content&&void 0!==this.pB.content.M_&&null!==this.pB.content.M_||vc.a.ng();this.pB.content.M_.state=e;this.Re.fFa(this.pB,e)}deleteObject(){this.DUb();const e=Object(Ne.a)(MG.a,this.pB.parent);e||vc.a.ng();e.deleteAnnotation(this.pB.content);this._State=70}getParentAsAnnotation(){this.DUb();if(3===this.pB.tXb&&this.pB.parent)return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Fx(this.pB.parent,
this._context,this.Co,this.Re));vc.a.ng();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getParentAsParagraph(){this.DUb();if(2===this.pB.tXb&&this.pB.parent)return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.Co.create(this.pB.parent,this._context));vc.a.ng();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getParentType(){this.DUb();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.pB.tXb)}_KeepReference(){this.Wq()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.Annotation"}invokePropertyGet(e){switch(e){case 1:return this.content;
case 2:return this.id;case 3:return this._ReferenceId;case 4:return this._State}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 4:this._State=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,
t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1006:return this.yF(t);case 1001:return this.ri();case 1002:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1005:return this.QEm();case 1004:return this.REm();case 1003:return this.$Em()}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}yF(){this.deleteObject();return null}QEm(){return this.getParentAsAnnotation()}REm(){return this.getParentAsParagraph()}$Em(){return this.getParentType()}ri(){this._KeepReference();
return null}si(){this._OnAccess();return null}DUb(){this.pB.U9c||(this._context.An.BF(),this._context.An.yv(),this.pB=this.Re.DUb(this.pB.id),this.pB.U9c||vc.a.ng())}}Object(y.a)(Fx,"Annotation",si.a,[1143]);class no{constructor(e,t,E){this.LJe=this.Al=-1;this.fq=E;0<e&&(this.Al+=e);this.LJe=0<t?e+t<this.fq.length()?e+t:this.fq.length():this.fq.length()}get_current(){return this.Al<this.LJe?this.fq._GetItem(this.Al):null}moveNext(){const e=this.Kpp();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Kpp(){this.Al++;
return this.Al<this.LJe?!0:!1}}Object(y.a)(no,"ElementEnumerator",null,[1244]);class NG extends si.a{constructor(e,t,E,W){super();this.SY=this.XMc=null;this.Bnk=e;this._context=t;this.Re=E;this.Co=W;E.nb(this,e)}length(){return this.XMc.count}get _ReferenceId(){return this.gr?this.Gr:null}getFirst(){const e=this.getFirstOrNullObject();e||vc.a.hl();return e}getFirstOrNullObject(){return!this.XMc||0>=this.length()?null:this.getItem(0)}getItem(e){return this._GetItem(e)}refresh(){this._context.An.BF();
this._context.An.yv();return this.Re.getAnnotationsByType(this.Bnk).then(e=>{this.Vhd(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)})}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,t){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.AnnotationCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.nI();case 1004:return this.oI();case 1:return this.P_(t);case 1001:return this.ri();case 1002:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){switch(e){case 1005:return this.Uro()}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}P_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this.getItem(e)}Uro(){return this.refresh()}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}lD(e,t){try{const E=new Fx(e,this._context,this.Co,this.Re);E.Wq();this.Wq();
t===sh.a.getTypeName()?OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(this._ReferenceId,4,E._ReferenceId):this.SY&&t===jE.a.getTypeName()?(this.SY.Z(e.id,E),OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(this._ReferenceId,5,E._ReferenceId)):t===Ex.a.getTypeName()&&OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(this._ReferenceId,6,E._ReferenceId);e.annotationType===LG.a.getTypeName()&&this.Ntp(e,t)}catch(E){Kz.a.mcd(E,[e],!1)}}Ntp(e,t){t===sh.a.getTypeName()?
Kz.a.mzb(e,32):t===Ex.a.getTypeName()&&Kz.a.mzb(e,64)}_GetItem(e){let t=null;"number"===typeof e?e<this.length()&&(t=this.XMc.J(e)):"string"===typeof e&&(t=e);if(t&&this.SY.mb(t))return this.SY.J(t);vc.a.qd();return null}Vhd(e){this.SY=new gf.a;this.XMc=new fa.a;if(e)for(const t of e)this.XMc.add(t.id),this.SY.add(t.id,new Fx(t,this._context,this.Co,this.Re))}}Object(y.a)(NG,"AnnotationCollection",si.a,[223,1143,1215]);class cB{constructor(e,t){this.Re=e;this.Co=t}create(e,t){return new NG(e,t,this.Re,
this.Co)}}Object(y.a)(cB,"AnnotationCollectionFactory",null,[]);var yq=d(676);class hu{constructor(e,t,E){this.Tyc=e;this.wNo=t;this.yA=E}zEl(e,t){var E;this.gDp(e,t);var W=e.node;const ha=yu.a.GL(W),Ka=W.ja(fd.a.Tj,0);0===Ka&&(z.ULS.sendTraceTag(508863365,369,10,"AppId:{0}, cannot read paragraph textId.",t.appId),vc.a.ng());const sb=e.lk,dc=e.Ep-sb;if(0>=dc)z.ULS.sendTraceTag(508859913,369,50,"AppId:{0}, range length must be positive.",t.appId);else{var xc=new fa.a;xc.add(e);this.wNo.select(xc,1);
W=null===(E=W.characterData)||void 0===E?void 0:E.substring(sb,sb+dc);E=Object.assign(new sh.a,{parentRevId:Ka.toString(),parentPath:ha.split("\\"),sourceTimestamp:Date.now(),items:[Object.assign(new Tv.a,{id:this.gBm(),body:Object.assign(new yq.AddInTextAnnotation,{id:Rd.a.create().toString(),priority:1,context:W,startInContext:0,categoryName:hu.Lfc,suggestions:[],range:{start:sb,length:dc}})})]});this.Tyc.submitOperation(E);E={};E.contextId=e.contextId==na.a.Bd?"textRange":"paragraph";E.AppId=null===
t||void 0===t?void 0:t.appId;z.ULS.sendTraceTag(508863364,369,50,qe.c(E))}}gDp(e,t){e.contextId!=na.a.Bd&&e.contextId!=na.a.paragraph&&e.contextId!=na.a.Vc&&(z.ULS.sendTraceTag(508863366,369,15,"AppId:{0}, node must be textRange or paragraph.",t.appId),vc.a.qd())}gBm(){const e=hu.lsk+hu.Xch.toString();hu.Xch++;return e}aQl(e,t){if(e)for(const E of e)if(E.contextId!=na.a.Bd&&E.contextId!=na.a.paragraph)z.ULS.sendTraceTag(508847651,369,50,"Skipping non-text context {0} for addin {1]",na.a[E.contextId],
t.appId);else if(e=yu.a.GL(E.node),e=this.yA.kHf(e))for(const W of e)W.content.categoryName===hu.Lfc&&this.yA.WUa(W,!1)}}hu.Xch=1;hu.lsk="#CP";hu.Lfc="CopilotHighlight";Object(y.a)(hu,"AnnotationOperations",null,[1311]);class TI{constructor(e,t,E){this.sVl=1;this.rVl=2;this.Ch=t;this.A9=E;this.zB=e}getAppRuntimeStartState(){const e=this.A9.KVa(this.zB);return this.Ch.nHf(e)==zk.background?1:0}setAppRuntimeStartState(e){const t=this.A9.KVa(this.zB);this.Ch.BMj(t,1==e?zk.background:zk.Dbe)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case this.rVl:return this.eim();case this.sVl:return this.JQo(t)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}eim(){return this.getAppRuntimeStartState()}JQo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.setAppRuntimeStartState(e);return null}}Object(y.a)(TI,"AppRuntimePersistenceService",null,[]);class OG{constructor(e,t){this.o1=e;this.A9=t}create(e,t){return new TI(t,this.o1,this.A9,e)}}Object(y.a)(OG,"AppRuntimePersistenceServiceFactory",null,[]);class zq{constructor(e,
t,E){this.Ch=t;this.A9=E;this.zB=e}getAppRuntimeState(){const e=this.A9.KVa(this.zB);return this.Ch.CU(e)?2:1}setAppRuntimeState(e){const t=this.A9.KVa(this.zB);2===e?(e=this.Ch.S9d(t),e.isForUILessAction=!1,this.Ch.showTaskPane(t,null,e)):1===e&&this.Ch.tUa(t)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 2:return this.fim();case 1:return this.KQo(t)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}fim(){return this.getAppRuntimeState()}KQo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"int");this.setAppRuntimeState(e);return null}}Object(y.a)(zq,"AppRuntimeService",null,[]);class Gx{constructor(e,t){this.o1=e;this.A9=t}create(e,t){return new zq(t,this.o1,this.A9,e)}}Object(y.a)(Gx,"AppRuntimeServiceFactory",null,[]);var UI=d(1927);class PG{constructor(){this.S9g=this.Ggb=null;this.T9g=0;this.LJh=this.QQc=null;this.Mnh=!1}get appId(){return this.Ggb}set appId(e){this.Ggb=e}get authority(){return this.S9g}set authority(e){this.S9g=e}get authorityType(){return this.T9g}set authorityType(e){this.T9g=
e}get isAnonymous(){return this.Mnh}set isAnonymous(e){this.Mnh=e}get tenantId(){return this.QQc}set tenantId(e){this.QQc=e}get upn(){return this.LJh}set upn(e){this.LJh=e}getTypeName(){return"Microsoft.Authentication.AuthContext"}invokePropertyGet(e){switch(e){case 4:return this.appId;case 2:return this.authority;case 3:return this.authorityType;case 5:return this.isAnonymous;case 6:return this.tenantId;case 1:return this.upn}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 4:this.appId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 2:this.authority=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 3:this.authorityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return;case 5:this.isAnonymous=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"boolean");return;case 6:this.tenantId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 1:this.upn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}E7l(e){this.upn=e.upn;this.authority=e.authority;this.authorityType=e.authorityType;this.tenantId=e.tenantId;this.isAnonymous=e.isAnonymous}}Object(y.a)(PG,"AuthContext",null,[]);var Lu=d(1657),tE;(function(e){e[e.unknown=-1]="unknown";e[e.Xeq=0]="organizationAccount";e[e.E7p=1]="microsoftAccount"})(tE||(tE={}));Object(y.b)("IdentityType",tE);class uE{constructor(){this.Mhh=this.ugh=
this.gxa=null;this.SIc=0}get displayName(){return this.gxa}set displayName(e){this.gxa=e}get email(){return this.ugh}set email(e){this.ugh=e}get federationProvider(){return this.Mhh}set federationProvider(e){this.Mhh=e}get identityType(){return this.SIc}set identityType(e){this.SIc=e}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(e){switch(e){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}static UFl(e){const t=new uE;t.displayName=e.displayName;t.email=e.email;switch(e.authority){case "MicrosoftAccount":t.identityType=
1;break;default:t.identityType=0}t.federationProvider="";return t}}Object(y.a)(uE,"OfficeIdentityInfo",null,[]);class CC{constructor(e,t,E){this.IH=null;this._id=e;this._value=t;this.Kk=E}get id(){return this._id}get value(){return this._value}set value(e){}getTypeName(){return"Microsoft.Authentication.RoamingSetting"}invokePropertyGet(e){switch(e){case 1:return this.id;case 2:return this.value}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 2:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"any");this.IH=t[0].toString();return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromise((E,W)=>{if(1===this.Kk){let ha,Ka;try{ha=ob.a.instance.resolve("WordEditor.TranscriptionRoamingServiceManager"),
Ka=ob.a.instance.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn"),Object(zg.b)()?Object(zg.a)(2,()=>ha.BSc(parseInt(this.IH)),!1,()=>!0).then(()=>{Ka.kAj();E(null)}).catch(sb=>{z.ULS.sendTraceTag(528859142,3011,10,"ADD Call for Transcription File Upload Minutes Failed With Exception: {0}",sb);W(sb)}):ha.BSc(parseInt(this.IH)).then(()=>{Ka.kAj();E(null)}).catch(sb=>{W(sb)})}catch(sb){W(sb)}}else 0===this.Kk?(ob.a.instance.resolve("WordEditor.TranslatorRoamingServiceManager").AJj(this.IH),
E(null)):W(null)})}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(y.a)(CC,"RoamingSetting",null,[]);class Ky{getItem(e){let t,E;if("ridTranscriptionQuotaMinutesUsed"===e)return OfficeExtension.WacRuntime.Utility.createPromise(W=>{Object(zg.b)()?Object(zg.a)(2,()=>ob.a.instance.resolve("WordEditor.TranscriptionRoamingServiceManager").y9a(),
!0,()=>!0).then(ha=>{t=ha.toString();E=1;W(new CC(e,t,E))}).catch(ha=>{z.ULS.sendTraceTag(528859141,3011,10,"GET Call for Transcription File Upload Minutes Failed With Exception: {0}",ha)}):ob.a.instance.resolve("WordEditor.TranscriptionRoamingServiceManager").y9a().then(ha=>{t=ha.toString();E=1;W(new CC(e,t,E))})});t=ob.a.instance.resolve("WordEditor.TranslatorRoamingServiceManager").A0a;E=0;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new CC(e,t,E))}getItemOrNullObject(){return null}getTypeName(){return"Microsoft.Authentication.RoamingSettingCollection"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1:return this.P_(t);case 2:return this.t9a(t)}e=
this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}P_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItem(e)}t9a(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItemOrNullObject(e)}}Object(y.a)(Ky,"RoamingSettingCollection",null,[]);class Lt{static get Fli(){return Lt.Muk}static Ffa(e){return e in Lt.Fli?Lt.Fli[e].toString():e}}Lt.map=null;Lt.Muk={["GeneralException"]:WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_GeneralException,
["AccessDenied"]:WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_AccessDenied,["ApiNotAvailable"]:WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_ApiNotAvailable,["UserNotSignedIn"]:WordEditorIntl.WordEditorStrings.L_UserNotSignedIn,["UserAborted"]:WordEditorIntl.WordEditorStrings.L_UserAborted,["UnsupportedUserIdentity"]:WordEditorIntl.WordEditorStrings.L_UnsupoortedUserIdentity,["InvalidResourceUrl"]:WordEditorIntl.WordEditorStrings.L_InvalidResourceUrl,["InvalidGrant"]:WordEditorIntl.WordEditorStrings.L_InvalidGrant,
["AddinIsAlreadyRequestingToken"]:WordEditorIntl.WordEditorStrings.L_SSOAddinIsAlreadyRequestingToken,["ResourceNotAllowed"]:WordEditorIntl.WordEditorStrings.L_SSOResourceNotAllowed,["ClientError"]:WordEditorIntl.WordEditorStrings.L_SSOClientError,["ServerError"]:WordEditorIntl.WordEditorStrings.L_SSOServerError};Object(y.a)(Lt,"SingleSignOnErrorCodeMap",null,[]);class vE{constructor(e,t){this.vwd=e;this.SIc=t}get accessToken(){return this.vwd}set accessToken(e){this.vwd=e}get tokenIdenityType(){return this.SIc}set tokenIdenityType(e){this.SIc=
e}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(e){switch(e){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 3:this.tokenIdenityType=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(y.a)(vE,"SingleSignOnToken",
null,[]);class dB{constructor(e,t,E,W){this.Ch=t;this.zB=e;this._context=W}get roamingSettings(){if(!this.Ch.au.getOsfControl(this.zB).isFirstParty())throw OfficeExtension.WacRuntime.Utility.createRichApiException(Lu.a.MJb,Lt.Ffa(Lu.a.MJb));return new Ky}getAccessToken(e){const t=this.Ch.au,E=t.getOsfControl(this.zB),W=E.getManifest(),ha=W.getMarketplaceID(),Ka=W.getMarketplaceVersion();this.OX(e,ha,Ka);return OfficeExtension.WacRuntime.Utility.createPromise((sb,dc)=>{t._enableFirstPartySSO?E.isFirstParty()&&
this.ben(W,e)?(this._context.An.BF(),ob.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(e,ha).then(xc=>{this._context.An.yv();sb(xc)},xc=>{this._context.An.yv();dc(xc.toString())})):dc(Lu.a.MJb):dc(Lu.a.kif)}).then(sb=>{let dc;switch(sb.authority){case UI.a.D4n:dc=1;break;default:dc=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new vE(sb.accessToken,dc))},sb=>{this.MCn(e,ha,sb);return sb?OfficeExtension.WacRuntime.Utility.createPromise((dc,xc)=>
{xc(OfficeExtension.WacRuntime.Utility.createRichApiException(sb,Lt.Ffa(sb)))}):OfficeExtension.WacRuntime.Utility.createPromise((dc,xc)=>{xc(OfficeExtension.WacRuntime.Utility.createRichApiException(Lu.a.N8a,Lt.Ffa(Lu.a.N8a)))})})}getAuthContext(){const e=this.Ch.au.getOsfControl(this.zB).getManifest(),t=e.getMarketplaceID(),E=e.getWebApplicationId();return OfficeExtension.WacRuntime.Utility.createPromise((W,ha)=>{this._context.An.BF();ob.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(t).then(Ka=>
{this._context.An.yv();W(Ka)},Ka=>{this._context.An.yv();ha(Ka.toString())})}).then(W=>{const ha=new PG;ha.E7l(W);ha.appId=E;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ha)},W=>W?OfficeExtension.WacRuntime.Utility.createPromise((ha,Ka)=>{Ka(OfficeExtension.WacRuntime.Utility.createRichApiException(W,Lt.Ffa(W)))}):OfficeExtension.WacRuntime.Utility.createPromise((ha,Ka)=>{Ka(OfficeExtension.WacRuntime.Utility.createRichApiException(Lu.a.N8a,Lt.Ffa(Lu.a.N8a)))}))}getPrimaryIdentityInfo(){const e=
this.Ch.au.getOsfControl(this.zB).getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((t,E)=>{this._context.An.BF();ob.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(e).then(W=>{this._context.An.yv();t(W)},W=>{this._context.An.yv();E(W.toString())})}).then(t=>{t=uE.UFl(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},t=>t?OfficeExtension.WacRuntime.Utility.createPromise((E,W)=>{W(OfficeExtension.WacRuntime.Utility.createRichApiException(t,
Lt.Ffa(t)))}):OfficeExtension.WacRuntime.Utility.createPromise((E,W)=>{W(OfficeExtension.WacRuntime.Utility.createRichApiException(Lu.a.N8a,Lt.Ffa(Lu.a.N8a)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(e){switch(e){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1:return this.Rfm(t);case 3:return this.rim();case 2:return this.FGm()}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Rfm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,Kl);return this.getAccessToken(e)}rim(){return this.getAuthContext()}FGm(){return this.getPrimaryIdentityInfo()}ben(e,
t){let E=!1;const W=e.getWebApplicationAuthorizations();e=null;for(const sb of W)if(sb.getResource().toLowerCase()===t.resource.toLowerCase()){e=sb;E=!0;break}if(!E){var ha="";for(var Ka of W)ha+=this.mdg(Ka.getResource().toLowerCase())+",";ha=ha.substring(0,ha.length-1);z.ULS.sendTraceTag(39362643,369,50,"{0}",qe.c({["event"]:"AuthenticationService::IsAuthorizationDeclared",["authsLength"]:W.length,["resources"]:ha}));return!1}Ka=t.scope.split(" ,+");for(ha of Ka)if(""!==ha){Ka=!1;for(const sb of e.getScopes())ha.toLowerCase()===
sb.toLowerCase()&&(Ka=!0);if(!Ka)return!1}return!0}OX(e,t,E){e=this.mdg(e.resource);z.ULS.sendTraceTag(39102240,369,50,"{0}",qe.c({["manifestId"]:t,["manifestVersion"]:E,["resource"]:e}))}MCn(e,t,E){e=this.mdg(e.resource);z.ULS.sendTraceTag(39102241,369,10,"{0}",qe.c({["manifestId"]:t,["resource"]:e,["error"]:E}))}mdg(e){return(e?e:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(y.a)(dB,"AuthenticationService",null,[]);class rt{constructor(e,t){this.o1=e;this.Hia=
t}create(e,t){return new dB(t,this.o1,this.Hia,e)}}Object(y.a)(rt,"AuthenticationServiceFactory",null,[]);class ar extends si.a{constructor(e){super();vc.a.yz(e,"FieldCollection");this.Y6b=e}length(){return this.Y6b.count}get _ReferenceId(){return this.gr?this.Gr:null}getFirst(){const e=this.getFirstOrNullObject();e||vc.a.hl();return e}getFirstOrNullObject(){return this.Y6b&&this.Y6b.count?this.Y6b.J(0):null}getByTypes(e){const t=new fa.a;for(const E of this.Y6b)for(const W of e)if(E.type===W){t.add(E);
break}return new ar(t)}_GetItem(e){e=vc.a.KS(e);if(0<=e&&e<this.length())return this.Y6b.J(e);vc.a.qd();return null}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,t){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.FieldCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.nI();case 1004:return this.oI();case 1:return this.NY(t);case 1002:return this.ri();case 1001:return this.si();case 1005:return this.KHf(t)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}NY(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}KHf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<int>");return this.getByTypes(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(ar,"FieldCollection",
si.a,[1143,1215]);class np extends si.a{constructor(e){super();vc.a.yz(e,"InlinePictureCollection");this.lJc=e}length(){return this.lJc.count}get _ReferenceId(){return this.gr?this.Gr:null}getFirst(){const e=this.getFirstOrNullObject();e||vc.a.hl();return e}getFirstOrNullObject(){vc.a.fj()||vc.a.il();return!this.lJc||0>=this.lJc.count?null:this.lJc.J(0)}_GetItem(e){e=vc.a.KS(e);if(e<this.length())return this.lJc.J(e);z.ULS.sendTraceTag(16847771,369,10,"The index is out of the paragraph range.");vc.a.qd();
return null}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,t){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.InlinePictureCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.nI();case 1004:return this.oI();case 1:return this.NY(t);case 1001:return this.ri();case 1002:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}NY(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(np,"InlinePictureCollection",si.a,[1143,1215]);var Mt=d(1602),eB;(function(e){e[e.body=0]="body";e[e.Bra=1]="contentControl";e[e.RWp=2]="customProperty";e[e.paragraph=3]="paragraph";e[e.range=4]="range";e[e.table=5]="table";e[e.qv=6]="tableRow"})(eB||(eB={}));Object(y.b)("ObjectType",eB);class Ly extends si.a{constructor(e,
t,E,W,ha,Ka,sb){super();this.Z8b=this.Bjb=null;vc.a.yz(eB[e],"ListCollection.calledClassName");vc.a.yz(ha,"ListCollection.requestContext");this.mEc=e;this.En=t;this.Ze=E;this.jF=W;this._context=ha;this.Zn=Ka;this.jb=sb;this.jF&&this._context.Lad&&(this.Z8b=this.jF.s8c.create(this.jF.Fq))}length(){return this.Bjb.count}_GetItem(e){e=vc.a.KS(e);if(0<=e&&e<this.length())return this.Bjb.J(e);z.ULS.sendTraceTag(19772865,369,10,"The index is out of the boundary of list in class ListCollection.");vc.a.qd();
return null}get _ReferenceId(){return this.gr?this.Gr:null}getById(e){(e=this.getByIdOrNullObject(e))||vc.a.hl();return e}getByIdOrNullObject(e){if(!this.Bjb||!this.length())return null;for(let t=0;t<this.length();t++)if(this.Bjb.J(t).id===e)return this.Bjb.J(t);return null}getFirst(){const e=this.getFirstOrNullObject();e||vc.a.hl();return e}getFirstOrNullObject(){this.k7j();return this.Bjb&&this.length()?this.Bjb.J(0):null}getItem(e){e=vc.a.KS(e);return this.getById(e)}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,
t){this.k7j();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.ListCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1002:return this.l2c(t);case 1005:return this.m2c(t);case 1004:return this.nI();case 1006:return this.oI();case 1:return this.P_(t);case 1001:return this.ri();case 1003:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}l2c(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getById(e)}m2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getByIdOrNullObject(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}P_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this.getItem(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}k7j(){let e=null;switch(this.mEc){case 0:e=this.jb.SA(this.En,
!0,!1);break;case 1:e=this.Ze.TG();break;case 4:e=v.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")?this.jF.onc?this.jF.onc.Fq:this.Z8b?this.Z8b.Fq:this.jF.Fq:this.jF.Fq;break;default:z.ULS.sendTraceTag(19772866,369,15,"AppId:{0}, invalid object type to get the list collection.",this._context.appId)}this.Bjb=this.Zn.nti(e,this._context)}zkd(){v.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.Z8b&&(this.Z8b.exb(),this.Z8b=null)}}Object(y.a)(Ly,"ListCollection",
si.a,[1143,1215]);class Dt extends si.a{constructor(e){super();vc.a.yz(e,"NoteItemCollection");this.iMc=e}length(){return this.iMc.count}get _ReferenceId(){return this.gr?this.Gr:null}getFirst(){const e=this.getFirstOrNullObject();e||vc.a.hl();return e}getFirstOrNullObject(){return this.iMc&&this.iMc.count?this.iMc.J(0):null}_GetItem(e){e=vc.a.KS(e);if(0<=e&&e<this.length())return this.iMc.J(e);vc.a.qd();return null}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,t){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,
t,this))}getTypeName(){return"Microsoft.WordServices.NoteItemCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
t){switch(e){case 1003:return this.nI();case 1004:return this.oI();case 1:return this.NY(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}NY(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}ri(){this._KeepReference();
return null}si(){this._OnAccess();return null}}Object(y.a)(Dt,"NoteItemCollection",si.a,[1143,1215]);class Hx extends si.a{constructor(e){super();vc.a.yz(e,"ParagraphCollection");this.GQ=e}length(){return this.GQ.count}get _ReferenceId(){return this.gr?this.Gr:null}getFirst(){const e=this.getFirstOrNullObject();e||vc.a.hl();return e}getFirstOrNullObject(){vc.a.fj()||vc.a.il();return this.GQ&&this.GQ.count?this.GQ.J(0):null}getLast(){const e=this.getLastOrNullObject();e||vc.a.hl();return e}getLastOrNullObject(){vc.a.fj()||
vc.a.il();return this.GQ&&this.GQ.count?this.GQ.J(this.GQ.count-1):null}_GetItem(e){e=vc.a.KS(e);if(e<this.length())return this.GQ.J(e);z.ULS.sendTraceTag(16795330,369,10,"The index is out of the paragraph range.");vc.a.qd();return null}getById(e){(e=this.getByIdOrNullObject(e))||vc.a.hl();return e}getByIdOrNullObject(e){var t;if(!e||!this.GQ||!this.GQ.count)return null;const E=this.GQ.getEnumerator();for(;E.moveNext();){const W=E.get_current();if((null===(t=W.Lsa())||void 0===t?void 0:t.id.toString())===
e)return W}return null}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,t){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.ParagraphCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.nI();case 1005:return this.oI();case 1004:return this.xxm();case 1006:return this.Axm();case 1007:return this.l2c(t);case 1008:return this.m2c(t);case 1:return this.NY(t);case 1001:return this.ri();case 1002:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=
this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}xxm(){return this.getLast()}Axm(){return this.getLastOrNullObject()}l2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getById(e)}m2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getByIdOrNullObject(e)}NY(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"any");return this._GetItem(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(Hx,"ParagraphCollection",si.a,[1143,1215]);class Vv extends si.a{constructor(e,t,E,W,ha,Ka){super();this.Zac=this._tables=null;this.mEc=e;this.CLd=t;this.jF=E;this.Ze=W;this._context=ha;this.fd=Ka;this.jF&&this._context.Lad&&(this.Zac=this.jF.s8c.create(this.jF.Fq))}length(){return this._tables.count}get _ReferenceId(){return this.gr?this.Gr:null}getFirst(){const e=this.getFirstOrNullObject();
e||vc.a.hl();return e}getFirstOrNullObject(){this.A9j();return this._tables&&this.length()?this._tables.J(0):null}_GetItem(e){e=vc.a.KS(e);if(e<this._tables.count)return this._tables.J(e);z.ULS.sendTraceTag(19969492,369,10,"The index is out of the table collection range.");vc.a.qd();return null}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,t){this.A9j();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.TableCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.nI();case 1004:return this.oI();case 1:return this.NY(t);case 1001:return this.ri();case 1002:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}NY(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}A9j(){switch(this.mEc){case 0:case 5:this._tables=this.fd.ANm(this.CLd,this._context);break;case 1:var e=this.Ze.TG();this._tables=this.fd.KIi(e.J(0),
e.J(e.count-1),this._context);break;case 4:e=v.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")?this.jF.onc?this.jF.onc.Fq:this.Zac?this.Zac.Fq:this.jF.Fq:this.jF.Fq;this._tables=this.fd.KIi(e.J(0),e.J(e.count-1),this._context);break;default:z.ULS.sendTraceTag(19969493,369,15,"AppId:{0}, invalid object type to get the table collection.",this._context.appId)}}zkd(){v.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.Zac&&(this.Zac.exb(),this.Zac=null)}}
Object(y.a)(Vv,"TableCollection",si.a,[1143,1215]);class Lw extends si.a{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj,zl,Wl,Rh){super();vc.a.NPa(e,"Body");this.En=e;this._context=t;this.Co=E;this.$k=W;this.BC=ha;this.rO=Ka;this.sya=sb;this.Zc=dc;this.Noa=xc;this.jb=Rc;this.Qq=md;this.EB=ud;this.od=Ud;this.Yx=Id;this.$g=Ee;this.BB=kf;this.jx=Ke;this.$m=dh;this.fd=$h;this.Zn=rj;this.Ut=zl;this.RZ=Wl;this.Wx=Rh}get GWh(){return this.En}get contentControls(){if(vc.a.tFa){var e=
new Pm;e.types=[31];return this.getContentControls(e)}e=this.jb.SA(this.En,!0,!1);return 0>=e.count?null:this.$g.nlc(e.J(0),e.J(e.count-1),this._context)}get endnotes(){var e=new fa.a;switch(this.type){case 4:case 1:case 0:e.addRange(this.od.dkc(this.En,1));break;case 2:case 3:case 5:case 6:return null}e=this.od.iAa(e,this._context);return new Dt(e)}get fields(){const e=new fa.a;switch(this.En.type){case 8:case 10:case 36:case 16:case 38:case 37:const t=this.jb.Gv(this.En,!0,!1),E=t.count;for(let W=
0;W<E;W++){const ha=this.Wx.akc(t.J(W),this._context,!0);e.addRange(ha)}break;default:z.ULS.sendTraceTag(539530944,369,10,"AppId:{0}, in function Body.Fields, Body root graph node must be from one of Document/Section/Headfooter/TableCell/FootnoteEndnote.",this._context.appId),vc.a.ng()}return new ar(e)}get font(){return this.BC.create(0,this.En,null,null,this._context)}get footnotes(){var e=new fa.a;switch(this.type){case 4:case 1:case 0:e.addRange(this.od.dkc(this.En,0));break;case 2:case 3:case 5:case 6:return null}e=
this.od.iAa(e,this._context);return new Dt(e)}get inlinePictures(){var e=this.jb.Gv(this.En,!0,!1);let t=0;const E=new fa.a;for(const W of e){e=new fa.a;this.Yx.YKf(e,W);for(const ha of e)E.add(this.rO.create(ha,this._context,t++))}return new np(E)}get lists(){return vc.a.fj()?new Ly(0,this.En,null,null,this._context,this.Zn,this.jb):null}get paragraphs(){const e=this.jb.Gv(this.En,!0,!1);let t=0;const E=new fa.a;for(const W of e)E.add(this.Co.create(W,this._context,t++));return new Hx(E)}get parentBody(){if(!vc.a.fj())return null;
const e=this.parentBodyOrNullObject;e||vc.a.hl();return e}get parentBodyOrNullObject(){return vc.a.fj()?this.fd.QMf(this.En,this._context):null}get parentContentControl(){const e=this.parentContentControlOrNullObject;e||vc.a.hl();return e}get parentContentControlOrNullObject(){const e=Zd.a.create(this.Psa(!0)),t=Zd.a.create(this.Psa(!1));this.od.zPa(e,t);return this.$g.olc(e,t,this._context)}get parentSection(){if(!vc.a.fj())return null;const e=this.parentSectionOrNullObject;e||vc.a.hl();return e}get parentSectionOrNullObject(){if(!vc.a.fj())return null;
const e=this.Zc.jg(this.En);let t=null;switch(this.En.type){case 16:case 36:e.zb(10)&&(t=e.yp(10));break;case 10:t=this.En;break;case 8:1===e.Dq()&&(t=e.Xd())}return t?this.sya.create(t,this._context):null}get style(){const e=this.jb.SA(this.En,!0,!1);return this.EB.o3c(e)}set style(e){const t=this.jb.SA(this.En,!0,!1);this.EB.fxc(t,e)}get styleBuiltIn(){if(!vc.a.fj())return-1;const e=this.jb.SA(this.En,!0,!1);return this.EB.b7d(e)}set styleBuiltIn(e){vc.a.fj()||vc.a.il();const t=this.jb.SA(this.En,
!0,!1);this.EB.Mxe(t,e)}get tables(){return vc.a.fj()?new Vv(0,this.En,null,null,this._context,this.fd):null}get text(){let e="";switch(this.En.type){case 8:case 10:case 36:case 16:case 38:case 37:const t=this.jb.Gv(this.En,!0,!1),E=t.count;for(let W=0;W<E;W++)e+=this.jb.EXb(t.J(W)),W<E-1&&(e+=vc.a.Eqc);break;default:z.ULS.sendTraceTag(16814427,369,10,"AppId:{0}, in function Body.Text, Body root graph node must be from one of Document/Section/Headfooter/TableCell/FootnoteEndnote.",this._context.appId),
vc.a.ng()}return e}get type(){if(!vc.a.fj())return-1;switch(this.En.type){case 8:return 0;case 10:const e=this.Zc.jg(this.En);e.zb(8);e.ld(8);return 1===e.Dq()?0:1;case 36:switch(this.En.properties.getValue(fd.a.bmc)){case 0:case 2:case 1:return 2;case 3:case 5:case 4:return 3;default:return-1}case 16:return 4;case 38:return 0==this.od.w7(this.En)?5:6;case 37:return 1==this.En.getValue(fd.a.n7)?5:6;default:return-1}}get _ReferenceId(){return this.gr?this.Gr:null}clear(){const e=(new Date).getTime(),
t=this.jb.SA(this.En,!0,!1);vc.a.wBc(t,"Body.Clear");this.od.APa(t.J(0));this.od.APa(t.J(t.count-1));if(8===this.En.type&&1<Ld.GraphIterator.eb(this.En).Dq())return OfficeExtension.WacRuntime.Utility.createPromise((E,W)=>{this.od.Wql(t,this._context,E,W,e)});this.od.ELb(t);vc.a.xEf()||(5===this.type||6===this.type)&&this.insertText(" ",2);vc.a.vP("Body.Clear",vc.a.fQ(e));return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getComments(){if(0===this.type)return this.Ut.Sgm(this._context);
if(1===this.type)return this.Ut.hmm(this.En,this._context);const e=this.jb.SA(this.En,!0,!1);return this.Ut.T5d(e,this._context)}getContentControls(e){var t;e=null!==(t=null===e||void 0===e?void 0:e.types)&&void 0!==t?t:[];vc.a.C_c(e);t=this.$g.vMm(this.En,this._context);return 0===e.length?t:null===t||void 0===t?void 0:t.getByTypes(e)}getHtml(){const e=this.jb.SA(this.En,!0,!1);return this.jx.getHtml(e.toArray(),this._context)}getOoxml(){const e=(new Date).getTime();this._context.An.BF();return OfficeExtension.WacRuntime.Utility.createPromise((t,
E)=>{const W=this.jb.SA(this.En,!0,!1);this.jx.getOoxml(W,this._context,t,E,e)})}getReviewedText(e){let t="";switch(this.En.type){case 8:case 10:case 36:case 16:case 38:case 37:const E=this.jb.Gv(this.En,!0,!1),W=E.count;for(let ha=0;ha<W;ha++)t+=this.RZ.h9d(E.J(ha),e);break;default:z.ULS.sendTraceTag(545005571,369,10,"NodeType:{0} is not supported to get the reviewed text.",this.En.type)}return t}getRange(e){vc.a.fj()||vc.a.il();let t=new fa.a;e&&5!==e?1===e?t.add(Zd.a.create(this.Psa(!0))):2===
e||4===e?t.add(Zd.a.create(this.Psa(!1))):(z.ULS.sendTraceTag(18745291,369,15,"AppId:{0}, rangeLocation of Body.GetRange must be Start/End/Whole/Content/After.",this._context.appId),vc.a.qd()):t=this.jb.SA(this.En,!0,!1);this.$m.uxe(t);return(e=this.$m.Jjc(t,e))?this.$k.create(e,this._context):null}insertBreak(e,t){const E=(new Date).getTime(),W=new fa.a;this.od.L1f(this.En)&&6!==e&&vc.a.rC();switch(t){case 2:var ha=!1;e||(ha=!0);ha=this.jb.Zl(this.En,!0,ha);W.add(Zd.a.create(ha));break;case 3:ha=
this.Psa(!1);W.add(Zd.a.create(ha));break;default:z.ULS.sendTraceTag(17179034,369,15,"AppId:{0}, insertLocation of Body.InsertBreak must be Start or End.",this._context.appId),vc.a.qd()}6===e?this.od.zPa(W.J(0),W.J(0)):W.J(0).contextId!==na.a.table&&(ha=this.od.r7a(W.J(0).node,2===t),W.Z(0,ha));return OfficeExtension.WacRuntime.Utility.createPromise((Ka,sb)=>{this.od.insertBreak(W,e,t,this._context,Ka,sb,E)})}insertContentControl(e){vc.a.wBf(e,"Body");e=vc.a.Yrd(e,0);1!==e||vc.a.tFa||vc.a.qd();8!==
e||vc.a.jda||vc.a.qd();const t=this.od.Tfc(this.Psa(!0),!0),E=this.od.Tfc(this.Psa(!1),!1);return this.$g.Nqa(t,E,this._context,e)}insertFileFromBase64(e,t){"<"===e.charAt(0)&&(z.ULS.sendTraceTag(18130831,369,10,"invalid argument for insertFileFromeBase64 API in Body class.",this._context.appId),vc.a.qd());return this.Hla(e,t,!1)}insertHtml(e,t){const E=(new Date).getTime();let W=new fa.a;var ha=2;switch(t){case 2:case 3:ha=this.Psa(2===t);W.add(Zd.a.create(ha));ha=2===t?0:1;break;case 4:return W=
this.jb.SA(this.En,!0,!1),vc.a.wBc(W,"Body.InsertHtml"),this.clear().then(()=>this.insertHtml(e,2));default:vc.a.qd()}this.od.zPa(W.J(0),W.J(W.count-1),ha);return this.jx.insertHtml(W,e,t,E,this._context)}insertInlinePictureFromBase64(e,t){const E=(new Date).getTime();2!==t&&3!==t&&(z.ULS.sendTraceTag(17433734,369,50,"AppId:{0}, insert inline picture with none supported location in Body class",this._context.appId),vc.a.qd());const W=Zd.a.create(this.Psa(2===t));let ha=null;this.od.zPa(W,W);({ML:ha}=
this.od.nN(W,W,t));let Ka;this.od.GW((Ka=new fa.a,Ka.add(ha),Ka),t,0);return this.Yx.eSb(e,ha,this._context).then(sb=>{this._context.An.yv(this.En);if(!sb)return z.ULS.sendTraceTag(17433736,369,10,"AppId:{0}, something went wrong when insert iamge into Body.",this._context.appId),vc.a.vP("Body.InsertInlinePictureFromBase64",vc.a.fQ(E),e.length,!1),vc.a.ng(),null;vc.a.vP("Body.InsertInlinePictureFromBase64",vc.a.fQ(E),e.length);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.rO.create(this.Yx.D0c(sb),
this._context))})}insertOoxml(e,t){"<"!==e.charAt(0)&&(z.ULS.sendTraceTag(18130832,369,10,"invalid argument for InsertOoxml API in Body class.",this._context.appId),vc.a.qd());return this.Hla(e,t,!0)}insertParagraph(e,t){var E=!1,W=null;switch(t){case 2:t=0;W=this.jb.Zl(this.En,!0,!0);E=!0;break;case 3:t=1;W=this.jb.hD(this.En,!0,!0);E=!1;break;default:z.ULS.sendTraceTag(17319647,369,15,"AppId:{0}, Invalid insert location for Body.InsertPparagraph method.",this._context.appId),vc.a.qd()}W||vc.a.ng();
if(14===W.type){let Ka;var ha=this.fd.w7d((Ka=new fa.a,Ka.add(Zd.a.create(W)),Ka),E);e=vc.a.aXc(e);let sb;this.od.insertText((sb=new fa.a,sb.add(Zd.a.Tc(ha.node,0)),sb),e,t);E=ha.node}else W=this.od.r7a(W,E),E=this.od.insertParagraph((ha=new fa.a,ha.add(W),ha),e,t);return this.Co.create(E,this._context)}insertTable(e,t,E,W){vc.a.fj()||vc.a.il();const ha=new fa.a;var Ka=!1;let sb=null;switch(E){case 2:E=0;sb=this.jb.Zl(this.En,!0,!0);Ka=!0;break;case 3:E=1;sb=this.jb.hD(this.En,!0,!0);Ka=!1;break;
default:z.ULS.sendTraceTag(19951649,369,15,"AppId:{0}, Invalid insert location for Body.InsertTable method.",this._context.appId),vc.a.qd()}sb||vc.a.ng();14===sb.type?ha.add(Zd.a.create(sb)):(Ka=this.od.r7a(sb,Ka),ha.add(Ka));return this.fd.insertTable(ha,e,t,E,W,this._context)}insertText(e,t){var E=new fa.a;switch(t){case 2:case 3:const W=this.Psa(2===t);E.add(Zd.a.create(W));this.od.zPa(E.J(0),E.J(E.count-1));break;case 4:(E=this.parentContentControlOrNullObject)&&E.clear();E=this.jb.SA(this.En,
!0,!1);this.od.Uv(E.J(0));this.od.Uv(E.J(E.count-1));break;default:z.ULS.sendTraceTag(21284487,369,15,"AppId:{0}, undefined location for Body.InsertText: {1}.",this._context.appId,Mt.a[t]),vc.a.qd()}this.od.GW(E,t,0);return this.zan(E,e,t)}search(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{const W=this.jb.SA(this.En,!0,!1);this.BB.find(W,e,t,E,this._context)})}_Search2(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{const W=this.jb.SA(this.En,!0,!1);this.BB.Jpb(W,
e,t,E,this._context)})}select(e){const t=this.jb.SA(this.En,!0,!1);this.Qq.select(t,e)}_KeepReference(){this.Wq()}_OnAccess(){vc.a.c5(this.En,"Body")}getTypeName(){return"Microsoft.WordServices.Body"}invokePropertyGet(e){switch(e){case 3:return this.contentControls;case 19:return this.endnotes;case 20:return this.fields;case 5:return this.font;case 18:return this.footnotes;case 7:return this.inlinePictures;case 11:return this.lists;case 2:return this.paragraphs;case 10:return this.parentBody;case 16:return this.parentBodyOrNullObject;
case 4:return this.parentContentControl;case 15:return this.parentContentControlOrNullObject;case 13:return this.parentSection;case 17:return this.parentSectionOrNullObject;case 6:return this.style;case 14:return this.styleBuiltIn;case 12:return this.tables;case 8:return this.text;case 9:return this.type;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,
t){switch(e){case 6:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 14:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1019:return this.vPb();case 1021:return this.FKa(t);case 1013:return this.MPb();
case 1016:return this.Vsa(t);case 1020:return this.AQb(t);case 1007:return this.uLa(t);case 1006:return this.uta(t);case 1017:return this.I$a(t);case 1003:return this.wLa(t);case 1015:return this.oha(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1011:return this.SIa();case 1014:return this.nQb();case 1009:return this.z$a(t);case 1008:return this.sta(t);case 1004:return this.C$a(t);
case 1010:return this.D$a(t);case 1005:return this.G$a(t);case 1012:return this.yva(t);case 1018:return this.Aoa(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}SIa(){return this.clear()}vPb(){return this.getComments()}FKa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,Pm);return this.getContentControls(e)}MPb(){return this.getHtml()}nQb(){return this.getOoxml()}Vsa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"int");return this.getRange(e)}AQb(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getReviewedText(e)}z$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertBreak(t,e)}uLa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int?");return this.insertContentControl(e)}sta(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertFileFromBase64(t,e)}C$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertHtml(t,e)}D$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertInlinePictureFromBase64(t,
e)}G$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertOoxml(t,e)}uta(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertParagraph(t,e)}I$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"Array<Array<string>>");return this.insertTable(t,E,W,e)}wLa(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertText(t,e)}yva(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,jl.a);return this.search(t,e)}Aoa(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(t,e)}oha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.select(e);return null}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}Psa(e){const t=Ld.GraphIterator.eb(this.En);var E=null;switch(this.En.type){case 8:E=Lw.aKf(t,10,e);t.Yj(E);
E=Lw.aKf(t,23,e);break;case 10:E=Lw.aKf(t,23,e);break;case 36:case 16:case 38:case 37:E=t.currentNode;break;default:z.ULS.sendTraceTag(16814430,369,10,"AppId:{0}, In function Body.GetLowestLayerOffSpringParagraphNode(). Body root graph node must be from one of Document/Section/Headfooter/TableCell/FootnoteEndnote.",this._context.appId),vc.a.ng()}return this.mzm(E,e)}mzm(e,t){let E=null;if(e&&(23===e.type||36===e.type||16===e.type||38===e.type||37===e.type)){e=Ld.GraphIterator.eb(e);let W,ha;do if(W=
e.currentNode,ha=t?e.fv(2)?e.Ub(2):e.Xd():e.fv(2)?e.IL(2):e.S_(),W&&ha&&11===W.type&&12===ha.type){E=ha;break}while(e.currentNode&&e.WA())}return E}zan(e,t,E){if(void 0===t||null===t)return null;var W=2===E?e.J(0):e.J(e.count-1);const ha=3!==E?!0:!1;t=vc.a.Byc(t);let Ka=null;const sb=this.Psa(ha);if(sb){var dc=null;switch(E){case 2:Ka=t.pop();e=0;this.od.r9c(sb)&&(dc=this.od.S6d(sb),-1!==dc&&(e=dc+2>this.jb.textLength(sb)?this.jb.textLength(sb):dc+2));dc=Zd.a.Tc(sb,e);dc.Fb=dc.Tb=W.vo();this.Noa.Ne(dc,
Ka);Ka.length?(dc=Zd.a.createTextRange(sb,e,e+Ka.length),this.od.Uv(dc,2)):(dc=Zd.a.Tc(sb,0),dc.Fb=dc.Tb=W.vo());break;case 3:Ka=t.shift();dc=Zd.a.zx(sb);dc.Fb=dc.Tb=W.wo();this.Noa.Ne(dc,Ka);Ka.length?(dc=Zd.a.createTextRange(sb,Xf.ParagraphReader.textLength(sb)-Ka.length,Xf.ParagraphReader.textLength(sb)),this.od.Uv(dc,2)):(dc=Zd.a.zx(sb),dc.Fb=dc.Tb=W.wo());break;case 4:Ka=t.pop(),dc=this.Can(e,Ka,sb)}W=this.od.sff(t,dc.node,ha);2===E?(0<Ka.length||!Ka.length&&!t.length)&&W.add(dc):3===E?(0<Ka.length||
!Ka.length&&!t.length)&&W.insert(0,dc):W.add(dc);return this.$k.create(W,this._context)}return null}Can(e,t,E){8===this.En.type&&1<Ld.GraphIterator.eb(this.En).Dq()&&(z.ULS.sendTraceTag(18667733,369,15,"AppId:{0}, Body.InsertText cannot replace the content of the document that contains multiple sections.",this._context.appId),vc.a.rC());E=E.qa;E&&E.length||(z.ULS.sendTraceTag(20030220,369,15,"AppId:{0}, CharacterPropertiesArray is null or empty before replacing the body.",this._context.appId),vc.a.ng());
E=E.first.qra(null);this.od.ELb(e);e=this.Psa(!0);var W=e.qa;W&&W.length||(z.ULS.sendTraceTag(20030221,369,15,"AppId:{0}, CharacterPropertiesArray is null or empty after replacing the body.",this._context.appId),vc.a.ng());W.J(0).formatting=E.formatting.Bf(W.J(0));E=0;this.od.r9c(e)&&(W=this.od.S6d(e),-1!==W&&(vc.a.xEf()?E=W+2:(E=W+1,t=" "+t)));W=Zd.a.Tc(e,E);const ha=this.jb.Cm(e,0);W.Fb=W.Tb=0<ha?ha/2:-1;this.Noa.Ne(W,t);e=t.length?Zd.a.createTextRange(e,E,E+t.length):Zd.a.Tc(e,E);e.Fb=W.vo();e.Tb=
t.length?0<ha?0:-1:W.wo();return e}Hla(e,t,E){const W=(new Date).getTime();let ha=new fa.a;switch(t){case 2:case 3:const Ka=this.Psa(2===t);ha.add(Zd.a.create(Ka));break;case 4:ha=this.jb.SA(this.En,!0,!1);break;default:z.ULS.sendTraceTag(18130833,369,15,"AppId:{0}, invalid insert location for body's insert Ooxml or insert Docx method",this._context.appId),vc.a.qd()}this.od.zPa(ha.J(0),ha.J(ha.count-1));return OfficeExtension.WacRuntime.Utility.createPromise((Ka,sb)=>{this.jx.insertOoxml(ha,e,t,this.En,
this._context,Ka,sb,W,E?0:1)})}static aKf(e,t,E){let W=null;if(e)if(E&&e.Xd()){do if(e.currentNode.type===t){W=e.currentNode;break}while(e.Fk());e.uc()}else if(!E&&e.S_()){do if(e.currentNode.type===t){W=e.currentNode;break}while(e.bK());e.uc()}return W}}Object(y.a)(Lw,"Body",si.a,[1143]);class Fo{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj){this.sya=null;this.Co=e;this.$k=t;this.BC=E;this.rO=W;this.Zc=ha;this.Noa=Ka;this.jb=sb;this.Qq=dc;this.EB=xc;this.od=Rc;this.Yx=md;this.$g=
ud;this.BB=Ud;this.jx=Id;this.$m=Ee;this.fd=kf;this.Zn=Ke;this.Ut=dh;this.RZ=$h;this.Wx=rj}zv(e){this.sya=e}create(e,t){return new Lw(e,t,this.Co,this.$k,this.BC,this.rO,this.sya,this.Zc,this.Noa,this.jb,this.Qq,this.EB,this.od,this.Yx,this.$g,this.BB,this.jx,this.$m,this.fd,this.Zn,this.Ut,this.RZ,this.Wx)}}Object(y.a)(Fo,"BodyFactory",null,[1169]);var yf=d(952);class Ix extends si.a{constructor(e,t,E,W,ha,Ka,sb,dc){super();vc.a.wBc(e,"CommentContentRange");this.Cd=e;this.e6=t;this.od=E;this.O1a=
W;this.opa=ha;this.$m=Ka;this.Ut=sb;this.Tq=dc}get bold(){const e=this.L_();return e.cUc?null:1===e.bold}set bold(e){vc.a.yz(e,"Font.Bold");this.Tq.Et(this.cka().currentNode)?e!=this.bold&&(e=e?new yf.a(1):new yf.a(0),this.opa.vEa(this.Cd,wb.a.bold,e),this.WLb()):vc.a.Mzb()}get hyperlink(){const e=this.$m.Qqb(this.Cd).returnValue;return e&&e.length?e[0].hyperlink.url:null}set hyperlink(e){this.Tq.Et(this.cka().currentNode)?(this.$m.jOj(this.Cd,e,!1,this.e6),this.WLb()):vc.a.Mzb()}get italic(){const e=
this.L_();return e.Rpc?null:1===e.italic}set italic(e){vc.a.yz(e,"Font.Italic");this.Tq.Et(this.cka().currentNode)?e!=this.italic&&(e=e?new yf.a(1):new yf.a(0),this.opa.vEa(this.Cd,wb.a.kA,e),this.WLb()):vc.a.Mzb()}get isEmpty(){return this.text===vc.a.Eqc}get text(){return this.$m.SEi(this.Cd,this.e6)}get strikeThrough(){const e=this.L_();return e.Oyc?null:1===e.strikethrough}set strikeThrough(e){vc.a.yz(e,"Font.StrikeThrough");this.Tq.Et(this.cka().currentNode)?e!=this.strikeThrough&&(e=e?new yf.a(1):
new yf.a(0),this.opa.vEa(this.Cd,wb.a.strikethrough,e),this.WLb()):vc.a.Mzb()}get underline(){const e=this.L_();return e.HS?-1:[1,2,3,6,4,20,7,23,39,55,9,25,10,26,11,27,43,0][e.underlineType]}set underline(e){this.Tq.Et(this.cka().currentNode)?e!==this.underline&&(0===e?(this.opa.vEa(this.Cd,wb.a.yha,17),this.WLb()):1===e?(this.opa.vEa(this.Cd,wb.a.yha,0),this.WLb()):vc.a.qd()):vc.a.Mzb()}get _ReferenceId(){return this.gr?this.Gr:null}_KeepReference(){return this.Wq()}_OnAccess(){vc.a.wBc(this.Cd,
"CommentContentRange");for(const e of this.Cd)vc.a.c5(e.node,"CommentContentRange")}insertText(e,t){if(this.Tq.Et(this.cka().currentNode)){var E=new Ld.GraphIterator;E.set(this.Cd.J(0).node);E.zb(40);E.ld(40);e=1<vc.a.Byc(e).length?this.od.u$m(this.Cd,e,t):this.od.insertText(this.Cd,e,t);t=e.count;var W=e.J(t-1);W.contextId===na.a.paragraph&&(W=Zd.a.createTextRange(W.node,0,Xf.ParagraphReader.textLength(W.node)),e.removeAt(t-1),e.add(W));e.J(0).contextId===na.a.Vc&&e.removeAt(0);e=this.O1a.create(e,
this.e6);({startIndex:t,endIndex:W}=e.ozi(E));this.WLb();e.jRh(E,t,W);return e}vc.a.Mzb()}getTypeName(){return"Microsoft.WordServices.CommentContentRange"}invokePropertyGet(e){switch(e){case 1:return this._ReferenceId;case 3:return this.isEmpty;case 4:return this.hyperlink;case 2:return this.text;case 5:return this.bold;case 6:return this.italic;case 7:return this.strikeThrough;case 8:return this.underline}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=
this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 4:this.hyperlink=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 5:this.bold=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 6:this.italic=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 7:this.strikeThrough=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"boolean");return;case 8:this.underline=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1001:return this.ri();case 1002:return this.si();case 1003:return this.wLa(t)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,
t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}wLa(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertText(t,e)}L_(){const e=this.opa.L_(this.Cd);e||vc.a.ng();return e}ozi(e){let t=-1,E=-1;const W=e.Dq();if(0<W){e.Xd();for(let ha=0;ha<W;ha++)e.Xd(),e.currentNode.id==
this.Cd.J(0).node.id&&(t=ha),e.currentNode.id==this.Cd.J(this.Cd.count-1).node.id&&(E=ha),e.uc(),e.Fk()}e.zb(40);e.ld(40);return{startIndex:t,endIndex:E}}jRh(e,t,E){const W=new fa.a;if(0<e.Dq()){e.Xd();for(let Ka=0,sb=0;Ka<E+1;Ka++,sb++){e.Xd();if(Ka>=t&&Ka<E+1){var ha=this.Cd.J(sb-t);if(ha.contextId===na.a.Vc){Ka--;ha=W.J(W.count-1).node;W.add(Zd.a.Xl(ha));continue}else ha.contextId===na.a.Bd?W.add(Zd.a.createTextRange(e.currentNode,ha.lk,ha.Ep)):ha.contextId===na.a.paragraph&&W.add(Zd.a.create(e.currentNode))}e.uc();
e.Fk()}e.zb(40);e.ld(40);this.Cd=W}}WLb(){const e=this.cka();let t=-1,E=-1;({startIndex:t,endIndex:E}=this.ozi(e));this.Ut.Owl(e.currentNode);this.jRh(e,t,E)}Fq(){return this.Cd}cka(){const e=new Ld.GraphIterator;e.set(this.Cd.J(0).node);e.zb(40);e.ld(40);return e}}Object(y.a)(Ix,"CommentContentRange",si.a,[1143]);class Km{constructor(e,t,E,W){this.od=e;this.opa=t;this.$m=E;this.Tq=W}zv(e){this.Ut=e}create(e,t){return new Ix(e,t,this.od,this,this.opa,this.$m,this.Ut,this.Tq)}}Object(y.a)(Km,"CommentContentRangeFactory",
null,[1169]);class yn extends si.a{constructor(e){super();vc.a.yz(e,"CommentReplyCollection");this.v5b=e}length(){return this.v5b.count}_GetItem(e){e=vc.a.KS(e);if(0<=e&&e<this.length())return this.v5b.J(e);vc.a.qd();return null}get _ReferenceId(){return this.gr?this.Gr:null}getFirst(){const e=this.getFirstOrNullObject();e||vc.a.hl();return e}getFirstOrNullObject(){return this.v5b&&0<this.v5b.count?this.v5b.J(0):null}getItem(e){e=vc.a.KS(e);return e<this.length()?this.v5b.J(e):null}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,
t){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.CommentReplyCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.nI();case 1004:return this.oI();case 1:return this.P_(t);case 1001:return this.ri();case 1002:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}P_(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this.getItem(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(yn,"CommentReplyCollection",si.a,[1143,1215]);class Gl extends si.a{constructor(e,t,E,W,ha,Ka,sb){super();vc.a.yz(e,"Comment GraphNodeContext");this.yda=e;this.e6=t;this.Ut=E;this.$k=W;this.Byd=ha;this.O1a=Ka;this.jb=sb}get authorEmail(){return this.Ut.Qvi(this.yda)}get authorName(){return this.yda.getValue(fd.a.PLb)}get content(){return this.Ut.Rvi(this.yda)}set content(e){this.Ut.nzg(e,
this.yda,!0)}get contentRange(){const e=Ld.GraphIterator.eb(this.yda),t=e.Dq(),E=new fa.a;if(0<t){e.Xd();for(let W=0;W<t;W++)e.Xd(),W===t-1?E.add(Zd.a.createTextRange(e.currentNode,0,this.jb.textLength(e.currentNode))):E.add(Zd.a.create(e.currentNode)),e.uc(),e.Fk()}return this.O1a.create(E,this.e6)}set contentRange(e){this.Ut.cNj(e,this.yda)}get creationDate(){return this.yda.getValue(fd.a.aJa)}get id(){return this.yda.getValue(fd.a.MG)}get _ReferenceId(){return this.gr?this.Gr:null}get replies(){var e=
this.Ut.rmm(this.yda);const t=new fa.a;for(const E of e)e=this.Byd.create(E,this.e6),t.add(e);return new yn(t)}get resolved(){return this.yda.ja(fd.a.Rea,!1)}set resolved(e){this.Ut.tGo(this.yda,e)}reply(e){if(this.resolved)vc.a.rC();else return e=this.Ut.LYk(this.yda,e),this.Byd.create(e,this.e6)}deleteObject(){this.Ut.deleteComment(this.yda)}getRange(){const e=this.Ut.hBa(this.yda),t=new fa.a;for(let E=0;E<e.length;E++){const W=e.J(E);t.add(W)}return this.$k.create(t,this.e6)}_KeepReference(){return this.Wq()}_OnAccess(){vc.a.c5(this.yda,
"Comment")}getTypeName(){return"Microsoft.WordServices.Comment"}invokePropertyGet(e){switch(e){case 1:return this.authorEmail;case 2:return this.authorName;case 3:return this.content;case 9:return this.contentRange;case 4:return this.creationDate;case 7:return this.replies;case 8:return this.resolved;case 5:return this.id;case 6:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,
t){switch(e){case 3:this.content=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 8:this.resolved=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 9:this.contentRange=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,Ix);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
t){switch(e){case 1001:return this.Vsa(t);case 1002:return this.NDo(t);case 1003:return this.yF(t);case 1005:return this.ri();case 1004:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Vsa(){return this.getRange()}NDo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.reply(e)}yF(){this.deleteObject();return null}ri(){this._KeepReference();
return null}si(){this._OnAccess();return null}}Object(y.a)(Gl,"Comment",si.a,[1143]);class QG{constructor(e,t,E){this.Ut=this.$k=null;this.Byd=e;this.O1a=t;this.jb=E}zv(e,t){this.$k=e;this.Ut=t}create(e,t){return new Gl(e,t,this.Ut,this.$k,this.Byd,this.O1a,this.jb)}}Object(y.a)(QG,"CommentFactory",null,[1169]);var VI=d(1936),fB=d(1690);class Wv extends si.a{constructor(e){super();vc.a.yz(e,"CommentCollection");this.oh=e}length(){return this.oh.count}_GetItem(e){e=vc.a.KS(e);if(0<=e&&e<this.length())return this.oh.J(e);
vc.a.qd();return null}get _ReferenceId(){return this.gr?this.Gr:null}getFirst(){const e=this.getFirstOrNullObject();e||vc.a.hl();return e}getFirstOrNullObject(){return this.oh&&0<this.oh.count?this.oh.J(0):null}getItem(e){e=vc.a.KS(e);return e<this.length()?this.oh.J(e):null}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,t){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.CommentCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.nI();case 1004:return this.oI();case 1:return this.P_(t);case 1001:return this.ri();case 1002:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}P_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this.getItem(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(Wv,"CommentCollection",si.a,[1143,1215]);var Sp=d(1570);class fv{constructor(e,t,E,W,ha,Ka,sb,dc){this.aRa=null;this.Tq=e;t.execute(xc=>
{this.aRa=xc});this.P1a=E;this.xmk=W;this.hb=ha;this.jb=Ka;this.$m=sb;this.t5b=dc}insertComment(e,t,E){this.Tq.Tsb(this.xmk,!1)||vc.a.rC();var W=new Nd.Selection(e.toArray(),!0);e&&0<=e.count&&e.J(0)&&e.J(0).contextId==na.a.Xc&&this.hb.B3j(W);if(this.jb.Xb(e.J(0).node)&&this.jb.Xb(e.J(e.count-1).node)){e=this.hb.gb.currentSelection;this.hb.Ic(W);W=VI.a.Wfc(null);const ha=new fB.a;ha.Ila(t+"\n");W.text=[ha.Ujc()];this.aRa.aza(W,null);this.aRa.Uza(W);t=Hb.a.Cf(W.objectId);t=this.Tq.td.Eb(t);this.hb.Ic(e);
return this.P1a.create(t,E)}vc.a.qd();return null}Rvi(e){e=Ld.GraphIterator.eb(e);e=this.Tq.uPb(e);return this.KFm(e[0])}nzg(e,t,E){this.Tq.Et(t)?(t=this.Tq.e3(t.id.toString()),this.Tq.XZc(t,null),this.Tq.XZc(t,null),E?(E=new fB.a,E.Ila(e+"\n"),t.text=[E.Ujc()]):t.text=[e],this.Tq.Dnb(t)):vc.a.Mzb()}deleteComment(e){this.aRa.deleteComment(this.Tq.e3(e.id.toString()))}LYk(e,t){e=this.Tq.v9h(this.Tq.e3(e.id.toString()).id,null);const E=new fB.a;E.Ila(t+"\n");e.text=[E.Ujc()];this.aRa.Uza(e);t=Hb.a.Cf(e.objectId);
return this.Tq.td.Eb(t)}T5d(e,t){var E=this.vmm(e);e=new fa.a;for(const W of E)E=this.P1a.create(W,t),e.add(E);return new Wv(e)}hBa(e){return this.Tq.ZNf(e.id)}rmm(e){var t=this.hBa(e);t=t.Ra.node.qa.sh(t.Ra.cpBegin);const E=new fa.a;e=e.getValue(fd.a.NJ);if(t.kf&&0<t.kf.length)for(let W=0;W<t.kf.length;W++)if(t.kf.J(W).Wc){const ha=t.kf.J(W).sPb();e===ha.ja(fd.a.XO,null)&&E.add(ha)}return E}qmm(e){return this.Tq.DF(e).objectId}Qvi(e){e=e.ja(fd.a.jWc,"");return!Qd.a.Tf(e)&&(e=e.split("::"),!dg.a.Tf(e)&&
2<=e.length)?e[1]:null}vmm(e){const t=new fa.a,E=e.count;for(let Ka=0;Ka<E;Ka++){var W=e.J(Ka);if(W.contextId===na.a.Vc)continue;const sb=-1===W.cpEnd?W.Ep:W.cpEnd;W=W.node.qa;for(let dc=0;dc<W.length;dc++){if(0>W.J(dc).cp)continue;if(W.J(dc).cp>sb)break;const xc=W.J(dc);if(xc.kf&&0<xc.kf.length)for(let Rc=0;Rc<xc.kf.length;Rc++){const md=xc.kf.J(Rc).sPb();var ha=this.hBa(md);Qd.a.Tf(md.ja(fd.a.XO,null))&&!t.contains(md)&&(ha=this.$m.M5h(e.J(0),e.J(E-1),ha.J(0),ha.J(ha.length-1)),10!=ha&&13!=ha&&
0!=ha&&11!=ha&&8!=ha&&t.add(md))}}}return t}KFm(e){if(""==e)return"";let t="";e=fB.a.Iqb(e);for(let E=0;E<e.ops.length-1;E++){const W=e.ops[E];null!=W.attributes&&null!=W.attributes.atmention?(t+="@",t+=W.attributes.atmention.fullName):t+=W.insert?W.insert:"\n"}return t}Sgm(e){const t=new fa.a;for(const W of this.Tq.Rhf)if(!W.Mf&&!Qd.a.Tf(W.objectId)){var E=Hb.a.Cf(W.objectId);E=this.Tq.td.Eb(E);E=this.P1a.create(E,e);t.add(E)}return new Wv(t)}hmm(e,t){const E=new fa.a;for(const ha of this.Tq.Rhf)if(!ha.Mf&&
!Qd.a.Tf(ha.objectId)){var W=Hb.a.Cf(ha.objectId);W=this.Tq.td.Eb(W);if(this.AWi(e,W,!0)||this.AWi(e,W,!1))W=this.P1a.create(W,t),E.contains(W)||E.add(W)}return new Wv(E)}tGo(e,t){this.aRa.xLb(this.Tq.e3(e.id.toString()),t)}AWi(e,t,E){t=this.Tq.td.Eb(E?Sp.k(t):Sp.h(t));t=Ld.GraphIterator.eb(t);return t.zb(10)&&(t.ld(10),t.io.equals(e))?!0:!1}Owl(e){const t=this.Tq.e3(e.id.toString());this.Tq.XZc(t,null);e=Ld.GraphIterator.eb(e);e=this.Tq.uPb(e);t.text=e;this.Tq.Dnb(t)}cNj(e,t){this.Tq.Et(t)||vc.a.Mzb();
const E=e.Fq().count,W=Array(E);for(let ha=0;ha<E;ha++){const Ka=e.Fq().J(ha).node;Ka.LSb=!0;W[ha]=Ka}e=this.t5b.dJg(W)[0];this.nzg(e,t,!1)}}Object(y.a)(fv,"CommentOperations",null,[1310]);class RG extends si.a{constructor(e,t,E,W,ha,Ka){super();vc.a.yz(e,"CommentReply GraphNodeContext");this.VFa=e;this.e6=t;this.Ut=E;this.Ei=W;this.P1a=ha;this.O1a=Ka}get authorEmail(){return this.Ut.Qvi(this.VFa)}get authorName(){return this.VFa.getValue(fd.a.PLb)}get content(){return this.Ut.Rvi(this.VFa)}set content(e){this.Ut.nzg(e,
this.VFa,!0)}get contentRange(){const e=Ld.GraphIterator.eb(this.VFa),t=e.Dq(),E=new fa.a;if(0<t){e.Xd();for(let W=0;W<t;W++)e.Xd(),E.add(Zd.a.create(e.currentNode)),e.uc(),e.Fk()}return this.O1a.create(E,this.e6)}set contentRange(e){this.Ut.cNj(e,this.VFa)}get creationDate(){return this.VFa.getValue(fd.a.aJa)}get id(){return this.VFa.getValue(fd.a.MG)}get _ReferenceId(){return this.gr?this.Gr:null}get parentComment(){var e=this.VFa.ja(fd.a.XO,null);return Qd.a.Tf(e)?null:(e=this.Ei.value.Eb(Hb.a.Cf(this.Ut.qmm(e))),
this.P1a.create(e,this.e6))}deleteObject(){this.Ut.deleteComment(this.VFa)}_KeepReference(){return this.Wq()}_OnAccess(){vc.a.c5(this.VFa,"CommentReply")}getTypeName(){return"Microsoft.WordServices.CommentReply"}invokePropertyGet(e){switch(e){case 1:return this.authorEmail;case 2:return this.authorName;case 3:return this.content;case 4:return this.creationDate;case 5:return this.id;case 6:return this._ReferenceId;case 7:return this.parentComment;case 8:return this.contentRange}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 3:this.content=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 8:this.contentRange=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,Ix);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
t){switch(e){case 1002:return this.yF(t);case 1001:return this.ri();case 1003:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}yF(){this.deleteObject();return null}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(RG,"CommentReply",si.a,[1143]);class DC{constructor(e){this.P1a=this.Ut=null;this.Ei=e}zv(e,t,
E){this.P1a=e;this.Ut=t;this.O1a=E}create(e,t){return new RG(e,t,this.Ut,this.Ei,this.P1a,this.O1a)}}Object(y.a)(DC,"CommentReplyFactory",null,[1169]);var Aq=d(1007),qn=d(148);class Mu extends si.a{constructor(e){super();vc.a.yz(e,"RangeCollection");this.jea=e}length(){return this.jea.count}get _ReferenceId(){return this.gr?this.Gr:null}getFirst(){const e=this.getFirstOrNullObject();e||vc.a.hl();return e}getFirstOrNullObject(){vc.a.fj()||vc.a.il();return this.jea&&this.jea.count?this.jea.J(0):null}_GetItem(e){e=
vc.a.KS(e);if(e<this.length())return this.jea.J(e);z.ULS.sendTraceTag(18745302,369,10,"The index is out of the boundary of range list.");vc.a.qd();return null}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,t){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.RangeCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.nI();case 1004:return this.oI();case 1:return this.NY(t);case 1001:return this.ri();case 1002:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}NY(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(Mu,"RangeCollection",si.a,[1143,1215]);class wE{constructor(e){this.Ze=e}get isChecked(){return!1}set isChecked(e){Aq.a.UCa(this.Ze.objectId)}getTypeName(){return"Microsoft.WordServices.CheckboxContentControl"}invokePropertyGet(e){switch(e){case 1:return this.isChecked}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 1:this.isChecked=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(y.a)(wE,"CheckboxContentControl",null,[1249]);class Lz extends si.a{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj,zl,Wl){super();vc.a.yz(e,"wacContentControl");this.Ze=e;this._context=t;this.Tp=E;this.x5=W;this.Co=ha;this.$k=Ka;this.BC=sb;this.rO=dc;this.Qq=xc;this.EB=Rc;this.od=md;this.$g=ud;this.Yx=Ud;this.BB=Id;this.jx=Ee;this.$m=kf;this.Zn=Ke;this.fd=
dh;this.jb=$h;this.Ut=rj;this.RZ=zl;this.Wx=Wl}get appearance(){return this.Ze.appearance}set appearance(e){this.jnb("ContentControl.Appearance");this.Ze.appearance=e;Aq.a.UCa(this.Ze.objectId)}get cannotDelete(){return!this.Ze.Nla}set cannotDelete(e){this.jnb("ContentControl.CannotDelete");e&&this.removeWhenEdited&&vc.a.qd();this.Ze.Nla=!e;Aq.a.UCa(this.Ze.objectId)}get cannotEdit(){return!this.Ze.isEditable}set cannotEdit(e){this.jnb("ContentControl.CannotEdit");this.Ze.isEditable=!e;Aq.a.UCa(this.Ze.objectId)}get checkboxContentControl(){if(!vc.a.jda||
8!==this.Ze.type)return null;this.cbh||(this.cbh=new wE(this.Ze));return this.cbh}get color(){return null==this.Ze.color?"#000000":Ok.a.VC(this.Ze.color).toUpperCase()}set color(e){this.jnb("ContentControl.Color");e=vc.a.LPa(e,"ContentControl.Color",this._context);e=parseInt(e,16);isNaN(e)?vc.a.qd():(this.Ze.color=e,Aq.a.UCa(this.Ze.objectId))}get endnotes(){var e=this.Ze.TG();e=this.od.$6d(e,1);e=this.od.iAa(e,this._context);return new Dt(e)}get fields(){return this.Ze.RL?new ar(new fa.a):new ar(this.Wx.Qrm(this.Ze,
this._context))}get contentControls(){if(vc.a.tFa||vc.a.jda){var e=new Pm;e.types=[31];return this.getContentControls(e)}e=this.Tp.mN(this.Ze.start,this.Ze.end,1);for(const t of e)if(t.id===this.Ze.id){e.remove(t);break}return this.$g.H9d(e,this._context)}get font(){null==this._font&&(this._font=this.BC.create(1,null,this.Ze,null,this._context));v.AFrameworkApplication.$u&&this._font._OnAccess();return this._font}get footnotes(){var e=this.Ze.TG();e=this.od.$6d(e,0);e=this.od.iAa(e,this._context);
return new Dt(e)}get id(){return this.Ze.id}get inlinePictures(){const e=this.Ze.TG(),t=new fa.a;for(const E of e)this.AGl(t,E);return new np(t)}get lists(){return vc.a.fj()?new Ly(1,null,this.Ze,null,this._context,this.Zn,null):null}get paragraphs(){const e=this.Ze.TG();let t=0;const E=new fa.a;for(const W of e)E.add(this.Co.create(W.node,this._context,t++));return new Hx(E)}get parentBody(){if(!vc.a.fj())return null;const e=this.Ze.TG();return this.fd.RMf(e.J(0).node,e.J(e.count-1).node,this._context)}get parentContentControl(){const e=
this.parentContentControlOrNullObject;e||vc.a.hl();return e}get parentContentControlOrNullObject(){var e;for(e=this.Ze.parentId;(e=this.Tp.getById(e))&&!this.$g.b9c(e);)e=e.parentId;return e?this.x5.create(e,this._context):null}get parentTable(){if(!vc.a.fj())return null;const e=this.parentTableOrNullObject;e||vc.a.hl();return e}get parentTableCell(){if(!vc.a.fj())return null;const e=this.parentTableCellOrNullObject;e||vc.a.hl();return e}get parentTableCellOrNullObject(){return vc.a.fj()?this.fd.Rkc(this.Ze.start.node,
this._context,this.Ze.end.node):null}get parentTableOrNullObject(){return vc.a.fj()?this.fd.frb(this.Ze.start.node,this._context,this.Ze.end.node):null}get placeholderText(){let e=this.Ze.placeholderText;e||(e=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);return e}set placeholderText(e){qn.a.pga?(e=vc.a.aXc(e),this.Ze.RL&&(this.insertText(e,4),this.Ze.RL=!0),this.Ze.placeholderText=e):(z.ULS.sendTraceTag(20833952,369,15,"AppId:{0}, set placeholder text for contentcontrol on wac is not allowed.",
this._context.appId),vc.a.rC())}get removeWhenEdited(){return this.Ze.removeWhenEdited}set removeWhenEdited(e){this.jnb("ContentControl.RemoveWhenEdited");e&&this.cannotDelete&&vc.a.qd();this.Ze.removeWhenEdited=e;Aq.a.UCa(this.Ze.objectId)}get style(){const e=this.Ze.TG();return this.EB.o3c(e)}set style(e){this.jnb("ContentControl.Style");const t=this.Ze.TG();this.EB.fxc(t,e);Aq.a.UCa(this.Ze.objectId)}get styleBuiltIn(){if(!vc.a.fj())return-1;const e=this.Ze.TG();return this.EB.b7d(e)}set styleBuiltIn(e){vc.a.fj()||
vc.a.il();const t=this.Ze.TG();this.EB.Mxe(t,e);Aq.a.UCa(this.Ze.objectId)}get fg(){return this.Ze.fg}get tHg(){if(!this.Ze.type){const e=Ld.GraphIterator.eb(this.Ze.start.node);if(e.zb(14))return e.ld(14)}}get AXj(){if(!this.Ze.type)return this.Ze.start?this.Ze.start.node:void 0}get subtype(){if(!vc.a.fj())return 0;if(vc.a.tFa)return this.mMm();if(!this.Ze.type){if(this.Ze.fg){const E=this.Ze.start.node,W=this.Ze.end.node;var e=Ld.GraphIterator.eb(E);if(e.zb(14)){var t=e.ld(14);e=this.jb.Zl(t);t=
this.jb.hD(t);if(e&&t&&E.id===e.id&&W.id===t.id)return 16}return 2}return 1}return 0}get tables(){return vc.a.fj()?new Vv(1,null,null,this.Ze,this._context,this.fd):null}get tag(){return this.Ze.tag}set tag(e){this.jnb("ContentControl.Tag");vc.a.yz(e,"Tag");this.Ze.tag=e;Aq.a.UCa(this.Ze.objectId)}get text(){return this.Ze.RL?"":this.Ze.getText()}getReviewedText(e){return this.Ze.RL?"":this.RZ.uIm(this.Ze,e)}get title(){return this.Ze.title}set title(e){this.jnb("ContentControl.Title");vc.a.yz(e,
"Title");this.Ze.title=e;Aq.a.UCa(this.Ze.objectId)}get type(){switch(this.Ze.type){case 1:return vc.a.tFa?96:31;case 8:return vc.a.jda?512:31;default:return 31}}get _ReferenceId(){return this.gr?this.Gr:null}clear(){vc.a.Qud()?this.tsl():this.ssl()}deleteContentControl(e){vc.a.Qud()?this.$Pl(e):this.ZPl(e)}getComments(){return this.Ut.T5d(this.Ze.TG(),this._context)}getContentControls(e){var t;e=null!==(t=null===e||void 0===e?void 0:e.types)&&void 0!==t?t:[];vc.a.C_c(e);t=this.Tp.mN(this.Ze.start,
this.Ze.end,1);for(var E of t)if(E.id===this.Ze.id){t.remove(E);break}E=this.$g.H9d(t,this._context);return 0===e.length?E:null===E||void 0===E?void 0:E.getByTypes(e)}getHtml(){const e=this.Ze.TG();return this.jx.getHtml(e.toArray(),this._context)}getOoxml(){const e=(new Date).getTime();this._context.An.BF();const t=this.Ze.TG();return OfficeExtension.WacRuntime.Utility.createPromise((E,W)=>{this.jx.getOoxml(t,this._context,E,W,e)})}getRange(e){vc.a.fj()||vc.a.il();1!==e&&2!==e&&e&&5!==e&&4!==e&&
3!==e&&(z.ULS.sendTraceTag(18745292,369,15,"AppId:{0}, rangeLocation of ContentControl.GetRange must be Start/End/Whole/Content/Before/After.",this._context.appId),vc.a.qd());var t=e;3===e&&(t=1);var E=this.Ze.TG(),W=E.J(0),ha=E.J(E.count-1);if(ha.contextId===na.a.paragraph&&4===e){var Ka=(Ka=this.jb.textLength(ha.node))?Zd.a.createTextRange(ha.node,0,Ka):Zd.a.zx(ha.node);E.removeAt(E.count-1);E.add(Ka);this.$m.axc(W,ha,E,!1)}t=this.$m.Jjc(E,t);E&&t&&0<E.count&&0<t.count&&(W=E.J(0),E=E.J(E.count-
1),ha=t.J(0),Ka=t.J(t.count-1),1===e?ha.Fb=Ka.Tb=W.Fb+1:2===e?ha.Fb=Ka.Tb=E.Tb-1:5===e&&(ha.Fb=W.Fb+1,Ka.Tb=E.Tb-1));return this.$k.create(t,this._context)}getTextRanges(e,t){vc.a.fj()||vc.a.il();var E=this.Ze.TG();e=this.$m.aPf(E,e,t);t=new fa.a;for(E=0;E<e.length;E++)t.add(this.$k.create(e[E],this._context,E));return new Mu(t)}insertBreak(e,t){const E=(new Date).getTime();2!==t&&3!==t&&t&&1!==t&&(z.ULS.sendTraceTag(19158349,369,15,"AppId:{0}, invalid insert location for ContentControl.InsertBreak.",
this._context.appId),vc.a.qd());vc.a.jda?this.ZNb(t):this.mpb(t);let W=!1;if(6===e||(vc.a.XGe()||this.Ze.fg)&&!e)W=this.Rnc(t);const ha=new fa.a;ha.add(this.GPb(t));W&&this.$g.bKa();return OfficeExtension.WacRuntime.Utility.createPromise((Ka,sb)=>{this.od.insertBreak(ha,e,t,this._context,Ka,sb,E)})}insertFileFromBase64(e,t){"<"===e.charAt(0)&&(z.ULS.sendTraceTag(18130834,369,10,"invalid argument for insertFileFromBase64 API in ContentControl class.",this._context.appId),vc.a.qd());this.Ze.isEditable||
vc.a.Wzc(this._context.appId,"ContentControl.InsertFileFromBase64",void 0,Mt.a[t]);vc.a.jda?this.ZNb(t):this.mpb(t);return this.Hla(e,t,!1)}insertHtml(e,t){vc.a.jda?this.ZNb(t):this.mpb(t);return vc.a.Qud()?this.a$m(e,t):this.$9m(e,t)}insertInlinePictureFromBase64(e,t){vc.a.jda?this.ZNb(t):this.mpb(t);return this.a8c(e,t)}insertOoxml(e,t){"<"!==e.charAt(0)&&(z.ULS.sendTraceTag(18130835,369,10,"invalid argument for InsertOoxml API in ContentControl class.",this._context.appId),vc.a.qd());vc.a.jda?
this.ZNb(t):this.mpb(t);return this.Hla(e,t,!0)}insertParagraph(e,t){2!==t&&3!==t&&t&&1!==t&&(z.ULS.sendTraceTag(21070048,369,15,"AppId:{0}, Invalid insert location for ContentControl.InsertPparagraph method.",this._context.appId),vc.a.qd());vc.a.XGe()||2!==t&&3!==t||this.Ze.fg||vc.a.Wzc(this._context.appId,"ContentControl.InsertParagraph",void 0,Mt.a[t]);vc.a.jda?this.ZNb(t):this.mpb(t);const E=this.Rnc(t),W=new fa.a;W.add(this.GPb(t));2===t?t=0:3===t&&(t=1);E&&this.$g.bKa();return this.Co.create(this.od.insertParagraph(W,
e,t),this._context)}insertTable(e,t,E,W){vc.a.fj()||vc.a.il();2!==E&&3!==E&&E&&1!==E&&(z.ULS.sendTraceTag(20971524,369,15,"Invalid argument for InsertTable API in ContentControl class.",this._context.appId),vc.a.qd());vc.a.XGe()||2!==E&&3!==E||this.Ze.fg||vc.a.Wzc(this._context.appId,"ContentControl.InsertParagraph",void 0,Mt.a[E]);vc.a.jda?this.ZNb(E):this.mpb(E);const ha=this.Rnc(E),Ka=new fa.a;Ka.add(this.GPb(E));2===E?E=0:3===E&&(E=1);ha&&this.$g.bKa();return this.fd.insertTable(Ka,e,t,E,W,this._context)}insertText(e,
t){2!==t&&3!==t&&4!==t&&(z.ULS.sendTraceTag(21284488,369,15,"AppId:{0}, invalid location for ContentControl.InsertText: {1}.",this._context.appId,Mt.a[t]),vc.a.qd());vc.a.jda&&this.Lki(t);var E=vc.a.Byc(e);!vc.a.XGe()&&1<E.length&&!this.Ze.fg&&vc.a.Wzc(this._context.appId,"ContentControl.InsertText","Attempt to insert multi-line text into an inline content control",Mt.a[t]);if(this.Ze.RL&&1===E.length&&""===E[0])return this.$k.create(this.hkc(),this._context);if(!vc.a.Qud()&&(this.Ze.RL||4===t))return this.Ze.Gye(e)&&
vc.a.ng(),this.$k.create(this.hkc(),this._context);E=this.Rnc(t);let W=new fa.a;switch(t){case 2:case 3:W.add(this.GPb(t));break;case 4:W=this.hkc()}E&&this.$g.bKa();return this.$k.create(this.od.insertText(W,e,t),this._context)}search(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{const W=this.Ze.TG();this.BB.find(W,e,t,E,this._context)})}_Search2(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{const W=this.Ze.TG();this.BB.Jpb(W,e,t,E,this._context)})}select(e){switch(e){case 0:this.$g.select(this.Ze);
break;case 1:case 2:if(this.Ze.RL)this.$g.select(this.Ze);else{const t=1===e?this.Ze.start:this.Ze.end;let E;this.Qq.select((E=new fa.a,E.add(t),E),e)}}}split(e,t,E,W){vc.a.fj()||vc.a.il();const ha=this.Ze.TG();if(ha&&0<ha.count){let Ka;(Ka=ha.J(0)).Fb=Ka.Fb+1;let sb;(sb=ha.J(ha.count-1)).Tb=sb.Tb-1}e=this.$m.Ayc(ha,e,t,E,W);t=new fa.a;for(E=0;E<e.length;E++)t.add(this.$k.create(e[E],this._context,E));return new Mu(t)}_KeepReference(){this.Wq()}_OnAccess(){this.Ze.isValid()||(z.ULS.sendTraceTag(17155413,
369,15,"AppId:{0}, Should not access invalid contentcontrol object.",this._context.appId),vc.a.ng())}getTypeName(){return"Microsoft.WordServices.ContentControl"}invokePropertyGet(e){switch(e){case 7:return this.appearance;case 10:return this.cannotDelete;case 11:return this.cannotEdit;case 32:return this.checkboxContentControl;case 8:return this.color;case 15:return this.contentControls;case 30:return this.endnotes;case 31:return this.fields;case 12:return this.font;case 29:return this.footnotes;
case 1:return this.id;case 17:return this.inlinePictures;case 19:return this.lists;case 14:return this.paragraphs;case 25:return this.parentBody;case 16:return this.parentContentControl;case 26:return this.parentContentControlOrNullObject;case 22:return this.parentTable;case 21:return this.parentTableCell;case 27:return this.parentTableCellOrNullObject;case 28:return this.parentTableOrNullObject;case 5:return this.placeholderText;case 9:return this.removeWhenEdited;case 13:return this.style;case 24:return this.styleBuiltIn;
case 23:return this.subtype;case 20:return this.tables;case 4:return this.tag;case 18:return this.text;case 3:return this.title;case 6:return this.type;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 7:this.appearance=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");
return;case 10:this.cannotDelete=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 11:this.cannotEdit=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 8:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 5:this.placeholderText=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 9:this.removeWhenEdited=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"boolean");return;case 13:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 24:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return;case 4:this.tag=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 3:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,
t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1010:return this.SIa();case 1011:return this.yF(t);case 1021:return this.vPb();case 1023:return this.FKa(t);case 1013:return this.MPb();case 1016:return this.Vsa(t);case 1019:return this.O4c(t);case 1007:return this.uta(t);case 1018:return this.I$a(t);case 1003:return this.wLa(t);case 1012:return this.oha(t);case 1017:return this.X0b(t);case 1002:return this.ri();
case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1014:return this.nQb();case 1008:return this.z$a(t);case 1006:return this.sta(t);case 1004:return this.C$a(t);case 1009:return this.D$a(t);case 1005:return this.G$a(t);case 1015:return this.yva(t);case 1020:return this.Aoa(t);case 1022:return this.AQb(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}SIa(){this.clear();
return null}yF(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"boolean");this.deleteContentControl(e);return null}vPb(){return this.getComments()}FKa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,Pm);return this.getContentControls(e)}MPb(){return this.getHtml()}nQb(){return this.getOoxml()}Vsa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getRange(e)}O4c(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"Array<string>");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.getTextRanges(t,e)}AQb(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getReviewedText(e)}z$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertBreak(t,e)}sta(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");
e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertFileFromBase64(t,e)}C$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertHtml(t,e)}D$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertInlinePictureFromBase64(t,e)}G$a(e){const t=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertOoxml(t,e)}uta(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertParagraph(t,e)}I$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"Array<Array<string>>");return this.insertTable(t,E,W,e)}wLa(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertText(t,e)}yva(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,jl.a);return this.search(t,e)}Aoa(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(t,e)}oha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.select(e);return null}X0b(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
2,"boolean");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"boolean");return this.split(t,E,W,e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}isValid(){return this.Ze.isValid()}AGl(e,t){const E=new fa.a;this.Yx.u7d(E,t);if(!(0>=E.count))for(const W of E)e.add(this.rO.create(W,this._context))}Hla(e,t,E){const W=(new Date).getTime();if(2===t||3===t||4===t){const ha=this.Ze.TG();return OfficeExtension.WacRuntime.Utility.createPromise((Ka,sb)=>{const dc=E?
0:1;this.jx.insertOoxml(ha,e,t,ha.J(0).node,this._context,Ka,sb,W,dc,this.Ze.id)})}z.ULS.sendTraceTag(18130836,369,15,"AppId:{0}, ContentControl.InsertOoxmlOrDocx: undefined location!",this._context.appId);vc.a.qd();return null}jnb(e){this.Ze.isSupported||(z.ULS.sendTraceTag(19417247,369,15,"AppId:{0}, {1}: currently is not supported as the contentcontrol is no-supported on WAC!",this._context.appId,e),vc.a.rC())}GPb(e){var t=null;switch(e){case 0:case 2:var E=this.Ze.start;t=this.Ze.fg?0:E.cpBegin;
t=Zd.a.Tc(E.node,t);t.Fb=e?t.Tb=E.vo():t.Tb=E.vo()-1;break;case 1:case 3:E=this.Ze.end,t=this.Ze.fg?E.node.characterData.length:E.cpEnd,t=Zd.a.Tc(E.node,t),t.Fb=1===e?t.Tb=E.wo()+1:t.Tb=E.wo()}return t}hkc(){if(vc.a.DGp()&&!this.Ze.fg&&!this.Ze.start)return new fa.a;const e=this.Ze.TG();let t;(t=e.J(0)).Fb=t.Fb+1;let E;(E=e.J(e.count-1)).Tb=E.Tb-1;return e}Rnc(e){let t=!1;!this.Ze.RL||2!==e&&3!==e&&4!==e||(t=!0,this.$g.uNb(),this.clear(),this.Ze.RL=!1);return t}$9m(e,t){vc.a.xBc(e,"ContentControl.InsertHtml");
if(!this.Ze.isEditable)return vc.a.Wzc(this._context.appId,"ContentControl.InsertHtml",void 0,Mt.a[t]),null;const E=(new Date).getTime();if(this.Ze.wfe||this.Ze.Poc)return z.ULS.sendTraceTag(19482261,369,15,"AppId:{0}, content control with Binding is not allowed for insertHtml API in ContentControl class.",this._context.appId),vc.a.rC(),null;if(2===t||3===t||4===t){const W=this.Ze.TG(),ha=this.Ze.Ud;let Ka=this.Ze.id;return this.Tp.mZb(Ka)?(z.ULS.sendTraceTag(19482262,369,15,"AppId:{0}, failed to release content control for insertHtml API in ContentControl class.",
this._context.appId),vc.a.ng(),null):this.jx.insertHtml(W,e,t,E,this._context,!0).then(()=>{let sb=!1;if(1===W.count&&W.J(0).contextId===na.a.Xc){sb=!0;let dc=new fa.a;dc.add(W.J(0));dc=this.od.insertText(dc," ",3);W.Z(0,dc.J(0))}if(({id:Ka}=this.Tp.SVk(W,ha)).returnValue)return z.ULS.sendTraceTag(19482263,369,10,"AppId:{0}, failed to restore the content control for insertHtml API in ContentControl class.",this._context.appId),vc.a.ng(),null;this.Ze=this.Tp.getById(Ka);sb&&this.Ze.Gye("");return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.$k.create(W,
this._context))})}z.ULS.sendTraceTag(19482264,369,15,"AppId:{0}, invalid argument for insertHtml API in ContentControl class.",this._context.appId);vc.a.qd();return null}a$m(e,t){const E=(new Date).getTime();vc.a.xBc(e,"ContentControl.InsertHtml");const W=this.Rnc(t);let ha=new fa.a;switch(t){case 2:case 3:ha.add(this.GPb(t));break;case 4:ha=this.hkc();break;default:z.ULS.sendTraceTag(22062857,369,15,"AppId:{0}, invalid argument for insertHtml API in ContentControl class.",this._context.appId),vc.a.qd()}W&&
this.$g.bKa();return this.jx.insertHtml(ha,e,t,E,this._context)}ssl(){this.Ze.clear()&&vc.a.ng()}tsl(){this.od.ELb(this.hkc())}ZPl(e){(e?this.Tp.mZb(this.id):this.Tp.NPl(this.id))&&vc.a.ng()}$Pl(e){e?(e=!1,this.Ze.RL&&(e=!0,this.$g.uNb(),this.clear()),this.Tp.mZb(this.id)&&vc.a.ng(),e&&this.$g.bKa()):this.od.Ogc(this.Ze.TG())}get Ud(){return this.Ze.Ud}get UR(){return this.Ze.Ud.UR}set UR(e){this.Ze.Ud.UR=e}set text(e){v.AFrameworkApplication.$u&&this.Ze.Gye(e)}a8c(e,t,E){const W=(new Date).getTime();
let ha=null,Ka=!1;switch(t){case 4:Ka=!0;this.$g.uNb();this.clear();ha=this.GPb(2);break;case 3:case 2:Ka=this.Rnc(t);ha=this.GPb(t);break;default:z.ULS.sendTraceTag(20047956,369,15,"AppId:{0}, invalid argument for insertInlinePictureFromBase64 API in ContentControl class.",this._context.appId),vc.a.qd()}ha||(z.ULS.sendTraceTag(20047957,369,50,"AppId:{0}, user wants to insert an image into content control but a wrong place or something wrong.",this._context.appId),vc.a.ng());Ka&&this.$g.bKa();let sb;
this.od.GW((sb=new fa.a,sb.add(ha),sb),t,0);v.AFrameworkApplication.$u&&E?(this._context.An.yv(),t=this.Yx.eSb(e,ha,this._context,E)):t=this.Yx.eSb(e,ha,this._context);return t.then(dc=>{v.AFrameworkApplication.$u||this._context.An.yv();if(!dc)return z.ULS.sendTraceTag(20047958,369,10,"AppId:{0}, something went wrong when insert iamge into ContentControl.",this._context.appId),vc.a.vP("ContentControl.InsertInlinePictureFromBase64",vc.a.fQ(W),e.length,!1),vc.a.ng(),null;vc.a.vP("ContentControl.InsertInlinePictureFromBase64",
vc.a.fQ(W),e.length);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.rO.create(this.Yx.D0c(dc),this._context))})}APb(){if(v.AFrameworkApplication.$u)return this.Ze.TG()}mMm(){return this.$g.b9c(this.Ze)?0===this.Ze.type?this.Ze.fg?this.b$k()?16:2:1:1===this.Ze.type?this.Ze.fg?64:32:0:0}b$k(){const e=this.Ze.start.node,t=this.Ze.end.node;var E=Ld.GraphIterator.eb(e);if(E.zb(14)){var W=E.ld(14);E=this.jb.Zl(W);W=this.jb.hD(W);if(E&&W&&e.id===E.id&&t.id===W.id)return!0}return!1}mpb(e){96===
this.type&&0!==e&&1!==e&&vc.a.rC()}Lki(e){512===this.type&&0!==e&&1!==e&&vc.a.rC()}ZNb(e){this.mpb(e);this.Lki(e)}}Object(y.a)(Lz,"ContentControl",si.a,[1143]);class $n{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud){this.fd=this.$g=this.rO=this.$k=this.Co=null;this.BC=e;this.Tp=t;this.Qq=E;this.EB=W;this.od=ha;this.Yx=Ka;this.BB=sb;this.jx=dc;this.$m=xc;this.Zn=Rc;this.jb=md;this.frk=ud}zv(e,t,E,W,ha,Ka,sb){this.Co=e;this.$k=t;this.rO=E;this.$g=W;this.fd=ha;this.RZ=Ka;this.Wx=sb}create(e,t){return new Lz(e,
t,this.Tp,this,this.Co,this.$k,this.BC,this.rO,this.Qq,this.EB,this.od,this.$g,this.Yx,this.BB,this.jx,this.$m,this.Zn,this.fd,this.jb,this.frk,this.RZ,this.Wx)}}Object(y.a)($n,"ContentControlFactory",null,[1169]);class Xv extends si.a{constructor(e){super();vc.a.yz(e,"ContentCollection");this.Uwa=e}length(){return this.Uwa.count}_GetItem(e){e=vc.a.KS(e);if(0<=e&&e<this.length())return this.Uwa.J(e);z.ULS.sendTraceTag(17093347,369,10,"The index is out of the ContentControlCollection range.");vc.a.qd();
return null}get _ReferenceId(){return this.gr?this.Gr:null}getByChangeTrackingStates(e){vc.a.EGp()||vc.a.il();if(null===e||void 0===e||!e.length)return null;let t=0;for(const E of e)0<=E&&4>=E?t|=E:vc.a.qd();e=new fa.a;for(const E of this.Uwa)E.isValid()&&(null!=E.Ud.Tv?this.NXf(t,4)&&e.add(E):null!=E.Ud.ex?this.NXf(t,2)&&e.add(E):this.NXf(t,1)&&e.add(E));return new Xv(e)}getById(e){(e=this.getByIdOrNullObject(e))||vc.a.hl();return e}getByIdOrNullObject(e){let t=null;for(const E of this.Uwa)if(E.id===
e&&E.isValid()){t=E;break}return t}getByTag(e){return this.Gui(t=>t.tag===e)}getByTitle(e){return this.Gui(t=>t.title===e)}getByTypes(e){vc.a.fj()||vc.a.il();const t=new fa.a;for(const E of this.Uwa)if(E.isValid())for(const W of e)if(0<(E.subtype&W)){t.add(E);break}return new Xv(t)}getFirst(){const e=this.getFirstOrNullObject();e||vc.a.hl();return e}getFirstOrNullObject(){vc.a.fj()||vc.a.il();return this.Uwa&&0<this.Uwa.count?this.Uwa.J(0):null}getItem(e){e=vc.a.KS(e);return this.getById(e)}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,
t){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.ContentControlCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1010:return this.Yjm(t);case 1002:return this.l2c(t);case 1008:return this.m2c(t);case 1004:return this.bkm(t);case 1003:return this.ckm(t);case 1006:return this.KHf(t);case 1007:return this.nI();case 1009:return this.oI();case 1:return this.P_(t);case 1001:return this.ri();case 1005:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}getContentControls(){return this.Uwa&&0<this.Uwa.count?Array.from(this.Uwa):[]}Yjm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<int>");return this.getByChangeTrackingStates(e)}l2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getById(e)}m2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");
return this.getByIdOrNullObject(e)}bkm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getByTag(e)}ckm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getByTitle(e)}KHf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<int>");return this.getByTypes(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}P_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");
return this.getItem(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}NXf(e,t){return 0!==(e&t)}Gui(e){if(!e)return null;const t=new fa.a;for(const E of this.Uwa)e(E)&&E.isValid()&&t.add(E);return new Xv(t)}}Object(y.a)(Xv,"ContentControlCollection",si.a,[1143,1215]);class SG{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md){this.Tp=e;this.JK=t;this.x5=E;this.od=W;this.fG=ha;this.Wm=Ka;this.HTe=sb;this.Bp=dc;this.jb=xc;this.Bo=Rc;this.Qq=md}get tF(){return null!=this.OUg?this.OUg:
this.OUg=(()=>this.HTe())()}b9c(e){switch(e.type){case 0:return!0;case 1:return vc.a.tFa;case 8:return vc.a.jda;default:return!1}}uti(e=null){const t=this.Tp.Tgm();return this.H9d(t,e)}nlc(e,t,E=null){e=this.Tp.mN(e,t,1);return this.H9d(e,E)}H9d(e,t=null){if(!e||!this.x5)return null;const E=new fa.a;for(const W of e)this.b9c(W)&&E.add(this.x5.create(W,t));return new Xv(E)}vMm(e,t=null){e=this.jb.SA(e,!0,!1);return 0>=e.count?null:this.nlc(e.J(0),e.J(e.count-1),t)}tEi(e,t){return this.Tp.mN(e,t,3,
!0)}olc(e,t,E=null){t=this.Tp.mN(e,t,3,!0);e=null;if(0<t.count)if(this.b9c(t.J(0)))e=t.J(0);else for(t=t.J(0),t=t.parentId;t=this.Tp.getById(t);){if(this.b9c(t)){e=t;break}t=t.parentId}return e?this.x5.create(e,E):null}thf(e){if(e.count){var t=e.J(0),E=e.J(e.count-1);if(t.contextId===na.a.Vc){var W=this.jb.textLength(t.node)?Zd.a.zx(t.node):Zd.a.create(t.node);W.Fb=t.vo();W.Tb=t.wo();t===E&&(E=W);t=W}E.contextId!==na.a.Vc||this.jb.textLength(E.node)||(W=Zd.a.create(E.node),W.Tb=E.wo(),E=W);if((df.SelectionEditor.mw(t)&&
df.SelectionEditor.atb(t)||this.jb.nn(t))&&df.SelectionEditor.mw(E)&&df.SelectionEditor.atb(E)){W=this.Bp.X8a(t.node,t.lk,t.Fb,!0);const ha=this.Bp.X8a(E.node,E.Ep,E.Tb,!1);if(!W&&!ha||W&&ha&&W.pe.equals(ha.pe)&&W.fg)W=Zd.a.create(E.node),W.Fb=E.Fb,W.Tb=E.Tb,E=W}e.Z(0,t);e.Z(e.count-1,E)}}Nqa(e,t,E,W=0,ha=!1){let Ka=0;if(e=({id:Ka}=this.Tp.$Uk(e,t,W,ha)).returnValue){if(ha)return e;z.ULS.sendTraceTag(17148101,369,15,"AppId:{0}, failed to create a new block content control.",E.appId);vc.a.ng();return null}if(ha)return e;
ha=this.Tp.getById(Ka);Aq.a.Iie(ha.objectId);ha.type=W;return this.x5.create(ha,E)}U5a(e,t,E=0,W=!1){let ha=0;if(e=({id:ha}=this.Tp.U5a(e,null,E,W)).returnValue){if(W)return e;z.ULS.sendTraceTag(17148102,369,15,"AppId:{0}, failed to create a new inline content control.",t.appId);vc.a.ng();return null}if(W)return e;W=this.Tp.getById(ha);if(v.AFrameworkApplication.$u&&W&&null===W.start)return 2;Aq.a.Iie(W.objectId);W.type=E;return this.x5.create(W,t)}gX(e,t){return this.Tp.gX(e,t)}iab(e){return this.fG.iab(e)}uNb(){this.JK&&
this.JK.uNb("RelateToSelection")}bKa(){this.JK&&this.JK.bKa("RelateToSelection")}select(e){this.Wm.select(e.objectId,!0)}Vsd(e){this.tF&&df.SelectionEditor.mf(e)&&this.tF.Vsd(e)}pPa(e,t){if(!this.tF||!df.SelectionEditor.mf(e))return e;var E=t.J(0),W=Zd.a.Tc(E.node,E.lk);W.Tb=W.Fb=E.Fb;E=t.J(t.count-1);var ha=Zd.a.Tc(E.node,E.Ep);ha.Tb=ha.Fb=E.Tb;E=df.SelectionEditor.gl(E)||E.contextId===na.a.paragraph;const Ka=new fa.a;Ka.add(W);Ka.add(ha);for(W=this.BAi(e.node,e.cpBegin,e.Fb);W;){ha=e.node.id;e=
this.Q0l(W,e,Ka);if(!e.node.id.equals(ha)&&(W=this.Bp.jwi(e.node,W.pe),!W)){z.ULS.sendTraceTag(36459329,369,15,"Failed to find content control start boundary after split.");vc.a.ng();break}this.P0l(W,Ka);W=this.Bp.jwi(W.Jb.paragraph,W.pe);ha=W.Jb.Hb.DL(W.pe,!0);W=Zd.a.Tc(W.Jb.paragraph,W.Jb.cp);W.Tb=W.Fb=ha+1;if(!this.tF.pPa(W)){z.ULS.sendTraceTag(36459330,369,15,"Failed to Convert inline content control to block.");vc.a.ng();break}W=this.BAi(e.node,e.cpBegin,e.Fb)}E=this.UAm(Ka,E);!t.count||E&&E.count||
(z.ULS.sendTraceTag(36459332,369,15,"GncList is empty after conversion"),vc.a.ng());t.clear();t.addRange(E);return e}Q0l(e,t,E){if(!e.Jb.cp)return t;E.add(t);this.QWj(e,!0,E);t=E.J(E.count-1);E.removeAt(E.count-1);return t}P0l(e,t){(e=this.Bp.Rmm(e))?e.Jb.cp!==this.jb.textLength(e.Jb.paragraph)&&this.QWj(e,!1,t):(z.ULS.sendTraceTag(36459333,369,15,"Failed to find content control end boundary."),vc.a.ng())}QWj(e,t,E){var W=e.Jb;e=W.Hb.DL(e.pe,e.Wc);W=Zd.a.Tc(W.paragraph,W.cp);W.Tb=W.Fb=e+(t?0:1);t=
new fa.a;for(var ha of E)t.add(this.Kdc(ha,W));({Bgc:ha}=this.od.dnc(W,!1));ha=this.Bo.Le(ha);for(e=0;e<E.count;e++)E.Z(e,this.Swm(E.J(e),W,ha,t.J(e)))}bYf(e,t){return e.node.id.equals(t.node.id)&&(e.cpBegin>t.cpBegin||e.cpBegin===t.cpBegin&&e.vo()>t.vo())}ybl(e,t){return this.Kdc(e,t)}Kdc(e,t=null,E=!1){return t&&!this.bYf(e,t)?null:this.Bp.X8a(e.node,e.cpBegin,e.Fb,E)}TGo(e,t,E,W){this.uve(e,t,E,W)}uve(e,t,E=null,W=null,ha=!1){E&&W&&!this.bYf(E,W)||(E=e.node.qa.sh(ha?e.lk:e.Ep))&&E.Hb&&E.Hb.length&&
(t=t?E.Hb.DL(t.pe,t.Wc):-1,t=ha?0<=t?t+1:0:0<=t?t:E.Hb.length,e.contextId===na.a.Xc?e.Tb=e.Fb=t:ha?e.Fb=t:e.Tb=t)}Swm(e,t,E,W){if(!this.bYf(e,t))return e;E=Zd.a.Tc(E,e.cpBegin-t.cpBegin);this.uve(E,W,e,t);return E}BAi(e,t,E){e=this.Bp.aba(e,t,E);for(const W of e)if(!W.fg)return W;return null}UAm(e,t){const E=e.J(0);e=e.J(e.count-1);return this.Qq.jzi(E,e,t)}}Object(y.a)(SG,"ContentControlOperations",null,[1308]);class Yv extends si.a{constructor(e,t,E){super();this._context=e;this.sl=t;this.B5=E}get id(){return this.B5.id}get namespaceUri(){return this.B5.namespace}get _ReferenceId(){return this.gr?
this.Gr:null}deleteObject(){this.knb();this.sl.Gei(this.id)!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&vc.a.qd()}deleteAttribute(e,t,E){this.knb();e=this.bRb(t,e);e=this.Wxb(e);1!==e.length&&vc.a.qd();e[0].removeAttribute(E);this.B5.save()}deleteElement(e,t){this.knb();e=this.bRb(t,e);e=this.Wxb(e);1!==e.length&&vc.a.qd();e[0].parentNode.removeChild(e[0]);this.B5.save()}getXml(){return this.B5.j1a}insertAttribute(e,t,E,W){this.knb();e=this.bRb(t,e);e=this.Wxb(e);1!=e.length&&vc.a.qd();e[0].setAttribute(E,
W);this.B5.save()}insertElement(e,t,E,W){this.knb();e=this.bRb(E,e);e=this.Wxb(e);1!==e.length&&vc.a.qd();W||0===W?W>e[0].childNodes.length&&vc.a.qd():W=e[0].childNodes.length;t=new OSF.XmlProcessor(t,"");e[0].insertBefore(t.getDocumentElement(),W===e[0].childNodes.length?null:e[0].childNodes[W])||vc.a.qd();this.B5.save()}query(e,t){e=this.bRb(t,e);e=this.Wxb(e,!1);t=[];if(e)for(let E=0;E<e.length;E++){const W=this.B5.getNodeXml(e[E]);t.push(W)}return t}setXml(e){this.knb();const t=this.Wxb("/",!1);
t&&(this.B5.setNodeXml(t[0].firstChild,e)||vc.a.qd())}updateAttribute(e,t,E,W){this.knb();e=this.bRb(t,e);e=this.Wxb(e);1!==e.length&&vc.a.qd();e[0].hasAttribute(E)?e[0].setAttribute(E,W):vc.a.qd();this.B5.save()}updateElement(e,t,E){this.knb();e=this.bRb(E,e);e=this.Wxb(e);1!==e.length&&vc.a.qd();this.B5.setNodeXml(e[0],t)||vc.a.qd()}bRb(e,t){const E=Object.keys(e);for(let W=0;W<E.length;W++){const ha=E[W],Ka=this.B5.T3c(e[ha]);Ka&&(t=t.replace("/"+ha+":","/"+Ka+":"))}return t}Wxb(e,t=!0){let E;
try{E=this.B5.selectNodes(e,null)}catch(W){t&&vc.a.qd()}t&&!E&&vc.a.qd();return E}knb(){this.B5.builtIn&&vc.a.qd()}_KeepReference(){this.Wq()}_OnAccess(){this._context.An.Nec(this.sl.uka.currentNode);this.B5.YZf()||this.B5.$Mg();vc.a.c5(this.B5.eR,"CustomXmlPart")}getTypeName(){return"Microsoft.WordServices.CustomXmlPart"}invokePropertyGet(e){switch(e){case 2:return this.id;case 3:return this.namespaceUri;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.yF(t);case 1012:return this.JPl(t);case 1009:return this.dQl(t);case 1004:return this.URm();case 1010:return this.n9m(t);
case 1007:return this.L9m(t);case 1006:return this.Wjo(t);case 1005:return this.a_o(t);case 1011:return this.Stp(t);case 1008:return this.Fvp(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}yF(){this.deleteObject();return null}JPl(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,
"string"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"string");this.deleteAttribute(t,E,e);return null}dQl(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");this.deleteElement(t,e);return null}URm(){return this.getXml()}n9m(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),
E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"string");this.insertAttribute(t,E,W,e);return null}L9m(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"any");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
3,"int?");this.insertElement(t,E,W,e);return null}Wjo(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");return this.query(t,e)}a_o(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.setXml(e);return null}Stp(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
2,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"string");this.updateAttribute(t,E,W,e);return null}Fvp(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"any");this.updateElement(t,E,e);return null}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(Yv,"CustomXmlPart",
si.a,[1143]);class Pq{constructor(e){this.sl=e}zv(){}create(e,t){return new Yv(t,this.sl,e)}}Object(y.a)(Pq,"CustomXmlPartFactory",null,[1169]);class Jx extends si.a{constructor(e){super();this.Stk=e}get body(){vc.a.rC();return null}get contentControls(){vc.a.rC();return null}get customXmlParts(){vc.a.rC();return null}get properties(){vc.a.rC();return null}get saved(){return!1}get sections(){vc.a.rC();return null}get settings(){vc.a.rC();return null}get _ReferenceId(){return this.gr?this.Gr:null}addStyle(){vc.a.rC();
return null}deleteBookmark(){vc.a.rC()}getBookmarkRange(){vc.a.rC();return null}getBookmarkRangeOrNullObject(){vc.a.rC();return null}getContentControls(){vc.a.rC();return null}insertFileFromBase64(){vc.a.rC();return null}getStyles(){vc.a.rC();return null}open(){return OfficeExtension.WacRuntime.Utility.createPromise(e=>{const t=new Pa.StandardDialog;t.Gd=4;t.Ix(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,E=>{1===E&&tb.a.yn(this.Stk,void 0,void 0,"ExtensionPackage.OpenDialog");
e(null)})})}save(){vc.a.rC()}_KeepReference(){this.Wq()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.DocumentCreated"}invokePropertyGet(e){switch(e){case 3:return this.body;case 4:return this.contentControls;case 8:return this.customXmlParts;case 6:return this.properties;case 1:return this.saved;case 2:return this.sections;case 7:return this.settings;case 5:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1028:return this.Pff(t);case 1011:return this.Iwf(t);case 1010:return this.DHf(t);case 1012:return this.EHf(t);case 1013:return this.FKa(t);case 1029:return this.zOf();case 1005:return this.Twg(t);
case 1008:return this.ri();case 1007:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1009:return this.s5n();case 1014:return this.sta(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Pff(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.addStyle(t,e)}Iwf(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.deleteBookmark(e);return null}DHf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getBookmarkRange(e)}EHf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getBookmarkRangeOrNullObject(e)}FKa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,Pm);return this.getContentControls(e)}sta(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,Co);return this.insertFileFromBase64(t,E,e)}zOf(){return this.getStyles()}s5n(){return this.open()}Twg(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string");this.save(t,e);return null}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}
Object(y.a)(Jx,"DocumentCreated",si.a,[1143]);class My{create(e){return new Jx(e)}}Object(y.a)(My,"DocumentCreatedFactory",null,[]);var eq=d(238),yr=d(228);class Mw extends si.a{constructor(e,t,E,W,ha){super();this._context=e;this.sl=t;this.Fda=E;this.gFk=W;this.k2a=ha}length(){return this.getCount()}_GetItem(e){if(vc.a.KS(e)<this.length())return this.Fda.J(e);vc.a.qd();return null}get _ReferenceId(){return this.gr?this.Gr:null}getCount(){this.Gfb();return this.Fda.count}getItem(e){(e=this.getItemOrNullObject(e))||
vc.a.hl();return e}getItemOrNullObject(e){this.Gfb();for(let t=0;t<this.Fda.count;t++)if(this.Fda.J(t).id==e)return this.Fda.J(t);return null}getOnlyItem(){const e=this.getOnlyItemOrNullObject();e||vc.a.hl();return e}getOnlyItemOrNullObject(){this.Gfb();return 1==this.getCount()?this.Fda.J(0):null}Gfb(){const e=this.sl.W1c(),t=new fa.a;for(let E=0;E<e.length;E++)if(e[E].namespace===this.gFk){const W=this.k2a.create(e[E],this._context);e[E].builtIn&&0!=t.count?t.insert(0,W):t.add(W)}this.Fda=t}_KeepReference(){this.Wq()}_OnAccess(){this._context.An.Nec(this.sl.uka.currentNode)}getAsyncEnumerator(e,
t){this.Gfb();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.CustomXmlPartScopedCollection"}invokePropertyGet(e){switch(e){case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.Z8a();case 2:return this.P_(t);case 1004:return this.t9a(t);case 1005:return this.GCm();case 1006:return this.HCm();case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Z8a(){return this.getCount()}P_(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItem(e)}t9a(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItemOrNullObject(e)}GCm(){return this.getOnlyItem()}HCm(){return this.getOnlyItemOrNullObject()}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(Mw,"CustomXmlPartScopedCollection",si.a,[1143,1215]);class EC extends si.a{constructor(e,t,E,W,ha){super();this._context=e;this.sl=
t;this.Fda=E;this.k2a=W;this.Pc=ha}length(){return this.getCount()}_GetItem(e){if(vc.a.KS(e)<this.length())return this.Fda.J(e);vc.a.qd();return null}get _ReferenceId(){return this.gr?this.Gr:null}add(e){let t=null;({qed:t}=this.sl.Lef(e)).returnValue!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&vc.a.qd();e=new Cf(t,this.Pc);return this.k2a.create(e,this._context)}getByNamespace(e){this.Gfb();const t=this.Fda,E=new fa.a;for(let W=0;W<t.count;W++)t[W].namespace===e&&E.add(this.k2a.create(t[W],
this._context));return 0==E.count?null:new Mw(this._context,this.sl,E,e,this.k2a)}getCount(){this.Gfb();return this.Fda.count}getItem(e){(e=this.getItemOrNullObject(e))||vc.a.hl();return e}getItemOrNullObject(e){this.Gfb();for(let t=0;t<this.Fda.count;t++)if(this.Fda.J(t).id==e)return this.Fda.J(t);return null}Gfb(){const e=this.sl.W1c(),t=new fa.a;for(let E=0;E<e.length;E++){const W=this.k2a.create(e[E],this._context);e[E].builtIn&&0!=t.count?t.insert(0,W):t.add(W)}this.Fda=t}_KeepReference(){this.Wq()}_OnAccess(){this._context.An.Nec(this.sl.uka.currentNode)}getAsyncEnumerator(e,
t){this.Gfb();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.CustomXmlPartCollection"}invokePropertyGet(e){switch(e){case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1004:return this.zSc(t);case 1005:return this.akm(t);case 1003:return this.Z8a();case 2:return this.P_(t);case 1006:return this.t9a(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}zSc(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.add(e)}akm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getByNamespace(e)}Z8a(){return this.getCount()}P_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItem(e)}t9a(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItemOrNullObject(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();
return null}}Object(y.a)(EC,"CustomXmlPartCollection",si.a,[1143,1215]);var Ny=d(1669);class wp extends si.a{constructor(e){super();vc.a.yz(e,"SectionCollection");this.rPc=e}length(){return this.rPc.count}get _ReferenceId(){return this.gr?this.Gr:null}getFirst(){const e=this.getFirstOrNullObject();e||vc.a.hl();return e}getFirstOrNullObject(){vc.a.fj()||vc.a.il();return this.rPc&&this.rPc.count?this.rPc.J(0):null}_GetItem(e){e=vc.a.KS(e);if(0<=e&&e<this.length())return this.rPc.J(e);z.ULS.sendTraceTag(16814432,
369,10,"The index is out of the section range.");vc.a.qd();return null}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,t){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.SectionCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.nI();case 1004:return this.oI();case 1:return this.NY(t);case 1001:return this.ri();case 1002:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}NY(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(wp,"SectionCollection",si.a,[1143,1215]);class Qo extends si.a{constructor(e,t,E){super();this.W5=e;this.gia=t;this.h2=E}get key(){return this.W5}get value(){return this.h2.get(this.W5).getValue(fd.a.kdc)}set value(e){this.h2.get(this.W5).setValue(fd.a.kdc,e)}get _Id(){return null}get _ReferenceId(){return this.gr?this.Gr:
null}deleteObject(){const e=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorSettingsChangedEventIsEnabled"),t=new Ld.GraphIterator;t.set(this.gia);let E=t.Ub(21);for(;E;){if(E.getValue(fd.a.jTc)===this.W5){t.S7a(!e);break}E=t.Lf(21)}e&&this.gia.fC(21);this.gia.setValue(Tb.a.NU,new Date);this.h2.delete(this.W5)}_KeepReference(){this.Wq()}_OnAccess(){vc.a.c5(this.h2.get(this.W5),"Setting")}getTypeName(){return"Microsoft.WordServices.Setting"}invokePropertyGet(e){switch(e){case 2:return this.key;
case 3:return this.value;case 4:return this._Id;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 3:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"any");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,
t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.yF(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}yF(){this.deleteObject();return null}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(Qo,"Setting",
si.a,[1143]);class xE extends si.a{constructor(e,t){super();this.gia=e;this.rac=t;this.h2=new Map}get _ReferenceId(){return this.gr?this.Gr:null}add(e,t){e||vc.a.qd();this.JPa();if(this.h2.has(e))this.h2.get(e).setValue(fd.a.kdc,t),this.gia.setValue(Tb.a.NU,new Date);else{const E=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorSettingsChangedEventIsEnabled");t=this.rac.Auf(e,t);const W=Rd.a.create(),ha=new Ld.GraphIterator;ha.set(this.gia);ha.w6(t,21,new Hb.a(W,1),!E);E&&this.gia.fC(21);
this.gia.setValue(Tb.a.NU,new Date);this.h2.set(e,t)}return new Qo(e,this.gia,this.h2)}deleteAll(){this.h2.clear();const e=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorSettingsChangedEventIsEnabled"),t=new Ld.GraphIterator;for(t.set(this.gia);t.Ub(21);)t.S7a(!e);e&&this.gia.fC(21);this.gia.setValue(Tb.a.NU,new Date)}getCount(){this.JPa();return this.h2.size}getItem(e){this.JPa();(e=this.cLf(e))||vc.a.hl();return e}getItemOrNullObject(e){this.JPa();return this.cLf(e)}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,
t){this.JPa();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.SettingCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.zSc(t);case 1005:return this.Fwf();case 1004:return this.Z8a();case 1:return this.P_(t);case 1006:return this.t9a(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}length(){return this.h2.size}_GetItem(e){e=
vc.a.KS(e);if(0>e||e>=this.h2.size)return vc.a.qd(),null;const t=this.h2.keys();let E="";for(let W=0;W<=e;W++)E=t.next().value;return this.cLf(E)}zSc(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");return this.add(t,e)}Fwf(){this.deleteAll();return null}Z8a(){return this.getCount()}P_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItem(e)}t9a(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItemOrNullObject(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}JPa(){this.h2.clear();const e=new Ld.GraphIterator;e.set(this.gia);let t=e.Ub(21);for(;t;){const E=t.getValue(fd.a.jTc);this.h2.set(E,t);t=e.Lf(21)}}cLf(e){return this.h2.has(e)?new Qo(e,this.gia,this.h2):null}}Object(y.a)(xE,"SettingCollection",si.a,[1143,1215]);class iu extends si.a{constructor(e,t){super();this._style=
e;this.Zv=t}get alignment(){if(this._style.hasProperty(Tb.a.Rh))switch(this._style.getValue(Tb.a.Rh)){case 1:return 0;case 2:return 1;case 3:return 2;case 6:case 7:case 9:case 11:case 10:case 13:return 3;default:return-1}}set alignment(e){let t=0;switch(e){case 0:t=1;break;case 2:t=3;break;case 1:t=2;break;case 3:t=6;break;default:z.ULS.sendTraceTag(509097629,369,15,"set ParagraphFormat.Alignment with not supported value: {0}.",e),vc.a.qd()}e=new Map;e.set(Tb.a.Rh,t);this.wD(e)}get firstLineIndent(){if(this._style.hasProperty(fd.a.hC)){const e=
this._style.getValue(fd.a.hC);return Ve.a.Xha(e)}}set firstLineIndent(e){e=Ve.a.RF(e);const t=new Map;0<=e?t.set(fd.a.hC,e):t.set(fd.a.mu,e);this.wD(t)}get keepTogether(){if(this._style.hasProperty(ad.a.keepTogether))return this._style.getValue(ad.a.keepTogether)}set keepTogether(e){vc.a.yz(e,"ParagraphFormat.KeepTogether");const t=new Map;t.set(ad.a.keepTogether,e);this.wD(t)}get keepWithNext(){if(this._style.hasProperty(ad.a.keepWithNext))return this._style.getValue(ad.a.keepWithNext)}set keepWithNext(e){vc.a.yz(e,
"ParagraphFormat.KeepWithNext");const t=new Map;t.set(ad.a.keepWithNext,e);this.wD(t)}get leftIndent(){if(this._style.hasProperty(fd.a.fe)){const e=this._style.getValue(fd.a.fe);return Ve.a.Xha(e)}}set leftIndent(e){const t=new Map;t.set(fd.a.fe,Ve.a.RF(e));this.wD(t)}get lineSpacing(){if(this._style.hasProperty(fd.a.xa)){const e=this._style.getValue(fd.a.xa);return Ve.a.Xha(e)}}set lineSpacing(e){vc.a.W0a(e,"ParagraphFormat.LineSpacing");const t=new Map;t.set(fd.a.xa,Ve.a.RF(e));this.wD(t)}get lineUnitAfter(){if(this._style.hasProperty(fd.a.G0))return this._style.getValue(fd.a.G0)/
100;if(this._style.hasProperty(fd.a.ta)){const e=this._style.getValue(fd.a.ta);return Ve.a.Xha(e)/12}}set lineUnitAfter(e){vc.a.V0a(e,"ParagraphFormat.LineUnitAfter");const t=new Map;t.set(fd.a.G0,100*e);t.set(fd.a.x8,!1);this.wD(t)}get lineUnitBefore(){if(this._style.hasProperty(fd.a.H0))return this._style.getValue(fd.a.H0)/100;if(this._style.hasProperty(fd.a.wj)){const e=this._style.getValue(fd.a.wj);return Ve.a.Xha(e)/12}}set lineUnitBefore(e){vc.a.V0a(e,"ParagraphFormat.LineUnitBefore");const t=
new Map;t.set(fd.a.H0,100*e);t.set(fd.a.y8,!1);this.wD(t)}get mirrorIndents(){}set mirrorIndents(e){}get outlineLevel(){if(this._style.hasProperty(fd.a.vj))return this._style.getValue(fd.a.vj)}set outlineLevel(e){if(0>e||9<e)z.ULS.sendTraceTag(509097628,369,10,"Set OutlineLevel with not supported value: {0}.",e),vc.a.qd();const t=new Map;t.set(fd.a.vj,e);this.wD(t)}get rightIndent(){if(this._style.hasProperty(fd.a.mv)){const e=this._style.getValue(fd.a.mv);return Ve.a.Xha(e)}}set rightIndent(e){const t=
new Map;t.set(fd.a.mv,Ve.a.RF(e));this.wD(t)}get spaceAfter(){if(this._style.hasProperty(fd.a.G0))return this._style.getValue(fd.a.G0)/100*12;if(this._style.hasProperty(fd.a.ta)){const e=this._style.getValue(fd.a.ta);return Ve.a.Xha(e)}}set spaceAfter(e){vc.a.V0a(e,"ParagraphFormat.SpaceAfter");const t=new Map;t.set(fd.a.ta,Ve.a.RF(e));t.set(fd.a.x8,!1);this._style.qg(fd.a.G0);this.wD(t)}get spaceBefore(){if(this._style.hasProperty(fd.a.H0))return this._style.getValue(fd.a.H0)/100*12;if(this._style.hasProperty(fd.a.wj)){const e=
this._style.getValue(fd.a.wj);return Ve.a.Xha(e)}}set spaceBefore(e){vc.a.V0a(e,"ParagraphFormat.SpaceBefore");const t=new Map;t.set(fd.a.wj,Ve.a.RF(e));t.set(fd.a.y8,!1);this._style.qg(fd.a.H0);this.wD(t)}get widowControl(){if(this._style.hasProperty(ad.a.widowControl))return this._style.getValue(ad.a.widowControl)}set widowControl(e){vc.a.yz(e,"ParagraphFormat.WidowControl");const t=new Map;t.set(ad.a.widowControl,e);this.wD(t)}get _ReferenceId(){return this.gr?this.Gr:null}_KeepReference(){return this.Wq()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.ParagraphFormat"}invokePropertyGet(e){switch(e){case 2:return this.alignment;
case 3:return this.firstLineIndent;case 4:return this.keepTogether;case 5:return this.keepWithNext;case 6:return this.leftIndent;case 7:return this.lineSpacing;case 8:return this.lineUnitAfter;case 9:return this.lineUnitBefore;case 10:return this.mirrorIndents;case 11:return this.outlineLevel;case 12:return this.rightIndent;case 13:return this.spaceAfter;case 14:return this.spaceBefore;case 15:return this.widowControl;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 2:this.alignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return;case 3:this.firstLineIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 4:this.keepTogether=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 5:this.keepWithNext=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"boolean");return;case 6:this.leftIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 7:this.lineSpacing=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 8:this.lineUnitAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 9:this.lineUnitBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 10:this.mirrorIndents=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"boolean");return;case 11:this.outlineLevel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return;case 12:this.rightIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 13:this.spaceAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 14:this.spaceBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 15:this.widowControl=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){switch(e){case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}ri(){this._KeepReference();
return null}si(){this._OnAccess();return null}wD(e){const t=this._style.getValue(fd.a.ma),E=new Zc.ScriptSharpLegacyMap;for(const W of e)E.Z(W[0],W[1]);this.Zv.DYa(t,E,Pd.a.Mp())}}Object(y.a)(iu,"ParagraphFormat",si.a,[1143]);class st extends si.a{constructor(e,t,E){super();this.BC=e;this._style=t;this.Zv=E;this.uIk=new iu(this._style,this.Zv);this._font=this.BC.create(null,null,null,null,null,this._style)}get baseStyle(){if(this._style.hasProperty(fd.a.pa))return this._style.getValue(fd.a.pa)}get builtIn(){}get description(){}get font(){return this._font}get inUse(){if(this._style.hasProperty(fd.a.J2i))return this._style.getValue(fd.a.J2i)}get linked(){return this._style.hasProperty(fd.a.linkedStyle)?
!0:!1}get listTemplate(){return null}get nameLocal(){return this._style.getValue(gb.a.la)}get nextParagraphStyle(){if(this._style.hasProperty(gb.a.ee))return this._style.getValue(gb.a.ee)}get paragraphFormat(){return this.uIk}get priority(){if(this._style.hasProperty(ad.a.oa))return this._style.getValue(ad.a.oa)}set priority(e){vc.a.V0a(e,"Style.Priority");this.wD(ad.a.oa,e)}get quickStyle(){if(this._style.hasProperty(fd.a.Hd))return this._style.getValue(fd.a.Hd)}set quickStyle(e){vc.a.yz(e,"Style.QuickStyle");
this.wD(fd.a.Hd,e)}get type(){return this._style.getValue(gb.a.na)}get unhideWhenUsed(){if(this._style.hasProperty(fd.a.unhideWhenUsed))return this._style.getValue(fd.a.unhideWhenUsed)}set unhideWhenUsed(e){vc.a.yz(e,"Style.UnhideWhenUsed");this.wD(fd.a.unhideWhenUsed,e)}get visibility(){if(this._style.hasProperty(fd.a.pmb))return this._style.getValue(fd.a.pmb)}set visibility(e){vc.a.yz(e,"Style.Visibility");this.wD(fd.a.pmb,e)}get _ReferenceId(){return this.gr?this.Gr:null}deleteObject(){const e=
new fa.a;e.add(this._style.getValue(fd.a.ma));this.Zv.Fei(e)}_KeepReference(){return this.Wq()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.Style"}invokePropertyGet(e){switch(e){case 2:return this.baseStyle;case 3:return this.builtIn;case 4:return this.description;case 5:return this.font;case 6:return this.inUse;case 7:return this.linked;case 16:return this.listTemplate;case 8:return this.nameLocal;case 9:return this.nextParagraphStyle;case 15:return this.paragraphFormat;case 10:return this.priority;
case 11:return this.quickStyle;case 12:return this.type;case 13:return this.unhideWhenUsed;case 14:return this.visibility;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 10:this.priority=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return;case 11:this.quickStyle=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 13:this.unhideWhenUsed=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 14:this.visibility=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
t){switch(e){case 1003:return this.yF(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}yF(){this.deleteObject();return null}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}wD(e,t){const E=this._style.getValue(fd.a.ma),W=new Zc.ScriptSharpLegacyMap;W.Z(e,t);this.Zv.DYa(E,W,Pd.a.Mp())}}
Object(y.a)(st,"Style",si.a,[1143]);class yE extends si.a{constructor(e,t,E){super();this.B1e=new Map;this.Pmh=new Map;this.BC=e;this.plb=t;this.Zv=E}length(){return this.plb.JG}_GetItem(e){if(vc.a.KS(e)<this.length())return this.Pmh.get(e);z.ULS.sendTraceTag(508941208,369,10,"The index is out of the style collection range.");vc.a.qd();return null}get _ReferenceId(){return this.gr?this.Gr:null}getByName(e){(e=this.getByNameOrNullObject(e))||vc.a.hl();return e}getByNameOrNullObject(e){if(this.B1e.has(e))return this.B1e.get(e);
if(Pd.a.ei.qr){var t=this.plb.uy().zBa(e);t=this.plb.gh(Pd.a.Vb.Ae(t))}else t=this.plb.XKa(e);return t?(t=new st(this.BC,t,this.Zv),this.B1e.set(e,t),t):null}getCount(){return this.plb.JG}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,t){this.YMg();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}YMg(){for(let e=0;e<this.length();e++){const t=new st(this.BC,this.hRm(e),this.Zv);this.Pmh.set(e,t)}}hRm(e){return Pd.a.ei.qr?(e=this.plb.uy().rla(e),this.plb.gh(Pd.a.Vb.Ae(e))):
this.plb.yBa(e)}getTypeName(){return"Microsoft.WordServices.StyleCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
t){switch(e){case 1003:return this.Zjm(t);case 1004:return this.$jm(t);case 1005:return this.Z8a();case 1:return this.NY(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Zjm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getByName(e)}$jm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");return this.getByNameOrNullObject(e)}Z8a(){return this.getCount()}NY(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(yE,"StyleCollection",si.a,[1143,1215]);class Oy{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj,zl,Wl,Rh,Mg,Xl,ql,Al,Hk,Dj){this.TOb=Al;this.Cjg=Hk;this.Rgd=Dj;this.SKe=new gf.a;this.Lwo=()=>{this._RemoveAllReferences()};
this.S$k=()=>{this._context.An.yv()};vc.a.yz(e,"Document");this.yt=e;this._context=t;this.qQ=E;this.sya=W;this.$k=ha;this.ga=Ka;this.hb=sb;this.pG=dc;this.ll=xc;Rc.vgf(this.Lwo);this.eyk=md;this.$g=ud;this.WCb=Ud;this.xnk=Id;this.zp=Ee;this.jb=kf;this.BB=Ke;this.jx=dh;this.RZ=$h;this.sl=rj;this.k2a=zl;this.Pc=Wl;this.rac=Rh;this.fy=Mg;this.Zv=Xl;this.BC=ql}get context(){return this._context}get allowCloseOnUntitled(){return!1}set allowCloseOnUntitled(e){vc.a.il()}get body(){return this.qQ.create(this.pG.tU(this.yt.value),
this._context)}get changeTrackingMode(){return this.RZ.Tkm()}set changeTrackingMode(e){this.RZ.wRo(this.ga,e)}get contentControls(){if(vc.a.tFa){const e=new Pm;e.types=[31];return this.getContentControls(e)}return this.$g.uti(this._context)}get customXmlParts(){const e=this.sl.W1c(),t=new fa.a;for(let E=0;E<e.length;E++){const W=this.k2a.create(e[E],this._context);e[E].builtIn&&0!=t.count?t.insert(0,W):t.add(W)}return new EC(this._context,this.sl,t,this.k2a,this.Pc)}get properties(){vc.a.fj()||vc.a.il("Getter");
return this.WCb}get saved(){return!this.eyk()}get sections(){const e=Ld.GraphIterator.eb(this.pG.tU(this.yt.value)),t=new fa.a;let E=0;this.ll.DVa(e,W=>{t.add(this.sya.create(W,this._context,E++));return!0});return new wp(t)}get settings(){this.context.Sk||vc.a.ng();const e=this.rac.rqb(this.yt,this.pG);e||vc.a.ng();let t=this.rac.dBa(this.context.Sk,e.currentNode);t||(t=this.rac.vsb(this.context.Sk,e.currentNode));t||vc.a.ng();return new xE(t,this.rac)}get _ReferenceId(){return null}addStyle(e,t){vc.a.OYj()||
vc.a.il();const E=Pd.a.Mp(),W=new Od.GraphTransaction(15);W.Ab(E);W.yi=wb.a.EMb;const ha=new eq.a(new yr.a);try{const Ka=Qd.a.e0(e);ha.setValue(fd.a.ma,Qd.a.XDa(Ka));ha.setValue(gb.a.la,Ka);ha.setValue(gb.a.styleName,Ka);ha.setValue(gb.a.nZa,Ka);ha.setValue(gb.a.na,t);ha.setValue(Tb.a.highlight,Ok.a.auto);ha.setValue(gb.a.Qx,Ok.a.auto);ha.setValue(fd.a.Hd,!0);ha.setValue(fd.a.ke,!0);ha.setValue(fd.a.pa,Zj.StyleReader.wordStyleIdNormal);ha.qg(fd.a.gE);e=[];e.push(ha);Pd.a.tSc(e,E)}finally{W.dispose()}return new st(this.BC,
ha,this.Zv)}deleteBookmark(e){(e=this.zp.eBa(e))&&this.zp.LBj(e.id)}getAnnotationsByType(e){this._context.An.BF();this._context.An.yv();let t;this.SKe.mb(e)?t=this.SKe.J(e):(t=this.xnk.create(e,this._context),this.SKe.add(e,t));return t.refresh().then(()=>OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t))}getBookmarkRange(e){(e=this.getBookmarkRangeOrNullObject(e))||vc.a.hl();return e}getBookmarkRangeOrNullObject(e){const t=this.zp.aEi(e);if(!t||t&&0==t.count)return null;const E=new fa.a;
e=this.zp.eBa(e);var W=this.zp.fBa(e,!0);var ha=t.J(0);if(1==t.count){var Ka=this.zp.fBa(e,!1);Ka=Ka.Iea.Jb.cp;W=W.Iea.Jb.cp;ha=this.jb.textLength(ha)===Ka-W?Zd.a.create(ha):Zd.a.createTextRange(ha,W,Ka)}else Ka=W.Iea.Jb.cp,ha=0===Ka?Zd.a.create(ha):Zd.a.createTextRange(ha,Ka,this.jb.textLength(ha));E.add(ha);for(ha=1;ha<t.count;ha++)ha!=t.count-1?E.add(Zd.a.create(t.J(ha))):ha==t.count-1&&(Ka=this.zp.fBa(e,!1))&&(W=t.J(ha),Ka=Ka.Iea.Jb.cp,Ka=this.jb.textLength(W)===Ka?Zd.a.create(W):Zd.a.createTextRange(t.J(ha),
0,Ka),E.add(Ka));return this.$k.create(E,this._context)}getContentControls(e){var t;e=null!==(t=null===e||void 0===e?void 0:e.types)&&void 0!==t?t:[];vc.a.C_c(e);t=this.$g.uti(this._context);return 0===e.length?t:null===t||void 0===t?void 0:t.getByTypes(e)}getEndnoteBody(){vc.a.C1c()||vc.a.il();return this.qQ.create(this.Yyi(0),this._context)}getFootnoteBody(){vc.a.C1c()||vc.a.il();return this.qQ.create(this.Yyi(1),this._context)}getMetadata(){vc.a.il();return null}getNeighborhoodTextAroundSelection(){vc.a.il();
return null}dKm(){var e=this.hb.gb.currentSelection;if(!e)return"NoSelection";e=e.toArray();for(let t=0;t<e.length;t++){const E=e[t];if(E.contextId===na.a.caa&&19===E.node.type)return"TextBoxSelection"}return"ValidSelection"}getSelection(){var e=this.hb.gb.currentSelection;e||vc.a.ng();e=e.toArray();const t=new fa.a;for(let E=0;E<e.length;E++){const W=e[E];W.contextId===na.a.caa&&19===W.node.type&&vc.a.rC();t.add(W)}return this.$k.create(t,this._context)}insertFileFromBase64(e,t,E){"<"===e.charAt(0)&&
(z.ULS.sendTraceTag(509110469,369,10,"invalid argument for insertFileFromBase64 API in Document class.",this._context.appId),vc.a.qd());null===E&&(E=new Co);return this.K9m(e,t,E)}getStyles(){vc.a.OYj()||vc.a.il();return new yE(this.BC,this.fy.ko(),this.Zv)}launchTapPane(){vc.a.il()}save(){this._context.An.BF();this.ga.jgo(wb.a.k_b,this.S$k)}close(){}search(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{const W=this.jb.SA(this.yt.value,!0,!0,!0);this.BB.find(W,e,t,E,this._context)})}getParagraphByUniqueLocalId(e){vc.a.Bjg||
vc.a.il();(e=this.Rgd.NBm(e))||vc.a.hl();const t=this.jb.Gv(this.yt.value,!0,!0,!0);let E=null;for(const W of t)if(W.id.toString()==e){E=this.Cjg.create(W,this._context);break}E||vc.a.hl();return E}setMetadata(){vc.a.il()}setMetadataOnTile(){vc.a.il()}setNavigationPaneVisibility(e){this.ga.Ob(e?Fa.a.cyc:Fa.a.VVc,2)}_GetObjectByReferenceId(e){return Ny.a.instance.v3d(e)}_GetObjectTypeNameByReferenceId(e){return Ny.a.instance.v3d(e).getTypeName()}_KeepReference(){}_OnAccess(){}_RegisterEvent(e,t){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,
e,t)}_RemoveAllReferences(){Ny.a.instance.Krl()}_RemoveReference(e){Ny.a.instance.myo(e)}_Search2(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{const W=this.jb.SA(this.yt.value,!0,!0,!0);this.BB.Jpb(W,e,t,E,this._context)})}_UnregisterEvent(e,t){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,e,t)}getTypeName(){return"Microsoft.WordServices.Document"}invokePropertyGet(e){switch(e){case 9:return this.allowCloseOnUntitled;case 3:return this.body;
case 10:return this.changeTrackingMode;case 4:return this.contentControls;case 8:return this.customXmlParts;case 6:return this.properties;case 1:return this.saved;case 2:return this.sections;case 7:return this.settings;case 5:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 9:this.allowCloseOnUntitled=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 10:this.changeTrackingMode=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1028:return this.Pff(t);case 1011:return this.Iwf(t);case 1010:return this.DHf(t);
case 1012:return this.EHf(t);case 1026:return this.FKa(t);case 1013:return this.ULf(t);case 1017:return this.NAm(t);case 1006:return this.iKm();case 1029:return this.zOf();case 1016:return this.Cxn(t);case 1005:return this.Twg(t);case 1027:return this.Etl(t);case 1014:return this.mAg(t);case 1015:return this.EVo(t);case 1021:return this.MVo(t);case 1001:return this.Glk(t);case 1002:return this.Hlk(t);case 1008:return this.ri();case 1007:return this.si();case 1018:return this.Jlk(t);case 1004:return this.Olk();
case 1003:return this.Plk(t);case 1019:return this.Ulk(t);case 1031:return this.iEm(t)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1020:return this.Shm(t);case 1022:return this.yva(t);case 1023:return this.Aoa(t);case 1025:return this.$qm();case 1024:return this.otm();case 1030:return this.sta(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Pff(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.addStyle(t,e)}Iwf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.deleteBookmark(e);return null}K9m(e,t,E){const W=(new Date).getTime();let ha=new fa.a;const Ka=this.pG.tU(this.yt.value);switch(t){case 2:var sb=this.jb.Zl(Ka);ha.add(Zd.a.create(sb));break;case 3:sb=this.jb.hD(Ka);ha.add(Zd.a.create(sb));break;case 4:ha=this.jb.SA(Ka,!0,!1);break;default:z.ULS.sendTraceTag(509110468,
369,15,`AppId:${this._context.appId}, invalid insert location for document's insert Docx method`,this._context.appId),vc.a.qd()}return OfficeExtension.WacRuntime.Utility.createPromise((dc,xc)=>{this.jx.insertOoxml(ha,e,t,Ka,this._context,dc,xc,W,1,0,!1,null,E)})}Shm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getAnnotationsByType(e)}DHf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getBookmarkRange(e)}EHf(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getBookmarkRangeOrNullObject(e)}FKa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,Pm);return this.getContentControls(e)}$qm(){return this.getEndnoteBody()}otm(){return this.getFootnoteBody()}ULf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getMetadata(e)}NAm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int?");return this.getNeighborhoodTextAroundSelection(e)}iKm(){return this.getSelection()}sta(e){const t=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,Co);return this.insertFileFromBase64(t,E,e)}zOf(){return this.getStyles()}Cxn(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.launchTapPane(e);return null}Twg(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"string");this.save(t,e);return null}Etl(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.close(e);return null}yva(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,jl.a);return this.search(t,e)}Aoa(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(t,
e)}mAg(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");this.setMetadata(t,e);return null}EVo(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"any");this.setMetadataOnTile(t,E,e);return null}MVo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"boolean");this.setNavigationPaneVisibility(e);return null}Glk(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this._GetObjectByReferenceId(e)}Hlk(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this._GetObjectTypeNameByReferenceId(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}Jlk(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");this._RegisterEvent(t,e);return null}Olk(){this._RemoveAllReferences();return null}Plk(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this._RemoveReference(e);return null}Ulk(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");this._UnregisterEvent(t,e);return null}iEm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getParagraphByUniqueLocalId(e)}Yyi(e){const t=
this.pG.tU(this.yt.value);(e=this.TOb.k3c(t,e))||vc.a.hl();return e}}Object(y.a)(Oy,"Document",null,[]);class fj{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj,zl,Wl,Rh,Mg,Xl,ql,Al,Hk,Dj){this.lv=e;this.context=t;this.gdl=E;this.yMo=W;this.eno=ha;this.Sb=Ka;this.lb=sb;this.gZa=dc;this.Xf=xc;this.vdc=Rc;this.vN=md;this.$rf=ud;this.nhc=Ud;this.v5k=Id;this.Zdm=Ee;this.Dg=kf;this.gMo=Ke;this.$6l=dh;this.hmp=$h;this.B7a=rj;this.MMl=zl;this.Yo=Wl;this.v_o=Rh;this.a0a=Mg;this.e9=Xl;
this.Gbm=ql;this.TOb=Al;this.Cjg=Hk;this.Rgd=Dj}create(){return new Oy(this.lv,this.context,this.gdl,this.yMo,this.eno,this.Sb,this.lb,this.gZa,this.Xf,this.vdc,this.vN,this.$rf,this.nhc,this.v5k,this.Zdm,this.Dg,this.gMo,this.$6l,this.hmp,this.B7a,this.MMl,this.Yo,this.v_o,this.a0a,this.e9,this.Gbm,this.TOb,this.Cjg,this.Rgd)}}Object(y.a)(fj,"DocumentFactory",null,[]);class FC{constructor(e,t){this.dGh=this.mQc=null;this.V9e=e;this.Pc=t;this.gJ()}get ZI(){return this.dGh}gJ(){const e=this.V9e.getValue(fd.a.Nci);
this.mQc!==e&&(this.mQc=e,this.dGh=qe.b(this.mQc))}Mdb(){const e=this.Pc.Mc(4);e.Ab(this.V9e);this.mQc=qe.c(this.ZI);this.V9e.setValue(fd.a.Nci,this.mQc);e.dispose()}}Object(y.a)(FC,"StandardPropertyDocument",null,[1326]);class op extends Cf{constructor(e,t){super(e,t)}DFi(){return this.selectNodes("//ns0:property",null).length}CFi(e){const t=this.selectNodes("//ns0:property",null);for(const E of t)if(this.getKey(E).toLowerCase()===e.toLowerCase())return E;return null}aHm(e){const t=this.selectNodes("//ns0:property",
null);return 0<=e&&e<t.length?t[e]:null}BYk(e,t){if(void 0!==e&&null!==e&&void 0!==t&&null!==t){const E=this.selectSingleNode("//ns0:Properties",null);if((e=this.bHm(e,t))&&this.appendChild(E,e))return this.LFo(),!0}return!1}FPl(){if(this.DFi()){for(var e=this.selectSingleNode("//ns0:Properties",null);e.hasChildNodes();)e.removeChild(e.firstChild);this.save()}}getKey(e){if(void 0===e||null===e)return null;e=this.selectSingleNode("@name",e);return void 0!==e&&null!==e?this.getNodeText(e):null}Vxe(e,
t){if(void 0===e||null===e||void 0===t||null===t)return!1;e=this.selectSingleNode("@name",e);return void 0!==e&&null!==e?this.setNodeText(e,t):!1}getType(e){return void 0!==e&&null!==e?this.getNodeBaseName(e.firstChild):null}getValue(e){return void 0!==e&&null!==e?this.getNodeText(e.firstChild):null}setValue(e,t){return void 0!==e&&null!==e&&void 0!==t&&null!==t?(t=this.XJi(t),!!t&&!!this.setNodeXml(e.firstChild,t)):!1}EQl(e){void 0!==e&&null!==e&&void 0!==e.parentNode&&null!==e.parentNode&&(e.parentNode.removeChild(e),
this.save())}bHm(e,t){return(t=this.XJi(t))?'<property xmlns="'+op.KZd+'" fmtid="{D5CDD505-2E9C-101B-9397-08002B2CF9AE}" pid="2" name="'+Qd.a.Hf(e)+'">'+t+"</property>":null}XJi(e){var t=Object.getType(e);let E=null;t===Number?E=parseInt(String(e))===e?op.V$j:op.U$j:t===String?(t=RegExp("[0-9]{4}(-[0-9]{2}){2}T[0-9]{2}(:[0-9]{2}){2}\\.[0-9]{3}Z","g").exec(e),E=void 0!==t&&null!==t&&0<t.length&&t[0]===e?op.T$j:op.W$j,e=Qd.a.Hf(e)):t===Boolean&&(E=op.S$j);return E?"<vt:"+E+' xmlns:vt="'+op.NCp+'">'+
e+"</vt:"+E+">":null}LFo(){const e=this.selectNodes("//@pid",null);for(let t=0;t<e.length;t++)this.setNodeText(e[t],(t+2).toString())}selectSingleNode(e,t){e=this.selectNodes(e,t);return void 0!==e&&null!==e&&0<e.length?e[0]:null}}op.KZd="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties";op.NCp="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes";op.V$j="i4";op.U$j="r8";op.W$j="lpwstr";op.S$j="bool";op.T$j="filetime";Object(y.a)(op,"CustomPropertyDocument",
Cf,[1343,1204]);class Ur extends si.a{constructor(e,t,E,W){super();this._context=e;this.vQ=E;this.sl=t;this.j2a=W}get key(){return this.vQ.getKey(this.j2a)}get type(){let e=0;switch(this.vQ.getType(this.j2a)){case op.V$j:case op.U$j:e=1;break;case op.W$j:e=0;break;case op.S$j:e=3;break;case op.T$j:e=2}return e}get value(){const e=this.vQ.getValue(this.j2a);return 1===this.type?Number.parseInvariant(e):3===this.type?Boolean.parse(e):2===this.type?new Date(e):e}set value(e){this.vQ.setValue(this.j2a,
e)||vc.a.qd()}get _Id(){return this.key}get _ReferenceId(){return this.gr?this.Gr:null}deleteObject(){this.vQ.EQl(this.j2a);this.j2a=null}_KeepReference(){this.Wq()}_OnAccess(){this._context.An.Nec(this.sl.uka.currentNode);this.j2a||vc.a.hl();if(!this.vQ.YZf()){this.vQ.$Mg();const e=this.vQ.CFi(this.key);e?this.j2a=e:vc.a.hl()}}getTypeName(){return"Microsoft.WordServices.CustomProperty"}invokePropertyGet(e){switch(e){case 2:return this.key;case 4:return this.type;case 3:return this.value;case 5:return this._Id;
case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 3:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"any");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
t){switch(e){case 1003:return this.yF(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}yF(){this.deleteObject();return null}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}yFo(e){this.vQ.Vxe(this.j2a,e)}}Object(y.a)(Ur,"CustomProperty",si.a,[1143]);class fq extends si.a{constructor(e,
t,E,W){super();this._context=e;this.sl=t;this.PFc=W;this.Pc=E;e=this.sl.o6d(op.KZd,!0);e=0<e.length?e[0]:this.GHl();this.vQ=new op(e,this.Pc)}length(){return this.getCount()}_GetItem(e){e=vc.a.KS(e);if(e=this.vQ.aHm(e))return new Ur(this._context,this.sl,this.vQ,e);z.ULS.sendTraceTag(21016673,369,10,"The index is out of the CustomPropertyCollection range.");vc.a.qd();return null}get _ReferenceId(){return this.gr?this.Gr:null}add(e,t){void 0!==e&&null!==e&&void 0!==t&&null!==t||vc.a.qd();var E=this.vQ.eR;
if(!E.isConnected){const W=this.sl.uka,ha=E.getValue(fd.a.bNb);W.w6(E,24,Hb.a.Cf(ha+"{1}"))}(E=this.getItemOrNullObject(e))?(E.key!==e&&E.yFo(e),E.value=t):this.vQ.BYk(e,t)?E=this.getItemOrNullObject(e):vc.a.qd();return E}deleteAll(){this.vQ.FPl()}getCount(){return this.vQ.DFi()}getItem(e){(e=this.getItemOrNullObject(e))||vc.a.hl();return e}getItemOrNullObject(e){return(e=this.vQ.CFi(e))?new Ur(this._context,this.sl,this.vQ,e):null}_KeepReference(){this.Wq()}_OnAccess(){this._context.An.Nec(this.sl.uka.currentNode);
if(!this.vQ.eR.isConnected){const e=this.sl.o6d(op.KZd,!0);0<e.length&&(this.vQ=new op(e[0],this.Pc))}this.vQ.YZf()||this.vQ.$Mg()}getAsyncEnumerator(e,t){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.CustomPropertyCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.zSc(t);case 1005:return this.Fwf();case 1004:return this.Z8a();case 1:return this.P_(t);case 1006:return this.t9a(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}zSc(e){const t=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");return this.add(t,e)}Fwf(){this.deleteAll();return null}Z8a(){return this.getCount()}P_(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItem(e)}t9a(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getItemOrNullObject(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();
return null}GHl(){const e=this.PFc.create(kk.a.eR),t=new Hb.a(Rd.a.create(),1);e.setValue(fd.a.bNb,"{"+ee.e(t.hu.toString())+"}");e.setValue(fd.a.C7a,'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"></Properties>');e.setValue(fd.a.LZd,op.KZd);e.setValue(fd.a.ygc,!0);return e}}Object(y.a)(fq,"CustomPropertyCollection",si.a,
[1143,1215]);class Py extends si.a{constructor(e,t,E,W,ha){super();this.GM=this.Vt=null;this._context=e;this.sl=t;this.Pc=E;this.PFc=W;this.VAk=ha}get applicationName(){this.GM.gJ();return this.GM.ZI.application}get author(){this.Vt.gJ();return this.Vt.ZI.Creator}set author(e){this.Vt.gJ();this.Vt.ZI.Creator=e;this.Vt.Mdb()}get category(){this.Vt.gJ();return this.Vt.ZI.Category}set category(e){this.Vt.gJ();this.Vt.ZI.Category=e;this.Vt.Mdb()}get comments(){this.Vt.gJ();return this.Vt.ZI.Description}set comments(e){this.Vt.gJ();
this.Vt.ZI.Description=e;this.Vt.Mdb()}get company(){this.GM.gJ();return this.GM.ZI.company}set company(e){this.GM.gJ();this.GM.ZI.company=e;this.GM.Mdb()}get creationDate(){this.Vt.gJ();const e=this.Vt.ZI.CreatedDate;return void 0!==e&&null!==e?new Date(e):null}get customProperties(){return new fq(this._context,this.sl,this.Pc,this.PFc)}get format(){this.GM.gJ();return this.GM.ZI.format}set format(e){this.GM.gJ();this.GM.ZI.format=e;this.GM.Mdb()}get keywords(){this.Vt.gJ();return this.Vt.ZI.Keywords}set keywords(e){this.Vt.gJ();
this.Vt.ZI.Keywords=e;this.Vt.Mdb()}get lastAuthor(){this.Vt.gJ();return this.Vt.ZI.LastModifiedBy}get lastPrintDate(){this.Vt.gJ();const e=this.Vt.ZI.LastPrinted;return void 0!==e&&null!==e?new Date(e):null}get lastSaveTime(){this.Vt.gJ();const e=this.Vt.ZI.Modified;return void 0!==e&&null!==e?new Date(e):null}get manager(){this.GM.gJ();return this.GM.ZI.manager}set manager(e){this.GM.gJ();this.GM.ZI.manager=e;this.GM.Mdb()}get revisionNumber(){this.Vt.gJ();return this.Vt.ZI.Revision}get security(){this.GM.gJ();
return this.GM.ZI.docSecurity}get subject(){this.Vt.gJ();return this.Vt.ZI.Subject}set subject(e){this.Vt.gJ();this.Vt.ZI.Subject=e;this.Vt.Mdb()}get template(){this.GM.gJ();return this.GM.ZI.template}get title(){this.Vt.gJ();return this.Vt.ZI.Title}set title(e){this.Vt.gJ();this.Vt.ZI.Title=e;this.Vt.Mdb()}get _ReferenceId(){return this.gr?this.Gr:null}_KeepReference(){this.Wq()}_OnAccess(){this.VAk||vc.a.il();this._context.An.Nec(this.sl.uka.currentNode);this.loadDocumentProperty()}getTypeName(){return"Microsoft.WordServices.DocumentProperties"}invokePropertyGet(e){switch(e){case 11:return this.applicationName;
case 5:return this.author;case 20:return this.category;case 7:return this.comments;case 23:return this.company;case 13:return this.creationDate;case 2:return this.customProperties;case 21:return this.format;case 6:return this.keywords;case 9:return this.lastAuthor;case 12:return this.lastPrintDate;case 14:return this.lastSaveTime;case 22:return this.manager;case 10:return this.revisionNumber;case 19:return this.security;case 4:return this.subject;case 8:return this.template;case 3:return this.title;
case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 5:this.author=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 20:this.category=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 7:this.comments=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"string");return;case 23:this.company=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 21:this.format=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 6:this.keywords=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 22:this.manager=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 4:this.subject=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");
return;case 3:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){switch(e){case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,
t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}loadDocumentProperty(){if(void 0===this.Vt||null===this.Vt)this.Vt=this.NHi(Py.xCl);if(void 0===this.GM||null===this.GM)this.GM=this.NHi(Py.I4l)}NHi(e){e=this.sl.o6d(e,!0);return new FC(e[0],this.Pc)}}Py.xCl="http://schemas.openxmlformats.org/package/2006/metadata/core-properties";Py.I4l="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties";
Object(y.a)(Py,"DocumentProperties",si.a,[1143]);var gB;(function(e){e[e.left=0]="left";e[e.right=1]="right";e[e.firstLine=2]="firstLine"})(gB||(gB={}));Object(y.b)("ExtensionParagraphIndent",gB);var Qy;(function(e){e[e.lineSpacing=0]="lineSpacing";e[e.before=1]="before";e[e.after=2]="after";e[e.q6p=3]="lineBefore";e[e.p6p=4]="lineAfter"})(Qy||(Qy={}));Object(y.b)("ExtensionParagraphSpacing",Qy);class GC extends si.a{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj,zl,Wl,Rh,Mg,
Xl){super();vc.a.NPa(e,"Paragraph");this.Od=e;this._context=t;this._id=E;this.BC=W;this.rO=ha;this.Co=Ka;this.$k=sb;this.c0e=dc;this.jb=xc;this.uv=Rc;this.WK=md;this.Qq=ud;this.EB=Ud;this.od=Id;this.Yx=Ee;this.$g=kf;this.BB=Ke;this.jx=dh;this.$m=$h;this.fd=rj;this.Zn=zl;this.Ut=Wl;this.RZ=Rh;this.Wx=Mg;this.Z3e=Xl}get alignment(){switch(this.jb.ez(this.Od)){case 1:return 0;case 2:return 1;case 3:return 2;case 6:case 7:case 9:case 11:case 10:case 13:return 3;default:return-1}}set alignment(e){let t=
0;switch(e){case 0:t=1;break;case 2:t=3;break;case 1:t=2;break;case 3:t=6;break;default:z.ULS.sendTraceTag(16871628,369,15,"AppId:{0}, set Paragraph.Alignment with not supported value: {1}.",this._context.appId,e),vc.a.qd()}this.uv.rH(this.Od,t)}get contentControls(){var e=Zd.a.create(this.Od);return vc.a.tFa?(e=new Pm,e.types=[31],this.getContentControls(e)):this.$g.nlc(e,e,this._context)}get fields(){return new ar(this.Wx.akc(this.Od,this._context,!1))}get endnotes(){var e=this.od.nKf(this.Od,1);
e=this.od.iAa(e,this._context);return new Dt(e)}get firstLineIndent(){return this.KMf(2)}set firstLineIndent(e){const t=this.uv.Sr;e=Ve.a.RF(e);0<=e?t.rha(this.Od,e):t.kyb(this.Od,0-e)}get font(){return this.BC.create(3,this.Od,null,null,this._context)}get footnotes(){var e=this.od.nKf(this.Od,0);e=this.od.iAa(e,this._context);return new Dt(e)}get inlinePictures(){const e=new fa.a,t=new fa.a;let E=0;this.Yx.YKf(t,this.Od);for(const W of t)e.add(this.rO.create(W,this._context,E++));return new np(e)}get isLastParagraph(){if(!vc.a.fj())return!1;
var e=this.fd.C8d(this.Od);return e?(e=this.jb.hD(e))?e.id.equals(this.Od.id)?!0:!1:!1:!1}get isListItem(){return vc.a.fj()?this.jb.GX(this.Od):!1}get leftIndent(){return this.KMf(0)}set leftIndent(e){this.uv.Sr.qOa(this.Od,1,Ve.a.RF(e))}get lineSpacing(){return this.m4c(0)}set lineSpacing(e){vc.a.W0a(e,"Paragraph.LineSpacing");this.uv.QE(this.Od,new Hu.a(2,e/12))}get lineUnitAfter(){return this.m4c(4)}set lineUnitAfter(e){vc.a.V0a(e,"Paragraph.LineUnitAfter");this.uv.cyb(this.Od,new Hu.a(2,e))}get lineUnitBefore(){return this.m4c(3)}set lineUnitBefore(e){vc.a.V0a(e,
"Paragraph.LineUnitBefore");this.uv.dyb(this.Od,new Hu.a(2,e))}get list(){if(!vc.a.fj())return null;const e=this.listOrNullObject;e||vc.a.hl();return e}get listItem(){if(!vc.a.fj())return null;const e=this.listItemOrNullObject;e||vc.a.hl();return e}get listItemOrNullObject(){if(!vc.a.fj())return null;let e;if(Xk.ListItemReader.Of){if(!Xk.ListItemReader.isListItem(this.Od))return null;e=Xf.ParagraphReader.Qkc(this.Od)}else if(!({sXb:e}=this.Zn.r$c(this.Od)).returnValue)return null;return this.c0e.create(e,
this._context)}get listOrNullObject(){if(!vc.a.fj())return null;var e=new fa.a;e.add(Zd.a.create(this.Od));e=this.Zn.nti(e,this._context);return e.count?e.J(0):null}get outlineLevel(){return this.jb.C9a(this.Od)+1}set outlineLevel(e){if(1>e||10<e)z.ULS.sendTraceTag(19674595,369,10,"Set OutlineLevel with not supported value: {0}.",e),vc.a.qd();this.uv.kWo(this.Od,e-1)}get parentBody(){return vc.a.fj()?this.fd.QMf(this.Od,this._context):null}get parentContentControl(){const e=this.parentContentControlOrNullObject;
e||vc.a.hl();return e}get parentContentControlOrNullObject(){const e=Zd.a.create(this.Od);this.od.zPa(e,e);return this.$g.olc(e,e,this._context)}get parentTable(){if(!vc.a.fj())return null;const e=this.parentTableOrNullObject;e||vc.a.hl();return e}get parentTableCell(){if(!vc.a.fj())return null;const e=this.parentTableCellOrNullObject;e||vc.a.hl();return e}get parentTableCellOrNullObject(){return vc.a.fj()?this.fd.Rkc(this.Od,this._context):null}get parentTableOrNullObject(){return vc.a.fj()?this.fd.frb(this.Od,
this._context):null}get rightIndent(){return this.KMf(1)}set rightIndent(e){this.uv.Sr.J_b(this.Od,1,Ve.a.RF(e))}get spaceAfter(){return this.m4c(2)}set spaceAfter(e){vc.a.V0a(e,"Paragraph.SpaceAfter");this.uv.cyb(this.Od,new Hu.a(4,e))}get spaceBefore(){return this.m4c(1)}set spaceBefore(e){vc.a.V0a(e,"Paragraph.SpaceBefore");this.uv.dyb(this.Od,new Hu.a(4,e))}get style(){let e;return this.EB.o3c((e=new fa.a,e.add(Zd.a.create(this.Od)),e))}set style(e){let t;this.EB.fxc((t=new fa.a,t.add(Zd.a.create(this.Od)),
t),e)}get styleBuiltIn(){if(!vc.a.fj())return-1;let e;return this.EB.b7d((e=new fa.a,e.add(Zd.a.create(this.Od)),e))}set styleBuiltIn(e){vc.a.fj()||vc.a.il();let t;this.EB.Mxe((t=new fa.a,t.add(Zd.a.create(this.Od)),t),e)}get tableNestingLevel(){return vc.a.fj()?this.fd.xIi(this.Od):0}get text(){return this.jb.EXb(this.Od)}get _Id(){return this._id}get _ReferenceId(){return this.gr?this.Gr:null}get uniqueLocalId(){return vc.a.Bjg?this.Z3e.hEi(this.Od.id.toString()):null}attachToList(e,t){vc.a.fj()||
vc.a.il();return this.Zn.attachToList(this.Od,e,t,this._context)}clear(){const e=Zd.a.create(this.Od);this.t6j(e);let t;this.od.ELb((t=new fa.a,t.add(e),t))}deleteParagraph(){const e=Zd.a.create(this.Od);this.t6j(e);let t;this.od.Ogc((t=new fa.a,t.add(e),t))}detachFromList(){vc.a.fj()||vc.a.il();this.Zn.detachFromList(this.Od)}getComments(){const e=new fa.a;e.add(Zd.a.create(this.Od));return this.Ut.T5d(e,this._context)}getContentControls(e){var t;e=null!==(t=null===e||void 0===e?void 0:e.types)&&
void 0!==t?t:[];vc.a.C_c(e);t=Zd.a.create(this.Od);t=this.$g.nlc(t,t,this._context);return 0===e.length?t:null===t||void 0===t?void 0:t.getByTypes(e)}getHtml(){const e=[Zd.a.create(this.Od)];return this.jx.getHtml(e,this._context)}getMetadata(){vc.a.il();return null}getNext(){const e=this.getNextOrNullObject();e||vc.a.hl();return e}getNextOrNullObject(){vc.a.fj()||vc.a.il();const e=this.jb.zg(this.Od,!1,!0);return e?this.Co.create(e,this._context):null}getOoxml(){const e=(new Date).getTime();this._context.An.BF();
return OfficeExtension.WacRuntime.Utility.createPromise((t,E)=>{const W=new fa.a;W.add(Zd.a.create(this.Od));this.jx.getOoxml(W,this._context,t,E,e)})}getPrevious(){const e=this.getPreviousOrNullObject();e||vc.a.hl();return e}getPreviousOrNullObject(){vc.a.fj()||vc.a.il();const e=this.jb.zg(this.Od,!0,!0);return e?this.Co.create(e,this._context):null}getRange(e){vc.a.fj()||vc.a.il();1!==e&&2!==e&&e&&5!==e&&4!==e&&(z.ULS.sendTraceTag(18745294,369,15,"AppId:{0}, rangeLocation of Paragraph.GetRange must be Start/End/Whole/Content/After.",
this._context.appId),vc.a.qd());const t=new fa.a;t.add(Zd.a.create(this.Od));this.$m.uxe(t);return(e=this.$m.Jjc(t,e))?this.$k.create(e,this._context):null}getSubrange(e,t){vc.a.fj()||vc.a.il();(0>e||e+t>this.jb.textLength(this.Od)||0>t)&&vc.a.qd();e=t?Zd.a.createTextRange(this.Od,e,e+t):Zd.a.Tc(this.Od,e);let E;return this.$k.create((E=new fa.a,E.add(e),E),this._context,0)}getTextRanges(e,t){vc.a.fj()||vc.a.il();var E=new fa.a;E.add(Zd.a.create(this.Od));this.$m.uxe(E);e=this.$m.aPf(E,e,t);t=new fa.a;
for(E=0;E<e.length;E++)t.add(this.$k.create(e[E],this._context,E));return new Mu(t)}getReviewedText(e){return this.RZ.h9d(this.Od,e)}insertBreak(e,t){t&&1!==t&&(z.ULS.sendTraceTag(17179038,369,15,"AppId:{0}, insertLocation of Paragraph.InsertBreak must be Before or After.",this._context.appId),vc.a.qd());const E=(new Date).getTime(),W=new fa.a;W.add(Zd.a.create(this.Od));if(6===e)this.od.zPa(W.J(0),W.J(0));else{const ha=this.od.r7a(this.Od,!t);W.Z(0,ha)}return OfficeExtension.WacRuntime.Utility.createPromise((ha,
Ka)=>{this.od.insertBreak(W,e,t,this._context,ha,Ka,E)})}insertContentControl(e){vc.a.wBf(e,"Paragraph");e=vc.a.Yrd(e,0);1!==e||vc.a.tFa||vc.a.qd();8!==e||vc.a.jda||vc.a.qd();const t=this.od.Tfc(this.Od,!0),E=this.od.Tfc(this.Od,!1);return this.$g.Nqa(t,E,this._context,e)}insertFileFromBase64(e,t){"<"===e.charAt(0)&&(z.ULS.sendTraceTag(18130840,369,10,"invalid argument for insertFileFromeBase64 API in Paragraph class.",this._context.appId),vc.a.qd());return this.Hla(e,t,!1)}insertHtml(e,t){const E=
(new Date).getTime();if(2===t||3===t||4===t){const W=new fa.a,ha=Zd.a.bU(0,this.jb.textLength(this.Od),!1,this.Od);W.add(ha);return this.jx.insertHtml(W,e,t,E,this._context)}vc.a.qd();return null}insertInlinePictureFromBase64(e,t){return this.a8c(e,t)}insertOoxml(e,t){"<"!==e.charAt(0)&&(z.ULS.sendTraceTag(18130841,369,10,"invalid argument for InsertOoxml API in Paragraph class.",this._context.appId),vc.a.qd());return this.Hla(e,t,!0)}insertParagraph(e,t){let E=null;switch(t){case 0:E=this.od.r7a(this.Od,
!0);break;case 1:E=this.od.r7a(this.Od,!1);break;default:z.ULS.sendTraceTag(21070050,369,15,"AppId:{0}, Invalid insert location for Paragraph.InsertParagraph method.",this._context.appId),vc.a.qd()}let W;return this.Co.create(this.od.insertParagraph((W=new fa.a,W.add(E),W),e,t),this._context)}insertTable(e,t,E,W){vc.a.fj()||vc.a.il();const ha=this.od.r7a(this.Od,!E);let Ka;return this.fd.insertTable((Ka=new fa.a,Ka.add(ha),Ka),e,t,E,W,this._context)}insertText(e,t){2!==t&&3!==t&&4!==t&&(z.ULS.sendTraceTag(21284492,
369,15,"AppId:{0}, invalid location for Paragraph.InsertText: {1}.",this._context.appId,Mt.a[t]),vc.a.qd());const E=Zd.a.create(this.Od);this.od.zPa(E,E);let W;return this.$k.create(this.od.insertText((W=new fa.a,W.add(E),W),e,t),this._context)}search(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{const W=new fa.a;W.add(Zd.a.create(this.Od));this.BB.find(W,e,t,E,this._context)})}_Search2(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{const W=new fa.a;W.add(Zd.a.create(this.Od));
this.BB.Jpb(W,e,t,E,this._context)})}select(e){const t=new fa.a;t.add(Zd.a.create(this.Od));this.Qq.select(t,e)}setMetadata(){vc.a.il()}split(e,t,E){vc.a.fj()||vc.a.il();const W=new fa.a;W.add(Zd.a.create(this.Od));this.$m.uxe(W);e=this.$m.Ayc(W,e,!1,t,E);t=new fa.a;for(E=0;E<e.length;E++)t.add(this.$k.create(e[E],this._context,E));return new Mu(t)}startNewList(){vc.a.fj()||vc.a.il();return this.Zn.startNewList(this.Od,this._context)}_KeepReference(){this.Wq()}_OnAccess(){vc.a.c5(this.Od,"Paragraph")}getTypeName(){return"Microsoft.WordServices.Paragraph"}invokePropertyGet(e){switch(e){case 7:return this.alignment;
case 5:return this.contentControls;case 36:return this.endnotes;case 8:return this.firstLineIndent;case 37:return this.fields;case 3:return this.font;case 35:return this.footnotes;case 17:return this.inlinePictures;case 28:return this.isLastParagraph;case 19:return this.isListItem;case 9:return this.leftIndent;case 11:return this.lineSpacing;case 16:return this.lineUnitAfter;case 15:return this.lineUnitBefore;case 24:return this.list;case 27:return this.listItem;case 34:return this.listItemOrNullObject;
case 33:return this.listOrNullObject;case 12:return this.outlineLevel;case 23:return this.parentBody;case 6:return this.parentContentControl;case 30:return this.parentContentControlOrNullObject;case 26:return this.parentTable;case 25:return this.parentTableCell;case 31:return this.parentTableCellOrNullObject;case 32:return this.parentTableOrNullObject;case 10:return this.rightIndent;case 14:return this.spaceAfter;case 13:return this.spaceBefore;case 4:return this.style;case 29:return this.styleBuiltIn;
case 22:return this.tableNestingLevel;case 18:return this.text;case 1:return this._Id;case 2:return this._ReferenceId;case 38:return this.uniqueLocalId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 7:this.alignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return;case 8:this.firstLineIndent=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 9:this.leftIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 11:this.lineSpacing=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 16:this.lineUnitAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 15:this.lineUnitBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 12:this.outlineLevel=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return;case 10:this.rightIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 14:this.spaceAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 13:this.spaceBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 4:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 29:this.styleBuiltIn=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1022:return this.eal(t);case 1011:return this.SIa();case 1012:return this.yF(t);case 1023:return this.hSl();case 1014:return this.MPb();case 1032:return this.vPb();case 1034:return this.FKa(t);
case 1028:return this.ULf(t);case 1024:return this.Jfa();case 1026:return this.Kfa();case 1025:return this.uGm();case 1027:return this.xGm();case 1017:return this.Vsa(t);case 1030:return this.gMm(t);case 1020:return this.O4c(t);case 1033:return this.AQb(t);case 1004:return this.uLa(t);case 1009:return this.uta(t);case 1019:return this.I$a(t);case 1005:return this.wLa(t);case 1013:return this.oha(t);case 1029:return this.mAg(t);case 1018:return this.X0b(t);case 1021:return this.Qbp();case 1002:return this.ri();
case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1015:return this.nQb();case 1010:return this.z$a(t);case 1008:return this.sta(t);case 1006:return this.C$a(t);case 1003:return this.D$a(t);case 1007:return this.G$a(t);case 1016:return this.yva(t);case 1031:return this.Aoa(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}eal(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.attachToList(t,e)}SIa(){this.clear();return null}yF(){this.deleteParagraph();return null}hSl(){this.detachFromList();return null}vPb(){return this.getComments()}FKa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,Pm);return this.getContentControls(e)}MPb(){return this.getHtml()}ULf(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getMetadata(e)}Jfa(){return this.getNext()}Kfa(){return this.getNextOrNullObject()}nQb(){return this.getOoxml()}uGm(){return this.getPrevious()}xGm(){return this.getPreviousOrNullObject()}Vsa(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getRange(e)}gMm(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.getSubrange(t,e)}O4c(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.getTextRanges(t,e)}AQb(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"int");return this.getReviewedText(e)}z$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertBreak(t,e)}uLa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int?");return this.insertContentControl(e)}sta(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertFileFromBase64(t,
e)}C$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertHtml(t,e)}D$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertInlinePictureFromBase64(t,e)}G$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");return this.insertOoxml(t,e)}uta(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertParagraph(t,e)}I$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
3,"Array<Array<string>>");return this.insertTable(t,E,W,e)}wLa(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertText(t,e)}yva(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,jl.a);return this.search(t,e)}Aoa(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(t,e)}oha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.select(e);return null}mAg(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"any");this.setMetadata(t,e);return null}X0b(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>"),E=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"boolean");return this.split(t,E,e)}Qbp(){return this.startNewList()}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}a8c(e,t,E){const W=(new Date).getTime();if(!t||1===t)return z.ULS.sendTraceTag(17433743,369,50,"AppId:{0}, insert inline picture with none supported location in Paragraph class.",this._context.appId),vc.a.qd(),null;var ha=
null;if(4===t)ha=Zd.a.Tc(this.Od,0),this.clear();else{ha=Zd.a.create(this.Od);({ML:ha}=this.od.nN(ha,ha,t));let Ka;this.od.GW((Ka=new fa.a,Ka.add(ha),Ka),t,0)}v.AFrameworkApplication.$u?(this._context.An.yv(this.Od),t=this.Yx.eSb(e,ha,this._context,E)):t=this.Yx.eSb(e,ha,this._context);return t.then(Ka=>{v.AFrameworkApplication.$u||this._context.An.yv(this.Od);if(Ka)return vc.a.vP("Paragraph.InsertInlinePictureFromBase64",vc.a.fQ(W),e.length),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.rO.create(this.Yx.D0c(Ka),
this._context));z.ULS.sendTraceTag(17433744,369,10,"AppId:{0}, something went wrong when insert iamge into Paragraph.",this._context.appId);vc.a.vP("Paragraph.InsertInlinePictureFromBase64",vc.a.fQ(W),e.length,!1);vc.a.ng();return null})}KMf(e){var t=this.jb.D9a(this.Od);if(t&&(t=t.Eu))switch(e){case 2:switch(e=this.ZMf(1,t.Eha),t.specialIndentType){case 1:return e;case 2:return-e;default:return 0}case 0:return this.ZMf(t.SRb,t.oD);case 1:return this.ZMf(t.TRb,t.ota);default:return 0}z.ULS.sendTraceTag(16832386,
369,10,"AppId:{0}, error happened when reading paragraph {1} indent.",this._context.appId,gB[e]);vc.a.ng();return 0}m4c(e){var t=this.jb.D9a(this.Od);if(t&&(t=t.spacing))switch(e){case 0:return this.$Mf(t.lineSpacing.unit,t.lineSpacing.value);case 1:return this.$Mf(t.beforeSpacing.unit,t.beforeSpacing.value);case 2:return this.$Mf(t.afterSpacing.unit,t.afterSpacing.value);case 3:return this.ABi(t.beforeSpacing.unit,t.beforeSpacing.value);case 4:return this.ABi(t.afterSpacing.unit,t.afterSpacing.value);
default:return 0}z.ULS.sendTraceTag(16832387,369,10,"AppId:{0}, error happened when reading paragraph {1} spacing.",this._context.appId,Qy[e]);vc.a.ng();return 0}ZMf(e,t){switch(e){case 2:return e=Kc.a.zLb(t),Ve.a.Xha(e);case 1:return Ve.a.Xha(t);default:return 0}}$Mf(e,t){switch(e){case 2:return 12*t;case 3:return Ve.a.Xha(t);case 4:return t;default:return 0}}ABi(e,t){switch(e){case 4:return t/12;case 3:return Ve.a.Xha(t)/12;case 2:return t;default:return 0}}t6j(e){const t=this.jb.Cm(this.Od,0),
E=this.jb.Cm(this.Od,this.jb.textLength(this.Od)),W=this.jb.ry(this.Od),ha=this.jb.Bx(this.Od),Ka=E-ha;e.Fb=0<t?W+(W<Ka?Ka-W:0):-1;e.Tb=0<E?ha+(W<Ka?0:Ka-W):-1}Hla(e,t,E){const W=(new Date).getTime(),ha=new fa.a;switch(t){case 2:case 3:case 4:const Ka=Zd.a.create(this.Od);this.od.zPa(Ka,Ka);ha.add(Ka);break;default:return z.ULS.sendTraceTag(18130842,369,15,"AppId:{0}, Paragraph.InsertOoxmlOrDocx: undefined location!",this._context.appId),vc.a.qd(),null}return OfficeExtension.WacRuntime.Utility.createPromise((Ka,
sb)=>{this.jx.insertOoxml(ha,e,t,this.Od,this._context,Ka,sb,W,E?0:1)})}language(){return this.WK.jLf(this.Od)}Lsa(){return this.Od}}Object(y.a)(GC,"Paragraph",si.a,[1143]);var Zv=d(79),Vr=d(108);class $v extends si.a{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj,zl,Wl,Rh,Mg,Xl,ql){super();this.U5=null;this.Eia="_";this.gpk=40;vc.a.wBc(e,"Range");this.Cd=e;this._context=t;this._id=E;this.Co=W;this.rO=ha;this.BC=Ka;this.$k=sb;this.s8c=dc;this.jb=xc;this.Qq=Rc;this.EB=md;this.od=
ud;this.Yx=Ud;this.$g=Id;this.BB=Ee;this.jx=kf;this.$m=Ke;this.fF=dh;this.fd=$h;this.Zn=rj;this.zp=zl;this.Rjb=Wl;this.Ut=Rh;this.RZ=Mg;this.Wx=Xl;this.$wd=ql;this.uBd=-1;this.Ohh=this.Qhh=null;this._context.Lad&&(this.U5=this.s8c.create(e))}get f3d(){return this.uBd}set f3d(e){this.uBd=e}get Gpb(){return this.Qhh}set Gpb(e){this.Qhh=e}get $2d(){return this.Ohh}set $2d(e){this.Ohh=e}get onc(){return this.U5}get Fq(){return this.Cd}get contentControls(){if(vc.a.tFa){var e=new Pm;e.types=[31];return this.getContentControls(e)}e=
this.Cd.J(0);const t=this.Cd.J(this.Cd.count-1);return this.$g.nlc(e,t,this._context)}get endnotes(){var e=this.od.$6d(this.Cd,1);e=this.od.iAa(e,this._context);return new Dt(e)}get fields(){const e=new fa.a;var t=!1;for(let E=0;E<this.Cd.count;E++){const W=this.Cd.J(E);switch(W.contextId){case na.a.paragraph:t=this.Wx.akc(W.node,this._context,t);e.addRange(t);t=!0;break;case na.a.Bd:t=this.Wx.O6d(W.node,W.cpBegin,W.cpEnd,this._context,t);e.addRange(t);t=!0;break;case na.a.Vc:break;case na.a.Xc:break;
default:z.ULS.sendTraceTag(539530914,369,10,"AppId:{0}, the contextId {1} is not supported to get the fields.",this._context.appId,W.contextId),vc.a.ng()}}return new ar(e)}get font(){return this.BC.create(4,null,null,this,this._context)}get footnotes(){var e=this.od.$6d(this.Cd,0);e=this.od.iAa(e,this._context);return new Dt(e)}get hyperlink(){if(!vc.a.fj())return null;const e=(vc.a.Sqg()?this.$m.Qqb(this.Cd):this.Qqb()).returnValue;return e&&e.length?e[0].hyperlink.url:null}set hyperlink(e){vc.a.fj()||
vc.a.il();if(vc.a.Sqg())this.$m.jOj(this.Fq,e,!0,this._context);else{this.n0f()||vc.a.ng();if(this.Cd.J(0).contextId===na.a.Xc||this.Cd.J(0).contextId===na.a.Vc)z.ULS.sendTraceTag(18989185,369,15,"AppId:{0}, InsertionPoint and EndOfParagraph Can not be set hyperlink by API",this._context.appId),vc.a.ng();var t,E=({$bg:t}=this.Qqb()).returnValue;if(E)for(let W=0;W<E.length;W++)this.fF.hV(E[W].paragraph,E[W].hyperlink);e&&""!==e&&t&&0<t.count&&(this.$m.I_h(t.J(0))?(E=!1,0===e.indexOf("#")&&(e=e.substr(1),
E=!0),this.fF.vF(t.J(0),e,!1,!1,!1,E)):vc.a.rC())}}get inlinePictures(){const e=new fa.a;let t=0;for(const E of this.Cd){const W=new fa.a;this.Yx.u7d(W,E);for(const ha of W)e.add(this.rO.create(ha,this._context,t++))}return new np(e)}get isEmpty(){return this.$m.ZSb(this.Cd)}get lists(){return vc.a.fj()?new Ly(4,null,null,this,this._context,this.Zn,null):null}get paragraphs(){let e=0;const t=new fa.a,E=new rC.a;for(const W of this.Cd)E.contains(W.node.id.toString())||(E.add(W.node.id.toString()),
t.add(this.Co.create(W.node,this._context,e++)));return new Hx(t)}get parentBody(){return vc.a.fj()?this.fd.RMf(this.Cd.J(0).node,this.Cd.J(this.Cd.count-1).node,this._context):null}get parentContentControl(){const e=this.parentContentControlOrNullObject;e||vc.a.hl();return e}get parentContentControlOrNullObject(){return this.$g.olc(this.Cd.J(0),this.Cd.J(this.Cd.count-1),this._context)}get parentTable(){if(!vc.a.fj())return null;const e=this.parentTableOrNullObject;e||vc.a.hl();return e}get parentTableCell(){if(!vc.a.fj())return null;
const e=this.parentTableCellOrNullObject;e||vc.a.hl();return e}get parentTableCellOrNullObject(){if(!vc.a.fj())return null;const e=this.Cd.J(0),t=this.Cd.J(this.Cd.count-1);return this.fd.Rkc(e.node,this._context,t.node)}get parentTableOrNullObject(){if(!vc.a.fj())return null;const e=this.Cd.J(0),t=this.Cd.J(this.Cd.count-1);return this.fd.frb(e.node,this._context,t.node)}get style(){return this.EB.o3c(this.Cd)}set style(e){this.EB.fxc(this.Cd,e)}get styleBuiltIn(){return vc.a.fj()?this.EB.b7d(this.Cd):
-1}set styleBuiltIn(e){vc.a.fj()||vc.a.il();this.EB.Mxe(this.Cd,e)}get tables(){return vc.a.fj()?new Vv(4,null,this,null,this._context,this.fd):null}get text(){return this.$m.SEi(this.Cd,this._context)}get _Id(){return this._id}get _ReferenceId(){return this.gr?this.Gr:null}clear(){this.Dzc();this.od.ELb(this.Cd);this.yMb()}compareLocationWith(e){vc.a.fj()||vc.a.il();e&&e.Fq.count||vc.a.ng();return this.$m.M5h(this.Fq.J(0),this.Fq.J(this.Fq.count-1),e.Fq.J(0),e.Fq.J(e.Fq.count-1))}deleteRange(){this.Dzc();
this.od.Ogc(this.Cd);this.yMb()}endPreview(){}expandTo(e){(e=this.expandToOrNullObject(e))||vc.a.hl();return e}expandToOrNullObject(e){vc.a.fj()||vc.a.il();if(!e||!e.Fq.count)return null;if(this.yZi(e)){var t=this.$m.EL(this.Cd.J(0),!0),E=this.$m.EL(this.Cd.J(this.Cd.count-1),!1,!0),W=this.$m.EL(e.Fq.J(0),!0);e=this.$m.EL(e.Fq.J(e.Fq.count-1),!1,!0);const ha=this.dka(t,W),Ka=this.dka(E,e);2===ha&&(t=W);Ka||(E=e);W=this.fzi(t,E);return this.$k.create(W,this._context)}return null}getBookmarks(e,t){const E=
[],W=new fa.a;var ha=new fa.a;for(const Ka of this.Fq){const sb=Ka.node;if(sb.qa)for(let dc=0;dc<sb.qa.length;dc++){const xc=sb.qa.J(dc);if(xc.Zh)for(let Rc=0;Rc<xc.Zh.length;Rc++){const md=xc.Zh.J(Rc).Po.toString();ha.contains(md)||ha.add(md);t||(W.contains(md)?W.remove(md):W.add(md))}}else z.ULS.sendTraceTag(545396882,369,15,"Paragraph characterProperties is null")}for(const Ka of ha)if(t||!t&&!W.contains(Ka))ha=this.zp.lPb(Hb.a.Cf(Ka)).ja(fd.a.yu,""),(e||!e&&!ha.startsWith(this.Eia))&&E.push(ha);
return E}getComments(){return this.Ut.T5d(this.Cd,this._context)}getContentControls(e){var t;e=null!==(t=null===e||void 0===e?void 0:e.types)&&void 0!==t?t:[];vc.a.C_c(e);t=this.Cd.J(0);const E=this.Cd.J(this.Cd.count-1);t=this.$g.nlc(t,E,this._context);return 0===e.length?t:null===t||void 0===t?void 0:t.getByTypes(e)}getHtml(){return this.jx.getHtml(this.Cd.toArray(),this._context)}getHyperlinkRanges(){vc.a.fj()||vc.a.il();let e;const t=new fa.a;({returnValue:e}=vc.a.Sqg()?this.$m.Qqb(this.Cd):this.Qqb());
if(!e)return new Mu(t);for(let E=0;E<e.length;E++){const W=new fa.a;W.add(Zd.a.createTextRange(e[E].paragraph,e[E].cpBegin,e[E].cpEnd));t.add(this.$k.create(W,this._context,E))}return new Mu(t)}getNextTextRange(e,t){(e=this.getNextTextRangeOrNullObject(e,t))||vc.a.hl();return e}getNextTextRangeOrNullObject(e,t){vc.a.fj()||vc.a.il();return(e=this.$m.getNextTextRange(this.Cd,e,t))?this.$k.create(e,this._context):null}getOoxml(){const e=(new Date).getTime();this._context.An.BF();return OfficeExtension.WacRuntime.Utility.createPromise((t,
E)=>{this.jx.getOoxml(this.Cd,this._context,t,E,e)})}getReviewedText(e){return this.vIm(e)}getRange(e){vc.a.fj()||vc.a.il();1!==e&&2!==e&&e&&5!==e&&4!==e&&(z.ULS.sendTraceTag(18745295,369,15,"AppId:{0}, rangeLocation of Range.GetRange must be Start/End/Whole/Content/After.",this._context.appId),vc.a.qd());return(e=this.$m.Jjc(this.Cd,e))?this.$k.create(e,this._context):null}getTextRanges(e,t){vc.a.fj()||vc.a.il();e=this.$m.aPf(this.Cd,e,t);t=new fa.a;for(let E=0;E<e.length;E++)t.add(this.$k.create(e[E],
this._context,E));return new Mu(t)}highlight(){const e=this.Cd.J(0);this.$wd.zEl(e,this._context)}insertBookmark(e){var t=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu");if(Qd.a.Tf(e)||e.length>this.gpk||e.includes(" ")||!t.test(e))vc.a.qd();else{t=this.Fq.J(0);var E=this.Fq.J(this.Fq.count-1);this.zp.pSc(e,t.lk,E.Ep,t.node,E.node,!0)}}insertBreak(e,t){t&&1!==t&&(z.ULS.sendTraceTag(17179039,369,15,"AppId:{0}, insertLocation of Range.InsertBreak must be Before, After.",this._context.appId),
vc.a.qd());const E=(new Date).getTime();return OfficeExtension.WacRuntime.Utility.createPromise((W,ha)=>{this.od.insertBreak(this.Cd,e,t,this._context,W,ha,E,this.U5,!0)})}insertComment(e){return void 0===e||null===e?(vc.a.qd(),null):this.Ut.insertComment(this.Fq,e,this._context)}insertContentControl(e){vc.a.wBf(e,"Range");e=vc.a.Yrd(e,0);1!==e||vc.a.tFa||vc.a.qd();8!==e||vc.a.jda||vc.a.qd();return this.UVf(!1,e)}insertFileFromBase64(e,t){"<"===e.charAt(0)&&(z.ULS.sendTraceTag(18130843,369,10,"invalid argument for insertFileFromeBase64 API in Range class.",
this._context.appId),vc.a.qd());return this.Hla(e,t,!1)}insertEndnote(e){e=this.od.eTi(this.Cd,e,1);return this.Rjb.create(e,this._context)}insertFootnote(e){e=this.od.eTi(this.Cd,e,0);return this.Rjb.create(e,this._context)}insertHtml(e,t){const E=(new Date).getTime();return this.jx.insertHtml(this.Cd,e,t,E,this._context,!0,this.U5)}insertInlinePictureFromBase64(e,t){const E=(new Date).getTime();this.od.GW(this.Cd,t,0);4===t&&this.clear();const W=this.od.Yee(this.Cd,t);let ha=null;const Ka=this.Cd.J(0),
sb=this.Cd.J(this.Cd.count-1),dc=({ML:ha}=this.od.nN(Ka,sb,t)).returnValue,xc=ha.node.characterData.length;this.Dzc();return this.Yx.eSb(e,ha,this._context).then(Rc=>{this._context.An.yv(Ka.node);if(!Rc)return this.yMb(),z.ULS.sendTraceTag(17433748,369,10,"AppId:{0}, something went wrong when insert image into Range.",this._context.appId),vc.a.vP("Range.InsertInlinePictureFromBase64",vc.a.fQ(E),e.length,!1),vc.a.ng(),null;vc.a.vP("Range.InsertInlinePictureFromBase64",vc.a.fQ(E),e.length);Rc=this.Yx.D0c(Rc);
this.od.hFe(this.Cd,ha,dc,1,xc);W&&this.od.Nte(this.Cd,t);this.yMb();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.rO.create(Rc,this._context))})}insertOoxml(e,t){"<"!==e.charAt(0)&&(z.ULS.sendTraceTag(18130844,369,10,"invalid argument for InsertOoxml API in Range class.",this._context.appId),vc.a.qd());return this.Hla(e,t,!0)}insertParagraph(e,t){t&&1!==t&&(z.ULS.sendTraceTag(21070051,369,15,"AppId:{0}, Invalid insert location for Range.InsertParagraph method.",this._context.appId),
vc.a.qd());this.Dzc();var E=!t,W=E?this.Cd.J(0):this.Cd.J(this.Cd.count-1);W=this.jb.zg(W.node,E);if(E=this.fd.w7d(this.Cd,!t))if(W){t?1===t&&(t=0):t=1;var ha;var Ka=this.od.insertParagraph((ha=new fa.a,ha.add(E),ha),e,t)}else e=vc.a.aXc(e),ha=Zd.a.Tc(E.node,0),0<this.jb.Cm(ha.node,ha.cpBegin)?ha.Fb=ha.Tb=this.jb.Cm(ha.node,ha.cpBegin)/2:ha.Fb=ha.Tb=-1,this.od.insertText((Ka=new fa.a,Ka.add(ha),Ka),e,t),Ka=E.node;else Ka=this.od.insertParagraph(this.Cd,e,t);this.yMb();return this.Co.create(Ka,this._context)}insertTable(e,
t,E,W){vc.a.fj()||vc.a.il();E&&1!==E&&vc.a.qd();this.Dzc();e=this.fd.insertTable(this.Cd,e,t,E,W,this._context,!0);this.yMb();return e}insertTapObjectFromFileContent(){return null}insertText(e,t){Zv.a.xVa&&0===this.uBd&&vc.a.rC();1===this.uBd&&2!==t&&3!==t&&4!==t&&(z.ULS.sendTraceTag(508703453,369,15,"AppId:{0}, invalid location for ADDIN FieldRange.InsertText: {1}.",this._context.appId,Mt.a[t]),vc.a.qd());this.Dzc();e=this.$k.create(this.od.insertText(this.Cd,e,t,this.f3d,this.Gpb,this.$2d),this._context);
this.yMb();return e}intersectWith(e){(e=this.intersectWithOrNullObject(e))||vc.a.hl();return e}intersectWithOrNullObject(e){vc.a.fj()||vc.a.il();if(!e||!e.Fq.count)return null;if(this.yZi(e)){var t=this.$m.EL(this.Cd.J(0),!0),E=this.$m.EL(this.Cd.J(this.Cd.count-1),!1,!0),W=this.$m.EL(e.Fq.J(0),!0);e=this.$m.EL(e.Fq.J(e.Fq.count-1),!1,!0);const ha=this.dka(t,W),Ka=this.dka(E,e),sb=this.dka(t,e),dc=this.dka(E,W);if(!ha||1===ha)if(2===dc||1===dc)t=W;else return null;else if(2===sb)return null;if(Ka){if(sb&&
1!==sb)return null;E=e}else if(!dc)return null;W=this.fzi(t,E);return this.$k.create(W,this._context)}return null}previewTextReplacement(){}removeHighlight(){this.$wd.aQl(this.Cd,this._context)}search(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{this.BB.find(this.Cd,e,t,E,this._context)})}_Search2(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{this.BB.Jpb(this.Cd,e,t,E,this._context)})}select(e){this.Qq.select(this.Cd,e)}split(e,t,E,W){vc.a.fj()||vc.a.il();e=
this.$m.Ayc(this.Cd,e,t,E,W);t=new fa.a;for(E=0;E<e.length;E++)t.add(this.$k.create(e[E],this._context,E));return new Mu(t)}_KeepReference(){this.Wq()}_OnAccess(){v.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.U5&&((this.Cd=this.U5.Fq)||z.ULS.sendTraceTag(21824033,369,10,"AppId:{0}, the range is lost for unknown reason using the new range model.",this._context.appId));vc.a.wBc(this.Cd,"InternalRange");for(const e of this.Cd)vc.a.c5(e.node,"Range")}insertField(e,t,E,
W){Zv.a.Taa||vc.a.il();return this.Wx.insertField(this.Cd,this._context,e,t,E,W)}getTypeName(){return"Microsoft.WordServices.Range"}invokePropertyGet(e){switch(e){case 6:return this.contentControls;case 22:return this.endnotes;case 23:return this.fields;case 3:return this.font;case 21:return this.footnotes;case 11:return this.hyperlink;case 8:return this.inlinePictures;case 10:return this.isEmpty;case 12:return this.lists;case 5:return this.paragraphs;case 16:return this.parentBody;case 7:return this.parentContentControl;
case 18:return this.parentContentControlOrNullObject;case 15:return this.parentTable;case 14:return this.parentTableCell;case 19:return this.parentTableCellOrNullObject;case 20:return this.parentTableOrNullObject;case 4:return this.style;case 17:return this.styleBuiltIn;case 13:return this.tables;case 9:return this.text;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 11:this.hyperlink=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 4:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 17:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,
t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1011:return this.SIa();case 1019:return this.dxl(t);case 1012:return this.yF(t);case 1035:return this.m0l();case 1020:return this.q4l(t);case 1028:return this.r4l(t);case 1026:return this.jjm(t);case 1014:return this.MPb();case 1023:return this.qvm();case 1022:return this.CBm(t);case 1030:return this.DBm(t);case 1040:return this.vPb();case 1042:return this.FKa(t);case 1017:return this.Vsa(t);
case 1041:return this.AQb(t);case 1025:return this.O4c(t);case 1032:return this.I0m(t);case 1027:return this.r9m(t);case 1039:return this.B9m(t);case 1003:return this.uLa(t);case 1038:return this.N9m(t);case 1037:return this.V9m(t);case 1008:return this.uta(t);case 1024:return this.I$a(t);case 1031:return this.wan(t);case 1004:return this.wLa(t);case 1021:return this.xbn(t);case 1029:return this.ybn(t);case 1034:return this.Afo(t);case 1033:return this.vyo();case 1013:return this.oha(t);case 1018:return this.X0b(t);
case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1015:return this.nQb();case 1009:return this.z$a(t);case 1007:return this.sta(t);case 1005:return this.C$a(t);case 1010:return this.D$a(t);case 1006:return this.G$a(t);case 1016:return this.yva(t);case 1036:return this.Aoa(t);case 1043:return this.O9m(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}SIa(){this.clear();
return null}dxl(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,$v);return this.compareLocationWith(e)}yF(){this.deleteRange();return null}m0l(){this.endPreview();return null}q4l(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,$v);return this.expandTo(e)}r4l(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,$v);return this.expandToOrNullObject(e)}jjm(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"boolean");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"boolean");return this.getBookmarks(t,e)}MPb(){return this.getHtml()}qvm(){return this.getHyperlinkRanges()}CBm(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.getNextTextRange(t,e)}DBm(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.getNextTextRangeOrNullObject(t,
e)}nQb(){return this.getOoxml()}vPb(){return this.getComments()}FKa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,Pm);return this.getContentControls(e)}Vsa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getRange(e)}AQb(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getReviewedText(e)}O4c(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"boolean");return this.getTextRanges(t,e)}I0m(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.highlight(e);return null}r9m(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.insertBookmark(e);return null}B9m(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.insertComment(e)}z$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");return this.insertBreak(t,e)}uLa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int?");return this.insertContentControl(e)}N9m(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.insertEndnote(e)}O9m(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
3,"boolean");return this.insertField(t,E,W,e)}V9m(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.insertFootnote(e)}sta(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertFileFromBase64(t,e)}C$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");return this.insertHtml(t,e)}D$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertInlinePictureFromBase64(t,e)}G$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertOoxml(t,e)}uta(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertParagraph(t,e)}I$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"Array<Array<string>>");return this.insertTable(t,E,W,e)}wan(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");return this.insertTapObjectFromFileContent(t,E,e)}wLa(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertText(t,e)}xbn(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,$v);return this.intersectWith(e)}ybn(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,$v);return this.intersectWithOrNullObject(e)}Afo(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this.previewTextReplacement(e);return null}vyo(){this.removeHighlight();return null}yva(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,jl.a);return this.search(t,e)}Aoa(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(t,e)}oha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.select(e);return null}X0b(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"Array<string>"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"boolean");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
3,"boolean");return this.split(t,E,W,e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}zkd(){v.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.U5&&(this.U5.exb(),this.U5=null)}Dzc(){this.U5&&this.U5.exb()}yMb(){this.U5?this.U5.jAa(this.Cd):this.U5=this.s8c.create(this.Cd)}vIm(e){let t="";for(let W=0;W<this.Cd.count;W++){var E=this.Cd.J(W);switch(E.contextId){case na.a.paragraph:E=this.RZ.h9d(E.node,e);t+=E;break;case na.a.Bd:E=this.RZ.DNf(E.node,
e,E.cpBegin,E.cpEnd);t+=E;break;case na.a.Vc:E.node.qa.last.Uh&&1==e||E.node.qa.last.Xi&&0==e||(t+=vc.a.Eqc);break;case na.a.Xc:break;default:z.ULS.sendTraceTag(545005570,369,10,"The contextId {0} is not supported to get the reviewed text.",E.contextId)}}return t}koc(e){return e.contextId===na.a.paragraph?!1:!0}Hla(e,t,E){const W=(new Date).getTime();return OfficeExtension.WacRuntime.Utility.createPromise((ha,Ka)=>{const sb=E?0:1;this.jx.insertOoxml(this.Cd,e,t,this.Cd.J(0).node,this._context,ha,
Ka,W,sb,0,!0,this.U5)})}yZi(e){return this.$m.xZi(this.Fq.J(0),e.Fq.J(0))}dka(e,t){return this.$m.dka(e,t)}fzi(e,t){this.dka(e,t);const E=new fa.a;for(const W of this.$g.gX(e,t))E.add(Zd.a.create(W));1===E.count?e.cpBegin!==t.cpEnd?t.cpEnd>this.jb.textLength(t.node)?(e.cpBegin<this.jb.textLength(t.node)&&0<e.cpBegin?E.Z(0,Zd.a.createTextRange(e.node,e.cpBegin,this.jb.textLength(t.node))):e.cpBegin?E.removeAt(0):E.Z(0,Zd.a.create(e.node)),e.cpBegin<=this.jb.textLength(t.node)&&0<e.cpBegin&&E.add(Zd.a.Xl(t.node))):
E.Z(0,Zd.a.createTextRange(e.node,e.cpBegin,t.cpEnd)):e.cpEnd<=this.jb.textLength(t.node)?E.Z(0,e):E.removeAt(0):(e.cpBegin&&(e.cpBegin===this.jb.textLength(e.node)?E.Z(0,Zd.a.Xl(e.node)):e.cpBegin<this.jb.textLength(e.node)?(E.Z(0,Zd.a.createTextRange(e.node,e.cpBegin,this.jb.textLength(e.node))),E.insert(1,Zd.a.Xl(e.node))):E.removeAt(0)),0<t.cpEnd&&t.cpEnd<=this.jb.textLength(t.node)?E.Z(E.count-1,Zd.a.createTextRange(t.node,0,t.cpEnd)):t.cpEnd?E.Z(E.count-1,Zd.a.create(t.node)):E.removeAt(E.count-
1));this.$m.axc(e,t,E,!0);return E}Qqb(){let e=[];const t=new fa.a;var E=this.Cd.J(0).node.id;let W=this.Cd.J(0).node;var ha=this.Cd.J(0);let Ka=this.Cd.J(0);for(let sb=0;sb<this.Cd.count;sb++){const dc=this.Cd.J(sb).node,xc=dc.id;if(!E.equals(xc)){E=ha.cpBegin;ha.contextId===na.a.paragraph?E=0:ha.contextId===na.a.Vc&&(E=ha.node.characterData.length);ha=Ka.cpEnd;if(Ka.contextId===na.a.paragraph||Ka.contextId===na.a.Vc)ha=Ka.node.characterData.length;E===ha?t.add(Zd.a.Tc(W,E)):t.add(Zd.a.createTextRange(W,
E,ha));W=dc;E=xc;ha=this.Cd.J(sb)}Ka=this.Cd.J(sb)}E=ha.cpBegin;ha.contextId===na.a.paragraph?E=0:ha.contextId===na.a.Vc&&(E=ha.node.characterData.length);ha=Ka.cpEnd;if(Ka.contextId===na.a.paragraph||Ka.contextId===na.a.Vc)ha=Ka.node.characterData.length;E===ha?t.add(Zd.a.Tc(W,E)):t.add(Zd.a.createTextRange(W,E,ha));for(const sb of t)sb.contextId===na.a.Xc&&(e=e.concat.apply(e,this.LUf(sb))),e=e.concat.apply(e,Vr.a.QA(sb,!1));return{returnValue:e,$bg:t}}n0f(){const e=this.Cd.J(0).node.id;for(let t=
0;t<this.Cd.count;t++){const E=this.Cd.J(t).node.id;if(!e.equals(E))return!1}return!0}LUf(e){const t=[],E=Vr.a.QA(e,!0);for(const W of E)W.cpBegin===e.cpBegin&&t.push(W);return t}UVf(e=!1,t=0){this.$g.thf(this.Cd);this.Cd.count||(z.ULS.sendTraceTag(37777541,369,10,"GncList's length is incorrect after adjustment.",this._context.appId),vc.a.ng());var E=this.Cd.J(0),W=this.Cd.J(this.Cd.count-1);if(E===W&&E.contextId===na.a.Xc&&this.$g.iab(E)){let Ka;W=E.node.qa.sh(E.cpBegin);Ka=E.vo()<W.Rx?0:1;var ha;
W=this.od.insertParagraph((ha=new fa.a,ha.add(E),ha),"",Ka);E=Zd.a.create(W);0<this.jb.Cm(W,0)?E.Fb=E.Tb=this.jb.Cm(W,0)/2:E.Fb=E.Tb=-1;return this.$g.Nqa(E,E,this._context,t,e)}return E===W&&E.contextId===na.a.Vc?(ha=Zd.a.zx(E.node),ha.Fb=ha.Tb=E.vo(),this.$g.iab(ha)&&vc.a.rC(),this.$g.U5a(ha,this._context,t,e)):this.koc(E)?this.$g.U5a(E,this._context,t,e):this.koc(W)?this.$g.Nqa(E,this.Cd.J(this.Cd.count-2),this._context,t,e):this.$g.Nqa(E,W,this._context,t,e)}XMf(e){if(v.AFrameworkApplication.$u){const t=
new fa.a;this.Yx.u7d(t,e);return t}}swp(){this.U5&&(this.Cd=this.U5.Fq)}}Object(y.a)($v,"Range",si.a,[1143]);class gq{constructor(e){this.yrf=new Map;e.execute(t=>{this.g6=t;this.z6c()})}O3i(){return!1}fHf(){return null}Q3i(){return!1}z6c(){}P3i(e,t){if(!e)return!0;if(e instanceof Lw)return this.Xsn(e,t);if(this.Q3i(e,t))return!0;e=this.Ttm(e);return 0===e.count?!1:this.Wsn(e,t)}Wsn(e,t){for(const E of e)if(this.O3i(t,E))return!0;return!1}Xsn(e,t){var E=!1;switch(e.type){case 0:E=!0;break;case 1:case 4:E=
this.fHf(t,!0),t=this.fHf(t,!1),E=this.N0i(E,e.GWh)?!0:this.N0i(t,e.GWh)}return E}N0i(e,t){if(!e)return!1;e=Ld.GraphIterator.eb(e);return e.zb(t.type)&&(e.ld(t.type),e.currentNode.equals(t))?!0:!1}Ttm(e){return e instanceof GC?(e=e.Lsa(),e=new fa.a([Zd.a.create(e)])):e instanceof $v?(e.swp(),e=e.Fq):e instanceof Lz&&e.isValid()?e=e.hkc():new fa.a}uUb(e,t=0){!0!==this.yrf.get(e)&&(t=new kh.a(5,1,t,()=>{this.yrf.set(e,!1);this.Hpg(e)}),this.yrf.set(e,!0),v.AFrameworkApplication.mc.Zb(t))}Hpg(){}}Object(y.a)(gq,
"AEventMessageManager",null,[1167]);var oh=d(651),Mz=d(1873);class Nz{constructor(){this.replyIds=[]}hNh(e){e.Mf?this.$lb(e):this.aza(e)}$lb(e){this.replyIds.push(e.a8a);this.id||(this.id=Mz.a.getInstance().qqm(e.Mf))}aza(e){this.id=e.a8a}}Object(y.a)(Nz,"CommentDetailInternal",null,[]);var Kx=d(1578);class Nu extends gq{constructor(e,t){super(e);this.n8e=new Map;this.QGd=new Map;this.gpa=t}QXc(e,t,E){const W=t.comment,ha=Ny.a.instance.v3d(E);if(ha){var Ka=this.nmm(W);if(this.P3i(ha,Ka)&&(8!==e||
!this.KZm(E))&&(t=this.Ukm(e,t)))return this.jIl(W,E,e,t)}}nSd(e,t){if(e.changeType!==t.changeType)return!1;t.commentDetails=e.commentDetails.concat(t.commentDetails);return!0}z6c(){this.g6.t0k(this.Txp.bind(this));this.g6.OPh(this.$rl.bind(this))}O3i(e,t){switch(t.contextId){case na.a.Bd:return this.Ffn(e,t);case na.a.paragraph:return this.Efn(e,t)}return!1}fHf(e,t){return this.gpa.td.Eb(t?Sp.k(e):Sp.h(e))}Txp(){for(const e of this.QGd.values())this.HBl(e.eventData);this.QGd.clear()}jIl(e,t,E,W){var ha,
Ka=null!==(ha=e.Mf)&&void 0!==ha?ha:e.id;ha=t+"_"+E+"_"+W+"_"+Ka;if(Ka=this.QGd.get(ha))return Ka=Ka.eventData.commentDetails[0],Ka.hNh(e),null;Ka=new Nz;Ka.hNh(e);Ka={x1b:t,eventType:E,eventData:{source:this.g6.ed,commentDetails:[Ka],changeType:W}};this.QGd.set(ha,Ka);return Ka}$rl(e,t){t.eventType&&9===t.eventType&&(this.n8e=new Map)}KZm(e){return this.n8e.get(e)?!0:(this.n8e.set(e,!0),!1)}nmm(e){return this.gpa.td.Eb(e.objectId)}Ukm(e,t){if(10!==e)return"none";if(t.changeType)return t.changeType;
e=t.comment;t=t.Uij;return e.done!==t.done?e.done?"resolved":"reopened":this.lqn(e.text[0],t.text[0])?null:e.Mf?"replyEdited":"edited"}HBl(e){const t=e.commentDetails[0];e.commentDetails[0]={id:t.id,replyIds:t.replyIds}}lqn(e,t){return this.v8h(e)===this.v8h(t)}v8h(e){e=fB.a.Iqb(e).ops;let t="";for(const E of e)t+=this.hHi(E);return t}hHi(e){let t="";const E=["insert","attributes","optional"];for(const W of Object.keys(e)){const ha=e[W];E.includes(W)||(t+=W);t=ha instanceof Object?t+this.hHi(ha):
t+ha}return t}Ffn(e,t){var E=new oh.a;E.add(e.id.toString());e=Kx.a.y2c(t.node,t.cpBegin,!0,E);E=(E=Kx.a.y2c(t.node,t.cpBegin,!1,E))&&E.Jb.cp<=t.cpEnd;return e&&e.Jb.cp<=t.cpEnd||E}Efn(e,t){const E=Sp.k(e);e=Sp.h(e);t=t.node;return E===t.id||e===t.id}}Object(y.a)(Nu,"CommentEventMessageManager",gq,[1167]);class zE extends gq{constructor(e,t,E,W,ha,Ka){super(e);this.e7a=t;this.eMb=E;this.lb=W;this.p_=ha;this.$rf=Ka;this.DWc=400;this.Dmg=[];this.sfc=new Map}z6c(){if(vc.a.t7h()){this.e7a.addHandler(ln.a.o7h,
this.onContentChanged.bind(this));this.lb.Cw(this.BP.bind(this));var e=S.App.jf.Il;e&&(e.Ve(12).fo(this.LN.bind(this)),e.Ve(55).Zt((t,E)=>{this.Ted(E.node,!1)}),e.Ve(55).DT((t,E)=>{this.Ted(E.node,!0)}))}}nSd(e,t){t.ids=e.ids.concat(t.ids);return!0}QXc(e,t,E){t=t.nodeId?this.eMb.Bu(t.nodeId):t.node;const W=this.yIf(t),ha=Ny.a.instance.v3d(E);if(this.P3i(ha,t))if(0===e&&this.Vyl(t.id))this.g6.fireEvent(0,{node:t});else return{eventType:e,eventData:{source:this.g6.ed,ids:[W]},x1b:E}}Q3i(e,t){return e instanceof
Lz?this.yIf(t)===e.id:!1}BP(e,t){if(e=t.Gm.currentSelection){e=this.p_.qwi(e);for(const E of e)this.Uff(1,E),this.Dmg.includes(E)||this.g6.fireEvent(12,{nodeId:E});for(const E of this.Dmg)e.includes(E)||(this.g6.fireEvent(13,{nodeId:E}),this.Uff(1,E));this.Dmg=e}}onContentChanged(e,t){this.Uff(2,t.pe)}Uff(e,t){this.sfc.get(e)||this.sfc.set(e,new Set);this.sfc.get(e).add(t);this.uUb(e,this.DWc)}Hpg(e){const t=this.sfc.get(e);if(t){for(const E of t)this.g6.fireEvent(e,{nodeId:E});this.sfc.set(e,new Set)}}Vyl(e){let t=
!1;for(const [E,W]of this.sfc)W.has(e)&&(this.g6.fireEvent(E,{nodeId:e}),W.delete(e),t=!0);return t}LN(e,t){if(t.property===Tb.a.Un&&"Remote"===this.g6.ed){e=Zd.a.create(t.node);e=this.$rf.tEi(e,e);for(const E of e)this.g6.fireEvent(2,{node:E.Ud})}}Ted(e,t){var E,W;null!==(E=this.g6.lv)&&void 0!==E&&E.td.id.equals(e.Lc.id)&&e&&0!==this.yIf(e)&&(null===(W=this.g6)||void 0===W?void 0:W.fireEvent(t?0:3,{node:e}))}yIf(e){return e.ja(fd.a.Iw,0)}}Object(y.a)(zE,"ContentControlEventMessageManager",gq,[1167]);
class TG extends gq{constructor(e,t){super(e);this.o3b=t;this.Sga=(E,W)=>{this.g6.fireEvent(14,{wordCount:W.state.wordCount})}}QXc(e,t,E){return{eventType:e,eventData:{source:this.g6.ed,wordCount:t.wordCount},x1b:E}}nSd(){return!0}z6c(){this.o3b?this.o3b.hmb(this.Sga):z.ULS.sendTraceTag(508826838,2250,10,"DocumentEventMessageManager.hookupToRichApiEvtManager: WordCountManager is not initialized yet!")}}Object(y.a)(TG,"DocumentEventMessageManager",gq,[1167]);class AE{constructor(e,t,E,W){this.Pvl=
e;this.Aml=t;this.$Wl=E;this.I8n=W}gCi(e){let t=null;switch(e){case 11:case 10:case 7:case 8:case 9:t=this.Pvl;break;case 3:case 1:case 2:case 0:case 12:case 13:t=this.Aml;break;case 14:t=this.$Wl;break;case 15:case 16:case 17:t=this.I8n}return t}}Object(y.a)(AE,"EventMessageManagerMapper",null,[]);var gv=d(1448);class xp{constructor(e,t,E){this.GIc=new ua.a;this.jHd=[];this.KLc=[];this.vKd=new Map;this.AJe=null;this.bhh=e;this.hRa=t;this.s7e=E;this.$0m()}get $E(){!this.AJe&&S.App&&Cc.StaticActiveAppFrame.za()&&
Cc.StaticActiveAppFrame.za().ib&&Cc.StaticActiveAppFrame.za().ib.$c&&Cc.StaticActiveAppFrame.za().ib.$c.yg&&(this.AJe=Cc.StaticActiveAppFrame.za().ib.$c.yg);return this.AJe}get lv(){var e,t;return null===(t=null===(e=Cc.StaticActiveAppFrame.za())||void 0===e?void 0:e.ib)||void 0===t?void 0:t.$c}get ed(){return this.$E&&2===this.$E.enabled?"Remote":"Local"}t0k(e){this.GIc.addHandler(xp.Bjj,e)}OPh(e){this.GIc.addHandler(xp.eeg,e)}zAo(e){this.GIc.removeHandler(xp.eeg,e)}fireEvent(e,t){try{const E=this.bhh.gCi(e);
if(!E)return null;const W=this.ENm(e);if(0!==W.length){this.GIc.raiseEvent(xp.eeg,{eventType:e});for(const ha of W){const Ka=E.QXc(e,t,ha);Ka&&this.qjo(ha,Ka)}this.s7e.CXn()}}catch(E){throw this.NCn(E,{eventType:e}),E;}}qjo(e,t){let E=this.vKd.get(e);E||(E=[],this.vKd.set(e,E));E.push(t)}$0m(){this.s7e.eB(this.U3k.bind(this));this.s7e.hwo();this.Tae=this.Tae.bind(this);this.OPh(this.Tae)}Tae(){this.$E&&(this.$E.KRd(this.jOo.bind(this)),gv.a.instance.ORd(this.y0l.bind(this)),this.zAo(this.Tae))}y0l(){0!==
this.jHd.length&&(this.KLc=this.KLc.concat(this.jHd),this.jHd=[])}jOo(){if(0!==this.KLc.length){for(const e of this.KLc)this.ELj(e);this.KLc=[]}}U3k(){this.GIc.raiseEvent(xp.Bjj);for(const e of this.vKd.values()){for(let t=1;t<e.length;t++){const E=e[t-1],W=e[t];this.EPn(E,W)?this.bhh.gCi(W.eventType).nSd(E.eventData,W.eventData)||this.fyg(E):this.fyg(E)}this.fyg(e[e.length-1])}this.vKd.clear()}EPn(e,t){return e.eventType===t.eventType}fyg(e){e&&(this.$E&&!this.$E.KL()?this.ELj(e):this.jHd.push(e))}ELj(e){this.hRa.fireEvent(e.x1b,
e.eventType,e.eventData)}NCn(e,t=null){e={["ErrMsg"]:e.message,["ErrStack"]:e.stack};t&&(e.ExtendMsg=t);z.ULS.sendTraceTag(523072988,369,50,"Exception in event: {0}",e)}ENm(e){var t;const E=[],W=null!==(t=this.hRa.m_eventIdControlMapByTarget)&&void 0!==t?t:{};for(const ha of Object.keys(W))W[ha][e]&&E.push(ha);return E}}xp.Bjj="BAE";xp.eeg="BFE";Object(y.a)(xp,"RichApiEventManager",null,[1307]);var Nw=d(1460),Lx=d(306);class HC extends Nw.a{constructor(){super()}get index(){return 5}run(){this.$mk()}hwo(){Lx.GraphTransactionManager.instance.Ava(this,
3)}eB(e){this.$mk=e}CXn(){this.D0()}}Object(y.a)(HC,"RichApiEventTransactionCompletedProcessor",Nw.a,[]);var BE=d(1975);class hB extends BE.a{constructor(e,t,E,W,ha,Ka,sb){super(ha,e,null,t,E,null,null,W,Ka);this.CBd=sb}deg(){this._state=0;this.Klb=this.AZ.Lje||this.AZ.ignoreSpace||this.AZ.ignorePunct?this.dja.Puj(this.AZ):this.dja.Yhd(this.AZ.text)}Vnf(){return this.CBd.J(this.lO)?!1:(this.Ymb(),this._state=2,this.Dyb(!0),!0)}Xhg(){this.FQf(this.CBd.J(this.lO).node,0);this.lO++}Ymb(){this.lO=0;this.Klb=
""}wRd(e,t){this.zk.CRd(t)}jrf(){return this.lO<this.CBd.count}Ndg(){this.lO>=this.CBd.count&&(this.lO=0,this._state=2,this.Dyb(!0))}rvg(){const e=this.dja.uXb(this.Klb);try{this.b7b=this.c7b.Ykc(e.join("|"),this.AZ)}catch(t){z.ULS.sendTraceTag(17339148,313,10,"ExtensionFindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",this.AZ.matchCase,this.AZ.matchWholeWord),this.b7b=null,this._state=2,this.Dyb(!0)}return!1}}Object(y.a)(hB,"ExtensionFindManager",
BE.a,[]);class CE{constructor(e,t,E,W){this.dja=e;this.wq=t;this.c7b=E;this.Q_e=W}create(e,t,E){return new hB(this.dja,this.wq,this.Q_e,this.c7b,e,t,E)}}Object(y.a)(CE,"ExtensionFindManagerFactory",null,[]);var UG=d(2193);class DE extends UG.a{constructor(e,t,E,W){super();this.jea=this.rT=this.KHd=null;t&&0<t.count&&(this.KHd=this.LBm(t),this.rT=E,this.jea=new fa.a);this.$k=e;this.e6=W}AVa(e,t){if(!e&&0<t.length)for(e=0;e<t.length;e++){const E=new fa.a,W=t[e].nodeId;if(this.KHd.mb(W)){const ha=this.KHd.J(W);
(ha.contextId===na.a.paragraph||ha.contextId===na.a.Bd&&t[e].Fc>=ha.cpBegin&&t[e].end<=ha.cpEnd)&&this.lJl(E,W,t[e])}}}lJl(e,t,E){e.add(Zd.a.createTextRange(this.KHd.J(t).node,E.Fc,E.end));this.jea.add(this.$k.create(e,this.e6,this.jea.count))}Fic(){this.rT(this.Dhl())}Dhl(){return new Mu(this.jea)}LBm(e){const t=new Ei.a;for(const E of e)t.add(E.node.id,E);return t}}Object(y.a)(DE,"ExtensionFindStatusManager",UG.a,[]);class EE{constructor(){this.$k=null}zv(e){this.$k=e}create(e,t,E){return new DE(this.$k,
e,t,E)}}Object(y.a)(EE,"ExtensionFindStatusManagerFactory",null,[]);var dt=d(1143);class ju extends dt.a{constructor(e,t,E,W,ha,Ka,sb){super(e,t,E,W,ha);this.rT=Ka;this.dqa=sb}m_h(){this.dqa(null)}n_h(){this.rT(this.yO.J(0))}o_h(){this.dqa(null)}}Object(y.a)(ju,"ExtensionImageSteward",dt.a,[]);class FE{constructor(e,t,E,W){this.Ck=e;this.Gb=t;this.Fn=E;this.xd=W}create(e,t,E){return new ju(e,this.Ck,this.Gb,this.Fn,this.xd,t,E)}}Object(y.a)(FE,"ExtensionImageStewardFactory",null,[]);var WI=d(2017);
class GE{constructor(){}zv(e,t,E,W,ha,Ka){this.$k=e;this.Wx=t;this.fd=E;this.$g=W;this.od=ha;this.Qq=Ka}create(e,t,E=0,W=null){return new WI.a(e,t,E,W,this.$k,this.Wx,this.fd,this.$g,this.od,this.Qq)}}Object(y.a)(GE,"FieldFactory",null,[1169]);var XI=d(352),HE=d(931),Ry=d(1277);class IC{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id){this.vDb=e;this.jb=t;this.$g=E;this.Ih=W;this.bE=ha;this.n6=Ka;this.Zc=sb;this.uDb=dc;this.fF=xc;this.DPk=Rc;this.od=md;this.qh=ud;this.Rhh=Ud;this.ga=Id}DHm(e,t,
E){if(!e.qa||!e.B7)return{Uca:null,startCp:0,endCp:0};for(;0<=t;t--){const W=e.qa.sh(t);if(W&&W.fc)for(let ha=0;ha<W.fc.length;ha++){const Ka=W.fc.J(ha);if(!Ka.ve&&1===Ka.Zq)return{Uca:e,startCp:t,endCp:E}}}e=this.jb.zg(e,!0,!0);return this.LFi(e)}Srm(e,t,E,W){if(!e.qa)return{Uca:null,startCp:0,endCp:0};for(let ha=t;ha<=e.characterData.length;ha++){const Ka=e.qa.sh(ha);if(Ka&&Ka.fc)for(let sb=0;sb<Ka.fc.length;sb++){const dc=Ka.fc.J(sb);if(!dc.ve&&1===dc.Zq)return ha>=E?{Uca:null,startCp:0,endCp:0}:
{Uca:e,startCp:ha,endCp:E};if(ha!==t&&!W)return this.DHm(e,t,E)}}return{Uca:null,startCp:0,endCp:0}}O6d(e,t,E,W,ha,Ka=!1){const sb=new fa.a;let dc=e,xc=dc.qa;if(xc&&dc.B7){let {Uca:Id,startCp:Ee,endCp:kf}=this.Srm(e,t,E,ha);if(Id){dc=Id;xc=dc.qa;var Rc=0;let Ke=null;ha=!0;Ka&&E===dc.characterData.length&&kf++;for(Ka=Ee;Ka<kf;Ka++){var md=xc.sh(Ka);if(md&&md.fc)for(var ud=0;ud<md.fc.length;ud++){var Ud=md.fc.J(ud);3===Ud.ve&&1===Ud.Zq?(ha=!0,Ke&&Rc!==md.cp&&(Ke.Cd.add(Zd.a.createTextRange(Id,Rc,md.cp)),
sb.add(Ke))):Ud.ve||1!==Ud.Zq?5===Ud.ve&&(Ke.Cd.add(Zd.a.createTextRange(Id,Rc,md.cp)),Ke.Cd.add(Zd.a.Xl(Id)),Ud=this.jb.zg(Id,!1,!0),sb.add(this.jEf(Ud,Ke))):(ha=!1,Rc=new fa.a,Ke=this.vDb.create(Rc,W),Rc=md.cp)}}for(Ka=kf;!ha&&Ka<=dc.characterData.length;Ka++)if((md=xc.sh(Ka))&&md.fc)for(ud=0;ud<md.fc.length;ud++)Ud=md.fc.J(ud),3===Ud.ve&&1===Ud.Zq?(ha=!0,Ke.Cd.add(Zd.a.createTextRange(Id,Rc,md.cp)),sb.add(Ke)):5===Ud.ve&&(Ke.Cd.add(Zd.a.createTextRange(Id,Rc,md.cp)),Ke.Cd.add(Zd.a.Xl(Id)),Ud=this.jb.zg(Id,
!1,!0),sb.add(this.jEf(Ud,Ke)))}}if(Zv.a.Taa){e=this.UBm(Zd.a.createTextRange(e,t,E),W);for(const Id of e)sb.add(Id)}return sb}UBm(e,t){const E=e.node;let W=0,ha=-1,Ka=null;const sb=[],dc=E.qa;for(;dc&&W<dc.length;){const Rc=dc.J(W++);if(Rc.vn&&Ka){if(ha<e.cpEnd&&e.cpBegin<Rc.cp&&Ka){var xc=new fa.a;xc.add(Zd.a.createTextRange(E,ha,Rc.cp));sb.push(this.vDb.create(xc,t,0,Ka));Ka=null}else ha!==e.cpEnd&&e.cpBegin!==Rc.cp||!Ka||(xc=new fa.a,xc.add(Zd.a.createTextRange(E,ha,Rc.cp)),sb.push(this.vDb.create(xc,
t,0,Ka)),Ka=null);if(Rc.cp>=e.cpEnd)break}if(Rc.hyperlink&&!Rc.fc||Rc.hyperlink&&!this.pYm(Rc.fc))ha=Rc.cp,Ka=Rc.hyperlink}return sb}pYm(e){for(let t=0;t<e.length;t++)if(1===e.J(t).ve){const E=e.J(t).BU;if(E&&E.startsWith(Vr.a.Dic)&&Vr.a.VXa(Vr.a.VKa(E)))return!0}return!1}LFi(e){if(!e.qa||!e.B7)return{Uca:null,startCp:0,endCp:0};for(let t=e.characterData.length;0<=t;t--){const E=e.qa.sh(t);if(E&&E.fc)for(let W=E.fc.length-1;0<=W;W--){const ha=E.fc.J(W);if(!ha.ve&&1===ha.Zq)return{Uca:e,startCp:t,
endCp:e.characterData.length}}}e=this.jb.zg(e,!0,!0);return this.LFi(e)}akc(e,t,E){return this.O6d(e,0,e.characterData.length,t,E,!0)}jEf(e,t){const E=e.qa;if(!E||!e.B7)return t;let W=0;for(let ha=0;ha<E.length;ha++){const Ka=E.J(ha);if(Ka.fc)for(let sb=0;sb<Ka.fc.length;sb++){const dc=Ka.fc.J(sb);if(!(1<dc.Zq))if(4===dc.ve)W=Ka.cp;else{if(3===dc.ve)return t.Cd.add(Zd.a.createTextRange(e,W,Ka.cp)),t;if(5===dc.ve)return t.Cd.add(Zd.a.createTextRange(e,W,Ka.cp)),t.Cd.add(Zd.a.Xl(e)),e=this.jb.zg(e,
!1,!0),this.jEf(e,t)}}}return t}Qrm(e,t){const E=e.start,W=e.end;if(E&&W)return e.fg?this.Prm(E,W,t):this.O6d(E.node,E.cpBegin,W.cpEnd,t,!1)}Prm(e,t,E){t=this.$g.gX(e,t);e=new fa.a;for(const W of t)t=this.akc(W,E,!0),e.addRange(t);return e}getNextOrNullObject(e,t){if(!e.Cd||0===e.Cd.count)return null;e=e.Cd.J(e.Cd.count-1);if(e.cpEnd!==e.node.characterData.length){var E=this.O6d(e.node,e.cpEnd,e.node.characterData.length,t,!0);if(0<E.count)return E.J(0)}for(e=this.jb.zg(e.node,!1,!0);e;){E=this.akc(e,
t,!0);if(0<E.count)return E.J(0);e=this.jb.zg(e,!1,!0)}return null}Nrm(e){var t;if(null===e.Cd||0===e.Cd.count)return"";if(Zv.a.Taa&&e.WTf)return"HYPERLINK "+(null===(t=e.WTf)||void 0===t?void 0:t.url);e=e.Cd.J(0);(e=e.node.qa.sh(-1==e.cpBegin?0:e.cpBegin))&&e.fc||vc.a.ng();const E=[];for(t=0;t<e.fc.length;++t)if(0===e.fc.J(t).ve){const W=new XI.a(e.fc,t);for(const ha of HE.a.LUa(W,!1))if(1===ha.wl.ve){if(!Zv.a.oyi)return ha.wl.BU;E.push(ha.wl.BU)}}return Zv.a.oyi&&0!==E.length?1===E.length?E[0]:
E.every(W=>W===E[0])?(z.ULS.sendTraceTag(508347467,324,50,"Found duplicate field instruction in {0} markers",E.length),E[0]):E.join(""):""}$So(e,t){if(null!==e.Cd&&0!==e.Cd.count){e=e.Cd.J(0);var E=e.node.qa.sh(e.cpBegin);if(E&&E.fc)for(let W of HE.a.U6(e.node,e.cpBegin))1===W.wl.ve&&(W.wl.BU=t);else vc.a.ng()}}ryi(e,t,E){const W=new fa.a;for(const ha of this.Ih.vy(e,0,this.Ih.xg(e)-1))W.addRange(this.syi(ha,t,E));return W}syi(e,t,E){const W=new fa.a;for(const ha of this.bE.OA(e))W.addRange(this.Rrm(ha,
t,E));return W}Rrm(e,t,E){if(this.n6.$s(e))return null;const W=this.Zc.Ql();W.set(e);var ha=W.Xd();for(e=new fa.a;ha;)ha=W.Xd(),12===ha.type?e.addRange(this.akc(ha,t,E)):14===ha.type&&e.addRange(this.ryi(ha,t,E)),W.uc(),ha=W.Fk();return e}insertField(e,t,E,W=31,ha,Ka=!1){W=0==W?31:W;this.od.GW(e,E,0);const sb=e.J(0),dc=e.J(e.count-1);let xc=null;({ML:xc}=this.od.nN(sb,dc,E));4==E&&this.od.Ogc(e);switch(!0){case 31==W||81==W:return this.W9m(t,E,W,ha,Ka,xc,sb,dc);case 88==W:return this.d$m(e,t,E,ha);
case 13==W:return this.nan(xc).then(()=>{var Rc=this.jb.zg(xc.node,!1,!0);Rc=this.CMm(Rc);return this.vDb.create(Rc,t)});default:vc.a.qd()}}Z6l(e){switch(e){case 31:return" DATE ";case 81:return" ADDIN ";default:return""}}W9m(e,t,E=31,W,ha=!1,Ka,sb,dc){return OfficeExtension.WacRuntime.Utility.createPromise(xc=>{var Rc=this.Z6l(E);null!=W&&(Rc+=W);ha||(Rc+=" \\* MERGEFORMAT ");var md=this.uDb.insertField(Ka,Rc,31!=E||Zv.a.xVa?"":"temp"),ud=Zd.a.bU(md.cpBegin,md.cpEnd,!1,0==t||2==t||4==t?sb.node:dc.node);
if(31==E){const Ud=this.Rhh.W4c(Ry.a.wic(Rc));Ud&&(Zv.a.xVa?(ud=this.uDb.JDf(md),Ud.YEe(Rc,ud)):(md=new fa.a,md.add(ud),Ud.YEe(Rc,md)));Rc=this.uDb.JDf(Ka);Rc=this.vDb.create(Rc,e)}else Rc=new fa.a([ud]),Rc=this.vDb.create(Rc,e);xc(Rc)})}d$m(e,t,E,W){return OfficeExtension.WacRuntime.Utility.createPromise(ha=>{var Ka=this.od.insertText(e,W,E),sb=Ka.J(0);sb=this.fF.vF(sb,W,!1,!1,!0,!1);Ka=this.vDb.create(Ka,t,0,sb);ha(Ka)})}nan(e){return OfficeExtension.WacRuntime.Utility.createPromise(t=>{if(32!==
this.DPk.zTi(0,e,2,null,{resolve:t}))throw vc.a.ng();})}CMm(e){var t,E=null===(t=null===e||void 0===e?void 0:e.qa)||void 0===t?void 0:t.first.Hb;(!E||0>=E.length)&&vc.a.ng();t=e.qa.first.Hb.J(0);t.fg||(z.ULS.sendTraceTag(508949568,3019,15,"Content control is not block type"),vc.a.ng());t=this.qh.pr(t.Ud.id,!1);E=new fa.a;for(E.add(Zd.a.create(e));e&&(e=Xf.ParagraphReader.zg(e,!1),E.add(Zd.a.create(e)),e.id!=t););return E}N6d(e){if(null===e.Cd||0===e.Cd.count)return null;e=e.Cd.J(0);if((e=e.node.qa.sh(e.cpBegin))&&
e.fc){for(let t=0;t<e.fc.length;t++){const E=e.fc.J(t);if(0===E.ve)return E}return null}vc.a.ng()}updateResult(e){const t=this.Rhh.W4c(Ry.a.wic(e.code));if(t)if(Zv.a.Taa){const E=this.uDb.JDf(e.Cd.J(0));t.YEe(e.code,E)}else t.YEe(e.code,e.Cd);else 13===e.type&&this.ga.lg(e.Cd.J(0),wb.a.y2b,2,!1,null,null)}}Object(y.a)(IC,"FieldOperations",null,[1305]);class Oz{[Symbol.iterator](){return this}constructor(e,t=!1){this.gen=t;e=this.uPn(e);this.G$d=Ld.GraphIterator.eb(e);this.currentNode=this.Wtb(e)?
e:t?this.oFi():this.ZCi()}next(){const e=this.currentNode;return null!=e?(this.currentNode=this.gen?this.oFi():this.ZCi(),{value:e}):{value:void 0,done:!0}}ZCi(){for(;this.G$d.Cj(1);){const e=this.G$d.currentNode;if(this.Wtb(e))return e}}oFi(){for(;this.G$d.oP(1);){const e=this.G$d.currentNode;if(this.Wtb(e))return e}}uPn(e){e=Ld.GraphIterator.eb(e);return e.zb(10)?e.yp(10):null}Wtb(e){return!!e&&10===e.type&&e.yc===kk.a.xoa}static create(e,t=!1){return new Oz(e,t)}}Object(y.a)(Oz,"WordSectionNodeIterator",
null,[]);var iB=d(1845);class Mx{constructor(e,t,E,W,ha,Ka,sb){this.Qi=sb;this.dqa=this.rT=this._context=this.KDh=this.sya=this.$g=this.$k=null;this.mJc=this.jCb=this.kLh=this.r5=0;this.AJh=!1;this.fHa=e;this.od=t;this.jb=E;this.Yx=W;this.HRa=Ka}zv(e,t,E){this.$k=e;this.$g=t;this.sya=E}getHtml(e,t){vc.a.C1c()&&this.od.L1f(e[0].node)&&vc.a.PIg();t.An.BF();let E="";e=({NWa:E}=this.HRa.tJf(e,!0)).returnValue;t.An.yv();e!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&vc.a.ng();return E}nsn(e){if((new RegExp(Mx.CBh)).test(e))return!0;
const t=new RegExp(Mx.BBh,"g");let E=0;for(;t.exec(e)&&1>=E;)E++;return 1<E}snn(e){return(new RegExp(Mx.BBh)).test(e)||(new RegExp(Mx.CBh)).test(e)}insertHtml(e,t,E,W,ha,Ka=!1,sb=null){this._context=ha;ha=this.snn(t)?1:0;this.od.GW(e,E,ha);let dc=new fa.a,xc=!1,Rc=null,md=13;if(vc.a.Qud())4===E&&(this.$g.uNb(),this.od.ELb(e),this.$g.bKa(),E=2),ha=new fa.a,ha.addRange(e),xc=this.od.Yee(ha,E),{ML:Rc,returnValue:md}=this.od.nN(ha.J(0),ha.J(ha.count-1),E),this.nsn(t)&&(Rc=this.$g.pPa(Rc,e)),dc.add(Rc),
xc&&({ML:Rc,returnValue:md}=this.od.nN(e.J(0),e.J(e.count-1),E));else{ha=e.J(0);const ud=e.J(e.count-1);({ML:Rc,returnValue:md}=this.od.nN(ha,ud,E));13===md?dc=e:dc.add(Rc)}sb&&sb.exb();return OfficeExtension.WacRuntime.Utility.createPromise(ud=>{const Ud=this.HRa.Bxe(dc.toArray(),!0,t,(Id,Ee)=>{Id===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&Ee||(sb&&sb.jAa(e),vc.a.ng());Id=new fa.a;for(const kf of Ee.toArray())Id.add(kf);Id.J(0).contextId===na.a.Xc?(Id.clear(),Id.add(Rc)):(this.od.Uv(Id.J(0)),
this.od.Uv(Id.J(Id.count-1)));Ee=this.$k.create(Id,this._context);ud(Ee);if(Ka){if(xc&&(Ee=Id.J(Id.count-1),Ee.contextId===na.a.paragraph)){let kf;this.od.q_d((kf=new fa.a,kf.add(Zd.a.create(this.jb.zg(Ee.node,!1))),kf))}this.owp(e,Id,md,xc)}sb&&sb.jAa(e);vc.a.vP("FileApiOperations.InsertHtml",vc.a.fQ(W),t.length)});Ud!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(sb&&sb.jAa(e),Ud===OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection&&vc.a.tFa&&vc.a.rC(),vc.a.ng())})}owp(e,t,E,W=!1){if(t.count&&
(1!==t.count||t.J(0).contextId!==na.a.Xc)){var ha=e.J(0),Ka=e.J(e.count-1),sb=t.J(t.count-1),dc=this.jb.zg(sb.node,!1);switch(E){case 0:sb.contextId!==na.a.Bd||W?e.Z(0,Zd.a.create(dc)):(e.Z(0,Zd.a.create(sb.node)),this.od.Uv(e.J(0),0),t.removeAt(t.count-1));e.J(0).Tb=ha.wo();e.pD(0,t);break;case 1:case 2:sb.contextId===na.a.Bd?(e.Z(0,Zd.a.Xl(sb.node)),e.J(0).Tb=ha.wo()):sb.contextId===na.a.paragraph?e.removeAt(0):sb.contextId===na.a.Vc&&t.remove(sb);e.pD(0,t);break;case 3:if(E=ha.cpEnd-ha.cpBegin){if(sb.contextId===
na.a.Bd)W?(e.Z(0,Zd.a.createTextRange(dc,0,E)),t.add(Zd.a.Xl(sb.node))):(e.Z(0,Zd.a.createTextRange(sb.node,sb.cpBegin,sb.cpEnd+E)),t.removeAt(t.count-1),t.count||(e.J(0).Fb=sb.vo())),1<e.count&&e.J(1).contextId===na.a.Vc&&e.Z(1,Zd.a.Xl(e.J(0).node));else if(sb.contextId===na.a.paragraph||sb.contextId===na.a.Vc)e.Z(0,Zd.a.createTextRange(dc,0,E)),1<e.count&&e.J(1).contextId===na.a.Vc&&e.Z(1,Zd.a.Xl(dc));e.J(0).Tb=ha.wo()}else e.removeAt(0);e.pD(0,t);break;case 5:case 6:e.Z(0,Zd.a.Xl(sb.node));this.od.gFa(e.J(0));
e.J(0).Tb=this.jb.Bx(e.J(0).node);break;case 7:if(E=ha.cpEnd-ha.cpBegin){if(sb.contextId===na.a.Bd)W?(e.Z(0,Zd.a.createTextRange(dc,0,E)),e.J(0).Fb=this.jb.ry(dc)):(e.Z(0,Zd.a.createTextRange(sb.node,sb.cpEnd,sb.cpEnd+E)),this.od.gFa(e.J(0))),1<e.count&&e.J(1).contextId===na.a.Vc&&e.Z(1,Zd.a.Xl(e.J(0).node));else if(sb.contextId===na.a.paragraph||sb.contextId===na.a.Vc)e.Z(0,Zd.a.createTextRange(dc,0,E)),e.J(0).Fb=this.jb.ry(dc),1<e.count&&e.J(1).contextId===na.a.Vc&&e.Z(1,Zd.a.Xl(dc));e.J(0).Tb=
ha.wo()}else{if(sb.contextId===na.a.Bd)e.Z(0,Zd.a.Tc(sb.node,sb.cpEnd)),this.od.gFa(e.J(0));else if(sb.contextId===na.a.paragraph||sb.contextId===na.a.Vc)e.Z(0,Zd.a.zx(sb.node)),this.od.gFa(e.J(0));e.J(0).Tb=e.J(0).vo()+ha.wo()-ha.vo()}break;case 4:sb.contextId!==na.a.Bd||W?(e.Z(0,Zd.a.create(dc)),e.J(0).Fb=ha.vo(),e.J(0).Tb=ha.wo()):(e.Z(0,Zd.a.createTextRange(sb.node,sb.cpEnd,this.jb.textLength(sb.node))),this.od.gFa(e.J(0)),e.J(0).Tb=ha.wo(),e.insert(1,Zd.a.Xl(sb.node)));break;case 9:Ka.contextId===
na.a.Vc?W||(e.removeAt(e.count-1),t.J(0).contextId===na.a.Bd&&0<e.count&&e.J(e.count-1).contextId===na.a.Bd&&(t.Z(0,Zd.a.createTextRange(t.J(0).node,e.J(e.count-1).cpBegin,t.J(0).cpEnd)),t.J(0).Fb=e.J(e.count-1).vo(),e.removeAt(e.count-1))):Ka.contextId!==na.a.paragraph||W||t.J(0).contextId!==na.a.Bd||(e.Z(e.count-1,Zd.a.createTextRange(t.J(0).node,0,t.J(0).cpEnd)),e.J(e.count-1).Fb=Ka.vo(),t.removeAt(0));sb.contextId===na.a.Bd&&(W=Zd.a.Xl(sb.node),W.Tb=this.jb.Bx(sb.node),t.add(W));e.addRange(t);
break;case 10:Ka.contextId===na.a.Xc?e.removeAt(e.count-1):Ka.contextId===na.a.Bd&&(t.J(0).contextId===na.a.Bd?(e.Z(e.count-1,Zd.a.createTextRange(t.J(0).node,Ka.cpBegin,t.J(0).cpEnd)),this.od.Uv(e.J(e.count-1),1),t.removeAt(0)):t.J(0).contextId===na.a.Vc&&e.Z(e.count-1,Zd.a.createTextRange(t.J(0).node,Ka.cpBegin,Ka.cpEnd)),e.J(e.count-1).Fb=Ka.vo());e.addRange(t);break;case 12:W||(Ka.contextId===na.a.Xc?e.Z(e.count-1,Zd.a.Tc(t.J(0).node,Ka.cpBegin)):Ka.contextId===na.a.Bd&&e.Z(e.count-1,Zd.a.createTextRange(t.J(0).node,
Ka.cpBegin,Ka.cpEnd)),e.J(e.count-1).Fb=Ka.vo(),e.J(e.count-1).Tb=Ka.wo());break;case 13:e.clear(),e.addRange(t)}}}getOoxml(e,t,E,W,ha){this.N7c(null,t,E,W,ha);this.fHa.getOoxml(e.toArray(),Ka=>{this.rT(Ka);this._context.An.yv();vc.a.vP("FileApiOperations.GetOoxml",vc.a.fQ(this.r5),Ka.length)},Ka=>{z.ULS.sendTraceTag(17568003,369,10,"AppId:{0}, {1}",this._context.appId,iB.a[Ka]);this.dqa(iB.a[Ka]);this._context.An.yv();vc.a.vP("FileApiOperations.GetOoxml",vc.a.fQ(this.r5),void 0,!1)})}insertOoxml(e,
t,E,W,ha,Ka,sb,dc,xc,Rc=0,md=!1,ud=null,Ud=null){this.od.GW(e,E,0);ud&&ud.exb();this.N7c(W,ha,Ka,sb,dc,xc,Rc,E,md);this._context.An.BF();this.F$m(e,t,ud,Ud)}N7c(e,t,E,W,ha,Ka=0,sb=0,dc=0,xc=!1){this.KDh=e?8===e.type||10===e.type?e:this.zMf(e):null;this._context=t;this.rT=E;this.dqa=W;this.r5=ha;this.kLh=Ka;this.jCb=sb;this.mJc=dc;this.AJh=xc}F$m(e,t,E,W){let ha=new fa.a;var Ka=e.J(0);const sb=e.J(e.count-1);var dc=null;const xc=({ML:dc}=this.od.nN(Ka,sb,this.mJc)).returnValue;let Rc=null,md=null;
13===xc?(ha=e,this.jCb||(this.jCb=this.Umm(e)),dc=Zd.a.Tc(Ka.node,Ka.lk),dc.Tb=dc.Fb=Ka.Fb,Ka=Zd.a.Tc(sb.node,sb.Ep),Ka.Tb=Ka.Fb=sb.Tb,Rc=this.$g.Kdc(dc,void 0,!0),md=this.$g.Kdc(Ka,void 0,!1)):(ha.add(dc),this.jCb||-1===dc.vo()||(this.mJc=({Iw:this.jCb}=this.Tmm(dc,this.jCb)).returnValue),Rc=this.$g.Kdc(dc,void 0,!0),md=this.$g.Kdc(dc,void 0,!1));let ud=-1,Ud=-1;9===xc&&(ud=sb.vo(),Ud=sb.wo());this.fHa.lye(ha.toArray(),t,this.jCb,this.mJc,this.kLh,W,async Id=>{Id=vc.a.P9m()?await this.Fwm(Id):this.HAi(Id);
this._context.An.yv();if(0===Id.count)return this.dqa("Can't find the inserted content. Please refresh the page for the result.");this.$g.uve(Id.J(0),Rc,void 0,void 0,!0);this.$g.uve(Id.J(Id.count-1),md,void 0,void 0,!1);var Ee=new fa.a;Ee.addRange(Id);isNull(W)?(Ee=this.$k.create(Ee,this._context),this.rT(Ee)):this.rT(new wp(this.AJm(Ee,this.mJc)));this.AJh&&this.hFe(e,Id,xc,ud,Ud);E&&E.jAa(e);vc.a.vP("FileApiOperations.SetOoxml",vc.a.fQ(this.r5),t.length)},Id=>{this._context.An.yv();z.ULS.sendTraceTag(17585566,
369,10,"AppId:{0}, {1}",this._context.appId,iB.a[Id]);this.dqa(iB.a[Id]);E&&E.jAa(e);vc.a.vP("FileApiOperations.SetOoxml",vc.a.fQ(this.r5),t.length,!1)})}Fwm(e){return OfficeExtension.WacRuntime.Utility.createPromise(t=>{const E=(new Yo.a).create();E.message="Waiting...";E.lM(CommonUIStrings.l_DefaultDialogTitle,()=>{t(new fa.a)},null);var W=vc.a.Q9m();const ha=vc.a.R9m();let Ka=0;W=new kh.a(2,2,1E3*W,sb=>{const dc=this.HAi(e,Ka);if(dc.count)return this.Qi.vf(sb),E.close(),t(dc);Ka++;if(Ka>ha)return this.Qi.vf(sb),
E.close(),t(new fa.a)});this.Qi.Zb(W)})}HAi(e,t=0){var E=new fa.a;e&&(E=this.jb.Gv(this.KDh,!0,!0),E=this.fHa.pkc(e,E),E.count||(E=this.Yx.tzi(),E=this.fHa.pkc(e,E)));E.count||z.ULS.sendTraceTag(18354846,369,10,"AppId:{0}, Can't find the inserted content when setting ooxml, retryTime:{1}",this._context.appId,t);return E}DHo(e,t,E){this.fHa.Jvg(e,6,W=>{W?t(W):E("retrieved styles string is empty or null")},W=>{E(iB.a[W])})}AJm(e,t){const E=new fa.a;let W=0;switch(t){case 2:var ha=e.J(e.count-1);for(var Ka of Oz.create(ha.node,
!0))E.add(this.sya.create(Ka,this._context,W++));break;case 4:case 3:Ka=e.J(0);for(ha of Oz.create(Ka.node))E.add(this.sya.create(ha,this._context,W++))}return E}Tmm(e,t){t=null;var E=e.node;let W=4;if(!E.qa)return{returnValue:0,Iw:0};E=E.qa.sh(e.cpBegin);e=e.vo();if(E&&E.Hb&&0<E.Hb.length){E=E.Hb;const ha=E.length;!e&&E.J(0).Wc&&E.J(0).lq?(t=E.J(0).Ud,W=0):e||E.J(0).Wc||!E.J(0).lq?e<=ha&&0<e&&E.J(e-1).Wc&&E.J(e-1).lq?(t=E.J(e-1).Ud,W=2):e<ha&&0<e&&E.J(e-1).Wc&&!E.J(e-1).lq&&E.J(e).Wc?(t=E.J(e).Ud,
W=0):e<=ha&&0<e&&!E.J(e-1).Wc&&(t=E.J(e-1).Ud,W=1):(t=E.J(0).Ud,W=3)}t=t?t.ja(fd.a.Iw,0):0;return{returnValue:W,Iw:t}}Umm(e){let t=null;var E=null;({ML:t}=this.od.nN(e.J(0),e.J(e.count-1),2));({ML:E}=this.od.nN(e.J(0),e.J(e.count-1),3));e=this.mwi(t,!0);E=this.mwi(E,!1);return e===E?e:0}mwi(e,t){let E=null;var W=e.node;if(!W.qa)return 0;W=W.qa.sh(e.cpBegin);e=e.vo();if(W&&W.Hb&&0<W.Hb.length){W=W.Hb;const ha=W.length;t&&0<e&&W.J(e-1).Wc&&W.J(e-1).lq?E=W.J(e-1).Ud:!t&&e<ha&&!W.J(e).Wc&&W.J(e).lq&&
(E=W.J(e).Ud)}return E?E.ja(fd.a.Iw,0):0}hFe(e,t,E,W=-1,ha=-1){if(!(0>=t.count||1===t.count&&t.J(0).contextId===na.a.Xc)){var Ka=e.J(0),sb=e.J(e.count-1),dc=t.J(0),xc=t.J(t.count-1);switch(E){case 0:xc.contextId===na.a.Bd&&(e.Z(0,Zd.a.create(xc.node)),e.J(0).Tb=Ka.wo(),this.od.Uv(e.J(0),0),t.removeAt(t.count-1));e.pD(0,t);break;case 1:case 2:xc.contextId===na.a.Vc&&e.removeAt(0);e.pD(0,t);break;case 3:(E=Ka.cpEnd-Ka.cpBegin)?(xc.contextId===na.a.Bd?(e.Z(0,Zd.a.createTextRange(xc.node,xc.cpBegin,xc.cpEnd+
E)),t.removeAt(t.count-1)):e.Z(0,Zd.a.createTextRange(Ka.node,0,E)),e.J(0).Tb=Ka.wo(),this.od.Uv(e.J(0),0)):e.removeAt(0);e.pD(0,t);break;case 5:case 6:xc.contextId===na.a.Bd?(e.Z(0,Zd.a.Xl(xc.node)),e.J(0).Fb=e.J(0).Tb=this.jb.Bx(xc.node)):e.Z(0,t.J(t.count-1));break;case 7:E=Ka.cpEnd-Ka.cpBegin;xc.contextId===na.a.Bd?Ka.contextId===na.a.Bd?(e.Z(0,Zd.a.createTextRange(Ka.node,xc.cpEnd,xc.cpEnd+E)),this.od.gFa(e.J(0)),e.J(0).Tb=Ka.wo()):(e.Z(0,Zd.a.Tc(Ka.node,xc.cpEnd)),this.od.gFa(e.J(0)),e.J(0).Tb=
e.J(0).Fb+Ka.wo()-Ka.vo()):(Ka.contextId===na.a.Bd?e.Z(0,Zd.a.createTextRange(Ka.node,0,E)):e.Z(0,Zd.a.Tc(Ka.node,0)),this.od.APa(e.J(0),Ka));break;case 4:xc.contextId===na.a.Bd&&(e.Z(0,Zd.a.createTextRange(xc.node,xc.cpEnd,xc.node.characterData.length)),e.J(0).Tb=Ka.wo(),this.od.gFa(e.J(0)),e.insert(1,Zd.a.Xl(xc.node)));break;case 9:sb.contextId===na.a.paragraph?(e.Z(e.count-1,Zd.a.create(dc.node)),e.J(e.count-1).Fb=W,e.J(e.count-1).Tb=ha,t.removeAt(0)):e.removeAt(e.count-1);e.addRange(t);break;
case 10:Ka.contextId===na.a.Xc?e.clear():t.J(0).contextId!==na.a.Vc?(e.Z(e.count-1,Zd.a.createTextRange(t.J(0).node,sb.cpBegin,t.J(0).cpEnd)),t.removeAt(0),e.J(e.count-1).Fb=sb.vo(),this.od.Uv(e.J(e.count-1),1)):(e.Z(e.count-1,Zd.a.createTextRange(t.J(0).node,sb.cpBegin,sb.cpEnd)),e.J(e.count-1).Fb=sb.vo());e.addRange(t);break;case 12:E=sb.cpEnd-sb.cpBegin;e.Z(e.count-1,E?Zd.a.createTextRange(dc.node,sb.cpBegin,sb.cpEnd):Zd.a.Tc(dc.node,sb.cpBegin));e.J(e.count-1).Fb=sb.vo();e.J(e.count-1).Tb=sb.wo();
break;case 13:e.clear(),e.addRange(t)}}}zMf(e){const t=new Ld.GraphIterator;t.set(e);e=null;t.zb(10)&&(e=t.yp(10));return e}}Mx.BBh="<(?:p|li)(?:\\s|>|/)";Mx.CBh="<table(?:\\s|>|/)";Object(y.a)(Mx,"FileApiOperations",null,[1306]);var JC=d(778),hv=d(382),Nt=d(358);class jB{constructor(){this.CEg=this.formatting=null}}Object(y.a)(jB,"TextFormattingActionData",null,[]);var IE=d(848),JE=d(1526),aw;(function(e){e[e.K7p=-1]="mixed";e[e.none=0]="none";e[e.hidden=5]="hidden";e[e.vYp=8]="dotLine";e[e.P_a=
1]="single";e[e.word=2]="word";e[e.double=3]="double";e[e.xnq=6]="thick";e[e.tii=4]="dotted";e[e.wYp=20]="dottedHeavy";e[e.ZWp=7]="dashLine";e[e.$Wp=23]="dashLineHeavy";e[e.aXp=39]="dashLineLong";e[e.bXp=55]="dashLineLongHeavy";e[e.tYp=9]="dotDashLine";e[e.uYp=25]="dotDashLineHeavy";e[e.foq=10]="twoDotDashLine";e[e.goq=26]="twoDotDashLineHeavy";e[e.Ipq=11]="wave";e[e.Kpq=27]="waveHeavy";e[e.Jpq=43]="waveDouble"})(aw||(aw={}));Object(y.b)("UnderlineType",aw);class bw extends si.a{constructor(e,t,E,
W,ha,Ka,sb,dc,xc,Rc,md){super();this.h7b=this.Cd=null;this.mEc=e;this.CLd=t;this.Krk=E;this.jF=W;this._context=ha;this._style=Ka;this.Zv=sb;this.jb=dc;this.ga=xc;this.Eoa=Rc;this.bCd=null;this.opa=md;this.jF&&this._context.Lad&&(this.h7b=this.jF.s8c.create(this.jF.Fq))}get bold(){if(null!=this._style){if(this._style.hasProperty(Tb.a.bold))return this._style.getValue(Tb.a.bold)}else{var e=this.L_();return e.cUc?null:1===e.bold}}set bold(e){vc.a.yz(e,"Font.Bold");if(null!=this._style){const t=new Map;
t.set(Tb.a.bold,e);this.wD(t)}else this.exc(wb.a.bold,e)}get color(){if(null!=this._style){if(this._style.hasProperty(Tb.a.fontColor)){var e=this._style.getValue(Tb.a.fontColor);return 16777215<e?"#000000":Ok.a.VC(e).toUpperCase()}}else return e=this.L_(),e.ROb?"":16777215<e.fontColor?"#000000":Ok.a.VC(e.fontColor).toUpperCase()}set color(e){e=vc.a.LPa(e,"Font.Color",this._context);if(null!=this._style){const t=new Map;t.set(Tb.a.fontColor,Number("0x"+e));this.wD(t)}else this.Izg(wb.a.ax,e)}get doubleStrikeThrough(){if(null!=
this._style){if(this._style.hasProperty(gb.a.du))return this._style.getValue(gb.a.du)}else{var e=this.L_();return e.NZc?null:1===e.du}}set doubleStrikeThrough(e){vc.a.yz(e,"Font.DoubleStrikeThrough");if(null!=this._style){const t=new Map;t.set(gb.a.du,e);this.wD(t)}else this.exc(wb.a.du,e)}get highlightColor(){if(null!=this._style){if(this._style.hasProperty(Tb.a.highlight)){var e=this._style.getValue(Tb.a.highlight);return 16777215<e?null:Ok.a.VC(e).toUpperCase()}}else return e=this.L_(),e.w6c?"":
16777215<e.highlight?null:Ok.a.VC(e.highlight).toUpperCase()}set highlightColor(e){if(e&&""!==e)if(e=vc.a.LPa(e,"Font.HighlightColor",this._context),null!=this._style){const t=new Map;t.set(Tb.a.highlight,Number("0x"+e));this.wD(t)}else this.Izg(wb.a.vY,e);else null!=this._style?(e=new Map,e.set(Tb.a.highlight,null),this.wD(e)):this.Izg(wb.a.Kza,"")}get italic(){if(null!=this._style){if(this._style.hasProperty(Tb.a.italic))return this._style.getValue(Tb.a.italic)}else{var e=this.L_();return e.Rpc?
null:1===e.italic}}set italic(e){vc.a.yz(e,"Font.Italic");if(null!=this._style){const t=new Map;t.set(Tb.a.italic,e);this.wD(t)}else this.exc(wb.a.kA,e)}get name(){if(null!=this._style){if(this._style.hasProperty(Tb.a.font))return this._style.getValue(Tb.a.font)}else{var e=this.L_();return e.n1c?"":e.fontName}}set name(e){vc.a.xBc(e,"Font.Name");if(null!=this._style){const t=new Map;t.set(Tb.a.font,e);this.wD(t)}else this.vEa(wb.a.font,new JC.a(e))}get size(){if(null!=this._style){if(this._style.hasProperty(Tb.a.fontSize))return this._style.getValue(Tb.a.fontSize)/
2}else{var e=this.L_();return e.o1c?null:e.fontSize/2}}set size(e){if(e>bw.OJn||e<bw.EMn)z.ULS.sendTraceTag(36312091,369,50,"Invalid font size: {0}.",e),vc.a.qd();if(null!=this._style){const t=new Map;t.set(Tb.a.fontSize,Math.round(2*e));this.wD(t)}else this.vEa(wb.a.oC,new JC.a(Math.round(2*e)))}get strikeThrough(){if(null!=this._style){if(this._style.hasProperty(Tb.a.strikethrough))return this._style.getValue(Tb.a.strikethrough)}else{var e=this.L_();return e.Oyc?null:1===e.strikethrough}}set strikeThrough(e){vc.a.yz(e,
"Font.StrikeThrough");if(null!=this._style){const t=new Map;t.set(Tb.a.strikethrough,e);this.wD(t)}else this.exc(wb.a.strikethrough,e)}get subscript(){if(null!=this._style){if(this._style.hasProperty(Tb.a.subscript))return this._style.getValue(Tb.a.subscript)}else{var e=this.L_();return e.$qd?null:1===e.subscript}}set subscript(e){vc.a.yz(e,"Font.Subscript");if(null!=this._style){const t=new Map;t.set(Tb.a.subscript,e);this.wD(t)}else this.exc(wb.a.subscript,e)}get superscript(){if(null!=this._style){if(this._style.hasProperty(Tb.a.superscript))return this._style.getValue(Tb.a.superscript)}else{var e=
this.L_();return e.brd?null:1===e.superscript}}set superscript(e){vc.a.yz(e,"Font.SuperScript");if(null!=this._style){const t=new Map;t.set(Tb.a.superscript,e);this.wD(t)}else this.exc(wb.a.superscript,e)}get underline(){const e=[1,2,3,6,4,20,7,23,39,55,9,25,10,26,11,27,43,0];if(null!=this._style){if(this._style.hasProperty(Tb.a.underlineType)){var t=this._style.getValue(Tb.a.underlineType);const E=this.aKi();return e[E.J(aw[t])]}}else return t=this.L_(),t.HS?-1:e[t.underlineType]}set underline(e){var t=
this.aKi();t.mb(aw[e])||vc.a.qd();null!=this._style?(t=new Map,t.set(Tb.a.underlineType,e),0!=e&&t.set(Tb.a.underline,!0),this.wD(t)):this.vEa(wb.a.yha,t.J(aw[e]))}get _ReferenceId(){return this.gr?this.Gr:null}_KeepReference(){this.Wq()}_OnAccess(){if(null==this._style)switch(this.mEc){case 0:case 5:case 6:this.Cd=this.jb.SA(this.CLd,!0,!1);break;case 3:this.Cd=new fa.a;this.Cd.add(Zd.a.create(this.CLd));break;case 1:this.Cd=this.Krk.TG();break;case 4:v.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")?
this.Cd=this.jF.onc?this.jF.onc.Fq:this.h7b?this.h7b.Fq:this.jF.Fq:this.Cd=this.jF.Fq;break;default:z.ULS.sendTraceTag(21824032,369,15,"AppId:{0}, invalid object type to set font on.",this._context.appId)}}getTypeName(){return"Microsoft.WordServices.Font"}invokePropertyGet(e){switch(e){case 4:return this.bold;case 6:return this.color;case 11:return this.doubleStrikeThrough;case 12:return this.highlightColor;case 5:return this.italic;case 2:return this.name;case 3:return this.size;case 10:return this.strikeThrough;
case 8:return this.subscript;case 9:return this.superscript;case 7:return this.underline;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 4:this.bold=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean?");return;case 6:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"string");return;case 11:this.doubleStrikeThrough=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean?");return;case 12:this.highlightColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 5:this.italic=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean?");return;case 2:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 3:this.size=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"number?");return;case 10:this.strikeThrough=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean?");return;case 8:this.subscript=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean?");return;case 9:this.superscript=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean?");return;case 7:this.underline=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){switch(e){case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}aKi(){const e=new gf.a;e.add("single",
0);e.add("word",1);e.add("double",2);e.add("thick",3);e.add("dotted",4);e.add("dottedHeavy",5);e.add("dashLine",6);e.add("dashLineHeavy",7);e.add("dashLineLong",8);e.add("dashLineLongHeavy",9);e.add("dotDashLine",10);e.add("dotDashLineHeavy",11);e.add("twoDotDashLine",12);e.add("twoDotDashLineHeavy",13);e.add("wave",14);e.add("waveHeavy",15);e.add("waveDouble",16);e.add("none",17);return e}exc(e,t){t=t?new yf.a(1):new yf.a(0);vc.a.Zzj()?this.opa.vEa(this.Cd,e,t):this.vEa(e,t)}Izg(e,t){this.vEa(e,
t)}vEa(e,t){if(this.Eoa.pVc(this.Cd,0)){var E=new hv.a;for(let W=0;W<this.Cd.count;W++)this.Cd.J(W).contextId!==na.a.Xc&&E.addContext(this.Cd.J(W));this.ga.gng(E,e,2,!0,new Nt.a,t)}}L_(){this._OnAccess();if(!this.bCd)if(vc.a.Zzj()){var e=this.opa.L_(this.Cd);e&&(this.bCd=e)}else{e=[new Nd.Selection(this.Cd.toArray(),!0)];e=new $f.SelectionCollection(e,0);const t=new jB;t.formatting=new IE.a;t.CEg=e;32===this.ga.lg(new sc.a(null),wb.a.Rid,2,!0,new Nt.a,t)&&(this.bCd=t.formatting)}return this.bCd}zkd(){v.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")&&
this.h7b&&(this.h7b.exb(),this.h7b=null)}wD(e){const t=this._style.getValue(fd.a.ma),E=new Zc.ScriptSharpLegacyMap;for(const W of e)E.Z(W[0],W[1]);this.Zv.DYa(t,E,Pd.a.Mp())}}bw.OJn=JE.a.ddj/2;bw.EMn=1;Object(y.a)(bw,"Font",si.a,[1143]);class kB{constructor(e,t,E,W,ha){this.jb=e;this.ga=t;this.Eoa=E;this.opa=W;this.Zv=ha}create(e,t,E,W,ha,Ka=null){return new bw(e,t,E,W,ha,Ka,this.Zv,this.jb,this.ga,this.Eoa,this.opa)}}Object(y.a)(kB,"FontFactory",null,[]);class Ow{constructor(e,t){this.ga=e;this.Eoa=
t}L_(e){e=[new Nd.Selection(e.toArray(),!0)];e=new $f.SelectionCollection(e,0);const t=new jB;t.formatting=new IE.a;t.CEg=e;return 32===this.ga.lg(new sc.a(null),wb.a.Rid,2,!0,new Nt.a,t)?t.formatting:null}vEa(e,t,E){if(this.Eoa.pVc(e,0)){var W=new hv.a;for(let ha=0;ha<e.count;ha++)e.J(ha).contextId!==na.a.Xc&&W.addContext(e.J(ha));this.ga.gng(W,t,2,!0,new Nt.a,E)}}}Object(y.a)(Ow,"FontOperaions",null,[1304]);class VG{constructor(e,t){this.fx=e;this.Fbf=t;this.PIh=[]}yv(e=null,t=15){e||(e=this.fx.value);
t=this.Fbf.Mc(t);t.Ab(e);this.PIh.push(t)}BF(){this.PIh.pop().dispose()}Nec(e){this.BF();this.yv(e,4)}}Object(y.a)(VG,"GraphTransactionWrapper",null,[1302]);var lB=d(1966);class an{constructor(e,t,E,W,ha,Ka,sb,dc,xc){this.UY=e;this.eq=t;this.jb=E;this.yt=W;this.pG=ha;this.Xuk=Ka;this.Af=sb;this.Ga=dc;this.us=xc}YKf(e,t){vc.a.NPa(t,"GraphNode");const E=this.UY.g2c(t,5);this.CAi(E,t,e)}u7d(e,t){vc.a.yz(t,"GraphNodeContext");const E=this.UY.lui(t);this.CAi(E,t.node,e)}CAi(e,t,E){for(const W of e){e=
!1;const ha=ob.a.instance.Oa("Box4.IFeatureHelper");if(this.eq.Hnc(W)||this.eq.Fnc(W)||this.eq.Gnc(W)||this.eq.Inc(W)||ha&&ha.isFeatureEnabled(46)&&this.eq.Jnc(W))e=!0;e&&(e=W.Jb.cp,E.add(Zd.a.createTextRange(t,e,e+1)))}}eSb(e,t,E,W){vc.a.xBc(e,"imgBase64Str");e=e.trim();return OfficeExtension.WacRuntime.Utility.createPromise((ha,Ka)=>{var sb=t.node,dc=new Ld.GraphIterator;dc.set(sb);const xc=this.Xuk.create(dc,ha,Ka),Rc=document.createElement("img");ha=()=>{const md=new lB.a(Rc.src,Rc.alt,Rc.width,
Rc.height);this.qCf(xc,md,t,E)};sb=()=>{Ka("")};v.AFrameworkApplication.$u&&W?(W.useSourceImageProps&&(W.height=0,W.width=0),this.qCf(xc,this.Rvm(e,W),t,E)):(dc=!1,(dc=void 0!==Rc.onload&&void 0!==Rc.onerror)?(Rc.onload=ha,Rc.onerror=sb,Rc.src=String.format("data:image/png;base64,{0}",e)):this.qCf(xc,this.Qvm(e),t,E))})}Qvm(e){const t=document.createElement("img");t.src=String.format("data:image/{0};base64,{1}","png",e);return new lB.a(t.src,t.alt,t.width,t.height)}Rvm(e,t){return new lB.a(e,t.altText?
t.altText:"",t.width,t.height)}toi(e,t){if(t&&5===t.Jh){t=t.id;e=this.UY.g2c(e,5);for(const E of e)if(E.id.equals(t))return E.Jb.cp}return-1}q8l(e,t){let E=this.toi(e,t);return 0>E&&({node:e,returnValue:E}=this.r8l(t),0>E)?{returnValue:-1,JMh:e}:{returnValue:E,JMh:e}}r8l(e){var t=this.tzi();for(const E of t)if(t=this.toi(E,e),-1!==t)return e=E,{returnValue:t,node:e};return{returnValue:-1,node:null}}D0c(e){const t=(new Date).getTime();let E=null;e=({JMh:E}=this.q8l(e.node,e.blob)).returnValue;vc.a.vP("ImageApiOperations.FindImageContextFromResult",
vc.a.fQ(t));return 0>e?(z.ULS.sendTraceTag(17433739,369,10,"the inserted inline picture can't be found"),vc.a.ng(),null):Zd.a.createTextRange(E,e,e+1)}getBase64ImageSrc(e,t,E,W,ha,Ka){const sb=this.eq.q9(e.properties,dj.a.iu,null);sb?this.eq.F3(sb)?(this.hGi(e,sb,W),E.An.yv(t.node)):(z.ULS.sendTraceTag(23594887,369,15,"AppId:{0}, Not valid ImageDataUrl: {1} ",E.appId,sb),vc.a.ng()):this.Gvm(t,e,E,W,ha,Ka)}Gvm(e,t,E,W,ha,Ka){const sb=t.properties,dc=this.eq.BKa(sb,e.node.Jj().td,this.Ga,this.us);this.eq.GTb(dc)?
this.eq.n9a(this.Af,dc,xc=>{let Rc=!0;const md=xc.data.De;2===xc.data.status&&this.eq.F3(md)?(this.hGi(t,md,W),sb.setValue(dj.a.iu,md)):(ha(""),Rc=!1);E.An.yv(e.node);vc.a.vP("ImageApiOperations.GetImageSrcFromServer",vc.a.fQ(Ka),void 0,Rc)},()=>{ha("");E.An.yv(e.node);vc.a.vP("ImageApiOperations.GetImageSrcFromServer",vc.a.fQ(Ka),void 0,!1)}):(z.ULS.sendTraceTag(23594888,369,15,"AppId:{0}, ImageDataUrl null, but not supported data url request: {1} ",E.appId,dc),vc.a.ng())}hGi(e,t,E){let W=null;const ha=
document.createElement("img");ha.src=t;ha.onload=()=>{var Ka=new He.a;const sb=Ka.nf(this.eq.tE(e.properties),0);Ka=Ka.nf(this.eq.YJ(e.properties),1);const dc=document.createElement("canvas");dc.width=sb;dc.height=Ka;dc.getContext("2d").drawImage(ha,0,0,sb,Ka);W=dc.toDataURL();E(W.substr(W.indexOf(";base64,")+8))}}tzi(){const e=new Ld.GraphIterator;e.set(this.yt.value);this.pG.dS(e);return this.jb.Gv(this.pG.EMf(e.currentNode),!0,!0)}qCf(e,t,E,W){e.gZn(t,E);W.An.BF();e.Egg()}}Object(y.a)(an,"ImageApiOperations",
null,[1303]);class WG extends si.a{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf){super();vc.a.yz(e,"GraphNodeContext");this.fr=e;this._context=t;this._id=E;this.Co=W;this.$k=ha;this.rO=Ka;this.eq=sb;this.Ck=dc;this.Oda=this.k7d(this.fr);this.Yx=xc;this.$g=Rc;this.Qq=md;this.od=ud;this.jx=Ud;this.$m=Id;this.jb=Ee;this.fd=kf}get altTextDescription(){return this.eq.eWa(this.Oda.properties)}set altTextDescription(e){this.Ck.I_b(this.Oda.properties,e)}get altTextTitle(){return this.eq.O_(this.Oda.properties)}set altTextTitle(e){this.Ck.x_a(this.Oda.properties,
e)}get height(){const e=this.eq.YJ(this.Oda.properties);return Ve.a.Lbb(e)}set height(e){vc.a.W0a(e,"InlinePicture.Height");e=Ve.a.FDa(e);this.lockAspectRatio&&this.Ck.pOa(this.Oda.properties,this.width/this.height*e);this.Ck.oOa(this.Oda.properties,e)}get hyperlink(){return this.eq.mkc(this.Oda.properties)}set hyperlink(e){this.Ck.qUo(this.Oda.properties,e)}get imageFormat(){return 0}get lockAspectRatio(){return this.eq.kab(this.Oda.properties)}set lockAspectRatio(e){this.Ck.lOj(this.Oda.properties,
e)}get paragraph(){return this.Co.create(this.fr.node,this._context)}get parentContentControl(){const e=this.parentContentControlOrNullObject;e||vc.a.hl();return e}get parentContentControlOrNullObject(){this.Ffb();return this.$g.olc(this.fr,this.fr,this._context)}get parentTable(){if(!vc.a.fj())return null;const e=this.parentTableOrNullObject;e||vc.a.hl();return e}get parentTableCell(){if(!vc.a.fj())return null;const e=this.parentTableCellOrNullObject;e||vc.a.hl();return e}get parentTableCellOrNullObject(){return vc.a.fj()?
this.fd.Rkc(this.fr.node,this._context):null}get parentTableOrNullObject(){return vc.a.fj()?this.fd.frb(this.fr.node,this._context):null}get width(){const e=this.eq.tE(this.Oda.properties);return Ve.a.Lbb(e)}set width(e){vc.a.W0a(e,"InlinePicture.Width");e=Ve.a.FDa(e);this.lockAspectRatio&&this.Ck.oOa(this.Oda.properties,this.height/this.width*e);this.Ck.pOa(this.Oda.properties,e)}get _Id(){return this._id}get _ReferenceId(){return this.gr?this.Gr:null}deleteInlinePicture(){this.Ffb();const e=this.fr.node;
for(let t=0;t<e.qa.length;t++)if(e.qa.J(t).cp===this.fr.cpBegin){this.od.oQl(this.fr);break}}getBase64ImageSrc(){const e=(new Date).getTime();this._context.An.BF();return OfficeExtension.WacRuntime.Utility.createPromise((t,E)=>{this.Yx.getBase64ImageSrc(this.Oda,this.fr,this._context,t,E,e)})}getNext(){const e=this.getNextOrNullObject();e||vc.a.hl();return e}getNextOrNullObject(){vc.a.fj()||vc.a.il();const e=this.jBm();return e?this.rO.create(e,this._context):null}getRange(e){vc.a.fj()||vc.a.il();
1!==e&&2!==e&&e&&(z.ULS.sendTraceTag(18745293,369,15,"AppId:{0}, rangeLocation of InlinePicture.GetRange must be Start/End/Whole.",this._context.appId),vc.a.qd());const t=new fa.a;t.add(this.fr);this.Ffb();return this.$k.create(this.$m.Jjc(t,e),this._context)}insertBreak(e,t){t&&1!==t&&(z.ULS.sendTraceTag(17339015,369,15,"AppId:{0}, insertLocation of InlinePicture.InsertBreak must be Before or After.",this._context.appId),vc.a.qd());const E=(new Date).getTime(),W=new fa.a;W.add(this.fr);this.Ffb();
return OfficeExtension.WacRuntime.Utility.createPromise((ha,Ka)=>{this.od.insertBreak(W,e,t,this._context,ha,Ka,E)})}insertContentControl(){this.Ffb();const e=new fa.a;e.add(this.fr);this.$g.thf(e);1!==e.count&&(z.ULS.sendTraceTag(37777540,369,10,"GncList's length is incorrect after adjustment.",this._context.appId),vc.a.ng());return e.J(0)!==this.fr?this.$g.Nqa(e.J(0),e.J(0),this._context):this.$g.U5a(this.fr,this._context)}insertFileFromBase64(e,t){"<"===e.charAt(0)&&(z.ULS.sendTraceTag(18130837,
369,10,"invalid argument for insertFileFromeBase64 API in InlinePicture class.",this._context.appId),vc.a.qd());return this.Hla(e,t,!1)}insertHtml(e,t){const E=(new Date).getTime();if(!t||1===t){const W=new fa.a;W.add(this.fr);return this.jx.insertHtml(W,e,t,E,this._context)}vc.a.qd();return null}insertInlinePictureFromBase64(e,t){if(2===t||3===t)return z.ULS.sendTraceTag(17319648,369,50,"AppId:{0}, insert inline picture with none supported location in InlinePicture class.",this._context.appId),vc.a.qd(),
null;const E=(new Date).getTime();let W=null;this.Ffb();if(4===t){let ha;this.od.GW((ha=new fa.a,ha.add(this.fr),ha),t,0);W=Zd.a.Tc(this.fr.node,this.fr.cpBegin);W.Fb=W.Tb=this.fr.vo();this.deleteInlinePicture()}else{({ML:W}=this.od.nN(this.fr,this.fr,t));let ha;this.od.GW((ha=new fa.a,ha.add(W),ha),t,0)}return this.Yx.eSb(e,W,this._context).then(ha=>{this._context.An.yv(this.fr.node);if(!ha)return z.ULS.sendTraceTag(17433740,369,10,"AppId:{0}, something went wrong when insert iamge into InlinePicture.",
this._context.appId),vc.a.vP("InlinePicture.InsertInlinePictureFromBase64",vc.a.fQ(E),e.length,!1),vc.a.ng(),null;vc.a.vP("InlinePicture.InsertInlinePictureFromBase64",vc.a.fQ(E),e.length);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.rO.create(this.Yx.D0c(ha),this._context))})}insertOoxml(e,t){"<"!==e.charAt(0)&&(z.ULS.sendTraceTag(18130838,369,10,"invalid argument for InsertOoxml API in InlinePicture class.",this._context.appId),vc.a.qd());return this.Hla(e,t,!0)}insertParagraph(e,
t){t&&1!==t&&(z.ULS.sendTraceTag(21070049,369,15,"AppId:{0}, Invalid insert location for InlinePicture.InsertPparagraph method.",this._context.appId),vc.a.qd());this.Ffb();let E;return this.Co.create(this.od.insertParagraph((E=new fa.a,E.add(this.fr),E),e,t),this._context)}insertText(e,t){t&&1!==t&&(z.ULS.sendTraceTag(17339328,369,15,"AppId:{0}, invalid location for InlinePicture.InsertText:{1}.",this._context.appId,Mt.a[t]),vc.a.qd());this.Ffb();let E;return this.$k.create(this.od.insertText((E=
new fa.a,E.add(this.fr),E),e,t),this._context)}select(e){const t=new fa.a;t.add(this.fr);this.Qq.select(t,e)}_KeepReference(){this.Wq()}_OnAccess(){vc.a.c5(this.fr.node,"InlinePicture")}getTypeName(){return"Microsoft.WordServices.InlinePicture"}invokePropertyGet(e){switch(e){case 3:return this.altTextDescription;case 4:return this.altTextTitle;case 5:return this.height;case 6:return this.hyperlink;case 11:return this.imageFormat;case 7:return this.lockAspectRatio;case 10:return this.paragraph;case 9:return this.parentContentControl;
case 15:return this.parentContentControlOrNullObject;case 14:return this.parentTable;case 13:return this.parentTableCell;case 16:return this.parentTableCellOrNullObject;case 17:return this.parentTableOrNullObject;case 8:return this.width;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,
t){switch(e){case 3:this.altTextDescription=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 4:this.altTextTitle=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 5:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 6:this.hyperlink=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 7:this.lockAspectRatio=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"boolean");return;case 8:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1012:return this.yF(t);case 1015:return this.Jfa();case 1016:return this.Kfa();case 1014:return this.Vsa(t);case 1004:return this.uLa(t);case 1010:return this.uta(t);
case 1007:return this.wLa(t);case 1013:return this.oha(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1003:return this.Dim();case 1006:return this.z$a(t);case 1011:return this.sta(t);case 1008:return this.C$a(t);case 1005:return this.D$a(t);case 1009:return this.G$a(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}yF(){this.deleteInlinePicture();
return null}Dim(){return this.getBase64ImageSrc()}Jfa(){return this.getNext()}Kfa(){return this.getNextOrNullObject()}Vsa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getRange(e)}z$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertBreak(t,e)}uLa(){return this.insertContentControl()}sta(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertFileFromBase64(t,e)}C$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertHtml(t,e)}D$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertInlinePictureFromBase64(t,
e)}G$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertOoxml(t,e)}uta(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertParagraph(t,e)}wLa(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");return this.insertText(t,e)}oha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.select(e);return null}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}k7d(e){return this.eq.MKa(e)}jBm(){if(!this.fr)return null;const e=new fa.a;if(this.fr.cpEnd!==this.fr.node.characterData.length){var t=Zd.a.createTextRange(this.fr.node,this.fr.cpEnd,this.fr.node.characterData.length);this.Yx.u7d(e,t);if(e.count)return e.J(0)}for(t=this.jb.zg(this.fr.node,
!1,!0);t;){this.Yx.YKf(e,t);if(e.count)return e.J(0);t=this.jb.zg(t,!1,!0)}return null}Hla(e,t,E){const W=(new Date).getTime();if(!t||1===t){this.Ffb();const ha=new fa.a;ha.add(this.fr);return OfficeExtension.WacRuntime.Utility.createPromise((Ka,sb)=>{this.jx.insertOoxml(ha,e,t,this.fr.node,this._context,Ka,sb,W,E?0:1)})}z.ULS.sendTraceTag(18130839,369,15,"AppId:{0}, InlinePicture.InsertOoxmlOrDocx: undefined location!",this._context.appId);vc.a.qd();return null}Ffb(){const e=this.jb.Cm(this.fr.node,
this.fr.cpBegin),t=this.jb.Cm(this.fr.node,this.fr.cpEnd);this.fr.Fb=0<e?e:-1;this.fr.Tb=0<t?0:-1}}Object(y.a)(WG,"InlinePicture",si.a,[1143]);class KE{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc){this.$k=this.Co=null;this.eq=e;this.Ck=t;this.Yx=E;this.$g=W;this.Qq=ha;this.od=Ka;this.jx=sb;this.$m=dc;this.jb=xc;this.fd=Rc}zv(e,t){this.Co=e;this.$k=t}create(e,t,E=0){return new WG(e,t,E,this.Co,this.$k,this,this.eq,this.Ck,this.Yx,this.$g,this.Qq,this.od,this.jx,this.$m,this.jb,this.fd)}}Object(y.a)(KE,"InlinePictureFactory",
null,[1169]);var Pz=d(2014),XG=d(348),Sy=d(992);class YG{constructor(e,t,E,W,ha){this.chb=this.H1a=-1;this.NRe=this.$9e=null;this.KRe=!1;this.Zph=!0;this.eBh=null;this.Qd=t;this.Ei=E;this.ZQa=W;this.Qq=ha;this.jAa(e)}get FNa(){return this.eBh||(this.eBh=Hb.a.create())}get a1b(){const e=this.ZQa.Eb(this.FNa);return e?this.$9e=this.Ei.value.Eb(e.W_a):null}set a1b(e){this.$9e=e}get eKa(){const e=this.ZQa.Eb(this.FNa);return e?this.NRe=this.Ei.value.Eb(e.NAa):null}set eKa(e){this.NRe=e}get Fq(){var e=
this.z9d(!0).returnValue;const t=this.z9d(!1).returnValue;if(!e||!t)return null;const E=Zd.a.Tc(e.paragraph,e.cp),W=Zd.a.Tc(t.paragraph,t.cp);if(!e.Hb||!e.Hb.length)this.H1a=-1;else if(e.Hb&&0<e.Hb.length&&-1===this.H1a||this.H1a>e.Hb.length)this.H1a=e.Hb.length;if(!t.Hb||!t.Hb.length)this.chb=-1;else if(t.Hb&&0<t.Hb.length&&-1===this.chb||this.chb>t.Hb.length)this.chb=0;this.KRe&&this.f3k(t);E.Fb=this.H1a;W.Tb=this.chb;e=this.Qq.jzi(E,W,this.KRe);if(!e||!e.count)return null;1===e.count&&(e.J(0).contextId===
na.a.Vc||e.J(0).contextId===na.a.Xc&&(this.Zph||this.chb<this.H1a))&&(e.J(0).Fb=e.J(0).Tb=this.H1a);return e}f3k(e){if(!e.mi){const t=this.c7(e.paragraph,e.paragraph.characterData.length);for(let E=0;E<e.lj.length;E++){const W=e.lj.J(E);if(W.Po.equals(this.FNa)){t.lj||(t.lj=new XG.a(t));t.lj.add(W.Bf(t));e.lj.remove(W);e.lj.length||(e.lj=null);break}}}}jAa(e){if(v.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")&&e&&e.count){var t=e.J(0),E=e.J(e.count-1);this.ZQa.RXk(this.FNa,
t.node.id,E.node.id);if(1===e.count)this.HVm(e.J(0));else{switch(t.contextId){case na.a.paragraph:e=this.c7(t.node,0);break;case na.a.Vc:e=this.c7(t.node,t.node.characterData.length);break;case na.a.Bd:e=this.c7(t.node,t.cpBegin);break;case na.a.Xc:e=this.c7(t.node,t.cpBegin);break;default:return}var W=!1;switch(E.contextId){case na.a.paragraph:var ha=this.c7(E.node,E.node.characterData.length);W=!0;break;case na.a.Bd:ha=this.c7(E.node,E.cpEnd);break;case na.a.Vc:ha=this.c7(E.node,E.node.characterData.length);
W=!0;break;case na.a.Xc:ha=this.c7(E.node,E.cpEnd);break;default:return}this.H1a=t.Fb;this.chb=E.Tb;e.lj.add(new Sy.a(e,null,this.FNa,this.ZQa,!0));ha.lj.add(new Sy.a(ha,null,this.FNa,this.ZQa,!1,W))}}}HVm(e){let t=!1,E,W;switch(e.contextId){case na.a.Xc:E=W=this.c7(e.node,e.cpBegin);this.Zph=e.Fb===e.Tb;break;case na.a.Vc:E=W=this.c7(e.node,e.node.characterData.length);t=!0;break;case na.a.Bd:E=this.c7(e.node,e.cpBegin);W=this.c7(e.node,e.cpEnd);break;case na.a.paragraph:E=this.c7(e.node,0);W=this.c7(e.node,
e.node.characterData.length);t=!0;break;default:return}this.H1a=e.Fb;this.chb=e.Tb;E.lj.add(new Sy.a(E,null,this.FNa,this.ZQa,!0));W.lj.add(new Sy.a(W,null,this.FNa,this.ZQa,!1,t))}exb(){var e,t=({$ua:e}=this.z9d(!1)).returnValue;this.cCj(t,!1,e);t=({$ua:e}=this.z9d(!0)).returnValue;this.cCj(t,!0,e);this.ZQa.mY(this.FNa)}cCj(e,t,E){if(e&&e.lj){var W=t?this.a1b:this.eKa;for(let ha=0;ha<e.lj.length;ha++)if(e.lj.J(ha).Po.equals(this.FNa)&&e.lj.J(ha).Wc===t){e.lj.remove(e.lj.J(ha));if(!e.lj.length)if(e.lj=
null,e.isEmpty){W.qa.remove(e);break}else if(0<e.cp&&e.NYf&&e.formatting&&E&&e.formatting.equals(E)){if((t=e.paragraph.qa.sh(e.cp-1))&&t.blob)break;W.qa.remove(e);break}break}}else z.ULS.sendTraceTag(20813538,369,50,"There should be some DynamicRangeObject on this chp, but unfortunately no.")}z9d(e){let t=null;const E=e?this.a1b:this.eKa;if(!E||!E.qa||!E.qa.length)return{returnValue:null,$ua:t};for(let W=0;W<E.qa.length;W++){const ha=E.qa.J(W);if(ha.lj)for(let Ka=0;Ka<ha.lj.length;Ka++)if(ha.lj.J(Ka).Po.equals(this.FNa)&&
ha.lj.J(Ka).Wc===e)return e||(this.KRe=ha.lj.J(Ka).x$h),1<=W&&(t=E.qa.J(W-1).formatting),{returnValue:ha,$ua:t}}return{returnValue:null,$ua:t}}c7(e,t){this.Qd.Ieb(Zd.a.Tc(e,t));e=e.F_(t);e.lj||(e.lj=new XG.a(e));return e}}Object(y.a)(YG,"InternalRange",null,[]);class cw{constructor(e,t,E,W,ha,Ka,sb){this.KWb=(dc,xc)=>{this.oRe.rhf(xc)};this.Qd=e;this.Ei=E;this.ZQa=W;this.oRe=ha;this.Qq=Ka;sb.Egf(this.KWb)}create(e){return new YG(e,this.Qd,this.Ei,this.ZQa,this.Qq)}}Object(y.a)(cw,"InternalRangeFactory",
null,[]);class LE{constructor(e,t,E){this.kah="";this.nBd=0;this.GK=e;this._id=t;this.zB=E}get id(){return this._id}_RegisterStateChange(){this.nBd||(OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.zB,this._id,1),this.kah=this.GK.hva(this._id,e=>{OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(e.featureName,1,e)}));this.nBd++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.nBd--;this.nBd||this.GK.rZb(this._id,
this.kah);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(e){switch(e){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,
t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 6:return this.Llk();case 7:return this.Wlk()}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Llk(){return this._RegisterStateChange()}Wlk(){return this._UnregisterStateChange()}}Object(y.a)(LE,"LicenseFeature",null,[]);class mB{get scopes(){return null}set scopes(e){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(e){switch(e){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}Object(y.a)(mB,"MsaDeviceTicketOptions",null,[]);class Nx{constructor(e,t,E){this.GK=e;this.o1=t;this.zB=E}getFeatureTier(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{this.GK.getFeatureTier(e,1===t?1:2===t?2:0).then(W=>{E(this.aym(W))},()=>{E(t)})})}getLicenseFeature(e){e=new LE(this.GK,e,this.zB);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}getMsaDeviceTicket(){vc.a.il();
return null}isFeatureEnabled(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{this.GK.isFeatureEnabled(e,t).then(W=>{E(W)},()=>{E(t)})})}isFreemiumUpsellEnabled(){const e=this.GK.isFreemiumUpsellEnabled();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}launchUpsellExperience(e){if(this.o1.au.getOsfControl(this.zB).isFirstParty())return this.GK.launchUpsellExperience(e),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null);throw OfficeExtension.WacRuntime.Utility.createRichApiException(Lu.a.MJb,
"Access Denied");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
t){switch(e){case 7:return this.DAm(t);case 6:return this.Tlk(t)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 2:return this.Lrm(t);case 5:return this.$xm(t);case 1:return this.Hin(t);case 3:return this.Ajn();case 4:return this.Dxn(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Lrm(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");return this.getFeatureTier(t,e)}$xm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.getLicenseFeature(e)}DAm(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,mB);return this.getMsaDeviceTicket(t,E,e)}Hin(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");
e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");return this.isFeatureEnabled(t,e)}Ajn(){return this.isFreemiumUpsellEnabled()}Dxn(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");return this.launchUpsellExperience(e)}Tlk(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");this._TestFireStateChangedEvent(e);return null}aym(e){switch(e){case 1:return 1;case 2:return 2;default:return 0}}}Object(y.a)(Nx,"License",null,[]);
class bp{constructor(e,t){this.o1=e;this.Snk=t}create(e){return new Nx(this.Snk,this.o1,e)}}Object(y.a)(bp,"LicenseFactory",null,[]);class Qq extends si.a{constructor(e,t,E,W,ha,Ka,sb){super();vc.a.NPa(e,"List");this.U1a=e;this.z3a=t;this._context=E;this.Zn=W;this.Co=ha;this.od=Ka;this.jb=sb;this.Yda=this.Zn.pBa(this.z3a,this.U1a)}get id(){return this.z3a}get levelExistences(){if(!this.Yda)return null;const e=Array(vc.a.wma);for(var t=0;t<e.length;t++)e[t]=!1;for(t=0;t<this.Yda.count;t++){const E=
this.Zn.sU(this.Yda.J(t));-1!==E&&(e[E]=!0)}return e}get levelTypes(){return this.Zn.Sym(this.Yda.J(0))}get paragraphs(){const e=new fa.a;for(let t=0;t<this.Yda.count;t++)e.add(this.Co.create(this.Zn.tBa(this.Yda.J(t)),this._context));return new Hx(e)}get _ReferenceId(){return this.gr?this.Gr:null}getLevelFont(){return null}getLevelParagraphs(e){(0>e||e>=vc.a.wma)&&vc.a.qd();const t=new fa.a;for(let E=0;E<this.Yda.count;E++)e===this.Zn.sU(this.Yda.J(E))&&t.add(this.Co.create(this.Zn.tBa(this.Yda.J(E)),
this._context));return new Hx(t)}getLevelPicture(){return null}getLevelString(e){return this.Zn.getLevelString(this.z3a,this.U1a,e)}insertParagraph(e,t){var E=null;let W=t,ha=null;2!==t&&t?3===t||1===t?(W=1,E=this.Zn.tBa(this.Yda.J(this.Yda.count-1)),ha=this.od.r7a(E,!1)):vc.a.qd():(W=0,E=this.Zn.tBa(this.Yda.J(0)),ha=this.od.r7a(E,!0));var Ka=null,sb=!1;t&&1!==t||(sb=t?!1:!0,Ka=this.jb.zg(E,sb,!0));let dc;E=this.od.insertParagraph((dc=new fa.a,dc.add(ha),dc),e,W);if(!E)return null;e=this.Co.create(E,
this._context);t&&1!==t||(this.Zn.detachFromList(E),Ka&&(t=this.Co.create(Ka,this._context),e.style=t.style,Ka=Ka.qa,sb&&0<Ka.length?(sb=Ka.J(Ka.length-1).qra(null))&&!sb.formatting&&1<Ka.length&&(sb=Ka.J(Ka.length-2).qra(null)):sb=Ka.first.qra(null),E=E.qa,E.J(0).formatting=sb.formatting.Bf(E.J(0)),e.leftIndent=t.leftIndent,e.firstLineIndent=t.firstLineIndent));return e}resetLevelFont(){}setLevelAlignment(e,t){this.Zn.setLevelAlignment(this.z3a,this.U1a,e,this.wym(t))}setLevelBullet(e,t,E,W){(0>
e||e>=vc.a.wma)&&vc.a.qd();0===t&&0>=E&&vc.a.qd();this.Zn.setLevelBullet(this.U1a,this.z3a,e,t,E,W)}setLevelIndents(e,t,E){this.Zn.iVo(this.z3a,this.U1a,e,t,E)}setLevelNumbering(e,t,E){(0>e||e>=vc.a.wma)&&vc.a.qd();-1!==t||E||vc.a.qd();this.Zn.setLevelNumbering(this.U1a,this.Yda.J(0),this.z3a,e,t,E)}setLevelPicture(){}setLevelStartingNumber(e,t){this.Zn.setLevelStartingNumber(this.z3a,this.U1a,e,t)}_KeepReference(){this.Wq()}_OnAccess(){vc.a.c5(this.U1a,"List");this.Yda=this.Zn.pBa(this.z3a,this.U1a);
vc.a.yz(this.Yda,"List")}getTypeName(){return"Microsoft.WordServices.List"}invokePropertyGet(e){switch(e){case 1:return this.id;case 5:return this.levelExistences;case 4:return this.levelTypes;case 3:return this.paragraphs;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1010:return this.Uxm(t);case 1004:return this.Wxm(t);case 1009:return this.Xxm(t);case 1007:return this.Zxm(t);case 1003:return this.uta(t);case 1011:return this.BFo(t);case 1012:return this.UUo(t);case 1005:return this.VUo(t);case 1013:return this.WUo(t);case 1006:return this.XUo(t);case 1008:return this.YUo(t);case 1014:return this.ZUo(t);
case 1001:return this.ri();case 1002:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Uxm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getLevelFont(e)}Wxm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getLevelParagraphs(e)}Xxm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
0,"int");return this.getLevelPicture(e)}Zxm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getLevelString(e)}uta(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertParagraph(t,e)}BFo(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"boolean");this.resetLevelFont(t,
e);return null}UUo(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");this.setLevelAlignment(t,e);return null}VUo(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"string");
this.setLevelBullet(t,E,W,e);return null}WUo(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"number");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"number");this.setLevelIndents(t,E,e);return null}XUo(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
2,"Array<any>");this.setLevelNumbering(t,E,e);return null}YUo(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"string");this.setLevelPicture(t,e);return null}ZUo(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");this.setLevelStartingNumber(t,e);return null}ri(){this._KeepReference();return null}si(){this._OnAccess();
return null}wym(e){let t="";switch(e){case 0:t="left";break;case 2:t="right";break;case 1:t="center";break;default:z.ULS.sendTraceTag(21067539,369,10,"AppId:{0}, in function List.SetLevelAlignment, the alignment parameter should be Left/Right/Centered.",this._context.appId),vc.a.qd()}return t}}Object(y.a)(Qq,"List",si.a,[1143]);class KC{constructor(e,t){this.Co=this.Zn=null;this.od=e;this.jb=t}zv(e,t){this.Zn=e;this.Co=t}create(e,t,E){return new Qq(e,t,E,this.Zn,this.Co,this.od,this.jb)}}Object(y.a)(KC,
"ListFactory",null,[]);class Ty extends si.a{constructor(e,t,E,W,ha){super();vc.a.NPa(e,"ListItem");this.Uia=e;this._context=t;this.Zn=E;this.Co=W;this.QKc=ha}get level(){return this.Zn.sU(this.Uia)}set level(e){(e>=vc.a.wma||0>e)&&vc.a.qd();this.Zn.sU(this.Uia)!==e&&this.Zn.eAg(this.Uia,e)}get listString(){const e=this.Zn.fQb(this.Uia);return this.QKc.lMa(e).$R}get siblingIndex(){const e=this.Zn.sU(this.Uia),t=this.YIf();let E=0;for(let W=0;W<t.count;W++)if(this.Zn.sU(t.J(W))===e){if(this.Uia.id.equals(t.J(W).id))return E;
E++}return-1}get _ReferenceId(){return this.gr?this.Gr:null}getAncestor(e){(e=this.getAncestorOrNullObject(e))||vc.a.hl();return e}getAncestorOrNullObject(e){const t=this.Zn.sU(this.Uia),E=this.YIf();var W=0;for(var ha=0;ha<E.count;ha++)this.Uia.id.equals(E.J(ha).id)&&(W=ha);for(--W;0<=W;W--)if(ha=this.Zn.sU(E.J(W)),ha<t&&(e&&ha===t-1||!e))return this.Co.create(this.Zn.tBa(E.J(W)),this._context);return null}getDescendants(e){const t=this.Zn.sU(this.Uia),E=this.YIf();var W=0;for(var ha=0;ha<E.count;ha++)this.Uia.id.equals(E.J(ha).id)&&
(W=ha);ha=new fa.a;for(W+=1;W<E.count;W++){const Ka=this.Zn.sU(E.J(W));if(Ka>t)(e&&Ka===t+1||!e)&&ha.add(this.Co.create(this.Zn.tBa(E.J(W)),this._context));else break}return new Hx(ha)}_KeepReference(){this.Wq()}_OnAccess(){vc.a.c5(this.Uia,"ListItem");const e=this.Zn.fQb(this.Uia);vc.a.c5(e,"ListItem")}getTypeName(){return"Microsoft.WordServices.ListItem"}invokePropertyGet(e){switch(e){case 4:return this.level;case 3:return this.listString;case 2:return this.siblingIndex;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 4:this.level=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.Chm(t);
case 1005:return this.Dhm(t);case 1004:return this.spm(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}Chm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"boolean");return this.getAncestor(e)}Dhm(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"boolean");return this.getAncestorOrNullObject(e)}spm(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"boolean");return this.getDescendants(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}YIf(){let e;e=Xk.ListItemReader.Osa(this.Uia,{vka:-1}).listId;const t=new Ld.GraphIterator;t.set(this.Uia);t.tq();let E=t.qt(36);E||(E=t.qt(8));return this.Zn.pBa(e,E)}}Object(y.a)(Ty,"ListItem",si.a,[1143]);class xo{constructor(e,t){this.Co=null;this.Zn=e;this.QKc=t}zv(e){this.Co=e}create(e,t){return new Ty(e,t,this.Zn,this.Co,
this.QKc)}}Object(y.a)(xo,"ListItemFactory",null,[]);var tt=d(70);class Ox{constructor(e,t,E,W,ha,Ka){this.DI=Ka;this.jb=e;this.b0e=t;this.ig=E;this.MM=W;this.QKc=ha}getLevelString(e,t,E){(0>E||E>=vc.a.wma)&&vc.a.qd();(t=this.pBa(e,t))&&t.count||vc.a.ng();for(var W=0;W<t.count;W++)if(this.sU(t.J(W))===E)return e=this.fQb(t.J(W)),this.QKc.lMa(e).$R;W="";var ha=this.ig.fz(t.J(0),e,E),Ka=Fw.a.Faa(ha,null);if(1===Ka.listType)W=Ka.levelText;else if(Ka.listType)vc.a.ng();else if(W=Ka.levelText,ha=ha.ja(Tb.a.PU,
1),E+=1,W=Qd.a.replaceAll(W,"%"+E,this.r8h(Ka,ha)),0<=W.indexOf("%"))for(Ka=0;Ka<E;Ka++)0<=W.indexOf("%"+(Ka+1))&&(ha=this.BLm(t.J(0),e,Ka),W=Qd.a.replaceAll(W,"%"+(Ka+1),ha));return W}setLevelAlignment(e,t,E,W){(0>E||E>=vc.a.wma||!W||""===W)&&vc.a.qd();(t=this.pBa(e,t))||vc.a.ng();this.ig.fz(t.J(0),e,E).setValue(fd.a.wga,W);if(!Rp.a.getInstance().Fu){for(e=0;e<t.count;e++)if(this.sU(t.J(e))===E){const ha=this.fQb(t.J(e));ha&&ha.setValue(fd.a.wga,W)}this.JY(this.tBa(t.J(0)))}}setLevelStartingNumber(e,
t,E,W){(0>E||E>=vc.a.wma||0>W)&&vc.a.qd();(t=this.pBa(e,t))&&t.count||vc.a.ng();var ha=this.ig.fz(t.J(0),e,E);ha.setValue(Tb.a.PU,W);if(!Rp.a.getInstance().Wr){var Ka=-1;e=W;var sb=vc.a.wma;let xc=!1;ha=Fw.a.Faa(ha,null);for(let Rc=0;Rc<t.count;Rc++){sb<E&&(xc=!0);sb=this.sU(t.J(Rc));if(sb===E&&!ha.listType){var dc=Rc;1!==dc-Ka&&xc&&(e=W,xc=!1);Ka=this.tkc(t.J(Rc));this.DI.ZEe(Ka,e,e);Ka=Rc;e++}Rp.a.getInstance().Fu||(dc=this.tBa(t.J(Rc)),this.JY(dc))}}}iVo(e,t,E,W,ha){(0>E||E>=vc.a.wma)&&vc.a.qd();
(t=this.pBa(e,t))||vc.a.ng();e=this.ig.fz(t.J(0),e,E);e.setValue(fd.a.fe,Ve.a.RF(W));ha=Ve.a.RF(ha);0<=ha?(e.setValue(fd.a.hC,ha),e.removeProperty(fd.a.mu)):(e.setValue(fd.a.mu,0-ha),e.removeProperty(fd.a.hC));for(e=0;e<t.count;e++)if(this.sU(t.J(e))===E){var Ka=this.tBa(t.J(e));Ka.qg(fd.a.fe);Ka.qg(fd.a.hC);Ka.qg(fd.a.mu);!Rp.a.getInstance().Fu&&(Ka=this.fQb(t.J(e)))&&(Ka.setValue(fd.a.fe,Ve.a.RF(W)),0<=ha?(Ka.setValue(fd.a.hC,ha),Ka.removeProperty(fd.a.mu)):(Ka.setValue(fd.a.mu,0-ha),Ka.removeProperty(fd.a.hC)))}Rp.a.getInstance().Fu||
this.JY(this.tBa(t.J(0)))}Sym(e){const t=this.u9a(e),E=Array(vc.a.wma);for(let ha=0;ha<vc.a.wma;ha++){var W=this.ig.fz(e,t,ha);W=Fw.a.Faa(W,null);W.listType?1===W.listType&&(E[ha]=W.x$c?2:0):E[ha]=1}return E}pBa(e,t){t=this.jb.Gv(t,!0,!1);const E=new fa.a;for(const W of t)this.Xnn(W,e)&&E.add(Xf.ParagraphReader.Qkc(W));return E.count?E:null}fQb(e){return Xk.ListItemReader.y7(e)}tkc(e){const t=new Ld.GraphIterator;t.set(e);e=null;Xk.ListItemReader.Hg(t)&&(this.ig.RX(t),e=t.currentNode);return e}sU(e){let t=
-1;Xk.ListItemReader.Hg(e)&&(t=Xk.ListItemReader.Osa(e,{HJa:-1}).listLevel);return t}tBa(e){const t=new Ld.GraphIterator;t.set(e);e=null;Xk.ListItemReader.Hg(t)&&(e=t.Ub(2));return e}nti(e,t){if(!e||!e.count)return null;const E=new fa.a,W=new fa.a;var ha=null;for(let sb=0;sb<e.count;sb++){const dc=e.J(sb).node;if(!(ha&&dc&&ha.id.equals(dc.id))){ha=dc;var Ka=void 0;Xk.ListItemReader.Of?Xk.ListItemReader.isListItem(dc)&&(Ka=Xf.ParagraphReader.Qkc(dc),Ka=this.u9a(Ka),W.contains(Ka)||(W.add(Ka),E.add(this.arb(dc)))):
({sXb:Ka}=this.r$c(dc)).returnValue&&(Ka=this.u9a(Ka),W.contains(Ka)||(W.add(Ka),E.add(this.arb(dc))))}}e=new fa.a;for(ha=0;ha<W.count;ha++)e.add(this.b0e.create(E.J(ha),W.J(ha),t));return e}u9a(e){let t=-1;e=Ld.GraphIterator.eb(e);Xk.ListItemReader.Hg(e)&&(t=Xk.ListItemReader.Osa(e,{vka:-1}).listId);return t}r$c(e){if(!e)return{returnValue:!1,sXb:null};e=Ld.GraphIterator.eb(e);if(e.zb(11)){const t=e.yp(11);if((e=t)&&Xk.ListItemReader.Hg(t))return{returnValue:!0,sXb:e}}else e=null;return{returnValue:!1,
sXb:e}}attachToList(e,t,E,W){if(E>=vc.a.wma||0>E)return vc.a.qd(),null;let ha=null;if(Xk.ListItemReader.Of){if(Xk.ListItemReader.isListItem(e)||!(ha=Xf.ParagraphReader.Qkc(e)))return vc.a.ng(),null}else if(({sXb:ha}=this.r$c(e)).returnValue||!ha)return vc.a.ng(),null;var Ka=new Ld.GraphIterator;Ka.set(ha);Ka.Jd();let sb=new hc.DictionaryPropertySet;var dc=this.ig.Xln(e,t);var xc=this.arb(e);xc=this.pBa(t,xc);dc&&xc?(dc=wb.a.XN,xc=this.fQb(xc.J(xc.count-1)),xc=this.ig.i3(xc),1===xc.listType?dc=wb.a.WE:
xc.listType||(dc=wb.a.XN),sb=this.MM.J_c(dc,sb),{cCa:xc}=this.MM.Tqa(sb,Ka,xc,!1)):dc&&!xc?vc.a.ng():vc.a.qd();if(!Rp.a.getInstance().Wr)if(Ka=this.tkc(ha))this.DI.qAb(Ka,t),this.eAg(ha,E);else return z.ULS.sendTraceTag(20473551,369,10,"AppId:{0}, Something went wrong in native code and failed to create a list node.",W.appId),null;Rp.a.getInstance().Fu&&(this.DI.qAb(e,t),this.eAg(ha,E));e=this.arb(e);return this.b0e.create(e,t,W)}startNewList(e,t){if(Xk.ListItemReader.Of){if(Xk.ListItemReader.isListItem(e))return vc.a.ng(),
null;var E=Xf.ParagraphReader.Qkc(e)}else if(({sXb:E}=this.r$c(e)).returnValue)return vc.a.ng(),null;const W=new Ld.GraphIterator;W.set(E);W.Jd();let ha=Fw.a.s_(1,1),Ka=new hc.DictionaryPropertySet;Ka=this.MM.J_c(wb.a.WE,Ka);({cCa:ha}=this.MM.Tqa(Ka,W,ha,!0));e=this.arb(e);E=this.u9a(E);return this.b0e.create(e,E,t)}detachFromList(e){Xk.ListItemReader.bmn(e)||vc.a.ng();this.MM.EVc(e)}eAg(e,t){var E=this.sU(e);if(-1!==E&&t<vc.a.wma&&-1<t){var W=this.tkc(e),ha=this.fQb(e);if(W&&ha){var Ka=this.u9a(e),
sb=this.ig.fz(ha,Ka,E),dc=Fw.a.Faa(sb,null);sb=this.vDi(e);Rp.a.getInstance().Wr||W.setValue(fd.a.listLevel,t);if(Rp.a.getInstance().Fu){var xc=this.tBa(e);this.DI.L_b(xc,Ka,t)}if(!this.ig.i3(ha).listType)for({startAt:ha,EAa:Ka}=this.dwm(e),Rp.a.getInstance().Wr||this.DI.ZEe(W,ha,Ka),W=this.vDi(e),xc=0;xc<W.count;xc++)if(!Rp.a.getInstance().Wr){const Rc=this.tkc(W.J(xc));this.DI.ZEe(Rc,ha+1+xc,Ka+1+xc)}if(!dc.listType&&!this.Hsn(e)&&t!==E)for(e=0;e<sb.count;e++)Rp.a.getInstance().Wr||(t=this.tkc(sb.J(e)),
E=Xk.ListItemReader.r$d(t),dc=Xk.ListItemReader.cQf(t),this.DI.ZEe(t,E-1,dc-1))}}}setLevelNumbering(e,t,E,W,ha,Ka){let sb=0,dc="right";switch(ha){case 0:sb=1;break;case 4:sb=2;break;case 2:sb=3;dc="left";break;case 3:sb=4;break;case 1:sb=5;dc="left";break;case -1:sb=1;break;default:vc.a.qd()}let xc="";if(Ka&&Ka.length){let Rc=!1;for(let md=0;md<Ka.length;md++)if(Number===Object.getType(Ka[md])){const ud=Ka[md];Rc=ud===W||Rc;ud>W?vc.a.qd():-1===ha&&ud===W?vc.a.qd():ud<W&&this.ig.fz(t,E,ud).ja(dj.a.cC,
14)&&vc.a.qd();xc=xc+"%"+(ud+1).toString()}else xc+=Ka[md];-1===ha||Rc||vc.a.qd()}else xc=null;t="%"+(W+1).toString();xc||(xc=t);this.EOj(0,sb,e,E,W,xc,"Calibri",dc)}setLevelBullet(e,t,E,W,ha,Ka){Ka=Ka?Ka:tt.a.EYc;switch(W){case 258231:ha=61623;Ka="Symbol";break;case 131183:ha=111;Ka="Courier New";break;case 716967:ha=61607;Ka="Wingdings";break;case 716918:ha=61558;Ka="Wingdings";break;case 717016:ha=61656;Ka="Wingdings";break;case 717052:ha=61692,Ka="Wingdings"}this.EOj(1,1,e,t,E,String.fromCharCode(ha),
Ka,"left")}vDi(e){var t=this.u9a(e);const E=this.sU(e),W=new fa.a;t=this.pBa(t,this.arb(e));let ha=!1;for(let Ka=0;Ka<t.count;Ka++){const sb=this.sU(t.J(Ka));if(ha&&sb<E)break;sb===E&&(ha&&W.add(t.J(Ka)),e.id.equals(t.J(Ka).id)&&(ha=!0))}return W}Hsn(e){var t=this.u9a(e);Xk.ListItemReader.Of||this.sU(e);t=this.pBa(t,this.arb(e));return e.id.equals(t.J(0).id)?!0:!1}dwm(e){var t=this.u9a(e),E=this.sU(e);const W=this.pBa(t,this.arb(e));t=null;for(let ha=0;ha<W.count;ha++)if(this.sU(W.J(ha))===E){if(e.id.equals(W.J(ha).id))break;
t=W.J(ha)}E=e=1;t&&!Rp.a.getInstance().Wr&&(t=this.tkc(t))&&(e=Xk.ListItemReader.r$d(t)+1,E=Xk.ListItemReader.cQf(t)+1);return{startAt:e,EAa:E}}Xnn(e,t){if(Xk.ListItemReader.Of)return e?Xk.ListItemReader.av(e,{vka:-1}).listId===t:!1;let E=!1,W=null;e&&({sXb:W}=this.r$c(e)).returnValue&&this.u9a(W)===t&&(E=!0);return E}arb(e){e=Ld.GraphIterator.eb(e);return e.zb(36)?e.yp(36):e.zb(38)?e.yp(38):e.zb(8)?e.yp(8):null}EOj(e,t,E,W,ha,Ka,sb,dc){var xc=null;const Rc=this.pBa(W,E);Rc||vc.a.ng();for(var md=
0;md<Rc.count;md++)if(this.sU(Rc.J(md))===ha){xc=Rc.J(md);break}md=new hc.DictionaryPropertySet;const ud=new Ld.GraphIterator;if(xc){var Ud=e?wb.a.WE:wb.a.XN;ud.set(xc);ud.Jd();md=this.MM.J_c(Ud,md);Ud=Fw.a.s_(e,t)}else Ud=this.ig.fz(Rc.J(0),W,ha),Ud=Fw.a.Faa(Ud,new hc.DictionaryPropertySet),Ud.Kca(e,t);Ud.levelText=Ka;Ud.font=sb;Ud.E8c=!0;Ud.Fx=dc;e=this.ig.fz(Rc.J(0),W,ha).ja(Tb.a.PU,tt.a.Ik);xc&&({cCa:Ud}=this.MM.Tqa(md,ud,Ud,!1));if(!Rp.a.getInstance().Fu)for(xc=0;xc<Rc.count;xc++)t=this.tBa(Rc.J(xc)),
this.JY(t);e!==tt.a.Ik&&this.setLevelStartingNumber(W,E,ha,e)}JY(e){e&&e.setValue(Tb.a.NU,new Date)}BLm(e,t,E){t=this.ig.fz(e,t,E);e=Fw.a.Faa(t,null);if(e.listType)return"";t=t.ja(Tb.a.PU,1);return this.r8h(e,t)}r8h(e,t){switch(e.Rsa()){case 0:return t+"";case 4:return Qd.a.YXd(t-1,!0);case 2:return Qd.a.gXc(t,!0);case 3:return Qd.a.YXd(t-1,!1);case 1:return Qd.a.gXc(t,!1);default:return t+""}}}Object(y.a)(Ox,"ListOperations",null,[1200]);class ME extends si.a{constructor(e,t,E,W,ha,Ka,sb){super();
vc.a.NPa(e,"NoteItem");this.TK=e;this._context=t;this._id=E;this.od=sb;this.qQ=W;this.$k=ha;this.Rjb=Ka}get type(){return this.od.w7(this.TK)}get body(){return this.qQ.create(this.TK,this._context)}get reference(){const e=new fa.a;var t=this.TK.zsa;t&&(t=t.Jb,e.add(Zd.a.createTextRange(t.paragraph,t.cp,t.cp+1)));return this.$k.create(e,this._context)}get _Id(){return this._id}get _ReferenceId(){return this.gr?this.Gr:null}deleteObject(){this.od.vQl(this.TK)}getNext(){const e=this.getNextOrNullObject();
e||vc.a.hl();return e}getNextOrNullObject(){const e=this.od.kBm(this.TK,this.type);return e?this.Rjb.create(e,this._context):null}_KeepReference(){this.Wq()}_OnAccess(){vc.a.c5(this.TK,"NoteItem")}getTypeName(){return"Microsoft.WordServices.NoteItem"}invokePropertyGet(e){switch(e){case 4:return this.body;case 5:return this.reference;case 3:return this.type;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=
this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.yF(t);case 1004:return this.Jfa();case 1005:return this.Kfa();case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}yF(){this.deleteObject();return null}Jfa(){return this.getNext()}Kfa(){return this.getNextOrNullObject()}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(ME,"NoteItem",si.a,[1143]);class NE{constructor(){}zv(e,t,E){this.qQ=e;this.$k=t;this.od=E}create(e,t,E=0){return new ME(e,t,E,this.qQ,this.$k,this,this.od)}}Object(y.a)(NE,"NoteItemFactory",null,
[1169]);class LC{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj){this.$k=null;this.BC=e;this.rO=t;this.c0e=E;this.jb=W;this.uv=ha;this.WK=Ka;this.Qq=sb;this.bPk=dc;this.od=xc;this.Yx=Rc;this.$g=md;this.BB=ud;this.jx=Ud;this.$m=Id;this.fd=Ee;this.Zn=kf;this.Ut=Ke;this.RZ=dh;this.Wx=$h;this.Z3e=rj}zv(e){this.$k=e}create(e,t,E=0){return new GC(e,t,E,this.BC,this.rO,this,this.$k,this.c0e,this.jb,this.uv,this.WK,this.Qq,this.bPk,this.od,this.Yx,this.$g,this.BB,this.jx,this.$m,this.fd,
this.Zn,this.Ut,this.RZ,this.Wx,this.Z3e)}}Object(y.a)(LC,"ParagraphFactory",null,[1169]);class Qz{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj,zl,Wl){this.Co=e;this.rO=t;this.BC=E;this.Xzk=W;this.jb=ha;this.Qq=Ka;this.EB=sb;this.od=dc;this.Yx=xc;this.$g=Rc;this.BB=md;this.jx=ud;this.$m=Ud;this.fF=Id;this.fd=Ee;this.Zn=kf;this.zp=Ke;this.Rjb=dh;this.Ut=$h;this.RZ=rj;this.Wx=zl;this.$wd=Wl}create(e,t,E=0){return new $v(e,t,E,this.Co,this.rO,this.BC,this,this.Xzk,this.jb,this.Qq,
this.EB,this.od,this.Yx,this.$g,this.BB,this.jx,this.$m,this.fF,this.fd,this.Zn,this.zp,this.Rjb,this.Ut,this.RZ,this.Wx,this.$wd)}}Object(y.a)(Qz,"RangeFactory",null,[1169]);class OE{constructor(){this.Feh=this._value=""}get value(){return this._value}set value(e){this._value=e}get Yra(){return this.Feh}set Yra(e){this.Feh=e}}Object(y.a)(OE,"StringAndDelimiter",null,[]);class Rz{constructor(){this.gib=this.rqa=-1;this.Joh=!1}get start(){return this.rqa}set start(e){this.rqa=e}get end(){return this.gib}set end(e){this.gib=
e}get QYf(){return this.Joh}set QYf(e){this.Joh=e}}Object(y.a)(Rz,"SubRangeGncLocation",null,[]);class un{constructor(e,t,E){this.jb=e;this.ga=t;this.fF=E}Jjc(e,t){if(!e||0>=e.count)return null;var E=e.count;const W=new fa.a;if(t)if(1===t)W.add(this.EL(e.J(0),!0));else if(2===t)W.add(this.EL(e.J(E-1),!1));else if(5===t){for(t=0;t<E-1;t++)W.add(e.J(t).clone());t=e.J(E-1).clone();const ha=this.jb.textLength(t.node);switch(t.contextId){case na.a.paragraph:if(t=ha?Zd.a.createTextRange(t.node,0,ha):1===
E?Zd.a.Tc(t.node,0):null)t.Fb=this.jb.ry(t.node),t.Tb=this.jb.Bx(t.node);break;case na.a.Vc:1===E?(t=Zd.a.zx(t.node),t.Fb=e.J(E-1).Fb,t.Tb=this.jb.Bx(t.node)):t=null}t&&W.add(t)}else if(4===t){E=e.J(E-1).clone();e=null;switch(E.contextId){case na.a.paragraph:case na.a.Vc:if(E=this.WCi(E.node))e=Zd.a.Tc(E.node,0),e.Fb=e.Tb=this.jb.ry(E.node);break;case na.a.Xc:case na.a.Bd:e=this.EL(E,!1)}if(e)W.add(e);else return null}else z.ULS.sendTraceTag(18745303,369,15,"rangeLocation of GetChildRange must be Start/End/Whole/Content/After."),
vc.a.qd();else for(t=0;t<E;t++)W.add(e.J(t).clone());return W}Ayc(e,t,E,W,ha,Ka=!0,sb=!0,dc=!1){if(!e||0>=e.count)return z.ULS.sendTraceTag(18745304,369,10,"the Gnc List should contain at least one graph node context."),null;dc&&(W||E||Ka)&&vc.a.ng();var xc=new fa.a;xc.add(e.J(0).node);var Rc=[""],md=0,ud=e.J(0).node.id;for(var Ud=0;Ud<e.count;Ud++){var Id=e.J(Ud).node,Ee=Id.id;ud.equals(Ee)||(ud=Ee,md++,xc.add(Id),Rc[md]="");switch(e.J(Ud).contextId){case na.a.paragraph:Id=this.jb.text(Id);break;
case na.a.Bd:case na.a.Xc:Id=this.jb.text(Id).substring(e.J(Ud).cpBegin,e.J(Ud).cpEnd);break;default:continue}Rc[md]+=Id}Ka||(ud=e.J(0).node,Ud=e.J(e.count-1).node,Rc[0]=this.jb.text(ud),Rc[Rc.length-1]=this.jb.text(Ud));ud=Array(md+1);for(Ud=0;Ud<md+1;Ud++)ud[Ud]=[],Id=new OE,Id.value=Rc[Ud],ud[Ud][0]=Id;for(Rc=0;Rc<t.length;Rc++)for(Ud=t[Rc],Id=0;Id<md+1;Id++){Ee=ud[Id];var kf=[];for(var Ke=0;Ke<Ee.length;Ke++)kf=kf.concat.apply(kf,this.Vap(Ud,Ee[Ke]));ud[Id]=kf}t=Array(md+1);for(Rc=0;Rc<md+1;Rc++)for(t[Rc]=
[],Ud=ud[Rc],Id=0,Ka&&!Rc&&(Id=this.nOf(e.J(0),!0)),Ee=this.jb.textLength(xc.J(Rc)),Ka&&Rc===md&&(Ee=this.nOf(e.J(e.count-1),!1)),kf=0;kf<Ud.length;kf++){Ke=new Rz;var dh=Ud[kf];if(dh=dh.value.length+dh.Yra.length){var $h=Id+dh<Ee?Id+dh:Ee;Ke.start=Id;Ke.end=$h;Id+=dh}else Ke.start=Id,Ke.end=Id;if(dc&&0<=kf&&kf<Ud.length-1){dh=Ud[kf+1];$h=dh.value.trimStart();const rj=dh.value.length-$h.length;Ke.end+=rj;Id+=rj;dh.value=$h}t[Rc][kf]=Ke}if(W)for(Rc=0;Rc<md+1;Rc++)for(Ud=ud[Rc],Id=0;Id<Ud.length;Id++)t[Rc][Id].end-=
Ud[Id].Yra.length;for(ud=0;ud<md+1;ud++)if(Ud=xc.J(ud),Rc=t[ud][t[ud].length-1],this.jb.textLength(Ud),ud===md&&(!Ka||e.J(e.count-1).contextId===na.a.paragraph||e.J(e.count-1).contextId===na.a.Vc)||!ud&&(0<md||!Ka||e.J(e.count-1).contextId===na.a.paragraph||e.J(e.count-1).contextId===na.a.Vc)||0<ud&&ud<md)Ud=new Rz,Ud.start=Rc.end,Ud.end=Rc.end,Ud.QYf=!0,t[ud][t[ud].length]=Ud;ud=Array(md+1);for(Rc=0;Rc<md+1;Rc++)for(ud[Rc]=[],Ud=xc.J(Rc),Id=t[Rc],Ee=0;Ee<Id.length;Ee++)kf=new fa.a,Ke=Id[Ee],Ke=Ke.QYf?
Zd.a.Xl(Ud):Ke.start||Ke.end!==this.jb.textLength(Ud)?Ke.start===Ke.end?Zd.a.Tc(Ud,Ke.start):Zd.a.createTextRange(Ud,Ke.start,Ke.end):Zd.a.create(Ud),kf.add(Ke),ud[Rc][Ee]=kf;xc=[];md=0;for(t=0;t<ud.length;t++)for(Rc=ud[t],Ud=0;Ud<Rc.length;Ud++){if(E&&Ud+1<Rc.length&&Rc[Ud+1].J(0).contextId===na.a.Vc)if(Id=new fa.a,t<ud.length-1){Id.addRange(Rc[Ud]);this.Jjn(Rc[Ud])||Id.J(Id.count-1).contextId===na.a.paragraph||(Id.J(Id.count-1).contextId===na.a.Xc&&Id.removeAt(Id.count-1),Id.add(Rc[Ud+1].J(0)));
Id.addRange(ud[t+1][0]);ud[t+1][0]=Id;break}else Id=Rc[Ud],Id.J(Id.count-1).contextId===na.a.paragraph?Rc.pop():Id.J(Id.count-1).contextId===na.a.Xc?(Ee=Rc.pop(),Id.Z(Id.count-1,Ee.J(0))):Id.J(Id.count-1).contextId===na.a.Bd&&(Ee=Rc.pop(),Id.add(Ee.J(0)));if(!E){if(Ud+1<Rc.length&&Rc[Ud+1].J(0).contextId===na.a.Vc)if(Id=Rc[Ud],Id.J(Id.count-1).contextId===na.a.paragraph)Rc.pop();else if(Id.J(Id.count-1).contextId===na.a.Xc){if(Ee=Rc.pop(),Id.Z(Id.count-1,Ee.J(0)),dc&&0<Ud){Rc[Ud-1].add(Ee.J(0));Rc.pop();
continue}}else Id.J(Id.count-1).contextId===na.a.Bd&&(Ee=Rc.pop(),Id.add(Ee.J(0)));W&&this.WDe(ud[t][Ud])}ha&&(ud[t][Ud]=this.XDe(ud[t][Ud],E));!dc&&Ka&&(Id=ud[t][Ud],Ee=e.J(0),kf=e.J(e.count-1),this.axc(Ee,kf,Id,W));sb&&this.ZSb(ud[t][Ud])||(xc[md++]=ud[t][Ud])}return xc}aPf(e,t,E){if(!e||!e.count)return null;t=this.Ayc(e,t,!1,!1,!1,!1,!1,!0);for(var W=0;W<t.length&&!this.tZf(t[W],e.J(0),!0);)t.shift();for(W=t.length-1;0<=W&&!this.tZf(t[W],e.J(e.count-1),!1);W--)t.pop();if(E){e=[];E=0;for(W=0;W<
t.length;W++)t[W]=this.XDe(t[W]),this.ZSb(t[W])||(e[E++]=t[W]);t=e}for(e=0;e<t.length;e++)this.axc(null,null,t[e],!1);return t}getNextTextRange(e,t,E){if(!e||0>=e.count)return null;var W=new fa.a;W.add(e.J(e.count-1));var ha=this.Ayc(W,t,!1,!1,!1,!1,!1,!0);W=new fa.a;var Ka=-1;for(let sb=ha.length-1;0<=sb&&!this.tZf(ha[sb],e.J(e.count-1),!1);sb--)Ka=sb;if(-1!==Ka){for(;Ka<ha.length&&this.ZSb(W);Ka++)W=ha[Ka],E&&(W=this.XDe(W));this.axc(null,null,W,!1);if(!this.ZSb(W))return W}e=e.J(e.count-1);do{if(e=
this.WCi(e.node))for(ha=new fa.a,ha.add(e),ha=this.Ayc(ha,t,!1,!1,!1,!1,!0,!0),Ka=0;Ka<ha.length&&this.ZSb(W);Ka++)W=ha[Ka],E&&(W=this.XDe(W));else return null;this.axc(null,null,W,!1)}while(this.ZSb(W));return W}ZSb(e){for(let t=0;t<e.count;t++)switch(e.J(t).contextId){case na.a.paragraph:case na.a.Vc:return!1;case na.a.Bd:if(e.J(t).cpBegin<e.J(t).cpEnd)return!1;break;case na.a.Xc:if(e.J(t).Fb<e.J(t).Tb)return!1}return!0}EL(e,t=!0,E=!1){if(!e)return null;let W=null;switch(e.contextId){case na.a.paragraph:W=
t?Zd.a.Tc(e.node,0):E?Zd.a.Tc(e.node,this.jb.textLength(e.node)+1):Zd.a.zx(e.node);break;case na.a.Vc:W=!t&&E?Zd.a.Tc(e.node,this.jb.textLength(e.node)+1):Zd.a.zx(e.node);break;case na.a.Bd:case na.a.Xc:W=t?Zd.a.Tc(e.node,e.cpBegin):Zd.a.Tc(e.node,e.cpEnd)}W&&t&&-1!==e.Fb?W.Fb=W.Tb=e.Fb:W&&!t&&-1!==e.Tb&&(W.cpEnd===this.jb.textLength(e.node)+1?W.Fb=W.Tb=-1:W.Fb=W.Tb=e.Tb);return W}uxe(e){if(e&&e.count){var t=e.J(0);e=e.J(e.count-1);t.Fb=this.jb.ry(t.node);e.Tb=this.jb.Bx(e.node)}}axc(e,t,E,W){if(E&&
E.count){var ha=E.J(0);E=E.J(E.count-1);var Ka=this.EL(ha),sb=this.EL(E,!1),dc=null,xc=null;e&&(dc=this.EL(e));t&&(xc=this.EL(t,!1));e&&dc&&dc.cpBegin===Ka.cpBegin?-1!==e.Fb&&(ha.Fb=e.Fb):(0<this.jb.Cm(ha.node,Ka.cpBegin)?ha.Fb=0:ha.Fb=-1,Ka.cpBegin||(ha.Fb=this.jb.ry(ha.node)));t&&xc&&xc.cpEnd===sb.cpEnd?-1!==t.Tb&&(E.Tb=t.Tb):(e=this.jb.Cm(E.node,sb.cpEnd),0<e?W?(E.Tb=e,sb.cpEnd===this.jb.textLength(sb.node)&&(E.Tb=this.jb.Bx(sb.node))):E.Tb=0:E.Tb=-1)}}I_h(e){return 32!==this.ga.lg(e,wb.a.QR,1,
!1,null,null)?!1:!0}WCi(e){return(e=this.jb.zg(e,!1,!0))?Zd.a.create(e):null}WDe(e){let t=!1;if(e&&0<e.count)for(var E=0;E<e.count;){e.J(E).contextId===na.a.Vc&&(e.removeAt(E),t=!0);break}if(e&&0<e.count)for(E=e.count-1;0<=E;E--){const W=e.J(E);if(W.contextId===na.a.Vc)e.removeAt(E),t=!0;else if(W.contextId===na.a.paragraph)if(t=!0,this.jb.textLength(W.node)){e.Z(E,Zd.a.createTextRange(W.node,0,this.jb.textLength(W.node)));break}else e.removeAt(E);else break}return t}XDe(e,t=!0){const E=new fa.a;
t&&this.WDe(e);if(e&&0<e.count)for(var W=0;W<e.count;){var ha=this.f3j(e.J(W),!0);if(ha.contextId===na.a.Xc)e.removeAt(W);else if(e.Z(W,ha),!t)break;if(t&&!this.WDe(e))break}if(e&&0<e.count){do if(W=e.count-1,ha=this.f3j(e.J(W),!1),ha.contextId===na.a.Xc)e.removeAt(W);else if(e.Z(W,ha),!t)break;while((!t||t&&this.WDe(e))&&0<e.count)}E.addRange(e);return E}f3j(e,t){if(!e)return null;var E=null;switch(e.contextId){case na.a.Bd:case na.a.paragraph:E=this.EL(e,!0);var W=this.EL(e,!1);const ha=this.jb.text(E.node),
Ka=ha.substring(E.cpBegin,W.cpBegin);let sb=E.cpBegin;W=W.cpEnd;t?sb+=Ka.length-Ka.trimStart().length:W=sb+Ka.trimEnd().length;E=W-sb?sb||W!==ha.length?Zd.a.createTextRange(E.node,sb,W):e:Zd.a.Tc(E.node,sb);break;case na.a.Vc:case na.a.Xc:E=e}return E}tZf(e,t,E){if(0<e.count){const Ka=this.EL(e.J(0),!0);var W=this.EL(e.J(e.count-1),!1);if(!Ka.node.id.equals(t.node.id))return!1;var ha=this.nOf(t,E);let sb=e=-1;switch(t.contextId){case na.a.Bd:case na.a.paragraph:this.jb.text(t.node).length?(e=2*ha+
1,sb=2*ha-1):sb=e=0;break;case na.a.Vc:case na.a.Xc:e=2*ha,sb=2*ha}ha=Ka.cpBegin;t=W.cpEnd;0<t-ha?(W=2*ha,ha=2*t-1,t===this.jb.text(Ka.node).length&&(ha+=1)):(W=2*ha,ha=2*t);if(E&&e>=W&&e<=ha||!E&&sb>=W&&sb<=ha)return!0}return!1}nOf(e,t){let E=0,W=0;if(e)switch(e.contextId){case na.a.paragraph:E=0;W=this.jb.textLength(e.node);break;case na.a.Vc:E=this.jb.textLength(e.node);W=this.jb.textLength(e.node);break;case na.a.Bd:case na.a.Xc:E=e.cpBegin,W=e.cpEnd}return t?E:W}Vap(e,t){const E=t.value.split(e),
W=[];for(let ha=0;ha<E.length;ha++){const Ka=new OE;Ka.value=E[ha];Ka.Yra=ha!==E.length-1?e:t.Yra;W[ha]=Ka}return W}Jjn(e){for(let t=0;t<e.count;t++)if(e.J(t).contextId===na.a.Vc)return!0;return!1}M5h(e,t,E,W){if(this.xZi(e,E)){e=this.EL(e,!0);t=this.EL(t,!1,!0);E=this.EL(E,!0);const ha=this.EL(W,!1,!0);W=this.dka(e,E);const Ka=this.dka(t,ha);e=this.dka(e,ha);t=this.dka(t,E);e=W?2===W?2===e?13:1===e?11:Ka?1===Ka?6:12:7:Ka?1===Ka?1:2:5:t?1===t?8:Ka?1===Ka?3:4:9:10}else e=0;return e}xZi(e,t){e=this.EL(e,
!0);t=this.EL(t,!0);return 3!==this.dka(e,t)}dka(e,t){if(e.node.id.equals(t.node.id)){var E=e.cpBegin-t.cpBegin;return E?0<E?2:0:(E=e.vo()-t.vo())?0<E?2:0:1}E=this.pJi(e.node);const W=this.pJi(t.node);E.insert(0,e.node);W.insert(0,t.node);e=E.count;for(t=W.count;0<e&&0<t&&E.J(--e).id.equals(W.J(--t).id););var ha=E.J(e+1);switch(ha.type){case 7:case 35:case 39:return 3;case 8:case 10:const Ka=this.c7h(E),sb=this.c7h(W);if(Ka||sb)return 3;ha=Ld.GraphIterator.eb(ha);return 0<ha.gBa(E.J(e))-ha.gBa(W.J(t))?
2:0;default:return ha=Ld.GraphIterator.eb(ha),0<ha.gBa(E.J(e))-ha.gBa(W.J(t))?2:0}}Qqb(e){let t=[];const E=new fa.a;var W=e.J(0).node.id;let ha=e.J(0).node;var Ka=e.J(0);let sb=e.J(0);for(let dc=0;dc<e.count;dc++){const xc=e.J(dc).node,Rc=xc.id;if(!W.equals(Rc)){W=Ka.cpBegin;Ka.contextId===na.a.paragraph?W=0:Ka.contextId===na.a.Vc&&(W=Ka.node.characterData.length);Ka=sb.cpEnd;if(sb.contextId===na.a.paragraph||sb.contextId===na.a.Vc)Ka=sb.node.characterData.length;W===Ka?E.add(Zd.a.Tc(ha,W)):E.add(Zd.a.createTextRange(ha,
W,Ka));ha=xc;W=Rc;Ka=e.J(dc)}sb=e.J(dc)}W=Ka.cpBegin;Ka.contextId===na.a.paragraph?W=0:Ka.contextId===na.a.Vc&&(W=Ka.node.characterData.length);Ka=sb.cpEnd;if(sb.contextId===na.a.paragraph||sb.contextId===na.a.Vc)Ka=sb.node.characterData.length;W===Ka?E.add(Zd.a.Tc(ha,W)):E.add(Zd.a.createTextRange(ha,W,Ka));for(const dc of E)dc.contextId===na.a.Xc&&(t=t.concat.apply(t,this.LUf(dc))),t=t.concat.apply(t,Vr.a.QA(dc,!1));return{returnValue:t,$bg:E}}SEi(e,t){let E="";for(let W=0;W<e.count;W++){const ha=
e.J(W);switch(ha.contextId){case na.a.paragraph:E+=this.jb.EXb(ha.node)+vc.a.Eqc;break;case na.a.Bd:const Ka={Ad:ha.cpBegin,endCp:ha.cpEnd};E+=this.jb.EXb(ha.node,void 0,Ka).substring(Ka.Ad,Ka.endCp);break;case na.a.Vc:E+=vc.a.Eqc;break;case na.a.Xc:break;default:z.ULS.sendTraceTag(539848968,369,10,"AppId:{0}, the contextId {1} is not supported to get the text.",t.appId,ha.contextId),vc.a.ng()}}return E}jOj(e,t,E,W){this.n0f(e)||vc.a.ng();if(e.J(0).contextId===na.a.Xc||e.J(0).contextId===na.a.Vc)z.ULS.sendTraceTag(540377293,
369,15,"AppId:{0}, InsertionPoint and EndOfParagraph Can not be set hyperlink by API",W.appId),vc.a.ng();if(W=({$bg:e}=this.Qqb(e)).returnValue)for(let ha=0;ha<W.length;ha++)this.fF.hV(W[ha].paragraph,W[ha].hyperlink);t&&""!==t&&e&&0<e.count&&(this.I_h(e.J(0))?(W=!1,E&&0===t.indexOf("#")&&(t=t.substr(1),W=!0),this.fF.vF(e.J(0),t,!1,!1,!1,W)):vc.a.rC())}pJi(e){const t=new fa.a;e=Ld.GraphIterator.eb(e);for(e.zb(7);e.uc();)t.add(e.currentNode);return t}c7h(e){for(let t=0;t<e.count;t++)if(35===e.J(t).type)return!0;
return!1}LUf(e){const t=[],E=Vr.a.QA(e,!0);for(const W of E)W.cpBegin===e.cpBegin&&t.push(W);return t}n0f(e){const t=e.J(0).node.id;for(let E=0;E<e.count;E++){const W=e.J(E).node.id;if(!t.equals(W))return!1}return!0}}Object(y.a)(un,"RangeOperations",null,[1193]);class Uy{constructor(e){this.controlId=this.appId=null;this.Lad=!1;this.Sk=null;this.An=e}}Object(y.a)(Uy,"RequestContext",null,[]);var et=d(2182);class ft{constructor(){this.Boa=null;this.qbc=this.$Ib=this.f4b=0;this.wsh=this.Lvk=this.GFc=
this.qQc=null;this.gub=[]}get AG(){return this.Boa}set AG(e){this.Boa=e}get oef(){return this.f4b}Sye(e){this.f4b=e}get doa(){return this.$Ib}Axc(e){this.$Ib=e}get kfb(){return this.qbc}get Vca(){return this.qQc}set Vca(e){this.qQc=e}get W6(){return this.GFc}set W6(e){this.GFc=e}get nKa(){return this.Lvk}get gub(){return this.wsh}set gub(e){this.wsh=e}z9a(){throw Error.notImplemented();}W8d(){throw Error.notImplemented();}ckc(){throw Error.notImplemented();}nBi(){throw Error.notImplemented();}CRd(){throw Error.notImplemented();
}OMh(){throw Error.notImplemented();}Rkd(){throw Error.notImplemented();}Yue(){throw Error.notImplemented();}s3h(){throw Error.notImplemented();}xcj(){throw Error.notImplemented();}alc(){throw Error.notImplemented();}HR(){throw Error.notImplemented();}Kyi(){throw Error.notImplemented();}jAb(){throw Error.notImplemented();}tGj(){throw Error.notImplemented();}}Object(y.a)(ft,"FindResultManagerStub",null,[1760]);class PE extends ft{constructor(e){super();this.sib=e}CRd(e){this.sib&&this.sib.AVa(0,e)}}
Object(y.a)(PE,"ExtensionFindResultManager",ft,[]);class QE{constructor(e,t,E,W){this.tdh=e;this.Dvk=t;this.Jvk=E;this.mLh=W}find(e,t,E,W,ha){if(this.Ntn(E)&&this.Ptn(t,E)){var Ka=0;E&&(Ka|=E.matchCase?1:0,Ka|=E.matchPrefix?8:0,Ka|=E.matchSuffix?16:0,Ka|=E.matchWildcards?4:0,Ka|=E.matchWholeWord?2:0,Ka|=E.ignorePunct?32:0,Ka|=E.ignoreSpace?64:0);this.Jpb(e,t,Ka,W,ha)}else z.ULS.sendTraceTag(18629911,344,10,"user have input a invalid search text."),vc.a.qd()}Jpb(e,t,E,W,ha){this.Otn(E)&&this.Qtn(t,
E)?(e=this.nsm(e),0>=e.count?W(new Mu(new fa.a)):(W=this.Jvk.create(e,W,ha),ha=new PE(W),this.Dvk.create(W,ha,e).find(this.oHm(t,E)))):(z.ULS.sendTraceTag(545814685,344,10,"user have input an invalid search text."),vc.a.qd())}oHm(e,t){let E=et.a.none;if(!t)return this.tdh(e,E);t&4&&(E|=et.a.HFp);t&1&&(E|=et.a.matchCase);t&2&&(E|=et.a.ZOg);t&8&&(E|=et.a.prefix);t&16&&(E|=et.a.suffix);t&64&&(E|=et.a.ignoreSpace);t&32&&(E|=et.a.ignorePunct);return this.tdh(e,E)}nsm(e){const t=new fa.a;for(const E of e)E.contextId!==
na.a.paragraph&&E.contextId!==na.a.Bd||t.add(E);return t}Ptn(e,t){return null===e||""===e||t&&t.matchWildcards&&!this.mLh.Yge(e)?!1:!0}Ntn(e){return e&&e.matchCase&&e.matchWildcards?!1:!0}Qtn(e,t){return null===e||""===e||4===t&&!this.mLh.Yge(e)?!1:!0}Otn(e){return 5===e?!1:!0}}Object(y.a)(QE,"SearchExecutor",null,[1186]);var Sz;(function(e){e[e.primary=0]="primary";e[e.a0p=1]="firstPage";e[e.uZp=2]="evenPages"})(Sz||(Sz={}));Object(y.b)("HeaderFooterType",Sz);class RE extends si.a{constructor(e,
t,E,W,ha,Ka,sb){super();vc.a.NPa(e,"Section");this.ezd=e;this._context=t;this._id=E;this.sya=W;this.qQ=ha;this.GRa=Ka;this.Ym=sb}get body(){return this.qQ.create(this.ezd,this._context)}get _Id(){return this._id}get _ReferenceId(){return this.gr?this.Gr:null}getFooter(e){return this.qQ.create(this.l9a(!1,e),this._context)}getHeader(e){return this.qQ.create(this.l9a(!0,e),this._context)}getNext(){const e=this.getNextOrNullObject();e||vc.a.hl();return e}getNextOrNullObject(){vc.a.fj()||vc.a.il();var e=
Ld.GraphIterator.eb(this.ezd);return e.zb(8)?(e=e.Ckc(1))?this.sya.create(e,this._context):null:null}_KeepReference(){this.Wq()}_OnAccess(){vc.a.c5(this.ezd,"Section")}getTypeName(){return"Microsoft.WordServices.Section"}invokePropertyGet(e){switch(e){case 3:return this.body;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1004:return this.ltm(t);case 1003:return this.Bum(t);case 1005:return this.Jfa();case 1006:return this.Kfa();case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}ltm(e){e=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getFooter(e)}Bum(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getHeader(e)}Jfa(){return this.getNext()}Kfa(){return this.getNextOrNullObject()}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}l9a(e,t){const E=new Ld.GraphIterator;E.set(this.ezd);let W=1,ha=-1;switch(t){case 0:ha=e?0:3;break;case 1:ha=e?2:5;W=2;break;case 2:ha=e?1:4;W=3;break;default:z.ULS.sendTraceTag(16831117,
369,15,"AppId:{0}, the type of header footer is undefined: {1}.",this._context.appId,Sz[t]),vc.a.qd()}this.GRa.Yki(E,W);e=this.Ym.KVb(E);t=null;e&&(t=this.Ym.l9a(e,ha));return t}}Object(y.a)(RE,"Section",si.a,[1143]);class SE{constructor(e,t,E){this.qQ=e;this.GRa=t;this.Ym=E}create(e,t,E=0){return new RE(e,t,E,this,this.qQ,this.GRa,this.Ym)}}Object(y.a)(SE,"SectionFactory",null,[1169]);var hq=d(910);class zr{constructor(e,t,E,W,ha){this.fd=null;this.hb=e;this.Oe=t;this.tG=E;this.jb=W;this.ga=ha}zv(e){this.fd=
e}nEa(e,t){this.QKj(e,t)}fNo(e,t){this.QKj(e,t)}QKj(e,t){const E=14===e.type,W=E?"Table":"Row";e=1===t?this.jb.Zl(e):this.jb.hD(e);const ha=1===t?0:this.jb.textLength(e);e=new Nd.Selection([Zd.a.Tc(e,ha)],!0);this.hb.Ic(e);t||32===this.ga.Ob(E?wb.a.nEa:wb.a.q_b,2)||(z.ULS.sendTraceTag(20306081,369,10,"Commands.Select{0} failed",W),vc.a.ng())}select(e,t){e.count||(z.ULS.sendTraceTag(17094667,369,10,"The gncList is empty when try to select the list."),vc.a.qd());const E=e.J(0);e=e.J(e.count-1);switch(t){case 0:var W=
new Nd.Selection([E],!0);W=this.Oe.Wj(W,!0,!1);var ha=new $f.SelectionCollection([W],0),Ka=new Nd.Selection([e],!0);Ka=this.Oe.Wj(Ka,!1,!0);if(({Gm:ha}=this.tG.d2b(ha,Ka.Ra)).returnValue){if(1<ha.length&&(W=this.fd.m3(E.node))){Ka=this.jb.Zl(W);const sb=this.jb.hD(W);if(Ka===E.node&&sb===e.node){this.nEa(W,t);break}}this.hb.Y0(ha)}else W=this.tG.$y(W,Ka.Ra),this.hb.Ic(W);break;case 1:t=Zd.a.Tc(E.node,E.lk);t.Tb=t.Fb=E.vo();W=new Nd.Selection([t],!0);this.hb.Ic(W);break;case 2:t=Zd.a.Tc(e.node,e.Ep);
t.Tb=t.Fb=e.wo();W=new Nd.Selection([t],!0);this.hb.Ic(W);break;default:z.ULS.sendTraceTag(17094670,369,10,"The type of selectionMode is undefined!"),vc.a.qd()}}I3c(e){return new hq.a(this.Oe.Wj(this.tG.Fo(e),!0,!1))}Ntd(e){this.hb.Z1h()||this.hb.Ic(e.restore())}jzi(e,t,E){var W,ha=this.CLm(e,t,E);E=this.Wqm(e,t,E);if(!ha||!E)return null;ha.Fb=e.Fb;E.Tb=t.Tb;const Ka=new fa.a;if(ha.equals(E))return ha.Tb=E.Tb,Ka.add(ha),Ka;Ka.add(ha);const sb=this.jb.Bx(ha.node);if(ha.node.id.equals(E.node.id))return ha.contextId===
na.a.Bd&&ha.cpEnd===this.jb.textLength(ha.node)&&E.contextId===na.a.Vc&&(ha.Tb=Math.min(sb,E.Tb),E.Tb=E.Fb=E.Tb),Ka.add(E),Ka;ha.Tb=sb;E.Fb=this.jb.ry(E.node);ha.contextId===na.a.Bd&&(ha=Zd.a.Xl(ha.node),ha.Tb=ha.Fb=sb,Ka.add(ha));e=e.node;t=t.node;do e=null!==(W=this.jb.zg(e,!1,!0))&&void 0!==W?W:this.pBm(e),e.id.equals(t.id)||(ha=Zd.a.create(e),ha.Fb=this.jb.ry(ha.node),ha.Tb=this.jb.Bx(ha.node),Ka.add(ha));while(!e.id.equals(t.id));Ka.add(E);return Ka}CLm(e,t,E){if(!e||!t)return null;if(e.node.id.equals(t.node.id)){if(t.cpBegin===
this.jb.textLength(t.node)&&E){if(e.cpBegin===t.cpBegin)return Zd.a.Xl(e.node);if(!e.cpBegin)return Zd.a.create(e.node)}return e.cpBegin===t.cpBegin?Zd.a.Tc(e.node,e.cpBegin):Zd.a.createTextRange(e.node,e.cpBegin,t.cpBegin)}return e.cpBegin?e.cpBegin===this.jb.textLength(e.node)?Zd.a.Xl(e.node):Zd.a.createTextRange(e.node,e.cpBegin,this.jb.textLength(e.node)):Zd.a.create(e.node)}Wqm(e,t,E){return e&&t?e.node.id.equals(t.node.id)?t.cpBegin===this.jb.textLength(t.node)&&E?e.cpBegin||e.cpBegin===t.cpBegin?
Zd.a.Xl(e.node):Zd.a.create(e.node):e.cpBegin===t.cpBegin?Zd.a.Tc(e.node,e.cpBegin):Zd.a.createTextRange(e.node,e.cpBegin,t.cpBegin):E?Zd.a.create(t.node):t.cpBegin?Zd.a.createTextRange(t.node,0,t.cpBegin):Zd.a.Tc(t.node,0):null}pBm(e){if(!vc.a.Zbi())return null;e=Ld.GraphIterator.eb(e);if(!e.zb(37))return null;e.ld(38);return(e=e.Fk())?this.jb.Zl(e):null}}Object(y.a)(zr,"SelectionApiHelper",null,[1185]);class TE{constructor(){this.exd=new Jb;this.aLe=new Tc}dBa(e,t){if(!e)return null;if(e.GP)return this.dBa(e.GP,
t);if(!e.Zla)return null;const E=new Ld.GraphIterator;E.set(t);for(t=E.Ub(19);t;){const W=this.wXc(t);if(W&&W.uUh(e))return t;t=E.Lf(19)}return null}vsb(e,t){e||vc.a.ng();if(e.GP)return this.vsb(e.GP,t);if(e.Zla){const E=this.luf(e);this.Aef(E,e,t);return E}return null}Auf(e,t){const E=this.aLe.create(kk.a.mKb);E.setValue(fd.a.jTc,e);E.setValue(fd.a.kdc,t);return E}rqb(e,t){const E=new Ld.GraphIterator;E.set(e.value);return t.dS(E)&&E.Ub(18)?E:null}wXc(e){const t=e.getValue(fd.a.WTa),E=e.getValue(fd.a.kTc),
W=e.getValue(fd.a.omb),ha=e.getValue(fd.a.nKb),Ka=e.getValue(fd.a.iTc),sb=e.getValue(fd.a.pmb),dc=e.ja(ad.a.xkf,null),xc=e.ja(ad.a.ykf,0);e=e.id.toString();let Rc=null;Ka||(Rc=new Ql(e,e,t,E,W,ha,sb,!0,dc,xc));return Rc}luf(e){const t=this.exd.create(kk.a.tIa);t.setValue(fd.a.WTa,e.yo);t.setValue(fd.a.kTc,e.version);t.setValue(fd.a.omb,e.store);t.setValue(fd.a.nKb,e.storeType);t.setValue(fd.a.pmb,e.lTc);t.setValue(fd.a.iTc,!1);t.setValue(fd.a.gSh,!1);t.setValue(fd.a.nSh,"");t.setValue(fd.a.sSh,"right");
t.setValue(fd.a.vSh,350);t.setValue(fd.a.uSh,1);t.setValue(fd.a.tSh,!1);return t}Aef(e,t,E){const W=new Ld.GraphIterator;W.set(E);e.anchor?vc.a.qd():(t=Hb.a.Cf(t.lSh),Rd.a.compare(t.hu,Rd.a.nil)&&(t=new Hb.a(Rd.a.create(),1)),W.w6(e,19,t))}}Object(y.a)(TE,"SettingOperations",null,[1184]);var MC=d(957);class ku{constructor(e,t,E,W,ha,Ka){this.fd=null;this.fy=e;this.ga=t;this.jb=E;this.Eoa=W;this.Mz=ha;this.zqa=Ka;this.n5a=new Ue.a(()=>this.Mz.IIi());this.mzh=new Ue.a(()=>{const sb=new gf.a,dc=this.fy.NMf(),
xc=this.fy.B8d();for(const Rc of dc.keys)sb.add(Rc,dc.J(Rc));for(const Rc of xc.keys)sb.add(Rc,xc.J(Rc));return sb})}get ei(){return null!=this.S4g?this.S4g:this.S4g=ob.a.instance.Oa("Box4.Styles.StyleSettings")}zv(e){this.fd=e}o3c(e){let t="";for(let E=0;E<e.count;E++){if(!this.j1f(e.J(E).contextId))continue;const W=this.pzi(e.J(E));""===t&&""!==W&&(t=W);if(W!==t)return""}return t}pzi(e){if(!this.j1f(e.contextId))return"";const t=new MC.a;return 2===this.ga.lg(e,wb.a.CNa,2,!1,new Nt.a,t)?this.pzi(Zd.a.create(e.node)):
t.$_a.getValue(gb.a.la)}b7d(e){e=this.o3c(e).toLowerCase();return e in ku.BIb?ku.BIb[e]:-1}zIi(e){e=this.Mz.VG(e);return this.Mz.P9d(e)}cNm(e){e=this.zIi(e).toLowerCase();return e in ku.BIb?ku.BIb[e]:-1}eQj(e,t){vc.a.xBc(t,"Table.Style/Table.StyleBuiltIn");t=this.Suj(t);const E=this.Mz.tNm(t);E?(t=this.Mz.D9d(e,E),this.zqa.c0b(t,e)):this.fxc(this.jb.SA(e,!0,!1),t)}UYo(e,t){t=this.WBi(t);this.eQj(e,t)}fxc(e,t){if(this.Eoa.pVc(e,0)){t=this.Suj(t);var E=this.fy.ko();if(this.ei.qr){const ha=E.uy().zBa(t);
E=E.gh(Pd.a.Vb.Ae(ha))}else E=E.XKa(t);E||(z.ULS.sendTraceTag(17334858,369,15,"The {0} style is not supported on word wac.",t),vc.a.qd());if(3===this.fy.FF(E)){var W=this.fd.fwi(e.J(0).node);e=this.fd.fwi(e.J(e.count-1).node);W&&e&&W.id===e.id?this.zqa.c0b(E,W):(z.ULS.sendTraceTag(20841048,369,15,"The {0} style only can be applied to table on word wac.",t),vc.a.qd())}else for(W of e)this.Lzg(W,E)}}Mxe(e,t){t=this.WBi(t);this.fxc(e,t)}WBi(e){let t="";for(const E of Object.keys(ku.BIb))if(ku.BIb[E]===
e){t=E;break}e=t.split("-");1<e.length&&(t=e[0]+e[1].substr(1));for(const E of this.mzh.value.keys)if(E.toLowerCase()===t)return this.mzh.value.J(E);for(const E of this.n5a.value.keys)if(E.toLowerCase()===t)return this.n5a.value.J(E);return""}Lzg(e,t){if(this.j1f(e.contextId)){var E=this.fy.FF(t);if(2===E){if(e.contextId===na.a.Xc||e.contextId===na.a.Bd){this.Lzg(Zd.a.create(e.node),t);return}}else if(1===E){if(e.contextId===na.a.paragraph){this.Lzg(Zd.a.createTextRange(e.node,0,this.jb.textLength(e.node)),
t);return}}else{z.ULS.sendTraceTag(17334859,369,10,"Table or other style: {0} is not supported on word wac.",t.toString());return}t=this.fy.Ae(t);this.ga.lg(e,wb.a.HT,2,!1,new Nt.a,t)}}Suj(e){if(!(e.trim().toLowerCase()in ku.BIb))return e.trim();let t="";e=e.trim().toLowerCase().split(" ");for(const E of e){for(e=0;e<E.length;e++)t=e?t+E.charAt(e):t+E.charAt(0).toUpperCase();t+=" "}return t.trimEnd()}j1f(e){switch(e){case na.a.paragraph:case na.a.Bd:case na.a.Xc:case na.a.view:return!0;default:return!1}}}
ku.BIb=yl.a.l9("other",-1,"normal",0,"heading 1",1,"heading 2",2,"heading 3",3,"heading 4",4,"heading 5",5,"heading 6",6,"heading 7",7,"heading 8",8,"heading 9",9,"toc 1",19,"toc 2",20,"toc 3",21,"toc 4",22,"toc 5",23,"toc 6",24,"toc 7",25,"toc 8",26,"toc 9",27,"footnote text",29,"header",31,"footer",32,"caption",34,"footnote reference",38,"endnote reference",42,"endnote text",43,"title",62,"subtitle",74,"hyperlink",85,"strong",87,"emphasis",88,"no spacing",157,"list paragraph",179,"quote",180,"intense quote",
181,"subtle emphasis",260,"intense emphasis",261,"subtle reference",262,"intense reference",263,"book title",264,"bibliography",265,"toc heading",266,"table grid",154,"plain table 1",267,"plain table 2",268,"plain table 3",269,"plain table 4",270,"plain table 5",271,"table grid light",272,"grid table 1 light",111,"grid table 1 light - accent 1",280,"grid table 1 light - accent 2",287,"grid table 1 light - accent 3",294,"grid table 1 light - accent 4",301,"grid table 1 light - accent 5",308,"grid table 1 light - accent 6",
315,"grid table 2",274,"grid table 2 - accent 1",281,"grid table 2 - accent 2",288,"grid table 2 - accent 3",295,"grid table 2 - accent 4",302,"grid table 2 - accent 5",309,"grid table 2 - accent 6",316,"grid table 3",275,"grid table 3 - accent 1",282,"grid table 3 - accent 2",289,"grid table 3 - accent 3",296,"grid table 3 - accent 4",303,"grid table 3 - accent 5",310,"grid table 3 - accent 6",317,"grid table 4",276,"grid table 4 - accent 1",283,"grid table 4 - accent 2",290,"grid table 4 - accent 3",
297,"grid table 4 - accent 4",304,"grid table 4 - accent 5",311,"grid table 4 - accent 6",318,"grid table 5 dark",277,"grid table 5 dark - accent 1",284,"grid table 5 dark - accent 2",291,"grid table 5 dark - accent 3",298,"grid table 5 dark - accent 4",305,"grid table 5 dark - accent 5",312,"grid table 5 dark - accent 6",319,"grid table 6 colorful",278,"grid table 6 colorful - accent 1",285,"grid table 6 colorful - accent 2",292,"grid table 6 colorful - accent 3",299,"grid table 6 colorful - accent 4",
306,"grid table 6 colorful - accent 5",313,"grid table 6 colorful - accent 6",320,"grid table 7 colorful",279,"grid table 7 colorful - accent 1",286,"grid table 7 colorful - accent 2",293,"grid table 7 colorful - accent 3",300,"grid table 7 colorful - accent 4",307,"grid table 7 colorful - accent 5",314,"grid table 7 colorful - accent 6",321,"list table 1 Light",322,"list table 1 light - accent 1",329,"list table 1 light - accent 2",336,"list table 1 light - accent 3",343,"list table 1 light - accent 4",
350,"list table 1 light - accent 5",357,"list table 1 light - accent 6",364,"list table 2",323,"list table 2 - accent 1",330,"list table 2 - accent 2",337,"list table 2 - accent 3",344,"list table 2 - accent 4",351,"list table 2 - accent 5",358,"list table 2 - accent 6",365,"list table 3",324,"list table 3 - accent 1",331,"list table 3 - accent 2",338,"list table 3 - accent 3",345,"list table 3 - accent 4",352,"list table 3 - accent 5",359,"list table 3 - accent 6",366,"list table 4",325,"list table 4 - accent 1",
332,"list table 4 - accent 2",339,"list table 4 - accent 3",346,"list table 4 - accent 4",353,"list table 4 - accent 5",360,"list table 4 - accent 6",367,"list table 5 dark",326,"list table 5 dark - accent 1",333,"list table 5 dark - accent 2",340,"list table 5 dark - accent 3",347,"list table 5 dark - accent 4",354,"list table 5 Dark - accent 5",361,"list table 5 Dark - accent 6",368,"list table 6 colorful",327,"list table 6 colorful - accent 1",334,"list table 6 colorful - accent 2",341,"list table 6 colorful - accent 3",
348,"list table 6 colorful - accent 4",355,"list table 6 colorful - accent 5",362,"list table 6 colorful - accent 6",369,"list table 7 colorful",328,"list table 7 colorful - accent 1",335,"list table 7 colorful - accent 2",342,"list table 7 colorful - accent 3",349,"list table 7 colorful - accent 4",356,"list table 7 colorful - accent 5",363,"list table 7 colorful - accent 6",370);Object(y.a)(ku,"StyleApiHelper",null,[1182]);var os;(function(e){e[e.top=0]="top";e[e.left=1]="left";e[e.bottom=2]="bottom";
e[e.right=3]="right";e[e.GTi=4]="insideHorizontal";e[e.HTi=5]="insideVertical";e[e.u4p=6]="inside";e[e.uqj=7]="outside";e[e.all=8]="all"})(os||(os={}));Object(y.b)("BorderLocation",os);class ZG extends si.a{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md){super();this.jW=[0,2,1,3];this.Qf=e;this.Ugb=t;this._context=E;this.Zc=W;this.Ih=ha;this.bE=Ka;this.Mz=sb;this.Ml=dc;this.n6=xc;this.p5=Rc;this.zqa=md;this.YLe=new Ue.a(()=>this.tjm());this.XLe=new Ue.a(()=>this.rjm())}get color(){return this.JOf(3).toUpperCase()}set color(e){e=
vc.a.LPa(e,"TableBorder.Color",this._context);this.UAg(3,e)}get type(){let e=this.JOf(2);e||(e="mixed");return this.YLe.value.J(e)}set type(e){-1===e&&vc.a.qd();this.UAg(2,this.sjm(e))}get width(){let e=this.JOf(1);e||(e="0");return parseFloat(e)}set width(e){vc.a.W0a(e,"TableBorder.Width");12<e&&vc.a.qd();this.UAg(1,e.toString())}get _ReferenceId(){return this.gr?this.Gr:null}_KeepReference(){this.Wq()}_OnAccess(){vc.a.c5(this.Qf,"TableBorder")}getTypeName(){return"Microsoft.WordServices.TableBorder"}invokePropertyGet(e){switch(e){case 2:return this.color;
case 3:return this.type;case 4:return this.width;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 2:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 3:this.type=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return;case 4:this.width=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){switch(e){case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}ri(){this._KeepReference();
return null}si(){this._OnAccess();return null}JOf(e){switch(this.Qf.type){case 16:return this.Mfa(this.Qf,this.Ugb,e);case 15:return this.BBa(this.Qf,this.Ugb,e);case 14:return this.Qf.hasProperty(fd.a.Vna)?this.Zsa(this.Qf,this.Ugb,e):this.L9a(this.Qf,this.Ugb,e);default:return z.ULS.sendTraceTag(20828692,369,10,"AppId:{0}, The node type is invalid when get table border",this._context.appId),vc.a.ng(),null}}Mfa(e,t,E){let W=null;switch(t){case 8:case 7:W=this.sDm(e,E);break;case 1:case 3:case 0:case 2:W=
this.Mz.zqm(Oq.a.rFf(),e,this.XLe.value.J(os[t]),E);3===E&&W===dq.a.E2&&(W="#000000");break;default:z.ULS.sendTraceTag(20828693,369,15,"AppId:{0}, The border location is invalid when get table cell border",this._context.appId),vc.a.qd()}return W}BBa(e,t,E){var W=null;switch(t){case 1:case 3:W=this.Zc.jg(e);1===t?this.Ml.Qke(W):this.Ml.Y9f(W);W=this.Mfa(W.currentNode,t,E);break;case 0:case 2:var ha=this.bE.OA(e);W=this.Mfa(ha.J(0),t,E);for(e=1;e<ha.count;e++)if(W!==this.Mfa(ha.J(e),t,E))return this.Ifa(E);
break;case 6:case 5:ha=this.bE.OA(e);1===ha.count&&(z.ULS.sendTraceTag(20828694,369,15,"AppId:{0}, The border location is invalid when get table row border",this._context.appId),vc.a.qd());W=this.Mfa(ha.J(0),3,E);if(this.Qf.hasProperty(fd.a.Vna))for(t=1;t<ha.count;t++)if(W!==this.Mfa(ha.J(t),1,E))return this.Ifa(E);for(t=1;t<ha.count-1;t++)if(W!==this.Mfa(ha.J(t),3,E))return this.Ifa(E);break;case 7:W=this.BBa(e,this.jW[0],E);for(ha=1;ha<this.jW.length;ha++)if(W!==this.BBa(e,this.jW[ha],E))return this.Ifa(E);
break;case 8:W=this.BBa(e,7,E);ha=this.bE.OA(e);if(1<ha.count&&W!==this.BBa(e,6,E))return this.Ifa(E);break;default:z.ULS.sendTraceTag(20828695,369,15,"AppId:{0}, The border location is invalid when get table row border",this._context.appId),vc.a.qd()}return W}L9a(e,t,E){var W=null,ha;let Ka;switch(t){case 1:case 3:e=this.Ih.vy(e,0,this.Ih.xg(e)-1);W=this.BBa(e.J(0),t,E);if(this.hTb(W))break;for(ha=1;ha<e.count;ha++)if(W!==this.BBa(e.J(ha),t,E))return this.Ifa(E);break;case 0:case 2:W=this.Zc.jg(e);
t?this.Ml.$9f(W):this.Ml.IVb(W);W=this.BBa(W.currentNode,t,E);break;case 4:ha=this.Ih.xg(e);1>=ha&&(z.ULS.sendTraceTag(20828696,369,15,"AppId:{0}, The border location is invalid when get table border",this._context.appId),vc.a.qd());e=this.Ih.vy(e,0,ha-1);W=this.BBa(e.J(0),2,E);if(this.hTb(W))break;for(t=1;t<ha-1;t++)if(W!==this.BBa(e.J(t),2,E))return this.Ifa(E);break;case 5:Ka=this.Ih.Fh(e);1>=Ka&&(z.ULS.sendTraceTag(20828697,369,15,"AppId:{0}, The border location is invalid when get table border",
this._context.appId),vc.a.qd());ha=this.Ih.xg(e);e=this.Ih.vy(e,0,ha-1);W=this.BBa(e.J(0),t,E);if(this.hTb(W))break;for(ha=1;ha<e.count;ha++)if(W!==this.BBa(e.J(ha),t,E))return this.Ifa(E);break;case 6:ha=this.Ih.xg(e);Ka=this.Ih.Fh(e);if(1===Ka&&1===ha)z.ULS.sendTraceTag(20828698,369,15,"AppId:{0}, The border location is invalid when get table border",this._context.appId),vc.a.qd();else if(1===Ka)W=this.L9a(e,4,E);else if(1===ha)W=this.L9a(e,5,E);else if(W=this.L9a(e,4,E),!this.hTb(W)&&W!==this.L9a(e,
5,E))return this.Ifa(E);break;case 7:W=this.L9a(e,this.jW[0],E);if(this.hTb(W))break;for(t=1;t<this.jW.length;t++)if(W!==this.L9a(e,this.jW[t],E))return this.Ifa(E);break;case 8:if(W=this.L9a(e,7,E),!this.hTb(W)&&(1<this.Ih.Fh(e)||1<this.Ih.xg(e))&&W!==this.L9a(e,6,E))return this.Ifa(E)}return W}Zsa(e,t,E){let W=null;switch(t){case 1:case 3:case 0:case 2:case 4:case 5:W=this.Mz.A6d(Oq.a.rFf(),e,this.XLe.value.J(os[t]),E);3===E&&W===dq.a.E2&&(W="#000000");break;case 6:W=this.Zsa(e,4,E);if(W!==this.Zsa(e,
5,E))return this.Ifa(E);break;case 7:W=this.Zsa(e,this.jW[0],E);for(t=1;t<this.jW.length;t++)if(W!==this.Zsa(e,this.jW[t],E))return this.Ifa(E);break;case 8:if(W=this.Zsa(e,7,E),!this.hTb(W)&&W!==this.Zsa(e,6,E))return this.Ifa(E)}return W}sDm(e,t){const E=this.Mfa(e,this.jW[0],t);for(let W=1;W<this.jW.length;W++)if(E!==this.Mfa(e,this.jW[W],t))return this.Ifa(t);return E}Ifa(e){switch(e){case 2:return"mixed";case 1:return"0";case 3:return""}return null}hTb(e){return"0"===e||"mixed"===e||""===e}UAg(e,
t){switch(this.Qf.type){case 16:var E=this.Zc.jg(this.Qf);E.zb(14);E=this.Ml.getContainingTable(E);this.Cye(this.Qf,this.Ugb,e,t,!E.hasProperty(fd.a.Vna));break;case 15:this.yyb(this.Qf,this.Ugb,e,t,!this.Qf.hasProperty(fd.a.Vna));break;case 14:this.Qf.hasProperty(fd.a.Vna)?this.vxc(this.Qf,this.Ugb,e,t):this.d0b(this.Qf,this.Ugb,e,t);break;default:z.ULS.sendTraceTag(20841049,369,10,"AppId:{0}, The node type is invalid when setting table border",this._context.appId),vc.a.ng()}}Cye(e,t,E,W,ha=!0){switch(t){case 0:case 2:case 1:case 3:this.$Pj(e,
t,E,W,ha);break;case 8:case 7:this.mWo(e,E,W,ha);break;default:z.ULS.sendTraceTag(20841050,369,15,"AppId:{0}, The border location is invalid when setting table cell border",this._context.appId),vc.a.qd()}}yyb(e,t,E,W,ha=!0){switch(t){case 1:case 3:ha=this.Zc.jg(e);1===t?this.Ml.Qke(ha):this.Ml.Y9f(ha);this.n6.$s(ha.currentNode)||this.Cye(ha.currentNode,t,E,W);break;case 0:case 2:e=this.bE.OA(e);for(let Ka=0;Ka<e.count;Ka++)this.Cye(e.J(Ka),t,E,W,ha);break;case 6:case 5:e=this.bE.OA(e);1===e.count&&
(z.ULS.sendTraceTag(20841051,369,15,"AppId:{0}, The border location is invalid when setting table row border",this._context.appId),vc.a.qd());for(t=0;t<e.count-1;t++)this.Cye(e.J(t),3,E,W);break;case 7:for(t=0;t<this.jW.length;t++)this.yyb(e,this.jW[t],E,W,ha);break;case 8:this.yyb(e,7,E,W,ha);this.yyb(e,6,E,W,ha);break;default:z.ULS.sendTraceTag(20841052,369,15,"AppId:{0}, The border location is invalid when setting table row border",this._context.appId),vc.a.qd()}}d0b(e,t,E,W){var ha;switch(t){case 1:case 3:e=
this.Ih.vy(e,0,this.Ih.xg(e)-1);for(ha=0;ha<e.count;ha++)this.yyb(e.J(ha),t,E,W);break;case 0:case 2:ha=this.Zc.jg(e);t?this.Ml.$9f(ha):this.Ml.IVb(ha);this.yyb(ha.currentNode,t,E,W);break;case 4:ha=this.Ih.xg(e);1>=ha&&(z.ULS.sendTraceTag(20841053,369,15,"AppId:{0}, The border location is invalid when setting table border",this._context.appId),vc.a.qd());e=this.Ih.vy(e,0,ha-1);for(t=0;t<ha-1;t++)this.yyb(e.J(t),2,E,W);break;case 5:var Ka=this.Ih.Fh(e);1>=Ka&&(z.ULS.sendTraceTag(20841054,369,15,"AppId:{0}, The border location is invalid when setting table border",
this._context.appId),vc.a.qd());ha=this.Ih.xg(e);e=this.Ih.vy(e,0,ha-1);for(Ka=0;Ka<ha;Ka++)this.yyb(e.J(Ka),t,E,W);break;case 6:ha=this.Ih.xg(e);Ka=this.Ih.Fh(e);1===Ka&&1===ha?(z.ULS.sendTraceTag(20841055,369,15,"AppId:{0}, The border location is invalid when setting table border",this._context.appId),vc.a.qd()):1===Ka?this.d0b(e,4,E,W):(1!==ha&&this.d0b(e,4,E,W),this.d0b(e,5,E,W));break;case 7:for(t=0;t<this.jW.length;t++)this.d0b(e,this.jW[t],E,W);break;case 8:this.d0b(e,7,E,W),(1<this.Ih.Fh(e)||
1<this.Ih.xg(e))&&this.d0b(e,6,E,W)}}vxc(e,t,E,W){switch(t){case 1:case 3:case 0:case 2:case 4:case 5:this.PYo(e,t,E,W);break;case 6:this.vxc(e,4,E,W);this.vxc(e,5,E,W);break;case 7:for(t=0;t<this.jW.length;t++)this.vxc(e,this.jW[t],E,W);break;case 8:this.vxc(e,6,E,W),this.vxc(e,7,E,W)}}$Pj(e,t,E,W,ha=!0){let Ka=null,sb=null;var dc=null;switch(E){case 3:Ka=this.Mfa(e,t,2);sb=W;dc=this.Mfa(e,t,1);break;case 1:Ka=this.Mfa(e,t,2);sb=vc.a.LPa(this.Mfa(e,t,3),"TableBorder.Color",this._context);dc=W;break;
case 2:Ka=W,sb=vc.a.LPa(this.Mfa(e,t,3),"TableBorder.Color",this._context),dc=this.Mfa(e,t,1)}E=parseInt(sb,16);dc=parseFloat(dc);this.VAg(e,t,Ka,dc,E);ha&&(t=({X2k:e}=this.Dgm(e,t)).returnValue)&&this.VAg(t,e,Ka,dc,E)}VAg(e,t,E,W,ha,Ka=!0){t=this.XLe.value.J(os[t]);Ka=Ka?this.p5.zR(t):this.p5.mP(t);Ka||(z.ULS.sendTraceTag(20841056,369,10,"AppId:{0}, The border property definition is invalid when setting table border",this._context.appId),vc.a.ng());this.zqa.fRo(e,Ka,E,W,ha)}Dgm(e,t){e=this.Zc.jg(e);
e.zb(14);let E=null,W=0;switch(t){case 0:E=this.Ml.wfj(e);W=2;break;case 2:E=this.Ml.c$f(e);W=0;break;case 1:this.n6.Rla(e)||(E=this.Ml.a$f(e,!0),W=3);break;case 3:this.n6.kga(e)||(E=this.Ml.a$f(e,!1),W=1)}return{returnValue:E,X2k:W}}mWo(e,t,E,W=!0){for(let ha=0;ha<this.jW.length;ha++)this.$Pj(e,this.jW[ha],t,E,W)}sjm(e){for(const t of this.YLe.value.keys)if(this.YLe.value.J(t)===e)return t;return""}PYo(e,t,E,W){let ha=null,Ka=null,sb=null;switch(E){case 3:ha=this.Zsa(e,t,2);Ka=W;sb=this.Zsa(e,t,
1);break;case 1:ha=this.Zsa(e,t,2);Ka=vc.a.LPa(this.Zsa(e,t,3),"TableBorder.Color",this._context);sb=W;break;case 2:ha=W,Ka=vc.a.LPa(this.Zsa(e,t,3),"TableBorder.Color",this._context),sb=this.Zsa(e,t,1)}this.VAg(e,t,ha,parseFloat(sb),parseInt(Ka,16),!1)}rjm(){const e=new gf.a;e.Z("top",5);e.Z("left",3);e.Z("bottom",0);e.Z("right",4);e.Z("insideHorizontal",1);e.Z("insideVertical",2);return e}tjm(){const e=new gf.a;e.Z("mixed",-1);e.Z("none",0);e.Z("single",1);e.Z("double",3);e.Z("dotted",6);e.Z("dashed",
7);e.Z("dotDash",8);e.Z("dotDotDash",9);e.Z("triple",10);e.Z("thinThickSmallGap",11);e.Z("thickThinSmallGap",12);e.Z("thinThickThinSmallGap",13);e.Z("thinThickMediumGap",14);e.Z("thickThinMediumGap",15);e.Z("thinThickThinMediumGap",16);e.Z("thinThickLargeGap",17);e.Z("thickThinLargeGap",18);e.Z("thinThickThinLargeGap",19);e.Z("wave",20);e.Z("doubleWave",21);e.Z("dashSmallGap",22);e.Z("dashDotStroked",23);e.Z("threeDEmboss",24);e.Z("threeDEngrave",25);return e}}Object(y.a)(ZG,"TableBorder",si.a,[1143]);
class NC{constructor(e,t,E,W,ha,Ka,sb,dc){this.Zc=e;this.Ih=t;this.bE=E;this.Mz=W;this.Ml=ha;this.p5=sb;this.zqa=dc;Ka&&Ka.execute(xc=>{null==xc?z.ULS.sendTraceTag(523580866,324,10,"ITableCellReader is null after future execution"):this.n6=xc})}create(e,t,E){return new ZG(e,t,E,this.Zc,this.Ih,this.bE,this.Mz,this.Ml,this.n6,this.p5,this.zqa)}}Object(y.a)(NC,"TableBorderFactory",null,[]);class Tz extends si.a{constructor(e,t,E,W,ha,Ka){super();this.JIb=null;this.nh=e;this.m5a=t;this.Ypk=E;this._context=
W;this.fd=ha;this.Ih=Ka}length(){return this.JIb.count}get _ReferenceId(){return this.gr?this.Gr:null}getFirst(){const e=this.getFirstOrNullObject();e||vc.a.hl();return e}getFirstOrNullObject(){this.z9j();return this.JIb&&this.length()?this.JIb.J(0):null}_GetItem(e){e=vc.a.KS(e);if(e<this.length())return this.JIb.J(e);z.ULS.sendTraceTag(19969494,369,10,"The index is out of the table row range.");vc.a.qd();return null}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,t){this.z9j();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,
t,this))}getTypeName(){return"Microsoft.WordServices.TableRowCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
t){switch(e){case 1003:return this.nI();case 1004:return this.oI();case 1:return this.NY(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}NY(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}ri(){this._KeepReference();
return null}si(){this._OnAccess();return null}z9j(){switch(this.Ypk){case 1:let t=null,E=null;for(var e=0;e<this.m5a.count;e++)if(this.m5a.J(e).isConnected){t=this.m5a.J(e);break}for(e=this.m5a.count-1;0<=e;e--)if(this.m5a.J(e).isConnected){E=this.m5a.J(e);break}if(!t&&!E){this.m5a.clear();this.JIb.clear();break}this.m5a=this.Ih.NNf(this.nh,t,E);this.JIb=this.fd.EIi(this.m5a,this._context);break;case 0:this.JIb=this.fd.EIi(this.Ih.vy(this.nh,0,this.Ih.xg(this.nh)-1),this._context);break;default:z.ULS.sendTraceTag(20756162,
369,10,"AppId:{0}, something went wrong when refresh the table row collection.",this._context.appId)}}}Object(y.a)(Tz,"TableRowCollection",si.a,[1143,1215]);class UE extends si.a{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud){super();vc.a.NPa(e,"TableCell");this.vA=e;this._context=t;this._id=E;this.tea=W;this.qQ=ha;this.Zc=Ka;this.JHa=sb;this.Ml=dc;this.n6=xc;this.fd=Rc;this.Ih=md;this.xqa=ud;this.vG=Ud}get body(){return this.qQ.create(this.vA,this._context)}get cellIndex(){return this.fd.Ckm(this.vA)}get columnWidth(){var e=
this.fd.m3(this.vA);if(this.Ih.rD(e))return null;var t=this.Zc.jg(this.vA);t.zb(14);t=this.xqa.v2c(t);e=this.xqa.R5d(e);return-1===e[t]?0:Ve.a.Lbb(e[t])}set columnWidth(e){vc.a.W0a(e,"TableCell.ColumnWidth");const t=this.fd.m3(this.vA);this.Ih.rD(t)&&vc.a.ng();var E=this.Zc.jg(this.vA);E.zb(14);E=this.xqa.v2c(E);var W=this.Zc.jg(t);let ha=0;if(W.zb(14)){let Ka;const sb=({psd:Ka}=this.fd.J4c(t)).returnValue;Ka&&!this.fd.uNi(sb)||vc.a.ng();W=this.fd.tIf(W)-Ka+sb[E];0<W?ha=Math.min(Ve.a.FDa(e),W):vc.a.ng()}else ha=
Ve.a.FDa(e);this.vG.Eva(t,E,ha)}get horizontalAlignment(){return this.fd.FKf(this.vA)}set horizontalAlignment(e){this.fd.Pzg(this.vA,e)}get parentRow(){return this.fd.ZEm(this.vA,this._context)}get parentTable(){return this.fd.frb(this.vA,this._context)}get rowIndex(){return this.fd.Jt(this.vA)}get shadingColor(){let e=this.fd.eOf(this.vA);return null!=e?e:""}set shadingColor(e){e=vc.a.LPa(e,"TableCell.ShadingColor",this._context);this.fd.KAg(this.vA,e)}get value(){return this.fd.SPf(this.vA)}set value(e){this.fd.nBg(this.vA,
e)}get verticalAlignment(){return this.fd.TPf(this.vA)}set verticalAlignment(e){this.fd.pBg(this.vA,e)}get width(){return Ve.a.Lbb(this.fd.L9d(this.vA))}get _Id(){return this._id}get _ReferenceId(){return this.gr?this.Gr:null}deleteColumn(){const e=this.fd.m3(this.vA);this.Ih.rD(e)&&vc.a.ng();this.fd.Yei(this.vA)}deleteRow(){var e=this.Zc.jg(this.vA);e.zb(15);e=this.Ml.Pvg(e);this.fd.Wwf(e)}getBorder(e){return this.JHa.create(this.vA,e,this._context)}getCellPadding(e){switch(e){case 1:return this.fd.M7d(this.vA);
case 3:return this.fd.j9d(this.vA);case 0:return this.fd.sPf(this.vA);case 2:return this.fd.HHf(this.vA);default:return vc.a.qd(),null}}getNext(){const e=this.getNextOrNullObject();e||vc.a.hl();return e}getNextOrNullObject(){let e=null;const t=this.Zc.jg(this.vA);t.zb(14);this.n6.kga(t)||(e=this.Ml.a$f(t,!1));return e?this.tea.create(e,this._context):null}insertColumns(e,t,E){const W=this.Zc.jg(this.vA);W.zb(14);const ha=this.fd.m3(this.vA);this.Ih.rD(ha)&&(z.ULS.sendTraceTag(20758723,369,15,"The table is complex table when insert columns"),
vc.a.ng());this.Ml.IVb(W);this.fd.insertColumns(t,W,e,E,this._context)}insertRows(e,t,E){vc.a.W0a(t,"TableCell.InsertRows()");const W=this.Zc.jg(this.vA);W.zb(14);this.Ml.Pvg(W);e=this.fd.insertRows(t,W,e,E,this._context);this.Ml.Qvg(W);return new Tz(W.currentNode,e,1,this._context,this.fd,this.Ih)}setCellPadding(e,t){this.fd.setCellPadding(this.vA,e,t)}split(e,t){if(0>=e||32767<e||0>=t||63<t)z.ULS.sendTraceTag(521483540,369,15,"The row/column count exceeds the maxium column size"),vc.a.qd();const E=
{};E.rows=e;E.columns=t;this.fd.KOa(this.vA,E)}_KeepReference(){this.Wq()}_OnAccess(){vc.a.c5(this.vA,"TableCell")}getTypeName(){return"Microsoft.WordServices.TableCell"}invokePropertyGet(e){switch(e){case 8:return this.body;case 6:return this.cellIndex;case 15:return this.columnWidth;case 12:return this.horizontalAlignment;case 4:return this.parentRow;case 3:return this.parentTable;case 5:return this.rowIndex;case 9:return this.shadingColor;case 7:return this.value;case 14:return this.verticalAlignment;
case 16:return this.width;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 15:this.columnWidth=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number?");return;case 12:this.horizontalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"int");return;case 9:this.shadingColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 7:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 14:this.verticalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
t){switch(e){case 1007:return this.RPl();case 1006:return this.GQl();case 1008:return this.i2c(t);case 1023:return this.o2c(t);case 1011:return this.Jfa();case 1012:return this.Kfa();case 1004:return this.z9m(t);case 1003:return this.nWf(t);case 1024:return this.Lnd(t);case 1005:return this.X0b(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}RPl(){this.deleteColumn();
return null}GQl(){this.deleteRow();return null}i2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getBorder(e)}o2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getCellPadding(e)}Jfa(){return this.getNext()}Kfa(){return this.getNextOrNullObject()}z9m(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
2,"Array<Array<string>>");this.insertColumns(t,E,e);return null}nWf(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"Array<Array<string>>");return this.insertRows(t,E,e)}Lnd(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"number");this.setCellPadding(t,
e);return null}X0b(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");this.split(t,e);return null}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)(UE,"TableCell",si.a,[1143]);class xm{constructor(e,t,E,W,ha,Ka,sb){this.fd=this.qQ=null;this.Zc=e;this.JHa=t;this.Ml=E;this.Ih=ha;this.xqa=Ka;this.vG=sb;W&&W.execute(dc=>{null==dc?z.ULS.sendTraceTag(523580865,324,10,"ITableCellReader is null after future execution"):
this.n6=dc})}zv(e,t){this.fd=e;this.qQ=t}create(e,t,E=0){return new UE(e,t,E,this,this.qQ,this.Zc,this.JHa,this.Ml,this.n6,this.fd,this.Ih,this.xqa,this.vG)}}Object(y.a)(xm,"TableCellFactory",null,[1169]);var nB=d(941);class dw extends si.a{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj,zl,Wl,Rh,Mg,Xl,ql,Al,Hk){super();vc.a.NPa(e,"Table");this.nh=e;this._context=t;this._id=E;this.BC=Ka;this.$ac=W;this.tea=ha;this.Zc=sb;this.Co=dc;this.$k=xc;this.JHa=Rc;this.$m=md;this.vG=ud;this.Ih=
Ud;this.fd=Id;this.bE=Ee;this.BB=$h;this.Mz=kf;this.zqa=Ke;this.jb=dh;this.Ml=Wl;this.od=rj;this.$g=zl;this.Qq=Rh;this.LFa=Mg;this.ll=Xl;this.qHa=ql;this.EB=Al;this.Wx=Hk}xEa(e){this.zqa.xEa(e,this.nh)}get alignment(){return this.fd.Kgm(this.nh)}set alignment(e){this.fd.zQo(this.nh,e)}get endnotes(){var e=this.od.dkc(this.nh,1);e=this.od.iAa(e,this._context);return new Dt(e)}get fields(){return new ar(this.Wx.ryi(this.nh,this._context,!1))}get font(){return this.BC.create(5,this.nh,null,null,this._context)}get footnotes(){var e=
this.od.dkc(this.nh,0);e=this.od.iAa(e,this._context);return new Dt(e)}get headerRowCount(){return this.vG.m9a(this.nh)}set headerRowCount(e){var t=this.Ih.xg(this.nh);if(0>e||e>t)z.ULS.sendTraceTag(20833941,369,15,"Invalid HeaderRowCount when set Table.HeaderRowCount."),vc.a.qd();var E=e;t=this.Ih.vy(this.nh,0,t-1);for(const W of t)t=W.ja(fd.a.Ntb,!1),0<E?t||W.setValue(fd.a.Ntb,!0):t&&W.setValue(fd.a.Ntb,!1),E--;E=this.Mz.k3(this.nh);this.xEa(e?E|32:E&-33)}get horizontalAlignment(){return this.fd.KQb(this.nh,
Object(ib.a)(this.fd,this.fd.FKf,"getHorizontalAlignmentOfTableCellNode"),-2)}set horizontalAlignment(e){this.fd.Pzg(this.nh,e)}get isUniform(){return!this.Ih.rD(this.nh)}get nestingLevel(){return this.fd.xIi(this.nh)}get parentBody(){return this.fd.QMf(this.nh,this._context)}get parentContentControl(){const e=this.parentContentControlOrNullObject;e||vc.a.hl();return e}get parentContentControlOrNullObject(){const e=Zd.a.create(this.jb.Zl(this.nh)),t=Zd.a.create(this.jb.hD(this.nh));this.od.zPa(e,
t);return this.$g.olc(e,t,this._context)}get parentTable(){const e=this.parentTableOrNullObject;e||vc.a.hl();return e}get parentTableCell(){const e=this.parentTableCellOrNullObject;e||vc.a.hl();return e}get parentTableCellOrNullObject(){return this.fd.Rkc(this.nh,this._context)}get parentTableOrNullObject(){return this.fd.frb(this.nh,this._context)}get rowCount(){return this.Ih.xg(this.nh)}get rows(){return new Tz(this.nh,null,0,this._context,this.fd,this.Ih)}get shadingColor(){return this.fd.KQb(this.nh,
Object(ib.a)(this.fd,this.fd.eOf,"getShadingColorOfTableCellNode"),"")}set shadingColor(e){e=vc.a.LPa(e,"Table.ShadingColor",this._context);this.fd.KAg(this.nh,e)}get style(){return this.EB.zIi(this.nh)}set style(e){this.EB.eQj(this.nh,e)}get styleBandedColumns(){return this.Mz.k3(this.nh)&1024?!1:!0}set styleBandedColumns(e){let t=this.Mz.k3(this.nh);this.xEa(e?t&-1025:t|1024)}get styleBandedRows(){return this.Mz.k3(this.nh)&512?!1:!0}set styleBandedRows(e){let t=this.Mz.k3(this.nh);this.xEa(e?t&
-513:t|512)}get styleBuiltIn(){return this.EB.cNm(this.nh)}set styleBuiltIn(e){this.EB.UYo(this.nh,e)}get styleFirstColumn(){return this.Mz.k3(this.nh)&128?!0:!1}set styleFirstColumn(e){let t=this.Mz.k3(this.nh);this.xEa(e?t|128:t&-129)}get styleLastColumn(){return this.Mz.k3(this.nh)&256?!0:!1}set styleLastColumn(e){let t=this.Mz.k3(this.nh);this.xEa(e?t|256:t&-257)}get styleTotalRow(){return this.Mz.k3(this.nh)&64?!0:!1}set styleTotalRow(e){let t=this.Mz.k3(this.nh);this.xEa(e?t|64:t&-65)}get tables(){return new Vv(5,
this.nh,null,null,this._context,this.fd)}get values(){return this.fd.mKi(this.nh)}set values(e){this.fd.DQj(this.nh,e)}get verticalAlignment(){return this.fd.KQb(this.nh,Object(ib.a)(this.fd,this.fd.TPf,"getVerticalAlignmentOfTableCellNode"),-1)}set verticalAlignment(e){this.fd.pBg(this.nh,e)}get width(){let e=0;({psd:e}=this.fd.J4c(this.nh));return Ve.a.Lbb(e)}set width(e){vc.a.W0a(e,"Table.Width");var t;const E=({psd:t}=this.fd.J4c(this.nh)).returnValue;var W=this.Zc.jg(this.nh);e=W.zb(14)?Math.min(Ve.a.FDa(e),
this.fd.tIf(W)):Ve.a.FDa(e);if(t)for(W=0;W<E.length;W++)this.LFa.Eva(this.nh,W,E[W]/t*e);else for(t=0;t<E.length;t++)this.LFa.Eva(this.nh,t,e/E.length)}get _Id(){return this._id}get _ReferenceId(){return this.gr?this.Gr:null}addColumns(e,t,E){this.Ih.rD(this.nh)&&(z.ULS.sendTraceTag(20758721,369,15,"The table is complext table when add columns"),vc.a.ng());const W=this.Zc.jg(this.nh);this.Ml.IVb(W);switch(e){case 2:e=0;this.Ml.Qke(W);break;case 3:e=1;this.Ml.Y9f(W);break;default:z.ULS.sendTraceTag(20758722,
369,15,"AppId:{0}, Invalid insert location for Table.AddColumns method.",this._context.appId),vc.a.qd()}this.fd.insertColumns(t,W,e,E,this._context)}addRows(e,t,E){vc.a.W0a(t,"Table.AddRows()");const W=this.Zc.jg(this.nh);switch(e){case 2:e=0;this.Ml.IVb(W);break;case 3:e=1;this.Ml.$9f(W);break;default:z.ULS.sendTraceTag(20756128,369,15,"AppId:{0}, Invalid insert location for Table.Addrows method.",this._context.appId),vc.a.qd()}e=this.fd.insertRows(t,W,e,E,this._context);return new Tz(this.nh,e,
1,this._context,this.fd,this.Ih)}autoFitWindow(){var e=this.Zc.jg(this.nh),t=0;e.zb(14)?t=this.fd.tIf(e):e.zb(10)?(t=e.yp(10),t=Ve.a.ctd(this.ll.ev(t)-this.ll.$J(t)-this.ll.FL(t))):e.zb(38)&&(t=e.yp(38),t=this.qHa.hlc(t),t=Ve.a.rba(t.SWc/96));var E;e=({psd:E}=this.fd.J4c(this.nh)).returnValue;if(E)for(let W=0;W<e.length;W++)this.LFa.Eva(this.nh,W,e[W]/E*t);else for(E=0;E<e.length;E++)this.LFa.Eva(this.nh,E,t/e.length)}clear(){this.fd.y3h(this.nh)}deleteObject(){this.fd.SW(this.nh)}deleteColumns(e,
t){null===t&&(t=1);var E=this.Ih.Fh(this.nh);(0>e||0>=t||e+t>E)&&vc.a.qd();this.Ih.rD(this.nh)&&vc.a.ng();if(t===E)this.fd.SW(this.nh);else{E=this.Zc.jg(this.nh);this.Ml.IVb(E);E=this.bE.OA(E.currentNode);for(let W=e;W<e+t;W++)this.fd.Yei(E.J(W))}}deleteRows(e,t){null===t&&(t=1);const E=this.Ih.xg(this.nh);(0>e||0>=t||e+t>E)&&vc.a.qd();if(t===E)this.fd.SW(this.nh);else{e=this.Ih.vy(this.nh,e,e+t-1);for(const W of e)this.fd.Wwf(W)}}distributeColumns(){this.Ih.rD(this.nh)&&vc.a.ng();let e;const t=({psd:e}=
this.fd.J4c(this.nh)).returnValue;t.length&&e||vc.a.ng();for(let E=0;E<t.length;E++)this.LFa.Eva(this.nh,E,e/t.length)}getBorder(e){return this.JHa.create(this.nh,e,this._context)}getCell(e,t){(e=this.getCellOrNullObject(e,t))||vc.a.hl();return e}getCellOrNullObject(e,t){if(0>e||0>t||e>=this.Ih.xg(this.nh)||t>=this.Ih.Fh(this.nh))return null;const E=this.Zc.jg(this.nh);return(e=this.Ml.vfj(E,e,t))?this.tea.create(e,this._context):null}getCellPadding(e){switch(e){case 1:e=this.fd.KQb(this.nh,Object(ib.a)(this.fd,
this.fd.M7d,"getLeftMarginOfTableCellNode"),-1);break;case 3:e=this.fd.KQb(this.nh,Object(ib.a)(this.fd,this.fd.j9d,"getRighttMarginOfTableCellNode"),-1);break;case 0:e=this.fd.KQb(this.nh,Object(ib.a)(this.fd,this.fd.sPf,"getTopMarginOfTableCellNode"),-1);break;case 2:e=this.fd.KQb(this.nh,Object(ib.a)(this.fd,this.fd.HHf,"getBottomMarginOfTableCellNode"),-1);break;default:return vc.a.qd(),null}return-1===e?null:e}getNext(){const e=this.getNextOrNullObject();e||vc.a.hl();return e}getNextOrNullObject(){var e=
this.Zc.jg(this.nh);return(e=this.Ml.kOn(e))?this.$ac.create(e,this._context):null}getParagraphAfter(){const e=this.getParagraphAfterOrNullObject();e||vc.a.hl();return e}getParagraphAfterOrNullObject(){const e=this.jb.zg(this.nh,!1,!0,!1);return e?this.Co.create(e,this._context):null}getParagraphBefore(){const e=this.getParagraphBeforeOrNullObject();e||vc.a.hl();return e}getParagraphBeforeOrNullObject(){const e=this.jb.zg(this.nh,!0,!0,!0);return e?this.Co.create(e,this._context):null}getRange(e){1!==
e&&2!==e&&e&&4!==e&&(z.ULS.sendTraceTag(20506275,369,15,"AppId:{0}, rangeLocation of Table.GetRange must be Start/End/Whole/After.",this._context.appId),vc.a.qd());const t=this.jb.SA(this.nh,!0,!1);return(e=this.$m.Jjc(t,e))?this.$k.create(e,this._context):null}insertContentControl(){return this.$g.Nqa(this.od.Tfc(this.jb.Zl(this.nh),!0),this.od.Tfc(this.jb.hD(this.nh),!1),this._context)}insertParagraph(e,t){var E=!0;switch(t){case 0:t=1;break;case 1:t=0;E=!1;break;default:z.ULS.sendTraceTag(20509196,
369,15,"The type of insert location is not supported in Table.InsertParagraph: {0}.",Mt.a[t]),vc.a.qd()}var W=this.jb.zg(this.nh,E,!1,!1),ha=new fa.a;ha.add(Zd.a.create(this.nh));ha=this.fd.w7d(ha,E);E=ha.node;if(W){let Ka;E=this.od.insertParagraph((Ka=new fa.a,Ka.add(ha),Ka),e,t)}else W=new fa.a,W.add(Zd.a.Tc(E,0)),this.od.insertText(W,e,t);return this.Co.create(E,this._context)}insertTable(e,t,E,W){const ha=new fa.a;ha.add(Zd.a.create(this.nh));return this.fd.insertTable(ha,e,t,E,W,this._context)}mergeCells(e,
t,E,W){var ha=this.Zc.jg(this.nh),Ka=this.Zc.jg(this.nh);const sb=this.Ih.xg(this.nh),dc=this.Ih.Fh(this.nh);if(e>=sb||0>e||0>t||t>=dc||0>E||E>=sb||0>W||W>=dc||E<e||W<t)z.ULS.sendTraceTag(521483542,369,15,"Invalid Index for {0} {1} {2} {3}",e,t,E,W),vc.a.qd();this.Ml.U9f(ha,e,t);this.Ml.U9f(Ka,E,W);E=this.Ml.getContainingTable(ha);Ka=this.Ih.rD(E)?hi.SelectionFactory.qbi(ha,Ka):hi.SelectionFactory.pbi(ha,Ka);Ka=Wg.a.gec(Ka);Ka=nB.a.QLf(Ka);32!==Ka.response&&(z.ULS.sendTraceTag(521483541,369,15,"get mergeCell context data fail"),
vc.a.qd());this.fd.mergeCells(ha.currentNode,Ka);ha=this.Zc.jg(this.nh);this.Ml.U9f(ha,e,t);return ha.currentNode?this.tea.create(ha.currentNode,this._context):null}search(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{const W=this.jb.SA(this.nh,!0,!1);this.BB.find(W,e,t,E,this._context)})}_Search2(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{const W=this.jb.SA(this.nh,!0,!1);this.BB.Jpb(W,e,t,E,this._context)})}select(e){this.Qq.nEa(this.nh,e)}setCellPadding(e,
t){this.fd.setCellPadding(this.nh,e,t)}_KeepReference(){this.Wq()}_OnAccess(){vc.a.c5(this.nh,"Table")}getTypeName(){return"Microsoft.WordServices.Table"}invokePropertyGet(e){switch(e){case 33:return this.alignment;case 38:return this.endnotes;case 39:return this.fields;case 24:return this.font;case 37:return this.footnotes;case 12:return this.headerRowCount;case 22:return this.horizontalAlignment;case 4:return this.isUniform;case 6:return this.nestingLevel;case 32:return this.parentBody;case 25:return this.parentContentControl;
case 36:return this.parentContentControlOrNullObject;case 8:return this.parentTable;case 7:return this.parentTableCell;case 34:return this.parentTableCellOrNullObject;case 35:return this.parentTableOrNullObject;case 11:return this.rowCount;case 3:return this.rows;case 18:return this.shadingColor;case 10:return this.style;case 17:return this.styleBandedColumns;case 16:return this.styleBandedRows;case 31:return this.styleBuiltIn;case 14:return this.styleFirstColumn;case 15:return this.styleLastColumn;
case 13:return this.styleTotalRow;case 5:return this.tables;case 9:return this.values;case 23:return this.verticalAlignment;case 27:return this.width;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 33:this.alignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"int");return;case 12:this.headerRowCount=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return;case 22:this.horizontalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return;case 18:this.shadingColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 10:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 17:this.styleBandedColumns=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"boolean");return;case 16:this.styleBandedRows=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 31:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return;case 14:this.styleFirstColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 15:this.styleLastColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 13:this.styleTotalRow=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"boolean");return;case 9:this.values=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"Array<Array<string>>");return;case 23:this.verticalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return;case 27:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,
t){switch(e){case 1004:return this.CVk(t);case 1003:return this.YYk(t);case 1012:return this.Val();case 1008:return this.SIa();case 1007:return this.yF(t);case 1010:return this.UPl(t);case 1009:return this.IQl(t);case 1014:return this.XVl();case 1015:return this.i2c(t);case 1005:return this.Ekm(t);case 1028:return this.Ikm(t);case 1023:return this.o2c(t);case 1025:return this.Jfa();case 1029:return this.Kfa();case 1027:return this.dEm();case 1031:return this.eEm();case 1026:return this.gEm();case 1030:return this.hEm();
case 1019:return this.Vsa(t);case 1020:return this.uLa(t);case 1022:return this.uta(t);case 1021:return this.I$a(t);case 1006:return this.aLn(t);case 1017:return this.oha(t);case 1024:return this.Lnd(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1018:return this.yva(t);case 1032:return this.Aoa(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}CVk(e){const t=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"Array<Array<string>>");this.addColumns(t,E,e);return null}YYk(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"Array<Array<string>>");
return this.addRows(t,E,e)}Val(){this.autoFitWindow();return null}SIa(){this.clear();return null}yF(){this.deleteObject();return null}UPl(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int?");this.deleteColumns(t,e);return null}IQl(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int?");this.deleteRows(t,e);
return null}XVl(){this.distributeColumns();return null}i2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getBorder(e)}Ekm(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.getCell(t,e)}Ikm(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.getCellOrNullObject(t,
e)}o2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getCellPadding(e)}Jfa(){return this.getNext()}Kfa(){return this.getNextOrNullObject()}dEm(){return this.getParagraphAfter()}eEm(){return this.getParagraphAfterOrNullObject()}gEm(){return this.getParagraphBefore()}hEm(){return this.getParagraphBeforeOrNullObject()}Vsa(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getRange(e)}uLa(){return this.insertContentControl()}uta(e){const t=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this.insertParagraph(t,e)}I$a(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"Array<Array<string>>");return this.insertTable(t,
E,W,e)}aLn(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int"),W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,3,"int");return this.mergeCells(t,E,W,e)}yva(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,jl.a);return this.search(t,
e)}Aoa(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(t,e)}oha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.select(e);return null}Lnd(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"number");this.setCellPadding(t,e);return null}ri(){this._KeepReference();
return null}si(){this._OnAccess();return null}Lsa(){return v.AFrameworkApplication.$u?this.nh:null}}Object(y.a)(dw,"Table",si.a,[1143]);class ew{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h,rj,zl){this.fd=this.$k=this.Co=null;this.tea=t;this.BC=e;this.Zc=E;this.JHa=W;this.vG=ha;this.Ih=Ka;this.bE=sb;this.Mz=dc;this.zqa=xc;this.jb=Rc;this.BB=md;this.Ml=Ee;this.od=ud;this.$g=Ud;this.$m=Id;this.Qq=kf;this.LFa=Ke;this.ll=dh;this.qHa=$h;this.EB=rj;this.Wx=zl}zv(e,t,E){this.fd=e;this.Co=
t;this.$k=E}create(e,t,E=0){return new dw(e,t,E,this,this.tea,this.BC,this.Zc,this.Co,this.$k,this.JHa,this.$m,this.vG,this.Ih,this.fd,this.bE,this.Mz,this.zqa,this.jb,this.BB,this.od,this.$g,this.Ml,this.Qq,this.LFa,this.ll,this.qHa,this.EB,this.Wx)}}Object(y.a)(ew,"TableFactory",null,[1169]);var oB=d(201),Uz=d(953),Pw;(function(e){e[e.top=0]="top";e[e.left=1]="left";e[e.bottom=2]="bottom";e[e.right=3]="right"})(Pw||(Pw={}));Object(y.b)("CellPaddingLocation",Pw);class Ot{constructor(e,t,E,W,ha,Ka,
sb,dc,xc,Rc,md,ud,Ud,Id,Ee){this.qQ=null;this.M7l=(kf,Ke)=>{const dh=kf.parentNode;return 35===kf.currentNode.type||dh&&14===dh.type||Ke&&kf.b$a(Ke)?!1:!0};this.jb=e;this.od=t;this.Ml=E;this.ga=W;this.Zc=ha;this.Qq=Ka;this.xqa=sb;this.n6=dc;this.$ac=xc;this.jOd=Rc;this.tea=md;this.Ih=ud;this.bE=Ud;this.Oh=Id;this.$g=Ee}zv(e){this.qQ=e}insertTable(e,t,E,W,ha,Ka,sb=!1){let dc;dc=this.sak(ha,t,E,W);let xc=this.w7d(e,dc);xc||({ML:xc}=this.od.nN(e.J(0),e.J(e.count-1),W,!0));xc=this.$g.pPa(xc,e);let Rc;
this.od.GW((Rc=new fa.a,Rc.add(xc),Rc),W,1);t=this.qan(xc,t,E,dc,e,Ka,sb);sb&&this.Qq.select(e,0);ha&&this.DQj(t,ha,!0);return t?this.$ac.create(t,Ka):null}nTi(e,t){e=this.Zc.jg(e);e.zb(7);e.uc();this.Oh.$z(e,t,!0,null,!1,!1);e.Ub(2);return e.currentNode}w7d(e,t){var E=t?e.J(0):e.J(e.count-1);if(E.contextId!==na.a.paragraph&&E.contextId!==na.a.table)return null;E=E.node;const W=this.Zc.jg(E);W.zb(7);if(14!==E.type){let ha=null;if(!this.Ih.yy(W))return null;for(;this.Ih.yy(W);){this.Ml.Qvg(W);const Ka=
this.jb.Zl(W.currentNode),sb=this.jb.hD(W.currentNode);if(t?E.id.equals(Ka.id):E.id.equals(sb.id))for(const dc of e){const xc=t?sb.id:Ka.id;if(dc.contextId===na.a.paragraph&&dc.node.id.equals(xc)){ha=W.currentNode;break}}else break}ha&&(E=ha)}return 14===E.type?this.IRf(E,t,!0):null}IRf(e,t,E){let W=this.jb.zg(e,t,!1,!1);if(!W&&E||W&&14===W.type)W=this.nTi(e,t);e=null;W&&(t?(e=Zd.a.zx(W),0<this.jb.Cm(W,this.jb.textLength(W))?e.Fb=e.Tb=this.jb.Bx(W):e.Fb=e.Tb=-1):(e=Zd.a.Tc(W,0),0<this.jb.Cm(W,0)?
e.Fb=e.Tb=this.jb.ry(W):e.Fb=e.Tb=-1));return e}ANm(e,t){const E=new fa.a;e=this.Ih.rPf(e);for(let W=0;W<e.count;W++)E.add(this.$ac.create(e.J(W),t,W));return E}KIi(e,t,E){const W=new fa.a;e=this.IOm(e,t);for(t=0;t<e.count;t++)W.add(this.$ac.create(e.J(t),E,t));return W}EIi(e,t){const E=new fa.a;for(let W=0;W<e.count;W++)E.add(this.jOd.create(e.J(W),t,W));return E}TMm(e,t){const E=new fa.a;e=this.bE.OA(e);for(let W=0;W<e.count;W++)E.add(this.tea.create(e.J(W),t,W));return E}frb(e,t,E=null){if(!e)return null;
!E||e.id.equals(E.id)?E=this.lla(e,!0):(e=this.Zc.jg(e),e.zb(14),E=this.Zc.jg(E),E.zb(14),E=this.Ml.YHo(e,E));return E?this.$ac.create(E,t):null}ZEm(e,t){e=this.Zc.jg(e);e.zb(15);return(e=e.ld(15))?this.jOd.create(e,t):null}Rkc(e,t,E=null){if(!e)return null;!E||e.id.equals(E.id)?E=this.lla(e,!1):(e=this.Zc.jg(e),e.zb(14),E=this.Zc.jg(E),E.zb(14),E=this.Ml.ZHo(e,E));return E?this.tea.create(E,t):null}Jt(e){const t=this.Zc.Ql();t.set(e);t.zb(14);return this.bE.Jt(t)}Ckm(e){const t=this.Zc.Ql();t.set(e);
t.zb(14);return this.xqa.v2c(t,!0)}SPf(e){if(this.n6.$s(e))return null;const t=this.Zc.Ql();t.set(e);var E=t.Xd();for(e="";E;){E=t.XLa;var W=t.Xd();if(12===W.type)e+=this.jb.rca(W),E||(e+="\r");else if(14===W.type){E=this.mKi(W);W="";for(let ha=0;ha<E.length;ha++){const Ka=E[ha].length;for(let sb=0;sb<Ka;sb++)W+=E[ha][sb],W=sb===Ka-1?W+"\r":W+"\t"}e+=W}t.uc();E=t.Fk()}return e}nKi(e){const t=new fa.a;for(const E of this.bE.OA(e))t.add(this.SPf(E));return[t.toArray()]}mKi(e){const t=new fa.a;for(const E of this.Ih.vy(e,
0,this.Ih.xg(e)-1))t.add(this.nKi(E)[0]);return t.toArray()}nBg(e,t,E=!1){this.n6.$s(e)||(E||this.spf(e),E=this.Zc.Ql(),E.set(e),E.Ub(1),E=E.Xd(),e=new fa.a,E=Zd.a.bU(0,this.jb.textLength(E),!1,E),e.add(E),this.od.insertText(e,t,2))}oBg(e,t,E=!1){e=this.bE.OA(e);(!t||!t.length||e.count<t[0].length)&&vc.a.qd();let W=0;for(const ha of e)W<t[0].length?this.nBg(ha,t[0][W++],E):E||this.spf(ha)}DQj(e,t,E=!1){const W=this.Ih.xg(e);W<t.length&&vc.a.qd();let ha=0;for(const Ka of this.Ih.vy(e,0,W-1))ha<t.length?
this.oBg(Ka,[t[ha++]],E):E||this.upf(Ka)}spf(e){if(!this.n6.$s(e)){e=this.jb.SA(e,!0,!1);this.od.APa(e.J(0));this.od.APa(e.J(e.count-1));this.od.GW(e,4,2);var t=e.J(e.count-1);e.Z(e.count-1,Zd.a.bU(0,this.jb.textLength(t.node),!1,t.node));e.J(e.count-1).Tb=t.wo();1===e.count&&(e.J(e.count-1).Fb=t.vo());this.od.q_d(e)}}upf(e){for(const t of this.bE.OA(e))this.spf(t)}y3h(e){const t=this.Ih.xg(e);for(const E of this.Ih.vy(e,0,t-1))this.upf(E)}Wwf(e){var t=this.m3(e);if(1===this.Ih.xg(t))this.SW(t);else{var E=
oB.TableNodeContext.create(e);e=this.Qq.I3c(E);32!==this.ga.lg(E,wb.a.deleteRow,2,!0,null,null)&&(t=this.Ih.rD(t),z.ULS.sendTraceTag(20304155,369,10,"Commands.DeleteRow Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",t,!0),vc.a.ng());this.Qq.Ntd(e)}}mergeCells(e,t){const E=this.m3(e),W=oB.TableNodeContext.create(e);e=this.Qq.I3c(W);32!==this.ga.lg(W,wb.a.mergeCells,2,!0,null,t)&&(t=this.Ih.rD(E),z.ULS.sendTraceTag(523319324,369,10,"Commands.mergeCells Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",
t,!0),vc.a.ng());this.Qq.Ntd(e)}KOa(e,t){const E=this.m3(e),W=oB.TableNodeContext.create(e);e=this.Qq.I3c(W);32!==this.ga.lg(W,wb.a.KOa,2,!0,null,t)&&(t=this.Ih.rD(E),z.ULS.sendTraceTag(523319326,369,10,"Commands.splitCells Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",t,!0),vc.a.ng());this.Qq.Ntd(e)}Yei(e){var t=this.m3(e);1===this.Ih.Fh(t)?this.SW(t):(e=oB.TableNodeContext.create(e),t=this.Qq.I3c(e),32!==this.ga.lg(e,wb.a.deleteColumn,2,!0,null,null)&&(z.ULS.sendTraceTag(20304157,
369,10,"Commands.DeleteColumn Error."),vc.a.ng()),this.Qq.Ntd(t))}SW(e){e=Zd.a.create(e);const t=this.Qq.I3c(e);32!==this.ga.lg(e,wb.a.SW,2,!0,null,null)&&(z.ULS.sendTraceTag(20304159,369,10,"Commands.DeleteTable Error."),vc.a.ng());this.Qq.Ntd(t)}IOm(e,t){const E=new fa.a;var W=e.node,ha=t.node;if(W.id.equals(ha.id)){if(this.koc(e))return E;t=Ld.GraphIterator.eb(W);t.zb(14)&&(W=this.Ml.Pvg(t),ha=this.Ml.vIf(t),this.R6i(e,e,ha,W)&&(e=this.Ml.getContainingTable(t),E.add(e)));return E}let Ka,sb;const dc=
({xbd:Ka,lwg:sb}=this.h5d(W,ha)).returnValue,xc=Ka[dc];switch(xc.type){case 14:return E.add(xc),E;case 15:return E.add(Ka[dc-1]),E;case 16:if(this.R6i(e,t,xc,Ka[dc-1]))return E.add(Ka[dc-2]),E}this.dNm(W,ha,Ka,sb,dc,E);return E}fwi(e){let t=null;e=Ld.GraphIterator.eb(e);e.zb(14)&&(t=fk.getContainingTable(e));return t}h5d(e,t){e=this.mqb(e);t=this.mqb(t);for(let E=0;E<e.length&&E<t.length;++E)if(e[E]!==t[E])return{returnValue:E-1,xbd:e,lwg:t};return{returnValue:0,xbd:e,lwg:t}}R6i(e,t,E,W){const ha=
e.node,Ka=t.node,sb=this.jb.Zl(E);E=this.jb.hD(E);return 1!==this.bE.OA(W).count||this.koc(e)||this.koc(t)||sb!==ha||E!==Ka?!1:!0}dNm(e,t,E,W,ha,Ka){const sb=this.yIi(E,ha+1);W=this.yIi(W,ha+1);sb&&Ka.add(sb);e=Ld.GraphIterator.eb(e);e.zb(7);E=Hc.a.Ft(e,E[ha]);for(E.vp(this.M7l,sb);E.moveNext()&&!(14===E.currentNode.type&&Ka.add(E.currentNode),W&&E.currentNode===W||E.currentNode.id.equals(t.id)););}yIi(e,t){for(;t<e.length;++t)if(14===e[t].type)return e[t];return null}koc(e){return-1===e.cpBegin&&
-1===e.cpEnd&&e.contextId===na.a.paragraph?!1:e.contextId===na.a.Bd||e.contextId===na.a.Vc||e.contextId===na.a.Xc}mqb(e){const t=[],E=new Ld.GraphIterator;E.set(e);for(E.zb(7);E.uc();)t.push(E.currentNode);t.reverse();return t}qan(e,t,E,W,ha,Ka,sb=!0){const dc=W?ha.J(0):ha.J(ha.count-1);let xc=0,Rc=!1;if(sb){const md=dc.node;xc=this.jb.textLength(md);md.id.equals(e.node.id)&&(Rc=!0)}z.ULS.sendTraceTag(21263694,369,50,"AppId:{0}, Insert table with row number: {1}, column number : {2}",Ka.appId,t,E);
t=Object.assign(new Uz.a,{rows:t,columns:E,fpc:!0});32!==this.ga.lg(e,wb.a.insertTable,2,!1,new Nt.a,t)&&(z.ULS.sendTraceTag(19951683,369,10,"Commands.InsertTable failed"),vc.a.ng());e=t.xp;this.IRf(e,W,!1);this.IRf(e,!W,!1);t=this.jb.zg(e,!1,!1,!1);if(!sb)return e;switch(dc.contextId){case na.a.paragraph:W&&(Rc&&1<ha.count&&!xc?ha.removeAt(0):Rc&&(ha.Z(0,Zd.a.create(t)),this.od.APa(ha.J(0))));break;case na.a.Vc:W&&(1<ha.count?ha.removeAt(0):(ha.Z(0,Zd.a.Tc(t,0)),this.od.APa(ha.J(0))));break;default:W?
(ha.Z(0,dc.contextId===na.a.Xc?Zd.a.Tc(t,0):Zd.a.createTextRange(t,0,dc.cpEnd-dc.cpBegin)),1<ha.count&&ha.J(1).contextId===na.a.Vc&&(ha.Z(1,Zd.a.Xl(t)),ha.J(1).Fb=ha.J(1).Tb=dc.wo()),this.od.APa(ha.J(0),dc)):1!==ha.count||ha.J(0).contextId!==na.a.Xc||ha.J(0).cpBegin||(ha.Z(0,Zd.a.Tc(this.jb.Zl(e),0)),this.od.APa(ha.J(0)))}return e}xIi(e){let t=this.Ih.HU(e)?1:0;e=this.Zc.jg(e);for(e.zb(7);e.ld(14);)t++;return t}eOf(e){return e.hasProperty(Tb.a.MJ)?vc.a.iam()?(e=Ok.a.VC(e.getValue(Tb.a.MJ)),null!=
e?e.toUpperCase():e):Ok.a.VC(e.getValue(Tb.a.MJ)).toUpperCase():""}KAg(e,t){this.ga.lg(Zd.a.create(e),wb.a.Hca,2,!0,new Nt.a,t)}TPf(e){switch(e.ja(fd.a.TOa,"top")){case "top":return 0;case "center":return 1;case "bottom":return 2;default:return-1}}pBg(e,t){switch(t){case 0:t=wb.a.B2f;break;case 1:t=wb.a.z2f;break;case 2:t=wb.a.v2f;break;default:z.ULS.sendTraceTag(20492683,369,15,"The argument for VerticalAlignment must be Top/Center/Bottom.");vc.a.qd();return}this.ga.lg(Zd.a.create(e),t,2,!0,new Nt.a,
{})}FKf(e){e=this.jb.Gv(e,!0,!1);const t=this.jb.ez(e.J(0));for(let E=1;E<e.count;E++)if(!t||t!==this.jb.ez(e.J(E)))return-2;return this.c5i(t)}Pzg(e,t){switch(t){case 0:t=wb.a.y2f;break;case 1:t=wb.a.w2f;break;case 2:t=wb.a.A2f;break;case 3:t=wb.a.x2f;break;default:z.ULS.sendTraceTag(20492684,369,15,"The argument for HorizontalAlignment must be Left/Centered/Right/Justified.");vc.a.qd();return}this.ga.lg(Zd.a.create(e),t,2,!0,new Nt.a,{})}Kgm(e){e=this.Ih.ez(e);return this.c5i(e)}zQo(e,t){switch(t){case 0:t=
wb.a.Y7;break;case 1:t=wb.a.paa;break;case 2:t=wb.a.I8;break;default:z.ULS.sendTraceTag(20807900,369,15,"The argument for Alignment must be Left/Centered/Right.");vc.a.qd();return}this.ga.lg(Zd.a.create(e),t,2,!0,new Nt.a,{})}M7d(e){const t=this.m3(e).ja(fd.a.sV,.15);return Ve.a.Lbb(e.ja(fd.a.sV,t))}j9d(e){const t=this.m3(e).ja(fd.a.CY,.15);return Ve.a.Lbb(e.ja(fd.a.CY,t))}sPf(e){const t=this.m3(e).ja(fd.a.i0a,0);return Ve.a.Lbb(e.ja(fd.a.i0a,t))}HHf(e){const t=this.m3(e).ja(fd.a.h0a,0);return Ve.a.Lbb(e.ja(fd.a.h0a,
t))}setCellPadding(e,t,E){if(0>E||1584<E)z.ULS.sendTraceTag(20772256,369,15,"The cell padding value should be between 0 and 1584 in points."),vc.a.qd();E=Ve.a.FDa(E);switch(e.type){case 14:this.rRo(e,Ot.OMe[Pw[t]],E);break;case 15:this.UMj(e,Ot.OMe[Pw[t]],E);break;case 16:this.TMj(e,Ot.OMe[Pw[t]],E);break;default:z.ULS.sendTraceTag(20772257,369,10,"The graph node should be is table, table row or table cell."),vc.a.qd()}}rRo(e,t,E){e=this.Ih.vy(e,0,this.Ih.xg(e)-1);for(const W of e)this.UMj(W,t,E)}UMj(e,
t,E){e=this.bE.OA(e);for(const W of e)this.TMj(W,t,E)}TMj(e,t,E){const W=this.L9d(e);t===fd.a.sV?E=Math.min(W-Ve.a.FDa(this.j9d(e)),E):t===fd.a.CY&&(E=Math.min(W-Ve.a.FDa(this.M7d(e)),E));e.setValue(t,E)}LQb(e,t,E){e=this.bE.OA(e);const W=t(e.J(0));for(let ha=1;ha<e.count;ha++)if(W==E||W!=t(e.J(ha)))return E;return W}KQb(e,t,E){e=this.Ih.vy(e,0,this.Ih.xg(e)-1);let W="number"===typeof E?0:"boolean"===typeof E?!1:null;for(let ha=0;ha<e.count;ha++){const Ka=this.bE.OA(e.J(ha));for(let sb=0;sb<Ka.count;sb++){const dc=
t(Ka.J(sb));ha+sb||(W=dc);if(W==E||W!=dc)return E}}return W}m3(e){return this.lla(e,!0)}lla(e,t){if(!e)return null;e=this.Zc.jg(e);return e.zb(14)?t?this.Ml.getContainingTable(e):this.Ml.vIf(e):null}RMf(e,t,E){return(e=this.pEi(e,t))?this.qQ.create(e,E):null}QMf(e,t){return(e=this.C8d(e))?this.qQ.create(e,t):null}pEi(e,t){if(!e||!t)return null;if(e.id.equals(t.id))return this.C8d(e);t=({xbd:e}=this.h5d(e,t)).returnValue;e=e[t];switch(e.type){case 16:case 36:case 8:case 10:case 37:return e;default:return this.C8d(e)}}C8d(e){let t=
null;e=Ld.GraphIterator.eb(e);e.zb(16)?t=e.yp(16):e.zb(36)?t=e.yp(36):e.zb(10)?t=e.yp(10):e.zb(8)?(e.ld(8),1!==e.Dq()&&(t=e.currentNode)):vc.a.Zbi()&&e.zb(38)&&(t=e.yp(38));return t}tIf(e){e.zb(14);var t=this.Ml.vIf(e);this.Zc.jg(t).zb(14);const E=this.Ml.getContainingTable(e);e=this.L9d(t);const W=t.ja(fd.a.sV,E.ja(fd.a.sV,.15));t=t.ja(fd.a.CY,E.ja(fd.a.CY,.15));t=e-W-t;0>=t&&(z.ULS.sendTraceTag(20730644,369,15,"Cell content width is not valid"),vc.a.ng());return t}J4c(e){e=this.xqa.R5d(e);let t=
0;if(this.uNi(e))var E=0;else{for(E of e)t+=E;E=t}return{returnValue:e,psd:E}}L9d(e){var t=this.Zc.jg(e);t.zb(14);t=this.xqa.v2c(t);var E=this.m3(e);E=this.xqa.R5d(E);e=e.ja(fd.a.colSpan,1);let W=0;for(;e;e--,t++)if(-1===E[t]){W=0;break}else W+=E[t];return W}c5i(e){switch(e){case 1:return 0;case 2:return 1;case 3:return 2;case 6:case 9:case 11:case 10:case 7:case 13:return 3;default:return-1}}insertColumns(e,t,E,W,ha){var Ka=!1;switch(E){case 0:Ka=!0;break;case 1:Ka=!1;break;default:z.ULS.sendTraceTag(20758724,
369,15,"The type of insert location is undefined: {0}.",Mt.a[E]),vc.a.qd()}E=this.Ml.getContainingTable(t);var sb=this.Ih.xg(E);const dc=this.Ih.Fh(E);if(0>=e||e>63-dc)z.ULS.sendTraceTag(20758725,369,15,"The insert column count plus original column count exceeds the maxium column size"),vc.a.qd();if(W)for(W.length>sb&&(z.ULS.sendTraceTag(20758726,369,15,"The values size is larger than table row size"),vc.a.qd()),sb=0;sb<W.length;sb++)W[sb].length>e&&(z.ULS.sendTraceTag(20758727,369,15,"The values size is larger than table size"),
vc.a.qd());this.y9m(e,t,Ka,ha);e=this.xqa.v2c(t);if(W)for(t=0;t<W.length;t++)for(ha=e;ha<e+W[t].length;ha++)Ka=this.Zc.jg(E),Ka=this.Ml.vfj(Ka,t,ha),this.nBg(Ka,W[t][ha-e])}y9m(e,t,E,W){const ha=E?wb.a.$mc:wb.a.gSb,Ka=Zd.a.create(t.currentNode);for(let sb=0;sb<e;sb++)32!==this.ga.lg(Ka,ha,2,!1,new Nt.a,null)&&vc.a.ng(),1<e&&(W.An.BF(),W.An.yv(t.currentNode));if(E)for(E=0;E<e;E++)t.bK();else t.Fk()}uNi(e){for(const t of e)if(-1===t)return!0;return!1}insertRows(e,t,E,W){const ha=t.yp(14);E=this.sak(W,
e+this.Ih.xg(ha),this.bE.OA(t.currentNode).count,E);e=this.ean(e,t,E);if(W)for(t=0;t<W.length;t++)this.oBg(e.J(t),[W[t]]);return e}ean(e,t,E){const W=E?wb.a.ysb:wb.a.H$a,ha=new fa.a;for(let sb=0;sb<e;sb++){var Ka=Zd.a.create(t.currentNode);Ka=this.ga.lg(Ka,W,2,!1,new Nt.a,null);32!==Ka&&(Ka=this.Ih.rD(this.Ml.getContainingTable(t)),z.ULS.sendTraceTag(20756129,369,10,"Commands.InsertRow Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",Ka,!0),vc.a.ng());E?(t.bK(),ha.insert(0,
t.currentNode)):(t.Fk(),ha.add(t.currentNode))}return ha}sak(e,t,E,W){if(32767<t||0>=t||0>=E||63<E)z.ULS.sendTraceTag(20756130,369,15,"Invalid Size for {0}","inserted row"),vc.a.qd();if(e)if(e.length>t)z.ULS.sendTraceTag(20756131,369,15,"The values size is larger than {0}'s size","inserted row"),vc.a.qd();else for(t=0;t<e.length;t++)e[t].length>E&&(z.ULS.sendTraceTag(20756160,369,15,"The values size is larger than {0}'s sizeinserted row"),vc.a.qd());e=!1;switch(W){case 0:e=!0;break;case 1:e=!1;break;
default:z.ULS.sendTraceTag(20756161,369,15,"The type of insert location is undefined: {0}.",Mt.a[W]),vc.a.qd()}return e}}Ot.OMe=yl.a.l9("left",fd.a.sV,"right",fd.a.CY,"top",fd.a.i0a,"bottom",fd.a.h0a);Object(y.a)(Ot,"TableOperations",null,[1170]);class iv extends si.a{constructor(e,t,E){super();this.HQc=null;this.$v=e;this._context=t;this.fd=E}length(){return this.HQc.count}get _ReferenceId(){return this.gr?this.Gr:null}getFirst(){const e=this.getFirstOrNullObject();e||vc.a.hl();return e}getFirstOrNullObject(){this.w6j();
return this.HQc&&this.length()?this.HQc.J(0):null}_GetItem(e){e=vc.a.KS(e);if(e<this.length())return this.HQc.J(e);z.ULS.sendTraceTag(19969491,369,10,"The index is out of the table cell collection range.");vc.a.qd();return null}_KeepReference(){this.Wq()}_OnAccess(){}getAsyncEnumerator(e,t){this.w6j();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new no(e,t,this))}getTypeName(){return"Microsoft.WordServices.TableCellCollection"}invokePropertyGet(e){switch(e){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1003:return this.nI();case 1004:return this.oI();case 1:return this.NY(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);
}invokeMethodAsync(e,t){e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}nI(){return this.getFirst()}oI(){return this.getFirstOrNullObject()}NY(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"any");return this._GetItem(e)}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}w6j(){this.HQc=this.fd.TMm(this.$v,this._context)}}Object(y.a)(iv,"TableCellCollection",si.a,[1143,1215]);class $G extends si.a{constructor(e,
t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh){super();vc.a.NPa(e,"TableRow");this.$v=e;this._context=t;this._id=E;this.BC=ha;this.jOd=W;this.Zc=Ka;this.JHa=sb;this.jb=dc;this.Ml=md;this.fd=Rc;this.od=xc;this.bE=ud;this.BB=Ud;this.Qq=Id;this.LFa=Ee;this.Ih=kf;this.Wx=Ke;this.tea=dh}get cellCount(){return this.bE.OA(this.$v).count}get cells(){return new iv(this.$v,this._context,this.fd)}get endnotes(){var e=this.od.dkc(this.$v,1);e=this.od.iAa(e,this._context);return new Dt(e)}get font(){return this.BC.create(6,
this.$v,null,null,this._context)}get fields(){return new ar(this.Wx.syi(this.$v,this._context,!1))}get footnotes(){var e=this.od.dkc(this.$v,0);e=this.od.iAa(e,this._context);return new Dt(e)}get horizontalAlignment(){return this.fd.LQb(this.$v,Object(ib.a)(this.fd,this.fd.FKf,"getHorizontalAlignmentOfTableCellNode"),-2)}set horizontalAlignment(e){this.fd.Pzg(this.$v,e)}get isHeader(){return this.bE.D9c(this.$v)}get parentTable(){return this.fd.frb(this.$v,this._context)}get preferredHeight(){return this.bE.blc(this.$v)}set preferredHeight(e){vc.a.V0a(e,
"TableRow.PreferredHeight");this.LFa.W_b(this.$v,Ve.a.FDa(e))}get rowIndex(){return this.fd.Jt(this.$v)}get shadingColor(){return this.fd.LQb(this.$v,Object(ib.a)(this.fd,this.fd.eOf,"getShadingColorOfTableCellNode"),"")}set shadingColor(e){e=vc.a.LPa(e,"TableRow.ShadingColor",this._context);this.fd.KAg(this.$v,e)}get values(){return this.fd.nKi(this.$v)}set values(e){this.fd.oBg(this.$v,e)}get verticalAlignment(){return this.fd.LQb(this.$v,Object(ib.a)(this.fd,this.fd.TPf,"getVerticalAlignmentOfTableCellNode"),
-1)}set verticalAlignment(e){this.fd.pBg(this.$v,e)}get _Id(){return this._id}get _ReferenceId(){return this.gr?this.Gr:null}clear(){this.fd.upf(this.$v)}deleteObject(){this.fd.Wwf(this.$v)}getBorder(e){return this.JHa.create(this.$v,e,this._context)}getCellPadding(e){switch(e){case 1:e=this.fd.LQb(this.$v,Object(ib.a)(this.fd,this.fd.M7d,"getLeftMarginOfTableCellNode"),-1);break;case 3:e=this.fd.LQb(this.$v,Object(ib.a)(this.fd,this.fd.j9d,"getRighttMarginOfTableCellNode"),-1);break;case 0:e=this.fd.LQb(this.$v,
Object(ib.a)(this.fd,this.fd.sPf,"getTopMarginOfTableCellNode"),-1);break;case 2:e=this.fd.LQb(this.$v,Object(ib.a)(this.fd,this.fd.HHf,"getBottomMarginOfTableCellNode"),-1);break;default:return vc.a.qd(),null}return-1===e?null:e}getNext(){const e=this.getNextOrNullObject();e||vc.a.hl();return e}getNextOrNullObject(){var e=this.Zc.jg(this.$v);e.zb(14);return(e=this.Ml.c$f(e))?this.jOd.create(e,this._context):null}insertContentControl(){return null}insertRows(e,t,E){vc.a.W0a(t,"TableRow.InsertRows()");
const W=this.Zc.jg(this.$v);W.zb(14);e=this.fd.insertRows(t,W,e,E,this._context);this.Ml.Qvg(W);return new Tz(W.currentNode,e,1,this._context,this.fd,this.Ih)}merge(){const e=this.Zc.jg(this.$v);this.Ml.Qke(e);var t=hi.SelectionFactory.vbi(this.$v);t=Wg.a.gec(t);t=nB.a.QLf(t);32!==t.response&&(z.ULS.sendTraceTag(521483539,369,15,"get mergeCell context data fail"),vc.a.qd());this.fd.mergeCells(e.currentNode,t);return this.$v?this.tea.create(this.$v,this._context):null}search(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>
{const W=this.jb.SA(this.$v,!0,!1);this.BB.find(W,e,t,E,this._context)})}_Search2(e,t){return OfficeExtension.WacRuntime.Utility.createPromise(E=>{const W=this.jb.SA(this.$v,!0,!1);this.BB.Jpb(W,e,t,E,this._context)})}select(e){this.Qq.fNo(this.$v,e)}setCellPadding(e,t){this.fd.setCellPadding(this.$v,e,t)}_KeepReference(){this.Wq()}_OnAccess(){vc.a.c5(this.$v,"TableRow")}getTypeName(){return"Microsoft.WordServices.TableRow"}invokePropertyGet(e){switch(e){case 4:return this.cellCount;case 3:return this.cells;
case 20:return this.endnotes;case 21:return this.fields;case 14:return this.font;case 19:return this.footnotes;case 12:return this.horizontalAlignment;case 16:return this.isHeader;case 5:return this.parentTable;case 17:return this.preferredHeight;case 6:return this.rowIndex;case 8:return this.shadingColor;case 7:return this.values;case 13:return this.verticalAlignment;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=
this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,t){switch(e){case 12:this.horizontalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return;case 17:this.preferredHeight=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"number");return;case 8:this.shadingColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 7:this.values=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"Array<Array<string>>");return;case 13:this.verticalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,t){this.invokePropertySet(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e,t){switch(e){case 1006:return this.SIa();case 1005:return this.yF(t);case 1009:return this.i2c(t);case 1023:return this.o2c(t);case 1012:return this.Jfa();
case 1013:return this.Kfa();case 1025:return this.uLa(t);case 1003:return this.nWf(t);case 1004:return this.tLn();case 1007:return this.oha(t);case 1024:return this.Lnd(t);case 1002:return this.ri();case 1001:return this.si()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,t){switch(e){case 1008:return this.yva(t);case 1026:return this.Aoa(t)}e=this.invokeMethod(e,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}SIa(){this.clear();
return null}yF(){this.deleteObject();return null}i2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getBorder(e)}o2c(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");return this.getCellPadding(e)}Jfa(){return this.getNext()}Kfa(){return this.getNextOrNullObject()}uLa(){return this.insertContentControl()}nWf(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int"),E=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,
1,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,2,"Array<Array<string>>");return this.insertRows(t,E,e)}tLn(){return this.merge()}yva(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,jl.a);return this.search(t,e)}Aoa(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"string");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"int");return this._Search2(t,
e)}oha(e){e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");this.select(e);return null}Lnd(e){const t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"int");e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,1,"number");this.setCellPadding(t,e);return null}ri(){this._KeepReference();return null}si(){this._OnAccess();return null}}Object(y.a)($G,"TableRow",si.a,[1143]);class Qw{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud){this.fd=null;this.BC=e;this.Zc=
t;this.JHa=E;this.jb=W;this.od=ha;this.Ml=Ka;this.bE=sb;this.BB=dc;this.Qq=xc;this.LFa=Rc;this.Ih=md;this.Wx=ud;this.tea=Ud}zv(e){this.fd=e}create(e,t,E=0){return new $G(e,t,E,this,this.BC,this.Zc,this.JHa,this.jb,this.od,this.fd,this.Ml,this.bE,this.BB,this.Qq,this.LFa,this.Ih,this.Wx,this.tea)}}Object(y.a)(Qw,"TableRowFactory",null,[1169]);var YI=d(1233),OC=d(117);class yp{constructor(e,t,E,W){this.$g=e;this.jb=t;this.Wd=E;this.aL=W}Tkm(){return this.Wd.GY?1:this.Wd.jPa?2:0}wRo(e,t){const E=YI.a.menuItemId,
W={};switch(t){case 0:W[E]=OC.a.uCc;break;case 1:W[E]=OC.a.tCc;break;case 2:W[E]=OC.a.F3b}32!==e.Pb(Fa.a.Zha,2,W)&&(z.ULS.sendTraceTag(545043662,369,10,"BuildspkgCommands.updateTrackChangeStatus Error."),vc.a.ng())}DNf(e,t,E,W){if(12!=e.type)return"";if(!this.aL.Drf(e,E,W))return this.O8d(e,E,W);const ha=this.aL.nWa(e,E,W);let Ka="";for(const sb of ha)2==sb.Kd.changeType?1==t&&(E<sb.Ad&&(Ka+=this.O8d(e,E,sb.Ad)),E=sb.endCp):1==sb.Kd.changeType&&0==t&&(E<sb.Ad&&(Ka+=this.O8d(e,E,sb.Ad)),E=sb.endCp);
E<W&&(Ka+=this.O8d(e,E,W));return Ka}h9d(e,t){let E=this.DNf(e,t,0,this.jb.textLength(e));e.qa.last.Uh&&1==t||e.qa.last.Xi&&0==t||(E+=vc.a.Eqc);return E}uIm(e,t){let E="";const W=e.start,ha=e.end;return W&&ha?E=e.fg?this.nhm(W,ha,t):E+this.DNf(W.node,t,W.cpBegin,ha.cpEnd):E}nhm(e,t,E){let W="";e=this.$g.gX(e,t);for(const ha of e)W+=this.h9d(ha,E);return W}O8d(e,t,E){t={Ad:t,endCp:E};return""+this.jb.EXb(e,void 0,t).substring(t.Ad,t.endCp)}}Object(y.a)(yp,"TrackChangesOperations",null,[1166]);class aH{constructor(){this.rcg=
new Map;this.X9i=new Map}hEi(e){if(!this.rcg.has(e)){const t=Rd.a.create();this.rcg.set(e,t.toString());this.X9i.set(t.toString(),e)}return this.rcg.get(e)}NBm(e){return this.X9i.get(e)}}Object(y.a)(aH,"ParagraphLocalIdMapping",null,[]);class pB extends gq{constructor(e,t){super(e);this.Rgd=t;this.DWc=vc.a.BOn;this.fOb=new Map;this.Mpe=new Map;this.LN=(E,W)=>{E=W.node;W.property===Tb.a.Un&&E&&this.xrf(16,E.id)};this.Z_n=(E,W)=>{E=W.node;W.aee||!E||E.oXa||this.xrf(15,E.id)};this.b0n=(E,W)=>{(E=W.node)&&
!E.oXa&&this.xrf(17,E.id)}}z6c(){if(vc.a.Bjg){var e=S.App.jf.Il;e&&(e=e.Ve(12),e.fo(this.LN),e.Zt(this.Z_n),e.Bw(this.b0n))}}nSd(e,t){if(e.source!==t.source)return!1;t.iLg=[...(new Set(e.iLg.concat(t.iLg)))];return!0}QXc(e,t,E){t=this.Rgd.hEi(t.rwb);return{eventType:e,eventData:{source:this.g6.ed,iLg:[t]},x1b:E}}rff(e,t){this.fOb.get(e)||this.fOb.set(e,new Set);this.fOb.get(e).add(t.toString());this.Mpe.set(t.toString(),e)}PCj(e,t){this.fOb.get(e)&&this.fOb.get(e).delete(t.toString());this.Mpe.delete(t.toString())}xrf(e,
t){const E=this.Mpe.get(t.toString());if(E)switch(e){case 17:this.PCj(E,t);15!=E&&(this.rff(e,t),this.uUb(e,this.DWc));break;case 16:17==E&&z.ULS.sendTraceTag(508404E3,369,15,"Trying to modify a deleted paragraph object: {0}",t.toString());break;case 15:17==E?(this.PCj(E,t),this.rff(16,t),this.uUb(16,this.DWc)):z.ULS.sendTraceTag(508403999,369,15,"Trying to add a new paragraph object: {0} when one already exists",t.toString())}else this.rff(e,t),this.uUb(e,this.DWc)}Hpg(e){const t=this.fOb.get(e);
if(t){for(const E of t)this.g6.fireEvent(e,{rwb:E}),this.Mpe.delete(E);this.fOb.set(e,new Set)}}}Object(y.a)(pB,"ParagraphEventMessageManager",gq,[1167]);class Vy{constructor(){this.W=null}get name(){return"WordEditor.Extension"}init(){if(Lh.a.Pud){this.W.resolve("WordEditor.Extension.RichApiEventManager");var e=this.W.resolve("WordEditor.Extension.ContentControlFactory"),t=this.W.resolve("WordEditor.Extension.ContentControlOperations"),E=this.W.resolve("WordEditor.Extension.ExtensionFindStatusManagerFactory"),
W=this.W.resolve("WordEditor.Extension.InlinePictureFactory"),ha=this.W.resolve("WordEditor.Extension.ParagraphFactory"),Ka=this.W.resolve("WordEditor.Extension.RangeFactory"),sb=this.W.resolve("WordEditor.Extension.SelectionApiHelper"),dc=this.W.resolve("WordEditor.Extension.TableFactory"),xc=this.W.resolve("WordEditor.Extension.TableRowFactory"),Rc=this.W.resolve("WordEditor.Extension.TableCellFactory"),md=this.W.resolve("WordEditor.Extension.FileApiOperations"),ud=this.W.resolve("WordEditor.Extension.InsertApiOperations"),
Ud=this.W.resolve("WordEditor.Extension.TableOperations"),Id=this.W.resolve("WordEditor.Extension.TrackChangesOperations"),Ee=this.W.resolve("WordEditor.Extension.ListOperations"),kf=this.W.resolve("WordEditor.Extension.ListFactory"),Ke=this.W.resolve("WordEditor.Extension.ListItemFactory"),dh=this.W.resolve("WordEditor.Extension.FieldFactory"),$h=this.W.resolve("WordEditor.Extension.NoteItemFactory"),rj=this.W.resolve("WordEditor.Extension.BodyFactory"),zl=this.W.resolve("WordEditor.Extension.SectionFactory"),
Wl=this.W.resolve("WordEditor.Extension.StyleApiHelper"),Rh=this.W.resolve("WordEditor.Extension.CommentOperations"),Mg=this.W.resolve("WordEditor.Extension.CommentFactory"),Xl=this.W.resolve("WordEditor.Extension.CommentReplyFactory"),ql=this.W.resolve("WordEditor.Extension.CommentContentRangeFactory"),Al=this.W.resolve("WordEditor.Extension.FieldOperations");e.zv(ha,Ka,W,t,Ud,Id,Al);W.zv(ha,Ka);sb.zv(Ud);E.zv(Ka);dh.zv(Ka,Al,Ud,t,ud,sb);ha.zv(Ka);md.zv(Ka,t,zl);ud.zv(t,Ud);dc.zv(Ud,ha,Ka);kf.zv(Ee,
ha);xc.zv(Ud);Rc.zv(Ud,rj);Ke.zv(ha);$h.zv(rj,Ka,ud);Ud.zv(rj);rj.zv(zl);Wl.zv(Ud);Mg.zv(Ka,Rh);Xl.zv(Mg,Rh,ql);ql.zv(Rh)}}dispose(){}wc(e){this.W=e;e.ia("WordEditor.Extension.ExtensionFindManagerFactory",()=>new CE(new aB.a,new sE.a,KG.a.instance,new Ue.a(()=>v.AFrameworkApplication.mc))).ha();e.ia("WordEditor.Extension.ExtensionFindStatusManagerFactory",()=>new EE).ha();e.ia("WordEditor.Extension.ParagraphLocalIdMapping",()=>new aH).ha();e.ia("WordEditor.Extension.SearchExecutor",()=>new QE(SI.a.createQuery,
e.resolve("WordEditor.Extension.ExtensionFindManagerFactory"),e.resolve("WordEditor.Extension.ExtensionFindStatusManagerFactory"),new aB.a)).ha().as("WordEditor.Extension.ISearchExecutor");e.ia("WordEditor.Extension.ContentControlOperations",()=>new SG(e.resolve("WordEditor.ContentControl.IContentControlManager"),e.Oa("Box4.IContentControlDataChangedManager"),e.resolve("WordEditor.Extension.ContentControlFactory"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("Box4.IContentControlCharacterPropertiesEditor"),
e.resolve("Box4.ContentControl.IContentControlOperator"),()=>e.Oa("Box4.IContentControlConverter"),e.resolve("Box4.IContentControlChpHelper"),e.resolve("Box4.IParagraphReader"),e.resolve("Box4.IOutlineElementNavigator"),e.resolve("WordEditor.Extension.ISelectionApiHelper"))).ha().as("WordEditor.Extension.IContentControlOperations");e.ia("WordEditor.Extension.ListOperations",()=>new Ox(e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.ListFactory"),e.resolve("Box4.List.IListReader"),
e.resolve("Box4.List.IListEditor"),e.resolve("Box4.IListMarkerUtility"),e.resolve("Box4.List.ListItemEditor"))).ha().as("WordEditor.Extension.IListOperations");e.ia("WordEditor.Extension.RangeOperations",()=>new un(e.resolve("Box4.IParagraphReader"),v.AFrameworkApplication.va,e.resolve("Box4.HyperlinkEditor"))).ha().as("WordEditor.Extension.IRangeOperations");e.ia("WordEditor.Extension.ExtensionImageStewardFactory",()=>new FE(e.resolve("WordEditor.IImageEditor"),v.AFrameworkApplication.mc,e.resolve("Box4.IUndoManager"),
e.Oa("Box4.IFeatureHelper"))).ha();e.ia("WordEditor.Extension.ImageApiOperations",()=>new an(e.resolve("Box4.BlobReaderProxy"),e.resolve("Box4.Images.ImageReaderProxy"),e.resolve("Box4.IParagraphReader"),new Ue.a(()=>Cc.StaticActiveAppFrame.za().ib.$c),Object(gh.a)(),e.resolve("WordEditor.Extension.ExtensionImageStewardFactory"),v.AFrameworkApplication.Be,v.AFrameworkApplication.K,v.AFrameworkApplication.ua.KWa)).as("WordEditor.Extension.IImageApiOperations").ha();e.ia("WordEditor.Extension.SelectionApiHelper",
()=>new zr(Wg.a.instance,oK.a.instance,e.resolve("Box4.ISelectionFactory"),e.resolve("Box4.IParagraphReader"),v.AFrameworkApplication.va)).ha().as("WordEditor.Extension.ISelectionApiHelper");e.ia("WordEditor.Extension.StyleApiHelper",()=>new ku(e.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.va,e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.AppsForOffice.IApiOperationChecker"),e.resolve("WordEditor.IWACTableStyleReader"),Es.a.instance)).ha().as("WordEditor.Extension.IStyleApiHelper");
e.ia("WordEditor.Extension.InsertApiOperations",()=>new Pz.a(v.AFrameworkApplication.va,e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("Box4.IOutlineElementEditor"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.AppsForOffice.IApiOperationChecker"),e.resolve("WordEditor.AppsForOffice.IOoxmlRangeManager"),xf.a.instance,e.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,e.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,Ku.a.instance,bB.a.instance,e.resolve("Box4.BlobReaderProxy"),
e.resolve("WordEditor.Extension.NoteItemFactory"),Wg.a.instance,e.resolve("Box4.IFieldEditor"),e.resolve("Box4.FieldCopyPasteHelper"))).ha().as("WordEditor.Extension.IInsertApiOperations");e.register(IC,"WordEditor.Extension.FieldOperations").ha().as("WordEditor.Extension.IFieldOperations").Rd(()=>new IC(e.resolve("WordEditor.Extension.FieldFactory"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("Box4.TableReaderProxy"),e.resolve("Box4.TableRowReaderProxy"),
e.resolve("Box4.ITableCellReader"),new uh.a,e.resolve("Box4.IFieldEditor"),e.resolve("Box4.IHyperlinkEditor"),e.resolve("WordEditor.TableOfContents.ITableOfContentsActor"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("Box4.ContentControlParagraphMapping"),e.resolve("Box4.IFieldUpdaterFactory"),v.AFrameworkApplication.va));e.ia("WordEditor.Extension.FileApiOperations",()=>new Mx(e.resolve("WordEditor.AppsForOffice.IOoxmlRangeManager"),e.resolve("WordEditor.Extension.IInsertApiOperations"),
e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.ImageApiOperations"),e.Oa("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),e.resolve("WordEditor.AppsForOffice.IHtmlDataGetSetProvider"),v.AFrameworkApplication.mc)).ha().as("WordEditor.Extension.IFileApiOperations");e.register(yp,"WordEditor.Extension.TrackChangesOperations").ha().as("WordEditor.Extension.ITrackChangesOperations").Rd(()=>new yp(e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("Box4.IParagraphReader"),
e.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,e.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance));e.ia("WordEditor.Extension.TableOperations",()=>new Ot(e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.InsertApiOperations"),e.resolve("Box4.ITableNavigator"),v.AFrameworkApplication.va,new uh.a,e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("Box4.ITableColumnReader"),e.resolve("Box4.ITableCellReader"),e.resolve("WordEditor.Extension.TableFactory"),
e.resolve("WordEditor.Extension.TableRowFactory"),e.resolve("WordEditor.Extension.TableCellFactory"),e.resolve("Box4.TableReaderProxy"),e.resolve("Box4.TableRowReaderProxy"),e.resolve("Box4.IOutlineElementEditor"),e.resolve("WordEditor.Extension.ContentControlOperations"))).ha().as("WordEditor.Extension.ITableOperations");e.ia("WordEditor.Extension.CommentOperations",()=>new fv(e.resolve("WordEditor.Comments.IWordEditorCommentModel"),e.Qa("WordEditor.Comments.IEditorCommentManager"),e.resolve("WordEditor.Extension.CommentFactory"),
v.AFrameworkApplication.va,Wg.a.instance,e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.RangeOperations"),e.resolve("WordEditor.Comments.ICommentFormatTranslator"))).ha().as("WordEditor.Extension.ICommentOperations");e.ia("WordEditor.Extension.FontOperations",()=>new Ow(v.AFrameworkApplication.va,e.resolve("WordEditor.AppsForOffice.IApiOperationChecker"))).ha().as("WordEditor.Extension.IFontOperations");e.ia("WordEditor.Extension.SettingOperations",()=>new TE).ha().as("WordEditor.Extension.ISettingOperations");
e.ia("WordEditor.Extension.InlinePictureFactory",()=>new KE(e.resolve("Box4.Images.IImageReader"),e.resolve("WordEditor.IImageEditor"),e.resolve("WordEditor.Extension.IImageApiOperations"),e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("WordEditor.Extension.IFileApiOperations"),e.resolve("WordEditor.Extension.RangeOperations"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.ITableOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.InlinePicture,Box4.GraphNodeContext>").ha();
e.ia("WordEditor.Extension.FontFactory",()=>new kB(e.resolve("Box4.IParagraphReader"),v.AFrameworkApplication.va,e.resolve("WordEditor.AppsForOffice.IApiOperationChecker"),e.resolve("WordEditor.Extension.IFontOperations"),e.resolve("Box4.Styles.IWACStyleEditor"))).ha();e.ia("WordEditor.Extension.TableBorderFactory",()=>new NC(new uh.a,e.resolve("Box4.TableReaderProxy"),e.resolve("Box4.TableRowReaderProxy"),e.resolve("WordEditor.IWACTableStyleReader"),e.resolve("Box4.TableNavigatorProxy"),e.Qa("Box4.TableCellReaderProxy"),
dq.a.instance,e.resolve("Box4.TableEditors.IWACTableStyleEditor"))).ha();e.ia("WordEditor.Extension.ParagraphFactory",()=>new LC(e.resolve("WordEditor.Extension.FontFactory"),e.resolve("WordEditor.Extension.InlinePictureFactory"),e.resolve("WordEditor.Extension.ListItemFactory"),e.resolve("Box4.IParagraphReader"),e.resolve("Box4.IParagraphEditor"),e.resolve("Box4.ILanguageReader"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("WordEditor.Extension.IStyleApiHelper"),e.resolve("WordEditor.Extension.IInsertApiOperations"),
e.resolve("WordEditor.Extension.IImageApiOperations"),e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.FileApiOperations"),e.resolve("WordEditor.Extension.RangeOperations"),e.resolve("WordEditor.Extension.TableOperations"),e.resolve("WordEditor.Extension.ListOperations"),e.resolve("WordEditor.Extension.CommentOperations"),e.resolve("WordEditor.Extension.TrackChangesOperations"),e.resolve("WordEditor.Extension.FieldOperations"),
e.resolve("WordEditor.Extension.ParagraphLocalIdMapping"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Paragraph,Box4.Graph.GraphNode>").ha();e.ia("WordEditor.Extension.ContentControlFactory",()=>new $n(e.resolve("WordEditor.Extension.FontFactory"),e.resolve("WordEditor.ContentControl.IContentControlManager"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("WordEditor.Extension.IStyleApiHelper"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("WordEditor.Extension.IImageApiOperations"),
e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.IFileApiOperations"),e.resolve("WordEditor.Extension.RangeOperations"),e.resolve("WordEditor.Extension.ListOperations"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.CommentOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.ContentControl,WordEditor.ContentControl.IContentControl>").ha();e.ia("WordEditor.Extension.InternalRangeFactory",()=>new cw(e.resolve("Box4.ICharacterPropertiesEditor"),
e.resolve("Box4.IParagraphReader"),new Ue.a(()=>Cc.StaticActiveAppFrame.za()?Cc.StaticActiveAppFrame.za().ib.$c.td:null),e.resolve("Box4.IDynamicRangeObjectSpace"),e.resolve("Box4.IDynamicRangeEditor"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("WordEditor.ITableEditor"))).ha();e.ia("WordEditor.Extension.AnnotationOperations",()=>new hu(e.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha().as("WordEditor.Extension.IAnnotationOperations");
e.ia("WordEditor.Extension.RangeFactory",()=>new Qz(e.resolve("WordEditor.Extension.ParagraphFactory"),e.resolve("WordEditor.Extension.InlinePictureFactory"),e.resolve("WordEditor.Extension.FontFactory"),e.resolve("WordEditor.Extension.InternalRangeFactory"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("WordEditor.Extension.IStyleApiHelper"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("WordEditor.Extension.IImageApiOperations"),
e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.FileApiOperations"),e.resolve("WordEditor.Extension.RangeOperations"),e.resolve("Box4.HyperlinkEditor"),e.resolve("WordEditor.Extension.TableOperations"),e.resolve("WordEditor.Extension.ListOperations"),e.resolve("WordEditor.Bookmark.IBookmarkManager"),e.resolve("WordEditor.Extension.NoteItemFactory"),e.resolve("WordEditor.Extension.CommentOperations"),e.resolve("WordEditor.Extension.TrackChangesOperations"),
e.resolve("WordEditor.Extension.FieldOperations"),e.resolve("WordEditor.Extension.IAnnotationOperations"))).ha();e.ia("WordEditor.Extension.ListFactory",()=>new KC(e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("Box4.IParagraphReader"))).ha();e.ia("WordEditor.Extension.ListItemFactory",()=>new xo(e.resolve("WordEditor.Extension.ListOperations"),e.resolve("Box4.IListMarkerUtility"))).ha();e.ia("WordEditor.Extension.NoteItemFactory",()=>new NE).ha();e.ia("WordEditor.Extension.FieldFactory",
()=>new GE).ha();e.ia("WordEditor.Extension.BodyFactory",()=>new Fo(e.resolve("WordEditor.Extension.ParagraphFactory"),e.resolve("WordEditor.Extension.RangeFactory"),e.resolve("WordEditor.Extension.FontFactory"),e.resolve("WordEditor.Extension.InlinePictureFactory"),new uh.a,e.resolve("Box4.ICharacterPropertiesEditor"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("WordEditor.Extension.IStyleApiHelper"),e.resolve("WordEditor.Extension.IInsertApiOperations"),
e.resolve("WordEditor.Extension.IImageApiOperations"),e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.IFileApiOperations"),e.resolve("WordEditor.Extension.RangeOperations"),e.resolve("WordEditor.Extension.TableOperations"),e.resolve("WordEditor.Extension.ListOperations"),e.resolve("WordEditor.Extension.CommentOperations"),e.resolve("WordEditor.Extension.TrackChangesOperations"),e.resolve("WordEditor.Extension.FieldOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Body,Box4.Graph.GraphNode>").ha();
e.ia("WordEditor.Extension.SectionFactory",()=>new SE(e.resolve("WordEditor.Extension.BodyFactory"),e.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),e.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Section,Box4.Graph.GraphNode>").ha();e.ia("WordEditor.Extension.TableCellFactory",()=>new xm(new uh.a,e.resolve("WordEditor.Extension.TableBorderFactory"),e.resolve("Box4.TableNavigatorProxy"),e.Qa("Box4.TableCellReaderProxy"),
e.resolve("Box4.TableReaderProxy"),e.resolve("Box4.ITableColumnReader"),e.resolve("Box4.ITableEditor"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.TableCell,Box4.Graph.GraphNode>").ha();e.ia("WordEditor.Extension.TableRowFactory",()=>new Qw(e.resolve("WordEditor.Extension.FontFactory"),new uh.a,e.resolve("WordEditor.Extension.TableBorderFactory"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("Box4.TableNavigatorProxy"),e.resolve("Box4.ITableRowReader"),
e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("Box4.ITableEditor"),e.resolve("Box4.TableReaderProxy"),e.resolve("WordEditor.Extension.FieldOperations"),e.resolve("WordEditor.Extension.TableCellFactory"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.TableRow,Box4.Graph.GraphNode>").ha();e.ia("WordEditor.Extension.TableFactory",()=>new ew(e.resolve("WordEditor.Extension.FontFactory"),e.resolve("WordEditor.Extension.TableCellFactory"),
new uh.a,e.resolve("WordEditor.Extension.TableBorderFactory"),e.resolve("WordEditor.ITableEditor"),e.resolve("Box4.TableReaderProxy"),e.resolve("Box4.TableRowReaderProxy"),e.resolve("Box4.Styles.IWACTableStyleReader"),e.resolve("Box4.TableEditors.IWACTableStyleEditor"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("WordEditor.Extension.RangeOperations"),
e.resolve("Box4.TableNavigatorProxy"),e.resolve("WordEditor.Extension.ISelectionApiHelper"),e.resolve("Box4.ITableEditor"),qh.a.instance,e.resolve("Box4.SectionAlignedViewPositionProvider"),e.resolve("WordEditor.Extension.IStyleApiHelper"),e.resolve("WordEditor.Extension.FieldOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Table,Box4.Graph.GraphNode>").ha();e.ia("WordEditor.Extension.GraphTransactionWrapper",()=>new VG(new Ue.a(()=>Cc.StaticActiveAppFrame.za()?Cc.StaticActiveAppFrame.za().ib.$c:
null),new ge.a)).as("WordEditor.Extension.IGraphTransactionWrapper");e.ia("WordEditor.Extension.RequestContext",()=>new Uy(e.resolve("WordEditor.Extension.GraphTransactionWrapper"))).ha();e.ia("WordEditor.Extension.DocumentProperties",()=>new Py(e.resolve("WordEditor.Extension.RequestContext"),e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),new ge.a,new Of,v.AFrameworkApplication.K.$("WordEditorAppsForOfficeDocPropertiesIsEnabled"))).ha();e.ia("WordEditor.Extension.AnnotationCollectionFactory",
()=>new cB(e.resolve("Box4.AugmentationLoop.IAnnotationStorage"),e.resolve("WordEditor.Extension.ParagraphFactory"))).ha();e.ia("WordEditor.Extension.DocumentFactory",()=>new fj(new Ue.a(()=>Cc.StaticActiveAppFrame.za()?Cc.StaticActiveAppFrame.za().ib.$c:null),e.resolve("WordEditor.Extension.RequestContext"),e.resolve("WordEditor.Extension.BodyFactory"),e.resolve("WordEditor.Extension.SectionFactory"),e.resolve("WordEditor.Extension.RangeFactory"),v.AFrameworkApplication.va,Wg.a.instance,Object(gh.a)(),
qh.a.instance,e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Ju.StaticSaveItems.vN,e.resolve("WordEditor.Extension.ContentControlOperations"),e.resolve("WordEditor.Extension.DocumentProperties"),e.resolve("WordEditor.Extension.AnnotationCollectionFactory"),e.resolve("WordEditor.Bookmark.IBookmarkManager"),e.resolve("Box4.IParagraphReader"),e.resolve("WordEditor.Extension.SearchExecutor"),e.resolve("WordEditor.Extension.IFileApiOperations"),e.resolve("WordEditor.Extension.TrackChangesOperations"),
e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),e.resolve("WordEditor.Extension.CustomXmlPartFactory"),new ge.a,e.resolve("WordEditor.Extension.SettingOperations"),e.resolve("Box4.Styles.IWACStyleReader"),e.resolve("Box4.Styles.IWACStyleEditor"),e.resolve("WordEditor.Extension.FontFactory"),Ku.a.instance,e.resolve("WordEditor.Extension.ParagraphFactory"),e.resolve("WordEditor.Extension.ParagraphLocalIdMapping"))).ha();e.ia("WordEditor.Extension.DocumentCreatedFactory",()=>new My).ha();
e.ia("WordEditor.Extension.AuthenticationServiceFactory",()=>new rt(e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),e.resolve("Postmessage.IHostPostmessenger"))).ha();e.ia("WordEditor.Extension.LicenseFactory",()=>new bp(e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),e.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();e.ia("WordEditor.Extension.AppRuntimeServiceFactory",()=>new Gx(e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),
e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).ha();e.ia("WordEditor.Extension.CommentContentRangeFactory",()=>new Km(e.resolve("WordEditor.Extension.IInsertApiOperations"),e.resolve("WordEditor.Extension.IFontOperations"),e.resolve("WordEditor.Extension.RangeOperations"),e.resolve("WordEditor.Comments.IWordEditorCommentModel"))).ha();e.ia("WordEditor.Extension.CommentFactory",()=>new QG(e.resolve("WordEditor.Extension.CommentReplyFactory"),e.resolve("WordEditor.Extension.CommentContentRangeFactory"),
e.resolve("Box4.IParagraphReader"))).ha();e.ia("WordEditor.Extension.CommentReplyFactory",()=>new DC(new Ue.a(()=>Cc.StaticActiveAppFrame.za()?Cc.StaticActiveAppFrame.za().ib.$c.td:null))).ha();e.ia("WordEditor.Extension.AppRuntimePersistenceServiceFactory",()=>new OG(e.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),e.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).ha();e.ia("WordEditor.Extension.RichApiEventManager",()=>new xp(e.resolve("WordEditor.Extension.EventMessageManagerMapper"),
OfficeExtension.WacRuntime.RichApi.getEventManager(),new HC)).ha();e.ia("WordEditor.Extension.EventMessageManagerMapper",()=>new AE(e.resolve("WordEditor.Extension.CommentEventMessageManager"),e.resolve("WordEditor.Extension.ContentControlEventMessageManager"),e.resolve("WordEditor.Extension.DocumentEventMessageManager"),e.resolve("WordEditor.Extension.ParagraphEventMessageManager"))).ha();e.ia("WordEditor.Extension.CommentEventMessageManager",()=>new Nu(e.Qa("WordEditor.Extension.RichApiEventManager"),
e.resolve("WordEditor.Comments.EditorCommentModel"))).ha();e.ia("WordEditor.Extension.ParagraphEventMessageManager",()=>new pB(e.Qa("WordEditor.Extension.RichApiEventManager"),e.resolve("WordEditor.Extension.ParagraphLocalIdMapping"))).ha();e.ia("WordEditor.Extension.ContentControlEventMessageManager",()=>new zE(e.Qa("WordEditor.Extension.RichApiEventManager"),e.resolve("Box4.IContentControlDataChangedManager"),e.resolve("WordEditor.ContentControl.IContentControlGraphManager"),e.resolve("Box4.ISelectionManager"),
e.resolve("Box4.IContentControlChpHelper"),e.resolve("WordEditor.Extension.ContentControlOperations"))).ha();e.ia("WordEditor.Extension.DocumentEventMessageManager",()=>new TG(e.Qa("WordEditor.Extension.RichApiEventManager"),this.R9a())).ha();e.ia("WordEditor.Extension.CustomXmlPartFactory",()=>new Pq(e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"))).ha()}R9a(){const e=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory");return e?e.getInstance(0):(z.ULS.sendTraceTag(508827729,
2250,10,"Could not resolve wordCountManagerFactory"),null)}static main(){v.AFrameworkApplication.rL||x.a.instance.Jc(new Vy)}}Object(y.a)(Vy,"ExtensionPackage",null,[0,1]);var lu=d(1230);class mu extends Pa.StandardDialog{constructor(e){super();this.XRe=e;this.Gd=0;this.Pe(1,CommonUIStrings.l_DialogClose)}jR(e){this.Gy(e,CommonUIStrings.l_DefaultDialogTitle,this.XRe,null,!1,!0)}}Object(y.a)(mu,"ErrorDialog",Pa.StandardDialog,[1199]);class VE{}Object(y.a)(VE,"LearningToolsExtraInfoContext",null,[1591]);
class WE{static requestFullscreen(e){e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.requestFullscreen?e.requestFullscreen():z.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():
document.exitFullscreen?document.exitFullscreen():z.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}}Object(y.a)(WE,"FullscreenUtils",null,[]);var qB=d(97),bH=d(1217),Px=d(26);class Vz{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf,Ke,dh,$h){this.vGh=this.BQe=0;this.Vgh=this.kl=this._iframe=this.W=this.jSa=null;this.gMn=rj=>{if(rj.data===qB.a.zmi)return z.ULS.sendTraceTag(20490002,306,50,"Postmessage sent with param: {0}",rj.data),this.b4h(),!0;if(rj.data===
qB.a.ooo)return this.Lqh=!0,this.yVl(),this.X2j(),!0;if(rj.data===qB.a.CEo)WE.requestFullscreen(this.W);else if(rj.data===qB.a.b4l)WE.exitFullscreen();else{let zl=null;try{zl=JSON.parse(rj.data)}catch(Wl){return z.ULS.sendTraceTag(21320706,306,100,"Postmessage generated exception: "+Wl),!1}if(zl&&(rj=zl.storageIdReceivedToContentLoadedDurationInMs))return this.noh=!0,this.uOe=rj,z.ULS.sendTraceTag(22905240,306,50,"contentLoadedDuration:{0}",this.uOe),!0}z.ULS.sendTraceTag(20490003,306,100,"Postmessage fired with irrelevant param");
return!1};this._title=e;this.s9b=t;this.Af=E;this.Jqa=W;this.an=ha;this.RBb=Ka;this.ibc=sb;this.hQk=dc;this.WDc=xc;this.PIc=Rc;this.XRe=md;this.noh=!1;this.uOe=0;this.Yb=Ud;this.MKc=Rd.a.create().toString();this.V_e=Id;this.Ggb=Ke;this.OOk=ud+"?appId="+Ke;this.rSk=Ee;this.Wvh=kf;this.Obc=dh;this.lac=$h;this.Lqh=!1;this.zpk=mb.a.Cg(this.WDc).name;this.O1=!1}Aeb(){this.kl=(new Yo.a).create();this.kl.Gd=5;this.kl.Du=!1;this.kl.lM(null,null,null)}bfc(){this.kl&&(this.kl.close(),this.kl=null)}jxn(){this.Vgh=
new mu(this.XRe);this.Vgh.jR(nb.a.P6i)}launch(e){z.ULS.sendTraceTag(2049E4,306,50,"Learning Tools service launched");this.an.start();this.BQe=(new Date).getTime();this.Aeb();var t={};t.title=this._title;t.chunks=this.hQk;t.StartingChunkIndex=this.V_e.SelectionChunkIndex;t.StartingCharIndex=this.V_e.SelectionCharIndex;var E="",W="",ha="";this.Obc?(E={},E.data=t,t=qe.c(E),E="&useV2Endpoint=1",this.lac&&(W="&sendDocxFile=1",ha="&startIndex="+this.V_e.SelectionCharIndex)):t=qe.c(t);W=this.Jqa+"OneNoteS2SHandler.ashx?action="+
e+"&appId="+this.Ggb+"&enabledConfig=WordEditorLearningToolsIsEnabled&"+v.AFrameworkApplication.jm+E+W+ha;ha={"Content-Type":"application/json; charset=utf-8"};ha.LearningToolsSessionId=this.MKc;this.Af.Ij(W,2,t,ha,!1,2,Ka=>{this.kcb(Ka)},Ka=>{this.bV(Ka)},e,void 0,void 0,void 0,this.ibc);e=this.OOk+"&exitCallback="+qB.a.zmi+"&omkt="+this.zpk+"&sessionId="+this.MKc+"&showFeedback="+v.AFrameworkApplication.sH.toString();this.rSk&&(e+="&v=2");this.txn(e)}kcb(e){var t=Vz.bxm(e.data.De);this.jSa={};this.O1=
!1;if(this.Wvh)this.jSa.readerModel=t;else{e=Object(Ne.a)(String,t.url);const E=Object(Ne.a)(String,t.storageId),W=Object(Ne.a)(String,t.version);t=Object(Ne.a)(String,t.processingHost);if(!e){Px.b(20259850,200,10,"{0}",{["Desc"]:"NoUrl"});return}this.jSa.storageId=E;this.jSa.apiVersion=W;this.jSa.processingHost=t}this.X2j()}txn(e){v.AFrameworkApplication.Oee=!0;this.W=document.createElement("div");this._iframe=document.createElement("iframe");this.W.appendChild(this._iframe);document.body.appendChild(this.W);
Vz.oOj(this.W);Vz.oOj(this._iframe);this._iframe.id="ImmersiveReader-iframe";this._iframe.title=this.PIc;this._iframe.tabIndex=0;this._iframe.src=e;this._iframe.setAttribute("allowfullscreen","true");this._iframe.setAttribute("aria-modal","true");this.Jzn()}bV(e){this.mYj(!1);z.ULS.sendTraceTag(20259852,201,10,"{0}",this.Erm(e));this.bfc();5!==e.data.status||this.O1?this.jxn():(this.O1=!0,this.b4h(),this.launch(Object(Ne.a)(String,e.data.state)))}Erm(e){let t=-1;e&&e.data&&(t=e.data.He);500===t?z.ULS.sendTraceTag(37065042,
201,10,"Failed to load the immersive reader for app {0} due to a 500 internal server error response from the LT service with LearningToolsSessionId {1}",this.Ggb,this.MKc):408===t&&z.ULS.sendTraceTag(37065043,201,10,"Failed to load the immersive reader for app {0} due to a 408 request timeout from the LT service with LearningToolsSessionId {1}",this.Ggb,this.MKc);return{["desc"]:"LT failure",["status"]:t,["LearningToolsSessionId"]:this.MKc}}Jzn(){this.s9b.mVh(this.gMn)}X2j(){if(this.jSa&&this.Lqh){this.Yb.fV("LearningToolsStaticReader");
this.mYj(!0);this.jSa.launchToPostMessageSentDurationInMs=this.an.Fi;var e={};let t="";if(this.Wvh)if(this.Obc){const E=this.jSa.readerModel;E.launchToPostMessageSentDurationInMs=this.an.Fi;t="LinguisticModel";e.messageValue=E}else t="ReaderModel2",e.messageValue=this.jSa;else t="Data",e.messageValue=this.jSa;e.messageType=t;this.LLj(e);this._iframe&&(e=this.Yb.ge("LearningTools"),e.parent=Fu.AFrame.NO,e.y6(()=>{this._iframe.focus()}),this.Yb.NN("LearningTools",!1));this.LLj({messageType:"SetFocus"})}}LLj(e){if(this._iframe&&
this._iframe.contentWindow){const t=A.a.getOrigin(this._iframe.src);this._iframe.contentWindow.postMessage(JSON.stringify(e),t)}}yVl(){this.bfc();const e=this.Yb.ge("LearningToolsStaticReader");e.parent=Fu.AFrame.NO;e.y6(()=>{this._iframe.focus()});this.W.style.visibility="visible";this._iframe.style.visibility="visible";this.Yb.NN("LearningToolsStaticReader",!1);z.ULS.sendTraceTag(20490001,306,50,"Learning Tools iFrame loaded");this.vGh=(new Date).getTime()-this.BQe}mYj(e){const t=new bH.a,E=new VE;
e?(E.RequestSucceeded=!0,E.DocumentCharCount=this.RBb,E.StartToDisplayIFrameDuration=this.vGh):E.RequestSucceeded=!1;t.ExtraInfoContext=E;this.an.Zcp(t)}b4h(){rb.a.Dy(this._iframe);rb.a.Dy(this.W);this.s9b.Dfi();const e={};e.learningToolsSessionDurationInMs=(new Date).getTime()-this.BQe;e.isContentLoaded=this.noh;e.contentLoadedDuration=this.uOe;this.Yb.fV("LearningTools");v.AFrameworkApplication.Oee=!1;z.ULS.sendTraceTag(21320707,306,50,JSON.stringify(e))}static oOj(e){e.style.position="absolute";
e.style.width="100%";e.style.height="100%";e.style.left="0";e.style.top="0";e.style.borderWidth="0";e.style.visibility="hidden";e.style.zIndex="1000";e.style.background="white"}static bxm(e){var t=null;e=({Zu:t}=qe.d(e)).returnValue;t=Object(Ne.a)(Object,t);return t?t:(Px.b(20259851,200,10,"{0}",{["desc"]:"CouldntParse",["serialized"]:e}),null)}}Object(y.a)(Vz,"LearningToolsLauncher",null,[]);class ps{constructor(){this.LanguageRunsList=null;this.SelectionCharIndex=this.SelectionChunkIndex=0;this.LanguageRunsList=
new fa.a;this.SelectionCharIndex=this.SelectionChunkIndex=0}}Object(y.a)(ps,"LearningToolsDocumentData",null,[]);var pK=d(1003);class PC{}Object(y.a)(PC,"LearningToolsLanguageRun",null,[]);class QC{static zfl(e){let t=null;var E=Ld.GraphIterator.eb(e);if(!E.zb(8))throw Error("Could not locate page content node for given paragraph");for(E=Hc.a.Ft(E,E.origin);E.moveNext();)Xf.ParagraphReader.Bh(E.iterator)&&(e=E.currentNode,e=this.Igl(e),t=this.uWk(e,t));return t}static uWk(e,t){null!=e&&(null==t&&
(t=document.createElement("div")),t.appendChild(e));return t}static Nym(e){var t=new Ld.GraphIterator;t.set(e);t.zb(11);t.ld(11);var E="";t=e.Nd.Nw(t);if(null!=t){e=Xf.ParagraphReader.oXb(e);const W=t.Sw;switch(t.listType){case 0:switch(t.listStyle){case 1:E="decimal";break;case 2:E="loweralpha";break;case 3:E="lowerroman";break;case 4:E="upperalpha";break;case 5:E="upperroman";break;default:E="decimal"}E=`lt:${E};in:${e};li:${W}`;break;case 1:switch(t.listStyle){case 1:E="disc";break;case 2:E="circle";
break;case 3:E="square";break;default:E="disc"}E=`lt:${E};in:${e}`}}return E}static lJi(e){let t=e.isBold?"b:1;":"";t+=e.isItalic?"i:1;":"";t+=e.isUnderline?"u:1;":"";t+=e.isStrikethrough?"s:1;":"";t+=e.isSuperscript?"sup:1;":"";return t+=e.isSubscript?"sub:1;":""}static Igl(e){let t=null;const E=Xf.ParagraphReader.text(e);let W=0;for(;null!=e.qa&&W<e.qa.length;){var ha=e.qa.J(W);var Ka=ha.cp;var sb=W<e.qa.length-1?e.qa.J(W+1).cp:Xf.ParagraphReader.textLength(e);let dc="";null!=ha.formatting?dc=this.lJi(ha.formatting.cache):
({formatting:ha}=e.qa.Mqb(ha.cp),null!=ha&&(dc=this.lJi(ha.cache)));sb=E.substring(Ka,sb);0<sb.length&&(Ka=document.createElement("span"),Ka.setAttribute("style",dc),Ka.innerText=sb,null==t&&(t=document.createElement("p")),t.appendChild(Ka));W++}null!=t&&Xf.ParagraphReader.GX(e)&&t.setAttribute("style",this.Nym(e));return t}}Object(y.a)(QC,"ImmersiveReaderUtility",null,[]);class Tj{get G3m(){return`${S.App.webServiceBase}OneNoteS2SHandler.ashx?action=${this.PQi}&appId=${this.E6}&enabledConfig=WordEditorLearningToolsIsEnabled&${v.AFrameworkApplication.jm}`}constructor(e,
t,E){this.UWl=e;this.RT=t;this.timeoutMs=E;this.E6="Word WAC";this.PQi="immersivereader"}launch(){const e=this.Aeb(WordEditorIntl.WordEditorStrings.l_LearningToolsLoadingMessage);this.v6l().then(t=>{e.close();return this.Fxn(t)}).catch(t=>{z.ULS.sendTraceTag(509661463,209,10,"Immersive Reader failed to launch. Error msg: "+this.Ffa(t));e.close();(new mu(WordEditorIntl.WordEditorStrings.l_LearningToolsErrorMessage)).jR(nb.a.P6i)})}v6l(){return new Promise((e,t)=>{this.RT.Ij(this.G3m,1,null,null,!1,
2,E=>e(E.data.De),t,this.PQi,void 0,void 0,void 0,this.timeoutMs)})}async IAn(){if(window.immersiveReader)return window.immersiveReader;v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?await appResourceLoader.loadChunk("immersiveReader"):await ob.a.instance.resolve("Common.IDynamicScriptLoaderProvider").xC.loadScript("immersiveReader");return window.immersiveReader}async Fxn(e){var t,E,W;const {["v0_7_0"]:{["launchAsync"]:ha,["CookiePolicy"]:Ka}}=await this.IAn(),sb=null===(t=this.UWl.body.paragraphs.getFirstOrNullObject())||
void 0===t?void 0:t.Lsa();t={["title"]:(null===WordRibbonStrings||void 0===WordRibbonStrings?void 0:WordRibbonStrings.ImmersiveView)||"Immersive Reader",["chunks"]:[{["content"]:null===(E=QC.zfl(sb))||void 0===E?void 0:E.innerHTML,["mimeType"]:"text/html"}]};E={["uiLang"]:null===(W=v.AFrameworkApplication.K)||void 0===W?void 0:W.appSettings.UICulture,["cookiePolicy"]:Ka.Enable,["allowFullscreen"]:!0};await ha(e,t,E)}Aeb(e){const t=(new Yo.a).create();t.Gd=5;t.Du=!1;t.message=e;t.lM(null,null,null);
return t}Ffa(e){if("object"!==typeof e)return""+e;if("message"in e)return""+e.message;try{return JSON.stringify(e)}catch(t){return"'Could not JSON serialize the error'"}}}Object(y.a)(Tj,"ImmersiveReaderSDKLauncher",null,[]);class Qx{constructor(){this.an=this.Jqa=this.Af=this.s9b=this.HGc=null;this.WDc=this.ibc=this.RBb=0;this.Yb=this.i$e=this.PIc=null;this.lac=this.Obc=this.L1e=this.Ncf=!1;this.v5l=(e,t,E)=>{if(1===E)return aq.SessionStatusManager.instance.Gk?8:32;if(!Wg.a.instance||!Wg.a.instance.gb||
!Wg.a.instance.gb.currentSelection)return 8;if(this.MBp)return this.ZPn.launch(),32;e=this.HGc.getSelection();this.lac?lf.a.mU(mc.a.R0a,!0,this.qUb,this.AWb,e):(t=this.n4c(),E=this.QHi(e),e=this.Vpm(t,E,e),t=this.WNm(e.LanguageRunsList),E=Qd.a.BL(v.AFrameworkApplication.It.FA),(new Vz(E,this.s9b,this.Af,this.Jqa,this.an,this.RBb,this.ibc,t,this.WDc,this.PIc,WordEditorIntl.WordEditorStrings.l_LearningToolsErrorMessage,this.i$e,this.Yb,e,this.Ncf,this.L1e,"Word WAC",this.Obc,this.lac)).launch("learningtools"));
return 32};this.qUb=e=>{const t=new ps;e=this.Nfm(Object(Ne.a)($v,e));t.SelectionCharIndex=e;e=Qd.a.BL(v.AFrameworkApplication.It.FA);(new Vz(e,this.s9b,this.Af,this.Jqa,this.an,this.RBb,this.ibc,[],this.WDc,this.PIc,WordEditorIntl.WordEditorStrings.l_LearningToolsErrorMessage,this.i$e,this.Yb,t,this.Ncf,this.L1e,"Word WAC",this.Obc,this.lac)).launch("learningtools")};this.AWb=(e,t)=>{z.ULS.sendTraceTag(41418846,209,10,"Error saving the docx file, status code: "+t);this.qUb(e)}}get MBp(){return null!=
this.T6g?this.T6g:this.T6g=v.AFrameworkApplication.K.$("LearningToolsNewImmersiveReaderSDKIsEnabled")}get ZPn(){return null!=this.M1g?this.M1g:this.M1g=(()=>new Tj(this.HGc,this.Af,this.ibc))()}get name(){return"WordEditor.LearningToolsContentExtractor"}wc(){}init(){Lh.a.X3f&&(this.Wb(),this.HGc=ob.a.instance.rf("WordEditor.Extension.DocumentFactory").value.create(),this.s9b=pK.a.instance,this.Af=v.AFrameworkApplication.Be,this.Jqa=S.App.webServiceBase,this.an=v.AFrameworkApplication.ua.hs.vYa("LoadResource",
"ImmersiveReader"),this.ibc=v.AFrameworkApplication.K.ic("LearningToolsTimeoutMs",3E4),this.WDc=v.AFrameworkApplication.lcid,this.PIc=WoncaIntl.WoncaStrings.L_ImmersiveView,this.i$e=v.AFrameworkApplication.K.kb("LearningToolsStaticUrl"),this.Yb=Ni.FocusManager.instance(),this.L1e=v.AFrameworkApplication.K.$("WordEditorLearningToolsNewDataFlowIsEnabled"),this.Obc=v.AFrameworkApplication.K.$("LearningToolsV2EndpointIsEnabled"),this.lac=v.AFrameworkApplication.K.$("LearningToolsSendDocxFileIsEnabled"));
this.Ncf=v.AFrameworkApplication.K.$("WordEditorLearningToolsReactUIIsEnabled")}n4c(){this.RBb=0;const e=this.HGc.body.paragraphs,t=e.length(),E=Array(t);for(let W=0;W<t;W++)E[W]=e._GetItem(W),this.RBb+=E[W].text.length;return E}Nfm(e){const t=e.paragraphs.getFirst();if(t){let E=0,W=0;const ha=this.HGc.body.paragraphs,Ka=ha.length();for(let sb=0;sb<Ka;sb++){const dc=ha._GetItem(sb);if(t.Lsa().equals(dc.Lsa()))return E+=this.QHi(e),E+=dc.text.length?W:0;dc.text.length?(E+=dc.text.length+W,W=0):W++}}return 0}Vpm(e,
t,E){const W=new ps;if(1===e.length&&!e[0].text.length)return t=new PC,t.Run="",W.LanguageRunsList.add(t),W;let ha=-1;E=E.paragraphs.getFirst();let Ka=0;for(const dc of e){e=dc.language();for(let xc=0;xc<e.length;xc++){const Rc=e[xc],md=Rc.Fc,ud=Rc.end;var sb=Rc.lcid;let Ud=0;const Id=new PC;let Ee="und";try{Ee=mb.a.Cg(sb).name}catch(kf){z.ULS.sendTraceTag(25557076,209,10,"error "+kf+" while reading lcid: "+sb)}Id.Lang=Ee;sb=dc.text.substring(md,ud);sb.length||dc.isListItem?Ka=0:Ka++;2>=Ka&&(ud===
dc.text.length||xc===e.length-1)&&(sb+="\n");!md&&dc.isListItem?Ud=Qx.jRo(dc,Id,sb):Id.Run=sb;W.LanguageRunsList.add(Id);ha++;E.Lsa().equals(dc.Lsa())&&t>=md&&t<=ud&&(W.SelectionChunkIndex=ha,W.SelectionCharIndex=t-Rc.Fc+Ud)}}return W}dispose(){}Wb(){v.AFrameworkApplication.va.ra(wb.a.qUb,na.a.application,this.v5l)}QHi(e){let t=0;(e=e.Fq)&&0<e.count&&(t=e.J(0).lk);return t}WNm(e){const t=[];for(const E of e)t.push({["content"]:E.Run,["lang"]:E.Lang});return t}static jRo(e,t,E){const W=e.list,ha=e.listItem;
let Ka="";W&&ha&&(Ka=W.levelTypes[ha.level]?e.listItem.listString+" ":"\u2022 ");t.Run=Ka+E;return Ka.length}static main(){v.AFrameworkApplication.rL||x.a.instance.Jc(new Qx)}}Object(y.a)(Qx,"LearningToolsContentExtractorPackage",null,[0,1]);class RC{constructor(e,t){this.cUb=e;this.lb=t;this.W=null;this.pCo=(E,W,ha)=>{if(1===ha)return this.FPo(this.lb.gb.currentSelection)?32:16;2===ha&&this.W.Qa("WordEditor.INeuralRewriteMessageHandler").execute(Ka=>{Ka.nZn()});return 32}}FPo(e){if(!this.Lpc(e)||
e.qXa)return!1;e=e.Ra;if(Xf.ParagraphReader.nn(e)||df.SelectionEditor.mf(e)||df.SelectionEditor.am(e)){switch((this.cUb.oBa(e)||v.AFrameworkApplication.lcid)&1023){case 9:return!0;case 10:if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}Lpc(e){return e.PL||2<e.length||!e.length||2===e.length&&!df.SelectionEditor.gl(e.Uc)||1===e.length&&df.SelectionEditor.gl(e.Uc)?!1:this.W1f(e.Ra)}W1f(e){return Xf.ParagraphReader.Xb(e.node)?
""!==Xf.ParagraphReader.text(e.node).trim():!1}get name(){return"WordEditor.NeuralRewrite"}wc(e){this.W=e}init(){const e=v.AFrameworkApplication.K;(e.$("RewriteIsEnabled")||e.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&this.W.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{t.isFeatureEnabled(zs.a.Ggj,!1).then(E=>{E&&v.AFrameworkApplication.va.fb(Fa.a.rewrite,I.a.frame,this.pCo,1028);return null})})}dispose(){}static main(){x.a.instance.Jc(new RC(ob.a.instance.resolve("Box4.ILanguageReader"),
ob.a.instance.resolve("Box4.ISelectionManager")))}}Object(y.a)(RC,"NeuralRewritePackage",null,[0,1]);var rB=d(437);class Ol{constructor(e,t){this.Qoa=this.Yh=null;this.Ffd=(E,W)=>{if(10===W.type&&(E="boolean"===typeof W.nA?W.nA?1:0:W.nA,this.Qoa!==E)){W="";switch(E){case null:case 0:W="Session not connected to OCS.";break;case 1:W="Session connected to OCS.";break;case 2:W="Session connected to OCS (WPM).";break;default:z.ULS.shipAssertTag(523120715,337,!1,"Unexpected hint value {0}",E)}z.ULS.sendTraceTag(523120716,
337,50,W);this.Qoa=E;this.k6.nS(rB.a.pdg)}};this.cNa=(E,W)=>{W.newState||(z.ULS.sendTraceTag(36806805,337,50,"RTC disconnected. No longer able to fetch OCS connection status."),this.Qoa=null,this.k6.nS(rB.a.pdg))};this.hyp=(E,W,ha,Ka,sb)=>{if(1===ha)return 32;sb[H.a.Visible]=null!=this.Qoa;switch(this.Qoa){case null:case 0:sb[H.a.Value]=WordEditorIntl.WordEditorStrings.L_OcsNotConnected;break;case 1:sb[H.a.Value]=WordEditorIntl.WordEditorStrings.L_OcsConnected;break;case 2:sb[H.a.Value]=WordEditorIntl.WordEditorStrings.L_OcsFluidConnected;
break;default:sb[H.a.Value]=WordEditorIntl.WordEditorStrings.L_OcsNotConnected,z.ULS.shipAssertTag(523120717,337,!1,"Unexpected hint value {0}",this.Qoa)}sb[N.a.labelText]=sb[H.a.Value];return 32};this.ga=e;this.k6=t}init(e){e?(this.Yh=e,this.Yh.JO(this.Ffd),this.Yh.b_(this.cNa),this.ga.fb(Fa.a.qxj,na.a.application,this.hyp,96)):z.ULS.sendTraceTag(36282374,306,10,"Null rtcProxy. Cannot initialize Ocs connection status manager.")}dispose(){this.Yh&&this.Yh.ZDa(this.Ffd)}}Object(y.a)(Ol,"OcsConnectionStatusManager",
null,[13]);class Wz{constructor(){this.Qoa=this.Yh=null;this.Ffd=(e,t)=>{10===t.type&&("boolean"===typeof t.nA?this.Qoa=e=t.nA?1:0:e=t.nA,this.Qoa=e,z.ULS.sendTraceTag(508826904,337,50,"Ocs connection status:"+this.Qoa))};this.cNa=(e,t)=>{t.newState||(z.ULS.sendTraceTag(508826903,337,50,"RTC disconnected. No longer able to fetch OCS connection status."),this.Qoa=null)}}init(e){e?(this.Yh=e,this.Yh.JO(this.Ffd),this.Yh.b_(this.cNa)):z.ULS.sendTraceTag(508826905,306,10,"Ocs State Manager null rtcProxy. Cannot initialize Ocs connection status manager.")}dispose(){this.Yh&&
this.Yh.ZDa(this.Ffd)}}Object(y.a)(Wz,"OcsStateManager",null,[13]);class sB{constructor(){this.W=null}get name(){return"WordEditor.OcsConnectionStatusPackage"}wc(e){this.W=e;this.W.ia("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager",()=>new Ol(v.AFrameworkApplication.va,this.W.resolve("WordEditor.IStatusBarUser"))).ha();this.W.ia("WordEditor.OcsConnectionStatus.OcsStateManager",()=>new Wz).ha()}init(){const e=this.W.resolve("Common.IAppSettingsManager");this.w8m();e.$("WordEditorShowOcsConnectionStatus")&&
this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo()})}w8m(){const e=this.W.resolve("WordEditor.OcsConnectionStatus.OcsStateManager");this.W.Qa("Box4.Presence.IRtcProxyProvider").execute(t=>{t.gD().continueWith(()=>{const E=t.gD().result;e.init(E)})})}Mo(){const e=this.W.resolve("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager");this.W.Qa("Box4.Presence.IRtcProxyProvider").execute(t=>{t.gD().continueWith(()=>{const E=t.gD().result;e.init(E)})})}dispose(){}static main(){x.a.instance.Jc(new sB)}}
Object(y.a)(sB,"OcsConnectionStatusPackage",null,[0,1]);var SC=d(1198);class Xz{constructor(e,t){this.clientId=e;this.g1=t}}Object(y.a)(Xz,"VectorClockInfo",null,[]);class gt{constructor(e,t,E){this.kac=e;this.Zc=t;this.jxk=E}q4m(){let e=this.rKm();return e||(e=this.KJl(),e)?this.r4m(e):(z.ULS.sendTraceTag(25723860,381,10,"Cannot create client vector clock graph node."),!1)}cHi(){return this.xvi(this.kac)}xvi(e){const t=this.c7d();if(t&&t.Ub(1)){do{const E=t.currentNode,W=E.getValue(fd.a.mGe);if(W==
e)return e=E.getValue(fd.a.g1),new Xz(W,e)}while(t.Lf(1))}return null}vhm(){const e=this.c7d();if(!e)return null;if(!e.Ub(1))return em.empty();const t=new fa.a;do{var E=e.currentNode;const W=E.getValue(fd.a.mGe);E=E.getValue(fd.a.g1);W?t.add(new Xz(W,E)):z.ULS.sendTraceTag(25723861,381,15,"A vector clock node with null client id is present in the graph.")}while(e.Lf(1));return t}KJl(){const e=this.c7d();if(!e)return null;const t=new SC.a;t.setValue(fd.a.mGe,this.kac);t.setValue(fd.a.g1,0);e.Uf(t,
1);return t}rKm(){const e=this.c7d();if(e&&e.Ub(1)){do{const t=e.currentNode;if(t.getValue(fd.a.mGe)==this.kac)return t}while(e.Lf(1))}return null}r4m(e){if(!e)return z.ULS.sendTraceTag(25723862,381,10,"Client vector clock node is null."),!1;const t=e.getValue(fd.a.g1)+1;e.setValue(fd.a.g1,t);return!0}c7d(){var e=this.jxk();if(!e)return z.ULS.sendTraceTag(25723864,381,10,"Cannot get an iterator since page content node is null."),null;e=this.Zc.Ksa(e,7,7);return e.Ub(33)?e:(z.ULS.sendTraceTag(25723865,
381,10,"Ocs Vector clock container node doesn't exist."),null)}}Object(y.a)(gt,"ClientGraphOcsVectorClockHandler",null,[1340]);class tB{constructor(e,t,E,W){this.roa=e;this.Jzf=t;this.IYl=E;this.nKo=W}}Object(y.a)(tB,"VectorClockBroadcastData",null,[]);class XE{hqm(e){if(!e)return z.ULS.sendTraceTag(25557077,381,15,"Unable to parse vector clock update message {0}",e),null;if(!e.SL1&&!e.SL2)return z.ULS.sendTraceTag(42243083,381,50,"Save Latency Message is null. [Message: {0}]",e),null;if(e.SL2)return this.oKi(e.SL2);
z.ULS.sendTraceTag(508833934,381,50,"Found save latency message with older SL1 format.");return this.oKi(e.SL1)}oKi(e){return new tB(new Xz(e.VCE.I.toUpperCase(),e.VCE.V),e.E,e.ER,e.SAG)}XIm(e){return e?{SL2:{E:e.Jzf,ER:e.IYl,SAG:e.nKo,VCE:{I:e.roa.clientId,V:e.roa.g1}}}:null}}Object(y.a)(XE,"OcsVectorClockRtcMessageConverter",null,[1341]);class cH extends Sys.EventArgs{constructor(e){super();this.Bel=e}}Object(y.a)(cH,"OcsVectorClockRtcEventArgs",Sys.EventArgs,[]);class Rw{constructor(e){this.sa=
new ua.a;this.Yh=null;this.idf=this.ui=!1;this.nDh=e}Q1k(e){this.sa.addHandler("OnVectorClockRtcReceivedEventKey",e)}dBo(e){this.sa.removeHandler("OnVectorClockRtcReceivedEventKey",e)}G1k(e){this.sa.addHandler("OnSuccessfulSaveToOcsEventKey",e)}YAo(e){this.sa.removeHandler("OnSuccessfulSaveToOcsEventKey",e)}N1k(e){this.sa.addHandler("OnTransitionInToOcsEventKey",e)}aBo(e){this.sa.removeHandler("OnTransitionInToOcsEventKey",e)}O1k(e){this.sa.addHandler("OnTransitionOutOfOcsEventKey",e)}bBo(e){this.sa.removeHandler("OnTransitionOutOfOcsEventKey",
e)}init(e){this.ui?z.ULS.sendTraceTag(25557078,381,10,"Trying to initialize OcsVectorClock Rtc Notification Handler again after it's already initialized."):e?(this.ui=!0,this.Yh=e,this.Yh.JO((t,E)=>{this.a2n(E)})):z.ULS.sendTraceTag(25557079,381,10,"Null rtcProxy. Cannot initialize OcsVectorClock Rtc Notification Handler.")}Jwc(e){this.Yh&&e&&this.Yh.nC(8,this.nDh.XIm(e))}a2n(e){8===e.type?(e=this.nDh.hqm(e.nA))&&this.sa.raiseEvent("OnVectorClockRtcReceivedEventKey",new cH(e)):10===e.type?((e="boolean"===
typeof e.nA?e.nA:0!==e.nA)?this.idf||this.sa.raiseEvent("OnTransitionInToOcsEventKey"):this.idf&&this.sa.raiseEvent("OnTransitionOutOfOcsEventKey"),this.idf=e):11===e.type&&this.sa.raiseEvent("OnSuccessfulSaveToOcsEventKey")}}Object(y.a)(Rw,"OcsVectorClockRtcNotificationHandler",null,[1339]);class Rx{constructor(e,t,E,W,ha){this.BHa=E;this.f$=W;this.rQ=ha;this.Kmh=(Ka,sb)=>{t.h4n(sb.Bel)};this.Jmh=()=>{t.TYn()};this.Ayh=()=>{e.e3n()};this.Txh=()=>{e.Ghg();t.Ghg()};this.Uxh=()=>{e.Hhg();t.Hhg()};this.exh=
()=>{e.sWb()}}ndm(){this.BHa.Q1k(this.Kmh);this.f$.RRd(this.Jmh);this.BHa.G1k(this.Ayh);this.BHa.N1k(this.Txh);this.BHa.O1k(this.Uxh);this.rQ.MSc(this.exh)}fda(){this.BHa&&(this.BHa.dBo(this.Kmh),this.BHa.YAo(this.Ayh),this.BHa.aBo(this.Txh),this.BHa.bBo(this.Uxh));this.f$&&this.f$.bEj(this.Jmh);this.rQ&&this.rQ.Aue(this.exh)}}Object(y.a)(Rx,"OcsVectorClockTelemetryEventForwarder",null,[]);class Sx{constructor(e,t){this.BAb=e;this.KRn=t}}Object(y.a)(Sx,"JournalEntry",null,[]);class Yz{constructor(e,
t,E,W,ha,Ka,sb){this.uia=!0;this.kac=e;this.gm=t;this.h5b=E;this.Lcf=W;this.qdg=Ka;this.dF=sb}h4n(e){if(!this.uia){var t=this.dF(),E=e.roa.clientId;if(E===this.kac)z.ULS.sendTraceTag(25723870,381,100,"Receiving own broadcast. Ignoring!");else if(this.bun(E))z.ULS.sendTraceTag(25723871,381,100,"Receiving vector clock broadcast from a WAC client {0}. Ignoring!",E);else{var W=this.h5b.xvi(E);W&&W.g1>=e.roa.g1?z.ULS.sendTraceTag(25723872,381,100,"Receiving late vector clock broadcast for client {0} with vector clock value {1}. Ignoring!",
E,e.roa.g1):this.Lcf.Uy(new Sx(e,t))}}}TYn(){if(!this.uia){var e=this.dF(),t=this.h5b.vhm();if(t)for(const E of t){if(t=this.Lcf.Tbo(E.clientId,E.g1))for(const W of t)this.RDn(W,e)}else z.ULS.sendTraceTag(25798300,381,10,"Cannot fetch vector clocks from graph. Disabling OcsVectorClockTelemetryInboundManager."),this.uia=!0}}Ghg(){z.ULS.sendTraceTag(36712913,381,50,"Transitioned in to OCS. Enabling OcsVectorClockTelemetryInboundManager.");this.uia=!1}Hhg(){z.ULS.sendTraceTag(36712914,381,50,"Transitioned out of OCS. Disabling OcsVectorClockTelemetryInboundManager.");
this.uia=!0;this.Lcf.Rql()}RDn(e,t){var E;t=t.getTime()-e.KRn.getTime();if(0>t)z.ULS.sendTraceTag(25723873,381,100,"Received content before broadcast for VC {0} of client {1}. Ignoring!",e.BAb.roa.g1,e.BAb.roa.clientId);else{var W=Math.round(e.BAb.Jzf/1E3),ha=W+t,Ka=null;Ka=this.qdg.Qoa;var sb=null===(E=v.AFrameworkApplication.K)||void 0===E?void 0:E.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldTriggerFluidCoauthSurvey",!1);v.AFrameworkApplication.Ld("7d2eh734;0egbh454");sb&&2==Ka&&(E=
ob.a.instance.Qa("Common.ISystemInitiatedFeedback"))&&E.execute(dc=>{dc.logActivity("FluidOnWebCoauthSentimentSurvey",null)});z.ULS.sendTraceTag(25723874,381,50,"Ocs Replication: {0}",Yz.buf(e.BAb.roa.clientId,this.kac,e.BAb.roa.g1,W,t,ha,Ka))}}bun(e){return(e=this.gm.nB.Ljc(Yz.xlm(e)))&&e.Capabilities?e.Capabilities.SupportsAppInnerLoop:!1}static xlm(e){return"{"+e.toLowerCase()+"}"}static buf(e,t,E,W,ha,Ka,sb){return{["S"]:e,["R"]:t,["V"]:E,["OT"]:sb,["ST"]:W,["RT"]:ha,["T"]:Ka}}}Object(y.a)(Yz,
"OcsVectorClockTelemetryInboundManager",null,[]);var nu=d(1254);class jv extends Nw.a{constructor(e){super();this.szk=e}get index(){return 0}run(){this.szk()}WI(){this.D0()}}Object(y.a)(jv,"OcsVectorClockUpdateProcessor",Nw.a,[]);class uB{constructor(e,t,E,W,ha,Ka){this.ui=!1;this.uia=!0;this.d7b=this.l2e=null;this.Mcf=!0;this.HAp=()=>{this.uia||this.Mcf||(this.h5b.q4m()?this.Mcf=!0:(z.ULS.sendTraceTag(25557084,381,10,"Cannot update vector clock graph node. Disabling OcsVectorClockTelemetryOutboundManager."),
this.uia=!0))};this.g$=e;this.h5b=t;this.BHa=E;this.qdg=ha;this.dF=Ka}init(){this.ui?z.ULS.sendTraceTag(25557082,381,10,"Trying to initialize OcsVectorClockTelemetryOutboundManager again after it's already initialized."):(this.b1m(),this.ui=!0)}CKo(){const e=this.h5b.cHi();e?(nu.a.StaticVarVectorClockClientId=e.clientId,nu.a.StaticVarVectorClockValue=e.g1):(nu.a.StaticVarVectorClockClientId=null,nu.a.StaticVarVectorClockValue=null);nu.a.StaticVarFirstEditTime=new Date}b1m(){this.l2e=new jv(this.HAp);
this.g$.Ava(this.l2e,7)}sWb(){this.CKo();this.uia||this.d7b||(this.d7b=this.dF(),this.Mcf=!1,this.l2e.WI())}e3n(){!this.uia&&this.d7b&&(this.Cel(),this.d7b=null)}Ghg(){z.ULS.sendTraceTag(36712918,381,50,"Transitioned in to OCS. Enabling OcsVectorClockTelemetryOutboundManager.");this.d7b=null;this.uia=!1}Hhg(){z.ULS.sendTraceTag(36712919,381,50,"Transitioned out of OCS. Disabling OcsVectorClockTelemetryOutboundManager.");this.uia=!0}Cel(){var e;if(!this.uia){var t=this.h5b.cHi();if(t){var E=1E3*(this.dF().getTime()-
this.d7b.getTime());t=new tB(t,E,0,"{CCCCCCCC-CCCC-CCCC-CCCC-FFFFFFFFFFFF}");this.BHa.Jwc(t);E=null===(e=v.AFrameworkApplication.K)||void 0===e?void 0:e.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldTriggerFluidCoauthSurvey",!1);v.AFrameworkApplication.Ld("7d2eh734;0egbh454");e=null;e=this.qdg.Qoa;E&&2==e&&(E=ob.a.instance.Qa("Common.ISystemInitiatedFeedback"))&&E.execute(W=>{W.logActivity("FluidOnWebCoauthSentimentSurvey",null)});z.ULS.sendTraceTag(36712920,381,50,"Vector clock broadcast: {0}",
uB.buf(t.roa.clientId,t.roa.g1,t.Jzf,e))}else z.ULS.sendTraceTag(25557086,381,10,"Unable to get self vector clock from graph. Disabling OcsVectorClockTelemetryOutboundManager."),this.uia=!0}}static buf(e,t,E,W){return{["S"]:e,["V"]:t,["OT"]:W,["ST"]:E}}}Object(y.a)(uB,"OcsVectorClockTelemetryOutboundManager",null,[]);var ht=d(2013);class YE{constructor(){this.jKc=new gf.a;this.aHd=new gf.a}Uy(e){const t=e.BAb.roa.clientId,E=e.BAb.roa.g1;let W;({value:W}=this.jKc.Dc(t,W)).returnValue||(W=new ht.a,
this.jKc.Z(t,W));if(30<=W.count)z.ULS.sendTraceTag(25723905,381,50,"Already {0} pending entries in the journal for client {1}. Ignoring the new entry with vector clock value {2}!",W.count,t,E);else{var ha;({value:ha}=this.aHd.Dc(t,0)).returnValue&&ha>=E||(W.enqueue(e),this.aHd.Z(t,E))}}Tbo(e,t){let E;if(!({value:E}=this.jKc.Dc(e,E)).returnValue||!E||!E.count)return null;for(e=new fa.a;!E.isEmpty;){const W=E.L0();if(W.BAb.roa.g1>t)break;e.add(W);E.dequeue()}return e}Rql(){for(const e of this.jKc.keys)this.jKc.remove(e);
for(const e of this.aHd.keys)this.aHd.remove(e)}}Object(y.a)(YE,"VectorClockJournal",null,[1160]);class ZE{constructor(){this.W=null;this.Mp=()=>{const e=Cc.StaticActiveAppFrame.za().ib.sc;return e?e.jd:null}}get name(){return"WordEditor.OcsVectorClockTelemetry"}get clientId(){return v.AFrameworkApplication.userSessionId.toUpperCase()}wc(e){this.W=e;e.ia("WordEditor.OcsVectorClockTelemetry.IClientGraphOcsVectorClockHandler",()=>new gt(this.clientId,e.resolve("Box4.Graph.IGraphIteratorFactory"),this.Mp)).ha();
e.ia("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcMessageConverter",()=>new XE).ha();e.ia("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler",()=>new Rw(e.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcMessageConverter"))).ha();e.ia("WordEditor.OcsVectorClockTelemetry.IVectorClockJournal",()=>new YE);e.ia("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryOutboundManager",()=>new uB(e.resolve("Box4.Graph.IGraphTransactionManager"),e.resolve("WordEditor.OcsVectorClockTelemetry.IClientGraphOcsVectorClockHandler"),
e.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler"),e.resolve("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager"),e.resolve("WordEditor.OcsConnectionStatus.OcsStateManager"),()=>new Date)).ha();e.ia("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryInboundManager",()=>new Yz(this.clientId,wu.StaticTheCoauthManager.ud(),e.resolve("WordEditor.OcsVectorClockTelemetry.IClientGraphOcsVectorClockHandler"),e.resolve("WordEditor.OcsVectorClockTelemetry.IVectorClockJournal"),
e.resolve("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager"),e.resolve("WordEditor.OcsConnectionStatus.OcsStateManager"),()=>new Date)).ha();e.ia("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryEventForwarder",()=>new Rx(e.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryOutboundManager"),e.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryInboundManager"),e.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler"),
gv.a.instance,e.resolve("Box4.ContentEditableViewEventSource"))).ha()}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo()})}Mo(){this.M5m();const e=this.W.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler");this.W.Qa("Box4.Presence.IRtcProxyProvider").execute(t=>{t.gD().continueWith(()=>{const E=t.gD().result;e.init(E)})});this.W.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryEventForwarder").ndm()}M5m(){this.W.resolve("Common.IAppSettingsManager");
this.W.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryOutboundManager").init();this.W.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryInboundManager")}dispose(){if(this.W){var e=this.W.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryEventForwarder");e&&e.fda()}}static main(){x.a.instance.Jc(new ZE)}}Object(y.a)(ZE,"OcsVectorClockTelemetryPackage",null,[0,1]);var ZI=d(1882);class Zz{}Zz.fgo="Microsoft.Office.WordOnline.ProactiveUxOpenedCooldownMilliseconds";
Zz.ego="Microsoft.Office.WordOnline.ProactiveUxEngagedCooldownMilliseconds";Object(y.a)(Zz,"Constants",null,[]);class $E{constructor(e,t=null){this.uOc=new fa.a;this.Ga=e;this.dF=t?t:()=>new Date;this.mSk=this.Ga.getIntFeatureGate(Zz.fgo,24E4);this.kSk=this.Ga.getIntFeatureGate(Zz.ego,6E4)}KAj(e){this.uOc.contains(e)||this.uOc.add(e)}ckf(e,t){if(1===this.uOc.count&&this.uOc.J(0).id===e)t();else{z.ULS.sendTraceTag(572339906,3025,50,"{0} attempted to trigger proactively",e);var E=this.dF(),W=null,ha=
null,Ka=null;for(const sb of this.uOc){if(sb.id===e&&sb.jtc){z.ULS.shipAssertTag(572592797,3025,!1,"{0} is already open",e);return}this.BYi(sb.jtc,W?W.jtc:null)&&(W=sb);this.BYi(sb.x_c,ha?ha.x_c:null)&&(ha=sb)}W&&this.fSj(E,W.jtc,this.mSk)?Ka=W:ha&&this.fSj(E,ha.x_c,this.kSk)&&(Ka=ha);Ka?z.ULS.sendTraceTag(572838542,3025,50,JSON.stringify({$Qp:e,eLp:Ka.id,fLp:Ka.jtc,dLp:Ka.x_c})):t()}}BYi(e,t){return!!e&&(!t||e>t)}fSj(e,t,E){return!!t&&+e-+t<E}}Object(y.a)($E,"ProactiveUxManager",null,[1196]);class aF{get name(){return"WordEditor.ProactiveUxGovernance"}init(){}wc(e){e?
e.ia("WordEditor.ProactiveUxGovernance.IProactiveUxManager",()=>new $E(v.AFrameworkApplication.K)).ha():z.ULS.shipAssertTag(572838541,3025,!1)}dispose(){}}Object(y.a)(aF,"PackageManager",null,[0,1]);class kv{constructor(e){this.name=e;this.Pii=1;this._lcidMap=[]}YXk(e,t){if(!t)throw Error.argumentNull(t.toLocaleString());this._lcidMap[e]=t}l6d(e){return this._lcidMap[e&1023]}isValid(){return this.name&&this._lcidMap?!0:!1}}Object(y.a)(kv,"LanguageModel",null,[1198,1194]);class vB{constructor(){this.uxg=
this.Grc=this.rZc=this.wwc=this.wPg=0}isValid(){return 0>=this.wPg||0>=this.wwc||0>=this.uxg||this.Grc>this.wwc?!1:!0}}Object(y.a)(vB,"ObjectCountParameterSet",null,[1194]);class bF{constructor(){this.Usk=this.Rsk=this.$sk=this.Zsk=0}create(e){switch(e){case 1:return this.MEl();default:throw Error.notImplemented("algorithmType");}}MEl(){const e=new kv("Default language model based on word, image and table count");this.qc(e,0,0);this.qc(e,1,138);this.qc(e,2,184);this.qc(e,3,218);this.qc(e,4,158);this.qc(e,
5,166);this.qc(e,6,199);this.qc(e,7,179);this.qc(e,8,184);this.qc(e,9,228);this.qc(e,10,218);this.qc(e,11,161);this.qc(e,12,195);this.qc(e,13,187);this.qc(e,14,161);this.qc(e,15,179);this.qc(e,16,188);this.qc(e,17,193);this.qc(e,18,193);this.qc(e,19,202);this.qc(e,20,199);this.qc(e,21,166);this.qc(e,22,181);this.qc(e,23,228);this.qc(e,24,188);this.qc(e,25,184);this.qc(e,26,180);this.qc(e,27,180);this.qc(e,28,180);this.qc(e,29,199);this.qc(e,30,193);this.qc(e,31,166);this.qc(e,32,138);this.qc(e,33,
228);this.qc(e,34,184);this.qc(e,35,184);this.qc(e,36,180);this.qc(e,37,161);this.qc(e,38,180);this.qc(e,39,180);this.qc(e,40,228);this.qc(e,41,138);this.qc(e,42,193);this.qc(e,43,138);this.qc(e,44,138);this.qc(e,45,166);this.qc(e,46,228);this.qc(e,47,180);this.qc(e,48,228);this.qc(e,49,228);this.qc(e,50,228);this.qc(e,51,228);this.qc(e,52,228);this.qc(e,53,228);this.qc(e,54,202);this.qc(e,55,184);this.qc(e,56,199);this.qc(e,57,228);this.qc(e,58,228);this.qc(e,59,228);this.qc(e,60,228);this.qc(e,
61,179);this.qc(e,62,228);this.qc(e,63,184);this.qc(e,64,184);this.qc(e,65,228);this.qc(e,66,228);this.qc(e,67,184);this.qc(e,68,184);this.qc(e,69,228);this.qc(e,70,228);this.qc(e,71,228);this.qc(e,72,228);this.qc(e,73,228);this.qc(e,74,228);this.qc(e,75,228);this.qc(e,76,228);this.qc(e,77,228);this.qc(e,78,228);this.qc(e,79,228);this.qc(e,80,166);this.qc(e,81,228);this.qc(e,82,228);this.qc(e,83,228);this.qc(e,84,228);this.qc(e,85,193);this.qc(e,86,218);this.qc(e,87,228);this.qc(e,88,228);this.qc(e,
89,228);this.qc(e,90,228);this.qc(e,91,228);this.qc(e,92,228);this.qc(e,93,228);this.qc(e,94,228);this.qc(e,95,228);this.qc(e,96,228);this.qc(e,97,228);this.qc(e,98,228);this.qc(e,99,228);this.qc(e,100,228);this.qc(e,101,228);this.qc(e,102,228);this.qc(e,103,228);this.qc(e,104,228);this.qc(e,105,228);this.qc(e,106,228);this.qc(e,107,228);this.qc(e,108,228);this.qc(e,109,228);this.qc(e,110,228);this.qc(e,111,228);this.qc(e,112,228);this.qc(e,113,228);this.qc(e,114,228);this.qc(e,115,228);this.qc(e,
116,228);this.qc(e,117,228);this.qc(e,118,228);this.qc(e,119,228);this.qc(e,120,228);this.qc(e,121,228);this.qc(e,122,228);this.qc(e,124,228);this.qc(e,126,228);this.qc(e,127,228);this.qc(e,128,228);this.qc(e,129,228);this.qc(e,130,228);this.qc(e,131,228);this.qc(e,132,228);this.qc(e,133,228);this.qc(e,134,228);this.qc(e,135,228);this.qc(e,136,228);this.qc(e,140,228);this.qc(e,145,228);this.qc(e,146,228);this.qc(e,147,228);return e}qc(e,t,E){e.YXk(t,Object.assign(new vB,{wPg:E,wwc:this.Zsk,uxg:this.$sk,
rZc:this.Rsk,Grc:this.Usk}))}}Object(y.a)(bF,"LanguageModelFactory",null,[1162]);class Tx{constructor(){this.Vyj=this.AWf=this.fNb=0}}Object(y.a)(Tx,"ReadingTimeValue",null,[]);class Sw{constructor(){this.Pii=this.Mhf=1;this.qHg=this.nUf=this.ePg=this.JJg=-1}}Object(y.a)(Sw,"ReadingTimeOutput",null,[]);class fw{constructor(){this.qwh=!1;this.$wl=(e,t)=>t.fNb>e.fNb?1:e.fNb>t.fNb?-1:0}get Mhf(){return 1}pNf(e,t,E){if(!e)throw Error.argumentNull("ReadingTimeInput");if(!t)throw Error.argumentNull("ObjectCountParameterSet");
if(!E)throw Error.argumentNull("Language model is null");var W=new fa.a,ha=0;for(var Ka=0;Ka<e.Yab.count;Ka++){var sb=E.l6d(e.Yab.J(Ka));void 0!==sb&&null!==sb?ha+=e.OAb.J(Ka)/E.l6d(e.Yab.J(Ka)).wPg:this.qwh||(this.qwh=!0,z.ULS.sendTraceTag(41554646,338,50,"Language in paragraph is not supported in language model and is holding {0} words",e.OAb.J(Ka)))}this.zff(W,ha,0);ha=E=0;Ka=t.wwc;0<t.rZc&&(E=Math.floor((t.wwc-t.Grc)/t.rZc),ha=(t.wwc-t.Grc)%t.rZc,Ka=t.Grc);Ka=Math.max(0,(e.LL-E)*Ka);for(sb=E;sb>=
Math.max(0,E-e.LL+1);--sb)Ka+=t.Grc+ha+sb*t.rZc;this.zff(W,Ka/60,1);this.zff(W,e.Zca*t.uxg/60,2);e=this.hkl(W);W.Sc(this.$wl);t=this.ikl(W);e=Object.assign(new Sw,{Mhf:this.Mhf,Pii:1,JJg:e});t=Math.round(t);for(const dc of W){W=dc.AWf+(0<t?1:0);switch(dc.Vyj){case 0:e.ePg=W;break;case 1:e.nUf=W;break;case 2:e.qHg=W}0<t&&t--}return e}zff(e,t,E){e.add(Object.assign(new Tx,{Vyj:E,AWf:this.ZEi(t,Math.floor),fNb:t%1}))}hkl(e){let t=0;for(const E of e)t+=E.AWf+E.fNb;return this.ZEi(t,Math.ceil)}ikl(e){let t=
0;for(const E of e)t+=E.fNb;return t}ZEi(e,t){e=t(e);if(!this.isSafeInteger(e)||0>e)throw Error.argumentOutOfRange("result is not a positive safe integer");return e}isSafeInteger(e){return isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<=this.MAX_SAFE_INTEGER}get MAX_SAFE_INTEGER(){return 9007199254740991}}Object(y.a)(fw,"ObjectCountReadingTimeStrategy",null,[1197]);class cF{constructor(e,t){if(!e)throw Error.argumentNull("IReadingTimeStrategy");if(!t)throw Error.argumentNull("ILanguageModel");if(!t.isValid())throw Error.argument("ILanguageModel");
this.mKk=e;this.WZe=t}pNf(e){if(this.isValid(e)){if(this.Tkn(e))return new Sw;if(!this.S9k(e))throw Error.argument("Input fields are in invalid state");}else throw Error.argument("ReadingTimeInput is null");let t=this.WZe.l6d(e.LCID);if(void 0===t||null===t)t=this.WZe.l6d(0);return this.mKk.pNf(e,t,this.WZe)}isValid(e){return e?!0:!1}Tkn(e){return 0>e.LL&&0>e.Zca&&!e.Yab&&!e.OAb}S9k(e){return 0<=e.LL&&0<=e.Zca&&!!e.LCID}}Object(y.a)(cF,"ReadingTimeAlgorithm",null,[1195]);class dH{constructor(e){this.Hrh=
e}create(e){if(!this.Hrh)throw Error.argumentNull("ILanguageModelFactory");switch(e){case 1:return this.createInstance(new fw,this.Hrh.create(e));default:throw Error.notImplemented("WordCount");}}createInstance(e,t){if(!e)throw Error.argumentNull("IReadingTimeStrategy");if(!t)throw Error.argumentNull("LanguageModel");return new cF(e,t)}}Object(y.a)(dH,"ReadingTimeFactory",null,[1163]);var $I=d(400);class dF{constructor(){this.rvb=this.pvb=this.numWords=this.hhp=this.A3m=this.uJp=this.GZa=-1}}Object(y.a)(dF,
"ReadingTimeStats",null,[1235]);class eH{constructor(){this.o9=new dF;this.J8=new dF;this.mak=this.lak=!1}get sij(){return this.wkc(this.J8.numWords,this.o9.numWords,"WC",this.Z$c())}get noo(){return this.qNf(this.J8.GZa,this.o9.GZa,this.J8.numWords+this.J8.pvb+this.J8.rvb,this.o9.numWords+this.o9.pvb+this.o9.rvb,"RTSB")}get koo(){return this.qNf(this.J8.GZa,this.o9.GZa,this.J8.numWords+this.J8.pvb+this.J8.rvb,this.o9.numWords+this.o9.pvb+this.o9.rvb,"RTDB",!0)}get loo(){return this.CHm(this.J8.GZa,
this.o9.GZa,this.J8.numWords+this.J8.pvb+this.J8.rvb,this.o9.numWords+this.o9.pvb+this.o9.rvb)}get joo(){return this.Z$c()?WordEditorIntl.WordEditorStrings.L_ReadingTimeStatsDialogSelectionDescription:WordEditorIntl.WordEditorStrings.L_ReadingTimeStatsDialogDescription}gti(e,t,E,W){return W?this.dOg(e,t,E):this.tud(t,E)}wkc(e,t,E,W){return this.gti(e,t,E,W).toLocaleString()}rNf(e,t,E,W,ha,Ka,sb=!1){e=this.gti(e,t,ha,Ka);E=Ka?E:W;W=Math.floor(e/1440);ha=e%1440;e=Math.floor(ha/60);ha%=60;if(0<W)return e?
String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultComposite,String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultDay,W),String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultHour,e)):String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultDay,W);if(0<e)return ha?String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultComposite,String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultHour,e),String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultMin,
ha)):String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultHour,e);t=Ka&&60>t&&!sb?WordEditorIntl.WordEditorStrings.L_ReadingTimeResultMinWithoutAbbreviation:WordEditorIntl.WordEditorStrings.L_ReadingTimeResultMin;return!ha&&0<E?WordEditorIntl.WordEditorStrings.L_ReadingTimeLessThanOneMin:String.format(t,ha)}qNf(e,t,E,W,ha,Ka=!1){const sb=this.Z$c(),dc=this.rNf(e,t,E,W,ha,sb);e=sb?this.rNf(e,t,E,W,ha,!1):dc;t=Ka?WordEditorIntl.WordEditorStrings.L_ReadingTimeSelectionDialogBox:WordEditorIntl.WordEditorStrings.L_ReadingTimeSelectionStatusBar;
Ka=Ka?e:WordEditorIntl.WordEditorStrings.L_ReadingTimeStatusBar;Ka=sb?t:Ka;return sb?String.format(Ka,dc,e):String.format(Ka,dc)}CHm(e,t,E,W){const ha=this.rNf(e,t,E,W,"RTDT",this.Z$c(),!0);return this.Z$c()?String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeSelectionDialogBoxTitle,ha):this.qNf(e,t,E,W,"RTDT")}dOg(e,t,E){e=this.tud(e,E);return e>t?(this.mak||(this.mak=!0,z.ULS.sendTraceTag(40916112,338,15,"Sel>Total for {0}",E)),t):e}tud(e,t){0>e&&!this.lak&&(this.lak=!0,z.ULS.sendTraceTag(40916113,
338,15,"{0}<0",t));return Math.max(e,0)}Z$c(){return 0<this.J8.numWords+this.J8.pvb+this.J8.rvb}}Object(y.a)(eH,"ReadingTimeStatsFacade",null,[]);class Tw{}Tw.moo="ReadingTimeButton";Object(y.a)(Tw,"ReadingTimeConstants",null,[]);class lv{constructor(e,t,E,W,ha,Ka){this.tIc=this.b8b=!1;this.wYe=!0;this.CKd="";this.dAe=(sb,dc,xc)=>{if(1===xc)return this.bpc?32:8;sb=this.Vd.Vf("UserAction","Show Reading Time Dialog.");sb.start();dc=this.Ztj();if(!dc||0>dc.o9.GZa)return 8;this.n2.DCa&&z.ULS.sendTraceTag(40916104,
338,50,"Open reading time dialog with total reading time of {0}.",dc.o9.GZa);xc=new Pa.StandardDialog;xc.Gd=0;xc.Nna(dc.loo,String.format(dc.joo,dc.koo),null);sb.stop();return 32};this.uDe=(sb,dc,xc)=>{if(1===xc)return this.DCa?32:8;this.bpc?this.iUl():this.N_l();Cc.StaticActiveAppFrame.za().hJ({ShowReadingTime:"CheckboxModel"});return 32};this.Ese=(sb,dc,xc,Rc,md)=>{if(1===xc)return this.DCa?32:8;md[ya.a.On]=this.bpc;return 32};this.Dse=(sb,dc,xc,Rc,md)=>{if(1===xc)return 32;md[ug.a.Visible]=this.CKd!==
WordEditorIntl.WordEditorStrings.L_ReadingTimeHidden;md[ug.a.LabelText]=this.CKd;return 32};this.W0n=()=>{this.Itd()};this.nnj=()=>{this.Itd()};this.n2=e;this.wPc=t;this.HOe=W;this.IOe=E;this.xIb=ha;this.Vd=Ka;this.n2.d2k(this.W0n);this.wPc.DCa&&this.wPc.AQh(this.nnj);this.n2.AQh(this.nnj);this.Itd()}get nwf(){return!Yi.a.Q7}Wb(){const e=v.AFrameworkApplication.va;e.ra(Fa.a.dAe,na.a.view,this.dAe);e.fb(Fa.a.Dse,na.a.application,this.Dse,96);e.ra(Fa.a.uDe,na.a.application,this.uDe);e.fb(Fa.a.Ese,na.a.application,
this.Ese,96)}N_l(){this.DCa&&(this.$Qj(!0),this.Exe(!0),this.Itd())}iUl(){this.$Qj(!1);this.Exe(!1);this.Itd()}get bpc(){this.b8b||(this.wYe=this.HOe("WACReadingTimeEnabled",this.nwf),this.b8b=!0);return this.wYe}$Qj(e){this.wYe=e}get DCa(){return this.n2.DCa}get tH(){return null!=this.y4g?this.y4g:this.y4g=(()=>this.xIb())()}Ztj(){const e=new eH;this.t9j(e.o9,this.n2);this.wPc.DCa&&this.t9j(e.J8,this.wPc);return e}t9j(e,t){e.GZa=t.sAa.JJg;e.uJp=t.sAa.ePg;e.A3m=t.sAa.nUf;e.hhp=t.sAa.qHg;e.numWords=
t.Sz;e.pvb=t.RMb;e.rvb=t.VMb}Ycm(){this.n2.uFe();this.wPc.uFe();const e=this.Ztj();return this.bpc&&this.DCa?0>e.o9.GZa?WordEditorIntl.WordEditorStrings.L_ReadingTimeCalculating:e.noo:WordEditorIntl.WordEditorStrings.L_ReadingTimeHidden}Itd(){lv.Wk.Yd(()=>{this.F2o(this.n2)&&(z.ULS.sendTraceTag(40916106,338,50,"Reading time document stats: {0}",{["totalReadingTime"]:this.n2.sAa?this.n2.sAa.JJg:-1,["wordReadingTime"]:this.n2.sAa?this.n2.sAa.ePg:-1,["imageReadingTime"]:this.n2.sAa?this.n2.sAa.nUf:-1,
["tableReadingTime"]:this.n2.sAa?this.n2.sAa.qHg:-1,["words"]:this.n2.Sz,["images"]:this.n2.RMb,["tables"]:this.n2.VMb}),this.tIc=!0);const e=this.Ycm();this.tH&&e!==this.CKd&&(this.CKd=e,this.tH.nS(Tw.moo))},"RIA:URTD")}Exe(e){this.IOe("WACReadingTimeEnabled",e?"true":"false",xh.a.xMa)}F2o(e){return!this.tIc&&-1!==e.RMb&&-1!==e.Sz&&-1!==e.VMb}static get Wk(){return $I.a.instance}}Object(y.a)(lv,"ReadingTimeActor",null,[]);class ut{constructor(){this.LCID=1033;this.Zca=this.LL=-1;this.OAb=new fa.a;
this.Yab=new fa.a}}Object(y.a)(ut,"ReadingTimeInput",null,[]);class eF extends Sys.EventArgs{constructor(e){super();this.isEnabled=e}}Object(y.a)(eF,"ReadingTimeAvailabilityChangedEventArg",Sys.EventArgs,[]);class TC extends Sys.EventArgs{constructor(e){super();this.state=e}}Object(y.a)(TC,"ReadingTimeChangedEventArg",Sys.EventArgs,[]);class iq{constructor(e,t,E,W,ha,Ka){this.BKd=null;this.yCb=new Sw;this.wG=null;this.eBd=!1;this.sa=new ua.a;this.ftc=()=>{this.DCa?this.eB():this.fda();this.uFe();
this.Hmo(this.DCa)};this.Sga=()=>{this.uFe();this.Imo(this.yCb)};this.WK=e;this.hb=t;try{this.BKd=E.create(1)}catch(sb){this.BKd=null,z.ULS.sendTraceTag(40916107,338,15,"Error when retrieving the reading time algorithm: [message: {0}] [callstack: {1}].",sb.message,sb.stack)}this.Z2a=Ka.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.oMk=Ka.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.hLh=ha;W.execute(sb=>{this.wG=sb.getInstance(this.hLh);this.ftc(this,null)})}eB(){this.eBd||
(this.wG.Ygf(this.ftc),this.wG.hmb(this.Sga),this.eBd=!0)}fda(){this.eBd&&(this.wG.qBo(this.ftc),this.wG.Eue(this.Sga),this.eBd=!1)}qxm(){return this.WK.oBa(this.hb.Og)}uFe(){if(this.DCa){var e=new ut;e.LL=this.RMb;e.Zca=this.VMb;e.LCID=this.qxm();e.OAb=this.zMl;e.Yab=this.tvf;try{if(this.yCb=this.BKd.pNf(e),void 0===this.yCb||null===this.yCb)this.yCb=new Sw}catch(t){this.yCb=new Sw,z.ULS.sendTraceTag(40916108,338,15,"Error when retrieving reading time: [message: {0}] [callstack: {1}].",t.message,
t.stack)}}}Imo(e){this.sa.raiseEvent("rttek",new TC(e))}Hmo(e){this.sa.raiseEvent("rtac",new eF(e))}AQh(e){this.sa.addHandler("rttek",e)}d2k(e){this.sa.addHandler("rtac",e)}get sAa(){return this.yCb}get Sz(){return this.wG?this.wG.Sz:-1}get tvf(){return this.wG?this.wG.tvf:null}get zMl(){return this.wG?this.wG.AMl:null}get RMb(){return this.wG?this.wG.RMb:-1}get VMb(){return this.wG?this.wG.VMb:-1}get DCa(){return!!this.BKd&&this.XXa&&!(1===this.hLh&&!this.oMk)}get XXa(){return this.Z2a&&!!this.wG&&
this.wG.XXa}}Object(y.a)(iq,"ReadingTimeManager",null,[1159]);class UC{constructor(){this.b6e=this.W=null;this.a9=()=>{this.Uva()}}get name(){return"WordEditor.ReadingTime"}init(){if(this.bpc()){const e=Cc.StaticActiveAppFrame.za().ib;e.lCa?(e.pdb(this.a9),this.Uva()):e.Eja(this.a9);z.ULS.sendTraceTag(40916109,338,50,"Reading time package initialized.")}}bpc(){return v.AFrameworkApplication.K.$("ReadingTimeIsEnabled")&&v.AFrameworkApplication.K.$("EnableTimeToReadAsPremiumFeature")}dispose(){}wc(e){this.W=
e;this.W.ia("WordEditor.ReadingTime.Algorithm.ILanguageModelFactory",()=>new bF).ha();this.W.ia("WordEditor.ReadingTime.Algorithm.IReadingTimeFactory",()=>new dH(this.W.resolve("WordEditor.ReadingTime.Algorithm.ILanguageModelFactory"))).ha();this.W.ia("WordEditor.ReadingTime.IReadingTimeManager",()=>new iq(ob.a.instance.resolve("Box4.ILanguageReader"),Wg.a.instance,this.W.resolve("WordEditor.ReadingTime.Algorithm.IReadingTimeFactory"),this.W.Qa("WordEditor.WordCount.IWordCountManagerFactory"),0,ob.a.instance.resolve("Common.IAppSettingsManager"))).ha()}Uva(){S.App.jf?
this.b6e?z.ULS.sendTraceTag(40916111,306,15,"ReadingTimeActor is alreadyd initialized. Skipping feature bootstrapping."):(this.b6e=new lv(ob.a.instance.resolve("WordEditor.ReadingTime.IReadingTimeManager"),new iq(ob.a.instance.resolve("Box4.ILanguageReader"),Wg.a.instance,this.W.resolve("WordEditor.ReadingTime.Algorithm.IReadingTimeFactory"),this.W.Qa("WordEditor.WordCount.IWordCountManagerFactory"),1,ob.a.instance.resolve("Common.IAppSettingsManager")),xh.a.vOa,xh.a.Bfa,()=>ob.a.instance.Oa("WordEditor.IStatusBarUser"),
ob.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")),this.b6e.Wb()):z.ULS.sendTraceTag(40916110,306,15,"TheNotebookManager is null. Reading Time will not be available.")}static main(){x.a.instance.Jc(new UC)}}Object(y.a)(UC,"ReadingTimePackage",null,[0,1]);class fH{constructor(){this.jl=null}rIa(e,t){this.jl||(this.jl={});this.jl[t]||(this.jl[t]=0);this.jl[t]+=e}getData(){return this.jl}reset(){this.jl=null}}Object(y.a)(fH,"MultiSumDataAggregator",null,[1021]);class fF extends Sys.EventArgs{constructor(){super();
this.pC=null}}Object(y.a)(fF,"DocumentSignalReadyEventArgs",Sys.EventArgs,[]);class Wr extends Sys.EventArgs{constructor(){super()}}Object(y.a)(Wr,"SignalAddedToBatchWindowEventArgs",Sys.EventArgs,[]);var $z;(function(e){e[e.jiq=0]="rest";e[e.add=1]="add";e[e.Oob=2]="edit";e[e.document=3]="document";e[e.IYp=4]="editorAccept"})($z||($z={}));Object(y.b)("SignalCategory",$z);class Wy extends Sys.EventArgs{constructor(){super();this.u7c=this.bQ=0}}Object(y.a)(Wy,"SignalReadyEventArgs",Sys.EventArgs,[]);
class aA{constructor(){this.startTime=null;this.bQ=this.Kzf=0;this.values=null;this.u7c=0}get endTime(){return this.startTime.getTime()+this.Kzf}}Object(y.a)(aA,"SignalSummary",null,[]);class Ux{constructor(e,t,E,W,ha=null){this.Waf=null;this.Dhb=0;this.kFb=this.xFc=null;this.sa=new ua.a;this.epl=()=>{const Ka=this.dF(),sb=this.AJf(this.kFb,Ka);sb>this.eMe&&(this.Dhb&&this.jIi(0,Ka,sb),this.kFb=Ka)};this.Gb=e;this.eMe=t;this.Yok=E;this.aJk=W;this.HBh={};this.SQe={};this.vMd=new vb.a;this.Ixd=new fH;
this.OLe=new fa.a;this.LCd=!1;ha||(ha=()=>new Date);this.dF=ha}bxb(e){3===e.bQ&&1!==e.kza?z.ULS.sendTraceTag(590401570,389,10,"Signal Aggregator: Signals at the document level should be of aggregation type Last. SignalId{0}",e.pC):(z.ULS.sendTraceTag(590401571,389,50,"Signal Aggregator: Registered a signal type: SignalId: {0}, SignalCategory: {1}, SignalDescription: {2}, AggregationType: {3}",e.pC,e.bQ,e.Ceb,e.kza),this.HBh[e.pC]=e)}init(e=null){e||(e=this.dF());this.Dhb=0;this.kFb=this.xFc=e;this.LCd=
!0}lHi(){if(!this.LCd)return z.ULS.sendTraceTag(590401601,389,10,"Signal Aggregator: Must call Init(timestamp) to initialize the aggregator first."),null;const e=new fa.a;e.add(Object.assign(new aA,{bQ:3,values:this.SQe}));for(const t of this.vMd){const E=Object.assign(new aA,{bQ:t.key,values:t.value.getData()});e.add(E)}return e}Exi(){return this.LCd?Object.assign(new aA,{bQ:3,values:this.SQe}):(z.ULS.sendTraceTag(574419076,389,10,"Signal Aggregator: Must call Init(timestamp) to initialize the aggregator first."),
null)}track(e){if(this.LCd){var t=this.HBh[e.pC];if(!t)z.ULS.sendTraceTag(590401603,389,10,"Signal Aggregator: Recieved a signal that was never registered: {0}",e.pC);else if(1===t.kza)this.SQe[e.pC]=e.value,this.sa.raiseEvent("DocumentSignalReadyEventKey",Object.assign(new fF,{pC:e.pC}));else if(!t.kza){this.oZk(e,t.bQ);const E=this.AJf(this.kFb,e.timestamp);(t.bQ!==this.Dhb||E>this.eMe)&&this.jIi(t.bQ,e.timestamp,E);this.kFb=e.timestamp;this.Ixd.rIa(e.value,e.pC);this.P1l()}}else z.ULS.sendTraceTag(590401602,
389,10,"Signal Aggregator: Must call Init(timestamp) to initialize the aggregator first.")}oZk(e,t){this.vMd.mb(t)||this.vMd.Z(t,new fH);this.vMd.J(t).rIa(e.value,e.pC)}AJf(e,t){return+t-+e}P1l(){this.Waf||(this.Waf=new kh.a(4,2,this.aJk,this.epl,193),this.Gb.Zb(this.Waf))}jIi(e,t,E){E>this.eMe&&e&&(this.GWd(0,t),this.Ixd.reset(),this.xFc=this.kFb,this.Dhb=0);E=Object.assign(new Wy,{bQ:this.Dhb,u7c:e});this.pul(e,t);this.Ixd.reset();this.xFc=t;this.Dhb=e;this.sa.raiseEvent("SignalReadyEventKey",E)}GWd(e,
t){this.Dhb&&(t=this.kFb);e=Object.assign(new aA,{bQ:this.Dhb,values:this.Ixd.getData(),startTime:this.xFc,Kzf:this.AJf(this.xFc,t),u7c:e});this.OLe.add(e);t=new Wr(e);this.sa.raiseEvent("SignalAddedToBatchWindowEventKey",t);z.ULS.sendTraceTag(590401605,389,50,"New Signal Bucket Added. SignalCategory: {0}, Values: {1}, StartTime: {2}, Duration (ms): {3}, IncomingCategory: {4}",$z[e.bQ],e.values,e.startTime,e.Kzf,$z[e.u7c]);return e.endTime}pul(e,t){for(e=this.GWd(e,t)-this.Yok;this.OLe.J(0).endTime<
e;)this.OLe.removeAt(0)}pQh(e){this.sa.addHandler("SignalReadyEventKey",e)}WAo(e){this.sa.removeHandler("SignalReadyEventKey",e)}YPh(e){this.sa.addHandler("DocumentSignalReadyEventKey",e)}htg(e){this.sa.removeHandler("DocumentSignalReadyEventKey",e)}}Object(y.a)(Ux,"SignalAggregator",null,[1342]);var br=d(446),aJ=d(321),xj=d(133),bA=d(229),gH=d(1850);class qs{constructor(e,t=1){this.pC=e;this.timestamp=new Date;this.value=t}}Object(y.a)(qs,"SignalEntry",null,[]);class wB{constructor(e,t,E,W,ha,Ka,
sb,dc,xc,Rc,md,ud,Ud){this.DDk=dc;this.Aok=xc;this.g_=Rc;this.kbl=md;this.rHa=ud;this.$d=Ud;this.zQ=new rC.a;this.Qih=0;this.LI=()=>{const Id=new qs(lo.a.q1h);this.i6.track(Id)};this.Hma=()=>{const Id=new qs(lo.a.zrj);this.i6.track(Id)};this.Mvb=()=>{const Id=new qs(lo.a.Grj);this.i6.track(Id)};this.Sga=(Id,Ee)=>{Id=new qs(lo.a.wordCount,Ee.state.wordCount);this.i6.track(Id);Id=new qs(lo.a.dV,Ee.state.dV);this.i6.track(Id)};this.JUn=(Id,Ee)=>{Ee.action==aJ.b.Apply&&(Id=new qs(this.vcj(Ee.category),
1),this.i6.track(Id))};this.GZn=(Id,Ee)=>{Ee.action==gH.a.bqc&&(Id=new qs(this.vcj(Ee.category),1),this.i6.track(Id))};this.s3n=()=>{const Id=new qs("E_TextPrediction",1);this.i6.track(Id)};this.Ajj=()=>{const Id=new qs("E_AutoCorrect",1);this.i6.track(Id)};this.i6=e;this.Xm=t;this.wu=E;this.Ns=W;this.ga=ha;this.Re=Ka;this.Ga=sb;this.eB()}async eB(){var e;const t=this.Xm.Ve(12);t.Zt(this.Hma);t.Bw(this.Mvb);this.wu.hmb(this.Sga);this.Ns.addHandler(bA.a.uEe,this.LI);this.$d.oZf()&&(this.d6m(),this.ga.P0(this));
this.Ga.$("SignalAggregatorCritiqueCountIsEnabled")&&yu.a.Pl().then(()=>{this.Re.nb(this,br.a.getTypeName())});await (null===(e=this.rHa)||void 0===e?void 0:e.b0f())&&(this.Aok.execute(E=>E.q0k(this.JUn)),this.DDk.execute(E=>E.Y0k(this.GZn)),xj.a.T1k(this.s3n),this.g_.ugf(this.Ajj),this.kbl.ugf(this.Ajj))}l8(){}j8(e){2===e.behavior&&this.zQ.contains(e.actionId)&&(this.Qih++,e=new qs(lo.a.l4d,this.Qih),this.i6.track(e))}lD(e){e&&e.content&&e.annotationType===br.a.getTypeName()&&(e=e.content,e=new qs(e.categoryName,
e.count),this.i6.track(e))}vcj(e){switch(e){case "Spelling":case "Grammar":return"E_Spelling_Grammar";case "Similarity":return"E_Similarity";default:return"E_Refinements"}}d6m(){this.zQ.add(wb.a.font);this.zQ.add(wb.a.oC);this.zQ.add(wb.a.p3);this.zQ.add(wb.a.C4);this.zQ.add(wb.a.hE);this.zQ.add(wb.a.bold);this.zQ.add(wb.a.kA);this.zQ.add(wb.a.underline);this.zQ.add(wb.a.strikethrough);this.zQ.add(wb.a.subscript);this.zQ.add(wb.a.superscript);this.zQ.add(wb.a.J6a);this.zQ.add(wb.a.NIa);this.zQ.add(wb.a.OIa);
this.zQ.add(wb.a.Hza);this.zQ.add(wb.a.K6a);this.zQ.add(wb.a.vY);this.zQ.add(wb.a.Jca);this.zQ.add(wb.a.ax);this.zQ.add(wb.a.Gva);this.zQ.add(wb.a.HT)}}Object(y.a)(wB,"SignalAggregatorEventCoordinator",null,[65,1161]);class mv{constructor(){this.pC=null;this.bQ=0;this.Ceb=null;this.kza=0}}Object(y.a)(mv,"SignalDef",null,[]);class Vx{constructor(){this.W=null}get name(){return"WordEditor.SignalAggregator"}wc(e){this.W=e;e=this.W.resolve("Common.IAppSettingsManager");const t=e.ic("SignalAggregatorBucketThresholdMilliseconds",
1E4),E=e.ic("SignalAggregatorBatchWindowMilliseconds",12E4),W=e.ic("SignalAggregatorPollingIntervalMilliseconds",6E3);this.W.ia("WordEditor.SignalAggregator.SignalAggregator",()=>new Ux(v.AFrameworkApplication.mc,t,E,W)).as("WordEditor.SignalAggregator.ISignalAggregator").ha()}init(){if(S.App.jf){var e=S.App.jf.Il;if(e){var t=this.W.resolve("WordEditor.SignalAggregator.SignalAggregator");this.Uvo(t);t.init();var E=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0);new wB(t,
e,E,this.W.resolve("Box4.EditStateEventManager"),v.AFrameworkApplication.va,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),v.AFrameworkApplication.K,this.W.Qa("WordEditor.CanvasContextual.LegacyProofingIntentProvider"),this.W.Qa("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"),this.W.resolve("Box4.IAutoCorrectScheduler"),this.W.resolve("Box4.AutocorrectActionExecutor"),this.W.Oa("WordEditor.EditorUpsell.IPremiumPreviewGate"),this.W.resolve("WordEditor.Designer.IDesignerControl"))}else z.ULS.sendTraceTag(590401569,
306,15,"Graph is null. Signal Aggregator will not be available")}else z.ULS.sendTraceTag(590401568,306,15,"TheNotebookManager is null. Signal Aggregator will not be available")}Uvo(e){let t=Object.assign(new mv,{pC:lo.a.q1h,bQ:2,Ceb:"The number of characters that have been typed",kza:0});e.bxb(t);t=Object.assign(new mv,{pC:lo.a.zrj,bQ:2,Ceb:"The number of paragraphs that have been added",kza:0});e.bxb(t);t=Object.assign(new mv,{pC:lo.a.Grj,bQ:2,Ceb:"The number of paragraphs that have been deleted",
kza:0});e.bxb(t);t=Object.assign(new mv,{pC:lo.a.l4d,bQ:3,Ceb:"The total count of font formatting changes that have been applied",kza:1});e.bxb(t);t=Object.assign(new mv,{pC:lo.a.wordCount,bQ:3,Ceb:"The latest word count of the document",kza:1});e.bxb(t);t=Object.assign(new mv,{pC:lo.a.dV,bQ:3,Ceb:"The latest paragraph count of the document",kza:1});e.bxb(t);if(v.AFrameworkApplication.K.$("SignalAggregatorCritiqueCountIsEnabled"))for(var E=0;E<lo.a.Wuf.length;E++)t=Object.assign(new mv,{pC:lo.a.Wuf[E],
bQ:3,Ceb:String.format("The latest {0} critique count of the document",lo.a.Wuf[E]),kza:1}),e.bxb(t);for(E=0;E<lo.a.Ihc.length;E++)t=Object.assign(new mv,{pC:lo.a.Ihc[E],bQ:4,Ceb:String.format("Accepted {0} count",lo.a.Ihc[E]),kza:0}),e.bxb(t)}dispose(){}static main(){x.a.instance.Jc(new Vx)}}Object(y.a)(Vx,"SignalAggregatorPackage",null,[0,1]);class Xy{}Object(y.a)(Xy,"ApplicationProperties",null,[]);class VC{}Object(y.a)(VC,"EnterpriseUserInfo",null,[]);class WC{}Object(y.a)(WC,"FeatureGates",null,
[]);class cA{constructor(e,t,E=!0){this.tJg=9E5;this.vJg=3E5;this.E7f=null;this.ubj="";this.C7f=0;this.qob=Date.now;this.Tba=e;this.rYa=t;E&&this.gHf()}SKm(){const e=this.qob();if(e<this.C7f+this.tJg)return e>this.C7f+this.vJg&&this.gHf(),this.ubj;this.gHf();return""}gHf(){this.E7f=this.E7f||new Promise(e=>{this.TKm().then(t=>{this.ubj=t;this.C7f=this.qob();this.E7f=null;e(t)})})}TKm(){return this.rYa&&this.rYa.length?new Promise(e=>{this.Tba.wV("SmartLookup",this.rYa).then(t=>{t.IsSuccess?t.Token||
(e(""),z.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(z.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+t.ErrorCode+": "+t.ErrorMessage),e(""));e(t.Token)}).catch(t=>{t=qe.c(t);z.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+t);e("")})}):(z.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(y.a)(cA,"SmartLookupAuthenticationManager",
null,[1608]);class dA{static iLm(){switch(v.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")?"EDOG":v.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")?"PROD":v.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")?"INT":dA.Vxi()){case "INT":return"WAC.INT.URL";case "EDOG":return"WAC.EDOG.URL";default:return"WAC.PROD.URL"}}static Vxi(){switch(Object(Ne.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(v.AFrameworkApplication.K){let e=
v.AFrameworkApplication.K.kb("UserPrincipalName");e=Qd.a.xh(e);const t=v.AFrameworkApplication.K.jy("SmartLookupINTEnabledForSKITeam")?v.AFrameworkApplication.K.iD("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(t,e)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static zKm(){switch(v.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":v.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")?"PROD":v.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")?
"INT":dA.Vxi()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(y.a)(dA,"Utils",null,[]);class rs{constructor(e){z.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Fub=v.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");this.PGn=v.AFrameworkApplication.K.kb("SmartLookupApprovedOriginPattern");
this.rYa=v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.U7f=A.a.rU(v.AFrameworkApplication.K.kb("AppCatalogUrl")||"");this.oj=new WC;this.oj.EnableAllTabV2=!0;this.oj.EnableIntentService=!0;this.oj.EnableInDocumentSearch=v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch");this.oj.EnableLocalSearch=v.AFrameworkApplication.K.$("SmartLookupEnableLocalSearch");this.oj.IntentServiceEndpoint=dA.zKm();this.fHn=new cA(e,this.rYa)}get approvedOriginPattern(){return this.PGn}dim(){const e=
new Xy;e.anid="";e.applicationVersion=v.AFrameworkApplication.buildVersion;e.appCorrelationId=Rd.a.create().toString();e.themePlatform=rs.PEp;e.lcid=v.AFrameworkApplication.lcid;e.launchUtcTime=(new Date).toUTCString();e.featureGates=this.oj;var t=mb.a.Cg(v.AFrameworkApplication.lcid);t=t?t.name:null;e.market=this.Iwi(t);e.uiLanguage=t;e.sessionId=v.AFrameworkApplication.userSessionId;e.themeId=0;e.parentalControl=rs.Rjg;const E=new VC;E.CountryCode=this.Iwi(t);E.ServiceEndpoint=this.rYa;E.IsGoLocal=
!1;E.IsEnabled=this.Fub;E.IsEnterpriseEnabled=this.Fub;E.TenantRoot=this.U7f;e.enterpriseUserInfo=E;e.accessToken=this.fHn.SKm();return e}Iwi(e){e=e.split("-");return e[e.length-1]}}rs.PEp="web";rs.Rjg="yes";Object(y.a)(rs,"SmartLookupManager",null,[1569]);class gF{constructor(){this.W=null}get name(){return"Common.App.SmartLookup"}wc(e){this.W=e;z.ULS.sendTraceTag(41521356,1313,50,"SmartLookupPackage - Initialize");this.W.register(1569,"Common.App.SmartLookup.ISmartLookupManager").ha().Rd(()=>new rs(this.W.resolve("Common.App.OAuth.IOAuthManager")))}dispose(){}}
Object(y.a)(gF,"SmartLookupPackage",null,[0,1]);class xB{}Object(y.a)(xB,"Selection",null,[]);class hH{}Object(y.a)(hH,"ConfigurationProvider",null,[]);var iH=d(309);class jH{static Gwc(e){const t=new iH.a;t.name="Office.Insights.SmartLookup.LaunchPane";t.samplingPolicy=2;const E=[];(e=Sb.a.bba("AppCorrelationId",e,2))&&Array.add(E,e);t.dataFields=E;cc.a.sendActivityEvent(t)}}Object(y.a)(jH,"LoggingUtils",null,[]);var XC=d(1811),cr=d(1962);class vt{constructor(e,t,E,W,ha,Ka){this.v6c=(sb,dc,xc)=>
{if(2!==xc)return 32;this.nTb()&&this.Ch.unb(vt.appId);return 32};this.lyc=(sb,dc,xc)=>{if(2!==xc)return 32;sb=(new cr.a).getSelectedText();sb=Object.assign(new xB,{neighborhood:sb.neighborhood,mentionStart:sb.mentionStart,mentionLength:sb.mentionLength});this.o_b=Object.assign(new XC.a,{selection:sb,entryPoint:0});return this.nbd()};this.GLa=(sb,dc,xc)=>{if(2!==xc)return 32;sb=(new cr.a).getSelectedText();sb=Object.assign(new xB,{neighborhood:sb.neighborhood,mentionStart:sb.mentionStart,mentionLength:sb.mentionLength});
this.o_b=Object.assign(new XC.a,{selection:sb,entryPoint:10});return this.nbd()};this.uba=(sb,dc,xc,Rc,md)=>{if(1===xc)return aq.SessionStatusManager.instance.Gk?8:32;sb=md.CommandValueId;try{this.o_b=qe.a(sb)}catch(ud){return z.ULS.sendTraceTag(41521359,1313,15,"SmartLookup application interface [{0}] is not in proper format",sb),8}return this.nbd()};this.Xpd=(sb,dc,xc,Rc,md)=>{if(1===xc)return 32;try{this.o_b=md}catch(ud){return z.ULS.sendTraceTag(41694411,1313,15,ud.message),8}return this.nbd()};
this.Wpd=(sb,dc,xc,Rc,md)=>{if(1===xc)return 32;if(!md)return 8;sb=md.query?md.query:"";sb=Object.assign(new xB,{neighborhood:sb,mentionStart:0,mentionLength:sb.length});this.o_b=Object.assign(new XC.a,{selection:sb,entryPoint:0});return this.nbd()};this.ga=e;this.Ch=t;this.dcj=E;this.o_b=null;this.Gcd=new Aa.a;this.sourceLocationOverrideResourceId=dA.iLm();this.Gcd.sourceLocationOverrideResourceId=this.sourceLocationOverrideResourceId;this.Gcd.xS=CommonUIStrings.L_SmartLookupPaneTitle;this.Gcd.taskPaneWidth=
400;this.fbj=ha;this.isFirstLaunch=!0;e=Object.assign(new hH,{channelId:"SmartLookup",approvedOriginPattern:this.dcj.approvedOriginPattern});this.DPi=SmartLookupHostRuntime.setup(e,[Ka])}Ivo(){z.ULS.sendTraceTag(41521357,1303,50,"Registering SmartLookup ribbon button.");this.ga.ra(Fa.a.lyc,I.a.frame,this.lyc);this.ga.ra(Fa.a.v6c,I.a.frame,this.v6c);this.ga.ra(M.a.uba,I.a.frame,this.uba);this.ga.ra(M.a.GLa,I.a.frame,this.GLa);this.ga.ra(M.a.Xpd,I.a.frame,this.Xpd);this.ga.ra(M.a.Wpd,I.a.frame,this.Wpd);
this.Fzo()}Fzo(){this.ga.mna("mso_smartLookup",Fa.a.lyc,I.a.frame,this.lyc,e=>{Cc.StaticActiveAppFrame.za().cBc(e,Object(ib.a)(this.fbj,this.fbj.qPb,"getCommandById"))});this.ga.mna("mso_smartLookup",Fa.a.v6c,I.a.frame,this.v6c,()=>{});this.ga.mna("mso_smartLookup",M.a.uba,I.a.frame,this.uba,()=>{});this.ga.mna("mso_smartLookup",M.a.GLa,I.a.frame,this.GLa,()=>{});this.ga.mna("mso_smartLookup",M.a.Xpd,I.a.frame,this.Xpd,()=>{});this.ga.mna("mso_smartLookup",M.a.Wpd,I.a.frame,this.Wpd,()=>{})}hyc(){if(!this.nTb()){const t=
this.dcj.dim();var e={};t.applicationName=vt.sdo;t.isFirstLaunch=this.isFirstLaunch;t.themeId=5;e[vt.b$o]=this.o_b;e[vt.m6k]=t;this.Gcd.gS=e;e=v.AFrameworkApplication.K.$("SmartLookupSdxFlowIsEnabled");this.Ch.B4(vt.appId,this.Gcd,e);this.isFirstLaunch=!1;jH.Gwc(t.appCorrelationId)}this.DPi.onPaneStateChanged(!0)}nTb(){return this.Ch.CU(vt.appId+"."+this.sourceLocationOverrideResourceId)}nbd(){this.nTb()?this.DPi.search(this.o_b):this.hyc();return 32}}vt.m6k="AppProperties";vt.sdo="Word";vt.b$o="SmartLookupApplicationInterface";
vt.appId="FA000000006";Object(y.a)(vt,"SmartLookupAddIn",null,[1157]);class Yy{getId(){return"SerpletExecutor"}}Yy.POi="FA000000012";Yy.queryPrefix="AssetID=";Object(y.a)(Yy,"BaseSerpletExecutor",null,[1191,1192]);class Ar extends Yy{constructor(e){super();this.o2=e}openHelpTaskPane(e){const t={};t.query=Yy.queryPrefix+e;e=new Aa.a;e.gS=t;this.o2.B4(Yy.POi,e)}}Object(y.a)(Ar,"WordSerpletExecutor",Yy,[]);class Zy extends gF{constructor(){super();this.zQa=null}get name(){return"WordEditor.SmartLookup"}init(){Zy.isFeatureEnabled()&&
this.Uva()}wc(e){super.wc(e);this.zQa=e;Zy.isFeatureEnabled()&&(this.zQa.ia("WordEditor.SmartLookup.WordSerpletExecutor",()=>new Ar(this.zQa.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"))).as("Common.App.SmartLookup.ISerpletExecutor").ha(),this.zQa.ia("WordEditor.SmartLookup.SmartLookupManager.ISmartLookupAddIn",()=>new vt(v.AFrameworkApplication.va,this.zQa.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.zQa.resolve("Common.App.SmartLookup.ISmartLookupManager"),
this.zQa.resolve("Common.IAppSettingsManager"),this.zQa.resolve("Common.IExternalUICommandDefinitionMapping"),this.zQa.resolve("Common.App.SmartLookup.ISerpletExecutor"),Cc.StaticActiveAppFrame.za().afb)).ha())}Uva(){z.ULS.sendTraceTag(41497102,1303,50,"SmartLookup package initialized.");this.zQa.resolve("WordEditor.SmartLookup.SmartLookupManager.ISmartLookupAddIn").Ivo()}static main(){Zy.isFeatureEnabled()&&x.a.instance.Jc(new Zy)}static isFeatureEnabled(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")}}
Object(y.a)(Zy,"WordEditorSmartLookupPackage",gF,[]);class kH{constructor(e,t,E,W,ha,Ka){this.Lgb=!1;this.Qze=(sb,dc,xc)=>2!==xc?32:this.jRc&&this.B5a?this.B5a.nTb?this.jRc.v0m(xc):this.jRc.v8o(xc):16;this.Tuc=(sb,dc,xc,Rc,md)=>this.jRc?this.jRc.Tuc(sb,dc,xc,Rc,md):16;this.ga=e;this.jRc=t;this.GHb=E;this.B5a=W;this.vbc=ha;this.UAk=Ka}register(e=!1){if(this.Lgb)z.ULS.sendTraceTag(51667738,3011,15,"Attempted to register Transcription add-in commands more than once.");else{this.Lgb=!0;z.ULS.sendTraceTag(51667739,
3011,50,"Registering Transcription add-in commands.");this.vbc&&(this.UAk?this.vbc.t8o():this.vbc.u8o());var t={},E=new fa.a;t.Transcription="ButtonModel";E.add("btnWordTranscription");this.ga&&(this.ga.ra(Fa.a.Qze,I.a.frame,this.Qze),this.ga.fb(Fa.a.Tuc,na.a.view,this.Tuc,96));e&&this.GHb&&this.GHb.BPa(t)}}}Object(y.a)(kH,"TranscriptionAddInCommands",null,[1348]);class cp{constructor(e,t){this.nHb=e;this.ey=t}oAm(e,t){Object(zg.a)(2,()=>this.ey.y9a(),!0,()=>!0).then(E=>{e[cp.zke]=E;t(e)}).catch(E=>
{z.ULS.sendTraceTag(528859138,3011,10,"GET Call for Transcription File Upload Minutes Failed With Exception: {0}",E)})}nAm(e,t){this.nHb.y9a().then(E=>{e[cp.zke]=E;t(e)})}GXk(e,t,E){Object(zg.a)(2,()=>this.ey.BSc(e[cp.Rle]),!1,()=>!0).then(()=>{Object(zg.a)(2,()=>this.ey.y9a(),!0,()=>!0).then(W=>{this.ey.uOb();t[cp.zke]=W;E(t)}).catch(W=>{z.ULS.sendTraceTag(528859139,3011,10,"GET Call for Transcription File Upload Minutes Failed With Exception: {0}",W)})}).catch(W=>{z.ULS.sendTraceTag(528859140,3011,
10,"ADD Call for Transcription File Upload Minutes Failed With Exception: {0}",W)})}FXk(e,t,E){this.nHb.BSc(e[cp.Rle]).then(()=>{this.nHb.y9a().then(W=>{this.nHb.uOb();t[cp.zke]=W;E(t)})})}KXm(e,t){return new Promise((E,W)=>{const ha={};switch(e){case cp.mAm:Object(zg.b)()?this.oAm(ha,E):this.nAm(ha,E);break;case cp.CXk:if(void 0===t[cp.Rle]||null===t[cp.Rle]){W(cp.wUi);break}Object(zg.b)()?this.GXk(t,ha,E):this.FXk(t,ha,E);break;case cp.iAp:if(void 0===t[cp.VHg]||null===t[cp.VHg]){W(cp.wUi);break}E=
t[cp.VHg];!isNaN(E)&&isFinite(E)&&xh.a.set("TeachingUIShowCount",E.toString());break;default:W(cp.qtp)}})}}cp.mAm="GetMonthlyMinutesUsed";cp.zke="monthlyMinutesUsed";cp.CXk="AddMinutesUsed";cp.Rle="numMinutesUsed";cp.iAp="UpdateTeachingUIShowCount";cp.VHg="teachingUIShowCountNew";cp.wUi="invalidArgs";cp.qtp="unsupportedRequestType";Object(y.a)(cp,"TranscriptionAddInRequestHandler",null,[1347]);class Pt{constructor(e,t,E){this.sessionId=e;this.locale=E;this.Ch=t;this.IEb=this.lZm=!1}get Toc(){return this.IEb}set Toc(e){this.IEb=
e}get nTb(){return this.Ch?this.Ch.CU(yh.vwc):!1}}Object(y.a)(Pt,"TranscriptionAddInState",null,[]);class Wx{t8o(){appChrome.showTranscribeAsSplitButton()}u8o(){appChrome.showTranscribeAsStandaloneGroup()}pTf(){appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShowHideTranscriptionPane",!0))}}Object(y.a)(Wx,"TranscriptionButtonEnabler",null,[1346]);class $y{constructor(e){this.sOb=t=>{this.TXe=t.isEnabled};this.TXe=this.e8b=!1;this.initialized=e?new Promise((t,E)=>{e.execute(W=>{this.e8b=
W.isFreemiumUpsellEnabled();const ha=W.isFeatureEnabled(zs.a.s2j,!1);W.hva(zs.a.s2j,this.sOb);this.o7m(ha).then(()=>{t(!0)}).catch(Ka=>{z.ULS.sendTraceTag(555054277,3011,10,"Failed to initialize transcription licensed user using isFeatureEnabled "+Ka.toString());E("Failed to initialize transcription licensed user")})})}):Promise.resolve(!0)}get isFreemiumUpsellEnabled(){return this.e8b}get a_f(){return this.TXe}o7m(e){return new Promise(t=>{e.then(E=>{this.TXe=E?!0:!1;t(!0)})})}}Object(y.a)($y,"TranscriptionLicenseState",
null,[]);class ou{constructor(e){this.G7c=0;this.ey=e}uOb(){return this.y9a().then(e=>{this.G7c=e}).catch(e=>{z.ULS.sendTraceTag(587310852,3011,10,"Failed to get initial monthly minutes used: "+e.toString())})}y9a(){return new Promise((e,t)=>{this.ey?this.ey.QQb(ou.yPf,0).continueWith(E=>{E.ij?t(E.vk):e(parseInt(E.result))},8):e(0)})}BSc(e){return new Promise((t,E)=>{this.ey?this.ey.Lva(ou.Xwg,e.toString()).continueWith(W=>{W.ij?(z.ULS.sendTraceTag(540375233,3011,10,"SaveTranscriptionMinutes: TaskFaulted. ExceptionDetails:{0} Stack:{1}",
W.vk,W.vk.stack),E(W.vk)):t(null)},8):t(null)})}}ou.yPf="getTranscriptionQuota";ou.Xwg="saveTranscriptionQuota";Object(y.a)(ou,"TranscriptionMonthlyQuotaManager",null,[]);class lH{constructor(){this.Gbf="";this.kRc="Office.Voice.Transcription."}KOo(e){this.Gbf=Rd.a.create().toString();e=[this.hZd(),this.Hai(!1)].concat(this.jai(e));cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:this.kRc+"PaneOpened",dataFields:e}))}lOo(e){cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:this.kRc+"PaneOpened",
dataFields:[this.hZd(),this.Hai(!0),this.uIl(e)]}))}LOo(e){cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:this.kRc+"PaneOpened",dataFields:[this.hZd(),this.vIl(e)]}))}IOo(e){this.yPo(e)}ROo(e,t,E){cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:this.kRc+"Preinitialization",dataFields:[Object.assign(new yi.a,{name:"DurationMs",int64:e}),Object.assign(new yi.a,{name:"IsRibbonButtonDisabled",bool:t}),Object.assign(new yi.a,{name:"DisabledReason",string:E})]}))}yPo(e){const t=this.jai(e);t.push(this.tIl(e),
this.hZd());cc.a.sendTelemetryEvent(Object.assign(new cg.a,{name:this.kRc+"PaneClosed",dataFields:t}))}tIl(e){return Object.assign(new yi.a,{name:"PaneOpenDurationInSecs",string:e.PaneOpenDurationInSecs})}hZd(){return Object.assign(new yi.a,{name:"TranscriptionSessionId",string:this.Gbf})}Hai(e){return Object.assign(new yi.a,{name:"PaneOpenedFinalEvent",bool:e})}vIl(e){return Object.assign(new yi.a,{name:"PaneOpenSucceeded",bool:e})}uIl(e){return Object.assign(new yi.a,{name:"IsLicensedUser",bool:e})}jai(e){return[Object.assign(new yi.a,
{name:"DeviceNetDownLinkInMbPerSec",double:e.DeviceNetDownLink}),Object.assign(new yi.a,{name:"EffectiveNetworkType",string:e.EffectiveNetworkType}),Object.assign(new yi.a,{name:"IsOnline",bool:e.IsOnline})]}}Object(y.a)(lH,"TranscriptionTelemetryHelper",null,[1156]);var bJ=d(1223);class YC{constructor(){this.Olb=this.bJb=this.vbc=this.Pya=this.q5a=this.vHd=this.W=null;this.a9=()=>{Cc.StaticActiveAppFrame.za().ib.pdb(this.a9);this.uuj()};this.vbc=new Wx}get name(){return"WordEditor.Transcription"}init(){if(S.App.uad()){const e=
Cc.StaticActiveAppFrame.za().ib;e.lCa?this.uuj():e.Eja(this.a9);z.ULS.sendTraceTag(51667727,3011,50,"Transcription package initialized.")}}dispose(){}uGi(){const e=v.AFrameworkApplication.K.$("IsAnonymousUser"),t=v.AFrameworkApplication.K.$("IsRoamingServiceEnabled");return e||!t?null:this.W.resolve("Box4.IRoamingServiceRequestManager")}wc(e){this.W=e;if(S.App.uad()){const t=this.W.resolve("Box4.ILanguageReader").oBa(this.W.resolve("Box4.ISelectionManager").Og);this.W.ia("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState",
()=>new Pt(v.AFrameworkApplication.userSessionId,this.W.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),mb.a.Cg(t).O4d)).as("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState").ha();this.vHd=new ou(this.uGi());this.bJb=new bJ.a(this.uGi());let E;E=new cp(this.vHd,this.bJb);this.q5a=new lH;this.Pya=new $y(this.W.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"));this.Olb=e.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager");this.W.ia("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn",
()=>new yh(this.W.resolve("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState"),this.W.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.W.resolve("WordEditor.Extension.DocumentProperties"),this.q5a,v.AFrameworkApplication.K,this.vHd,E,this.Pya,this.bJb,this.Olb)).as("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn").ha();this.W.ia("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddInCommands",()=>{var W;return new kH(v.AFrameworkApplication.va,this.W.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn"),
this.W.resolve("Common.IRibbonButtonUpdater"),this.W.resolve("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState"),null!==(W=this.vbc)&&void 0!==W?W:new Wx,Lh.a.zXi()&&Lh.a.AXi())}).as("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddInCommands").ha();z.ULS.sendTraceTag(51667730,3011,50,"Transcription package configured.")}}uuj(){if(S.App.uad()){var e=Date.now();this.EZb(!0);var t=[];var E=Object(zg.b)()?this.bJb.uOb().then(()=>({name:"QuotaCheck",succeeded:!0})):this.vHd.uOb().then(()=>
({name:"QuotaCheck",succeeded:!0}));t.push(E);E=v.AFrameworkApplication.K.$("IsO365ConsumerHost");var W=v.AFrameworkApplication.K.$("IsAnonymousUser");E&&!W&&t.push(this.B6l());Promise.all(t).then(ha=>{ha=ha.filter(sb=>!sb.succeeded).map(sb=>sb.name);const Ka=Date.now()-e;this.q5a.ROo(Ka,0<ha.length,ha.join(","));0===ha.length?this.Uva():(new Wx).pTf();this.EZb(!1)}).catch(ha=>{z.ULS.sendTraceTag(555055175,3011,10,"Failed to initialize transcription feature "+ha.toString());(new Wx).pTf();this.EZb(!1)})}}async B6l(){try{return await this.Pya.initialized,
{name:"UpsellLicenseCheck",succeeded:this.Pya.isFreemiumUpsellEnabled||this.Pya.a_f}}catch(e){return z.ULS.sendTraceTag(555054278,3011,10,"Failed to get/initialize transcription license state "+e.toString()),Promise.reject("Failed to get/initialize transcription license state")}}Uva(){this.W.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn").load();this.W.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddInCommands").register()}EZb(e){appChrome.api.setAsyncRequestStatus("transcribe",
e)}static main(){S.App.uad()?(x.a.instance.Jc(new YC),z.ULS.sendTraceTag(51667728,3011,50,"Transcription package registered with PackageLifecycleManager.")):(z.ULS.sendTraceTag(51667729,3011,50,"Skip Transcription package registration, because the feature is disabled."),(new Wx).pTf())}}Object(y.a)(YC,"WordEditorTranscriptionPackage",null,[0,1]);class mH{constructor(e,t){this.text=t}}Object(y.a)(mH,"ListTransformationContent",null,[]);class Xx{constructor(e,t,E,W,ha,Ka){this.Oh=t;this.vG=E;this.zqa=
W;this.Qd=ha;this.uv=Ka;this.pT=e}}Object(y.a)(Xx,"TableConstructor",null,[1158]);class Qt{constructor(){this.W=null}get name(){return"WordEditor.Transformation"}wc(e){this.W=e;this.W.ia("WordEditor.Transformation.ITableConstructor",()=>new Xx(this.W.resolve("Box4.IOutlineEditor"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.ITableEditor"),this.W.resolve("Box4.TableEditors.IWACTableStyleEditor"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("Box4.IParagraphEditor"))).ha()}init(){}dispose(){this.W=
null}static main(){x.a.instance.Jc(new Qt)}}Object(y.a)(Qt,"TransformationPackage",null,[0,1]);var gw=d(164),eA=d(113);class ZC extends gw.a{constructor(){super();this.language=null;this.percentage=this.characterCount=0;this.H_=Object.assign(new eA.a,{T_:ZC.getTypeName(),B_:ZC.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(y.a)(ZC,"LanguageCountAnnotation",gw.a,[]);const Uw=(e,t)=>-1===e.indexOf("-")&&
-1===t.indexOf("-")?e===t:e.startsWith(t)||t.startsWith(e)?!0:!1;class fA{constructor(){this.Yhb=new Ei.a}rXk(e){void 0===e||null===e||void 0===e.language||null===e.language||void 0===e.percentage||null===e.percentage||void 0===e.characterCount||null===e.characterCount?z.ULS.sendTraceTag(42500685,399,10,"AddNewLanguage: Null or undefined languageCountAnnotation parameter."):this.Yhb.Z(e.language.toLowerCase(),e)}bqm(){let e=0;for(let t=0;t<this.Yhb.count;t++)e+=this.Yhb.values.J(t).percentage;return e}cqm(e){if(!e)return z.ULS.sendTraceTag(42500686,
399,10,"GetDocumentLanguageCompositionPercentageForKnownLanguages: Null or undefined knownLanguageTags parameter."),0;let t=0;for(const E of e)for(e=0;e<this.Yhb.count;e++)if(Uw(this.Yhb.keys.J(e),E)){const W=this.Yhb.values.J(e);W&&(t+=W.percentage)}return t}Thm(){let e=0;for(let t=0;t<this.Yhb.count;t++)e+=this.Yhb.values.J(t).characterCount;return e}}Object(y.a)(fA,"IntelligentSuggestionsDocumentLanguageComposition",null,[]);class hF extends Pa.StandardDialog{constructor(){super()}pi(e,t,E,W,ha){if(void 0===
e||null===e)return z.ULS.sendTraceTag(42500737,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined standardDialogHandler parameter."),!1;if(void 0===t||null===t)return z.ULS.sendTraceTag(42823903,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined reactDialogHandler parameter."),!1;if(void 0===E||null===E||!E.length)return z.ULS.sendTraceTag(42500738,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined fromLanguage parameter."),!1;if(void 0===
W||null===W||!W.length)return z.ULS.sendTraceTag(42500739,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined toLanguage parameter."),!1;z.ULS.sendTraceTag(42500740,399,50,"TranslatorIntelligentSuggestionsReactDialog: Trying to display the translation suggestion dialog.");ha?(ha={["messageText"]:CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessage},ha.pathText=CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxPrefPath,ha.sentenceEndText=CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessagePeriod,
e=new bk.a(!1,!1,!0),e.Gd=4,e.Pe(2,String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxNeverFrom,E)),e.Pe(1,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslate),E={["id"]:"TranslatorIntelligentSuggestionsDialog",["icon"]:{["iconName"]:"Translator_32",["ariaLabel"]:CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslateIconAltText},["bodyControls"]:ha},e.pi(String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTitle,W),t,E)):(this.Gd=
4,this.Pe(2,String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxNeverFrom,E)),this.Pe(1,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslate),this.Qub(String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTitle,W),String.format("{0} {1}{2}",CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessage,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxPrefPath,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessagePeriod),
"Translator_32x32x32",CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslateIconAltText,e,null));return!0}}Object(y.a)(hF,"TranslatorIntelligentSuggestionsReactDialog",Pa.StandardDialog,[]);var yB;(function(e){e[e.ok=0]="ok";e[e.scq=1]="neverFrom";e[e.cancel=2]="cancel"})(yB||(yB={}));Object(y.b)("UserAction",yB);class Hp{constructor(e,t,E,W,ha,Ka,sb,dc,xc,Rc,md,ud,Ud,Id,Ee,kf){this.Wkh=!1;this.OQa=this.IH=null;this.GIm=Ke=>{try{if(6===Ke.status){const dh=Ke.result;dh&&dh.length?this.IH=
qe.b(dh):z.ULS.sendTraceTag(42500693,399,15,"GetRoamingSettingsFrom: Roaming settings are null or empty which might mean that the user cannot access the Roaming Service due to the type of the account they have.")}else z.ULS.sendTraceTag(42500694,399,10,"GetRoamingSettingsFrom: Could not retrieve the Roaming Settings as the task run status is: {0}",Ke.status);this.IH?this.dhi():(z.ULS.sendTraceTag(42783172,399,10,"RoamingSettings are null so quiting: {0}",{["ProcessingTime"]:this.LZ.Fi}),this.Cfb())}catch(dh){z.ULS.sendTraceTag(42500695,
399,10,"GetRoamingSettingsFrom: Failed to deserialize the Roaming Settings. Exception: {0}. ProcessingTime: {1}",dh,this.LZ.Fi),this.Cfb()}};this.jbn=Ke=>{this.aUi(Ke,null)};this.aUi=Ke=>{this.p$e.stop();Ke=1===Ke?0:2===Ke?1:2;this.bUi(Ke,"DialogBox");z.ULS.sendTraceTag(42500705,399,50,"IntelligentSuggestionsHandleDialog: Pressed {0}",yB[Ke])};this.Re=e;this.CIc=E;this.hPd=t;this.TIh=W;this.LZ=Ka.vYa("Task","TranslatorIntelligentSuggestionsAugLoop");this.p$e=Ka.vYa("DialogShown","TranslatorIntelligentSuggestionsDialogBox");
this.ug=ha;this.Buh=sb;this.qHd=dc;this.WEk=xc;this.evh=Rc;this.XBk=md;this.WRa=ud;this.OBk=Id;this.sCk=Ee;this.Cuh=kf;({value:this.OQa}=Hp.D0a.Dc(Ud.toLocaleLowerCase())).returnValue||(this.OQa=Ud,-1!==this.OQa.lastIndexOf("-")&&(this.OQa=this.OQa.substring(0,this.OQa.lastIndexOf("-"))))}initialize(){var e=this.TIh.dPm();if(!e)return z.ULS.sendTraceTag(42500687,399,10,"Initialize: Not able to get the roaming settings (check user type)."),null;e.continueWith(this.GIm,8);e=new kh.a(2,1,500,()=>{xl.Csd.PEo()});
v.AFrameworkApplication.mc.Zb(e);return yu.a.Pl().then(()=>{this.Re.nb(this,"AugLoop_Text_LanguageCountAnnotation");this.LZ.start();z.ULS.sendTraceTag(42500688,399,50,"TranslatorAugLoopRuntimeManager: Registerd Handler for AL runtime manager at {0}.",Date.now())})}lD(e,t){try{if(t===sh.a.getTypeName()){var E=e.content;void 0===E||null===E||void 0===E.language||null===E.language||void 0===E.percentage||null===E.percentage||void 0===E.characterCount||null===E.characterCount?z.ULS.sendTraceTag(42500689,
399,10,"HandleAnnotationEvent: Null or undefined languageCountAnnotation parameter."):(z.ULS.sendTraceTag(42500690,399,50,"HandleAnnotationEvent: Annotation received: {0}",E),E.language=E.language.toLocaleLowerCase(),E.percentage>this.CIc.percentage&&(this.CIc=E),Uw(this.OQa,E.language)&&E.percentage>this.qHd?(z.ULS.sendTraceTag(42500691,399,50,"HandleAnnotationEvent: {0}.",{["MinKnownLangPer"]:this.qHd,["ActualUILangPer"]:E.percentage,["ProcessingTime"]:this.LZ.Fi}),this.Cfb()):(this.hPd.rXk(E),
this.dhi()))}}catch(W){z.ULS.sendTraceTag(42500692,399,10,"HandleAnnotationEvent: Exception: {0}",W)}}dhi(){if(this.g$k()&&this.u4o()){const E=this.iLf(this.CIc.language);if(E&&E.displayName&&E.displayName.length){var e=this.iLf(this.SJi());if(e&&e.displayName&&e.displayName.length)if(z.ULS.sendTraceTag(42783173,399,50,"DisplayIntelligentSuggestionsIfReady: Ready to show callout or dialog if flight is enabled. ProcessingTime:{0}",this.LZ.Fi),this.OBk&&this.sCk)this.LZ.Fi>this.Cuh?z.ULS.sendTraceTag(51512477,
399,15,"DisplayIntelligentSuggestionsIfReady: Not displaying the teaching callout as it took too long to process the document {0}",{["MaxWaitTime"]:this.Cuh,["ActualWaitTime"]:this.LZ.Fi}):this.w8o(E.displayName,e.displayName);else if(void 0!==this.ug&&null!==this.ug&&this.ug.K7h)z.ULS.sendTraceTag(50644368,399,50,"DisplayIntelligentSuggestionsIfReady: Not displaying the dialog as the user has already started editing the document. ProcessingTime:{0}",this.LZ.Fi);else{if(this.XBk)if(this.LZ.Fi>this.Buh)z.ULS.sendTraceTag(42823902,
399,15,"DisplayIntelligentSuggestionsIfReady: Not displaying the dialog box as it took too long to process the document {0}",{["MaxWaitTime"]:this.Buh,["ActualWaitTime"]:this.LZ.Fi});else{this.p$e.start();var t=new hF;t.pi(this.jbn,this.aUi,E.displayName,e.displayName,this.WRa)||(this.p$e.stop(),t.dispose())}}else z.ULS.sendTraceTag(42500697,399,10,"DisplayIntelligentSuggestionsIfReady: Could not retrieve/match language information from Translator for the language we want to translate to.")}else z.ULS.sendTraceTag(42500696,
399,10,"DisplayIntelligentSuggestionsIfReady: Could not retrieve/match language information from Translator for document main language.")}}g$k(){return this.IH?void 0===this.IH.NeverShowCallout||null===this.IH.NeverShowCallout||this.IH.NeverShowCallout?(z.ULS.sendTraceTag(42500698,399,50,"AreTranslationSuggestionsPrerequisitesSatisfied: Bail as 'never show callout' setting is set to true. ProcessingTime:{0}",this.LZ.Fi),this.Cfb(),!1):this.Wkh?(z.ULS.sendTraceTag(42500699,399,50,"AreTranslationSuggestionsPrerequisitesSatisfied: Bail as translation suggestion has already been attempted. ProcessingTime:{0}",
this.LZ.Fi),this.Cfb(),!1):"1"===A.a.HL(window.self.location.href,"translatorRedirect")?(z.ULS.sendTraceTag(42783174,399,50,"Translated document - pressed show Original: {0}",{["ProcessingTime"]:this.LZ.Fi}),this.Cfb(),!1):12E4<this.LZ.Fi?(z.ULS.sendTraceTag(42500700,399,15,"AreTranslationSuggestionsPrerequisitesSatisfied: Stopping from listening to annotations as it took too long to process the document {0}",{["MaxWaitTime"]:12E4,["ActualWaitTime"]:this.LZ.Fi}),this.Cfb(),!1):!0:!1}u4o(){const e=
this.hPd.bqm();z.ULS.sendTraceTag(42500701,399,50,"ShouldSuggestTranslation: DocProcessedPer {0}.",e);if(e>this.WEk){var t=this.$gm();t=this.hPd.cqm(t);const E=100*Math.trunc((this.hPd.Thm()+50)/100);z.ULS.sendTraceTag(42500702,399,50,"ShouldSuggestTranslation: {0}.",{["MinKnownLangPer"]:this.qHd,["ActualKnownLangPer"]:t,["NoChars"]:E,["DocProcessedPer"]:e});if(t<this.qHd)return this.Wkh=!0,z.ULS.sendTraceTag(42783175,399,50,"Known languages composition less than default bar, one final check pending: {0}",
{["ProcessingTime"]:this.LZ.Fi}),this.Cfb(),E<this.evh?(z.ULS.sendTraceTag(42500703,399,15,"ShouldSuggestTranslation: The number of characters of the annotations are less than the minimum required: {0}",{["MinNoChars"]:this.evh,["ActualNoChars"]:E}),!1):!0;z.ULS.sendTraceTag(42783176,399,50,"Known languages composition greater than default bar, : {0}",{["ProcessingTime"]:this.LZ.Fi});this.Cfb()}return!1}bUi(e,t){try{if(!e){const E=new kh.a(2,1,100,()=>{xl.B2j(this.SJi())});v.AFrameworkApplication.mc.Zb(E)}else if(1===
e){const E=this.iLf(this.CIc.language);if(E&&E.name&&E.name.length){let W=E.name.toLocaleLowerCase();"no"===W&&(W="nb");this.TIh.AJj(W)}else z.ULS.sendTraceTag(42500704,399,10,"IntelligentSuggestionsUserAction: Could not retrieve/match language information from Translator for document main language.")}z.ULS.sendTraceTag(51512478,399,50,"IntelligentSuggestionsUserAction: UserSelected:{0}, SourcePrompt:{1}, Language:{2}",yB[e],t,this.CIc.language)}catch(E){z.ULS.sendTraceTag(51512479,399,10,"IntelligentSuggestionsUserAction: Exception: {0}",
E)}}Cfb(){this.Re.xc(this,"AugLoop_Text_LanguageCountAnnotation");z.ULS.sendTraceTag(42500706,399,50,"UnregisterAugmentationLoopHandler: Unregisterd Handler for AL runtime manager at {0}",Date.now())}$gm(){const e=new fa.a;if(void 0!==this.IH.LanguageTagsExcluded&&null!==this.IH.LanguageTagsExcluded)for(var t=0;t<this.IH.LanguageTagsExcluded.length;t++)e.add(this.IH.LanguageTagsExcluded[t].toLowerCase());e.contains(this.OQa)||e.add(this.OQa);void 0!==this.IH.AlwaysTranslatePreference&&null!==this.IH.AlwaysTranslatePreference&&
this.IH.AlwaysTranslatePreference&&void 0!==this.IH.DocumentTargetLanguage&&null!==this.IH.DocumentTargetLanguage&&(t=this.IH.DocumentTargetLanguage.toLocaleLowerCase(),Hp.wYa.mb(t)&&(t=Hp.wYa.J(t)),e.contains(t)||e.add(t));return e}SJi(){if(void 0!==this.IH.AlwaysTranslatePreference&&null!==this.IH.AlwaysTranslatePreference&&this.IH.AlwaysTranslatePreference&&void 0!==this.IH.DocumentTargetLanguage&&null!==this.IH.DocumentTargetLanguage){let e=this.IH.DocumentTargetLanguage.toLocaleLowerCase();Hp.wYa.mb(e)&&
(e=Hp.wYa.J(e));return e}return this.OQa}iLf(e){if(!e||!e.length)return z.ULS.sendTraceTag(42500707,399,10,"GetLanguageInfoFromTranslator: Provided null or empty parameter."),null;e=e.toLocaleLowerCase();const t=xl.Csd.txm();if(!t)return z.ULS.sendTraceTag(42500736,399,10,"GetLanguageInfoFromTranslator: Could not retrieve the language names from Ogma/BRS"),null;for(let E=0;E<t.length;E++){let W=t[E].name.toLowerCase();Hp.wYa.mb(W)&&(W=Hp.wYa.J(W),t[E].name=W);if(Uw(W,e))return t[E]}return null}w8o(e,
t){Ya.UISurfaces.kP().then(E=>{let W=null;const ha=()=>{W?E.removeNotification(W):z.ULS.sendTraceTag(51512480,399,15,"ShowTranslatorTeachingCallout: Attempting to close callout but id is null.")};var Ka=this.UJi(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslate,0,ha);const sb=this.UJi(String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsTeachingCalloutSecondaryButton,e),1,ha);Ka=Object.assign(new ub.a,{target:"button[data-unique-id=Review]",content:CommonUIStrings.l_TranslatorIntelligentSuggestionsTeachingCalloutMessage,
title:String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsTeachingCalloutTitle,t),primaryButtonProps:Ka,secondaryButtonProps:sb,useTeachingStyles:!0,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new Za.a,{preventDismissOnScroll:!0,directionalHint:5,onDismiss:()=>{this.Khp(ha)}})});Ka=E.callout(Ka);W=E.addNotification(Ka);return null}).catch(E=>{z.ULS.sendTraceTag(51512481,399,10,"ShowTranslatorTeachingCallout: Error while showing the teaching callout. ErrorMessage:{0}",
E);return!1});z.ULS.sendTraceTag(51512482,399,50,"ShowTranslatorTeachingCallout: Teaching Callout Shown. ProcessingTime:{0}",this.LZ.Fi)}UJi(e,t,E){return Object.assign(new qo.a,{label:e,onExecute:()=>{this.bUi(t,"TeachingCallout");E()}})}Khp(e){z.ULS.sendTraceTag(51512483,399,50,"TeachingCalloutDismiss: Action:{0}, ProcessingTime:{1}","CalloutClosed",this.LZ.Fi);e()}static YE(){Hp.wYa=new Ei.a;Hp.wYa.add("zh-cht","zh-hant");Hp.wYa.add("zh-chs","zh-hans");Hp.wYa.add("nb","no");Hp.D0a=new Ei.a;Hp.D0a.add("zh-tw",
"zh-hant");Hp.D0a.add("zh-cn","zh-hans");Hp.D0a.add("zh-sg","zh-hans");Hp.D0a.add("zh-mo","zh-hant");Hp.D0a.add("zh-hk","zh-hant");Hp.D0a.add("nb-no","no");Hp.D0a.add("nn-no","no");Hp.D0a.add("pt-br","pt")}}Hp.wYa=null;Hp.D0a=null;Object(y.a)(Hp,"TranslatorAugLoopRuntimeManager",null,[1142,223]);Hp.YE();class gA{constructor(){this.SIh=this.W=null}get name(){return"WordEditor.Translator"}init(){v.AFrameworkApplication.K.Rn(()=>{if(gA.MZf())try{this.SIh=this.W.resolve("WordEditor.Translator.TranslatorAugLoopRuntimeManager"),
this.SIh.initialize()}catch(e){z.ULS.sendTraceTag(42500741,399,10,"TranslatorPackage: Failed to initialize AL runtime manager. Exception: {0}",e)}})}dispose(){}wc(e){this.W=e;gA.MZf()&&(this.W.ia("WordEditor.Translator.IntelligentSuggestionsDocumentLanguageComposition",()=>new fA).ha(),this.W.ia("Microsoft.Office.AugLoop.Text.LanguageCountAnnotation",()=>new ZC).ha(),this.W.ia("WordEditor.Translator.TranslatorAugLoopRuntimeManager",()=>new Hp(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.W.resolve("WordEditor.Translator.IntelligentSuggestionsDocumentLanguageComposition"),this.W.resolve("Microsoft.Office.AugLoop.Text.LanguageCountAnnotation"),this.W.resolve("WordEditor.TranslatorRoamingServiceManager"),this.W.resolve("Box4.IEditViewStateManager"),v.AFrameworkApplication.ua.hs,v.AFrameworkApplication.K.ic("LanguageIntelligentSuggestionMaxWaitTimeAnnotationsMs",5E3),v.AFrameworkApplication.K.ic("LanguageIntelligentSuggestionMinKnownLangCompositionPercentage",10)/100,v.AFrameworkApplication.K.ic("LanguageIntelligentSuggestionMinProcessedDocLangCompositionPercentage",
95)/100,v.AFrameworkApplication.K.ic("LanguageIntelligentSuggestionMinDocumentCharCountFromAnnotations",1E3),!0,!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Ib.cH,v.AFrameworkApplication.uiCulture,v.AFrameworkApplication.ua.Ib.MXa,!0,v.AFrameworkApplication.K.ic("LanguageIntelligentSuggestionMaxWaitTimeTeachingCalloutMs",1E4))).as("WordEditor.Translator.ITranslatorAugLoopRuntimeManager").ha())}static main(){gA.MZf()&&x.a.instance.Jc(new gA)}static MZf(){return!v.AFrameworkApplication.rL&&
!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("LanguageIntelligentSuggestionIsEnabled")&&v.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&v.AFrameworkApplication.K.$("AugLoopServerSideSeedingIsEnabled")}}Object(y.a)(gA,"WordEditorTranslatorPackage",null,[0,1]);var cJ=d(1940);class nH{constructor(e,t){this.Pia=e;this.RSk=t;this.DWb=this.DWb.bind(this);this.EWb=this.EWb.bind(this);this.OWb=this.OWb.bind(this)}Vte(){this.Pia.urg(this.DWb);this.Pia.vrg(this.EWb);this.Pia.Hrg(this.OWb)}Ife(){return!1}DWb(e,
t,E){1<e.length&&"!"===e.trimEnd()?this.Pia.reset():"."===e.charAt(e.length-1)&&this.RSk.FOo(e,E)}EWb(){}OWb(){}}Object(y.a)(nH,"WordAiAssistantInitHandler",null,[248]);var qK=d(1168),oH=d(2032),Yx=d(39);class nv{constructor(e){Yx.a.assign(nv,this,e)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(e){return Yx.a.matchesTypesFor(e,[nv.getTypeName()])}}nv.H_={T_:nv.getTypeName(),B_:nv.getBaseTypes()};
class Zx{constructor(e){Yx.a.assign(Zx,this,e)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiTextModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(e){return Yx.a.matchesTypesFor(e,[Zx.getTypeName()])}}Zx.H_={T_:Zx.getTypeName(),B_:Zx.getBaseTypes()};class $x{constructor(e){Yx.a.assign($x,this,e)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiEmbeddingsModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_OpenAiModelConfig","AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(e){return Yx.a.matchesTypesFor(e,
[$x.getTypeName()])}}$x.H_={T_:$x.getTypeName(),B_:$x.getBaseTypes()};class ss{constructor(e){Yx.a.assign(ss,this,e)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiChatModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(e){return Yx.a.matchesTypesFor(e,[ss.getTypeName()])}}ss.H_={T_:ss.getTypeName(),B_:ss.getBaseTypes()};var iF;(function(e){e[e.TextChatDavinci002=0]="TextChatDavinci002";e[e.TextDavinci001=1]="TextDavinci001";e[e.TextDavinci002=2]=
"TextDavinci002";e[e.TextDavinci003=3]="TextDavinci003";e[e.TextCurie001=4]="TextCurie001";e[e.TextBabbage001=5]="TextBabbage001";e[e.TextAda001=6]="TextAda001";e[e.CodeDavinci002=7]="CodeDavinci002";e[e.CodeCushman001=8]="CodeCushman001";e[e.Custom=9]="Custom";e[e.TextSimilarityAda001=10]="TextSimilarityAda001";e[e.TextSimilarityBabbage001=11]="TextSimilarityBabbage001";e[e.TextSimilarityCurie001=12]="TextSimilarityCurie001";e[e.TextSimilarityDavinci001=13]="TextSimilarityDavinci001";e[e.TextSearchAdaDoc001=
14]="TextSearchAdaDoc001";e[e.TextSearchAdaQuery001=15]="TextSearchAdaQuery001";e[e.TextSearchBabbageDoc001=16]="TextSearchBabbageDoc001";e[e.TextSearchBabbageQuery001=17]="TextSearchBabbageQuery001";e[e.TextSearchCurieDoc001=18]="TextSearchCurieDoc001";e[e.TextSearchCurieQuery001=19]="TextSearchCurieQuery001";e[e.TextSearchDavinciDoc001=20]="TextSearchDavinciDoc001";e[e.TextSearchDavinciQuery001=21]="TextSearchDavinciQuery001";e[e.CodeSearchAdaCode001=22]="CodeSearchAdaCode001";e[e.CodeSearchAdaText001=
23]="CodeSearchAdaText001";e[e.CodeSearchBabbageCode001=24]="CodeSearchBabbageCode001";e[e.CodeSearchBabbageText001=25]="CodeSearchBabbageText001";e[e.TextEmbeddingAda002=26]="TextEmbeddingAda002";e[e.Gpt35Turbo=27]="Gpt35Turbo";e[e.Gpt4_32k=28]="Gpt4_32k";e[e.Gpt4_0203=29]="Gpt4_0203";e[e.Gpt4_0314_4k=30]="Gpt4_0314_4k";e[e.Gpt4_0314_32k=31]="Gpt4_0314_32k"})(iF||(iF={}));var jF=d(2191);class kF{static create(e){const t=new kF(e);return t.activateAnnotation(e.responseType).then(()=>t)}constructor(e){this.config=
e;this.nextMessageId=0;this.responseCallbacks=new Map;const t=["session","chats"],E=Hb.a.create().toString(),W=[...t,E];this.messagesPath=[...W,"messages"];this.config.session.submitOperations([new Va.a({parentPath:t,items:[{id:E,body:e.chat}]}),new Va.a({parentPath:W,items:[{id:"messages",body:new jF.a}]})])}send(e,t){const E=`${this.nextMessageId++}`;this.responseCallbacks.set(E,t);this.config.session.submitOperations([new Va.a({parentPath:this.messagesPath,items:[{id:E,body:e}]})])}close(){return this.config.session.releaseAnnotation(this.activatedAnnotationToken)}activateAnnotation(e){return this.config.session.activateAnnotation(e,
{callback:t=>{if(Va.a.typeGuard(t)&&this.isUnderSubtree(t.parentPath,this.messagesPath))for(const E of t.items){const W=t.parentPath[t.parentPath.length-1],ha=this.responseCallbacks.get(W);ha&&(ha(E.body),this.responseCallbacks.delete(W))}}}).then(({token:t})=>{this.activatedAnnotationToken=t})}isUnderSubtree(e,t){if(e.length<t.length)return!1;for(let E=0;E<t.length;E++)if(e[E]!==t[E])return!1;return!0}}Object(y.a)(kF,"ChatHelper",null,[]);class zB{constructor(e,t){this.hb=e;this.HRa=t}FOo(e,t){var E,
W;const ha=null===(W=null===(E=this.hb.gb)||void 0===E?void 0:E.currentSelection)||void 0===W?void 0:W.Uc;ha&&(E=ha.node,Xf.ParagraphReader.Xb(E)&&(E=Xf.ParagraphReader.text(E),0>t||t>E.length||(E=E.substring(0,t),this.createChatHelper({chat:new oH.BasicChat({modelConfig:new Zx({model:iF.TextDavinci003,parameters:{temperature:.9}}),context:E,prefixText:"\u00acHuman\u00ac",suffixText:"\u00acAI\u00ac",historyDepth:0}),responseType:oH.BasicChatResponse.getTypeName()}).then(Ka=>{Ka.send(new jF.b({message:"Give response to this query as a HTML element to be put inside a paragraph- "+
e}),sb=>{sb=sb.text.replace(/^\n/,"");sb=sb.replace(/\n$/,"");const dc=Zd.a.createTextRange(ha.node,0,t+e.length);this.HRa.Bxe([dc],!0,sb,()=>{})})}).catch(()=>{z.ULS.sendTraceTag(508944669,389,15,"WordAiAssistantTextHandler::sendMsg - could not process the request.")}))))}createChatHelper(e){return qK.a.r5d().getSession().then(t=>kF.create({session:t,...e}))}}Object(y.a)(zB,"WordAiAssistantTextHandler",null,[]);class Tp extends za.a{get name(){return"WordEditor.WordAiAssistantPackage"}ifa(e){const t=
new cJ.a(e.resolve("Box4.IEditingDomManager"),e.resolve("Box4.ICaretPositionManager"),e.resolve("Box4.BackspaceDeleteEventSource"),Object(ki.a)(),"!",["!"]);t.Mdc(Cc.StaticActiveAppFrame.za().ib,Un.KeyInputManager.instance);e.ia("WordEditor.WordAiAssistantPackage.WordAiAssistantInitHandler",()=>new nH(t,e.resolve("WordEditor.WordAiAssistantPackage.WordAiAssistantTextHandler"))).ha();e.ia("WordEditor.WordAiAssistantPackage.WordAiAssistantTextHandler",()=>new zB(e.resolve("Box4.ISelectionManager"),
e.resolve("WordEditor.AppsForOffice.HtmlDataGetSetProvider")));e.resolve("WordEditor.WordAiAssistantPackage.WordAiAssistantInitHandler").Vte()}kfa(){}jfa(){}static main(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordAiAssistantPackage",!1)&&x.a.instance.Jc(new Tp)}}Object(y.a)(Tp,"WordAiAssistantPackage",za.a,[]);var Xr=d(569),az=d(481),lF=d(762),$C=d(1060);class ov{constructor(e,t,E,W,ha,Ka,sb,dc,xc=null){this.ga=e;this.Ch=t;this.Ga=
E;this.tu=W;this.Gb=ha;this.yA=Ka;this.GNe=sb;this.B5b=dc;this.wG=xc;this.QCd=this.Lgb=!1;this.AEb=void 0;this.BDg=(Rc,md,ud,Ud,Id)=>{if(2!==ud)return 32;this.ga.Ob(Fa.a.z5f,2);return this.Ch.CU(ov.Fra)?this.iTf():this.Ipd(Rc,md,ud,Ud,Id)};this.vpg=(Rc,md,ud,Ud,Id)=>{if(1===ud)return 32;Id&&(Id[ya.a.On]=this.Ch.CU(ov.Fra),Id[ya.a.Visible]=!0);return 32};this.NIf=(Rc,md)=>{const ud={};v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSkittleSummaryGenerationSkipped",
!1)?ud.triggerSummary=Rc===Fa.a.YWb:(ud.triggerSummary=Rc===Fa.a.YWb&&!!md.summary,ud.summary=md.summary);ud.wacSessionId=v.AFrameworkApplication.sessionStartInfoSettings.WACSessionID;ud.canonicalUserId=v.AFrameworkApplication.K.kb("LoggableUserId");ud.serverDocID=v.AFrameworkApplication.sessionStartInfoSettings.ServerDocId;this.wG&&(ud.initialWordCount=this.wG.Sz);ud.isCopilotContentGenerationDisabledbyAdminControl=this.AEb;return ud};this.Ipd=(Rc,md,ud,Ud,Id)=>{if(1===ud)return 32;const Ee=performance.now();
z.ULS.sendTraceTag(508347790,3050,50,"Opening Copilot Chat pane");Rc=Object.assign(new Aa.a,{taskPaneWidth:400,isResizable:!0,resizeMinWidth:320,resizeMaxWidth:920,isModernPane:!0,xS:appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddTaskpaneHeaderPreviewTag")?WordRibbonStrings.Copilot:WordEditorIntl.WordEditorStrings.L_CopilotPaneTitle,gS:this.NIf(Rc,Id),onTaskPaneClose:this.Cof,showResizeChatButton:!0,QHg:OfficeCommonStrings.PreviewTaskpaneHeaderTag});yu.a.Pl().then(()=>{lF.a.getAugLoopRuntimeManager().activateAnnotation(Object.assign(new az.a,
{annotationType:Xr.a.getTypeName()}))});this.Ch.B4(ov.Fra,Rc,!0);this.Gb.Zb(new kh.a(2,1,5E3,()=>{if(this.Ch.CU(ov.Fra)){const kf=this.YHf();kf&&this.j6f(kf,Ee)}}));return 32};this.j6f=(Rc,md)=>{Rc.onload=()=>{const ud=performance.now();z.ULS.sendTraceTag(508347789,3050,50,"User Load time of the Copilot Chat pane is: {0} ms",ud-md)}};this.YHf=()=>{const Rc=this.Ch.BVa(ov.Fra);return Rc&&""!==Rc?window.document.getElementById(Rc):null};this.Cof=()=>{this.Cwf();this.B5b.endCopilotOperation("")};this.Cwf=
async()=>{const Rc=await this.yA.getAnnotationsByType(yq.AddInTextAnnotation.getTypeName());for(const md of Rc)md.content.categoryName===ov.Lfc&&this.yA.WUa(md,!1)}}register(){this.Lgb?z.ULS.sendTraceTag(508347795,3050,15,"Attempted to register Copilot Chat add-in commands more than once."):(this.Lgb=!0,z.ULS.sendTraceTag(508347794,3050,50,"Registering Copilot Chat commands."),this.ga.fb(Fa.a.Tre,na.a.view,this.vpg,1124),Object(Jq.d)()&&Object($C.a)()&&(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",
!1)||this.iXf(),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotAdminControlEnabled",!1)?this.pVf():(this.AEb=!1,this.hkd())))}hkd(){this.ga.fb(Fa.a.Poe,I.a.frame,this.BDg,1028);this.ga.fb(Fa.a.YWb,I.a.frame,this.Ipd,1028)}pVf(){this.GNe.execute(e=>{let t=Date.now();e.AL("CopilotContentGeneration",!0).then(E=>{t=Date.now()-t;z.ULS.sendTraceTag(508347793,3050,50,"[Copilot Chat] Copilot OCPS setting check latency: "+t.toString());this.AEb=E}).finally(()=>{this.hkd()})})}iXf(){this.Ga.Rn(()=>
{!this.Ga.$("IsAnonymousUser")&&this.tu&&this.tu.execute(e=>{let t=Date.now();e.isFeatureEnabled("Copilot",!1).then(E=>{t=Date.now()-t;z.ULS.sendTraceTag(508347792,3050,50,"[Copilot Chat] Copilot license check latency: "+t.toString());this.rJg(E)})})})}rJg(e){Object(Sf.c)()?appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ChatPane",!e)):z.ULS.sendTraceTag(508347791,3050,50,"[Copilot Chat] App chrome is not loaded yet. Cannot update the visibility of the copilot pane button in the ribbon.")}iTf(){this.Ch.unb(ov.Fra);
return 32}}ov.Fra="FA000000125";ov.Lfc="CopilotHighlight";Object(y.a)(ov,"CopilotChatAddInCommands",null,[993]);class dJ{constructor(e,t){this.Rrd=e;this.tg=t}startCopilotOperation(){if(this.tg.EXa())return z.ULS.sendTraceTag(508347799,3050,10,"Multi Step operation already running."),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(void 0);this.Rrd.kug();this.tg.yXj();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(void 0)}endCopilotOperation(){if(!this.tg.EXa())return z.ULS.sendTraceTag(508347798,
3050,10,"Multi Step operation must be running before attempting to end it."),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(void 0);this.tg.lki();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(void 0)}}Object(y.a)(dJ,"CopilotOperationLifecycleHandler",null,[992]);class ay extends za.a{constructor(){super(...arguments);this.a9=()=>{Cc.StaticActiveAppFrame.za().ib.pdb(this.a9);this.initInternal()}}get name(){return"Copilot.Chat"}kfa(){if(ay.isEnabled()){const e=Cc.StaticActiveAppFrame.za().ib;
e.lCa?this.initInternal():e.Eja(this.a9)}}initInternal(){try{this.Uva()}catch(e){z.ULS.sendTraceTag(508347797,3050,10,"Initializing CopilotChatPackage failed.",e)}}jfa(){}ifa(e){this.W=e;ay.isEnabled()&&(this.W.ia("WordEditor.CopilotOperationLifecycleHandler",()=>new dJ(this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"),this.W.resolve("Box4.IUndoManager"))).ha(),this.W.ia("WordEditor.Copilot.ICopilotChatAddInCommands",()=>new ov(v.AFrameworkApplication.va,
this.W.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),v.AFrameworkApplication.K,this.W.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),v.AFrameworkApplication.mc,e.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.Qa("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.W.resolve("WordEditor.CopilotOperationLifecycleHandler"),this.R9a())).ha())}Uva(){this.W.resolve("WordEditor.Copilot.ICopilotChatAddInCommands").register()}static isEnabled(){return Object(Jq.d)()&&
Object($C.a)()}R9a(){const e=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory");return e?e.getInstance(0):(z.ULS.sendTraceTag(508347796,3050,10,"Could not resolve wordCountManagerFactory"),null)}static main(){v.AFrameworkApplication.rL||ay.isEnabled()&&x.a.instance.Jc(new ay)}}Object(y.a)(ay,"CopilotChatPackage",za.a,[]);Type.registerNamespace("B4Apps");Type.registerNamespace("ResumeAssistant.AppForOffice");Type.registerNamespace("WEAFO");Type.registerNamespace("WECX");Type.registerNamespace("WELT");
Type.registerNamespace("Wonca.AddInCommands");Type.registerNamespace("Wonca.AppsForOffice");Type.registerNamespace("WordEditor.AcronymsWeb");Type.registerNamespace("WordEditor.AddInCommands");Type.registerNamespace("WordEditor.Assistance");Type.registerNamespace("WordEditor.ConditionalTriggering");Type.registerNamespace("WordEditor.Designer");Type.registerNamespace("WordEditor.EditorUpsell");Type.registerNamespace("WordEditor.Extension");Type.registerNamespace("WordEditor.Ideas");Type.registerNamespace("WordEditor.Ideas.TriggerModels");
Type.registerNamespace("WordEditor.ListTransformationSuggestion");Type.registerNamespace("WordEditor.NeuralRewrite");Type.registerNamespace("WordEditor.OcsConnectionStatus");Type.registerNamespace("WordEditor.OcsVectorClockTelemetry");Type.registerNamespace("WordEditor.Policy");Type.registerNamespace("WordEditor.ProactiveUxGovernance");Type.registerNamespace("WordEditor.ReadingTime");Type.registerNamespace("WordEditor.ResumeAssistant");Type.registerNamespace("WordEditor.SmartLookup");Type.registerNamespace("WordEditor.SmartLookup.SmartLookupManager");
Type.registerNamespace("WordEditor.UpsellCampaign");Type.registerNamespace("WordEditor.Transcription");Type.registerNamespace("WordEditor.Transcription.SDXAddInLoader");Type.registerNamespace("WordEditor.Transformation");Type.registerNamespace("WordEditor.Translator");Type.registerNamespace("WordEditor.DocumentAssemblyEditor");Type.registerNamespace("Common.App.ContentSecurityPolicy");F.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AppsForOfficeOauth");
Type.registerNamespace("Common.App.DisplayEnvironmentName");O.main();Type.registerNamespace("Common.App.SmartLookup");Type.registerNamespace("CommandUI.AddInCommands");ah.main();Ug.main();"undefined"==typeof OfficeExtension&&Type.registerNamespace("OfficeExtension");"undefined"==typeof OfficeExtension.WacRuntime&&(OfficeExtension.WacRuntime={},Type.registerNamespace("OfficeExtension.WacRuntime"));"undefined"==typeof OfficeExtension.WacRuntime.IAsyncEnumerator&&(OfficeExtension.WacRuntime.IAsyncEnumerator=
function(){},OfficeExtension.WacRuntime.IAsyncEnumerator.prototype={get_current:null,moveNext:null},OfficeExtension.WacRuntime.IAsyncEnumerator.registerInterface("OfficeExtension.WacRuntime.IAsyncEnumerator"));Vy.main();Jw.main();window.WordEditor.Extension.Range=$v;window.WordEditor.Extension.AutomationUtility=l;window.WordEditor.Extension.SearchOptions=jl.a;window.WordEditor.Extension.AutomationTransaction=yv;v.AFrameworkApplication.rL||x.a.instance.Jc(new Fk);sB.main();ZE.main();Type.registerNamespace("Common.App.LearningTools");
x.a.instance.Jc(new Tk);Qx.main();Object(V.a)();ZI.a.main();UC.main();try{x.a.instance.Jc(new aF)}catch(e){z.ULS.shipAssertTag(572838543,3025,!1,e.message)}ia.main();if(!v.AFrameworkApplication.rL)if(Cc.StaticActiveAppFrame.za())try{x.a.instance.Jc(new qt(Xh.a.get_instance(),new ol,Cc.StaticActiveAppFrame.za().ib))}catch(e){z.ULS.shipAssertTag(592720736,3016,!1,String.format("{0} {1}",e.message,e.stack))}else z.ULS.shipAssertTag(592558211,3016,!1);YC.main();gA.main();Zy.main();Qt.main();RC.main();
Vx.main();Iy.main();lu.a.main();ja.main();BC.main();ay.main();Type.registerNamespace("Common.App.AppLoadStateTracker");window.Common.App.AppLoadStateTracker.AppLoadStateTracker=w.a;x.a.instance.Jc(new u,7);Tp.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/22137596/wdjs/WordEditorDS.box4.dll3.js.map