/*
 Microsoft Corporation. All rights reserved.
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1557:function(G,J,d){d.d(J,"a",function(){return v});G=d(0);var m=d(2),f=d(2092),a=d(148),l=d(7),w=d(1697),y=d(1657);class v{static NPa(u,x){u||(l.ULS.sendTraceTag(16795331,369,10,"The {0} root node should not be null.",x),v.ng())}static wBc(u,x){u&&u.count||(l.ULS.sendTraceTag(16795332,369,10,"The list of {0} objects should not be null or empty.",x),v.ng())}static c5(u,x){v.NPa(u,x);u.isConnected||(l.ULS.sendTraceTag(16795333,
369,15,"The accessed node is no longer connected to the graph in class: {0}.",x),v.hl())}static yz(u,x){null===u&&(l.ULS.sendTraceTag(16847773,369,10,"The {0} value should not be null.",x),v.qd())}static xBc(u,x){u&&""!==u||(l.ULS.sendTraceTag(17056035,369,10,"The {0} value should not be null or empty.",x),v.qd())}static W0a(u,x){if(null===u||0>=u)l.ULS.sendTraceTag(17040545,369,10,"{0} is with not supported value: {1}.",x,u),v.qd()}static V0a(u,x){if(null===u||0>u)l.ULS.sendTraceTag(20534342,369,
10,"Set {0} with not supported value: {1}.",x,u),v.qd()}static KS(u){if("number"===typeof u)return u;v.qd();return 0}static LPa(u,x,z){v.xBc(u,x);var A=f.a.Era(u);A=""!==A?A:u;"#"!==A.charAt(0)&&(A="#"+A);let D=!1;if(7>A.length)D=!0;else for(let F=1;7>F;F++){const I=A.charAt(F);if(!("0"<=I&&"9">=I||"A"<=I&&"F">=I||"a"<=I&&"f">=I)){D=!0;break}}if(D)throw l.ULS.sendTraceTag(19240924,369,15,"AppId:{0}, Set {1} with not supported argument: {2}.",z.appId,x,u),OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.Nce,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);return v.Reo(A)}static Reo(u){return u.substring(5,7)+u.substring(3,5)+u.substring(1,3)}static vP(u,x,z=0,A=!0){l.ULS.sendTraceTag(17576160,369,50,"{0}",{["MethodName"]:u,["BlobSize"]:z,["Latency"]:x,["ExecutionStatus"]:A})}static fQ(u){return(new Date).getTime()-u}static ng(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.N8a,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_GeneralException);}static qd(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.Nce,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);}static il(u=""){if("Getter"!==u)throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notImplemented,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotImplemented);}static Mzb(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.MJb,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_AccessDenied);}static hl(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.Kun,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_ItemNotFound);
}static PIg(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.Ile,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotSupported);}static Wzc(u,x,z="",A=""){u="AppId:"+u+",";u=(""!==z?u+("Property"+z):u+"Method")+(":"+x+", currently is not allowed on Word Wac");""!==A&&(u+=" for Parameter:"+A);l.ULS.sendTraceTag(19415938,369,15,u);"Getter"!==z&&v.rC()}static rC(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.xcg,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotAllowed);
}static Bjp(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.S5n,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_OperationCancelled);}static fj(){return m.AFrameworkApplication.K.$("WordEditorExtensionRichApi_1_3_Enabled")}static Qud(){return m.AFrameworkApplication.K.$("WordEditorContentControlUserEditingIsEnabled")}static XGe(){return m.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")}static get tFa(){return a.a.flg}static get jda(){return a.a.Qec}static aXc(u){u=
(u||"").replace(RegExp("\\r","g"),"\\r");u=u.replace(RegExp("\\n","g"),"\\n");return u=u.replace(RegExp("\\v","g"),"\\v")}static Byc(u){return u.split(RegExp("\r\n|\r|\n"))}static Zzj(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorFontEnabled",!1)}static Sqg(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorHyperlinkEnabled",!1)}static t7h(){var u;m.AFrameworkApplication.Ld("46ab6280;fg4g7862");return null===
(u=m.AFrameworkApplication.K)||void 0===u?void 0:u.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContentControlEventApiEnabled",!1)}static xEf(){m.AFrameworkApplication.Ld("241fi198;754i3702");return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixFtnEtnClearFormat",!1)}static C1c(){m.AFrameworkApplication.Ld("0cdc8638;0cdc8638");return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FtnEtnBodyEnabled",!1)}static EGp(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecognizeCCWhenTrackchangesONOrOFF",
!1)}static DGp(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InlineContentControlIsValidEnabled",!1)}static Zbi(){var u;m.AFrameworkApplication.Ld("aa6dc483;d84c1847");return null===(u=m.AFrameworkApplication.K)||void 0===u?void 0:u.getBooleanFeatureGate("Microsoft.Office.WordOnline.CrossFtnEtnNodeEnabled",!1)}static GGp(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetrieveStylesApiIsEnabled",!1)}static iam(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.fixingTableCellShadingColorEnabled",
!1)}static OYj(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StyleAPIEnabled",!1)}static Q9m(){return m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.InsertFileFromBase64RetryInterval",0)}static R9m(){return m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.InsertFileFromBase64RetryTime",0)}static P9m(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFileFromBase64ImprovementEnabled",
!1)}static get Bjg(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphEventAPIEnabled",!1)}static get BOn(){return m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MsTimeToRunFirePendingEvents",500)}static C_c(u){null!==u&&void 0!==u&&u.length&&u.some(x=>-1===v.Yrd(x))&&v.qd()}static wBf(u,x){null!=u&&(u=v.Yrd(u),l.ULS.sendTraceTag(509616404,369,50,`${x}.insertContentControl(${w.a[u]})`),-1===u&&v.qd())}static Yrd(u,x=-1){switch(u){case 96:return 1;
case 31:return 0;case 512:return this.jda?8:x;default:return x}}}v.Eqc="\r";v.Aji=new Map([[7,"\u0002"],[6,"\x0B"],[8,"\f"],[12,"\t"]]);v.wma=9;Object(G.a)(v,"Utility",null,[])},1568:function(G,J,d){d.d(J,"g",function(){return A});d.d(J,"f",function(){return D});d.d(J,"e",function(){return F});d.d(J,"d",function(){return I});d.d(J,"h",function(){return H});d.d(J,"i",function(){return N});d.d(J,"a",function(){return M});d.d(J,"k",function(){return U});d.d(J,"j",function(){return O});d.d(J,"c",function(){return V});
d.d(J,"b",function(){return Y});var m=d(56),f=d(7),a=d(1582);d.n(a);J=d(1787);G=[{role:2,roleType:a.RoleType.Title},{role:3,roleType:a.RoleType.Subtitle},{role:4,roleType:a.RoleType.Heading1},{role:5,roleType:a.RoleType.Heading2},{role:6,roleType:a.RoleType.Heading3},{role:7,roleType:a.RoleType.Heading4},{role:8,roleType:a.RoleType.Heading5},{role:9,roleType:a.RoleType.Heading6},{role:10,roleType:a.RoleType.Heading7},{role:11,roleType:a.RoleType.Heading8},{role:12,roleType:a.RoleType.Heading9},{role:15,
roleType:a.RoleType.ListItem},{role:13,roleType:a.RoleType.BodyText},{role:14,roleType:a.RoleType.Caption}];const l={[J.c.Title]:2,[J.c.Subtitle]:3,[J.c.FirstLevelHeading]:4,[J.c.SecondLevelHeading]:5,[J.c.ThirdLevelHeading]:6,[J.c.ForthLevelHeading]:7,[J.c.FifthLevelHeading]:8,[J.c.SixthLevelHeading]:9,[J.c.SeventhLevelHeading]:10,[J.c.EighthLevelHeading]:11,[J.c.NinthLevelHeading]:12,[J.c.BodyText]:13,[J.c.BulletedListItem]:15,[J.c.NumberedListItem]:15};J=[{role:1,$I:{default:"Unknown",VL:null}},
{role:2,$I:{default:"Title",VL:Box4Intl.Box4Strings.L_StyleWordTitle}},{role:3,$I:{default:"Subtitle",VL:Box4Intl.Box4Strings.L_StyleWordSubtitle}},{role:4,$I:{default:"Heading1",VL:Box4Intl.Box4Strings.L_StyleWordHeading1}},{role:5,$I:{default:"Heading2",VL:Box4Intl.Box4Strings.L_StyleWordHeading2}},{role:6,$I:{default:"Heading3",VL:Box4Intl.Box4Strings.L_StyleWordHeading3}},{role:7,$I:{default:"Heading4",VL:Box4Intl.Box4Strings.L_StyleWordHeading4}},{role:8,$I:{default:"Heading5",VL:Box4Intl.Box4Strings.L_StyleWordHeading5}},
{role:9,$I:{default:"Heading6",VL:Box4Intl.Box4Strings.L_StyleWordHeading6}},{role:10,$I:{default:"Heading7",VL:Box4Intl.Box4Strings.L_StyleWordHeading17}},{role:11,$I:{default:"Heading8",VL:Box4Intl.Box4Strings.L_StyleWordHeading8}},{role:12,$I:{default:"Heading9",VL:Box4Intl.Box4Strings.L_StyleWordHeading9}},{role:13,$I:{default:"BodyText",VL:Box4Intl.Box4Strings.L_StyleWordNormal}},{role:14,$I:{default:"Caption",VL:Box4Intl.Box4Strings.L_StyleWordCaption}},{role:15,$I:{default:"ListItem",VL:null}},
{role:16,$I:{default:"SubtleEmphasis",VL:Box4Intl.Box4Strings.L_StyleWordSubtleEmphasis}},{role:17,$I:{default:"Emphasis",VL:Box4Intl.Box4Strings.L_StyleWordEmphasis}},{role:18,$I:{default:"IntenseEmphasis",VL:Box4Intl.Box4Strings.L_StyleWordIntenseEmphasis}},{role:19,$I:{default:"Strong",VL:Box4Intl.Box4Strings.L_StyleWordStrong}},{role:20,$I:{default:"Quote",VL:Box4Intl.Box4Strings.L_StyleWordQuote}},{role:21,$I:{default:"IntenseQuote",VL:Box4Intl.Box4Strings.L_StyleWordIntenseQuote}},{role:22,
$I:{default:"SubtleReference",VL:Box4Intl.Box4Strings.L_StyleWordSubtleReference}},{role:23,$I:{default:"IntenseReference",VL:Box4Intl.Box4Strings.L_StyleWordIntenseReference}},{role:24,$I:{default:"BookTitle",VL:Box4Intl.Box4Strings.L_StyleWordBookTitle}},{role:25,$I:{default:"NoSpacing",VL:Box4Intl.Box4Strings.L_StyleWordNoSpacing}}];const w=new Map(J.map(Q=>[Q.$I.default,Q.role])),y=new Map(J.map(Q=>[Q.role,Q.$I.default])),v=new Map(J.map(Q=>[Q.role,Q.$I.VL])),u=new Map(G.map(Q=>[Q.roleType,Q.role])),
x=new Map(G.map(Q=>[Q.role,Q.roleType])),z=(Q,S,P)=>Q.has(S)?Q.get(S):P,A=Q=>z(w,Q,1),D=Q=>z(u,Q,1),F=Q=>z(x,Q,a.RoleType.Unknown),I=Q=>l[Q],H=Q=>z(y,Q,"Unknown"),N=Q=>z(v,Q,null),M=Q=>{switch(Q){case 4:return 0;case 5:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:return 8;default:return 9}},U=Q=>{switch(Q){case 13:return"Normal";case 1:return"Unknown";case 4:return"Heading 1";case 5:return"Heading 2";case 2:return"Title";case 15:return"List Paragraph";
case 3:return"Subtitle";case 14:return"Caption";case 6:return"Heading 3";case 7:return"Heading 4";case 8:return"Heading 5";case 9:return"Heading 6";case 10:return"Heading 7";case 11:return"Heading 8";case 12:return"Heading 9";case 16:return"Subtle Emphasis";case 17:return"Emphasis";case 18:return"Intense Emphasis";case 19:return"Strong";case 20:return"Quote";case 21:return"Intense Quote";case 22:return"Subtle Reference";case 23:return"Intense Reference";case 24:return"Book Title";case 25:return"No Spacing";
default:return"Unknown"}},O=Q=>{switch(Q){case 13:return m.StyleReader.wordStyleIdNormal;case 4:return m.StyleReader.wordStyleIdHeading1;case 5:return m.StyleReader.wordStyleIdHeading2;case 2:return m.StyleReader.KAb;case 15:return m.StyleReader.wordStyleIdListParagraph;case 3:return m.StyleReader.Xud;case 6:return m.StyleReader.wordStyleIdHeading3;case 7:return m.StyleReader.LBc;case 8:return m.StyleReader.MBc;case 9:return m.StyleReader.NBc;case 10:return m.StyleReader.Uud;case 11:return m.StyleReader.Vud;
case 12:return m.StyleReader.Wud;case 16:return m.StyleReader.JAb;case 17:return m.StyleReader.Zfb;case 18:return m.StyleReader.HAb;case 19:return m.StyleReader.vck;case 20:return m.StyleReader.QBc;case 21:return m.StyleReader.IAb;case 22:return m.StyleReader.wck;case 23:return m.StyleReader.uck;case 24:return m.StyleReader.sck;case 25:return m.StyleReader.p3b;case 14:return m.StyleReader.tck;default:return f.ULS.sendTraceTag(512274639,3016,50,"Style ID not supported for role "+H(Q)),"Unknown"}},
V=Q=>{switch(Q){case 18:case 21:case 23:return!0;default:return!1}},Y=Q=>4<=Q&&12>=Q},1570:function(G,J,d){d.d(J,"l",function(){return z});d.d(J,"c",function(){return A});d.d(J,"b",function(){return D});d.d(J,"u",function(){return I});d.d(J,"s",function(){return M});d.d(J,"r",function(){return U});d.d(J,"g",function(){return O});d.d(J,"d",function(){return V});d.d(J,"p",function(){return Y});d.d(J,"o",function(){return Q});d.d(J,"a",function(){return S});d.d(J,"e",function(){return P});d.d(J,"i",
function(){return T});d.d(J,"n",function(){return Z});d.d(J,"t",function(){return X});d.d(J,"j",function(){return aa});d.d(J,"k",function(){return ia});d.d(J,"h",function(){return wa});d.d(J,"w",function(){return ma});d.d(J,"v",function(){return na});d.d(J,"q",function(){return ta});d.d(J,"f",function(){return Aa});d.d(J,"m",function(){return oa});G=d(21);var m=d(54),f=d(131),a=d(71);J=d(426);var l=d(38),w=d(8),y=d(454),v=d(5),u=d(7),x=d(1578);const z=()=>document.getElementById(a.a.c1a),A=new J.a,
D=`.ParaWrappingDiv .${l.a.L0d}`,F=G.a.instance.rf("Box4.CommentParagraphMapping"),I=[Box4Intl.Box4Strings.l_HK_Bold,Box4Intl.Box4Strings.l_HK_Bold_Mac,Box4Intl.Box4Strings.l_HK_Italic,Box4Intl.Box4Strings.l_HK_Italic_Mac,Box4Intl.Box4Strings.l_HK_Underline,Box4Intl.Box4Strings.l_HK_Underline_Mac];let H=void 0;const N=()=>{if(void 0===H){let za;try{za=CSS.supports("selector(:not(* *))")}catch(ja){za=!1}za||u.ULS.sendTraceTag(526263553,324,15,"Cannot use complex CSS selector in CommentHelpers, falling back to less performant alternative");
H=za}return H},M=za=>!!za&&!!za.Mf,U=(za,ja,fa,Ca)=>{if(!za||!za.objectId)return!1;const xa=fa.Eb(m.a.Cf(za.objectId)),ua=x.a.klc(xa,!0),sa=x.a.klc(xa,!1);if(!ua||!sa||ua===sa&&ua!==ja||!w.ParagraphReader.p$c(ja,ua,sa))return!1;za=!0;var Ea=!1;ua===ja&&(Ea=x.a.Cfa(xa,fa,!0),za=za&&!!Ea&&Ea.Jb.cp<=Ca,Ea=!!Ea&&Ea.Jb.cp===Ca);ja===sa&&(ja=x.a.Cfa(xa,fa,!1),za=za&&!!ja&&ja.Jb.cp>Ca,Ea=Ea&&!!ja&&ja.Jb.cp===Ca);return za||Ea},O=za=>{if(!za)return null;za=f.a.Eb(za,l.a.nWc);return null!==za&&void 0!==za?
za:[]},V=za=>za?f.a.Eb(za,l.a.UWd):null,Y=(za,ja)=>{if(!za)return-1;for(let fa=0;fa<za.length;fa++)if(za[fa].rwb.equals(ja))return fa;return-1},Q=(za,ja)=>{if(!za)return-1;for(let fa=0;fa<za.length;fa++)if(za[fa].eUi.equals(ja))return fa;return-1},S=za=>`Comment Object Id: ${za.objectId}`,P=(za=!1)=>Aa(z(),za),T=()=>Array.from(z().querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart")),
Z=(za,ja=!1)=>{if(za.Kj){for(const fa of za.$f.mj)if(oa(fa,ja))return!0;return!1}return oa(za.htmlElement,ja)},X=za=>!!za&&!!za.ja(v.a.XO,null),aa=()=>{const za=new Set,ja=T();for(let fa=0;fa<ja.length;fa++)O(ja[fa]).forEach(Ca=>{za.add(Ca.toString())});return za},ia=(za,ja)=>ja?Fa(za,!0,ja):Qa(za,!0),wa=(za,ja)=>ja?Fa(za,!1,ja):Qa(za,!1),ma=(za,ja)=>{ya(za,ja,!0);y.a.isEnabled&&!za.oXa&&u.ULS.sendTraceTag(512372928,327,50,`Adding to CommentParagraphMapping CommentId: ${za.id} StartParaId: ${ja}`)},
na=(za,ja)=>{ya(za,ja,!1);y.a.isEnabled&&!za.oXa&&u.ULS.sendTraceTag(512372899,327,50,`Adding to CommentParagraphMapping CommentId: ${za.id} EndParaId: ${ja}`)},Fa=(za,ja,fa)=>{var Ca,xa;const ua=za.id.toString();return ja?y.a.isEnabled?null!==(Ca=F.value.$6a.get(ua))&&void 0!==Ca?Ca:fa:za.ja(v.a.W_a,fa):y.a.isEnabled?null!==(xa=F.value.Y6a.get(ua))&&void 0!==xa?xa:fa:za.ja(v.a.NAa,fa)},Qa=(za,ja)=>{const fa=za.id.toString();return ja?y.a.isEnabled?F.value.$6a.get(fa):za.getValue(v.a.W_a):y.a.isEnabled?
F.value.Y6a.get(fa):za.getValue(v.a.NAa)},ya=(za,ja,fa)=>{const Ca=za.id.toString();y.a.isEnabled?za.oXa||(fa?F.value.$6a:F.value.Y6a).set(Ca,ja):za.setValue(fa?v.a.W_a:v.a.NAa,ja)},ta=za=>y.a.isEnabled?F.value.$6a.has(za.objectId)&&F.value.Y6a.has(za.objectId):!0,Aa=(za,ja)=>{if(ja){if(N())return Array.from(za.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)"));
ja=za.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart");const fa=ja.length;if(0<fa){za=za.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart");const Ca=[];let xa=0;for(let ua=0,sa=za.length;ua<sa;ua++){const Ea=za[ua];xa<fa&&ja[xa]===Ea?++xa:Ca.push(Ea)}return Ca}}return Array.from(za.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart"))},
oa=(za,ja)=>{if(ja){if(N())return!!za.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)");ja=za.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart").length;
if(0<ja)return ja!==za.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart").length}return!!za.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart")}},1573:function(G,J,d){d.d(J,"a",function(){return l});G=d(0);var m=d(2),f=d(1928),a=d(19);class l{static Oyi(){return l.F2k+"_"+f.a.A6c+"_"+a.a.MT(m.AFrameworkApplication.userName)+"_"}static d5d(w){return w+"_"+f.a.A6c+"_"+a.a.MT(m.AFrameworkApplication.userName)+"_"}static sFi(){return l.$fo+
"_"+f.a.A6c+"_"+a.a.MT(m.AFrameworkApplication.userName)+"_"}}l.oIa="ack0";l.pIa="ack1";l.WRd="ack2";l.F2k="ack3";l.GQh="ack4";l.HQh="ack7";l.l6i="ack8";l.STj="ack9";l.nkf="ack10";l.A5o="ack13";l.Vcc="AddinDetailsRefreshed";l.aSd="AddinServiceUserState";l.D2k="DdaMethod";l.C2k="ControlId";l.$Rd="OsfcontrolId";l.jhf="SecurityOrigin";l.Wcc="ak0";l.J2k="ak1";l.LQh="ak2";l.chf="ak4";l.FQh="Office.AutoShowTaskpaneWithDocument";l.JQh="value";l.I2k="errorCode";l.OYl="SourceControlId";l.MYl="OsfControl";
l.NYl="RibbonUpdaterData";l.YCe="AddinShared";l.$fo="__OSF_PRIVATECATALOG_ADDINIDS";Object(G.a)(l,"AddinConstantsString",null,[])},1575:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,l,w,y){void 0===y&&(y=w);var v=Object.getOwnPropertyDescriptor(l,w);if(!v||("get"in v?!l.mJ:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,y,v)}:function(a,l,w,y){void 0===y&&(y=w);a[y]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===
w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1948),J);f(d(1949),J)},1578:function(G,J,d){G=d(0);var m=d(21),f=d(89),a=d(54),l=d(2),w=d(789),y=d(123),v=d(250),u=d(651),x=d(23),z=d(6),A=d(221),D=d(8),F=d(454),I=d(350),H=d(1268),N=d(87),M=d(66),U=d(807),O=d(1008),V=d(1009),Y=d(16),Q=d(5),S=d(503),P=d(7),T=d(122),Z=d(270),X=d(95),aa=d(1773);class ia extends Sys.EventArgs{constructor(Aa,oa){super();this.graphNode=Aa;this.Bvl=oa}}Object(G.a)(ia,
"OnCopyCommentEventArgs",Sys.EventArgs,[]);class wa extends Sys.EventArgs{constructor(Aa,oa){super();this.graphNode=Aa;this.ntl=oa}}Object(G.a)(wa,"OnPasteCommentEventArgs",Sys.EventArgs,[]);var ma=d(1295),na=d(1570),Fa=d(1652);class Qa extends Sys.EventArgs{constructor(Aa){super();this.lL=Aa}}Object(G.a)(Qa,"OnDeleteEventArgs",Sys.EventArgs,[]);class ya extends Sys.EventArgs{constructor(Aa){super();this.lL=Aa}}Object(G.a)(ya,"OnPasteEventArgs",Sys.EventArgs,[]);d.d(J,"a",function(){return ta});class ta{static get rg(){return null!=
ta.pUg?ta.pUg:ta.pUg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get ed(){return null!=ta.$Vg?ta.$Vg:ta.$Vg=new f.a}static get cJa(){return Fa.a.instance}static get Ej(){return x.StaticActiveAppFrame.za().ib.$c.td}static get rc(){return null!=ta.YWg?ta.YWg:ta.YWg=m.a.instance.Oa("Box4.IFeatureHelper")}static isComment(Aa){return 40===Aa.lf}static Gde(Aa){return 40===Aa.type}static TXf(Aa){return!!Aa&&39===Aa.lf}static Ieg(Aa,oa){oa.property===Y.a.wg&&(ta.KSb=!1)}static Meg(Aa,oa){oa&&
!Aa.Wc&&ta.yei(Aa)}static yei(Aa){const oa=Aa.Jb.paragraph.Lc;Aa=oa.Eb(Aa.nk);ta.B_c();Aa&&Aa.anchor&&ta.deleteComment(Aa,oa)}static Xtf(Aa){const oa=new z.GraphIterator;oa.set(Aa.Jj());ta.cJa.Kbb(oa);return oa}static deleteComment(Aa,oa){Aa?(ta.B_c(),ta.o_d(Aa,oa),Aa.anchor&&(ta.ed.raiseEvent(ta.efd,new Qa(Aa)),oa=Aa.ja(Q.a.MG,0),P.ULS.sendTraceTag(592188697,327,15,`Comment deleted by canvas anchor removal. ${Aa.id}`),ta.lch.add(oa.toString()),oa=new z.GraphIterator,oa.set(Aa),oa.zb(39),oa.eh())):
P.ULS.sendTraceTag(512275402,327,50,"Comment Node is Undefined")}static Wgn(Aa){return ta.lch.contains(Aa)}static o_d(Aa,oa){ta.B_c();const za=ta.Cfa(Aa,oa,!0);oa=ta.Cfa(Aa,oa,!1);ta.hxb(za);ta.hxb(oa);za&&oa&&za.Jb===oa.Jb&&P.ULS.sendTraceTag(50619292,327,10,`comment ${Aa.id} start and end range objects belonged to same chp`)}static hxb(Aa){if(Aa&&Aa.Jb.kf){Aa.Jb.kf.remove(Aa);const oa=Aa.Jb.paragraph;0<=Aa.oe&&Aa.oe<oa.qe.length&&(Aa.Jb.cp||1!==oa.qe.length||(oa.qe.wX(0,4),oa.qe.Kq.Z(1,A.CharacterPropertiesEditor.GN),
oa.qe.Nt.Z(1,A.CharacterPropertiesEditor.fS)),oa.qe.removeAt(Aa.oe,4));oa.Jl()}}static bVn(Aa,oa){if(oa){var za=oa.paragraph;Aa=oa.cpBegin;var ja=oa.cpEnd;if(za&&D.ParagraphReader.Xb(za)&&(za=za.qa)){oa.Pm[ta.dXd]||(oa.Pm[ta.dXd]=[]);oa=oa.Pm[ta.dXd];for(let Ca=0;Ca<za.length;Ca++){const xa=za.J(Ca).kf;if(!xa)continue;const ua=xa.length;var fa=za.J(Ca).cp;if(fa<Aa||fa>ja)for(fa=0;fa<ua;fa++)oa.push(xa.J(fa))}}}}static mUn(Aa,oa){if(oa&&(Aa=oa.Pm[ta.dXd]))for(oa=0;oa<Aa.length;oa++)ta.yei(Aa[oa])}static Cfa(Aa,
oa,za){if(!Aa)return null;const ja=za?na.k(Aa,a.a.nil):na.h(Aa,a.a.nil);oa=oa.Eb(ja);return oa?ta.hBa(oa,Aa.id,za):(za||P.ULS.sendTraceTag(4531344,327,15,`Comment anchor missing! Comment Id: ${Aa.id} Anchor Id: ${ja} ${ta.Vgn(ja)}`),null)}static Vgn(Aa){return F.a.isEnabled?`isDeletedParagraph: ${ta.bfi.has(Aa.toString())}`:""}static hBa(Aa,oa,za){for(let ja=0;ja<Aa.qa.length;ja++){const fa=Aa.qa.J(ja);if(fa.kf)for(let Ca=0;Ca<fa.kf.length;Ca++)if(fa.kf.J(Ca).nk.equals(oa)&&za===fa.kf.J(Ca).Wc)return fa.kf.J(Ca)}return null}static klc(Aa,
oa){if(!Aa)return null;oa=oa?na.k(Aa,a.a.nil):na.h(Aa,a.a.nil);return Aa.Lc.Eb(oa)}static y2c(Aa,oa,za,ja=null){const fa=!ja;for(let Ca=0;Ca<Aa.qa.length;Ca++){const xa=Aa.qa.J(Ca);if(xa.cp>=oa&&xa.kf)for(let ua=0;ua<xa.kf.length;ua++){const sa=xa.kf.J(ua).nk.toString();if(xa.kf.J(ua).Wc===za&&(fa||ja.contains(sa)))return xa.kf.J(ua)}}return null}static Dxm(Aa,oa,za,ja){for(let fa=0;fa<Aa.qa.length;fa++){const Ca=Aa.qa.J(fa);if(Ca.cp>oa)break;if(Ca.cp===oa&&Ca.kf)for(let xa=Ca.kf.length-1;0<=xa;xa--){const ua=
Ca.kf.J(xa).nk.toString();if(Ca.kf.J(xa).Wc===za&&ja.contains(ua))return Ca.kf.J(xa)}}return null}static scc(Aa,oa,za,ja){let fa=null;for(let Ca=0;Ca<Aa.qa.length;Ca++){let xa=Aa.qa.J(Ca);if(xa.cp>=za){xa.cp>za||!xa.formatting?(fa=ta.rg.$0(Aa,Ca,za,fa),xa=Aa.qa.J(Ca)):fa=xa.formatting;xa.kf||(xa.kf=new I.a(xa));ta.$Qd(oa,xa.kf,fa.Dk,ja);break}xa.formatting&&(fa=xa.formatting)}}static $Qd(Aa,oa,za,ja){za=oa.Jb.paragraph;const fa=new H.a(oa.Jb,null,Aa,ja);for(let Ca=0;Ca<oa.length;Ca++)if(oa.J(Ca).nk===
Aa&&oa.J(Ca).Wc===ja){P.ULS.sendTraceTag(589616028,327,10,"CommentRangeObject {0} already exists with isStart value {1} in commentRangeObjects",Aa,ja);break}oa.add(fa);za.Jl();fa.oe?za.qe.wX(fa.oe-1,4):za.qe.rta(fa.oe,4);za.qe.Kq.Z(fa.oe,A.CharacterPropertiesEditor.GN);za.qe.Nt.Z(fa.oe,A.CharacterPropertiesEditor.fS);return fa}static B_c(){if(!ta.KSb){var Aa=new z.GraphIterator;Aa.set(x.StaticActiveAppFrame.za().ib.$c);ta.cJa.Kbb(Aa);if(Aa.Ub(1))for(;Aa.Lf(1););ta.KSb=!0}}static U8l(Aa){const oa=
new z.GraphIterator;oa.set(x.StaticActiveAppFrame.za().ib.$c);ta.cJa.Kbb(oa);if(39!==oa.lf)return!1;let za;if(za=oa.Ub(1)){if(za.id.equals(Aa))return!0;for(;za=oa.Lf(1);)if(za.id.equals(Aa))return!0}return!1}static KWb(Aa,oa){ta.Gkd(oa)}static fik(Aa,oa){F.a.isEnabled&&(Aa=oa.node)&&(oa=D.ParagraphReader.vU(Aa),ta.Awe(oa)&&ta.bfi.add(Aa.id.toString()))}static Awe(Aa){return 0<Aa?document.querySelector("div.PageContentContainer p[paraid='"+Aa+"']"):null}static Gkd(Aa){ta.fsg(D.ParagraphReader.tPb(Aa));
let oa=null;var za=new z.GraphIterator;za.set(Aa);if(za.tq()&&(za=N.a.Ft(za,za.origin),za.moveNext()))for(;za.moveNext();)if(D.ParagraphReader.Bh(za.iterator)){oa=za.iterator.currentNode;break}if(oa){Aa=D.ParagraphReader.tPb(Aa);for(const ja of Aa)ja.Wc&&(Aa=ja.Jb.paragraph.Lc.Eb(ja.nk))&&(ta.hxb(ja),ta.scc(oa,Aa.id,0,!0),na.w(Aa,oa.id))}}static fsg(Aa){for(const oa of Aa)if(!oa.Wc){Aa=oa.Jb.paragraph.Lc;const za=Aa.Eb(oa.nk);ta.deleteComment(za,Aa)}}static y8d(Aa,oa){const za=[];if(!Aa)return P.ULS.shipAssertTag(594908762,
327,!1,"Trying to highlight null node."),za;if(!Aa.isConnected)return P.ULS.shipAssertTag(51467871,327,!1,"Trying to highlight disconnected node."),za;const ja=ta.Cfa(Aa,ta.Ej,!0),fa=ta.Cfa(Aa,ta.Ej,!1);if(!ja||!fa)return P.ULS.shipAssertTag(51467872,327,!1,`Missing comment anchor ${Aa.id}`),za;Aa=!1;let Ca=ja.Jb.paragraph;for(;Ca&&(!oa||!oa(Ca,Ca===ja.Jb.paragraph));){Ca===ja.Jb.paragraph&&(Aa=!0);Aa&&za.push(Ca);if(Ca===fa.Jb.paragraph)break;Ca=D.ParagraphReader.zg(Ca,!1)}return za}static Jeg(Aa,
oa){oa.Pm.Comments||(oa.Pm.Comments={});ta.Cme(oa.operation,oa.Ypj,oa.original,oa.clone,oa.Pm.Comments,!0)}static Leg(Aa,oa){oa.Pm.Comments||(oa.Pm.Comments={});ta.Cme(oa.operation,oa.Ypj,oa.original,oa.clone,oa.Pm.Comments,!1)}static YVn(Aa,oa){oa.Pm.Comments||(oa.Pm.Comments={});Aa=oa.Pm.Comments;if((oa=Object.keys(Aa))&&0<oa.length)for(let za=0;za<oa.length;za++){const ja=Aa[oa[za].toString()];ja&&(ja.nk=null,ta.hxb(ja))}}static Cme(Aa,oa,za,ja,fa,Ca){const xa=za.Lc;var ua=D.ParagraphReader.tPb(ja);
ua.sort((yb,Za)=>yb.Jb.cp<Za.Jb.cp||yb.Jb.cp===Za.Jb.cp&&yb.Wc?-1:yb.Jb.cp===Za.Jb.cp&&yb.Wc===Za.Wc?0:1);const sa=new X.a,Ea=new Z.a,Ja=ta.rc.isFeatureEnabled(110);for(const yb of ua)if(Object(T.a)(ma.MainView,Object(M.a)().zd)){var nb=xa.Eb(yb.nk);if(nb&&nb.isConnected)if(yb.Wc)fa[yb.nk.toString()]=yb;else{var ub=nb.ja(Q.a.MG,0);ua=Ca?ta.iid(nb,ja,Aa,oa):ta.nid(nb,ja,Aa,oa);if(Ca)Ja&&(ub=z.GraphIterator.eb(ja),ub.zb(25)&&ub.ld(25)&&aa.a.ed.raiseEvent(aa.a.mkj,new ia(ub.currentNode,ua.getValue(Q.a.MG))));
else{if(Ja){var Yb=ua.ja(Q.a.MG,0);ub&&Yb&&(Ea.mb(ub)?Ea.J(ub)!==Yb&&P.ULS.sendTraceTag(589616029,327,10,"Failed to add Key {0}, Value {1} to clonedDurableIdMapping, since Key {0}, Value {2} already exists. This could affect copy/paste of tasks.",ub,Yb,Ea.J(ub)):Ea.add(ub,Yb))}ua.setValue(Q.a.Usb,!0);nb.ja(Q.a.Gqf,null)||(ub=nb.ja(Q.a.AUa,null))&&ua.setValue(Q.a.Gqf,ub);ua.setValue(Q.a.AUa,l.AFrameworkApplication.userSessionId)}ub=yb.nk.toString();Yb=fa[ub];yb.nk=ua.id;if(!Ca){yb.Fv=null;nb=nb.getValue(Q.a.NJ);
const Za=ua.getValue(Q.a.NJ);fa[nb]=Za;if(nb=ua.ja(Q.a.XO,null))sa.mb(nb)||sa.add(nb,[]),sa.J(nb).push(ua)}na.v(ua,ja.id);ja.id||P.ULS.shipAssertTag(5564305,327,!1,"Comment node has no end anchor!");Yb?(Yb.nk=ua.id,Ca||(Yb.Fv=null),na.w(ua,Yb.Jb.paragraph.id),delete fa[ub]):(ta.scc(ja,ua.id,yb.Jb.cp,!0),na.w(ua,ja.id))}else P.ULS.sendTraceTag(592188835,327,10,String.format("Node is null or not connected, IsNodeChildOfCommentContent:{0}, IsNull:{1}",ta.U8l(yb.nk),!nb)),yb.nk=null,ta.hxb(yb)}else yb.nk=
null,ta.hxb(yb);if(!Ca){for(const yb of sa){Aa=yb.key;oa=yb.value;for(const Za of oa)Za.setValue(Q.a.XO,fa[Aa])}0<Ea.count&&Ja&&(za=z.GraphIterator.eb(za),za.zb(25)&&za.ld(25)&&aa.a.ed.raiseEvent(aa.a.Kmj,new wa(za.currentNode,Ea)))}ja.Nk()}static jBf(Aa,oa){if(Aa.zb(25)&&Aa.ld(25)&&!Aa.fv(16)){const za=z.GraphIterator.eb(oa);za.zb(39);za.ld(39);oa=S.b(za.currentNode,oa.Jj().Lc,!0);Aa.Uf(oa,16)}}static Lsf(Aa,oa){var za=oa.Jj().td;za=S.b(Aa,za,!0);oa=z.GraphIterator.eb(oa);ta.jBf(oa,Aa);oa.Ub(16);
oa.w6(za,1,Aa.id);return za}static iid(Aa,oa,za,ja){ta.B_c();oa=ta.Lsf(Aa,oa);oa.oXa=!0;ta.w3l(Aa,oa,za,ja);return oa}static w3l(Aa,oa,za,ja){Aa=new U.a(z.GraphIterator.eb(Aa),z.GraphIterator.eb(oa),{});Aa.r0b=!0;za=new w.a(za,ja,new O.a(Aa,null));za.ni=!0;za.vm("ExecuteInternalCommentCopy");za.run()}static nid(Aa,oa,za,ja){ta.B_c();var fa=oa.Jj().td;oa=z.GraphIterator.eb(oa);oa.zb(7);oa.ld(7);oa.Ub(16);fa=S.b(Aa,fa,!0);fa.Kg(Q.a.NJ,y.a.create().toString());fa.Kg(Q.a.commentId,v.a.VF());let Ca=!1;
ta.i4i(fa.wf(Q.a.MG))?Ca=!0:fa.Kg(Q.a.MG,ta.yJf());oa.Uf(fa,1);ta.x3l(Aa,fa,za,ja);oa.Yj(fa);oa.IL(1);oa.Cqb(2);oa.Ub(2);fa.setValue(Q.a.NJ,oa.currentNode.wf(Q.a.Yc).toString());ta.ed.raiseEvent(ta.g0n,new ya(fa));Ca&&this.Qci.add(fa.id.toString());return fa}static x3l(Aa,oa,za,ja){Aa=new V.a(z.GraphIterator.eb(Aa),z.GraphIterator.eb(oa),null,null);za=new w.a(za,ja,Aa);za.ni=!0;za.vm("ExecuteInternalCommentPaste");za.run()}static yJf(){const Aa=v.a.Zuc(1,this.Vcj);return ta.i4i(Aa)?Aa:ta.yJf()}static i4i(Aa){if(!Aa)return!1;
if(x.StaticActiveAppFrame.za()){const oa=new z.GraphIterator;oa.set(x.StaticActiveAppFrame.za().ib.$c);ta.cJa.Kbb(oa);let za=oa.Xd();for(;za;){if(za.wf(Q.a.MG)===Aa)return!1;za=oa.Fk()}}return!0}static xgf(Aa){ta.ed.addHandler(ta.efd,Aa)}}ta.g0n="OnPaste";ta.efd="OnDelete";ta.dXd="CommentRangesToTrimOutsideSelection";ta.lch=new u.a;ta.KSb=!1;ta.Vcj=2147483646;ta.Qci=new Set;ta.bfi=new Set;Object(G.a)(ta,"CommentEditor",null,[])},1582:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,
l,w,y){void 0===y&&(y=w);var v=Object.getOwnPropertyDescriptor(l,w);if(!v||("get"in v?!l.mJ:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,y,v)}:function(a,l,w,y){void 0===y&&(y=w);a[y]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1930),J);f(d(1931),J)},1586:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);
class m extends Sys.EventArgs{constructor(f){super();this.data=f}}Object(G.a)(m,"DesignerEventArgs",Sys.EventArgs,[])},1590:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.completion=new Promise((f,a)=>{this.resolve=f;this.reject=a})}}Object(G.a)(m,"ControlledPromise",null,[])},1593:function(G,J,d){d.d(J,"a",function(){return m});const m={d5h:"CommentDeepLinkNavigationFailed",SWd:"CommentDataLoss",QLb:"CommentExperienceDegraded",cDf:"CommentsFeatureUsage",Kqf:"CommentThreadInProgress",
eXd:"CommentReplyInProgress",g5h:"CommentEditInProgress",TWd:"CommentDeepLink",b5h:"CommentCommit",RLb:"CommentLoad",v5h:"CommentInitialization"}},1594:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}m.dr="SpellingErrorV2";m.$Eg="SpellingErrorV2Themed";m.uAl="ContextualSpellingAndGrammarErrorV2";m.rsf="ContextualSpellingAndGrammarErrorV2Themed";m.hSd="AdvancedProofingIssueV2Themed";m.Nyj="AdvancedProofingIssueV2Themed";m.HVj="SimilarityReviewed";m.IVj="SimilarityReviewedThemed";m.JVj=
"SimilarityUnreviewed";m.KVj="SimilarityUnreviewedThemed";m.C8h="CopilotHighlightThemed";m.xyc="SpellingErrorHighlight";m.Glc="GrammarErrorHighlight";m.kmb="CritiqueIndicatorHighlight";m.Myj="ReactiveRewriteIndicatorHighlight";m.X8o="SimilarityHighlight";m.Y8o="SimilarityReviewedHighlight";m.xTd="IdeasSuggestionConfirmation";m.nAl="ContextIQSuggestionThemed";Object(G.a)(m,"CanvasContextualCssClasses",null,[])},1596:function(G,J,d){d.d(J,"a",function(){return y});G=d(0);var m=d(5),f=d(308),a=d(1264),
l=d(1180),w=d(7);class y{constructor(v,u,x,z){this.Wxn=v;this.abn=u;this.$an=x;this.gtj=z}Ttc(v,u,x,z,A){v?(v=this.JXc(v,u,x),null!==v&&(z=this.ctf(z,v,A),this.$an.setState(this.Wxn.value,z))):w.ULS.shipAssertTag(543499408,3016,!1,"No ParagraphNode")}JXc(v,u,x){return 0>x?(w.ULS.sendTraceTag(539018900,389,10,"Attempted to create a ParagraphRange descriptor with negative length"),null):f.a.WXc(v.ja(m.a.Yc,-1),v.ja(m.a.Tj,-1),u,x,u,x,v)}ctf(v,u,x){return Object.assign(new l.a,{annotationType:v,contentDescriptor:u,
state:x})}zXf(v,u,x,z,A){if(v){var D=v.ja(m.a.Yc,-1),F=v.ja(m.a.Tj,-1);-1===D||-1===F?A(null):(v=this.JXc(v,u,x),null===v?A(0):this.abn.Lfd(v,z,I=>{A(I)}))}else w.ULS.shipAssertTag(543499409,3016,!1,"No ParagraphNode")}yao(v){if(v){var u=a.a.WEl(v);this.gtj.pOh({Fyb:u,settingType:v})||w.ULS.shipAssertTag(521416710,3016,!1,"Persist Designer suppression setting failed")}}crn(v){return new Promise(u=>{this.gtj.DEi(v,x=>{(null===x||void 0===x?0:x.Fyb)?u(x.Fyb):u(null)})})}}y.cog="WordDesignerPullQuotesAnnotation";
y.tdi="WordDesignerDefaultAnnotation";y.yGg="WordDesignerSuggestedImageAnnotation";y.A0j="WordDesignerThemeImageAnnotation";y.mGg="WordDesignerStylizedTitleAnnotation";y.nfc="WordDesignerComplexDecoratorAnnotationType";y.vfi="DesignerPaneSuppressionSetting";Object(G.a)(y,"PersistenceHelperImpl",null,[881])},1598:function(G,J,d){function m(H){return 1===(null===H||void 0===H?void 0:H.vr)||3===(null===H||void 0===H?void 0:H.vr)}G=d(0);var f=d(41),a=d(47),l=d(35),w=d(7),y=d(1699),v;(function(H){H[H.initial=
0]="initial";H[H.oEp=.1]="viewingOriginal";H[H.B9k=.5]="applying";H[H.applied=1]="applied";H[H.tSp=2]="accepted";H[H.bue=3]="rejected";H[H.Biq=4]="roleChanged";H[H.$4p=5]="invalidated"})(v||(v={}));Object(G.b)("ReviewIntentState",v);const u=H=>{switch(H){case v.oEp:return v.bue;case v.B9k:return v.applied;default:return H}};var x=d(151);d.d(J,"d",function(){return A});d.d(J,"e",function(){return m});d.d(J,"b",function(){return D});d.d(J,"c",function(){return F});d.d(J,"a",function(){return I});class z{constructor(H,
N,M=null,U,O=!0){this.id=H;this.vr=N;this.LD=M;this.$d=U;this.ggn=O;this.kZi=!1;this.G5i=f.a.Ee()}RNi(){return!1}nYa(H){this.Z7(v[u(H)]);this.Zie(H)}Zie(H){1===H&&this.LD&&this.$d&&(this.ggn?(this.$d.xdn()&&this.LD.execute(N=>{N.logActivity(x.a.alk,null)}),2===this.vr&&this.$d.fsn()?this.LD.execute(N=>{N.logActivity(x.a.qlk,null)}):1===this.vr&&this.$d.Lnn()?this.LD.execute(N=>{N.logActivity(x.a.klk,null)}):0===this.vr&&this.$d.zjn()&&this.LD.execute(N=>{N.logActivity(x.a.elk,null)})):4===this.vr&&
this.$d.dhn()&&this.LD.execute(N=>{N.logActivity(x.a.clk,null)}))}rcd(){6E4>f.a.Ee()-this.G5i?this.Z7("removed"):w.ULS.sendTraceTag(539109067,3016,50,"ID: {0}, Type: {1}, State: {2}",this.id,this.vr,"removedButKept")}wDn(){this.kZi||(this.Z7("hovered"),this.kZi=!0)}Z7(H){this.G5i=f.a.Ee();w.ULS.sendTraceTag(540357460,3016,50,"ID: {0}; Type: {1}, State: {2};",this.id,this.vr,H);a.a(x.a.XRl,!0,void 0,[Object.assign(new l.a,{name:"suggestionType",int64:this.vr}),Object.assign(new l.a,{name:"ID",string:this.id.toString()}),
Object.assign(new l.a,{name:"State",string:H})])}}Object(G.a)(z,"DesignerSuggestion",null,[]);class A extends z{constructor(H,N=1,M=null,U,O=!1,V=0,Y=""){super(H,N,M,U,O);this.Wcb=V;this.Hid=Y}}Object(G.a)(A,"PullQuoteSuggestion",z,[]);class D extends z{constructor(H,N,M,U=null,O,V){super(H,2,U,O);this.zU=N;this.baseUrl=M;this.Jge=V;this.selectedIndex=0;this.Vyc=x.a.V5m}l4m(){w.ULS.shipAssertTag(527708514,3016,this.Vyc===x.a.JSn,`${this.Vyc}`);this.Vyc=Math.min(this.zU.length,x.a.Rje)}RNi(){return this.Vyc<
Math.min(this.zU.length,x.a.Rje)}Nsa(H){return H>=this.zU.length?(w.ULS.shipAssertTag(527708515,3016,!1),null):this.baseUrl+this.zU[H].imageId}jPf(H){return H>=this.zU.length?(w.ULS.shipAssertTag(527708544,3016,!1),null):this.baseUrl+this.zU[H].thumbnailId}O_(H){return H>=this.zU.length?(w.ULS.shipAssertTag(527708545,3016,!1),null):this.zU[H].altText?this.zU[H].altText:this.zU[H].category===y.SuggestionCategory.AbstractImage?WordEditorIntl.WordEditorStrings.L_DesignerImageSuggestionAbstractImageAltText:
WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage}Cvm(H){var N;return H>=this.zU.length?(w.ULS.shipAssertTag(527210446,3016,!1),0):null!==(N=this.zU[H].score)&&void 0!==N?N:0}nYa(H){if(!this.Jge){const N=v[u(H)];w.ULS.sendTraceTag(509653453,3016,50,"ID: {0}; Type: ImageSuggestion for Heading , State: {1};",this.id,N);a.a(x.a.HRl,!0,void 0,[Object.assign(new l.a,{name:"ID",string:this.id.toString()}),Object.assign(new l.a,{name:"State",string:N})])}super.nYa(H)}}Object(G.a)(D,"ImageSuggestion",
z,[]);class F extends z{constructor(H,N=null,M,U,O=null){super(H,0,N,M,U);this.metadata=O;this.mej=!1}nYa(H){this.mej||(this.mej=!0,this.metadata&&a.a(x.a.PFl,!0,0,this.metadata.concat([Object.assign(new l.a,{name:"ID",string:this.id.toString()})])));super.nYa(H)}}Object(G.a)(F,"InconsistencySuggestion",z,[]);class I extends z{constructor(H,N=null,M,U=!1,O){super(H,4,N,M,U);this.h$n=O}nYa(H){this.Fep=H;super.nYa(H)}}Object(G.a)(I,"DesignerPasteSuggestion",z,[])},1600:function(G,J,d){d.d(J,"a",function(){return m});
G=d(0);class m{constructor(f,a,l,w,y=null,v=null,u=null,x=0,z=0){this.h8=this.Hzc=this.jNa=this.ZU=null;this.TJ=x;this.Ate=f;this.iZa=a;this.bfb=l;w&&(this.ZU=w);null!=y&&(this.jNa=y);null!=v&&(this.Hzc=v);u&&(this.h8=u);this.shapeId=z}}Object(G.a)(m,"AnchorData",null,[])},1607:function(G,J,d){d.d(J,"a",function(){return z});G=d(0);var m=d(19),f=d(200),a=d(578),l=d(44),w=d(17),y=d(25),v=d(94),u=d(256),x=d(8);class z{constructor(A,D,F,I,H){this.ERb=A;this.GBa=D;this.GFb=F;this.Npa=I;this.Qd=H;this.mth=
0;this.Eib=null;this.uMk=!1;this.Tsh=!0;this.znh=null;this.ded=this.rGd=!0;this.Qoh=!1;this.ZMc=A?A.innerText:x.ParagraphReader.text(D)}get wE(){throw Error.notImplemented("The inherit class should have the default value.");}set wE(A){}get xUb(){return this.mth}cRj(A){this.mth=A}get currentSelection(){return this.Eib}set currentSelection(A){this.Eib=A}get HI(){return this.GFb}get U3(){return this.Npa}get AYi(){return this.Qoh}get V3i(){return!1}get wDa(){return this.ZMc}get I4o(){return!0}invoke(){this.Qoh=
!0;if(this.ERb&&this.ERb.parentNode&&!this.wE){var A=this.ERb.innerText;if(this.ded&&m.a.substring(this.ZMc,this.GFb,this.Npa)!==m.a.substring(A,this.GFb,this.Npa))return 0;this.xNb(this.ERb);this.cRj(this.ERb.innerText.length-A.length);return 1}this.rGd||f.a.instance.$b("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.Tsh)return f.a.instance.$b("AbortedAction",{["Reason"]:this.znh}),0;var D=x.ParagraphReader.text(this.GBa);A=D.length;var F=this.ZMc.length,I=m.a.substring(this.ZMc,
this.GFb,this.Npa).trimEnd();D=m.a.substring(D,this.GFb,this.Npa).trimEnd();this.I4o&&I===D&&this.Npa>F&&(this.Npa=F);if(this.ded&&I!==D)if(F=I.replace(RegExp('"',"g"),""),F===m.a.substr(D,0,F.length))this.Npa-=2;else return 0;if(v.StaticTheCoauthManager.ud().Jo&&a.CoauthLockEditor.getInstance().seb(z.mg.Kjc(this.GBa)))return 0;F=new l.GraphTransaction(15);F.Ab(this.GBa);F.yi=this.commandId;this.csa(this.GBa);this.cRj(x.ParagraphReader.textLength(this.GBa)-A);this.Eib&&!this.uMk&&w.SelectionEditor.Dm(this.Eib)&&
(D=this.Eib.Ra,A=D.cpBegin,I=D.cpEnd,D=D.node,D===this.GBa&&this.xUb&&(A>=this.Npa&&(A+=this.xUb),I>=this.Npa&&(I+=this.xUb),this.Eib=y.SelectionFactory.eN(D,A,I)));F.dispose();return 2}Y$j(){this.rGd=this.c2h()}xNb(){}c2h(){var A=x.ParagraphReader.text(this.GBa);const D=m.a.substring(this.ZMc,this.GFb,this.Npa).trimEnd();A=m.a.substring(A,this.GFb,this.Npa).trimEnd();return D===A}static get mg(){return u.a.instance}}Object(G.a)(z,"AAutoCorrectAction",null,[313])},1608:function(G,J,d){d.d(J,"a",function(){return U});
G=d(0);var m=d(131),f=d(2),a=d(592),l=d(262),w=d(365),y=d(1594),v=d(841),u=d(321),x=d(547),z=d(676);d.n(z);var A=d(1503),D=d(652),F=d(767),I=d(1932),H=d(1677),N=d(114),M;(function(O){O[O.Spelling=0]="Spelling";O[O.Grammar=1]="Grammar";O[O.Style=2]="Style";O[O.DCc=3]="Similarity";O[O.rQg=4]="ContextIQ";O[O.Ndk=5]="AutoReplace";O[O.vQg=6]="CopilotHighlight"})(M||(M={}));Object(G.b)("AnnotationRenderCategory",M);class U{static com(O){switch(U.d9d(O)){case M.Spelling:O=y.a.$Eg;break;case M.Grammar:O=
y.a.rsf;break;case M.DCc:O=60!==O.M_.state&&70!==O.M_.state?y.a.KVj:y.a.IVj;break;case M.rQg:if(H.a.F2i(O))return;O=H.a.Kek?y.a.nAl:y.a.hSd;break;case M.Ndk:O=y.a.xTd;break;case M.vQg:O=y.a.C8h;break;default:O=y.a.hSd}return O}static EPm(O){switch(U.d9d(O)){case M.Spelling:return u.f.SpellingSquiggle;case M.Grammar:return u.f.GrammarSquiggle;default:return u.f.CritiqueSquiggle}}static d9d(O){let V;if(U.ypc(O)){switch(O.priority){case 0:V=M.Spelling;break;case 1:V=M.Grammar;break;default:V=M.Style}this.kde(O)&&
(V=M.vQg)}else U.Gtb(O)?V=M.DCc:U.s9c(O)&&(V=M.rQg);return V}static kde(O){return l.a.getTypeNameFor(O)===z.AddInTextAnnotation.getTypeName()}static ypc(O){const V=l.a.getTypeNameFor(O);return V===w.a.getTypeName()||V===v.a.getTypeName()||this.kde(O)}static s9c(O){return l.a.getTypeNameFor(O)===A.a.getTypeName()}static Gtb(O){return l.a.getTypeNameFor(O)===a.a.getTypeName()}static qge(O){return U.ypc(O)?0===O.priority:!1}static Cee(O){return U.ypc(O)?1===O.priority:!1}static $cn(O){return l.a.getTypeNameFor(O)===
v.a.getTypeName()}static EXf(O){return null!=O&&"Spelling"===O.categoryName&&1===O.suggestions.length&&4===(O.suggestions[0].suggestionActions&4)}static uMm(O,V){const Y=[u.b.IgnoreOnce];switch(O){case 0:Y.push(u.b.IgnoreAll);V&&Y.push(u.b.AddToDictionary);break;case 1:Y.push(u.b.Options)}return Y}static Rui(O){return U.ypc(O)?O.categoryName:U.Gtb(O)?U.GVj:U.s9c(O)?U.Aam:null}static fOf(O,V){let Y=x.a.Exc;switch(O){case 0:Y=V?x.a.Vye:x.a.ZRj;break;case 1:Y=x.a.YRj}return Y}static ujc(O,V=!1,Y){Y=
"IntentProvider_Suggestion_"+Y;let Q=m.a.Eb(O,Y);V&&!Q&&m.a.Hm(O,Y,Q=new D.a);return Q}static RRf(O,V,Y,Q,S,P,T,Z,X=!1,aa){let ia=null;try{if(Q&&Y&&(ia=P.Ysi(Y,S))){var wa=ia.content;if(F.a.ULa||!f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)||this.d9d(wa)!=M.Style){T.H1d(O,V,Z);U.ujc(O,!0,aa).add(wa.id);var ma=U.com(wa);O.classList.add(ma);I.a.mzb(ia,1);U.F2b&&U.Bef(O,wa);X&&F.a.wcd()}}}catch(na){I.a.mcd(na,[ia],!0)}}static get F2b(){return null!=
U.S6g?U.S6g:U.S6g=f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}static Bef(O,V){U.qge(V)?O.setAttribute("aria-invalid","spelling"):U.Cee(V)&&O.setAttribute("aria-invalid","grammar")}static vXa(O,V,Y){O=(O=U.ujc(O,!1,Y))?N.firstOrDefault(O):null;return{returnValue:!!O,type:O?Y:null,data:O}}}U.GVj="Similarity";U.Aam="FlagAnnotation";Object(G.a)(U,"AnnotationHelper",null,[])},1609:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);
class m{constructor(f,a,l,w=!1,y=!1,v=!1,u=!1,x=null){this.jn=f;this.source=a;this.ZXa=l;this.Fja=w;this.ryc=y;this.gCf=v;this.bVa=u;this.Kp=x}}Object(G.a)(m,"ContextualIntentInvocationParameters",null,[])},1610:function(G,J,d){d.d(J,"a",function(){return a});G=d(0);var m=d(28),f=d(7);class a{constructor(l){this.jn=l}static create(l){if(!l)return f.ULS.shipAssertTag(575930373,3016,!1),null;l=m.a.create(l);return new a(l)}}Object(G.a)(a,"ShowReviewArgs",null,[])},1611:function(G,J,d){d.d(J,"a",function(){return m});
G=d(0);class m{constructor(){this.data=this.landingTab=null}}Object(G.a)(m,"LaunchData",null,[])},1615:function(G,J,d){d.d(J,"c",function(){return a});d.d(J,"a",function(){return l});d.d(J,"b",function(){return w});G=d(0);var m=d(1596);class f{constructor(y,v,u){this.suggestion=y;this.vr=v;this.paragraphNode=u}get role(){switch(this.vr){case 1:case 3:return 27;case 2:return 28;default:return 1}}}Object(G.a)(f,"AddEnhancementActionData",null,[]);class a extends f{constructor(y,v,u,x,z,A=1){super(y,
A,v);this.Wcb=u;this.Hid=x;this.callback=z}}Object(G.a)(a,"AddPullQuoteActionData",f,[]);class l extends f{constructor(y,v,u=0){super(y,2,v);this.kta=u}}Object(G.a)(l,"AddCoverPhotoActionData",f,[]);class w{constructor(y,v,u,x,z){this.suggestion=y;this.jt=v;this.nnc=u;this.p8c=x;this.bTd=z}get annotationType(){switch(this.suggestion.vr){case 1:case 3:return m.a.cog;case 2:return m.a.yGg;default:return m.a.tdi}}get tYa(){return this.jt&&1<=this.jt.length?this.jt[0]:null}}Object(G.a)(w,"AddDesignerSuggestionActionData",
null,[])},1621:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}Object(G.a)(m,"OAuthResult",null,[])},1622:function(G,J,d){d.r(J);d.d(J,"FindManagerHelper",function(){return v});G=d(0);var m=d(7),f=d(122),a=d(22),l=d(111),w=d(1135),y=d(23);d=d(1945);class v extends d.a{constructor(){super()}get $c(){return y.StaticActiveAppFrame.za().ib.$c}get Ej(){return y.StaticActiveAppFrame.za().ib.$c.td}get Ota(){return y.StaticActiveAppFrame.za().ib.Ota()}get aYf(){return y.StaticActiveAppFrame.za().ib.sc.nj}Fff(u){a.App.jf.Il.MTa(u)}Uke(u,
x,z){return w.b(u,x,z)}JKg(u,x,z){if(1===z){if(!Object(l.a)().KKg(u))return!1}else if(!(u.lf===x||u.zb(x)&&u.ld(x)))return!1;return Object(f.a)(45,u.currentNode)||this.Uke(u,x,z)?!0:!1}$Va(u){return this.Ej.Eb(u).$Va()}t1i(u,x,z,A){if(!u||u.matchCase!==z.matchCase||u.matchWholeWord!==z.matchWholeWord||A.length!==x.length)return!0;for(u=0;u<A.length;u++){if(A[u]!==x[u])return!0;if(z.matchCase){if(A[u]!==x[u])return!0}else if(A[u].toLocaleLowerCase()!==x[u].toLocaleLowerCase())return!0}return!1}D1i(u,
x,z,A){if(!u||u.matchWholeWord&&!z.matchWholeWord||u.matchCase&&!z.matchCase||A.length!==x.length)return!1;if(u.matchWholeWord)return u.matchCase?x[0]===A[0]:A[0].toLocaleLowerCase()===x[0].toLocaleLowerCase();for(let D=0;D<A.length;D++)if(u.matchCase){if(!A[D].startsWith(x[D]))return!1}else if(!A[D].toLocaleLowerCase().startsWith(x[D].toLocaleLowerCase()))return!1;u.matchCase===z.matchCase&&u.matchWholeWord===z.matchWholeWord&&1===x.length&&m.ULS.sendTraceTag(4069025,313,50,"{0}",{["IncrementalSearchTriggeredQueryLength"]:z.text.length});
return!0}Xte(u,x,z){const A=a.App.jf.Il.Ve(12);A.fo(u);A.Zt(x);A.Bw(z)}static get instance(){v.xDb||(v.xDb=new v);return v.xDb}}v.xDb=null;Object(G.a)(v,"FindManagerHelper",d.a,[])},1623:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);var m=d(2);class f{constructor(){this.currentDocumentPath=m.AFrameworkApplication.K.kb("EditDocInClientUrl")}}Object(G.a)(f,"SmartLookupApplicationInterface",null,[])},1624:function(G,J,d){d.d(J,"a",function(){return M});G=d(0);var m=d(789),f=d(111),a=d(6),l=
d(807),w=d(1008),y=d(1009),v=d(207),u=d(8),x=d(44),z=d(144),A=d(590),D=d(5),F=d(503),I=d(82),H=d(748),N=d(576);class M{constructor(U,O,V,Y,Q){M.iee=!1;this.lG=U;this.O3e=O;this.N3e=V;this.Zc=Y;this.ywk=Q}ETo(U,O){this.lG.Eta(U)&&U.properties.setValue(D.a.Asa,O)}cic(){if(!M.iee){var U=this.UDi();for(var O=U.Ub(7);O;O=U.Cj(7))for(O=U.Ub(8);O;O=U.Cj(8));M.iee=!0}}UDi(){const U=this.Zc.Ql();U.set(this.ywk());Object(f.a)().dS(U);return U}Vv(){const U=this.UDi();this.N3e.Vke(U);this.RCo(U.currentNode);
M.iee=!1}Igo(U){this.cic();if(U.isConnected){var O=this.w7(U);if(O=this.lG.k3c(U,O)){var V=this.Zc.Ql();V.set(O);V.zb(25);U.anchor&&(V.set(U),V.zb(37),V.eh())}}}l1l(U,O){if(U.zb(25)&&U.ld(25)&&!U.fv(7)){const V=a.GraphIterator.eb(O);V.zb(37);V.ld(37);O=F.b(V.currentNode,O.Jj().Lc,!0);U.Uf(O,7)}}E3l(U,O,V,Y){U=new l.a(a.GraphIterator.eb(U),a.GraphIterator.eb(O),{});U.r0b=!0;V=new m.a(V,Y,new w.a(U,null));V.ni=!0;V.vm("ExecuteInternalFootnoteEndnoteCopy");V.run()}Lsf(U,O){O=O.Jb.paragraph;var V=O.Jj().td;
V=F.b(U,V,!0);O=a.GraphIterator.eb(O);this.l1l(O,U);O.Ub(7);O.Uf(V,8);return V}iid(U,O,V,Y){this.cic();const Q=this.w7(U);if(!this.lG.k3c(this.lG.eEi(U),Q))return null;O=this.Lsf(U,O);this.E3l(U,O,V,Y);return O}nid(U,O,V,Y){this.cic();var Q=O.Jb.paragraph;const S=Q.Jj().td;Q=a.GraphIterator.eb(Q);Q.zb(7);Q.ld(7);this.Ske(Q,O.w7());O=F.b(U,S,!0);Q.Uf(O,8);this.F3l(U,O,V,Y);return O}F3l(U,O,V,Y){U=new y.a(a.GraphIterator.eb(U),a.GraphIterator.eb(O),null,null);V=new m.a(V,Y,U);V.ni=!0;V.vm("ExecuteInternalFootnoteEndnotePaste");
V.run()}Ske(U,O){U.Ub(7);this.lG.PYi(U,O)||U.Lf(7)}$Ai(U,O){const V=this.Zc.Ql();V.set(O);V.zb(7);V.ld(7);this.Ske(V,U);return V}PCi(U,O,V){return this.YCi(U,O,V,!1)}tGm(U,O,V){return this.YCi(U,O,V,!0)}YCi(U,O,V,Y){var Q=this.Zc.Ql();let S=null,P=!1;Q.set(U);Q.tq();Q.ld(8);Q.Xd();for(Q=v.a.Ft(Q,Q.aud(8));Q.moveNext();){if(u.ParagraphReader.Xb(Q.currentNode)){const Z=Q.currentNode;var T=I.i(Z,7);for(const X of T){if(Z===U){T=X.Jb.cp;if(Y&&T>=O)return S;T>=O&&-1!==O&&(P=!0)}if(X.w7()===V){if(!Y&&P)return X;
S=X}}Z===U&&(P=!0)}if(Y&&P)return S}return null}RCo(U){const O=new x.GraphTransaction(3);O.Ab(U);U=v.a.iq(Object(f.a)().Iu(U));let V=1,Y=1;for(;U.moveNext();){var Q=U.currentNode;if(Q&&u.ParagraphReader.Xb(Q)){Q=I.i(Q,7);for(const S of Q){Q=S.x7();const P=S.w7()?V++:Y++;this.ETo(Q,P)}}}O.dispose()}w7(U){return this.lG.Eta(U)?U.properties.getValue(D.a.n7):0}static xtm(){return new M(N.a.instance,z.PageReader.instance,Object(f.a)(),new A.a,M.hgm)}static hgm(){return H.a.en.ib.$c}static get instance(){return null!=
M.HZg?M.HZg:M.HZg=M.xtm()}}M.iee=!1;Object(G.a)(M,"FootnoteEndnoteEditorInteractive",null,[266])},1630:function(G,J,d){G=d(0);class m{static hBm(){return m._nextEventReceiverId++}}m._nextEventReceiverId=0;Object(G.a)(m,"EventReceiverIdCounter",null,[]);d.d(J,"a",function(){return f});class f{constructor(a,l){this.T6b=a;this._id=m.hBm();this.rLk=l}get id(){return this._id}notify(a,l){this.rLk(a,l)}HR(a,l){return this.T6b.Ljo(a,l?this:null)}}Object(G.a)(f,"EventReceiver",null,[433])},1633:function(G,
J,d){d.d(J,"a",function(){return m});G=d(0);class m{}m.open="open";m.refresh="refresh";m.Pwg="saveAs";m.translate="translate";m.x9f="modeSwitch";m.huf="createNew";Object(G.a)(m,"ReasonList",null,[])},1634:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{static Isd(f){if(!f)return"{NULL}";const a=f.length;if(600>=a)return f;const l=a-195;return f.substring(0,400)+"[...]"+f.substring(l,a)}}Object(G.a)(m,"LogUtils",null,[])},1635:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}
Object(G.a)(m,"SmartLookupSelection",null,[])},1637:function(G,J,d){d.d(J,"a",function(){return N});G=d(0);var m=d(21),f=d(967),a=d(590),l=d(111),w=d(32),y=d(5),v=d(46),u=d(16),x=d(7),z=d(122),A=d(84),D=d(104),F=d(514),I=d(181),H=d(1140);class N{constructor(M,U,O,V,Y,Q){this.HSk=M;this.xe=U;this.vQf=O;this.u9b=V;this.xxk=Y;this.wxk=Q}get hk(){return null!=this.p5g?this.p5g:this.p5g=m.a.instance.resolve("WordEditor.ITableEditor")}get Md(){return null!=this.q6g?this.q6g:this.q6g=m.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Lj(){return null!=
this.X5g?this.X5g:this.X5g=m.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get f3b(){return this.HSk.value}get Gud(){return this.xe.value}lsl(M){const U=this.f3b.D9d(M,f.a.$Vb);U&&(this.c0b(U,M),this.xEa(1696,M))}c0b(M,U,O=!0){const V=this.f3b.H4c(U);if(V&&(M=this.Gud.Ae(M),V.gh(M))){const Y=this.f3b.k3(U);let Q="Unknown";this.f3b.n5a.value&&(Q=this.f3b.n5a.value.mb(M)?M:"CustomStyle");x.ULS.sendTraceTag(0,311,50,"{0}",{["ApplyTableStyleId"]:Q,["RowCount"]:this.xxk(U),
["ColumnCount"]:this.wxk(U),["HR"]:!!(Y&32),["FC"]:!!(Y&128),["TR"]:!!(Y&64),["LC"]:!!(Y&256),["BR"]:!(Y&512),["BC"]:!(Y&1024),["TableId"]:U.id.toString()});O&&this.F_a(U);this.Vzp(U,V);O=V.gh(M);U.properties.setValue(y.a.tableStyle,O.id);this.jsl(U);U.N2.Kla(!0)}}TPj(M,U,O){if(M=this.f3b.D9d(O,M))this.xEa(U,O),this.c0b(M,O)}xEa(M,U,O=!0){O&&this.F_a(U);U.properties.setValue(y.a.tableLook,M);x.ULS.sendTraceTag(0,311,50,"{0}",{["HR"]:!!(M&32),["FC"]:!!(M&128),["TR"]:!!(M&64),["LC"]:!!(M&256),["BR"]:!(M&
512),["BC"]:!(M&1024),["TableId"]:U.id.toString()});U.N2.Kla(!0)}Vzp(M,U){(M=this.u9b(M))&&U.RAg(M)}jsl(M){if(M.isConnected){M.hasProperty(v.a.Qx)&&M.removeProperty(v.a.Qx);this.Pzo(M);this.kDj(M);M=this.vQf.jg(M);for(var U=M.Ub(1);U;){for(U=M.Ub(1);U;)U.hasProperty(u.a.MJ)&&U.removeProperty(u.a.MJ),U.hasProperty(y.a.TOa)&&U.removeProperty(y.a.TOa),this.gxb(U),this.kDj(U),U=M.Cj(1);U=M.Cj(1)}}}P9d(M){let U=M.ja(v.a.nZa,null);if(U)return U;if(M=this.Gud.Ae(M))if(U=({value:U}=this.f3b.n5a.value.Dc(M,
U)).returnValue?U:null)return U;return M}fRo(M,U,O,V,Y){M.properties.setValue(U.style,O);M.properties.setValue(U.size,V*I.a.iUc);M.properties.setValue(U.color,Y)}F_a(M){if(this.Md.Mg){var U;Object(z.a)(F.a,M)&&(U=Object(A.a)(F.a,M))&&(U=U.gY())&&this.Lj.F_a(M,U)}}Pzo(M){M.qg(y.a.Xa,y.a.Ya,y.a.cwa,y.a.ob,y.a.pb,y.a.awa,y.a.Va,y.a.Wa,y.a.$va,y.a.qb,y.a.rb,y.a.bwa,y.a.tb,y.a.ub,y.a.KEa,y.a.Mb,y.a.Nb,y.a.ROa)}gxb(M){M.qg.apply(M,this.hk.P0h)}kDj(M){M.qg(y.a.Ea,y.a.Aa,y.a.Ba,y.a.Ca,y.a.sV,y.a.CY,y.a.i0a,
y.a.h0a)}static sNm(){return new N(m.a.instance.rf("WordEditor.IWACTableStyleReader"),m.a.instance.rf("Box4.Styles.IWACStyleReader"),new a.a,Object(D.a)(Object(l.a)(),Object(l.a)().Iu,"navigateToPageContentNode"),w.TableReader.xg,w.TableReader.Fh,H.a.instance)}static get instance(){return null!=N.E_g?N.E_g:N.E_g=N.sNm()}}Object(G.a)(N,"WACTableStyleEditor",null,[253,254])},1652:function(G,J,d){d.d(J,"a",function(){return a});G=d(0);var m=d(111),f=d(286);class a{Kbb(l){Object(m.a)().dS(l);return l.Ub(16)}static Xs(){return new f.a(()=>
new a)}static get instance(){return a._instance.value}}a._instance=a.Xs();Object(G.a)(a,"CommentNavigator",null,[283])},1653:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m extends Sys.EventArgs{constructor(){super();this.Ykj=this.NMa=null}}Object(G.a)(m,"OnCommentInitArgs",Sys.EventArgs,[])},1654:function(G,J,d){d.d(J,"a",function(){return F});G=d(0);var m=d(54),f=d(2173),a=d(2),l=d(94),w=d(578),y=d(37),v=d(125),u=d(7),x=d(1578),z=d(642),A=d(1570),D=d(1593);class F{static yEn(){const I=
document.getElementsByClassName(z.a.Aig);if(I&&I.length){var H=I[0].clientWidth;for(let N=1;N<I.length;N++){if(I[N].clientWidth!==H||N===I.length-1){u.ULS.sendTraceTag(540160401,327,50,"{0}:NoOfContainers={1}",I[N].clientWidth-H,I.length);break}H=I[N].clientWidth}}}static BRg(I,H,N){I&&(I=l.StaticTheCoauthManager.ud().Ak.GLf(I),w.CoauthLockEditor.getInstance().seb(I)&&u.ULS.sendTraceTag(540160402,327,15,`Comment with ObjectId: ${H.objectId} added to a locked ${N?"start":"end"} paragraph. Lock Type ${I.Type.toString()}`))}static JDp(I,
H,N){var M=H.Eb(m.a.Cf(I.objectId));if(M){var U=x.a.Cfa(M,H,!0);H=x.a.Cfa(M,H,!1);null!==U&&void 0!==U&&U.Fv||(U=A.k(M),u.ULS.sendTraceTag(540160404,327,15,`CommentRangeStart failed to save. startParaId: ${U}, CommentObjectId: ${I.objectId}`),F.s$i(N));null!==H&&void 0!==H&&H.Fv||(M=A.h(M),u.ULS.sendTraceTag(540160405,327,15,`CommentRangeEnd failed to save. endParaId: ${M}, CommentObjectId: ${I.objectId}`),F.s$i(N))}else u.ULS.sendTraceTag(540160403,327,15,`Commited Comment missing CommentNode graph object ObjectId: ${I.objectId}`)}static s$i(I){I.logKpiFailure(D.a.b5h,
"CommentReferenceFailedToSave",{isIntentional:!1,isInternal:!0},{name:D.a.SWd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1})}static nEn(I,H,N){0!==I.size&&I.forEach(M=>{H.has(M)||F.oEn(M,N)})}static oEn(I,H){H.Eb(m.a.Cf(I))&&u.ULS.sendTraceTag(539800642,327,15,`comment start missing for ${I}`)}static Wol(I){const H=new Set;I.forEach(N=>{N&&N.pk&&((N=F.oDm(N))?H.add(N):u.ULS.sendTraceTag(539554689,327,15,"Outline Node is undefined"))});H.forEach(N=>{const M=N.ja(v.a.Oqf,[]);0===N.ja(v.a.Mqf,
[]).length&&0===M.length&&u.ULS.sendTraceTag(539800644,327,15,`Outline Element Node ${N.id.toString()} is missing comment info while paragraph has comments. This will cause some comments to fail to load.`)})}static Htn(I,H,N,M){I=N.Tvi(I);if(!I)return!1;N=A.k(I,m.a.nil);M=M.Eb(N);H.has(N.toString())&&u.ULS.sendTraceTag(539800643,327,15,`Para Node ${N} missing comment reference for comment ${I.id}`);return M&&M.pk?!0:(u.ULS.sendTraceTag(539567714,327,15,`Para Node ${N} with missing comment reference for comment ${I.id} is in a invalid state ${M?
"paraNode containingGraph is null":"paraNode is null"}`),!1)}static oDm(I){let H;try{H=y.OutlineElementNavigator.nm(I)}catch(N){u.ULS.sendTraceTag(539567715,327,10,`ParaNode ${I.id} OutlineNode failed to retrieve ${N}`)}return H}static mqm(I){var H;switch(null===(H=I.KA)||void 0===H?void 0:H.sessionType){case f.a.create:return D.a.Kqf;case f.a.reply:return D.a.eXd;case f.a.Oob:return D.a.g5h}}static T1h(I){if(a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForDuplicateReactionUsers",
!0)&&(I=I[1])&&0!==I.length){var H=new Set;for(let N=0;N<I.length;N++)H.add(I[N].UserId);I.length>H.size&&u.ULS.sendTraceTag(521458447,327,15,`Reaction UserList has duplicates: ${I.length-H.size}`)}}}Object(G.a)(F,"CommentDiagnosticHelpers",null,[])},1655:function(G,J,d){d.d(J,"a",function(){return y});G=d(0);var m=d(60),f=d(187),a=d(7),l=d(88),w=d(67);class y{constructor(v,u,x){a.ULS.shipAssertTag(6305502,307,!!v);this.properties=v;this.Ec=u;this.xT=x}AEi(){return this.properties.ja(f.a.mS,"")}Guj(){return!0}J3j(){let v=
!1,u=null;const x=this.AEi();if(this.xT||""!==x)try{({Cka:u,returnValue:v}=this.KAc(x))}catch(z){a.ULS.shipAssertTag(4203138,307,!1),this.Ec.$b(l.a.usa,{["Reason"]:w.a.kmf}),m.a.PT(u)}else a.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Ec.$b(l.a.U4,{["Reason"]:w.a.ACf});return{returnValue:v,KXd:u}}}Object(G.a)(y,"AStringInputImportStrategy",null,[570])},1657:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}m.N8a="GeneralException";m.Nce="InvalidArgument";m.notImplemented=
"NotImplemented";m.MJb="AccessDenied";m.Kun="ItemNotFound";m.Ile="NotSupported";m.kif="ApiNotAvailable";m.xcg="NotAllowed";m.S5n="OperationCancelled";m.H$j="UserNotSignedIn";m.iud="UserAborted";m.v8c="InvalidResourceUrl";m.MWf="InvalidGrant";m.Dpf="ClientError";m.Lyg="ServerError";Object(G.a)(m,"ErrorCodes",null,[])},1658:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f){this.id=f}}Object(G.a)(m,"DesignerPaneToggleData",null,[])},1660:function(G,J,d){d.d(J,"a",function(){return w});
G=d(0);var m=d(1976),f=d(590),a=d(5),l=d(1135);class w{constructor(y){this.fsm=(v,u)=>{const x=this.yGi(v),z=this.Zc.jg(u);return z.zb(x)?(z.ld(x),new m.a(z.currentNode,u,v)):null};this.esm=(v,u)=>{let x=null,z=null;const A=this.yGi(v);u=this.Zc.jg(u);({rootNode:x,Uca:z}=this.CXo(u,v,A,x,z));return x&&z?new m.a(x,z,v):null};this.jsm=v=>{v=this.Zc.jg(v);return(this.Jba(2)||this.Jba(4))&&v.zb(36)?(v.ld(36),this.G9l(v.currentNode)):(this.Jba(8)||this.Jba(16))&&v.zb(37)?(v.ld(37),this.Voi(v.currentNode)):
this.Jba(32)&&v.zb(40)?32:this.Jba(1)&&v.zb(8)?1:0};this.Zc=y;this.H9l=this.jsm;this.s9l=this.fsm;this.r9l=this.esm;this.Z9l=31;this.supportedTypes=this.msm()}xyi(y){const v=[],u=this.H9l(y);if(u){var x=this.s9l(u,y);x&&(v[v.length]=x)}for(const z of this.supportedTypes)z!==u&&z&&(x=this.r9l(z,y))&&(v[v.length]=x);return v}Jba(y){return!!y&&!!(this.Z9l&y)}CXo(y,v,u,x,z){if(y.zb(7)){y.ld(7);if(8===u||37===u||39===u)for(var A=y.Xd();A;){if(A.type===u)if(37===u){if((8===v||16===v)&&v===this.Voi(A)){x=
y.currentNode;break}}else{x=y.currentNode;break}A=y.Fk()}x&&y.WA()&&(A=this.Zc.jg(x),l.b(A,u,v)&&(z=y.currentNode))}return{rootNode:x,Uca:z}}msm(){const y=[];this.Jba(1)&&(y[y.length]=1);this.Jba(2)&&(y[y.length]=2);this.Jba(4)&&(y[y.length]=4);this.Jba(8)&&(y[y.length]=8);this.Jba(16)&&(y[y.length]=16);this.Jba(32)&&(y[y.length]=32);return y}yGi(y){let v=8;switch(y){case 1:case 2:case 4:v=8;break;case 8:case 16:v=37;break;case 32:v=39}return v}Voi(y){y=y.properties.getValue(a.a.n7);return this.Jba(8)&&
1===y?8:this.Jba(16)&&!y?16:0}G9l(y){y=y.getValue(a.a.bmc);return this.Jba(2)&&w.Xjn(y)?2:this.Jba(4)&&w.tjn(y)?4:0}static LG(){return new w(new f.a)}static get instance(){return null!=w.NZg?w.NZg:w.NZg=w.LG()}static Xjn(y){return y&&1!==y&&2!==y?!1:!0}static tjn(y){return 3===y||4===y||5===y?!0:!1}}Object(G.a)(w,"WordFindContextHelper",null,[272])},1661:function(G){function J(){throw Error("setTimeout has not been defined");}function d(){throw Error("clearTimeout has not been defined");}function m(F){if(v===
setTimeout)return setTimeout(F,0);if((v===J||!v)&&setTimeout)return v=setTimeout,setTimeout(F,0);try{return v(F,0)}catch(I){try{return v.call(null,F,0)}catch(H){return v.call(this,F,0)}}}function f(F){if(u===clearTimeout)return clearTimeout(F);if((u===d||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(F);try{return u(F)}catch(I){try{return u.call(null,F)}catch(H){return u.call(this,F)}}}function a(){z&&A&&(z=!1,A.length?x=A.concat(x):D=-1,x.length&&l())}function l(){if(!z){var F=m(a);z=!0;for(var I=
x.length;I;){A=x;for(x=[];++D<I;)A&&A[D].run();D=-1;I=x.length}A=null;z=!1;f(F)}}function w(F,I){this.dem=F;this.Lja=I}function y(){}G=G.exports={};try{var v="function"===typeof setTimeout?setTimeout:J}catch(F){v=J}try{var u="function"===typeof clearTimeout?clearTimeout:d}catch(F){u=d}var x=[],z=!1,A,D=-1;G.nQn=function(F){var I=Array(arguments.length-1);if(1<arguments.length)for(var H=1;H<arguments.length;H++)I[H-1]=arguments[H];x.push(new w(F,I));1!==x.length||z||m(l)};w.prototype.run=function(){this.dem.apply(null,
this.Lja)};G.title="browser";G.browser=!0;G.env={};G.vTp=[];G.version="";G.versions={};G.on=y;G.addListener=y;G.once=y;G.off=y;G.removeListener=y;G.kue=y;G.emit=y;G.Nuj=y;G.Peo=y;G.eA=function(){return[]};G.UTp=function(){throw Error("process.binding is not supported");};G.WWp=function(){return"/"};G.$Up=function(){throw Error("process.chdir is not supported");};G.joq=function(){return 0}},1662:function(G,J,d){(function(m){function f(){try{var T=new Uint8Array(1);T.__proto__={__proto__:Uint8Array.prototype,
y0p:function(){return 42}};return"function"===typeof T.subarray&&0===T.subarray(1,1).byteLength}catch(Z){return!1}}function a(T,Z){if((l.eia?2147483647:1073741823)<Z)throw new RangeError("Invalid typed array length");l.eia?(T=new Uint8Array(Z),T.__proto__=l.prototype):(null===T&&(T=new l(Z)),T.length=Z);return T}function l(T,Z,X){if(!(l.eia||this instanceof l))return new l(T,Z,X);if("number"===typeof T){if("string"===typeof Z)throw Error("If encoding is specified then the first argument must be a string");
return v(this,T)}return w(this,T,Z,X)}function w(T,Z,X,aa){if("number"===typeof Z)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&Z instanceof ArrayBuffer){Z.byteLength;if(0>X||Z.byteLength<X)throw new RangeError("'offset' is out of bounds");if(Z.byteLength<X+(aa||0))throw new RangeError("'length' is out of bounds");Z=void 0===X&&void 0===aa?new Uint8Array(Z):void 0===aa?new Uint8Array(Z,X):new Uint8Array(Z,X,aa);l.eia?(T=Z,T.__proto__=l.prototype):
T=u(T,Z);Z=T}else if("string"===typeof Z){aa=T;T=X;if("string"!==typeof T||""===T)T="utf8";if(!l.PYf(T))throw new TypeError('"encoding" must be a valid string encoding');X=A(Z,T)|0;aa=a(aa,X);Z=aa.write(Z,T);Z!==X&&(aa=aa.slice(0,Z));Z=aa}else Z=x(T,Z);return Z}function y(T){if("number"!==typeof T)throw new TypeError('"size" argument must be a number');if(0>T)throw new RangeError('"size" argument must not be negative');}function v(T,Z){y(Z);T=a(T,0>Z?0:z(Z)|0);if(!l.eia)for(var X=0;X<Z;++X)T[X]=0;
return T}function u(T,Z){var X=0>Z.length?0:z(Z.length)|0;T=a(T,X);for(var aa=0;aa<X;aa+=1)T[aa]=Z[aa]&255;return T}function x(T,Z){if(l.isBuffer(Z)){var X=z(Z.length)|0;T=a(T,X);if(0===T.length)return T;Z.jE(T,0,0,X);return T}if(Z){if("undefined"!==typeof ArrayBuffer&&Z.buffer instanceof ArrayBuffer||"length"in Z)return(X="number"!==typeof Z.length)||(X=Z.length,X=X!==X),X?a(T,0):u(T,Z);if("Buffer"===Z.type&&Q(Z.data))return u(T,Z.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");
}function z(T){if(T>=(l.eia?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(l.eia?2147483647:1073741823).toString(16)+" bytes");return T|0}function A(T,Z){if(l.isBuffer(T))return T.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(T)||T instanceof ArrayBuffer))return T.byteLength;"string"!==typeof T&&(T=""+T);var X=T.length;if(0===X)return 0;for(var aa=!1;;)switch(Z){case "ascii":case "latin1":case "binary":return X;
case "utf8":case "utf-8":case void 0:return M(T).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*X;case "hex":return X>>>1;case "base64":return O(T).length;default:if(aa)return M(T).length;Z=(""+Z).toLowerCase();aa=!0}}function D(T,Z,X){var aa=!1;if(void 0===Z||0>Z)Z=0;if(Z>this.length)return"";if(void 0===X||X>this.length)X=this.length;if(0>=X)return"";X>>>=0;Z>>>=0;if(X<=Z)return"";for(T||(T="utf8");;)switch(T){case "hex":T=Z;Z=X;X=this.length;if(!T||0>T)T=0;if(!Z||0>Z||
Z>X)Z=X;aa="";for(X=T;X<Z;++X)T=aa,aa=this[X],aa=16>aa?"0"+aa.toString(16):aa.toString(16),aa=T+aa;return aa;case "utf8":case "utf-8":return H(this,Z,X);case "ascii":T="";for(X=Math.min(this.length,X);Z<X;++Z)T+=String.fromCharCode(this[Z]&127);return T;case "latin1":case "binary":T="";for(X=Math.min(this.length,X);Z<X;++Z)T+=String.fromCharCode(this[Z]);return T;case "base64":return 0===Z&&X===this.length?Y.fromByteArray(this):Y.fromByteArray(this.slice(Z,X));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":Z=
this.slice(Z,X);X="";for(T=0;T<Z.length;T+=2)X+=String.fromCharCode(Z[T]+256*Z[T+1]);return X;default:if(aa)throw new TypeError("Unknown encoding: "+T);T=(T+"").toLowerCase();aa=!0}}function F(T,Z,X,aa,ia){if(0===T.length)return-1;"string"===typeof X?(aa=X,X=0):2147483647<X?X=2147483647:-2147483648>X&&(X=-2147483648);X=+X;isNaN(X)&&(X=ia?0:T.length-1);0>X&&(X=T.length+X);if(X>=T.length){if(ia)return-1;X=T.length-1}else if(0>X)if(ia)X=0;else return-1;"string"===typeof Z&&(Z=l.from(Z,aa));if(l.isBuffer(Z))return 0===
Z.length?-1:I(T,Z,X,aa,ia);if("number"===typeof Z)return Z&=255,l.eia&&"function"===typeof Uint8Array.prototype.indexOf?ia?Uint8Array.prototype.indexOf.call(T,Z,X):Uint8Array.prototype.lastIndexOf.call(T,Z,X):I(T,[Z],X,aa,ia);throw new TypeError("val must be string, number or Buffer");}function I(T,Z,X,aa,ia){function wa(Qa,ya){return 1===ma?Qa[ya]:Qa.coo(ya*ma)}var ma=1,na=T.length,Fa=Z.length;if(void 0!==aa&&(aa=String(aa).toLowerCase(),"ucs2"===aa||"ucs-2"===aa||"utf16le"===aa||"utf-16le"===aa)){if(2>
T.length||2>Z.length)return-1;ma=2;na/=2;Fa/=2;X/=2}if(ia)for(aa=-1;X<na;X++)if(wa(T,X)===wa(Z,-1===aa?0:X-aa)){if(-1===aa&&(aa=X),X-aa+1===Fa)return aa*ma}else-1!==aa&&(X-=X-aa),aa=-1;else for(X+Fa>na&&(X=na-Fa);0<=X;X--){na=!0;for(aa=0;aa<Fa;aa++)if(wa(T,X+aa)!==wa(Z,aa)){na=!1;break}if(na)return X}return-1}function H(T,Z,X){X=Math.min(T.length,X);for(var aa=[];Z<X;){var ia=T[Z],wa=null,ma=239<ia?4:223<ia?3:191<ia?2:1;if(Z+ma<=X)switch(ma){case 1:128>ia&&(wa=ia);break;case 2:var na=T[Z+1];128===
(na&192)&&(ia=(ia&31)<<6|na&63,127<ia&&(wa=ia));break;case 3:na=T[Z+1];var Fa=T[Z+2];128===(na&192)&&128===(Fa&192)&&(ia=(ia&15)<<12|(na&63)<<6|Fa&63,2047<ia&&(55296>ia||57343<ia)&&(wa=ia));break;case 4:na=T[Z+1];Fa=T[Z+2];var Qa=T[Z+3];128===(na&192)&&128===(Fa&192)&&128===(Qa&192)&&(ia=(ia&15)<<18|(na&63)<<12|(Fa&63)<<6|Qa&63,65535<ia&&1114112>ia&&(wa=ia))}null===wa?(wa=65533,ma=1):65535<wa&&(wa-=65536,aa.push(wa>>>10&1023|55296),wa=56320|wa&1023);aa.push(wa);Z+=ma}T=aa.length;if(T<=S)aa=String.fromCharCode.apply(String,
aa);else{X="";for(Z=0;Z<T;)X+=String.fromCharCode.apply(String,aa.slice(Z,Z+=S));aa=X}return aa}function N(T,Z,X){if(0!==T%1||0>T)throw new RangeError("offset is not uint");if(T+Z>X)throw new RangeError("Trying to access beyond buffer length");}function M(T,Z){Z=Z||Infinity;for(var X,aa=T.length,ia=null,wa=[],ma=0;ma<aa;++ma){X=T.charCodeAt(ma);if(55295<X&&57344>X){if(!ia){if(56319<X){-1<(Z-=3)&&wa.push(239,191,189);continue}else if(ma+1===aa){-1<(Z-=3)&&wa.push(239,191,189);continue}ia=X;continue}if(56320>
X){-1<(Z-=3)&&wa.push(239,191,189);ia=X;continue}X=(ia-55296<<10|X-56320)+65536}else ia&&-1<(Z-=3)&&wa.push(239,191,189);ia=null;if(128>X){if(0>--Z)break;wa.push(X)}else if(2048>X){if(0>(Z-=2))break;wa.push(X>>6|192,X&63|128)}else if(65536>X){if(0>(Z-=3))break;wa.push(X>>12|224,X>>6&63|128,X&63|128)}else if(1114112>X){if(0>(Z-=4))break;wa.push(X>>18|240,X>>12&63|128,X>>6&63|128,X&63|128)}else throw Error("Invalid code point");}return wa}function U(T){for(var Z=[],X=0;X<T.length;++X)Z.push(T.charCodeAt(X)&
255);return Z}function O(T){var Z=Y,X=Z.toByteArray;T=(T.trim?T.trim():T.replace(/^\s+|\s+$/g,"")).replace(P,"");if(2>T.length)T="";else for(;0!==T.length%4;)T+="=";return X.call(Z,T)}function V(T,Z,X,aa){for(var ia=0;ia<aa&&!(ia+X>=Z.length||ia>=T.length);++ia)Z[ia+X]=T[ia];return ia}var Y=d(1078);d(2003);var Q=d(2004);J.dCc=l;J.pQp=function(T){+T!=T&&(T=0);return l.CRh(+T)};J.vNp=50;l.eia=void 0!==m.eia?m.eia:f();J.u5p=l.eia?2147483647:1073741823;l.from=function(T,Z,X){return w(null,T,Z,X)};l.eia&&
(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0}));l.CRh=function(T){y(T);return a(null,T)};l.A4k=function(T){return v(null,T)};l.isBuffer=function(T){return!(null==T||!T.CAk)};l.compare=function(T,Z){if(!l.isBuffer(T)||!l.isBuffer(Z))throw new TypeError("Arguments must be Buffers");if(T===Z)return 0;for(var X=T.length,aa=Z.length,ia=0,wa=Math.min(X,
aa);ia<wa;++ia)if(T[ia]!==Z[ia]){X=T[ia];aa=Z[ia];break}return X<aa?-1:aa<X?1:0};l.PYf=function(T){switch(String(T).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};l.concat=function(T,Z){if(!Q(T))throw new TypeError('"list" argument must be an Array of Buffers');if(0===T.length)return l.CRh(0);var X;if(void 0===Z)for(X=Z=0;X<T.length;++X)Z+=T[X].length;Z=l.A4k(Z);
var aa=0;for(X=0;X<T.length;++X){var ia=T[X];if(!l.isBuffer(ia))throw new TypeError('"list" argument must be an Array of Buffers');ia.jE(Z,aa);aa+=ia.length}return Z};l.byteLength=A;l.prototype.CAk=!0;l.prototype.toString=function(){var T=this.length|0;return 0===T?"":0===arguments.length?H(this,0,T):D.apply(this,arguments)};l.prototype.equals=function(T){if(!l.isBuffer(T))throw new TypeError("Argument must be a Buffer");return this===T?!0:0===l.compare(this,T)};l.prototype.compare=function(T,Z,X,
aa,ia){if(!l.isBuffer(T))throw new TypeError("Argument must be a Buffer");void 0===Z&&(Z=0);void 0===X&&(X=T?T.length:0);void 0===aa&&(aa=0);void 0===ia&&(ia=this.length);if(0>Z||X>T.length||0>aa||ia>this.length)throw new RangeError("out of range index");if(aa>=ia&&Z>=X)return 0;if(aa>=ia)return-1;if(Z>=X)return 1;Z>>>=0;X>>>=0;aa>>>=0;ia>>>=0;if(this===T)return 0;var wa=ia-aa,ma=X-Z,na=Math.min(wa,ma);aa=this.slice(aa,ia);T=T.slice(Z,X);for(Z=0;Z<na;++Z)if(aa[Z]!==T[Z]){wa=aa[Z];ma=T[Z];break}return wa<
ma?-1:ma<wa?1:0};l.prototype.includes=function(T,Z,X){return-1!==this.indexOf(T,Z,X)};l.prototype.indexOf=function(T,Z,X){return F(this,T,Z,X,!0)};l.prototype.lastIndexOf=function(T,Z,X){return F(this,T,Z,X,!1)};l.prototype.write=function(T,Z,X,aa){if(void 0===Z)aa="utf8",X=this.length,Z=0;else if(void 0===X&&"string"===typeof Z)aa=Z,X=this.length,Z=0;else if(isFinite(Z))Z|=0,isFinite(X)?(X|=0,void 0===aa&&(aa="utf8")):(aa=X,X=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var ia=this.length-Z;if(void 0===X||X>ia)X=ia;if(0<T.length&&(0>X||0>Z)||Z>this.length)throw new RangeError("Attempt to write outside buffer bounds");aa||(aa="utf8");for(ia=!1;;)switch(aa){case "hex":Z=Number(Z)||0;aa=this.length-Z;X?(X=Number(X),X>aa&&(X=aa)):X=aa;aa=T.length;if(0!==aa%2)throw new TypeError("Invalid hex string");X>aa/2&&(X=aa/2);for(aa=0;aa<X;++aa){ia=parseInt(T.substr(2*aa,2),16);if(isNaN(ia))break;this[Z+aa]=ia}return aa;case "utf8":case "utf-8":return V(M(T,this.length-Z),this,
Z,X);case "ascii":return V(U(T),this,Z,X);case "latin1":case "binary":return V(U(T),this,Z,X);case "base64":return V(O(T),this,Z,X);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":aa=T;ia=this.length-Z;for(var wa=[],ma=0;ma<aa.length&&!(0>(ia-=2));++ma){var na=aa.charCodeAt(ma);T=na>>8;na%=256;wa.push(na);wa.push(T)}return V(wa,this,Z,X);default:if(ia)throw new TypeError("Unknown encoding: "+aa);aa=(""+aa).toLowerCase();ia=!0}};l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.iSp||
this,0)}};var S=4096;l.prototype.slice=function(T,Z){var X=this.length;T=~~T;Z=void 0===Z?X:~~Z;0>T?(T+=X,0>T&&(T=0)):T>X&&(T=X);0>Z?(Z+=X,0>Z&&(Z=0)):Z>X&&(Z=X);Z<T&&(Z=T);if(l.eia)Z=this.subarray(T,Z),Z.__proto__=l.prototype;else{X=Z-T;Z=new l(X,void 0);for(var aa=0;aa<X;++aa)Z[aa]=this[aa+T]}return Z};l.prototype.coo=function(T){N(T,2,this.length);return this[T]<<8|this[T+1]};l.prototype.Sno=function(){N(void 0,4,this.length);return this[void 0]|this[NaN]<<8|this[NaN]<<16|this[NaN]<<24};l.prototype.jE=
function(T,Z,X,aa){X||(X=0);aa||0===aa||(aa=this.length);Z>=T.length&&(Z=T.length);Z||(Z=0);0<aa&&aa<X&&(aa=X);if(aa===X||0===T.length||0===this.length)return 0;if(0>Z)throw new RangeError("targetStart out of bounds");if(0>X||X>=this.length)throw new RangeError("sourceStart out of bounds");if(0>aa)throw new RangeError("sourceEnd out of bounds");aa>this.length&&(aa=this.length);T.length-Z<aa-X&&(aa=T.length-Z+X);var ia=aa-X;if(this===T&&X<Z&&Z<aa)for(aa=ia-1;0<=aa;--aa)T[aa+Z]=this[aa+X];else if(1E3>
ia||!l.eia)for(aa=0;aa<ia;++aa)T[aa+Z]=this[aa+X];else Uint8Array.prototype.set.call(T,this.subarray(X,X+ia),Z);return ia};l.prototype.fill=function(T,Z,X,aa){if("string"===typeof T){"string"===typeof Z?(aa=Z,Z=0,X=this.length):"string"===typeof X&&(aa=X,X=this.length);if(1===T.length){var ia=T.charCodeAt(0);256>ia&&(T=ia)}if(void 0!==aa&&"string"!==typeof aa)throw new TypeError("encoding must be a string");if("string"===typeof aa&&!l.PYf(aa))throw new TypeError("Unknown encoding: "+aa);}else"number"===
typeof T&&(T&=255);if(0>Z||this.length<Z||this.length<X)throw new RangeError("Out of range index");if(X<=Z)return this;Z>>>=0;X=void 0===X?this.length:X>>>0;T||(T=0);if("number"===typeof T)for(aa=Z;aa<X;++aa)this[aa]=T;else for(T=l.isBuffer(T)?T:M((new l(T,aa)).toString()),ia=T.length,aa=0;aa<X-Z;++aa)this[aa+Z]=T[aa%ia];return this};var P=/[^+\/0-9A-Za-z-_]/g}).call(this,d(1293))},1677:function(G,J,d){G=d(0);var m=d(1300),f=d(2175),a=d(1180),l=d(8),w=d(116),y=d(44),v=d(28),u=d(25),x=d(321),z=d(828),
A=d(1016),D=d(54),F=d(2),I=d(845),H=d(20),N=d(91),M=d(417),U=d(814),O=d(19),V=d(15),Y=d(7),Q=d(416),S=d(935),P=d(396),T=d(2183),Z=d(39),X=function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_CustomProp"};Za.getBaseTypes=function(){return[]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};return Za}(),aa=function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Za.getTypeName=
function(){return"AugLoop_ObservationalAssistance_EntityConfig"};Za.getBaseTypes=function(){return[]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};return Za}(),ia=function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccEntityConfig"};Za.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EntityConfig"]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,
[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};return Za}();(function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccFeatureConfig"};Za.getBaseTypes=function(){return[]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};return Za})();(function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_FeatureConfig"};
Za.getBaseTypes=function(){return[]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};return Za})();var wa=function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_BestMatchConfig"};Za.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),
B_:Za.getBaseTypes()};return Za}(),ma=function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_ScopeConfig"};Za.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};return Za}(),na=function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccConfig"};
Za.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccFeatureConfig"]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};return Za}(),Fa=function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagConfig"};Za.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};
Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};return Za}(),Qa=function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeConfig"};Za.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};return Za}(),ya=function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionConfig"};
Za.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};return Za}(),ta=function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientConfig"};Za.getBaseTypes=function(){return[]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};
return Za}(),Aa=function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Object.defineProperty(Za.prototype,"metadata",{get:function(){return this.M_},set:function(Ya){this.M_=Ya},enumerable:!1,configurable:!0});Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_SessionConfig"};Za.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};return Za}();(function(){function Za(Ya){Z.a.assign(Za,
this,Ya)}Object.defineProperty(Za.prototype,"metadata",{get:function(){return this.M_},set:function(Ya){this.M_=Ya},enumerable:!1,configurable:!0});Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_HostConfig"};Za.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};return Za})();(function(){function Za(Ya){Z.a.assign(Za,this,Ya)}Za.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientMetadata"};
Za.getBaseTypes=function(){return[]};Za.typeGuard=function(Ya){return Z.a.matchesTypesFor(Ya,[Za.getTypeName()])};Za.H_={T_:Za.getTypeName(),B_:Za.getBaseTypes()};return Za})();var oa=d(2184),za=d(1504),ja=d(1503),fa=d(547),Ca=d(1122),xa=d(35);class ua{constructor(){this.a3e=void 0}onKeyPressed(Za){return this.a3e?this.a3e(Za):!1}setKeyPressHandler(Za){this.a3e=Za}}var sa=d(1501),Ea=d(1702),Ja=d(1608),nb=d(1594);d.d(J,"a",function(){return yb});var ub;(function(Za){Za[Za.Hdk=0]="ArrowDown";Za[Za.Idk=
1]="ArrowUp";Za[Za.VKp=2]="ArrowLeft";Za[Za.WKp=3]="ArrowRight";Za[Za.End=4]="End";Za[Za.Jfk=5]="Enter";Za[Za.DMp=6]="Escape";Za[Za.ggk=7]="Home";Za[Za.sQp=8]="Space";Za[Za.Tab=9]="Tab"})(ub||(ub={}));Object(G.b)("KeyIdentifier",ub);var Yb;(function(Za){Za.Seen="Seen";Za.Tried="Tried";Za.Kept="Kept";Za.Rejected="Rejected"})(Yb||(Yb={}));Object(G.b)("EngagementType",Yb);class yb extends A.a{constructor(Za,Ya,Pa,rb,tb,ob,Oa,Xa,ab,cb,ib,Ub,lb,Qb,fc,Fc,nc,zb,Vb){super();this.ga=Za;this.Re=Ya;this.Qd=
Pa;this.fF=rb;this.hb=tb;this.VK=ob;this.MC=Oa;this.QY=Xa;this.Pia=ab;this.h6=ib;this.UM=Ub;this.nHa=lb;this.lnk=Qb;this.Yn=fc;this.nd=Fc;this.QD=nc;this.AH=zb;this.Pc=Vb;this.aOk=0;this.Y8e=!1;this.S0e=1E3;this.cOk=3500;this.aNd="ContextIQSignalId";this.v9e=0;this.Soh=!0;this.asa=()=>{this.Pia.reset();this.XBn()};this.jfd=(rc,pb)=>{for(const Pb of pb.xk)if(rc=Pb.intent,8===rc.type)if(0<=Pb.xUb){rc=rc.Jb.paragraph;var bb=this.Yn.qkc(rc,8,Pb.cpBegin,Pb.cpEnd);1<=bb.count&&bb.J(0)&&(pb=rc.characterData.indexOf("@",
bb.J(0).Fc),bb=rc.characterData.indexOf("/",bb.J(0).Fc),pb=yb.jCc()?this.Pia.cGa&&"/"===this.Pia.cGa?bb:pb:pb,this.Yn.lLg(rc,Pb.cpBegin,Pb.cpEnd),pb=new m.a(8,pb,pb+1,D.a.create()),this.Yn.vMa(rc,pb))}else this.TGa.Vw(V.a.psf,!0,void 0,void 0,void 0,void 0)};cb&&cb.execute(rc=>this.Ypa=rc);this.TGa=new Ca.a;this.Brh=new ua;this.getPersonImageUrl=this.getPersonImageUrl.bind(this);this.Ksi(!0);this.psi();this.Qd.zgf(this.jfd);this.lnk.MNa(this);this.Fia=[new f.a(nb.a.kmb,nb.a.kmb)]}onSessionClose(){}onSessionConnect(){this.Ksi(!1);
this.psi()}onSessionDisconnect(){}get ARb(){return this.Fia}static w5k(Za){return Za.results&&0!==Za.results.length?Za.results[0].entityType===T.a.Topic:!1}static F2i(Za){return yb.Jek()&&Ja.a.s9c(Za)&&this.w5k(Za)?!0:yb.Iek()?Za.isStealth:!1}static X6d(Za){var Ya,Pa;if(0!==(null===(Ya=null===Za||void 0===Za?void 0:Za.results)||void 0===Ya?void 0:Ya.length))return null===(Pa=null===Za||void 0===Za?void 0:Za.results[0])||void 0===Pa?void 0:Pa.entityType}vXa(Za,Ya){return Ja.a.vXa(Za,Ya,fa.a.mnb)}v7a(Za,
Ya){Za=Ja.a.ujc(Za,!1,fa.a.mnb);if(!Za||!Za.contains(Ya))return null;Ya=this.Re.Zka(Ya);return yb.F2i(null===Ya||void 0===Ya?void 0:Ya.content)?nb.a.hSd:nb.a.kmb}dxb(Za){yb.Avd()&&!this.Ly&&(this.Ly=Za,this.nHa.mIa((Ya,Pa)=>{Ya=Pa.paragraphNode;const rb=Pa.hna;for(const tb of Pa.contents)1!=tb.hI&&0!=tb.hI||Ja.a.RRf(tb.element,Ya,tb.intents,this.fTc,this.AEa,this.UM,this.Ly,rb,!1,fa.a.mnb)}))}psi(){const Za=F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1),Ya=F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQSatoriFlags",!1),Pa=F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAddressFlags",!1),rb=F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQTopicFlags",!1),tb=F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQLoopFlags",!1),ob=yb.Bvd()&&yb.WXf?void 0:[Object.assign(new X,{name:"Filter",value:'{"And":[{"Term":{"PeopleType":"Person"}},{"Term":{"PeopleSubtype":"OrganizationUser"}}]}'})],
Oa=["@"];yb.jCc()&&Oa.push("/");const Xa=Object.assign(new S.a,{parentPath:["Signal",oa.a.getTypeName()],items:[Object.assign(new Q.a,{id:"ClientConfigSignal",body:Object.assign(new oa.a,{timestamp:Date.now(),parentPath:"Canvas",sessionConfig:Object.assign(new Aa,{clientConfig:Object.assign(new ta,{ecc:Object.assign(new na,{enabled:yb.Cvd()||yb.Bvd(),entities:[Object.assign(new ia,{entityType:T.a.People,enabled:!0,queryPrefix:Oa,customProps:ob}),Object.assign(new ia,{entityType:T.a.File,enabled:!0,
queryPrefix:Oa}),Object.assign(new ia,{entityType:T.a.Loop,enabled:Za,queryPrefix:Oa})],bestMatch:Object.assign(new wa,{enabled:yb.sQg()}),scopes:Object.assign(new ma,{enabled:!1})}),flag:Object.assign(new Fa,{enabled:yb.Avd(),entities:[Object.assign(new aa,{entityType:T.a.Loop,enabled:Za&&tb}),Object.assign(new aa,{entityType:T.a.Topic,enabled:rb}),Object.assign(new aa,{entityType:T.a.Address,enabled:Pa}),Object.assign(new aa,{entityType:T.a.Satori,enabled:Ya})]}),nudge:Object.assign(new Qa,{enabled:!1}),
prediction:Object.assign(new ya,{enabled:!1})})})})})]});this.MC.Pl().then(()=>{this.QY.getAugLoopRuntimeManager().submitOperation(Object.assign(new P.a,{operation:Xa}));Y.ULS.sendTraceTag(520104021,3034,50,"Submitted ClientConfigSignal Operation.")})}Ksi(Za){const Ya=Object.assign(new S.a,{parentPath:["Signal",oa.b.getTypeName()],items:[Object.assign(new Q.a,{id:"SessionStartupSignal",body:Object.assign(new oa.b,{timestamp:Date.now()})})]});this.MC.Pl().then(()=>{Za&&this.LE();this.QY.getAugLoopRuntimeManager().submitOperation(Object.assign(new P.a,
{operation:Ya}));Y.ULS.sendTraceTag(521412674,3034,50,"Submitted StartupSignal Operation.")})}LE(){yb.Cvd()&&(F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQUseEccResultAnnotation",!1)?(this.Re.nb(this,za.a.getTypeName()),Y.ULS.sendTraceTag(521412673,3034,50,"Registered for EccResultAnnotations.")):(this.Re.nb(this,za.d.getTypeName()),Y.ULS.sendTraceTag(521412672,3034,50,"Registered for UserInitiatedResultAnnotations.")));yb.Avd()&&(this.Re.nb(this,za.b.getTypeName()),
Y.ULS.sendTraceTag(512361884,3034,50,"Registered for FlagResultAnnotations."))}lup(Za,Ya,Pa,rb,tb){const ob=void 0===Ya?!1:this.v9e>Ya;this.rj.zI&&!ob&&(Za=this.ssi(Za),rb&&Za.suggestionGroups&&0<Za.suggestionGroups.length&&(Za.suggestionGroups[0].previewData=rb.substring(tb+1,rb.length)),this.rj.definition=Za,Ya&&(this.v9e=Ya));Ya?(rb=Date.now(),Pa=[Object.assign(new xa.a,{name:this.aNd,string:Pa}),Object.assign(new xa.a,{name:"ContextIQMenuOpen",bool:this.rj.zI}),Object.assign(new xa.a,{name:"ContextIQStaleAnnotation",
bool:ob})],this.TGa.gcd("ContextIQUserInitUserPerceivedLatency",rb-Ya,1,!0,void 0,Pa)):Y.ULS.sendTraceTag(537966025,3034,15,"SignalGenerationTime is undefined, can not determine if this annotation is stale or generate User Perceived Latency telemetry.")}ssi(Za){if(Za){var Ya=[],Pa=[];switch(Za.annotationType){case za.d.getTypeName():var rb=Za.content;if(!rb)return;for(var tb of rb.results)Ya=Ya.concat(tb.results);rb=fa.a.P6a;break;case za.a.getTypeName():tb=Za.content;if(!tb)return;for(const ob of tb.entityResults)Ya=
Ya.concat(ob.entities);yb.sQg()&&(Pa=null===(rb=tb.treatments)||void 0===rb?void 0:rb.bestMatchEntries);rb=fa.a.P6a;break;case ja.a.getTypeName():Ya=Ya.concat(Za.content.results);rb=fa.a.mnb;break;default:return}Za={annotationId:Za.id,results:Ya,bestMatchResults:Pa};if(Ya=this.Soh)this.Soh=!1;return{...x.g,id:rb,suggestionGroups:[{type:rb,isContentPending:!1,contentData:Za,isFirstInvoke:Ya}]}}}async getPersonImageUrl(Za,Ya){Za=new I.a(Za,"O365",Ya,Za);if(this.Ypa&&this.Ypa.getPersonaIconPropertiesArray&&
(Za=await this.Ypa.getPersonaIconPropertiesArray([Za]),0<Za.length&&Za[0].authorImageURL))return Za[0].authorImageURL}static KHe(){return yb.Cvd()||yb.Avd()}static Cvd(){return yb.DHe&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAtMentionEntryPointIsEnabled",!1)}static Bvd(){return yb.DHe&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQConsumerAtMentionEntryPointIsEnabled",!1)}static Avd(){return yb.DHe&&F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQFlagsAreEnabled",
!1)}static Iek(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQStealthFlagsAreEnabled",!1)}static sQg(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQBestMatchIsEnabled",!1)}static Jek(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQTopicFlagsLimitIsEnabled",!1)}static jCc(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQSlashInvoke",
!1)}static Kek(){return F.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQUnderlineIsEnabled",!1)}static DHe(){return!H.a.XR&&!H.a.K7}static get Deb(){return yb.bOk}C8o(Za){if(this.Ypa){var Ya={...x.g,id:fa.a.P6a,suggestionGroups:[{type:fa.a.P6a,isContentPending:!0,contentData:{annotationId:"",results:[]}}]},Pa=!1;this.ga.d3(V.a.M_a)&&(Pa=!0);this.rj.Ona(Za,Ya,this,!0,!1,null,this.asa,null,!1,rb=>{rb.shouldIgnoreFocusEvent=tb=>{var ob;return this.Y8e?!0:tb===(null===
(ob=this.nd.Ke)||void 0===ob?void 0:ob.editingElement)};rb.getPersonImageUrl=this.getPersonImageUrl},Pa,!1,this.Brh)}else Y.ULS.sendTraceTag(539068165,3034,15,"PeopleAPI was not ready in time for showing a User Init Context IQ Card")}d4h(){this.rj.dismiss()}onKeyDown(Za){if(Za&&Za.Kb){switch(Za.Kb.keyCode){case N.a.aia:var Ya=ub.Hdk;break;case N.a.cO:Ya=ub.End;break;case N.a.Mu:Ya=ub.Jfk;break;case N.a.x9:Ya=ub.ggk;break;case N.a.xz:Ya=ub.Tab;break;case N.a.y9:Ya=ub.Idk}void 0!==Ya&&(Za.Kb.stopPropagation(),
Za.Kb.preventDefault(),this.Brh.onKeyPressed(Ya))}}lD(Za,Ya){if(Za&&Za.content&&Ya===z.a.getTypeName()&&(Za.annotationType===za.d.getTypeName()||Za.annotationType===za.a.getTypeName())){var Pa=Ya=void 0,rb=void 0,tb=0,ob=Za.parentPath.split("\\");if(ob&&7===ob.length)if(Pa=ob[ob.length-1],ob=Date.now(),Pa in yb.Deb){clearTimeout(yb.Deb[Pa].bkp);Ya=yb.Deb[Pa].startTime;rb=yb.Deb[Pa].U8o;tb=yb.Deb[Pa].Yqe;delete yb.Deb[Pa];const Oa=[Object.assign(new xa.a,{name:this.aNd,string:Pa})];this.TGa.gcd("ContextIQUserInitALLatency",
ob-Ya,1,!0,void 0,Oa)}else Y.ULS.sendTraceTag(537962376,3034,15,"SignalId is not in the dictionary, can not generate AL Latency telemetry.");else Y.ULS.sendTraceTag(537966026,3034,15,"Annotation's parent path is not the expected length of 7. Can not generate AL Latency telemetry.");this.lup(Za,Ya,Pa,rb,tb)}}get types(){return[fa.a.P6a,fa.a.mnb]}SLg(Za,Ya){this.rj.zI&&this.rj.SLg(Za,Ya)}get fTc(){return!M.SessionStatusManager.instance.Gk&&1!=F.AFrameworkApplication.ua.mode}AEa(Za){return Za&&Ja.a.s9c(Za)?
!Ea.a.ddc(Za):!1}GS(Za){if(yb.KHe()){var Ya,Pa;if(M.SessionStatusManager.instance.Gk||!this.fTc||!({annotation:Ya,fif:Pa}=this.UM.V2d(Za.jn,Za.gCf,this.AEa)).returnValue)return!1;if(Ya.annotationType===ja.a.getTypeName()){let rb=!1;this.ga.d3(V.a.M_a)&&(rb=!0);const tb=this.ssi(Ya);Za=this.rj.Ona(Pa,tb,this,Za.ZXa,Za.bVa,null,ob=>{(null===ob||void 0===ob?void 0:ob.cardType)===fa.a.mnb&&(null===ob||void 0===ob?0:ob.$6f)&&this.TGa.Vw(V.a.PXd,!0,void 0,void 0,void 0,void 0,{ZAf:Yb.Tried,entityType:yb.X6d(Ya.content)})},
null,!1,null,rb);this.rj.F_b({$6f:!0,cardType:fa.a.mnb});Za&&this.TGa.Vw(V.a.PXd,!0,void 0,void 0,void 0,void 0,{ZAf:Yb.Seen,entityType:yb.X6d(Ya.content)});return Za}return!1}}Upp(Za,Ya){this.Re.fFa(Za,70);const Pa=this.QD.twi(Za,0);if(Pa){const rb=new a.a;rb.contentDescriptor=Pa;rb.annotationType=Za.annotationType;rb.state=70;this.AH.setState(Ya,rb)}}executeAction(Za,Ya,Pa,rb){var tb,ob,Oa,Xa=Date.now();if(!Ya)return!1;var ab=null===(tb=this.rj.definition)||void 0===tb?void 0:tb.id;switch(Za.actionType){case x.b.Apply:this.rj.F_b({cardType:ab,
$6f:!1});this.P$d(Za.descriptorData,Ya,Pa,rb);ab===fa.a.mnb&&(Ya={ZAf:Yb.Kept,entityType:yb.X6d(null===(ob=this.Re.Zka(Za.descriptorData.annotationId))||void 0===ob?void 0:ob.content)},this.TGa.Vw(V.a.PXd,!0,void 0,void 0,void 0,void 0,Ya));this.d4h();break;case x.b.ClearSearch:this.Y8e=!0;this.TIa(Ya,Pa,rb,!1);this.rj.zI&&(this.LUj(),ab=l.ParagraphReader.text(Ya).substring(0,Pa+1),this.AGf(Ya,ab,Pa,Xa));this.Y8e=!1;break;case x.b.Retry:this.rj.zI&&(this.LUj(),ab=l.ParagraphReader.text(Ya).substring(0,
rb),this.AGf(Ya,ab,Pa,Xa));break;case x.b.OpenEditorPane:if(32!==this.ga.Ob(V.a.M_a,2))return Y.ULS.sendTraceTag(520898381,3034,15,"Failed to launch the editor pane from contextual card.",Za.actionType),!1;break;case x.b.IgnoreOnce:Pa=this.Re.Zka(null===(Oa=Za.descriptorData)||void 0===Oa?void 0:Oa.annotationId);this.Upp(Pa,Ya.Lc);Xa=this.Pc.Mc(3);try{Xa.Ab(Ya),Ya.om(16,!0)}finally{Xa&&Xa.dispose()}this.TGa.Vw(V.a.PXd,!0,void 0,void 0,void 0,void 0,{ZAf:Yb.Rejected,entityType:yb.X6d(Pa.content)});
this.rj.F_b({$6f:!1,cardType:ab});this.rj.dismiss();break;default:return Y.ULS.sendTraceTag(539849408,3034,15,"Failed to process action of type {0} since it is not known to us.",Za.actionType),!1}return!0}AGf(Za,Ya,Pa,rb){var tb,ob,Oa=Pa.toString();const Xa=Za.id.toString(),ab=Xa+"-"+Oa;var cb=++this.aOk;const ib=ab+"-"+cb;cb=(cb=w.FormattingReader.U6d(Za,Pa,l.ParagraphReader.textLength(Za)))?w.FormattingReader.language(cb):F.AFrameworkApplication.lcid;cb=null!==(ob=null===(tb=U.a.Cg(cb))||void 0===
tb?void 0:tb.O4d)&&void 0!==ob?ob:"";Ya.length>this.S0e&&(Pa-=Ya.length-this.S0e,Ya=Ya.slice(-this.S0e));tb=yb.jCc()?{prefix:this.Pia.cGa,start:Pa,length:Ya.length-Pa}:void 0;const Ub=Object.assign(new S.a,{parentPath:["Canvas","Signal",sa.a.getTypeName(),Xa,Oa,ab],items:[Object.assign(new Q.a,{id:ib,body:Object.assign(new sa.a,{languageId:cb,startOfSentence:!0,text:Ya,timestamp:Date.now(),userInitQuery:!0,queryRange:tb})})]});this.MC.Pl().then(()=>{this.QY.getAugLoopRuntimeManager().submitOperation(Object.assign(new P.a,
{operation:Ub}));Y.ULS.sendTraceTag(521412643,3034,50,"Submitted Text Predictor Signal.");const lb=[Object.assign(new xa.a,{name:this.aNd,string:ib})];this.TGa.gcd("ContextIQUserInitSignalGenerationLatency",Date.now()-rb,1,!0,void 0,lb)});("@"===Ya.slice(-1)||yb.jCc&&"/"===Ya.slice(-1))&&Pa===Ya.length-1&&(Oa=this.Yn.qkc(Za,8,Pa,Pa))&&0===Oa.count&&(Oa=new m.a(8,Pa,Pa+1,D.a.create()),this.Yn.vMa(Za,Oa));Za=setTimeout(()=>{this.l6o(ib)},this.cOk);yb.Deb[ib]={startTime:rb,U8o:Ya,Yqe:Pa,bkp:Za}}cxp(){if(this.rj.zI&&
this.rj.definition&&this.rj.definition.suggestionGroups&&this.rj.definition.suggestionGroups[0]){const Za=this.rj.definition;Za.suggestionGroups[0].isContentPending=!0;this.rj.definition=Za}}LUj(){this.rj.definition={...x.g,id:fa.a.P6a,suggestionGroups:[{type:fa.a.P6a,isContentPending:!0,contentData:{annotationId:"",results:[]}}]}}l6o(Za){if(Za in yb.Deb){var Ya=yb.Deb[Za].startTime;Ya=void 0===Ya?!1:this.v9e>Ya;!Ya&&this.rj.zI&&(this.rj.definition={...x.g,id:fa.a.P6a,suggestionGroups:[{type:fa.a.P6a,
isContentPending:!1,errorMessage:"No results received from AugLoop",contentData:{annotationId:"",results:[]}}]});Za=[Object.assign(new xa.a,{name:this.aNd,string:Za}),Object.assign(new xa.a,{name:"ContextIQMenuOpen",bool:this.rj.zI}),Object.assign(new xa.a,{name:"ContextIQStaleSignal",bool:Ya})];this.TGa.gcd("ContextIQUserInitALTimeout",1,0,!0,void 0,Za)}}P$d(Za,Ya,Pa,rb){var tb=Za.type;switch(tb){case T.a.File:this.QR(Ya,Pa,rb,Za.fileName,Za.url+"?web=1");break;case T.a.People:yb.WXf?this.QR(Ya,
Pa,rb,Za.displayName,"mailto:"+Za.primaryEmailAddress):this.spp(Za,Ya,Pa,rb);break;case T.a.Loop:this.r$m(Za,Ya,Pa,rb);break;case T.a.Address:this.l9m(Za,Ya,Pa,rb);break;case T.a.Satori:tb="https://www.bing.com/search?q="+Za.title.replace(" ","+");this.QR(Ya,Pa,rb,Za.title,tb);break;case T.a.Topic:this.QR(Ya,Pa,rb,Za.title,Za.url);break;default:Y.ULS.sendTraceTag(539849409,3034,15,"Failed to process entity of type {0} since it is not known to us.",tb)}}spp(Za,Ya,Pa,rb){const tb=Za.primaryEmailAddress,
ob=new I.a(tb,"O365",Za.displayName,tb);this.Ypa.checkUserAccess(ob).then(Oa=>{Oa.UserCanWrite?(Y.ULS.sendTraceTag(539100301,3034,50,"User has the correct permissions to be AtMentioned"),this.c8c(Ya,Pa,rb,ob)):this.$3j(ob,Ya,Pa,rb)},()=>{Y.ULS.sendTraceTag(539100302,3034,15,"Got back failed response from checking user access for AtMentioned User");this.$3j(ob,Ya,Pa,rb)})}$3j(Za,Ya,Pa,rb){this.Ypa.grantUsersAccess([Za]).then(tb=>{let ob=!1;tb.Details&&(ob=tb.Details.Result[0].UserCanWrite);ob?(Y.ULS.sendTraceTag(539100303,
3034,50,"AtMentioned User has been granted access"),this.c8c(Ya,Pa,rb,Za)):(Y.ULS.sendTraceTag(539100304,3034,50,"AtMentioned user has been denied access"),this.TIa(Ya,Pa,rb,!0))},()=>{Y.ULS.sendTraceTag(539100305,3034,15,"Failed Response from Attempt to grant access to AtMentioned user")})}c8c(Za,Ya,Pa,rb){this.Yn.lLg(Za,Ya,Pa);this.TGa.Vw(V.a.psf,!0,void 0,void 0,void 0,void 0);this.VK.c8c(Za,Ya,Pa,rb.DisplayName,rb.Email)}QR(Za,Ya,Pa,rb,tb){if(Za){var ob=new y.GraphTransaction(15),Oa=rb+" ";try{ob.Ab(Za);
this.Yn.lLg(Za,Ya,Pa);this.TGa.Vw(V.a.psf,!0,void 0,void 0,void 0,void 0);this.Qd.Ne(v.a.createTextRange(Za,Ya,Pa),Oa);const Xa=O.a.vmc(tb);this.fF.vF(v.a.createTextRange(Za,Ya,Ya+rb.length),Xa,!1,!1,!1);this.hb.Ic(u.SelectionFactory.se(Za,Ya+Oa.length))}finally{ob&&ob.dispose()}}else Y.ULS.sendTraceTag(509612897,3034,15,"Paragraph node is undefined/null.")}r$m(Za,Ya,Pa,rb){if(Ya){var tb=new y.GraphTransaction(15);try{tb.Ab(Ya);this.Qd.Ne(v.a.createTextRange(Ya,Pa,rb),"");this.hb.Ic(u.SelectionFactory.se(Ya,
Pa));const ob=Za.id;ob===fa.a.FGn?this.ga.Ob(V.a.i8c,2):ob===fa.a.CGn?this.ga.Ob(V.a.W7c,2):ob===fa.a.EGn?this.ga.Ob(V.a.sce,2):Y.ULS.sendTraceTag(537458136,3034,15,"Trying to insert unsupported loop type.")}finally{tb&&tb.dispose()}}else Y.ULS.sendTraceTag(537458135,3034,15,"Paragraph node is undefined/null.")}l9m(Za,Ya,Pa,rb){if(Ya){var tb=new y.GraphTransaction(15);try{tb.Ab(Ya);const ob=O.a.vmc(Za.url);this.fF.vF(v.a.createTextRange(Ya,Pa,rb),ob,!1,!1,!1);this.hb.Ic(u.SelectionFactory.se(Ya,rb));
const Oa=this.Re.Zka(Za.annotationId);this.Re.fFa(Oa,60)}finally{tb&&tb.dispose()}}else Y.ULS.sendTraceTag(509434014,3034,15,"Paragraph node is undefined/null.")}TIa(Za,Ya,Pa,rb){if(Za){var tb=new y.GraphTransaction(15);rb||(Ya+=1);try{tb.Ab(Za),this.Qd.Ne(v.a.createTextRange(Za,Ya,Pa),""),this.hb.Ic(u.SelectionFactory.se(Za,Ya))}finally{tb&&tb.dispose()}}else Y.ULS.sendTraceTag(529413333,3034,15,"Paragraph node is undefined/null.")}XBn(){this.h6.execute(Za=>{Za.logActivity("CIQ_AtInvoke",null)})}}
yb.WXf=!1;yb.bOk={};Object(G.a)(yb,"ContextIQIntentProvider",A.a,[223,249])},1678:function(G,J,d){var m=d(1600);G=d(0);class f{}Object(G.a)(f,"SerializableAnchorDataV1",null,[]);class a{}Object(G.a)(a,"SerializableCpDataV1",null,[]);var l=d(1062);d.d(J,"a",function(){return w});d.d(J,"c",function(){return y});d.d(J,"b",function(){return v});d.d(J,"d",function(){return u});const w=x=>new m.a(x.RK,x.PS,x.TS,d(1705).versionedDeserialize(x.OS),x.PE,x.TE,d(1705).versionedDeserialize(x.OE),x.DK,x.SI),y=
x=>{const z=new f;z.RK=x.Ate;z.PS=x.iZa;z.TS=x.bfb;z.DK=x.TJ;z.SI=x.shapeId;x.ZU&&(z.OS=u(x.ZU));x.jNa&&(z.PE=x.jNa);x.Hzc&&(z.TE=x.Hzc);x.h8&&(z.OE=u(x.h8));return z},v=x=>{if(!x)return null;const z=new l.a(x.CP);z.UAa=null!=x.FB?x.FB:0;z.Rka=null!=x.FE?x.FE:0;z.Sza=null!=x.CB?x.CB:0;z.Tza=null!=x.CE?x.CE:0;z.PWa=null!=x.HB?x.HB:0;z.Ala=null!=x.HE?x.HE:0;z.hEa=null!=x.R?x.R:0;z.QAa=null!=x.E?x.E:0;z.REa=null!=x.TW?x.TW:0;z.zDa=null!=x.PB?x.PB:0;z.symbols=null!=x.SYM?x.SYM:0;z.dCa=null!=x.IE?x.IE:
0;z.gDa=null!=x.OO?x.OO:0;z.$ya=null!=x.AX?x.AX:0;z.iJa=null!=x.CCI?x.CCI:0;z.dryDeletion=null!=x.DD?x.DD:0;return z},u=x=>{if(!x)return null;const z=new a;z.CP=x.cp;z.VS=1;0<x.UAa&&(z.FB=x.UAa);0<x.Rka&&(z.FE=x.Rka);0<x.Sza&&(z.CB=x.Sza);0<x.Tza&&(z.CE=x.Tza);0<x.PWa&&(z.HB=x.PWa);0<x.Ala&&(z.HE=x.Ala);0<x.hEa&&(z.R=x.hEa);0<x.QAa&&(z.E=x.QAa);0<x.REa&&(z.TW=x.REa);0<x.zDa&&(z.PB=x.zDa);0<x.symbols&&(z.SYM=x.symbols);0<x.dCa&&(z.IE=x.dCa);0<x.gDa&&(z.OO=x.gDa);0<x.$ya&&(z.AX=x.$ya);0<x.iJa&&(z.CCI=
x.iJa);0<x.dryDeletion&&(z.DD=x.dryDeletion);return z}},1688:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a="",l="",w=""){this.IsCurrentUser=!1;this.UserId=f;this.Provider=a;this.DisplayName=l;this.Email=w}}Object(G.a)(m,"CommentTaskPerson",null,[1487])},1689:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a,l,w,y=!1){this.priority=this.completion=-1;this.type=f;this.user=a;this.time=l;this.recordId=w;this.isLossy=y}}Object(G.a)(m,"HistoryRecord",
null,[])},1690:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.RQa={};this.RQa.ops=[]}Ila(f){const a=this.RQa.ops;if(a.length){var l=a.length-1;const w=a[l];if(!w.attributes){w.insert+=f;a[l]=w;this.RQa.ops=a;return}}l={};l.insert=f;Array.add(a,l)}mWf(f,a){const l={};this.wPj(l,a);Array.add(this.RQa.ops,this.Yfc(f,l))}RVf(f,a,l,w=!1){var y={};y.fullName=a.fullName;y.email=a.email;y.resolveState=a.resolveState;a={};a.atmention=y;f=this.Yfc(f,a);l&&(y={},y.contentId=
l.contentId,a={},a.atmention=y,w&&(y.isCurrentUser=l.isCurrentUser),f.optional=a);Array.add(this.RQa.ops,f)}cnc(f,a){f=this.Yfc(f,{});const l={};l.base64=a.base64;a={};a.image=l;f.optional=a;Array.add(this.RQa.ops,f)}ZSi(f,a){const l={};l.link=a.link;this.wPj(l,a);Array.add(this.RQa.ops,this.Yfc(f,l))}Ujc(){return Sys.Serialization.JavaScriptSerializer.serialize(this.RQa)}Yfc(f,a){const l={};l.insert=f;l.attributes=a;return l}wPj(f,a){this.B_b(a.weight>=m.Idd,f,"weight",a.weight);this.B_b(a.italic,
f,"italic",!0);this.B_b(a.underline,f,"underline",!0);this.B_b(a.strikethrough,f,"strikethrough",!0);this.B_b(!!a.highlight,f,"highlight",a.highlight);this.B_b(!!a.color,f,"color",a.color);this.B_b(!!a.paragraph,f,"paragraph",a.paragraph)}B_b(f,a,l,w){f&&(a[l]=w)}static Iqb(f){return Sys.Serialization.JavaScriptSerializer.deserialize(f,!0)}}m.Idd=700;Object(G.a)(m,"DeltaFormatCreator",null,[1444])},1691:function(G,J,d){d.d(J,"a",function(){return a});G=d(0);var m=d(636),f=d(426);class a{constructor(l=
!1){this.DP=null;this.d$a=!1;l&&(this.DP=new m.a(new f.a))}}Object(G.a)(a,"OpenCommentInfo",null,[])},1692:function(G,J,d){d.d(J,"b",function(){return u});d.d(J,"a",function(){return x});d.d(J,"c",function(){return z});d.d(J,"d",function(){return A});d.d(J,"e",function(){return D});var m=d(20),f=d(2),a=d(125),l=d(7),w=d(492),y=d(363),v=d(266);const u=()=>m.a.ju,x=()=>void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1,z=F=>!!F&&F.isConnected,A=(F,I,H,N)=>{if(!I||!I.isConnected)return F.dispose(),
!1;const M=I.Jj(),U=I.ja(a.a.lK,v.a.Hu),O={};O[w.a.nodeId]=I.id.toString();O[w.a.cellId]=M.pl.toString();O[w.a.fileId]=M.kq;O[w.a.zza]=M.yg.Is.toString();O[w.a.kK]=M.yg.kK;O[w.a.v_]=H.toString();O[w.a.lcid]=f.AFrameworkApplication.lcid.toString();O[w.a.accessToken]=f.AFrameworkApplication.accessToken;O[w.a.classId]=I.yc.toString();O[w.a.lK]=U;N=N||{};for(const V of y.a(N))O[V]=N[V];for(const V of y.a(O))F.Vfc(V,O[V]);return!0},D=(F,I,H)=>{const N={};N.IsResponseNull=!I;I&&(N.OperationResult=I.StatusCode,
N.RevisionListLength=I.RevisionList?I.RevisionList.length.toString():"null");l.ULS.sendTraceTag(36783366,322,50,"UploadResponseReceived: {0}",N);H&&H.isConnected&&(I&&!I.StatusCode?(H.CL().yg.dD(null,null,null),F.kNg()):F.bYb(null,I?I.StatusCode:14))}},1693:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,l,w,y){void 0===y&&(y=w);Object.defineProperty(a,y,{enumerable:!0,get:function(){return l[w]}})}:function(a,l,w,y){void 0===y&&(y=w);a[y]=l[w]}),f=this&&this.__exportStar||function(a,
l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1950),J);f(d(1951),J)},1694:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(G.a)(m,"InsightsParameters",null,[])},1697:function(G,J,d){d.d(J,"a",function(){return m});d.d(J,"b",function(){return f});G=d(0);var m;(function(a){a[a.Unknown=-1]="Unknown";a[a.RPp=0]="RichText";
a[a.kPp=1]="PlainText";a[a.iPp=2]="Picture";a[a.uLp=3]="ComboBox";a[a.sMp=4]="DropDownList";a[a.iLp=5]="BuildingBlockGallery";a[a.Date=6]="Date";a[a.HPp=7]="RepeatSectionItem";a[a.rLp=8]="CheckBox";a[a.GPp=9]="RepeatSection";a[a.Tdk=10]="Bibliography";a[a.zQp=11]="TableOfContents";a[a.Yhk=12]="NumberOfContentControlKinds"})(m||(m={}));Object(G.b)("ContentControlKind",m);const f=a=>{for(let l=0;l<m.Yhk;++l)if(m[l]===a)return l;return m.Unknown}},1698:function(G,J,d){d.d(J,"c",function(){return y});
d.d(J,"b",function(){return v});d.d(J,"a",function(){return u});var m=d(41),f=d(752),a=d(76),l=d(66),w=d(295);const y=(x,z,A)=>{var D=x.characterData.length;if(z>A||A>D)return null;a:{for(F of x.jJ)if(D=F.jc,D.te&&D===Object(l.a)().zd){var F=D;break a}F=null}if(!F)return null;F=x.nl(F.oc);if(!F)return null;D=[];x=x.qa;for(let H=x.h3(z);H<x.length;H++){var I=x.J(H);if(I.cp>A||I.cp===A&&z!==A)break;(I=w.a.xBa(F,I.cp))&&0>Array.indexOf(D,I)&&D.push(I)}return D},v=x=>{let z=null;for(const D of x){var A=
m.a.getElementBounds(D);z?(x=z,x.x>A.x&&(x.x=A.x),x.x+x.width<A.x+A.width&&(x.width=A.x+A.width-x.x),x.y>A.y&&(x.y=A.y),x.y+x.height<A.y+A.height&&(x.height=A.y+A.height-x.y)):z=A}z||(z=new Sys.UI.Bounds(0,0,0,0));return z},u=(x,z)=>{x=v(x);if(!x.width&&!x.height)return null;const A=document.createElement("div");A.id=z;A.style.position="absolute";A.style.left=x.x+"px";A.style.top=x.y+"px";A.style.width=x.width+"px";A.style.height=x.height+"px";A.style.zIndex="-9999";a.d(A,f.a.ZTa,"true");return A}},
1699:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,l,w,y){void 0===y&&(y=w);Object.defineProperty(a,y,{enumerable:!0,get:function(){return l[w]}})}:function(a,l,w,y){void 0===y&&(y=w);a[y]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1970),J);f(d(1971),J);f(d(1972),J);f(d(1973),J);f(d(1974),J)},1700:function(G,J,d){d.d(J,"a",function(){return m});
G=d(0);class m{constructor(f){this.source=f}}Object(G.a)(m,"AcceptAllActionData",null,[])},1702:function(G,J,d){d.d(J,"a",function(){return U});G=d(0);var m=d(766),f=d(28),a=d(23),l=d(17),w=d(25),y=d(8),v=d(11),u=d(673),x=d(592),z=d(262),A=d(84),D=d(77),F=d(122),I=d(1295),H=d(1609),N=d(1503),M=d(1608);class U{constructor(O,V,Y,Q,S,P,T){this.ESa=O;this.hb=V;this.Yn=Y;this.so=Q;this.Phb=S;this.Sxk=P;this.w6b=T}Isa(O){return(O=this.so.Isa(O))&&Object(A.a)(m.a,O.errorDetails)&&!O.errorDetails.jab()?O:
null}HKa(O){return this.Phb.HKa(O)}KGf(O){if(!O)return null;if(u.a(O.annotationType)){if((O=O.content)&&O.suggestions&&!U.ddc(O))return O}else if(O.annotationType===x.a.getTypeName()){if((O=O.content)&&O.suggestions)return O}else if(O.annotationType===N.a.getTypeName()&&(O=O.content)&&O.results)return O;return null}V2d(O,V,Y){let Q=null,S=null,P=null;var T=this.Yn.G3c(O,0);if(!T||!T.count)return{returnValue:!1,annotation:Q,wwj:S,fif:P};for(const Z of T){if(V&&(Z.Fc!==O.cpBegin||Z.end!==O.cpEnd))continue;
T=this.KGf(Z.intent);if(!T||Y&&!Y(T))continue;let X;({stop:X}=U.CTj(S,T)).returnValue&&(Q=Z.intent,S=T,P=f.a.createTextRange(O.node,Z.Fc,Z.end));if(X)break}return{returnValue:!!S,annotation:Q,wwj:S,fif:P}}Ysi(O,V){let Y=null,Q=null;for(const S of O){if(S.type)continue;O=this.KGf(S.intent);if(!O||V&&!V(O))continue;let P;({stop:P}=U.CTj(Y,O)).returnValue&&(Y=O,Q=S.intent);if(P)break}return Q}kJi(O,V,Y,Q,S){const P=new D.a;if(Q.Jbe){var T=this.Yn.fWa(O,0,Z=>{if(V>Z.Fc||Z.Fc>Y)return!1;Z=this.KGf(Z.intent);
return!Z||U.ddc(Z)||Q.Ijd&&!Q.Ijd(Z)?!1:!0});for(const Z of T)P.add(Z)}if(Q.Ibe){T=this.so.u7(O,Z=>{if(V>Z.Fc||Z.Fc>Y)return!1;Z=Z.errorDetails;return Z.jab()||Q.zid&&!Q.zid(Z)?!1:!0});for(const Z of T)P.add(Z)}if(Q.Gbe){O=this.Phb.pJf(O,Z=>V>Z.Fc||Z.Fc>Y||Q.gZc&&!Q.gZc(Z.uF)?!1:!0);for(const Z of O)P.add(Z)}P.Sc(S);return P}sJf(O,V){return Math.min(Math.abs(V-O.Fc),Math.abs(V-O.end))}rBm(O,V,Y,Q){let S,P=0;Q?(Q=0,S=V-1):(Q=V+1,S=O.characterData.length);Y=this.kJi(O,Q,S,Y,(T,Z)=>this.sJf(T,V)-this.sJf(Z,
V));if(!Y.count)return{returnValue:null,offset:P};P=V<Y.J(0).Fc||V>Y.J(0).end?this.sJf(Y.J(0),V):0;return{returnValue:f.a.createTextRange(O,Y.J(0).Fc,Y.J(0).end),offset:P}}iMf(O,V,Y,Q){let S=0;var P=({offset:S}=this.rBm(O,V,Y,Q)).returnValue;if(P)return{returnValue:P,offset:S};P=this.ESa.Nbi(O,Q);if(!P)return{returnValue:null,offset:S};for(S=Q?V:O.characterData.length-V;P.lba();){O=P.my;V=this.kJi(O,0,O.characterData.length,Y,(T,Z)=>T.Fc===Z.Fc?T.end-Z.end:T.Fc-Z.Fc);if(V.count)return Y=Q?V.J(V.count-
1):V.J(0),S+=Q?O.characterData.length-Y.end:Y.Fc,{returnValue:f.a.createTextRange(O,Y.Fc,Y.end),offset:S};S+=O.characterData.length}return{returnValue:null,offset:S}}hMf(O,V,Y,Q){return this.iMf(O,V,Y,Q).returnValue}aZc(O,V,Y){let Q=0,S=1;this.hMf(O,V,Y,!1)&&S++;this.hMf(O,V,Y,!0)&&(Q++,S++);return{index:Q,count:S}}Flm(O,V,Y){let Q;const S=({offset:Q}=this.iMf(O,V<O.characterData.length?V+1:V,Y,!0)).returnValue;if(S&&!Q)return S;V=({offset:O}=this.iMf(O,1<V?V-1:0,Y,!1)).returnValue;return S&&V?Q<
O?S:V:S?S:V}eKj(O,V){let Y=null;a.StaticActiveAppFrame.za()&&Object(F.a)(I.MainView,a.StaticActiveAppFrame.za().ib.sc)&&(Y=a.StaticActiveAppFrame.za().ib.sc);if(!Y)return!1;this.hb.Ic(l.SelectionEditor.Wj(w.SelectionFactory.Fo(O),!0,!1));O=Y.jr.uJm();const Q=(O-250)/2;Y.jr.V0(100<Q?100-100*Q/O:-1,void 0,void 0,S=>{window.setTimeout(()=>{V(S)},0)});return!0}PVb(O,V,Y=4,Q=!0){const S=()=>{V.rj.zI||V.GS(new H.a(O,Y,!1,Q,void 0,!0))};V.rj.dismiss();this.Sxk.select(O.node,O.cpBegin,O.cpBegin);if(!this.w6b.r0d(O.node))return this.eKj(O,
()=>{S()});S();return!0}static ddc(O){if(!O)return!0;if(!O.M_||!O.M_.state)return!1;O=O.M_.state;return 60===O||70===O}static CTj(O,V){const Y=M.a.kde(V)||z.a.getTypeNameFor(V)===x.a.getTypeName();return{returnValue:!O||Y||u.a(z.a.getTypeNameFor(V))&&O.priority>V.priority,stop:Y}}vbg(O,V,Y,Q,S=4,P=!0){O=this.inm(O);if(!O)return!1;V=this.Ifi(O,V,Y,Q);return this.PVb(O,V,S,P)}inm(O){var V=this.hb.gb.currentSelection;for(const Y of V)if(y.ParagraphReader.Xb(Y.node)&&(V=Y.contextId,V===v.a.Xc||V===v.a.Bd||
V===v.a.paragraph))return this.Flm(Y.node,V!==v.a.paragraph?Y.cpBegin:0,O);return null}Ifi(O,V,Y,Q){return this.Ycn(O)?V:this.lhn(O)?Q:Y}Ycn(O){return this.V2d(O,!0,null).returnValue}lhn(O){return!!this.HKa(O)}}Object(G.a)(U,"SuggestionNavigator",null,[])},1703:function(G,J,d){d.d(J,"c",function(){return f});d.d(J,"a",function(){return a});d.d(J,"b",function(){return l});var m=d(29);const f=(w,y,v)=>{if(!m.c(w)&&"#text"!==w.nodeName&&(y?w.setAttribute("unselectable","on"):w.setAttribute("unselectable",
"off"),v))for(w=w.firstChild;w;)f(w,y,!0),w=w.nextSibling},a=w=>{w=document.createElement(w);w.setAttribute("unselectable","on");return w},l=(w,y)=>{if(!m.c(w)){var v=w.className;if(m.c(v)||-1===v.indexOf(y))y=v.trim()+" "+y,y=y.trim(),w.className=y}}},1704:function(G,J,d){d.d(J,"a",function(){return u});G=d(0);var m=d(7),f=d(104),a=d(2),l=d(198),w=d(21),y=d(309),v=d(35);class u{constructor(){this.ija=null}mEe(){try{this.ija||(this.ija=w.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"))}catch(x){m.ULS.sendTraceTag(51689674,
1300,10,"Unable to resolve ISearchOAuthManager: "+x)}}pPf(x,z){return this.ija?this.ija.getToken(x,z):new Promise(A=>{w.a.instance.Qa("Common.App.SearchCommon.ISearchOAuthManager").execute(D=>{D?(this.ija=D,this.ija.getToken(x,z).then(F=>A(F))):A(null)})})}fzm(){this.mEe();return this.ija?this.ija.getToken("Search",a.AFrameworkApplication.k7f):null}eIi(){if("Dev Box"===a.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(x=>
{window.setTimeout(()=>{x(window.TellMeSubstrateTokenOverride)},750)});this.mEe();return this.ija?this.ija.getToken("Search",a.AFrameworkApplication.uGg):null}SNm(){this.mEe();return this.ija?this.ija.getToken("Search",this.PNm()):null}PNm(){return a.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")}UKm(){if("Dev Box"===a.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(x=>
{window.setTimeout(()=>{x(window.TellMeSubstrateTokenOverride)},750)});this.mEe();return this.ija?this.ija.getToken("SmartLookup",this.RKm()):null}RKm(){return a.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")}gzm(){return Object(f.a)(this,this.fzm,"getLokiTokenPromise")}lMm(){return Object(f.a)(this,this.eIi,"getSubstrateTokenPromise")}v0b(){return!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Ib.v0b}BOm(){const x={};this.v0b()&&(x.Loki=this.gzm(),x.Substrate=this.lMm());
return x}ucd(x){l.a.jOa(Object.assign(new y.a,{name:"Events",dataFields:[Object.assign(new v.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new v.a,{name:"Status",bool:x})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}PAn(){return a.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.ucd(!1);return!1}).then(()=>{this.ucd(!0);return!0}):new Promise((x,z)=>{const A=w.a.instance.resolve("Common.IDynamicScriptLoaderProvider").xC;
A?A.loadScript("tellme-strings").then(()=>{this.ucd(!0);x(!0)}).catch(()=>{this.ucd(!1);z(!1)}):(this.ucd(!1),z(!1))})}static sqn(){return!!a.AFrameworkApplication.ua&&(a.AFrameworkApplication.ua.Ib.mad||a.AFrameworkApplication.ua.Ib.ppc)}static bge(){return!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Ib.ppc}}Object(G.a)(u,"ReactSharedHeaderSearchUtils",null,[])},1705:function(G,J,d){d.r(J);d.d(J,"validateCpDataV1",function(){return f});d.d(J,"isEqual",function(){return a});d.d(J,"isSupportedCpVersion",
function(){return l});d.d(J,"validateVersionedCpData",function(){return y});d.d(J,"versionedDeserialize",function(){return v});var m=d(1678);const f=u=>"number"!==typeof u.CP||null!=u.FB&&"number"!==typeof u.FB||null!=u.FE&&"number"!==typeof u.FE||null!=u.HB&&"number"!==typeof u.HB||null!=u.HE&&"number"!==typeof u.HE||null!=u.CB&&"number"!==typeof u.CB||null!=u.CE&&"number"!==typeof u.CE||null!=u.R&&"number"!==typeof u.R||null!=u.E&&"number"!==typeof u.E||null!=u.TW&&"number"!==typeof u.TW||null!=
u.PB&&"number"!==typeof u.PB||null!=u.SYM&&"number"!==typeof u.SYM||null!=u.IE&&"number"!==typeof u.IE||null!=u.OO&&"number"!==typeof u.OO||null!=u.AX&&"number"!==typeof u.AX||null!=u.CCI&&"number"!==typeof u.CCI||null!=u.DD&&"number"!==typeof u.DD?!1:!0,a=(u,x)=>u||x?u&&x&&u.CP===x.CP&&u.FB===x.FB&&u.FE===x.FE&&u.HB===x.HB&&u.HE===x.HE&&u.CB===x.CB&&u.CE===x.CE&&u.R===x.R&&u.E===x.E&&u.TW===x.TW&&u.PB===x.PB&&u.SYM===x.SYM&&u.IE===x.IE&&u.OO===x.OO&&u.AX===x.AX&&u.CCI===x.CCI&&u.DD===x.DD?!0:!1:
!0,l=u=>1===u,w=u=>{let x=u,z=0;"number"===typeof x.VS&&(z=x.VS);if("number"===typeof x.VS||"number"===typeof x.CP)return{returnValue:x,pOg:z};x=null;for(let A=0;A<u.length;A++){const D=u[A];1===D.VS&&D.VS>z&&(z=D.VS,x=u[A])}return{returnValue:x,pOg:z}},y=u=>{const x=({pOg:u}=w(u)).returnValue;if(!x)return!1;switch(u){case 0:case 1:return f(x);default:return!1}},v=u=>{if(!u)return null;const x=({pOg:u}=w(u)).returnValue;if(!x)return null;switch(u){case 0:case 1:return m.b(x);default:return null}}},
1737:function(G,J,d){d.d(J,"a",function(){return w});G=d(0);var m=d(96),f=d(1590),a=d(2234),l=d(2061);class w{constructor(y){this.Qi=y}async h7(y,v){const {priority:u=2,delay:x=0,Wja:z=a.a.none}=null!==v&&void 0!==v?v:{};z.throwIfCancellationRequested();const A=new f.a,D=new m.a(u,1,x,()=>{try{const I=y();A.resolve(I)}catch(I){A.reject(I)}finally{F()}}),F=z.onCancel(()=>{this.Qi.vf(D);A.reject(new l.a(z))});this.Qi.Zb(D);return await A.completion}}Object(G.a)(w,"TaskDispatcher",null,[])},1738:function(G,
J,d){d.d(J,"a",function(){return l});G=d(0);var m=d(123),f=d(2),a=d(7);class l{constructor(w,y){this.RT=w;this.yK=y}rV(w,y,v,u){w={["appId"]:2155,["manifestType"]:"Fps",["submitTime"]:(new Date).toISOString(),["source"]:"Client",["type"]:"Survey",["clientFeedbackId"]:m.a.create().toString(),["email"]:v,["application"]:{["appData"]:"{}",["extendedManifestData"]:JSON.stringify({["surveySpecificData"]:JSON.stringify(u)})},["survey"]:{["surveyId"]:w},["telemetry"]:this.cLb(y),["web"]:this.tUc()};this.DNa(JSON.stringify(w),
{["Content-Type"]:"application/json"})}cLb(w){const y=f.AFrameworkApplication.sessionStartInfoSettings;return{["officeBuild"]:f.AFrameworkApplication.buildVersion,["featureArea"]:w,["audienceGroup"]:y.AudienceGroup,["osBuild"]:y.OsVersion,["platform"]:y.Platform,["processSessionId"]:y.WACSessionID,["flights"]:f.AFrameworkApplication.K.kb("FlightId"),["loggableUserId"]:f.AFrameworkApplication.K.kb("LoggableUserId"),["tenantId"]:f.AFrameworkApplication.K.kb("TenantId")}}DNa(w,y,v=0){3<v||this.yK.h7(()=>
{this.RT.Ij("https://petrol.office.microsoft.com/v1/feedback",2,w,y,!1,2,()=>{a.ULS.sendTraceTag(509207132,3041,50,"Success sending OCV feedback for EditorAi")},()=>{this.DNa(w,y,v+1);a.ULS.sendTraceTag(509207131,3041,50,"Failure sending OCV feedback for EditorAi, attempt {0}",v)},null)},{delay:this.npm(v)})}npm(w=0){let y=0;1===w?y=200:1<w&&(y=200+500*(w-1));return y}tUc(){const w=f.AFrameworkApplication.sessionStartInfoSettings;return{["browser"]:w.Browser,["browserVersion"]:w.BrowserVersion,["dataCenter"]:w.WACDatacenter}}}
Object(G.a)(l,"EditorAiSurveysApiClient",null,[])},1739:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);class m{constructor(a){this.selectedRating=a}}Object(G.a)(m,"EditorAiRatingData",null,[]);class f{constructor(a,l,w){this.rating=[new m(a)];this.comment=[l,...w]}}Object(G.a)(f,"EditorAiSurveyData",null,[])},1741:function(G,J,d){G=d(0);var m=d(814),f=d(19),a=d(191),l=d(91),w=d(2),y=d(21),v=d(7),u=d(1505),x=d(11),z=d(116),A=d(28),D=d(3),F=d(1147),I=d(155),H=d(17),N=d(25),M=d(108),U=d(8);class O{static get OVh(){O.HDc||
(O.HDc=[],O.qrc(m.a.Cg("ar-sa")),O.qrc(m.a.Cg("de-de")),O.qrc(m.a.Cg("es-es")),O.T3(m.a.Cg("en-029"),m.a.Cg("en-us")),O.T3(m.a.Cg("en-au"),m.a.Cg("en-us")),O.T3(m.a.Cg("en-bz"),m.a.Cg("en-us")),O.T3(m.a.Cg("en-ca"),m.a.Cg("en-us")),O.T3(m.a.Cg("en-gb"),m.a.Cg("en-us")),O.T3(m.a.Cg("en-id"),m.a.Cg("en-us")),O.T3(m.a.Cg("en-my"),m.a.Cg("en-us")),O.T3(m.a.Cg("en-ph"),m.a.Cg("en-us")),O.T3(m.a.Cg("zh-tw"),m.a.Cg("en-us")),O.qrc(m.a.Cg("fr-fr")),O.T3(m.a.Cg("hr-ba"),m.a.Cg("hr-hr")),O.T3(m.a.Cg("it-ch"),
m.a.Cg("it-it")),O.T3(m.a.Cg("nb-no"),m.a.Cg("nn-no")),O.qrc(m.a.Cg("nl-nl")),O.T3(m.a.Cg("ro-md"),m.a.Cg("ro-ro")),O.T3(m.a.Cg("ru-md"),m.a.Cg("ru-ru")),O.T3(m.a.Cg("sr-latn-ba"),m.a.Cg("sr-latn-cs")),O.T3(m.a.Cg("sr-latn-me"),m.a.Cg("sr-latn-cs")),O.T3(m.a.Cg("sr-latn-rs"),m.a.Cg("sr-latn-cs")),O.qrc(m.a.Cg("sr-cyrl-cs")),O.T3(m.a.Cg("sv-fi"),m.a.Cg("sv-se")));return O.HDc}static qrc(cb){O.HDc[cb.languageId]=cb.LCID}static T3(cb,ib){O.HDc[cb.LCID]=ib.LCID}static lyi(cb){var ib=m.a.Cg(cb);if(!ib)return 0;
ib=O.OVh[ib.LCID]||O.OVh[ib.languageId]||0;return ib===cb?0:ib}}O.HDc=null;Object(G.a)(O,"AutoCorrectListFallback",null,[]);var V=d(345),Y=d(92),Q=d(187),S=d(125),P=d(5),T=d(16),Z=d(6),X=d(70),aa=d(369),ia=d(37),wa=d(58),ma=d(109),na=d(44),Fa=d(1607);class Qa extends Fa.a{constructor(cb,ib,Ub,lb,Qb,fc){super(cb,ib,Ub,lb,fc);this.A0=Qb}get wE(){return!0}get commandId(){return D.a.Kal}set wE(cb){super.wE=cb}}Object(G.a)(Qa,"ARegexCorrectAction",Fa.a,[]);class ya extends Qa{static get wub(){if(null!=
ya.Z0g)var cb=ya.Z0g;else(cb=y.a.instance.Oa("Box4.List.IListCommands"))||v.ULS.sendTraceTag(512357316,393,50,"IListCommands was tried to be resolved before it was registered."),cb=ya.Z0g=cb;return cb}static get rm(){return null!=ya.c1g?ya.c1g:ya.c1g=y.a.instance.resolve("Box4.List.IListEditor")}static get Nd(){return null!=ya.u1g?ya.u1g:ya.u1g=y.a.instance.resolve("Box4.List.IListReader")}get levelText(){const [cb,ib]=this.A0;return ib?cb.replace(ib,"%1"):cb}}Object(G.a)(ya,"AListAutoCorrectAction",
Qa,[]);class ta extends ya{get commandId(){return D.a.Cal}csa(cb){if(ta.wub){var ib=Z.GraphIterator.eb(cb);ib.Jd();ia.OutlineElementNavigator.he(ib);if(ta.rm.$ye(ib,this.A0[0])){var Ub=ta.Nd.Nw(ib),lb=this.A0[0],Qb=f.a.charAt(lb,0),fc=this.wzm(Qb),Fc=aa.a.s_(1,fc.listStyle);Ub&&Fc.ESf(Ub)||(Ub=new na.GraphTransaction(15),Ub.qu(ib),this.Qd.Ne(A.a.createTextRange(cb,this.HI,this.U3+1),"",!0,!1),ta.rm.cVo(Fc),cb=new V.DictionaryPropertySet,cb.setValue(Q.a.tFf,!0),Qb&&(Fc.JT=Qb,cb.setValue(S.a.JT,Fc.JT)),
cb.setValue(P.a.Tw,fc.levelText),cb.setValue(T.a.font,fc.fontName),"-"===Qb&&Y.Health.instance.recordKpiUsage("DashBulletAutoCreate",0,ta.bD,null),cb.setValue(S.a.jua,"autocorrect"),cb.setValue(S.a.nma,lb),ta.wub.Nhl(Fc.listType,Fc.listStyle,cb),Ub.dispose())}}}wzm(cb){const ib={listStyle:0,levelText:X.a.XZd,fontName:X.a.EYc};switch(cb){case "*":return{...ib,listStyle:1};case "-":return{...ib,levelText:"-",fontName:ma.a.RJ};default:return ib}}static aI(cb,ib,Ub,lb,Qb){return new ta(null,cb,ib,Ub,
lb,Qb)}static QW(cb,ib,Ub,lb,Qb){return new ta(cb,wa.a(cb).Cb,ib,Ub,lb,Qb)}}ta.bD="wwaengidc";ta.Zqg=["[\\*](?![\\*])","[\\-](?![\\-])"];Object(G.a)(ta,"BulletListAction",ya,[]);var Aa=d(95);class oa extends Qa{constructor(cb,ib,Ub,lb,Qb,fc){super(cb,ib,Ub,lb,Qb,fc);this.KJc=!1;this.wE=!cb;oa.gq=new Aa.a}get wE(){return this.KJc}set wE(cb){this.KJc=cb}xNb(cb){this.Pof(cb.innerText,(ib,Ub,lb)=>{cb.innerText=f.a.substring(cb.innerText,0,ib)+lb+f.a.right(cb.innerText,Ub)})}csa(cb){this.Pof(U.ParagraphReader.text(cb).substring(this.HI,
this.U3),(ib,Ub,lb)=>{this.Qd.Ne(A.a.createTextRange(cb,this.HI+ib,this.HI+Ub),lb,!0,!1)})}Pof(cb,ib){if(!(2>this.A0.length)&&this.A0[1]){var Ub=this.A0[1];oa.gq.count||this.$tj();oa.gq.mb(Ub)&&(cb=cb.lastIndexOf(Ub),-1!==cb&&ib(cb,cb+Ub.length,oa.gq.J(Ub)))}}}Object(G.a)(oa,"ADictionarySequenceReplacerAction",Qa,[]);class za extends oa{get commandId(){return D.a.jkf}$tj(){oa.gq.Z("--","\u2014");oa.gq.Z(" -- "," \u2013 ");oa.gq.Z(" - "," \u2013 ");oa.gq.Z("-- ","\u2014");oa.gq.Z(" --"," \u2013");
oa.gq.Z(" -"," \u2013")}static aI(cb,ib,Ub,lb,Qb){return new za(null,cb,ib,Ub,lb,Qb)}static QW(cb,ib,Ub,lb,Qb){return new za(cb,wa.a(cb).Cb,ib,Ub,lb,Qb)}}Object(G.a)(za,"DashAction",oa,[]);class ja extends oa{constructor(cb,ib,Ub,lb,Qb,fc,Fc){super(cb,ib,Ub,lb,Qb,fc);this.ga=Fc}get commandId(){return D.a.Dal}$tj(){oa.gq.Z(":)","\ud83d\ude0a");oa.gq.Z(":-)","\ud83d\ude0a");oa.gq.Z(":|","\ud83d\ude10");oa.gq.Z(":-|","\ud83d\ude10");oa.gq.Z(":(","\ud83d\ude41");oa.gq.Z(":-(","\ud83d\ude41");oa.gq.Z(";)",
"\ud83d\ude09");oa.gq.Z(";-)","\ud83d\ude09");oa.gq.Z(":D","\ud83d\ude00");oa.gq.Z(":-D","\ud83d\ude00");oa.gq.Z(":')","\ud83d\ude02");oa.gq.Z("=D","\ud83d\ude03");oa.gq.Z(":>","\ud83d\ude06");oa.gq.Z(":->","\ud83d\ude06");oa.gq.Z(":3","\ud83d\ude0a");oa.gq.Z(":-3","\ud83d\ude0a");oa.gq.Z("B-)","\ud83d\ude0e");oa.gq.Z("*-*","\ud83d\ude0d");oa.gq.Z(":*","\ud83d\ude19");oa.gq.Z(":-*","\ud83d\ude19");oa.gq.Z(":X","\ud83d\ude36");oa.gq.Z(":-X","\ud83d\ude36");oa.gq.Z(":O","\ud83d\ude2e");oa.gq.Z(":-O",
"\ud83d\ude2e");oa.gq.Z(":#","\ud83e\udd10");oa.gq.Z(":-#","\ud83e\udd10");oa.gq.Z(":P","\ud83d\ude1b");oa.gq.Z(":-P","\ud83d\ude1b");oa.gq.Z(";P","\ud83d\ude1c");oa.gq.Z(";-P","\ud83d\ude1c");oa.gq.Z(":-/","\ud83d\ude15");oa.gq.Z("$-$","\ud83e\udd11");oa.gq.Z(":S","\ud83d\ude16");oa.gq.Z(":-S","\ud83d\ude16");oa.gq.Z(":[","\ud83d\ude1f");oa.gq.Z(":-[","\ud83d\ude1f");oa.gq.Z(":\u2019(","\ud83d\ude22");oa.gq.Z(":'(","\ud83d\ude22");oa.gq.Z("@-@","\ud83d\ude31")}csa(cb){this.Pof(U.ParagraphReader.text(cb).substring(this.HI,
this.U3),(ib,Ub,lb)=>{ib=A.a.createTextRange(cb,this.HI+ib,this.HI+Ub);Ub={};Ub.MenuItemId=lb;this.ga.lg(ib,D.a.wsb,2,!1,null,Ub,null)})}static aI(cb,ib,Ub,lb,Qb,fc){return new ja(null,cb,ib,Ub,lb,Qb,fc)}static QW(cb,ib,Ub,lb,Qb,fc){return new ja(cb,wa.a(cb).Cb,ib,Ub,lb,Qb,fc)}}Object(G.a)(ja,"EmojiAction",oa,[]);class fa{constructor(cb,ib,Ub,lb){this.RV=cb;this.jPd=ib;this.pKc=lb;this.FH=Ub}E0i(){if(!this.FH)return!1;this.RV=this.RV.trimStart();return this.RV===this.FH?!0:!1}sun(){if(!this.RV)return!1;
const cb=this.RV.lastIndexOf(" ");return-1!==cb&&"."===this.RV.charAt(cb-1)&&"."===this.RV.charAt(cb-3)?!0:!1}qun(){if(!this.RV)return!1;var cb=this.RV.lastIndexOf(" ");return-1!==cb&&(cb=this.RV.substring(0,cb-1).lastIndexOf(" "),"."===this.RV.charAt(cb+2))?!0:!1}qnn(){return this.E0i()&&(1===this.FH.length&&"."===this.jPd||"."===this.RV.charAt(1))?!0:!1}rnn(){return this.FH?0<="\\/".indexOf(this.jPd)||3===this.FH.length&&0<="\\/".indexOf(this.FH.charAt(1))?!0:!1:!1}lmn(){return this.FH?0<=this.FH.indexOf("@")?
!0:!1:!1}sD(){if(!this.FH)return!1;for(const cb of fa.jQf())if(f.a.startsWith(this.FH+this.jPd,cb))return!0;return!1}Pln(){return this.FH?"i"===this.FH&&0<=fa.quotes.indexOf(this.jPd)?!0:!1:!1}Hfn(){if(!this.RV)return!1;const cb=f.a.$ab(this.RV,this.RV.length-1);if(-1!==cb&&this.RV.substring(cb+1,this.RV.length)===this.FH){const ib=this.RV.charAt(cb-1);if(0<=fa.Eyg.indexOf(ib)||0<=fa.quotes.indexOf(ib)&&0<=fa.Eyg.indexOf(this.RV.charAt(cb-2)))return!0}return!1}dol(){return!this.RV||this.sun()||this.qnn()||
this.rnn()||this.qun()||this.lmn()||this.sD()?!1:this.E0i()||this.Pln()||this.Hfn()?!0:!1}static jQf(){return fa.tth||(fa.tth="http: https: ftp:// mailto: \\\\ www.".split(" "))}}fa.Eyg=".!?";fa.quotes="'\"";fa.tth=null;Object(G.a)(fa,"FirstLetterUpperCaseRules",null,[]);class Ca{constructor(cb){this.FH=cb}tdm(){if(!this.FH)return null;for(let cb=0;cb<Ca.XKi().length;cb++)if(this.FH===Ca.XKi()[cb])return Ca.hSm()[cb];return null}static XKi(){return Ca.kjh||(Ca.kjh=["1/2","1/4","3/4"])}static hSm(){return Ca.jjh||
(Ca.jjh=["\u00bd","\u00bc","\u00be"])}}Ca.kjh=null;Ca.jjh=null;Object(G.a)(Ca,"FractionsCollection",null,[]);class xa extends Fa.a{constructor(cb,ib,Ub,lb,Qb,fc){super(cb,ib,Ub,lb,fc);this.$8h=Qb}get wE(){return!0}get commandId(){return D.a.Eal}xNb(cb){cb.innerText=f.a.substring(cb.innerText,0,this.HI)+this.$8h+f.a.right(cb.innerText,this.U3)}csa(cb){this.Qd.Ne(A.a.createTextRange(cb,this.HI,this.U3),this.$8h,!0,!1)}set wE(cb){super.wE=cb}static aI(cb,ib,Ub,lb,Qb){return new xa(null,cb,ib,Ub,lb,Qb)}}
Object(G.a)(xa,"FractionsReplaceCorrectAction",Fa.a,[]);class ua extends ya{get commandId(){return D.a.Gal}csa(cb){if(ua.wub){var ib=Z.GraphIterator.eb(cb);ib.Jd();ia.OutlineElementNavigator.he(ib);if(ua.rm.$ye(ib,this.A0[0])){var [Ub,lb]=this.A0,Qb=ua.ESn(lb),fc=f.a.Gpc(lb)?4:2,Fc=A.a.createTextRange(cb,this.HI,this.U3+1);ua.rm.Jdc(cb,ib,fc,Qb,Fc,Ub,this.levelText,ua.wub)}}}static aI(cb,ib,Ub,lb,Qb){return new ua(null,cb,ib,Ub,lb,Qb)}static QW(cb,ib,Ub,lb,Qb){return new ua(cb,wa.a(cb).Cb,ib,Ub,lb,
Qb)}static ESn(cb){if(!cb)return 0;cb=f.a.xh(cb);if(!f.a.ode(cb.charAt(0)))return 0;const ib=cb.charCodeAt(0)-97+1;let Ub;for(Ub=1;Ub<cb.length&&cb.charAt(Ub)===cb.charAt(0);Ub++);return 26*(Ub-1)+ib}}Object(G.a)(ua,"LetterListAction",ya,[]);var sa=d(133);class Ea extends ya{get commandId(){return D.a.Jdc}csa(cb){if(Ea.wub){var ib=Z.GraphIterator.eb(cb);ib.Jd();ia.OutlineElementNavigator.he(ib);if(Ea.rm.$ye(ib,this.A0[0])){var [Ub,lb]=this.A0,Qb=parseInt(lb);if(!(99999999<=Qb)){var fc=A.a.createTextRange(cb,
this.HI,this.U3+1);sa.a.ghe()&&sa.a.jUm();Ea.rm.Jdc(cb,ib,1,Qb,fc,Ub,this.levelText,Ea.wub)}}}}static aI(cb,ib,Ub,lb,Qb){return new Ea(null,cb,ib,Ub,lb,Qb)}static QW(cb,ib,Ub,lb,Qb){return new Ea(cb,wa.a(cb).Cb,ib,Ub,lb,Qb)}}Object(G.a)(Ea,"NumberListAction",ya,[]);class Ja extends Fa.a{get wE(){return!0}get commandId(){return D.a.Ial}xNb(){}csa(cb){const ib=A.a.createTextRange(cb,this.U3-2,this.U3),Ub=new na.GraphTransaction(15);Ub.Ab(cb);let lb=!1,Qb=null,fc=0;for(;fc<cb.qa.length;){var Fc=cb.qa.J(fc),
nc=Fc.Iba;const zb=Fc.CX;if(Fc.cp>=ib.cpBegin){Fc.cp>ib.cpBegin||!Fc.formatting?Qb=lb?Fc.formatting:this.Qd.$0(cb,fc,ib.cpBegin,Qb):(Qb=Fc.formatting,zb&&(lb=!1),nc&&(lb=!0));fc++;break}Fc.formatting&&(Qb=Fc.formatting);zb&&(lb=!1);nc&&(lb=!0);fc++}for(;fc<cb.qa.length;){nc=cb.qa.J(fc);if(nc.cp>=ib.cpEnd){if(nc.cp>ib.cpEnd||!nc.formatting&&!nc.mi)lb||this.Qd.$0(cb,fc,ib.cpEnd,Qb);lb||Ja.km.Kva(Qb,!0);break}nc.formatting&&(lb||Ja.km.Kva(Qb,!0),Qb=nc.formatting);Fc=nc.Iba;nc=nc.CX;Fc&&(lb=!0);!Fc&&
nc&&(lb=!1);fc++}Ub.dispose()}set wE(cb){super.wE=cb}static get km(){return null!=Ja.RXg?Ja.RXg:Ja.RXg=y.a.instance.resolve("Box4.IFormattingEditor")}static aI(cb,ib,Ub,lb){return new Ja(null,cb,ib,Ub,lb)}}Object(G.a)(Ja,"OrdinalsReplaceCorrectAction",Fa.a,[]);var nb=d(61),ub=d(62),Yb=d(232),yb;(function(cb){cb[cb.tyj=0]="rand";cb[cb.uyj=1]="randOld";cb[cb.Zaj=2]="lorem"})(yb||(yb={}));Object(G.b)("RandTextType",yb);class Za extends Qa{constructor(cb,ib,Ub,lb,Qb,fc){super(cb,ib,Ub,lb,Qb,fc);Za.S5e||
Za.Ecp()}static $mn(){var cb;return null===(cb=w.AFrameworkApplication.K)||void 0===cb?void 0:cb.getBooleanFeatureGate("Microsoft.Office.WordOnline.isNoRandDoubleSpaceEnabled",!0)}get commandId(){return D.a.Jal}csa(cb){if(!(cb.gv||nb.a.getInstance().Fu&&(ub.ListItemReader.Of?ub.ListItemReader.isListItem(cb):Yb.a.Xla(cb)))){var ib=this.Eib.Ra.node===cb,Ub=5,lb=3;if(this.A0[0].startsWith("=rand.old")){var Qb=yb.uyj;Ub=3}else if(this.A0[0].startsWith("=rand"))Qb=yb.tyj;else if(this.A0[0].startsWith("=lorem"))Qb=
yb.Zaj;else return;this.A0[1]&&(Ub=parseInt(this.A0[1]));this.A0[2]&&(lb=parseInt(this.A0[2]));if(!(20<lb||100<Ub)){cb.CL().YG.laa(7);var fc=Z.GraphIterator.eb(cb);fc.Jd();ia.OutlineElementNavigator.he(fc);Za.Kf.$z(fc,!1,!1);Za.Kf.QJ(fc);var Fc=!1;switch(Qb){case yb.tyj:Qb=Za.S5e;break;case yb.uyj:Qb=Za.cBh;break;case yb.Zaj:Qb=Za.kuh;Fc=!0;break;default:return}var nc=0;for(let Vb=0;Vb<Ub;++Vb){const rc=[];for(var zb=0;zb<lb;zb++)rc.push(Qb[nc++%Qb.length]);zb=A.a.Tc(fc.currentNode,0);if(Fc){const pb=
z.FormattingReader.Cs(zb);Za.km.Sm(pb,P.a.noProof,!0)}this.Qd.Ne(zb,rc.join(Za.$mn()?"":" "),!0,!1);Vb<Ub-1&&(ia.OutlineElementNavigator.he(fc),Za.Kf.$z(fc,!1,!1),Za.Kf.QJ(fc))}Ub=fc.currentNode;fc=Z.GraphIterator.eb(cb);fc.Jd();ia.OutlineElementNavigator.he(fc);fc.eh();ib&&(this.Eib=N.SelectionFactory.se(Ub,U.ParagraphReader.textLength(Ub)))}}}static get Kf(){return null!=Za.f2g?Za.f2g:Za.f2g=y.a.instance.resolve("Box4.IOutlineElementEditor")}static get km(){return null!=Za.VXg?Za.VXg:Za.VXg=y.a.instance.resolve("Box4.IFormattingEditor")}static Ecp(){Za.S5e=
"Video provides a powerful way to help you prove your point. ;When you click Online Video, you can paste in the embed code for the video you want to add. ;You can also type a keyword to search online for the video that best fits your document. ;To make your document look professionally produced, Word provides header, footer, cover page, and text box designs that complement each other. ;For example, you can add a matching cover page, header, and sidebar. ;Click Insert and then choose the elements you want from the different galleries. ;Themes and styles also help keep your document coordinated. ;When you click Design and choose a new Theme, the pictures, charts, and SmartArt graphics change to match your new theme. ;When you apply styles, your headings change to match the new theme. ;Save time in Word with new buttons that show up where you need them. ;To change the way a picture fits in your document, click it and a button for layout options appears next to it. ;When you work on a table, click where you want to add a row or a column, and then click the plus sign. ;Reading is easier, too, in the new Reading view. ;You can collapse parts of the document and focus on the text you want. ;If you need to stop reading before you reach the end, Word remembers where you left off - even on another device. ".split(";");
Za.cBh=["The quick brown fox jumps over the lazy dog. "];Za.kuh="Lorem ipsum dolor sit amet, consectetuer adipiscing elit. ;Maecenas porttitor congue massa. ;Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna. ;Nunc viverra imperdiet enim. ;Fusce est. ;Vivamus a tellus. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin pharetra nonummy pede. ;Mauris et orci. ;Aenean nec lorem. ;In porttitor. ;Donec laoreet nonummy augue. ;Suspendisse dui purus, scelerisque at, vulputate vitae, pretium mattis, nunc. ;Mauris eget neque at sem venenatis eleifend. ;Ut nonummy. ;Fusce aliquet pede non pede. ;Suspendisse dapibus lorem pellentesque magna. ;Integer nulla. ;Donec blandit feugiat ligula. ;Donec hendrerit, felis et imperdiet euismod, purus ipsum pretium metus, in lacinia nulla nisl eget sapien. ;Donec ut est in lectus consequat consequat. ;Etiam eget dui. ;Aliquam erat volutpat. ;Sed at lorem in nunc porta tristique. ;Proin nec augue. ;Quisque aliquam tempor magna. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Nunc ac magna. ;Maecenas odio dolor, vulputate vel, auctor ac, accumsan id, felis. ;Pellentesque cursus sagittis felis. ;Pellentesque porttitor, velit lacinia egestas auctor, diam eros tempus arcu, nec vulputate augue magna vel risus. ;Cras non magna vel ante adipiscing rhoncus. ;Vivamus a mi. ;Morbi neque. ;Aliquam erat volutpat. ;Integer ultrices lobortis eros. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin semper, ante vitae sollicitudin posuere, metus quam iaculis nibh, vitae scelerisque nunc massa eget pede. ;Sed velit urna, interdum vel, ultricies vel, faucibus at, quam. ;Donec elit est, consectetuer eget, consequat quis, tempus quis, wisi. ;In in nunc. ;Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos. ;Donec ullamcorper fringilla eros. ;Fusce in sapien eu purus dapibus commodo. ;Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. ;Cras faucibus condimentum odio. ;Sed ac ligula. ;Aliquam at eros. ;Etiam at ligula et tellus ullamcorper ultrices. ;In fermentum, lorem non cursus porttitor, diam urna accumsan lacus, sed interdum wisi nibh nec nisl. ;Ut tincidunt volutpat urna. ;Mauris eleifend nulla eget mauris. ;Sed cursus quam id felis. ;Curabitur posuere quam vel nibh. ;Cras dapibus dapibus nisl. ;Vestibulum quis dolor a felis congue vehicula. ;Maecenas pede purus, tristique ac, tempus eget, egestas quis, mauris. ;Curabitur non eros. ;Nullam hendrerit bibendum justo. ;Fusce iaculis, est quis lacinia pretium, pede metus molestie lacus, at gravida wisi ante at libero. ;Quisque ornare placerat risus. ;Ut molestie magna at mi. ;Integer aliquet mauris et nibh. ;Ut mattis ligula posuere velit. ;Nunc sagittis. ;Curabitur varius fringilla nisl. ;Duis pretium mi euismod erat. ;Maecenas id augue. ;Nam vulputate. ;Duis a quam non neque lobortis malesuada. ;Praesent euismod. ;Donec nulla augue, venenatis scelerisque, dapibus a, consequat at, leo. ;Pellentesque libero lectus, tristique ac, consectetuer sit amet, imperdiet ut, justo. ;Sed aliquam odio vitae tortor. ;Proin hendrerit tempus arcu. ;In hac habitasse platea dictumst. ;Suspendisse potenti. ;Vivamus vitae massa adipiscing est lacinia sodales. ;Donec metus massa, mollis vel, tempus placerat, vestibulum condimentum, ligula. ;Nunc lacus metus, posuere eget, lacinia eu, varius quis, libero. ;Aliquam nonummy adipiscing augue. ".split(";")}static aI(cb,
ib,Ub,lb,Qb){return new Za(null,cb,ib,Ub,lb,Qb)}static QW(cb,ib,Ub,lb,Qb){return new Za(cb,wa.a(cb).Cb,ib,Ub,lb,Qb)}}Za.S5e=null;Za.cBh=null;Za.kuh=null;Object(G.a)(Za,"RandAction",Qa,[]);class Ya{constructor(cb,ib,Ub,lb){this.pattern=lb&8?new RegExp(cb,"i"):new RegExp(cb);this.L1m=ib;this.XSm=Ub;this.flags=lb}}Object(G.a)(Ya,"RegexAutoCorrectEntry",null,[]);class Pa extends ya{get commandId(){return D.a.Lal}csa(cb){if(Pa.wub){var ib=Z.GraphIterator.eb(cb);ib.Jd();ia.OutlineElementNavigator.he(ib);
if(Pa.rm.$ye(ib,this.A0[0])){var [Ub,lb]=this.A0,Qb=Pa.FSn(lb);if(!(0>=Qb)){var fc=f.a.Gpc(lb.charAt(0))?5:3,Fc=A.a.createTextRange(cb,this.HI,this.U3+1);Pa.rm.Jdc(cb,ib,fc,Qb,Fc,Ub,this.levelText,Pa.wub)}}}}static aI(cb,ib,Ub,lb,Qb){return new Pa(null,cb,ib,Ub,lb,Qb)}static QW(cb,ib,Ub,lb,Qb){return new Pa(cb,wa.a(cb).Cb,ib,Ub,lb,Qb)}static S1l(){Pa.aTa||(Pa.aTa={},Pa.aTa.M=1E3,Pa.aTa.D=500,Pa.aTa.C=100,Pa.aTa.L=50,Pa.aTa.X=10,Pa.aTa.V=5,Pa.aTa.I=1)}static FSn(cb){if(!cb)return 0;Pa.S1l();cb=f.a.sC(cb);
let ib=0,Ub=0;for(let lb=cb.length-1;0<=lb;lb--){const Qb=Pa.aTa[f.a.charAt(cb,lb).toString()];Ub=Qb<ib?Ub-Qb:Ub+Qb;ib=Qb}return Ub}}Pa.aTa=null;Pa.Zqg=["M{1,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(CM|CD|DC{0,3}|C{1,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(XC|XL|LX{0,3}|X{1,3})(IX|IV|V?I{0,3})","(IX|IV|VI{0,3}|I{1,3})"].map(cb=>`\\(?(${cb})[\\.\\)\\-]`);Object(G.a)(Pa,"RomanListAction",ya,[]);var rb=d(40);class tb extends Fa.a{constructor(cb,ib,Ub,lb,Qb,fc){super(cb,ib,Ub,Ub+1,fc);this.lRk=
lb;this.$ch=Qb;this.ded=!1}get wE(){return!1}get commandId(){return D.a.Mal}xNb(cb){cb.innerText=f.a.substring(cb.innerText,0,this.HI)+this.$ch+f.a.right(cb.innerText,this.U3)}csa(cb){this.Qd.Ne(A.a.createTextRange(cb,this.HI,this.U3),this.lRk,!0,!1);this.Qd.Ne(A.a.createTextRange(cb,this.HI,this.HI+1),this.$ch,!0,!1)}set wE(cb){super.wE=cb}static aI(cb,ib,Ub,lb,Qb,fc){if("'"!==Ub&&'"'!==Ub)return null;var Fc=Z.GraphIterator.eb(cb);Fc.Jd();ia.OutlineElementNavigator.he(Fc);if(rb.OutlineElementReader.Lo(Fc.currentNode))return null;
lb=!ib||f.a.qga(lb)||-1!==Array.indexOf(tb.U4n,lb);Fc="'"===Ub;return new tb(fc,cb,ib,Ub+"",lb?Fc?"\u2018":"\u201c":Fc?"\u2019":"\u201d",Qb)}}tb.U4n=["[","{","("];Object(G.a)(tb,"SmartQuoteCorrectAction",Fa.a,[]);class ob extends Fa.a{constructor(cb,ib,Ub,lb,Qb,fc){super(cb,ib,Ub,lb,fc);this.Zch=Qb}get wE(){return ob.KJc}set wE(cb){ob.KJc=cb}get commandId(){return D.a.Nal}Y$j(){this.rGd=this.c2h();this.rGd||(this.Tsh=!1,this.znh="MatchTextIsNotTheSame")}xNb(cb){cb.innerText=f.a.substring(cb.innerText,
0,this.HI)+this.Zch+f.a.right(cb.innerText,this.U3)}csa(cb){this.Qd.Ne(A.a.createTextRange(cb,this.HI,this.U3),this.Zch,!0,!1)}static QW(cb,ib,Ub,lb,Qb){const fc=wa.a(cb);return new ob(cb,fc?fc.Cb:null,ib,Ub,lb,Qb)}static aI(cb,ib,Ub,lb,Qb){return new ob(null,cb,ib,Ub,lb,Qb)}}ob.KJc=!1;Object(G.a)(ob,"StringReplaceCorrectAction",Fa.a,[]);class Oa extends Fa.a{constructor(cb,ib,Ub,lb,Qb,fc,Fc,nc){super(cb,ib,Ub,lb,Qb);this.ul=fc;this.tBk=Fc;this.aL=nc}get wE(){return!0}get commandId(){return D.a.Oal}xNb(cb){let ib=
f.a.substring(cb.innerText,this.HI,this.U3);ib.charAt(0)!==ib.charAt(0).toUpperCase()&&(ib=ib.charAt(0).toUpperCase()+ib.substring(1,ib.length));cb.innerText=f.a.substring(cb.innerText,0,this.HI)+ib+f.a.right(cb.innerText,this.U3)}csa(cb){const ib=this.HI,Ub=this.HI+1,lb=cb.characterData.substring(ib,Ub).charAt(0);if(!f.a.Gpc(lb)){const Qb=A.a.createTextRange(cb,ib,Ub);this.cgn(Qb)||this.aL&&this.aL.pad(cb,ib,Ub)||this.Qd.Ne(Qb,lb.toUpperCase().toString(),!0,!1)}}cgn(cb){return this.tBk?!!this.ul&&
this.ul.Bba(cb):!1}set wE(cb){super.wE=cb}static QW(cb,ib,Ub,lb){const Qb=wa.a(cb);return new Oa(cb,Qb?Qb.Cb:null,ib,Ub,lb,null,!1,null)}static aI(cb,ib,Ub,lb,Qb,fc){return new Oa(null,cb,ib,Ub,lb,Qb,!0,fc)}}Object(G.a)(Oa,"UpperFirstLetterAutoCorrectAction",Fa.a,[]);class Xa{constructor(cb,ib){this.pKc=ib;this.FH=cb}YCp(){const cb=Number.parseInvariant(this.FH.substring(0,this.FH.length-2));switch(Number.parseInvariant(this.FH.charAt(this.FH.length-3).toString())){case 1:return 11===cb?"th":"st";
case 2:return 12===cb?"th":"nd";case 3:return 13===cb?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}Enn(){var cb=m.a.Cg(this.pKc);if(!cb||!cb.name.toLowerCase().startsWith("en")||!this.FH||2>=this.FH.length)return!1;for(cb=0;cb<Xa.u$d().length;cb++)if(this.FH.toLowerCase().endsWith(Xa.u$d()[cb])){if(RegExp("^\\d+$").test(this.FH.substr(0,this.FH.length-2))){const ib=this.YCp();if(this.FH.toLowerCase().endsWith(Xa.u$d()[cb])&&ib===Xa.u$d()[cb])return!0}break}return!1}static u$d(){return Xa.jyh||
(Xa.jyh=["st","nd","rd","th"])}}Xa.jyh=null;Object(G.a)(Xa,"ValidateOrdinalsRule",null,[]);d.d(J,"a",function(){return ab});class ab{constructor(cb,ib,Ub,lb,Qb,fc,Fc){this.rOc=[];this.F4b=[];this.GDc=[];this.vLe=new Set;this.Yib=-1;this.gmh=this.eja=!1;this.Nyk=cb;this.Qd=ib;this.ul=Ub;this.ga=lb;this.TY=fc;this.aL=Fc;Qb?(this.eja=Qb.$("ReplaceQuoteWithSmartQuoteIsEnabled"),this.gmh=Qb.$("HyperlinkUrlValidationIsEnabled"),v.ULS.sendTraceTag(23418953,324,50,"{0}",{["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.eja})):
(v.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.eja=!1)}Xsb(cb){return 0<=ab.kkf.indexOf(cb)}G1f(cb){return 0<=ab.lkf.indexOf(cb)}j_f(cb){return cb.toLowerCase()===cb}Gpc(cb){return cb.toUpperCase()===cb}ode(cb){return cb.toLowerCase()!==cb.toUpperCase()}Vin(cb,ib,Ub,lb){return(new fa(cb,ib,Ub,lb)).dol()}iom(cb){do{if(cb.getAttribute("xml:lang"))return m.a.Cg(cb.getAttribute("xml:lang"))||m.a.y8c;if(cb.getAttribute("lang"))return m.a.Cg(cb.getAttribute("lang"))||
m.a.y8c;cb=cb.parentNode}while(cb&&1===cb.nodeType);return m.a.y8c}XIf(cb){return m.a.Cg(z.FormattingReader.language(z.FormattingReader.Cs(cb)))||m.a.y8c}y3d(cb,ib){0>ib&&(ib=0);let Ub=-1;const lb=ab.kkf.length;for(let Qb=0;Qb<lb;++Qb){const fc=cb.lastIndexOf(f.a.charAt(ab.kkf,Qb),ib);fc>Ub&&(Ub=fc)}cb=f.a.$ab(cb,ib);cb>Ub&&(Ub=cb);return Ub}E8l(cb){for(let ib=0;ib<cb.length;++ib)if(this.ode(f.a.charAt(cb,ib)))return ib;return-1}hEf(cb,ib){if(!cb||0>ib)return-1;let Ub=ib;Ub=Ub?this.y3d(cb,Ub-1):-1;
Ub=Ub>f.a.$ab(cb,ib-1)?Ub:f.a.$ab(cb,ib-1);Ub++;return Ub}Zoi(cb,ib,Ub){this.A_c(ib);if(!this.F4b[ib]){ib=O.lyi(ib);if(0>=ib)return null;this.A_c(ib);if(!this.F4b[ib])return null}if(Ub&&this.GDc[ib]&&Array.contains(this.GDc[ib],cb+Ub))return null;Ub=this.F4b[ib][f.a.xh(cb)];if("string"!==typeof Ub||Ub===cb||!Ub)return null;var lb=this.E8l(cb);if(0>lb||this.j_f(f.a.charAt(cb,lb)))return Ub;ib=!0;for(lb+=1;lb<cb.length;++lb){const Qb=f.a.charAt(cb,lb);ib&&!this.Gpc(Qb)&&(ib=!1)}return ib?null:f.a.sC(f.a.substring(Ub,
0,1))+f.a.right(Ub,1)}S8l(cb,ib,Ub,lb){a.a.mark(4666);const Qb=this.iom(ib).LCID;let fc=0,Fc=cb;const nc=ib.innerText;var zb=nc.lastIndexOf(" ",cb);if(this.VYf(nc.substring(zb+1,cb)))return a.a.mark(4667),null;zb=null;var Vb=!1;do{Fc=Fc?this.y3d(nc,Fc-1):-1;if(-1===Fc&&!Ub){Vb=ib;var rc=null;if(!this.Xsb(nc.charAt(0))){do{for(;Vb&&!Vb.previousSibling;)Vb=Vb.parentNode;Vb&&(Vb=Vb.previousSibling,rc=Vb.innerText)}while(Vb&&!rc);if(Vb&&rc&&!this.Xsb(f.a.charAt(rc,rc.length-1)))return a.a.mark(4667),
null}Vb=!0}rc=f.a.substring(nc,Fc+1,cb);++fc;var pb=this.Zoi(rc,Qb,lb.toString());if(pb)zb=ob.QW(ib,Fc+1,cb,pb,this.Qd),ab.g6f();else for(const bb of this.rOc)if(!(bb.flags&1&&!(Ub&&1>Fc)||bb.flags&4||bb.flags&2&&" "!==lb)&&(pb=bb.pattern.exec(rc))){zb=bb.L1m(ib,Fc+1,cb,pb,this.Qd,this.ga);break}}while(!Vb&&!zb&&fc<ab.Zcj&&0<=Fc);a.a.mark(4667);return zb}Q8l(cb,ib,Ub){const lb=cb.node;let Qb=U.ParagraphReader.text(lb);0>ib&&(ib=cb.cpBegin);cb=this.XIf(cb).LCID;if(this.VYf(Qb.substring(f.a.$ab(Qb,
ib)+1,ib)))return null;var fc=-1,Fc=M.a.lkc(lb);for(var nc=0;nc<Fc.length;nc++)if(ib>Fc[nc].cpEnd)fc=Fc[nc].cpEnd;else{if(ib>Fc[nc].cpBegin)return null;break}Fc=null;nc=(nc=ib)?this.y3d(Qb,nc-1):-1;nc<fc&&(nc=fc-1);fc=f.a.substring(Qb,nc+1,ib);fc=fc.trimStart();if(1>nc)for(const zb of this.rOc){let Vb=Qb;" "!==Ub&&(Vb=Qb+Ub);if(zb.pattern.exec(Vb))return null}Qb=Qb.substring(0,ib);if(!this.Vin(Qb,Ub.toString(),fc,cb))return null;fc.charAt(0).toUpperCase()!==fc.charAt(0)&&(Fc=Oa.aI(lb,nc+1,ib,this.Qd,
this.ul,this.aL));return Fc}Boi(cb,ib,Ub){cb=N.SelectionFactory.pp(cb,!1);if(!cb)return null;cb=cb.Uc;return H.SelectionEditor.mf(cb)?this.Q8l(cb,ib,Ub):null}VYf(cb){return f.a.IX(cb)}KDf(cb,ib,Ub,lb){a.a.mark(4666);const Qb=cb.node,fc=this.XIf(cb).LCID,Fc=U.ParagraphReader.text(Qb);0>ib&&(ib=cb.cpBegin);if(Ub&&!this.Xsb(f.a.charAt(Fc,ib))||this.VYf(Fc.substring(f.a.$ab(Fc,ib)+1,ib)))return a.a.mark(4667),null;cb=-1;Ub=M.a.lkc(Qb);for(var nc=0;nc<Ub.length;nc++)if(ib>Ub[nc].cpEnd)cb=Ub[nc].cpEnd;
else{if(ib>Ub[nc].cpBegin)return null;break}Ub=0;nc=ib;let zb=null;do{nc=nc?this.y3d(Fc,nc-1):-1;nc<cb&&(nc=cb-1);const rc=f.a.substring(Fc,nc+1,ib);++Ub;var Vb=null;let pb=!1;if(F.a.sii){const bb=Fc+String.fromCharCode(lb);pb=this.rOc.some(Pb=>Pb.pattern.exec(bb))}pb||(Vb=this.Zoi(rc,fc,null));if(Vb)this.TY.b_a&&(zb=ob.aI(Qb,nc+1,ib,Vb,this.Qd),ab.g6f());else for(const bb of this.rOc)if(!(bb.flags&1&&-1!==nc||bb.flags&4&&lb!==l.a.Mu||bb.flags&2&&lb!==l.a.U0a)&&(Vb=bb.pattern.exec(rc))){zb=bb.XSm(Qb,
nc+1,ib,Vb,this.Qd,this.ga);if(zb.commandId!==D.a.jkf&&!this.TY.b_a||zb.commandId===D.a.jkf&&!this.TY.old)zb=null;break}}while(0<=nc&&nc>=cb&&!zb&&Ub<ab.Zcj);a.a.mark(4667);return zb}Aoi(cb,ib,Ub){cb=N.SelectionFactory.pp(cb,!1);if(!cb)return null;cb=cb.Uc;return H.SelectionEditor.mf(cb)?this.KDf(cb,ib,!1,Ub):null}Joi(cb,ib){var Ub=N.SelectionFactory.pp(cb,!1);if(!Ub)return null;let lb=Ub.Uc;Ub.ly&&Ub.Uc.contextId!==x.a.Vc&&0<=ib&&(lb=A.a.Tc(cb,ib));if(!H.SelectionEditor.mf(lb)||M.a.uCa(lb,!1))return null;
Ub=U.ParagraphReader.text(lb.node);cb=0<ib?f.a.$ab(Ub,ib-1)+1:f.a.$ab(Ub,Ub.length-1)+1;ib=0<ib?ib:Ub.length;Ub=f.a.substring(Ub,cb,ib);return!Ub||this.gmh&&!M.a.VXa(Ub)||!f.a.IX(Ub)&&!f.a.m9c(Ub)||!ab.Np.bzo(lb,cb,ib)?null:this.Nyk.oGl(lb.node,cb,ib)}Ooi(cb,ib){var Ub=N.SelectionFactory.pp(cb,!1);if(!Ub)return null;var lb=Ub.Uc;if(!H.SelectionEditor.mf(lb))return null;0>ib&&(ib=lb.cpBegin);var Qb=U.ParagraphReader.text(lb.node);Ub=this.hEf(Qb,ib);const fc=ab.lkf.length;for(let Fc=0;Fc<fc;++Fc){const nc=
Qb.lastIndexOf(f.a.charAt(ab.lkf,Fc),ib-1);nc>Ub&&(Ub=nc+1)}Qb=f.a.substring(Qb,Ub,ib);if(!Qb)return null;lb=this.XIf(lb).LCID;return(new Xa(Qb,lb)).Enn()?Ja.aI(cb,Ub,ib,this.Qd):null}xoi(cb,ib){var Ub=N.SelectionFactory.pp(cb,!1);if(!Ub)return null;Ub=Ub.Uc;if(!H.SelectionEditor.mf(Ub))return null;0>ib&&(ib=Ub.cpBegin);var lb=U.ParagraphReader.text(Ub.node);Ub=this.hEf(lb,ib);lb=f.a.substring(lb,Ub,ib);return lb?(lb=(new Ca(lb)).tdm())?xa.aI(cb,Ub,ib,lb,this.Qd):null:null}Q9l(cb,ib,Ub,lb,Qb){var fc=
N.SelectionFactory.pp(cb,!1);if(!fc)return null;fc=fc.Uc;if(Ub>ib||!H.SelectionEditor.mf(fc))return null;0>ib&&(ib=fc.cpBegin);if(0>ib)return null;fc=U.ParagraphReader.text(fc.node);return tb.aI(cb,Ub,Qb,ib?fc.charAt(ib-1):"\x00",this.Qd,lb)}WJb(cb,ib,Ub,lb){this.rOc.push(new Ya(`^${cb}$`,ib,Ub,lb))}T8f(cb){if(this.F4b[this.Yib]){const ib=this.F4b[this.Yib];for(const Ub in cb)ib[Ub]=cb[Ub]}else this.F4b[this.Yib]=cb}X8f(cb){this.GDc[this.Yib]?this.GDc[this.Yib].push(...(cb||[])):this.GDc[this.Yib]=
cb}Ozn(cb,ib){var Ub;this.vLe.has(ib)||(this.vLe.add(ib),null===(Ub=w.AFrameworkApplication.Be)||void 0===Ub?void 0:Ub.Ij(cb,1,null,null,!1,3,lb=>{this.Yib=ib;try{Object(u.a)(lb.data.De)}catch(Qb){v.ULS.sendTraceTag(5898336,324,50,"Failed to parse autocorrect: {0}",{["ResponseData"]:lb.data?lb.data.De:""})}this.Yib=-1},()=>{this.d1l(ib)},null,void 0,void 0,void 0,void 0,"27"))}d1l(cb){cb=O.lyi(cb);0<cb&&this.A_c(cb)}static get jbl(){return null!=ab.ZTg?ab.ZTg:ab.ZTg=(()=>ab.UVh.map(([cb,...ib])=>
(new Ya(`^${cb}`,...ib)).pattern))()}static get UVh(){return null!=ab.$Tg?ab.$Tg:ab.$Tg=(()=>[...ta.Zqg.map(cb=>[cb,ta.QW,ta.aI,3]),["\\(?(\\d+)[\\.\\)\\-]",Ea.QW,Ea.aI,3],["\\(?(L|l|C|c|D|d|M|m){1}[\\.\\)\\-]",ua.QW,ua.aI,3],...Pa.Zqg.map(cb=>[cb,Pa.QW,Pa.aI,11]),["\\(?([A-Za-z]){1}[\\.\\)\\-]",ua.QW,ua.aI,3]])()}Xzn(){this.A_c(1033);this.WJb("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Za.QW,Za.aI,5);this.WJb("=rand\\.old\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Za.QW,Za.aI,5);this.WJb("=lorem\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",
Za.QW,Za.aI,5);ab.UVh.forEach(cb=>this.WJb(...cb));this.WJb("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",za.QW,za.aI,0);this.WJb("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",ja.QW,ja.aI,0);this.WJb("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",ja.QW,ja.aI,0)}A_c(cb){this.vLe.has(cb)||this.Ozn(I.a.vel(String.format("Acl/Acl{0}.js",cb)),cb)}static g6f(){y.a.instance.Qa("Common.ISystemInitiatedFeedback").execute(cb=>{cb.logActivity("AutocorrectStringMatch",null)})}static get Np(){return null!=ab.JYg?ab.JYg:
ab.JYg=y.a.instance.resolve("Box4.IHyperlinkEditor")}}ab.kkf=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";ab.lkf=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";ab.Eyg=".!?";ab.Zcj=5;Object(G.a)(ab,"AutoCorrectRules",null,[298])},1748:function(G,J,d){G=d(0);var m=d(77),f=d(104),a=d(346),l=d(367);class w{constructor(F,I,H,N=0,M=0,U=null,O=null){this.commandId=F;this.controlId=I;this.timeStamp=H;this.commandSurface=a.a[N];this.iz=l.a[M];
this.contentType=U;this.GCe=O}}Object(G.a)(w,"CommandActionInfo",null,[]);class y{constructor(){this.tmk=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))");this.hsk=RegExp("(CoauthorsRendered|DoNothing|MenuClose|MenuOpen|ZeroTermContextMenuClose|SmartLookupContextMenu|TabSwitch|((TellMe).+))")}isNullOrUndefined(F){return null===F||"undefined"===typeof F}Ttn(F){return!this.tmk.exec(F)}Utn(F){return this.isNullOrUndefined(F)||!F.trim().length?!1:!this.hsk.exec(F)}}
Object(G.a)(y,"EventsCacheLoggingUtils",null,[]);class v{constructor(F,I,H,N){this.CmdId=this.ParentTcid=this.Tcid=null;this.Time=0;this.Tcid=F;this.ParentTcid=I;this.CmdId=H;this.Time=N}}Object(G.a)(v,"MRUControl",null,[]);var u=d(2),x=d(1947),z=d(698),A=d(149);d.d(J,"a",function(){return D});class D{constructor(){this.jLc=null;this.Guh=this.I0e=20;this.zHd=this.Txa=this.BHc=this.tyd=this.Tyd=null;this.kFh=this.ZXe=!1;this.nvl=(F,I)=>{this.Tyd.insert(0,new w(I.commandId,I.controlId,I.time,I.commandSurface,
I.iz,I.contentType,I.Htc));this.qKg(this.Tyd);this.ZXe&&this.jLc.Utn(I.controlId)&&this.YVk(I)}}init(){this.jLc=new y;this.Tyd=new m.a;this.tyd=new m.a;this.BHc=new m.a;this.I0e=u.AFrameworkApplication.K.ic("MaxCommandClickedEventQueueSize",20);x.a.F0k(this.nvl);z.a.instance.FPh(Object(f.a)(this,this.Aoo,"recordActionEvent"));this.ZXe=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UserMRUActionsCookieEnabled",!1);this.kFh=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPreferParentControls",
!0);this.ZXe&&(this.Txa=new m.a,this.zHd="UserRecentActions_"+this.n5d(),this.yAn())}n5d(){switch(u.AFrameworkApplication.ua.Ib.Tk){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}yAn(){var F=A.a.get(this.zHd);if(!this.jLc.isNullOrUndefined(F)&&0<F.length){let I=null;try{I=JSON.parse(decodeURIComponent(F))}catch(H){A.a.remove(this.zHd);return}F=0;for(const H of I)this.Txa.insert(F++,H)}}YVk(F){const I=this.kFh&&
!this.jLc.isNullOrUndefined(F.Htc)&&0<F.Htc.length;if(0<this.Txa.count){for(var H=0;H<this.Txa.count&&3>H;H++){var N=this.Txa.J(H);if(I&&N.ParentTcid===F.Htc||N.Tcid===F.controlId)return}for(H=3;H<this.Txa.count;H++)if(N=this.Txa.J(H),I&&N.ParentTcid===F.Htc||N.Tcid===F.controlId){this.Txa.remove(N);break}}this.Txa.insert(0,new v(F.controlId,F.Htc,F.commandId,F.time));this.Txa.count>this.Guh&&this.Txa.removeAt(this.Guh);F=JSON.stringify(this.Txa.toArray());A.a.vOa(this.zHd,F,A.a.xMa)}qKg(F){F.count>
this.I0e&&F.removeAt(this.I0e)}Aoo(F,I){this.tyd.insert(0,new w(I.actionName,I.controlId,I.timeStamp,I.commandSurface,I.iz,I.contentType,I.GCe));this.qKg(this.tyd);this.jLc.Ttn(I.actionName)&&(this.BHc.insert(0,new w(I.actionName,I.controlId,I.timeStamp,I.commandSurface,I.iz,I.contentType,I.GCe)),this.qKg(this.BHc))}x2c(){return this.Tyd}iqb(){return this.tyd}static get instance(){return D._instance||(D._instance=new D)}}D._instance=null;Object(G.a)(D,"CommandClickEventsCache",null,[])},1750:function(G,
J,d){G=d(0);var m=d(123),f=d(54),a=d(345),l=d(57),w=d(3),y=d(618),v=d(13),u=d(6),x=d(216),z=d(44),A=d(325),D=d(894),F=d(125),I=d(46),H=d(16),N=d(5),M=d(187),U=d(43),O=d(7),V=d(1985),Y=d(538),Q=d(1809),S=d(138),P=d(323);class T{constructor(ma,na,Fa,Qa,ya,ta){this.Khc=this.UJ=null;this.gGf=na;if(ma[Y.a.s5c])this.uN=ma[Y.a.s5c],this.ZSc=ma[Y.a.ZSc],this.Khc=Array(4),this.Khc[0]=ma[Y.a.Tob],this.Khc[1]=ma[Y.a.Uob],this.Khc[2]=ma[Y.a.Vob],this.Khc[3]=ma[Y.a.Sob],this.GFp=ma[Y.a.width],this.S_m=ma[Y.a.height],
this.MCa=void 0!==ma[Y.a.MCa]?"true"===ma[Y.a.MCa].toLowerCase():void 0,this.mt=Fa,this.whc=Qa;else{na=ma[Y.a.Tob];const Aa=ma[Y.a.Uob],oa=ma[Y.a.Vob],za=ma[Y.a.Sob];ta&&ta.$("EffectExtentPointsForGraphicsEditorIsEnabled")&&void 0!==na&&void 0!==Aa&&void 0!==oa&&void 0!==za?(this.Tob=na,this.Uob=Aa,this.Vob=oa,this.Sob=za):(this.Tob=ma[Y.a.left],this.Uob=ma[Y.a.right],this.Vob=ma[Y.a.top],this.Sob=ma[Y.a.bottom]);this.width=ma[Y.a.width];this.height=ma[Y.a.height];this.rotationAngle=ma[Y.a.angle];
this.wbo=ma[Y.a.vbo];this.mt=Fa;this.whc=Qa;this.pnb=ya;this.pLa=2;this.flipH=this.N_(ma,Y.a.flipH);this.flipV=this.N_(ma,Y.a.flipV);this.jRn();this.Rvp()}}Rvp(){this.UJ||(this.UJ=Array(4),this.UJ[0]=S.a.iI(this.Tob),this.UJ[1]=S.a.iI(this.Uob),this.UJ[2]=S.a.iI(this.Vob),this.UJ[3]=S.a.iI(this.Sob))}jRn(){var ma=P.e(this.rotationAngle);if(45<=ma&&135>=ma||225<=ma&&315>=ma){ma=this.width/2;const na=this.height/2;this.Tob-=ma-na;this.Uob+=ma-na;this.Vob-=na-ma;this.Sob+=na-ma}}N_(ma,na){if(ma.hasOwnProperty(na))return ma[na]}}
Object(G.a)(T,"JsonToDocumentXmlResponseCommonParams",null,[]);class Z extends T{constructor(ma,na,Fa,Qa,ya,ta){super(ma,na,Fa,Qa,ya,ta);this.Y4k="string"===typeof ma[Y.a.xSd]?ma[Y.a.xSd]:null;this.vic="string"===typeof ma[Y.a.vic]?ma[Y.a.vic]:null}}Object(G.a)(Z,"JsonToDocumentXmlResponseDrawingParams",T,[]);var X=d(467),aa=d(544);class ia extends T{constructor(ma,na,Fa,Qa,ya,ta){var Aa,oa,za,ja,fa;super(ma,na,Fa,Qa,ya,ta);this.SAp=ma[Y.a.bbo];this.lzl=ma[Y.a.Uao];this.pLa=aa.a.qdb;this.lzl||(this.pLa=
aa.a.ycg,this.UJ=X.a.instance.Hsa(S.a.iI(this.width),S.a.iI(this.height),this.rotationAngle));this.vig=this.N_(ma,Y.a.mtc);this.hpe=this.N_(ma,Y.a.hpe);this.wig=this.N_(ma,Y.a.wig);this.mbk=this.N_(ma,Y.a.lbk);this.NGe=this.N_(ma,Y.a.NGe);this.VOg=this.N_(ma,Y.a.VOg);this.wkd=null!==(Aa=this.N_(ma,Y.a.wkd))&&void 0!==Aa?Aa:"";this.extension=ma[Y.a.extension];this.mAa=null!==(oa=this.N_(ma,Y.a.left))&&void 0!==oa?oa:0;this.oAa=null!==(za=this.N_(ma,Y.a.top))&&void 0!==za?za:0;this.nAa=null!==(ja=this.N_(ma,
Y.a.right))&&void 0!==ja?ja:0;this.lAa=null!==(fa=this.N_(ma,Y.a.bottom))&&void 0!==fa?fa:0;this.lockAspectRatio=this.N_(ma,Y.a.lockAspectRatio);this.jXh=this.N_(ma,Y.a.Wma);this.borderStyle=this.N_(ma,Y.a.Vua);this.borderColor=this.N_(ma,Y.a.sNa);this.Gdl=void 0!==this.jXh||void 0!==this.borderStyle||void 0!==this.borderColor;this.altTextDescription=this.N_(ma,Y.a.altTextDescription);this.alphaModFix=this.N_(ma,Y.a.alphaModFix)}}Object(G.a)(ia,"JsonToDocumentXmlResponsePictureParams",T,[]);d.d(J,
"a",function(){return wa});class wa{constructor(ma,na,Fa,Qa,ya,ta,Aa,oa,za,ja,fa,Ca,xa,ua,sa,Ea,Ja){this.mib=this.DIb=null;this.GCd=ma;this.DTe=na;this.AM=Fa;this.Fn=Qa;this.Km=ya;this.Pc=ta;this.Vuk=oa;this.jgh=Aa;this.Ck=za;this.eq=ja;this.YIk=fa;this.XIk=Ca;this.Ga=xa;this.UY=ua;this.xd=sa;this.lBk=Ea;this.kzk=Ja}bV(ma,na,Fa,Qa,ya,ta,Aa){ta.stop();Aa?O.ULS.sendTraceTag(575522565,3001,10,ma):O.ULS.sendTraceTag(575522566,3001,10,ma);this.jgh?(Qa=this.Pc.Mc(7,w.a.u5c),Qa.Ab(Fa),na.Db.setValue(F.a.EVa,
!1),na.Db.setValue(I.a.h0,0),na.Db.setValue(H.a.lma,na.Iil),na.Db.setValue(H.a.kma,na.Gil),Qa.dispose()):Qa();this.mib&&this.mib(ma);ya()}Usc(ma,na,Fa,Qa,ya,ta,Aa){O.ULS.sendTraceTag(575522567,3001,50,"GraphicsEditorJsonToDocumentXmlRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:Aa.Fi});var oa=ma.data.De,za=null;try{za=JSON.parse(oa)}catch(fa){this.bV("Failed to parse incoming JSON blob.",na,ya,Qa,Fa,Aa,!1);return}if(V.a.error in za)this.bV("Error code returned from WordGraphicsEditorHandler endpoint: "+
za[V.a.error],na,ya,Qa,Fa,Aa,!1);else{oa=10;var ja=1;try{oa=parseInt(za[Y.a.mt]),ja=parseInt(za[Y.a.whc])}catch(fa){this.bV("Invalid data found in the JSON blob. (i.e. placeholderkind/drawingid)",na,ya,Qa,Fa,Aa,!1);return}Fa=ma.data.request?Object(y.a)(ma.data.request.get_body()):null;ma=null;ma=na.Db;Qa=na.getId();na=ma.getValue(N.a.mt);na=na!==oa&&(5===na||5===oa||this.uYm(ma,za));5===oa?(za=new ia(za,this.DTe,oa,ja,Fa,this.Ga),ma=this.xmm(ya,ta,za,na,ma,Qa)):(za=new Z(za,this.DTe,oa,ja,Fa,this.Ga),
ma=this.wmm(ya,ta,za,na,ma,Qa));za=this.Pc.Mc(7,w.a.u5c);oa=ya;v.ImageReader.vba(ya)&&na&&(oa=u.GraphIterator.eb(ya),oa.zb(12),oa=oa.parentNode);za.Ab(oa);ma();this.AM.mOa(ta);za.dispose();if(this.Km&&this.Km!==m.a.nil){const fa=oa.Jj();null===fa||void 0===fa?void 0:fa.yg.CF(()=>{O.ULS.sendTraceTag(574358089,3001,50,"Graphical Content Properties Persisted to Box4: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:Aa.Fi});Aa.stop();const Ca=new f.a(this.Km,1);this.Fn.mfc(fa,Ca);const xa=
this.GCd.properties;null!=xa&&Object(x.a)(()=>{const ua=new z.GraphTransaction(3,w.a.qba);ua.Ab(ya);xa.setValue(F.a.UP,1);ua.dispose()})},null,null)}this.DIb&&this.DIb(ya)}}CSh(ma,na){ma.ze(V.a.glg,"false");ma.ze(V.a.gGf,this.DTe);ma.ze(V.a.ysf,"0");ma.dL(Y.a.pnb,window.self.devicePixelRatio.toString());void 0!==na&&null!==na&&(na=this.eq.Qn(na.Hk),na=this.eq.Ek(na),ma.ze(Y.a.mt,A.a[na]));this.lBk&&(ma.ze(Y.a.wbe,"true"),ma.ze(Y.a.J3m,this.kzk.toString()))}hMh(ma){if(this.jgh){ma=ma.Hk;var na=this.eq.Qn(ma);
if(!na)return null;const Fa=new Q.a(this.Vuk,na),Qa=this.Pc.Mc(15,w.a.u5c);Qa.Ab(ma.node);this.ctj(na,!1);na.setValue(N.a.mt,na.ja(N.a.mt,10));Qa.yi=w.a.u5c;Qa.sMa(this.Km,1);Qa.dispose();return Fa}na=new a.DictionaryPropertySet;this.ctj(na,!0);return(ma=this.Ck.xhi(ma,na,this.Km))&&ma.blob?new Q.a(ma.blob.id,ma.blob.properties):null}g9d(){return Box4Intl.Box4Strings.l_GraphicsEditorError}ctj(ma,na){ma.setValue(H.a.lma,l.a.em(this.YIk,0));ma.setValue(H.a.kma,l.a.em(this.XIk,1));na?ma.setValue(I.a.h0,
1):ma.setValue(F.a.EVa,!0);ma.setValue(M.a.L7,!0)}wmm(ma,na,Fa,Qa,ya,ta){const Aa=oa=>{this.GCd.uwp(Fa,oa,ma)};return this.Agj(Qa,ya,ma)?this.Wvi(na,ya,ta,Aa):()=>{Aa(ya)}}xmm(ma,na,Fa,Qa,ya,ta){const Aa=oa=>{this.GCd.vwp(Fa,oa,ma)};return this.Agj(Qa,ya,ma,Fa)?this.Wvi(na,ya,ta,Aa):()=>Aa(ya)}Agj(ma,na,Fa,Qa){return ma?!0:Qa?v.ImageReader.k8d(na,Fa.Lc,!1)!==Qa.vig:!1}Wvi(ma,na,Fa,Qa){const ya=D.a.instance.Nvd;ya.Bv(na);ya.id=Fa;return()=>{this.GCd.sDo(ma,Fa,ya,this.UY,Qa)}}IYo(ma){this.DIb=ma}YSo(ma){this.mib=
ma}uYm(ma,na){return this.xd.isFeatureEnabled(43)&&(ma.hasProperty(U.a.uN)&&!na[Y.a.s5c]||!ma.hasProperty(U.a.uN)&&na[Y.a.s5c])?!0:!1}}Object(G.a)(wa,"GraphicsEditorJsonToDocumentXmlRequestHelper",null,[446])},1751:function(G,J,d){G=d(0);var m=d(34),f=d(7),a=d(492),l=d(621),w=d(2096),y=d(2),v=d(19),u=d(258),x=d(1885),z=d(23),A=d(22);class D extends w.a{constructor(I,H,N,M,U,O,V=null,Y=!1){super(I,H,N,M,U,"WACUploadFrame",y.AFrameworkApplication.userSessionId,O,!1,V,Y)}kD(I){return z.StaticActiveAppFrame.za().Sj(I)}CMj(I){u.a.instance.$Jb(I)}IXc(){y.AFrameworkApplication.bN&&
this.Vfc(a.a.bN,y.AFrameworkApplication.bN);0===A.App.jf.aO&&z.StaticActiveAppFrame.za().ib.activeSection.NG&&(f.ULS.sendTraceTag(41697634,322,100,"Box4UploadFrame.createHiddenInputElements: encrypted element"),this.Vfc(a.a.NG,z.StaticActiveAppFrame.za().ib.activeSection.NG))}t9d(I){let H=null,N;({group:N}=l.a.R4(I)).returnValue?H=N.Responses[0]:f.ULS.sendTraceTag(508404873,322,10,"Box4UploadFrame.GetServerResponse: unable to deserialize the response");return H}Nlc(){f.ULS.sendTraceTag(41697635,322,
15,"Box4ImageUploadFrame.HandleUploadError: The response is invalid, falling back on a default unspecified failure response");const I=new x.a;I.StatusCode=14;this.SGj(I);this.gRd()}UWb(I){I?(I=v.a.NYj(I),I=I.replace(RegExp("&amp;","g"),"&"),(I=this.t9d(I))?(this.SGj(I),this.gRd()):this.Nlc()):this.Nlc()}}Object(G.a)(D,"Box4UploadFrame",w.a,[]);d.d(J,"a",function(){return F});class F extends D{constructor(I,H,N,M,U,O=null,V=!1){super(I,H,N,M,U,F.Ofm(),O,V);this.FVf()}static Ofm(){return F.oKh.join(",")+
","+F.Icf.join(",")}IXc(){super.IXc();this.Vfc(a.a.FAb,"1");this.Vfc(a.a.R2b,"1")}Nlc(){super.Nlc();f.ULS.sendTraceTag(41697632,322,15,"Box4ImageUploadFrame.HandleUploadError: Falling back on a default Unspecified Failure response")}t9d(I){const H=super.t9d(I);if(!H)try{const N=m.a(I);l.a.UFf(N)}catch(N){f.ULS.sendTraceTag(41697633,322,10,"Box4ImageUploadFrame.GetServerResponse: {0}",N.toString())}return H}}F.oKh=".jpg .jpeg .png .gif .bmp .tif .tiff .jfif".split(" ");F.Icf=[".webp"];Object(G.a)(F,
"Box4ImageUploadFrame",D,[])},1752:function(G,J,d){G=d(0);class m{}Object(G.a)(m,"AuthContext",null,[]);var f=d(2),a=d(671);d.d(J,"a",function(){return l});class l{static getAuthContext(){const w=f.AFrameworkApplication.K.kb("UserPrincipalName")||"";let y=w;f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(y=a.a.ZSn||w);return Object.assign(new m,{upn:w,loginHint:y,authority:a.a.authority,authorityType:l.s5d(),tenantId:f.AFrameworkApplication.K.kb("TenantId")||
""})}static s5d(){let w=0;const y=l.$ti();"aad"===y.toLowerCase()?w=2:"msa"===y.toLowerCase()&&(w=1);return w}static $ti(){return f.AFrameworkApplication.K.kb("HostAuthType")||""}}Object(G.a)(l,"OAuthIdentity",null,[])},1753:function(G,J,d){d.r(J);G=d(0);var m=d(1935),f=d(1937),a=d(483),l=d(1938),w=d(184),y=d(2),v=d(103),u=d(101),x=d(575),z=d(249),A=d(10),D=d(73),F=d(91),I=d(112),H=d(96),N=d(33),M=d(60),U=d(41),O=d(20),V=d(12);class Y{constructor(P){this.ske=4;this.GAh=0;this.Beh=this.xah=this.eCh=
this.Jfh=this.BDh=this.KHa=this.ebc=this.gy=this.BGh=this.Uih=this.Vih=this.CHa=this.F4a=this.$Qe=this.y2a=this.q2a=this.W=this.N9=this.PFa=null;this.ikj=T=>{if(this.vw.JSb&&T.Kb.target===this.gy)return!0;this.vw.khg();return!0};this.jkj=()=>{this.vw.Nkj();return!0};this.kkj=T=>{let Z=!1;T.Kb.keyCode===F.a.Mu&&(0===this.vw.Cna?this.vw.khg():this.vw.Nkj(),Z=!0);return Z};this.Veg=()=>{if(this.q2a.disabled)return!0;this.vw.Lga();return!0};this.dfg=()=>{if(this.y2a.disabled)return!0;this.vw.I3n();return!0};
this.Ygg=()=>{if(this.F4a.disabled)return!0;this.vw.B1n();return!0};this.aoe=()=>{if(this.CHa.disabled)return!0;this.vw.PWb(this.gy.value);return!0};this.qeg=()=>{if(this.PFa.disabled)return!0;this.vw.onCancel();return!0};this.XMa=T=>{if(T.Kb.ctrlKey&&T.Kb.keyCode===F.a.Mu)return 0<this.gy.value.length&&this.aoe(null),!0;if(T.Kb.keyCode===F.a.Z4)return!0;this.vhg(T.eventName===A.a.jv&&T.Kb.charCode===F.a.Mu);return!1};this.TMa=()=>{this.vhg(!1);return!1};this.Jfd=()=>{const T=new H.a(0,1,0,()=>{this.vhg(!1)},
1);y.AFrameworkApplication.mc.Zb(T);return!1};O.a.sCa&&(this.ske=6);this.vw=P;this.N1=I.KeyInputManager.lc(F.a.Z4,0);this.render()}get containerElement(){return this.W}dispose(){var P=y.AFrameworkApplication.ua.UE;const T=y.AFrameworkApplication.ua.VE;P.xc(A.a.click,this.W,this.ikj);P.xc(A.a.$C,this.W,this.jkj);T.xc(A.a.oi,this.W,this.kkj);this.q2a&&(P.xc(A.a.click,this.q2a,this.Veg),T.iAb(this.q2a,this.Beh));this.y2a&&(P.xc(A.a.click,this.y2a,this.dfg),T.iAb(this.y2a,this.Jfh));this.CHa&&(P.xc(A.a.click,
this.CHa,this.aoe),T.iAb(this.CHa,this.BDh));this.PFa&&(P.xc(A.a.click,this.PFa,this.qeg),T.iAb(this.PFa,this.xah));this.F4a&&(P.xc(A.a.click,this.F4a,this.Ygg),T.iAb(this.F4a,this.eCh));this.gy&&(T.xc(A.a.jv,this.gy,this.XMa),T.xc(A.a.oi,this.gy,this.XMa),O.a.Di&&(P=y.AFrameworkApplication.ua.Qzc,P.xc(A.a.tWc,this.gy,this.TMa),P.xc(A.a.pfc,this.gy,this.TMa),P.xc(A.a.qfc,this.gy,this.TMa)),x.a.instance.xc(A.a.paste,this.gy,this.Jfd));this.KHa=this.ebc=this.gy=this.PFa=this.CHa=this.$Qe=this.y2a=this.F4a=
this.q2a=this.W=null}focus(){D.FocusManager.instance().ME(w.AFrame.Us);this.W.focus();this.vw.Mr.mIf().Mk.mA(this.W)}kqi(){D.FocusManager.instance().ME(f.a.lWc);this.gy.focus();this.vw.Mr.mIf().Mk.mA(this.gy);2===this.vw.Nr&&this.gy.value&&0<this.gy.value.length&&U.a.fnd(this.gy);const P=this.vw.Mr.Tga.Ogd,T=U.a.lWa(P,this.W);T.y+this.W.clientHeight>P.scrollTop+P.clientHeight&&(P.scrollTop=T.y+this.W.clientHeight-P.clientHeight)}l$l(){Sys.UI.DomElement.removeCssClass(this.W,"NewOrEditComment");this.PFa.style.display=
"none";this.gy.style.display="none";D.FocusManager.vKg(this.gy);D.FocusManager.vKg(this.CHa);D.FocusManager.instance().ge(f.a.lWc).tt(this.N1);D.FocusManager.instance().mdb(f.a.lWc);I.KeyInputManager.instance.xc(A.a.jv,this.gy,this.XMa);I.KeyInputManager.instance.xc(A.a.oi,this.gy,this.XMa);if(O.a.Di){const P=y.AFrameworkApplication.ua.Qzc;P.xc(A.a.tWc,this.gy,this.TMa);P.xc(A.a.pfc,this.gy,this.TMa);P.xc(A.a.qfc,this.gy,this.TMa)}x.a.instance.xc(A.a.paste,this.gy,this.Jfd);this.N9.removeChild(this.gy);
this.N9.removeChild(this.ebc);this.KHa=this.ebc=this.gy=null;this.KMg();this.Jtd();this.focus()}Jtd(){this.FEj(this.BGh,this.Vih,this.Uih,this.$Qe,this.W)}render(){var P=a.a("a",this.uma("cc"),"CommentContainer");N.a.Ls(P,N.a.ara,f.a.Dwl);P.tabIndex=0;this.vw.Mf&&(P.className+=" Reply1");var T=a.a("div",this.uma("ch"),"CommentHeaderRow");const Z=a.a("span",this.uma("ca"),"CommentAuthor UIFontBold");Z.innerText=this.vw.author;T.appendChild(Z);const X=a.a("span",this.uma("ct"),"CommentDate");X.innerText=
Y.kNl(this.vw.date,this.vw.Mr.jNl,this.vw.Mr.Kjp);Sys.UI.DomElement.addCssClass(X,y.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight");T.appendChild(X);const aa=a.a("span",this.uma("ci"),"CommentStatusIcon");T.appendChild(aa);let ia=null;this.vw.JSb&&(ia=l.a.o7a(this.uma("cl"),f.a.Hvl,CommonUIStrings.l_CommentCancelButton,"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(ia,y.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),ia.tabIndex=0,T.appendChild(ia));this.N9=a.a("div",this.uma("cn"),
"CommentContent");let wa=null,ma=null,na=null;this.vw.JSb?(wa=a.a("textarea",this.uma("ce"),f.a.C5h+" UIFont"),wa.rows=this.ske,wa.cols=50,wa.tabIndex=0,N.a.Ls(wa,"title",CommonUIStrings.l_CommentContent),this.N9.appendChild(wa),ma=a.a("div","","CommentTextMeasurementContainer"),na=a.a("textarea","",f.a.C5h+" UIFont"),na.rows=1,na.cols=50,na.style.visibility="hidden",na.spellcheck=!1,ma.appendChild(na),this.N9.appendChild(ma),2===this.vw.Nr&&(wa.value=this.vw.text.join("\n")+"\n")):this.KMg();const Fa=
a.a("div","","CommentFooterRow"),Qa=a.a("span",this.uma("cf"),""),ya=l.a.o7a(this.uma("cr"),f.a.xwl+" CommentFooterButton",CommonUIStrings.l_CommentReplyButton,"CommentReply_16x16x32",!1);ya.tabIndex=0;ya.setAttribute(N.a.Ph,N.a.eaa);Qa.appendChild(ya);const ta=l.a.o7a(this.uma("cd"),"CommentDoneButton CommentFooterButton",CommonUIStrings.l_CommentDoneButton,"CheckboxUnchecked_16x16x32",!1);ta.tabIndex=0;const Aa=ta.childNodes[0].childNodes[0];Qa.appendChild(ta);const oa=l.a.o7a(this.uma("cx"),f.a.Jvl+
" CommentFooterButton",CommonUIStrings.l_CommentDeleteButton,"Delete_16x16x32",!1);ta.tabIndex=0;Qa.appendChild(oa);Fa.appendChild(Qa);const za=a.a("span",this.uma("cfa"),""),ja=l.a.o7a(this.uma("cs"),f.a.ywl,CommonUIStrings.l_CommentSaveCommentButton,null);l.a.C_b(ja,!1);ja.tabIndex=0;za.appendChild(ja);Fa.appendChild(za);this.FEj(aa,Qa,za,Aa,P);this.vw.Mr.W8h||(Z.setAttribute("Unselectable","on"),X.setAttribute("Unselectable","on"));P.appendChild(T);P.appendChild(this.N9);P.appendChild(Fa);this.W=
P;this.y2a=ta;this.$Qe=Aa;this.q2a=oa;this.F4a=ya;this.CHa=ja;this.gy=wa;this.ebc=ma;this.KHa=na;this.PFa=ia;this.Vih=Qa;this.Uih=za;this.BGh=aa;P=y.AFrameworkApplication.ua.UE;T=y.AFrameworkApplication.ua.VE;P.nb(A.a.click,this.W,this.ikj);P.nb(A.a.$C,this.W,this.jkj);T.nb(A.a.oi,this.W,this.kkj);this.y2a&&(P.nb(A.a.click,this.y2a,this.dfg),this.Jfh=T.Zwb(this.y2a,this.dfg,F.a.Mu));this.F4a&&(P.nb(A.a.click,this.F4a,this.Ygg),this.eCh=T.Zwb(this.F4a,this.Ygg,F.a.Mu));this.CHa&&(P.nb(A.a.click,this.CHa,
this.aoe),this.BDh=T.Zwb(this.CHa,this.aoe,F.a.Mu));this.q2a&&(P.nb(A.a.click,this.q2a,this.Veg),this.Beh=T.Zwb(this.q2a,this.Veg,F.a.Mu));this.PFa&&(P.nb(A.a.click,this.PFa,this.qeg),this.xah=T.Zwb(this.PFa,this.qeg,F.a.Mu));wa&&(T.nb(A.a.jv,wa,this.XMa),T.nb(A.a.oi,wa,this.XMa),O.a.Di&&(P=y.AFrameworkApplication.ua.Qzc,P.nb(A.a.tWc,wa,this.TMa,null),P.nb(A.a.pfc,wa,this.TMa,null),P.nb(A.a.qfc,wa,this.TMa,null)),x.a.instance.nb(A.a.paste,wa,this.Jfd),this.d0o())}APj(P){l.a.C_b(this.CHa,P)}uma(P){return P+
"_"+this.vw.id}FEj(P,T,Z,X,aa){switch(this.vw.n_a){case 0:case 1:this.gVj(P,0);break;case 2:case 4:P.style.display="none";break;case 3:Sys.UI.DomElement.addCssClass(aa,"SaveFailure"),Sys.UI.DomElement.addCssClass(aa,"NoReply"),this.gVj(P,1)}this.vw.done?(Sys.UI.DomElement.addCssClass(aa,"CommentIsDone"),X.className=u.getImageClass("CheckboxChecked_16x16x32")):(Sys.UI.DomElement.removeCssClass(aa,"CommentIsDone"),X.className=u.getImageClass("CheckboxUnchecked_16x16x32"));this.vw.JSb?(Sys.UI.DomElement.addCssClass(aa,
"NewOrEditComment"),Sys.UI.DomElement.addCssClass(aa,"SelectedComment"),P.style.display="none",T.style.display="none",Z.style.display="inline",0===this.vw.Mr.mode&&(this.APj(!1),l.a.C_b(this.PFa,!1))):(1===this.vw.Cna?(Sys.UI.DomElement.addCssClass(aa,"SelectedComment"),Sys.UI.DomElement.removeCssClass(aa,"SelectedParentComment"),T.style.display=1!==this.vw.Mr.mode||3===this.vw.n_a||this.vw.CXa?"none":"inline"):(2===this.vw.Cna?(Sys.UI.DomElement.removeCssClass(aa,"SelectedComment"),Sys.UI.DomElement.addCssClass(aa,
"SelectedParentComment")):(Sys.UI.DomElement.removeCssClass(aa,"SelectedComment"),Sys.UI.DomElement.removeCssClass(aa,"SelectedParentComment")),T.style.display="inline"),Z.style.display="none")}gVj(P,T){M.a.rF(P);switch(T){case 0:T=document.createElement("img");T.alt=CommonUIStrings.l_CommentProgressTooltip;T.src=v.a.Tea("progress16.gif");P.appendChild(T);break;case 1:T=u.createClusteredImage(16,16,"Risks_16x16x32","",!0,CommonUIStrings.l_CommentFailTooltip),P.appendChild(T)}P.style.display="inline-block"}KMg(){M.a.PT(this.N9);
var P=this.vw.text;1===P.length&&P[0]&&(P=P[0].split("\n"));for(const T of P)P=a.a("p","","CommentContentPara"),P.innerText=T||"\u00a0",this.vw.Mr.W8h||P.setAttribute("Unselectable","on"),this.N9.appendChild(P)}d0o(){const P=D.FocusManager.instance().ge(f.a.lWc);P.parent=w.AFrame.Us;z.a.instance.vcc(f.a.lWc,this.gy);P.bindAction(I.KeyInputManager.lc(F.a.lJe,2),V.a.Vg);P.bindAction(this.N1,V.a.Aqf);P.bindAction(I.KeyInputManager.lc(F.a.y9,0),V.a.V7a);P.bindAction(I.KeyInputManager.lc(F.a.aia,0),V.a.V7a);
P.tt(D.FocusManager.instance().MZ);P.tt(D.FocusManager.instance().NZ)}vhg(P){if(0!==this.vw.Mr.mode&&(this.APj(0<this.gy.value.length),!O.a.sCa)){this.ebc.clientWidth!==this.gy.clientWidth&&(this.ebc.style.width=this.gy.clientWidth+"px");this.KHa.value=this.gy.value+"___";this.GAh>this.gy.value.length&&(this.KHa.rows=1);for(var T=0,Z=Number.MAX_VALUE;1<=(T=this.KHa.scrollHeight-this.KHa.clientHeight)&&T<Z;)Z=T,this.KHa.rows++;this.KHa.rows<this.ske?this.gy.rows=this.ske:(P&&this.KHa.rows++,this.gy.rows=
this.KHa.rows);this.GAh=this.gy.value.length}}static kNl(P,T,Z){if(!P||isNaN(P.getDate()))return"";let X=Z;const aa=new Date;if(aa.getFullYear()!==P.getFullYear()||aa.getMonth()!==P.getMonth()||aa.getDate()!==P.getDate())X=String.format(CommonUIStrings.l_CommentLongDateFormat,T,Z);return P.localeFormat(X)}}Object(G.a)(Y,"CommentViewObject",null,[13,1571]);var Q=d(123);d.d(J,"Comment",function(){return S});class S{constructor(P,T,Z,X,aa,ia,wa,ma,na=!1,Fa=null,Qa=null,ya=null){this.d9g=this.e9g=this.egh=
null;this.hMd=0;this.Nkb=2;this.XFa=0;this.hRe=this.NQ=null;this.v_f=!1;this.objectId=null;this.CXa=!1;this._id=P;this.vkh=T;this.Q9g=Z;this.Ozd=X;this.$Kd=aa;this.YQa=ia;this.GQ=wa;this.tkh=ma;this.n7h=na;this.Kok=Fa;this.Lok=Qa;this.usersByReactionType=ya;this.Gj=m.a.instance}get id(){return this._id}set id(P){this._id=P}get author(){return this.age?CommonUIStrings.l_RemovedAuthorName:this.Q9g}get authorId(){return this.Kok}get Idc(){return this.Lok}get date(){return this.age?null:this.Ozd}set date(P){this.Ozd=
P}get done(){return this.YQa}set done(P){this.YQa!==P&&(this.YQa=P,this.NQ&&this.NQ.Jtd())}get cMi(){return this.tkh}set cMi(P){this.tkh=P}get Mf(){return this.$Kd}set Mf(P){this.$Kd=P}get text(){return this.GQ}set text(P){this.GQ=P;this.NQ&&this.NQ.KMg()}get LBa(){return this.vkh}set LBa(P){this.vkh=P}get a8a(){return this.egh}set a8a(P){this.egh=P}get cTc(){return this.e9g}set cTc(P){this.e9g=P}get bTc(){return this.d9g}set bTc(P){this.d9g=P}get Cna(){return this.hMd}set Cna(P){this.hMd!==P&&(this.hMd=
P,this.NQ&&this.NQ.Jtd())}get n_a(){return this.Nkb}set n_a(P){this.Nkb===P||0===this.Nkb&&2===P||3===this.Nkb||(this.Nkb=P,this.NQ&&this.NQ.Jtd())}get Nr(){return this.XFa}set Nr(P){if(this.XFa!==P){const T=this.JSb&&0===P;this.XFa=P;T&&this.NQ&&this.NQ.l$l()}}get JSb(){return 1===this.XFa||2===this.XFa}get age(){return!!this.Gj&&this.Gj.fha}get containerElement(){return this.NQ?this.NQ.containerElement:null}get Mr(){return this.Gj}get KA(){return this.hRe}set KA(P){this.hRe=P}dispose(){this.NQ&&
(this.NQ.dispose(),this.NQ=null)}render(){this.NQ=new Y(this);return this.NQ.containerElement}Ibb(){this.NQ&&this.NQ.Jtd()}focus(){this.khg();this.NQ.focus();this.JSb&&this.NQ.kqi()}toString(){let P="[null]";this.GQ&&0<this.GQ.length&&(P=30<this.GQ[0].length?this.GQ[0].substr(0,30)+"...":this.GQ[0]);return String.format('I:{0} A:{1} T:{2} R:{3} D:{4} "{5}"',this._id||"[null]",this.Q9g||"[null]",this.Ozd?this.Ozd.toString():"[null]",this.$Kd||"[null]",this.YQa,P)}khg(){2===this.Mr.mode||3===this.Mr.mode?
this.JSb&&this.NQ.kqi():(D.FocusManager.instance().ME(w.AFrame.Us),1!==this.hMd&&this.Mr.selectComment(this._id))}Nkj(){this.Mr.Mep&&0===this.XFa&&(D.FocusManager.instance().ME(w.AFrame.Us),this.XFa=2,this.Nkb=0,this.Mr.Pob(this,null))}pXn(){3===this.Mr.mode&&(D.FocusManager.instance().ME(w.AFrame.Us),this.XFa=0,this.Nkb=2,this.Mr.Tnf())}Lga(){D.FocusManager.instance().ME(w.AFrame.Us);this.Mr.deleteComment(this)}I3n(){this.Mr.xLb(this,!this.YQa)}B1n(){2!==this.Mr.mode&&(D.FocusManager.instance().ME(w.AFrame.Us),
this.Mr.$lb(this.$Kd||this._id,null))}PWb(P){D.FocusManager.instance().ME(w.AFrame.Us);this.GQ=Array(1);this.GQ[0]=P;1===this.XFa?this.Mr.Uza(this):this.Mr.Dnb(this)}onCancel(){D.FocusManager.instance().ME(w.AFrame.Us);this.Mr.Tga.Ogd&&this.Mr.Tga.Ogd.focus();1===this.XFa?(this.Mr.deleteComment(this),this.Mr.Ewe(this.Mf)):this.pXn()}static R9h(P,T,Z,X){const aa=Q.a.create().toString();P=new S(aa,S.STm,P,new Date,T,!1,[],Z,!1,y.AFrameworkApplication.K.kb("PresenceUserId"),y.AFrameworkApplication.K.kb("PresenceProvider"));
P.XFa=1;P.Nkb=0;P.hRe=X;return P}}S.STm=null;S.Uqj=-1;Object(G.a)(S,"Comment",null,[13,670])},1769:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.handler=null}}Object(G.a)(m,"SetAnnotationResultCallbackParameters",null,[])},1771:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{static get ytc(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}m.SOb="fontInfoTaskPane";m.experienceId="modernfontpicker";Object(G.a)(m,"FontInfoPaneConstants",
null,[])},1772:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.endDate=this.startDate=null}}Object(G.a)(m,"CommentTaskSchedule",null,[])},1773:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);var m=d(89);class f{static get ed(){return null!=f.YVg?f.YVg:f.YVg=new m.a}static G0k(a){f.ed.addHandler(f.mkj,a)}static m1k(a){f.ed.addHandler(f.Kmj,a)}}f.mkj="OnCopyComment";f.Kmj="OnPasteComment";Object(G.a)(f,"CommentEventsManager",null,[])},1774:function(G,J,d){d.d(J,
"a",function(){return m});const m={cDf:"TasksFeatureUsage",uhp:"TaskExperienceDegraded",vCe:"TaskCreate",wCe:"TaskEngagement"}},1777:function(G,J,d){d.d(J,"c",function(){return w});d.d(J,"b",function(){return y});d.d(J,"a",function(){return v});var m=d(77),f=d(7),a=d(2),l=d(34);const w=u=>{if(!u)return null;let x;try{x=l.b(u)}catch(z){x=null,f.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",z)}return x},y=(u,x)=>{let z=[];if(u.breadcrumbs&&
0<u.breadcrumbs.length)z=u.breadcrumbs;else{const A=u.service_info;A&&A.friendly_service_name&&Array.add(z,A.friendly_service_name);u.display_path&&Array.addRange(z,u.display_path)}return z.join(x?" \u00ab ":" \u200f\u00bb ")},v=(u,x=!1)=>{if(!u)return[];if(!u.documents)return f.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!u.documents.items)return f.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];u=u.documents.items;const z=new m.a;for(let D=0;D<u.length;D++){const F=
u[D];var A=F.web_url;if(!A){f.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!F.url){f.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}A=String.format("{0}?web=1",F.url)}const I={};I.DocumentUrl=A;I.MruId=F.mru_id;{A=F;let H=A.title;H?(A.extension&&(H=String.format("{0}.{1}",H,A.extension)),A=H):(f.ULS.sendTraceTag(578352837,202,15,"empty file title"),A="")}I.FileName=A;I.IsPinned=F.is_pinned;I.Path=y(F,a.AFrameworkApplication.isRtl);x&&(I.App=F.app,I.TimeStamp=F.time_stamp);z.add(I)}return z.toArray()}},
1778:function(G,J,d){d.d(J,"a",function(){return a});G=d(0);var m=d(96),f=d(20);class a{constructor(l,w,y){this.er=this.Rhg=null;this.HCh=this.Gkb=this.GCh=this.wHa=0;this.yBd=null;this.hfg=v=>{if(this.qoa(v,this.er)){if(f.a.HF||f.a.uj)this.yBd=v;this.WAa(this.er,null)}};this._context=l;this.Gb=w;this.Ga=y;this.Dob=!1;this.$td=!0;this.OFo();this.avb=this.K.$("NativeFileOpenDialogIsEnabled")}get context(){return this._context}get K(){return this.Ga}get retryCount(){return this.wHa}get HHo(){return this.GCh}get zdb(){return this.Gkb}get KHo(){return this.HCh}Yvb(l){this.er=
l;if(!this.Dob){if(this.$td){if(this.avb&&f.a.HF){this.yBd=l.BZc(this.hfg);return}this.yBd=l.BZc(null);if(!this.qoa(this.yBd,l))return}this.WAa(l,null)}}dtc(){this.Rhg&&this.Rhg()}QHo(l){if(!l||this.retryCount>=this.HHo)return!1;this.wHa=this.retryCount+1;const w=new m.a(2,1,this.zdb,()=>{this.tld(l)},110);this.Gb.Zb(w);this.zdb<this.KHo&&(this.Gkb=2*this.zdb);return!0}OFo(){this.wHa=0;this.GCh=this.K.ic("Box4UploadRetryCount",20);this.Gkb=this.K.ic("Box4UploadRetryDelayStart",200);this.HCh=this.K.ic("Box4UploadRetryDelayMax",
3200);this.er&&(this.er.dispose(),this.er=null)}}Object(G.a)(a,"FileUploader",null,[])},1779:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}m.Callback="action";Object(G.a)(m,"MenuLauncherAsyncTriggerCommandProperties",null,[])},1780:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,l,w,y){void 0===y&&(y=w);Object.defineProperty(a,y,{enumerable:!0,get:function(){return l[w]}})}:function(a,l,w,y){void 0===y&&(y=w);a[y]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===
w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1952),J);f(d(1953),J);f(d(1954),J);f(d(1955),J);f(d(1956),J);f(d(1957),J)},1781:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,l,w,y){void 0===y&&(y=w);var v=Object.getOwnPropertyDescriptor(l,w);if(!v||("get"in v?!l.mJ:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,y,v)}:function(a,l,w,y){void 0===y&&(y=w);a[y]=l[w]}),f=this&&
this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1958),J);f(d(1959),J)},1782:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,l,w,y){void 0===y&&(y=w);var v=Object.getOwnPropertyDescriptor(l,w);if(!v||("get"in v?!l.mJ:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,y,v)}:function(a,l,w,y){void 0===y&&(y=w);a[y]=l[w]}),
f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1960),J);f(d(1961),J)},1784:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(G.a)(m,"CalloutButtonProps",null,[])},1785:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);var m=d(7);class f{constructor(a){this.Oj=a}get ql(){return this.Oj&&
this.Oj.nj?this.Oj:null}Pxb(a,l){return this.ql?this.ql.Knf(a,!0)?this.ql.Pxb(a,l,!0,!0,!1):(m.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(G.a)(f,"PageViewWrapper",null,[])},1786:function(G,J,d){function m(){a||(f.Health.instance.addQosPillar("AsyncCollab"),a=!0)}d.d(J,"a",function(){return m});var f=d(92);let a=!1},1787:function(G,J,d){d.d(J,"c",function(){return m});d.d(J,"b",function(){return f});d.d(J,"a",function(){return a});
var m;(function(l){l[l.Title=1]="Title";l[l.Subtitle=2]="Subtitle";l[l.FirstLevelHeading=3]="FirstLevelHeading";l[l.SecondLevelHeading=4]="SecondLevelHeading";l[l.ThirdLevelHeading=5]="ThirdLevelHeading";l[l.ForthLevelHeading=6]="ForthLevelHeading";l[l.FifthLevelHeading=7]="FifthLevelHeading";l[l.SixthLevelHeading=8]="SixthLevelHeading";l[l.SeventhLevelHeading=9]="SeventhLevelHeading";l[l.EighthLevelHeading=10]="EighthLevelHeading";l[l.NinthLevelHeading=11]="NinthLevelHeading";l[l.BulletedListItem=
12]="BulletedListItem";l[l.BodyText=13]="BodyText";l[l.NumberedListItem=14]="NumberedListItem"})(m||(m={}));var f;(function(l){l.Article="Article";l.Letter="Letter";l.Poem="Poem";l.Story="Story";l.General="General";l.InterviewAssistant="InterviewAssistant";l.TravelPlan="TravelPlan";l.Recipe="Recipe";l.Resume="Resume";l.PodcastQuestions="PodcastQuestions"})(f||(f={}));var a;(function(l){l[l.Success=0]="Success";l[l.OffensiveContentInput=1]="OffensiveContentInput";l[l.OffensiveContentOutput=2]="OffensiveContentOutput";
l[l.EmptyResponse=3]="EmptyResponse";l[l.ErrorInExecution=4]="ErrorInExecution";l[l.NonSupportedLanguageInput=6]="NonSupportedLanguageInput";l[l.NonSupportedLanguageOutput=7]="NonSupportedLanguageOutput";l[l.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList";l[l.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList";l[l.InputAttackDetected=10]="InputAttackDetected";l[l.OutputAttackDetected=11]="OutputAttackDetected";l[l.ParagraphParsingFailed=14]="ParagraphParsingFailed";
l[l.LLMClassificationBlocked=15]="LLMClassificationBlocked";l[l.TooLargeRequest=16]="TooLargeRequest";l[l.StreamParsingFailed=17]="StreamParsingFailed";l[l.RequestRejected=18]="RequestRejected";l[l.PartialResult=19]="PartialResult";l[l.ModelPartialResult=20]="ModelPartialResult";l[l.ModelEmptyResponse=21]="ModelEmptyResponse";l[l.CopilotLicenseNotAvailable=22]="CopilotLicenseNotAvailable"})(a||(a={}))},1788:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a=0,l=!1){this.J$j=
!1;this.paragraphNode=f;this.Zbg=a;this.J$j=l}}Object(G.a)(m,"ReviewActionArgs",null,[])},1792:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f=0,a=0,l=0,w=0,y="",v="",u="",x="",z="0pt",A="0pt",D="0pt",F="0pt"){this.borderTopStyle=f;this.borderRightStyle=a;this.borderBottomStyle=l;this.borderLeftStyle=w;this.borderTopColor=y;this.borderRightColor=v;this.borderBottomColor=u;this.borderLeftColor=x;this.borderTopWidth=z;this.borderRightWidth=A;this.borderBottomWidth=D;this.borderLeftWidth=
F}}Object(G.a)(m,"TableCellBorderProperties",null,[])},1793:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f="",a="",l="",w=""){this.Mml=f;this.Lml=a;this.Jml=l;this.Kml=w}}Object(G.a)(m,"TableCellMarginProperties",null,[])},1797:function(G,J,d){d.d(J,"a",function(){return l});G=d(0);var m=d(44);d(5);var f=d(7),a=d(1519);class l{constructor(w,y){this.xFn=()=>{f.ULS.sendTraceTag(39358976,324,50,"ForceSave request was successful in AutoSaveParamsUpdateService.")};this.pMa=
(v,u)=>{f.ULS.sendTraceTag(39358977,324,10,"ForceSave request failed in AutoSaveParamsUpdateService with status code {0}.",u)};this.HDb=y}QLj(w,y,v,u=null,x=null,z=null){if(w){var A=new m.GraphTransaction(0);A.Ab(w);w.setValue(y,v);A.dispose();try{this.HDb(a.a.cbl,!1,u||this.xFn,x||this.pMa,z,null,null)}catch(D){f.ULS.sendTraceTag(39358947,324,10,"Error calling ForceSave in TableOfContentsActor.SendSaveRequest. Message: {0}",D.message)}}else f.ULS.sendTraceTag(39358946,324,10,"AutoSaveParametersNode is null in AutoSaveParamsUpdateService.")}}
Object(G.a)(l,"AutoSaveParamsUpdateService",null,[324])},1798:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);var m=d(7);class f{constructor(a){this.N0j=a}Yd(a,l){if(a){var w=this.N0j();a();a=this.N0j();m.ULS.sendTraceTag(555307094,345,50,`${l}-${a-w}`)}else m.ULS.shipAssertTag(520127454,345,!1)}}Object(G.a)(f,"PerfLogger",null,[396])},1799:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a){this.paragraphNode=f;this.state=a}}Object(G.a)(m,"ReviewCompletedArgs",
null,[])},1800:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a){this.index=f;this.count=a}}Object(G.a)(m,"DesignerReviewPosition",null,[])},1801:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);var m;(function(a){a[a.empty=0]="empty";a[a.filled=1]="filled"})(m||(m={}));Object(G.b)("BlueDotHighlightContextType",m);class f{constructor(a,l,w=WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionTooltipClick,y=m.empty){this.jt=a;this.aUc=l;this.plp=w;this.ddl=y}}
Object(G.a)(f,"BlueDotHighlightContext",null,[])},1802:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.qw=this.rp=this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0;this.vCa=!1;this.hXb=this.mVb=5;this.vra=this.GG=this.eWc=0;this.Wul=!1;this.e7i=3}}Object(G.a)(m,"SectionPropertiesData",null,[])},1803:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(203);class m extends d.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=
this.AriaDescription=this.IconName=this.Label=null}get ControlType(){return 12}}Object(G.a)(m,"ErrorViewProps",d.a,[])},1804:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(203);class m extends d.a{constructor(){super();this.CommandValueId=this.ActionCommandValueId=this.ActionText=this.ActionIdMapped=this.ActionId=this.Details=this.Links=this.Description=this.SecondaryLabel=this.Label=this.iconSet=this.ActionCommandId=this.CommandIdMapped=this.CommandId=null}get ControlType(){return 13}}
Object(G.a)(m,"MultiActionButtonProps",d.a,[])},1805:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}Object(G.a)(m,"PersonaInfo",null,[])},1806:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}Object(G.a)(m,"PersonaIdentifiers",null,[])},1808:function(G,J,d){d.d(J,"a",function(){return D});G=d(0);var m=d(205),f=d(2),a=d(21),l=d(20),w=d(13),y=d(325),v=d(258),u=d(432),x=d(7),z=d(492),A=d(538);class D{constructor(F,I,H,N,M,U,O,V,Y,Q,S,P,T,Z){this.us=F;this.b3a=I;this.Ga=
H;this.zq=N;this.Ps=M;this.cG=U;this.sea=O;this.Bhb=V;this.xhb=Y;this.zhb=Q;this.Ahb=S;this.vib=P;this.wib=T;this.zFd=Z}build(F,I,H,N){const M=new m.QueryStringBuilder("WordOart.ashx");f.AFrameworkApplication.Aja(M);M.ze(z.a.nodeId,I.id.toString());I=w.ImageReader.EFm(I,F.Lc);M.ze(A.a.QZd,I?I.ja(u.a.kdg,""):"");M.ze(A.a.width,this.zq.toString());M.ze(A.a.height,this.Ps.toString());M.ze(A.a.yhd,this.sea.toString());M.ze(A.a.MCo,y.a[this.b3a]);I=this.Ga.$("WordEditorImageCropIsEnabled");M.ze(A.a.Xbi,
I.toString());I&&(M.ze(A.a.top,this.Bhb.toString()),M.ze(A.a.bottom,this.xhb.toString()),M.ze(A.a.left,this.zhb.toString()),M.ze(A.a.right,this.Ahb.toString()));I=this.Ga.$("WordEditorImageRotateIsEnabled");M.ze(A.a.tIj,I.toString());I&&(M.ze(A.a.angle,this.cG.toString()),M.ze(A.a.flipH,this.vib?"true":"false"),M.ze(A.a.flipV,this.wib?"true":"false"));M.ze(A.a.glg,H?"true":"false");M.ze(A.a.sBe,this.zFd?"true":"false");this.Ga.$("WacWordEditorRenderHighContrastGraphicsIsEnabled")&&this.us&&this.us.sTf&&
M.ze(A.a.JWa,this.us.sTf);(F=F.Jj())?(M.ze(z.a.fileId,F.kq),M.ze(z.a.cellId,F.pl.toString())):x.ULS.sendTraceTag(575522528,322,10,"parentGraphSpace is null. Cannot set FileId and CellId. url: {0}",M.toString());F=a.a.instance.Oa("Box4.IFeatureHelper");F=!!F&&F.isFeatureEnabled(46);M.ze(A.a.wYl,"true");M.ze(A.a.N8m,F.toString());M.ze(A.a.Bji,"true");F&&M.ze(A.a.qtj,F.toString());M.ze(A.a.R8m,"true");v.a.instance.$Jb(M);H&&N&&!l.a.Mt&&M.dL(A.a.pnb,window.self.devicePixelRatio.toString());M.ze(A.a.YVh,
"true");return M.toString()}}Object(G.a)(D,"WordOartEndpointUrlBuilder",null,[])},1809:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);var m=d(16);class f{constructor(a,l){this._id=a;this.Db=l;this.Iil=l.ja(m.a.lma,0);this.Gil=l.ja(m.a.kma,0)}getId(){return this._id}}Object(G.a)(f,"GraphicsEditorImageContainer",null,[460])},1810:function(G,J,d){d.d(J,"a",function(){return V});G=d(0);var m=d(54),f=d(2),a=d(138),l=d(205),w=d(13),y=d(467),v=d(204),u=d(5),x=d(187),z=d(46),A=d(16),D=d(43),F=d(432),
I=d(125),H=d(63),N=d(1072),M=d(7),U=d(538),O=d(1808);class V{constructor(Y,Q,S,P,T,Z){this.properties=null;this.us=Q;this.Ck=P;this.Ga=T;this.pG=Z}uwp(Y,Q,S){Y.uN||(Q.setValue(u.a.$Sc,Y.Y4k),Q.setValue(u.a.A2d,Y.vic));this.Jck(Y,Q,S)}vwp(Y,Q,S){Q.setValue(u.a.CXb,Y.SAp);w.ImageReader.k8d(Q,S.Lc,!1)!==Y.vig&&Q.qg(u.a.sqe,x.a.iu,x.a.q8,z.a.Xfb);if(Y.hpe)Q.setValue(A.a.pca,m.a.Cf(Y.hpe));else{var P=this.u$h(Y.vig,Y.wig,Y.extension);S.Lc.ou(P);Q.setValue(A.a.pca,P.id)}Y.NGe?Q.setValue(z.a.Xfb,m.a.Cf(Y.NGe)):
Y.mbk&&(P=this.u$h(Y.mbk,Y.VOg,Y.extension),S.Lc.ou(P),Q.setValue(z.a.Xfb,P.id));Q.ja(u.a.tqe,"")!==Y.wkd&&(""!==Y.wkd?Q.setValue(u.a.tqe,Y.wkd):Q.removeProperty(u.a.tqe));0===Y.mAa&&0===Y.oAa&&0===Y.nAa&&0===Y.lAa||this.Ck.Tzg(Q,Y.oAa,Y.lAa,Y.mAa,Y.nAa);void 0!==Y.lockAspectRatio?Q.setValue(u.a.g0,Y.lockAspectRatio):Q.setValue(u.a.g0,!1);Y.Gdl&&(this.T_b(Q,u.a.Wma,Y.jXh),this.T_b(Q,u.a.Vua,Y.borderStyle),this.T_b(Q,u.a.sNa,Y.borderColor));void 0!==Y.altTextDescription&&Q.setValue(u.a.f0,Y.altTextDescription);
this.T_b(Q,D.a.alphaModFix,Y.alphaModFix);this.Jck(Y,Q,S);Y=y.a.instance.ZBf(Q);Q.setValue(u.a.Xga,Y)}u$h(Y,Q,S){const P=new N.a(H.a.Okg);P.setValue(F.a.kdg,Y);P.setValue(F.a.mtc,Y);P.setValue(z.a.c7l,m.a.Cf(Y).hu);P.setValue(u.a.vQi,Q);P.setValue(F.a.tDf,f.AFrameworkApplication.rootQuerySignature);P.setValue(z.a.Rni,S);return P}Jck(Y,Q,S){Y.uN?(this.properties=Q,Q.setValue(D.a.uN,Y.uN),Y.ZSc&&Q.setValue(D.a.wSd,Y.ZSc),Q.setValue(D.a.HBa,Y.GFp),Q.setValue(D.a.IBa,Y.S_m),Q.setValue(D.a.xWa,Y.Khc),
Q.setValue(u.a.mt,Y.mt),Q.setValue(u.a.Nob,Y.whc),Q.setValue(z.a.h0,0),Q.setValue(I.a.EVa,!1),Q.setValue(I.a.UP,0),this.T_b(Q,D.a.V$a,Y.MCa),this.qNh(Q,S,!1,!0),this.wql(Q)):(Q.setValue(u.a.pLa,Y.pLa),Q.setValue(x.a.iu,Y.pLa?Y.wbo:""),Y.pnb&&Q.setValue(x.a.MRb,Y.pnb),Q.setValue(u.a.mt,Y.mt),Q.setValue(u.a.Nob,Y.whc),Q.setValue(u.a.Xga,Y.UJ),Q.setValue(A.a.lma,a.a.iI(Y.width)),Q.setValue(A.a.kma,a.a.iI(Y.height)),Q.setValue(z.a.Rkg,a.a.iI(Y.width)),Q.setValue(z.a.Qkg,a.a.iI(Y.height)),Q.setValue(x.a.nLa,
-1),Q.setValue(x.a.mLa,-1),Q.setValue(A.a.xCa,!0),Q.setValue(u.a.vX,Y.rotationAngle),Q.setValue(I.a.EVa,!1),Q.setValue(z.a.h0,0),Y.pLa&&this.qNh(Q,S,!0,!1),this.xql(Q));5!=w.ImageReader.Ek(Q)?this.zql(Q):this.vql(Q);this.T_b(Q,u.a.zSf,Y.flipH);this.T_b(Q,u.a.VSf,Y.flipV)}sDo(Y,Q,S,P,T=null){Y=this.Ck.nDo(Y.Hk,Q,S,P);null==Y?M.ULS.sendTraceTag(561538391,3001,10,"Failed to replace picture properties"):T&&T(Y)}qNh(Y,Q,S,P){let T=!1;var Z=this.pG.Iu(Q);Z&&Z.wf(u.a.g1f)&&(T=!0);Z=w.ImageReader.Gfa(Y);
const X=w.ImageReader.Msa(Y);Q=(new O.a(this.us,w.ImageReader.Ek(Y),this.Ga,w.ImageReader.XB(Y),w.ImageReader.fD(Y),w.ImageReader.g3(Y),w.ImageReader.grb(Y),Math.max(Z.top,0),Math.max(Z.bottom,0),Math.max(Z.left,0),Math.max(Z.right,0),X.Spb,X.oKa,T)).build(Q,Y,!0,!0);P&&(P=new l.QueryStringBuilder(Q),P.ze(U.a.wbe,"true"),Q=P.toString());Y.setValue(u.a.Rob,Q);S&&v.a.V_b(Y,1,f.AFrameworkApplication.K,this.us)}T_b(Y,Q,S){void 0===S||null===S?Y.removeProperty(Q):Y.setValue(Q,S)}xql(Y){Y.removeProperty(D.a.uN);
Y.removeProperty(D.a.wSd);Y.removeProperty(D.a.HBa);Y.removeProperty(D.a.IBa);Y.removeProperty(D.a.xWa);Y.removeProperty(D.a.ame);Y.removeProperty(D.a.WWl);Y.removeProperty(D.a.V$a)}zql(Y){Y.removeProperty(u.a.sqe);Y.removeProperty(u.a.CXb);Y.removeProperty(A.a.pca);Y.removeProperty(u.a.tqe)}vql(Y){Y.removeProperty(u.a.A2d);Y.removeProperty(u.a.$Sc);Y.removeProperty(D.a.uN);Y.removeProperty(D.a.wSd)}wql(Y){Y.removeProperty(u.a.$Sc);Y.removeProperty(x.a.iu);Y.removeProperty(A.a.lma);Y.removeProperty(A.a.kma);
Y.removeProperty(u.a.Xga);Y.removeProperty(x.a.q8);Y.removeProperty(u.a.A2d);Y.removeProperty(u.a.vX)}}Object(G.a)(V,"GraphicsEditorImageEditor",null,[447])},1811:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}Object(G.a)(m,"SmartLookupApplicationInterface",null,[])},1812:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a,l,w,y,v){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=f;this.url=a;this.spWebUrl=
l;this.uniqueId=w;this.size=y;this.lastModified=v}}Object(G.a)(m,"FileInfo",null,[])},1843:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);var m=d(7);d=d(278);class f extends d.a{constructor(a,l,w,y){super(f.Ykf);this.Tm=a;this.Dg=l;this.view=w;this.options=y}initialize(){super.initialize();const a=this.options.h_b==this.Dg.Fea(this.view.jd,{MR:this.options.MR,$fa:this.options.Qmc,nta:this.options.Pmc,LR:this.options.LR});a&&!this.cma&&m.ULS.sendTraceTag(557114691,3028,50,this.aR(this.Tm,!0,
`satisfiedIfBlank=${this.options.h_b}`));this.Jg(a)}Pd(){super.Pd()}}f.Ykf="BlankDocumentConditionId";Object(G.a)(f,"BlankDocumentCondition",d.a,[])},1844:function(G,J,d){d.d(J,"a",function(){return D});G=d(0);var m=d(481),f=d(762),a=d(436),l=d(1540),w=d(2186),y=d(39),v=d(828),u=d(416),x=d(396),z=d(7);J=d(278);var A=d(123);class D extends J.a{constructor(F,I){super("SummaryGenerationCondition");this.qGg=-1;this.TLj=()=>{if(!D.AGg&&this.o3b.Sz>D.TMn){const H=f.a.getAugLoopRuntimeManager(),N=this.W4d();
this.qGg=Date.now();H.submitOperation(Object.assign(new x.a,{operation:N}))}};this.ULj=()=>{this.TLj();this.o3b.Eue(this.ULj)};this.TWb=H=>{H=H.items[0];l.a.typeGuard(H.body)?(D.AGg=H.body,"Success"!==D.AGg.status?this.Jg(!1):(this.Jg(!0),this.XDn())):(z.ULS.sendTraceTag(508944770,3047,10,`unexpected annotation: ${y.a.getTypeNameFor(H.body)}`),this.Jg(!1))};this.o3b=I.getInstance(0);this.Tm=F.Tm}static get summary(){return D.AGg}initialize(){super.initialize();a.a.Pl().then(()=>{f.a.getAugLoopRuntimeManager().activateAnnotation(Object.assign(new m.a,
{annotationType:l.a.getTypeName(),handler:this.TWb}))});-1===this.o3b.Sz?this.o3b.hmb(this.ULj):this.TLj()}Pd(){super.Pd()}W4d(){return Object.assign(new v.l,{parentPath:["Signal",w.b.getTypeName()],items:[Object.assign(new u.a,{body:new w.b({contextId:A.a.create().toString(),doNotStream:!0})})]})}Jg(F){super.Jg(F);z.ULS.sendTraceTag(508944769,3028,50,this.aR(this.Tm,F))}XDn(){if(-1!==this.qGg){var F=Date.now()-this.qGg;z.ULS.sendTraceTag(508925082,3047,50,"[Copilot Chat][Summarization] Latency for summary generation response (ms): {0}",
F)}}}D.TMn=200;Object(G.a)(D,"SummaryGenerationCondition",J.a,[])},1847:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f){this.alt=this.ariaLabel=this.src=null;this.src=f}}Object(G.a)(m,"ImageProps",null,[])},1849:function(G,J,d){d.d(J,"a",function(){return z});G=d(0);var m=d(54),f=d(8),a=d(11),l=d(7),w=d(15),y=d(1615),v=d(1598),u=d(1610),x=d(1609);class z{constructor(A,D,F,I,H,N,M){this.ykj=(U,O)=>{O&&O.data&&O.data.jn&&(U=new x.a(O.data.jn,1,!0),this.WPe.GS(U))};this.Inj=
(U,O)=>{O&&O.data&&O.data.jn&&O.data.jn.node&&this.otk.vgj(this.WPe,O.data.jn.node)};this.Xvc=(U,O,V)=>{U=O.view.te?O.view:null;if(!U||!U.lb)return 8;U=U.lb.gb.J(0).Ra;return f.ParagraphReader.Xb(U.node)?1===V?32:2===V?(V=new x.a(U,2,!1),this.WPe.GS(V),32):2:2};this.cgc=(U,O,V)=>{var Y,Q;U=O.view.te?O.view:null;if(!U||!U.lb)return 8;U=null===(Y=U.lb.gb.J(0))||void 0===Y?void 0:Y.Ra;return U&&U.node?f.ParagraphReader.Xb(U.node)?1===V?32:2===V?(V=U.node,Y=f.ParagraphReader.text(U.node),O=U.cpBegin,
U=U.cpEnd-O,0<U&&(Y=Y.substr(O,U)),U=Math.floor(Math.random()*z.YIj),O=m.a.create(),l.ULS.sendTraceTag(541446531,3016,50,"Create Pull Quote invoked from context menu. PullQuote info: {0}; Document info: {1}",{["suggestionId"]:O,["textLength"]:Y.length,["paragraphLength"]:f.ParagraphReader.textLength(V),["paragraphRole"]:null===(Q=this.J$.YB(V))||void 0===Q?void 0:Q.role,["styleId"]:U},this.fEk.s7d()),Q=[new y.c(new v.d(O,3,null,null,!1,U,Y),V,U,Y,S=>{this.h6b.Ajd(u.a.create(S));this.h6b.Xuc({role:27,
paragraphNode:S,placeholder:!1})},3)],this.XJk.XSd(Q),32):2:2:8};this.ga=A;this.WPe=D;this.otk=F;this.h6b=I;this.XJk=H;this.J$=N;this.fEk=M}initialize(){this.ga.fb(w.a.Xvc,a.a.view,this.Xvc,1028);this.h6b.H1k(this.Inj);this.h6b.C0k(this.ykj);this.ga.fb(w.a.cgc,a.a.view,this.cgc,4)}dispose(){this.ga.Zw(w.a.cgc,a.a.view,this.cgc);this.h6b.EAo(this.ykj);this.h6b.ZAo(this.Inj);this.ga.Zw(w.a.Xvc,a.a.view,this.Xvc)}}z.YIj=5;Object(G.a)(z,"DesignerActionListener",null,[854,13])},1850:function(G,J,d){d.d(J,
"a",function(){return m});G=d(0);class m{}m.zwc="Seen";m.bqc="Kept";m.bue="Rejected";Object(G.a)(m,"CritiqueAction",null,[])},1865:function(G,J,d){d.d(J,"b",function(){return f});d.d(J,"a",function(){return a});var m=d(39);class f{constructor(l){m.a.assign(f,this,l)}static getTypeName(){return"AugLoop_DocumentTextContentGenerator_PromptAssistanceSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.a.matchesTypesFor(l,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),
B_:f.getBaseTypes()};class a{constructor(l){m.a.assign(a,this,l)}static getTypeName(){return"AugLoop_DocumentTextContentGenerator_DocumentTextContentGeneratorStreamedSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.a.matchesTypesFor(l,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1866:function(G,J,d){d.d(J,"b",function(){return f});d.d(J,"a",function(){return a});d.d(J,"c",function(){return l});var m=d(39);class f{constructor(w){m.a.assign(f,
this,w)}get metadata(){return this.M_}set metadata(w){this.M_=w}static getTypeName(){return"AugLoop_DocumentTextContentGenerator_PromptAssistanceAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(w){return m.a.matchesTypesFor(w,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(w){m.a.assign(a,this,w)}get metadata(){return this.M_}set metadata(w){this.M_=w}static getTypeName(){return"AugLoop_DocumentTextContentGenerator_DocumentContentStreamChunk"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(w){return m.a.matchesTypesFor(w,
[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(w){m.a.assign(l,this,w)}get metadata(){return this.M_}set metadata(w){this.M_=w}static getTypeName(){return"AugLoop_DocumentTextContentGenerator_StreamCompleted"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(w){return m.a.matchesTypesFor(w,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},1867:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.kik=
"PageContentOrigin";this.Cfk=500;this.lTg=["resize"];this.wjp=f=>()=>{!this.ICd&&f&&(this.ICd=setTimeout(()=>this.f3h(),this.Cfk),f())}}addHandler(f){this.oZb();this.DRa=this.wjp(f);this.x4n(this.DRa);this.lTg.forEach(a=>{window.addEventListener(a,this.DRa)})}oZb(){var f;this.f3h();null===(f=this.CLh)||void 0===f?void 0:f.disconnect();this.lTg.forEach(a=>{window.removeEventListener(a,this.DRa)});this.DRa=void 0}f3h(){this.ICd&&(clearTimeout(this.ICd),this.ICd=void 0)}x4n(f){this.CLh=new MutationObserver(f);
(f=document.getElementsByClassName(this.kik)[0])&&this.CLh.observe(f,{attributes:!0,attributeFilter:["style"]})}}Object(G.a)(m,"EditorAiWindowEventManager",null,[])},1868:function(G,J,d){d.d(J,"a",function(){return a});G=d(0);var m=d(42),f=d(10);class a{constructor(l){var w,y;this.lo=l;this.lV=null;this.lV=null===(y=null===(w=this.lo)||void 0===w?void 0:w.zd)||void 0===y?void 0:y.container}addHandler(l){this.lV&&(this.oZb(),this.DRa=l,m.a.addHandler(this.lV,f.a.scroll,this.DRa),m.a.addHandler(this.lV,
f.a.resize,this.DRa))}oZb(){this.lV&&this.DRa&&(m.a.removeHandler(this.lV,f.a.scroll,this.DRa),m.a.removeHandler(this.lV,f.a.resize,this.DRa))}}Object(G.a)(a,"EditorAiPositionManager",null,[])},1872:function(G,J,d){G=d(0);var m=d(7),f=d(104),a=d(816),l=d(77),w=d(298);class y{constructor(mb,Ua,vb=null){this.id=mb.Id;vb||(vb="");this.yoo=vb;this.sensitivityLabel=mb}}Object(G.a)(y,"AutoPolicyLabelData",null,[]);class v{constructor(mb,Ua){this.vIa=mb;this.displayName=Ua}}Object(G.a)(v,"PolicyLabelRequestState",
null,[]);class u{constructor(){this.yxg=this.ocg=""}}Object(G.a)(u,"PolicyStrings",null,[]);var x=d(182),z=d(2),A=d(101),D=d(10),F=d(42),I=d(19);class H{static get t2f(){return H.pvn}}H.pvn="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(G.a)(H,"JustificationDialogHtml",null,[]);class N extends x.a{constructor(mb,Ua){super(!1,!1,N.bO);this.ojb=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];this.xKd=null;this.wKd=!1;this.ovn=(vb,Ia)=>{let Ma="";if(1===vb)for(let qb=0;qb<this.ojb.length;qb++)if(Ia[N.Cpg+qb]){Ma=qb===this.ojb.length-1?Ia[N.Hrd]:this.ojb[qb];break}this.tw(vb,this.gMd,Ma)};this.Jyj=vb=>{let Ia="";1===
vb&&this.xKd&&(Ia=this.xKd);this.tw(vb,this.gMd,Ia)};this.qZn=vb=>{this.xKd=vb;vb=this.validate();this.wKd!==vb&&(this.wKd=vb,this.t9(CommonUIStrings.l_SensitivityJustificationTitle,this.Jyj,this.KFi(this.wKd)))};this.vip=vb=>{vb.target&&this.Bva(1,this.validate())};this.dte=vb=>{if(vb=vb.target){vb.checked=!0;var Ia=$get(N.Hrd);vb.id===N.Cpg+(this.ojb.length-1)?(Ia.disabled=!1,Sys.UI.DomElement.setVisible(Ia,!0),Ia.focus()):(Ia.disabled=!0,vb.focus());this.Bva(1,this.validate())}};this.gMd=mb;this.tw=
Ua;this.kh=this.Hfl();this.Gd=1;this.Qg=N.id;this.Pe(1,CommonUIStrings.l_DialogChange);this.Bva(1,!1);this.uY(0)}JDg(){if(N.bO)this.pi(CommonUIStrings.l_SensitivityJustificationTitle,this.Jyj,this.KFi(this.wKd));else{const mb={};for(let Ua=0;Ua<this.ojb.length;Ua++)mb[N.Cpg+Ua]=!1;mb[N.Hrd]="";this.pi(CommonUIStrings.l_SensitivityJustificationTitle,this.ovn,mb);this.mrg();F.a.addHandler($get(N.Hrd),D.a.input,this.vip)}}validate(){if(N.bO)return this.kak(this.xKd);const mb=$get(N.Hrd);return mb.disabled?
!0:this.kak(mb.value)}kak(mb){const Ua=2>mb.length,vb=500<mb.length,Ia=RegExp("[{|}|;|\\\\]").test(mb);mb=""===I.a.XDa(mb);return!Ua&&!vb&&!Ia&&!mb}KFi(mb){return{["id"]:this.Qg,["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:CommonUIStrings.l_SensitivityJustificationPlaceholder}},["actionButtonProps"]:{["label"]:CommonUIStrings.l_DialogChange,["disabled"]:!mb},["infoMessage"]:CommonUIStrings.l_SensitivityJustificationMessage,["justificationIrrelevantLabel"]:CommonUIStrings.l_SensitivityJustificationNoLongerApplies,
["justificationIncorrectLabel"]:CommonUIStrings.l_SensitivityJustificationIncorrect,["justificationOtherLabel"]:CommonUIStrings.l_SensitivityJustificationOther,["onJustificationUpdated"]:this.qZn}}Hfl(){return x.a.az(N.t2f,z.AFrameworkApplication.Ys,A.getImageClass(N.iconName),CommonUIStrings.l_SensitivityJustificationMessage,this.ojb[0],this.ojb[1],this.ojb[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)}mrg(){const mb=document.getElementsByName(N.Dzn);for(let Ua=0;Ua<mb.length;Ua++)F.a.addHandler(mb[Ua],
D.a.focus,this.dte),F.a.addHandler(mb[Ua],D.a.click,this.dte)}static get bO(){return z.AFrameworkApplication.ua.Ib.cH&&z.AFrameworkApplication.ua.Ib.q0f}}N.t2f=H.t2f;N.Dzn="ListRadioBox";N.Cpg="radiobox";N.Hrd="txtJustification";N.iconName="Info_32x32x32";N.id="JustificationDialog";Object(G.a)(N,"JustificationDialog",x.a,[]);class M extends x.a{constructor(mb,Ua,vb){super(!1,!1,!0);this.ZHn=(Ma,qb)=>{1===Ma&&qb.selectedLabel&&(Ma=qb.selectedLabel,""!==Ma&&this.stk(Ma))};if(mb&&vb){var Ia={["id"]:"MandatoryLabellingDialog"};
this.stk=vb;this.U_e=Ua;if(!z.AFrameworkApplication.K.$("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||this.U_e&&""!==this.U_e)Ia.learnMoreLink={["type"]:"AppLinkProps",["id"]:"mandatoryLabellingLearnMoreLink",["text"]:CommonUIStrings.l_LearnMore,["handler"]:{["href"]:this.U_e,["target"]:"_blank"},["customTooltip"]:CommonUIStrings.L_LearnMoreTooltip};Ua={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(Ua.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",["controls"]:mb});Ia.labelFlyout=
{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!0,["menuDefinition"]:Ua};mb={["id"]:"MandatoryLabellingDialog",["bodyControls"]:Ia};Ia.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;Ia.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;this.pi(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,this.ZHn,mb)}else m.ULS.sendTraceTag(560547850,306,10,
"MandatoryLabelingDialog was triggered with invalid inputs")}}Object(G.a)(M,"MandatoryLabellingDialog",x.a,[]);class U{constructor(){this.WRa=!!z.AFrameworkApplication.ua&&z.AFrameworkApplication.ua.Ib.cH}qHl(mb,Ua,vb){this.WRa&&new M(mb,Ua,vb)}static get instance(){return U._instance||(U._instance=new U)}}U._instance=null;Object(G.a)(U,"MandatoryLabellingDialogFactory",null,[1078]);class O{}O.Ncp="sbProtectForm14";O.Qcp="SBStatusBarMarkAsReadOnly14";O.hyn="Info_16x16x32";O.oVc="QuickSearchCompletedToday_16x16x32";
O.eqg="CommonControlCheckboxCheck_16";O.m1j="On";O.visible="Visible";O.cbm="ImageIsVisible";O.HOa="SourceControlId";O.menuItemId="MenuItemId";O.Ig="Menu";O.kSh="AppLockId";O.value="Value";O.labelText="LabelText";O.alt="Alt";O.rQi="Image16by16";O.Cmc="Image16by16Class";O.Mcp="SBProtectForm_16";O.Pcp="SBStatusBarMarkAsReadOnly_16";O.icon="Icon";O.iconColor="IconColor";O.customTooltip="CustomTooltip";O.Kno="MipTagDynamicFillWithOutline_20";O.Lno="MipTagLockDynamicFillWithOutline_20";O.Jno="MipTagErrorOutline_20";
O.Mno="MipTagQuestionOutline_20";O.ODe="transparent";O.Sqp="UILocation";Object(G.a)(O,"PolicyConstants",null,[]);class V extends x.a{constructor(mb,Ua,vb){super(!1,!1,V.bO);this.dCp=Ia=>{1!==Ia&&this.tw(Ia,this.gMd,"",this.Vda)};this.gMd=mb;this.Vda=Ua;this.tw=vb;this.Gd=1;this.Qg=V.id;this.uY(1);this.uY(0)}iEg(){const mb={["id"]:"UserDefinedPermissionsDialog"};V.bO&&this.pi("Defined Permissions",this.dCp,mb)}static get bO(){return z.AFrameworkApplication.ua.Ib.cH&&z.AFrameworkApplication.ua.Ib.q0f}}
V.id="UserDefinedPermissionsDialog";Object(G.a)(V,"UserDefinedPermissionsDialog",x.a,[]);var Y=d(823),Q=d(218),S=d(240),P=d(818),T=d(92),Z=d(47),X=d(439),aa=d(366),ia=d(142),wa=d(511),ma=d(188),na=d(33),Fa=d(139),Qa=d(21),ya=d(75),ta=d(12),Aa=d(35),oa=d(143);class za{constructor(mb,Ua,vb,Ia){this.oKc=this.ZEb=null;this.zph=this.AYe=this.tZe=this.TJc=this.Erh=this.ruh=this.LPe=!1;this.I5b=this.g2a=this.A4a=this.Pgb=this.Vda=this.tB=this.FSa=this.tl=null;this.isk=this.BLe=0;this.Vhh=this.Wqh=this.u$g=
this.N4e=null;this.Rro=()=>{this.AYe&&!this.cee()&&(this.AYe=!1,this.Xh.value.Qro())};this.YHn=Ma=>{this.XBf(this.tuh[Ma])};this.dng=()=>{if(!this.Xh.value.o2i()){var Ma=this.tB[this.tl.AppliedPolicyId];this.TJc&&this.Pgb&&this.I5b!==this.Pgb.id&&(!Ma||Ma.Order<this.Pgb.sensitivityLabel.Order)&&(Ma=this.wyb(this.Pgb.id,{},4),32!==Ma?m.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+Ma):(this.I5b=this.Pgb.id,this.g2a&&(Ma=this.tB[this.g2a])&&
Ma.Order<=this.Pgb.sensitivityLabel.Order&&(this.Xh.value.VZa(29),this.g2a=null)));Ma=this.tB[this.Xh.value.Iz.AppliedPolicyId];if(this.A4a&&this.g2a!==this.A4a.id&&(!Ma||Ma.Order<this.A4a.sensitivityLabel.Order)){const qb=this.A4a.id;this.Xh.value.VZa(29);this.Xh.value.XQd(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.D8d(this.A4a.sensitivityLabel))+" "+this.A4a.yoo,CommonUIStrings.l_PolicyLabelRecommendationButton,()=>{this.wyb(qb,
{},8)});this.g2a=this.A4a.id}this.A4a=this.Pgb=null}};this.DAl=(Ma,qb,Xb,Cc)=>{1===Ma&&this.syb(qb,Cc,Xb)};this.CAl=(Ma,qb,Xb)=>{1===Ma?this.LTb()?this.wyb(qb,null,2,Xb):this.syb(qb===this.tl.AppliedPolicyId?"":qb,Xb,""):this.yj.Ie()};this.Wcl=Ma=>{1===Ma&&this.Xh.value.Vmo()};this.s0d=()=>32;this.b4n=(Ma,qb)=>{qb.BE&&this.tB&&(Ma=this.tB[this.Xh.value.Iz.AppliedPolicyId])&&(this.g2a&&(qb=this.tB[this.g2a])&&qb.Order<=Ma.Order&&(this.Xh.value.VZa(29),this.g2a=null),this.I5b&&this.I5b!==Ma.Id&&(this.Xh.value.VZa(28),
this.I5b=null))};this.ga=mb;this.yj=Ua;this.Ga=vb;this.Xh=Ia;this.ALc={};this.Yzh={};this.tuh={};this.Nsb=vb.$("WacApplyManualPolicyLabelIsEnabled");this.Xh.value.URd(this.dng);this.Xh.value.Sgf(this.dng);this.Xh.value.qgf(this.b4n);z.AFrameworkApplication.ua&&z.AFrameworkApplication.ua.Z5a(this.Rro);vb.$("SupportsPolicies")&&vb.kb("AppliedPolicyId")&&(this.ZEb=vb.kb("IrmPolicyTitle"),this.oKc=vb.kb("IrmPolicyDescription"));this.Pok=this.Ga.ic("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.Qok=
this.Ga.ic("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}get BI(){return z.AFrameworkApplication.BI||!!this.Wqh&&this.Wqh()}Wb(){this.ga.ra(ta.a.iig,ya.a.frame,this.s0d);this.ga.fb(ta.a.Kuc,ya.a.frame,Object(f.a)(this,this.Kuc,"queryPolicyLabel"),96);this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.ga.ra(ta.a.Epj,ya.a.frame,this.s0d),this.ga.fb(ta.a.gjd,ya.a.frame,Object(f.a)(this,this.gjd,"queryPolicyShortLabel"),96));this.ga.ra(ta.a.O1b,
ya.a.frame,Object(f.a)(this,this.O1b,"toggleSensitivity"));this.ga.ra(ta.a.NXb,ya.a.frame,Object(f.a)(this,this.NXb,"populateSensitivityFlyout"));this.ga.ra(ta.a.Z_b,ya.a.frame,Object(f.a)(this,this.Z_b,"setSensitivity"));this.ga.fb(ta.a.ijd,ya.a.frame,Object(f.a)(this,this.ijd,"querySensitivity"),96);this.ga.ra(ta.a.zYb,ya.a.frame,Object(f.a)(this,this.zYb,"querySensitivityToggleButton"));this.ga.ra(ta.a.yYb,ya.a.frame,Object(f.a)(this,this.yYb,"querySensitivitySubFlyout"));this.cSc(ta.a.O1b)||this.ga.Rc(ta.a.O1b,
4);this.cSc(ta.a.NXb)||this.ga.Rc(ta.a.NXb,4);this.cSc(ta.a.Z_b)||this.ga.Rc(ta.a.Z_b,4);this.cSc(ta.a.zYb)||this.ga.Rc(ta.a.zYb,4);this.cSc(ta.a.yYb)||this.ga.Rc(ta.a.yYb,4);this.yj.Ie();z.AFrameworkApplication.K&&ia.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.Xh.value.tAo(Object(f.a)(this,this.sAj,"registerActionsHandler"))}sAj(){this.Wb()}Bfb(){this.ga.Zw(ta.a.iig,ya.a.frame,this.s0d);this.ga.Zw(ta.a.Kuc,ya.a.frame,
Object(f.a)(this,this.Kuc,"queryPolicyLabel"));this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.ga.Zw(ta.a.Epj,ya.a.frame,this.s0d),this.ga.Zw(ta.a.gjd,ya.a.frame,Object(f.a)(this,this.gjd,"queryPolicyShortLabel")));this.ga.Zw(ta.a.O1b,ya.a.frame,Object(f.a)(this,this.O1b,"toggleSensitivity"));this.ga.Zw(ta.a.NXb,ya.a.frame,Object(f.a)(this,this.NXb,"populateSensitivityFlyout"));this.ga.Zw(ta.a.Z_b,ya.a.frame,Object(f.a)(this,this.Z_b,"setSensitivity"));
this.ga.Zw(ta.a.ijd,ya.a.frame,Object(f.a)(this,this.ijd,"querySensitivity"));this.ga.Zw(ta.a.zYb,ya.a.frame,Object(f.a)(this,this.zYb,"querySensitivityToggleButton"));this.ga.Zw(ta.a.yYb,ya.a.frame,Object(f.a)(this,this.yYb,"querySensitivitySubFlyout"))}O1b(){return 32}Tti(mb){const Ua="mandatoryLabelling_"+mb.Id;this.tuh[Ua]=mb.Id;return{["type"]:"AppToggleButtonProps",["id"]:Ua,["label"]:mb.DisplayName,["hideLabel"]:!1,["customTooltip"]:mb.Tooltip}}LTb(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",
!1)}i_f(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)}pzm(){const mb=[],Ua=this.FSa;for(const Ia in Ua){var vb=Ua[Ia];const Ma=this.tB[Ia];if(Ma&&Ma.Enabled&&!Ma.HasUserDefinedPermissions)if(vb.count){const qb={["sections"]:[],["shouldAutoOpen"]:!1},Xb={["id"]:"mandatoryLabelling_flyoutMenuSection_"+Ma.Id,["controls"]:[]};for(const Cc of vb)(vb=this.tB[Cc])&&vb.Enabled&&!vb.HasUserDefinedPermissions&&Array.add(Xb.controls,this.Tti(vb));Array.add(qb.sections,
Xb);Array.add(mb,{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabelling_"+Ma.Id,["label"]:Ma.DisplayName,["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:qb})}else Array.add(mb,this.Tti(Ma))}return mb}NXb(mb,Ua,vb,Ia,Ma){if(1===vb||!this.Xh.value.wdc(!0))return 32;Ma.MenuItems=Object.assign(new X.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(Ma.MenuItems.MenuSectionList,this.hAa(!this.isReactRibbonEnabled()));this.tl.CustomUrl&&Array.add(Ma.MenuItems.MenuSectionList,
this.VGl(this.isReactRibbonEnabled()?this.tl.CustomUrl:I.a.Hf(this.tl.CustomUrl)));this.isReactRibbonEnabled()||(Ma.PopulationXML=S.o(Ma.MenuItems));return 32}ijd(mb,Ua,vb,Ia,Ma){if(1===vb||!Ma||!this.Nsb)return 32;this.tl=this.Xh.value.Iz;if(this.Xh.value.wdc(!0)&&(Ma[O.visible]=!0,this.Erh||(Z.a("MipLabelsAvailable"),this.Erh=!0),this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&!this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.CEBlockPopupEnabled",
!1)&&this.tl&&this.tl.AreLabelsAvailable&&(mb=Qa.a.instance.Qa("Common.ISystemInitiatedFeedback")))){const qb=za.Tf(this.tl.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";mb.execute(Xb=>{Xb.logActivity(qb,null)})}return 32}zYb(mb,Ua,vb,Ia,Ma){if(1===vb||!Ma)return 32;let qb,Xb;Ma[O.m1j]=!!(qb=Ma[O.menuItemId])&&!!(Xb=this.ALc[qb])&&Xb===this.tl.AppliedPolicyId;return 32}yYb(mb,Ua,vb,Ia,Ma){if(1===vb||!Ma)return 32;let qb,Xb,Cc;mb=!!(qb=Ma[O.HOa])&&
!!(Xb=this.ALc[qb])&&!!(Cc=this.FSa[Xb])&&Cc.contains(this.tl.AppliedPolicyId);Ma[O.cbm]=mb;Ma[O.m1j]=mb;return 32}Z_b(mb,Ua,vb,Ia,Ma){if(1===vb||!Ma)return 32;mb=this.ALc[Ma[O.HOa]];Ua=this.Tqp(Ma[O.Sqp]);vb=new Aa.a;vb.name="SensitivityPickerLocation";vb.int64=Ua;Z.a("SensitivityPickerUsage",void 0,void 0,[vb]);return this.wyb(mb,Ma,2)}cee(){return!!z.AFrameworkApplication.ua&&1===z.AFrameworkApplication.ua.mode}rnp(){this.tl.DefaultLabelId&&this.tl.MandatoryLabelingEnforced?this.LPe||this.cee()?
this.tl.AppliedPolicyId?this.XBf(""):(this.Xh.value.Rpn(this.Xh.value.kbd)||this.cee())&&this.xki():this.yNj():this.tl.DefaultLabelId?this.yNj():this.tl.MandatoryLabelingEnforced&&(this.tl.AppliedPolicyId?this.XBf(""):this.xki())}z_i(){return this.tl.MandatoryLabelingEnforced?this.tl&&this.tl.AreLabelsAvailable?this.Ga.$("TestOverrideIsReactDialogEnabled")||this.yj&&this.yj.Ib&&this.yj.Ib.cH?!0:(m.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):
(m.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(m.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}xki(){!this.z_i()||z.AFrameworkApplication.Lta||this.ruh||(this.ruh=z.AFrameworkApplication.Lta=!0,m.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),this.Xh.value.Xxj("",1),this.Xh.value.gff(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,
CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,()=>{this.XHn()}))}XBf(mb){this.z_i()&&z.AFrameworkApplication.Lta&&(z.AFrameworkApplication.Lta=!1,m.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.Xh.value.usg(),this.Xh.value.Xxj(mb,2))}XHn(){U.instance.qHl(this.pzm(),this.tl.CustomUrl,this.YHn)}WVh(){return this.Ga.$("CoAuthForProtectedFilesEnabled")&&this.Ga.$("SupportsOfficeClientCoauthoring")&&
this.Ga.$("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.Vhh&&this.BI}wyb(mb,Ua,vb,Ia=null){this.Xh.value.Omo(vb);let Ma=32,qb=!1,Xb=!0;const Cc=2===vb||8===vb||16===vb,Ec=mb===this.tl.AppliedPolicyId;if(this.u$g&&this.u$g(mb,Cc))m.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",vb),this.yj.Ie();else if(Ua&&O.kSh in Ua&&this.Xh.value.tVo(Ua[O.kSh]),mb)if(this.Xh.value.o2i()||this.WVh()&&this.tZe)m.ULS.sendTraceTag(42796168,
306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",vb),this.yj.Ie(),Cc&&this.pSd(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.Ga.$("HasDocumentEditRights"))if(this.Xh.value.xll(mb))if(!this.LTb()&&this.tB[mb]&&this.tB[mb].HasUserDefinedPermissions&&!Ec)m.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",
vb),1!==vb&&4!==vb&&this.h4k();else if(Cc&&this.tl.MandatoryLabelingEnforced&&Ec)m.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",vb),this.pSd(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);else{if(Cc&&this.Ga.$("WacLabelingJustificationDialogIsEnabled")&&this.tl.RequiredDowngradeJustification&&(Ec||this.tB[mb].RequiredDowngradeJustification)&&
(this.LTb()?!this.zph&&!Ia:!this.Vda))return m.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",vb),this.JDg(mb),Ma;if(this.LTb()&&this.tB[mb].HasUserDefinedPermissions&&!Ec)return m.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",vb),this.iEg(mb,Ia),Ma;if(this.WVh()&&!this.Vhh())this.BLe<this.Pok?(m.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.BLe,
vb),this.tZe=!0,this.BLe++,oa.Task.delay(this.Qok).continueWith(()=>{this.tZe=!1;this.wyb(mb,Ua,vb)})):(m.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",vb),qb=1!==vb,Xb=!1,Ma=8);else{if(this.fon(mb)&&(m.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",vb),1===vb||8===vb||4===vb))return Ma;m.ULS.sendTraceTag(570972056,
306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",vb);this.syb(Ec?"":mb,this.LTb()?Ia:this.Vda,"",vb);return Ma}}else m.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",vb),this.yj.Ie(),Cc&&this.pSd(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else m.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",
vb),this.yj.Ie(),Cc&&this.pSd(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);else m.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",vb),this.yj.Ie(),qb=Cc,Xb=!1,Ma=8;this.Xh.value.kyj(0,vb,qb,Xb);return Ma}l7k(mb,Ua,vb=null,Ia=!1){T.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",0,"wordclpfc",null);this.Ga.$("SupportsOfficeClientCoauthoring")&&
this.Ga.$("CoAuthForProtectedFilesIsEnabled")?(this.TJc=!1,(this.tl=this.Xh.value.Iz)&&!this.tl.AppliedPolicyId?this.TJc=!0:this.tl&&this.tl.PolicyLabelAssignmentMethod&&(this.TJc=Fa.e(this.tl.PolicyLabelAssignmentMethod)===Fa.e("standard"))):this.TJc=Ia;mb=za.Tf(mb)?null:this.tB[mb];(Ua=za.Tf(Ua)?null:this.tB[Ua])?this.A4a=new y(Ua,!0,vb):(this.Xh.value.VZa(29),this.g2a=null);mb?this.Pgb=new y(mb,!1):this.I5b=null;this.dng(null,null)}g8k(mb){this.wyb(mb,null,16)}eUo(){this.tB={};if(this.tl=this.Xh.value.Iz)for(const mb of this.tl.SensitivityLabels)this.tB[mb.Id]=
mb}fon(mb){if(this.FSa&&mb in this.FSa){mb=this.FSa[mb];for(const Ua of mb)if((mb=this.tB[Ua])&&mb.Enabled)return!0}return!1}AWo(){this.FSa={};if(this.tl=this.Xh.value.Iz){for(const mb of this.tl.SensitivityLabels)mb.ParentId||(this.FSa[mb.Id]=new l.a);for(const mb of this.tl.SensitivityLabels)mb.ParentId&&mb.ParentId in this.FSa&&mb.Enabled&&this.FSa[mb.ParentId].add(mb.Id)}}mko(){this.tl=this.Xh.value.Iz;const mb=this.Nsb&&this.isReactRibbonEnabled()&&this.Xh.value.wdc();za.ave(mb)}yNj(){if(this.Ga.$("WacApplyDefaultPolicyLabelIsEnabled"))if(this.cee())this.AYe=
!0;else if(!this.LPe&&(this.LPe=!0,(this.tl=this.Xh.value.Iz)&&this.tl.DefaultLabelId))if(!this.tl.AppliedPolicyId)m.ULS.sendTraceTag(509732190,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.tl.DefaultLabelType),this.wyb(this.tl.DefaultLabelId,null,1);else if(w.a.th().equals(this.tl.DefaultLabelType,"documentLibraryDefault")){const mb=this.tB[this.tl.AppliedPolicyId],Ua=this.tB[this.tl.DefaultLabelId];this.tl.AppliedPolicyId!==this.tl.DefaultLabelId&&w.a.th().equals(this.tl.PolicyLabelAssignmentMethod,
"standard")&&mb.Order<Ua.Order&&(m.ULS.sendTraceTag(509732189,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.tl.DefaultLabelType),this.wyb(this.tl.DefaultLabelId,null,1))}}syb(mb,Ua,vb,Ia=2){this.LTb()?Ua&&(this.zph=!0):this.Vda=Ua;this.Xh.value.syb(mb);this.yj.Ie();vb=new v(Ia,this.D8d(this.tB[mb]));this.Xh.value.zAg(mb,this.LTb()?Ua:this.Vda,vb)}JDg(mb){(new N(mb,this.CAl)).JDg()}iEg(mb,Ua){(new V(mb,Ua,this.DAl)).iEg()}pSd(mb="",Ua=""){const vb=new ma.StandardDialog;vb.Du=z.AFrameworkApplication.gga;
vb.Gd=0;vb.Pe(1,CommonUIStrings.l_DialogClose);vb.yY(mb,Ua,null)}h4k(){const mb=new ma.StandardDialog;mb.Du=z.AFrameworkApplication.gga;mb.Gd=1;mb.Pe(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);mb.Pe(0,CommonUIStrings.l_DialogClose);mb.yY(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,this.Wcl)}isReactRibbonEnabled(){return!!this.yj&&!!this.yj.Ib&&this.yj.Ib.Hs}apc(){return this.yj&&this.yj.Ib?this.yj.Ib.apc:!1}dXo(mb,Ua,vb,
Ia){mb?(Ia[O.value]=mb,Ia[O.labelText]=mb,Ia[O.customTooltip]=Ua,this.vOj(vb,z.AFrameworkApplication.lH,Ia)):(Ia[O.iconColor]=O.ODe,this.tl.MandatoryLabelingEnforced?(Ia[O.value]=Ia[O.labelText]=this.R8d().yxg,Ia[O.icon]=O.Jno):(Ia[O.value]=Ia[O.labelText]=this.R8d().ocg,Ia[O.icon]=O.Mno));Ia[O.visible]=!0}HUo(mb){let Ua="",vb="",Ia="";if(this.tl.AreLabelsAvailable){let Ma=null;this.tB&&(Ma=this.tB[this.tl.AppliedPolicyId]);Ma&&(Ua=this.D8d(Ma),vb=Ma.Tooltip,z.AFrameworkApplication.lH=this.Xh.value.Yoc(Ma),
Ia=this.fIf(Ma));if(!this.Xh.value.wdc()&&!Ma)return}else{if(!this.ZEb)return;Ua=this.ZEb;Ia=O.ODe;vb=this.oKc?this.oKc:""}this.dXo(Ua,vb,Ia,mb)}Kuc(mb,Ua,vb,Ia,Ma){if(1===vb)return 32;this.tl=this.Xh.value.Iz;if(!this.tl||!Ma)return 32;Ma[O.value]="";Ma[O.labelText]="";Ma[O.alt]=null;Ma[O.rQi]=null;Ma[O.Cmc]=null;Ma[O.customTooltip]="";Ma[O.visible]=!1;Ma[O.iconColor]="";Ma[O.icon]="";if(this.i_f())this.HUo(Ma);else{vb=Ua=mb="";if(!this.tl.AreLabelsAvailable){if(!this.ZEb)return 32;mb=this.ZEb;vb=
O.ODe;this.oKc&&(Ua=this.oKc)}else if(this.tl.AppliedPolicyId){Ia=null;for(const qb of this.tl.SensitivityLabels)if(qb.Id.toLowerCase()===this.tl.AppliedPolicyId.toLowerCase()){Ia=qb;break}Ia&&(mb=this.D8d(Ia),Ua=Ia.Tooltip,z.AFrameworkApplication.lH=this.Xh.value.Yoc(Ia),vb=this.fIf(Ia))}mb&&(Ma[O.value]=mb,Ma[O.labelText]=mb,this.apc()?Ma[O.customTooltip]=Ua:Ma[O.alt]=Ua,this.vOj(vb,z.AFrameworkApplication.lH,Ma),Ma[O.visible]=!0)}return 32}gjd(mb,Ua,vb,Ia,Ma){if(1===vb)return 32;this.tl=this.Xh.value.Iz;
if(!this.tl||!Ma)return 32;Ma[O.labelText]="";if(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpUseHideBarByDefaultSetting",!1)&&this.tl.HideBarByDefault)return 32;mb="";if(this.tl.AreLabelsAvailable)if(this.tl.AppliedPolicyId){if(!this.tB)return 32;(Ua=this.tB[this.Xh.value.Iz.AppliedPolicyId])&&(mb=Ua.ParentId&&this.tB[Ua.ParentId]?this.tB[Ua.ParentId].DisplayName:Ua.DisplayName)}else mb=this.tl.MandatoryLabelingEnforced?this.R8d().yxg:this.R8d().ocg;else{if(!this.ZEb)return 32;
mb=this.ZEb}Ma[O.labelText]=mb;return 32}D8d(mb){return mb?this.tB?mb.ParentId&&this.tB[mb.ParentId]?this.tB[mb.ParentId].DisplayName+"\\"+mb.DisplayName:mb.DisplayName:(m.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),mb.DisplayName):""}vOj(mb,Ua,vb){this.i_f()?(vb[O.icon]=this.MIi(Ua),vb[O.iconColor]=this.NIi(mb)):this.apc()?vb[O.icon]=Ua?O.Mcp:O.Pcp:(vb[O.rQi]=z.AFrameworkApplication.Ys,vb[O.Cmc]=Ua?A.getImageClass(O.Ncp):A.getImageClass(O.Qcp))}VGl(mb){const Ua=
this.BMb("LearnMoreSection",!0);mb=Object.assign(new Q.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:mb,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:z.AFrameworkApplication.Ys,Image16by16Class:A.getImageClass(O.hyn),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"});Array.add(Ua.ControlList,mb);return Ua}Hbi(mb,Ua,vb=!1){let Ia;Ia="Toggle_"+mb.Id;Ia="Sensitivity_"+Ia;const Ma=mb.DisplayName,qb=mb.Tooltip;var Xb=mb.Id===this.tl.AppliedPolicyId,
Cc=vb?I.a.Hf(Ia):Ia;this.i_f()?(Xb=this.fIf(mb),Ua=Object.assign(new wa.a,{Id:Cc,ExternalId:Cc,LabelText:vb?I.a.Hf(Ma):Ma,Command:"2935633379",MenuItemId:Cc,QueryCommand:"991261903",Visible:!0,Alt:vb?I.a.Hf(qb):qb,AriaLabel:na.a.GTc,IconColor:this.NIi(Xb),KeyTip:Ua}),Ua.ExternalImageId=this.MIi(this.Xh.value.Yoc(mb))):(Cc=Object.assign(new Y.a,{Id:Cc,ExternalId:Cc,LabelText:vb?I.a.Hf(Ma):Ma,Command:"2935633379",MenuItemId:Cc,QueryCommand:"991261903",CheckedImage:z.AFrameworkApplication.Ys,Visible:!0,
Alt:vb?I.a.Hf(qb):qb,IsChecked:Xb,AriaLabel:na.a.GTc,KeyTip:Ua}),this.isReactRibbonEnabled()?(Cc.CheckedImageClass=A.getImageClass(O.eqg),Cc.ExternalImageId=O.eqg):Cc.CheckedImageClass=A.getImageClass(O.oVc),Ua=Cc);Cc=Ia;this.ALc[Cc]=mb.Id;this.Yzh[mb.Id]=Cc;return Ua}BMb(mb,Ua=!1){return Object.assign(new aa.a,{Title:"",Id:mb,DisplayMode:O.Ig,ShowMenuSectionSeparator:Ua,ControlsId:"Ctrl_"+mb,ControlList:[]})}oKl(mb,Ua,vb){mb=this.BMb(mb+"Sub");let Ia=1;for(const Ma of Ua)(Ua=this.tB[Ma])&&Ua.Enabled&&
(Array.add(mb.ControlList,this.Hbi(Ua,Ia.toString(),vb)),Ia++);return mb}hAa(mb=!1){const Ua=this.BMb("SensitivitySection");let vb=1;const Ia=this.FSa;for(const qb in Ia){const Xb=Ia[qb],Cc=this.tB[qb];if(Cc&&Cc.Enabled){if(Xb.count){var Ma="Sensitivity_"+Cc.Name;mb&&I.a.Hf(Ma);Ma="Label"+this.isk++;const Ec=Object.assign(new P.a,{Id:Ma,ExternalId:Ma,LabelText:mb?I.a.Hf(Cc.DisplayName):Cc.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new X.a,{Title:"",MenuSectionList:[],
UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:na.a.GTc,KeyTip:vb.toString(),Alt:mb?I.a.Hf(Cc.Tooltip):Cc.Tooltip});this.isReactRibbonEnabled()?Ec.ExternalImageId=O.eqg:(Ec.Image16by16=z.AFrameworkApplication.Ys,Ec.Image16by16Class=A.getImageClass(O.oVc));Array.add(Ec.Menu.MenuSectionList,this.oKl(Ma,Xb,mb));Array.add(Ua.ControlList,Ec);this.ALc[Ec.Id]=Cc.Id;this.Yzh[Cc.Id]=Ec.Id}else Array.add(Ua.ControlList,this.Hbi(Cc,vb.toString(),mb));vb++}}return Ua}cSc(mb){return!!this.ga.d3(mb)&&
!!this.ga.d3(mb).flags&&!!this.ga.d3(mb).flags.length}MIi(mb){return mb?O.Lno:O.Kno}NIi(mb){return mb?mb:O.ODe}fIf(mb){if(mb.Color||!mb.ParentId)return mb.Color;const Ua=this.tB[mb.ParentId];return Ua?Ua.Color:mb.Color}Tqp(mb){switch(mb){case 2:case 14:case 15:return 1;case 21:return 2;default:return 0}}R8d(){this.N4e||(this.N4e=Object.assign(new u,{ocg:HeaderStrings.NoSensitivityLabel,yxg:HeaderStrings.SelectASensitivityLabel}));return this.N4e}static zzp(){z.AFrameworkApplication.K&&!z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",
!1)||!ia.c()||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("OpenDocumentLabelPane",!0))}static ave(mb){ia.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!mb))}static Tf(mb){return mb&&mb.length?!1:!0}}Object(G.a)(za,"PolicyActor",null,[1069]);var ja=d(636),fa=d(89),Ca=d(2024);class xa extends Sys.EventArgs{constructor(mb,Ua,vb,Ia,Ma,qb){super();this.kec=mb;this.title=Ua;this.message=vb;this.buttonText=Ia;this.zUc=Ma;this.Tfe=qb}}Object(G.a)(xa,
"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class ua extends Sys.EventArgs{constructor(mb,Ua,vb,Ia,Ma){super();this.kec=mb;this.title=Ua;this.message=vb;this.buttonText=Ia;this.zUc=Ma}}Object(G.a)(ua,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var sa=d(2023);class Ea extends Sys.EventArgs{constructor(mb,Ua,vb){super();this.j4h=mb;this.i4h=Ua;this.existingLabelPriority=vb}}Object(G.a)(Ea,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);class Ja extends Sys.EventArgs{constructor(mb){super();
this.QFm=mb}}Object(G.a)(Ja,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class nb extends Sys.EventArgs{constructor(){super()}}Object(G.a)(nb,"GetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class ub{constructor(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=null;this.MandatoryLabelingEnforced=this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.CustomUrl=this.DefaultLabelType=this.DefaultLabelId=null;this.AreLabelsAvailable=
this.HideBarByDefault=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.DefaultLabelType=this.DefaultLabelId="";this.SensitivityLabels=[];this.MandatoryLabelingEnforced=!1;this.CustomUrl="";this.HideBarByDefault=!1}}Object(G.a)(ub,"GetPolicyLabelsData",null,[]);class Yb extends Sys.EventArgs{constructor(mb=!1){super();this.BE=mb}}Object(G.a)(Yb,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);class yb extends Sys.EventArgs{constructor(mb,
Ua){super();this.tcj=mb;this.appMode=Ua}}Object(G.a)(yb,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class Za extends Sys.EventArgs{constructor(mb,Ua,vb,Ia){super();this.title=mb;this.Bbo=Ua;this.buttonText=vb;this.gVn=Ia}}Object(G.a)(Za,"PolicyTipEventArgs",Sys.EventArgs,[]);class Ya extends Sys.EventArgs{constructor(mb,Ua){super();this.kec=mb;this.Tfe=Ua}}Object(G.a)(Ya,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Pa extends Sys.EventArgs{constructor(){super()}}
Object(G.a)(Pa,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);class rb extends Sys.EventArgs{constructor(mb,Ua){super();this.klg=mb;this.vIa=Ua}}Object(G.a)(rb,"SetPolicyLabelEventArgs",Sys.EventArgs,[]);class tb extends Sys.EventArgs{constructor(mb,Ua,vb,Ia=null,Ma=null,qb=null,Xb=null){super();this.errorType=mb;this.Yif=Ua;this.d7o=vb;this.title=Ia;this.message=Ma;this.buttonText=qb;this.zUc=Xb}}Object(G.a)(tb,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class ob extends Sys.EventArgs{constructor(mb){super();
this.Yif=mb}}Object(G.a)(ob,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);class Oa extends Sys.EventArgs{constructor(mb){super();this.Q2o=mb}}Object(G.a)(Oa,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,[]);var Xa=d(96),ab=d(119),cb=d(34),ib=d(49),Ub=d(41),lb=d(550),Qb=d(202);class fc{static PSo(mb,Ua){if(!mb||!Ua||mb.count!==Ua.count)return!1;for(const vb of mb)if(!Ua.contains(vb))return!1;return!0}static toArray(mb){if(!mb)return null;const Ua=Array(mb.count);let vb=0;for(const Ia of mb)Ua[vb]=
Ia,vb++;return Ua}}Object(G.a)(fc,"HashSetUtils",null,[]);var Fc=d(224),nc=d(105),zb=d(72);class Vb{constructor(mb,Ua,vb,Ia=0,Ma=null,qb=0){this.CPe=this.FM=null;this.Xkb=this.gIc=this.jIc=0;this.Jwa="";this.aIb=this.Drh=this.y9g=this.aoh=this.z1a=this.l0e=null;this.Cph=!1;this.wBb=null;this.fVe=0;this.NJd=this.eIb=this.RDb=this.MJd=null;this.sa=new fa.a;this.xod=this.p4c=this.Kl=null;this.QWe=!1;this.kbd=null;this.tkf=Xb=>{if(!this.W1i){var Cc=Xb.SPb();Cc.continueWith(()=>{this.Kl=Cc.result;this.Kl.JO(this.yZn)})}};
this.yZn=(Xb,Cc)=>{12===Cc.type&&(this.Drh?this.Drh():this.EPb(this.Jwa,2,this.z1a,!0))};this.Ga=mb;this.Af=Ua;this.Vd=vb;this.XGd=Ia;this.Iz=new ub;this.Xzh=this.Ga.kb("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.tu=Ma;this.AMc=0===qb?this.Hij(z.AFrameworkApplication.ua.Ib.Tk):this.Hij(qb);this.Nsb=mb.$("WacApplyManualPolicyLabelIsEnabled");this.Onc=mb.$("CoAuthForProtectedFilesIsEnabled");this.lzb=mb.$("SupportsOfficeClientCoauthoring");this.p2i=!1;this.lPj=3E4;this.Gb=ab.a.instance;
mb.$("SupportsPolicies")&&Z.a("MipSupportsPolicies");this.Onc&&this.lzb&&Z.a("MipSupportsOfficeClientCoauthoring")}get DXf(){return this.QWe}Z1k(mb){this.sa.addHandler("PolicyTipEvent",mb)}qgf(mb){this.sa.addHandler("LabelInfoUpdateEvent",mb)}tAo(mb){this.sa.removeHandler("LabelInfoUpdateEvent",mb)}k2k(mb){this.sa.addHandler("SetPolicyLabelTriggeredEventKey",mb)}URd(mb){this.sa.addHandler("SetPolicyLabelEventKey",mb)}Sgf(mb){this.sa.addHandler("SetPolicyLabelFailureEventKey",mb)}e0k(mb){this.sa.addHandler("GetPolicyLabelEventKey",
mb)}d0k(mb){this.sa.addHandler("GetAutoPolicyLabelEventKey",mb);this.DXf&&(m.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.Kpg(new Ja(0)))}$_k(mb){this.sa.addHandler("CreateAutoCLPSecurityNodesEventKey",mb)}s2k(mb){this.sa.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",mb)}t2k(mb){this.sa.addHandler("UpdateAutoCLPSITNodesEventKey",mb)}H_k(mb){this.sa.addHandler("AddAutoPolicyBusinessBarEntryEventKey",mb)}e2k(mb){this.sa.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",
mb)}I_k(mb){this.sa.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",mb)}f2k(mb){this.sa.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",mb)}EPh(mb){this.sa.addHandler("MandatoryLabellingAppHandlerEventKey",mb)}q2k(mb){this.sa.addHandler("UDPLabelingAppHandlerEventKey",mb)}get xin(){if(!this.FM)return!1;for(const mb of this.FM.V1c())if(!mb.Capabilities||!mb.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}get W1i(){return!!this.Kl}B5m(mb){mb&&this.Onc&&this.lzb&&mb.execute(this.tkf)}h5m(mb){mb&&
this.Onc&&this.lzb&&mb.continueWith(()=>{this.FM=mb.result})}ipl(){return this.aoh?this.aoh():!1}Yp(){return(new Date).getTime()}vJf(){this.Vd&&(this.MJd=this.Vd.Vf("WebServiceCall","Call Get Policy Endpoint On Server"));var mb=Fc.a.s7a(1,1);this.Ga.$("SendHostAttributionInfoForPolicyLabelEnabled")?(mb=new lb.a(this.Ukc("datalosspolicy"),1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,mb),this.Af.send(mb).UDa(Object(f.a)(this,this.rkj,"onDataLossPolicySuccessCallback"),
Object(f.a)(this,this.qkj,"onDataLossPolicyFailureCallback"))):this.Af.Ij(this.Ukc("datalosspolicy"),1,null,null,!0,2,Object(f.a)(this,this.rkj,"onDataLossPolicySuccessCallback"),Object(f.a)(this,this.qkj,"onDataLossPolicyFailureCallback"),null);this.jIc++;m.ULS.sendTraceTag(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.Xzh,this.jIc)}Qro(){this.EPb(this.Jwa,2,this.z1a)}EPb(mb,Ua=0,vb=null,Ia=!1){T.Health.instance.recordKpiUsage("MipGetPolicyLabel",
0,"officewebclp",this.f9a(void 0,Ua));this.p4c=this.Yp();const Ma=this.Qtf(Ua);this.t6d(mb,Ma,vb,Ia,Ua);this.EZb(!0)}rkj(mb){this.Etj();let Ua="";({data:Ua}=this.AKg(mb)).returnValue&&(m.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.jIc=0,this.Vd&&(this.NJd=this.Vd.Vf("Task","Parse and Handle Get Policy Response")),this.j9n(Ua),this.NJd&&(this.NJd.stop(),this.NJd=null))}qkj(mb){this.Etj();this.jIc<=this.XGd?this.vJf():(m.ULS.sendTraceTag(25565154,306,
15,"Request to get DataLossPrevention policy failed with error response: {0}.",mb?mb.data?mb.data.rna:null:null),this.jIc=0)}o2i(){return 0<this.Xkb}syb(mb){this.Iz.AppliedPolicyId=mb}zAg(mb,Ua,vb=null){const Ia=this.mGl(vb);this.PWo(mb,Ua,Ia,vb)}koj(mb){this.eIb&&(this.eIb.stop(),this.eIb=null);const {XKj:Ua,jPj:vb}=this.mHi(mb),Ia=mb.data.state,Ma=Ia?Ia.vIa:2;let qb="";({data:qb}=this.AKg(mb)).returnValue?(m.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",
Ma),this.Xkb=0,this.S9n(qb,Ua,vb,Ia)):this.Uvg(Ma)}Omo(mb){T.Health.instance.recordKpiUsage("MipSetPolicyLabel",0,"officewebclp",this.f9a(mb));this.xod=this.Yp();m.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.sa.raiseEvent("SetPolicyLabelTriggeredEventKey",new ob(mb))}URn(){this.Onc&&this.lzb&&this.W1i&&this.Kl.nC(12,null,!0)}joj(mb){this.eIb&&(this.eIb.stop(),this.eIb=null);const {XKj:Ua,jPj:vb}=this.mHi(mb);if(this.Xkb<=this.XGd)this.zAg(Ua,vb);else{var Ia=
mb.data.state;Ia=Ia?Ia.vIa:2;m.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",mb?mb.data?mb.data.rna:null:null,Ia);this.kbd="WACServerConnectionFailed";this.Xkb=0;this.Uvg(Ia)}}Rpn(mb){if(mb&&("LabelNotSupported"===mb||"LabelErrorRetryLater"===mb||"CoherencyFailure"===mb||"LabelIdNotFound"===mb||"LabelDisabled"===mb))return m.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",mb),!0;m.ULS.sendTraceTag(539103557,306,
50,"LabelError is not retriable: {0}",mb);return!1}Yoc(mb){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPAsProtectedLabelEnabled",!1)?mb.IsEndpointProtectionEnabled||mb.HasUserDefinedPermissions:mb.IsEndpointProtectionEnabled}xll(mb){if(!mb)return!1;let Ua=null,vb=null;for(const Ia of this.Iz.SensitivityLabels)Ia.Id===mb&&(Ua=Ia),Ia.Id===this.Jwa&&(vb=Ia);if(!Ua)return!1;if(this.Onc&&this.lzb){if(this.y9g&&this.y9g()||this.xin)return!0}else if(z.AFrameworkApplication.Om&&
z.AFrameworkApplication.Om.qqb||this.z1a&&this.z1a())return!0;return this.Yoc(Ua)===(!!vb&&this.Yoc(vb))}XQd(mb,Ua,vb,Ia,Ma){28===mb?this.Oxj(new xa(mb,Ua,vb,Ia,Ma,!1)):this.Oxj(new xa(mb,Ua,vb,Ia,Ma,!0))}VZa(mb){28===mb?this.gyj(new Ya(mb,!1)):this.gyj(new Ya(mb,!0))}Wlo(mb,Ua,vb){m.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");this.sa.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new Ea(mb,Ua,vb))}Wmo(mb){m.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");
this.sa.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new Ea(null,null,mb))}Xmo(mb,Ua){m.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.sa.raiseEvent("UpdateAutoCLPSITNodesEventKey",new Ea(mb,Ua,null))}Xxj(mb,Ua){m.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===Ua?"Reading":"Edit")+" switch event.");this.sa.raiseEvent("MandatoryLabellingAppHandlerEventKey",new yb(mb,Ua))}gff(mb,Ua,vb,Ia,Ma){37===mb&&this.Jlo(new ua(37,Ua,vb,Ia,Ma))}usg(){this.Jmo(new Pa)}Vmo(){m.ULS.sendTraceTag(540608322,
306,50,"Raising a UDP labeling event.");this.sa.raiseEvent("UDPLabelingAppHandlerEventKey",new Oa(!0))}wdc(mb=!1){const Ua=!!this.Iz&&this.Iz.AreLabelsAvailable&&!!this.Iz.SensitivityLabels&&0<this.Iz.SensitivityLabels.length&&Qb.a.any(this.Iz.SensitivityLabels,vb=>!!vb&&vb.Enabled);Ua||mb||za.ave(!1);return Ua}hlj(mb){this.RDb&&(this.RDb.stop(),this.RDb=null);var Ua="";this.EZb(!1);({data:Ua}=this.AKg(mb)).returnValue?(m.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),
this.gIc=0,Ua=this.C9n(Ua),mb=this.VEi(mb.data),T.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.lqb(void 0,mb,this.p4c)),this.p4c=null,mb=new Ja(mb),this.fmo(mb),this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?Ua&&this.X0o()?this.DXf?this.Vtp():(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)||this.CYd(),this.Kpg(mb),this.QWe=!0):Ua||this.qte():!this.DXf&&Ua&&this.Ga.$("WacApplyManualPolicyLabelIsEnabled")&&
this.jUh()?(this.Kpg(mb),this.QWe=!0):Ua||this.qte()):this.qte()}X0o(){if(!this.Ga.$("WacApplyManualPolicyLabelIsEnabled"))return m.ULS.sendTraceTag(539877667,306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.jUh())return!1;if(""===this.Jwa)return m.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),!0;if(this.wBb===this.fVe)return m.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),
!1;m.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");return!0}CYd(){this.g6j();m.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.aIb.count,this.wBb);const mb=fc.toArray(this.aIb);this.Wlo(mb,mb,this.wBb)}Vtp(){var mb=this.aIb;this.g6j();fc.PSo(mb,this.aIb)||(m.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.aIb.count),
mb=fc.toArray(this.aIb),this.Xmo(mb,mb));this.Cph&&(m.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",this.wBb),this.Wmo(this.wBb))}g6j(){const mb=new ja.a(w.a.th());for(const Ua of this.Iz.SensitivityLabels)if(Ua&&Ua.AutoLabelingSensitiveTypeIds&&0<Ua.AutoLabelingSensitiveTypeIds.length)for(const vb of Ua.AutoLabelingSensitiveTypeIds)vb&&mb.add(vb);this.aIb=mb}glj(mb){const Ua=this.VEi(mb.data);T.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",
!1,!1,this.lqb(void 0,Ua,this.p4c));this.p4c=null;this.RDb&&(this.RDb.stop(),this.RDb=null);if(this.gIc<=this.XGd){if(this.Ga.$("SendHostAttributionInfoForPolicyLabelEnabled")){const vb=mb.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in vb&&vb[Fc.a.pwe]&&"HostAttributionInfo.ScenarioTypeParamName"in vb&&vb[Fc.a.Tmd]){mb.data.request.get_headers();mb.data.request.get_headers()[Fc.a.Tmd];mb=this.Qtf(Ua);this.t6d(this.Jwa,mb,this.z1a,void 0,Ua);return}}this.EPb(this.Jwa,Ua,this.z1a)}else m.ULS.sendTraceTag(34996494,
306,15,"Request to get label policy failed with error response: {0}.",mb?mb.data?mb.data.rna:null:null),this.qte(),this.gIc=0,this.EZb(!1)}VEi(mb){return mb.state?mb.state:0}Ukc(mb,Ua=!1){let vb=String.format("{0}{1}?action={2}&{3}",this.Ga.kb("PolicyHandlerWebServiceBase")||z.AFrameworkApplication.ua.Ib.HYa,this.Xzh,mb,z.AFrameworkApplication.jm);"setpolicylabel"===mb&&z.AFrameworkApplication.Om&&z.AFrameworkApplication.Om.aZf&&(vb=ib.a.lp(vb,"sl","1"));Ua&&(vb=ib.a.lp(vb,"cbd","1"));return vb}mHi(mb){let Ua,
vb;Ua=vb=null;mb&&mb.data&&mb.data.request&&mb.data.request.get_headers()&&(Ua=mb.data.request.get_headers()[zb.a.YKj],vb=mb.data.request.get_headers()[zb.a.kPj]);return{XKj:Ua,jPj:vb}}AKg(mb){mb=mb?mb.data?mb.data.De:null:null;return mb&&mb.length&&!this.Vqn(mb)?{returnValue:!0,data:mb}:(m.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,data:mb})}j9n(mb){let Ua;try{Ua=cb.b(mb)}catch(vb){m.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");
return}if(Ua)if(Ua.IsPolicyTipAvailable)switch(Ua.IsPolicyTipAvailable.toLowerCase()){case "false":m.ULS.sendTraceTag(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":m.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.CPe=Ua.NavigateUrl;this.A7o(Ua.GeneralText,Object(f.a)(this,this.HWn,"onDataLossPolicyOverrideButtonClick"));break;default:m.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",
Ua.IsPolicyTipAvailable)}else m.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");else m.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")}LBl(mb){switch(mb){case "CoherencyFailure":return 1;case "DisabledByPolicy":return 2;case "FileCheckedOut":return 3;case "FileEncrypted":return 4;case "FileLocked":return 5;case "FileNotSupported":return 6;case "FileTooLarge":return 7;
case "InvalidOperationOnZeroByteFile":return 8;case "LabelDisabled":return 9;case "LabelErrorRetryLater":return 10;case "LabelIdNotFound":return 11;case "LabelIrmDisabledByTenant":return 12;case "LabelNotSupported":return 13;case "MinorVersionLimitExceeded":return 15;default:return 0}}S9n(mb,Ua,vb,Ia){var Ma=Ia?Ia.vIa:2;let qb=0,Xb="",Cc;if(({Zu:Cc}=cb.d(mb)).returnValue)if(Cc){Xb="Success";mb=this.Qtf(3);if(Cc.IsSuccessful){T.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.lqb(Ma,void 0,
this.xod));this.kbd=this.xod=null;m.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",Ma);2===Ma&&this.VZa(29);this.YXo(Ua,Ma);this.URn();this.VZa(28);Ia&&4===Ma&&this.XQd(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,Ia.displayName),CommonUIStrings.l_DialogOk,()=>{});Z.a("MipAppliedLabels",void 0,void 0,[Object.assign(new Aa.a,{name:"SetPolicyLabelApplyFlag",
string:sa.a[Ma]})]);this.t6d(Ua,mb,this.z1a,void 0,3);return}m.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",Ma,Cc.FailureReason);this.kbd=Cc.FailureReason;qb=this.LBl(Cc.FailureReason);this.p2i&&0<=Cc.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(Ia=new Xa.a(2,1,this.lPj,()=>{m.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",
this.Xkb);this.Xkb<=this.XGd&&this.zAg(Ua,vb)}),this.Gb.Zb(Ia));this.Onc&&this.lzb&&this.t6d(this.Iz.AppliedPolicyId,mb,this.z1a,!0,3)}else Xb="setPolicyLabelData null.",m.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",Ma);else Xb="TryDeserialize failed.",m.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",Ma);this.Uvg(Ma,qb);Ma=this.lqb(Ma,void 0,this.xod);
this.xod=null;Ma.extendedProperties.set("SetPolicyLabelDataFailureReason",this.kbd);Ma.extendedProperties.set("SetPolicyLabelDataParseStatus",Xb.toString());T.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,Ma)}Uvg(mb,Ua=0){const vb=2===mb||8===mb||16===mb;this.syb(this.Jwa);this.Wxj(new Yb);this.kyj(Ua,mb,vb,!1)}YXo(mb,Ua){this.syb(this.Jwa=mb);if(""===mb)z.AFrameworkApplication.lH=!1,z.AFrameworkApplication.n1d=!1;else for(const vb of this.Iz.SensitivityLabels)if(vb.Id===
mb){z.AFrameworkApplication.lH=this.Yoc(vb);break}this.Nmo(new rb(mb,Ua))}ixp(){for(const mb of this.Iz.SensitivityLabels)mb&&mb.Enabled&&(mb.Id===this.Jwa&&(this.Cph=this.wBb!==mb.Order,this.wBb=mb.Order),mb.Order>this.fVe&&(this.fVe=mb.Order))}C9n(mb){if(!({Zu:mb}=cb.d(mb)).returnValue)return m.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1;if(!mb)return m.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),
!1;if(!mb.AreLabelsAvailable)return!1;this.Iz=mb;this.Jwa=mb.AppliedPolicyId;this.Ga.appSettings&&(this.Ga.appSettings.AppliedPolicyId=this.Jwa);this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.ixp();this.wdc()&&m.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");this.Wxj(new Yb(!0));return!0}jUh(){if(!this.wdc())return m.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),
!1;for(const mb of this.Iz.SensitivityLabels)if(mb&&mb.AutoLabelingSensitiveTypeIds&&0<mb.AutoLabelingSensitiveTypeIds.length)return!0;m.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}Wxj(mb){m.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");this.sa.raiseEvent("LabelInfoUpdateEvent",mb)}fmo(mb){m.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.sa.raiseEvent("GetPolicyLabelEventKey",
mb)}qte(){za.ave(!1);this.sa.raiseEvent("GetPolicyLabelFailureEventKey",new nb)}Kpg(mb){this.tu&&this.tu.execute(Ua=>{Ua=[Ua.isFeatureEnabled("MsoClpSpTwo",!0),Ua.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(Ua).then(vb=>{Qb.a.any(vb,Ia=>Ia)&&(m.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),this.sa.raiseEvent("GetAutoPolicyLabelEventKey",mb),this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)&&this.CYd(),Z.a("MipAutoClassificationEnabled"));
return null})})}f9a(mb=null,Ua=null){const vb=new Map;vb.set("ClpCoauth",this.lzb.toString());null!=mb&&vb.set("ApplyLabelFlags",sa.a[mb]);null!=Ua&&vb.set("GetPolicyLabelsReason",Ca.a[Ua]);return vb}lqb(mb=null,Ua=null,vb=null){const Ia=new nc.a;Ia.extendedProperties=this.f9a(mb,Ua);null!=vb&&(Ia.durationMs=this.Yp()-vb);return Ia}Nmo(mb){m.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.sa.raiseEvent("SetPolicyLabelEventKey",mb)}Oxj(mb){m.ULS.sendTraceTag(51128227,306,50,
"Raising an add auto policy business bar entry event.");mb&&mb.Tfe&&Z.a("MipRecommendations");this.sa.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",mb)}gyj(mb){m.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.sa.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",mb)}Jlo(mb){m.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.sa.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",mb)}Jmo(mb){m.ULS.sendTraceTag(573842332,
306,50,"Raising a remove mandatory labelling business bar entry event.");this.sa.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",mb)}A7o(mb,Ua=null){m.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.sa.raiseEvent("PolicyTipEvent",new Za(CommonUIStrings.l_PolicyBusinessBarTitle,mb,CommonUIStrings.l_PolicyOverrideButton,Ua))}kyj(mb,Ua,vb,Ia=!0){m.ULS.sendTraceTag(42074656,306,Ia?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",Ua);Ia=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;
let Ma=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,qb=null,Xb=null;switch(mb){case 2:Ia=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarTitle;Ma=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarMessage;break;case 5:Ma=CommonUIStrings.l_SensitivityApplicationErrorFileLockedBusinessBarMessage;break;case 7:Ia=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;Ma=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;
break;case 13:Ia=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;Ma=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 9:Ia=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;Ma=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 10:Ma=CommonUIStrings.l_SensitivityApplicationErrorLabelErrorRetryLaterBusinessBarMessage;break;case 14:Ia=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;
Ma=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;break;case 15:Ia=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,Ma=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,qb=CommonUIStrings.l_LearnMore,Xb=()=>{this.QWo()}}mb=new tb(mb,Ua,vb,Ia,Ma,qb,Xb);this.sa.raiseEvent("SetPolicyLabelFailureEventKey",mb)}tVo(mb){this.l0e=mb}HWn(){this.CPe?(m.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),
Ub.a.Wpb(this.CPe)):m.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}Vqn(mb){if(!mb.startsWith("<")||-1===mb.indexOf("Error")&&-1===mb.indexOf("Unavailable"))return!1;m.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0}Etj(){this.MJd&&(this.MJd.stop(),this.MJd=null)}bgm(mb){if(!mb)return"manual";
switch(mb.vIa){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}}mim(mb){if(!mb)return"privileged";mb=mb.vIa;let Ua="privileged";if(4===mb||1===mb)Ua="standard";return Ua}Hij(mb){switch(mb){case 1:return"Excel";case 4:return"OneNote";case 2:return"PowerPoint";case 5:return"Visio";case 3:return"Word";default:return"Unknown"}}t6d(mb,Ua,vb=null,Ia=!1,Ma=0){this.Ga.$("WacLabelingGetPolicyLabelsIsEnabled")&&
(this.Jwa=mb,this.z1a=vb,this.Vd&&(this.RDb=this.Vd.Vf("WebServiceCall","Call Get Policy Endpoint On Server")),vb={},vb[zb.a.e7k]=mb,this.Ga.$("SendHostAttributionInfoForPolicyLabelEnabled")?(mb=new lb.a(this.Ukc("getpolicylabels",Ia),1,null,vb,!0,2,Ma,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Ua),this.Af.send(mb).UDa(Object(f.a)(this,this.hlj,"onGetPolicyLabelsSuccessCallback"),Object(f.a)(this,this.glj,"onGetPolicyLabelsFailureCallback"))):this.Af.Ij(this.Ukc("getpolicylabels",
Ia),1,null,vb,!0,2,Object(f.a)(this,this.hlj,"onGetPolicyLabelsSuccessCallback"),Object(f.a)(this,this.glj,"onGetPolicyLabelsFailureCallback"),Ma,void 0,void 0,void 0,void 0,"22"),this.gIc++,m.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.gIc))}PWo(mb,Ua,vb,Ia=null){if(this.Nsb){this.Vd&&(this.eIb=this.Vd.Vf("WebServiceCall","Call Set Policy Endpoint On Server"));var Ma={};Ma[zb.a.YKj]=mb;Ua&&(Ma[zb.a.kPj]=encodeURIComponent(Ua));this.l0e&&(Ma[zb.a.j6k]=
this.l0e);Ia?(Ma[zb.a.hPj]=this.bgm(Ia),Ma[zb.a.iPj]=this.mim(Ia),1===Ia.vIa&&this.Iz.DefaultLabelType&&(Ma[zb.a.OWo]=this.Iz.DefaultLabelType)):(Ma[zb.a.hPj]="manual",Ma[zb.a.iPj]="privileged");this.lzb&&this.Iz&&(Ma[zb.a.Abo]=this.Iz.PolicyLabelVersionToken);this.Ga.$("SendHostAttributionInfoForPolicyLabelEnabled")?(mb=new lb.a(this.Ukc("setpolicylabel",!0),1,null,Ma,!0,2,Ia,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,vb),this.Af.send(mb).UDa(Object(f.a)(this,
this.koj,"onSetPolicyLabelSuccessCallback"),Object(f.a)(this,this.joj,"onSetPolicyLabelFailureCallback"))):this.Af.Ij(this.Ukc("setpolicylabel",!0),1,null,Ma,!0,2,Object(f.a)(this,this.koj,"onSetPolicyLabelSuccessCallback"),Object(f.a)(this,this.joj,"onSetPolicyLabelFailureCallback"),Ia,void 0,void 0,void 0,void 0,"32");this.Xkb++;m.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.Xkb)}else m.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}QWo(){const mb=
new ma.StandardDialog,Ua=this.Ga.kb("BreadcrumbFolderUrl");Ua?(mb.Gd=11,mb.Pe(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),mb.Pe(2,CommonUIStrings.l_DialogOk)):(mb.Gd=0,mb.Pe(1,CommonUIStrings.l_DialogOk));mb.Zef(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");mb.hyo();mb.yY(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,
vb=>{1===vb&&Ua&&Ub.a.yn(Ua,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}Qtf(mb){switch(mb){case 1:return Fc.a.s7a(1,1);case 2:return Fc.a.s7a(7,1);case 3:return Fc.a.s7a(8,1);default:return Fc.a.s7a(7,0)}}mGl(mb=null){if(!mb)return Fc.a.s7a(8,0);switch(mb.vIa){case 1:case 16:return Fc.a.s7a(1,1);case 4:case 2:case 8:return Fc.a.s7a(8,1);default:return Fc.a.s7a(8,0)}}EZb(mb){ia.c()&&appChrome.api.setAsyncRequestStatus("sensitivity",mb)}}Object(G.a)(Vb,"PolicyManager",
null,[1055]);var rc=d(140),pb=d(193);class bb{constructor(){this.I8e=this.O4e=this.suh=this.uBh=this.$9g=this.St=this.fea=this.W=this.Xh=null;this.ljj=()=>{this.St=this.W.Oa("CommonUI.BusinessBar");this.Xh||(this.Xh=this.W.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.fea=this.W.resolve("Common.App.Policy.PolicyActor");ia.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.Xh.qgf(Object(f.a)(this.fea,this.fea.sAj,
"registerActionsHandler")):this.fea.Wb();this.Xh.qgf(this.hxp);z.AFrameworkApplication.K.$("WacApplyManualPolicyLabelIsEnabled")&&(this.Xh.Sgf(this.aXm),this.Xh.H_k(this.XQd),this.Xh.e2k(this.VZa),this.Xh.I_k(this.gff),this.Xh.f2k(this.usg))};this.hxp=()=>{this.fea.AWo();this.fea.eUo();this.fea.mko();const mb=this.Xh.ipl();z.AFrameworkApplication.K.$("HasDocumentEditRights")&&!mb?this.fea.rnp():m.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",
z.AFrameworkApplication.K.$("HasDocumentEditRights"),mb);z.AFrameworkApplication.ua.Ie()};this.z7o=(mb,Ua)=>{this.O4e&&this.St.C3(38)&&this.St.removeEntry(this.O4e);mb=this.TEi(Ua.title,Ua.Bbo,38,Ua.gVn,Ua.buttonText);z.AFrameworkApplication.ua.Ib.cza(mb,!0)?(this.O4e=mb,m.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):m.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")};this.aXm=
(mb,Ua)=>{Ua.d7o&&(this.I8e&&this.St.C3(21)&&this.St.removeEntry(this.I8e),mb=this.TEi(Ua.title,Ua.message,21,null,null,Ua.zUc,Ua.buttonText),z.AFrameworkApplication.ua.Ib.cza(mb,!0)?(this.I8e=mb,m.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):m.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))};this.VZa=(mb,Ua)=>{(mb=Ua.Tfe?this.uBh:this.$9g)&&this.St&&this.St.C3(Ua.kec)&&
this.St.removeEntry(mb)};this.XQd=(mb,Ua)=>{this.St&&(this.Xh.VZa(Ua.kec),mb=new a.a(Ua.title,Ua.message,null),mb.id=Ua.kec,mb.closeable=!0,mb.image=3,mb.addButton(Ua.buttonText,Ua.zUc,Ua.buttonText,!0),this.St.Uy(mb,!1),Ua.Tfe?this.uBh=mb:this.$9g=mb)};this.gff=(mb,Ua)=>{this.St&&(mb=new a.a(Ua.title,Ua.message,null),mb.id=Ua.kec,mb.closeable=!1,mb.image=3,mb.addButton(Ua.buttonText,Ua.zUc,Ua.buttonText,!1),this.St.Uy(mb,!1),this.suh=mb)};this.usg=()=>{const mb=this.suh;mb&&this.St&&this.St.C3(mb.id)&&
this.St.removeEntry(mb)}}get name(){return"Common.App.Policy"}init(){z.AFrameworkApplication.K.$("ShouldInitCommonPolicyPackage")&&(z.AFrameworkApplication.K.$("IsDataLossPreventionEnabledForUser")&&z.AFrameworkApplication.ua&&(this.Xh=this.W.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.Xh.Z1k(this.z7o),m.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",
!1)?rc.a.get_instance().Lk(5,()=>{this.Xh.vJf()}):rc.a.get_instance().Lk(6,()=>{this.Xh.vJf()})),z.AFrameworkApplication.K.$("WacLabelingPoliciesIsEnabled")&&z.AFrameworkApplication.K.$("SupportsPolicies")?z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?rc.a.get_instance().Lk(5,this.ljj):rc.a.get_instance().Lk(6,this.ljj):(za.zzp(),za.ave(!1)))}dispose(){}wc(mb){mb.register(1055,"Common.App.Policy.Contracts.IPolicyManager").ha().Rd(()=>
new Vb(z.AFrameworkApplication.K,z.AFrameworkApplication.Be,z.AFrameworkApplication.ua.hs,z.AFrameworkApplication.K.ic("MaxGetPolicyRetries",1),mb.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),z.AFrameworkApplication.ua.Ib.Tk));mb.register(za,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").ha().Rd(()=>new za(z.AFrameworkApplication.va,z.AFrameworkApplication.ua,z.AFrameworkApplication.K,mb.rf("Common.App.Policy.Contracts.IPolicyManager")));this.W=
mb}TEi(mb,Ua,vb,Ia=null,Ma=null,qb=null,Xb=null){mb=new a.a(mb,Ua,null);mb.id=vb;mb.closeable=!0;Ia&&mb.mRd(Ma,Ia);qb&&mb.addButton(Xb,qb,Xb);return mb}static main(){pb.a.instance.Jc(new bb)}}Object(G.a)(bb,"PackageManager",null,[0,1]);d.d(J,"a",function(){return Pb});const Pb=()=>{Type.registerNamespace("Common.App.Policy");bb.main()}},1873:function(G,J,d){var m=d(0),f=d(1936),a=d(381),l=d(651),w=d(54),y=d(21),v=d(2170),u=d(2),x=d(196);class z{constructor(ic,yc){this.CommentId=ic;this.ResolveState=
yc}}Object(m.a)(z,"CommentProperties",null,[]);var A=d(628),D=d(1690),F=d(96),I=d(2173),H=d(2174),N=d(1753),M=d(2172),U=d(202),O=d(1934);class V extends O.a{constructor(ic,yc="",bd="",sd="",ie=!1){super(ic,yc,bd,sd,ie);this.DateUtc=null}}Object(m.a)(V,"CommentReactionUser",O.a,[]);var Y;(function(ic){ic[ic.o6p=1]="like"})(Y||(Y={}));Object(m.b)("ReactionType",Y);var Q;(function(ic){ic[ic.first=0]="first";ic[ic.done=0]="done";ic[ic.zrp=1]="undone";ic[ic.aza=2]="addComment";ic[ic.deleteComment=3]="deleteComment";
ic[ic.Pob=4]="editComment";ic[ic.uOh=5]="addReaction";ic[ic.VCj=6]="removeReaction";ic[ic.last=7]="last"})(Q||(Q={}));Object(m.b)("CommentChangeType",Q);var S=d(250),P=d(1510),T=d(286);class Z{constructor(){this.HEh=this.aHh=!1;this.$Qk=[]}get sAc(){return this.$Qk}get h1b(){return this.aHh}set h1b(ic){this.aHh=ic;for(const yc of this.sAc)yc.h1b=ic}get N_b(){return this.HEh}set N_b(ic){this.HEh=ic;for(const yc of this.sAc)yc.N_b=ic}sfb(ic){for(const yc of this.sAc)ic=yc.sfb(ic);return ic}}Object(m.a)(Z,
"AggregateCommentTaskPersonTransformer",null,[1495]);var X=d(7),aa=d(123),ia=d(1689);class wa{constructor(ic,yc){this.cDk=new T.a(()=>yc.sfb(ic.value))}Wom(){return new Date}n7a(ic,yc,bd){if(0===ic)throw X.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");const sd=aa.a.create().toString();bd=new ia.a(ic,this.cDk.value,bd,sd,!1);bd.commentId=yc;X.ULS.sendTraceTag(42796192,327,
50,"History Record Generated. [RecordType: {0}]",ic);return bd}}Object(m.a)(wa,"HistoryRecordFactory",null,[1497]);var ma=d(1772);class na{constructor(ic,yc,bd,sd,ie,We){this.isLossy=ic;this.title=yc;this.assignees=bd;this.schedule=sd;this.completion=ie;this.priority=We}}Object(m.a)(na,"CommentTaskState",null,[]);class Fa{constructor(){this.commentId=null}}Object(m.a)(Fa,"HistoryItem",null,[]);class Qa{constructor(ic,yc,bd,sd,ie,We,Pe){this.fXe=!1;if(1!==yc.type)throw Error.argument("createRecord");
this.$Fc=bd;this.XFc=sd;this.YFc=ie;this.fwh=1;this.tDd=ic;this.eFk=We;this._state=new na(!1,this.$Fc,Pe,new ma.a,this.YFc,this.XFc);this._history=[];this.pai(yc)}fgc(ic,yc){if(1!==ic.type)throw Error.argument("createRecordTemplate");const bd=Qa.BMm(ic,this.fwh);this.fwh++;return Object.assign(new ia.a(yc,ic.user,ic.time,bd),{commentId:ic.commentId})}get C5i(){return this.history[this.history.length-1]}get ANi(){return this.state.completion===this.YFc}get zNi(){return this.state.priority===this.XFc}get BNi(){return(void 0===
this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get CNi(){return this.state.title===this.$Fc}pai(ic){ic=Object.assign(new Fa,{commentId:ic.commentId,records:[ic]});this.history.push(ic)}Uti(ic){let yc=-1;for(let bd=0;bd<this.state.assignees.length;bd++)if(this.tDd.equals(this.state.assignees[bd],ic)){yc=bd;break}return yc}R0o(ic){const yc=this.C5i,bd=yc.records[yc.records.length-1];return this.tDd.equals(bd.user,
ic.user)&&yc.commentId===ic.commentId&&bd.time.getTime()===ic.time.getTime()?!0:!1}LAp(ic){switch(ic.type){case 2:-1===this.Uti(ic.assignee)&&this.state.assignees.push(ic.assignee);break;case 3:const yc=this.Uti(ic.assignee);0<=yc&&this.state.assignees.splice(yc,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=ic.schedule;break;case 6:this.state.completion=ic.completion;break;case 9:this.state.title=ic.title;break;case 10:this.state.priority=ic.priority;break;case 0:this.state.isLossy=
!0;break;case 1:X.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.fXe=!0;break;case 8:this.fXe=!1;break;case -1:X.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}ic.isLossy&&(this.state.isLossy=!0);this.R0o(ic)?this.C5i.records.push(ic):this.pai(ic)}get isDeleted(){return this.fXe}get state(){return this._state}get history(){return this._history}cvm(ic){if(!ic)return this.history;const yc=
Array.clone(this.history),bd=yc[0],sd=bd.records.shift();if(!this.eFk){var ie=this.fgc(sd,4);bd.records.unshift(ie)}!ic.ANi&&this.ANi&&(ie=this.fgc(sd,6),ie.completion=this.YFc,bd.records.unshift(ie));!ic.zNi&&this.zNi&&(ie=this.fgc(sd,10),ie.priority=this.XFc,bd.records.unshift(ie));!ic.BNi&&this.BNi&&(ie=this.fgc(sd,5),ie.schedule=new ma.a,bd.records.unshift(ie));!ic.CNi&&this.CNi&&(ie=this.fgc(sd,9),ie.title=this.$Fc,bd.records.unshift(ie));ic.isDeleted&&(ic=this.fgc(sd,8),bd.records.unshift(ic));
return yc}static BMm(ic,yc){return"Synthesized-"+ic.recordId+"-"+yc}}Object(m.a)(Qa,"CommentTaskStateBuilder",null,[]);class ya{constructor(ic,yc,bd,sd){this.id=ic;this.commentId=yc;this.currentState=bd;this.history=sd}}Object(m.a)(ya,"CommentTaskItem",null,[]);var ta=d(1688);const Aa=ic=>{const yc=new ta.a(ic.UserId,ic.Provider,ic.DisplayName,ic.Email);yc.IsCurrentUser=ic.IsCurrentUser;return yc};var oa=d(1933);class za{static clone(ic){ic=za.ltl(ic.extensions);return new oa.a(ic)}static X3h(ic){return ic?
za.clone(ic):null}static isEmpty(ic){return!ic.extensions||!ic.extensions.count}static Tf(ic){return!ic||za.isEmpty(ic)}static ltl(ic){if(!ic)return null;const yc=new a.a;ic.forEach((bd,sd)=>{yc.add(bd,sd);return!0});return yc}}Object(m.a)(za,"ExtensionListExtensions",null,[]);class ja{static clone(ic){var yc=Aa(ic.user);yc=new ia.a(ic.type,yc,ic.time,ic.recordId,ic.isLossy);yc.commentId=ic.commentId;yc.anchorExtensionList=za.X3h(ic.anchorExtensionList);yc.recordExtensionList=za.X3h(ic.recordExtensionList);
ic.assignee&&(yc.assignee=Aa(ic.assignee));if(ic.schedule){var bd=ic.schedule;const sd=new ma.a;sd.startDate=bd.startDate;sd.endDate=bd.endDate;yc.schedule=sd}yc.completion=ic.completion;yc.title=ic.title;yc.priority=ic.priority;yc.undoId=ic.undoId;return yc}}Object(m.a)(ja,"HistoryRecordExtensions",null,[]);class fa{constructor(ic,yc,bd,sd,ie,We,Pe,Re=!1){this.tDd=ic;this.FJd=yc;this.VSa=bd;this.Urk=sd;this.$Fc=ie;this.XFc=We;this.YFc=Pe;this.cFd=Re}BKl(ic,yc,bd,sd=null){if(!ic)throw X.ULS.sendTraceTag(42796181,
327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!yc)throw X.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!bd||!bd.length)throw X.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==bd[0].type)throw X.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var ie=[],We=null,Pe=this.bio(bd);for(var Re of bd)if(!Pe.contains(Re.recordId))if(bd=
this.TJi(Re.commentId,sd),bd=this.ufm(Re,bd),1===bd.type){let vg=[];this.cFd&&We&&We.state&&(vg=We.state.assignees);We=new Qa(this.tDd,bd,this.$Fc,this.XFc,this.YFc,this.cFd,vg);ie.push(We)}else if(We)We.LAp(bd);else throw X.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");Pe=null;Re=[];if(We){We.isDeleted||
(Pe=We.state);We=null;for(var Sf of ie)ie=Sf.cvm(We),Array.addRange(Re,ie),We=Sf}Sf=this.TJi(yc,sd);Pe&&(Pe.completion=this.Hxl(yc,sd,Pe.completion));return new ya(ic,Sf,Pe,Re)}xsi(ic,yc,bd,sd=null){if(!yc)throw X.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(bd&&!ic)throw X.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const ie=[],We=this.VSa.Wom();if(bd){var Pe=this.VSa.n7a(1,ic,We);ie.push(Pe)}Pe=
null;if(yc.assigneeUpdate){if(!yc.assigneeUpdate.assigneesToAdd||!yc.assigneeUpdate.assigneesToRemove)throw X.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Re=0;Re<yc.assigneeUpdate.assigneesToAdd.length;Re++){var Sf=this.qai(2,yc.assigneeUpdate.assigneesToAdd[Re],ic,We);Sf&&ie.push(Sf)}for(Re=0;Re<yc.assigneeUpdate.assigneesToRemove.length;Re++)(Sf=this.qai(3,yc.assigneeUpdate.assigneesToRemove[Re],ic,We))&&ie.push(Sf)}else yc.assignee&&
(bd||(Pe=this.VSa.n7a(4,ic,We),ie.push(Pe)),Re=this.VSa.n7a(2,ic,We),Pe=this.FJd.sfb(yc.assignee),Re.assignee=Pe,ie.push(Re));yc.title?(sd=this.VSa.n7a(9,ic,We),sd.title=yc.title,ie.push(sd)):bd&&sd&&(Re=this.VSa.n7a(9,ic,We),Re.title=this.Urk.qPm(sd,Pe),ie.push(Re));if(yc.schedule){if(yc.schedule.startDate>yc.schedule.endDate)throw X.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");sd=this.VSa.n7a(5,ic,We);sd.schedule=yc.schedule;ie.push(sd)}if(void 0!==
yc.completion&&null!==yc.completion){sd=yc.completion;if(0>sd||100<sd)throw X.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");bd||X.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",sd);bd=this.VSa.n7a(6,ic,We);bd.completion=sd;ie.push(bd)}if(void 0!==yc.priority&&null!==yc.priority){yc=yc.priority;if(0>yc||10<yc)throw X.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");ic=this.VSa.n7a(10,
ic,We);ic.priority=yc;ie.push(ic)}return ie}qai(ic,yc,bd,sd){if(2!==ic&&3!==ic)return X.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;ic=this.VSa.n7a(ic,bd,sd);ic.assignee=this.FJd.sfb(yc);return ic}bio(ic){const yc=new l.a,bd=new l.a;for(let sd=ic.length-1;0<=sd;sd--){const ie=ic[sd],We=bd.contains(ie.recordId);We||-1!==ie.type||(bd.contains(ie.undoId)?X.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):
bd.add(ie.undoId));if(We||-1===ie.type)yc.contains(ie.recordId)?X.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):yc.add(ie.recordId)}return yc}ufm(ic,yc){const bd=ja.clone(ic);bd.commentId=yc;bd.user=this.FJd.sfb(ic.user);bd.assignee=this.FJd.sfb(ic.assignee);return bd}Hxl(ic,yc,bd){let sd=bd;ic&&yc&&(({value:yc}=yc.Dc(ic)).returnValue?(sd=yc.ResolveState?100:100===bd?0:bd,sd!==bd&&X.ULS.sendTraceTag(592719873,327,50,
"Task completion state has been changed to match comment resolution state for comment {0}",ic)):X.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",ic));return sd}TJi(ic,yc){let bd=ic;ic&&yc&&(({value:yc}=yc.Dc(ic)).returnValue?bd=yc.CommentId:(X.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",ic),bd=ic));return bd}}Object(m.a)(fa,"CommentTaskTranslatorImpl",null,[1496]);var Ca=d(1126),
xa=d(1305);class ua{constructor(){this.Wob=CommonUIStrings.l_Ellipsis}qPm(ic,yc){if(!ic)throw X.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");try{var bd=D.a.Iqb(ic)}catch(Sf){throw X.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var sd=ic=0,ie=0;const We=RegExp("\\s+","g"),Pe=new Sys.StringBuilder;for(var Re of bd.ops)Re.attributes&&Re.attributes.atmention&&
Re.attributes.atmention.email&&yc&&(bd=Re.attributes.atmention.email,0<bd.length&&(bd===yc.UserId||bd===yc.Email||bd===Ca.a.zpb(yc.UserId))&&(sd=ic,ie=sd+Re.insert.length)),bd=Re.insert.replace(We," "),ic+=bd.length,Pe.append(bd);!ie&&yc&&X.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",yc.Provider);yc=Pe.toString().trimEnd();ic=yc.length;255<ic?(Re=(255-(ie-sd))/2,0>sd-Re?(ic=xa.a.instance.S8a(yc,255-this.Wob.length),ie=yc.substring(0,ic)+this.Wob,ic="Trimmed End"):ie+
Re>ic?(sd=xa.a.instance.j9a(yc,ic-255+this.Wob.length),ie=this.Wob+yc.substring(sd,ic),ic="Trimmed Start"):(sd=xa.a.instance.j9a(yc,sd-Re+this.Wob.length),ic=xa.a.instance.S8a(yc,ie+Re-this.Wob.length),ie=this.Wob+yc.substring(sd,ic)+this.Wob,ic="Trimmed Both")):(ic="No Trim",ie=yc);X.ULS.sendTraceTag(592998804,327,50,ic);return ie}}Object(m.a)(ua,"ContentExtractor",null,[]);class sa{constructor(ic,yc){this.Tyk=ic;this.dDk=yc;this.N_b=this.h1b=!1}sfb(ic){if(!ic)return null;if(void 0===ic.UserId||
null===ic.UserId)throw X.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(ic.IsCurrentUser||!this.Tyk.equals(this.dDk.value,ic))return ic;ic=Aa(ic);ic.IsCurrentUser=!0;return ic}}Object(m.a)(sa,"EnsureIsCurrentUserSetTransformer",null,[1495]);class Ea{constructor(){this.N_b=this.h1b=!1}sfb(ic){if(!ic)return null;if(void 0===ic.UserId||null===ic.UserId)return ic;if(!ic.Email||""===ic.Email){let yc;if(yc=Ca.a.zpb(ic.UserId))return ic=Aa(ic),ic.Email=
yc,ic}return ic}}Object(m.a)(Ea,"RestoreEmailTransformer",null,[1495]);class Ja{constructor(){this.N_b=this.h1b=!1}sfb(ic){if(!ic)return null;if(void 0!==ic.UserId&&null!==ic.UserId)return ic;switch(this.h1b?this.N_b?2:1:0){case 0:if(void 0===ic.UserId||null===ic.UserId)throw X.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");ic=Aa(ic);break;case 1:if(void 0===ic.Id||null===ic.Id)throw X.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");
if(void 0===ic.Email||null===ic.Email)throw X.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var yc=Ja.dsj(ic.Id,ic.Email,null);if(!yc||""===yc)throw X.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var bd=u.AFrameworkApplication.K.kb("HostAuthType")||"";if("aad"!==bd.toLowerCase()||yc.startsWith("S::")){if("msa"===bd.toLowerCase())throw X.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),
Error.argument("CommentTaskUserType");X.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",bd)}else throw X.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");ic=new ta.a(yc,"AD",ic.DisplayName,ic.Email);break;case 2:if(void 0===ic.UserPrincipalName||null===ic.UserPrincipalName)throw X.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==ic.SuggestionSubtype&&
null!==ic.SuggestionSubtype)if("OrganizationUser"===ic.SuggestionSubtype)yc="AD";else throw X.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",ic.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw X.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");bd=Ja.dsj(ic.Id,ic.UserPrincipalName,ic.AadObjectId);if(!bd||""===bd)throw X.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");
if("AD"===yc&&!bd.startsWith("S::"))throw X.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");ic=new ta.a(bd,yc,ic.Name,ic.UserPrincipalName);break;default:throw X.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return ic}static dsj(ic,yc,bd){if(!yc||""===yc)return X.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),ic;if(bd&&""!==bd)return"S::"+yc+"::"+bd;if(!ic||""===ic)return X.ULS.sendTraceTag(593368217,
327,50,"Missing ID"),ic;if(ic.startsWith("S::"))return ic;if(-1!==ic.indexOf("@")){bd=ic.split("@");if(aa.a.isValid(bd[0]))return"S::"+yc+"::"+bd[0];X.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return ic}}Object(m.a)(Ja,"UserIdCanonicalizationTransformer",null,[1495]);class nb{constructor(ic,yc,bd=!1,sd=!1){this.Guk=ic;this.Aah=yc;this.PDk=bd;this.cFd=sd}lEl(){const ic=new Ca.a;var yc=new T.a(nb.zom);const bd=new Z;this.Aah&&(bd.sAc.push(new Ja),bd.sAc.push(new Ea));
this.Guk&&bd.sAc.push(new sa(ic,yc));bd.h1b=this.Aah;bd.N_b=this.PDk;yc=new wa(yc,bd);const sd=new ua;return new fa(ic,bd,yc,sd,nb.ROl,nb.FOl,nb.GOl,this.cFd)}static zom(){const ic=new ta.a(u.AFrameworkApplication.K.kb("PresenceUserId")||"",u.AFrameworkApplication.K.kb("PresenceProvider")||"",u.AFrameworkApplication.userName||"");ic.IsCurrentUser=!0;return ic}}nb.ROl="";nb.FOl=5;nb.GOl=0;Object(m.a)(nb,"CommentTaskTranslatorFactory",null,[1486]);var ub=d(12),Yb=d(105),yb=d(6),Za=d(22),Ya=d(51),Pa=
d(794),rb=d(38),tb=d(8),ob=d(1300),Oa=d(17),Xa=d(25),ab=d(28),cb=d(87),ib=d(306),Ub=d(135),lb=d(498),Qb=d(287),fc=d(426),Fc=d(656),nc=d(23),zb=d(362),Vb=d(52),rc=d(66),pb=d(256),bb=d(11),Pb=d(242),mb=d(5),Ua=d(63),vb=d(1166),Ia=d(771),Ma=d(757),qb=d(331),Xb=d(636),Cc=d(298),Ec=d(104),Wb=d(652),Hb=d(122),Sb=d(95),cc=d(245),Gc=d(1528),Oc=d(174),Zc=d(34),kb=d(15),wd=d(1127);class qe{create(){return new wd.a}}Object(m.a)(qe,"CommentNodeFactory",null,[296]);var Qd=d(132),me=d(1295),Ne=d(1151),Cd=d(1578),
Pf=d(1652),cg=d(1460),mg=d(16);class ci extends cg.a{constructor(ic){super();this.vKk=ic}get index(){return 2}run(){this.vKk()}c5h(ic,yc){yc.property===mg.a.wg&&this.D0()}}Object(m.a)(ci,"CommentContentPropertyTracker",cg.a,[]);var Dd=d(1654),Xc=d(1570);class Jd{constructor(){this.lRe=new Map;this.nUe=new Map}JVk(ic,yc){if(this.lRe.has(ic))throw Error("DuplicateDurableId");if(this.nUe.has(yc))throw Error("DuplicateGuardId");this.lRe.set(ic,yc);this.nUe.set(yc,ic)}ium(ic){return this.lRe.get(ic)}Ixi(ic){return this.nUe.get(ic)}}
Object(m.a)(Jd,"CommentIdMapper",null,[]);class pf{constructor(ic,yc){this.rwb=ic;this.eUi=yc}}Object(m.a)(pf,"CommentIntentIdentifier",null,[]);var Ce=d(1593),pc=d(1116),$c=d(1306),id=d(209),de=d(748);class Ae extends cg.a{constructor(ic,yc){super();this.dhb=new Xb.a(new pc.a);this.Abc=new $c.a(Xc.c);this.Bbc=new id.ScriptSharpLegacyMap;this.pGk=ic;this.sHk=yc;this.Bbc.add(mb.a.Rea,1);this.Bbc.add(mb.a.NJ,0);this.Bbc.add(mg.a.wg,0);this.Bbc.add(mb.a.WT,2)}get index(){return 4}run(){let ic="";for(const yc of this.dhb)if(this.pGk(yc),
this.Abc.mb(yc.id))for(const bd of this.Abc.J(yc.id))ic+="_"+bd;this.sHk(ic);this.dhb.clear();this.Abc=new $c.a(Xc.c)}twl(ic,yc){ic=yc.property;if(ic===mb.a.Rea||ic===mb.a.NJ||ic===mg.a.wg||de.a.eHe&&ic===mb.a.PLb||ic===mb.a.WT)this.dhb.add(yc.node),this.Bbc.mb(ic)&&(this.Abc.mb(yc.node.id)||this.Abc.add(yc.node.id,new Wb.a),this.Abc.J(yc.node.id).add(this.Bbc.J(ic))),this.D0();Cd.a.Qci.has(yc.node.id.toString())&&ic===mb.a.MG&&X.ULS.sendTraceTag(521484097,327,15,"Durable ID changed of a Cut Pasted Comment")}Ewl(ic,
yc){yc.property===mg.a.Un&&(ic=yc.node,ic.LSb&&(this.dhb.add(ic),this.D0()))}Chp(ic,yc){this.dhb.add(yc.node);this.D0()}}Object(m.a)(Ae,"CommentNodeTransactionCompletedProcessor",cg.a,[]);var gf=d(1653),uf=d(1691),Lf=d(1774);class hg{constructor(){this.t_c=this.Hqd=null;this.r1d=this.bBe=!1;this.zUa=this.$Ia=null}}Object(m.a)(hg,"CommentAnchorParaNodesStatus",null,[]);d.d(J,"a",function(){return Vf});class Vf extends f.a{get e0j(){return null!=this.x5g?this.x5g:this.x5g=(()=>this.xd.isFeatureEnabled(13))()}constructor(ic,
yc,bd,sd,ie,We,Pe,Re,Sf,vg,Yg,ph,Di,bj,gi,Zg,Bb,Nb,Bc,td,Je,Ef,Ih,tg,Dh,Jh=null,Xh){super();this.Oy=ic;this.R_e=yc;this.N_e=bd;this.Pc=sd;this.erk=ie;this.pFb=We;this.vdf=Pe;this.t5b=Re;this.Ga=Sf;this.xd=vg;this.Yn=Yg;this.f9b=ph;this.W1=Di;this.V8b=bj;this.fth=gi;this.Ri=Zg;this.Fn=Bb;this.u1a=Nb;this.Hj=Bc;this.A1=td;this.sJ=Je;this.p5a=Ef;this.OOc=Ih;this.$Ec=[];this.Q1a=[];this.Laf=new a.a(0);this.jLd=new a.a;this.qOd=new Xb.a(Cc.a.th());this.kaf=new Xb.a(Cc.a.th());this.yAd=null;this.$Cb=new a.a;
this.PPe=!1;this.Dyd=new l.a;this.unh=!1;this.ZNe=new Set;this.uNe=0;this.J1=[];this.A6b=2;this.MHa=new a.a(!1);this.eMc=new l.a;this.OGc=new Map;this.yyd=new Jd;this.zyd=0;this.drk=5;this.kWb=(Mf,Jg)=>{Mf=Jg.paragraphNode;for(const ug of Jg.contents)this.xla(ug.element,Mf,ug.intents,ug.hI)};this.Ted=(Mf,Jg)=>{if(Mf.Lc.id.equals(this.td.id)){this.u1a.INa(7);var ug=Mf.getValue(mb.a.NJ),ze=Mf.getValue(mb.a.MG).toString();ug=this.Ri.epb?this.OGc.has(ze)?this.OGc.get(ze):ze:ug;ug=this.DF(ug);if(Jg){if(ug){this.hz&&
this.hz.Mf===ug.id&&(X.ULS.sendTraceTag(592188698,327,50,"Draft lost by parent deletion"),this.sJ.logKpiFailure(Ce.a.eXd,"DraftCommentLostOnParentDelete",{isIntentional:!1,isInternal:!0},{name:Ce.a.SWd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}));Jg=ug.Mf?"The comment is a reply":"";ze=Xc.k(Mf,w.a.nil).toString();const pi=Xc.h(Mf,w.a.nil).toString();if(this.Dyd.contains(ug.id)&&!Cd.a.Wgn(ug.a8a)){this.Dyd.remove(ug.id);const og=+new Date-+ug.date;X.ULS.sendTraceTag(577307335,327,15,"New session comment deleted by inbound change: {0}. duration: {1}. startParaId: {2}. endParaId: {3}. {4}.",
Xc.a(ug),og,ze,pi,Jg)}else X.ULS.sendTraceTag(50426379,327,50,"{0} deleted by inbound changes. startParaId: {1}. endParaId: {2}. {3}.",Xc.a(ug),ze,pi,Jg);this.Gj.OYc(ug);this.Nei(Mf.id)}}else if(!ug){this.sJ.ensureFeatureDenominatorLoggedAndVetoPillarRegistered();y.a.instance.Oa("WordEditor.Comments.EditorCommentManager")||X.ULS.sendTraceTag(525379405,327,10,"comment Manager resolve failed");if(this.Ri.lNb&&!this.Hj.s0){this.A1.m4("OnCommentInit",Object.assign(new gf.a,{Ykj:()=>{this.Keg(Mf);this.cZb()}}));
return}this.Ri.Pr||this.Hj.s0||this.A1.m4("OnCommentInit");this.nlo(Mf)||this.Keg(Mf)}this.PPe=!0}};this.cZb=(Mf=null)=>{this.Ri.B1b&&this.eSi();this.Ri.B1b&&this.L0l();this.uL.fZb(void 0,Mf);this.u1a.INa(8)};this.Qoj=(Mf,Jg,ug)=>{if(Mf.Lc.id.equals(this.td.id)){var ze=Mf.ja(mb.a.taskId,"");if(""===ze)X.ULS.sendTraceTag(42856717,3003,10,"Newly added or deleted task node does not have a task id.");else{if(Jg)if(this.kaf.add(ze),ze=this.V8b.value.QIi(Mf),void 0!==ze&&null!==ze)this.$Cb.remove(ze);else{X.ULS.sendTraceTag(591971722,
3003,10,"A task without comment id was deleted even though that shouldn't be possible.");return}else if(this.qOd.add(ze),Jg=this.V8b.value,Mf=Jg.QIi(Mf),void 0!==Mf&&null!==Mf)for(this.$Cb.J(Mf)?this.$Cb.Z(Mf,ze):this.$Cb.add(Mf,ze),Mf=Jg.SIi(ze),Jg=0;Jg<Mf.length;Jg++){var pi=Mf[Jg].commentId;pi&&(pi=Number.parseInvariant(pi),this.$Cb.J(pi)||this.$Cb.add(pi,ze))}else{X.ULS.sendTraceTag(591971723,3003,10,"A task without comment id was added or modified even though that shouldn't be possible.");return}ug&&
this.cZb()}}};this.Kup=Mf=>{if(Cd.a.Gde(Mf)){const ug=this.e3(Mf.id.toString());if(ug){const ze={text:ug.text,done:ug.done};var Jg=yb.GraphIterator.eb(Mf);ug.text=this.uPb(Jg);this.C$i(ug.text);ug.done=Mf.ja(mb.a.Rea,!1);Mf.hasProperty(mb.a.WT)&&(Jg=(Jg=Mf.getValue(mb.a.WT))?Zc.b(Jg||""):null,ug.usersByReactionType=Jg,Dd.a.T1h(ug.usersByReactionType),this.fpl(ug));this.Nup(Mf,ug);ug.Mf||this.Tup(Mf,ug);!this.qG||this.hz&&this.hz.id===ug.id||this.qG.fireEvent(10,{comment:ug,Uij:ze})}}else this.xd.isFeatureEnabled(110)&&
72===Mf.type?this.Qoj(Mf,!1,!1):this.Mup(Mf)};this.M0l=()=>{const Mf=this.U5d();for(this.$Ec.sort((Jg,ug)=>{const ze=Jg.ja(mb.a.XO,null),pi=ug.ja(mb.a.XO,null);if(!ze&&pi)return-1;if(!pi&&ze)return 1;Jg.hasProperty(mb.a.aJa)&&ug.hasProperty(mb.a.aJa)?(Jg=Jg.getValue(mb.a.aJa),ug=ug.getValue(mb.a.aJa),ug=Jg<ug):(Jg=new Date(Jg.getValue(mb.a.hfc)),ug=new Date(ug.getValue(mb.a.hfc)),ug=Jg<ug);return ug?-1:1});this.$Ec.length;){const Jg=this.$Ec[0];Mf.Irb(Jg)&&(Mf.Yj(Jg),this.Gj.aza(this.FYd(Mf),null),
this.Gj.mode=1);Array.removeAt(this.$Ec,0)}if(Mf.Ub(1))for(;Mf.Lf(1););this.xd.isFeatureEnabled(110)&&this.V8b.value.UIi();this.PPe&&(this.cZb(),this.PPe=!1)};this.iTl=Mf=>{1===Mf&&(cc.WoncaApp.OCe.A9h(),Za.App.Lna?Za.App.Ak.zcd(!0,"CommentInboundFailed"):this.f9b.value.Wdb(!0,"CommentInboundFailed"));this.W1.jK(Ya.a.Wsf,this.l5i)};this.Cta=Mf=>{if(!this.Ri.Pr||Mf.done)return!1;if(Mf.Nr===v.a.dE)return!0;if(Mf.objectId){if(this.Bfn(Mf))return!1;if(!this.imn(Mf.objectId)||Mf.Mf)return!0;for(const Jg of this.xR())if(Jg.Mf===
Mf.id)return!0}return!1};Vf.AM=Jh;this.GHd=new Xb.a(Cc.a.th());!this.Ri.lNb&&this.Ri.Pr||wd.a.PZa(this.Ted);Dh.mIa(this.kWb);tg&&(tg.Bw((Mf,Jg)=>{Mf=Xc.p(this.J1,Jg.node.id);0<this.J1.length&&(!Mf||Mf===this.J1.length-1)&&(this.A6b=1,this.J1=[])}),Xh.execute(Mf=>{this.qG=Mf}))}get uL(){return this.Gj}get Rhf(){return this.oh}get l5i(){return null!=this.M0g?this.M0g:this.M0g=Object.assign(new Pa.a,{L6:WoncaIntl.WoncaStrings.l_InboundingCommentFailed,Uja:1})}get Yo(){return this.Pc}get lv(){return this.Oy.value}get td(){return this.lv.td}get d1a(){return this.R_e.value}get cJa(){return this.N_e.value}get lb(){return this.pFb.value}get N0(){return this.Ga.kb("PresenceUserId")}get Lcb(){return this.Ga.kb("PresenceProvider")}xla(ic,
yc,bd,sd){if(bd&&this.hz&&(!this.hz||!this.hz.Mf)){var ie=!1;for(const We of bd)if(3===We.type)switch(ie=!0,bd=Xc.o(this.J1,We.id),-1<bd&&(this.J1[bd].rwb=yc.id),ic.classList.add(rb.a.L0d),sd){case 1:ic.classList.add(rb.a.vzf);break;case 0:ic.classList.add(rb.a.wzf)}ie||ic.classList.remove(rb.a.L0d,rb.a.wzf,rb.a.vzf);this.u1a.INa(3)}}nIf(ic=!1){return this.vdf.Pdm(this.oh,u.AFrameworkApplication.va.mode,yc=>!this.Ri.S0b||!ic||this.Cta(yc))}PHf(ic){return this.vdf.kkm(this.Gj.model.xR(),u.AFrameworkApplication.va.mode,
ic)}SMf(ic){if(!ic||!ic.Mf)return ic;ic=ic.Mf;for(let yc=0;yc<this.oh.length;yc++)if(this.oh[yc].id===ic)return this.oh[yc];return null}kEl(){const ic=[];if(this.xd.isFeatureEnabled(110)){var yc=this.V8b.value;for(const bd of yc.UIi())(yc=this.Msi(bd))&&ic.push(yc)}return ic}A4m(ic){if(!this.Q1a)throw x.a.invalidOperation("UpdateContent must have been called before this.");for(let yc=0;yc<this.Q1a.length;yc++)if(this.Q1a[yc].id===ic)return yc;return-1}eSi(){const ic=new Sb.a;for(const bd of this.oh)if(bd.objectId&&
bd.LBa){var yc=w.a.Cf(bd.objectId);if((yc=this.td.Eb(yc))&&yc.hasProperty(mb.a.MG))if(yc=yc.getValue(mb.a.MG).toString(),ic.mb(yc)){const sd=ic.J(yc).CommentId;this.mhk(sd,bd,yc)}else ic.add(yc,new z(bd.id,bd.done))}this.yAd=ic}mhk(ic,yc,bd){ic!==yc.LBa?(X.ULS.sendTraceTag(42866777,327,10,"Multiple comments contains the same DurableId [{0}]; ObjectId [{1}], GuardId [{2}], GuardId of existing entry: {3}",bd,yc.objectId,yc.LBa,ic),this.sJ.logKpiFailure(Ce.a.RLb,"MultipleCommentsWithSameDurableId",{isInternal:!0},
{name:Ce.a.QLb,isInternal:!0})):X.ULS.sendTraceTag(554297428,327,15,"Duplicate entry of same comment with DurableId [{0}], GuardId [{1}], ObjectId [{2}]",bd,yc.LBa,yc.objectId)}Msi(ic){const yc=this.fth.value;var bd=this.V8b.value;const sd=bd.qlc(ic);if(void 0===sd||null===sd)return X.ULS.sendTraceTag(592234717,3003,50,"GenerateTaskItemForTaskId was called with a taskId [{0}] that has no comment anchor id.",ic),null;bd=bd.SIi(ic);try{return yc.BKl(ic,sd.toString(),bd,this.yAd)}catch(ie){return X.ULS.sendTraceTag(42856716,
3003,10,"CreateTaskItemFromHistoryRecords Failed due to [{0}]",ie.message),null}}Uvi(ic=!1,yc=!1){const bd=new l.a,sd=yc?Xc.j():new Set;this.MHa.keys.forEach(ie=>{sd.has(ie)||ic&&this.MHa.J(ie)||bd.add(ie);return!0});return bd}j8d(){if(!this.oh)return 0;let ic=0;for(const yc of this.oh)yc.Mf||ic++;return ic}l9c(ic){var yc,bd;return(null===(bd=null===(yc=this.hz)||void 0===yc?void 0:yc.KA)||void 0===bd?void 0:bd.draftId)===ic}MVk(ic){var yc;if(ic.Nr===v.a.dE){if(this.Gj.mode=2,this.Xib=ic,this.lb.gb){var bd=
this.lb.gb.currentSelection;if(bd&&bd.Ra){bd=this.wzp(bd);for(var sd=0;sd<bd.length;sd++){var ie=bd.J(sd).node;if(!tb.ParagraphReader.Xb(ie)||!(-1!==bd.J(sd).cpBegin&&-1!==bd.J(sd).cpEnd||-1!==bd.J(sd).lk&&-1!==bd.J(sd).Ep))continue;var We=-1===bd.J(sd).cpBegin?bd.J(sd).lk:bd.J(sd).cpBegin;const Pe=-1===bd.J(sd).cpEnd?bd.J(sd).Ep:bd.J(sd).cpEnd,Re=w.a.create();this.Yn.vMa(ie,new ob.a(3,We,Pe,Re));this.J1.push(new pf(ie.id,Re));this.tWk(null===(yc=ic.KA)||void 0===yc?void 0:yc.draftId,ie,We,bd)}}}}else this.Jqg(ic);
bd=({index:yc}=this.eEe(ic)).returnValue;sd=null;if(!ic.Mf){ie=this.Uvi();ic.Nr!==v.a.dE&&(sd=this.eKm(ic),ie.remove(ic.objectId));ie=({index:We}=this.JAm(sd,ie)).returnValue;yc=-1<We?We:yc;We=0;if(ie)for(;yc<this.oh.length&&this.oh[yc].Mf;)yc++;if(!ie&&this.Ri.Pr&&ic.Nr===v.a.dE)for(ie=0;ie<yc;ie++)this.oh[ie].Mf||this.oh[ie].done||We++;this.Edp(ic,We)}bd&&(Array.insert(this.oh,yc,ic),this.qG&&ic.Nr!==v.a.dE&&(ic.Mf?this.qG.fireEvent(10,{comment:ic,changeType:"replyAdded"}):this.qG.fireEvent(11,
{comment:ic})),this.PVk(ic,sd))}wzp(ic){const yc=Oa.SelectionEditor.n4l(ic);yc&&(this.lb.Ic(yc),ic=yc);return ic}tWk(ic,yc,bd,sd){this.Ri.contentNavigationApiEnabled&&ic&&yc&&sd&&this.OOc.Vff({contentId:ic,containerContentType:0,sca:{Ad:bd,zP:yc.Uj}},{selection:sd})}PVk(ic,yc){if(this.Ri.contentNavigationApiEnabled&&ic&&!ic.Mf&&ic.Nr!==v.a.dE){var bd=this.td.Eb(ic.objectId);if(bd){var sd=Xc.k(bd,w.a.nil);sd=this.td.Eb(sd);sd=Cd.a.hBa(sd,bd.id,!1);(null===sd||void 0===sd?0:sd.Jb)&&(null===sd||void 0===
sd?0:sd.paragraph)?this.OOc.Vff({contentId:ic.id,containerContentType:0,sca:{Ad:sd.Jb.cp,zP:sd.paragraph.Uj}},{selection:yc}):X.ULS.sendTraceTag(520717896,327,10,`comment object id: ${bd.id},
        commentStartRangeObject Valid: ${!!sd},
        containingProperties Valid: ${!(null===sd||void 0===sd||!sd.Jb)},
        paragraph valid: ${!(null===sd||void 0===sd||!sd.paragraph)};
        Failed to add to ReviewSuggestionModel`)}}}Uza(ic){super.Uza(ic);this.Dyd.add(ic.id)}dDo(ic,yc){this.Ri.contentNavigationApiEnabled&&this.OOc.cDo(ic,yc)}Edp(ic,yc){this.Ri.Pr&&ic.Nr===v.a.dE&&ic.KA&&this.Laf.Z(ic.KA.draftId,yc)}oOm(ic){return this.Laf.J(ic)}bCj(ic){this.Laf.remove(ic)}ewm(ic){let yc=0,bd=0;for(let sd=0;sd<this.oh.length;sd++){if(this.oh[sd].id===ic.id){bd=sd;break}this.oh[sd].Mf||this.oh[sd].done||yc++}return{returnValue:bd,tjp:yc}}ZNf(ic){var yc=null,bd=this.td.Eb(ic);ic=
Cd.a.Cfa(bd,this.td,!0);bd=Cd.a.Cfa(bd,this.td,!1);ic&&bd&&(yc=Xa.SelectionFactory.se(ic.Jb.paragraph,ic.Jb.cp),yc=Xa.SelectionFactory.$y(yc,ab.a.Tc(bd.Jb.paragraph,bd.Jb.cp)));ic&&bd||this.sJ.logKpiFailure(Ce.a.RLb,"ParaNodeNotConnected",{isIntentional:!1,isInternal:!0});return yc}eKm(ic){ic=w.a.Cf(ic.objectId);return this.ZNf(ic)}Bsg(ic,yc){var bd=this.td.Eb(ic);if(bd){var sd=this.td.Eb(Xc.k(bd));bd=this.td.Eb(Xc.h(bd));if(sd===bd)for(bd=0;bd<sd.qa.length&&!sd.qa.J(bd).cqp(ic,yc);bd++);}}JAm(ic,
yc){let bd=-1;var sd=null;ic||(ic=this.lb.gb?this.lb.gb.currentSelection:null);if(!ic||!ic.Ra)return{returnValue:null,index:bd};const ie=this.aFi(ic.Ra);if(!ie)return{returnValue:null,index:bd};var We=Cd.a.Dxm(ie.iterator.currentNode,ic.Ra.cpBegin,this.Ri.Pr,yc);We&&(sd=this.e3(We.nk.toString()),We=Array.indexOf(this.oh,sd),sd=0<=We?sd:null,bd=0<=We?We+1:bd);sd||(ic=this.Svi(ie,ic.Ra,this.Ri.Pr,yc),sd=0<=ic?this.oh[ic]:null,bd=0<=ic?ic:bd);return{returnValue:sd,index:bd}}kmm(ic=null){var yc=null;
yc=this.lb.gb.currentSelection;return yc&&yc.Ra?this.tsm(yc.Ra,this.Ri.Pr,ic):null}aFi(ic){const yc=new yb.GraphIterator;yc.set(ic.node);return yc.tq()?cb.a.Ft(yc,yc.origin):null}tsm(ic,yc,bd=null){const sd=this.aFi(ic);ic=this.Svi(sd,ic,yc,bd);return-1<ic?this.oh[ic]:null}Svi(ic,yc,bd,sd=null){let ie=-1;if(ic)for(yc=yc.cpBegin;-1===ie&&ic.moveNext();)tb.ParagraphReader.Bh(ic.iterator)&&((yc=Cd.a.y2c(ic.iterator.currentNode,yc,bd,sd))&&(ie=Array.indexOf(this.oh,this.e3(yc.nk.toString()))),yc=0);return ie}CWi(ic){const yc=
ic.toString();return this.MHa.mb(yc)&&this.MHa.J(yc)||this.eMc.contains(ic)&&this.td.zla(ic)&&this.td.Eb(ic).ja(mb.a.Rea,!1)}dNj(ic,yc=!1){if(ic=this.z2c(ic))ic.v_f=!yc}U_f(ic){return this.MHa.mb(ic.toString())||this.eMc.contains(ic)&&this.td.zla(ic)&&!this.td.Eb(ic).ja(mb.a.XO,null)}Jqg(ic){!ic.objectId||ic.Mf||this.MHa.mb(ic.objectId)||this.MHa.add(ic.objectId,ic.done)}deleteComment(ic){ic&&!ic.Mf&&(this.Ri.Pr&&ic.Nr!==v.a.dE?this.MHa.remove(ic.objectId):ic.Nr===v.a.dE&&this.p5j());this.Dyd.remove(ic.id);
return super.deleteComment(ic)}zJf(ic){return ic&&ic.hasProperty(mb.a.MG)?ic.wf(mb.a.MG).toString():""}z2c(ic){if(!ic)return null;if(this.Ri.epb)return this.DF(ic);for(const yc of this.oh){const bd=this.td.Eb(w.a.Cf(yc.objectId));if(this.zJf(bd)===ic.toString())return ic=bd.wf(mb.a.NJ),this.DF(ic)}return null}Apg(ic,yc=!1){if(ic&&Cd.a.Gde(ic)&&this.xd.isFeatureEnabled(110)){const bd=this.zJf(ic);if(""!==bd){if(yc){let sd;if(this.yAd&&({value:sd}=this.yAd.Dc(bd,sd)).returnValue&&sd.ResolveState===
ic.ja(mb.a.Rea,!1))return}(ic=this.$Cb.J(Number.parseInvariant(bd)))&&this.qOd.add(ic)}}}nlo(ic){const yc=this.lIf(ic);let bd=!1;yc.bBe&&yc.r1d||(this.eMc.add(ic.id),bd=!0,this.gkj(ic));return bd}gkj(ic){A.a.z6(u.AFrameworkApplication.mc,()=>{this.Keg(ic);this.eMc.remove(ic.id);this.eMc.count||(this.cZb(),this.uL.Vvp())},"DelayLoadCommentNodeIntoModel")}Keg(ic){if(!this.Gj&&(X.ULS.sendTraceTag(525379406,327,10,"Comment Manager Not initialized"),this.zyd<this.drk)){this.zyd+=1;this.gkj(ic);X.ULS.sendTraceTag(525378784,
327,50,`Comment Node add Retry attempt ${this.zyd}`);return}const yc=this.U5d();yc.Yj(ic);if(yc.WA()){let bd;try{bd=this.FYd(yc)}catch(sd){X.ULS.$w(512553930,327,10,sd,"create comment from comment node failed")}if(!bd){X.ULS.sendTraceTag(512553929,327,15,`CommentNode Failed to add: ${null===ic||void 0===ic?void 0:ic.id}`);this.sJ.logKpiFailure(Ce.a.RLb,"CommentCreationFailed",{isInternal:!0},{name:Ce.a.QLb,isInternal:!0});return}this.Gj.aza(bd,null);2!==this.Gj.mode&&3!==this.Gj.mode&&(this.Gj.mode=
1);this.Apg(ic);this.TRn(bd);this.yak(bd)}else this.$Ec.push(ic);this.A1.m4("OnCommentNodeAdded",{lL:ic})}TRn(ic){this.Ri.Pr&&!this.Hj.kn&&this.uL.iB&&ic.Mf&&this.uL.iB.id===ic.Mf&&this.uL.notify(String.format(Box4Intl.Box4Strings.L_CommentReplyAdded,ic.author),!1)}lIf(ic){const yc=new hg;yc.Hqd=Xc.k(ic,w.a.nil);yc.t_c=Xc.h(ic,w.a.nil);ic=yc.Hqd.equals(w.a.nil);const bd=yc.t_c.equals(w.a.nil);ic||(yc.$Ia=this.td.Eb(yc.Hqd),yc.bBe=!!yc.$Ia&&yc.$Ia.isConnected);bd||(yc.zUa=this.td.Eb(yc.t_c),yc.r1d=
!!yc.zUa&&yc.zUa.isConnected);return yc}Pki(ic,yc){const bd=this.A4m(ic);-1!==bd&&Array.removeAt(this.Q1a,bd);yc||((ic=this.Msi(ic))?this.Q1a.push(ic):X.ULS.sendTraceTag(42870813,3003,10,"GenerateTaskItemForTaskId returned null"))}L0l(){for(const ic of this.qOd)this.Pki(ic,!1);this.qOd.clear();for(const ic of this.kaf)this.Pki(ic,!0);this.kaf.clear()}eEe(ic){var yc=this.oh.length,bd=!1;if(ic.Mf){var sd=(bd=this.DF(ic.Mf))&&bd.objectId?this.td.Eb(w.a.Cf(bd.objectId)):null;sd=!!sd&&sd.hasProperty(mb.a.aJa);
yc=Array.indexOf(this.oh,bd);bd=0>yc;for(yc+=1;yc<this.oh.length&&this.oh[yc].Mf===ic.Mf&&this.oh[yc]!==this.hz&&!(sd&&ic.date<this.oh[yc].date);)yc++}return{returnValue:!bd,index:yc}}Y0m(){const ic=new Ae(this.Kup,this.cZb),yc=Za.App.jf.Il;yc.Ve(40).fo(Object(Ec.a)(ic,ic.twl,"commentPropertyChanged"));yc.Ve(12).fo(Object(Ec.a)(ic,ic.Ewl,"commentTextChanged"));this.xd.isFeatureEnabled(110)&&yc.Ve(72).fo(Object(Ec.a)(ic,ic.Chp,"taskPropertyChanged"));ib.GraphTransactionManager.instance.Ava(ic,3)}C$i(ic){this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.EmptyCommentLogging",
!1)&&ic&&0!==ic.length&&(ic=D.a.Iqb(ic[0]),1<ic.ops.length||0===ic.ops.length||("\n"===ic.ops[0].insert&&(this.uNe+=1),3<this.uNe&&X.ULS.sendTraceTag(509437908,327,15,"comments content cleared. Potentially resulting in data loss")))}fpl(ic){if(ic&&this.ZNe.has(ic.id)){var yc=ic.usersByReactionType[1];for(let bd=0;yc&&bd<yc.length;bd++)if(yc[bd].UserId===this.N0)return;X.ULS.sendTraceTag(542765345,327,15,`Like by current user on Comment ${ic.objectId} removed by inbound changes`)}}Tup(ic,yc){this.ytl(yc);
const bd=this.Ri.Pr;bd&&this.oYm(yc)?(this.nPl(yc),this.Apg(ic),this.dzp(yc)):bd||this.Apg(ic,!0)}Mup(ic){const yc=new yb.GraphIterator;yc.set(ic);yc.zb(40);yc.ld(40);if(yc.currentNode){if(ic=this.e3(yc.currentNode.id.toString())){const bd={done:ic.done,text:ic.text};ic.text=this.uPb(yc);this.C$i(ic.text);!this.qG||this.hz&&this.hz.id===ic.id||this.qG.fireEvent(10,{comment:ic,Uij:bd})}}else X.ULS.sendTraceTag(592738053,327,15,"UpdateComment Unexpected Node Type: "+Ub.a[ic.type])}dzp(ic){if(!this.Hj.kn){var yc=
new Wb.a;this.rFe(ic,yc);0<yc.count&&Ma.b(yc)}}nPl(ic){const yc=new F.a(0,1,0,()=>{this.Lup(ic)},137,void 0,!0);u.AFrameworkApplication.mc.Zb(yc)}ytl(ic){var yc;null!==(yc=this.hz)&&void 0!==yc&&yc.KA&&this.hz.KA.sessionType!==I.a.metadata&&(yc=this.hz,ic.Mf||!ic.done||yc.Mf!==ic.id&&yc.id!==ic.id||(X.ULS.sendTraceTag(592188699,327,15,"Draft comment lost on parent resolve, DraftType: {0}",yc.Nr),this.sJ.logKpiFailure(Ce.a.eXd,"DraftCommentLostOnParentResolve",{isIntentional:!1,isInternal:!0},{name:Ce.a.SWd,
isIntentional:!1,isInternal:!0,isSessionEndingError:!1}),yc.Nr===v.a.dE?(this.Gj.clearSelection(),this.deleteComment(yc),this.selectComment(ic)):yc.Nr===v.a.ncl&&(yc.Nr=v.a.normal,yc.n_a=H.a.succeeded,this.Gj.Tnf())))}Nup(ic,yc){var bd;const sd=null===(bd=yc.KA)||void 0===bd?void 0:bd.draftId;if(this.Ri.epb){if(ic=ic.getValue(mb.a.MG).toString(),yc.id!==ic){if(!yc.Mf)for(bd=Array.indexOf(this.oh,yc)+1;bd<this.oh.length&&this.oh[bd].Mf===yc.id;bd++)this.oh[bd].Mf=ic;X.ULS.sendTraceTag(555044877,327,
50,"durable Id updated.");yc.id=ic;this.OGc.has(ic)&&this.OGc.delete(ic)}}else if(ic=ic.getValue(mb.a.NJ),yc.id!==ic){if(!yc.Mf)for(bd=Array.indexOf(this.oh,yc)+1;bd<this.oh.length&&this.oh[bd].Mf===yc.id;bd++)this.oh[bd].Mf=ic;yc.id=ic}sd&&this.dDo(sd,yc.id)}oYm(ic){return this.MHa.mb(ic.objectId)&&this.MHa.J(ic.objectId)!==ic.done}Lup(ic){this.MHa.Z(ic.objectId,ic.done);if(ic.done)if(this.uL.XAc(ic),this.Hj.kn)this.uL.rfd(ic,!0);else{var yc=new F.a(0,1,0,()=>{this.uL.rfd(ic,!0,!1);this.jLd.remove(ic.id)},
139);this.jLd.add(ic.id,yc);u.AFrameworkApplication.mc.Zb(yc);this.tA&&ic.id===(void 0===this.tA.Mf||null===this.tA.Mf?this.tA.id:this.tA.Mf)&&this.uL.clearSelection()}else this.uL.XAc(ic),yc=null,({value:yc}=this.jLd.Dc(ic.id)).returnValue?(u.AFrameworkApplication.mc.vf(yc),this.jLd.remove(ic.id)):this.uL.rfd(ic,!1)}dmj(){this.y6m();this.w6m();u.AFrameworkApplication.K.$("IsDocumentOwner")||y.a.instance.Qa("Common.ISystemInitiatedFeedback").execute(ic=>{ic.logActivity("ShowTUIForCommentAwareness",
null)})}w6m(){this.Ri.B1b&&this.eSi();this.Ri.B1b&&(this.Q1a=this.kEl(),Ne.a.PZa(this.Qoj))}y6m(){!this.Ri.lNb&&this.Ri.Pr&&wd.a.PZa(this.Ted);this.Y0m();this.X0m()}X0m(){const ic=new ci(this.M0l),yc=Za.App.jf.Il;yc.Ve(39).fo(Object(Ec.a)(ic,ic.c5h,"commentContainerPropertyChanged"));this.xd.isFeatureEnabled(110)&&yc.Ve(71).fo(Object(Ec.a)(ic,ic.c5h,"commentContainerPropertyChanged"));ib.GraphTransactionManager.instance.Ava(ic,3)}e3(ic){for(let yc=0;yc<this.oh.length;yc++){const bd=this.oh[yc];if(bd.objectId===
ic)return bd}return null}ZZk(ic){if(ic)for(const yc of ic)yc&&this.GHd.add(yc)}Hrl(){this.GHd.clear()}Ief(ic,yc){Array.insert(this.oh,yc,ic);this.Jqg(ic);this.kCn(ic);yc=this.x6d(ic);this.GHd.contains(yc)&&(ic.v_f=!0,this.GHd.remove(yc))}yak(ic){Xc.q(ic)||X.ULS.sendTraceTag(512278912,327,15,`Missing Start or End mapping info for Comment ${ic.objectId}`)}kCn(ic){X.ULS.sendTraceTag(539800645,327,50,`Comment added to Model. ${Xc.a(ic)} `)}FYd(ic){40!==ic.lf&&X.ULS.sendTraceTag(594363294,327,15,"[CreateCommentForNode] Iterator is not at commentNode");
const yc=ic.currentNode;var bd=yc.getValue(mb.a.PLb),sd=yc.getValue(mb.a.NJ);const ie=yc.getValue(mb.a.MG).toString(),We=yc.getValue(mb.a.hfc);let Pe=null,Re=null;if(yc.hasProperty(mb.a.WT)){var Sf=yc.getValue(mb.a.WT);Pe=Sf?Zc.b(Sf||""):null;Dd.a.T1h(Pe)}yc.hasProperty(mb.a.aJa)&&(Re=yc.getValue(mb.a.aJa));let vg=null,Yg=null;yc.hasProperty(mb.a.PWd)&&yc.hasProperty(mb.a.jWc)&&(vg=yc.getValue(mb.a.PWd),Yg=yc.getValue(mb.a.jWc));Sf=Xc.k(yc,w.a.nil).toString();const ph=Xc.h(yc,w.a.nil).toString(),
Di=yc.ja(mb.a.Rea,!1),bj=yc.ja(mb.a.XO,null),gi=yc.ja(mb.a.Prb,!1);let Zg;this.e0j&&yc.attrString?(sd=this.QEl(yc.attrString),Zg=sd.paragraphs,sd=sd.LBa.toString()):Zg=this.uPb(ic);bd=new N.Comment(this.Ri.epb?ie:sd,sd,bd,Re||new Date(We),this.Ri.epb?this.yyd.Ixi(bj):bj,Di,Zg,N.Comment.Uqj,gi,Yg,vg,Pe);bd.cTc=Sf;bd.bTc=ph;bd.objectId=yc.id.toString();bd.a8a=ie;this.gNh(ie,sd);ic.ld(39);return bd}QEl(ic){let yc=ic.J9l(new lb.a(0));const bd=new D.a;let sd=0;for(;yc&&!yc.fIe();){let Pe=void 0;yc.C_i||
(Pe=ic.kD(yc));var ie=ic.pla(yc.Ire),We=ie&&ie.properties["2"];const Re=new M.a;if("para"==We)sd=null===ie||void 0===ie?void 0:ie.properties["5417"];else if(!We){Re.weight=(null===ie||void 0===ie?0:ie.properties["1436"])?D.a.Idd:0;Re.italic=(null===ie||void 0===ie?0:ie.properties["1440"])?!0:!1;Re.underline=(null===ie||void 0===ie?0:ie.properties["1484"])?!0:!1;Re.strikethrough=(null===ie||void 0===ie?0:ie.properties["1448"])?!0:!1;if(We=null===ie||void 0===ie?void 0:ie.properties["1482"])Re.highlight=
We;if(ie=null===ie||void 0===ie?void 0:ie.properties["1466"])Re.color=ie;bd.mWf(Pe,Re);bd.Ila("\n")}yc=ic.ABm(yc)}return{LBa:sd,paragraphs:[bd.Ujc()]}}gNh(ic,yc){(!ic||Number.parseInvariant(ic)>=Cd.a.Vcj)&&X.ULS.sendTraceTag(544022547,327,10,`Durable Id is invalid ${ic}`);yc||X.ULS.sendTraceTag(544022548,327,10,`Guard Id is invalid ${yc}`);try{this.yyd.JVk(ic,yc)}catch(bd){"DuplicateDurableId"===bd.message?X.ULS.sendTraceTag(544511521,327,10,`Duplicate Durable Id: ${ic} with Guard Id: ${yc}`):"DuplicateGuardId"===
bd.message?X.ULS.sendTraceTag(544511522,327,10,`Duplicate GuardId: ${yc} with Durable Id: ${ic}`):X.ULS.sendTraceTag(544022549,327,10,`Unkown Error when adding to CommentIds map: ${bd}`)}}uPb(ic){var yc;if(40!==ic.lf)return X.ULS.sendTraceTag(594379426,327,15,"Trying to get text from node of type: {0}",ic.lf),this.t5b.dJg([]);let bd=ic.lf+":";const sd=ic.Dq();0<sd?(ic.Xd(),bd+=ic.lf+":"):(X.ULS.sendTraceTag(509642946,327,15,`Comment has no paragraphs. ${null===(yc=ic.currentNode)||void 0===yc?void 0:
yc.id}`),yc=new Yb.a,yc.inStaging=!0,this.sJ.logKpiFailure(Ce.a.RLb,"CommentContentNotFound",{isIntentional:!1,isInternal:!0},{name:Ce.a.SWd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:yc},Qd.a));yc=Array(sd);for(let ie=0;ie<sd;ie++){ic.Xd();bd+=ic.lf+":";const We=ic.currentNode;We.LSb=!0;yc[ie]=We;We.qa||X.ULS.sendTraceTag(594363293,327,15,"[GetCommentText_Crash] "+bd);!We.qa&&this.Ri.hOo&&this.qq();ic.uc();ic.Fk();bd+=ie<sd-1?":"+ic.lf+":":":"}return this.t5b.dJg(yc)}qq(){if(cc.WoncaApp.OCe){var ic=
new Gc.a(!0,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportTitle,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportDescription,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportPrivacyStatement);ic.Gd=1;ic.Pe(1,WoncaIntl.WoncaStrings.l_SendErrorReport);ic.Pe(0,WoncaIntl.WoncaStrings.l_NoThanks);ic.uY(1);ic.Gy(Ya.a.Wsf,CommonUIStrings.l_DefaultDialogTitle,WoncaIntl.WoncaStrings.l_InboundingCommentFailed,this.iTl,!1)}else this.W1.jK(Ya.a.Wsf,this.l5i)}x6d(ic){if(!ic||!ic.objectId)return"";
ic=w.a.Cf(ic.objectId);ic=this.td.Eb(ic);return this.zJf(ic)}VEm(ic){return this.x6d(ic.Mf?this.DF(ic.Mf):ic)}jro(ic,yc){if(this.xd.isFeatureEnabled(110))if(this.Ri.fha)X.ULS.sendTraceTag(595128897,3003,50,"RecordTaskChanges no ops because filter PII flag on"),this.cZb();else{this.p5a.Vw(ub.a.LBg);var bd=null===yc||void 0===yc?void 0:yc.taskId,sd=!bd;sd?this.p5a.logKpiUsage(Lf.a.vCe,0):this.p5a.logKpiUsage(Lf.a.wCe,0);try{const Sf=this.V8b.value,vg=this.x6d(ic);if(""===vg)this.$ie(sd,"FailedDurableIdForComment");
else{var ie=this.VEm(ic);if(""===ie)this.$ie(sd,"FailedDurableIdForParentComment");else if(sd&&ic.KA.sessionType!==I.a.create&&ic.KA.sessionType!==I.a.reply)X.ULS.sendTraceTag(42856725,3003,10,"Unexpected create task for drafting session type [{0}]",ic.KA.sessionType),this.p5a.logKpiFailure(Lf.a.vCe,"FailedTaskCreateInvalidSessionType");else{var We=null;ic.KA.sessionType!==I.a.metadata&&(We=vg);var Pe=this.fth.value;var Re=U.a.Tf(ic.text)?Pe.xsi(We,yc,sd):Pe.xsi(We,yc,sd,ic.text[0]);0<Re.length?sd?
(Sf.eob(Number.parseInvariant(ie),Re)||this.p5a.logKpiFailure(Lf.a.vCe,"TaskCreateFailed"),this.cZb()):(this.p5a.logKpiUsage(Lf.a.wCe,0),Sf.W6k(bd,Re)||this.p5a.logKpiFailure(Lf.a.wCe,"TaskEngagementFailed")):this.$ie(sd,"HistoryRecordsLengthZero")}}}catch(Sf){this.$ie(sd,"RecordTaskChangesFailed")}}}$ie(ic,yc){const bd={name:Lf.a.uhp,isInternal:!0};ic?this.p5a.logKpiFailure(Lf.a.vCe,yc,bd):this.p5a.logKpiFailure(Lf.a.wCe,yc,bd)}aRd(ic,yc){if(ic){var bd=u.AFrameworkApplication.userName,sd=yc.toString();
ic.usersByReactionType||(ic.usersByReactionType={});var ie=ic.usersByReactionType[sd];bd=new V(this.N0,this.Lcb,bd);bd.DateUtc=new Date;ie?ie.push(bd):ic.usersByReactionType[sd]=[bd];X.ULS.sendTraceTag(572014993,327,50,"Reaction type {0} added to {1} with Object Id: {2} ",yc,ic.Mf?"reply":"parent",ic.objectId);sd=[ic];this.sJ.Vw(kb.a.uwl,{succeeded:!0,Yl:{reactionType:Y[yc]}});this.Rjd(sd,Q.uOh);this.ZNe.add(ic.id)}}oue(ic,yc){if(ic&&ic.usersByReactionType){var bd=ic.usersByReactionType[yc.toString()];
if(bd&&bd.length){for(let sd=0;sd<bd.length;sd++)if(bd[sd].UserId===this.N0){Array.removeAt(bd,sd);break}X.ULS.sendTraceTag(572014994,327,50,"Reaction type {0} removed from {1} with Object Id: {2} ",yc,ic.Mf?"reply":"parent",ic.objectId);bd=[ic];this.sJ.Vw(kb.a.wwl,{succeeded:!0,Yl:{reactionType:Y[yc]}});this.ZNe.delete(ic.id);this.Rjd(bd,Q.VCj)}}}Rjd(ic,yc){const bd=this.Pc.Mc(15);bd.Ab(this.d1a);this.lv.YG.laa(3);switch(yc){case Q.deleteComment:for(yc=0;yc<ic.length;yc++){var sd=ic[yc];if(sd.Nr===
v.a.dE)this.Ri.contentNavigationApiEnabled&&this.OOc.remove(sd.KA.draftId),this.uL.dMg();else{var ie=w.a.Cf(sd.objectId);(ie=this.td.Eb(ie))&&Cd.a.o_d(ie,this.td);X.ULS.sendTraceTag(39364559,327,50,`Deleting Comment: [CommentObjectId:${sd.objectId}]`);this.qG&&(sd.Mf?this.qG.fireEvent(10,{comment:sd,changeType:"replyDeleted"}):this.qG.fireEvent(7,{comment:sd}));this.Ri.contentNavigationApiEnabled&&this.OOc.remove(sd.id);this.Ri.grl&&!this.PBa()&&this.A1.m4("OnCommentNodeDeleted",{lL:ie})}}break;case Q.aza:this.Gj.mode=
1;ic=ic[0];ic.date=new Date;yc=this.SHl(ic);sd=yc.getValue(mb.a.MG).toString();ic.a8a=sd;this.Ri.epb&&this.OGc.set(sd,ic.id);sd=ic.text;ie=this.U5d();if(ic.Mf){var We=this.DF(ic.Mf),Pe=this.td.Eb(w.a.Cf(We.objectId));yc.setValue(mb.a.XO,Pe.getValue(mb.a.NJ));this.$lb(yc,sd,this.td,ie,Pe);X.ULS.sendTraceTag(39364560,327,50,`Adding Reply: [ObjectId:${ic.objectId}][ParentObjectId:${We.objectId}]`)}else(We=this.lb.gb.currentSelection)&&We.Ra&&(Oa.SelectionEditor.Dm(We)&&(Pe=Oa.SelectionEditor.i7(We.Ra,
!1))&&(this.lb.Ic(Pe),We=Pe,X.ULS.sendTraceTag(592569872,327,50,"[RecordChanges] Selection extended")),tb.ParagraphReader.Xb(We.Ra.node)&&tb.ParagraphReader.Xb(We.Uc.node)&&(this.VJb(yc,sd,ie,We),X.ULS.sendTraceTag(39364561,327,50,`Adding Comment: [ObjectId:${ic.objectId}]`)));sd=yc.ja(mb.a.NJ,null);ic.LBa=sd;ic.n_a=H.a.YLj;ic.n_a=H.a.succeeded;ic.objectId=yc.id.toString();this.Jqg(ic);this.yak(ic);this.gNh(ic.a8a,ic.LBa);this.qG&&(ic.Mf?this.qG.fireEvent(10,{comment:ic,changeType:"replyAdded"}):
this.qG.fireEvent(11,{comment:ic}));break;case Q.Pob:this.Gj.mode=1;ic=ic[0];yc=w.a.Cf(ic.objectId);yc=this.td.Eb(yc);sd=ic.LBa;ic.LBa||(sd=yc.getValue(mb.a.NJ),X.ULS.sendTraceTag(554446870,327,15,`Missing GuardID for Comment with objectId ${ic.objectId} while editing`),sd=this.Ri.epb?sd:ic.id);this.D6j(yc,ic.text,sd);X.ULS.sendTraceTag(39364562,327,50,`Editing Comment: [CommentObjectId:${ic.objectId}]`);ic.n_a=H.a.YLj;ic.n_a=H.a.succeeded;this.qG&&this.qG.fireEvent(10,{comment:ic,changeType:ic.Mf?
"replyEdited":"edited"});break;case Q.uOh:case Q.VCj:yc=ic[0];ic=w.a.Cf(yc.objectId);ic=this.td.Eb(ic);(yc=(yc=yc.usersByReactionType)?Zc.c(yc):"")&&ic.setValue(mb.a.WT,yc);break;case Q.done:case Q.zrp:for(yc=0;yc<ic.length;yc++)sd=ic[yc],ie=w.a.Cf(sd.objectId),this.td.Eb(ie).setValue(mb.a.Rea,sd.done),X.ULS.sendTraceTag(594124932,327,50,`${sd.done?"Resolved":"Re-opened"} Comment: [CommentObjectId:${sd.objectId}]`),this.qG&&this.qG.fireEvent(10,{comment:sd,changeType:sd.done?"resolved":"reopened"})}this.Fn.$G();
X.ULS.sendTraceTag(572281361,327,50,"Disposing transaction, should raise context reload event");bd.dispose()}U5d(){const ic=new yb.GraphIterator;ic.set(this.lv);this.cJa.Kbb(ic);return ic}knd(){return this.KKj(!0)}lnd(){return this.KKj(!1)}KKj(ic){if(!this.oh.length)return null;let yc=this.tA;do{if(yc){const bd=this.Ri.Pr&&!this.Hj.kn;yc=ic?this.rsm(yc,bd):this.ssm(yc,bd)}else yc=ic?this.oh[0]:this.oh[this.oh.length-1];if(!yc)return null}while(yc.Mf&&""!==yc.Mf);this.selectComment(yc);return yc}S9h(ic,
yc,bd,sd,ie){const We=this.erk.create(Ua.a.lL);this.Ri.fha&&(yc=CommonUIStrings.l_RemovedAuthorName,bd=null);We.setValue(mb.a.commentId,S.a.VF());We.setValue(mb.a.MG,Cd.a.yJf());We.setValue(mb.a.AUa,u.AFrameworkApplication.userSessionId);We.setValue(mb.a.NJ,ic);We.setValue(mb.a.PLb,yc);We.setValue(mb.a.Eqf,yc);We.setValue(mb.a.hfc,bd?P.a.J4d(bd,"MM/dd/yyyy HH:mm:ss",P.a.dataCulture):"");We.setValue(mb.a.aJa,bd);We.setValue(mb.a.Rea,sd);ie&&(ic=ie?Zc.c(ie):"",We.setValue(mb.a.WT,ic));We.setValue(mb.a.jWc,
this.N0);We.setValue(mb.a.PWd,this.Lcb);return We}SHl(ic){var yc;const bd=this.S9h(ic.id,ic.author,ic.date,ic.done,null!==(yc=ic.usersByReactionType)&&void 0!==yc?yc:{});ic.Mf&&(this.Ri.epb?((yc=this.yyd.ium(ic.Mf))||X.ULS.sendTraceTag(555008772,327,10,`Missing guardId for Comment With Durable Id ${ic.Mf}`),ic=yc):ic=ic.Mf,bd.setValue(mb.a.XO,ic));return bd}$lb(ic,yc,bd,sd,ie){this.aza(ic,yc,sd);yc=Vf.zOh(ic,bd,ie,!0);bd=Vf.zOh(ic,bd,ie,!1);yc&&Xc.w(ic,yc.Jb.paragraph.id);bd&&(Xc.v(ic,bd.Jb.paragraph.id),
bd.Jb.paragraph.id||X.ULS.shipAssertTag(5564303,327,!1,"Comment node has no end anchor!"))}VJb(ic,yc,bd,sd){this.aza(ic,yc,bd);let ie,We;({start:yc,end:ie,startCp:bd,endCp:We,rUh:Pe}=this.Oil());Pe&&(sd.Ra.node===yc&&(bd=Qb.a.Gqb(sd,!0)),sd.Uc.node===ie&&(We=Qb.a.Gqb(sd,!1)));if(-1===bd||-1===We){this.unh||0!==this.A6b||(this.sJ.logKpiFailure(Ce.a.Kqf,"DraftSelectionLost",{isInternal:!0},{name:Ce.a.QLb,isInternal:!0}),this.unh=!0);yc=sd.Ra.node;bd=Qb.a.Gqb(sd,!0);ie=sd.Uc.node;We=Qb.a.Gqb(sd,!1);
if(2<sd.length){var Pe=[];for(let Re=0;Re<sd.length;Re++)Pe.push(sd.J(Re).node.id);this.bOh(ic,Pe)}X.ULS.sendTraceTag(51233603,327,50,"Intents invalid reason {0}",this.A6b)}else if(2<this.J1.length){Pe=[];for(sd=0;sd<this.J1.length;sd++)Pe.push(this.J1[sd].rwb);this.bOh(ic,Pe)}Cd.a.scc(yc,ic.id,bd,!0);Cd.a.scc(ie,ic.id,We,!1);Xc.w(ic,yc.id);Xc.v(ic,ie.id);this.p5j();ie.id||X.ULS.shipAssertTag(5564304,327,!1,"Comment node has no end anchor!")}bOh(ic,yc){if(!(2>=yc.length||!ic||Xc.t(ic))){this.Hj.XX.add(ic.id,
new Xb.a(new fc.a));for(var bd=w.a.Bt(yc[0],yc[1])?2:1,sd=yc.length-2;bd<=sd;bd++){const ie=yc[bd];this.Hj.rz.mb(ie)?this.Hj.rz.J(ie).DP||(this.Hj.rz.J(ie).DP=new Xb.a(new fc.a)):this.Hj.rz.add(ie,new uf.a(!0));this.Hj.rz.J(ie).d$a=!0;this.Hj.rz.J(ie).DP.add(ic.id);this.Hj.XX.J(ic.id).add(ie)}}}Oil(){let ic=null,yc=-1,bd=null;var sd=-1;let ie=!1;if(!this.J1.length||2!==this.A6b)return{start:ic,end:bd,startCp:yc,endCp:sd,rUh:ie};ic=this.td.Eb(this.J1[0].rwb);bd=1===this.J1.length?ic:this.td.Eb(this.J1[this.J1.length-
1].rwb);if(tb.ParagraphReader.Xb(ic)&&tb.ParagraphReader.Xb(bd)){sd=Pe=>3===Pe.type;let We=this.Yn.fWa(ic,3,sd);yc=0<We.count?We.J(0).Fc:-1;ic!==bd&&(We=this.Yn.fWa(bd,3,sd));sd=0<We.count?We.J(0).end:-1;-1===yc&&null!=ic&&(yc=ic.qa.first.cp,ie=!0,X.ULS.sendTraceTag(524862562,327,50,"Draft Anchor startCp was adjusted"));-1===sd&&null!=bd&&(sd=bd.qa.last.cp,ie=!0,X.ULS.sendTraceTag(524862563,327,50,"Draft Anchor endCp was adjusted"))}this.A6b=-1===yc||-1===sd?0:2;return{start:ic,end:bd,startCp:yc,
endCp:sd,rUh:ie}}p5j(){for(const ic of this.J1){const yc=this.td.Eb(ic.rwb);tb.ParagraphReader.Xb(yc)&&this.Yn.G0a(yc,3)}this.J1=[];this.A6b=2}aza(ic,yc,bd){ic.anchor||(bd.Uf(ic,1),bd.Yj(ic),this.eNj(ic,yc,bd))}eNj(ic,yc,bd){let sd=0;var ie=null;if(this.e0j){var We=this.t5b.pkp(yc);const Pe={2:"para"};Pe["1035"]=ic.getValue(mb.a.PLb);Pe["1036"]=ic.getValue(mb.a.hfc);Pe["1037"]=ic.getValue(mb.a.commentId);Pe["5523"]=ic.getValue(mb.a.Eqf);We.ASc(new vb.b("comment",new lb.a(We.getLength()),new Ia.b(Pe)));
ic.textblocks=[new qb.JsonContent(We.serialize(()=>""))]}yc=this.t5b.wkp(yc,Pe=>{const Re=new Fc.a;bd.Uf(Re,1);bd.Yj(Re);bd.Uf(Pe,2);bd.Yj(Pe);bd.uc();bd.uc()});for(We=0;We<yc.length;We++)ie=yc[We],sd=ie.getValue(mb.a.Yc),Vf.rl.N0a(ie),Vf.AM&&Vf.AM.kUa&&Vf.AM.mOa(ab.a.create(ie));ic.setValue(mb.a.NJ,sd.toString());return ie}Tsb(ic,yc){return this.Hdn(ic,yc)}yYm(){return 0<this.J1.length}Wfc(ic,yc,bd){return ic.Ra&&tb.ParagraphReader.Xb(ic.Ra.node)&&tb.ParagraphReader.Xb(ic.Uc.node)?(yc=this.S9h(tb.ParagraphReader.vU(ic.Uc.node).toString(),
yc?yc:u.AFrameworkApplication.userName,new Date,!1,{}),bd||(bd=new D.a,bd.Ila("\n")),this.VJb(yc,[bd.Ujc()],this.U5d(),ic),yc):null}Et(ic){return!this.vdf.ICg(this.z2c(ic.getValue(mb.a.MG)))}D6j(ic,yc,bd){const sd=new yb.GraphIterator;for(sd.set(ic);sd.Xd();)sd.eh();this.eNj(ic,yc,sd).Kg(mb.a.Yc,Number.parseInvariant(bd));ic.setValue(mb.a.NJ,bd);if(yc=this.e3(ic.id.toString()))yc.n7h=!1;ic.setValue(mb.a.Prb,!1)}C6j(ic,yc){this.D6j(ic,[Sys.Serialization.JavaScriptSerializer.serialize(yc)],ic.getValue(mb.a.NJ))}yI(ic){ic=
this.td.Eb(w.a.Cf(ic));return!!ic&&ic.ja(mb.a.yI,!1)}stj(ic){ic=this.td.Eb(w.a.Cf(ic));return!!ic&&ic.ja(mb.a.V6h,!1)}Bfn(ic){const yc=Xc.j();return ic&&yc.has(ic.objectId)}imn(ic){const yc=this.td.Eb(w.a.Cf(ic));return yc?this.Goc(yc):(X.ULS.sendTraceTag(562562755,341,15,"CommentNode is null, commentObjectId: "+ic),!1)}Goc(ic){var yc=ic.id,bd=Xc.k(ic),sd=Xc.h(ic);if(!w.a.Bt(bd,sd))return!1;bd=ic.Lc.Eb(bd);if(!bd)return!1;sd=({xVc:ic}=this.qXc(bd,yc,!0)).returnValue;var ie=({xVc:yc}=this.qXc(bd,yc,
!1)).returnValue;if(-1===sd||-1===ie)return!1;bd=bd.qa;sd=bd.J(ic);ie=bd.J(yc);if(!sd.hyperlink||!sd.hyperlink.wI||!ie.vn)return!1;for(ic+=1;ic<yc;ic++)if(sd=bd.J(ic),sd.hyperlink||sd.vn)return!1;return!0}U5c(){return Vf.JYm(this.oh,ic=>this.yI(ic),ic=>this.stj(ic))}qXc(ic,yc,bd){let sd;for(sd=0;sd<ic.qa.length;sd++){const ie=ic.qa.J(sd);if(ie.kf)for(let We=0;We<ie.kf.length;We++){const Pe=ie.kf.J(We);if(Pe.nk.equals(yc)&&Pe.Wc===bd)return{returnValue:ie.cp,xVc:sd}}}return{returnValue:-1,xVc:sd}}Nei(ic){if(this.Hj.XX.mb(ic)){const yc=
new Wb.a;for(const bd of this.Hj.XX.J(ic))this.Gxo(bd,ic,yc);this.Hj.XX.remove(ic);Ma.b(yc)}}rFe(ic,yc){if(ic.objectId){ic=w.a.Cf(ic.objectId);var bd=this.td.Eb(ic);if(bd){var sd=Xc.k(bd,w.a.nil);bd=Xc.h(bd,w.a.nil);sd.equals(w.a.nil)||yc.add(this.td.Eb(sd));bd.equals(w.a.nil)||yc.add(this.td.Eb(bd));if(this.Hj.XX.mb(ic))for(const ie of this.Hj.XX.J(ic))yc.add(this.td.Eb(ie))}}}Gxo(ic,yc,bd){let sd;({value:sd}=this.Hj.rz.Dc(ic,sd));sd&&(sd.DP.remove(yc),sd.DP.count||(sd.d$a=!1,bd.add(this.td.Eb(ic))))}static get rl(){return null!=
Vf.V2g?Vf.V2g:Vf.V2g=y.a.instance.resolve("Box4.IParagraphEditor")}static getInstance(){return Vf.Qm()}static Qm(){if(Vf._instance)return Vf._instance;const ic=new T.a(()=>(new nb(!0,!0,!0)).lEl()),yc=y.a.instance;Vf._instance=new Vf(new T.a(()=>nc.StaticActiveAppFrame.za().ib.$c),new T.a(()=>nc.StaticActiveAppFrame.za().ib.sc.jd),new T.a(()=>Pf.a.instance),new zb.a,new qe,new T.a(()=>Vb.a.instance),yc.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),yc.resolve("WordEditor.Comments.ICommentFormatTranslator"),
yc.resolve("Common.IAppSettingsManager"),yc.resolve("Box4.IFeatureHelper"),yc.resolve("Box4.Intent.IIntentRangeEditor"),new T.a(()=>Za.App.uV),yc.resolve("Box4.IKickoutExecutor"),yc.rf("WordEditor.Tasks.ITaskActor"),ic,yc.resolve("WordEditor.Comments.CommentsSettings"),yc.resolve("Box4.IUndoManager"),yc.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),yc.resolve("WordEditor.Comments.CommentsState"),yc.resolve("WordEditor.Comments.WordCommentEventsActor"),yc.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),
yc.resolve("WordEditor.Comments.ITasksUsageAndHealthLogger"),yc.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentModel"),Za.App.jf.Il.Ve(12),yc.resolve("Box4.ParagraphRenderEvents"),yc.resolve("Box4.CatchUpActivity.IChangeIdEditor"),yc.Qa("WordEditor.Extension.RichApiEventManager"));return Vf._instance}static zOh(ic,yc,bd,sd){yc=Cd.a.Cfa(bd,yc,sd);if(!yc)return null;yc=yc.Jb.kf;return Cd.a.$Qd(ic.id,yc,yc.J(0).Fv,sd)}Hdn(ic,yc){if(Za.App.SU||(yc?!Za.App.Et:!Za.App.Et&&!Za.App.pn)||
1===ic.mode||!Object(Hb.a)(me.MainView,Object(rc.a)().zd))return!1;ic=this.Fhm();return!ic||pb.a.instance.Q2(ic)||pb.a.instance.Vla(ic)||ic.contextId===bb.a.caa||Pb.a.gZf(ic)&&Pb.a.hoc()?!1:!0}Fhm(){const ic=Object(rc.a)().zd;var yc=ic.lb.Og;this.hz&&Oc.n(yc.node)&&(yc=yb.GraphIterator.eb(yc.node),yc.zb(12),yc=yc.yp(12),yc=Xa.SelectionFactory.Gra(yc),ic.lb.Ic(yc),yc=ic.lb.Og);return yc}static JYm(ic,yc,bd){const sd=new Wb.a,ie=new Wb.a,We=new Sb.a,Pe=new Sb.a;for(const vg of ic){var Re=vg.id,Sf=vg.objectId;
ic=vg.done;const Yg=!!Sf&&yc(Sf);Re&&(ic&&sd.add(Re),Yg&&ie.add(Re),Sf&&We.Z(Re,Sf));if(Re=vg.Mf)({value:Sf}=Pe.Dc(Re,0)).returnValue||(Sf=0),Pe.Z(Re,Sf+1);if(!Re&&!ic&&!Yg)return!0}for(const vg of ie){if(sd.contains(vg))continue;let Yg;if(({value:Yg}=We.Dc(vg,Yg)).returnValue&&bd(Yg))return!0;let ph;if(({value:ph}=Pe.Dc(vg,0)).returnValue&&0<ph)return!0}return!1}emm(ic){const yc=[];let bd=this.oh.findIndex(sd=>sd.id===ic);if(-1<bd)for(yc.push(this.oh[bd]);++bd<this.oh.length&&this.oh[bd].Mf===ic;)yc.push(this.oh[bd]);
return yc}qqm(ic){return this.yyd.Ixi(ic)}}Vf._instance=null;Vf.AM=null;Object(m.a)(Vf,"EditorCommentModel",f.a,[656,657,658])},1878:function(G,J,d){G=d(0);var m=d(417),f=d(123),a=d(47),l=d(321),w=d(3),y=d(7),v=d(15),u=d(1700),x=d(1658);class z{constructor(Z,X,aa=!1){this.paragraphNode=Z;this.role=X;this.fWj=aa}}Object(G.a)(z,"DesignerReviewActionData",null,[]);class A{constructor(Z,X,aa){this.paragraphNode=Z;this.vr=X;this.role=aa}}Object(G.a)(A,"TriageActionData",null,[]);class D extends A{constructor(Z,
X){super(Z,0,X)}}Object(G.a)(D,"RoleTriageActionData",A,[]);class F extends A{constructor(Z,X,aa){super(Z,1,27);this.styleId=X;this.v_=aa}}Object(G.a)(F,"PullQuoteTriageActionData",A,[]);class I extends A{constructor(Z,X){super(Z,2,28);this.kta=X}}Object(G.a)(I,"ImageTriageActionData",A,[]);class H{constructor(Z,X){this.paragraphNode=Z;this.QTb=X}}Object(G.a)(H,"ViewOriginalActionData",null,[]);var N=d(151),M=d(1598),U=d(1799);class O{constructor(Z,X){this.currentNode=Z;this.nextNode=X}}Object(G.a)(O,
"ReviewNavigationArgs",null,[]);class V{constructor(Z,X){this.paragraphNode=Z;this.isVisible=X}}Object(G.a)(V,"ReviewVisibilityArgs",null,[]);class Y{constructor(Z){this.nMk=Z}getSelectedOption(){return this.nMk}getSeparatorIndexes(){return[1]}}Object(G.a)(Y,"DesignerPreviewData",null,[]);var Q=d(547),S=d(1016),P=d(1800);d.d(J,"a",function(){return T});class T extends S.a{constructor(Z,X,aa,ia,wa,ma,na,Fa,Qa,ya,ta,Aa){super();this.Sb=Z;this.$d=X;this.D_d=aa;this.G7=ia;this.Dg=wa;this.FD=ma;this.G2j=
na;this.Rm=Fa;this.Lw=Qa;this.E_d=ya;this.Ht=ta;this.cGf=Aa;this.ylb=null;this.lxd=void 0;this.zOe=0;this.FJ=[Q.a.ofi]}get types(){return this.FJ}get cLj(){return Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress}get Xqe(){return 0}a4o(Z){return 3!==Z.suggestion.vr&&!this.Lw.isVisible&&(!this.zOe||!Z.rKb&&1===this.zOe)}GS(Z){var X;if(!Z.source||m.SessionStatusManager.instance.Gk)return!1;const aa=Z.jn;var ia=this.G7.G3c(aa,1);if(!ia||!ia.count)return!1;const wa=ia.J(0).intent;if(Z.ryc)return.5!=
(null===wa||void 0===wa?void 0:wa.state)&&4!=(null===wa||void 0===wa?void 0:wa.state);const ma=aa.node;if(0==(null===wa||void 0===wa?void 0:wa.state)&&(2==(null===wa||void 0===wa?void 0:wa.suggestion.vr)||1==(null===wa||void 0===wa?void 0:wa.suggestion.vr)))return wa.rKb(),this.G7.G0a(ma,1),this.FD.Zxj(new U.a(ma,1)),!0;if(1==Z.source&&27==(null===wa||void 0===wa?void 0:wa.tsb)&&(.5==(null===wa||void 0===wa?void 0:wa.state)||4==(null===wa||void 0===wa?void 0:wa.state)))return!1;ia=this.Lw.isVisible?
this.D_d.ASl(ma):new P.a(0,1);let na;const Fa=this.Nwm(null===(X=null===wa||void 0===wa?void 0:wa.suggestion)||void 0===X?void 0:X.vr);X=this.rj.Ona(aa,{id:"Intent-"+Q.a.ofi,suggestionGroups:[{type:Fa,id:Fa,title:wa.description,snippet:this.Neo(this.Dg.rca(aa.node)),snippetFormatting:[],supportedActions:this.UHf(null===wa||void 0===wa?void 0:wa.suggestion,!0),suggestions:({tNo:na}=this.Ibi(ma)).returnValue,previewData:na?new Y(na):null,isContentPending:!1}],setSize:ia.count,positionInSet:ia.index},
this,Z.ZXa,!1,()=>{var Qa;this.FD.$xj(new V(ma,!0));this.Lw.isVisible||3===(null===(Qa=null===wa||void 0===wa?void 0:wa.suggestion)||void 0===Qa?void 0:Qa.vr)||this.zOe++},()=>{this.FD.$xj(new V(ma,!1))},null,!1,Qa=>{Qa.showDesignerButton=!this.Lw.isVisible;Qa.shouldSkipTwoStepReview=!0;Qa.isFormattingSuggestion=0==wa.suggestion.vr;Qa.isMultiParagraphSuggestion=1<wa.QQ.length;Qa.proactivePromptHintType=this.a4o(wa)?l.e.HideFromReviewCardAndRibbon:l.e.None});a.c(v.a.a5n,X,void 0,void 0,30);return X}executeAction(Z,
X){var aa,ia,wa,ma,na;if(!Z||!X)return!1;const Fa=this.Rm.YB(X);y.ULS.sendTraceTag(541446529,3016,50,"Action: {0}; Role: {1}; Pane: {2};",Z.actionType,null===Fa||void 0===Fa?void 0:Fa.role,this.Lw.isVisible);const Qa=this.E_d.lX(X);try{switch(Z.actionType){case l.b.Accepted:const ya=this.Sb.Pb(v.a.wQd,2,new z(X,null===Fa||void 0===Fa?void 0:Fa.role,!0));this.rMg(xa=>{xa.supportedActions=this.UHf(null===Qa||void 0===Qa?void 0:Qa.suggestion,!1)});return this.Lw.isVisible&&32===ya?this.ubg(X):32===ya;
case l.b.Rejected:const ta=this.Sb.Pb(v.a.$te,2,new z(X,null===Fa||void 0===Fa?void 0:Fa.role,!0));2===(null===Qa||void 0===Qa?void 0:Qa.suggestion.vr)||Object(M.e)(null===Qa||void 0===Qa?void 0:Qa.suggestion)||this.Atd(X,!1);2===(null===Qa||void 0===Qa?void 0:Qa.suggestion.vr)&&this.rj.dismiss();return this.Lw.isVisible&&32===ta?this.ubg(X):32===ta;case l.b.Next:case l.b.Previous:return!this.Lw.isVisible||this.ubg(X,Z.actionType===l.b.Previous);case l.b.Apply:const Aa=null===(aa=Z.suggestion)||void 0===
aa?void 0:aa.contentData;let oa;switch(null===Aa||void 0===Aa?void 0:Aa.vr){case 0:oa=new D(X,Aa.role);break;case 1:case 3:const xa=Aa.Wcb;y.ULS.sendTraceTag(541446530,3016,50,"Changing PullQuote style: {0}",{["suggestionId"]:null===(ia=null===Qa||void 0===Qa?void 0:Qa.suggestion)||void 0===ia?void 0:ia.id,["newStyleId"]:xa});Qa.suggestion.Wcb=xa;oa=new F(X,xa,f.a.create());break;case 2:oa=new I(X,Aa.kta);break;default:return y.ULS.shipAssertTag(527459665,3016,!1,String.format("DesignerSuggestionType: {0}",
Aa.vr)),!1}this.rj.focus();const za=this.Sb.Pb(v.a.gnb,2,oa);this.Atd(X,!1);return 32===za;case l.b.AcceptAll:return 32===this.Sb.Pb(w.a.Tlb,2,new u.a(2));case l.b.RejectAll:return 32===this.Sb.Ob(v.a.vkd,2);case l.b.SnoozeAll:return 32===this.Sb.Ob(v.a.qxf,2);case l.b.Undo:const ja=this.Sb.Pb(v.a.vPa,2,new z(X,null===Fa||void 0===Fa?void 0:Fa.role));this.Atd(X,!0);return 32===ja;case l.b.OpenDesignerPane:return 32===this.Sb.Pb(v.a.ePa,2,new x.a(6));case l.b.ViewOriginal:const fa={QTb:Z.descriptorData.isViewingOriginal,
$zg:Z.descriptorData.setIsViewingOriginal};if(void 0==(null===fa||void 0===fa?void 0:fa.QTb)||void 0==(null===fa||void 0===fa?void 0:fa.$zg))return y.ULS.shipAssertTag(538789889,3016,!1,String.format("isViewingOriginal: {0}; setIsViewingOriginal: {1}",null===fa||void 0===fa?void 0:fa.QTb,null===fa||void 0===fa?void 0:fa.$zg)),!1;this.rj.focus();const Ca=this.Sb.Pb(v.a.sxf,2,new H(X,fa.QTb));fa.$zg(!fa.QTb);this.Atd(X,!0);return 32===Ca;case l.b.GiveFeedback:switch(null===(wa=null===Qa||void 0===Qa?
void 0:Qa.suggestion)||void 0===wa?void 0:wa.vr){case 0:return this.Ht.invokeUserFeedback(N.a.glk),!0;case 1:case 3:return this.Ht.invokeUserFeedback(N.a.mlk),!0;case 2:return this.Ht.invokeUserFeedback(N.a.ilk),!0;default:return y.ULS.shipAssertTag(537658138,3016,!1,String.format("DesignerSuggestionType: {0}",null===(ma=null===Qa||void 0===Qa?void 0:Qa.suggestion)||void 0===ma?void 0:ma.vr)),!1}case l.b.ShowMore:switch(null===(na=null===Qa||void 0===Qa?void 0:Qa.suggestion)||void 0===na?void 0:na.vr){case 2:y.ULS.sendTraceTag(527210449,
3016,50,"User clicked show more images"),Qa.suggestion.l4m(),this.Atd(X,!0,!0)}return!0;default:return!1}}catch(ya){return y.ULS.shipAssertTag(572027277,3016,!1,String.format("{0} {1}",ya.message,ya.stack)),!1}}ubg(Z,X=!1){const aa=this.D_d.Bkc(Z,X)||this.D_d.Bkc(Z,!X);this.FD.rmo(new O(Z,aa,!X));return!aa||this.D_d.vgj(this,aa)}Ftm(Z){switch(Z.vr){case 0:case 1:case 3:return{...l.h,font:Z.font,cssColor:Z.color,fontSize:Z.fontSize,fontWeight:Z.bold?l.d.Bold:l.d.Normal,italic:Z.italic,underlineType:Z.underline?
l.f.Single:l.f.None,backgroundImg:Z.backgroundImg};case 2:break;default:y.ULS.shipAssertTag(527569927,3016,!1,`${Z.vr}`)}}Jvm(Z){if(2===Z.vr)return{src:Z.imageUrl,width:0,height:0,imageAltText:Z.altText}}Ibi(Z){var X=null;let aa=null;if(this.ylb=this.G2j.QCm(Z)){aa=Array(this.ylb.options.length);for(Z=0;Z<this.ylb.options.length;Z++)X=this.ylb.options[Z],aa[Z]={type:"DesignerTriageItem",id:String.format("DesignerTriageItem {0}",Z),title:X.title,supportedActions:[l.b.Apply],contentData:X,image:this.Jvm(X),
titleFormatting:[this.Ftm(X)]};X=(null===aa||void 0===aa?0:aa.length)?aa[this.ylb.selectedIndex]:void 0}return{returnValue:aa,tNo:X}}rMg(Z){this.rj.definition?this.rj.definition.suggestionGroups?1===this.rj.definition.suggestionGroups.length&&(Z(this.rj.definition.suggestionGroups[0]),this.rj.definition=this.rj.definition):y.ULS.sendTraceTag(512274571,3016,50,"UXManger.definition.suggestionGroups is null"):y.ULS.sendTraceTag(512274572,3016,50,"UXManger.definition is null")}Atd(Z,X,aa=!1){const ia=
this.E_d.lX(Z);this.rMg(wa=>{wa.supportedActions=this.UHf(null===ia||void 0===ia?void 0:ia.suggestion,X);if(this.ylb){if(aa){var ma=this.Ibi(Z).returnValue;wa.suggestions=ma}ma=this.G2j.IJm(this.ylb.options,Z);wa.previewData=new Y(wa.suggestions[ma])}})}UHf(Z,X){const aa=[];X?(aa.push(l.b.Accepted),aa.push(l.b.Rejected),0==(null===Z||void 0===Z?void 0:Z.vr)&&aa.push(l.b.ViewOriginal)):(aa.push(l.b.Next),aa.push(l.b.Undo));this.Lw.isVisible||(this.$d.hgn()&&this.R9k(ia=>{ia&&this.rMg(wa=>wa.supportedActions.push(l.b.GiveFeedback))})&&
aa.push(l.b.GiveFeedback),this.$d.Xgn()&&aa.push(l.b.OpenDesignerPane),aa.push(l.b.SnoozeAll));0===(null===Z||void 0===Z?void 0:Z.vr)&&aa.push(l.b.AcceptAll);aa.push(l.b.RejectAll);(null===Z||void 0===Z?0:Z.RNi())&&aa.push(l.b.ShowMore);return aa}Neo(Z){const X=Z.split(" ",10);return 10>X.length?Z:X.join(" ")+"\u2026"}static chn(Z){return Z===Q.a.pfi||Z===Q.a.qfi||Z===Q.a.ufi}Nwm(Z){return 2===Z?Q.a.qfi:1===Z||3===Z?Q.a.ufi:Q.a.pfi}R9k(Z){void 0===this.lxd&&this.cGf.execute(async X=>{this.lxd=await X.isFeatureEnabled(N.a.Mfj,
!1);Z(this.lxd)});return!!this.lxd}}Object(G.a)(T,"DesignerIntentProvider",S.a,[])},1882:function(G,J,d){G=d(0);var m=d(2),f=d(75),a=d(577),l=d(92),w=d(2024),y=d(96),v;(function(oa){oa[oa.Gfm=0]="generic";oa[oa.$tl=1]="coherencyFailure";oa[oa.wUl=2]="disabledByPolicy";oa[oa.b7l=3]="fileCheckedOut";oa[oa.J_p=4]="fileEncrypted";oa[oa.L_p=5]="fileLocked";oa[oa.Q_p=6]="fileNotSupported";oa[oa.r7l=7]="fileTooLarge";oa[oa.P4p=8]="invalidOperationOnZeroByteFile";oa[oa.mwn=9]="labelDisabled";oa[oa.H5p=10]=
"labelErrorRetryLater";oa[oa.J5p=11]="labelIdNotFound";oa[oa.K5p=12]="labelIrmDisabledByTenant";oa[oa.L5p=13]="labelNotSupported";oa[oa.X6p=14]="mandatoryConflict";oa[oa.H7p=15]="minorVersionLimitExceeded"})(v||(v={}));Object(G.b)("SetPolicyLabelErrorType",v);var u=d(119),x=d(140),z=d(2023),A=d(193),D=d(94),F=d(23),I=d(111),H=d(360),N=d(416),M=d(758),U=d(396),O=d(105),V=d(3),Y=d(44),Q=d(6),S=d(436),P=d(762),T=d(5),Z=d(7),X=d(548),aa=d(2025),ia=d(15),wa=d(1797),ma=d(546),na=d(245);class Fa{constructor(oa,
za){this.Re=oa;this.fea=za}initialize(){const oa=S.a.Pl();oa&&oa.then(()=>{this.K8c()?this.Re.nb(this,"AugLoop_SecurityClp_LabellingAnnotation"):this.Re.nb(this,"AugLoop_Automatic_Clp_LabellingAnnotation")})}lD(oa=null,za=null){Z.ULS.sendTraceTag(575963811,337,50,"HandleAnnotationEvent");if(na.WoncaApp.W$.UFp.B_f()){if(this.K8c()){if(!oa||"AugLoop_SecurityClp_LabellingAnnotation"!==oa.annotationType){Z.ULS.sendTraceTag(538845259,337,15,"HandleAnnotationEvent - unsupported annotation");return}}else if(!oa||
"AugLoop_Automatic_Clp_LabellingAnnotation"!==oa.annotationType){Z.ULS.sendTraceTag(575972804,337,15,"HandleAnnotationEvent - unsupported annotation");return}if(!za||za!==H.a.getTypeName()&&za!==M.a.getTypeName())Z.ULS.sendTraceTag(575972805,337,15,"HandleAnnotationEvent - unsupported opType");else{za=oa.content||{};oa=za.automatic||{};var ja=oa.sensitivityLabel||{};oa=this.K8c()?oa.id:ja.id;ja=za.recommended||{};var fa=ja.sensitivityLabel||{};za=this.K8c()?ja.id:fa.id;ja=this.K8c()?ja.policyTip:
fa.policyTip;this.fea.l7k(oa,za,ja,this.Cln())}}else Z.ULS.sendTraceTag(575972803,337,15,"HandleAnnotationEvent - not IsNotRead")}Cln(){const oa=F.StaticActiveAppFrame.za().ib.$c.Jea;return!oa.Sqa||""===oa.Sqa||oa.CTb}K8c(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)}}Object(G.a)(Fa,"AutoClpAnnotationEventHandler",null,[223]);var Qa=d(34);class ya{Z5h(oa,za,ja,fa,Ca,xa,ua,sa){const Ea=za.klg;let Ja="",nb="";const ub=oa.DefaultLabelId;
let Yb;oa.SensitivityLabels.forEach(Ya=>{Ya.Id==sa&&(Ja=Ya.ParentId);Ya.Id==Ea&&(nb=Ya.ParentId);Ya.Id==ub&&Ya.ParentId&&(Yb=Ya.ParentId)});const yb=[];oa.SensitivityLabels.forEach(Ya=>{Ya.Id!=sa&&Ya.Id!=Ja&&Ya.Id!=Ea&&Ya.Id!=nb&&Ya.Id!=oa.DefaultLabelId||yb.push(Ya);Yb&&Ya.Id==Yb&&yb.push(Ya)});oa.SensitivityLabels=yb;const Za={};Za.clpLabelId=za.klg||"";Za.clpTenantId=fa;Za.clpApplyLabelFlags=za.vIa;Za.clpSupportsOfficeClientCoauthoring=ja;Za.clpUserName=Ca;Za.clpUserPrincipalName=xa;Za.clpDocLocation=
ua;Za.clpActions=Qa.c(oa);za=Qa.c(Za);ja=[];ja.push(za);return ja}}Object(G.a)(ya,"AutoSaveParameterComposer",null,[1062]);class ta{}ta.k4h="WordClpReadPolicy";ta.dfc="WordClpSetPolicy";ta.zWd="wordclpfc";Object(G.a)(ta,"Constants",null,[]);d.d(J,"a",function(){return Aa});class Aa{constructor(oa){this.DBh=!0;this.$jh=this.zCd=this.Zjh=0;this.lyd=this.QTe=!1;this.yod=this.Gb=null;this.Gja=()=>D.StaticTheCoauthManager.ud().Aq||D.StaticTheCoauthManager.ud().Gja&&D.StaticTheCoauthManager.ud().nB.gMa;
this.fUn=()=>{m.AFrameworkApplication.va.fb(V.a.M8j,f.a.frame,this.Kyp,96);a.a.$p(Aa.W.Qa("Common.App.Policy.Contracts.IPolicyManager")).continueWith(za=>{var ja=0;l.Health.instance.recordKpiUsage(ta.k4h,1,ta.zWd,this.f9a());ja=(new Date).getTime();Aa.Xh=za.result;this.elb&&(Aa.Xh.h5m(D.StaticTheCoauthManager.bta().CWR(()=>D.StaticTheCoauthManager.bta().result.nB)),Aa.Xh.B5m(Aa.W.Qa("Common.Interface.IRtcBasicProvider")),Aa.Xh.e0k(this.PFm));Aa.Xh.Nsb=Aa.Xh.Nsb&&m.AFrameworkApplication.K.$("WordApplyManualPolicyLabelIsEnabled");
this.lyd&&Aa.Xh.k2k(this.G2n);Aa.Xh.p2i=!0;Aa.Xh.lPj=m.AFrameworkApplication.K.ic("WordClpSetPolicyLabelZeroByteFailureRetryIntervalMs",3E4);Aa.Xh.URd(this.F2n);Aa.Xh.Sgf(this.E2n);m.AFrameworkApplication.K.$("AutoClpIsEnabled")&&m.AFrameworkApplication.K.$("AugLoopAnnotationsIsEnabled")&&(Aa.Xh.d0k(this.vso),m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&(Aa.Xh.$_k(this.CYd),Aa.Xh.s2k(this.Ttp),Aa.Xh.t2k(this.Utp)));Aa.Xh.EPh(this.f8k);Aa.Xh.q2k(this.Nqp);
za=m.AFrameworkApplication.K.kb("AppliedPolicyId");""===za&&(za=this.t8d().Sqa);Aa.tCb=za;m.AFrameworkApplication.$u||Aa.Xh.EPb(za,w.a.qlf,this.Gja,!1);ja=Object.assign(new O.a,{durationMs:(new Date).getTime()-ja});l.Health.instance.recordKpiSuccess(ta.k4h,ja)});a.a.$p(Aa.W.Qa("Common.App.Policy.Contracts.IPolicyActor")).continueWith(za=>{Aa.fea=za.result;Aa.fea.Nsb=Aa.fea.Nsb&&m.AFrameworkApplication.K.$("WordApplyManualPolicyLabelIsEnabled")})};this.PFm=(za,ja)=>{Z.ULS.sendTraceTag(579203664,337,
100,"GetPolicyLabelHandler");this.QTe&&(Aa.tCb=Aa.Xh.Iz.AppliedPolicyId,Aa.lPe=Aa.Xh.Iz.PolicyLabelVersionToken);za=this.t8d();this.r5i(za.Sqa,Aa.Xh.Iz.AppliedPolicyId)||!(0<this.zCd)||this.QTe&&ja.QFm===w.a.KNo||(this.zCd--,Z.ULS.sendTraceTag(579737543,337,15,"LabelId from host did not match content stream."),ja=new y.a(2,1,this.$jh,()=>{Z.ULS.sendTraceTag(579715490,337,15,"Retrying GetDocumentPolicyLabelsRequestAsync after labelId mismatch. getPolicyRetryRemainingCount : {0}",this.zCd);const fa=
this.t8d();Aa.Xh.EPb(fa.Sqa,w.a.refresh,this.Gja,!0)}),this.Gb.Zb(ja))};this.Kyp=(za,ja,fa)=>{Z.ULS.sendTraceTag(579203665,337,100,"UpdatePolicyLabelFromBox4 - Begin.");if(1===fa)return 32;za=this.t8d();const Ca=za.Sqa;za=this.elb?za.GXb:null;if(this.elb?Aa.lPe===za:this.r5i(Aa.tCb,Ca))return Z.ULS.sendTraceTag(579203666,337,100,"UpdatePolicyLabelFromBox4 - Label Change not detected."),32;Z.ULS.sendTraceTag(579203667,337,100,"UpdatePolicyLabelFromBox4 - Label Change detected.");this.zCd=this.Zjh;
Aa.Xh?Aa.Xh.EPb(Ca,w.a.refresh,this.Gja,!0):a.a.$p(Aa.W.Qa("Common.App.Policy.Contracts.IPolicyManager")).continueWith(xa=>{Aa.Xh=xa.result;Aa.Xh.EPb(Ca,w.a.refresh,this.Gja,!0)});Aa.tCb&&(Aa.h5e=Aa.tCb);Aa.tCb=Ca;this.elb&&(Aa.lPe=za);Z.ULS.sendTraceTag(579203668,337,100,"UpdatePolicyLabelFromBox4 - End.");return 32};this.G2n=(za,ja)=>{za=this.f9a(ja.Yif);l.Health.instance.recordKpiUsage(ta.dfc,1,ta.zWd,za);this.yod=this.Yp()};this.E2n=(za,ja)=>{this.lyd||l.Health.instance.recordKpiUsage(ta.dfc,
1,ta.zWd,this.f9a());za=this.lqb(ja.Yif,this.yod);za.extendedProperties.set("ErrorType",v[ja.errorType]);l.Health.instance.recordKpiFailure(ta.dfc,"Shared or Host SetPolicyLabel failure.",!1,!1,za)};this.F2n=(za,ja)=>{this.lyd||(l.Health.instance.recordKpiUsage(ta.dfc,1,ta.zWd,this.f9a()),this.yod=this.Yp());za=F.StaticActiveAppFrame.za().ib.$c;if(!this.elb){var fa=new Y.GraphTransaction(0);try{fa.Ab(za),za.Jea.Sqa=ja.klg}finally{fa&&fa.dispose()}}Aa.xxd=Aa.W.resolve("WordEditor.AutoSaveParamsUpdateService");
fa=new Q.GraphIterator;fa.set(za);if(Aa.pG.dS(fa)){za=fa.Ub(35);fa=Aa.Xh.Iz;var Ca=T.a.yAg,xa=m.AFrameworkApplication.K,ua=null;ua=xa.kb("EditDocInClientUrl");ua||(Z.ULS.sendTraceTag(523567771,337,50,"EditDocInClientUrl setting was empty. Falling back to WopiSrc"),ua=xa.kb("WopiSrc"));ua||Z.ULS.sendTraceTag(523567772,337,10,"WopiSrc setting was empty.");var sa=null;sa=Aa.h5e?this.b$g.Z5h(fa,ja,this.elb,xa.kb("TenantId"),xa.kb("UserName"),xa.kb("UserPrincipalName"),ua,Aa.h5e):this.b$g.Z5h(fa,ja,this.elb,
xa.kb("TenantId"),xa.kb("UserName"),xa.kb("UserPrincipalName"),ua,Aa.tCb);Aa.xxd.QLj(za,Ca,sa,()=>{const Ea=this.lqb(ja.vIa,this.yod);l.Health.instance.recordKpiSuccess(ta.dfc,Ea)},(Ea,Ja)=>{Ea=this.lqb(ja.vIa,this.yod);Ea.extendedProperties.set("statusCode",X.a[Ja]);l.Health.instance.recordKpiFailure(ta.dfc,"Word Save Failed",!1,!1,Ea);Z.ULS.sendTraceTag(592311969,337,10,"SetPolicyLabel Save failed with {0}.",X.a[Ja])})}};this.vso=()=>{this.DBh&&(Aa.U9g=new Fa(Aa.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
Aa.W.resolve("Common.App.Policy.Contracts.IPolicyActor"),Aa.Xh),Aa.U9g.initialize());this.DBh=!1};this.CYd=(za,ja)=>{const fa=Object.assign(new H.a,{parentPath:["session","doc","security"],items:[Object.assign(new N.a,{id:"clp",body:Object.assign(new aa.CLP,{existingLabelPriority:ja.existingLabelPriority,partialDocSITs:ja.j4h,fullDocSITs:ja.i4h})})]});S.a.Pl().then(()=>{P.a.getAugLoopRuntimeManager().submitOperation(Object.assign(new U.a,{operation:fa}))})};this.Ttp=(za,ja)=>{const fa=Object.assign(new M.a,
{parentPath:["session","doc","security"],items:[Object.assign(new N.a,{id:"clp",body:Object.assign(new aa.CLP,{existingLabelPriority:ja.existingLabelPriority})})]});S.a.Pl().then(()=>{P.a.getAugLoopRuntimeManager().submitOperation(Object.assign(new U.a,{operation:fa}))})};this.Utp=(za,ja)=>{const fa=Object.assign(new M.a,{parentPath:["session","doc","security"],items:[Object.assign(new N.a,{id:"clp",body:Object.assign(new aa.CLP,{partialDocSITs:ja.j4h,fullDocSITs:ja.i4h})})]});S.a.Pl().then(()=>{P.a.getAugLoopRuntimeManager().submitOperation(Object.assign(new U.a,
{operation:fa}))})};this.f8k=(za,ja)=>{ja&&ja.appMode?(za=1===ja.appMode,m.AFrameworkApplication.va.Pb(za?ia.a.ezc:ia.a.Ueb,2,{IsFromMandatoryLabeling:!0}),za||""===ja.tcj||Aa.fea.g8k(ja.tcj),ja=za?1:3,za=m.AFrameworkApplication.va.mode,ja!==za&&Z.ULS.sendTraceTag(545818049,337,10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",ja,za)):Z.ULS.sendTraceTag(572302786,337,15,"ApplyMandatoryLabeling is called with invalid inputs.")};this.Nqp=(za,ja)=>{ja.Q2o&&m.AFrameworkApplication.va.Pb(V.a.YX,
2,!1)};this.b$g=oa}get elb(){return m.AFrameworkApplication.K.$("SupportsOfficeClientCoauthoring")&&m.AFrameworkApplication.K.$("CoAuthForProtectedFilesIsEnabled")}get name(){return"WordEditor.Policy"}init(){Aa.pG=Object(I.a)();this.Gb=u.a.instance;Aa.rc.Ds.continueWith(()=>{this.Mo()});this.Zjh=m.AFrameworkApplication.K.ic("WordClpGetPolicyRetryCount",10);this.$jh=m.AFrameworkApplication.K.ic("WordClpGetPolicyRetryTimeoutMs",3E4);this.QTe=m.AFrameworkApplication.K.$("WordClpGetPolicyUpdateLocal");
this.lyd=m.AFrameworkApplication.K.$("ClpKpiIsEnabled")}dispose(){}wc(oa){Aa.W=oa;Aa.W.ia("WordEditor.AutoSaveParamsUpdateService",()=>new wa.a(Aa.W.resolve("Box4.Graph.IGraphIteratorFactory"),ma.a.mU)).ha()}Yp(){return(new Date).getTime()}Mo(){Aa.rc.isFeatureEnabled(60)&&m.AFrameworkApplication.K.$("SupportsPolicies")&&x.a.get_instance().Lk(10,this.fUn)}f9a(oa=null){const za=new Map;za.set("ClpCoauth",this.elb.toString());null!=oa&&za.set("ApplyLabelFlags",z.a[oa]);return za}t8d(){return F.StaticActiveAppFrame.za().ib.$c.Jea}r5i(oa,
za){return(oa||"")===(za||"")}lqb(oa,za){const ja=new O.a;ja.extendedProperties=this.f9a(oa);null!=za&&(ja.durationMs=this.Yp()-za);return ja}static get rc(){return null!=Aa.EWg?Aa.EWg:Aa.EWg=Aa.W.resolve("Box4.IFeatureHelper")}static main(){A.a.instance.Jc(new Aa(new ya))}}Aa.W=null;Aa.Xh=null;Aa.fea=null;Aa.xxd=null;Aa.pG=null;Aa.U9g=null;Aa.tCb="";Aa.lPe="";Aa.h5e="";Object(G.a)(Aa,"WordEditorPolicyPackage",null,[0,1])},1884:function(G,J,d){G=d(0);var m=d(929),f=d(753),a=d(10),l=d(1543),w=d(2176),
y=d(379),v=d(7),u=d(122),x=d(1610);class z{constructor(H,N,M){this.isVisible=H;this.elements=N;this.content=M}}Object(G.a)(z,"TooltipVisibilityArgs",null,[]);var A;(function(H){H[H.RVp=0]="consistency";H[H.Dgq=1]="pullQuote";H[H.wmq=2]="suggestedImage";H[H.Egq=3]="pullQuoteMenu";H[H.GXp=4]="designerPaste"})(A||(A={}));Object(G.b)("DesignerSuggestionType",A);var D=d(151),F=d(1801);d.d(J,"a",function(){return I});class I extends l.a{constructor(H,N,M,U,O,V,Y,Q){super();this.hn=H;this.Gq=N;this.wsl=
M;this.Uej=U;this.Dg=O;this.FD=V;this.tK=Y;this.sc=Q;this.Mza=this.iLa=null;this.ZMa=S=>{S=S.Mq;this.FD.oyj(new z(!0,[S.aUc],S.plp));if(S.jt&&0<S.jt.length){const P=this.tK.lX(S.jt[0]);P&&P.suggestion.wDn()}return this.hOj(S)};this.$Ma=S=>{this.FD.oyj(new z(!1));return this.h3h(S.Mq)};this.SMa=S=>{if(I.Hab(S.Mq,this.Mza))return!0;this.FD.smo(x.a.create(S.Mq.jt[0]));return!0};this.$gg=(S,P)=>{P.data?P.data.isVisible?this.BRo(P.data.paragraphNode):this.drl():v.ULS.shipAssertTag(573850384,3016,!1)};
this.FD.Fgf(this.$gg)}ZTo(H){H?(H=this.DKf(H))&&this.hOj(H):v.ULS.shipAssertTag(589693324,3016,!1)}wrl(){this.h3h(this.iLa)}qeb(H){H=this.Dg.Zl(H.Cb);return!!H&&this.tK.O$c(H)}t7a(H){const N=H.D6a(0,D.a.cdl,this.zoom),M=[];M.push(this.Ira(H.s8,N,H.CBc[0].y-H.E7[0].y));return M}Ira(H,N,M){var U,O=H.uh.ownerDocument;const V=m.a.createElement(O,f.a.div);V.className=D.a.Ycl;V.style.left=N+"px";V.style.top=M+"px";N=m.a.createElement(O,f.a.div);N.className=D.a.adl;O=m.a.createElement(O,f.a.div);O.className=
D.a.Zcl;H=this.Dg.Zl(H.Cb);M=this.tK.lX(H);if(null===(U=null===M||void 0===M?void 0:M.suggestion)||void 0===U?0:U.vr)O.className+=String.format(" {0}",A[M.suggestion.vr]);N.appendChild(O);V.appendChild(N);V.id=I.nui(H);U=this.DKf(H,V);1==U.ddl&&(O.className+=String.format(" {0}",D.a.$cl));this.Mza&&this.Mza.jt.includes(H)?(V.className+=String.format(" {0}",D.a.elf),this.Mza=U):this.iLa&&this.iLa.jt.includes(H)&&(V.className+=String.format(" {0}",D.a.dlf),this.iLa=U);this.Uej(a.a.QX,V,this.ZMa,U);
this.Uej(a.a.yP,V,this.$Ma,U);this.wsl(a.a.click,V,this.SMa,U);return V}BRo(H){if(H){var N=this.DKf(H);N?(this.tK.lX(H)&&(H=Object.assign(new w.a,{action:0,type:3,ZB:N,dM:this.Mza}),this.Gq.qH(H)),this.Mza=N,I.Hab(this.iLa,this.Mza)&&(this.iLa=null)):v.ULS.shipAssertTag(590112344,3016,!1)}else v.ULS.shipAssertTag(590112343,3016,!1)}drl(){if(this.Mza){var H=Object.assign(new w.a,{action:1,type:3,ZB:null,dM:this.Mza});this.Mza=null;this.Gq.qH(H)}}hOj(H){if(I.Hab(H,this.Mza)||I.Hab(H,this.iLa))return!0;
const N=Object.assign(new w.a,{action:2,type:3,ZB:H,dM:this.iLa});this.iLa=H;this.Gq.qH(N);return!0}h3h(H){if(I.Hab(H,this.Mza))return!0;H=Object.assign(new w.a,{action:3,type:3,ZB:null,dM:this.iLa});this.iLa=null;this.Gq.qH(H);return!0}DKf(H,N){N=N?N:this.bjm(H);if(!N)return null;const M=this.tK.lX(H);return new F.a(0<(null===M||void 0===M?void 0:M.QQ.length)?null===M||void 0===M?void 0:M.QQ:[H],N,I.EJi(M),I.cjm(M))}static EJi(H){if(!H)return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion;
switch(H.suggestion.vr){case 0:return I.tde(H.state)?WordEditorIntl.WordEditorStrings.L_ReviewUpdatedDesignerFormattingSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerFormattingSuggestion;case 1:case 3:return I.tde(H.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerPullQuoteSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerPullQuoteSuggestion;case 2:return I.tde(H.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerText2ImageSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerText2ImageSuggestion;
default:return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion}}static cjm(H){return H?I.tde(H.state)?1:0:0}static tde(H){return 0!==H&&.1!==H}bjm(H){var N=null,M=this.hn.jg(H);M.zb(11)&&(M.uc(),M=M.currentNode.nl(this.sc.oc))&&(H=String.format("#{0}",I.nui(H)),N=M.htmlElement.querySelector(H),!N&&Object(u.a)(y.a,M)&&(N=(N=M.z3d())?N.querySelector(H):null));return N}static nui(H){return String.format("p{0}{1}",H.id.hu,H.id.n)}static Hab(H,N){return!!N&&!!H&&H.aUc===N.aUc}}Object(G.a)(I,
"BlueDotActor",l.a,[245,246])},1885:function(G,J,d){G=d(0);var m=d(1499);class f extends m.a{constructor(){super();this.LastAutoSaveErrorReported=0;this.LastAutoSaveCorrelation=null;this.MeritsErrorReport=!1;this.LocalCobaltMachineId=this.LocalCobaltSessionId=null;this.WaciiEnabledRequests=0;this.ShowMergePrompt=!1;this.PartMergeInfo=0}}Object(G.a)(f,"ALocalCobaltServerResponse",m.a,[]);d.d(J,"a",function(){return a});class a extends f{constructor(){super();this.RootCellId=null;this.AvailableFileAccess=
0;this.PageHtml=this.ClientKnowledge=this.LatestRevisionId=this.RevisionList=null;this.PinRevisionForAugLoopResponse=this.ContentBytes=0;this.RevisionIdPinnedForAugLoop=null;this.ScheduledShutdownTime=0;this.LastSavedToHostRevisionSequenceNumber=-1}}Object(G.a)(a,"GetChangesResponse",f,[])},1889:function(G,J,d){G=d(0);class m{constructor(l,w,y,v){this.FFb=l;this.l9b=w;this._marginLeft=y;this.m9b=v}}Object(G.a)(m,"Margins",null,[]);var f=d(947);d.d(J,"a",function(){return a});class a{}a.l4=[new m(1440,
1440,1440,1440),new m(720,720,720,720),new m(1440,1440,1080,1080),new m(1440,1440,2880,2880),new m(1440,1440,1800,1800)];a.Zua=[new f.a(12240,15840),new f.a(12240,20160),new f.a(10440,15120),new f.a(11907,16839),new f.a(8391,11907)];Object(G.a)(a,"PredefinedPageProperties",null,[])},1890:function(G,J,d){G=d(0);var m=d(35),f=d(1162);class a extends f.a{isUserPromptField(F){return new l(F)}annotationStatusField(F){return new w(F)}annotationCharCountField(F){return new y(F)}userPromptCharCountField(F){return new v(F)}precedingTextsCharCountField(F){return new u(F)}followingTextsCharCountField(F){return new x(F)}promptTriggerSourceField(F){return new z(F)}promptIdField(F){return new A(F)}}
Object(G.a)(a,"AiInserterDataFieldsFactoryImpl",f.a,[]);class l extends m.a{constructor(F){super();this.name="isUserPrompt";this.bool=F}}Object(G.a)(l,"IsUserPromptDataField",m.a,[]);class w extends m.a{constructor(F){super();this.name="annotationStatus";this.int64=F}}Object(G.a)(w,"AnnotationStatusDataField",m.a,[]);class y extends m.a{constructor(F){super();this.name="annotationCharCount";this.int64=F}}Object(G.a)(y,"AnnotationCharCountField",m.a,[]);class v extends m.a{constructor(F){super();this.name=
"userPromptCharCount";this.int64=F}}Object(G.a)(v,"UserPromptCharCountField",m.a,[]);class u extends m.a{constructor(F){super();this.name="precedingTextsCharCount";this.int64=F}}Object(G.a)(u,"PrecedingTextsCharCountField",m.a,[]);class x extends m.a{constructor(F){super();this.name="followingTextsCharCount";this.int64=F}}Object(G.a)(x,"FollowingTextsCharCountField",m.a,[]);class z extends m.a{constructor(F){super();this.name="promptTriggerSource";this.string=F}}Object(G.a)(z,"PromptTriggerSourceField",
m.a,[]);class A extends m.a{constructor(F){super();this.name="promptId";this.string=F}}Object(G.a)(A,"PromptIdField",m.a,[]);m=d(1017);d.d(J,"a",function(){return D});class D extends m.a{constructor(F){super(F,"AiInsert");this.fieldsFactory=new a}}Object(G.a)(D,"AiInserterTelemetryLoggerImpl",m.a,[])},1895:function(G,J,d){G=d(0);var m=d(361),f=d(761);class a{constructor(w,y,v,u,x,z,A){this.pj=w;this.focusManager=y;this.PG=v;this.iL=u;this.Umd=x;this.Urj=z;this.Zdi=A;this.lU=this.tMb();this.PG.Z$(this.lU.name);
this.iL.vcc(this.lU.name,this.pj,this.lU.P0a);w=this.ztf();this.focusManager.Umb(this.pj,this.lU,w)}focus(){this.isFocused||this.focusManager.Bg(this.lU.name)}get isFocused(){return this.focusManager.currentScope===this.lU}addIsFocusChangedHandler(w){this.lU.y6(()=>w(!0));this.lU.KTa(()=>w(!1))}eOh(w){this.lU.T5a(w)}dispose(){var w;this.focusManager.mdb(this.lU.name);this.focusManager.currentScope||this.focusManager.Bg(null!==(w=this.Zdi)&&void 0!==w?w:f.a.Ho)}tMb(){var w;const y=this.focusManager.ge(this.Umd);
y.parent=null!==(w=this.Urj)&&void 0!==w?w:f.a.mq;y.P0a=!0;y.amd=!0;y.iK=!0;return y}ztf(){const w=new m.DOMFocusListing(()=>this.pj);w.Gn(8);return w}}Object(G.a)(a,"EditorAiFocusScopeImpl",null,[]);d.d(J,"a",function(){return l});class l{constructor(w,y,v,u){this.options=w;this.focusManager=y;this.PG=v;this.iL=u}registerScope(w){return new a(w,this.focusManager,this.PG,this.iL,this.options.Umd,this.options.Urj,this.options.Zdi)}}Object(G.a)(l,"EditorAiFocusManagerImpl",null,[])},1926:function(G,
J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static Zti(f){switch(f){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(G.a)(m,"WopiAuthContext",null,[782])},1927:function(G,J,d){d.d(J,"a",
function(){return m});G=d(0);class m{}m.D4n="OneDriveWOPI";Object(G.a)(m,"HostApplicationType",null,[])},1928:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}m.Dck="WAC_Word";m.A6c=null;Object(G.a)(m,"AddinHostApp",null,[])},1930:function(G,J){Object.defineProperty(J,"__esModule",{value:!0});J.RoleType=J.ErrorCode=void 0;(function(d){d[d.Success=0]="Success";d[d.DocumentTooLarge=1]="DocumentTooLarge"})(J.ErrorCode||(J.ErrorCode={}));(function(d){d[d.Unknown=0]="Unknown";d[d.Title=
1]="Title";d[d.Subtitle=2]="Subtitle";d[d.Heading1=3]="Heading1";d[d.Heading2=4]="Heading2";d[d.Heading3=5]="Heading3";d[d.Heading4=6]="Heading4";d[d.Heading5=7]="Heading5";d[d.Heading6=8]="Heading6";d[d.Heading7=9]="Heading7";d[d.Heading8=10]="Heading8";d[d.Heading9=11]="Heading9";d[d.ListItem=12]="ListItem";d[d.BodyText=13]="BodyText";d[d.ListHeader=14]="ListHeader";d[d.Caption=15]="Caption";d[d.CoverPageElement=16]="CoverPageElement"})(J.RoleType||(J.RoleType={}))},1931:function(G,J,d){Object.defineProperty(J,
"__esModule",{value:!0});J.NavigationPaneInputClassifierSignal=J.DesignerInputClassifierSignal=J.DocumentRoleDetectionAnnotation=J.RoleDetectionAnnotation=J.RoleDetectionSettings=J.RoleDetectionCustomMetadata=J.BasePartialDocumentLevelAnnotation=J.WordNavPaneInputTargetDocumentClassificationAnnotation=J.WordDesignerInputTargetDocumentClassificationAnnotation=J.BaseInputTargetDocumentClassificationAnnotation=void 0;const m=d(277);class f{constructor(D){m.SchemaObject.assign(f,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=
D}static getTypeName(){return"AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(D){return m.SchemaObject.matchesTypesFor(D,[f.getTypeName()])}}J.BaseInputTargetDocumentClassificationAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(D){m.SchemaObject.assign(a,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_RoleDetection_WordDesignerInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation",
"AugLoop_Core_Annotation"]}static typeGuard(D){return m.SchemaObject.matchesTypesFor(D,[a.getTypeName()])}}J.WordDesignerInputTargetDocumentClassificationAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(D){m.SchemaObject.assign(l,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_RoleDetection_WordNavPaneInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation",
"AugLoop_Core_Annotation"]}static typeGuard(D){return m.SchemaObject.matchesTypesFor(D,[l.getTypeName()])}}J.WordNavPaneInputTargetDocumentClassificationAnnotation=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class w{constructor(D){m.SchemaObject.assign(w,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(D){return m.SchemaObject.matchesTypesFor(D,
[w.getTypeName()])}}J.BasePartialDocumentLevelAnnotation=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class y{constructor(D){m.SchemaObject.assign(y,this,D)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionCustomMetadata"}static getBaseTypes(){return[]}static typeGuard(D){return m.SchemaObject.matchesTypesFor(D,[y.getTypeName()])}}J.RoleDetectionCustomMetadata=y;y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class v{constructor(D){m.SchemaObject.assign(v,this,D)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionSettings"}static getBaseTypes(){return[]}static typeGuard(D){return m.SchemaObject.matchesTypesFor(D,
[v.getTypeName()])}}J.RoleDetectionSettings=v;v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class u{constructor(D){m.SchemaObject.assign(u,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(D){return m.SchemaObject.matchesTypesFor(D,[u.getTypeName()])}}J.RoleDetectionAnnotation=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};
class x{constructor(D){m.SchemaObject.assign(x,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_RoleDetection_DocumentRoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation","AugLoop_Core_Annotation"]}static typeGuard(D){return m.SchemaObject.matchesTypesFor(D,[x.getTypeName()])}}J.DocumentRoleDetectionAnnotation=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class z{constructor(D){m.SchemaObject.assign(z,
this,D)}static getTypeName(){return"AugLoop_RoleDetection_DesignerInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(D){return m.SchemaObject.matchesTypesFor(D,[z.getTypeName()])}}J.DesignerInputClassifierSignal=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class A{constructor(D){m.SchemaObject.assign(A,this,D)}static getTypeName(){return"AugLoop_RoleDetection_NavigationPaneInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(D){return m.SchemaObject.matchesTypesFor(D,
[A.getTypeName()])}}J.NavigationPaneInputClassifierSignal=A;A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()}},1932:function(G,J,d){d.d(J,"a",function(){return w});G=d(0);var m=d(2),f=d(7),a;(function(y){y[y.qdb=1]="rendered";y[y.o8f=2]="markedIntent";y[y.$rp=4]="unmarkedIntent";y[y.SUf=8]="incrementedToScore";y[y.GNl=16]="decrementedToScore";y[y.kRi=32]="incrementedToEditor";y[y.FNl=64]="decrementedToEditor"})(a||(a={}));Object(G.b)("AnnotationTrackingStates",a);var l;(function(y){y[y.Mnq=0]="toggledProofing";
y[y.x_p=1]="falseAlarm";y[y.Skq=2]="similarityAnnotation";y[y.M3p=3]="ignoredAnnotation";y[y.NWp=4]="currentGoalCritique";y[y.beo=5]="premiumPreview";y[y.bZp=6]="enabledCritique"})(l||(l={}));Object(G.b)("NotRenderingReason",l);class w{static get jSf(){return w.Okh?a.qdb|a.o8f|a.SUf|a.kRi:a.qdb|a.o8f|a.SUf}static mzb(y,v){if(this.n1i)switch(v){case a.qdb:case a.o8f:case a.SUf:case a.kRi:if(this.$Nc.get(y.id))break;let u=this.DJb.get(y.id);u=u?u|v:v;(u&this.jSf)===this.jSf?(this.$Nc.set(y.id,this.jSf),
this.DJb.delete(y.id)):w.DJb.set(y.id,u);break;case a.FNl:case a.GNl:case a.$rp:this.DJb.has(y.id)&&this.DJb.delete(y.id),this.$Nc.has(y.id)&&this.$Nc.delete(y.id)}}static Zqc(y,v){m.AFrameworkApplication.Ld("ad28f280;c9bhh505");this.eqh&&this.irn&&f.ULS.sendTraceTag(508641415,375,15,"critiqueType: {0}, critiquePriority: {1}, reason: {2}",y.typeId,y.priority,v)}static mcd(y,v,u=!1){m.AFrameworkApplication.Ld("b85e6302;34iig242");this.n1i&&v.forEach(x=>{const z=x.id;f.ULS.sendTraceTag(508641414,375,
15,"annotation track : {0}, critiqueType: {1}, annotation error trace: {2}",w.DJb.get(z)?w.DJb.get(z):w.$Nc.get(z),u?x.content.typeId:"NA",y)})}static get irn(){if(null!=w.C0g)var y=w.C0g;else{var v;y=null===(v=m.AFrameworkApplication.K)||void 0===v?void 0:v.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldEnableRenderingLoggingEnabled",!1);y=w.C0g=y}return y}static get n1i(){if(null!=w.s0g)var y=w.s0g;else{var v;y=null===(v=m.AFrameworkApplication.K)||void 0===v?void 0:v.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingLoggingEnabled",
!1);y=w.s0g=y}return y}}w.DJb=new Map;w.$Nc=new Map;w.Okh=!1;w.eqh=!1;Object(G.a)(w,"ProofingTelemetryLogger",null,[])},1933:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f){this.extensions=f}}Object(G.a)(m,"ExtensionList",null,[])},1934:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a="",l="",w="",y=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=f;this.Provider=a;this.DisplayName=l;this.Email=
w;this.IsCurrentUser=y}}Object(G.a)(m,"OfficeSharedCommentUser",null,[])},1935:function(G,J,d){d.d(J,"a",function(){return I});G=d(0);var m=d(1936),f=d(184),a=d(2),l=d(127),w=d(361),y=d(1430),v=d(833),u=d(580),x=d(1431),z=d(189),A=d(188),D=d(75),F=d(12);class I{constructor(H){this.Nda=this.ti=this.w5=null;this.aF=0;this.u5b=this.jpa=this.Yb=null;this.REh=!1;this.VNe=null;this.W8h=!0;this.cQl=N=>{1===N?this.OYc(this.u5b):(this.u5b&&this.selectComment(this.u5b.id),this.u5b=null)};this.dismiss=()=>{z.UISurfaces.kP().then(N=>
{N.removeNotification(this.VNe);return this.VNe=null})};this.ga=H;this.Wb()}get Tga(){return this.w5}get model(){return this.ti}get kmc(){return this.Nda}get jNl(){return a.AFrameworkApplication.L0o}get Kjp(){return a.AFrameworkApplication.cSj}get VPl(){return CommonUIStrings.l_DeleteCommentConfirm}get Mep(){return!1}get mE(){return!1}get Ygj(){return!1}get sLj(){return!1}get Qli(){return this.jpa}set Qli(H){this.jpa=H}get mode(){return this.aF}set mode(H){H!==this.aF&&(this.aF=H,-1!==this.aF&&(this.w5.Ibb(),
this.ti.Ibb(),0===this.aF&&this.QAf()))}get m0b(){return this.REh}set m0b(H){this.REh=H}get fha(){return!1}get XTj(){return!0}dispose(){this.w5&&(this.w5.dispose(),this.w5=null);this.ti&&(this.ti.dispose(),this.ti=null);this.Nda&&(this.Nda.dispose(),this.Nda=null);this.QAf()}selectComment(H,N=1){const M=this.ti.DF(H);!M||2===this.mode&&1!==M.Nr||(this.ti.selectComment(M),this.Nda.highlightComment(M,!0),this.w5.selectComment(M,N),1===N&&this.m0b&&this.jpa.selectComment(H))}knd(){const H=this.ti.knd();
H&&(this.Nda.highlightComment(H,!0),this.w5.selectComment(H),this.m0b&&this.jpa.selectComment(H.id))}lnd(){const H=this.ti.lnd();H&&(this.Nda.highlightComment(H,!0),this.w5.selectComment(H),this.m0b&&this.jpa.selectComment(H.id))}Ewe(H){H?this.selectComment(H,0):this.w5.Ngj&&this.mIf().Mk.mA(this.w5.Ngj)}clearSelection(){this.ti.clearSelection();this.m0b&&this.jpa.selectComment(null);this.Nda.trl()}h8n(){this.mE||(2===this.aF?(this.clearSelection(),this.deleteComment(this.ti.hz)):this.clearSelection())}VJb(H){if(1===
this.mode){H=m.a.Wfc(H);var N=({anchor:M}=this.Nda.jDl()).returnValue;if(M&&0===N)this.aza(H,M);else{switch(N){case 1:H=CommonUIStrings.l_NewCommentError;break;case 2:H=CommonUIStrings.l_NewCommentInvalidContent;break;default:H=CommonUIStrings.l_NewCommentError}var M=new A.StandardDialog;M.Gd=0;M.Nna(CommonUIStrings.l_DefaultDialogTitle,H,null)}}}aza(H){0!==this.mode&&(this.ti.MVk(H),0===H.Nr||this.Ygj||this.selectComment(H.id),this.ga.Ob(F.a.x5h,2))}Pob(H,N){1===this.mode&&H&&(this.ti.XZc(H,N),this.selectComment(H.id))}Tnf(){this.ti.Lll()}$lb(H,
N){1===this.mode&&(H=this.ti.v9h(H,N),this.selectComment(H.id,0),this.ga.Ob(F.a.B5h,2))}deleteComment(H){if(1!==this.mode)if(2===this.mode){if(1!==H.Nr)return;this.mode=1}else return;this.XTj&&1!==H.Nr?(this.u5b=H,H=new A.StandardDialog,H.Gd=4,H.uY(2),H.WDg(CommonUIStrings.l_DefaultDialogTitle,this.VPl,this.cQl)):this.OYc(H)}Wb(){this.ga.fb(F.a.Dvl,D.a.frame,l.ActionManager.Zf,64);this.ga.fb(F.a.Evl,D.a.frame,l.ActionManager.Zf,64);this.ga.fb(F.a.Z4h,D.a.frame,l.ActionManager.Zf,64);this.ga.ra(F.a.Aqf,
D.a.frame,l.ActionManager.Zf);this.ga.ra(F.a.e5h,D.a.frame,l.ActionManager.Zf);this.ga.ra(F.a.f5h,D.a.frame,l.ActionManager.Zf);this.ga.fb(F.a.Kvl,D.a.frame,l.ActionManager.Zf,64);this.ga.fb(F.a.Lvl,D.a.frame,l.ActionManager.Zf,64);this.ga.ra(F.a.x5h,D.a.frame,l.ActionManager.Zf);this.ga.ra(F.a.y5h,D.a.frame,l.ActionManager.Zf);this.ga.ra(F.a.B5h,D.a.frame,l.ActionManager.Zf);this.ga.fb(F.a.zwl,D.a.frame,l.ActionManager.Zf,64);this.ga.fb(F.a.Bwl,D.a.frame,l.ActionManager.Zf,64);this.ga.fb(F.a.Awl,
D.a.frame,l.ActionManager.Zf,64);this.ga.ra(F.a.D5h,D.a.frame,l.ActionManager.Zf);this.ga.ra(F.a.Rbb,D.a.frame,()=>{this.Rbb();return 32})}OYc(H){const N=H.Mf;1===H.Nr?this.ga.Ob(F.a.Aqf,2):this.ga.Ob(F.a.e5h,2);this.u5b=null;this.m0b||this.clearSelection();H=this.ti.deleteComment(H);for(let M=0;M<H.length;M++)H[M].dispose();this.Ewe(N)}xLb(H,N){0!==this.mode&&(this.ga.Ob(N?F.a.f5h:F.a.D5h,2),this.ti.xLb(H,N))}Uza(H){this.ti.Uza(H);this.mode=1;this.ga.Ob(F.a.y5h,2)}Dnb(H){this.ti.Dnb(H);this.mode=
1}Qwl(H,N){this.ti.jro(H,N)}Q7c(){}QAf(){}I0b(H,N,M,U,O){return this.w5.I0b(H,N,M,U,O)}EY(H,N,M,U,O){return this.w5.EY(H,N,M,U,O)}mIf(){var H=this.Yb.getRegion(f.AFrame.Us);if(!H){const N=this.Yb.ge(f.AFrame.Us);H=new w.DOMFocusListing(()=>this.Tga.Ogd);H.lna=!0;H.Gn(3);H.Gn(2);H.Gn(4);H.Gn(1);H.Gn(6);H.Gn(5);this.Yb.jra(()=>this.Tga.Ogd,N,H);H=this.Yb.getRegion(f.AFrame.Us);H.SZa();H.aS=!0;H.b7a=!0;N.tt(this.Yb.MZ);N.tt(this.Yb.NZ)}return H}aRd(H,N){0!==this.mode&&this.ti.aRd(H,N)}oue(H,N){0!==this.mode&&
this.ti.oue(H,N)}Rbb(){z.UISurfaces.kP().then(H=>{var N=Object.assign(new y.a,{target:this.sLj?'[data-unique-id*="ShowCommentsTopBar"]':'[data-unique-id~="ShowCommentsTopBar"]',showCloseIcon:!0,content:CommonUIStrings.l_DeepLinkedCommentDoesNotExistNotification,calloutProps:Object.assign(new x.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});N=H.callout(N);const M=Object.assign(new u.a,{expirationOptions:Object.assign(new v.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.VNe=H.addNotification(N,
M)})}static get instance(){return I._instance||(I.factory?I._instance=I.factory():null)}static set instance(H){I._instance=H}}I._instance=null;I.factory=null;Object(G.a)(I,"CommentManager",null,[660,661,13])},1936:function(G,J,d){d.d(J,"a",function(){return a});G=d(0);var m=d(2),f=d(1018);class a{constructor(){this.Gj=null;this.oh=[];this._changes=[];this.Xib=this.fac=this.tA=null}get Pt(){return this.tA}get hz(){return this.Xib}initialize(l){this.Gj=l}dispose(){const l=this.oh.length;for(let w=0;w<
l;w++)this.oh[w].dispose();this.oh=[]}Ibb(){this.tA&&this.tA.Ibb();this.fac&&this.fac.Ibb()}selectComment(l){this.clearSelection();l.Cna=1;this.tA=l;if(l.Mf){var w=Array.indexOf(this.oh,l);for(--w;0<=w;w--){const y=this.oh[w];if(y.id===l.Mf){y.Cna=2;this.fac=y;break}}}m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.GCa&&f.ShyRibbon.hnb(1,0)}knd(){if(!this.oh.length)return null;let l;l=this.tA?this.Pvi(this.tA,!0):this.oh[0];this.selectComment(l);return l}lnd(){if(!this.oh.length)return null;
let l;l=this.tA?this.fmm(this.tA):this.oh[this.oh.length-1];this.selectComment(l);return l}clearSelection(){this.tA&&(this.tA.Cna=0,this.tA=null);this.fac&&(this.fac.Cna=0,this.fac=null)}XZc(l,w){this.Gj.mode=3;l.Nr=2;l.n_a=0;l.KA=w;this.Xib=l}Lll(){this.Xib=null;this.Gj.mode=1}v9h(l,w){var y=this.DF(l);this.Gj.mode=2;this.Xib=l=d(1753).Comment.R9h(m.AFrameworkApplication.userName,l,y.cMi,w);for(w=this.oh.length-1;0<=w;w--)if(y=this.oh[w],y.Mf===l.Mf||y.id===l.Mf){Array.insert(this.oh,w+1,l);break}return l}Uza(l){this.E5h(l,
2)}Dnb(l){this.E5h(l,4)}deleteComment(l){const w=[],y=Array.indexOf(this.oh,l);for(;y<this.oh.length;){const v=this.oh[y];if(v.id===l.id||v.Mf===l.id)Array.removeAt(this.oh,y),Array.add(w,v);else break}this.Rjd(w,3);-1<Array.indexOf(w,this.Xib)&&(this.Xib=null,this.Gj.mode=1);return w}xLb(l,w){const y=[];let v=Array.indexOf(this.oh,l);for(;v<this.oh.length;){const u=this.oh[v];if(u.id===l.id||u.Mf===l.id)u.done=w,Array.add(y,u),v++;else break}this.Rjd(y,w?0:1)}xR(){return Array.clone(this.oh)}PBa(){return!!this.oh&&
!!this.oh.length}DF(l){for(let w=0;w<this.oh.length;w++){const y=this.oh[w];if(y.id===l)return y}return null}Pvi(l,w){l=Array.indexOf(this.oh,l);return l===this.oh.length-1?w?this.oh[0]:null:this.oh[l+1]}rsm(l,w=!1){let y=l=Array.indexOf(this.oh,l);do if(y=y===this.oh.length-1?0:y+1,!w||!this.oh[y].done)return this.oh[y];while(y!==l);return this.oh[l]}fmm(l){return(l=Array.indexOf(this.oh,l))?this.oh[l-1]:this.oh[this.oh.length-1]}ssm(l,w=!1){let y=l=Array.indexOf(this.oh,l);do if(y=y?y-1:this.oh.length-
1,!w||!this.oh[y].done)return this.oh[y];while(y!==l);return this.oh[l]}aRd(){}oue(){}E5h(l,w){const y=[];l.Nr=0;Array.add(y,l);this.Rjd(y,w);this.Xib=null}static Wfc(l){return d(1753).Comment.R9h(m.AFrameworkApplication.userName,null,d(1753).Comment.Uqj,l)}}Object(G.a)(a,"CommentModel",null,[13,657])},1937:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}m.lWc="CommentPaneTextbox";m.cXd="CommentPane";m.Jvl="CommentDeleteButton";m.ywl="CommentSaveButton";m.xwl="CommentReplyButton";
m.Hvl="CommentCancelButton";m.C5h="CommentTextEntry";m.Dwl="CommentTabHelp";Object(G.a)(m,"CommentManagerConstants",null,[])},1938:function(G,J,d){d.d(J,"a",function(){return l});G=d(0);var m=d(483),f=d(101),a=d(33);class l{dispose(){}static o7a(w,y,v,u=null,x=!0){var z=x?"":v;w=m.a("a",w,"StandardButton "+y);w.title=z;w.tabIndex=0;z=null;u?(z=f.createClusteredImage(16,16,u,"StandardButtonImage",!0,null),z.setAttribute(a.a.Ph,a.a.BA),w.appendChild(z)):Sys.UI.DomElement.addCssClass(w,"StandardButtonNoImage");
x?(u=m.a("span",null,"StandardButtonLabel"),u.innerText=v,w.appendChild(u)):Sys.UI.DomElement.addCssClass(z,"StandardButtonImageNoText");w.setAttribute(a.a.Ph,a.a.eaa);return w}static C_b(w,y){void 0!==w&&null!==w&&(w.disabled=!y,y?(y=a.a.PO,Sys.UI.DomElement.removeCssClass(w,"DisabledButton"),Sys.UI.DomElement.removeCssClass(w,"cui-disabled")):(y=a.a.hq,Sys.UI.DomElement.containsCssClass(w,"DisabledButton")||Sys.UI.DomElement.addCssClass(w,"DisabledButton"),Sys.UI.DomElement.containsCssClass(w,"cui-disabled")||
Sys.UI.DomElement.addCssClass(w,"cui-disabled")),a.a.Ls(w,a.a.Gjf,y))}}Object(G.a)(l,"SimpleButtonFactory",null,[13])},1940:function(G,J,d){d.d(J,"a",function(){return A});G=d(0);var m=d(91),f=d(2),a=d(10),l=d(20),w=d(19),y=d(47),v=d(7),u=d(3),x=d(22),z=d(23);class A{constructor(D,F,I,H,N="@",M=["@","/"]){var U,O;this.V6e=this.LFd=this.VDd=this.ne=null;this.l$=this.Jxa=this.l$g=!1;this.cGa=void 0;this.yrh=this.vEb=!1;this.Qia=0;this.VCg=this.z5b=!1;this.WWb=()=>{this.reset()};this.Cmb=V=>{this.Qia=
V.Kb.keyCode;var Y=V.Kb.rawEvent.key;if(!Y||(this.z5b?Array.contains(this.Duj,Y):Y===this.Yra))this.VCg=!0;return this.l$&&this.LFd?V.Kb.keyCode===m.a.Z4||V.Kb.keyCode===m.a.Mu||V.Kb.keyCode===m.a.xz?(Y=!1,V.Kb.keyCode===m.a.Z4?(v.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),Y=!0):V.Kb.keyCode===m.a.Mu?v.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):V.Kb.keyCode===m.a.xz&&v.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),
this.LFd(V),Y&&this.reset(),!0):V.Kb.keyCode===m.a.aia||V.Kb.keyCode===m.a.y9||V.Kb.keyCode===m.a.a5||V.Kb.keyCode===m.a.b5||V.Kb.keyCode===m.a.x9||V.Kb.keyCode===m.a.cO?(this.LFd(V),!0):!1:!1};this.gwa=V=>{if(this.VCg||this.l$){this.VCg=!1;var Y=this.l4c(),Q=this.P2c(V.Kb.target),S=V.Kb.rawEvent.inputType;return(void 0!==S&&null!==S||this.Qia!==m.a.PD&&this.Qia!==m.a.Y4)&&"deleteContentBackward"!==S&&"deleteContentForward"!==S?this.gNi(Y,Q,V.Kb.target):!1}};this.Wbl=V=>{if(1!==V.Kb.rawEvent.key.length)return!1;
const Y=this.l4c(),Q=this.P2c(V.Kb.target);return this.gNi(Y,Q,V.Kb.target)};this.$Xa=V=>{if(!this.l$)return!1;const Y=this.l4c(),Q=this.P2c(V.Kb.target);(V.Kb.keyCode===m.a.PD||V.Kb.keyCode===m.a.Y4||(V.Kb.keyCode===m.a.t1a||V.Kb.keyCode===m.a.OCc)&&V.Kb.ctrlKey)&&this.F5c(Y,Q,V.Kb.target);return!1};this.Akf=(V,Y)=>{this.Qia=Y.FXf?m.a.PD:Y.isDelete?m.a.Y4:this.Qia;this.l$&&(Y.FXf?this.lUm(Y.f5i):Y.isDelete&&this.SUm(Y.f5i))};this.Je=D;this.Uk=F;this.KDc=I;this.nd=H;this.Yra=N;this.Duj=M;this.z5b=
null!==(O=null===(U=f.AFrameworkApplication.K)||void 0===U?void 0:U.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQSlashInvoke",!1))&&void 0!==O?O:!1;this.reset()}Mdc(D,F){this.Jxa||(this.Jxa=!0,D.lCa?this.Dmb(F):D.Eja(()=>{this.Jxa||this.Dmb(F)}))}dispose(){this.vEb&&(z.StaticActiveAppFrame.za().Szc.xc(a.a.input,this.nd.Ke.editingElement,this.gwa),this.vEb=!1);this.l$g&&(this.ne.xc(a.a.FTd,this.nd.Ke.editingElement,this.Wbl),this.l$g=!1);this.yrh&&(this.ne.xc(a.a.gL,this.nd.Ke.editingElement,
this.Cmb),this.ne.xc(a.a.oi,this.nd.Ke.editingElement,this.$Xa));z.StaticActiveAppFrame.za().iha(this.WWb);this.hYj()}urg(D){this.VDd=D}Hrg(D){this.V6e=D}vrg(D){this.LFd=D}jWh(D){this.l$=!0;this.cGa=D;f.AFrameworkApplication.Ld("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control");f.AFrameworkApplication.Ld("ContextIQSlashInvoke-Treatment;ContextIQSlashInvoke-Control")}hYj(){this.l$=!1;this.cGa=void 0}zI(){return this.l$}Dmb(D){this.ne=D;if(!this.nd.zd)v.ULS.sendTraceTag(593376530,
324,10,"SelectionView is null. AtMentions will not work in this session");else if(this.nd.zd.nj){if(x.App.lUc&&l.a.MBe||l.a.ju)z.StaticActiveAppFrame.za().Szc.nb(a.a.input,this.nd.Ke.editingElement,this.gwa,null),this.vEb=!0;this.ne&&(this.ne.nb(a.a.gL,this.nd.Ke.editingElement,this.Cmb),this.ne.nb(a.a.oi,this.nd.Ke.editingElement,this.$Xa),this.yrh=!0);this.KDc.NPh(this.Akf);z.StaticActiveAppFrame.za().z2(this.WWb)}}gNi(D,F,I){if(1>F)return!1;D=D.replace(new RegExp(A.newLine,"g"),"");const H=D.charAt(F-
1);this.z5b?this.l$&&H!==this.cGa?this.F5c(D,F,I):!this.l$&&Array.contains(this.Duj,H)?this.VDd&&(this.reset(),this.hvj(F,D)&&(this.jWh(H),this.F5c(D,F,I),v.ULS.sendTraceTag(41178051,324,50,"Prefix typed.  Beginning of paragraph?: {0}",1===F?"true":"false"))):this.l$&&H===this.cGa&&v.ULS.sendTraceTag(41178052,324,50,"Tried to type prefix while already in at mention mode"):this.l$&&H!==this.Yra?this.F5c(D,F,I):this.l$||H!==this.Yra?this.l$&&H===this.Yra&&v.ULS.sendTraceTag(508674265,324,50,"Tried to type @ while already in at mention mode"):
this.VDd&&(this.reset(),this.hvj(F,D)&&(this.jWh(H),this.F5c(D,F,I),v.ULS.sendTraceTag(508674266,324,50,"@ typed.  Beginning of paragraph?: {0}",1===F?"true":"false")));return this.l$}reset(){this.Jxa=!1;this.hYj();this.V6e&&this.V6e()}P2c(D){return this.Uk.Djc(2,D)}l4c(){return this.Je.Cx().innerText}hvj(D,F){return 0>D-2||this.Gnl(F.charAt(D-2))?!0:!1}Gnl(D){return w.a.qga(D)||"("===D}F5c(D,F,I){if(!D||""===D||0>F)this.reset();else{const {nKj:H,Yqe:N}=this.Uvn(D,F);this.VDd(H,I,N)}}Uvn(D,F){const I=
this.bGm(D,F);if(0<=I&&F<=D.length)return{nKj:D.substring(I,F),Yqe:I};this.reset();return{nKj:"",Yqe:I}}bGm(D,F){let I=-1,H=F;for(H;0<=H&&63>=F-H;H--)if(this.z5b?this.cGa&&D.charAt(H)===this.cGa:D.charAt(H)===this.Yra){I=H;break}63<F-H&&-1==I&&y.c(u.a.Fqp,!0,void 0,void 0,void 0,void 0);return I}lUm(D){D=this.P2c(D.Kb.target);D=this.l4c().charAt(D-1);this.l$&&(this.z5b?D===this.cGa:D===this.Yra)&&this.reset()}SUm(D){D=this.P2c(D.Kb.target);D=this.l4c().charAt(D);this.l$&&(this.z5b?D===this.cGa:D===
this.Yra)&&this.reset()}}A.newLine="\n";Object(G.a)(A,"AtMentionsListener",null,[721])},1944:function(G,J,d){d.d(J,"m",function(){return a});d.d(J,"j",function(){return l});d.d(J,"y",function(){return w});d.d(J,"r",function(){return y});d.d(J,"s",function(){return u});d.d(J,"t",function(){return x});d.d(J,"o",function(){return D});d.d(J,"i",function(){return F});d.d(J,"a",function(){return H});d.d(J,"b",function(){return N});d.d(J,"f",function(){return M});d.d(J,"d",function(){return U});d.d(J,"e",
function(){return O});d.d(J,"c",function(){return V});d.d(J,"w",function(){return Q});d.d(J,"k",function(){return S});d.d(J,"x",function(){return P});d.d(J,"g",function(){return Z});d.d(J,"z",function(){return X});d.d(J,"B",function(){return wa});d.d(J,"A",function(){return na});d.d(J,"l",function(){return Fa});d.d(J,"h",function(){return oa});d.d(J,"p",function(){return za});d.d(J,"q",function(){return ja});d.d(J,"u",function(){return fa});d.d(J,"v",function(){return Ca});d.d(J,"n",function(){return xa});
var m=d(39);class f{constructor(ua){m.a.assign(f,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(ua){m.a.assign(a,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),
B_:a.getBaseTypes()};class l{constructor(ua){m.a.assign(l,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class w{constructor(ua){m.a.assign(w,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse",
"AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class y{constructor(ua){m.a.assign(y,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class v{constructor(ua){m.a.assign(v,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class u{constructor(ua){m.a.assign(u,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class x{constructor(ua){m.a.assign(x,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class z{constructor(ua){m.a.assign(z,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class A{constructor(ua){m.a.assign(A,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwapOnClose"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionCloseReason"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class D{constructor(ua){m.a.assign(D,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class F{constructor(ua){m.a.assign(F,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class I{constructor(ua){m.a.assign(I,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class H{constructor(ua){m.a.assign(H,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class N{constructor(ua){m.a.assign(N,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class M{constructor(ua){m.a.assign(M,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class U{constructor(ua){m.a.assign(U,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class O{constructor(ua){m.a.assign(O,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class V{constructor(ua){m.a.assign(V,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[V.getTypeName()])}}V.H_={T_:V.getTypeName(),B_:V.getBaseTypes()};class Y{constructor(ua){m.a.assign(Y,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class Q{constructor(ua){m.a.assign(Q,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[Q.getTypeName()])}}Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()};class S{constructor(ua){m.a.assign(S,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class P{constructor(ua){m.a.assign(P,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class T{constructor(ua){m.a.assign(T,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class Z{constructor(ua){m.a.assign(Z,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[Z.getTypeName()])}}Z.H_={T_:Z.getTypeName(),B_:Z.getBaseTypes()};class X{constructor(ua){m.a.assign(X,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[X.getTypeName()])}}X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};class aa{constructor(ua){m.a.assign(aa,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[aa.getTypeName()])}}aa.H_={T_:aa.getTypeName(),B_:aa.getBaseTypes()};class ia{constructor(ua){m.a.assign(ia,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[ia.getTypeName()])}}ia.H_={T_:ia.getTypeName(),B_:ia.getBaseTypes()};class wa{constructor(ua){m.a.assign(wa,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[wa.getTypeName()])}}wa.H_={T_:wa.getTypeName(),B_:wa.getBaseTypes()};class ma{constructor(ua){m.a.assign(ma,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[ma.getTypeName()])}}ma.H_={T_:ma.getTypeName(),B_:ma.getBaseTypes()};class na{constructor(ua){m.a.assign(na,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[na.getTypeName()])}}na.H_={T_:na.getTypeName(),B_:na.getBaseTypes()};class Fa{constructor(ua){m.a.assign(Fa,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[Fa.getTypeName()])}}Fa.H_={T_:Fa.getTypeName(),B_:Fa.getBaseTypes()};class Qa{constructor(ua){m.a.assign(Qa,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[Qa.getTypeName()])}}Qa.H_={T_:Qa.getTypeName(),B_:Qa.getBaseTypes()};class ya{constructor(ua){m.a.assign(ya,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[ya.getTypeName()])}}ya.H_={T_:ya.getTypeName(),B_:ya.getBaseTypes()};class ta{constructor(ua){m.a.assign(ta,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[ta.getTypeName()])}}ta.H_={T_:ta.getTypeName(),B_:ta.getBaseTypes()};class Aa{constructor(ua){m.a.assign(Aa,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[Aa.getTypeName()])}}Aa.H_={T_:Aa.getTypeName(),B_:Aa.getBaseTypes()};class oa{constructor(ua){m.a.assign(oa,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[oa.getTypeName()])}}oa.H_={T_:oa.getTypeName(),B_:oa.getBaseTypes()};class za{constructor(ua){m.a.assign(za,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionConnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[za.getTypeName()])}}za.H_={T_:za.getTypeName(),B_:za.getBaseTypes()};class ja{constructor(ua){m.a.assign(ja,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[ja.getTypeName()])}}ja.H_={T_:ja.getTypeName(),B_:ja.getBaseTypes()};class fa{constructor(ua){m.a.assign(fa,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SessionReconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[fa.getTypeName()])}}fa.H_={T_:fa.getTypeName(),B_:fa.getBaseTypes()};class Ca{constructor(ua){m.a.assign(Ca,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,[Ca.getTypeName()])}}Ca.H_={T_:Ca.getTypeName(),B_:Ca.getBaseTypes()};class xa{constructor(ua){m.a.assign(xa,this,ua)}static getTypeName(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ua){return m.a.matchesTypesFor(ua,
[xa.getTypeName()])}}xa.H_={T_:xa.getTypeName(),B_:xa.getBaseTypes()}},1945:function(G,J,d){d.d(J,"a",function(){return z});G=d(0);var m=d(7),f=d(82),a=d(824),l=d(128),w=d(8),y=d(376),v=d(1946);class u extends a.a{constructor(A){super(A.Fc,A.end);this.e6n=A}}Object(G.a)(u,"RemappableHitRange",a.a,[]);class x{constructor(A,D){this.x6c=A;this.M8c=D}Kxi(){return this.M8c?this.x6c.Fc:this.x6c.end}CSo(A){this.M8c?this.x6c.Fc=A:this.x6c.end=A}sZi(A,D){const F=this.Kxi()+(this.M8c?0:-1);return F>=A&&F<D}}
Object(G.a)(x,"HitRangeEdge",null,[]);class z{get $c(){return null}get Ej(){return null}get Ota(){return!1}get aYf(){return!1}Fff(){}Uke(){return!1}JKg(){return!1}yyi(A){return f.f(A,()=>!1)}$Va(){return null}gke(A,D,F,I,H){D=D||[];F=F||[];const N=[];let M=0,U=0,O=0;for(;M<D.length||U<F.length;){const V=M<D.length&&U<F.length?D[M].Fc<F[U].Fc?D[M++]:F[U++]:M<D.length?D[M++]:F[U++];N[O]=v.a.createInstance(V.Fc,V.end,A,O,I,H);++O}return N}dvm(A,D){if(!D)return null;if(!w.ParagraphReader.$6h(A)){var F=
this.$Qb(A.characterData,D);return[F,F]}F=this.$Qm(A,l.AParagraphNode.Q0c);A=this.dRm(A,F);D=this.$Qb(A,D);if(!D)return[D,D];D=D.map(I=>new u(I));D=this.qco(D);this.Ywo(D,F);D=this.T7l(D,F);F=D.map(I=>I.e6n);return[D,F]}$Qm(A,D){D=Object(y.c)(D);const F=Object(y.a)(D);return[...w.ParagraphReader.w4c(A)].map(I=>{I.isVisible=F(I);return I})}dRm(A,D){D=D.filter(F=>F.isVisible);return w.ParagraphReader.V9d(A,D)}qco(A){const D=[];for(const F of A)D.push(new x(F,!0)),D.push(new x(F,!1));return D}Ywo(A,
D){if(0!==A.length){var F=0,I=0;for(const H of D){if(F>=A.length)break;if(H.isVisible)for(;F<A.length;){D=A[F];if(!D.sZi(H.O6.cp-I,H.cpEnd-I))break;D.CSo(D.Kxi()+I);F++}else I+=H.cpEnd-H.O6.cp}}}T7l(A,D){if(0===A.length)return[];const F=[];let I=0,H=!1;for(const N of D){if(I>=A.length)break;if(N.isVisible)for(;I<A.length;){D=A[I];if(!D.sZi(N.O6.cp,N.cpEnd))break;D.M8c?H=!0:!D.M8c&&H&&(F.push(D.x6c),H=!1);I++}else H=!1}return F}t1i(){return!1}D1i(){return!1}$Qb(A,D){if(D&&A){let F;const I=[];try{for(;F=
D.exec(A);){const H=new a.a(F.index,D.lastIndex);I.push(H)}return I}catch(H){m.ULS.sendTraceTag(522846819,313,15,H instanceof SyntaxError?"Invalid regular expression":`errorName: ${H.name}`)}}return null}Xte(){}}Object(G.a)(z,"BaseFindManagerHelper",null,[553])},1946:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a,l,w,y,v,u){this.id=++m.tLk;this.m$g=f;this.gib=a;this.nwh=l;this.Clh=w;this.Kk=y;this.Knh=v;this.wq=u;this.next=this.Rv=null}get Fc(){return this.m$g}get end(){return this.gib}get type(){return this.Kk}EDi(){return this.wq.$Va(this.nodeId)}get nodeId(){return this.nwh}get LWa(){return this.Clh}get mde(){return this.Knh}kYd(f){this.m$g=
f.Fc;this.gib=f.end;this.nwh=f.nodeId;this.Clh=f.LWa;this.Kk=f.type;this.Knh=f.mde}static createInstance(f,a,l,w,y,v){const {FindManagerHelper:u}=d(1622);return new m(f,a,l,w,y,v,u.instance)}}m.tLk=0;Object(G.a)(m,"FindResult",null,[581])},1947:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);var m=d(2);d=d(89);class f{static F0k(a){f.tTg.addHandler(f.L4h,a)}static Tlo(a){m.AFrameworkApplication.K.$("SqmCommandEventSourceEnabled")&&f.tTg.raiseEvent(f.L4h,a)}}f.L4h="CommandClickEvent";f.tTg=
new d.a;Object(G.a)(f,"CommandClickEvents",null,[])},1948:function(G,J){Object.defineProperty(J,"__esModule",{value:!0});J.ErrorCode=J.FormattingSuggestionsRange=J.FormattingSuggestionType=void 0;(function(d){d[d.FontSize=0]="FontSize";d[d.FontFamily=1]="FontFamily";d[d.FontColor=2]="FontColor";d[d.Alignment=3]="Alignment";d[d.Indentation=4]="Indentation";d[d.Bold=5]="Bold";d[d.RightIndentation=6]="RightIndentation";d[d.Italic=7]="Italic";d[d.Underline=8]="Underline";d[d.AllCaps=9]="AllCaps";d[d.LineSpacing=
10]="LineSpacing";d[d.BeforeSpacing=11]="BeforeSpacing";d[d.AfterSpacing=12]="AfterSpacing";d[d.SpecialIndentType=13]="SpecialIndentType";d[d.SpecialIndentBy=14]="SpecialIndentBy";d[d.FontKerning=15]="FontKerning"})(J.FormattingSuggestionType||(J.FormattingSuggestionType={}));(function(d){d[d.Paragraph=0]="Paragraph";d[d.List=1]="List"})(J.FormattingSuggestionsRange||(J.FormattingSuggestionsRange={}));(function(d){d[d.Success=0]="Success";d[d.DocumentTooLarge=1]="DocumentTooLarge"})(J.ErrorCode||
(J.ErrorCode={}))},1949:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.FormattingSuggestionsSummaryAnnotation=J.FormattingSuggestionsAnnotation=void 0;const m=d(277);class f{constructor(l){m.SchemaObject.assign(f,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,
[f.getTypeName()])}}J.FormattingSuggestionsAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}J.FormattingSuggestionsSummaryAnnotation=a;a.H_={T_:a.getTypeName(),
B_:a.getBaseTypes()}},1950:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},1951:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.PullQuotesSignal=J.DocumentPullQuoteAnnotation=J.PullQuoteAnnotation=void 0;const m=d(277);class f{constructor(w){m.SchemaObject.assign(f,this,w)}get metadata(){return this.M_}set metadata(w){this.M_=w}static getTypeName(){return"AugLoop_PullQuotes_PullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,
[f.getTypeName()])}}J.PullQuoteAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(w){m.SchemaObject.assign(a,this,w)}get metadata(){return this.M_}set metadata(w){this.M_=w}static getTypeName(){return"AugLoop_PullQuotes_DocumentPullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[a.getTypeName()])}}J.DocumentPullQuoteAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(w){m.SchemaObject.assign(l,
this,w)}static getTypeName(){return"AugLoop_PullQuotes_PullQuotesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(w){return m.SchemaObject.matchesTypesFor(w,[l.getTypeName()])}}J.PullQuotesSignal=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},1952:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},1953:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},1954:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},1955:function(G,J,
d){Object.defineProperty(J,"__esModule",{value:!0});J.TextToImageAnnotation=void 0;var m=d(277);G=function(){function f(a){m.SchemaObject.assign(f,this,a)}Object.defineProperty(f.prototype,"metadata",{get:function(){return this.M_},set:function(a){this.M_=a},enumerable:!1,configurable:!0});f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageAnnotation"};f.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};
f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();J.TextToImageAnnotation=G},1956:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.TextToImageSignal=void 0;var m=d(277);G=function(){function f(a){m.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageSignal"};f.getBaseTypes=function(){return["AugLoop_TextToSuggestions_TextToSuggestionSignal","AugLoop_Signals_Signal"]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();J.TextToImageSignal=G},1957:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.TextToImageTraceSignal=void 0;var m=d(277);G=function(){function f(a){m.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageTraceSignal"};f.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_=
{T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();J.TextToImageTraceSignal=G},1958:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},1959:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.ThemeExtractorSignal=J.ThemeExtractorAnnotation=void 0;const m=d(277);class f{constructor(l){m.SchemaObject.assign(f,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,
[f.getTypeName()])}}J.ThemeExtractorAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}J.ThemeExtractorSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1960:function(G,J){Object.defineProperty(J,"__esModule",{value:!0});J.TableType=
void 0;G=J.TableType||(J.TableType={});G[G.Other=0]="Other";G[G.SimpleHeaded=1]="SimpleHeaded"},1961:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.TableTypeAnnotation=void 0;const m=d(277);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_TableAnalysis_TableTypeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])}}J.TableTypeAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1962:function(G,J,d){d.d(J,"a",function(){return z});G=d(0);d(1635);var m=d(1694),f=d(2),a=d(19);d(1623);d(34);var l=d(7),w=d(1461),y=d(17),v=d(128),u=d(8),x=d(23);class z{constructor(A=2E3){this.TRk=/(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)?/g;this.Fjb=A}Bgn(){z.CR();return!0}Atn(){return!0}getSelectedText(){const A=z.CR();return this.r9d(A)}WNf(){const A=
z.CR();return this.VJm(A)}r9d(A){return this.ZGi(A,!0)}VJm(A){return this.ZGi(A,!1)}ZGi(A,D){try{return this.UJm(A,D)}catch(F){l.ULS.sendTraceTag(545869845,1303,15,"Error accessing selection: {0}",F)}return Object.assign(new m.a,{neighborhood:"",mentionStart:0,mentionLength:0})}UJm(A,D){var F=null;let I=!1;D&&A&&A.ly&&y.SelectionEditor.mf(A.Ra)&&y.SelectionEditor.Ftb(A.Ra)&&(l.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),I=y.SelectionEditor.mf(A.Ra),(F=
y.SelectionEditor.i7(A.Ra,!1))&&F.ly&&0<=F.Ra.cpBegin&&0<=F.Ra.cpEnd&&1>=F.Ra.cpEnd-F.Ra.cpBegin&&(F=null));F&&(A=F);if(!A)return Object.assign(new m.a,{neighborhood:"",mentionStart:0,mentionLength:0});const H=new Sys.StringBuilder;F=D=0;const N=[],M=A.length;let U=null;for(let Q=0;Q<M;Q++){var O=A.J(Q);if(!u.ParagraphReader.Xb(O.node)||Array.contains(N,O.node.Uj))continue;N.push(O.node.Uj);const S=w.a.create(O.cpBegin,O.cpEnd),P=u.ParagraphReader.Ipb(O.node,v.AParagraphNode.Q0c,null,S);f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",
!1)&&I&&(U=this.w5l(P,S.Ad));let T=P,Z=0;var V=u.ParagraphReader.zg(O.node,!0,!0,!0);O=u.ParagraphReader.zg(O.node,!1,!0,!0);let X=0;for(;T.length<this.Fjb&&(V||O);){if(!(X%2)&&V){var Y=u.ParagraphReader.text(V,v.AParagraphNode.Q0c);Y&&(T=Y+" "+T,Z+=Y.length+1);V=u.ParagraphReader.zg(V,!0,!0,!0)}1===X%2&&O&&(T=(Y=u.ParagraphReader.text(O,v.AParagraphNode.Q0c))?T+" "+Y:T,O=u.ParagraphReader.zg(O,!1,!0,!0));X++}V=Q===M-1;Q||-1===S.Ad||(D=S.Ad);F+=V&&-1!==S.endCp?S.endCp:P.length;H.append(T);f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",
!1)&&I&&U&&(D=U.start,F=U.start+U.length);D+=Z;F+=Z;V||(H.append(" "),F++)}for(A=v.AParagraphNode.iV(H.toString()," ");D<F&&a.a.Qw(A.charCodeAt(D));)D++;for(;F>D&&a.a.Qw(A.charCodeAt(F-1));)F--;return this.v3k(A,D,F)}w5l(A,D){for(var F;null!==(F=this.TRk.exec(A));){const I=F.index;F=F[0].length;if(D>=I&&D<=I+F)return{start:I,length:F}}return null}v3k(A,D,F){if(A.length>this.Fjb){var I=F-D;if(I>this.Fjb)A=A.substr(D,this.Fjb),F=this.Fjb,D=0;else{I=Math.max(D-Math.floor((this.Fjb-I)/2),0);let H;H=Math.min(I+
this.Fjb,A.length);I=Math.max(H-this.Fjb,0);D-=I;F-=I;A=A.substring(I,H)}}return Object.assign(new m.a,{neighborhood:A,mentionStart:D,mentionLength:F-D})}static CR(){var A=x.StaticActiveAppFrame.za().ib.sc;if(!A)return l.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;A=A.lb;return A&&A.gb&&A.gb.length?A.gb.currentSelection:(l.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(G.a)(z,"Box4InsightsSelection",null,[519,520])},1963:function(G,
J,d){d.d(J,"a",function(){return m});G=d(0);d=d(442);class m extends d.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(G.a)(m,"IconGalleryButtonProps",d.a,[])},1964:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.y=this.x=0}}Object(G.a)(m,"IPoint",null,[])},1965:function(G,J,d){d.d(J,"a",function(){return a});G=d(0);var m=d(19),f=d(7);d=d(1655);class a extends d.a{constructor(l,
w,y,v,u){super(l,w,u);this.Pk=y;this.xFh=u}KAc(l){let w;if(this.xT&&!l)return f.ULS.sendTraceTag(594408835,307,10,"No htmlDomContent"),{returnValue:!1,Cka:null};if(this.xFh){if(this.Pk)return w=this.Pk.Wjg(l,!1),{returnValue:!0,Cka:w};f.ULS.sendTraceTag(592269661,307,10,"_clipboardDataHelper should not be null")}w=document.createElement("div");l=l.split(RegExp("\r\n|\r|\n"));for(var y=0;y<l.length-1;y++){const v=document.createElement("p");v.innerText=this.Ibd(l[y]);w.appendChild(v)}y=document.createElement("span");
y.innerText=m.a.r_c(l[l.length-1]);w.appendChild(y);return{returnValue:!0,Cka:w}}Ibd(l){return m.a.r_c(l.length?l:" ")}}Object(G.a)(a,"MultiLineTextImportStrategy",d.a,[])},1966:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(934);class m extends d.a{constructor(f,a,l,w,y=null,v=0,u=0,x=null,z=null,A=null,D=null){super(y?y.jca:null,y?y.mD:null,y?y.xDa:null,y?y.cultureName:null,y?y.dIa:null);this.src=f;this.alt=a;this.width=l;this.height=w;this.maxWidth=v;this.maxHeight=u;this.href=x;this.iRl=
z;this.OCf=A;this.oWd=D}}Object(G.a)(m,"ImageSemanticArgs",d.a,[])},1967:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a,l,w=!1){this.YOb=f;this.e5i=a;this.Ikl=l;this.xvn=w}}Object(G.a)(m,"ClearSpecificFormattingProperties",null,[])},1970:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},1971:function(G,J){Object.defineProperty(J,"__esModule",{value:!0});J.SuggestionCategory=void 0;G=J.SuggestionCategory||(J.SuggestionCategory={});G[G.TextRelatedImage=
0]="TextRelatedImage";G[G.AbstractImage=1]="AbstractImage";G[G.Icon=2]="Icon"},1972:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},1973:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},1974:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.TextToSuggestionSignal=void 0;var m=d(277);G=function(){function f(a){m.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToSuggestions_TextToSuggestionSignal"};f.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};
f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();J.TextToSuggestionSignal=G},1975:function(G,J,d){d.d(J,"a",function(){return w});G=d(0);var m=d(96),f=d(202),a=d(7),l=d(122);class w{constructor(y,v,u,x,z,A,D,F,I){this.fQd=0;this.AZ=null;this.Klb="";this.U7b=this.OSe=!1;this.nRa=this.T$=null;this.Ztg=!1;this.b7b=null;this.Gbp=H=>{this.nRa===H&&(this.nRa=null,this.T$?this.Klb=this.dja.Yhd(this.AZ.text):(this.deg(),
this.E0c(null)),this.nXj())};this.E0c=()=>{this.T$=null;if(!this.Vnf())if(!this.dja.uXb(this.Klb).length)this.Ymb(),this.Dyb(!0);else if(!this.rvg())switch(this._state){case 0:this.eFp();break;case 1:this.bzj()}};this.sib=y;this.dja=v;this.Avk=u;this.wq=x;this.Q_e=z;this.AHb=A;this.Ivk=D;this.c7b=F;this.zk=I;this._state=2;this.lO=0}get KOg(){return this.fQd}set KOg(y){this.fQd=y}get HBc(){return this.fQd}set HBc(y){this.fQd=y}get Qi(){return this.Q_e.value}get zZb(){return this.AHb.value}get dmd(){return this.Ivk.value}get o8l(){return this.OSe}Dyb(y){(this.OSe=
y)&&this.sib&&this.sib.Fic()}get ZDf(){return null}get E3d(){return this.b7b}find(y){this.AZ=y;this.Rrl();this.nRa=new m.a(2,1,this.KOg,this.Gbp,51);this.Qi.Zb(this.nRa)}F6a(){}qvg(){}uLi(){}zLi(){}iOi(){return!1}Rrl(){this.T$&&(this.Qi.vf(this.T$),this.T$=null);this.nRa&&(this.Qi.vf(this.nRa),this.nRa=null)}eFp(){var y=(new Date).getTime();this.Gjj();const v=this.fFp(y);this._state||(this.T$=new m.a(2,1,this.HBc,this.E0c,52),this.Qi.Zb(this.T$));y=(new Date).getTime()-y;a.ULS.sendTraceTag(17306246,
313,50,"{0}",{["Extension Walk Time"]:y,["Count"]:v})}FQf(y,v,u=!0){this.K1h(y);if(Object(l.a)(45,y))if(12===y.type)this.xTm(y,v,this.U7b,u);else{const x=this.wq.$Qb(y.$Va(),this.E3d);u&&(x&&0<x.length?this.w_a(y,x):y.ora());u=this.wq.gke(y.id,x,null,v,this.U7b);this.wRd(y.id,u,y,v);this.n8f(y)}}xTm(y,v,u,x=!0){const z=[];var A=this.wq.yyi(y);if(!f.a.Tf(A)&&(this.n8f(y),x))for(const I of A)A=this.wq.$Qb(I.$Va(),this.E3d),f.a.Tf(A)?this.ora(I):(this.w_a(I,A),z.push(A));const [D,F]=this.wq.dvm(y,this.E3d);
this.ora(y);!f.a.Tf(D)&&x&&this.w_a(y,D);u=this.wq.gke(y.id,F,z,v,u);this.wRd(y.id,u,y,v)}fFp(y){let v=this._state=0;const u=this.PHi();this.Luj();const x=this.rQj();do this.Xhg(),v++;while(this.jrf(u)&&(new Date).getTime()-y<w.odj);x&&x.dispose();this.Ndg();return v}deg(){}nXj(){}Vnf(){return!1}Ymb(){}rvg(){return!1}bzj(){}Gjj(){}K1h(){}w_a(){}ora(){}n8f(){}wRd(){}Ndg(){}PHi(){return null}Luj(){}rQj(){return null}Xhg(){}jrf(){return!1}}w.odj=200;Object(G.a)(w,"BaseFindManager",null,[1758])},1976:function(G,
J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a,l){this.rootNode=f;this.Uca=a;this.Mic=l}}Object(G.a)(m,"FindNodeContext",null,[])},1982:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a=null,l=null,w=null){this.iconSet={};this.iconSet["default"]=f;this.iconSet.icon16=a;this.iconSet.icon24=l;this.iconSet.icon32=w}}Object(G.a)(m,"IconSetContainer",null,[])},1985:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(492);class m extends d.a{constructor(){super()}}
m.ysf="conversionRequestType";m.glg="png";m.gGf="gc2json";m.sBe="strict";m.$3l="existingcontent";m.error="error";Object(G.a)(m,"GraphicsEditorParameters",d.a,[])},2003:function(G,J){J.read=function(d,m,f,a,l){var w=8*l-a-1;var y=(1<<w)-1,v=y>>1,u=-7;l=f?l-1:0;var x=f?-1:1,z=d[m+l];l+=x;f=z&(1<<-u)-1;z>>=-u;for(u+=w;0<u;f=256*f+d[m+l],l+=x,u-=8);w=f&(1<<-u)-1;f>>=-u;for(u+=a;0<u;w=256*w+d[m+l],l+=x,u-=8);if(0===f)f=1-v;else{if(f===y)return w?NaN:Infinity*(z?-1:1);w+=Math.pow(2,a);f-=v}return(z?-1:
1)*w*Math.pow(2,f-a)};J.write=function(d,m,f,a,l,w){var y,v=8*w-l-1,u=(1<<v)-1,x=u>>1,z=23===l?Math.pow(2,-24)-Math.pow(2,-77):0;w=a?0:w-1;var A=a?1:-1,D=0>m||0===m&&0>1/m?1:0;m=Math.abs(m);isNaN(m)||Infinity===m?(m=isNaN(m)?1:0,a=u):(a=Math.floor(Math.log(m)/Math.LN2),1>m*(y=Math.pow(2,-a))&&(a--,y*=2),m=1<=a+x?m+z/y:m+z*Math.pow(2,1-x),2<=m*y&&(a++,y/=2),a+x>=u?(m=0,a=u):1<=a+x?(m=(m*y-1)*Math.pow(2,l),a+=x):(m=m*Math.pow(2,x-1)*Math.pow(2,l),a=0));for(;8<=l;d[f+w]=m&255,w+=A,m/=256,l-=8);a=a<<
l|m;for(v+=l;0<v;d[f+w]=a&255,w+=A,a/=256,v-=8);d[f+w-A]|=128*D}},2004:function(G){var J={}.toString;G.exports=Array.isArray||function(d){return"[object Array]"==J.call(d)}},2013:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f){this.iO=0;this.pHd=isFinite(f)?Math.max(f,8):8;this.fq=Array(this.pHd);this.Jk=this.Plb=this.y4a=0;this.edh=this.Hwi(this.pHd)}get count(){return this.Jk}get isEmpty(){return!this.count}enqueue(f){this.count===this.iO&&this.g4m();this.fq[this.Plb]=
f;this.Plb++;this.Plb===this.iO&&(this.Plb=0);this.Jk=this.count+1}dequeue(){if(!this.count)throw Error.create("Empty Queue");const f=this.fq[this.y4a];this.y4a++;this.y4a===this.iO&&(this.y4a=0);this.Jk=this.count-1;this.count<=this.edh&&this.ANl();return f}L0(){if(!this.count)throw Error.create("Empty Queue");return this.fq[this.y4a]}g4m(){this.SOj(2*this.iO)}ANl(){const f=Math.max(this.iO/2,this.pHd);this.count>f||this.SOj(f)}SOj(f){const a=Array(f);let l=0;if(this.y4a<this.Plb||!this.count)for(var w=
this.y4a;w<this.Plb;w++)a[l]=this.fq[w],l++;else{for(w=this.y4a;w<this.iO;w++)a[l]=this.fq[w],l++;for(w=0;w<this.Plb;w++)a[l]=this.fq[w],l++}this.fq=a;this.iO=f;this.y4a=0;this.Plb=l;this.edh=this.Hwi(f)}Hwi(f){return f<=this.pHd?-1:Math.floor(.25*f)}}Object(G.a)(m,"Queue",null,[])},2023:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);var m;(function(f){f[f.none=0]="none";f[f.Ugq=1]="reasonDefaultLabel";f[f.Wgq=2]="reasonManual";f[f.Tgq=4]="reasonAutomatic";f[f.Xgq=8]="reasonRecommended";f[f.Vgq=
16]="reasonMandatory"})(m||(m={}));Object(G.b)("ApplyLabelFlags",m)},2024:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);var m;(function(f){f[f.unknown=0]="unknown";f[f.qlf=1]="boot";f[f.refresh=2]="refresh";f[f.KNo=3]="selfSetPolicyLabel"})(m||(m={}));Object(G.b)("GetPolicyLabelsReason",m)},2025:function(G,J,d){var m=this&&this.xM||(Object.create?function(a,l,w,y){void 0===y&&(y=w);Object.defineProperty(a,y,{enumerable:!0,get:function(){return l[w]}})}:function(a,l,w,y){void 0===y&&(y=w);
a[y]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(2026),J);f(d(2027),J)},2026:function(G,J){Object.defineProperty(J,"__esModule",{value:!0})},2027:function(G,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.Security=J.DLP=J.CLP=J.SecurityShared=J.SeedAnnotation=J.EditAnnotation=J.SensitiveItemFullDocumentAnnotation=J.SensitiveItemRangeAnnotation=void 0;
const m=d(277);class f{constructor(z){m.SchemaObject.assign(f,this,z)}get metadata(){return this.M_}set metadata(z){this.M_=z}static getTypeName(){return"AugLoop_SecurityShared_SensitiveItemRangeAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}}J.SensitiveItemRangeAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(z){m.SchemaObject.assign(a,this,z)}get metadata(){return this.M_}set metadata(z){this.M_=z}static getTypeName(){return"AugLoop_SecurityShared_SensitiveItemFullDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
J.SensitiveItemFullDocumentAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(z){m.SchemaObject.assign(l,this,z)}get metadata(){return this.M_}set metadata(z){this.M_=z}static getTypeName(){return"AugLoop_SecurityShared_EditAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}J.EditAnnotation=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class w{constructor(z){m.SchemaObject.assign(w,this,z)}get metadata(){return this.M_}set metadata(z){this.M_=z}static getTypeName(){return"AugLoop_SecurityShared_SeedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
J.SeedAnnotation=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class y{constructor(z){m.SchemaObject.assign(y,this,z)}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static getBaseTypes(){return[]}}J.SecurityShared=y;y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class v{constructor(z){m.SchemaObject.assign(v,this,z)}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}J.CLP=v;v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};
class u{constructor(z){m.SchemaObject.assign(u,this,z)}static getTypeName(){return"AugLoop_SecurityShared_DLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}J.DLP=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class x{constructor(z){m.SchemaObject.assign(x,this,z)}static getTypeName(){return"AugLoop_SecurityShared_Security"}static getBaseTypes(){return[]}}J.Security=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()}},2061:function(G,J,d){d.d(J,"a",function(){return f});var m=
d(756),f=function(a){function l(w){var y=this.constructor,v=a.call(this)||this;v.sourceToken=w;v.name="CancelError";v.message="Operation was cancelled";Object.setPrototypeOf(v,y.prototype);return v}Object(m.h)(l,a);l.typeGuard=function(w){return w instanceof Error&&"CancelError"===w.name&&w.hasOwnProperty("sourceToken")};return l}(Error)},2084:function(G,J,d){d.r(J);G=d(0);var m=d(2),f=d(96),a=d(2179),l=d(7),w=d(84),y=d(104),v=d(122),u=d(286),x=d(590),z=d(362),A=d(87),D=d(3),F=d(68),I=d(44),H=d(1135),
N=d(6),M=d(107);class U extends F.a{constructor(){super(new M.a(33));this.aEf=this.rwg=0}Rbe(){return 0}PMa(){const ub=new I.GraphTransaction(3);ub.Ab(this);const Yb=new N.GraphIterator;Yb.set(this);if(Yb.WA()){const yb=Yb.Xd();Yb.set(yb);const Za=H.b(Yb,this.rwg,this.aEf),Ya=new N.GraphIterator;Ya.set(this);Ya.Xd();Ya.eh();Za&&Yb.currentNode!==yb&&Ya.Uf(Yb.currentNode,-2)}ub.dispose()}}Object(G.a)(U,"FindTrackingNode",F.a,[]);var O=d(17),V=d(52),Y=d(8),Q=d(1975),S=d(1976);class P{constructor(ub){this.Zc=
ub;ub=[];ub.push(1);this.supportedTypes=ub}xyi(ub){const Yb=this.Zc.Ql();Yb.set(ub);const yb=[];Yb.zb(8)&&(Yb.ld(8),yb.push(new S.a(Yb.currentNode,ub,1)));return yb}static LG(){return new P(new x.a)}static get instance(){return null!=P.zZg?P.zZg:P.zZg=P.LG()}}Object(G.a)(P,"FindContextHelper",null,[272]);var T=d(1622),Z=d(381),X=d(119),aa=d(16),ia=d(23);class wa{constructor(ub,Yb,yb,Za,Ya,Pa,rb,tb,ob){this.kp=null;this.y7b=this.qUe=!1;this.Nhb=this.J8g=this.dhb=null;this.ACh=!1;this.LN=(Oa,Xa)=>{Oa=
Xa.node;Xa.property===aa.a.Un&&this.i$c(Oa)&&this.cRb(Oa,3)};this.Mvb=(Oa,Xa)=>{Oa=Xa.node;this.i$c(Oa)&&this.cRb(Oa,2)};this.Hma=(Oa,Xa)=>{Oa=Xa.node;Xa=Xa.aee;!this.zC.o8l&&Xa||!this.i$c(Oa)||this.cRb(Oa,1)};this.Jgo=()=>{const Oa=this.Vd.Vf("UserAction","ProcessDirtyNodesInFindResultsTime");this.kp=null;const Xa=this.Pc.Mc(3);Xa.Ab(this.wq.$c);0<this.addedNodes.count&&(this.y7b=!0,this.qbh(this.addedNodes,this.zC.zk));0<this.UYc.count&&this.qbh(this.UYc,this.zC.zk);if(0<this.inb.count){const ab=
!this.AKk(this.inb,this.zC,this.wq,this.zKk);this.y7b=this.y7b||ab}Xa.dispose();this.zC.zk.jAb();this.vyb(this.y7b);this.QJj();Oa.stop()};this.xLo=()=>{this.IVc();if(0<this.inb.count||0<this.addedNodes.count||0<this.UYc.count)this.kp=new f.a(2,1,500,this.Jgo,53),this.Gb.Zb(this.kp)};this.zC=ub;this.iZ=Yb;this.wq=yb;this.Gb=Za;this.Pc=Ya;this.qbh=Pa;this.AKk=rb;this.zKk=tb;this.Vd=ob;this.reset();this.QJj=this.xLo;this.wq.Xte(this.LN,this.Hma,this.Mvb)}get inb(){return this.dhb}get addedNodes(){return this.J8g}get UYc(){return this.Nhb}get fHj(){return this.ACh}get nYm(){return 0<
this.inb.count||0<this.UYc.count}start(){this.qUe=!0;this.vyb(!1)}stop(){this.reset()}reset(){this.qUe=!1;this.vyb(!1);this.dhb=new Z.a;this.J8g=new Z.a;this.Nhb=new Z.a;this.IVc()}i$c(ub){return!!ub.Lc&&!!this.wq.Ej&&ub.Lc.id.equals(this.wq.Ej.id)}cRb(ub,Yb){if(this.qUe&&Object(v.a)(45,ub)&&!this.zC.zZb.pld)if(this.zC.zk.kfb||this.zC.zk.gub.length){switch(Yb){case 1:this.inb.mb(ub.id)||this.addedNodes.Z(ub.id,ub);break;case 2:this.inb.mb(ub.id)&&this.inb.remove(ub.id);this.addedNodes.mb(ub.id)?this.addedNodes.remove(ub.id):
this.UYc.Z(ub.id,ub);break;case 3:this.inb.Z(ub.id,ub)}this.QJj()}else 2!==Yb&&this.vyb(this.y7b=!0)}IVc(){this.kp&&(this.Gb.vf(this.kp),this.kp=null)}vyb(ub){this.fHj!==ub&&(this.ACh=ub,this.iZ.vyb(ub));ub||(this.y7b=!1)}static LG(ub,Yb){return new wa(ub,Yb,T.FindManagerHelper.instance,X.a.instance,new z.a,wa.krl,wa.ywo,wa.xwo,ia.StaticActiveAppFrame.za().hs)}static createInstance(ub,Yb){return wa._instance||(wa._instance=wa.LG(ub,Yb))}static ywo(ub,Yb,yb,Za){let Ya=!1;const Pa=wa.eKi(ub,wa.$Jn);
for(let rb=0;rb<Pa.length;++rb){const tb=!Za(Pa[rb],Yb,yb);Ya=Ya||tb;ub.remove(Pa[rb].id)}return!Ya}static xwo(ub,Yb,yb){const Za=Yb.zk;ub.ora();const Ya=ub.id,Pa=Za.alc(Ya);if(Pa)Yb=yb.$Qb(ub.$Va(),Yb.E3d),yb=yb.gke(Ya,Yb,null,Pa.type,Pa.mde),ub.w_a(Yb),Za.Yue(Ya,yb);else return!1;return!0}static krl(ub,Yb){const yb=wa.eKi(ub,wa.ZJn);for(let Za=0;Za<yb.length;++Za){const Ya=yb[Za],Pa=Ya.id;Ya.ora();Yb.Rkd(Pa);ub.remove(Pa)}}static eKi(ub,Yb){const yb=[];let Za=Yb;ub.forEach((Ya,Pa)=>{yb.push(Pa);
--Za;return Za?!0:!1});return yb}}wa.$Jn=5;wa.ZJn=15;wa._instance=null;Object(G.a)(wa,"FindResultAppEventCoordinator",null,[1788]);class ma{constructor(ub,Yb){this.$Ib=this.f4b=0;this.GFc=this.qQc=this.Boa=null;this.qbc=0;this.aFb=null;this.iZ=ub;this.mpa=Yb;this.L4a=new Z.a;this.EHb=new Z.a;this.Qjb=new Z.a;this.Vhb=new Z.a;this.K4a=new Z.a(0);this.LOc=new Z.a;for(ub=0;ub<Yb.length;++ub)this.K4a.Z(Yb[ub],0);this.gub=[]}get AG(){return this.Boa}set AG(ub){this.Boa=ub;ub=Array(1);ub[0]=this.Boa;this.iZ.AVa(3,
ub)}get Vca(){return this.qQc}set Vca(ub){this.qQc=ub}get W6(){return this.GFc}set W6(ub){this.GFc=ub}get nKa(){let ub=null;for(const Yb of this.mpa)if(ub=this.L4a.J(Yb))break;return ub}get oef(){return this.f4b}Sye(ub){ub!==this.f4b&&(this.f4b=ub)}get doa(){return this.$Ib}Axc(ub){ub!==this.$Ib&&(this.$Ib=ub,this.iZ&&!this.$Ib&&(this.iZ.hxe(0),this.iZ.Lye(0)))}get kfb(){return this.qbc}get kqc(){return this.aFb}yef(ub,Yb){if(ub&&!(0>=ub.length)){var yb=ub[0].type,Za=Yb,Ya=Za?Za.next:this.L4a.J(yb);
Za||this.L4a.Z(yb,ub[0]);for(const Pa of ub){const rb=Pa;this.LOc.Z(rb.id,rb);Za&&(Za.next=rb);rb.Rv=Za;Za=rb}Za&&(Za.next=Ya);Ya&&(Ya.Rv=Za);Yb&&ub[0].nodeId.equals(Yb.nodeId)||this.Qjb.Z(ub[0].nodeId,ub[0]);!Ya&&Za&&this.EHb.Z(Za.type,Za);this.kqc===Yb&&(this.aFb=Za);this.K4a.Z(yb,this.K4a.J(yb)+ub.length);this.Axc(this.doa+ub.length);this.qbc=this.kfb+ub.length;this.iZ&&this.iZ.AVa(0,ub)}}CRd(ub){!ub||0>=ub.length||this.yef(ub,this.EHb.J(ub[0].type))}OMh(ub){!ub||0>=ub.length||(this.kqc&&this.kqc.type!==
ub[0].type&&(this.aFb=null),this.yef(ub,this.kqc))}Rkd(ub){const Yb=this.alc(ub);if(Yb){ub=Yb;for(var yb=0;ub;){++yb;if(!ub.next||!ub.nodeId.equals(ub.next.nodeId))break;ub=ub.next}this.ZCj(Yb,ub)}else l.ULS.sendTraceTag(4069027,313,15,"RemoveResultsForNode called for node not in cache: {0}",ub.toString())}ZCj(ub,Yb){let yb=0,Za=0;const Ya=[];let Pa=ub;for(;Pa!==Yb.next;){const rb=this.Q1i(Pa);this.Qjb.J(Pa.nodeId).id===Pa.id&&(Pa.next&&Pa.next.nodeId.equals(Pa.nodeId)?(this.Qjb.Z(Pa.nodeId,Pa.next),
rb&&this.Vhb.Z(Pa.nodeId,Pa.next)):(this.Qjb.remove(Pa.nodeId),rb&&this.Vhb.remove(Pa.nodeId)));this.kqc&&this.kqc.id===Pa.id&&(this.aFb=ub.Rv);this.Vca&&this.Vca.id===Pa.id&&(this.Vca=this.jMf(Pa,ub));this.W6&&this.W6.id===Pa.id&&(this.W6=this.jMf(Pa,ub));this.AG&&this.AG.id===Pa.id&&(this.AG=this.jMf(Pa,ub));this.LOc.remove(Pa.id);Ya.push(Pa);Pa=Pa.next;rb?++Za:++yb}ub.Rv?ub.Rv.next=Yb.next:Yb.next?this.L4a.Z(Yb.type,Yb.next):this.L4a.remove(Yb.type);Yb.next?Yb.next.Rv=ub.Rv:ub.Rv?this.EHb.Z(ub.type,
ub.Rv):this.EHb.remove(ub.type);Yb.next=null;ub.Rv=null;this.K4a.Z(ub.type,this.K4a.J(ub.type)-yb);this.Axc(this.doa-yb);this.qbc=this.kfb-(yb+Za);this.iZ&&this.iZ.AVa(1,Ya)}Yue(ub,Yb){const yb=this.alc(ub);if(yb){const Za=[],Ya=[],Pa=[];let rb=yb,tb,ob=0;do ob<Yb.length?(rb.kYd(Yb[ob]),Za.push(rb)):(Ya.push(rb),this.Vca&&this.Vca.id===rb.id&&0<Za.length&&(this.Vca=Za[Za.length-1])),++ob,tb=rb,rb=rb.next;while(rb&&tb.nodeId.equals(rb.nodeId));for(;ob<Yb.length;++ob)Pa.push(Yb[ob]);0<Ya.length&&this.ZCj(Ya[0],
Ya[Ya.length-1]);0<Pa.length&&this.yef(Pa,0<Za.length?Za[Za.length-1]:yb);Yb=Za.length;if(0<Yb){if(this.Vhb.mb(ub)){this.Vhb.remove(ub);this.Axc(this.doa+Yb);let Oa,Xa;(Oa=this.K4a).Z(Xa=Za[0].type,Oa.J(Xa)+Yb)}this.iZ&&this.iZ.AVa(4,Za)}}else l.ULS.sendTraceTag(4069056,313,15,"ReplaceResultsForNode: NodeId not found in cache nodeId={0}",ub.toString())}s3h(){this.Qjb=new Z.a;this.Vhb=new Z.a;this.L4a=new Z.a;this.EHb=new Z.a;this.LOc=new Z.a;for(let ub=0;ub<this.mpa.length;++ub)this.K4a.Z(this.mpa[ub],
0);this.AG=null;this.Sye(0);this.W6=this.Vca=this.aFb=null;this.Axc(0);this.qbc=0;this.iZ&&this.iZ.AVa(2,null)}xcj(){this.Vhb=new Z.a;this.Qjb.forEach((ub,Yb)=>{this.Vhb.Z(ub,Yb);return!0});for(let ub=0;ub<this.mpa.length;++ub)this.K4a.Z(this.mpa[ub],0);this.AG=null;this.Sye(0);this.aFb=null;this.Axc(0);this.iZ&&this.iZ.AVa(2,null)}alc(ub){return this.Qjb.mb(ub)?this.Qjb.J(ub):null}HR(ub){let Yb=null;this.LOc.mb(ub)&&(Yb=this.LOc.J(ub));return Yb}Kyi(ub){return this.L4a.mb(ub)?this.L4a.J(ub):null}Fxm(ub){return this.EHb.mb(ub)?
this.EHb.J(ub):null}jAb(){var ub=0;if(this.AG){ub=0;const Za=this.AG.type;var Yb=this.L4a.J(Za);if(Yb){for(var yb=1;Yb&&this.AG.id!==Yb.id;)this.Q1i(Yb)||++yb,Yb=Yb.next;Yb&&(ub=yb)}if(Yb){Yb=0;for(yb=0;yb<this.mpa.length&&this.mpa[yb]!==Za;++yb)Yb+=this.K4a.J(this.mpa[yb]);ub=Yb+ub}else l.ULS.sendTraceTag(4069057,313,10,"UpdateActiveIndexFromActiveResult, active result not found in cache, setting it to null"),this.AG=null,ub=0}this.Sye(ub);this.iZ&&(this.iZ.hxe(this.oef),this.iZ.Lye(this.doa))}z9a(ub){return this.g8d(ub,
!1)}W8d(ub){return this.g8d(ub,!0)}g8d(ub,Yb){let yb=Yb?ub.Rv:ub.next,Za=ub.type;for(;!yb&&(Za=this.qBm(Za,Yb),yb=Yb?this.Fxm(Za):this.Kyi(Za),Za!==ub.type););return yb||ub}ckc(ub){return this.Cvi(ub,!1)}nBi(ub){return this.Cvi(ub,!0)}Cvi(ub,Yb){let yb=this.g8d(ub,Yb);for(;yb.nodeId.equals(ub.nodeId)&&yb.id!==ub.id;)yb=this.g8d(yb,Yb);return yb}qBm(ub,Yb){let yb=0;for(let Za=0;Za<this.mpa.length;++Za)if(ub===this.mpa[Za]){yb=Za;break}Yb?(--yb,0>yb&&(yb=this.mpa.length-1)):(++yb,yb===this.mpa.length&&
(yb=0));return this.mpa[yb]}tGj(){this.aFb=null}jMf(ub,Yb){ub=this.z9a(ub);ub.id===Yb.id&&(ub=null);return ub}Q1i(ub){return this.Vhb.mb(ub.nodeId)}static createInstance(ub,Yb,yb=!1){return yb?new ma(ub,Yb):ma._instance||(ma._instance=new ma(ub,Yb))}}ma._instance=null;Object(G.a)(ma,"FindResultManager",null,[1760]);class na{constructor(ub,Yb){this.NSm=yb=>{const Za=this.wq.Ej.Eb(yb.nodeId);if(Za){if(this.aE.AG){var Ya=this.wq.Ej.Eb(this.aE.AG.nodeId);(Ya=Object(w.a)(45,Ya))?Ya.U2h():l.ULS.sendTraceTag(4069060,
313,15,"{0}",{["GoToResultInternal"]:"ActiveHitNodeNotFound",["NodeId"]:this.aE.AG.nodeId})}Za.b8f(yb.LWa,yb.type)?(this.aE.AG=yb,l.ULS.sendTraceTag(4065305,313,50,"{0}",{["GoToResultInternal"]:"Success",["ResultId"]:yb.id})):d(2084).FindManager.instance.iOi()?l.ULS.sendTraceTag(4575581,313,15,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Za.id,["HitIndexInNode"]:yb.LWa,["ResultId"]:yb.id}):l.ULS.sendTraceTag(4069061,313,10,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Za.id,["HitIndexInNode"]:yb.LWa,
["ResultId"]:yb.id});this.aE.jAb()}else l.ULS.sendTraceTag(4069059,313,10,"{0}",{["GoToResultInternal"]:"Invalid findResult.NodeId",["NodeId"]:yb.nodeId})};this.aE=ub;this.wq=Yb;this.lQf=this.NSm}xLi(){const ub=this.aE.AG?this.aE.z9a(this.aE.AG):this.aE.nKa;this.lQf(ub)}MSm(){const ub=this.aE.AG?this.aE.W8d(this.aE.AG):this.aE.nKa;this.lQf(ub)}CLi(ub){const Yb=this.aE.HR(ub);Yb?this.lQf(Yb):l.ULS.sendTraceTag(4069058,313,10,"{0}",{["GoToResult"]:"Invalid FindResult",["ResultId"]:ub})}static LG(ub){return new na(ub,
T.FindManagerHelper.instance)}static createInstance(ub){return na._instance||(na._instance=na.LG(ub))}}na._instance=null;Object(G.a)(na,"FindResultNavigator",null,[1759]);var Fa=d(19),Qa=d(1305);F=d(160);class ya{static uXb(ub){const Yb=[];var yb=RegExp('"[^"\\r\\n]*"',"ig"),Za=ub.match(yb);let Ya;if(Za&&0<Za.length)for(Ya=0;Ya<Za.length;Ya++){var Pa=Za[Ya].split('"').join("");Pa=Pa.trim();Pa=Pa.split(ya.qqd).join(" ");if(""!==Pa){Yb.push(Pa);var rb=Pa.split(ya.iYb).join(" ");rb=rb.trim();rb=rb.split(ya.qqd).join(" ");
""!==rb&&rb!==Pa&&Yb.push(rb)}}ub=ub.split(yb).join(" ");yb=Qa.a.instance.Njm(ub);if(!yb.length)return Yb.sort(ya.yWj),Yb;Za=yb[0];for(Ya=1;Ya<yb.length;Ya++)if(rb=yb[Ya],2!==Za.dO||2!==rb.dO)Pa=ub.substring(Za.cp,rb.cp),Pa=Pa.trim(),ya.I4i(Pa,Za)&&Yb.push(Pa),Za=rb;Pa=ub.substring(Za.cp,ub.length);Pa=Pa.trim();ya.I4i(Pa,Za)&&Yb.push(Pa);Yb.sort(ya.yWj);return Yb}static I4i(ub,Yb){return""!==ub&&'"'!==ub&&1!==Yb.dO}static uDo(ub){for(let Yb=0;Yb<ub.length;Yb++)ub[Yb]=ub[Yb].split(ya.qqd).join("\\s+");
return ub}static yWj(ub,Yb){return ub.length>Yb.length?-1:ub.length===Yb.length?0:1}}ya.iYb=RegExp("[\\[\\]\\\\\\^\\$\\.\\|\\+\\(\\)\\?\\*\\-_=,;:%!'<>/@#&{}]");ya.qqd=RegExp("\\s+");ya.bso=[new F.a(RegExp("\\[","g"),"\\["),new F.a(RegExp("\\]","g"),"\\]"),new F.a(RegExp("\\\\","g"),"\\\\"),new F.a(RegExp("\\^","g"),"\\^"),new F.a(RegExp("\\$","g"),"\\$"),new F.a(RegExp("\\.","g"),"\\."),new F.a(RegExp("\\|","g"),"\\|"),new F.a(RegExp("\\+","g"),"\\+"),new F.a(RegExp("\\(","g"),"\\("),new F.a(RegExp("\\)",
"g"),"\\)"),new F.a(RegExp("\\?","g"),"\\?"),new F.a(RegExp("\\*","g"),"\\*")];Object(G.a)(ya,"SearchAndFindUtils",null,[]);class ta{Yhd(ub){return Fa.a.Jka(ub,ya.bso)}uXb(ub){ub=ya.uXb(ub);return ub=ya.uDo(ub)}Puj(){return null}Yge(){return!1}static get instance(){return null!=ta.a_g?ta.a_g:ta.a_g=new ta}}Object(G.a)(ta,"QueryProcessor",null,[1579]);var Aa=d(789),oa=d(21),za=d(11),ja=d(28),fa=d(685),Ca=d(824),xa=d(287),ua=d(94),sa=d(256);class Ea{constructor(){this.qld=this.transaction=null;this.Rzb=
this.aug=0;this.Ytg=this.nob=null}}Object(G.a)(Ea,"ReplaceAllContext",null,[]);class Ja{constructor(ub,Yb,yb,Za,Ya,Pa,rb,tb,ob,Oa,Xa){this.mYn=(ab,cb,ib,Ub,lb)=>{let Qb=null;if(ab>cb)for(Qb=ib;0<cb&&Qb.nodeId.equals(lb.id);)Qb=this.aE.z9a(Qb),--cb;else 0<ab?Qb=this.aE.ckc(ib):Ub.nodeId!==lb.id&&(Qb=Ub);return Qb};this.k3h=()=>{const ab=this.aE.gub;if(ab&&0<ab.length){const cb=this.Pc.Mc(3);cb.Ab(this.wq.Ej.Eb(ab[0]));for(let ib=0;ib<ab.length;++ib){const Ub=this.wq.Ej.Eb(ab[ib]);Ub?Ub.ora(!1,!0):
l.ULS.sendTraceTag(4069064,313,10,"Last replaced node not found in object Space, NodeId: {0}",ab[ib])}cb.dispose();Array.clear(this.aE.gub)}};this.Y2n=(ab,cb)=>{this.DOc=!0;this.BCj();const ib=new Ea;ib.qld=ab?ab:"";ib.Ytg=cb;ib.Rzb=this.aE.doa;ab=this.Pc.Mc(15);ab.Ab(this.wq.$c);ib.transaction=ab;this.P3l(ib,ab)};this.DXn=(ab,cb)=>{ab=new Aa.a(null,this.Aho,ab);const ib=this.wq.$c;ib&&ib.CL().YG.laa(9);ab.vm("ReplaceAll");cb.lOa(ab);ab.run()};this.M0n=(ab,cb)=>{ab=this.Vd.Vf("UserAction","OnProcessReplaceAll");
if(this.Gpn(cb))return this.txl(cb),!1;let ib=cb.nob;ib||(ib=this.aE.nKa);cb.nob=this.aE.ckc(ib);const Ub=this.wq.Ej.Eb(ib.nodeId);if(!Ub)return l.ULS.sendTraceTag(4065307,313,10,"ReplaceAll: Node for result with id: {0} and nodeId: {1}, Not Found!",ib.id,ib.nodeId),!0;const lb=Ub.cWa();if(lb&&lb.length)if(this.Onl(Ub,lb[0].Fc,lb[0].end))l.ULS.sendTraceTag(5007254,313,50,"ReplaceAll: Skipping node: {0} as Paragraph is locked",Ub.id);else{let Qb=0;for(let fc=0;fc<lb.length;++fc){cb.aug+=1;const Fc=
this.replaceText(this.zC.ZDf,Ub,cb.qld,ja.a.createTextRange(Ub,lb[fc].Fc+Qb,lb[fc].end+Qb));Qb+=cb.qld.length-(lb[fc].end-lb[fc].Fc)+Fc;Ub.DAg(0,cb.qld.length)}0<cb.qld.length&&this.aE.gub.push(ib.nodeId)}else l.ULS.sendTraceTag(4065308,313,15,"ReplaceAll: No hits found for result with id: {0} and nodeId: {1}!",ib.id,ib.nodeId);ab.stop();return!0};this.iWn=ab=>{ab.transaction.dispose();this.DOc=!1;this.zC.F6a(!1);ab.Ytg&&ab.Ytg(ab.aug,ab.Rzb)};this.x1n=(ab,cb,ib,Ub)=>{!ab.matchCase&&0<ib.length&&
(ab=cb.$Va().substr(Ub.cpBegin,Ub.cpEnd-Ub.cpBegin),ib=this.cml(ib,ab));return this.EOc(Ub,ib,!0,!1)};this.zC=ub;this.aE=Yb;this.wq=yb;this.Pc=Za;this.P_e=Ya;this.NAk=rb;this.r8g=tb;this.EOc=ob;this.bDk=Oa;this.Vd=Xa;this.DOc=!1;this.bcp=this.Y2n;this.Aho=this.M0n;this.txl=this.iWn;this.P3l=this.DXn;this.BCj=this.k3h;this.replaceText=this.x1n;this.cml=Ja.sVn;this.xBm=this.mYn}get NE(){return this.P_e.value}get pld(){return this.DOc}replace(ub){var Yb=!1;if(this.pld)return l.ULS.sendTraceTag(4069062,
313,15,"Replace: Cancelled as replace is already in progress"),Yb;if(this.NE.pMl){var yb=this.NE.Tka;const Pa=yb.node;yb.contextId===za.a.paragraph&&(yb=ja.a.createTextRange(Pa,0,Y.ParagraphReader.textLength(Pa)));var Za=Object(w.a)(45,Pa);if(Za){var Ya=new Ca.a(yb.cpBegin,yb.cpEnd);Ya=Za.tAi(Ya);if(Ya!==fa.a.invalid&&0<=Ya){if(this.t1h(yb))return l.ULS.sendTraceTag(5007250,313,50,"Replace: Cancelled as Paragraph is locked"),Yb;this.DOc=!0;Yb=this.Pc.Mc(15);Yb.Ab(Pa);this.replaceText(this.zC.ZDf,
Za,ub,yb);Yb.dispose();this.BCj();Za.DAg(Ya,ub.length);0<ub.length&&this.aE.gub.push(Pa.id);ub=this.aE.alc(Pa.id);yb=this.aE.z9a(ub);Za=Za.cWa();Za=this.wq.gke(Pa.id,Za,null,ub.type,ub.mde);this.aE.Yue(Pa.id,Za);(yb=this.xBm(Za.length,Ya,ub,yb,Pa))?this.zC.dmd.CLi(yb.id):this.aE.jAb();Yb=!0;this.DOc=!1}else l.ULS.sendTraceTag(5007251,313,50,"Replace: Cancelled as current selection not on a find hit.")}else l.ULS.sendTraceTag(4069063,313,15,"Replace: Failed as No node found corresponding to current selection")}else l.ULS.sendTraceTag(5007252,
313,50,"Replace: Cancelled as current selection does not contain single context");Yb?(l.ULS.sendTraceTag(4065306,313,50,"ReplaceManager Replace Success"),this.zC.Ztg=!0):(l.ULS.sendTraceTag(5007253,313,50,"ReplaceManager Replace Not Successful"),this.zC.dmd.xLi());return Yb}replaceAll(ub,Yb){this.pld?l.ULS.sendTraceTag(4069065,313,15,"ReplaceAll: Called when Replace is already in Progress"):this.aE.doa?this.bcp(ub,Yb):l.ULS.sendTraceTag(4069066,313,15,"ReplaceAll: Called when total results is 0")}t1h(ub){const Yb=
this.NAk(ub);!Yb&&this.r8g.value&&this.bDk.value&&this.r8g.value(ub.node);return Yb}Onl(ub,Yb,yb){return this.t1h(ja.a.createTextRange(ub,Yb,yb))}Gpn(ub){return ub.nob===this.aE.nKa}static get rg(){return null!=Ja.oUg?Ja.oUg:Ja.oUg=oa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static LG(ub,Yb){const yb=new u.a(()=>ua.StaticTheCoauthManager.ud()&&ua.StaticTheCoauthManager.ud().Ak?Object(y.a)(ua.StaticTheCoauthManager.ud().Ak,ua.StaticTheCoauthManager.ud().Ak.yG,"acquireAndApplyLock"):null);
return new Ja(ub,Yb,T.FindManagerHelper.instance,new z.a,new u.a(()=>xa.a.instance),new u.a(()=>V.a.instance),Object(y.a)(sa.a.instance,sa.a.instance.fgn,"isContextSetInLockedRange"),yb,Object(y.a)(Ja.rg,Ja.rg.Ne,"replaceTextRange"),new u.a(()=>ua.StaticTheCoauthManager.ud().Jo),ia.StaticActiveAppFrame.za().hs)}static createInstance(ub,Yb){return Ja._instance||(Ja._instance=Ja.LG(ub,Yb))}static sVn(ub,Yb){const yb=Fa.a.xh(Yb);!Fa.a.localeCompare(Fa.a.sC(Yb),Yb)&&Fa.a.localeCompare(yb,Yb)?ub=Fa.a.sC(ub):
Fa.a.Gpc(Yb.charAt(0))&&!Fa.a.j_f(Yb.charAt(0))&&(Yb=Fa.a.sC(ub.substr(0,1)),ub=1===ub.length?Yb:Yb+ub.substr(1,ub.length-1));return ub}}Ja._instance=null;Object(G.a)(Ja,"ReplaceManager",null,[1757]);d.d(J,"FindManager",function(){return nb});class nb extends Q.a{constructor(ub,Yb,yb,Za,Ya,Pa,rb,tb,ob,Oa,Xa,ab,cb,ib,Ub,lb=!1){super(ub,Yb,yb,Ya,Pa,cb,ib,Xa,ab);this.lpa=this.jPc=null;this.hQd=!1;this.ZHa=this.Jhb=this.tjb=null;this.fHc=0;this.QNd=Za;this.pFb=rb;this.Zc=tb;this.Pc=ob;this.V4e=Oa;this.Hvk=
Ub;this.JKc=[];this._state=2;this.lIb=!lb;this.vCb=new U;this.wq.Fff(this.vCb);this.vIb=new U;this.wq.Fff(this.vIb);this.wq.$c&&(this.tjb=this.wq.Ej);this.KOg=400;this.HBc=100}get lb(){return this.pFb.value}get ZDf(){return this.jPc}get F3d(){return this.Hvk.value}F6a(ub=!0){this.zZb&&this.zZb.pld||(this.Ymb(ub),this.sib.reset(),this.Klb="",this.QNd&&this.F3d.stop(),this.Srl(),this.RPj(null))}Srl(){this.T$&&(this.Qi.vf(this.T$),this.T$=null);this.nRa&&(this.Qi.vf(this.nRa),this.nRa=null)}Ymb(ub=!0){!this.tjb&&
0<this.zk.kfb&&l.ULS.sendTraceTag(4235910,313,10,"{0}",{["CancelFind"]:"LastKnowSpaceNull"});if(0<this.zk.kfb&&this.tjb){let yb=this.zk.nKa;const Za=yb.nodeId;if(this.tjb.Eb(Za)){const Ya=this.Pc.Mc(3);for(Ya.Ab(this.tjb.Eb(Za));yb;){const Pa=this.tjb.Eb(yb.nodeId);var Yb=Object(w.a)(45,Pa);if(Yb){if(this.lIb&&(Yb.ora(void 0,ub),Y.ParagraphReader.Xb(Pa)&&(Yb=this.wq.yyi(Pa))))for(const rb of Yb)rb.ora(void 0,ub);Pa.om(16,!0)}yb=this.zk.ckc(yb);if(!yb||yb.nodeId.equals(Za))break}Ya.dispose()}else l.ULS.sendTraceTag(4235911,
313,10,"ClearFindHits: Error - node not in last known space");this.zk.s3h()}ub&&this.zZb&&this.zZb.k3h();this.zGj();this.JKc=[];this.b7b=this.jPc=null;this.lO=0;this.Ztg=this.hQd=!1}qvg(){const ub=this.AZ;this.Ymb();ub&&""!==ub.text&&this.find(ub)}iOi(){return this.QNd&&this.F3d.nYm}VGj(){10>this.fHc?(this.fHc++,l.ULS.sendTraceTag(4069014,313,15,"{0}",{["ErrorRestartCount"]:this.fHc}),this.find(this.AZ)):(l.ULS.sendTraceTag(4235912,313,10,"RestartFindAfterErrorCondition: max retries reached"),m.AFrameworkApplication.va.Ob(D.a.zec,
2),this.fHc=0)}bzj(){var ub=(new Date).getTime();let Yb=!1;this.zk.kfb||(Yb=!0);let yb=0;if(!Yb){this.zk.Vca||(this.zk.Vca=this.zk.nKa);this.zk.W6||(this.zk.W6=this.zk.Vca,this.zk.AG=null);let Za=null,Ya=!0;for(;!Yb&&this.zk.W6&&(new Date).getTime()-ub<Q.a.odj;){const Pa=this.zk.W6,rb=this.wq.Ej.Eb(Pa.nodeId);rb?(Ya&&(Za=this.Pc.Mc(3),Za.Ab(rb),Ya=!1),Pa.mde&&!this.Jhb&&(this.Jhb=rb),this.zk.W6=this.zk.ckc(this.zk.W6),Yb=!this.zk.W6||this.zk.W6.nodeId.equals(this.zk.Vca.nodeId),this.FQf(rb,Pa.type,
this.lIb),++yb):this.zk.Rkd(Pa.nodeId)}Za&&Za.dispose()}this.zk.jAb();Yb&&(this.zk.W6=null,this.hQd?this._state=0:(this._state=2,this.Dyb(!0)));this.T$=new f.a(2,1,this.HBc,Object(y.a)(this,this.E0c,"findInternal"),52);this.Qi.Zb(this.T$);ub=(new Date).getTime()-ub;l.ULS.sendTraceTag(4065247,313,50,"{0}",{["RecheckTime"]:ub,["Count"]:yb,["Total"]:this.zk.doa,["TotalWithDirty"]:this.zk.kfb})}weo(){this.Ymb();this.lO=0;if(this.wq.aYf&&this.lIb){var ub=this.lb;if(ub){var Yb=ub.gb.currentSelection;if(Yb){var yb=
ia.StaticActiveAppFrame.za().ib.sc;(yb=yb?yb.jr:null)&&yb.JEa();Yb=O.SelectionEditor.Wj(Yb,!1,!1);ub.Ic(Yb);yb&&yb.lza()}}}ub=this.OSl();this.lpa=this.Avk.xyi(ub)}SPj(){this.RPj(this.lpa[this.lO].Uca)}RPj(ub){this.yYo(ub);this.pNj(ub)}zGj(){this.Jhb=null;this.U7b=!1}gMf(ub){const Yb=this.Zc.Ql();Yb.set(ub);if(!Yb.zb(7))return Yb.reset(),null;if(this.wq.Uke(Yb,7,0))return ub=Yb.currentNode,Yb.reset(),ub;l.ULS.sendTraceTag(4235914,313,10,"GetNextFindableNode: No findable nodes");Yb.reset();return null}OSl(){if(this.wq.aYf){var ub=
this.lb;if((ub=ub?ub.gb.currentSelection:null)&&this.lIb)return ub.Uc.Gl?(ub=ub.Uc,O.SelectionEditor.mw(ub)?(ub=ub.node,Object(v.a)(45,ub)?ub:this.gMf(ub)):Object(v.a)(45,ub.node)?ub.node:this.gMf(ub.node)):this.gMf(this.wq.$c);ub=this.Zc.Ql();ub.set(this.wq.$c);if(this.wq.JKg(ub,8,1)){l.ULS.sendTraceTag(4069018,313,50,"No Selection: No selection, choosing title or first findable");const Yb=ub.currentNode;ub.reset();return Yb}l.ULS.sendTraceTag(4235915,313,10,"TryMoveToPageLeadingContent failed")}l.ULS.sendTraceTag(4235916,
313,10,"Error: ContentView isn't PageView");return null}pOf(){const ub=this.Zc.Ql();this.vIb||l.ULS.sendTraceTag(508432899,313,15,"StartNodeTracker is missing in GetStartingNode().");ub.set(this.vIb);if(1===ub.Dq())return ub.Xd(),ub.currentNode;l.ULS.sendTraceTag(4069019,313,15,"Something went wrong in GetStartingNode...");return null}yYo(ub){const Yb=this.Pc.Mc(3);Yb.Ab(this.vIb);const yb=this.Zc.Ql();yb.set(this.vIb);yb.WA()&&(yb.Xd(),yb.eh());ub&&(yb.Uf(ub,81),ub=this.lpa[this.lO],this.vIb.rwg=
ub.rootNode.type,this.vIb.aEf=ub.Mic);Yb.dispose()}uom(){if(this.vCb){var ub=this.Zc.Ql();ub.set(this.vCb);if(ub.Dq())return ub.Xd(),ub.currentNode;ub=this.V4e(this.wq.$c);ub.moveNext();if(ub.currentNode)return ub.currentNode}l.ULS.sendTraceTag(4069020,313,15,"Something went wrong in GetCurrentNode...");return null}pNj(ub){const Yb=this.Pc.Mc(3);Yb.Ab(this.vCb);const yb=this.Zc.Ql();yb.set(this.vCb);yb.WA()&&(yb.Xd(),yb.eh());ub&&(yb.Uf(ub,81),ub=this.lpa[this.lO],this.vCb.rwg=ub.rootNode.type,this.vCb.aEf=
ub.Mic);Yb.dispose()}uLi(){let ub=this.zk.AG||this.zk.nKa;if(ub){for(var Yb=!1,yb=!0;ub;){var Za=this.wq.Ej.Eb(ub.nodeId);if(Za=Object(w.a)(45,Za))if(Yb=Za.c8f(ub.type)){yb&&(ub=this.zk.z9a(ub));break}else ub=this.zk.z9a(ub);else if(yb=ub,ub=this.zk.ckc(ub),this.zk.Rkd(yb.nodeId),!ub||yb.nodeId.equals(ub.nodeId))break;yb=!1}Yb?(this.zk.AG=ub,this.zk.jAb(),l.ULS.sendTraceTag(4065248,313,50,"FindManager GoToNextHit Success")):l.ULS.sendTraceTag(4069022,313,15,"Failed to go to Next Hit")}}zLi(){let ub=
this.zk.AG||this.zk.nKa;if(ub){for(var Yb=!1,yb=!0;ub;){var Za=this.wq.Ej.Eb(ub.nodeId);if(Za=Object(w.a)(45,Za))if(Yb=Za.ocj(ub.type)){yb&&(ub=this.zk.W8d(ub));break}else ub=this.zk.W8d(ub);else if(yb=ub,ub=this.zk.nBi(ub),this.zk.Rkd(yb.nodeId),!ub||yb.nodeId.equals(ub.nodeId))break;yb=!1}Yb?(this.zk.AG=ub,l.ULS.sendTraceTag(4065249,313,50,"FindManager GoToPreviousHit Success")):l.ULS.sendTraceTag(4069024,313,15,"Failed to go to Previous Hit");this.zk.jAb()}}zll(){return 2===this._state&&(this.Ztg||
this.QNd&&this.F3d.fHj)}deg(){this.wq.Ota?(this.Klb=this.dja.Yhd(this.AZ.text),this.tjb=this.wq.Ej,this.zGj()):this.VGj()}nXj(){this.QNd&&this.F3d.start()}Vnf(){if(!this.wq.Ota||this.tjb!==this.wq.Ej)return this.Ymb(),this.VGj(),!0;this.fHc=0;return!1}rvg(){const ub=this.dja.uXb(this.Klb),Yb=this.zll();let yb=!1;if(Yb||this.wq.t1i(this.jPc,this.JKc,this.AZ,ub)){yb=!0;this.Dyb(!1);this.sib.update();this.sib.eEf();!Yb&&this.wq.D1i(this.jPc,this.JKc,this.AZ,ub)?(this.zk.xcj(),this.zk.W6=null,this._state=
1):(this.weo(),this.SPj(),this._state=0,this.hQd=!0);this.jPc=this.AZ;this.JKc=ub;try{this.b7b=this.c7b.Ykc(this.JKc.join("|"),this.AZ)}catch(Za){return l.ULS.sendTraceTag(0,313,10,"FindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",this.AZ.matchCase,this.AZ.matchWholeWord),this.b7b=null,this._state=2,this.Dyb(!0),!0}this.T$=new f.a(2,1,this.HBc,Object(y.a)(this,this.E0c,"findInternal"),52);this.Qi.Zb(this.T$)}return yb}Gjj(){if(!this.Jhb){const ub=
this.Zc.Ql();ub.set(1===this.lpa[this.lO].Mic?this.wq.$c:this.lpa[this.lO].rootNode);this.wq.JKg(ub,this.lpa[this.lO].rootNode.type,this.lpa[this.lO].Mic)?(this.Jhb=ub.currentNode,ub.reset()):(l.ULS.sendTraceTag(17306254,313,10,"TryToMoveToPageLeadingParagraph failed."),ub.reset(),this.T$=new f.a(2,1,this.HBc,Object(y.a)(this,this.E0c,"findInternal"),52),this.Qi.Zb(this.T$))}}Ndg(){this.zk.jAb();this.pNj(this.ZHa.currentNode);this.ZHa.currentNode===this.pOf()&&(this.lO++,this.lO===this.lpa.length?
(this.lO=0,this._state=2,this.hQd=!1,this.Dyb(!0)):this.SPj());this.ZHa=null}PHi(){return this.pOf()}Luj(){const ub=this.uom();this.ZHa=this.Zc.Ql();this.ZHa.set(ub);this.ZHa.T4(this.lpa[this.lO].rootNode)}rQj(){const ub=this.Pc.Mc(3);ub.Ab(this.ZHa.currentNode);return ub}Xhg(){this.FQf(this.ZHa.currentNode,this.lpa[this.lO].Mic,this.lIb);this.wq.Uke(this.ZHa,this.lpa[this.lO].rootNode.type,this.lpa[this.lO].Mic)}jrf(ub){return!!this.ZHa.currentNode&&!this.ZHa.currentNode.id.equals(ub.id)}K1h(ub){!this.U7b&&
this.Jhb&&ub.id===this.Jhb.id&&this.pOf().id!==this.Jhb.id&&0<this.zk.kfb&&(this.U7b=!0,this.zk.tGj())}wRd(ub,Yb,yb,Za){const Ya=this.zk.alc(ub);Ya?this.zk.Yue(ub,Yb):this.U7b?this.zk.OMh(Yb):this.zk.CRd(Yb);this.lIb&&!this.zk.AG&&0<Yb.length&&yb.c8f(Za)&&(this.zk.AG=Ya?Ya:Yb[0],this.zk.Vca||(this.zk.Vca=this.zk.AG))}w_a(ub,Yb){ub.w_a(Yb)}ora(ub){this.lIb&&ub.ora()}n8f(ub){ub.om(16,!0)}static LG(ub,Yb,yb,Za,Ya=!1){Yb||(Yb=ta.instance);yb||(yb=P.instance);const Pa=ma.createInstance(ub,yb.supportedTypes,
Ya),rb=new u.a(()=>Ja.createInstance(nb.instance,nb.instance.zk)),tb=new u.a(()=>na.createInstance(nb.instance.zk)),ob=new u.a(()=>wa.createInstance(nb.instance,ub));return new nb(ub,Yb,yb,Za,T.FindManagerHelper.instance,new u.a(()=>m.AFrameworkApplication.mc),new u.a(()=>V.a.instance),new x.a,new z.a,A.a.createInstance,a.a.instance,Pa,rb,tb,ob,Ya)}static get instance(){return nb._instance}static createInstance(ub,Yb=null,yb=null,Za=!1,Ya=!1){return Ya?nb.LG(ub,Yb,yb,Za,!0):nb.instance||(nb._instance=
nb.LG(ub,Yb,yb,Za))}}nb._instance=null;Object(G.a)(nb,"FindManager",Q.a,[])},2085:function(G,J,d){G=d(0);var m=d(21),f=d(2),a=d(250),l=d(5),w=d(16),y=d(46),v=d(63),u=d(7),x=d(84),z=d(122),A=d(77),D=d(93),F=d(219),I=d(11),H=d(6),N=d(503),M=d(116),U=d(894),O=d(1120),V=d(37),Y=d(223),Q=d(214),S=d(85);class P{constructor(tb){this.Fua=tb}}Object(G.a)(P,"ValidParentData",null,[]);var T=d(40),Z=d(398),X=d(704),aa=d(390),ia=d(703),wa=d(554);class ma{constructor(){this.Rgc=0}}Object(G.a)(ma,"BelowOutlineElementData",
null,[]);var na=d(675),Fa=d(939),Qa=d(582);class ya extends na.a{constructor(tb,ob,Oa,Xa){super(4,Xa);this.Pgc=tb;this.LJb=ob;this.VTc=Oa}ylc(){var tb=this.Pgc;if(!tb)return u.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const ob=[],Oa=new Fa.a(this.Pgc.id,this.Pgc.Yc,this.LJb?this.LJb.id:null);""!==tb.characterData&&tb.characterData&&(tb=new Qa.DeleteTextUpdateHint(this.Pgc.id,0,tb.characterData),ob.push(tb));ob.push(Oa);
return ob}}Object(G.a)(ya,"DeleteParagraphOperation",na.a,[]);var ta=d(1021),Aa=d(505);class oa extends na.a{constructor(tb,ob,Oa,Xa,ab){super(3,ab);this.Gua=tb;this.PYa=ob;this.PPn=Oa;this.cDa=Xa}ylc(){const tb=[];var ob=new ta.AddParagraphUpdateHint(this.cDa.id,this.cDa.Yc,this.Gua?this.Gua.id:null);tb.push(ob);""!==this.cDa.characterData&&this.cDa.characterData&&(ob=new Aa.a(this.cDa.id,0,this.cDa.characterData),tb.push(ob));return tb}}Object(G.a)(oa,"InsertNewParagraphOperation",na.a,[]);var za=
d(1020);class ja extends na.a{constructor(tb,ob,Oa,Xa){super(2,Xa);this.Gua=tb;this.PYa=ob;this.eke=Oa}ylc(){const tb=[],ob=new za.MergeParagraphUpdateHint(this.Gua.id,this.Gua.Yc,this.Gua.characterData.length,this.PYa.id,this.PYa.Yc,this.eke.id,this.eke.Yc);tb.push(ob);return tb}}Object(G.a)(ja,"MergeParagraphOperation",na.a,[]);var fa=d(938);class Ca extends na.a{constructor(tb,ob,Oa,Xa,ab){super(1,ab);this.i8=tb;this.RWj=ob;this.LJb=Oa;this.VTc=Xa}ylc(){const tb=[],ob=new fa.a(this.i8.id,this.i8.Yc,
this.RWj,this.LJb.id,this.LJb.Yc,this.VTc.id,this.VTc.Yc);tb.push(ob);return tb}}Object(G.a)(Ca,"SplitParagraphOperation",na.a,[]);var xa=d(401),ua=d(578),sa=d(44),Ea=d(1186),Ja=d(94),nb=d(32),ub=d(128),Yb=d(256),yb=d(8),Za=d(186),Ya=d(62),Pa=d(61);d.d(J,"a",function(){return rb});class rb{constructor(tb,ob,Oa,Xa,ab,cb,ib=null,Ub=null,lb=null){this.ohd=new WeakMap;this.pT=tb;this.MM=ob;this.ig=Oa;this.e$=ib;this.Zv=Ub;this.fy=lb}$Tk(tb){var ob;(null===(ob=Ja.StaticTheCoauthManager.ud())||void 0===
ob?0:ob.Jo)&&Ja.StaticTheCoauthManager.ud().Ak.yG(tb)}wEa(tb,ob,Oa,Xa=!1){V.OutlineElementNavigator.Le(tb);yb.ParagraphReader.Bh(tb)?rb.rl.Sr.wEa(tb,ob,Oa):nb.TableReader.isTable(tb)&&14===tb.lf&&(ob=(new aa.a(1,Oa)).Nu,Oa=Object(x.a)(Z.TableNode,tb.currentNode),this.cQj(Oa,ob,Xa));V.OutlineElementNavigator.he(tb)}cQj(tb,ob,Oa=!1){tb&&Object(z.a)(Z.TableNode,tb)&&(Oa?ob?(tb.setValue(l.a.fe,ob),ob=nb.TableReader.Fh(tb),rb.hk.oAg(tb,ob)):tb.removeProperty(l.a.fe):tb.fe=ob)}get Sr(){return O.a.oQb}get kJ(){return this.Zv||
(this.Zv=m.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get Vb(){return this.fy||(this.fy=m.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Md(){return null!=this.g6g?this.g6g:this.g6g=m.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Lj(){return null!=this.U5g?this.U5g:this.U5g=m.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get rm(){return this.MM.value}get Nd(){return this.ig.value}get MN(){return this.pT.value}get mg(){return Yb.a.instance}get tF(){return null!=
this.RUg?this.RUg:this.RUg=m.a.instance.Oa("Box4.IContentControlConverter")}dob(){const tb=U.a.instance.createInstance(v.a.$X);tb.setValue(w.a.aM,Y.a.first);tb.setValue(w.a.wLl,new Date);tb.$Ac();return tb}oIl(){const tb=new Ea.a;tb.setValue(w.a.aM,Y.a.first);return tb}Izf(tb,ob,Oa=!1){T.OutlineElementReader.F0f(tb)?(tb=T.OutlineElementReader.isRtl(tb),Oa?this.Y_b(ob,tb):this.X_b(ob,tb)):this.Azo(ob)}xxc(tb,ob){const Oa=V.OutlineElementNavigator.nm(tb);T.OutlineElementReader.Lo(Oa)!==ob&&(this.X_b(Oa,
ob),tb.anchor.j0(4))}X_b(tb,ob){const Oa=new sa.GraphTransaction(7);Oa.Ab(tb);this.Y_b(tb,ob);const Xa=new H.GraphIterator;Xa.set(tb);xa.a.instance.Lbn(Xa);if(Xa.zb(10)){const ab=Xa.ld(10);Xa.Ub(1)===tb&&this.MN.X_b(ab,ob)}Oa.dispose()}Y_b(tb,ob){let Oa=null,Xa=null;if(D.a.instance.J(1)&&tb.isConnected){Oa=yb.ParagraphReader.Gv(tb,!0,!0);Xa=new A.a;for(let ab=0;ab<Oa.count;ab++)12===Oa.J(ab).type&&Xa.add(Oa.J(ab).sE())}tb.properties.setValue(w.a.d4,ob);if(D.a.instance.J(1)&&Oa&&Xa)if(Oa.count!==Xa.count)u.ULS.shipAssertTag(35973010,
376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",Oa.count,Xa.count);else for(tb=0;tb<Oa.count;tb++)this.Lj.wY(Oa.J(tb),Xa.J(tb),this.Md.Mg)}Azo(tb){tb.properties.removeProperty(w.a.d4)}QJ(tb,ob=null,Oa=!1){var Xa,ab=null;let cb=null;if(!T.OutlineElementReader.Mh(tb))return u.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),null;let ib=null,Ub=null,lb=0;ob&&(ib=ob.formatting,Ub=ob.uoa,lb=ob.languageId);Oa||({Gua:ab,PYa:cb}=this.Zsi(tb,
ab,cb));ob=tb.currentNode;const Qb=F.a.instance.createInstance(v.a.paragraphNode);Qb.setValue(w.a.Un,"");tb.Uf(Qb,2);tb.Yj(Qb);rb.rl.qZb(Qb);rb.rl.AHn(Qb);rb.rl.N0a(Qb);this.$Tk(Qb);ib&&(Qb.qa.first.formatting.Dk=ib);lb||(lb=f.AFrameworkApplication.lcid);tb.currentNode.Kg(w.a.pmd,tb.currentNode.ja(w.a.pmd,lb));tb.currentNode.setValue(l.a.jZa,0);Ub&&this.kJ.VN(Ub,Qb,!0);!Oa&&ab&&(Oa=new wa.a(Qb),ab=new oa(ab,cb,ab,Oa,Qb.esa),tb.currentNode.CL().YG.CG(ab));if((null===(Xa=Pa.a.getInstance())||void 0===
Xa?0:Xa.Fu)&&this.ohd.has(ob)){const {P8o:fc,insertBefore:Fc,c6n:nc}=this.ohd.get(ob);this.rm.cKg(H.GraphIterator.eb(fc),Fc,nc,ob);this.ohd.delete(ob)}return Qb}Zsi(tb,ob,Oa){Oa=new H.GraphIterator;Oa.hd(tb);ob=null;Oa.bZf?Oa.currentNode.CL().YG.laa(6):(V.OutlineElementNavigator.Y3(Oa,!0,!1),ob=this.e7d(Oa));Oa.hd(tb);Oa=this.gui(Oa);return{Gua:ob,PYa:Oa}}gui(tb){const ob=new H.GraphIterator;ob.hd(tb);tb=null;ob.XLa||(V.OutlineElementNavigator.ht(ob,!0,!1),tb=this.e7d(ob));return tb}e7d(tb,ob=!1){tb=
V.OutlineElementNavigator.Le(tb,!0);return tb?this.szi(tb,ob):(u.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}szi(tb,ob=!1){if(12===tb.type)return ob?new wa.a(tb):new ia.a(tb);tb.CL().YG.laa(5);return new X.a(tb)}Usl(tb,ob){var Oa=ob.currentNode.clone();tb.fK(Oa,null,1);tb.Yj(Oa);Oa.Oea=ob.currentNode;V.OutlineElementNavigator.Le(ob);ob.tba&1&&ob.currentNode.$2b(null);Oa=ob.currentNode.clone();Oa.NOa=ob.currentNode.NOa;Oa.iQ=ob.currentNode.iQ;tb.fK(Oa,null,2);tb.Yj(Oa);
tb.x3(1);Oa.Oea=ob.currentNode;Oa.setValue(l.a.Yc,a.a.VF());ob.qt(11)}qZb(tb){tb.Ub(2)&&tb.eh()}eDo(tb,ob){const Oa=tb.currentNode;V.OutlineElementNavigator.Le(tb);const Xa=tb.currentNode;V.OutlineElementNavigator.he(tb);ob.IL(1);V.OutlineElementNavigator.Le(ob);tb.Uf(ob.currentNode,2);ob.eh();var ab=new H.GraphIterator;ab.hd(ob);if(ab.Ub(1)){const cb=new H.GraphIterator;cb.hd(tb);const ib=new P(null);if(!this.zQm(cb,ab.currentNode,ib))return;N.g(cb,null,1,1,ab,-1)}ob.eh();ab=null;tb.oP(1)&&(ab=tb.currentNode);
for(tb.uc();Q.OutlineNavigator.Wba(ob);)tb.fK(ob.currentNode,ab,1),ab=ob.currentNode,ob.eh();tb.Yj(Oa);tb.Yj(Xa);tb.eh()}Tca(tb,ob,Oa,Xa,ab,cb,ib=!1,Ub=!1){var lb=T.OutlineElementReader.Mh(tb),Qb=T.OutlineElementReader.Mh(ob),fc=Oa.isValid&&Oa.contextId===I.a.Xc;lb&&Qb&&fc||u.ULS.sendTraceTag(594642515,307,15,"sourceOutlineElementIsValid:{0}; destinationOutlineElementIsValid:{1}; ipContextIsValid:{2}",lb,Qb,fc);var Fc=tb.currentNode;this.qZb(ob);Qb=ob.lf;let nc,zb=null;lb=fc=null;let Vb=!1;V.OutlineElementNavigator.Le(tb);
const rc=tb.lf;if(yb.ParagraphReader.Bh(tb)){nc=tb.currentNode;(fc=Object(x.a)(ub.AParagraphNode,nc))?fc.qa&&fc.qa.length||u.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",fc):u.ULS.sendTraceTag(38925731,307,15,"srcParaNode is null");fc=new wa.a(fc);(Vb=Oa.cpBegin===yb.ParagraphReader.textLength(nc))&&(lb=this.gui(ob));const pb=ob.currentNode;zb=this.QJ(ob,void 0,!0);rb.rl.V_a(tb,ob,Oa,ab,cb,ib,Ub);Xa?(ab=this.Vb.Eq(nc))&&this.kJ.VN(ab,zb,!0):Vb&&(ab=this.Vb.Eq(nc))&&
((Ub=ab.ja(y.a.ee,null))?(ab=this.Vb.EF(zb).gh(Ub),this.kJ.VN(ab,zb,!1)):this.kJ.VN(ab,zb,!0));this.Izf(Fc,pb)}V.OutlineElementNavigator.he(tb);V.OutlineElementNavigator.he(ob);V.OutlineElementNavigator.Le(tb);(Fc=Object(x.a)(ub.AParagraphNode,tb.currentNode))?Fc.qa&&Fc.qa.length||u.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",Fc):u.ULS.sendTraceTag(38925761,307,15,"srcPara is null");Fc=new wa.a(Fc);V.OutlineElementNavigator.he(tb);(tb=zb)?tb.qa&&tb.qa.length||
u.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",tb):(u.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),u.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:Vb,["moveText"]:cb,["overrideParagraphStyle"]:Xa,["sourceOutlineElementContentNodeType"]:rc,["destinationOutlineElementNodeType"]:Qb,["alwaysMoveEopToDestinationPara"]:ib}));Vb?(Oa=new wa.a(tb),Oa=new oa(fc,lb,Fc,Oa,tb.esa),ob.currentNode.CL().YG.CG(Oa)):(Oa=
cb?new Ca(fc,Oa.cpBegin,Fc,new wa.a(tb),tb.esa):new Ca(fc,Oa.cpBegin,new wa.a(tb),Fc,tb.esa),ob.currentNode.CL().YG.CG(Oa));return tb}y_h(tb,ob){V.OutlineElementNavigator.Le(tb);let Oa=yb.ParagraphReader.zu(tb.currentNode)&&this.hll(tb);const Xa=tb.currentNode;Oa=ob?Oa&&!this.mg.W8n(Xa):Oa&&!this.mg.H8n(Xa);V.OutlineElementNavigator.he(tb);return Oa}hll(tb){return yb.ParagraphReader.Bh(tb)&&!yb.ParagraphReader.Inb(tb.currentNode)}merge(tb,ob,Oa,Xa,ab=null,cb=!1,ib,Ub=!1,lb=!1,Qb=!1,fc=!0,Fc=!0){var nc;
if(tb.currentNode.id===ob.currentNode.id)return!1;let zb;const Vb=new H.GraphIterator;Vb.hd(ob);ib=this.e7d(Vb);Vb.hd(tb);zb=this.e7d(Vb,!0);if(!this.y_h(ob,!0)||!this.y_h(tb,!1))return!1;if(this.mg.vh){V.OutlineElementNavigator.Le(tb);V.OutlineElementNavigator.Le(ob);var rc=yb.ParagraphReader.Bh(tb)?tb.currentNode:null;const pb=yb.ParagraphReader.Bh(ob)?ob.currentNode:null;V.OutlineElementNavigator.he(tb);V.OutlineElementNavigator.he(ob);if(rc&&pb&&!this.mg.z_h(rc,pb,!1)){if(!this.tF||!this.mg.z_h(rc,
pb,!0))return!1;this.tF&&(this.tF.E4j(rc,!1),this.tF.E4j(pb,!0))}}rc=Object(x.a)(ub.AParagraphNode,tb.currentNode);rc=(Oa||!rc||!rc.characterData.length)&&!Ya.ListItemReader.Hg(tb);Ub||this.rm.merge(tb,ob,rc,ab);V.OutlineElementNavigator.Le(tb);ab=tb.currentNode.esa;V.OutlineElementNavigator.Le(ob);if(yb.ParagraphReader.Bh(ob)){Ub=ob.currentNode;if(null===(nc=Ja.StaticTheCoauthManager.ud())||void 0===nc?0:nc.Jo)if(nc=tb.currentNode,rc=ua.CoauthLockEditor.getInstance(),rc.seb(this.mg.Kjc(Ub))||rc.seb(this.mg.Kjc(nc)))return ob.uc(),
tb.uc(),!1;nc=!1;(Ub=tb.parentNode)&&T.OutlineElementReader.ACa(Ub)&&(nc=Ya.ListItemReader.Hg(Ub));(fc=fc&&this.W0o(yb.ParagraphReader.isEmpty(tb),nc,Oa,Xa,lb))&&(Ub=this.Vb.tOf(ob))&&this.kJ.VN(Ub,tb.currentNode,!0);Oa&&(Ub=ob.currentNode,rc=tb.currentNode,(fc||nc)&&Za.b(Ub,rc),!Fc||lb&&Xa||this.e$.dej(Ub,rc,nc),Qb&&(lb=this.bCl(rc,Ub),u.ULS.sendTraceTag(588288132,307,50,"wasCopied: {0}",lb)));Oa=rb.rl.merge(tb,ob,Oa,Xa,cb);cb=Vb.currentNode;Xa=tb.currentNode;tb.uc();Oa&&T.OutlineElementReader.isEmpty(ob,
!0)&&this.T7a(ob);tb=new ja(zb,ib,new ia.a(cb),ab);Xa.CL().YG.CG(tb);return!0}ob.uc();tb.uc();return!1}bCl(tb,ob){let Oa=null;ob&&ob.qa&&0<ob.qa.length&&ob.qa.first.mi&&(Oa=ob.qa.first.formatting);return Oa&&tb&&tb.qa&&0<tb.qa.length&&M.FormattingReader.tzl(tb.qa)?(tb.qa.last.formatting=Oa.Bf(tb.qa.last),!0):!1}W0o(tb,ob,Oa,Xa,ab){return ob?!1:Oa?!(Xa&&ab):tb}L$m(tb){const ob=new H.GraphIterator;ob.set(tb.node);ob.Jd();V.OutlineElementNavigator.he(ob);const Oa=this.tta(ob),Xa=this.tta(ob);this.Tca(ob,
Oa,tb,!1,!0,!0);T.OutlineElementReader.isEmpty(ob,!1)&&(this.rm.eha(ob),ob.eh());T.OutlineElementReader.isEmpty(Oa,!1)&&!T.OutlineElementReader.ltb(Oa)&&(this.rm.eha(Oa),Oa.eh());return Xa}nzo(tb){this.ohd.delete(tb)}$z(tb,ob,Oa,Xa=null,ab=!1,cb=!0){if(!this.dll(tb))return null;const ib=tb.currentNode;var Ub=!1;cb&&(Ub=Ya.ListItemReader.Hg(tb),ab=ob||ab||!T.OutlineElementReader.isEmpty(tb,!1),Ub=this.rm.E4o(Ub,ab));ab=ob?tb.oP(1):tb.currentNode;tb.uc();Oa=this.MN.kSb(tb,ab,Oa,Xa);if(!Oa)return null;
this.Izf(ib,Oa);cb&&Ub&&(Pa.a.getInstance().Fu?T.OutlineElementReader.uU(Oa)?this.rm.cKg(tb,ob,ib,Oa):this.ohd.set(Oa,{P8o:tb.currentNode,insertBefore:ob,c6n:ib}):this.rm.cKg(tb,ob,ib,Oa));return Oa}dll(tb){return T.OutlineElementReader.Mh(tb)&&(tb=tb.parentNode,S.OutlineReader.Afe(tb)||T.OutlineElementReader.ACa(tb)||T.OutlineElementReader.HXa(tb))?!0:!1}YDa(tb){const ob=new H.GraphIterator;ob.set(tb);ob.Jd();ob.qt(11);let Oa=null,Xa=null;({Gua:Oa,PYa:Xa}=this.Zsi(ob,Oa,Xa));let ab=-1;12===tb.type&&
(ab=tb.esa);ob.currentNode?(ob.currentNode.CL().YG.CG(new ya(this.szi(tb,!0),Oa,Xa,ab)),this.T7a(ob)):u.ULS.sendTraceTag(574650269,324,15,"The content to be deleted does not have a containing OE")}T7a(tb){if(tb.fv(1)){const ob=new ma,Oa=new H.GraphIterator;Oa.hd(tb);this.Kim(Oa,ob)&&this.Sr.VYc(tb,-ob.Rgc)}tb.eh();nb.TableReader.yy(tb)&&this.bdo(tb)}iWf(tb,ob,Oa){if(!S.OutlineReader.zy(tb)&&!T.OutlineElementReader.Mh(tb))return null;const Xa=this.oIl();0<Oa&&Oa<Y.a.last&&Xa.setValue(w.a.aM,Math.min(Y.a.nil,
Oa));tb.fK(Xa,ob,1);return Xa}N$m(tb,ob){if(!T.OutlineElementReader.Mh(tb)&&!T.OutlineElementReader.zN(tb)||!S.OutlineReader.BCa(tb.parentNode)&&!T.OutlineElementReader.ACa(tb.parentNode))return null;const Oa=tb.currentNode;let Xa;Xa=tb.currentNode;tb.uc();ob=this.iWf(tb,Xa,ob);tb.Yj(Oa);return ob}bdo(tb){T.OutlineElementReader.zN(tb)&&(tb.fv(1)||tb.eh());this.Fpi(tb,!1);this.kRh(tb)}Fpi(tb,ob){var Oa,Xa=null;for(Oa=tb.Ub(1);Oa;){var ab=!1;T.OutlineElementReader.HXa(Oa)&&!tb.fv(1)&&(ab=!0);var cb=
Oa;Oa=tb.Cj(1);if(ab)ab=new H.GraphIterator,ab.set(cb),ab.Jd(),ab.eh();else if(T.OutlineElementReader.HXa(cb)){if(Xa){ab=new H.GraphIterator;ab.set(Xa);var ib=new H.GraphIterator;ib.set(cb);ib.Jd();ab.Uf(ib.currentNode,1);ib.eh();ib=T.OutlineElementReader.$ka(cb);ib===Y.a.nil&&(ib=1);const Ub=T.OutlineElementReader.$ka(cb);(ib=Math.max(0,Ub-ib))?cb.setValue(w.a.aM,Math.min(Y.a.nil,ib)):(ab.Yj(cb),tb.Ub(1),N.e(ab),ab.uc());ob&&this.Fpi(ab,!0)}}else Xa=cb}ob=null;Xa=Y.a.last+1;for(Oa=tb.Ub(1);Oa;Oa=
tb.Cj(1))if(T.OutlineElementReader.zN(tb))cb=T.OutlineElementReader.$ka(Oa),Xa>cb&&(Xa=cb,ob=Oa);else{tb.uc();return}if(ob){for(Oa=tb.Ub(1);Oa;Oa=tb.Cj(1))Oa!==ob&&(Oa=T.OutlineElementReader.$ka(Oa),tb.currentNode.setValue(w.a.aM,Math.min(Y.a.nil,Oa-Xa)));Xa+=T.OutlineElementReader.$ka(tb.currentNode);tb.currentNode.setValue(w.a.aM,Math.min(Y.a.nil,Xa));Oa=new H.GraphIterator;Oa.hd(tb);Oa.Yj(ob);Oa.Ub(1);N.e(Oa)}}zQm(tb,ob,Oa){var Xa=T.OutlineElementReader.$ka(tb.currentNode);if(1===Xa)return!0;if(T.OutlineElementReader.zN(tb))return!1;
if(!tb.Cqb(1)||this.wnn(tb,ob))return tb.currentNode.setValue(w.a.aM,Math.min(Y.a.nil,1)),!0;if(Oa.Fua&&tb.Yj(Oa.Fua)){if(T.OutlineElementReader.zN(tb)&&1===Xa+T.OutlineElementReader.$ka(tb.currentNode))return Oa.Fua=tb.IL(1),tb.uc(),!0;tb.uc()}if(Oa.Fua&&tb.Yj(Oa.Fua)||!Oa.Fua&&tb.Ub(1)){if(tb.currentNode!==ob&&tb.Lf(1)&&T.OutlineElementReader.zN(tb)&&1===Xa+T.OutlineElementReader.$ka(tb.currentNode))return Oa.Fua=null,!0;tb.uc()}if(tb.Irb(ob)&&this.vnn(tb,ob)){for(Oa=tb.Ub(1);Oa;Oa=tb.Cj(1))if(Oa!==
ob){var ab=T.OutlineElementReader.$ka(Oa);Oa.setValue(w.a.aM,Math.min(Y.a.nil,ab+(Xa-1)))}tb.currentNode.setValue(w.a.aM,Math.min(Y.a.nil,1));return!0}if(1>Xa)return Xa=this.iWf(tb,Oa.Fua,1-Xa),tb.Yj(Xa),Oa.Fua=null,!0;if(1<Xa){tb.currentNode.setValue(w.a.aM,Math.min(Y.a.nil,1));ob=null;for(ab=tb.Ub(1);ab;){if(T.OutlineElementReader.zN(tb)){ab.setValue(w.a.aM,Math.min(Y.a.nil,Xa-1+T.OutlineElementReader.$ka(ab)));ab=tb.Cj(1);continue}ob||(ob=this.N$m(tb,Xa-1));const cb=ab;ab=N.i(tb,ob,1);ab===ob&&
(ab=tb.Cj(1));Oa.Fua===cb&&(Oa.Fua=ob,ob=null)}return!0}return!1}wnn(tb,ob){return H.GraphIterator.qfa(()=>{if(1===tb.Cqb(1)){const Oa=tb.Ub(1);tb.uc();if(Oa===ob)return!0}return!1})}vnn(tb,ob){return H.GraphIterator.qfa(()=>{let Oa;for(Oa=tb.Ub(1);Oa;Oa=tb.Cj(1))if(Oa!==ob&&!T.OutlineElementReader.zN(tb))return tb.uc(),!1;return!0})}Kim(tb,ob){ob.Rgc=0;do{const Oa=tb.currentNode;if(tb.Ub(1))ob.Rgc-=T.OutlineElementReader.$ka(Oa);else{if(S.OutlineReader.zy(tb)||null===tb.currentNode)return!1;if(3!==
tb.role||!tb.wla(1))for(;!tb.Cj(1);)if(ob.Rgc+=T.OutlineElementReader.$ka(tb.currentNode),S.OutlineReader.zy(tb)||null===tb.currentNode)return!1}}while(T.OutlineElementReader.zN(tb));return!0}tta(tb,ob=!1){return this.nce(tb,!1,ob)}K$m(tb){return this.nce(tb,!0,!1)}nce(tb,ob,Oa=!1){const Xa=new H.GraphIterator;Xa.hd(tb);tb=new H.GraphIterator;tb.hd(Xa);this.$z(tb,ob,!1,null,Oa);tb.currentNode.setValue(w.a.aM,Math.min(Y.a.nil,T.OutlineElementReader.$ka(Xa.currentNode)));Xa.Ub(1)&&N.g(tb,null,1,1,Xa,
-1);return tb}kRh(tb){if(T.OutlineElementReader.VEo(tb)){1!==T.OutlineElementReader.$ka(tb.currentNode)&&tb.currentNode.setValue(w.a.aM,Y.a.first);for(var ob=tb.Ub(1);ob;)if(T.OutlineElementReader.zN(tb)){ob=new H.GraphIterator;ob.hd(tb);ob.uc();const Oa=new H.GraphIterator;Oa.hd(tb);Oa.Ub(1);N.g(ob,tb.currentNode,1,1,Oa,-1);ob=tb.Eob(1)}else this.kRh(tb),ob=tb.Cj(1)}}static get hk(){return null!=rb.t5g?rb.t5g:rb.t5g=m.a.instance.resolve("Box4.ITableEditor")}static get rl(){return rb.uv||(rb.uv=m.a.instance.resolve("Box4.IParagraphEditor"))}static set rl(tb){rb.uv=
tb}}rb.uv=null;Object(G.a)(rb,"OutlineElementEditor",null,[503])},2088:function(G,J,d){G=d(0);var m=d(104),f=d(101),a=d(10),l=d(33);class w extends Sys.UI.Control{constructor(F,I,H,N){super(document.createElement("div"));this.z1=this.Koa=this.jO=this.ix=this.O5=this.Qgb=this.Zjb=null;this.uIc=this.Hib=!1;this.content=this._title=null;this.woa=0;this.eWh=null;this.Nja=0;this.ooj=null;this.aka=()=>{this.dismiss();return!0};this.CHh=F;this.Z9b=I;this.Wl=H;this.Z3h=N;this.Mj=I.ownerDocument;this.yae=
this.Du=this.bW=!1}get ica(){this.Zjb||(this.Zjb=this.Mj.createElement("div"),this.Zjb.id=this.Sj("WACCalloutOuter"),this.Zjb.className="WACCalloutOuter",this.Zjb.setAttribute(l.a.Ph,l.a.CUh),this.Zjb.style.width=this.woa+"px");return this.Zjb}get TTc(){if(!this.Qgb){this.Qgb=this.Mj.createElement("div");this.Qgb.id=this.Sj("WACCalloutBeakContainer");this.Qgb.className="WACCalloutBeakContainer";var F="CalloutBeakTopFilled_32x16x32";if(5===this.Nja||6===this.Nja||4===this.Nja)F="CalloutBeakBottomFilled_32x16x32";
F=f.createClusteredImage(32,16,F,"WACCalloutBeak",!0,"");this.Qgb.appendChild(F)}return this.Qgb}set TTc(F){this.Qgb=F}get gK(){return this.bW}get title(){return this._title}set title(F){this._title!==F&&(this._title=F,this.Koa&&(this.Koa.innerText=this._title))}get Du(){return this.Hib}set Du(F){this.Hib!==F&&(this.Hib=F,this.O5&&(this.O5.contains(this.jO)&&!this.Hib?this.O5.removeChild(this.jO):!this.O5.contains(this.jO)&&this.Hib&&this.fNh()))}get yae(){return this.uIc}set yae(F){this.uIc!==F&&
(this.uIc=F,this.O5&&(this.O5.contains(this.Koa)&&!this.uIc?this.O5.removeChild(this.Koa):!this.O5.contains(this.Koa)&&this.uIc&&this.WOh()))}show(){this.bW||(this.hFl(),this.fL(),this.Z9b.appendChild(this.ica),this.ica.style.display="Block",this.oYo(),this.bW=!0,this.ooj&&this.ooj())}dismiss(){this.bW&&(this.fSl(),this.Z9b.removeChild(this.ica),this.bW=!1,this.Z3h&&this.Z3h())}dispose(){this.dismiss();this.Koa=this.jO=this.ix=this.Qgb=this.O5=this.Zjb=null;Sys.Component.prototype.dispose.call(this)}Sj(F){return this.get_element().id+
F}hFl(){this.O5=this.Mj.createElement("div");this.O5.id=this.Sj("WACCalloutHeader");this.O5.className="WACCalloutHeader";this.Du&&this.fNh();this.yae&&this.WOh();this.ix=this.Mj.createElement("div");this.ix.id=this.Sj("WACCalloutContent");this.ix.className="WACCalloutContent";this.ix.style.width=190<this.woa?this.woa-26+"px":"164px";this.ix.appendChild(this.content);this.ica.appendChild(this.TTc);this.ica.appendChild(this.O5);this.ica.appendChild(this.ix)}fNh(){this.jO=this.Mj.createElement("a");
this.jO.className="WACCalloutCloseAnchor";this.jO.id=this.Sj("WACCalloutCloseAnchor");this.jO.href="#";this.O5.appendChild(this.jO);const F=f.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.jO.appendChild(F)}WOh(){this.Koa=this.Mj.createElement("div");this.Koa.className="WACCalloutTitle UIFontBold";this.Koa.style.width=190<this.woa?this.woa-30+"px":"160px";this.Koa.id=this.Sj("WACCalloutTitle");this.Koa.innerText=this.title;this.O5.contains(this.jO)?
this.O5.insertBefore(this.Koa,this.jO):this.O5.appendChild(this.Koa)}oYo(){var F=this.CHh;let I;if(1===this.Nja){var H=this.eWh.y+16;I=-16}else 2===this.Nja||3===this.Nja||0===this.Nja?(H=F.y+F.height+15,I=-15):(H=F.y-this.ica.clientHeight-15-2,I=this.ica.clientHeight-1);this.ica.style.top=H+"px";this.TTc.style.top=I+"px";1===this.Nja?(F=this.eWh.x-16,this.ica.style.left="50%",this.ica.style.marginLeft=-this.woa/2+"px",H=Sys.UI.DomElement.getBounds(this.ica),this.TTc.style.left=F-H.x+"px"):(H=F.x+
this.CHh.width/2,2===this.Nja||5===this.Nja?(F=20,H-=36):0===this.Nja||4===this.Nja?(F=this.woa/2-16,H-=this.woa/2):(F=this.woa-20-32,H=H-this.woa+36),this.ica.style.left=H+"px",this.TTc.style.left=F+"px")}fL(){this.Du&&!this.z1&&(this.z1=this.aka,this.Wl.nb(a.a.click,this.jO,this.z1,null))}fSl(){this.Du&&this.z1&&(this.Wl.xc(a.a.click,this.jO,this.z1),this.z1=null)}}Object(G.a)(w,"Callout",Sys.UI.Control,[1577]);class y extends w{constructor(F,I,H,N,M,U=null){super(F,H,M.i9,U);this.ovh=0;this.onClick=
()=>{this.dismiss();return!0};this.woa=this.Zzm(N);this.pbc=I;this.yj=M;this.akp=7;this.Fr=this.pbc.ownerDocument.createElement("div");this.Fr.className="ModalCalloutControlOverlay";this.Fr.tabIndex=0;this.pbc.insertBefore(this.Fr,this.pbc.firstChild)}show(){this.gK||(this.yj.$qe(),this.yj.Oja(!1),this.Fr.style.zIndex=String(this.yj.fIa),super.show(),this.eB(),this.ovh=window.setTimeout(Object(m.a)(this,this.dismiss,"dismiss"),1E3*this.akp))}dismiss(){this.gK&&(this.yj.ofa(!1),this.fda(),this.pbc&&
this.pbc.contains(this.Fr)&&this.pbc.removeChild(this.Fr),super.dismiss(),window.clearTimeout(this.ovh))}eB(){this.yj.z2(Object(m.a)(this,this.dismiss,"dismiss"));this.yj.UE.nb(a.a.click,this.Fr,this.onClick)}fda(){this.yj.iha(Object(m.a)(this,this.dismiss,"dismiss"));this.yj.UE.xc(a.a.click,this.Fr,this.onClick)}Zzm(F){let I=0;switch(F){case 0:I=190;break;case 1:I=250;break;case 2:I=300;break;case 3:I=360}return I}}Object(G.a)(y,"ModalCallout",w,[]);var v=d(7),u=d(580),x=d(189);class z extends y{constructor(F,
I,H,N,M,U=null){super(F,I,H,N,M,U);this.iW=null}show(){if(!this.gK){const F=Object.assign(new u.a,{onShow:()=>{y.prototype.show.call(this)}});x.UISurfaces.kP().then(I=>{const H=I.externalNotification();this.iW=I.addNotification(H,F);return null},I=>{v.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",I);return null})}}dismiss(){this.gK&&this.iW&&(x.UISurfaces.kP().then(F=>{F.removeNotification(this.iW);return this.iW=null},F=>{v.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",
F);return null}),super.dismiss())}}Object(G.a)(z,"ReactManagedModalCallout",y,[]);var A=d(2);d.d(J,"a",function(){return D});class D{static hai(F,I,H,N){return A.AFrameworkApplication.ua.Ib.MXa?new z(F,I,H,N,A.AFrameworkApplication.ua,null):new y(F,I,H,N,A.AFrameworkApplication.ua,null)}}Object(G.a)(D,"ModalCalloutControlFactory",null,[])},2092:function(G,J,d){G=d(0);var m=d(57),f=d(138),a=d(19),l=d(2),w=d(90);class y{constructor(F,I){this.value=F;this.Ndm=I}get yee(){return this.Ndm}}Object(G.a)(y,
"ElementValueWrapper",null,[]);class v extends y{constructor(F,I,H){super(F,I);this.G1i=H}}Object(G.a)(v,"DimensionWrapper",y,[]);var u=d(1792),x=d(1793),z=d(7),A=d(1426);d.d(J,"a",function(){return D});class D{static get PPi(){return D.Iyk}static get fCe(){return D.zPk}static get dCe(){return D.yPk}static RPf(F,I,...H){I=D.lKi(I);let N=!1;I||(I=D.FQm(F,...H),N=!!I);return new y(I,N)}static lKi(F){for(const I of F)if(void 0!==I&&null!==I&&""!==I)return I.trim();return null}static FQm(F,...I){for(const H of I)if(I=
F.getAttribute(H),void 0!==I&&null!==I&&(I+="",void 0!==I&&null!==I&&""!==I))return I.trim();return null}static QEi(F,I){I=parseFloat(I);if(isNaN(I))return 0;switch(F){case "px":return Math.round(I);case "pt":return Math.round(m.a.M0(I,0,!1));case "in":return Math.round(m.a.Zfa(I,0,!1));case "cm":return Math.round(m.a.Zfa(f.a.W0h(I),0,!1));case "mm":return Math.round(m.a.Zfa(f.a.W0h(.1*I),0,!1));default:return I}}static Dve(F,I,...H){F=D.RPf(F,I,...H);H=0;I=!1;if(F.value){I=F.value.endsWith("%");
let N;I?(H="%",N=a.a.substring(F.value,0,F.value.length-1)):F.yee?(H="px",N=F.value):(H=F.value.substr(F.value.length-2),isNaN(parseFloat(H))?N=a.a.substring(F.value,0,F.value.length-2):(H="px",N=F.value));H=D.QEi(H,N)}return new v(H,F.yee,I)}static zKi(F){return A.a.s1f?new v(D.QEi("px",getComputedStyle(F).width),!0,!1):D.Dve(F,[F.style.width],"width","WIDTH","Width")}static Kzi(F){return D.Dve(F,[F.style.height],"height","HEIGHT","Height")}static $J(F){return D.Dve(F,[F.style.marginLeft],"leftmargin",
"LEFTMARGIN","LeftMargin")}static FL(F){return D.Dve(F,[F.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static LQm(F){F=D.RPf(F,[F.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return F.value&&F.value in D.fCe&&void 0!==D.fCe[F.value]&&null!==D.fCe[F.value]?D.fCe[F.value]:0}static gsn(F){F=D.lKi([F.style.borderCollapse]);return!!F&&!(void 0===F||null===F)&&("collapse"===F||"COLLAPSE"===F||"Collapse"===F)}static yim(F){return D.RPf(F,[F.style.backgroundColor,F.style.background],
"bgcolor","BGCOLOR","BgColor","BGColor").value}static yBl(F){const I=a.a.substring(F,0,1),H=a.a.substring(F,1,2);F=a.a.substring(F,2,3);return I+I+H+H+F+F}static Era(F){let I="";if(!F||""===F)return I;I=F.trim();if(I.startsWith("rgb")){I=a.a.substring(I,I.indexOf("(")+1,I.length-1);F=I.split(",");if(3!==F.length)return"";I="";for(let N=0;N<F.length;N++){var H=parseInt(F[N]);if(isNaN(H)||0>H||255<H)return"";H=H.toString(16);1===H.length&&(H="0"+H);I+=H}return a.a.sC(I)}if(D.PPi[a.a.xh(I)])return D.PPi[a.a.xh(I)];
I.startsWith("#")&&(I=a.a.substring(I,1,I.length));if(isNaN(parseInt(I,16)))return"";3===I.length&&(I=D.yBl(I));return 6!==I.length?"":I}static K9n(F){var I=F.indexOf("mso-tab-count");if(-1===I)return 0;const H=RegExp("([\\d])");let N="";for(I=I+13+1;I<F.length;I++){const M=F.charAt(I).toString();if(H.test(M))N+=M;else break}F=0;""!==N&&(F=parseInt(N));return F}static S$d(F,I){const H=D.yim(F);H&&""!==H&&I.jw(N=>N.Hca(D.Era(H)))}static Sui(F){var I=F.style;if(!I)return null;let H=D.dCe[I.borderTopStyle];
const N=D.Era(I.borderTopColor);let M=I.borderTopWidth,U=D.dCe[I.borderRightStyle];const O=D.Era(I.borderRightColor);let V=I.borderRightWidth,Y=D.dCe[I.borderBottomStyle];const Q=D.Era(I.borderBottomColor);let S=I.borderBottomWidth,P=D.dCe[I.borderLeftStyle];const T=D.Era(I.borderLeftColor);I=I.borderLeftWidth;l.AFrameworkApplication.Ld("gdea6103;0df65435");F=F.getAttribute("border");null!==F&&(H=this.Uwc(F,H),Y=this.Uwc(F,Y),P=this.Uwc(F,P),U=this.Uwc(F,U),M=this.Vwc(F,M),V=this.Vwc(F,V),S=this.Vwc(F,
S),I=this.Vwc(F,I),z.ULS.sendTraceTag(509125330,3022,50,"getCellBorders: Table Border Attribute found and fixed"));return new u.a(H,U,Y,P,N,O,Q,T,M,V,S,I)}static Vwc(F,I){return""===I?F+"px":I}static Uwc(F,I){return 0===I?"0"===F?1:11:I}static Dkm(F){var I=F.querySelectorAll("[class^=TableCellContent]");I=1===I.length?I[0]:void 0;return(F=(null===I||void 0===I?0:I.style)?I.style:F.style)?new x.a(F.paddingTop,F.paddingRight,F.paddingBottom,F.paddingLeft):null}}D.Iyk=w.a.l9("aliceblue","F0F8FF","antiquewhite",
"FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood","DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400",
"darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B","darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro",
"DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo","4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90",
"lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00","limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred",
"C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500","orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown",
"BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD","slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen",
"9ACD32");D.zPk=w.a.l9("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);D.yPk=w.a.l9("",0,"initial",3,"inherit",11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(G.a)(D,"DefaultHtmlTranslatorHelper",null,[])},2095:function(G,J,d){G=d(0);var m=d(7),f=d(2),a=d(263),l=d(231),w=d(96);class y{constructor(){this.Uje=22;this.Mvg=1E3;this.MHo=
2E4;this.SHo=18E4}}Object(G.a)(y,"Config",null,[]);d.d(J,"a",function(){return v});class v{constructor(u){this._url=this.tw=null;this.N4a=this.M4a=0;this.Hlb=!1;this.Jgd="";this.vCh=this._body=this._headers=null;this.tMa=()=>{f.AFrameworkApplication.Be.Ij(this._url,1,this._body,this._headers,!0,2,this.kcb,this.bV,null,void 0,void 0,void 0,void 0,"16",void 0,void 0,void 0,this.vCh)};this.kcb=x=>{var z=v.nW;this.Nld();var A=x.data.rna;let D=null;if(A){v.Ltn(A)||(A=Sys.Net.XMLDOM(x.data.De,!0));if("undefined"===
typeof A.selectSingleNode){z=x.data.De||"[null]";800<z.length&&(z=z.substring(0,400)+"[...]"+z.substring(z.length-400,z.length));m.ULS.sendTraceTag(39387396,301,10,'Invalid docdata.xml retrieved.  Contents: "{0}"',z);this.X9a(x.data);return}D=A.selectSingleNode("/docdata/status")}f.AFrameworkApplication.vUa&&x.data.vi[a.PageStats.Kgd]&&(this.Jgd+=x.data.vi[a.PageStats.Kgd].toString());D&&("InProgress"===D.text&&this.M4a++<v.Qu.Uje||"ServiceBusy"===D.text&&3>this.N4a++)?(m.ULS.sendTraceTag(39387397,
301,50,"Re-requesting; Status: {0}; Retry Count: {1}; Url: {2}",D.text,this.M4a+this.N4a,this._url),this.WNa(v.Qu.Mvg*(this.M4a+this.N4a))):(A=D?D.text:null,m.ULS.sendTraceTag(39387398,301,50,"Request Complete. Result: {0}; Url: {1}",A,this._url),4<z&&m.ULS.sendTraceTag(524104657,301,15,"Request Complete. Result: {0}; Url: {1}; Retry: {2}",A,this._url,z),f.AFrameworkApplication.vUa&&""!==this.Jgd&&(x.data.vi[a.PageStats.Kgd]=this.Jgd,this.Jgd=""),this.tw(!0,A,x.data))};this.bV=x=>{this.Hlb?(v.xHa||
(v.sjb=new Date,v.xHa=!0,v.nW=1),(new Date).getTime()-v.sjb.getTime()<v.Qu.SHo?(this.wxb(4<=v.nW?v.Qu.MHo:v.Qu.Mvg),4===v.nW&&(v.jMc=this.z$.nka(CommonUIStrings.l_NetworkProblemToast,!0),this.z$.Uy(v.jMc))):this.X9a(x.data)):4>v.nW?this.wxb(2*v.Qu.Mvg):this.X9a(x.data)};this.z$=u}send(u,x,z,A,D,F){this._url=u;this.tw=D;this.Hlb=F;this._body=x;this._headers=z;this.vCh=A;this.tMa(null)}WNa(u){u=new w.a(2,1,u,this.tMa,94);f.AFrameworkApplication.mc.Zb(u)}wxb(u){this.WNa(u);v.nW++}X9a(u){m.ULS.sendTraceTag(524104658,
301,15,"Request failed - giving up (failures "+v.nW+"): "+this._url);this.tw(!1,null,u)}Nld(){v.xHa=!1;v.nW=0;if(v.jMc){this.z$.removeEntry(v.jMc);v.jMc=null;const u=this.z$.nka(CommonUIStrings.l_NetworkRestoredToast,!1);u.image=3;this.z$.Uy(u)}}static Laa(u,x,z){return v.GWl(u,x,z)}static GWl(u,x,z){if(l.a.instance.QIa()&&f.AFrameworkApplication.ua&&f.AFrameworkApplication.ua.oPi)return!1;(new v(z)).send(u,null,null,null,x,!1);return!0}static Ltn(u){return!!u&&"undefined"!==typeof u.selectSingleNode}}
v.sjb=null;v.xHa=!1;v.nW=0;v.jMc=null;v.Qu=new y;Object(G.a)(v,"ClientRequestWithRetry",null,[])},2096:function(G,J,d){G=d(0);var m=d(7),f=d(104),a=d(2),l=d(42);const w=(N,M,U)=>{if(N){var O=0;do{try{N();break}catch(V){if(m.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",O,U,V.message,V.stack),O>=M)break}O++}while(1)}};var y=d(96),v=d(33),u=d(34),x=d(205),z=d(139),A=d(49),D=d(1301),F=d(20),I=d(123);d.d(J,"a",function(){return H});
class H{constructor(N,M,U,O,V,Y,Q,S,P=!0,T=null,Z=!1,X=null){this.$ni="FileUpload.ashx";this._iframe=null;this._initialized=!1;this.xm=this.xHc=this.ISe=this.G5a=this.vBd=this.XD=this._form=null;this.ii=!1;this.pA=this.wBd=this.Elb=null;this.g7l=()=>{this.vBd&&(this.vBd.innerText=this.EAi())};this.Shg=()=>{try{if(!this._iframe.contentWindow.document.body)return}catch(ia){this.Nlc();return}if(!(this._initialized||this.avb&&F.a.HF))this.pBf();else if(!this.avb||!F.a.HF||this.dmn){let ia;ia=F.a.Mt?this._iframe.contentWindow.document.body.innerText:
this.GBp?this._iframe.contentWindow.document.body.firstChild.innerText:this._iframe.contentWindow.document.body.firstChild.innerHTML;var aa=this._iframe.contentWindow.document.body.innerText.toLowerCase();const wa=0<=aa.indexOf("responses")||0<=aa.indexOf("wopisrc");aa=0<=aa.indexOf("http error");!wa&&aa&&m.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this._iframe.contentWindow.document.body.innerText);this.UWb(ia)}};this._parent=N;this.Ezk=M;this.pLk=
U;this.njh=V;this.GHa=Q;this.l8g=S;this.Jvh=X;this.Gah=T;this.ycf=!1;this.EAk=O.$("CanaryRenewalForFileUploadIsEnabled");this.GBp=!1;(this.Xjb=Z)||this.oDl(Y);P&&this.FVf()}get SGj(){return this.pLk}get sessionId(){return this.GHa}get dK(){return this._iframe}get qR(){return this.XD}get avb(){return a.AFrameworkApplication.K?a.AFrameworkApplication.K.$("NativeFileOpenDialogIsEnabled"):!1}get Uni(){return a.AFrameworkApplication.K?a.AFrameworkApplication.K.$("FileInputDescriptionAccessibilityIsEnabled"):
!1}get XAp(){return a.AFrameworkApplication.K?a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UploadDocumentFromPCIsEnabled",!1):!1}get dmn(){return this.Xjb?!1:z.b(this._iframe.contentWindow.location.pathname,this.$ni,0)}get I4k(){return!F.a.Ita&&a.AFrameworkApplication.K.$("AllowMultipleImageInsertFromLocalDevice")}FVf(){this.pA=I.a.create().toString();this.Xjb?this.pBf():this.H6k()}oDl(N){this._iframe=document.createElement("iframe");this._iframe.className=N;this._iframe.id=
N;this.njh&&(this._iframe.style.visibility="visible",this._iframe.style.height="30px",this._iframe.setAttribute("frameborder","0"));this.G5a=this.Shg;l.a.addHandler(this._iframe,"load",this.G5a)}BZc(N=null){a.AFrameworkApplication.ua.$qe();if(!this.XD)return m.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";l.a.addHandler(this.XD,"change",()=>{this.f7l(N)});w(Object(f.a)(this,this.Tni,"fileInputClick"),1,"DoFileOpenDialog");return this.XD.value}f7l(N){N&&N(this.XD.value)}Suo(N){l.a.addHandler(this.XD,
"change",()=>{N(this.EAi())})}EAi(){let N=null;if(this.XD.value){const M=this.XD.value,U=M.lastIndexOf("\\");0<U&&(N=M.substring(U+1,M.length))}return N?N:""}Tni(){try{m.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.XD.click()}catch(N){throw m.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",N.message),N;}}Zqd(){this.Rqn()?this.$Yj():(this.dNg(),this._form.submit())}Rqn(){return(this.EAk||this.Xjb)&&!(void 0===window.self.FormData||
null===window.self.FormData)}MLj(N){if(N){const M=this.r9h();this.xm=new XMLHttpRequest;this.xm.open("POST",M);this.xm.setRequestHeader("X-CorrelationId",this.pA);this.aDn(N);this.xm.onreadystatechange=Object(f.a)(this,this.ooa,"uploadResponseReceived");this.xm.send(N)}}aDn(N){if(!F.a.Ita&&N.get){var M=N.get("ImageId");N=window.self.navigator;M={["CorrelationId"]:this.pA,["Canary"]:a.AFrameworkApplication.bN,["ImageNodeId"]:M};N&&(N=N.connection?N.connection:N.mozConnection?N.mozConnection:N.webkitConnection?
N.webkitConnection:null)&&(M.effectiveType=N.effectiveType,M.downlink=N.downlink,M.type=N.type,M.rtt=N.rtt);m.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",M)}}$Yj(){try{this.dNg();m.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const N=new (Type.parse("FormData"))(this._form);this.MLj(N)}catch(N){m.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+N.message),this.UWb(null)}}ZYj(N){try{if(this.dNg(),
m.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.iDp(N)){this.wBd=N;this._form.contains(this.XD)&&this._form.removeChild(this.XD);var M=new (Type.parse("FormData"))(this._form);M.append("applicationfileInput",N.blob,N.filename);this.MLj(M)}else this.UWb(null)}catch(U){m.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+U.message),this.UWb(null)}}iDp(N){return N&&void 0!==N.blob&&null!==N.blob&&void 0!==
N.filename&&null!==N.filename&&""!==N.filename?void 0===window.self.FormData||null===window.self.FormData?(m.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(N=N?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===N.blob||null===N.blob,void 0===N.filename||null===N.filename||""===N.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",m.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",
N)),!1)}ooa(){if(4===this.xm.readyState)if(200===this.xm.status){m.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.pA);const N=this.xm.getResponseHeader("X-NewKey"),M=this.Uen(this.xm);let U=!1;if(void 0!==N&&null!==N&&M&&(U=this.TCp(N),!this.ycf&&U)){m.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.pA);this.ycf=!0;this.IXc();void 0!==this.wBd&&
null!==this.wBd?this.ZYj(this.wBd):this.$Yj();return}m.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.ycf,M,!(void 0===N||null===N),U,this.pA);this.UWb(this.xm.responseText)}else m.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.xm.status,this.xm.responseText?!1:!0,this.pA),this.UWb(null)}Uen(N){try{const M=
u.a(N.responseText).Responses;if(void 0!==M&&null!==M&&1===M.length){const U=M[0];if(void 0!==U&&null!==U&&2===U.length&&28===U[1].StatusCode)return!0}}catch(M){}return!1}TCp(N){D.a.WEe(N);return a.AFrameworkApplication.bN!==N?!1:!0}dNg(){this.Elb||(this.Elb=new Date)}dispose(){this.ii||(this.Xjb?this._parent.removeChild(this._form):(this._parent.removeChild(this._iframe),l.a.removeHandler(this._iframe,"load",this.G5a),this.G5a=null),this.ISe&&(l.a.removeHandler(this.XD,"change",this.ISe),this.ISe=
null),this.Uni&&(this.xHc&&(l.a.removeHandler(this.XD,"change",this.xHc),this.xHc=null),this.vBd=null),this.XD=this._form=this._parent=this._iframe=null,this.ii=!0,this.Elb=null,m.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}zPl(){this.dispose()}Vfc(N,M){if(this._form){var U;(U=this._form.querySelector("input[name="+N+"]"))?U.value=M:(U=this.Vtf(),U.type="hidden",U.id=N,U.name=N,U.value=M,this._form.appendChild(U))}}Vtf(){return this.Xjb?document.createElement("input"):this._iframe.contentWindow.document.createElement("input")}pBf(){if(!this._initialized){var N=
this.kD("uploadForm");const M=this.kD("fileInput"),U=this.r9h();this.NFl();this._form.id=N;this._form.method="post";this._form.encoding="multipart/form-data";this._form.action=U;this.XD.type="file";this.l8g&&(this.XD.accept=this.l8g,this.Gah&&(this.XD.capture=this.Gah));this.XD.id=M;this.XD.name=M;this.I4k&&(this.XD.multiple=!0);this.XAp&&("true"===this.Jvh?this.XD.multiple=!0:"false"===this.Jvh&&(this.XD.multiple=!1));!this.Uni||F.a.Mt||F.a.ju||(this.xHc=this.g7l,l.a.addHandler(this.XD,"change",
this.xHc),this.vBd=v.a.zSh(this._form,this.XD,"InputFileDescription"));this.njh&&(this.Xjb||(N=this._iframe.contentWindow.document.body,N.style.margin="0",N.style.overflow="hidden"),N=a.AFrameworkApplication.ua,this.XD.style.fontFamily=N.bFa,this.XD.style.fontSize=N.bLg,this.XD.style.margin="0");(N=document.getElementById("__REQUESTDIGEST"))&&this.Vfc("__REQUESTDIGEST",N.value);this.IXc();this._form.appendChild(this.XD);this._initialized=!0;this.Ezk(this)}}NFl(){if(this.Xjb)this._form=document.createElement("form"),
this._parent.appendChild(this._form),this.XD=document.createElement("input");else{this._form=this._iframe.contentWindow.document.createElement("form");const N=this._iframe.contentWindow.document;N.body.appendChild(this._form);this.XD=N.createElement("input")}}H6k(){this._parent.appendChild(this._iframe);this.avb&&F.a.HF&&this.pBf()}r9h(){var N=new x.QueryStringBuilder(this.$ni);a.AFrameworkApplication.Aja(N);this.CMj(N);N=N.toString();if(F.a.uj||F.a.HF||F.a.ju)N=A.a.O1c(N);return N}gRd(){const N=
new y.a(2,1,0,Object(f.a)(this,this.zPl,"delayedDispose"),4);a.AFrameworkApplication.mc.Zb(N)}}Object(G.a)(H,"UploadFrame",null,[13])},2097:function(G,J,d){G=d(0);class m{constructor(a){this.next=null;this.data=a}}Object(G.a)(m,"QueueNode",null,[]);d.d(J,"a",function(){return f});class f{constructor(){this.UK=this.BBb=null;this.Jk=0}get count(){return this.Jk}get isEmpty(){return!this.count||!this.BBb||!this.UK}enqueue(a){a=new m(a);this.isEmpty?this.UK=this.BBb=a:this.BBb=this.BBb.next=a;this.Jk=
this.count+1}back(){return this.isEmpty?null:this.BBb.data}dequeue(){if(this.isEmpty)return null;const a=this.UK;this.UK=a.next;this.Jk=this.count-1;this.UK||(this.BBb=null);return a.data}clear(){this.UK=this.BBb=null;this.Jk=0}toArray(){const a=Array(this.count);let l=this.UK;for(let w=0;w<this.count&&l;w++)a[w]=l.data,l=l.next;return a}}Object(G.a)(f,"Queue",null,[])},2169:function(G,J,d){d.d(J,"b",function(){return m});d.d(J,"e",function(){return f});d.d(J,"d",function(){return a});d.d(J,"c",function(){return l});
d.d(J,"h",function(){return w});d.d(J,"a",function(){return y});d.d(J,"f",function(){return v});d.d(J,"g",function(){return u});var m;(function(x){x[x.Unspecified=0]="Unspecified";x[x.Inline=1]="Inline";x[x.Floating=2]="Floating"})(m||(m={}));var f;(function(x){x[x.Undefined=0]="Undefined";x[x.Bullet=1]="Bullet";x[x.Numbered=2]="Numbered";x[x.Lim=3]="Lim";x[x.Nil=4]="Nil";x[x.Any=5]="Any";x[x.NoList=6]="NoList";x[x.Invalid=7]="Invalid"})(f||(f={}));var a;(function(x){x[x.DontCare=1]="DontCare";x[x.Thin=
2]="Thin";x[x.ExtraLight=3]="ExtraLight";x[x.Light=4]="Light";x[x.Normal=5]="Normal";x[x.Medium=6]="Medium";x[x.SemiBold=7]="SemiBold";x[x.Bold=8]="Bold";x[x.ExtraBold=9]="ExtraBold";x[x.Heavy=10]="Heavy"})(a||(a={}));var l;(function(x){x[x.NoCaps=0]="NoCaps";x[x.SmallCaps=1]="SmallCaps";x[x.AllCaps=2]="AllCaps";x[x.AllPetiteCaps=3]="AllPetiteCaps";x[x.PetiteCaps=4]="PetiteCaps";x[x.Unicase=5]="Unicase";x[x.Titling=6]="Titling";x[x.Other=7]="Other"})(l||(l={}));var w;(function(x){x[x.None=0]="None";
x[x.Words=1]="Words";x[x.SingleLine=2]="SingleLine";x[x.DoubleLine=3]="DoubleLine";x[x.HeavyLine=4]="HeavyLine";x[x.DottedLine=5]="DottedLine";x[x.DottedHeavyLine=6]="DottedHeavyLine";x[x.DashLine=7]="DashLine";x[x.DashHeavyLine=8]="DashHeavyLine";x[x.DashLongLine=9]="DashLongLine";x[x.DashLongHeavyLine=10]="DashLongHeavyLine";x[x.DotDashLine=11]="DotDashLine";x[x.DotDashHeavyLine=12]="DotDashHeavyLine";x[x.DotDotDashLine=13]="DotDotDashLine";x[x.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";x[x.WavyLine=
15]="WavyLine";x[x.WavyHeavyLine=16]="WavyHeavyLine";x[x.WavyDoubleLine=17]="WavyDoubleLine"})(w||(w={}));var y;(function(x){x[x.Left=0]="Left";x[x.Right=1]="Right";x[x.Center=2]="Center";x[x.Justified=3]="Justified";x[x.Other=4]="Other";x[x.None=5]="None";x[x.JustifyLow=6]="JustifyLow";x[x.Distributed=7]="Distributed";x[x.ThaiDistributed=8]="ThaiDistributed"})(y||(y={}));var v;(function(x){x[x.Image=0]="Image";x[x.TextBox=1]="TextBox";x[x.Chart=2]="Chart";x[x.SmartArt=3]="SmartArt";x[x.Drawing=4]=
"Drawing";x[x.EquationObject=5]="EquationObject";x[x.Ink=6]="Ink";x[x.InkSpace=7]="InkSpace";x[x.InkEndOfLine=8]="InkEndOfLine";x[x.LineBreak=9]="LineBreak";x[x.PageBreak=10]="PageBreak";x[x.PageNumbers=11]="PageNumbers";x[x.FootnoteEndnote=12]="FootnoteEndnote";x[x.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";x[x.Tab=14]="Tab";x[x.UnsupportedObject=15]="UnsupportedObject";x[x.Other=16]="Other"})(v||(v={}));var u;(function(x){x[x.Initial=0]="Initial";x[x.FirstLine=1]="FirstLine";
x[x.Hanging=2]="Hanging"})(u||(u={}))},2170:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);var m;(function(f){f[f.normal=0]="normal";f[f.dE=1]="beingCreated";f[f.ncl=2]="beingEdited"})(m||(m={}));Object(G.b)("CommentType",m)},2172:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(G.a)(m,
"DeltaAttributes",null,[])},2173:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{static WKf(f){return f===m.create?0:f===m.reply?1:f===m.Oob?2:f===m.metadata?3:null}}m.create="CREATE";m.reply="REPLY";m.Oob="EDIT";m.metadata="METADATA";Object(G.a)(m,"CommentSessionType",null,[])},2174:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);var m;(function(f){f[f.zoq=0]="unsaved";f[f.YLj=1]="sentToServer";f[f.succeeded=2]="succeeded";f[f.UB=3]="failed";f[f.Wiq=4]="saveNotNeeded"})(m||
(m={}));Object(G.b)("CommentSaveStatus",m)},2175:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a){this.className=f;this.v5c=a}}Object(G.a)(m,"HighlightCssClassPair",null,[])},2176:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.type=this.action=0;this.dM=this.ZB=null}}Object(G.a)(m,"HighlightOperation",null,[])},2177:function(G,J,d){d.d(J,"a",function(){return a});G=d(0);var m=d(477);J=d(273);var f=d(102);class a extends J.a{constructor(){super();
this.LastKnownPaginationRevision=this.FileId=null}lm(){return m.a.lrj}static Xea(l,w){const y=new a;y.FileId=l;y.LastKnownPaginationRevision=f.a(w);return y}}Object(G.a)(a,"PaginationRequest",J.a,[])},2179:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{Ykc(f,a){let l="g";a.matchCase||a.Lje||(l+="i");if(a.matchPrefix||a.matchWholeWord)f="\\b"+f;if(a.matchSuffix||a.matchWholeWord)f+="\\b";return new RegExp(f,l)}static get instance(){return m._instance||(m._instance=new m)}}m._instance=
null;Object(G.a)(m,"FindUtils",null,[1600])},2181:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a){this._text=f;this.CHc=a}get text(){return this._text}get matchCase(){return this.vTb(1)}get matchWholeWord(){return this.vTb(2)}get Lje(){return this.vTb(4)}get matchPrefix(){return this.vTb(8)}get matchSuffix(){return this.vTb(16)}get ignorePunct(){return this.vTb(32)}get ignoreSpace(){return this.vTb(64)}vTb(f){return(this.CHc&f)===f}static createQuery(f,a){return new m(f,
a)}}Object(G.a)(m,"Query",null,[1589])},2182:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);var m;(function(f){f[f.none=0]="none";f[f.matchCase=1]="matchCase";f[f.ZOg=2]="wholeWordOnly";f[f.HFp=4]="wildCards";f[f.prefix=8]="prefix";f[f.suffix=16]="suffix";f[f.ignorePunct=32]="ignorePunct";f[f.ignoreSpace=64]="ignoreSpace"})(m||(m={}));Object(G.b)("QueryFilters",m)},2183:function(G,J,d){d.d(J,"a",function(){return m});var m;(function(f){f.Acronym="Acronym";f.Address="Address";f.Attachment=
"Attachment";f.Bookmark="Bookmark";f.Building="Building";f.Channel="Channel";f.Chat="Chat";f.Conversation="Conversation";f.DateTime="DateTime";f.Document="Document";f.EditorialQnA="EditorialQnA";f.Email="Email";f.EmployeeOffer="EmployeeOffer";f.Event="Event";f.External="External";f.Fact="Fact";f.File="File";f.Flight="Flight";f.Floorplan="Floorplan";f.Group="Group";f.Keywords="Keywords";f.Link="Link";f.LocalBusiness="LocalBusiness";f.Loop="Loop";f.MeetingProposal="MeetingProposal";f.MeetingRoomProposal=
"MeetingRoomProposal";f.Message="Message";f.MessageExtensionApp="MessageExtensionApp";f.PIM="PIM";f.People="People";f.Report="Report";f.Satori="Satori";f.Scope="Scope";f.SharePoint="SharePoint";f.Site="Site";f.Streams="Streams";f.Task="Task";f.Team="Team";f.Text="Text";f.Time="Time";f.Topic="Topic";f.TranscriptLlmAnswer="TranscriptLlmAnswer";f.TuringQnA="TuringQnA";f.VivaSales="VivaSales"})(m||(m={}))},2184:function(G,J,d){d.d(J,"b",function(){return f});d.d(J,"a",function(){return a});var m=d(39);
(function(){function l(w){m.a.assign(l,this,w)}l.getTypeName=function(){return"AugLoop_ObservationalAssistance_ControlSignal"};l.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};l.typeGuard=function(w){return m.a.matchesTypesFor(w,[l.getTypeName()])};l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};return l})();(function(){function l(w){m.a.assign(l,this,w)}l.getTypeName=function(){return"AugLoop_ObservationalAssistance_InteractionModeSignal"};l.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal",
"AugLoop_Signals_Signal"]};l.typeGuard=function(w){return m.a.matchesTypesFor(w,[l.getTypeName()])};l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};return l})();var f=function(){function l(w){m.a.assign(l,this,w)}l.getTypeName=function(){return"AugLoop_ObservationalAssistance_StartupSignal"};l.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]};l.typeGuard=function(w){return m.a.matchesTypesFor(w,[l.getTypeName()])};l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};
return l}(),a=function(){function l(w){m.a.assign(l,this,w)}l.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientConfigSignal"};l.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]};l.typeGuard=function(w){return m.a.matchesTypesFor(w,[l.getTypeName()])};l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};return l}();(function(){function l(w){m.a.assign(l,this,w)}l.getTypeName=function(){return"AugLoop_ObservationalAssistance_ShutdownSignal"};
l.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]};l.typeGuard=function(w){return m.a.matchesTypesFor(w,[l.getTypeName()])};l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};return l})()},2185:function(G,J,d){d.d(J,"a",function(){return m});var m;(function(f){f.blankDocument="blankDocument";f.blankLine="blankLine";f.selection="selection"})(m||(m={}))},2186:function(G,J,d){d.d(J,"a",function(){return f});d.d(J,"b",function(){return a});var m=d(39);
class f{constructor(l){m.a.assign(f,this,l)}static getTypeName(){return"AugLoop_TextSummarization_GenerateTextSummarySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.a.matchesTypesFor(l,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.a.assign(a,this,l)}static getTypeName(){return"AugLoop_TextSummarization_GptSummarySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.a.matchesTypesFor(l,
[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},2189:function(G,J,d){d.d(J,"a",function(){return m});d.d(J,"b",function(){return l});var m;(function(w){w[w.EditorLowPrivilege=0]="EditorLowPrivilege";w[w.AugLoopLowPrivilege=1]="AugLoopLowPrivilege";w[w.Anonymous=2]="Anonymous";w[w.ClientAssertion=3]="ClientAssertion";w[w.ClientAssertionV2=4]="ClientAssertionV2";w[w.AutoClpLowPrivilege=5]="AutoClpLowPrivilege";w[w.AutoClpAppOnlyLowPrivilege=6]="AutoClpAppOnlyLowPrivilege";w[w.Substrate=
7]="Substrate";w[w.WacUserInfo=8]="WacUserInfo";w[w.OwaExchange=9]="OwaExchange";w[w.SmartCompose=10]="SmartCompose";w[w.WritingAnalyticsLowPrivilege=11]="WritingAnalyticsLowPrivilege";w[w.DWEngineLowPrivilege=12]="DWEngineLowPrivilege";w[w.SubstrateApp=13]="SubstrateApp";w[w.CortanaAppPop=14]="CortanaAppPop";w[w.OfficeAppsAppOnly=15]="OfficeAppsAppOnly";w[w.PPTFrontdoorAppPop=16]="PPTFrontdoorAppPop";w[w.EditorAppOnlyLowPrivilege=17]="EditorAppOnlyLowPrivilege";w[w.AugLoopApp=18]="AugLoopApp";w[w.MeetingIntelligenceApp=
19]="MeetingIntelligenceApp";w[w.GraphApp=20]="GraphApp";w[w.IceServicesApp=21]="IceServicesApp";w[w.AzureMapsApp=22]="AzureMapsApp";w[w.SpoApp=23]="SpoApp";w[w.OneDrive=24]="OneDrive";w[w.GoogleDrive=25]="GoogleDrive";w[w.GettyApp=26]="GettyApp";w[w.Dropbox=27]="Dropbox";w[w.GooglePhotos=28]="GooglePhotos";w[w.EditorApp=29]="EditorApp";w[w.AmazonKindle=30]="AmazonKindle";w[w.ShredderApp=31]="ShredderApp";w[w.FormsLowPrivilege=32]="FormsLowPrivilege";w[w.VivaSalesLowPrivilege=33]="VivaSalesLowPrivilege";
w[w.IntentSvcApp=34]="IntentSvcApp";w[w.DcgLowPrivilege=35]="DcgLowPrivilege";w[w.CSALowPrivilege=36]="CSALowPrivilege";w[w.ConsumerSydneyLowPrivilege=37]="ConsumerSydneyLowPrivilege";w[w.CompliantSydneyApp=38]="CompliantSydneyApp";w[w.M365AdminApp=39]="M365AdminApp";w[w.MeetingArtifactsServiceLowPrivilege=40]="MeetingArtifactsServiceLowPrivilege";w[w.AlchemyApp=41]="AlchemyApp";w[w.M365Admin=42]="M365Admin";w[w.ConsumerShellApp=43]="ConsumerShellApp";w[w.PowerQueryLowPrivilege=44]="PowerQueryLowPrivilege";
w[w.CIIApp=45]="CIIApp";w[w.ConsumerShell=46]="ConsumerShell";w[w.AssistCopilotLowPrivilege=47]="AssistCopilotLowPrivilege";w[w.Pva=48]="Pva";w[w.TeamsCopilotServiceLowPrivilege=49]="TeamsCopilotServiceLowPrivilege"})(m||(m={}));var f;(function(w){w[w.Unknown=0]="Unknown";w[w.Consumer=1]="Consumer";w[w.Enterprise=2]="Enterprise"})(f||(f={}));var a;(function(w){w.AuthorizationCode="authorization_code";w.ClientCredentials="client_credentials";w.RefreshToken="refresh_token"})(a||(a={}));var l;(function(w){w[w.LoggedIn=
0]="LoggedIn";w[w.LoggedOut=1]="LoggedOut"})(l||(l={}))},2191:function(G,J,d){d.d(J,"a",function(){return l});d.d(J,"b",function(){return y});var m=d(39);class f{constructor(v){m.a.assign(f,this,v)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(v){return m.a.matchesTypesFor(v,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(v){m.a.assign(a,this,v)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(v){return m.a.matchesTypesFor(v,
[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(v){m.a.assign(l,this,v)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(v){return m.a.matchesTypesFor(v,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class w{constructor(v){m.a.assign(w,this,v)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(v){return m.a.matchesTypesFor(v,
[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class y{constructor(v){m.a.assign(y,this,v)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(v){return m.a.matchesTypesFor(v,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()}},2192:function(G,J,d){d.d(J,"a",function(){return y});G=d(0);var m=d(182),f=d(184),a=d(2),l=d(73),w=d(211);class y extends m.a{constructor(v,u=!1){super(v,!1,u)}get c$c(){return!1}get kN(){return w.a.fZc+
"/modeless"}get jub(){return null}set jub(v){}get dub(){return null}set dub(v){}pi(v,u=null,x=null){this.uW&&(x.isModal=!1);super.pi(v,u,x)}hide(){if(a.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Oc)this.V7j(),a.AFrameworkApplication.ua.Iy.ny(f.AFrame.z9f),super.hide()}CWk(){const v=a.AFrameworkApplication.ua.Iy,u=a.AFrameworkApplication.ua.sq;v.Z$(this.kN);v.xW(this.kN);u.ge(this.kN).parent=f.AFrame.mq}dza(){l.FocusManager.vM()&&
(super.dza(),this.CWk(),a.AFrameworkApplication.ua.Iy.bL(f.AFrame.z9f))}osg(){if(l.FocusManager.vM()&&!a.AFrameworkApplication.ol){const v=l.FocusManager.instance();v.fV(this.kN);const u=v.getRegion(this.kN);u&&u.Mk.mA(null);v.mdb(this.kN)}}$ga(){"DL"===this.aIa||"DP"===this.aIa?super.$ga():a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WacAutoFitNonModalDialogIsEnabled")?(this.V7j(),this.QVh()&&this.UVj(this.Oc.clientHeight,this.Oc.clientWidth)):this.WN()}WN(){this.UVj(m.a.keh,m.a.seh)}UVj(v,
u){if(this.dub&&this.jub){let x,z;x=w.a.Tqe+this.jub;z=w.a.Sqe+this.dub;x+v>this.jD()&&(x=this.jD()-v);z+u>this.ev()&&(z=this.ev()-u);this.VVj(x,z)}else super.WN()}oMf(v){if(!v)return null;v.endsWith("px")&&(v=v.substring(0,v.length-2));return w.a.Noc(v)?((v=parseInt(v))||(v=1),v):null}V7j(){if(this.Oc&&this.Oc.style){var v=this.oMf(this.Oc.style.top);v&&(this.jub=v-w.a.Tqe);if(v=a.AFrameworkApplication.isRtl?this.oMf(this.Oc.style.right):this.oMf(this.Oc.style.left))this.dub=v-w.a.Sqe}}}Object(G.a)(y,
"ModelessCustomDialog",m.a,[])},2193:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{AVa(){}Fic(){}Lye(){}hxe(){}reset(){}eEf(){}update(){}vyb(){}dispose(){}}Object(G.a)(m,"FindStatusManagerStub",null,[241,13])},2205:function(G,J,d){d.d(J,"b",function(){return m});d.d(J,"a",function(){return f});var m;(function(a){a[a.None=0]="None";a[a.BetweenLeftAndRightMargin=1]="BetweenLeftAndRightMargin";a[a.BetweenLeftAndRightEdge=2]="BetweenLeftAndRightEdge";a[a.FitToBox=3]="FitToBox"})(m||(m=
{}));var f;(function(a){a.left="left";a.center="center";a.right="right";a.both="both"})(f||(f={}))},2206:function(G,J,d){d.d(J,"a",function(){return m});var m;(function(a){a.Insert="Insert";a.Rewrite="Rewrite";a.Start="Start";a.VisualizeAsTable="VisualizeAsTable"})(m||(m={}));var f;(f||(f={})).FlowCompleted="CopilotComposeFlowCompleted"},2207:function(G,J,d){d.d(J,"a",function(){return f});d.d(J,"b",function(){return l});d.d(J,"c",function(){return w});var m=d(39);class f{constructor(y){m.a.assign(f,
this,y)}get metadata(){return this.M_}set metadata(y){this.M_=y}static getTypeName(){return"AugLoop_AiInsert_AiInsertAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return m.a.matchesTypesFor(y,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(y){m.a.assign(a,this,y)}get metadata(){return this.M_}set metadata(y){this.M_=y}static getTypeName(){return"AugLoop_AiInsert_AiInsertAnnotationV2"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return m.a.matchesTypesFor(y,
[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(y){m.a.assign(l,this,y)}get metadata(){return this.M_}set metadata(y){this.M_=y}static getTypeName(){return"AugLoop_AiInsert_AiInsertStreamChunkAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return m.a.matchesTypesFor(y,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class w{constructor(y){m.a.assign(w,this,y)}get metadata(){return this.M_}set metadata(y){this.M_=
y}static getTypeName(){return"AugLoop_AiInsert_AiInsertStreamCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return m.a.matchesTypesFor(y,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()}},2208:function(G,J,d){d.d(J,"a",function(){return f});var m=d(39);class f{constructor(w){m.a.assign(f,this,w)}static getTypeName(){return"AugLoop_AiInsert_AiInsertSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(w){return m.a.matchesTypesFor(w,
[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(w){m.a.assign(a,this,w)}static getTypeName(){return"AugLoop_AiInsert_AiInsertSignalV2"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(w){return m.a.matchesTypesFor(w,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(w){m.a.assign(l,this,w)}static getTypeName(){return"AugLoop_AiInsert_LimitCount"}static getBaseTypes(){return[]}static typeGuard(w){return m.a.matchesTypesFor(w,
[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},2229:function(G,J,d){G=d(0);var m=d(1688),f=d(1689),a=d(1772),l=d(233),w=d(34);class y{}y.eventType="Type";y.ppb="Time";y.eventId="Id";y.xVh="AttributionId";y.yVh="AttributionProvider";y.wVh="AttributionName";y.bVh="AssigneeId";y.cVh="AssigneeProvider";y.aVh="AssigneeName";y.startDate="Start";y.endDate="End";y.title="Title";y.Y4h="Anchor";y.anchorExtensionList="AnchorExtensionList";y.Ksj="Percent";y.priority="Priority";y.undoId="UndoId";
y.isLossy="IsLossy";y.recordExtensionList="RecordExtensionList";Object(G.a)(y,"Key",null,[]);var v=d(381),u=d(1933);const x=A=>{if(!A)return null;let D=null;A=v.a.wMb(A,F=>F.toString(),F=>F.toString());0<A.count&&(D=new u.a(A));return D};d.d(J,"a",function(){return z});class z{Fyg(A){if(!A)return"[]";A=z.nBl(A);return w.c(A)}Tgc(A){A=w.b(A||"[]");return z.XAl(A)}static Tha(A,D){throw Error.argument(A,D);}static Hkc(A,D){D=D.toString();return D in A?A[D].toString():null}static HQb(A,D){D=D.toString();
D in A||z.Tha("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",D));return A[D].toString()}static ZKf(A,D){D=D.toString();D in A||z.Tha("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",D));return Number.parseInvariant(A[D].toString())}static OCm(A,D,F){D=D.toString();return D in A?Boolean.parse(A[D].toString()):F}static PCm(A,D){D=D.toString();return D in A?A[D]:null}static aGg(A){A=new Date(A);isNaN(A.getUTCMilliseconds())&&z.Tha("dateTime",
"Date and time is in invalid format");return A}static fwf(A){return A.toISOString()}static r$h(A,D){return x(z.PCm(A,D))}static oBl(A){const D={};D[y.eventType]=A.type;D[y.ppb]=z.fwf(A.time);D[y.eventId]=A.recordId;A.isLossy!==z.w_i&&(D[y.isLossy]=A.isLossy);A.user&&(A.user.UserId&&A.user.Provider&&A.user.DisplayName||z.Tha("record","HistoryRecord has invalid attribution"),D[y.xVh]=A.user.UserId,D[y.yVh]=A.user.Provider,D[y.wVh]=A.user.DisplayName);A.commentId&&(D[y.Y4h]=A.commentId);if(A.anchorExtensionList&&
A.anchorExtensionList.extensions){var F=A.anchorExtensionList.extensions.dAc();D[y.anchorExtensionList]=F}A.recordExtensionList&&A.recordExtensionList.extensions&&(F=A.recordExtensionList.extensions.dAc(),D[y.recordExtensionList]=F);switch(A.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:A.assignee&&A.assignee.UserId&&A.assignee.Provider&&A.assignee.DisplayName||z.Tha("record","HistoryRecord has invalid assignee");D[y.bVh]=A.assignee.UserId;D[y.cVh]=A.assignee.Provider;D[y.aVh]=A.assignee.DisplayName;
break;case 5:A.schedule||z.Tha("record","Schedule history record must have a schedule object");A.schedule.startDate&&(D[y.startDate]=z.fwf(A.schedule.startDate));A.schedule.endDate&&(D[y.endDate]=z.fwf(A.schedule.endDate));break;case 6:(0>A.completion||100<A.completion)&&z.Tha("record","Progress history record must have a completion >= 0 and <= 100");D[y.Ksj]=A.completion;break;case 10:(0>A.priority||10<A.priority)&&z.Tha("record","Priority history record must have a completion >= 0 and <= 10");D[y.priority]=
A.priority;break;case 9:A.title||z.Tha("record","SetTitle history record must have a title");D[y.title]=A.title;break;case -1:A.undoId||z.Tha("record","Undo history record must have an id to undo");D[y.undoId]=A.undoId;break;default:z.Tha("record","Unsupported history record type")}return D}static xBl(A){var D=null,F=z.Hkc(A,y.xVh);const I=z.Hkc(A,y.yVh),H=z.Hkc(A,y.wVh);if(F||I||H)F&&I&&H||z.Tha("dictionary","Record has invalid attribution user"),D=new m.a(F,I,H);D=new f.a(z.ZKf(A,y.eventType),D,
z.aGg(z.HQb(A,y.ppb)),z.HQb(A,y.eventId));D.commentId=z.Hkc(A,y.Y4h);D.anchorExtensionList=z.r$h(A,y.anchorExtensionList);D.recordExtensionList=z.r$h(A,y.recordExtensionList);D.isLossy=z.OCm(A,y.isLossy,z.w_i);switch(D.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:D.assignee=new m.a(z.HQb(A,y.bVh),z.HQb(A,y.cVh),z.HQb(A,y.aVh));break;case 5:D.schedule=new a.a;if(F=z.Hkc(A,y.startDate))D.schedule.startDate=z.aGg(F);if(A=z.Hkc(A,y.endDate))D.schedule.endDate=z.aGg(A);break;case 10:D.priority=
z.ZKf(A,y.priority);(0>D.priority||10<D.priority)&&z.Tha("dictionary","Priority record must have history >= 0 and <= 10");break;case 6:D.completion=z.ZKf(A,y.Ksj);(0>D.completion||100<D.completion)&&z.Tha("dictionary","Progress record must have history >= 0 and <= 100");break;case 9:D.title=z.HQb(A,y.title);break;case -1:D.undoId=z.HQb(A,y.undoId);break;default:z.Tha("dictionary","Unsupported history record type")}return D}static nBl(A){const D=Array(A.length);for(let F=0;F<A.length;++F)D[F]=z.oBl(A.J(F));
return D}static XAl(A){const D=new l.a;for(const F of A)A=z.xBl(F),D.add(A);return D}}z.w_i=!1;Object(G.a)(z,"JsonTaskHistorySerialization",null,[652])},2231:function(G,J,d){G=d(0);class m{constructor(l){this.result=null;this.oAj=l}exec(l){return(this.result=this.oAj.exec(l))?!0:!1}DL(){return this.result.index}J7d(){return this.oAj.lastIndex}}Object(G.a)(m,"RegularExpressionWrapper",null,[]);var f=d(19);d.d(J,"a",function(){return a});class a{Yhd(l){return this.fXj(l).join("").replace(RegExp("(\\\\.\\\\.\\\\.)",
"g"),"(\\.\\.\\.|\u2026)")}Puj(l){var w=l.text;w=l.Lje?this.Uap(w):this.fXj(w);if(l.ignorePunct||l.ignoreSpace){let y="";l.ignoreSpace&&(y+="\\s");l.ignorePunct&&(y+=a.ljo);y="["+y+"]*";for(let v=1;v<w.length;v++)if(!l.Lje||"{"!==w[v].charAt(0)&&"@"!==w[v].charAt(0))w[v]=y+w[v]}return w.join("")}uXb(l){return[l]}Yge(l){for(let w=0;w<l.length;++w){const y=l.charAt(w);let v=0;if("["===y){if(!({AF:v}=this.Grn(l.substr(w))).returnValue)return!1;w=v+w-1}else if("<"===y){if(!this.Drn(l.substr(w)))return!1}else if(">"===
y){if(!w)return!1}else if("{"===y){if(!w||!({AF:v}=this.Frn(l.substr(w))).returnValue)return!1;w=v+w-1}else if("@"===y){if(!w||!this.Ern(l.substr(w)))return!1}else if("("===y){if(!({AF:v}=this.Crn(l.substr(w))).returnValue)return!1;w=v+w-1}else if("}"===y||"]"===y||")"===y)return!1}return!0}ipi(l,w){let y,v;v=y=0;if(l.length<=w)return{returnValue:!1,AF:y,Jud:v};const u=l.length;var x=l.charAt(w);if("["===x)for(x=w+1;x<u;x++){if("]"===l.charAt(x)&&1!==x-w)return y=x,v=5,{returnValue:!0,AF:y,Jud:v}}else if("{"===
x)for(x=-1,w+=1;w<u;w++){const z=l.charAt(w);if(","===z)x=w;else if("}"===z)return v=-1===x?6:1!==w-x?7:8,y=w,{returnValue:!0,AF:y,Jud:v}}return{returnValue:!1,AF:y,Jud:v}}Dqp(l,w,y){let v;if((v=w)||1!==l.length)switch(l.charAt(w+1)){case "{":let u,x;if(!({AF:u,Jud:x}=this.ipi(l,w+1)).returnValue)return{returnValue:this.rPa("*",y,!1),AF:v};l=this.rPa("*",y,!0)+this.rPa(l.substring(w+1,u+1),x);v=u;if(7===x||8===x)l+="?";return{returnValue:l,AF:v};case "@":return v=w+1,{returnValue:this.rPa("*",y,!0),
AF:v};case "*":if(!w){for(v++;"*"===l.charAt(v);)v++;if(v===l.length)return{returnValue:this.rPa("*",y,!0),AF:v}}return{returnValue:this.rPa("*",y,!1),AF:v};default:return{returnValue:this.rPa("*",y,!1),AF:v}}else return{returnValue:this.rPa(l,y,!0),AF:v}}rPa(l,w,y=!1){const v=l.length;switch(w){case 5:return"!"===l.charAt(1)&&2<v?"([^"+this.Ruj(l.substr(2,v-3))+"]\u0640*)":"(["+this.Ruj(l.substr(1,v-2))+"]\u0640*)";case 6:return l;case 7:return l;case 9:return"+?";case 8:return l;case 3:return"\\b";
case 4:return"\\b";case 1:return".";case 2:return y?"(.+?)":"(.*?)";case 10:return l}return null}BKi(l){switch(l){case "?":return 1;case "*":return 2;case "<":return 3;case ">":return 4;case "@":return 9}return 0}Ldo(l){return"["===l||"]"===l||"\\"===l||"("===l||")"===l?String.format("\\{0}",l):"'"===l||"\u2018"===l||"\u2019"===l||'"'===l||"\u201c"===l||"\u201d"===l||f.a.qga(l)?this.cng(l):l}Ruj(l){const w=[];for(let y=0;y<l.length;++y)w[y]=this.Ldo(l.charAt(y));return w.join("")}Grn(l){let w;var y;
w=-1;var v=new m(RegExp("\\[.+?\\]","g"));if(v.exec(l)){if(y=v.DL())return{returnValue:!1,AF:w};w=v.J7d()}else return{returnValue:!1,AF:w};if((new m(RegExp("(\\(\\))|(.+?!)","g"))).exec(l.substring(1,w-1)))return{returnValue:!1,AF:w};y=new m(RegExp("[^!\\[]-[^\\]]","g"));for(l.substring(0,w);y.exec(l.substring(0,w));){v=y.DL();const u=RegExp("[-]","g");v=l.substring(v,y.J7d()).split(u);if(v[0].charAt(0)>v[1].charAt(0))return{returnValue:!1,AF:w}}return{returnValue:!0,AF:w}}Drn(l){return(new m(RegExp("\\<(\\{|\\@|\\>|\\<|\\}|\\))",
"g"))).exec(l)?!1:!0}Frn(l){let w;w=-1;var y;if((new m(RegExp("(\\}\\{)|(\\}\\@)","g"))).exec(l))return{returnValue:!1,AF:w};const v=new m(RegExp("\\{\\d+(,|(,\\d+))?\\}","g"));if(v.exec(l)){if(y=v.DL())return{returnValue:!1,AF:w};w=v.J7d();y=RegExp("[{,}]","g");y=l.substring(0,w).split(y);if(4===y.length&&(l=Number.parseInvariant(y[1]),y=Number.parseInvariant(y[2]),l>=y))return{returnValue:!1,AF:w}}else return{returnValue:!1,AF:w};return{returnValue:!0,AF:w}}Ern(l){return(new m(RegExp("\\@\\{","g"))).exec(l)?
!1:!0}Crn(l){let w;w=-1;let y;const v=new m(RegExp("\\(([^\\[\\]]*?(\\[.+?\\])?)+?\\)","g"));if(v.exec(l)){y=v.DL();w=v.J7d();if(y)return{returnValue:!1,AF:w};if(this.Yge(l.substring(1,w-1)))return{returnValue:!0,AF:w}}return{returnValue:!1,AF:w}}Uap(l){const w=[],y=l.length;let v=0;for(let u=0;u<y;++u){const x=v,z=l.charAt(u);let A=0,D=0;"["===z||"\\"===z||"^"===z||"$"===z||"."===z||"|"===z||"+"===z||"("===z||")"===z||"?"===z||"*"===z||"<"===z||">"===z||"@"===z||"?"===z||"{"===z?"["!==z&&"{"!==z||
!({AF:A,Jud:D}=this.ipi(l,u)).returnValue?"?"===z||"<"===z||">"===z||"@"===z?(D=this.BKi(z),w[x]=this.rPa(z,D)):"*"===z?(D=this.BKi(z),w[x]=({AF:A}=this.Dqp(l,u,D)).returnValue,u=A):"("===z||")"===z?(D=10,w[x]=this.rPa(z,D)):w[x]=String.format("\\{0}",z):(w[x]=this.rPa(l.substr(u,A+1-u),D),u=A):w[x]="'"===z||"\u2018"===z||"\u2019"===z||'"'===z||"\u201c"===z||"\u201d"===z||"-"===z||"\u2013"===z||"\u2014"===z||f.a.qga(z)?"["+this.cng(z)+"]":"\u2026"===z?"\\.\\.\\.":z;""!==w[x]&&0===D&&(w[x]=u<l.length-
1&&("@"===l.charAt(u+1)||"{"===l.charAt(u+1))?"("+w[x]+"\u0640*)":w[x]+"\u0640*");v++}return w}fXj(l){const w=[];for(let y=0;y<l.length;++y){const v=l.charAt(y);w[y]="["===v||"\\"===v||"^"===v||"$"===v||"."===v||"|"===v||"+"===v||"("===v||")"===v||"?"===v||"*"===v?String.format("\\{0}",v):"'"===v||"\u2018"===v||"\u2019"===v||'"'===v||"\u201c"===v||"\u201d"===v||"-"===v||"\u2013"===v||"\u2014"===v||f.a.qga(v)?"["+this.cng(v)+"]":"\u2026"===v?"\\.\\.\\.":v;""!==w[y]&&(w[y]+="\u0640*")}return w}cng(l){return"'"===
l||"\u2018"===l||"\u2019"===l?"'\u2018\u2019":'"'===l||"\u201c"===l||"\u201d"===l?'"\u201c\u201d':"-"===l||"\u2013"===l||"\u2014"===l?"-\u2013\u2014":f.a.qga(l)?a.Lrp:l}static get instance(){return a._instance||(a._instance=new a)}}a._instance=null;a.Lrp=" \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000";a.ljo='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d\u201c';Object(G.a)(a,"WordQueryProcessor",null,[1579])},2234:function(G,J,d){d.d(J,
"a",function(){return m});var m={none:{cancellationRequested:!1,throwIfCancellationRequested:function(){},rejectWhenCancellationRequested:function(){return new Promise(function(){})},onCancel:function(){return function(){}}}}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/22137596/wdjs/WordEditorDS.common.js.map