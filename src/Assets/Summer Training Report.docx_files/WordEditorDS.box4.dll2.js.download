'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1559:function(G,J,d){G=d(0);var m=d(16),f=d(46),a=d(5),l=d(125),w=d(192),y=d(864),v=d(233),u=d(651),x=d(2),z=d(381),A=d(21),D=d(104),F=d(286),I=d(1),H=d(1667);class N{constructor(Y,Q){this.Ouk=Y;this.NB=Q}J(Y){return this.Ouk.l3(Y,this.NB)}}Object(G.a)(N,"PropertyMergeStrategies",null,[]);var M=d(1713),U=d(1665);class O extends U.a{constructor(){super();this.sed=this.dke=this.Eo=null;this.Fre=0}get tfa(){return"Property"}HPb(){this.detail.Z("Type",
this.tfa);this.detail.Z("ComplexMerger",null!=this.Eo?this.Eo:-1);this.detail.Z("Strategy",null!=this.dke?this.dke:-1);this.detail.Z("ClassId",null!=this.sed?this.sed:-1);this.detail.Z("PropId",this.Fre);return this.detail}}Object(G.a)(O,"PropertyMergeFailureDetail",U.a,[]);d.d(J,"a",function(){return V});class V{constructor(Y=null){this.SAh=this.rc=null;this.p9b=Y||this.P3c()}get Eo(){return 1}get Pub(){return this.p9b}P3c(){return[Object(D.a)(this,this.Vpp,"tryPreProcessFavoredRevision"),Object(D.a)(this,
this.$sl,"cloneObjectAndRemoveNeededProperties"),Object(D.a)(this,this.Ipp,"tryMergeNodeInternal")]}get NB(){return 5}get Hre(){return this.SAh||(this.SAh=new N(this.Yk(),this.NB))}OD(Y,Q){const S=Y.jh.value.Jf;w.a.instance.Ua(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",S.id,S.yc);Y.lu.logger.Oi(Object.assign(new O,{Eo:this.Eo,sed:S.yc,Fre:Q}));return!1}IKg(Y){const Q=Y.jh.value;w.a.instance.Ua(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",Q.Jf.id,Q.Jf.yc);for(let S=0;S<this.Pub.length;S++)if(!(0,this.Pub[S])(Y))return w.a.instance.Ua(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",Q.Jf.id,Q.Jf.yc,S),Y.lu.logger.Qie("GraphNodeComplexMerge.GetMergeFunctions()",S),this.SCn(Y),Y.Rl=null,!1;w.a.instance.Ua(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",Q.Jf.id,Q.Jf.yc);
return!0}SCn(Y){Y.OOg||(Y.OOg=!0,M.a(Y.jh.value.Ov,"Base",1),M.a(Y.jh.value.Jf,"Favored",1),M.a(Y.Wo.value.Jf,"Conflict",1))}Vpp(Y){const Q=Y.jh.value,S=this.Hre;if(!Q.B3)return!0;let P=!0;Q.yNa.forEach((T,Z)=>{if(!Z.B3||Y.Xg.contains(T))return!0;Z=S.J(T);if(5===Z){const X=Q.Ov.yc;w.a.instance.Ua(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",X,T,Z);Y.lu.logger.Oi(Object.assign(new O,{Eo:this.Eo,
sed:X,Fre:T,dke:Z}));return P=!1}6===Z&&Y.Wng.add(T);return!0});return P}$sl(Y){Y.Rl=Y.jh.value.Jf.WO();const Q=Y.Wng,S=Y.Rl;Q&&Q.forEach(P=>{S.removeProperty(y.a.J_(P));return!0});return!0}Ipp(Y){const Q=Y.Wo.value,S=Q.Ov.yc,P=this.Hre;let T=!0;Q.yNa.forEach((Z,X)=>{const aa=P.J(Z);T=this.Jpp(Y,X,Z,aa);T||(Y.Rl=null,w.a.instance.Ua(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",S,Z,aa),Y.lu.logger.Oi(Object.assign(new O,{Eo:this.Eo,sed:S,Fre:Z,dke:aa})));
return T});return T}Jpp(Y,Q,S,P){const T=Y.Rl;if(!Q.B3&&8!==P||2===P||7===P||Y.Xg.contains(S))return!0;if(5===P)return!1;if(4===P||3===P){let Z;if(({value:Z}=Y.jh.value.yNa.Dc(S)).returnValue&&Z.B3)return 4!==P;P=0}8===P&&(P=0);if(0===P){if(!Q.isDeleted)return Y=y.a.J_(S),(V.wDp(Q,S,Y)||V.t3o())&&T.heb(Y,Q.newValue),!0;P=6}return 6===P?(T.removeProperty(y.a.J_(S)),!0):1===P?this.OD(Y,S):!1}DLn(Y,Q,S,P,T,Z){Y=Y||new v.a;Q=Q||new v.a;S=S||new v.a;var X=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
Y.length,Q.length,S.length),aa=Y.length<=Q.length&&Y.length<=S.length;this.q_i()&&aa&&w.a.instance.Ua(541181455,1,1,X);if(!aa&&this.rYi(Z.runtime.rc))return null;if(this.q_i())for(X=0;X<Y.length;X++){aa=Y.sg(X);var ia=Q.sg(X);let wa=S.sg(X);aa=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",aa,ia,wa,X,Y.length);w.a.instance.Ua(541181457,1,1,aa)}if(this.rYi(Z.runtime.rc))for(Z=0;Z<
Y.length;Z++)if(X=Y.sg(Z),aa=Q.sg(Z),ia=S.sg(Z),!P(X,aa)||!P(X,ia))return null;Y=Y.wOa();P=new u.a;Z=Y.length;for(X=Z;X<Q.length;X++)aa=Q.sg(X),Y.add(aa),P.add(aa);for(;Z<S.length;Z++)Q=S.sg(Z),P.contains(Q)?w.a.instance.Ua(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",Q):(Y.add(Q),T(Q));return Y}q_i(){return!!x.AFrameworkApplication.K&&x.AFrameworkApplication.K.$("LogMPALErrors")}rYi(Y){if(!Y)return!1;Y.I$d(1000008);
return Y.yrb(1000008)}prn(Y){if(!Y)return!1;Y.I$d(1000009);return Y.yrb(1000009)}cej(Y,Q,S,P){return H.a(Y,Q,S,P)}AMa(Y,Q,S){Y=Y||new v.a;Q=Q||new v.a;S=S||new v.a;const P=Y.BS(),T=Q.BS(),Z=S.BS();Y=V.filter(Y,X=>T.contains(X)&&Z.contains(X));Y.BS();Y.pD(Y.length,V.filter(Q,X=>!P.contains(X)));Y.pD(Y.length,V.filter(S,X=>!P.contains(X)&&!T.contains(X)));return Y}wLn(Y,Q){const S=y.a.J_(Q),P=Y.gf;var T=P.getPropertyObjectIds(Y.jh.value.Ov,S),Z=P.getPropertyObjectIds(Y.jh.value.Jf,S);const X=P.getPropertyObjectIds(Y.Wo.value.Jf,
S);T=this.AMa(T,Z,X);Z=Y.Rl;0<T.length?P.setPropertyObjectIds(Z,S,T):Z.removeProperty(S);Y.Xg.add(Q)}Vnb(Y,Q,S){Y.hasProperty(S)?Q.heb(S,Y.qI(S)):Q.removeProperty(S)}ZCo(Y,Q){var S=Q.fk();for(const P of S)Q.removeProperty(P);S=Y.fk();for(const P of S)Q.heb(P,Y.qI(P))}E2f(Y,Q,S,P,T){Q=Y.getPropertyInt32(Q,T);S=Y.getPropertyInt32(S,T);S=null!=Q&&null!=S?Math.max(Q,S):null!=S?S:null!=Q?Q:null;null!=S?Y.setPropertyInt32(P,T,S):P.removeProperty(T)}Mof(Y,Q,S,P,T,Z){Q=Y(Q,T);S=Y(S,T);Y=Y(P,T);P=Q.BS();let X=
!1;Z&&(X=Z(Q,S,Y));X?(Z=!0,P=!1):(Z=P.U6h(S),P=P.U6h(Y));w.a.instance.Ua(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",y.a.yb(T),Q.Yr(),S.Yr(),Y.Yr(),Z,P);return{yWc:Y,$$a:Z,Q$a:P}}Aol(Y,Q,S,P,T){let Z;Q=Y(Q,T);S=Y(S,T);Y=Y(P,T);P=this.M2i(Q,S);Z=this.M2i(Q,Y);w.a.instance.Ua(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
y.a.yb(T),Q.Yr(),S.Yr(),Y.Yr(),P,Z);return{yWc:Y,$$a:P,Q$a:Z}}M2i(Y,Q){if(!Y&&!Q)return!0;if(!Y||!Q)return!1;if(!Y.count&&!Q.count)return!0;let S=!1;Q.forEach((P,T)=>S=Y.mb(P)&&T==Y.J(P));return S}Yk(){let Y;Y=this.prn(this.rc)?V.jDk.value:V.iDk.value;const Q=new z.a(0);for(let S=0;S<Y.length;S++)Q.Z(Y[S],7);return Q}static Daa(){return new V}static get instance(){return V._instance.value}static t3o(){return A.a.instance.Oa("Box4.IFeatureHelper").isFeatureEnabled(73)}static wDp(Y,Q,S){if(void 0!==
Y.newValue&&null!==Y.newValue||I.a.e0i(S.type))return!0;V.QDn(Y,Q,S);return!1}static QDn(Y,Q,S){S=S.type===I.a.string;Q=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",Q);S||(Q+=String.format(" [NewValue: {0}] [OldValue: {1}]",Y.newValue,Y.oldValue));w.a.instance.Ua(19145822,1,2,Q)}static W8f(Y,Q,S){const P=y.a.yb(S),T=Y.gf;var Z=T.getPropertyObjectIds(Y.jh.value.Ov,S);const X=T.getPropertyObjectIds(Y.jh.value.Jf,S);var aa=T.getPropertyObjectIds(Y.Wo.value.Jf,S);aa=V.yQm(aa,Y.lu.runtime.syc);
Q=Q.AMa(Z,X,aa);Z=Y.Rl;0<Q.length?T.setPropertyObjectIds(Z,S,Q):Z.removeProperty(S);Y.Xg.add(P);return!0}static yQm(Y,Q){const S=new v.a;Y.forEach(P=>{Q.contains(P,(T,Z)=>T.equals(Z))||S.add(P);return!0});return S}static filter(Y,Q){const S=new v.a;Y.forEach(P=>{Q(P)&&S.add(P);return!0});return S}static xvm(){return[y.a.yb(m.a.v1d),y.a.yb(m.a.lastModifiedTime),y.a.yb(m.a.aM),y.a.yb(m.a.pmd),y.a.yb(m.a.dwg),y.a.yb(f.a.ped),y.a.yb(a.a.rXd),y.a.yb(a.a.Rob),y.a.yb(l.a.WIj)]}static yvm(){return[y.a.yb(m.a.v1d),
y.a.yb(m.a.lastModifiedTime),y.a.yb(m.a.aM),y.a.yb(m.a.pmd),y.a.yb(m.a.dwg),y.a.yb(f.a.ped),y.a.yb(a.a.rXd),y.a.yb(l.a.WIj)]}}V._instance=new F.a(V.Daa);V.iDk=new F.a(V.xvm);V.jDk=new F.a(V.yvm);Object(G.a)(V,"GraphNodeComplexMerge",null,[1057])},1560:function(G,J,d){d.r(J);G=d(0);var m=d(122),f=d(1579),a=d(1566),l=d(1715),w=d(1716);class y{constructor(u,x){this.ljb=!1;this.sma=null;if(!u)throw Error.argumentNull("annotations");if(!u.Mpc(x))throw Error.argument("structTypeID","Invalid struct type ID");
this.Gx=u;this.mrc=this.Gx.kDi(x);this.aPk=x}get gdc(){return this.Gx}get isReadOnly(){return this.ljb}get Z_a(){return this.aPk}Lqb(u){if(0>u||u>=this.mrc)throw Error.argument("iField","Invalid field index");return this.sma&&null!=this.sma[u]?this.sma[u]:this.Gx.VHi(this.Z_a,u)}Dzg(u,x){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>u||u>=this.mrc)throw Error.argument("iField","Invalid field index");if(!this.Gx.Eoc(this.Gx.IQb(this.Z_a,
u),x))throw Error.argument("value","Value is not of the correct type for the specified field");(this.sma||(this.sma=Array(this.mrc)))[u]=x}bia(){const {Annotations:u}=d(1560);let x="[";if(this.sma){let z=!0;for(let A=0;A<this.mrc;++A){if(null==this.sma[A])continue;const D=this.Gx.IQb(this.Z_a,A);if(u.AAb(D,this.sma[A],this.Gx.VHi(this.Z_a,A)))continue;z?z=!1:x+=", ";x+=this.Gx.WHi(this.Z_a,A);x+="=";const F=this.Gx.bia(D,this.sma[A]);D===u.eda?(x+='"',x+=f.a.YBf(F),x+='"'):x+=F}}return x+"]"}isEqual(u){const {Annotations:x}=
d(1560);if(this===u)return!0;if(!u||this.Gx!==u.gdc||this.Z_a!==u.Z_a)return!1;for(let z=0;z<this.mrc;++z)if(!x.AAb(this.Gx.IQb(this.Z_a,z),this.Lqb(z),u.Lqb(z)))return!1;return!0}clone(){const u=new y(this.Gx,this.Z_a);this.sma&&(u.sma=Array.clone(this.sma));return u}IW(){return this.isReadOnly?this.clone():this}Z5f(){const {Annotations:u}=d(1560);if(!this.isReadOnly&&(this.ljb=!0,this.sma))for(let x=0;x<this.mrc;++x){const z=this.sma[x];null!=z&&u.QUb(z)}}toString(){return this.bia()}}Object(G.a)(y,
"StructValue",null,[1666,1663]);d.d(J,"Annotations",function(){return v});class v{constructor(u,x){if(!u)throw Error.argumentNull("initData");if(!x)throw Error.argumentNull("objectFetcher");this.SGn=x.aYl;let z=0;var A=x.yqb(u.J(z));++z;this.S7f=new l.a(new w.a(A));this.Kuk=u.J(z);++z;this.ybj=Array(this.S1d);this.Fcd=Array(this.S1d);this.Eub=Array(this.S1d);for(A=0;A<this.S1d;++A){this.ybj[A]=x.kD(u.J(z));++z;this.Fcd[A]=u.J(z);++z;var D=u.J(z);++z;this.Eub[A]=Array(D);for(var F=0;F<D;++F)this.Eub[A][F]=
x.kD(u.J(z)),++z}this.$Ok=u.J(z);++z;this.ecj=Array(this.Rqd);this.vje=Array(this.Rqd);this.wje=Array(this.Rqd);this.uje=Array(this.Rqd);for(A=0;A<this.Rqd;++A)for(this.ecj[A]=x.kD(u.J(z)),++z,D=u.J(z),++z,this.vje[A]=Array(D),this.wje[A]=Array(D),this.uje[A]=Array(D),F=0;F<D;++F)this.vje[A][F]=x.kD(u.J(z)),++z,this.wje[A][F]=u.J(z),++z,this.uje[A][F]=({Bla:z}=this.ZUa(this.wje[A][F],u,z,null,null,null)).returnValue,v.QUb(this.uje[A][F]);this.qok=u.J(z);++z;this.w7f=Array(this.Gdc);this.x7f=Array(this.Gdc);
this.v7f=Array(this.Gdc);for(A=0;A<this.Gdc;++A)this.w7f[A]=x.kD(u.J(z)),++z,this.x7f[A]=u.J(z),++z,this.v7f[A]=({Bla:z}=this.ZUa(this.x7f[A],u,z,null,null,null)).returnValue,v.QUb(this.v7f[A])}c2c(u){for(let x=0;x<this.Gdc;++x)if(this.w7f[x]===u)return x;return-1}Vti(u){if(!this.Ipc(u))throw Error.argument("attrID","Invalid attribute ID");return this.w7f[u]}getAttributeType(u){if(!this.Ipc(u))throw Error.argument("attrID","Invalid attribute ID");return this.x7f[u]}IQb(u,x){if(!this.Mpc(u))throw Error.argument("structTypeID",
"Invalid struct type ID");u=this.wje[v.Sqd(u)];if(0>x||x>=u.length)throw Error.argument("iField","Invalid field index");return u[x]}bia(u,x){if(!this.Z1f(u))throw Error.argument("typeID","Invalid type ID");if(!this.Eoc(u,x))throw Error.argument("value","Value is not of the correct type");switch(u){case v.eda:return x;case v.aFa:return x?"True":"False";case v.uPa:case v.kwa:return x.toString();case v.HY:return x.bia();default:if(!v.zK(u)&&v.ftd(u)){u=v.MBf(u);const D=this.Eub[u].length;switch(this.Fcd[u]){case 0:return this.Eub[u][x];
case 1:if(x){var z="";for(var A=1;A<D;++A)x&1<<A-1&&(0<z.length&&(z+=" & "),z+=this.Eub[u][A]);return z}return this.Eub[u][0];case 2:z="";for(A=0;A<D;++A)x&1<<A&&(0<z.length&&(z+=" & "),z+=this.Eub[u][A]);return z;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Fcd[u]);}}else return x.bia()}}Z1f(u){switch(u){case v.eda:case v.aFa:case v.uPa:case v.kwa:case v.HY:return!0;default:return v.zK(u)?this.Z1f(v.w9a(u)):v.ftd(u)?this.xtn(u):this.Mpc(u)}}xtn(u){u=v.MBf(u);return 0<=
u&&u<this.ybj.length}Mpc(u){u=v.Sqd(u);return 0<=u&&u<this.ecj.length}Ipc(u){return 0<=u&&u<this.Gdc}Eoc(u,x){if(null==x)return!1;switch(u){case v.eda:return"string"===typeof x;case v.aFa:return"boolean"===typeof x;case v.uPa:return"number"===typeof x;case v.kwa:return"number"===typeof x;case v.HY:return Object(m.a)(1662,x);default:if(v.zK(u))return Object(m.a)(1665,x)&&x.d8===v.w9a(u);if(v.ftd(u)){if("number"!==typeof x)return!1;u=v.MBf(u);const z=this.Eub[u].length;switch(this.Fcd[u]){case 0:return 0<=
x&&x<z;case 1:return!(x&-1<<z-1);case 2:return!!x&&!(x&-1<<z);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Fcd[u]);}}else return Object(m.a)(1666,x)&&x.Z_a===u}}get Gdc(){return this.qok}get S1d(){return this.Kuk}get Rqd(){return this.$Ok}oim(u){if(!this.Ipc(u))throw Error.argument("attrID","Invalid attribute ID");return this.v7f[u]}kDi(u){if(!this.Mpc(u))throw Error.argument("structTypeID","Invalid struct type ID");return this.vje[v.Sqd(u)].length}WHi(u,x){if(!this.Mpc(u))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.vje[v.Sqd(u)][x]}VHi(u,x){if(!this.Mpc(u))throw Error.argument("structTypeID","Invalid struct type ID");u=this.uje[v.Sqd(u)];if(0>x||x>=u.length)throw Error.argument("iField","Invalid field index");return u[x]}ZUa(u,x,z,A,D,F){if(!x)throw Error.argumentNull("initData");if(v.zK(u)){var I=x.J(z);++z;u=v.w9a(u);var H=new a.a(this,u);for(var N=0;N<I;++N)Array.add(H.items,({Bla:z}=this.ZUa(u,x,z,A,D,F)).returnValue);return{returnValue:H,Bla:z}}switch(u){case v.eda:return{returnValue:(A||
this.S7f).kD(x.J(z++)),Bla:z};case v.aFa:return{returnValue:1===x.J(z++),Bla:z};case v.uPa:return{returnValue:x.J(z++),Bla:z};case v.kwa:return{returnValue:(D||this.SGn)[x.J(z++)],Bla:z};case v.HY:u=x.J(z++);I=new f.a(this);for(H=0;H<u;++H)N=x.J(z),++z,F&&(N=F[N]),I.jA(N,({Bla:z}=this.ZUa(this.getAttributeType(N),x,z,A,D,F)).returnValue);return{returnValue:I,Bla:z};default:if(v.ftd(u))return{returnValue:x.J(z++),Bla:z};if(v.P4j(u)){I=x.J(z++);H=new y(this,u);for(N=0;N<I;++N){const M=x.J(z);++z;H.Dzg(M,
({Bla:z}=this.ZUa(this.IQb(u,M),x,z,A,D,F)).returnValue)}return{returnValue:H,Bla:z}}throw Error.argument("typeID","Invalid type ID");}}static ftd(u){return 16<=(u&16383)&&16384!==(u&16384)&&32768!==(u&32768)}static P4j(u){return 16<=(u&16383)&&16384===(u&16384)&&32768!==(u&32768)}static zK(u){return 32768===(u&32768)}static Pym(u){if(v.zK(u))throw Error.argument("nonListTypeID","Non-list type ID required");return u|32768}static w9a(u){if(!v.zK(u))throw Error.argument("listTypeID","List type ID required");
return u&-32769}static AAb(u,x,z){switch(u){case v.eda:case v.aFa:case v.uPa:case v.kwa:return x===z;case v.HY:return x.isEqual(z);default:return v.zK(u)?x.isEqual(z):v.ftd(u)?x===z:x.isEqual(z)}}static QUb(u){Object(m.a)(1663,u)&&u.Z5f()}static IW(u){return Object(m.a)(1663,u)?u.IW():u}static MBf(u){return u-16}static Sqd(u){return(u&-16385)-16}}v.eda=1;v.aFa=2;v.uPa=3;v.kwa=5;v.HY=9;Object(G.a)(v,"Annotations",null,[1667])},1563:function(G,J,d){G=d(0);var m=d(372);class f{constructor(){this.userId=
this.email=this.displayName=null}}Object(G.a)(f,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(G.a)(a,"InsightsParameters",null,[]);var l=d(1833),w=d(1834),y=d(1836),v=d(1837),u=d(2),x=d(1623),z=d(1635),A=d(34),D=d(20),F=d(19),I=d(29),H=d(1835);d.d(J,"a",function(){return N});class N{static get xWf(){return"Insights_16x16x32"}static get W8l(){return"Find_16x16x32"}static get Nrj(){return"-Parameterized"}static get tEg(){return"Parameterized"}static get lEe(){return"bTryQuery"}static get PKg(){return"TellMeSuggestion_"}static get q4j(){return"bTryQueryAlternate"}static get cIg(){return"MenuTellMe"}static get S$n(){const M=
{},U=[];Array.add(U,{Term:{PeopleType:"Person"}});M.And=U;return M}static Uuf(M){return M+N.Nrj}static getParameter(M){let U="",O="";if(M)for(let V=0;V<M.Mni;++V)"Type"===M.SJf(V)?U=M.getValue(V):"Value"===M.SJf(V)&&(O=M.getValue(V));return new m.a(U,O)}static JMb(M){M=Object.assign(new a,{neighborhood:M,mentionStart:0,mentionLength:M.length});return A.c(M)}static hbi(M,U,O){M=Object.assign(new f,{displayName:M,email:U,userId:O});return A.c(M)}static OUa(M,U,O=null){return A.c(N.BHi(M,U,O,null))}static BHi(M,
U,O=null,V=null){M=Object.assign(new z.a,{neighborhood:M,mentionStart:0,mentionLength:M?M.length:0});return Object.assign(new x.a,{selection:M,userIntent:V,entryPoint:U,launchData:O})}static nHo(M,U){return N.OUa(M,N.eHj(U))}static eHj(M){switch(M){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static Ljn(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static vpc(){const M=
u.AFrameworkApplication.K?u.AFrameworkApplication.K.kb("SovereignEnvironmentName"):null;return!!M&&0<M.length}static isEnterpriseUser(){const M=u.AFrameworkApplication.K?u.AFrameworkApplication.K.kb("HostAuthType"):null;return!!M&&"aad"===M.toLowerCase()||"external"===M&&N.wYf()}static iCg(M){return M.dip&&!N.vpc()}static vqn(){const M=u.AFrameworkApplication.K?u.AFrameworkApplication.K.kb("UiHostIntegrationType"):"";return!!u.AFrameworkApplication.K&&"UnifiedUiHostTeams"===M&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static hCg(M){return M.l0a&&M.Q6l&&(M.Crd||M.Ard||M.Ptb)&&!N.vqn()&&N.isEnterpriseUser()&&!N.vpc()}static Vta(){return u.AFrameworkApplication.K?u.AFrameworkApplication.Feb||u.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):u.AFrameworkApplication.Feb}static EU(M){return!M||N.H2i(M.Yg)}static H2i(M){return!M||!M.trim().length}static YDe(M){if(!M)return 0;const U=Math.pow(10,5);return Math.round(M*U)/U}static zkp(){var M=new Date;return M?new Date(M.getUTCFullYear(),M.getUTCMonth(),M.getUTCDate(),
M.getUTCHours(),M.getUTCMinutes(),M.getUTCSeconds(),M.getUTCMilliseconds()):null}static mPf(M){M=new Date(M);return(N.zkp().getTime()-M.getTime())/1E3}static o3i(M){switch(M){case l.a.cTf:case w.a.xpi:case H.a.ITi:case y.a.phj:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return M.startsWith(N.lEe)||
M.startsWith(N.PKg)||M.startsWith(N.q4j)||M.startsWith("PeopleSuggestion")||M.startsWith("FileSuggestion")||M.startsWith("FindInDocumentSuggestion")||M.startsWith("NotesSuggestion")||M.startsWith("OnenoteNotesSuggestion")||M.startsWith("SmartLookupFromTellMe")||M.startsWith("GetHelpFromTellMe")||M.startsWith("GetHelpWithDescriptionFromTellMe")||M.startsWith("AddinSuggestion")||M.startsWith("OfficeScripts")?!0:!1}static pKf(M,U){const O=[];Array.add(O,new v.a(400,M));Array.add(O,new v.a(200,U));M=
{};M.parts=O;return JSON.stringify(M)}static tqb(M){const U=M.indexOf("<b0>"),O=M.lastIndexOf("</b0>"),V=[];Array.add(V,new v.a(400,M.substring(0,U)));Array.add(V,new v.a(600,M.substring(U+4,O)));Array.add(V,new v.a(400,M.substring(O+5,M.length)));M={};M.parts=V;return JSON.stringify(M)}static vJi(M){const U=N.mPf(M);return 60>U?CommonUIStrings.l_TimeSince_SecsAgo:3600>U?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(U/60).toString()):86400>U?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(U/3600).toString()):172800>U?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(M)).localeFormat("MMMM dd, yyyy"))}static Zlm(M){const U=Array(M.length);for(let O=0;O<M.length;O++)U[O]=M[O].commandId;return U}static wYf(){if("Dev Box"===u.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse"))return!0;let M=u.AFrameworkApplication.K.kb("UserPrincipalName");M=I.c(M)?"":F.a.xh(M);const U=u.AFrameworkApplication.K.jy("TellMeIntEnabledForFeatureCrew")?
u.AFrameworkApplication.K.iD("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(U,M)&&"inner"===u.AFrameworkApplication.K.kb("Microsoft365Ring")}static tvm(M){switch(N.Q6d(M)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static gLm(M){M=N.Q6d(M);switch(M){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return M}}static Q6d(M){switch(M.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static Ita(){return D.a.N7&&!D.a.Vr}}N.jfb=9E5;Object(G.a)(N,"TellMeUtils",null,[])},1565:function(G,J,d){d.r(J);G=d(0);var m=d(543),f=d(298),a=d(104),l=d(122),w=d(84),y=d(1748),v=d(255);class u{constructor(vb,Ia,Ma,qb,Xb,Cc){this.groupType=vb;this.resultType=Ia;this.oGg=Ma;this.mba=qb;this.yyf=Xb;this.resultIndex=
Cc}}Object(G.a)(u,"ClickLoggingInfo",null,[]);const x=vb=>{const Ia=[];for(;vb;)Array.add(Ia,"{ContextId:"+vb.contextId+", IsGraphNodeContext:"+vb.Gl+"}"),vb=vb.Hk;Ia.reverse();return"{"+Ia.join(", ")+"}"};class z{constructor(){this.xta=this.sessionId=null}}Object(G.a)(z,"CorrelationRecord",null,[1596]);var A=d(1587);class D{constructor(vb,Ia){this.provider=vb;this.yfb=Ia}}Object(G.a)(D,"ExternalResultProvider",null,[]);class F{constructor(vb,Ia){this.Id=null;this.TimeStamp=0;this.Id=vb;this.TimeStamp=
Ia}}Object(G.a)(F,"MRUControl",null,[]);var I=d(1717),H=d(1563),N=d(2),M=d(1425);class U{constructor(vb,Ia){this.AEk=10;this.y$=[];this.$Ga=[];this.Mph=this.Lph=!1;this.VLc=this.ULc="";this.n9b=Ia;this.kc=vb}G2c(){!this.Lph&&this.kc&&(this.ULc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.kc.application,this.y$=this.Nui(),this.Lph=!0);return this.y$}jHm(){!this.Mph&&this.kc&&(this.VLc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.kc.application,this.$Ga=this.Nui(!0),this.Mph=!0);return this.$Ga}ysn(vb){return vb.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===vb||"TryOfficeUpsell"===vb}cYf(vb){return this.Odn(vb)||this.ysn(vb)||H.a.o3i(vb)?!1:!0}S5a(vb){vb=vb.ControlId;this.cYf(vb)&&(vb=this.Tsg(vb),this.Yyo(vb),this.NHn(),Array.insert(this.y$,0,new F(vb,Date.now())),this.ULc.length&&(vb=JSON.stringify(this.y$),M.a.instance.setItem(this.ULc,vb)))}DG(vb){this.MHn();Array.insert(this.$Ga,0,new F(I.a[vb],Date.now()));this.VLc.length&&(vb=JSON.stringify(this.$Ga),M.a.instance.setItem(this.VLc,vb))}Nui(vb=!1){if(!this.y$.length){var Ia=
vb?M.a.instance.getItem(this.VLc):M.a.instance.getItem(this.ULc);if(!Ia||""===Ia)return vb?this.$Ga:this.y$;let Ma=null;try{Ma=JSON.parse(Ia)}catch(qb){this.$ql(vb),Ma=null}if(!Ma||!Ma.length||10<Ma.length)return vb?this.$Ga:this.y$;Ia=0;for(const qb of Ma)if(vb||this.kc.Wge(qb.Id)&&this.cYf(qb.Id))if(vb?Array.insert(this.$Ga,Ia++,qb):Array.insert(this.y$,Ia++,qb),Ia===this.n9b)break}return vb?this.$Ga:this.y$}Hrf(vb){vb=this.Tsg(vb);for(const Ia of this.y$)if(Ia.Id===vb)return!0;return!1}$ql(vb=
!1){M.a.instance.setItem(vb?this.VLc:this.ULc,"")}kgn(vb){vb=this.Tsg(vb.ControlId);return this.cYf(vb)?this.Hrf(vb):!1}Yyo(vb){if(0<this.y$.length){let Ia=0;for(const Ma of this.y$){if(Ma.Id===vb){Array.removeAt(this.y$,Ia);break}Ia++}}}Tsg(vb){return"Excel"===this.kc.application&&vb.startsWith("m_excelWebRenderer_ewaCtl_")?vb.substr(26,vb.length):vb}NHn(){this.y$.length===this.n9b&&Array.removeAt(this.y$,this.y$.length-1)}MHn(){this.$Ga.length===this.AEk&&Array.removeAt(this.$Ga,this.$Ga.length-
1)}Odn(vb){vb=vb.split("|");let Ia="";if(6<=vb.length)Ia=vb[0];else if(3<=vb.length){if("3"===vb[0])return!0;Ia=vb[1]}return Ia.startsWith("WA")}static createInstance(vb){let Ia=3;N.AFrameworkApplication.K&&(Ia=N.AFrameworkApplication.K.ic("TellMeMaxRecommendedResultsToReturn",3));return new U(vb,Ia)}}Object(G.a)(U,"MruControlsManager",null,[1595]);class O{constructor(vb){this.LGb=vb}pka(vb,Ia){let Ma;return vb.DE&&(Ma=this.LGb[vb.value])?Ma.pka(vb,Ia):(Ma=this.Mvi(vb.value))?Ma.pka(Ma.wNn,Ia):null}OEm(vb,
Ia){if(vb=this.LGb[vb])for(const Ma of Ia)if(Ia=H.a.getParameter(Ma),Ia.key===vb.Mjg)return Ia.value;return null}VRn(vb){(vb=this.Mvi(vb))&&vb.SRn()}Mvi(vb){const Ia=vb.indexOf(H.a.Nrj);return 0<Ia?this.LGb[vb.substring(0,Ia)]:null}}Object(G.a)(O,"ParameterizedCommandManager",null,[1594]);var V=d(1601);class Y{constructor(vb,Ia){this.Yg=vb;this.Swb=Ia}}Object(G.a)(Y,"TellMeQuery",null,[]);var Q=d(1714);class S{constructor(vb,Ia){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=vb;this.TimeElapsedSinceClick=
Ia}}Object(G.a)(S,"CommandClickedEvent",null,[]);var P=d(29);class T{constructor(vb,Ia){this.WGk=vb;this.mya=Ia}Ot(vb){this.WGk(P.c(vb.query)?"":vb.query.Yg,vb.$o,vb.attributes,this.mya,vb.Zoc)}}Object(G.a)(T,"ResultsUpdatedCallback",null,[1593]);class Z{constructor(vb,Ia,Ma,qb,Xb){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=vb;this.TimeElapsedSinceClick=Ma;this.CommandSurface=qb;this.CommandId=Ia;this.TerminalParentControlId=
Xb}}Object(G.a)(Z,"UserActionEvent",null,[]);var X=d(77);class aa{constructor(vb,Ia){this.menuModel=vb;this.cHj=Ia}}Object(G.a)(aa,"GeneratedMenuModel",null,[]);class ia{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(G.a)(ia,"MenuModel",null,[]);class wa{constructor(vb,Ia,Ma){this.kc=vb;this.LGb=Ia;this.sja=Ma}nfm(vb,Ia,Ma){const {TellMeActor:qb}=d(1565);let Xb=0;const Cc=new ia,Ec=[];let Wb="";Cc.sections=[];let Hb=new X.a;
const Sb=!!this.kc&&this.kc.Pab;var cc=!!this.kc&&this.kc.Jyb||N.AFrameworkApplication.ua.Ib.Jyb;for(const Oc of vb){vb=0;Sb||(Hb=new X.a);const Zc=new X.a;let kb=Oc.displayName;for(const wd of Oc.results){if(0<=wd.value.indexOf(H.a.tEg)){if(wd.DE){var Gc=this.LGb[wd.value];if(Gc&&wd.value.endsWith(H.a.tEg)){if("FindParameterized"!==wd.value&&!cc){const qe=[];qe.push(appChrome.actions.setControlLabel(wd.value,Gc.G7d(wd)));qe.push(appChrome.actions.setButtonCommandValueId(wd.value,Gc.kIf(wd)));appChrome.api.dispatch(qe)}Gc=
wd.value.replace(H.a.tEg,"");Hb.remove(Gc)?vb--:Zc.add(Gc);Hb.add(wd.value);vb++}}}else switch(wd.type){case 5:Zc.contains(wd.value)||(Hb.add(wd.value),vb++);break;case 7:Hb.add(wd.DE);vb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:Hb.add(wd.value),vb++}13===Oc.groupType&&(kb=H.a.Vta()?0<Ia.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,
Ia):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Ia));21===Oc.groupType&&(kb=CommonUIStrings.l_LearningUILiveText)}Xb+=vb;""!==kb&&0<vb&&(Wb+=" , "+vb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+kb+" , ");0<Hb.count&&!Sb&&(vb=appChrome.api.menuSection(Hb.toArray(),Oc.displayName,null,V.a[Oc.groupType]),Ec.push(vb))}cc=null;0<Xb&&(cc=0<Ia.length?1!==Xb?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,
Xb,Ia):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Ia):1!==Xb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Xb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,Sb?(Ia=appChrome.api.menuSection(Hb.toArray(),"",null,null),Ec.push(Ia)):cc+=Wb);Ma&&(this.kc.KBa?qb.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(cc)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(cc)));Cc.sections=
Ec;return new aa(Cc,Xb,[])}static get DAf(){return wa.Cgh||(wa.Cgh=new aa(Object.assign(new ia,{sections:[]}),0,[]))}}wa.Cgh=null;Object(G.a)(wa,"TellMeMenuDefintionGenerator",null,[]);var ma;(function(vb){vb[vb.OQp=0]="TellMeControlActivated";vb[vb.QQp=1]="TellMeQueryExecuted";vb[vb.SQp=2]="TellMeResultsRendered";vb[vb.PQp=3]="TellMeControlDeactivated"})(ma||(ma={}));Object(G.b)("PerformanceMarker",ma);var na;(function(vb){vb[vb.UQp=0]="TellMeTimeToRender";vb[vb.TQp=1]="TellMeSessionLength";vb[vb.RQp=
2]="TellMeResultTriageTime"})(na||(na={}));Object(G.b)("PerformanceMeasure",na);class Fa{mark(vb){window.performance.mark(ma[vb])}measure(vb,Ia,Ma){const {TellMeActor:qb}=d(1565);try{window.performance.measure(na[vb],ma[Ia],ma[Ma])}catch(Xb){qb.instance.Ye.onError("TellMePerformance:Measure","error measuring "+na[vb])}}B6f(vb,Ia,Ma){const {TellMeActor:qb}=d(1565);qb.instance.Ye.L6f(Ia,Ma,vb,this.Czm(vb))}Erl(){var vb=[0,1,2,3];for(const Ia of vb)window.performance.clearMarks(ma[Ia])}clearMeasures(vb){for(const Ia of vb)window.performance.clearMeasures(na[Ia])}Czm(vb){let Ia=
0;(vb=this.ahm(vb))&&0<vb.length&&(Ia=vb[vb.length-1].duration);return Ia}ahm(vb){return window.performance.getEntriesByName(na[vb],"measure")}}Object(G.a)(Fa,"TellMePerformance",null,[]);var Qa=d(1640),ya=d(1639),ta=d(34);class Aa{constructor(vb){this.bQk=vb}$fd(vb,Ia,Ma){const {TellMeActor:qb}=d(1565);qb.instance.Ye.aca(Ia,ya.a.Fuc,vb.data.He.toString(),Math.round(window.performance.now()-Ma),ya.a.Fuc,!0,Qa.a.OWa);vb=ta.b(vb.data.De);Ia=-1;vb.Index&&(Ia=vb.Index);qb.instance.Ye.UEn(Ia,this.bQk)}nfd(vb,
Ia,Ma){const {TellMeActor:qb}=d(1565);qb.instance.Ye.aca(Ia,ya.a.Fuc,vb.data.He.toString(),Math.round(window.performance.now()-Ma),ya.a.Fuc,!1,Qa.a.OWa)}pHm(vb){if(vb&&""!==vb.trim()){const Ma=window.performance.now(),qb=N.AFrameworkApplication.W_j;var Ia={};Ia.Text=vb;Ia.IsFileHash="false";Ia=ta.c(Ia);N.AFrameworkApplication.Be.Ij(qb,2,Ia,{"Content-Type":"application/json",Accept:"application/json"},!1,0,Xb=>{this.$fd(Xb,vb.length,Ma)},Xb=>{this.nfd(Xb,vb.length,Ma)},null,null,!1,4E3,6E3)}}}Object(G.a)(Aa,
"TellMeQueryIndexCallback",null,[]);var oa=d(1567);class za{constructor(vb,Ia,Ma){this.xml=vb;this.cHj=Ia;this.HVl=Ma}}Object(G.a)(za,"GeneratedMenuXml",null,[]);var ja=d(1833),fa=d(19);class Ca{constructor(vb,Ia){this.Yyd=vb||{};this.e4a=Ia}get LZb(){return 5}pka(vb,Ia=null){return this.e4a.pka(vb,Ia)||this.ufl(vb.value)}ufl(vb){return Ca.ymf(vb,this.Yyd[vb]||null)}static ymf(vb,Ia=null){vb=String.format('<ClonedControl Id="{0}" ',vb);for(const Xb in Ia){var Ma=Xb,qb=Ia[Xb];qb=qb?fa.a.Hf(qb.toString()):
"";vb+=String.format('{0}="{1}" ',Ma,qb)}return vb+"/>"}}Object(G.a)(Ca,"CommandMenuItemFactory",null,[1545]);var xa=d(240);class ua{constructor(){this.Cvk=CommonUIStrings.l_FindInDocumentText}get LZb(){return 8}pka(vb){var Ia=vb.DE;vb=fa.a.Hf(vb.value);const Ma=fa.a.Hf(Ia);Ia=fa.a.Hf(String.format(this.Cvk,Ia));return this.Fem(vb,Ma,Ia)}Fem(vb,Ia,Ma){return xa.a(vb,"1540292897",Ma,H.a.W8l,null,Ia,Ma,null,null)}}Object(G.a)(ua,"FindInDocumentMenuItemFactory",null,[1545]);var sa=d(1834),Ea=d(1835);
class Ja{constructor(vb=null){this.Lzk=vb||CommonUIStrings.l_InsightsButtonText}get LZb(){return 10}pka(vb){var Ia=vb.DE;vb=H.a.Vta()?H.a.OUa(Ia,1):H.a.JMb(Ia);Ia=String.format(this.Lzk,Ia);return this.Oem(vb,Ia)}Oem(vb,Ia){return xa.a(Ea.a.ITi,H.a.Vta()?"1914896509":"3317204163",fa.a.Hf(Ia),H.a.xWf,null,fa.a.Hf(vb),fa.a.Hf(Ia),null,null)}}Object(G.a)(Ja,"InsightsMenuItemFactory",null,[1545]);var nb=d(1836);class ub{get LZb(){return 7}pka(vb){const Ia=Object(w.a)(Q.a,vb);return this.vfm(fa.a.Hf(vb.value),
Ia.id)}vfm(vb,Ia){return xa.a(Ia,"1404166600",vb,null,null,vb,vb,null,null)}}Object(G.a)(ub,"TryQueryMenuItemFactory",null,[1545]);class Yb{constructor(vb){this.bT=[];this.kc=vb}Drm(vb){for(const Ia of this.bT)if(Ia.LZb===vb)return Ia;return null}ia(vb){this.bT.push(vb)}Wso(vb){this.ia(new Ca(this.kc.GAl,vb));this.ia(new nb.a(this.kc.DQn));this.ia(new ja.a(this.kc.lMo,this.kc.kMo,this.kc.oip,this.kc.U_m,this.kc.s2o));this.ia(new Ja);this.ia(new ua);this.ia(new sa.a);this.ia(new ub)}}Object(G.a)(Yb,
"MenuItemFactoryRegistry",null,[]);var yb=d(1569);class Za{constructor(vb,Ia){this.kc=vb;this.Uuh=new Yb(this.kc);this.Uuh.Wso(Ia)}ofm(vb,Ia){let Ma=0;const qb=[],Xb=[];for(const Ec of vb){vb=H.a.cIg;var Cc=[];for(const Wb of Ec.results){const Hb=this.Uuh.Drm(Wb.type).pka(Wb,Ia);vb=H.a.cIg;Cc.push(Hb);if(13===Wb.type||14===Wb.type)vb="Menu32";17===Wb.type&&(vb="MenuTellMeExtended");Wb.groupType=Ec.groupType;Xb.push(Object(w.a)(yb.a,Wb))}Ma=Ma?Ma:Cc.length;Cc=xa.d("TellMeDropdownControls",Cc);vb=xa.g("TellMeDropdownMenuSection",
Cc,vb,Ec.displayName);qb.push(vb)}Ia=xa.h(qb,"LookupDropdownMenu");return new za(Ia,Ma,Xb)}static get i1d(){return Za.Dgh||(Za.Dgh=new za(xa.h([],"LookupDropdownMenu"),0,[]))}}Za.Dgh=null;Object(G.a)(Za,"TellMeXmlGenerator",null,[]);class Ya{}Ya.rOn="MRU";Ya.test="Test";Object(G.a)(Ya,"ActionType",null,[]);var Pa=d(1626),rb;(function(vb){vb[vb.eQp=0]="Service";vb[vb.D3b=1]="Local";vb[vb.eOp=2]="MRU";vb[vb.Wjk=3]="TestResult";vb[vb.Unknown=4]="Unknown"})(rb||(rb={}));Object(G.b)("SubResultType",rb);
var tb=d(90);class ob{constructor(vb,Ia,Ma,qb,Xb=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=vb;this.IsEnabled=Ia;this.ResultType=I.a[Ma];this.SubResultType=rb[qb];this.OptionalData=Xb?tb.a.toJSON(Xb):null}}Object(G.a)(ob,"ResultInfo",null,[]);var Oa=d(129),Xa=d(198),ab=d(309);class cb{constructor(vb,Ia=null){this.hEd="TellMeWAC.";this.zIk=vb;this.fRk=Ia}kOa(vb,Ia,Ma){Ia=Oa.a.fI(Ia);vb=Oa.a.Ouf(vb,this.zIk,this.fRk,Ma,Ia);Xa.a.kOa(vb,
this.hEd)}jOa(vb,Ia,Ma=0){Ia=Oa.a.fI(Ia);Xa.a.jOa(Object.assign(new ab.a,{name:vb,dataFields:Ia,durationMs:Ma}),this.hEd)}}Object(G.a)(cb,"TellMeOtelLogger",null,[1610]);var ib=d(123);class Ub{constructor(vb,Ia,Ma,qb,Xb,Cc,Ec){this.B$=this.oea=this.ach=null;this.eQa=vb;this.Chb=Ia;this.USa=Ma;this.kjb=qb;this.n3a=Xb;this.mCk=Cc;this.B$=Ec?Ec:new cb(this.kjb?v.a.sEg:v.a.CCe)}get Hs(){return this.kjb}get fva(){return this.USa}tye(vb){this.ach=vb;switch(vb){case oa.a.contextMenu:this.oea=oa.a.contextMenu;
break;default:this.oea=oa.a.su}}ccl(vb,Ia){this.USa.xta||(this.USa.xta=ib.a.create().toString(),this.k$i(vb,!0,Ia))}fki(vb,Ia=!0){this.USa.xta&&this.GCn(vb,Ia);this.kjb&&appChrome.api.updateTellMeCorrelationId("");this.USa.xta=null}k$i(vb,Ia,Ma){const {TellMeActor:qb}=d(1565),Xb=this.Gaa(A.a.J$a);Xb[Pa.a.culture]=this.Chb;Xb[Pa.a.appName]=this.eQa;Xb[Pa.a.context]=vb;Xb[Pa.a.bge]=this.n3a;Xb[Pa.a.wsn]=this.mCk;Xb[Pa.a.hrn]=Ma;Xb[Pa.a.Ykn]=Ia;Xb[Pa.a.contentType]=qb.instance.EZd;this.B$.kOa(A.a.J$a,
Xb,this.ach);this.kjb&&appChrome.api.updateTellMeCorrelationId(this.USa.xta)}GCn(vb,Ia){const Ma=this.Gaa(A.a.wSb);Ma[Pa.a.KYl]=vb;Ma[Pa.a.Xkn]=Ia;this.B$.jOa(A.a.wSb,Ma)}TEn(vb,Ia,Ma){let qb=0;!Ma&&0<vb.length&&(qb=vb.trim().split(" ").length);const Xb=this.Gaa(A.a.query);Xb[Pa.a.query]="!";Xb[Pa.a.rYb]=Ia;Xb[Pa.a.pxj]=vb.length;Xb[Pa.a.M4i]=Ma;Xb[Pa.a.sJp]=qb;this.B$.kOa(A.a.query,Xb,this.oea)}WDn(vb,Ia,Ma,qb,Xb,Cc,Ec,Wb=null){const Hb=this.Gaa(A.a.latency);Hb[Pa.a.culture]=this.Chb;Hb[Pa.a.pxj]=
vb;Hb[Pa.a.U4j]=Ia;Hb[Pa.a.statusCode]=Ma;Hb[Pa.a.service]=Xb;Hb[Pa.a.isSuccess]=Cc;Hb[Pa.a.Swn]=Ec;Wb&&(Hb[Pa.a.dlp]=Wb);this.B$.jOa(A.a.latency,Hb,qb)}L6f(vb,Ia,Ma,qb){const Xb=this.Gaa(A.a.performance);Xb[Pa.a.culture]=this.Chb;Xb[Pa.a.gcl]=ma[vb];Xb[Pa.a.l0l]=ma[Ia];Xb[Pa.a.kao]=na[Ma];this.B$.jOa(A.a.performance,Xb,qb)}bFn(vb,Ia){var {TellMeActor:Ma}=d(1565);const {CommandResultsUtility:qb}=d(1614);if(vb.results.length){var Xb=this.Gaa(A.a.KEj);Xb[Pa.a.mba]=Ia.toString();Xb[Pa.a.groupType]=V.a[vb.groupType];
16===vb.groupType&&(Xb[Pa.a.Dqn]=Ma.instance.hud);Ia=[];Ma=[];var Cc=[];for(const Ec of vb.results)Xb[Pa.a.resultType]||(Xb[Pa.a.resultType]=I.a[Ec.type]),vb={},27===Ec.type&&(vb.AssetId=Ec.eL),Ma.push(qb.X8c(Ec.value)),Ia.push(Ec.value),Cc.push(new ob(Ec.value,qb.X8c(Ec.value),Ec.type,Ec.subType,vb));0<Ia.length&&(Xb[Pa.a.pHo]="{"+Ia.join(", ")+"}",Xb[Pa.a.J_l]="{"+Ma.join(", ")+"}",Xb[Pa.a.kHo]=ta.c(Cc));this.B$.kOa(A.a.KEj,Xb,this.oea)}}cgm(vb,Ia){if(4===vb)return Ya.rOn;switch(Ia){case 5:case 16:case 17:case 18:return"Command";
case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return I.a[Ia]}jCn(vb,Ia,Ma,qb,Xb){const Cc=this.Gaa(A.a.click);Cc[Pa.a.U4j]=vb;Cc[Pa.a.e9n]=Ia;Cc[Pa.a.commandId]=Ma;Cc[Pa.a.P6]=qb;Cc[Pa.a.actionType]=this.cgm(Xb.groupType,Xb.resultType);Cc[Pa.a.resultType]=I.a[Xb.resultType];Cc[Pa.a.oGg]=rb[Xb.oGg];Cc[Pa.a.groupType]=V.a[Xb.groupType];Cc[Pa.a.mba]=Xb.mba.toString();Cc[Pa.a.yyf]=Xb.yyf.toString();Cc[Pa.a.resultIndex]=Xb.resultIndex.toString();this.B$.kOa(A.a.click,
Cc,this.oea)}pCn(vb,Ia){this.USa.xta||(this.USa.xta=ib.a.create().toString(),this.k$i("",!1,Ia));Ia=this.Gaa(A.a.V7h);Ia[Pa.a.rYb]=vb;this.B$.jOa(A.a.V7h,Ia)}E$i(vb,Ia,Ma){if(vb){if(Ma)for(const qb in Ma)vb[qb]=Ma[qb];this.B$.jOa(A.a.events,vb,Ia)}}FI(vb,Ia,Ma=null){const qb=this.Gaa(A.a.events);qb[Pa.a.event]=vb;this.E$i(qb,Math.round(Ia),Ma)}oua(vb,Ia,Ma=null){const qb=this.Gaa(A.a.events);qb[Pa.a.event]=A.a.error;qb[Pa.a.module]=vb;qb[Pa.a.errorMessage]=Ia;qb[Pa.a.message]=Ia;this.E$i(qb,Math.round(window.performance.now()),
Ma)}hCn(vb){const Ia=this.Gaa(A.a.M4h);Ia[Pa.a.value]=vb;Ia[Pa.a.Cte]=this.kjb;this.B$.kOa(A.a.M4h,Ia,this.oea)}zBn(vb){const Ia=this.Gaa(A.a.lMh);Ia[Pa.a.value]=vb;Ia[Pa.a.Cte]=this.kjb;this.B$.kOa(A.a.lMh,Ia,this.oea)}bDn(vb){const Ia=this.Gaa(A.a.joi);Ia[Pa.a.value]=vb;Ia[Pa.a.Cte]=this.kjb;this.B$.kOa(A.a.joi,Ia,this.oea)}REn(vb){const Ia=this.Gaa(A.a.Hwj);Ia[Pa.a.value]=vb;Ia[Pa.a.Cte]=this.kjb;this.B$.kOa(A.a.Hwj,Ia,this.oea)}OBn(vb){const Ia=this.Gaa(A.a.kMj);Ia[Pa.a.value]=vb;this.B$.kOa(A.a.kMj,
Ia,this.oea)}VEn(vb,Ia){const Ma=this.Gaa(A.a.kxj);Ma[Pa.a.Fuc]=vb;Ia&&(Ma[Pa.a.xta]=Ia);this.B$.jOa(A.a.kxj,Ma)}Gaa(vb){return{["SessionID"]:this.USa.sessionId,["CorrelationID"]:this.USa.xta,["Time"]:(new Date).getTime(),["Event"]:vb,["Scenario"]:this.oea}}}Object(G.a)(Ub,"UsageLogger",null,[1592]);var lb=d(73),Qb=d(1779),fc=d(1298),Fc=d(1611),nc=d(96),zb=d(33),Vb=d(1297),rc=d(639),pb=d(20),bb=d(814),Pb=d(75),mb=d(12);d.d(J,"TellMeActor",function(){return Ua});class Ua{constructor(){this.e4a=this.a6=
this.Yb=this.Ga=this.QS=this.tu=this.Gb=this.ga=this.Ye=this.SM=this.X0e=this.xLh=this.hqa=this.kc=null;this.C8b=!1;this.MNe=[];this.Xbh=[];this.eKh=[];this.Evh=[];this.Fvh=[];this.zqh=!1;this.s5b=this.sja=null;this.SJc=this.n3a=!1;this.uHd=!0;this.m2=this.QIc=this.ukh=this.l1e=this.qvh=null;this.m1=[];this.Ehb=this.Y5b=this.dGa=this.rKd=this.GFh=null;this.Q7b=!1;this.e1e=0;this.Q4b=null;this.mya=-1;this.Wuh=0;this.$Jc=!1;this.fib=null;this.$Jh=!1;this.S4b=this.Rq=null;this.a0d=(vb,Ia,Ma,qb,Xb)=>
{if(Ia.contextId===Pb.a.frame)switch(vb){case mb.a.su:return this.su(vb,Ia,Ma,qb,Xb);case mb.a.bIg:return this.aZh(vb,Ia,Ma,qb,Xb);case mb.a.gIg:return this.X$i(vb,Ia,Ma,qb,Xb);case mb.a.jIg:return this.v$i(vb,Ia,Ma,qb,Xb);case mb.a.iIg:return this.T$i(vb,Ia,Ma,qb,Xb);case mb.a.eIg:return this.J$a(vb,Ia,Ma,qb,Xb);case mb.a.lIg:return this.XGo(Ma);case mb.a.hIg:return this.S$i(vb,Ia,Ma,qb,Xb);case mb.a.kIg:return this.u$i(vb,Ia,Ma,qb,Xb);case mb.a.Brd:return this.mqi(vb,Ia,Ma,qb,Xb);case mb.a.aIg:return this.J6h(vb,
Ia,Ma,qb,Xb);case mb.a.mIg:case mb.a.W3f:return this.sWf(vb,Ia,Ma,qb,Xb);case mb.a.vDf:case mb.a.wDf:case mb.a.xDf:case mb.a.yDf:case mb.a.zDf:case mb.a.aig:case mb.a.cig:case mb.a.dig:case mb.a.nIg:return this.aZa(vb,Ia,Ma,qb,Xb);case mb.a.xkg:case mb.a.ykg:case mb.a.zkg:return this.F$a(vb,Ia,Ma,qb,Xb);case mb.a.dIg:return this.Hpj(vb,Ia,Ma,qb,Xb);case mb.a.lhf:case mb.a.mhf:case mb.a.nhf:return this.Fhe(vb,Ia,Ma,qb,Xb);case mb.a.P0b:return this.P0b(vb,Ia,Ma,qb,Xb);case mb.a.s3f:return this.m6i(vb,
Ia,Ma,qb,Xb);case mb.a.Bpg:return this.Lxj(vb,Ia,Ma,qb,Xb);case mb.a.yGf:return this.Jsi(vb,Ia,Ma,qb,Xb)}return 2};this.Lxj=(vb,Ia,Ma,qb,Xb)=>{if(1===Ma)return 32;if(P.c(Xb))return this.Ye.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Yb.UEf();if(vb=Xb.TerminalParentControlId){vb=this.S4b.J(vb);if(!vb)return 16;Ia=[];Array.add(Ia,vb);if(!this.A6i(Ia))return 8}return 32};this.Jsi=()=>{if(!this.S4b.count)return 16;const vb=[];for(const Ia of this.S4b.values)Array.add(vb,
Ia);return this.A6i(vb)?32:8};this.F$a=(vb,Ia,Ma,qb,Xb)=>{if(1===Ma)return 32;if(P.c(Xb))return this.Ye.onError("TellMeActor:InsertMention","actiondata comes null"),16;vb=Xb.UILocation;let Cc;Xb=Xb.CommandValueId;try{Cc=ta.a(Xb)}catch(Ec){return this.Ye.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return P.c(Cc)?(this.Ye.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):P.c(this.QIc)?(this.Ye.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),
16):19!==vb?(this.Ye.onError("TellMeActor:InsertMention","location "+vb+" is unexpected"),16):this.QIc.F$a(Cc.displayName,Cc.email,Cc.userId)?32:(this.Ye.onError("TellMeActor:InsertMention","mention is not inserted"),16)};this.aZa=(vb,Ia,Ma,qb,Xb)=>1===Ma?32:P.c(Xb)?(this.Ye.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===Xb.UILocation?this.Gan(Ma,Xb):this.itc(vb,Ia,Ma,qb,Xb);this.Hpj=(vb,Ia,Ma,qb,Xb)=>{if(1===Ma)return 32;if(P.c(Xb))return this.Ye.onError("TellMeActor:OpenFeedback",
"actiondata comes null"),16;this.Rq&&window.setTimeout(()=>{this.Rq.execute(Cc=>{Cc.O_a("TellMeSurvey",null)})},Ua.i6l);return 32};this.rDa=(vb,Ia,Ma,qb,Xb)=>{Ma=window.performance.now();this.cco(Ia);this.Ye.OUo(Ia);this.kc.Hs?(this.Ehb=this.X0e.nfm(Ia,vb,Xb),this.kc.KBa?(this.m1.push(appChrome.actions.updateTellMeSearchResults(this.Ehb.menuModel,vb,Xb)),appChrome.api.dispatch(this.m1)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.Ehb.menuModel,vb,Xb)),this.kc.QFe&&this.Q7b&&
(P.c(this.m2)||this.m2.Location!==oa.a.contextMenu)&&(this.SM.mark(2),this.SM.measure(0,1,2))):this.dGa=this.xLh.ofm(Ia,this.Ye.fva);this.Q4b&&this.Gb.Zb(this.Q4b);Xb={};Xb.GroupsCount=Ia.length;Xb.QueryID=qb;Xb.QueryLength=vb.length;this.Ye.gC(A.a.mJl,window.performance.now()-Ma,Xb)};this.m6i=(vb,Ia,Ma,qb,Xb)=>{if(1===Ma)return 32;if(P.c(Xb))return this.Ye.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",
!1)){vb={};vb.SourceControlId=Xb.SourceControlId;vb.Query=Xb.CommandValueId;Xb=this.ga.Pb(mb.a.lbd,2,vb);if(32!==Xb)this.Ye.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+Xb+".");return Xb}return this.ga.Pb(mb.a.lbd,2,Xb)};this.Fhe=(vb,Ia,Ma,qb,Xb)=>{({AddinResultsProvider:vb}=d(1749));if(1===Ma)return 32;if(P.c(Xb))return this.Ye.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;Ma=Xb.CommandValueId;if(P.b(Ma))return this.Ye.onError("TellMeActor:LaunchAddin",
"Add-in assetId is null"),16;if(!vb.lKb[Ma])return this.Ye.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Ma+" doesn't not exist in entitlements"),16;Xb=d(1749).AddinResultsProvider.lKb[Ma];vb={};vb.solutionId=Xb.id;vb.version=Xb.appVersion;vb.storeType=Xb.storeType;vb.storeId=Xb.storeId;vb.assetId=Xb.assetId;vb.assetStoreId=Xb.assetStoreId;vb.displayName=Xb.displayName;vb.targetType=Xb.targetType;vb.height=Xb.height;vb.width=Xb.width;Xb=this.ga.Pb(mb.a.eWf,2,vb);if(32!==Xb)this.Ye.onError("TellMeActor:LaunchAddin",
"CommonCommands.InsertOfficeAddin failed. Response: "+Xb+". AssetId: "+Ma);return Xb};this.P0b=()=>{if(!P.c(this.Rq))for(const vb of y.a.instance.iqb()){if("ShowContextMenuWithFloatie"===vb.commandId)return this.Rq.execute(Ia=>{Ia.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(vb.commandId&&-1===vb.commandId.indexOf("Tab"))break}return 8}}get EZd(){return this.QS?this.QS.contentType:Ua.unknown}get actions(){return this.m1}set actions(vb){this.m1=vb}U9d(){return this.Ye?this.Ye.fva.xta:
null}yR(){return this.kc}get cNn(){return this.uHd}get XEp(){return this.qvh}performance(){return this.SM}get jEg(){return this.GFh}set jEg(vb){this.GFh=vb}get hud(){return this.$Jh}set hud(vb){this.$Jh=vb}hJ(vb){const Ia=window.performance.now();this.sja&&!P.c(vb)&&(this.sja(vb),this.Ye.gC(A.a.hJ,window.performance.now()-Ia))}initialize(vb,Ia=null,Ma=null,qb=null,Xb=null,Cc=null,Ec=null,Wb=null,Hb=null,Sb=null,cc=null){const {InteractionLogger:Gc}=d(2089),{GroupsPlacementInfo:Oc}=d(2087),{AggregatorResultsProvider:Zc}=
d(1871);this.kc=vb;this.n3a=!!N.AFrameworkApplication.ua&&N.AFrameworkApplication.ua.Ib.ppc;this.Ye=qb;if(!qb){qb=new z;qb.sessionId=N.AFrameworkApplication.userSessionId;const kb=bb.a.Cg(N.AFrameworkApplication.lcid)||bb.a.y8c;this.Ye=new Gc(new Ub(this.kc.application,kb.name,qb,this.kc.Hs,this.n3a,vb.l0a,null),this.kc.NAl,this.kc)}this.e4a=new O(this.kc.parameterData);this.xLh=Ma||new Za(this.kc,this.e4a);this.sja=Ec;this.X0e=this.X0e||new wa(this.kc,this.kc.parameterData,Ec);this.Yb=lb.FocusManager.instance();
this.a6=U.createInstance(this.kc);this.ukh=new Oc(vb);this.ga=Xb||N.AFrameworkApplication.va;this.Gb=Cc||N.AFrameworkApplication.mc;this.tu=Hb;this.hqa=Ia;this.Rq=cc;this.SM=new Fa;this.S4b=new m.a(f.a.th());this.rKd=[];Hb?Hb.execute(kb=>{kb.isFeatureEnabled(Ua.cip,!0).then(wd=>{const {AggregatorResultsProvider:qe}=d(1871);this.$Jc=wd;this.hqa=this.hqa||qe.createInstance(this.a6,this.kc,this.e4a,this.$Jc);for(const Qd of this.rKd)this.hqa.DG(Qd.provider,Qd.yfb);this.rKd=[];return null})}):(this.$Jc=
!0,this.hqa=this.hqa||Zc.createInstance(this.a6,this.kc,this.e4a,this.$Jc));this.Ga=Wb;this.dGa=Za.i1d;this.qvh=new Promise(kb=>{this.l1e=kb});Sb&&Sb.execute(kb=>{this.QS=kb})}Wb(){this.KZk()}suo(vb){this.QIc=vb}KZk(){this.ga.fb(mb.a.su,Pb.a.frame,Object(a.a)(this,this.su,"tellMe"),96);this.ga.fb(mb.a.bIg,Pb.a.frame,Object(a.a)(this,this.aZh,"cacheAsyncMenuRefreshFunction"),96);this.ga.fb(mb.a.gIg,Pb.a.frame,Object(a.a)(this,this.X$i,"logItemExecuted"),96);this.ga.fb(mb.a.jIg,Pb.a.frame,Object(a.a)(this,
this.v$i,"logControlDeactivation"),96);this.ga.fb(mb.a.iIg,Pb.a.frame,Object(a.a)(this,this.T$i,"logInputFocus"),96);this.ga.fb(mb.a.eIg,Pb.a.frame,Object(a.a)(this,this.J$a,"interactionBegin"),96);this.ga.fb(mb.a.lIg,Pb.a.frame,Object(a.a)(this,this.J$a,"interactionBegin"),96);this.ga.fb(mb.a.hIg,Pb.a.frame,Object(a.a)(this,this.S$i,"logInputBlur"),96);this.ga.fb(mb.a.kIg,Pb.a.frame,Object(a.a)(this,this.u$i,"logControlActivated"),96);this.ga.fb(mb.a.Brd,Pb.a.frame,Object(a.a)(this,this.mqi,"focusSearchBox"),
96);this.ga.fb(mb.a.aIg,Pb.a.frame,Object(a.a)(this,this.J6h,"constructLiveNotificationForMenu"),96);this.ga.fb(mb.a.mIg,Pb.a.frame,Object(a.a)(this,this.sWf,"insertTryQuery"),96);this.ga.fb(mb.a.W3f,Pb.a.frame,Object(a.a)(this,this.sWf,"insertTryQuery"),96);this.ga.fb(mb.a.vDf,Pb.a.frame,this.aZa,96);this.ga.fb(mb.a.wDf,Pb.a.frame,this.aZa,96);this.ga.fb(mb.a.xDf,Pb.a.frame,this.aZa,96);this.ga.fb(mb.a.yDf,Pb.a.frame,this.aZa,96);this.ga.fb(mb.a.zDf,Pb.a.frame,this.aZa,96);this.ga.fb(mb.a.aig,Pb.a.frame,
this.aZa,96);this.ga.fb(mb.a.cig,Pb.a.frame,this.aZa,96);this.ga.fb(mb.a.dig,Pb.a.frame,this.aZa,96);this.ga.fb(mb.a.xkg,Pb.a.frame,this.F$a,96);this.ga.fb(mb.a.ykg,Pb.a.frame,this.F$a,96);this.ga.fb(mb.a.zkg,Pb.a.frame,this.F$a,96);this.ga.fb(mb.a.dIg,Pb.a.frame,this.Hpj,96);this.ga.fb(mb.a.nIg,Pb.a.frame,this.aZa,96);this.ga.fb(mb.a.lhf,Pb.a.frame,this.Fhe,96);this.ga.fb(mb.a.mhf,Pb.a.frame,this.Fhe,96);this.ga.fb(mb.a.nhf,Pb.a.frame,this.Fhe,96);this.ga.fb(mb.a.P0b,Pb.a.frame,this.P0b,96);this.ga.fb(mb.a.s3f,
Pb.a.frame,this.m6i,96);this.ga.fb(mb.a.Bpg,Pb.a.frame,this.Lxj,96);this.ga.fb(mb.a.yGf,Pb.a.frame,this.Jsi,96)}hso(vb){this.uHd=!1;const Ia=window.performance.now();vb.jbb.isCompleted?(this.uHd=!0,this.l1e(!0)):vb.w2(()=>{this.uHd=!0;this.l1e(!0);this.Ye.gC(A.a.dRl,window.performance.now()-Ia)});this.$so(vb)}$so(vb){rc.a.Rte(this.a0d);rc.a.y_c([new Vb.a(mb.a.su,Pb.a.frame,96),new Vb.a(mb.a.bIg,Pb.a.frame,96),new Vb.a(mb.a.gIg,Pb.a.frame,96),new Vb.a(mb.a.jIg,Pb.a.frame,96),new Vb.a(mb.a.iIg,Pb.a.frame,
96),new Vb.a(mb.a.eIg,Pb.a.frame,96),new Vb.a(mb.a.lIg,Pb.a.frame,96),new Vb.a(mb.a.hIg,Pb.a.frame,96),new Vb.a(mb.a.kIg,Pb.a.frame,96),new Vb.a(mb.a.Brd,Pb.a.frame,96),new Vb.a(mb.a.aIg,Pb.a.frame,96),new Vb.a(mb.a.mIg,Pb.a.frame,96),new Vb.a(mb.a.W3f,Pb.a.frame,96),new Vb.a(mb.a.vDf,Pb.a.frame,96),new Vb.a(mb.a.wDf,Pb.a.frame,96),new Vb.a(mb.a.xDf,Pb.a.frame,96),new Vb.a(mb.a.yDf,Pb.a.frame,96),new Vb.a(mb.a.zDf,Pb.a.frame,96),new Vb.a(mb.a.aig,Pb.a.frame,96),new Vb.a(mb.a.cig,Pb.a.frame,96),new Vb.a(mb.a.dig,
Pb.a.frame,96),new Vb.a(mb.a.xkg,Pb.a.frame,96),new Vb.a(mb.a.ykg,Pb.a.frame,96),new Vb.a(mb.a.zkg,Pb.a.frame,96),new Vb.a(mb.a.dIg,Pb.a.frame,96),new Vb.a(mb.a.nIg,Pb.a.frame,96),new Vb.a(mb.a.lhf,Pb.a.frame,96),new Vb.a(mb.a.mhf,Pb.a.frame,96),new Vb.a(mb.a.nhf,Pb.a.frame,96),new Vb.a(mb.a.P0b,Pb.a.frame,96),new Vb.a(mb.a.s3f,Pb.a.frame,96),new Vb.a(mb.a.Bpg,Pb.a.frame,96),new Vb.a(mb.a.yGf,Pb.a.frame,96)],vb)}mqi(vb,Ia,Ma){if(1===Ma)return 32;this.WPj();vb=!1;(this.kc.l0a||this.n3a)&&(Ia=document.getElementById("SearchButton"))&&
Ia.click();if(!this.kc.l0a&&this.n3a)for(Ia=document.getElementsByClassName("ms-suiteux-search-box"),Ma=0;Ma<Ia.length;Ma++){const qb=Ia[Ma].querySelector("input[type=search]");qb&&(vb=lb.FocusManager.ZN(qb))}else vb=lb.FocusManager.ZN($get(this.kc.Hs?v.a.sEg:v.a.CCe));this.SJc=!0;return vb?32:8}sWf(vb,Ia,Ma,qb,Xb){if(1===Ma)return 32;if(P.c(Xb))return this.Ye.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.WPj();vb=Xb.CommandValueId;Ia=this.kc.Hs?v.a.sEg:v.a.CCe;this.kc.Hs&&
!P.c(Xb[fc.a.I_a])&&(Xb[fc.a.I_a]=!1);if(vb){if(this.kc.Hs)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(vb)),this.fib=[19],32;if(Xb=$get(Ia))Xb.value=vb}return lb.FocusManager.ZN($get(Ia))?32:8}WPj(){this.Yb.NN(this.kc.l0a||this.n3a?this.kc.pRb:this.kc.Gdb,!1)}Ufm(vb,Ia){switch(vb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Ia);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Ia);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,
Ia);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,Ia)}return Ia}J6h(vb,Ia,Ma,qb,Xb){if(1===Ma)return 32;if(P.c(Xb))return this.Ye.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;vb=this.dGa?this.dGa.cHj:0;Xb.Value=1!==vb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,vb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.dGa)for(const Cc of this.dGa.HVl)Xb=Object(l.a)(Q.a,
Cc)?Cc.id:fa.a.replaceAll(Cc.value,'"',""),(Xb=$get(Xb+"-"+H.a.cIg))&&zb.a.Ls(Xb,zb.a.Jja,fa.a.Hf(this.Ufm(Cc.groupType,Xb.innerText)));return 32}aZh(vb,Ia,Ma,qb,Xb){if(1===Ma)return 32;if(P.c(Xb))return this.Ye.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.Q4b=new nc.a(2,1,0,()=>{Xb[Qb.a.Callback]()},97);this.dGa&&this.Gb.Zb(this.Q4b);return 32}X$i(vb,Ia,Ma,qb,Xb){if(1===Ma)return 32;if(P.c(Xb))return this.Ye.onError("TellMeActor:LogItemExecuted","actiondata comes null"),
16;Xb.CloseAllMenus&&(vb=void 0===Xb.ParentControlId||null===Xb.ParentControlId?"<NA>":Xb.ParentControlId,Ia=this.s5b?this.s5b[Xb.ControlId]:null,!Ia&&this.s5b&&"<NA>"!==vb&&(Ia=this.s5b[vb]),Ia||(Ia=this.C8b&&this.a6.kgn(Xb),Ia=this.ySl(Ia,Xb.ControlId),Ia=new u(Ia,32,4,-1,-1,-1),this.Ye.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+Xb.ControlId+" determined group:"+V.a[Ia.groupType])),this.Ye.TVn(Xb.ControlId,vb,Xb.CommandId,Xb.CloseAllMenus,Ia),this.e4a.VRn(Xb.ControlId),Xb.Location!==
oa.a.contextMenu&&(this.a6.S5a(Xb),this.a6.DG(Ia.resultType),this.kc.vze&&this.hqa.xXk(Xb.CommandId)));return 32}v$i(vb,Ia,Ma,qb,Xb){if(1===Ma)return 32;(new Aa(this.U9d())).pHm(this.Y5b);vb=this.Y5b;Ia=this.mya;Ma=this.Ye.xzd;if(P.c(Xb))return this.Ye.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;Xb=Xb.UILocation;vb&&0<vb.length&&this.$Jc&&H.a.iCg(this.kc)&&this.kc.Dge&&19!==Xb&&Ia>Ma&&!this.kc.uS&&(this.Ye.N6f(vb),this.Ye.tzg(Ia));this.Ye.IFo();this.kc.QFe&&19!==Xb&&(this.SM.mark(3),
this.SM.measure(1,0,3),this.SM.measure(2,2,3),this.SM.B6f(0,1,2),this.SM.B6f(2,2,3),this.SM.B6f(1,0,3),this.SM.Erl(),this.SM.clearMeasures([0,2,1]));this.Ye.vWn(window.performance.now()-this.e1e);this.kc.Hs&&(this.Ehb=null,this.Ye.lDa());this.SJc=this.Q7b=!1;this.Y5b="";return 32}T$i(vb,Ia,Ma){if(1===Ma)return 32;this.Ye.Jvb(x(Ia),this.SJc);return 32}S$i(vb,Ia,Ma){if(1===Ma)return 32;this.Ye.lDa();this.Q7b=!1;return 32}u$i(vb,Ia,Ma,qb,Xb){if(1===Ma)return 32;this.m2=null;Xb&&(this.m2=Xb);this.kc.QFe&&
(P.c(this.m2)||this.m2.Location!==oa.a.contextMenu)&&this.SM.mark(0);this.Ye.tye(P.c(this.m2)||P.c(this.m2.Location)?oa.a.unknown:this.m2.Location);this.Ye.uWn(this.Wuh,this.SJc);this.Q7b||this.ecb();return 32}q$h(vb,Ia){const Ma=[],qb=Date.now();for(const Xb of vb)vb=(qb-Xb.timeStamp)/1E3,vb=H.a.YDe(vb),Array.add(Ma,new S(Ia?Xb.commandId:Xb.controlId,vb));return Ma}uLl(vb){const Ia=[],Ma=Date.now();for(const qb of vb)if(qb.controlId||"keyboardShortcut"===qb.commandSurface)vb=(Ma-qb.timeStamp)/1E3,
vb=H.a.YDe(vb),Array.add(Ia,new Z(qb.controlId,qb.commandId,vb,qb.commandSurface,qb.GCe));return Ia}eai(vb=!1){var Ia=vb?this.a6.jHm():this.a6.G2c();vb=[];const Ma=Date.now();for(const qb of Ia)Ia=(Ma-qb.TimeStamp)/1E3,Ia=H.a.YDe(Ia),Array.add(vb,new S(qb.Id,Ia));return vb}ecb(){if(!this.Q7b){this.C8b=this.Q7b=!0;if(!this.zqh){this.zqh=!0;const vb={};vb.IsMLREnabled=this.kc.Dmn;vb.IsReactRibbonEnabled=this.kc.Hs;vb.IsSharedHeaderEnabled=!!N.AFrameworkApplication.ua&&N.AFrameworkApplication.ua.Ib.BN;
vb.IsSearchUxEnabled=this.n3a;vb.IsTellMeInHeaderEnabled=this.kc.l0a;vb.IsGoLocalEnv=H.a.Ljn();vb.IsSovereignEnvironment=H.a.vpc();vb.IsTellMeServiceResultsEnabled=H.a.iCg(this.kc);vb.IsSubstrateProviderEnabled=H.a.hCg(this.kc);vb.ShouldFetchTokens=!!N.AFrameworkApplication.ua&&N.AFrameworkApplication.ua.Ib.v0b;vb.IsSerpletEnabled=H.a.Vta();vb.FirstOnClickTimeInMS=Math.round(window.performance.now());vb.IsHeaderHidden=N.AFrameworkApplication.hideHeader||N.AFrameworkApplication.a0;vb.IsSearchInHeaderHidden=
N.AFrameworkApplication.t6c;void 0!==window.performance.timing&&null!==window.performance.timing&&(vb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));vb.IsFindWithMatchesEnabled=this.kc.w3d;vb.HelpShowsTopSearchResult=this.kc.opd;vb.HelpShowsNumberOfMatches=this.kc.npd;N.AFrameworkApplication.K&&(vb.UiHost=N.AFrameworkApplication.K.kb("UiHostIntegrationType"));this.Ye.mFn(JSON.stringify(vb))}this.MNe=this.q$h(y.a.instance.x2c(),!1);this.Xbh=this.q$h(y.a.instance.iqb(),
!0);this.eKh=this.uLl(y.a.instance.iqb());this.Evh=this.eai();this.Fvh=this.eai(!0);this.Ye.ecb()}}J$a(vb,Ia,Ma,qb,Xb){if(1===Ma)return 32;if(P.c(Xb))return this.Ye.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(pb.a.P9c)return 32;this.e1e=window.performance.now();this.ecb();vb=new T(this.rDa,0);this.mya++;this.Ye.beginQuery("",this.mya,this.C8b);this.cMg(!0,null);this.dGa=Za.i1d;this.Ehb=wa.DAf;if(this.hqa)Ua.instance.actions=[],this.hqa.hK(new Y("",this.mya),vb,this.kc.Hs);
else this.Ye.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Q4b&&this.Gb.Zb(this.Q4b);return 32}XGo(vb){if(1===vb)return 32;this.Yb.fV(this.kc.l0a||this.n3a?this.kc.pRb:this.kc.Gdb,!1);return 32}su(vb,Ia,Ma,qb,Xb){if(1===Ma)return 32;if(P.c(Xb))return this.Ye.onError("TellMeActor:TellMe","actiondata comes null"),16;this.m2=Xb;this.Ye.tye(P.c(this.m2.Location)?oa.a.unknown:this.m2.Location);vb=this.m2.Value;this.kc.Hs||vb&&""!==vb.trim()?(!this.Ehb&&this.kc.Hs&&
(this.Ye.Jvb(x(Ia),this.SJc),this.ecb()),this.W3l(vb,this.m2.Location),this.m2.PopulationXML=this.dGa.xml):this.C8b?this.m2.PopulationXML=this.dGa.xml:(this.m2.PopulationXML=Za.i1d.xml,this.Ehb=wa.DAf,this.Y5b="");return 32}W3l(vb,Ia){this.e1e=window.performance.now();this.kc.QFe&&Ia!==oa.a.contextMenu&&this.SM.mark(1);this.kc.Hs&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(vb));vb&&0<vb.trim().length&&(this.C8b=!1);this.kc.k2l();Ia=P.c(Ia)?oa.a.su:Ia;if(vb!==this.Y5b||this.kc.Hs){this.mya++;
this.Ye.beginQuery(vb,this.mya,this.C8b);this.cMg(!0,null);const Ma=new Y(vb,this.mya),qb=new T(this.rDa,this.mya);this.dGa=Za.i1d;this.Ehb=wa.DAf;if(this.hqa)Ua.instance.actions=[],this.hqa.hK(Ma,qb,this.kc.Hs,Ia,this.fib),this.fib=null;else this.Ye.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Wuh=this.mya;this.Y5b=vb}}gxp(vb){if(this.kc.Hs){var Ia=appChrome.selectors.getActiveControlStates();if(Ia=Object(w.a)(Object,Ia[vb.value])){vb.label=Ia.label;let Ma=
null;"description"in Ia&&(Ma=Ia.description);Ma&&Object.getType(Ma)===String?vb.description=Ma:"secondaryText"in Ia?vb.description=Ia.secondaryText:"fullDescriptionLabel"in Ia&&(vb.description=Ia.fullDescriptionLabel)}}}cco(vb){this.s5b={};let Ia=0,Ma=0;for(const qb of vb){vb=0;for(const Xb of qb.results)this.s5b[Xb.value]=new u(Xb.groupType,Xb.type,Xb.subType,Ia,vb,Ma),vb++,Ma++,Xb.label||5!==Xb.type||this.gxp(Xb);0<vb&&Ia++}}itc(vb,Ia,Ma,qb,Xb){if(1===Ma)return 32;if(P.c(Xb))return this.Ye.onError("TellMeActor:OpenUrlInNewTab",
"actiondata comes null"),16;(vb=Xb.CommandValueId)&&window.open(vb,"_blank");return 32}A6i(vb){const Ia={};Ia.token=this.jEg;Ia.files=ta.c(vb);Ia.type="MultiFilesDeckGeneration";if(N.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.ga.Pb(mb.a.mxn,2,Ia),!0;vb=H.a.BHi("",H.a.eHj("GenerateDeckFromFile"),Object.assign(new Fc.a,{landingTab:"All",data:Ia}));vb=this.ga.Pb(mb.a.uba,2,vb);return 32!==vb?(this.Ye.onError("LaunchSmartLookupWithFilesData",
"CommonCommands.InvokeSerplet failed. Response: "+vb+"."),!1):!0}Gan(vb,Ia){if(1===vb)return 32;if(P.c(Ia))return this.Ye.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(P.c(this.QIc))return this.Ye.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;vb=Ia.CommandValueId;return P.c(vb)?(this.Ye.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.QIc.insertHtmlText(vb)?32:(this.Ye.onError("TellMeActor:InsertUrl","url is not inserted"),16)}ySl(vb,
Ia){return Ia.startsWith(this.kc.Hs?H.a.PKg:H.a.lEe)?5:vb?4:"bSearchHelp"===Ia||Ia.startsWith("GetHelpFromTellMe")?8:"bInsights"===Ia||Ia.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Ia?24:Ia===this.kc.MDf?2:0}DG(vb,Ia){this.hqa?this.hqa.DG(vb,Ia):Array.add(this.rKd,new D(vb,Ia))}cMg(vb,Ia="",Ma=null){vb?this.S4b=new m.a(f.a.th()):Ia&&Ma&&this.S4b.add(Ia,Ma)}static get instance(){return Ua._instance||(Ua._instance=new Ua)}}Ua._instance=null;Ua.cip="mso_tellMeService";Ua.unknown="Unknown";
Ua.i6l=500;Object(G.a)(Ua,"TellMeActor",null,[])},1566:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);var m=d(1579);class f{constructor(a,l){this.ljb=!1;const {Annotations:w}=d(1560);if(!a)throw Error.argumentNull("annotations");if(!a.Z1f(l))throw Error.argument("memberTypeID","Invalid type ID");if(w.zK(l))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Gx=a;this.JEk=l;this.fq=[]}get gdc(){return this.Gx}get isReadOnly(){return this.ljb}get d8(){return this.JEk}get items(){return this.fq}bia(){const {Annotations:a}=
d(1560);let l="[";for(let w=0,y=this.items.length;w<y;++w){0<w&&(l+=", ");const v=this.Gx.bia(this.d8,this.items[w]);this.d8===a.eda?(l+='"',l+=m.a.YBf(v),l+='"'):l+=v}return l+"]"}isEqual(a){const {Annotations:l}=d(1560);if(this===a)return!0;if(!a||a.gdc!==this.Gx||a.d8!==this.d8||a.items.length!==this.items.length)return!1;for(let w=0;w<this.items.length;++w)if(!l.AAb(this.d8,this.items[w],a.items[w]))return!1;return!0}clone(){const a=new f(this.Gx,this.d8);Array.addRange(a.items,this.items);return a}IW(){return this.isReadOnly?
this.clone():this}Z5f(){const {Annotations:a}=d(1560);if(!this.isReadOnly){this.ljb=!0;for(const l of this.items)a.QUb(l)}}toString(){return this.bia()}}Object(G.a)(f,"ListValue",null,[1665,1663])},1567:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}m.su="TellMe";m.contextMenu="ContextMenu";m.unknown="Unknown";Object(G.a)(m,"TellMeScenario",null,[])},1569:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a,l=null,w=null,y=4,v=-99999,u=0){this.eL="";this.mSd=
-1;this.value=f;this.type=a;this.subType=y;this.label=this.DE=l;this.groupType=30;this.description=w;this.score=v;this.count=u}}Object(G.a)(m,"ResultBinding",null,[])},1571:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f){this.attributes=null;this.query=f;this.$o=[]}aw(f){this.$o.push(f)}YCj(f){const a=[];for(const l of this.$o)l.groupType!==f&&a.push(l);this.$o.length!==a.length&&(this.$o=a)}get Zoc(){return!1}}Object(G.a)(m,"SimpleResultsUpdatedEventArgs",null,[1572])},
1572:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f=30,a=""){this.yO=[];this.groupType=f;this.displayName=a}get results(){return this.yO}hy(f){f.groupType=this.groupType;Array.add(this.results,f)}Gsg(f=1){if(this.results.length>=f)for(let a=0;a<f;a++)Array.removeAt(this.results,this.results.length-1)}}Object(G.a)(m,"SimpleResultGroup",null,[1573])},1579:function(G,J,d){G=d(0);class m{constructor(a,l){this.ymb=a;this.value=l}}Object(G.a)(m,"AttrValuePair",null,[]);d.d(J,
"a",function(){return f});class f{constructor(a){this.ljb=!1;if(!a)throw Error.argumentNull("annotations");this.Gx=a;this.z0=[]}get gdc(){return this.Gx}get isReadOnly(){return this.ljb}get kSf(){return 0<this.z0.length}xr(a){if(!this.Gx.Ipc(a))throw Error.argument("attributeID","Invalid attribute ID");for(const l of this.z0)if(a===l.ymb)return a=l.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}jA(a,l){var {Annotations:w}=d(1560);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");
if(!this.Gx.Ipc(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Gx.Eoc(this.Gx.getAttributeType(a),l))throw Error.argument("value","Value is not of the correct type for the specified attribute");w.QUb(l);for(w=0;w<this.z0.length;++w){const y=this.z0[w];if(a===y.ymb){y.value=l;return}}Array.add(this.z0,new m(a,l))}UZa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Gx.Ipc(a))throw Error.argument("attributeID",
"Invalid attribute ID");for(let l=0;l<this.z0.length;++l)if(a===this.z0[l].ymb){Array.removeAt(this.z0,l);break}}w4d(a){if(!a)throw Error.argumentNull("action");for(const l of this.z0)a(l.ymb,l.value)}clone(){const a=new f(this.Gx);a.j7a(this);return a}j7a(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.gdc!==this.Gx)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.z0);
a.w4d((l,w)=>{this.jA(l,w)})}bia(){const {Annotations:a}=d(1560);let l="[",w=!0;for(const y of this.z0){w?w=!1:l+=", ";l+=this.Gx.Vti(y.ymb);l+="=";const v=this.Gx.getAttributeType(y.ymb),u=this.Gx.bia(v,y.value);v===a.eda?(l+='"',l+=f.YBf(u),l+='"'):l+=u}return l+"]"}isEqual(a){const {Annotations:l}=d(1560);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.Gx!==a.gdc||this.kSf!==a.kSf)return!1;let w=0,y=null,v=!1;a.w4d((u,x)=>{++w;if(!v){var z=-1;for(let A=0,D=this.z0.length;A<
D;++A)if(this.z0[A].ymb===u){z=A;break}0>z?v=!0:(y||(y=Array(this.z0.length)),y[z]=x)}});if(this.z0.length!==w||v)return!1;for(let u=0,x=this.z0.length;u<x;++u)if(!l.AAb(this.Gx.getAttributeType(this.z0[u].ymb),this.z0[u].value,y[u]))return!1;return!0}IW(){return this.isReadOnly?this.clone():this}Z5f(){const {Annotations:a}=d(1560);if(!this.isReadOnly){this.ljb=!0;for(const l of this.z0)a.QUb(l.value)}}toString(){return this.bia()}static YBf(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]",
"\\]").replace(",","\\,")}}Object(G.a)(f,"FeatureBundle",null,[1662,1663])},1587:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}m.click="Click";m.J$a="InteractionBegin";m.wSb="InteractionEnd";m.V7h="ControlActivated";m.query="Query";m.kxj="QueryIndexRecorded";m.M4h="Clicks";m.lMh="ActionEvents";m.joi="FilteredActionEvents";m.kMj="SessionContext";m.latency="Latency";m.performance="Performance";m.KEj="RenderedResults";m.events="Events";m.mJl="CreateResultsMenu";m.hJ="UpdateRibbonControls";
m.oHo="ResultsAggregation";m.hK="IssueQuery";m.svl="CommandSuggestions";m.error="Error";m.H5f="LoadModelData";m.dRl="DepsResolveTime";m.dNn="ModelDataWaitTime";m.XIg="TimedOut";m.L2k="AddinQueryCommandReady";m.xgm="GetAddinEntitlements";m.Hwj="ProviderMRUEvents";m.z_l="EnableAddinSearchCommands";Object(G.a)(m,"EventNames",null,[])},1595:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.P7f=null;this.Aga=this.R7f=0}QFf(f,a,l){if(!f)throw Error.argumentNull("referenceList");
if(0>a||a>f.length)throw Error.argumentOutOfRange("startIndex");if(0>l||l>f.length)throw Error.argumentOutOfRange("length");if(a+l>f.length)throw Error.argument("Invalid start-length range");this.P7f=f;this.R7f=a;this.Aga=l}cqb(f,a,l){this.QFf(f.P7f,f.R7f+a,l)}J(f){if(0>f||f>=this.Aga)throw Error.argumentOutOfRange("index");return this.P7f[this.R7f+f]}get count(){return this.Aga}static uuf(f){const a=new m;a.QFf(f,0,f.length);return a}}Object(G.a)(m,"ReadOnlyList",null,[1689])},1601:function(G,J,
d){d.d(J,"a",function(){return m});G=d(0);var m;(function(f){f[f.sLp=0]="Classifier";f[f.RKp=1]="AppsForOffice";f[f.VHe=2]="FindInDocument";f[f.NMp=3]="FindInDocumentScopedSearch";f[f.APp=4]="RecentlyUsed";f[f.gkk=5]="TryQuery";f[f.Empty=6]="Empty";f[f.aRp=7]="TryCommand";f[f.Jdk=8]="Assistance";f[f.Bdk=9]="Answer";f[f.Definition=10]="Definition";f[f.Entity=11]="Entity";f[f.Ykk=12]="WolframAnswer";f[f.xgk=13]="Insights";f[f.People=14]="People";f[f.Document=15]="Document";f[f.BPp=16]="Recommended";
f[f.fQp=17]="ServiceClassifier";f[f.gQp=18]="ServiceRecommended";f[f.Image=19]="Image";f[f.Notes=20]="Notes";f[f.Wgk=21]="Learning";f[f.Feedback=22]="Feedback";f[f.Template=23]="Template";f[f.odk=24]="ActionAI";f[f.pdk=25]="ActionAICommand";f[f.wjk=26]="SummarizeDeck";f[f.xdk=27]="Addin";f[f.cik=28]="OfficeScript";f[f.ydk=29]="AddinStoreEntry";f[f.None=30]="None";f[f.lOp=31]="MergedActions";f[f.mOp=32]="MergedScopedSearches";f[f.nOp=33]="MergedSuggestedSearches"})(m||(m={}));Object(G.b)("ResultGroupType",
m)},1612:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(1665);class m extends d.a{constructor(){super();this.info=this.$j=this.eventId=null}get tfa(){return"Misc"}HPb(){this.detail.Z("Type",this.tfa);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.$j);this.detail.Z("Info",this.info);return this.detail}}Object(G.a)(m,"BasicMergeFailureDetail",d.a,[])},1613:function(G,J,d){d.d(J,"a",function(){return l});G=d(0);var m=d(651),f=d(864),a=d(1631);class l{constructor(w,y=!0){this.Fm=
y&&w?w.WO():w;this.rbc=new m.a}XM(w){this.rbc.add(f.a.yb(w))}oZo(w){this.rbc=w}gej(w){this.Fm&&(new a.a(this.Fm,w)).yNa.forEach((y,v)=>{v.B3&&!this.rbc.contains(y)&&(this.rbc.add(y),v.isDeleted?(v=this.Fm,v.hasProperty(f.a.J_(y))&&v.removeProperty(f.a.J_(y))):this.Fm.heb(f.a.J_(y),v.newValue));return!0})}}Object(G.a)(l,"PartialMergeResult",null,[])},1614:function(G,J,d){d.r(J);d.d(J,"CommandResultsUtility",function(){return x});G=d(0);var m=d(1626),f=d(1587),a=d(1627),l=d(1569),w=d(1572),y=d(1565),
v=d(1563),u=d(2);class x{static ptd(z,A){if(A&&A.Hs){const D={};for(const F of z)A.Wge(F)&&(D[F]=appChrome.selectors.getModelType(F));y.TellMeActor.instance.hJ(D)}}static pip(z){return z.startsWith("btnTellMeOfficeAddIn")}static X8c(z){const A=y.TellMeActor.instance.yR();return!!A&&A.Hs&&!appChrome.selectors.isControlDisabled(z)}static Fie(z,A,D,F){if(y.TellMeActor.instance.Ye&&z){const I=[];for(const H of z)I.push(String.format('{{"Id":"{0}","Score":{1}}}',H.commandId,H.score));z={};z[m.a.suggestions]=
"[{"+I.join(",")+"}]";z[m.a.M4i]=A;z[m.a.groupType]=D;z[m.a.provider]=F;y.TellMeActor.instance.Ye.gC(f.a.svl,window.performance.now(),z)}}static Gnm(z,A){const D=[],F=[];for(const I of A){A=I.commandId;let H=I;I.commandId in z&&(A=z[I.commandId],H=new a.a(A,I.score));Array.contains(F,A)||(D.push(H),F.push(A))}return D}static z4c(z,A,D,F,I,H,N,M){D.LIf&&(A=x.Gnm(D.LIf,A));var U=v.a.Zlm(A);x.ptd(U,D);var O=[],V=[];U=[];const Y=new w.a(N);N=16===N||18===N||7===N||4===N?u.AFrameworkApplication.K?u.AFrameworkApplication.K.ic("TellMeMaxRecommendedResultsToReturn",
3):3:0===N||17===N||25===N?5:0;for(const Q of A)if(!x.ign(Q.commandId)){A=x.pip(Q.commandId);if(D.Wge(Q.commandId)&&!A){if(v.a.o3i(Q.commandId))continue;A=null;I&&H&&(A=I.OEm(Q.commandId,H));x.X8c(Q.commandId)?Array.add(O,new l.a(Q.commandId,5,A,null,M,Q.score)):Array.add(V,new l.a(Q.commandId,5,A,null,M,Q.score))}else D.uKb&&A&&F&&Array.add(U,Q.commandId.substr(21));if(O.length+U.length>=N)break}D=0;for(I=0;I<O.length&&D<N;I++,D++)Y.hy(O[I]);for(O=0;O<V.length&&D<N;O++,D++)Y.hy(V[O]);for(V=0;V<U.length&&
D<N;V++,D++)F.Yoq(z,U[V],Y);return Y}static ign(z){x.yWh||(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.jy("TellMeControlPredictionBlockList")&&u.AFrameworkApplication.K.iD("TellMeControlPredictionBlockList").forEach(A=>{Array.add(x.xWh,A.toLowerCase())}),x.yWh=!0);return Array.contains(x.xWh,z.toLowerCase())}static SXf(z){return 2<z.length&&";"===z.charAt(0)&&";"===z.charAt(z.length-1)&&!!u.AFrameworkApplication.K&&(u.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",
!1))}static Ovi(z){const A=new w.a(0);var D=z.split(";");z=y.TellMeActor.instance.yR();for(const F of D)if(0<F.length){D=F.split(":");const I=2===D.length?D[0]:F;if(!z.Wge(I))break;if(1===D.length)D=new l.a(I,5,null,null,1),A.hy(D);else if(2===D.length)D=new l.a(I,5,D[1],null,1),A.hy(D);else break}return A}static YWk(z,A,D){if(!(A&&A.results&&z&&z.results&&z.results.length))return{returnValue:!1,Wef:z,Tff:A};const F=[];for(var I of A.results)Array.add(F,I.value);I=0;const H=0<A.results.length?A.results[0].score:
0;for(const N of z.results)if(N.score>D&&!Array.contains(F,N.value)&&x.X8c(N.value)&&(0<H&&(N.score=H),Array.insert(A.results,I,N),I++),2===I)break;return 0<I?(D=A.results.length-5,0<D&&A.Gsg(D),{returnValue:!0,Wef:z,Tff:A}):{returnValue:!1,Wef:z,Tff:A}}}x.yWh=!1;x.xWh=[];Object(G.a)(x,"CommandResultsUtility",null,[])},1625:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{static qkp(f){return f.toString().charCodeAt(0)}static asn(f){return 55296<=f&&57343>=f}static charAt(f,a){return f.charAt(a)}static pUh(f,
a){if(f===a)return!0;"\u00a0"===f&&(f=" ");"\u00a0"===a&&(a=" ");return f===a}static oUh(f,a){if(f===a)return!0;if(!f||!a||f.length!==a.length)return!1;f=m.UEj(f);a=m.UEj(a);return f===a}static UEj(f){return f.replace(m.Wcd," ")}static izb(f,a,l){return f.substring(a,a+l)}}m.Wcd=RegExp("\u00a0","g");Object(G.a)(m,"CharUtils",null,[])},1626:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}m.appName="AppName";m.P6="CloseAllMenus";m.commandId="CommandId";m.context="Context";m.culture=
"Culture";m.message="Message";m.errorMessage="ErrorMessage";m.event="Event";m.xta="CorrelationID";m.e9n="ParentUiElement";m.query="Input";m.rYb="QueryID";m.pxj="QueryLength";m.Fuc="QueryIndex";m.pHo="ResultsList";m.suggestions="Suggestions";m.scenario="Scenario";m.sessionId="SessionID";m.source="Source";m.timeStamp="Time";m.U4j="UiElement";m.Cte="ReactUx";m.value="Val";m.statusCode="StatusCode";m.service="Service";m.isSuccess="IsSuccess";m.dlp="TokenAcquired";m.Swn="LatencyType";m.groupName="GroupName";
m.mba="GroupIndex";m.groupType="GroupType";m.kHo="ResultInfoList";m.resultType="ResultType";m.oGg="SubResultType";m.Xkn="IsInputBlur";m.Ykn="IsInputFocus";m.hrn="IsShortCutUsed";m.actionType="ActionType";m.count="Count";m.KYl="DwellTime";m.M4i="IsZeroTerm";m.sJp="WordsCount";m.bge="IsSearchUxEnabled";m.wsn="IsTellMeInHeaderEnabled";m.module="Module";m.resultIndex="ResultIndex";m.yyf="DisplayIndex";m.J_l="EnableList";m.provider="Provider";m.contentType="ContentType";m.Dqn="IsSelectionBased";m.gcl=
"BeginPerformanceMarker";m.l0l="EndPerformanceMarker";m.kao="PerformanceMeasure";Object(G.a)(m,"Columns",null,[])},1627:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a){this.commandId=f;this.score=a}}Object(G.a)(m,"CommandSuggestion",null,[])},1631:function(G,J,d){G=d(0);var m=d(381),f=d(864),a=d(286),l=d(104);class w{constructor(v,u,x){this.QJk=v;this.fGk=u;this.xFk=x;this.iXe=new a.a(Object(l.a)(this,this.Qol,"checkIfDifferent"))}get Xng(){return this.QJk}get oldValue(){return this.fGk}get newValue(){return this.xFk}get Msb(){return!(void 0===
this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get B3(){return this.Msb||this.isDeleted||this.iXe.value}Qol(){return this.Msb||this.isDeleted?!0:!f.a.xUh(this.Xng,this.oldValue,this.newValue)}}Object(G.a)(w,"PropertyDiff",null,[]);d.d(J,"a",function(){return y});class y{constructor(v,u){this.cGk=v;this.uFk=u;this.iXe=new a.a(()=>this.h9c());this.SJk=
new a.a(Object(l.a)(this,this.Y2l,"evaluatePropertyDiffs"))}get Ov(){return this.cGk}get Jf(){return this.uFk}get Msb(){return!!this.Jf&&!this.Ov}get isDeleted(){return!this.Jf&&!!this.Ov}get B3(){return this.Msb||this.isDeleted||this.iXe.value}get yNa(){return this.SJk.value}h9c(v=null){let u=!1;this.yNa.forEach((x,z)=>{u=z.B3&&(!v||7!==v.J(x));return!u});return u}Y2l(){const v=new m.a;var u=this.Jf,x=this.Ov;if(this.Msb){x=u.fk();for(var z=0;z<x.length;z++){var A=x[z];v.Z(f.a.yb(A),new w(A,null,
u.qI(A)))}}else if(this.isDeleted)for(u=x.fk(),z=0;z<u.length;z++)A=u[z],v.Z(f.a.yb(A),new w(A,x.qI(A),null));else{z=x.fk();for(A=0;A<z.length;A++){var D=z[A],F=f.a.yb(D),I=x.qI(D);const H=u.hasProperty(D)?u.qI(D):null;v.Z(F,new w(D,I,H))}z=u.fk();for(A=0;A<z.length;A++)D=z[A],x.hasProperty(D)||(F=f.a.yb(D),I=u.qI(D),v.Z(F,new w(D,null,I)))}return v}}Object(G.a)(y,"MergeableObjectDiff",null,[])},1638:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);var m=d(54);class f{constructor(){this.cp=
0;this.id=m.a.create()}}Object(G.a)(f,"LcsUpdateHint",null,[1079,190])},1639:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}m.su="TellMe";m.wGn="Loki";m.fZj="Substrate";m.Fuc="QueryIndex";m.X_j="TellMeRanker";m.Y_j="TellMeRankerLogging";Object(G.a)(m,"Services",null,[])},1640:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{}m.OWa="HttpRequest";m.provider="Provider";Object(G.a)(m,"LatencyTypes",null,[])},1645:function(G,J,d){G=d(0);var m=d(63),f=d(16),a=d(5),l=d(43),
w=d(233),y=d(192),v=d(250),u=d(54),x=d(651),z=d(104),A=d(257),D=d(1665);class F extends D.a{constructor(){super();this.GD=null}get tfa(){return"CreateMergeBlock"}HPb(){this.detail.Z("Type",this.tfa);this.detail.Z("Revision",this.GD);return this.detail}}Object(G.a)(F,"CreateMergeBlockFailureDetail",D.a,[]);var I=d(1711),H=d(1713),N=d(1822),M=d(1666),U=d(1613),O=d(1893),V=d(616);d.d(J,"a",function(){return Y});class Y{static SYd(Q,S,P,T,Z,X,aa){let ia;ia="";const wa=new w.a;for(let na=0;na<P.length;na++){var ma=
void 0;let Fa;ma=I.a.Xnm(S,P.J(na),T,Z,X,aa,Q);if(!ma)return{returnValue:null,Ebb:ia};({V8f:Fa,Ebb:ma}=ma.sCi());if(!Fa)return{returnValue:null,Ebb:ia};ia+=ma;wa.pD(wa.length,Fa)}return{returnValue:wa,Ebb:ia}}static gai(Q,S,P,T,Z,X,aa,ia){let wa,ma,na,Fa,Qa,ya;ya=Qa=Fa=na=ma=wa=null;({Ebb:Fa,returnValue:wa}=Y.SYd(S,ta=>Q.runtime.In.J(ta),P,1,X,aa,ia));if(!wa)return y.a.instance.Ua(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),
Q.logger.Oi(Object.assign(new F,{GD:"Base"})),{returnValue:!1,ZM:wa,n0c:ma,itd:na,CTd:Fa,P2d:Qa,HEe:ya};({Ebb:Qa,returnValue:ma}=Y.SYd(S,ta=>Q.runtime.NA.J(ta)||Q.runtime.In.J(ta),T,2,X,aa,ia));if(!ma)return y.a.instance.Ua(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),Q.logger.Oi(Object.assign(new F,{GD:"Favored"})),{returnValue:!1,ZM:wa,n0c:ma,itd:na,CTd:Fa,P2d:Qa,HEe:ya};({Ebb:ya,returnValue:na}=
Y.SYd(S,ta=>Q.runtime.sv.J(ta)||Q.runtime.In.J(ta),Z,4,X,aa,ia));return na?{returnValue:!0,ZM:wa,n0c:ma,itd:na,CTd:Fa,P2d:Qa,HEe:ya}:(y.a.instance.Ua(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),Q.logger.Oi(Object.assign(new F,{GD:"Unfavored"})),{returnValue:!1,ZM:wa,n0c:ma,itd:na,CTd:Fa,P2d:Qa,HEe:ya})}static K4h(Q,S=!1){const P=new w.a;let T=0;for(;T<Q.length;){var Z=Q.J(T);if(1===Z.type||
4===Z.type||2===Z.type)P.add(Z),T++;else if(3===Z.type){let aa="";aa+=Z.character;T++;let ia=Z.JXa,wa=!1;for(;T<Q.length;T++){var X=Q.J(T);3===X.type?Z.runId===X.runId&&Z.yL.equals(X.yL)&&(Z.Rfa===X.Rfa||Z.cLa===X.cLa)&&Z.iA.$B(X.iA)&&(!S||Z.Xu&&Z.Xu.equals(X.Xu))?(aa+=X.character,X.JXa&&(ia=!0)):wa=!0:wa=!0;if(wa){Z=new O.a(null,Z.source,Z.wk,Z.Rg,Z.runId,Z.yL,aa,Z.gvb,!0,ia,Z.Rfa,Z.cLa,Z.zZa,Z.iA,Z.Xu);P.add(Z);break}}}}y.a.instance.Ua(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
P.Yr());return P}static hvl(Q,S=!1){const P=new w.a;let T=0;for(;T<Q.length;){var Z=Q.J(T);if(1===Z.type||4===Z.type||2===Z.type)P.add(Z),T++;else if(3===Z.type){let aa=Z.character.toString();T++;let ia=Z.JXa;for(;T<Q.length;T++){var X=Q.J(T);if(3===X.type&&Y.A2o(Z,X,S))aa+=X.character,X.JXa&&(ia=!0);else break}Z=new O.a(null,Z.source,Z.wk,Z.Rg,Z.runId,Z.yL,aa,Z.gvb,!0,ia,Z.Rfa,Z.cLa,Z.zZa,Z.iA,Z.Xu);P.add(Z)}}y.a.instance.Ua(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
P.Yr());return P}static A2o(Q,S,P){return Q.runId===S.runId&&Q.yL.equals(S.yL)&&(Q.Rfa===S.Rfa||Q.cLa===S.cLa)&&Q.iA.$B(S.iA)&&(!P||!!Q.Xu&&Q.Xu.equals(S.Xu))}static YWo(Q,S,P,T,Z,X,aa,ia,wa,ma,na,Fa,Qa,ya,ta,Aa){Q.setPropertyString(P.Fm,f.a.Un,Z);Q.setPropertyUint32(P.Fm,a.a.Yc,T);Q.setPropertyUint32s(P.Fm,a.a.Kq,X);Q.setPropertyUint32s(P.Fm,a.a.Nt,aa);Q.setPropertyObjectIds(P.Fm,f.a.Vn,wa);Q.hasProperty(P.Fm,a.a.Tj)&&Q.setPropertyUint32(P.Fm,a.a.Tj,Y.Tem());S&&S(7)&&Q.setPropertyObjectIds(P.Fm,
a.a.Fw,Aa);T=!1;for(Z=0;Z<ma.length;Z++)if(ma.J(Z)){T=!0;break}T&&Q.setPropertyBools(P.Fm,a.a.ccg,ma);Y.Pil(S,Q,P,na,Fa,Qa,ya);Y.Qil(Q,P,ta);P.XM(f.a.Un);P.XM(a.a.Yc);P.XM(a.a.Kq);P.XM(a.a.Nt);P.XM(f.a.Vn);P.XM(a.a.ccg);P.XM(f.a.zn);P.XM(f.a.Yyb);P.XM(a.a.uWa);P.XM(a.a.xNa);P.XM(f.a.dDa);P.XM(a.a.Fw);Q.hasProperty(P.Fm,a.a.Tj)&&P.XM(a.a.Tj);0<ia.length?Q.setPropertyUint32s(P.Fm,f.a.zn,ia):P.Fm.removeProperty(f.a.zn)}static Pil(Q,S,P,T,Z,X,aa){if(Q(97)){Q=T.contains(!0,(ia,wa)=>wa);Y.BAg(S,P,f.a.dDa,
Q?T:null);Y.BAg(S,P,f.a.Yyb,Y.BGj(T,Z));Y.BAg(S,P,a.a.uWa,Y.BGj(T,X));T=!1;for(Z=0;Z<aa.length;Z++)0!==aa.J(Z)&&(T=!0);T?S.setPropertyUint32s(P.Fm,a.a.xNa,aa):P.Fm.removeProperty(a.a.xNa)}}static Qil(Q,S,P){const T=aa=>aa;var Z=Object(z.a)(Q,Q.setPropertyBools,"setPropertyBools");Y.hUa(S,P.Bsb,T,Z,a.a.xLa);Y.hUa(S,P.uob,T,Z,a.a.wka);Y.hUa(S,P.Ocb,T,Z,a.a.wNa);Z=aa=>0<aa.length;var X=Object(z.a)(Q,Q.setPropertyStrings,"setPropertyStrings");Y.hUa(S,P.Asb,Z,X,a.a.yLa);Y.hUa(S,P.tob,Z,X,a.a.KJa);Y.hUa(S,
P.Lwb,Z,X,a.a.lPa);Z=aa=>!!aa;X=Object(z.a)(Q,Q.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");Y.hUa(S,P.Csb,Z,X,a.a.zLa);Y.hUa(S,P.L7a,Z,X,a.a.LJa);Y.hUa(S,P.Nwb,Z,X,a.a.mPa);Z=aa=>!!aa;X=Object(z.a)(Q,Q.$Wo,"setPropertyList");Y.gnf(S,P.cXa,Z,X,l.a.dXa);Y.gnf(S,P.oNb,Z,X,l.a.YUa);Y.gnf(S,P.WXb,Z,X,l.a.z0a);P.Ocb.any(T)?Y.hUa(S,P.Mwb,()=>!0,Object(z.a)(Q,Q.setPropertyObjectIds,"setPropertyObjectIds"),a.a.ZEa):S.Fm.removeProperty(a.a.ZEa)}static BGj(Q,S){const P=new w.a;let T=!1;for(let Z=
0;Z<Q.length;Z++){const X=S.J(Z)&&!Q.J(Z);P.add(X);T=X||T}return T?P:null}static BAg(Q,S,P,T){T?Q.setPropertyBools(S.Fm,P,T):S.Fm.removeProperty(P)}static Tem(){return v.a.VF()}static qDi(Q,S){return Q.runtime.NA.l3(S,Q.runtime.In.J(S)||Q.runtime.sv.get(S))}static Q3c(Q,S,P,T,Z){let X;X=new w.a;const aa=!!P&&P(7),ia=!!P&&P(113);if(Q.runtime.rc.isFeatureEnabled(72)){var wa=Y.hvl(T,aa);var ma=Y.K4h(T,aa);wa.length!==ma.length&&Q.runtime.rc.JF(72)}else wa=Y.K4h(T,aa);ma=0;let na="",Fa=new w.a,Qa=new w.a,
ya=new w.a,ta=new w.a,Aa=new w.a,oa=new w.a,za=new w.a,ja=new w.a,fa=new w.a;const Ca=new N.a;let xa=new w.a;var ua=wa.J(wa.length-1);if(2!==ua.type&&4!==ua.type)return y.a.instance.Ua(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",ua.type),Q.logger.Oi(Object.assign(new M.a,{$j:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",ua.type)})),{returnValue:!1,bqe:X};
var sa=0;for(ua=0;ua<wa.length;ua++){var Ea=wa.J(ua),Ja=null;if(1===Ea.type||3===Ea.type)Ja=Ea,na+=Ja.text;else if(4===Ea.type){Ea=Y.qDi(Q,Ea.wk);Ea=new U.a(Ea);X.add(Ea);continue}Ja?(Fa.add(Ja.runId),Qa.add(Ja.Rg),sa+=Ja.text.length,ya.add(sa),ta.add(Ja.yL),Aa.add(Ja.gvb),oa.add(Ja.JXa),za.add(Ja.Rfa),ja.add(Ja.cLa),fa.add(Ja.zZa),Ca.Bsb.add(Ja.iA.TYm),Ca.uob.add(Ja.iA.vYm),Ca.Ocb.add(Ja.iA.yZm),Ca.Asb.add(Ja.iA.Dsb.author),Ca.tob.add(Ja.iA.vob.author),Ca.Lwb.add(Ja.iA.$ua.author),Ca.Csb.add(Ja.iA.Dsb.Hdd),
Ca.L7a.add(Ja.iA.vob.Hdd),Ca.Nwb.add(Ja.iA.$ua.Hdd),Ca.Mwb.add(Ja.iA.$ua.Cmg),ia&&(Ca.cXa.push(new V.a(!1,"",null,null!=Ja.iA.Dsb.BMa?S.wzg(Ja.iA.Dsb.BMa):null)),Ca.cXa.push(new V.a(!1,"",null,null!=Ja.iA.vob.BMa?S.wzg(Ja.iA.vob.BMa):null)),Ca.cXa.push(new V.a(!1,"",null,null!=Ja.iA.$ua.BMa?S.wzg(Ja.iA.$ua.BMa):null))),aa&&xa.add(Ja.Xu)):Fa.length||(Fa.add(0),Qa.add(0),ya.add(0),ta.add(u.a.nil),Aa.add(!1),oa.add(!1),za.add(!1),ja.add(!1),fa.add(0),Ca.Bsb.add(!1),Ca.uob.add(!1),Ca.Ocb.add(!1),Ca.Asb.add(""),
Ca.tob.add(""),Ca.Lwb.add(""),Ca.Csb.add(0),Ca.L7a.add(0),Ca.Nwb.add(0),Ca.Mwb.add(u.a.nil),ia&&(Ca.cXa.push(new V.a(!1,"",null,null)),Ca.oNb.push(new V.a(!1,"",null,null)),Ca.WXb.push(new V.a(!1,"",null,null))));if(2===Ea.type){sa=Ea;Ea=sa.Yc;ya.dI(ya.length-1);Ja=Z.J(ma);if(!Ja)return y.a.instance.Ua(17044307,1,2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",
ma,Z.length,T.length,ua,wa.length),Q.logger.Oi(Object.assign(new M.a,{$j:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),y.a.instance.foa(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",Z.Yr()),y.a.instance.foa(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",T.Yr()),y.a.instance.foa(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",wa.Yr()),{returnValue:!1,bqe:X};if(Ja=Y.qDi(Q,Ja))Ja=new U.a(Ja.WO()),Y.YWo(S,P,Ja,sa.Yc,
na,Fa,Qa,ya,ta,Aa,oa,za,ja,fa,Ca,xa),X.add(Ja);y.a.instance.Ua(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",sa.wk,Ea,Fa.Yr(),Qa.Yr(),ya.Yr(),oa.Yr(),za.Yr(),ja.Yr(),ta.Yr(),"",fa.Yr());ma++;na="";Fa=new w.a;Qa=new w.a;ya=new w.a;ta=new w.a;Aa=new w.a;oa=new w.a;za=new w.a;ja=new w.a;fa=new w.a;Ca.reset();sa=0;xa=
new w.a}}return{returnValue:!0,bqe:X}}static bGo(Q,S){const P=Q.runtime.Yq.J(A.a.$N),T=S.getPropertyObjectIds(P.Fm,a.a.W4);for(let Z=0;Z<T.length;Z++)Q.runtime.Yq.remove(T.J(Z));S.setPropertyObjectIds(P.Fm,a.a.W4,new w.a);S.setPropertyString(P.Fm,a.a.I0a,u.a.nil.toString());P.XM(a.a.W4);P.XM(a.a.I0a)}static o8m(Q,S){if(Q.runtime.Yq.mb(A.a.$N))return null;const P=new U.a(Q.runtime.In.J(A.a.$N).WO());S.setPropertyString(P.Fm,a.a.I0a,Q.output.XL.last().id.toString());S.setPropertyObjectIds(P.Fm,a.a.W4,
new w.a);P.XM(a.a.W4);P.XM(a.a.I0a);Q.runtime.Yq.Z(A.a.$N,P);return P}static RLf(Q){const S=new w.a;Q.forEach(P=>{S.add(P.id);return!0});return S}static brc(Q,S,P,T){let Z=0;P.forEach(X=>{H.a(X,S+Z++,1);X.yc===m.a.paragraphNode&&Q.getPropertyObjectIds(X,f.a.Vn).forEach(aa=>{T.add(aa);return!0});return!0})}static RCn(Q,S){const P=new x.a;let T=0;S.forEach(Z=>{if(P.contains(Z))return!0;P.add(Z);if(({index:T}=Y.v6f("BaseFormatting_",T,Z,X=>Q.runtime.In.J(X))).returnValue||({index:T}=Y.v6f("FavoredFormatting_",
T,Z,X=>Q.runtime.NA.J(X))).returnValue||({index:T}=Y.v6f("ConflictingFormatting_",T,Z,X=>Q.runtime.sv.J(X))).returnValue)return!0;T++;return!0})}static v6f(Q,S,P,T){if(P=T(P))if(H.a(P,Q+S,1),P.yc===m.a.H_a)return S++,{returnValue:!0,index:S};return{returnValue:!1,index:S}}static kzf(Q){return!!Q.runtime.In.J(A.a.$N)}static hUa(Q,S,P,T,Z){S.any(P)?(T(Q.Fm,Z,S),Q.XM(Z)):Q.Fm.removeProperty(Z)}static gnf(Q,S,P,T,Z){S.some(P)?(T(Q.Fm,Z,S),Q.XM(Z)):Q.Fm.removeProperty(Z)}static zPj(Q,S){const P=new w.a;
P.add(0);const T=Q?Q.length:0;for(let Z=0;Z<T;Z++)P.insert(Z+1,Q.sg(Z));P.insert(P.length,S);return P}}Object(G.a)(Y,"ParagraphMergeUtils",null,[])},1663:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);var m=d(233);class f{constructor(a,l,w){this.Bn=null;this.Kk=a;this.source=l;this.wk=w}get type(){return this.Kk}get Reb(){return!1}get Bjn(){return 1===(this.source&1)}get Cjn(){return 2===(this.source&2)}get Djn(){return 4===(this.source&4)}V7(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",
this.ajm(),this.Bjc())}ajm(){let a="";this.Bjn&&(a+="Base");this.Cjn&&(a+="FavoredUpdate");this.Djn&&(a+="UnfavoredUpdate");return a}Bjc(){return""}$B(a){return this.type===a.type}wqd(){const a=new m.a;a.add(this);return a}get length(){return 0}}Object(G.a)(f,"AMergeBlock",null,[95,96])},1664:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(1663);class m extends d.a{constructor(f,a,l){super(2,f,a);this.Yc=l}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),
this.Yc,this.wk)}Bjc(){return"Eop"}clone(){return new m(this.source,this.wk,this.Yc)}$B(f,a,l,w=!1,y=!0){return super.$B(f,a,l,w)?y?f.Yc===this.Yc:f.wk===this.wk&&f.Yc===this.Yc:!1}get length(){return 1}}Object(G.a)(m,"EopMergeBlock",d.a,[])},1665:function(G,J,d){d.d(J,"a",function(){return f});G=d(0);var m=d(381);class f{constructor(){this.detail=new m.a}}Object(G.a)(f,"AMergeFailureDetail",null,[1070])},1666:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(1612);class m extends d.a{constructor(){super()}get tfa(){return"ParagraphMerge"}}
Object(G.a)(m,"ParagraphMergeFailureDetail",d.a,[])},1667:function(G,J,d){d.d(J,"b",function(){return w});d.d(J,"a",function(){return v});var m=d(233),f=d(381),a=d(651),l=d(1823);const w=(x,z,A)=>{const D=y(x,z,A);let F=0,I=0,H=0,N=new l.a;const M=new m.a;for(let U=0;U<D.length;U++){const O=D.sg(U+1);N.HSd(x.sg(F));N.JSd(z.sg(I));N.NSd(A.sg(H));F++;I++;for(H++;F<x.length&&(!O||!O.equals(x.sg(F)));)N.HSd(x.sg(F)),F++;for(;I<z.length&&(!O||!O.equals(z.sg(I)));)N.JSd(z.sg(I)),I++;for(;H<A.length&&(!O||
!O.equals(A.sg(H)));)N.NSd(A.sg(H)),H++;M.add(N);N=new l.a}for(;F<x.length;)N.HSd(x.sg(F)),F++;for(;I<z.length;)N.JSd(z.sg(I)),I++;for(;H<A.length;)N.NSd(A.sg(H)),H++;N.isEmpty||M.add(N);return M},y=(x,z,A)=>{const D=new m.a,F=z.BS(),I=A.BS();x.forEach(H=>{F.contains(H)&&I.contains(H)&&D.add(H);return!0});return D},v=(x,z,A)=>{x=x||new m.a;z=z||new m.a;A=A||new m.a;const D=new m.a,F=new f.a(0),I=new a.a;for(var H=0;H<x.length;H++){var N=x.sg(H);F.Z(N,H)}for(x=H=0;H<z.length&&x<A.length;){N=z.sg(H);
let M=A.sg(x),U=F.l3(N,-1),O=F.l3(M,-1);-1===U?(u(I,D,N),H++):-1===O?(u(I,D,M),x++):U===O?(u(I,D,N),H++,x++):U<O?H++:x++}for(;H<z.length;H++)N=z.sg(H),-1===F.l3(N,-1)&&u(I,D,N);for(;x<A.length;x++)z=A.sg(x),-1===F.l3(z,-1)&&u(I,D,z);return D},u=(x,z,A)=>{x.contains(A)||(z.add(A),x.add(A))}},1668:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(1612);class m extends d.a{constructor(){super()}get tfa(){return"RdOpLcs"}}Object(G.a)(m,"ReducedOpsLcsFailureDetail",d.a,[])},1675:function(G,J,
d){G=d(0);class m{constructor(){this.hsd=this.V7c=null;this.F8f=this.score=this.Ycd=0}Tjg(D,F,I){this.score=D.J(F);++F;this.V7c=D.J(F)?I.Jsa(D.J(F)):null;++F;this.hsd=D.J(F)?I.Jsa(D.J(F)):null;++F;this.Ycd=D.J(F);++F;this.F8f=D.J(F);++F;return F}}Object(G.a)(m,"TokenStringGeneratorInit",null,[]);class f{constructor(D,F,I,H,N){this.Qpb=D;this.count=F;this.R3d=I;this.lR=H;this.depth=N}}Object(G.a)(f,"ErrorTolerantTrieMatch",null,[]);var a=d(1747),l=d(1842);class w{constructor(D=null,F=0,I=0,H=0){this.eRk=
D||new l.a;this.$Aa=F;this.lR=I;this.depth=H}get p9(){return this.eRk}getKey(){return this.p9.gz.toString()+":"+this.$Aa.toString()}}Object(G.a)(w,"TrieBookmark",null,[]);class y{constructor(D,F){this.sYa=D;this.J7f=F}xGn(D){if(null==D)throw Error.argumentNull("prefix");let F={};var I=F[""]=new w;this.bbe(I,F);for(I=0;I<D.length;++I){const H=D.charCodeAt(I),N={};for(let M in F)this.G3k(H,F[M],N);F=N}return this.dnp(F)}bbe(D,F){if(!(D.lR>=this.J7f)&&(D=new w(a.a.Npf(D.p9),D.$Aa,D.lR+1,D.depth),D.p9.uH&
a.a.mgb&&(D.$Aa+=1),this.sYa.$1b(D.p9))){D.depth+=1;let I=!0;for(;I;)y.qFe(D,F),this.bbe(D,F),D.$Aa+=this.sYa.Qjc(D.p9,!0)+(D.p9.uH&a.a.mgb?1:0),I=this.sYa.Dsd(D.p9)}}G3k(D,F,I){F.lR+1<=this.J7f&&(F.lR+=1,y.qFe(F,I),--F.lR);F.p9.uH&a.a.mgb&&(F.$Aa+=1);if(this.sYa.$1b(F.p9)){F.depth+=1;let H=!0;for(;H;)F.p9.j3b===D?(y.qFe(F,I),this.bbe(F,I)):F.lR+1<=this.J7f&&(F.lR+=1,y.qFe(F,I),this.bbe(F,I),--F.lR),F.$Aa+=this.sYa.Qjc(F.p9,!0)+(F.p9.uH&a.a.mgb?1:0),H=this.sYa.Dsd(F.p9)}}dnp(D){const F=[];for(var I in D){const H=
D[I];if(!H.p9.gz)continue;const N=!!(H.p9.uH&a.a.mgb),M=this.sYa.Qjc(H.p9,!1)+(N?1:0);Array.add(F,new f(H.$Aa,M,N,H.lR,H.depth))}F.sort((H,N)=>{let M=H.Qpb-N.Qpb;return M||(M=-(H.count-N.count))?M:M=H.depth-N.depth});if(2>F.length)return F;D=[];for(I=0;I<F.length;)I+=y.E2j(I,F,D);return D}static qFe(D,F){const I=D.getKey();I in F?(F=F[I],F.lR=Math.min(F.lR,D.lR)):F[I]=new w(a.a.Npf(D.p9),D.$Aa,D.lR,D.depth)}static E2j(D,F,I){const H=F[D];let N=H.Qpb;const M=N+H.count;let U=1,O=H.R3d;for(;D+U<F.length&&
F[D+U].Qpb<M;){const V=F[D+U];V.Qpb>N&&(Array.add(I,new f(N,V.Qpb-N,O,H.lR,H.depth)),O=!1);U+=y.E2j(D+U,F,I);N=V.Qpb+V.count}N<M&&Array.add(I,new f(N,M-N,O,H.lR,H.depth));return U}}Object(G.a)(y,"ErrorTolerantTrieLookupEngine",null,[1744]);class v extends m{constructor(D,F,I){super();this.bRi=this.zpj=!1;this.Jli=null;if(D){var H=0;try{H=this.Tjg(D,H,F);this.zpj=1===D.J(H);++H;this.bRi=1===D.J(H);++H;const N=D.J(H);this.Jli=this.y9n(I,N)}catch(N){throw Error.argument("initData");}}}y9n(D,F){return new y(D,
F)}}Object(G.a)(v,"FuzzyMatchTokenStringGeneratorInit",m,[]);class u extends m{constructor(D,F){super();this.query=this.name=null;if(D){this.annotations=F.annotations;var I=0;try{I=this.Tjg(D,I,F),this.name=F.kD(D.J(I)),++I,this.query=F.lN(D.J(I))}catch(H){throw Error.argument("initData");}}}}Object(G.a)(u,"QueryTokenStringGeneratorInit",m,[]);class x extends m{constructor(D,F){super();if(D)try{this.Tjg(D,0,F)}catch(I){throw Error.argument("initData");}}}Object(G.a)(x,"SurfaceStringTokenStringGeneratorInit",
m,[]);var z=d(1595);d.d(J,"a",function(){return A});class A{constructor(D){this.z7f=D}get V7c(){return this.z7f.V7c}get hsd(){return this.z7f.hsd}get Ycd(){return this.z7f.Ycd}static create(D,F,I){const {SurfaceStringTokenStringGenerator:H}=d(2010),{QueryTokenStringGenerator:N}=d(2011),{FuzzyMatchTokenStringGenerator:M}=d(2012);let U=0;try{if(D.J(U)!==A.fLb)throw Error.argument("initData","Input does not represent a token string generator");++U;const O=D.J(U);++U;const V=new z.a;V.cqb(D,U,D.count-
U);switch(O){case H.DUc:return new H(new x(V,F));case N.DUc:return new N(new u(V,F));case M.DUc:return new M(new v(V,F,I));default:throw Error.argument("initData");}}catch(O){throw Error.argument("initData");}}static fPh(D,F,I,H,N,M){D=D.klp.getId(F,null);if(0>D)return++M,M;A.gPh(D,I,H,N);return M}static gPh(D,F,I,H){Array.add(H.$Fg,D);Array.add(H.MYj,F);++H.eAc[I]}}A.fLb=1099767983;Object(G.a)(A,"TokenStringGenerator",null,[1708])},1710:function(G,J,d){d.d(J,"a",function(){return a});G=d(0);var m=
d(233);J=d(1663);var f=d(1625);class a extends J.a{constructor(l,w,y){super(l,w,y)}uap(l){let w;w=null;if(!this.text||!this.Reb||0>=l||l>=this.length)return{returnValue:!1,dXj:w};w=new m.a;const y=this.clone();y.Yod(f.a.izb(this.text,0,l));const v=this.clone();v.Yod(f.a.izb(this.text,l,this.length-l));w.add(y);w.add(v);return{returnValue:!0,dXj:w}}V7(){return!0}get length(){return this.text.length}}Object(G.a)(a,"ATextMergeBlock",J.a,[])},1711:function(G,J,d){d.d(J,"a",function(){return a});G=d(0);
var m=d(63),f=d(192);class a{Aif(l,w){return l+("[Block: "+w+"] ")}static Xnm(l,w,y,v,u,x,z){const {ParagraphMergeBlockCreator:A}=d(2093),{TableMergeBlockCreator:D}=d(2098);if(w.yc===m.a.paragraphNode)return new A(l,w,y,u,x,v(7),z,v(113));if(w.yc===m.a.xp)return new D(w,y);f.a.instance.Ua(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",w.yc);return null}}Object(G.a)(a,"MergeBlockCreator",null,[])},1712:function(G,J,d){d.d(J,"a",function(){return w});G=d(0);var m=d(63),
f=d(5),a=d(54);J=d(1710);var l=d(1631);class w extends J.a{constructor(y,v,u,x,z,A,D,F,I,H,N,M,U,O){super(v,u,x);this.Rg=z;this.runId=A;this.gvb=F;this.nwk=D;this.GKe=y;this.JXa=I;this.Rfa=H;this.cLa=N;this.zZa=M;this.iA=U;this.Xu=O}get WSc(){return this.GKe}get yL(){return this.nwk}get WOb(){return this.WSc(this.yL)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.Rg,this.runId,this.gvb,
this.wk,this.yL.toString(),this.Xu?this.Xu.toString():"NULL")}$B(y,v,u,x=!1){if(!super.$B(y,v,u,x))return!1;if(x)return!0;if(!this.iA.$B(y.iA)||this.Xu&&!this.Xu.equals(y.Xu))return!1;if(this.yL.equals(y.yL)||this.yL.equals(a.a.nil)||y.yL.equals(a.a.nil))return!0;y=new l.a(this.WOb,y.WOb);v=v.H$h(this.WOb,u);return y.h9c(v.Hre)?!1:!0}get Zdn(){return this.V7()&&"\ufffc"===this.text&&this.WOb?this.WOb.hasProperty(f.a.mt)||this.WOb.yc!==m.a.swb?!0:!1:!1}}Object(G.a)(w,"AUserRunMergeBlock",J.a,[])},
1713:function(G,J,d){d.d(J,"a",function(){return f});var m=d(192);const f=(a,l,w=4)=>{a?m.a.instance.foa(4273285,w,4,l,a.bAc()):m.a.instance.Ua(4293845,w,1,l,"{0}: Node was null.",l)}},1714:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(1569);class m extends d.a{constructor(f,a,l,w,y=null){super(f,a,y,null,l);this.id=w}}Object(G.a)(m,"TryQueryResultBinding",d.a,[])},1715:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f){this.Bb=f}get Tbb(){return this.Bb.Tbb}get Yep(){return 4!==
this.Bb.style}get $ep(){return!0}get trie(){return this.Bb.trie}getId(f,a){if(!this.Yep)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Bb.style){case 0:return this.vvm(f,a);default:throw Error.notImplemented();}}kD(f){if(!this.$ep)throw Error.invalidOperation("String lookup not supported on this string table");if(0>f||f>=this.Tbb)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Bb.style){case 0:return this.QLm(f);case 4:return this.PLm(f);
default:throw Error.notImplemented();}}vvm(f,a){f=this.Bb.trie.Uaj(f,0,f.length,a);if(!f.succeeded)return-1;if(0>f.uAc||f.uAc>=this.Bb.Tbb)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Bb.Esd?this.Bb.Kjd.hA(this.Bb.Esd+4*f.uAc,4):f.uAc}QLm(f){if(this.Bb.Esd){let a=0;for(;a<this.Bb.Tbb&&this.Bb.Kjd.hA(this.Bb.Esd+4*a,4)!==f;++a);if(a>=this.Bb.Tbb)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Bb.trie.UHi(a)}return this.Bb.trie.UHi(f)}PLm(f){const a=
this.Bb.Kjd.hA(this.Bb.JYj+4*f,4);f=this.Bb.Kjd.hA(this.Bb.KYj+4*f,4);if(0>f||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const l=Array(a);for(let w=0;w<a;++w)l[w]=({h2m:f}=this.Uno(f)).returnValue;return String.fromCharCode.apply(null,l)}Uno(f){let a=0;for(let l=0;3>l;++l){const w=this.Bb.Kjd.J(this.Bb.k1h+f)^182;++f;a|=(w&127)<<7*l;if(!(w&128))break}return{returnValue:a,h2m:f}}}Object(G.a)(m,"StringTable",null,[1688])},1716:function(G,J,d){d.d(J,"a",function(){return f});
G=d(0);var m=d(1747);class f{constructor(a){this.trie=null;this.k1h=this.JYj=this.KYj=this.Esd=0;if(a){this.Kjd=a;var l=0;if(a.hA(l,4)!==f.fLb)throw Error.argument("bytes","Input does not represent a string table");l+=4;this.Tbb=a.hA(l,4);l+=4;this.style=a.hA(l,4);l+=4;switch(this.style){case 0:const w=1===a.hA(l,4);l+=4;w||(this.Esd=l,l+=4*this.Tbb);a.hA(l,4);this.trie=this.$9n(a,l+4);break;case 4:this.KYj=l;this.JYj=l+=4*this.Tbb;l+=4*this.Tbb;a.hA(l,4);this.k1h=l+4;break;default:throw Error.argument("bytes");
}}}$9n(a,l){return new m.a(a,l)}}f.fLb=1025118440;Object(G.a)(f,"StringTableInit",null,[])},1717:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);var m;(function(f){f[f.Bdk=0]="Answer";f[f.Definition=1]="Definition";f[f.Entity=2]="Entity";f[f.Ykk=3]="WolframAnswer";f[f.Jdk=4]="Assistance";f[f.Command=5]="Command";f[f.Document=6]="Document";f[f.gkk=7]="TryQuery";f[f.VHe=8]="FindInDocument";f[f.gNp=9]="HelpAction";f[f.xgk=10]="Insights";f[f.People=11]="People";f[f.Image=12]="Image";f[f.PMp=13]=
"FirstRunResult";f[f.EOp=14]="NoCommandsFoundResult";f[f.Wjk=15]="TestResult";f[f.SKp=16]="AppsForOffice_Installed";f[f.UKp=17]="AppsForOffice_Recommandation";f[f.TKp=18]="AppsForOffice_Query";f[f.JOp=19]="Notes_Onenote";f[f.KOp=20]="Notes_Samsung";f[f.LOp=21]="Notes_Sticky";f[f.Wgk=22]="Learning";f[f.Feedback=23]="Feedback";f[f.Template=24]="Template";f[f.odk=25]="ActionAI";f[f.pdk=26]="ActionAICommand";f[f.xdk=27]="Addin";f[f.cik=28]="OfficeScript";f[f.ydk=29]="AddinStoreEntry";f[f.$Mp=30]="GenerateSlides";
f[f.wjk=31]="SummarizeDeck";f[f.Unknown=32]="Unknown"})(m||(m={}));Object(G.b)("ResultType",m)},1743:function(G,J,d){G=d(0);var m=d(5),f=d(651),a=d(192),l=d(233),w=d(54),y=d(381),v=d(84),u;(function(Oa){Oa[Oa.none=0]="none";Oa[Oa.Bdd=1]="mergeConflict";Oa[Oa.SVp=2]="containerBaseIdValidationFailure";Oa[Oa.m_p=3]="failedToApplyHints";Oa[Oa.jGe=4]="validateUpdateHintsAreComplete";Oa[Oa.other=5]="other"})(u||(u={}));Object(G.b)("ParagraphMergeUsingHintsFailureReason",u);var x=d(1134),z=d(257),A=d(972);
const D=Oa=>{const Xa=new l.a;Oa.forEach(ab=>{Xa.add(ab);return!0});return Xa};var F=d(1664),I=d(1667),H=d(1668);const N=(Oa,Xa)=>{if(Oa.length!==Xa.length)return!1;for(let ab=0;ab<Oa.length;ab++)Oa.J(ab).Bn=Xa.J(ab),Xa.J(ab).Bn=Oa.J(ab);return!0},M=(Oa,Xa,ab)=>{let cb,ib,Ub;cb=0;ib=!1;Ub=0;var lb;if(!({idx:lb}=Q(Oa,Xa)).returnValue)return a.a.instance.Ua(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",Xa,Oa.Yr()),{returnValue:!1,o5c:cb,
dvb:ib,fed:Ub};if(!ab&&2===Oa.J(lb).type)return{returnValue:!0,o5c:lb,dvb:ib,fed:Ub};if(!Oa.J(lb).V7())return a.a.instance.Ua(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",lb,ab,Oa.Yr()),{returnValue:!1,o5c:cb,dvb:ib,fed:Ub};let Qb=!1,fc=0;for(;lb<Oa.length&&Oa.J(lb).wk.equals(Xa);lb++){if(ab===fc){Qb=!0;break}if(ab>fc&&ab<fc+Oa.J(lb).length){ib=Qb=!0;Ub=ab-fc;break}fc+=Oa.J(lb).length}Qb||ab!==fc||(Qb=!0);Qb&&(cb=lb);return{returnValue:Qb,
o5c:cb,dvb:ib,fed:Ub}},U=(Oa,Xa,ab)=>{let cb,ib,Ub;Ub=ib=0;cb=!1;let lb=0,Qb=!1;for(;ib<Oa.length;ib++){if(Xa===lb){Qb=!0;break}if(Xa>lb&&Xa<lb+Oa.J(ib).length){cb=Qb=!0;Ub=Xa-lb;break}lb+=Oa.J(ib).length}Qb||Xa!==lb||(Qb=!0);Qb||(Oa=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Oa.length,lb,Xa),a.a.instance.Ua(573178201,1,2,Oa),ab.Oi(Object.assign(new H.a,{eventId:"8k6fz",info:Oa})));return{returnValue:Qb,dvb:cb,vWh:ib,uWh:Ub}},O=(Oa,Xa,ab)=>{let cb;
if(Oa.J(Xa).V7()&&({dXj:cb}=Oa.J(Xa).uap(ab)).returnValue)return Oa.pD(Xa+1,cb),Oa.dI(Xa),!0;a.a.instance.Ua(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",Xa,ab,Oa.Yr());return!1},V=(Oa,Xa,ab)=>{let cb,ib;if(!({o5c:ab,dvb:ib,fed:cb}=M(Oa,Xa,ab)).returnValue)return{returnValue:!1,index:0};if(!ib)return{returnValue:!0,index:ab};if(O(Oa,ab,cb))return{returnValue:!0,index:ab+1};a.a.instance.Ua(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",
Xa,cb,Oa.Yr());return{returnValue:!1,index:0}},Y=(Oa,Xa,ab)=>{let cb;if(!({dvb:cb,vWh:Xa,uWh:ab}=U(Oa,Xa,ab)).returnValue)return{returnValue:!1,index:0};if(!cb)return{returnValue:!0,index:Xa};if(O(Oa,Xa,ab))return{returnValue:!0,index:Xa+1};a.a.instance.Ua(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",ab,Oa.Yr());return{returnValue:!1,index:0}},Q=(Oa,Xa)=>{let ab;ab=0;for(let cb=0;cb<Oa.length;cb++)if(Oa.J(cb).wk.equals(Xa))return ab=cb,{returnValue:!0,
idx:ab};a.a.instance.Ua(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",Xa,Oa.Yr());return{returnValue:!1,idx:ab}},S=(Oa,Xa)=>{let ab;ab=-1;for(let cb=Xa;cb<Oa.length;cb++)if(2===Oa.J(cb).type)return ab=cb,{returnValue:!0,Nka:ab};a.a.instance.Ua(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",Xa,Oa.Yr());return{returnValue:!1,Nka:ab}},P=(Oa,Xa,ab)=>{let cb;cb=-1;for(let ib=ab;ib<Oa.length;ib++)if(2===
Oa.J(ib).type&&Oa.J(ib).wk.equals(Xa))return cb=ib,{returnValue:!0,Nka:cb};a.a.instance.Ua(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",Xa,ab,Oa.Yr());return{returnValue:!1,Nka:cb}},T=(Oa,Xa)=>{let ab;ab=0;var cb;if(!({idx:cb}=Q(Oa,Xa)).returnValue)return a.a.instance.Ua(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Xa,Oa),{returnValue:!1,length:ab};for(;cb<Oa.length;cb++)if(6!==Oa.J(cb).type){if(2===Oa.J(cb).type)return{returnValue:!0,
length:ab};a.a.instance.shipAssertTag(17342617,1,Oa.J(cb).V7(),"We found something other than text with type "+Oa.J(cb).type);a.a.instance.shipAssertTag(17877021,1,Oa.J(cb).wk.equals(Xa),"Unexpected GraphNodeId {0} for ParaId {1}",Oa.J(cb).wk,Xa);ab+=Oa.J(cb).length}a.a.instance.Ua(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Xa,Oa);return{returnValue:!1,length:ab}},Z=Oa=>{const Xa=new l.a;for(let ab=0;ab<Oa.length;ab++)Xa.add(Oa.J(ab).clone());return Xa};var X=d(1666),aa=d(1625);
class ia{constructor(Oa,Xa,ab=null,cb=null){this.wk=Oa;this.type=Xa;this.text=ab;this.Yc=cb}isEqual(Oa){return Oa.wk.equals(this.wk)&&this.type===Oa.type&&this.Yc===Oa.Yc&&aa.a.oUh(this.text,Oa.text)}toString(){let Oa=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.wk,this.Yc,this.type);this.text&&(Oa+=String.format(" [TextLength: {0}]",this.text.length));return Oa}}Object(G.a)(ia,"MergeBlockValidationState",null,[]);var wa=d(122),ma=d(1021),na=d(939),Fa=d(582),Qa=d(505),
ya=d(1020),ta=d(938),Aa=d(1612),oa=d(1831),za;(function(Oa){Oa[Oa.Pj=1]="base";Oa[Oa.z_p=2]="favoredUpdate";Oa[Oa.qoq=4]="unfavoredUpdate";Oa[Oa.min=1]="min";Oa[Oa.max=7]="max"})(za||(za={}));Object(G.b)("MergeBlockSource",za);class ja{constructor(Oa,Xa,ab,cb){this.Rg=Oa;this.cp=Xa;this.BTd=ab;this.Vtd=cb}}Object(G.a)(ja,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var fa=d(1663);class Ca extends fa.a{constructor(Oa,Xa){super(6,Oa,Xa);this.Yc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",
super.toString(),this.wk)}Bjc(){return"Selection"}clone(){return new Ca(this.source,this.wk)}$B(){return!1}get length(){return 0}}Object(G.a)(Ca,"SelectionMergeBlock",fa.a,[]);var xa;(function(Oa){Oa[Oa.success=0]="success";Oa[Oa.Rjq=1]="selfSplit";Oa[Oa.Pcq=2]="noSecondaryBlockToSplit";Oa[Oa.ooq=3]="unexpected"})(xa||(xa={}));Object(G.b)("SplitTwinListResult",xa);var ua=d(1710);class sa extends ua.a{constructor(Oa,Xa,ab,cb){super(5,Oa,Xa);this._text=null;this.Yod(ab);this.IRk=cb}get text(){return this._text}Yod(Oa){this._text=
Oa}get ztd(){return this.IRk}clone(){return new sa(this.source,this.wk,this.text,this.ztd)}get Reb(){return this.text&&this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(G.a)(sa,"UpdateHintTextMergeBlock",ua.a,[]);class Ea{constructor(Oa,Xa,ab,cb){this.Z5=!1;this.Bkb=new y.a;this.Zd=Oa;this.CJh=cb;this.yah=ab;this._base=Xa;this.TPe=Z(Xa);if(!N(this.Pj,this.$e))throw a.a.instance.Ua(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),Oa.logger.Oi(Object.assign(new Aa.a,
{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get Pj(){return this._base}get $e(){return this.TPe}get Bdd(){return this.Z5}rjf(Oa,Xa){switch(Oa.type){case 1:return this.P7k(Oa,Xa);case 2:return this.Qif(Oa,Xa);case 3:return this.N8k(Oa,Xa);case 4:return this.i8k(Oa);case 5:return this.h7k(Oa,Xa);case 6:return this.Oif(Oa);default:return!1}}qjf(Oa,Xa){switch(Oa.type){case 1:return this.Uif(Oa,Xa);case 2:return this.Pif(Oa,Xa);case 3:return this.M8k(Oa,Xa);case 4:return this.h8k(Oa);
case 5:return this.g7k(Oa,Xa);case 6:return this.Nif(Oa);default:return{returnValue:!1,tv:null}}}P7k(Oa,Xa){let ab;const cb=({Ela:ab}=this.LOa(Oa.Rg,Xa,!1,Oa.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==cb&&1!==cb)return 3!==cb&&(a.a.instance.Ua(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",za[Xa],xa[cb]),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.Z5=
!1;Xa=new sa(Xa,Oa.Rg,Oa.text,Oa.id);this.SVf(Oa,ab,Xa);return!0}Qif(Oa,Xa){let ab,cb=({Ela:ab}=this.LOa(Oa.Rg,Xa,!1,Oa.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;if(0!==cb&&1!==cb)return 3!==cb&&(a.a.instance.Ua(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",za[Xa],xa[cb]),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let ib;({Ela:ib,returnValue:cb}=
this.LOa(Oa.Rg,Xa,!1,Oa.cp+Oa.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==cb&&1!==cb)return 3!==cb&&(a.a.instance.Ua(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",za[Xa],xa[cb]),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.Z5=!1;this.Hwf(Oa,ab,ib);return!0}N8k(Oa,Xa){let ab;const cb=({dUf:ab}=this.wAi(Oa,Xa,!1)).returnValue;if(0!==cb&&1!==cb)return 3!==
cb&&(a.a.instance.Ua(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",za[Xa],xa[cb]),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),!1;this.Z5=!1;Xa=new F.a(Xa,Oa.Uu,Oa.Xya);this.SVf(Oa,ab,Xa);return!0}i8k(Oa){let Xa;if(!({hbe:Xa}=this.xAi(Oa,this.$e,"Derived")).returnValue)return!1;this.Hwf(Oa,Xa,Xa+1);return!0}h7k(Oa,Xa){let ab;if(!({U8f:Xa,cUf:ab}=this.rCi(Oa,!1,Xa)).returnValue)return!1;
this.SVf(Oa,ab,Xa);return!0}Oif(Oa){let Xa;if(!({gbe:Xa}=this.oAi(Oa,this.$e,"Derived")).returnValue)return!1;this.Hwf(Oa,Xa,Xa+1);return!0}yTh(Oa,Xa,ab){const cb=({Ela:Xa}=this.LOa(Oa,ab,!1,Xa,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;if(0!==cb&&1!==cb)return 3!==cb&&(a.a.instance.Ua(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",za[ab],xa[cb]),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",
eventId:"9l2vz"}))),!1;this.Z5=!1;Oa=new Ca(ab,Oa);this.$e.insert(Xa,Oa);return!0}Uif(Oa,Xa){var ab=null;if(Ea.dYi(Oa.text.length))return{returnValue:!1,tv:ab};let cb,ib,Ub;var lb=({Ela:cb,ZBa:ib,lka:Ub}=this.LOa(Oa.Rg,Xa,!0,Oa.cp,!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==lb&&2!==lb)return 3!==lb&&(a.a.instance.Ua(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",za[Xa],xa[lb]),this.Zd.logger.Oi(Object.assign(new oa.a,
{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,tv:ab};this.Z5=!1;({Nka:lb}=S(this.$e,ib));lb=this.$e.J(lb).wk;ab=new sa(Xa,Oa.Rg,Oa.text,Oa.id);Xa=new sa(Xa,lb,Oa.text,Oa.id);ab.Bn=Xa;Xa.Bn=ab;this.Pj.insert(cb,ab);this.$e.insert(ib,Xa);ab=new l.a;ab.add(new Qa.a(lb,Ub,Oa.text,Oa.id,Oa.Iv));return{returnValue:!0,tv:ab}}Pif(Oa,Xa){let ab;ab=null;if(Ea.dYi(Oa.text.length))return{returnValue:!1,tv:ab};let cb;var ib,Ub=({Ela:cb,ZBa:lb,lka:ib}=this.LOa(Oa.Rg,Xa,!0,Oa.cp,!1,
"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==Ub){if(2!==Ub)return 3!==Ub&&(a.a.instance.Ua(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",za[Xa],xa[Ub]),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,tv:ab};var lb=0;for({idx:ib}=Q(this.Pj,Oa.Rg);ib<this.Pj.length&&lb<Oa.cp;ib++)lb+=this.Pj.J(ib).length;lb-=this.Pj.J(ib-1).length;
({ZBa:lb,lka:ib,returnValue:Ub}=this.LOa(Oa.Rg,Xa,!0,lb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Ub)return 3!==Ub&&(a.a.instance.Ua(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",za[Xa],xa[Ub]),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,tv:ab};this.Z5=!1}var Qb,fc;({Ela:Qb,ZBa:fc,lka:Fc,returnValue:Ub}=this.LOa(Oa.Rg,
Xa,!0,Oa.cp+Oa.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==Ub){if(2!==Ub)return 3!==Ub&&(a.a.instance.Ua(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",za[Xa],xa[Ub]),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,tv:ab};var Fc=0;for({idx:fc}=Q(this.Pj,Oa.Rg);fc<this.Pj.length&&Fc<Oa.cp+Oa.text.length;fc++)Fc+=this.Pj.J(fc).length;
({ZBa:fc,lka:Fc,returnValue:Ub}=this.LOa(Oa.Rg,Xa,!0,Fc,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Ub)return 3!==Ub&&(a.a.instance.Ua(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",za[Xa],xa[Ub]),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,tv:ab};this.Z5=!1}Xa="";ab=new l.a;for(--fc;fc>=lb;fc--)if(6!==this.$e.J(fc).type)if(this.$e.J(fc).Bn)Xa=
this.$e.J(fc).text+Xa,this.$e.dI(fc);else{if(5===this.$e.J(fc).type)Ub=Fc-Xa.length;else if(2===this.$e.J(fc).type){if(Ub=0,!({length:Fc}=T(this.$e,this.$e.J(fc).wk)).returnValue)return a.a.instance.Ua(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,tv:ab}}else return a.a.instance.Ua(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),
this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,tv:ab};if(!({Nka:nc}=S(this.$e,fc+1)).returnValue)return a.a.instance.Ua(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,tv:ab};var nc=this.$e.J(nc).wk;ab.add(new Fa.DeleteTextUpdateHint(nc,Ub,Xa));Xa=""}for(--Qb;Qb>=cb;Qb--)this.Pj.dI(Qb);if(!({Nka:nc}=
S(this.$e,lb)).returnValue)return a.a.instance.Ua(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,tv:ab};nc=this.$e.J(nc).wk;Xa&&Xa.length&&ab.add(new Fa.DeleteTextUpdateHint(nc,ib,Xa,Oa.id,Oa.Iv));return{returnValue:!0,tv:ab}}M8k(Oa,Xa){var ab=null;let cb,ib,Ub;var lb=({dUf:cb,jQi:ib,lka:Ub}=this.wAi(Oa,Xa,!0)).returnValue;if(0!==lb)return 3!==lb&&(a.a.instance.Ua(590202207,
1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",za[Xa],xa[lb]),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,tv:ab};var Qb;if(!({Nka:Qb}=S(this.$e,ib)).returnValue)return a.a.instance.Ua(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,tv:ab};lb=this.$e.J(Qb).wk;const fc=this.$e.J(Qb).Yc;let Fc,
nc,zb;({Uu:Qb,kaa:Fc,Xya:nc,Hea:zb}=this.$Am(Oa,Qb));this.d1h(this.$e,Qb,Fc,zb,ib);ab=new F.a(Xa,Oa.Uu,Oa.Xya);Xa=new F.a(Xa,Qb,nc);ab.Bn=Xa;Xa.Bn=ab;this.Pj.insert(cb,ab);this.$e.insert(ib,Xa);ab=new l.a;ab.add(new ta.a(lb,fc,Ub,Qb,nc,Fc,zb,Oa.id,Oa.Iv));return{returnValue:!0,tv:ab}}h8k(Oa){let Xa;Xa=null;let ab,cb;var ib;if(!({hbe:ab}=this.xAi(Oa,this.Pj,"Base")).returnValue)return{returnValue:!1,tv:Xa};if(!this.Pj.J(ab).Bn||!({Nka:cb}=P(this.$e,this.Pj.J(ab).Bn.wk,0)).returnValue)return a.a.instance.Ua(17342619,
1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.Z5=!0,{returnValue:!1,tv:Xa};if(!({Nka:ib}=S(this.$e,cb+1)).returnValue)return a.a.instance.Ua(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",
eventId:"bckc2"})),this.Z5=!0,{returnValue:!1,tv:Xa};let Ub,lb,Qb,fc,Fc,nc;({Fbb:ib,Gbb:Qb,Ubg:Ub,fQn:fc,QPn:lb,RPn:Fc}=this.tom(Oa,cb,ib));if(!({length:nc}=T(this.$e,ib)).returnValue)return{returnValue:!1,tv:Xa};this.c1h(this.$e,ib,Qb,cb);this.$e.dI(cb);this.Pj.dI(ab);Xa=new l.a;Xa.add(new ya.MergeParagraphUpdateHint(Ub,fc,nc,lb,Fc,ib,Qb,Oa.id,Oa.Iv));return{returnValue:!0,tv:Xa}}g7k(Oa,Xa){var ab=null;let cb,ib,Ub;if(!({U8f:Ub,cUf:cb}=this.rCi(Oa,!0,Xa)).returnValue)return{returnValue:!1,tv:ab};
if(!({esb:ib}=this.E3c(this.Pj,this.$e,cb,!0)).returnValue)return a.a.instance.Ua(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,tv:ab};if(0<ib&&2!==this.$e.J(ib-1).type)return a.a.instance.Ua(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.Z5=!0,{returnValue:!1,
tv:ab};let lb;if(!({Uu:lb}=this.$si(ib)).returnValue)return{returnValue:!1,tv:ab};Xa=new F.a(Xa,Oa.Rg,Oa.Yc);ab=Ub;ab.Bn=Xa;Xa.Bn=ab;this.Pj.insert(cb,Ub);this.$e.insert(ib,Xa);ab=new l.a;ab.add(new ma.AddParagraphUpdateHint(Oa.Rg,Oa.Yc,lb,Oa.id,Oa.Iv));return{returnValue:!0,tv:ab}}Nif(Oa){let Xa;Xa=null;let ab;var cb;if(!({gbe:cb}=this.oAi(Oa,this.Pj,"Base")).returnValue)return{returnValue:!1,tv:Xa};if(!this.Pj.J(cb).Bn||!this.Pj.J(cb).Bn.wk.equals(Oa.Rg))return a.a.instance.Ua(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),
this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.Z5=!0,{returnValue:!1,tv:Xa};if(!({esb:ab}=this.E3c(this.Pj,this.$e,cb,!0)).returnValue)return a.a.instance.Ua(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),{returnValue:!1,tv:Xa};if(0<ab&&2!==this.$e.J(ab).type)return a.a.instance.Ua(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.Zd.logger.Oi(Object.assign(new oa.a,
{$j:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.Z5=!0,{returnValue:!1,tv:Xa};const ib=this.$e.J(ab).wk,Ub=this.$e.J(ab).Yc;this.$e.dI(ab);this.Pj.dI(cb);({Uu:cb}=this.$si(ab));0<ab&&6===this.$e.J(ab-1).type&&this.Xco(ab-1,cb);Xa=new l.a;Xa.add(new na.a(ib,Ub,cb,Oa.id,Oa.Iv));return{returnValue:!0,tv:Xa}}xTh(Oa,Xa,ab){let cb;var ib=({Ela:Xa,ZBa:cb}=this.LOa(Oa,ab,!0,Xa,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==ib)return 3!==ib&&(a.a.instance.Ua(590202208,
1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",za[ab],xa[ib]),this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({Nka:ib}=S(this.$e,cb));ib=this.$e.J(ib).wk;Oa=new Ca(ab,Oa);ab=new Ca(ab,ib);Oa.Bn=ab;ab.Bn=Oa;this.Pj.insert(Xa,Oa);this.$e.insert(cb,ab);return!0}tom(Oa,Xa,ab){let cb,ib,Ub;cb=Oa.Fbb.equals(Oa.Rg)?this.$e.J(Xa).wk:this.$e.J(ab).wk;Oa=Oa.Gbb===Oa.Yc?this.$e.J(Xa).Yc:
this.$e.J(ab).Yc;ib=this.$e.J(Xa).wk;Xa=this.$e.J(Xa).Yc;Ub=this.$e.J(ab).wk;ab=this.$e.J(ab).Yc;return{Fbb:cb,Gbb:Oa,Ubg:ib,fQn:Xa,QPn:Ub,RPn:ab}}$Am(Oa,Xa){let ab;var cb=Oa.Rg.equals(Oa.Uu)?Oa.kaa:Oa.Uu;const ib=Oa.Yc===Oa.Xya?Oa.Hea:Oa.Xya;Oa.Rg.equals(Oa.Uu)?ab=this.$e.J(Xa).wk:(ab=cb,cb=this.$e.J(Xa).wk);Oa.Yc===Oa.Xya?(Oa=this.$e.J(Xa).Yc,Xa=ib):(Oa=ib,Xa=this.$e.J(Xa).Yc);return{Uu:ab,kaa:cb,Xya:Oa,Hea:Xa}}e1h(Oa,Xa,ab,cb){for(;cb<Oa.length;cb++){if(!Oa.J(cb).V7()&&6!==Oa.J(cb).type&&2!==Oa.J(cb).type){a.a.instance.shipAssertTag(17311188,
1,!1,"Found merge block of type "+Oa.J(cb).type);break}Oa.J(cb).wk=Xa;if(2===Oa.J(cb).type){Oa.J(cb).Yc=ab;break}}}d1h(Oa,Xa,ab,cb,ib){this.e1h(Oa,ab,cb,ib);Ea.f1h(Oa,Xa,ib)}c1h(Oa,Xa,ab,cb){this.e1h(Oa,Xa,ab,cb+1);Ea.f1h(Oa,Xa,cb)}xAi(Oa,Xa,ab){let cb,ib=-1;if(!({Nka:cb}=P(Xa,Oa.Rg,0)).returnValue)return a.a.instance.Ua(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+ab+"for GraphNodeId "+Oa.Rg),{returnValue:!1,hbe:cb};if(!({Nka:ib}=S(Xa,cb+1)).returnValue||!Xa.J(ib).wk.equals(Oa.kaa))return a.a.instance.Ua(17342623,
1,2,"GetIndicesForMergePara: Failed to find index "+cb+1+" in "+ab+" of length "+Xa.length),{returnValue:!1,hbe:cb};this.c1h(Xa,Oa.Fbb,Oa.Gbb,cb);return{returnValue:!0,hbe:cb}}wAi(Oa,Xa,ab){let cb;const ib=ab?this.Pj:this.$e,Ub=ab?"Base":"Derived",lb=({Ela:Xa,ZBa:ab,lka:cb}=this.LOa(Oa.Rg,Xa,ab,Oa.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===lb||2===lb)return a.a.instance.Ua(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Ub),{returnValue:lb,dUf:Xa,jQi:ab,
lka:cb};this.d1h(ib,Oa.Uu,Oa.kaa,Oa.Hea,Xa);return{returnValue:lb,dUf:Xa,jQi:ab,lka:cb}}oAi(Oa,Xa,ab){return({idx:Oa}=Q(Xa,Oa.Rg)).returnValue?2!==Xa.J(Oa).type?(a.a.instance.Ua(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+ab),{returnValue:!1,gbe:-1}):{returnValue:!0,gbe:Oa}:(a.a.instance.Ua(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+ab),{returnValue:!1,gbe:-1})}Xco(Oa,Xa){var ab=this.$e.J(Oa);if(Xa){let cb;({Nka:cb}=P(this.$e,
Xa,0));ab=ab.clone();ab.wk=Xa;this.$e.dI(Oa);this.$e.insert(cb,ab)}else this.$e.length>Oa&&(this.$e.J(Oa+1).V7()||2===this.$e.J(Oa+1).type)&&(ab.wk=this.$e.J(Oa+1).wk)}rCi(Oa,Xa,ab){var cb=Xa?this.Pj:this.$e;Xa=Xa?"Base":"Derived";ab=new F.a(ab,Oa.Rg,Oa.Yc);if(Oa.Uu){if(!({Nka:cb}=P(cb,Oa.Uu,0)).returnValue)return a.a.instance.Ua(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",Oa.Uu,Xa),{returnValue:!1,U8f:ab,cUf:cb};cb+=1}else cb=0;return{returnValue:!0,
U8f:ab,cUf:cb}}$si(Oa){let Xa;Xa=null;let ab=Oa-1;if(-1===ab)return{returnValue:!0,Uu:Xa};6===this.$e.J(ab).type&&ab--;if(2===this.$e.J(ab).type||4===this.$e.J(ab).type)return Xa=this.$e.J(ab).wk,{returnValue:!0,Uu:Xa};a.a.instance.Ua(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",this.$e.J(Oa-1).type);return{returnValue:!1,Uu:Xa}}E3c(Oa,Xa,ab,cb){let ib,Ub=!0;ib=-1;if(ab>Oa.length)return a.a.instance.Ua(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),
{returnValue:!1,esb:ib};if(ab<Oa.length){if(-1<ab&&ab<Oa.length&&!Oa.J(ab).Bn){Ub=!1;for(var lb=ab+1;lb<Oa.length;lb++)if(Oa.J(lb).Bn){ab=lb;Ub=!0;break}}if(!Ub)return{returnValue:!1,esb:ib};Ub=!1;for(lb=0;Oa.J(ab)&&lb<Xa.length;lb++)if(Xa.J(lb).Bn===Oa.J(ab)){ib=lb;Ub=!0;break}if(!Ub)return{returnValue:!1,esb:ib}}else ib=Xa.length;if(0<ib&&cb&&!Xa.J(ib-1).Bn){for(Oa=ib-1;0<=Oa&&!Xa.J(Oa).Bn;Oa--);ib=Oa+1;6===Xa.J(ib).type&&5!==this.Zd.input.source&&ib++}return{returnValue:!0,esb:ib}}LOa(Oa,Xa,ab,
cb,ib,Ub){let lb;var Qb;let fc;var Fc=this.Pj;let nc=this.$e,zb=!1;ab||(Fc=this.$e,nc=this.Pj);fc=Qb=lb=0;let Vb,rc,pb=0;if(!({o5c:cb,dvb:Vb,fed:rc}=M(Fc,Oa,cb)).returnValue)return a.a.instance.Ua(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),{returnValue:3,Ela:lb,ZBa:Qb,lka:fc};0<=cb&&cb<Fc.length&&!Fc.J(cb).Bn&&Vb&&!ib&&(a.a.instance.Ua(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",
Ub),this.Z5=!0,pb=Xa===Fc.J(cb).source?1:2,zb=!0);ib&&!Fc.J(cb)&&cb--;ib&&Vb&&!Fc.J(cb).Bn&&(Vb=!1,rc=0);if(!ab&&!({idx:Oa}=Q(nc,Oa)).returnValue&&!Vb)return{returnValue:0,Ela:cb,ZBa:Qb,lka:fc};if(!({esb:Oa}=this.E3c(Fc,nc,cb,ab&&!Vb)).returnValue&&!zb&&(Xa=!1,1===this.CJh&&0<cb&&!rc&&(cb--,{esb:Oa,returnValue:Xa}=this.E3c(Fc,nc,cb,ab&&!Vb),Xa&&(cb++,Oa<nc.length-1?Oa++:Xa=!1)),!Xa))return a.a.instance.Ua(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),
this.Zd.logger.Oi(Object.assign(new oa.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.Z5=!0,{returnValue:3,Ela:lb,ZBa:Qb,lka:fc};if(Vb&&(!O(Fc,cb,rc)||!zb&&!O(nc,Oa,rc)))return a.a.instance.shipAssertTag(17044297,1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,Ela:lb,ZBa:Qb,lka:fc};lb=cb;Qb=Oa;Vb&&(lb=cb+1,zb||(Qb=Fc.J(cb),ab=nc.J(Oa),Qb.Bn=ab,ab.Bn=Qb,Fc=Fc.J(cb+1),Qb=nc.J(Oa+1),Fc.Bn=Qb,Qb.Bn=
Fc,Qb=Oa+1));if(Qb>=nc.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+Qb+" secondaryList length was "+nc.length),{returnValue:3,Ela:lb,ZBa:Qb,lka:fc};for(Fc=0;Fc<Qb;Fc++)nc.J(Fc).wk.equals(nc.J(Qb).wk)&&(fc+=nc.J(Fc).length);return{returnValue:pb,Ela:lb,ZBa:Qb,lka:fc}}Hwf(Oa,Xa,ab){this.yah.contains(Oa.id)&&this.Bkb.Z(Oa.id,new l.a);for(--ab;ab>=Xa;ab--)this.yah.contains(Oa.id)?this.Bkb.J(Oa.id).insert(this.Bkb.J(Oa.id).length,
this.$e.J(ab)):this.$e.J(ab).Bn&&(this.$e.J(ab).Bn.Bn=null),this.$e.dI(ab)}SVf(Oa,Xa,ab){if(this.Bkb.mb(Oa.Iv)){const cb=this.Bkb.J(Oa.Iv);for(let ib=0;ib<cb.length;ib++)cb.J(ib).wk=ab.wk,Object(wa.a)(F.a,ab)&&Object(wa.a)(F.a,cb.J(ib))&&(cb.J(ib).Yc=ab.Yc);this.$e.pD(Xa,this.Bkb.J(Oa.Iv));this.Bkb.remove(Oa.Iv)}else this.$e.insert(Xa,ab)}wPm(Oa){let Xa,ab;ab=Xa=-1;if(!Oa.Bn)return{returnValue:!1,Sgc:Xa,dxf:ab};var cb;let ib=0,Ub=!1;if(!({idx:cb}=Q(this.$e,Oa.Bn.wk)).returnValue)return{returnValue:!1,
Sgc:Xa,dxf:ab};for(;cb<this.$e.length;cb++){if(Oa.Bn===this.$e.J(cb)){Xa=cb;ab=ib;Ub=!0;break}ib+=this.$e.J(cb).length}return{returnValue:Ub,Sgc:Xa,dxf:ab}}PDf(Oa){let Xa;Xa=new l.a;let ab=0,cb=0;for(;ab<Oa.length;){if(cb>=this.Pj.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,QAc:Xa};if(Oa.J(ab).length>this.Pj.J(cb).length){if(!O(Oa,ab,this.Pj.J(cb).length))return a.a.instance.Ua(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",
ab,this.Pj.J(cb).length),{returnValue:!1,QAc:Xa}}else if(Oa.J(ab).length<this.Pj.J(cb).length){var ib=!!this.Pj.J(cb).Bn,Ub=0;if(ib&&!({esb:Ub}=this.E3c(this.Pj,this.$e,cb,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",cb),{returnValue:!1,QAc:Xa};if(!O(this.Pj,cb,Oa.J(ab).length)||ib&&!O(this.$e,Ub,Oa.J(ab).length))return a.a.instance.Ua(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,QAc:Xa};if(ib){ib=this.Pj.J(cb);var lb=this.$e.J(Ub);ib.Bn=lb;lb.Bn=ib;ib=this.Pj.J(cb+1);Ub=this.$e.J(Ub+1);ib.Bn=Ub;Ub.Bn=ib}}if(this.Pj.J(cb).Bn&&5!==this.Pj.J(cb).type&&this.Pj.J(cb).V7()&&(Ub=this.Pj.J(cb),ib=Oa.J(ab),!Ub.yL.equals(ib.yL)||!Ub.iA.$B(ib.iA))){let Qb;if(!({Sgc:lb,dxf:Qb}=this.wPm(this.Pj.J(cb))).returnValue)return{returnValue:!1,QAc:Xa};Xa.add(new ja(this.$e.J(lb).wk,Qb,Ub,ib))}ab++;cb++}return{returnValue:!0,QAc:Xa}}static f1h(Oa,Xa,ab){for(--ab;0<=ab;ab--){if(!Oa.J(ab).V7()&&
6!==Oa.J(ab).type){a.a.instance.shipAssertTag(17311187,1,2===Oa.J(ab).type||4===Oa.J(ab).type,"Found merge block of type "+Oa.J(ab).type);break}Oa.J(ab).wk=Xa}}static dYi(Oa){return Oa?!1:(a.a.instance.Ua(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(G.a)(Ea,"ParagraphMergeUsingHintsTwinList",null,[1056]);var Ja=d(1829),nb=d(1830),ub=d(1826),Yb=d(1828),yb=d(1827);class Za{constructor(Oa,Xa,ab,cb){this.cp=Oa;this.length=
Xa;this.BTd=ab;this.Vtd=cb}}Object(G.a)(Za,"UpdateFormattingIdsPosInfo",null,[]);class Ya{constructor(Oa,Xa,ab){this.Z5=!1;this.Bkb=new y.a;this.avh=!1;this.Zd=Oa;this.CJh=ab;this._base=Xa;this.TPe=Z(Xa);if(!N(this.Pj,this.$e))throw a.a.instance.Ua(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Oa.logger.Oi(Object.assign(new H.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");this.Zd.runtime.rc.yrb(1000010)&&(this.avh=!0)}get Pj(){return this._base}get $e(){return this.TPe}get Bdd(){return this.Z5}rjf(Oa,
Xa){switch(Oa.type){case 11:return this.N7k(Oa,Xa);case 8:return this.Qif(Oa,Xa);case 10:return this.Oif(Oa);default:return!1}}qjf(Oa,Xa){switch(Oa.type){case 11:return this.M7k(Oa,Xa);case 8:return this.Pif(Oa,Xa);case 10:return this.Nif(Oa);default:return{returnValue:!1,tv:null}}}yTh(){a.a.instance.Ua(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.Zd.logger.Oi(Object.assign(new H.a,{$j:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}xTh(){a.a.instance.Ua(574433296,
1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.Zd.logger.Oi(Object.assign(new H.a,{$j:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}PDf(Oa){let Xa;Xa=new l.a;let ab=0,cb=0,ib=0;for(;ab<Oa.length;){if(cb>=this.Pj.length)return a.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.Zd.logger.Oi(Object.assign(new H.a,{$j:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),
{returnValue:!1,Utd:Xa};if(Oa.J(ab).length>this.Pj.J(cb).length){if(!O(Oa,ab,this.Pj.J(cb).length))return a.a.instance.Ua(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.Zd.logger.Oi(Object.assign(new H.a,{$j:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,Utd:Xa}}else if(Oa.J(ab).length<this.Pj.J(cb).length&&!this.Keb(ib+Oa.J(ab).length,!0).returnValue)return a.a.instance.Ua(574433299,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),
this.Zd.logger.Oi(Object.assign(new H.a,{$j:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,Utd:Xa};if(this.Pj.J(cb).Bn&&5!==this.Pj.J(cb).type&&this.Pj.J(cb).V7()){const Ub=this.Pj.J(cb),lb=Oa.J(ab);if(!Ub.yL.equals(lb.yL)||!Ub.iA.$B(lb.iA)){let Qb,fc;if(({Sgc:Qb,jfi:fc}=this.xPm(this.Pj.J(cb))).returnValue)Xa.add(new Za(fc,this.$e.J(Qb).length,Ub,lb));else return a.a.instance.Ua(571757956,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),
this.Zd.logger.Oi(Object.assign(new H.a,{$j:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,Utd:Xa}}}ib+=this.Pj.J(cb).length;ab++;cb++}return{returnValue:!0,Utd:Xa}}N7k(Oa,Xa){let ab;if(!({MJa:ab}=this.Keb(Oa.cp,!0)).returnValue)return a.a.instance.Ua(574433300,1,2,"ApplyInsertTextHintToDerived"),this.Zd.logger.Oi(Object.assign(new H.a,{$j:"ApplyInsertTextHintToDerived",eventId:"8ps6u"})),!1;for(let ib=0;ib<Oa.s3.length;ib++)switch(Oa.s3.J(ib).type){case 7:var cb=
Oa.s3.J(ib);this.$e.insert(ab,new sa(Xa,null,cb.text,cb.id));break;case 9:cb=Oa.s3.J(ib);this.$e.insert(ab,new F.a(Xa,cb.Rg,cb.Yc));break;default:return a.a.instance.Ua(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.Zd.logger.Oi(Object.assign(new H.a,{$j:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}Qif(Oa,Xa){let ab,cb;if(!({MJa:ab}=this.Keb(Oa.cp,!0)).returnValue||!({MJa:cb}=this.Keb(Oa.cp+Oa.text.length,!1)).returnValue)return a.a.instance.Ua(575706433,1,2,"ApplyDeleteTextHintToDerived"),
this.Zd.logger.Oi(Object.assign(new H.a,{$j:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Oa=cb;Oa>=ab;Oa--)this.$e.J(Oa).source!==Xa&&this.m_d(this.$e,Oa);return!0}Oif(Oa){let Xa;if(!({MJa:Xa}=this.Keb(Oa.cp,!0)).returnValue)return a.a.instance.Ua(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.Zd.logger.Oi(Object.assign(new H.a,{$j:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),!1;this.Kwf(this.$e,Oa,Xa);return!0}M7k(Oa,Xa){let ab;ab=null;let cb,ib;if(!({CKb:cb,MJa:ib}=this.Keb(Oa.cp,
!0)).returnValue)return a.a.instance.Ua(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.Zd.logger.Oi(Object.assign(new H.a,{$j:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,tv:ab};var Ub=this.OIf(this.$e,ib-1);Ub=new yb.a(Ub);for(let lb=0;lb<Oa.s3.length;lb++)switch(Oa.s3.J(lb).type){case 7:Ub.s3.add(this.Uif(Oa.s3.J(lb),Xa,cb,ib));break;case 9:Ub.s3.add(this.O7k(Oa.s3.J(lb),Xa,cb,ib));break;default:return a.a.instance.Ua(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),
this.Zd.logger.Oi(Object.assign(new H.a,{$j:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,tv:ab}}ab=new l.a;ab.add(Ub);return{returnValue:!0,tv:ab}}Uif(Oa,Xa,ab,cb){const ib=new sa(Xa,Oa.Rg,Oa.text,Oa.id);Xa=new sa(Xa,Oa.Rg,Oa.text,Oa.id);ib.Bn=Xa;Xa.Bn=ib;this.Pj.insert(ab,ib);this.$e.insert(cb,Xa);ab=new Yb.a(Oa.Rg,Oa.text);ab.id=Oa.id;return ab}O7k(Oa,Xa,ab,cb){const ib=new F.a(Xa,Oa.Rg,Oa.Yc);Xa=new F.a(Xa,Oa.Rg,Oa.Yc);ib.Bn=Xa;Xa.Bn=ib;this.Pj.insert(ab,ib);this.$e.insert(cb,
Xa);return new ub.a(Oa.Rg,Oa.Yc)}Pif(Oa){let Xa;Xa=new l.a;let ab;var cb;let ib;if(!({CKb:ab,MJa:cb}=this.Keb(Oa.cp,!0)).returnValue||!({CKb:ib,MJa:Ub}=this.Keb(Oa.cp+Oa.text.length,!1)).returnValue)return a.a.instance.Ua(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.Zd.logger.Oi(Object.assign(new H.a,{$j:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),{returnValue:!1,tv:Xa};this.Zd.runtime.rc.I$d(1000010);for(Oa=Ub;Oa>=cb;Oa--)if(this.$e.J(Oa).Bn){var Ub=Oa;const lb=({Pbg:Oa}=
this.z8l(Oa,cb)).returnValue;lb&&(Xa.add(lb),this.m_d(this.$e,Oa,Ub))}for(cb=ib;cb>=ab;cb--)this.m_d(this.Pj,cb);return{returnValue:!0,tv:Xa}}Nif(Oa){let Xa;Xa=null;let ab,cb;if(!({CKb:ab,MJa:cb}=this.Keb(Oa.cp,!0)).returnValue)return a.a.instance.Ua(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.Zd.logger.Oi(Object.assign(new H.a,{$j:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,tv:Xa};if(!this.Kwf(this.Pj,Oa,ab))return a.a.instance.Ua(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),
this.Zd.logger.Oi(Object.assign(new H.a,{$j:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,tv:Xa};this.Kwf(this.$e,Oa,cb)&&(Xa=new l.a,Xa.add(new Ja.a(this.OIf(this.$e,cb-1),Oa.Rg,Oa.Yc)));return{returnValue:!0,tv:Xa}}Keb(Oa,Xa){var ab;var cb=ab=-1;let ib,Ub;if(!({dvb:Ub,vWh:Oa,uWh:ib}=U(this.Pj,Oa,this.Zd.logger)).returnValue)return{returnValue:!1,CKb:ab,MJa:cb};const lb=Oa>=this.Pj.length;lb&&Oa--;if(this.Pj.J(Oa).Bn){const Qb=this.Y9l(this.$e,this.Pj.J(Oa));if(Ub){if(0>
Qb||!O(this.Pj,Oa,ib)||!O(this.$e,Qb,ib))return a.a.instance.Ua(575706444,1,2,"SplitTwinListAndFindIdx"),this.Zd.logger.Oi(Object.assign(new H.a,{$j:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,CKb:ab,MJa:cb};ab=this.Pj.J(Oa);cb=this.$e.J(Qb);ab.Bn=cb;cb.Bn=ab;ab=this.Pj.J(Oa+1);cb=this.$e.J(Qb+1);ab.Bn=cb;cb.Bn=ab;ab=Xa?Oa+1:Oa;cb=Xa?Qb+1:Qb}else Xa?(ab=lb?Oa+1:Oa,cb=lb?Qb+1:Qb):(ab=lb?Oa:Oa-1,cb=lb?Qb:Qb-1)}else if(Ub){if(O(this.Pj,Oa,ib))ab=Xa?Oa+1:Oa;else return a.a.instance.Ua(575706445,
1,2,"SplitTwinListAndFindIdx"),this.Zd.logger.Oi(Object.assign(new H.a,{$j:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,CKb:ab,MJa:cb};Xa?(cb=({JRb:cb}=this.Gic(this.Pj,this.$e,Oa,!1)).returnValue?cb+1:0,cb=cb>=this.$e.length?this.$e.length-1:cb):(cb=({JRb:cb}=this.Gic(this.Pj,this.$e,Oa,!0)).returnValue?cb-1:this.$e.length-1,cb=0>cb?0:cb)}else Xa?(({JRb:cb}=this.Gic(this.Pj,this.$e,Oa,!0)).returnValue||(({JRb:cb}=this.Gic(this.Pj,this.$e,Oa,!1)).returnValue?cb+=1:(cb=lb?this.$e.length-
1:0,cb=0>cb?0:cb)),ab=lb?Oa+1:Oa):(({JRb:cb}=this.Gic(this.Pj,this.$e,Oa,!1)).returnValue||(({JRb:cb}=this.Gic(this.Pj,this.$e,Oa,!0)).returnValue?--cb:(cb=Oa?this.$e.length-1:0,cb=0>cb?0:cb)),ab=lb?Oa:Oa-1);return{returnValue:!0,CKb:ab,MJa:cb}}Gic(Oa,Xa,ab,cb){let ib=null;if(cb)for(;ab<Oa.length;ab++){if(Oa.J(ab).Bn){ib=Oa.J(ab).Bn;break}}else for(;0<=ab;ab--)if(Oa.J(ab).Bn){ib=Oa.J(ab).Bn;break}if(ib)for(Oa=0;Oa<Xa.length;Oa++)if(Xa.J(Oa)===ib)return Xa=Oa,{returnValue:!0,JRb:Xa};return{returnValue:!1,
JRb:-1}}Y9l(Oa,Xa){for(let ab=0;ab<Oa.length;ab++)if(Oa.J(ab).Bn===Xa)return ab;return-1}m_d(Oa,Xa,ab=-1){for(ab=0>ab?Xa:ab;ab>=Xa;ab--)Oa.J(ab).Bn&&(Oa.J(ab).Bn.Bn=null),Oa.dI(ab)}OIf(Oa,Xa){let ab=0;for(;0<=Xa;Xa--)ab+=Oa.J(Xa).length;return ab}VNm(Oa){Oa=Object(v.a)(ua.a,Oa);Oa||(a.a.instance.Ua(575706448,1,2,"GetTextBlock"),this.Zd.logger.Oi(Object.assign(new H.a,{$j:"GetTextBlock",eventId:"8ujvq"})));return Oa}z8l(Oa,Xa){let ab="",cb=Oa;for(;cb>=Xa&&this.$e.J(cb).Bn&&2!==this.$e.J(cb).type;)ab=
this.VNm(this.$e.J(cb)).text+ab,cb--;Xa=0>cb?0:this.OIf(this.$e,cb);return!this.avh||cb<Oa?(Oa=cb+1,{returnValue:new nb.a(Xa,ab),Pbg:Oa}):{returnValue:null,Pbg:cb}}xPm(Oa){let Xa,ab,cb=!1;ab=Xa=0;if(!Oa.Bn)return{returnValue:!1,Sgc:Xa,jfi:ab};for(Xa=0;Xa<this.$e.length;Xa++){if(this.$e.J(Xa).Bn===Oa){cb=!0;break}ab+=this.$e.J(Xa).length}return{returnValue:cb,Sgc:Xa,jfi:ab}}Kwf(Oa,Xa,ab){ab=ab===Oa.length?--ab:ab;ab>Oa.length-1&&(a.a.instance.Ua(571757957,1,2,"DeleteEopInList: Idx out of range"),this.Zd.logger.Oi(Object.assign(new H.a,
{$j:"DeleteEopInList",eventId:"8ffwf"})));if(2===Oa.J(ab).type){const cb=Oa.J(ab);if(cb.wk!==Xa.Rg||cb.Yc!==Xa.Yc)return!1;this.m_d(Oa,ab);return!0}return!1}}Object(G.a)(Ya,"ParagraphMergeUsingHintsTwinListLcs",null,[1056]);var Pa=d(1645),rb=d(1613),tb=d(1825);d.d(J,"a",function(){return ob});class ob{constructor(Oa,Xa,ab,cb,ib,Ub,lb=null,Qb=null,fc=null){this.lT=this.Qya=this.lRa=this.Kwa=null;this._initialized=!1;this.Zd=Oa;this.wH=Xa;this.UHa=cb;this.vGa=ab;this.nxa=ib;this.MLe=new f.a;for(Oa=
0;Oa<this.wH.length;Oa++)this.MLe.add(this.wH.J(Oa).id);this.Fhh=new f.a;for(Oa=0;Oa<this.vGa.length;Oa++)this.Fhh.add(this.vGa.J(Oa).id);this.pJh=new f.a;for(Oa=0;Oa<this.UHa.length;Oa++)this.pJh.add(this.UHa.J(Oa).id);this.vg=Ub;this.pcf=lb||A.a.instance;this.QK=Qb;this.TZ=fc;this.TEb=1===(this.QK&&this.TZ&&1===this.QK.EPa&&1===this.TZ.EPa?1:0);this.mxa=0}get Nvg(){return 1!==this.mxa}n8m(){var Oa=!0;if(this.QK&&this.TZ)return Oa;if(this.QK||this.TZ)return a.a.instance.Ua(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),
!1;this.Zd.runtime.NA.mb(z.a.$N)&&(Oa=this.Zd.runtime.NA.J(z.a.$N),Oa=this.eOg(Oa,this.Zd.runtime.dJa.id,"favored")&&({AK:this.QK}=this.qSi(Oa,this.MLe,this.Fhh,this.Zd.runtime.NA,"favored")).returnValue);Oa&&this.Zd.runtime.sv.mb(z.a.$N)&&(Oa=this.Zd.runtime.sv.J(z.a.$N),Oa=this.eOg(Oa,this.Zd.runtime.dJa.id,"unfavored")&&({AK:this.TZ}=this.qSi(Oa,this.MLe,this.pJh,this.Zd.runtime.sv,"unfavored")).returnValue);this.QK=this.QK?this.QK:new tb.a(new l.a,0);this.TZ=this.TZ?this.TZ:new tb.a(new l.a,0);
Oa&&this.Zd.input.LRb&&(Oa=this.Zd.input.cda.last().QKa(z.a.$N),Oa=this.eOg(Oa,this.Zd.input.cda.last().KJ.id,"alreadyMerged"));return Oa}o6m(){const Oa=new f.a;if(this.TEb)return Oa;const Xa=this.QK?this.QK.AK.wOa():new l.a;let ab=0;for(;ab<Xa.length-1;){const cb=Xa.J(ab);let ib,Ub=!1;for(ib=ab+1;ib<Xa.length;ib++){const lb=Xa.J(ib);if(cb.NZi(lb)){Oa.add(cb.id);Xa.dI(ib);Xa.dI(ab);Ub=!0;break}}Ub||ab++}return Oa}eOg(Oa,Xa,ab){Oa=this.vg.getPropertyString(Oa,m.a.I0a);Oa=w.a.Cf(Oa);return Xa.equals(Oa)?
!0:(this.iod(2),a.a.instance.Ua(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.Zd.runtime.dJa.id,Oa,ab),!1)}qSi(Oa,Xa,ab,cb,ib){let Ub;Ub=new tb.a(new l.a,0);Oa=this.vg.getPropertyObjectIds(Oa,m.a.W4).wOa();for(let Qb=0;Qb<Oa.length;Qb++){if(!cb.mb(Oa.J(Qb)))return a.a.instance.Ua(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",
Oa.J(Qb),ib),{returnValue:!1,AK:Ub};const fc=cb.J(Oa.J(Qb));var lb=w.a.Cf(this.vg.getPropertyString(fc,m.a.loa));if(Xa.contains(lb)||ab.contains(lb)){lb=this.pcf.V4c(fc);if(!lb)return a.a.instance.Ua(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",fc.id,ib),{returnValue:!1,AK:Ub};Ub.AK.add(lb)}}0<Oa.length&&a.a.instance.Ua(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",
ib,Oa.Yr(),Ub.AK.Yr());return{returnValue:!0,AK:Ub}}w7m(){return({ZM:this.Kwa,n0c:this.lRa,itd:this.Qya}=Pa.a.gai(this.Zd,this.vg,this.wH,this.vGa,this.UHa,this.nxa,!0,!0)).returnValue?!0:!1}l8m(Oa){const Xa=Pa.a.SYd(this.vg,ab=>this.Zd.runtime.In.J(ab),this.wH,1,this.nxa,!0,!0).returnValue;if(!Xa)return a.a.instance.Ua(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.lT=this.TEb?new Ya(this.Zd,Xa,1):new Ea(this.Zd,Xa,Oa,this.QK?this.QK.EPa:
0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;if(!this.n8m()||!this.w7m())return!1;const Oa=this.o6m();return this.l8m(Oa)?!0:!1}tCi(Oa){const Xa=new l.a;let ab="";for(let cb=0;cb<Oa.length;cb++){const ib=Oa.J(cb);ib.V7()?ab+=Oa.J(cb).text:2===ib.type?(Xa.add(new ia(ib.wk,ib.type,ab,ib.Yc)),ab=""):4===ib.type&&(Xa.add(new ia(ib.wk,ib.type)),ab="")}return Xa}jGe(Oa,Xa,ab){Xa=this.tCi(Xa);Oa=this.tCi(Oa);let cb=Xa.length===Oa.length;if(cb)for(let ib=0;ib<Xa.length;ib++)if(!Xa.J(ib).isEqual(Oa.J(ib))){cb=
!1;break}cb||(this.iod(4),a.a.instance.Ua(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",ab,Oa.Yr(),Xa.Yr()));return cb}dUh(Oa,Xa,ab){(Xa=({Ifb:Oa}=this.w9k(Oa,Xa,ab)).returnValue)||this.iod(this.lT.Bdd?1:3);return{returnValue:Xa,Ifb:Oa}}w9k(Oa,Xa,ab){let cb;cb=new l.a;let ib=!0;var Ub=0;let lb=null,Qb=this.QK?this.QK.AK.length:0;for(var fc=0;fc<Qb&&ib;fc++)lb=this.QK.AK.J(fc),
Ub<this.TZ.AK.length&&lb.id.equals(this.TZ.AK.J(Ub).id)&&5!==this.Zd.input.source?({returnValue:ib}=this.lT.qjf(lb,2),Ub++):ib=this.lT.rjf(lb,2);if(!ib)return a.a.instance.Ua(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",lb.toString()),{returnValue:!1,Ifb:cb};if(!this.jGe(this.lT.$e,this.lRa,"Favored"))return{returnValue:!1,Ifb:cb};if(Oa&&1===this.Zd.input.xma&&!this.lT.yTh(Xa,ab,2))return a.a.instance.Ua(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
Xa,ab),{returnValue:!1,Ifb:cb};ib=!0;fc=new l.a;for(Qb=this.TZ?this.TZ.AK.length:0;Ub<Qb&&ib;Ub++){lb=this.TZ.AK.J(Ub);let Fc;({tv:Fc,returnValue:ib}=this.lT.qjf(lb,4));ib&&Fc&&fc.pD(fc.length,Fc)}return ib?this.jGe(this.lT.Pj,this.Qya,"Unfavored")?Oa&&2===this.Zd.input.xma&&!this.lT.xTh(Xa,ab,4)?(a.a.instance.Ua(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Xa,ab),{returnValue:!1,Ifb:cb}):{returnValue:!0,Ifb:fc}:{returnValue:!1,Ifb:cb}:(a.a.instance.Ua(17044291,
1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",lb.id,lb.type),{returnValue:!1,Ifb:cb})}Gzm(){let Oa,Xa=0;let ab=0,cb=w.a.nil;for(Oa=new y.a;ab<this.lT.Pj.length;){const lb=this.lT.Pj.J(ab);cb.equals(lb.wk)||(Xa=0,cb=lb.wk);if(5===lb.type){var ib=Xa+lb.length;var Ub=void 0;let Qb;const fc=Z(this.Qya);if(!({index:Ub}=V(fc,lb.wk,Xa)).returnValue||!({index:Qb}=V(fc,lb.wk,ib)).returnValue)return a.a.instance.Ua(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",
lb.ztd),{returnValue:!1,Udj:Oa};for(ib=new l.a;Ub<Qb;Ub++)ib.add(fc.J(Ub));Oa.Z(lb.ztd,ib)}Xa+=lb.length;ab++}return{returnValue:!0,Udj:Oa}}Hzm(){let Oa;Oa=new y.a;let Xa=0;for(let cb=0;cb<this.lT.Pj.length;cb++){const ib=this.lT.Pj.J(cb);if(5===ib.type){var ab=void 0;let Ub;const lb=Z(this.Qya);if(!({index:ab}=Y(lb,Xa,this.Zd.logger)).returnValue||!({index:Ub}=Y(lb,Xa+ib.length,this.Zd.logger)).returnValue)return a.a.instance.Ua(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),
{returnValue:!1,Vdj:Oa};const Qb=new l.a;for(;ab<Ub;ab++)Qb.add(lb.J(ab));Oa.Z(ib.ztd,Qb)}Xa+=ib.length}return{returnValue:!0,Vdj:Oa}}j8k(Oa){let Xa;Xa=new l.a;let ab;if(this.TEb){if(!({Vdj:ab}=this.Hzm()).returnValue)return{returnValue:!1,Fdd:Xa}}else if(!({Udj:ab}=this.Gzm()).returnValue)return{returnValue:!1,Fdd:Xa};let cb;cb=this.TEb?new Ya(this.Zd,Z(this.lRa),1):new Ea(this.Zd,Z(this.lRa),new f.a,this.QK?this.QK.EPa:0);for(var ib=0;ib<Oa.length;ib++)if(!cb.rjf(Oa.J(ib),4))return{returnValue:!1,
Fdd:Xa};for(Oa=cb.$e.length-1;0<=Oa;Oa--)5===cb.$e.J(Oa).type&&(ib=cb.$e.J(Oa).ztd,cb.$e.dI(Oa),cb.$e.pD(Oa,ab.J(ib)));this.TEb&&(this.ldi(cb.$e),this.ldi(this.lT.$e));if(!this.jGe(this.lT.$e,cb.$e,"Merged"))return{returnValue:!1,Fdd:Xa};Xa=cb.$e;return{returnValue:!0,Fdd:Xa}}ldi(Oa){const Xa=new y.a;for(let ab=Oa.length-1;0<=ab;ab--){const cb=Object(v.a)(F.a,Oa.J(ab));cb&&(Xa.mb(cb.Yc)?Xa.J(cb.Yc).source!==cb.source&&Oa.dI(ab):Xa.add(cb.Yc,cb))}}v9k(Oa){let Xa;if(!({Utd:Xa}=this.lT.PDf(Z(this.Qya))).returnValue)return!1;
for(let cb=0;cb<Xa.length;cb++){const ib=Xa.J(cb);let Ub,lb;if(!({index:Ub}=Y(Oa,ib.cp,this.Zd.logger)).returnValue||!({index:lb}=Y(Oa,ib.cp+ib.length,this.Zd.logger)).returnValue)return a.a.instance.Ua(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.Zd.logger.Oi(Object.assign(new H.a,{$j:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var ab=!1;for(let Qb=Ub;Qb<lb&&!ab;Qb++)ab=!ib.BTd.yL.equals(Oa.J(Qb).yL);if(!ab){for(ab=Ub;ab<lb;ab++)Oa.dI(Ub);Oa.insert(Ub,
ib.Vtd)}}return!0}u9k(Oa){let Xa;if(!({QAc:Xa}=this.lT.PDf(Z(this.Qya))).returnValue)return!1;for(let ib=0;ib<Xa.length;ib++){var ab=Xa.J(ib);let Ub,lb;if(({index:Ub}=V(Oa,ab.Rg,ab.cp)).returnValue&&({index:lb}=V(Oa,ab.Rg,ab.cp+ab.Vtd.length)).returnValue){var cb=!1;for(let Qb=Ub;Qb<lb&&!cb;Qb++)cb=!ab.BTd.yL.equals(Oa.J(Qb).yL)||!ab.BTd.iA.$B(Oa.J(Qb).iA);if(cb){if(this.QK&&1===this.QK.EPa||this.TZ&&1===this.TZ.EPa)return!1}else{for(cb=Ub;cb<lb;cb++)Oa.dI(Ub);Oa.insert(Ub,ab.Vtd)}}else if(ab=ab.Vtd.Zdn,
a.a.instance.Ua(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",ab),ab||this.QK&&1===this.QK.EPa||this.TZ&&1===this.TZ.EPa)return!1}return!0}bFm(Oa){let Xa,ab;ab=new l.a;Xa=this.Zd.runtime.Yq.J(z.a.$N);let cb;({d9f:cb}=ob.yti(this.Zd,this.vg));const ib=new l.a;for(let lb=0;lb<Oa.length;lb++){if(cb.contains(Oa.J(lb).id,(fc,Fc)=>fc.equals(Fc)))continue;if(this.Zd.runtime.Yq.mb(Oa.J(lb).id))return a.a.instance.shipAssertTag(17044293,
1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Oa.J(lb).id),{returnValue:!1,dqe:Xa,cqe:ab};ib.add(Oa.J(lb).id);var Ub=Oa.J(lb).B9a();const Qb=new rb.a(Ub);Ub=Ub.fk();for(const fc of Ub)Qb.XM(fc);ab.add(Qb)}Oa=this.vg.getPropertyObjectIds(Xa.Fm,m.a.W4);Oa.pD(Oa.length,ib);this.vg.setPropertyObjectIds(Xa.Fm,m.a.W4,Oa);return{returnValue:!0,dqe:Xa,cqe:ab}}J6d(Oa){return String.format("Name: {0}, Message: {1}, Stack: {2}",Oa.name,Oa.message,Oa.stack)}iod(Oa){0===this.mxa&&(this.mxa=
Oa)}DAc(){let Oa;Oa=null;let Xa,ab;var cb;try{if({Yq:Oa,dqe:Xa,cqe:ab,returnValue:cb}=this.Aop(),cb){if(Xa&&ab){this.Zd.runtime.Yq.Z(Xa.Fm.id,Xa);for(cb=0;cb<ab.length;cb++){const Qb=ab.J(cb);this.Zd.runtime.Yq.Z(Qb.Fm.id,Qb)}const ib=Xa.Fm,Ub=this.vg.getPropertyObjectIds(ib,m.a.W4),lb=this.vg.getPropertyString(ib,m.a.I0a);a.a.instance.Ua(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Ub.Yr(),lb)}else a.a.instance.Ua(593826831,
1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,Yq:Oa}}}catch(ib){a.a.instance.Ua(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.J6d(ib))}this.iod(5);a.a.instance.Ua(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.mxa,this.Nvg);this.nbb();this.QK&&1===this.QK.EPa&&this.Zd.logger.Oi(Object.assign(new X.a,{eventId:"bc04c",$j:"ParagraphMergeUsingHints.TryDoMerge",
info:u[this.mxa]+"/LCS"}));return{returnValue:!1,Yq:Oa}}Aop(){let Oa,Xa,ab;ab=Xa=Oa=null;let cb;cb=this.initialize();this.Zd.logger.NX("PMUH Initialize");let ib=null;cb=cb&&({Ifb:ib}=this.dUh(!1,w.a.nil,0)).returnValue;this.Zd.logger.NX("PMUH ApplyUpdateHints");let Ub=new l.a;cb=cb&&({Fdd:Ub}=this.j8k(ib)).returnValue;this.Zd.logger.NX("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");cb=this.TEb?cb&&this.v9k(Ub):cb&&this.u9k(Ub);this.Zd.logger.NX("PMUH ApplyUnfavoredFormattingChanges");
this.TEb&&!this.aIo(Ub)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.Zd.logger.Oi(Object.assign(new H.a,{$j:"ReuseParaIdsIfPossible",eventId:"8ettb"})),cb=!1);const lb=this.v8d(Ub);cb=cb&&({bqe:Oa}=Pa.a.Q3c(this.Zd,this.vg,this.nxa,Ub,lb)).returnValue;this.Zd.logger.NX("PMUH GetMergeableObjectsFromMergeBlocks");this.QK&&1===this.QK.EPa&&this.TZ&&1===this.TZ.EPa||(cb=cb&&({dqe:Xa,cqe:ab}=this.bFm(D(ib))).returnValue,this.Zd.logger.NX("PMUH GetPartialMergeResultForUpdateHintNodes"));
return{returnValue:cb,Bdd:!!this.lT&&this.lT.Bdd,Yq:Oa,dqe:Xa,cqe:ab}}v8d(Oa){const Xa=new l.a;for(let ab=0;ab<Oa.length;ab++)2===Oa.J(ab).type&&Xa.add(Oa.J(ab).wk);return Xa}JJf(Oa){const Xa=new l.a;for(let ab=0;ab<Oa.length;ab++)2===Oa.J(ab).type&&Xa.add(Oa.J(ab));return Xa}aIo(Oa){var Xa=this.JJf(this.Kwa),ab=this.JJf(this.lRa),cb=this.JJf(this.Qya),ib=this.v8d(Xa),Ub=this.v8d(ab),lb=this.v8d(cb);Ub=I.b(ib,Ub,lb);ib=new l.a;for(lb=0;lb<Ub.length;lb++)ib.pD(ib.length,Ub.J(lb).$9l());Ub=this.e$l(Oa);
Xa=this.a$l(Ub,ib,Xa,ab,cb);ab=0;cb=new f.a;for(ib=0;ib<Oa.length;ib++)if(Ub=Oa.J(ib),2===Ub.type)if(cb.contains(Ub.wk))if(ab<Xa.length)Oa.dI(ib),Oa.insert(ib,Xa.J(ab)),ab++;else return!1;else cb.add(Ub.wk);0<Oa.length&&2!==Oa.J(Oa.length-1).type&&ab<Xa.length&&Oa.insert(Oa.length,Xa.J(ab));return!0}e$l(Oa){const Xa=new f.a;for(let ab=0;ab<Oa.length;ab++)2===Oa.J(ab).type&&Xa.add(Oa.J(ab).wk);return Xa}a$l(Oa,Xa,ab,cb,ib){const Ub=new l.a;for(let lb=0;lb<Xa.length;lb++){const Qb=Xa.J(lb);if(!Oa.contains(Qb)){let fc;
(({block:fc}=this.HDf(cb,Qb)).returnValue||({block:fc}=this.HDf(ib,Qb)).returnValue||({block:fc}=this.HDf(ab,Qb)).returnValue)&&fc&&Ub.add(fc)}}return Ub}HDf(Oa,Xa){for(let ab=0;ab<Oa.length;ab++)if(2===Oa.J(ab).type&&Oa.J(ab).wk===Xa)return Oa=Oa.J(ab),{returnValue:!0,block:Oa};return{returnValue:!1,block:null}}nbb(){const Oa=new l.a;Pa.a.brc(this.vg,"BaseObjects_",this.wH,Oa);Pa.a.brc(this.vg,"FavoredObjects_",this.vGa,Oa);Pa.a.brc(this.vg,"ConflictObjects_",this.UHa,Oa)}Sjl(){let Oa,Xa;Oa=w.a.nil;
Xa=-1;let ab=0;for(let cb=0;cb<this.lT.$e.length;cb++){const ib=this.lT.$e.J(cb);if(ib.V7())ab+=ib.length;else if(6!==ib.type)ab=0;else return Oa=ib.wk,Xa=ab,{returnValue:!0,objectId:Oa,cp:Xa}}a.a.instance.Ua(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:Oa,cp:Xa}}utd(Oa,Xa){let ab,cb;cb=Xa;ab=Oa;try{let ib=this.initialize();if(ib=(ib=ib&&this.dUh(!0,Oa,Xa).returnValue)&&({objectId:ab,cp:cb}=this.Sjl()).returnValue)return a.a.instance.Ua(17409924,
1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",ab,cb),{returnValue:!0,ydb:ab,qva:cb}}catch(ib){a.a.instance.Ua(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.J6d(ib))}this.iod(5);a.a.instance.Ua(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.mxa,this.Nvg);this.nbb();return{returnValue:!1,ydb:ab,qva:cb}}static yti(Oa,
Xa){let ab;ab=new l.a;if(!Oa.input.LRb)return{returnValue:!0,d9f:ab};Oa=Oa.input.cda.last().QKa(z.a.$N);ab=Xa.getPropertyObjectIds(Oa,m.a.W4);return{returnValue:!0,d9f:ab}}static Mdo(Oa){if(!Pa.a.kzf(Oa))return!0;const Xa=new x.a;Oa.runtime.Yq.Z(z.a.$N,Pa.a.o8m(Oa,Xa));return!0}static kdo(Oa){if(!Oa.runtime.Yq.mb(z.a.$N)||!Oa.runtime.sv.mb(z.a.$N))return!0;const Xa=new x.a,ab=Oa.runtime.Yq.J(z.a.$N);var cb=Xa.getPropertyString(ab.Fm,m.a.I0a);if(w.a.Cf(cb).equals(w.a.nil))return!0;cb=Xa.getPropertyObjectIds(ab.Fm,
m.a.W4);const ib=Xa.getPropertyObjectIds(Oa.runtime.sv.J(z.a.$N),m.a.W4);let Ub;({d9f:Ub}=ob.yti(Oa,Xa));for(let lb=0;lb<ib.length;lb++)cb.contains(ib.J(lb),(Qb,fc)=>Qb.equals(fc))||Ub.contains(ib.J(lb),(Qb,fc)=>Qb.equals(fc))||(cb.add(ib.J(lb)),Oa.runtime.Yq.Z(ib.J(lb),new rb.a(Oa.runtime.sv.J(ib.J(lb)).WO())));Xa.setPropertyObjectIds(ab.Fm,m.a.W4,cb);return!0}}Object(G.a)(ob,"ParagraphMergeUsingHints",null,[994])},1747:function(G,J,d){G=d(0);class m{constructor(v){this.dhj=v;this.succeeded=!1;this.uAc=
v?v.uAc:0;this.rsn=!1;this.length=this.khp=0}}Object(G.a)(m,"TrieResult",null,[]);class f{constructor(v,u,x){this.Gub=new m(null);this.$Gn=v;this.Hcd=u;this.xbj=u+x-1}get result(){return this.Gub}OCi(){let v;return this.Hcd<=this.xbj?(v=this.$Gn.charAt(this.Hcd),++this.Hcd,{returnValue:!0,ch:v}):{returnValue:!1,ch:"\x00"}}Jrg(v,u,x){v&&(this.Gub.rsn=!0,this.Gub.khp=u);this.Gub.length=this.Hcd;this.Gub.succeeded=!0;this.Gub.uAc=x;this.Hcd!==this.xbj+1&&(this.Gub=new m(this.Gub))}}Object(G.a)(f,"LookUpStringVisitor",
null,[1710]);var a=d(1842);class l{constructor(){this.H0h=this.WYh=this.YYh=this.VYh=this.XYh=this.Vmf=this.Tmf=this.Xmf=this.Smf=0}}Object(G.a)(l,"TRIESTATS",null,[]);class w{constructor(){this.POa=this.Bed=0}}Object(G.a)(w,"TrieSymbol",null,[]);d.d(J,"a",function(){return y});class y{constructor(v,u){this.a8=null;this.pje=this.Mbj=this.Kbj=this.Obj=this.Gbj=this.Nbj=this.Lbj=this.Pbj=this.Hbj=0;this.WL=v;if(v.hA(u,4)!==y.fLb)throw Error.argument("Input does not represent a trie");u+=4;this.zbj=
1===v.hA(u,4);u+=4;this.XGn=1===v.hA(u,4);u+=4;this.TGn=v.hA(u,4);u+=4;if(v.hA(u,4)){v=u+4;this.a8=this.boo(v);this.Hbj=u=v+y.jil;this.Pbj=u+=y.xUd*(this.a8.Smf+(this.a8.Smf%2?1:0));this.Lbj=u+=y.xUd*(this.a8.Xmf+(this.a8.Xmf%2?1:0));this.Nbj=u+=y.xUd*(this.a8.Tmf+(this.a8.Tmf%2?1:0));this.Gbj=u+=y.xUd*(this.a8.Vmf+(this.a8.Vmf%2?1:0));this.Obj=u+=y.Zmf*this.a8.VYh;this.Kbj=u+=y.$mf*this.a8.YYh;this.Mbj=u+=y.$mf*this.a8.WYh;u+=y.$mf*this.a8.XYh;if(u!==v+this.a8.H0h)throw Error.argument("Corrupted trie binary");
this.pje=u}else this.a8=null}Uaj(v,u,x,z){v=new f(v,u,x);this.Rak(v,z);return v.result}UHi(v){if(this.zbj)if(v)--v;else return"";if(!this.a8)throw Error.argument("Invalid trieID");const u=new a.a;u.uH=0;this.$1b(u);const x=[];for(;;){if(u.uH&y.mgb)if(v)--v;else return Array.add(x,u.j3b),String.fromCharCode.apply(null,x);const z=!!(u.uH&y.WIe),A=this.Qjc(u,!0);if(z||v<A){if(Array.add(x,u.j3b),!this.$1b(u))throw Error.argument("Invalid trieID");}else if(v-=A,!this.Dsd(u))throw Error.argument("Invalid trieID");
}}Rak(v,u){let x=0;this.zbj&&(v.Jrg(this.XGn,this.TGn,0),++x);if(this.a8){var z=new a.a;z.uH=0;if(this.$1b(z))for(;;){var A=void 0;if(!({ch:A}=v.OCi()).returnValue)break;u&&(A=u(A));A=A.toString().charCodeAt(0);let D=!1;for(;!D;){const F=!!(z.uH&y.mgb);if(z.j3b===A){if(D=!0,F&&v.Jrg(!!(z.uH&y.JSg),z.pCe,x),!this.$1b(z))return}else if(x+=this.Qjc(z,!0),!this.Dsd(z))return;F&&++x}}}}$1b(v){if(!v.uH)return this.jKg(v),!0;if(!(v.uH&y.VIe))return!1;v.RWa=0;v.gz=v.dsb;this.jKg(v);return!0}Dsd(v){if(v.uH&
y.WIe)return!1;this.jKg(v);return!0}Qjc(v,u){return v.uH&y.ISg?v.wUd:v.uH&y.VIe?!u&&v.uH&y.WIe?this.Knm(v):1:0}Knm(v){v=y.Npf(v);if(!this.$1b(v))return 0;let u=0;do v.uH&y.mgb&&++u,u+=this.Qjc(v,!1);while(this.Dsd(v));return u}jKg(v){v.uH||(v.RWa=0,v.gz=this.pje);var u=this.VZd(this.Hbj,v.gz),x=u.POa;v.gz+=u.Bed;u=this.WL.hA(this.Gbj+y.Zmf*x,y.Zmf);v.j3b=u&65535;v.uH=u>>16;v.uH&y.ISg&&(v.wUd=this.qNl(v));v.uH&y.JSg&&(u=this.VZd(this.Pbj,v.gz),x=u.POa,v.gz+=u.Bed,v.pCe=this.WL.hA(this.Obj+4*x,4));
v.uH&y.Njk?(v.dsb=this.pje+((this.WL.J(v.gz)<<8|this.WL.J(v.gz+1))<<8|this.WL.J(v.gz+2)),v.gz+=3):v.uH&y.Ojk?(v.dsb=v.gz,v.RWa=v.dsb):v.uH&y.Pjk?(u=this.VZd(this.Lbj,v.gz),x=u.POa,v.gz+=u.Bed,v.dsb=this.pje+this.WL.hA(this.Kbj+4*x,4)):v.uH&y.VIe&&(u=this.VZd(this.Nbj,v.gz),x=u.POa,v.gz+=u.Bed,v.RWa||(v.RWa=v.gz),v.RWa+=this.WL.hA(this.Mbj+4*x,4),v.dsb=v.RWa)}VZd(v,u){const x=new w;let z=0;for(;;){z+=this.WL.J(u);++u;++x.Bed;const A=this.WL.hA(v,2);if(z<A)break;x.POa+=A;z-=A;v+=2;z<<=8}x.POa+=z;return x}qNl(v){let u=
this.WL.J(v.gz);192<=u?(u=(u&63)<<15|(this.WL.J(v.gz+1)&127)<<8,u|=this.WL.J(v.gz+2),v.gz+=3):128<=u?(u=(u&127)<<8|this.WL.J(v.gz+1),v.gz+=2):v.gz+=1;return u}boo(v){const u=new l;u.Smf=this.WL.hA(v+12,2);u.Xmf=this.WL.hA(v+14,2);u.Tmf=this.WL.hA(v+16,2);u.Vmf=this.WL.hA(v+18,2);u.XYh=this.WL.hA(v+24,4);u.VYh=this.WL.hA(v+28,4);u.YYh=this.WL.hA(v+32,4);u.WYh=this.WL.hA(v+36,4);u.H0h=this.WL.hA(v+40,4);return u}static Npf(v){const u=new a.a;u.j3b=v.j3b;u.uH=v.uH;u.wUd=v.wUd;u.gz=v.gz;u.dsb=v.dsb;u.RWa=
v.RWa;u.pCe=v.pCe;return u}}y.fLb=1654263084;y.jil=48;y.xUd=2;y.$mf=4;y.Zmf=4;y.mgb=1;y.WIe=2;y.ISg=4;y.JSg=8;y.VIe=16;y.Ojk=64;y.Pjk=128;y.Njk=256;Object(G.a)(y,"Trie",null,[1697])},1749:function(G,J,d){d.r(J);G=d(0);d(1567);var m=d(1587);class f{}f.Ocj=0;f.iml=1;f.pre=10;Object(G.a)(f,"AppsForOfficeStoreType",null,[]);var a=d(1565),l=d(2),w=d(96),y=d(12);class v{constructor(){this.f$e=0}zog(H,N){this.f$e=window.performance.now();this.e1a(()=>{const M=window.performance.now(),U={},O=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);N.M2k&&(U.callback=V=>{H(V,f.Ocj,M)},O&&(U.storeType=f.Ocj),l.AFrameworkApplication.va.Pb(y.a.pYb,2,U));N.N2k&&(U.callback=V=>{H(V,f.pre,M)},O?U.storeType=f.pre:l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?U.storeType=10:U.storeType=f.pre,l.AFrameworkApplication.va.Pb(y.a.pYb,2,U))},0,()=>{if(a.TellMeActor.instance.Ye)a.TellMeActor.instance.Ye.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+
(window.performance.now()-this.f$e)+" ms")})}e1a(H,N=0,M=null){2!==l.AFrameworkApplication.va.Ob(y.a.pYb,1)?(a.TellMeActor.instance.Ye&&a.TellMeActor.instance.Ye.gC(m.a.L2k,window.performance.now()-this.f$e),H()):N<v.mKn?l.AFrameworkApplication.mc.Zb(new w.a(2,1,v.aFp,()=>{this.e1a(H,N+1,M)})):M&&M()}static get instance(){v._instance||(v._instance=new v);return v._instance}}v._instance=null;v.mKn=20;v.aFp=500;Object(G.a)(v,"AddinEntitlementsQuery",null,[]);class u{constructor(){this.description=this.id=
this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.N2f=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(G.a)(u,"AddinInfo",null,[]);var x=d(1569),z=d(1572),A=d(1571),D=d(1563),F=d(142);d.d(J,"AddinResultsProvider",function(){return I});class I{constructor(H){this.t6e=[];this.kc=H;this.lYn=(N,M,U)=>{if(N){const O=N.errorCode;if(a.TellMeActor.instance.Ye){const V={};V.StoreType=M;V.ErrorCode=O;V.AddinCount=
N.value?N.value.length:0;a.TellMeActor.instance.Ye.gC(m.a.xgm,window.performance.now()-U,V)}if(0===O&&N.value){I.lKb=I.lKb||{};N=N.value;for(const V of N)N=new u,N.displayName=V[0],N.id=V[1],N.description=V[2],N.targetType=V[3],N.appVersion=4<V.length?V[4]:"",N.assetId=5<V.length?V[5]:"",N.assetStoreId=6<V.length?V[6]:"",N.width=7<V.length?V[7]:0,N.height=8<V.length?V[8]:0,N.iconUrl=9<V.length?V[9]:"",N.providerName=10<V.length?V[10]:"",N.storeId=11<V.length?V[11]:"",N.storeType=12<V.length?V[12]:
"",N.N2f=this.ixm(N),I.lKb[N.id]=N,0<N.iconUrl.length&&(M="AddinIcon_"+N.id,l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.TAj(M,N.iconUrl):appChrome.addInApi.registerAddinIcon(M,N.iconUrl))}}};v.instance.zog(this.lYn,this.kc)}sN(){return"Add-ins"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:2}hK(H,N,M,U,O=null){M=new A.a(H);O&&!Array.contains(O,27)||D.a.EU(H)||(O=new z.a(27),O.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,
this.Iwm(H.Yg,O),M.aw(O));N.Ot(M)}Iwm(H,N){if((H=this.iMo(H))&&0<H.length){let M=0;H.forEach(U=>{if(!(3<++M)){var O="AddinSuggestion"+M,V={};if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var Y="AddinIcon_"+U.id;0>Array.indexOf(this.t6e,Y)&&0<U.iconUrl.length&&this.TAj(Y,U.iconUrl);V["default"]=0<=Array.indexOf(this.t6e,Y)?Y:"AppForOfficeLogo_20"}else V["default"]=0<U.iconUrl.length?"AddinIcon_"+U.id:"AppForOfficeLogo_20";Y=[];
Y.push(appChrome.actions.setControlLabel(O,U.displayName));Y.push(appChrome.actions.setControlIconSet(O,V));Y.push(appChrome.actions.setCompoundButtonCommandValueId(O,U.id));Y.push(appChrome.actions.updateCompoundButtonDescription(O,U.description));l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(V=window.performance.now(),Y.push(appChrome.actions.updateControlEnabledDisabledState(O,!1)),a.TellMeActor.instance.Ye&&a.TellMeActor.instance.Ye.gC(m.a.z_l,
window.performance.now()-V));appChrome.api.dispatch(Y);O=new x.a(O,27,void 0,void 0,1);O.eL=Telemetry.PrivacyRules.GetPrivacyCompliantId(U.id,U.storeType,U.assetId,null,null,U.storeId);N.hy(O)}})}}TAj(H,N){F.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(H,N),Array.add(this.t6e,H))}iMo(H){if(!I.lKb)return null;const N=[],M=I.lKb;for(const O in M){var U=M[O];U&&I.nJn(H,U)&&Array.add(N,U)}return N}ixm(H){return I.Xap(H.displayName)}static nJn(H,N){if(!N.N2f)return!1;
for(const M of H.split(" ")){H=!1;for(const U of N.N2f)if(U.toLowerCase().startsWith(M.toLowerCase())){H=!0;break}if(!H)return!1}return!0}static Xap(H){const N=[];for(const M of H.split(" ")){H=0;for(let U=0;U<M.length;U++){const O=M.charAt(U);O.toString().toUpperCase()===O.toString()&&U>H&&(Array.add(N,M.substring(H,U)),H=U)}Array.add(N,M.substring(H,M.length));H&&Array.add(N,M.substring(0,M.length))}return N}}I.lKb=null;Object(G.a)(I,"AddinResultsProvider",null,[1003])},1822:function(G,J,d){d.d(J,
"a",function(){return f});G=d(0);var m=d(233);class f{constructor(){this.WXb=this.oNb=this.cXa=this.Mwb=this.Nwb=this.L7a=this.Csb=this.Lwb=this.tob=this.Asb=this.Ocb=this.uob=this.Bsb=null;this.reset()}reset(){this.Bsb=new m.a;this.uob=new m.a;this.Ocb=new m.a;this.Asb=new m.a;this.tob=new m.a;this.Lwb=new m.a;this.Csb=new m.a;this.L7a=new m.a;this.L7a=new m.a;this.Nwb=new m.a;this.Mwb=new m.a;this.cXa=[];this.oNb=[];this.WXb=[]}xDp(a){return this.CWa(this.Bsb,a)&&this.CWa(this.uob,a)&&this.CWa(this.Ocb,
a)&&this.CWa(this.Asb,a)&&this.CWa(this.tob,a)&&this.CWa(this.Lwb,a)&&this.CWa(this.Csb,a)&&this.CWa(this.L7a,a)&&this.CWa(this.Nwb,a)&&this.CWa(this.Mwb,a)}CWa(a,l){return!a||!a.length||a.length===l}}Object(G.a)(f,"MergeableTrackedChangesProperties",null,[])},1823:function(G,J,d){d.d(J,"a",function(){return a});G=d(0);var m=d(233),f=d(651);class a{constructor(){this.hQa=new m.a;this.kRa=new m.a;this.zTa=new m.a}get AKb(){return this.hQa}get bDf(){return this.kRa}get hAb(){return this.zTa}get isEmpty(){return!this.hQa.length&&
!this.kRa.length&&!this.zTa.length}get Mub(){return Math.max(Math.max(this.hQa.length,this.kRa.length),this.zTa.length)}get QMn(){return Math.min(Math.min(this.hQa.length,this.kRa.length),this.zTa.length)}HSd(l){this.hQa.add(l)}JSd(l){this.kRa.add(l)}NSd(l){this.zTa.add(l)}$9l(){const l=new f.a,w=new m.a;let y=0;for(;y<this.hQa.length||y<this.kRa.length||y<this.zTa.length;)y<this.hQa.length&&!l.contains(this.hQa.J(y))&&(w.add(this.hQa.J(y)),l.add(this.hQa.J(y))),y<this.kRa.length&&!l.contains(this.kRa.J(y))&&
(w.add(this.kRa.J(y)),l.add(this.kRa.J(y))),y<this.zTa.length&&!l.contains(this.zTa.J(y))&&(w.add(this.zTa.J(y)),l.add(this.zTa.J(y))),y++;return w}}Object(G.a)(a,"ObjectCollection",null,[])},1824:function(G,J,d){d.d(J,"a",function(){return F});G=d(0);var m=d(63),f=d(16),a=d(381),l=d(233);d(54);d(864);var w=d(651),y=d(192),v=d(196),u=d(1134),x=d(1453),z=d(1881),A=d(1667),D=d(1876);class F{constructor(I){this.JC=new u.a;this.tZ=new a.a;this.sIh=new a.a(0);this.Qwd=new l.a;this.Blh=new l.a;this.Nvh=
new l.a;this.ith=new l.a;this.$uh="";this.J2a=null;this.xt=this.l_e=0;this.hJd=new a.a(0);this.vSe=this.izh=this.dGd=0;const {MarkerValidation:H}=d(2008);this._state=I;this.nEk=new H}get Vcd(){return this.nEk}get Nwj(){return this.J2a}xYo(I){this.l_e=I}Qie(I,H){this.$uh=String.format("{0}-{1}",I,H)}hye(I){this.nrl();this.vSe=I}lAg(){this.vSe=0}nrl(){this.J2a&&this.Qwd.add(this.J2a);this.J2a=null}Oi(I){this.J2a||(this.J2a=I);switch(this.vSe){case 1:this.Blh.add(I);break;case 2:this.Nvh.add(I);break;
case 3:this.ith.add(I);break;default:this.J2a&&this.Qwd.add(I)}}i$i(I){this.Qwd.add(I)}gEn(){this.xt=this.GKa();this.qbb("MergeEnd")}qbb(I){const H=this.GKa();this.sIh.Z(I,H-this.l_e);this.l_e=H}rWo(){this.dGd=this.GKa();this.izh++}NX(I){const H=this.GKa();let N;({value:N}=this.hJd.Dc(I)).returnValue?(N+=H-this.dGd,this.hJd.Z(I,N)):this.hJd.Z(I,H-this.dGd);this.dGd=H}Kzm(){this.tZ.Z("Id",this._state.input.BVb.toString());this.tZ.Z("Source",x.a[this._state.input.source]);this.tZ.Z("RevSummary",F.i1a(this.yIm()));
this.tZ.Z("NodesRolledBackIfFailed",F.i1a(this.PBm()));if(!this._state.output.succeeded){let I,H,N,M,U;({Nbl:I,a6l:H,Erp:N,Sbl:M,Grp:U}=this.f8l(this._state.runtime));this.tZ.Z("CharactersLost",this.blm(I,H,N));this.tZ.Z("CharactersLostInComments",this.gmm());this.tZ.Z("CharactersLostInTables",this.rhm(U,M))}this.tZ.Z("FuncStep",this.$uh);this.tZ.Z("FailureDetail",F.i1a(this.HPb()));this.tZ.Z("FailDetailHints",this.L6d(this.Blh));this.tZ.Z("FailDetailNaiveMerge",this.L6d(this.Nvh));this.tZ.Z("FailDetailLcs",
this.L6d(this.ith));this.tZ.Z("ExtraDetails",this.L6d(this.Qwd));this.tZ.Z("Timeline",F.i1a(this.sIh));this.tZ.Z("ParagraphMergesCount",this.izh);this.tZ.Z("ParagraphMergeDurations",F.i1a(this.hJd));this.tZ.Z("MarkerInfo",F.i1a(this.Vcd.txi()));this.tZ.Z("Result",F.i1a(this.Mzm()));return JSON.stringify(F.i1a(this.tZ))}GKa(){return(new Date).getTime()}yIm(){const I=new a.a;let H,N,M;({KIg:H,MPg:N,dJa:M}=this.mLf(this._state,this._state.input.cda,this._state.input.k1a,this._state.input.LRb));I.Z("hasBase",
M?"true":"false");if(M){let U=0,O=0;for(;H&&!H.id.equals(M.id);)U++,H=H.KJ;for(;N&&!N.id.equals(M.id);)O++,N=N.KJ;I.Z("lenToBaseTheirs",H?U:-1);I.Z("lenToBaseYours",N?O:-1)}return I}mLf(I,H,N,M){I=H.sg(H.length-1-(M?1:0));H=(N=N.sg(N.length-1))&&I?I.PVa(N):null;return{KIg:I,MPg:N,dJa:H}}PBm(){if(!this._state.runtime.sSi)return null;const I=this._state.runtime.sv,H=new a.a(0);I.forEach((N,M)=>{({value:N}=H.Dc(M.yc.toString()));H.Z(M.yc.toString(),N+1);return!0});return H}blm(I,H,N){let M=null,U=null,
O=null;const V=this._state.runtime.sv;let Y=0;try{O=new D.a(this.JC,this._state);M=A.b(I,H,N);U=new w.a;for(I=0;I<M.length;I++)if(!M.J(I).AKb.Bt(M.J(I).hAb,(Q,S)=>Q.equals(S))){const Q=this.qgi(M.J(I),O);Y+=Q;U.add(M.J(I))}M&&V.forEach((Q,S)=>{if(S.yc===m.a.paragraphNode){S=null;for(let P=0;P<M.length;P++)if(!U.contains(M.J(P))&&M.J(P).hAb.contains(Q,(T,Z)=>T===Z)){S=M.J(P);break}S&&(Q=this.qgi(S,O),U.add(S),Y+=Q)}return!0});return Y}catch(Q){return y.a.instance.Ua(579190992,1,2,"Exception in GetCharactersLost: "+
Q.toString()),-1}}f8l(I){let H,N,M,U,O;I.dJ=Y=>{if(750<this.GKa()-this._state.input.X_a)throw y.a.instance.Ua(579190991,1,2,"Timed out while calculating characters lost: {0}",Y),v.a.invalidOperation(Y);};H=new l.a;N=new l.a;M=new l.a;U=new l.a;const V=new l.a;O=new l.a;try{if(I.In){const Y=I.In.J(z.ChildNodeListMerge.upe);let Q,S;Q=I.NA.J(z.ChildNodeListMerge.upe)||Y;S=I.sv.J(z.ChildNodeListMerge.upe)||Y;this.FDf(Y,P=>I.In.J(P),H,U);this.FDf(Q,P=>I.NA.J(P)||I.In.J(P),N,V);this.FDf(S,P=>I.sv.J(P)||
I.In.J(P),M,O)}}catch(Y){y.a.instance.Ua(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+Y.toString())}return{Nbl:H,a6l:N,Erp:M,Sbl:U,Grp:O}}rhm(I,H){try{let M=0;const U=this._state.runtime;var N=Y=>U.sv.J(Y)||U.In.J(Y);const O=new w.a,V=this.U9l(I,U,N,O);for(I=0;I<V.count;I++){let Y=V.keys.J(I);const Q=V.J(Y);if(!O.contains(Y)){let S=this.tIi(U,N,O,Y,Q);if(-1!==S)M+=S;else return y.a.instance.Ua(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(N=
0;N<H.length;N++){let Y=H.J(0);if(!O.contains(Y)){let Q=this.W9d(U.In.J(Y));if(-1===Q)return y.a.instance.Ua(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;M+=Q}}return M}catch(M){return y.a.instance.Ua(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+M.toString()),-1}}tIi(I,H,N,M,U){I.dJ("GetTableCharactersLost");let O=0;U=this.JC.getPropertyObjectIds(U,f.a.wg);for(let P=0;P<U.length;P++){var V=H(U.J(P));V=this.JC.getPropertyObjectIds(V,f.a.wg);for(let T=
0;T<V.length;T++){var Y=H(V.J(T));if(I.In.J(U.J(P))&&I.In.J(V.J(T))){var Q=I.In.J(V.J(T));if(!Q)return y.a.instance.Ua(573089737,1,2,"Base cell unexpectedly null"),-1;Y=this.JC.getPropertyObjectIds(Q,f.a.wg);var S=I.NA.J(V.J(T))||I.In.J(V.J(T));S=this.JC.getPropertyObjectIds(S,f.a.wg);Q=this.JC.getPropertyObjectIds(Q,f.a.wg);Y=A.b(Y,S,Q);for(Q=0;Q<Y.length;Q++){S=Y.J(Q);const Z=this.iNm(I,H,N,S);if(-1===Z)return y.a.instance.Ua(573089738,1,2,"Error getting characters lost for parition {0}",S.toString()),
-1;O+=Z}}else{Q=this.ZNm(H,Y,N);if(-1===Q)return y.a.instance.Ua(573089736,1,2,"Error getting text length of cell {0}",Y.id.toString()),-1;O+=Q}}}N.add(M);return O}iNm(I,H,N,M){let U=0;var O=new l.a,V=new l.a;const Y=new a.a;new a.a;for(var Q=0;Q<M.AKb.length;Q++){var S=I.In.J(M.AKb.J(Q));S=this.JC.getPropertyObjectIds(S,f.a.$H);if(1!==S.length)return y.a.instance.Ua(573089739,1,2,"Unexpected number of ContentNodes: {0}",S.length),-1;var P=I.In.J(S.J(0));P.yc===m.a.paragraphNode?O.add(P):P.yc===m.a.xp&&
Y.add(S.J(0),P)}for(Q=0;Q<M.hAb.length;Q++){S=H(M.hAb.J(Q));S=this.JC.getPropertyObjectIds(S,f.a.$H);if(1!==S.length)return y.a.instance.Ua(573089740,1,2,"Unexpected number of ContentNodes: {0}",S.length),-1;P=H(S.J(0));if(P.yc===m.a.paragraphNode)V.add(P);else if(P.yc===m.a.xp){P=this.tIi(I,H,N,S.J(0),P);if(-1===P)return y.a.instance.Ua(573089741,1,2,"Error diffing table {0}",S.J(0).toString()),-1;U+=P}}Q=new D.a(this.JC,this._state);if(0<O.length&&0<V.length){O=Q.uoi(O,T=>I.In.J(T),V,T=>H(T));if(-1===
O)return y.a.instance.Ua(573089742,1,2,"Problem diffing parition {0} with LCS",M.toString()),-1;U+=O}else if(0<O.length)for(M=0;M<O.length;M++)U+=this.JC.getPropertyString(O.J(M),f.a.Un).length+1;else if(0<V.length)for(M=0;M<V.length;M++)U+=this.JC.getPropertyString(V.J(M),f.a.Un).length+1;for(M=0;M<Y.count;M++)if(O=Y.keys.J(M),!N.contains(O)){V=this.W9d(Y.J(O));if(-1===V)return y.a.instance.Ua(573089743,1,2,"Error getting length of table {0}",O.toString()),-1;U+=V}return U}ZNm(I,H,N){let M=0;H=this.JC.getPropertyObjectIds(H,
f.a.wg);for(let V=0;V<H.length;V++){var U=I(H.J(V));U=this.JC.getPropertyObjectIds(U,f.a.$H);if(1!==U.length)return y.a.instance.Ua(573089744,1,2,"Unexpected number of ContentNodes: {0}",U.length),-1;var O=I(U.J(0));if(O.yc===m.a.paragraphNode)M+=this.JC.getPropertyString(O,f.a.Un).length+1;else if(O.yc===m.a.xp){O=this.W9d(O);if(-1===O)return y.a.instance.Ua(573089745,1,2,"Problem finding text length of table {0}",U.J(0).toString()),-1;M+=O;N.add(U.J(0))}}return M}W9d(I){this._state.runtime.dJ("GetTextLengthOfTable");
let H=0;const N=Y=>this._state.runtime.sv.J(Y)||this._state.runtime.In.J(Y);I=this.JC.getPropertyObjectIds(I,f.a.wg);for(let Y=0;Y<I.length;Y++){var M=N(I.J(Y));M=this.JC.getPropertyObjectIds(M,f.a.wg);for(let Q=0;Q<M.length;Q++){var U=N(M.J(Q));U=this.JC.getPropertyObjectIds(U,f.a.wg);for(let S=0;S<U.length;S++){var O=N(U.J(S));O=this.JC.getPropertyObjectIds(O,f.a.$H);if(1!==O.length)return y.a.instance.Ua(573089746,1,2,"Unexpected number of ContentNodes: {0}",O.length),-1;var V=N(O.J(0));if(V.yc===
m.a.paragraphNode)H+=this.JC.getPropertyString(V,f.a.Un).length+1;else if(V.yc===m.a.xp){V=this.W9d(V);if(-1===V)return y.a.instance.Ua(573089747,1,2,"Error finding the text length of table {0}",O.J(0)),-1;H+=V}}}}return H}U9l(I,H,N,M){const U=new a.a;for(let O=0;O<I.length;O++){let V=!1;H.sv.J(I.J(O))&&(V=!0);const Y=N(I.J(O)),Q=this.JC.getPropertyObjectIds(Y,f.a.wg);if(!V)for(let S=0;S<Q.length;S++)if(H.sv.J(Q.J(S))){V=!0;break}V?U.add(I.J(O),Y):M.add(I.J(O))}return U}qgi(I,H){return this.pgi(I.AKb,
I.hAb,H)}pgi(I,H,N){const M=new l.a;for(var U=0;U<I.length;U++)M.add(this._state.runtime.In.J(I.J(U)));I=new l.a;for(U=0;U<H.length;U++)I.add(this._state.runtime.sv.J(H.J(U))||this._state.runtime.In.J(H.J(U)));return N.uoi(M,O=>this._state.runtime.In.J(O),I,O=>this._state.runtime.sv.J(O)||this._state.runtime.In.J(O))}FDf(I,H,N,M){if(I.yc===m.a.Sh){I=this.JC.getPropertyObjectIds(I,f.a.wg);for(let U=0;U<I.length;U++){const O=this.JC.getPropertyObjectIds(H(I.J(U)),f.a.wg);for(let V=0;V<O.length;V++){const Y=
this.JC.getPropertyObjectIds(H(O.J(V)),f.a.wg);for(let Q=0;Q<Y.length;Q++){const S=this.JC.getPropertyObjectIds(H(Y.J(Q)),f.a.$H);if(1!==S.length)return;const P=H(S.J(0));P.yc===m.a.paragraphNode?N.add(S.J(0)):P.yc===m.a.xp?M.add(S.J(0)):y.a.instance.Ua(573089748,1,2,"Unsupported class id in GetCharactersLost: "+m.a[P.yc])}}}}}GDf(I,H){I=this.JC.getPropertyObjectIds(I,f.a.wg);const N=new l.a;for(let M=0;M<I.length;M++){const U=this.JC.getPropertyObjectIds(H(I.J(M)),f.a.$H);if(1!==U.length)return null;
N.add(U.J(0))}return N}gmm(){let I=0;const H=this._state.runtime,N=H.sv,M=O=>H.sv.J(O)||H.In.J(O);let U=null;H.dJ=O=>{if(750<this.GKa()-this._state.input.X_a)throw y.a.instance.Ua(573089749,1,2,"Timed out while calculating comment characters lost: {0}",O),v.a.invalidOperation(O);};try{N.forEach((O,V)=>{if(V.yc===m.a.lL){O=this.GDf(V,M);var Y=H.In.J(V.id);if(Y)Y=this.GDf(Y,S=>H.In.J(S)),U||(U=new D.a(this.JC,this._state)),I+=this.pgi(Y,O,U);else for(Y=0;Y<O.length;Y++)I+=this.JC.getPropertyString(H.sv.J(O.J(Y)),
f.a.Un).length+1}if(V.yc===m.a.bka&&(O=this.JC.getPropertyObjectIds(V,f.a.wg).BS(),V=H.In.J(V.id)))for(V=this.JC.getPropertyObjectIds(V,f.a.wg),Y=0;Y<V.length;Y++)if(!O.contains(V.J(Y))){var Q=H.In.J(V.J(Y));Q=this.GDf(Q,S=>H.In.J(S));for(let S=0;S<Q.length;S++)I+=this.JC.getPropertyString(H.In.J(Q.J(S)),f.a.Un).length+1}return!0})}catch(O){return y.a.instance.Ua(573089750,1,2,"Exception in GetCommentCharactersLost: "+O.toString()),-1}return I}HPb(){return this.J2a?this.J2a.HPb():null}L6d(I){const H=
new l.a;I.forEach(N=>{H.add(F.i1a(N.HPb()));return!0});return H.toArray()}Mzm(){const I=new a.a;I.Z("Succeeded",this._state.output.succeeded);I.Z("Timeout",this._state.output.timeout);I.Z("Crash",this._state.output.fAa);I.Z("MergedRevisions",this._state.output.XL?this._state.output.XL.length:-1);I.Z("Duration",this.xt-this._state.input.X_a);return I}static i1a(I){if(!I)return null;const H={};I.forEach((N,M)=>{H[N.toString()]=M;return!0});return H}}Object(G.a)(F,"MergeLogger",null,[])},1825:function(G,
J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a){this.EPa=a;this.AK=f}}Object(G.a)(m,"UpdateHintCollection",null,[])},1826:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(1638);class m extends d.a{constructor(f,a){super();this.Rg=f;this.Yc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Rg,this.Yc)}}Object(G.a)(m,"LcsInsertParaUpdateHint",d.a,[])},1827:function(G,J,d){d.d(J,"a",function(){return f});
G=d(0);var m=d(233);d=d(1638);class f extends d.a{constructor(a){super();this.s3=new m.a;this.cp=a}get type(){return 11}toString(){let a="";for(let l=0;l<this.s3.length;l++)a+=String.format("({0}), ",this.s3.J(l).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(G.a)(f,"LcsInsertUpdateHint",d.a,[])},1828:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(1638);class m extends d.a{constructor(f,a){super();this.text=a;this.Rg=f}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",
this.cp,this.type,this.Rg,this.text)}}Object(G.a)(m,"LcsInsertTextUpdateHint",d.a,[])},1829:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(1638);class m extends d.a{constructor(f,a,l){super();this.cp=f;this.Rg=a;this.Yc=l}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Rg,this.Yc)}}Object(G.a)(m,"LcsDeleteParaUpdateHint",d.a,[])},1830:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(1638);class m extends d.a{constructor(f,
a){super();this.cp=f;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(G.a)(m,"LcsDeleteTextUpdateHint",d.a,[])},1831:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(1612);class m extends d.a{constructor(){super()}get tfa(){return"Conflict"}}Object(G.a)(m,"ConflictMergeFailureDetail",d.a,[])},1832:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);d=d(1612);class m extends d.a{constructor(){super()}get tfa(){return"TableMerge"}}
Object(G.a)(m,"TableMergeFailureDetail",d.a,[])},1833:function(G,J,d){d.d(J,"a",function(){return a});G=d(0);var m=d(240),f=d(19);class a{constructor(l,w,y,v,u){this.c8e=l;this.b8e=w;this.fQk=y;this.oyk=v;this.mmh=u}get LZb(){return 4}pka(l,w=null){w=w.sessionId+"|"+w.xta+"|"+l.DE;if(this.mmh||this.oyk){let y=this.mmh||f.a.sC(CommonUIStrings.l_HelpTooltip)===f.a.sC(l.DE.trim());if(this.fQk&&2<l.DE.length){const v=l.DE;";"===v.charAt(0)&&";"===v.charAt(v.length-1)&&v.substring(1,v.length-1)===a.cTf&&
(y=!0)}l=y?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,l.DE);return this.Isi(w,f.a.Hf(l),y)}return this.Isi(w,f.a.Hf(String.format(CommonUIStrings.l_TextWithQuotation,l.DE)),!1)}Isi(l,w,y){return m.a(a.cTf,y?this.b8e:this.c8e,w,"OfficeAssistant_16x16x32","A0",f.a.Hf(l),w,null,null)}}a.cTf="bSearchHelp";Object(G.a)(a,"AssistanceMenuItemFactory",null,[1545])},1834:function(G,J,d){d.d(J,"a",function(){return w});G=d(0);var m=d(2),f=d(240),a=d(101),
l=d(19);class w{get LZb(){return 13}pka(){return w.Ofl()}static Ofl(){return f.b(w.xpi,"798637440",l.a.Hf(CommonUIStrings.l_LookupFirstRunExperienceTitle),m.AFrameworkApplication.Ys,a.getImageClass("Info_32x32x32"),null,null,l.a.Hf(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,l.a.Hf(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}w.xpi="bTellMeFirstRun";Object(G.a)(w,"FirstRunMenuItemFactory",null,[1545])},1835:function(G,J,d){d.d(J,"a",function(){return m});
G=d(0);class m{}m.ITi="bInsights";Object(G.a)(m,"InsightsMenuItemFactoryStatic",null,[])},1836:function(G,J,d){d.d(J,"a",function(){return l});G=d(0);var m=d(2),f=d(240),a=d(19);class l{constructor(w=null,y=null){this.lwh=w;this.GFk=y||CommonUIStrings.l_LookupNoResultsDescription}get LZb(){return 14}pka(w){w=String.format(this.GFk,w.DE);return this.Agl(w)}Agl(w){return f.b(l.phj,"798637440",a.a.Hf(CommonUIStrings.l_LookupNoResultsTitle),this.lwh?m.AFrameworkApplication.Ys:null,this.lwh,null,null,
a.a.Hf(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.Hf(w),null,null)}}l.phj="lookupNoResults";Object(G.a)(l,"NoCommandsFoundMenuItemFactory",null,[1545])},1837:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(f,a){this.FontWeight=0;this.Text=null;this.FontWeight=f;this.Text=a}}Object(G.a)(m,"LabelFormatted",null,[])},1838:function(G,J,d){d.d(J,"a",function(){return y});G=d(0);d(1567);var m=d(1569),f=d(1572),a=d(1571),l=d(1563),w=d(19);class y{constructor(v){this.kc=
v}sN(){return"Assistance"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:this.kc.igd?3:2}hK(v,u,x=!1,z,A=null){z=new a.a(v);if((!A||Array.contains(A,8))&&!l.a.EU(v)){A=new f.a(8);if(x){x=w.a.sC(CommonUIStrings.l_HelpTooltip)===w.a.sC(v.Yg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,v.Yg);const D=[];this.kc.Pab&&(this.kc.Dze||D.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),x=this.eDi(v.Yg));const F=
"||"+v.Yg;D.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",x));D.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",F));appChrome.api.dispatch(D);v=new m.a("GetHelpFromTellMe",4,v.Yg,null,1)}else v=new m.a("bSearchHelp",4,v.Yg,null,1);A.hy(v);A.displayName=CommonUIStrings.l_HelpButtonTitle;z.aw(A)}u.Ot(z)}Grb(v,u=null){const x=new f.a(8),z=w.a.sC(CommonUIStrings.l_HelpTooltip)===w.a.sC(v.Yg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
v.Yg);for(let D=0;D<u.length&&2>D;D++){var A=[];let F="GetHelpWithDescriptionFromTellMe"+(D+1).toString(),I=4;if(this.kc.npd)A.push(appChrome.actions.setControlLabel(F,z)),A.push(appChrome.actions.setCompoundButtonCommandValueId(F,v.Yg)),A.push(appChrome.actions.updateCompoundButtonDescription(F,this.tPf(u.length)));else if(this.kc.opd){let H=this.GJi(u[D]);F="GetHelpFromTellMe"+(D+1).toString();this.kc.Pab&&(H=this.eDi(H));I=9;A.push(appChrome.actions.setControlLabel(F,H));A.push(appChrome.actions.setButtonCommandValueId(F,
this.OOm(u[D])))}appChrome.api.dispatch(A);A=new m.a(F,I,null,null,0);A.label=this.GJi(u[D]);A.description=this.NOm(u[D]);x.hy(A);if(this.kc.opd)break}x.displayName=CommonUIStrings.l_HelpButtonTitle;return x}tPf(v){return 1===v?String.format(CommonUIStrings.l_SearchResultText,v):String.format(CommonUIStrings.l_SearchResultsText,v)}eDi(v){return this.kc.h1f?l.a.pKf(v,CommonUIStrings.l_HelpScopedButtonText):v+CommonUIStrings.l_HelpScopedButtonText}GJi(v){return v.name?v.name:""}NOm(v){return v.description?
v.description:""}OOm(v){return v.id?"AssetID="+v.id:""}}Object(G.a)(y,"AssistanceResultsProvider",null,[1003])},1839:function(G,J,d){d.d(J,"a",function(){return v});G=d(0);d(1567);var m=d(1569),f=d(1572),a=d(1571),l=d(1565),w=d(1563),y=d(1611);class v{constructor(u){this.kc=u}sN(){return"Image"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:3===this.kc.hw?3:2}hK(u,x,z,A,D=null){z=new a.a(u);(!D||Array.contains(D,19))&&w.a.EU(u)&&this.kc.uS&&this.Grb(u,z,1);x.Ot(z)}Grb(u,x,z,A=null){var D=[];let F;
l.TellMeActor.instance.yR()&&l.TellMeActor.instance.yR().Pab?(F=this.kc.h1f?w.a.pKf(u.Yg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):u.Yg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.kc.Dze||D.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):F=this.kc.uS?w.a.EU(u)?this.kc.vmb?w.a.tqb(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.kc.vmb?w.a.tqb(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
u.Yg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,u.Yg):this.kc.Nxc?CommonUIStrings.l_TellMeImageSuggestionButtonText:u.Yg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.kc.KBa?(l.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",F)),D=w.a.OUa(u.Yg,9,Object.assign(new y.a,{landingTab:"Image"})),l.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",D))):(D.push(appChrome.actions.setControlLabel("ImageForSearch",
F)),u=w.a.OUa(u.Yg,9,Object.assign(new y.a,{landingTab:"Image"})),D.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",u)),appChrome.api.dispatch(D));z=new m.a("ImageForSearch",12,null,null,z);A&&(z.score=A.ConfidenceScore);A=new f.a(19,this.kc.Nxc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);A.hy(z);x.aw(A)}}Object(G.a)(v,"ImageResultsProvider",null,[1003])},1840:function(G,J,d){d.d(J,"a",function(){return y});G=d(0);d(1567);var m=d(1569),f=d(1572),a=d(1571),
l=d(1563),w=d(2);class y{constructor(v){this.kc=v}sN(){return"Template"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:3}hK(v,u){v=new a.a(v);u.Ot(v)}Grb(v,u,x){var z=[];let A;A=this.kc.uS?this.kc.vmb?l.a.tqb(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,v.Yg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,v.Yg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,v.Yg);z.push(appChrome.actions.setControlLabel("TemplateForSearch",A));z.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(w.AFrameworkApplication.K.kb("TellMeTemplateProviderURL"),w.AFrameworkApplication.uiCulture,v.Yg)));appChrome.api.dispatch(z);v=new f.a(23);v.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;z=new m.a("TemplateForSearch",24,null,null,0);z.label=x[0].Title?x[0].Title:"";z.description=x[0].Description?x[0].Description:"";v.hy(z);u.aw(v)}}Object(G.a)(y,"TemplateResultsProvider",null,[1003])},1841:function(G,J,d){d.d(J,"a",function(){return x});G=d(0);d(1567);var m=d(1614),f=d(1569),
a=d(1572),l=d(1571),w=d(1714),y=d(1565),v=d(1563),u=d(19);class x{constructor(z,A,D,F){this.a6=z;this.zlb=A;this.ZIh=F;this.Mvk=D;this.kc=y.TellMeActor.instance.yR()}sN(){return"EmptyQuery"}kX(){return 1===this.kc.hw?1:0}hK(z,A,D=!1,F,I=null){F=new l.a(z);if((!I||Array.contains(I,5)||Array.contains(I,6)||Array.contains(I,4))&&v.a.EU(z)){this.a6.G2c().length||!this.Mvk||this.ZIh||(z=new a.a(6),I=new f.a(null,13,void 0,void 0,1),z.hy(I),F.aw(z));z=new a.a(4);if(0<this.a6.G2c().length){z.displayName=
CommonUIStrings.l_TellMeRecentlyUsedTitle;I=this.a6.G2c();var H=[];for(var N of I)H.push(N.Id);m.CommandResultsUtility.ptd(H,this.kc);for(var M of I)m.CommandResultsUtility.X8c(M.Id)&&z.hy(new f.a(M.Id,5,null,null,2));F.aw(z)}if(this.ZIh&&0<this.zlb.length&&this.a6.G2c().length<x.maxResults){N=new a.a(5);N.displayName=CommonUIStrings.l_TellMeTryQueryTitle;M=x.maxResults-z.results.length;z=[];for(I=0;I<this.zlb.length&&I<M;++I){if(D){H=v.a.PKg+(I+1);const U=this.zlb[I].key,O=u.a.replaceAll(U,'"',"");
z.push(appChrome.actions.setControlLabel(H,U));z.push(appChrome.actions.setButtonCommandValueId(H,O));H=new w.a(U,7,0,O,H)}else H=new w.a(this.zlb[I].key,7,0,this.zlb[I].value);N.hy(H)}0<z.length&&appChrome.api.dispatch(z);F.aw(N)}}A.Ot(F)}}x.maxResults=5;Object(G.a)(x,"EmptyQueryResultsProvider",null,[1003])},1842:function(G,J,d){d.d(J,"a",function(){return m});G=d(0);class m{constructor(){this.pCe=this.RWa=this.dsb=this.gz=this.wUd=this.uH=this.j3b=0}}Object(G.a)(m,"TRIESCAN",null,[])},1871:function(G,
J,d){d.r(J);var m=d(0),f=d(1567),a=d(1626),l=d(1587),w=d(1569),y=d(1572),v=d(1571),u=d(1565),x=d(1563),z=d(1611);class A{constructor(gb){this.kc=gb}sN(){return"ActionAI"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:2}hK(gb,Mb,hc=!1,Kc,Vc=null){Kc=new v.a(gb);if(!Vc||Array.contains(Vc,24))if(this.J3o()||!x.a.EU(gb)){Vc=new y.a(24);var od=x.a.EU(gb);hc&&(hc=null,x.a.Vta()&&(hc=x.a.OUa(od?"":gb.Yg,1,Object.assign(new z.a,{landingTab:"ActionAI"}))),this.kc.KBa?hc&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",
hc)):(gb=[],hc&&gb.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",hc)),appChrome.api.dispatch(gb)));Vc.hy(new w.a("ActionAIFromTellMe",25,null,null,1));Kc.aw(Vc)}Mb.Ot(Kc)}J3o(){return x.a.Vta()&&this.kc.qXf}}Object(m.a)(A,"ActionAIResultsProvider",null,[1003]);var D=d(1749);class F{constructor(gb,Mb){this.BFa=gb;this.Al=Mb}Ot(gb){this.BFa.tXo(this.Al,gb)}}Object(m.a)(F,"AggregatorResultsProviderCallback",null,[1593]);class I{constructor(gb){this.Ewa=null;this.kc=gb;this.kc.uKb&&
(this.Ewa=null)}sN(){return"AppsForOffice"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:2}hK(gb,Mb,hc,Kc,Vc=null){hc=new v.a(gb);if(!Vc||Array.contains(Vc,1))Vc=new y.a(1),this.Ewa.OSp(Vc,gb.Yg),hc.aw(Vc);Mb.Ot(hc)}}Object(m.a)(I,"AppsForOfficeRecommendationResultsProvider",null,[1003]);var H=d(1838),N=d(1560),M=d(1579),U=d(122);class O{constructor(gb,Mb){this.Bb=gb;this.WGn=Mb}isMatch(gb,Mb){if(!Object(U.a)(1662,gb))throw Error.argument("objToTest","Expected feature bundle");let hc;return({value:hc}=
gb.xr(this.Bb.wza)).returnValue?this.Bb.iOg.isMatch(hc,Mb):this.WGn}}Object(m.a)(O,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1690]);class V{constructor(gb,Mb){this.Bb=gb;this.F7f=Mb}isMatch(gb){if(!Object(U.a)(1662,gb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.F7f^gb.xr(this.Bb.wza).returnValue)}}Object(m.a)(V,"AnnotatedWithAnnotationFilter",null,[1690]);class Y{constructor(gb){this.Bb=gb}isMatch(gb,Mb){if(!Object(U.a)(1666,gb))throw Error.argument("objToTest",
"Expected struct value");return this.Bb.iOg.isMatch(gb.Lqb(this.Bb.yVa),Mb)}}Object(m.a)(Y,"FieldValueMatchesStructFilter",null,[1690]);class Q{constructor(gb,Mb){gb&&(this.yVa=gb.J(0),this.iOg=Mb.Jsa(gb.J(1)))}}Object(m.a)(Q,"FieldValueMatchesStructFilterInit",null,[]);class S{constructor(gb){this.F7f=gb}isMatch(gb){if(!Object(U.a)(1662,gb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.F7f^gb.kSf)}}Object(m.a)(S,"HasAnnotationsAnnotationFilter",null,[1690]);class P{constructor(gb,
Mb){this.Bb=gb;this.Uba=Mb}isMatch(gb,Mb){if(!Object(U.a)(1665,gb))throw Error.argument("objToTest","Expected list value");switch(this.Uba){case 0:for(const hc of gb.items)if(this.Bb.filter.isMatch(hc,Mb))return!0;return!1;case 1:for(const hc of gb.items)if(!this.Bb.filter.isMatch(hc,Mb))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(P,"ItemTestListFilter",null,[1690]);class T{constructor(gb){this.Bb=gb}isMatch(gb,Mb){if(!Object(U.a)(1665,gb))throw Error.argument("objToTest",
"Expected list value");return this.Bb.filter.isMatch(gb.items.length,Mb)}}Object(m.a)(T,"LengthMatchesListFilter",null,[1690]);class Z{constructor(gb,Mb){this.Bb=gb;this.Uba=Mb}isMatch(gb,Mb,hc=null){let Kc=0===this.Uba;for(const Vc of this.Bb.s2h)if((Kc=Vc.isMatch(gb,Mb,hc))?1===this.Uba:0===this.Uba)return Kc;2===this.Uba&&(Kc=!Kc);return Kc}}Object(m.a)(Z,"NonterminalFilter",null,[1690]);class X{constructor(gb,Mb){if(gb){var hc=gb.J(0);this.s2h=Array(hc);for(let Kc=0;Kc<hc;++Kc)this.s2h[Kc]=Mb.Jsa(gb.J(1+
Kc))}}}Object(m.a)(X,"NonterminalFilterInit",null,[]);class aa{constructor(gb,Mb){this.Bb=gb;this.Uba=Mb}isMatch(gb,Mb){if("number"!==typeof gb)throw Error.argument("objToTest","Expected number value");let hc=this.Bb.number;if(this.Bb.query){Mb=this.Bb.query.Gu(null,Mb);if("number"!==typeof Mb)throw Error.invalidOperation("Query did not return number");hc+=Mb}switch(this.Uba){case 0:return gb===hc;case 1:return gb<hc;case 2:return gb<=hc;case 3:return gb>hc;case 4:return gb>=hc;default:throw Error.notImplemented();
}}}Object(m.a)(aa,"NumberFilter",null,[1690]);class ia{constructor(gb,Mb){gb&&(this.number=gb.J(0),this.query=gb.J(1)?Mb.lN(gb.J(1)):null)}}Object(m.a)(ia,"NumberFilterInit",null,[]);class wa{constructor(gb,Mb,hc){this.M6d=this.Jrm;this.bHn=gb;this.Dbj=Mb;this.Cbj=hc}sof(gb){this.Dbj=gb}Jrm(gb){if(!gb)throw Error.argument("name","Invalid named feature bundle reference");const Mb=gb.substr(1);return 1===gb.charCodeAt(0)&&Mb===this.bHn?this.Dbj:this.Cbj?this.Cbj.M6d(gb):null}}Object(m.a)(wa,"SimpleNamedFeatureBundleResolver",
null,[1702]);class ma{constructor(gb){this.Bb=gb}isMatch(gb,Mb){if(!Object(U.a)(1662,gb))throw Error.argument("objToTest","Expected feature bundle");gb=this.Bb.query.Gu(null,new wa(this.Bb.lGe,gb,Mb));if("boolean"!==typeof gb)throw Error.invalidOperation("Query did not return bool");return gb}}Object(m.a)(ma,"PredicateAnnotationFilter",null,[1690]);class na{constructor(gb,Mb){gb&&(this.lGe=Mb.kD(gb.J(0)),this.query=Mb.lN(gb.J(1)))}}Object(m.a)(na,"PredicateAnnotationFilterInit",null,[]);class Fa{constructor(gb){this.Bb=
gb}isMatch(gb,Mb){if("boolean"!==typeof gb)throw Error.argument("objToTest","Expected bool value");Mb=this.Bb.query.Gu(null,Mb);if("boolean"!==typeof Mb)throw Error.invalidOperation("Query did not return bool");return gb===Mb}}Object(m.a)(Fa,"QueryBooleanFilter",null,[1690]);class Qa{constructor(gb,Mb){this.Bb=gb;this.Uba=Mb}isMatch(gb,Mb){if("number"!==typeof gb)throw Error.argument("objToTest","Expected integer");Mb=this.Bb.query.Gu(null,Mb);if("number"!==typeof Mb)throw Error.invalidOperation("Query did not return an enum value");
switch(this.Uba){case 0:return gb===Mb;case 1:return 0!==(gb&Mb);case 2:return gb===(gb&Mb);case 3:return Mb===(gb&Mb);default:throw Error.notImplemented();}}}Object(m.a)(Qa,"QueryEnumFilter",null,[1690]);class ya{constructor(gb,Mb){gb&&(this.pfe=1===gb.J(0),this.query=Mb.lN(gb.J(1)))}}Object(m.a)(ya,"QueryEnumFilterInit",null,[]);class ta{constructor(gb,Mb){this.Bb=gb;this.Uba=Mb}isMatch(gb,Mb){if(!Object(U.a)(1665,gb))throw Error.argument("objToTest","Expected list value");Mb=this.Bb.query.Gu(null,
Mb);if(!Object(U.a)(1665,Mb))throw Error.invalidOperation("Query did not return list value");if(gb.d8!==Mb.d8)return!1;switch(this.Uba){case 0:return N.Annotations.AAb(N.Annotations.Pym(gb.d8),gb,Mb);case 1:for(const hc of gb.items)for(const Kc of Mb.items)if(N.Annotations.AAb(gb.d8,hc,Kc))return!0;return!1;case 2:for(const hc of gb.items)for(const Kc of Mb.items)if(!N.Annotations.AAb(gb.d8,hc,Kc))return!1;return!0;case 3:for(const hc of Mb.items)for(const Kc of gb.items)if(!N.Annotations.AAb(gb.d8,
hc,Kc))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(ta,"QueryListFilter",null,[1690]);class Aa{constructor(gb,Mb){this.Bb=gb;this.Uba=Mb}isMatch(gb,Mb){if("string"!==typeof gb)throw Error.argument("objToTest","Expected string");Mb=this.Bb.query.Gu(null,Mb);if("string"!==typeof Mb)throw Error.invalidOperation("Query did not return string");this.Bb.MXf&&(gb=gb.toUpperCase(),Mb=Mb.toUpperCase());switch(this.Uba){case 0:return gb===Mb;case 1:return 0<=gb.indexOf(Mb);case 2:return gb.startsWith(Mb);
case 3:return gb.endsWith(Mb);case 4:return 0<=Mb.indexOf(gb);case 5:return Mb.startsWith(gb);case 6:return Mb.endsWith(gb);default:throw Error.notImplemented();}}}Object(m.a)(Aa,"QueryStringFilter",null,[1690]);class oa{constructor(gb,Mb){gb&&(this.query=Mb.lN(gb.J(0)),this.MXf=1===gb.J(1))}}Object(m.a)(oa,"QueryStringFilterInit",null,[]);class za{constructor(gb){this.Bb=gb}isMatch(gb,Mb){if(!Object(U.a)(1666,gb))throw Error.argument("objToTest","Expected struct value");Mb=this.Bb.query.Gu(null,
Mb);if(!Object(U.a)(1666,Mb))throw Error.invalidOperation("Query did not return struct value");return gb.isEqual(gb)}}Object(m.a)(za,"QueryStructFilter",null,[1690]);class ja{constructor(gb){this.Bb=gb}isMatch(gb,Mb){gb=this.Bb.query.Gu(null,Mb);if("boolean"!==typeof gb)throw Error.invalidOperation("Query did not return bool");return gb}}Object(m.a)(ja,"QueryWhereConstraintFilter",null,[1690]);class fa{constructor(gb){this.Bb=gb}isMatch(gb){if("string"!==typeof gb)throw Error.argument("objToTest",
"Expected string");return this.Bb.Yqg.test(gb)}}Object(m.a)(fa,"RegexStringFilter",null,[1690]);class Ca{constructor(gb,Mb){gb&&(this.Yqg=Mb.Ykc(gb.J(0)))}}Object(m.a)(Ca,"RegexStringFilterInit",null,[]);class xa{constructor(gb,Mb){gb&&(this.filter=Mb.Jsa(gb.J(0)))}}Object(m.a)(xa,"SingleFilterFilterInit",null,[]);class ua{constructor(gb,Mb){gb&&(this.query=Mb.lN(gb.J(0)))}}Object(m.a)(ua,"SingleQueryFilterInit",null,[]);class sa{constructor(gb){this.Bb=gb}isMatch(gb){if("boolean"!==typeof gb)throw Error.argument("objToTest",
"Expected bool value");return gb===this.Bb.value}}Object(m.a)(sa,"StoredValueBooleanFilter",null,[1690]);class Ea{constructor(gb){gb&&(this.value=1===gb.J(0))}}Object(m.a)(Ea,"StoredValueBooleanFilterInit",null,[]);class Ja{constructor(gb,Mb){this.Bb=gb;this.Uba=Mb}isMatch(gb){if("number"!==typeof gb)throw Error.argument("objToTest","Expected integer");switch(this.Uba){case 0:return this.Bb.pfe?this.Bb.value?!!(gb&this.Bb.value):!gb:gb===this.Bb.value;case 1:return this.Bb.pfe?(gb&this.Bb.value)===
this.Bb.value:32>gb&&(1<<gb&this.Bb.value)===this.Bb.value;case 2:return this.Bb.pfe?!!(gb&this.Bb.value):32>gb&&!!(1<<gb&this.Bb.value);default:throw Error.notImplemented();}}}Object(m.a)(Ja,"StoredValueEnumFilter",null,[1690]);class nb{constructor(gb){gb&&(this.pfe=1===gb.J(0),this.value=gb.J(1))}}Object(m.a)(nb,"StoredValueEnumFilterInit",null,[]);class ub{constructor(){this.d9n=null;this.Ymf=this.HRb=0}}Object(m.a)(ub,"WHEREConstraintData",null,[]);class Yb{constructor(gb){this.Bb=gb}isMatch(gb,
Mb){if(!Object(U.a)(ub,gb))throw Error.argument("objToTest","Expected WHERE constraint data");let hc=-1,Kc=-1;const Vc=gb.d9n;switch(this.Bb.dof){case 4:hc=Vc.W0c;Kc=Vc.IEg;break;case 5:hc=gb.HRb;Kc=Vc.W0c-gb.HRb;break;case 6:hc=Vc.W0c+Vc.IEg;Kc=gb.HRb+gb.Ymf-hc;break;case 1:case 2:case 3:let od=!1;for(let Od=Vc.NUp;Od;Od=Od.next)if(this.Bb.cCp===Od.name){od=!0;1===this.Bb.dof?(hc=Od.W0c,Kc=Od.IEg):2===this.Bb.dof?(hc=gb.HRb,Kc=Od.W0c-gb.HRb):(hc=Od.W0c+Od.IEg,Kc=gb.HRb+gb.Ymf-hc);break}if(!od)return!1;
break;case 7:hc=gb.HRb;Kc=gb.Ymf;break;default:throw Error.notImplemented();}return null!==this.Bb.Yap.y1p(Vc.gmq,hc,Kc,hc,!0,2,Mb)}}Object(m.a)(Yb,"SubSreWhereConstraintFilter",null,[1690]);class yb{constructor(gb,Mb){if(gb){var hc=Mb.kD(gb.J(0));this.dof=hc.charCodeAt(0);this.cCp=hc.substr(1);this.Yap=Mb.jJm(gb.J(1))}}}Object(m.a)(yb,"SubSreWhereConstraintFilterInit",null,[]);class Za{constructor(gb){this.Bb=gb}isMatch(gb,Mb,hc=null){if(!Object(U.a)(1662,gb))throw Error.argument("objToTest","Expected feature bundle");
if(null==hc)throw Error.argumentNull("parentTextForSpan");if(this.Bb.XRh&&!this.Bb.XRh.isMatch(gb,Mb))return!1;if(this.Bb.vIg){let Kc;if(({value:Kc}=gb.xr(this.Bb.N$o)).returnValue){if(!this.Bb.vIg.isMatch(Kc,Mb))return!1}else{let Vc,od;if(!({value:Vc}=gb.xr(this.Bb.FWj)).returnValue||!({value:od}=gb.xr(this.Bb.EWj)).returnValue||0>Vc||0>od||Vc+od>hc.length||!this.Bb.vIg.isMatch(hc.substr(Vc,od),Mb))return!1}}if(this.Bb.wXj){let Kc;if(!({value:Kc}=gb.xr(this.Bb.FWj)).returnValue||!this.Bb.wXj.isMatch(Kc,
Mb))return!1}if(this.Bb.Y6i){let Kc;if(!({value:Kc}=gb.xr(this.Bb.EWj)).returnValue||!this.Bb.Y6i.isMatch(Kc,Mb))return!1}return!0}}Object(m.a)(Za,"TextSpanFilter",null,[1690]);class Ya{constructor(gb,Mb){gb&&(this.annotations=Mb.annotations,this.FWj=gb.J(0),this.EWj=gb.J(1),this.N$o=gb.J(2),this.vIg=gb.J(3)?Mb.Jsa(gb.J(3)):null,this.XRh=gb.J(4)?Mb.Jsa(gb.J(4)):null,this.wXj=gb.J(5)?Mb.Jsa(gb.J(5)):null,this.Y6i=gb.J(6)?Mb.Jsa(gb.J(6)):null)}}Object(m.a)(Ya,"TextSpanFilterInit",null,[]);class Pa{constructor(gb,
Mb){gb&&(this.annotations=Mb.annotations,this.wza=gb.J(0),this.iOg=gb.J(1)?Mb.Jsa(gb.J(1)):null)}}Object(m.a)(Pa,"ValueFilterAnnotationFilterInit",null,[]);var rb=d(1595);class tb{Jsa(gb,Mb){const hc=gb.J(0),Kc=new rb.a;Kc.cqb(gb,1,gb.count-1);switch(hc){case 1:return new Z(new X(Kc,Mb),0);case 2:return new Z(new X(Kc,Mb),1);case 3:return new Z(new X(Kc,Mb),2);case 101:return new fa(new Ca(Kc,Mb));case 103:return new Aa(new oa(Kc,Mb),0);case 104:return new Aa(new oa(Kc,Mb),1);case 105:return new Aa(new oa(Kc,
Mb),2);case 106:return new Aa(new oa(Kc,Mb),3);case 107:return new Aa(new oa(Kc,Mb),4);case 108:return new Aa(new oa(Kc,Mb),5);case 109:return new Aa(new oa(Kc,Mb),6);case 201:return new sa(new Ea(Kc));case 202:return new Fa(new ua(Kc,Mb));case 301:return new aa(new ia(Kc,Mb),0);case 302:return new aa(new ia(Kc,Mb),1);case 303:return new aa(new ia(Kc,Mb),2);case 304:return new aa(new ia(Kc,Mb),3);case 305:return new aa(new ia(Kc,Mb),4);case 401:return new Ja(new nb(Kc),0);case 402:return new Ja(new nb(Kc),
1);case 403:return new Ja(new nb(Kc),2);case 404:return new Qa(new ya(Kc,Mb),0);case 405:return new Qa(new ya(Kc,Mb),1);case 406:return new Qa(new ya(Kc,Mb),2);case 407:return new Qa(new ya(Kc,Mb),3);case 501:return new Y(new Q(Kc,Mb));case 502:return new za(new ua(Kc,Mb));case 601:return new P(new xa(Kc,Mb),0);case 602:return new P(new xa(Kc,Mb),1);case 603:return new T(new xa(Kc,Mb));case 604:return new ta(new ua(Kc,Mb),0);case 605:return new ta(new ua(Kc,Mb),1);case 606:return new ta(new ua(Kc,
Mb),2);case 607:return new ta(new ua(Kc,Mb),3);case 701:return new S(!1);case 702:return new S(!0);case 703:return new V(new Pa(Kc,Mb),!1);case 704:return new V(new Pa(Kc,Mb),!0);case 705:return new O(new Pa(Kc,Mb),!1);case 706:return new O(new Pa(Kc,Mb),!0);case 707:return new ma(new na(Kc,Mb));case 901:return new Za(new Ya(Kc,Mb));case 1002:return new ja(new ua(Kc,Mb));case 1001:return new Yb(new yb(Kc,Mb));default:throw Error.argument("initData");}}}Object(m.a)(tb,"FilterFactory",null,[1664]);
var ob=d(1566);class Oa{constructor(gb){this.Bb=gb}get GF(){return this.Bb.GF}get H8(){return this.Bb.H8}get OBe(){return this.Bb.OBe}get Qde(){return this.Bb.Qde}load(gb,Mb){return this.Gu(gb,gb?new wa("root",gb,Mb):Mb)}store(gb,Mb,hc){this.Myc(gb,Mb,gb?new wa("root",gb,hc):hc,null)}Gu(gb,Mb){if(!this.Qde&&!this.Bb.annotations.Eoc(this.GF,gb))throw Error.argument("input","Input value not of expected type");let hc=this.Bb.Api;for(;hc;)gb=hc.load(gb,Mb),hc=hc.next;return gb}Myc(gb,Mb,hc,Kc){if(!this.OBe)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.Qde&&!this.Bb.annotations.Eoc(this.GF,gb))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Bb.annotations.Eoc(this.H8,Mb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Bb.Api.store(gb,Mb,hc,Kc)}static x4h(gb,Mb,hc,Kc){if(hc===Kc)return Mb;if(N.Annotations.zK(hc)&&N.Annotations.zK(Kc)){hc=N.Annotations.w9a(hc);Kc=N.Annotations.w9a(Kc);const Vc=new ob.a(gb,Kc);for(const od of Mb.items)Array.add(Vc.items,Oa.x4h(gb,od,hc,Kc));return Vc}if(hc===
N.Annotations.uPa){if(Kc===N.Annotations.kwa)return Mb;if(Kc===N.Annotations.eda)return Mb.toString()}else if(hc===N.Annotations.kwa){if(Kc===N.Annotations.uPa)return Math.floor(Mb);if(Kc===N.Annotations.eda)return Mb.toString()}else if(hc===N.Annotations.eda){if(Kc===N.Annotations.uPa)return parseInt(Mb);if(Kc===N.Annotations.kwa)return parseFloat(Mb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(m.a)(Oa,"AnnotationQuery",null,[1695]);class Xa{constructor(){this.H8=
this.GF=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}A9a(gb){if(this.next)return{returnValue:this.next,MOa:gb};if(gb){const Mb=gb.S7h;gb=gb.ivj;return{returnValue:Mb,MOa:gb}}return{returnValue:null,MOa:gb}}}Object(m.a)(Xa,"AnnotationQueryStep",null,[1718]);class ab extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){Mb=this.Bb.query.Gu(gb,Mb);if(N.Annotations.zK(this.GF)){var hc=N.Annotations.w9a(this.GF);let Vc=new ob.a(this.Bb.annotations,hc);if(N.Annotations.zK(this.Bb.query.H8)){if(gb.items.length!==
Mb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let od=0,Od=gb.items.length;od<Od;++od)Array.add(Vc.items,this.EUd(gb.items[od],Mb.items[od],hc===N.Annotations.kwa))}else for(var Kc of gb.items)Array.add(Vc.items,this.EUd(Kc,Mb,hc===N.Annotations.kwa));return Vc}if(N.Annotations.zK(this.Bb.query.H8)){Kc=new ob.a(this.Bb.annotations,this.GF);for(hc of Mb.items)Array.add(Kc.items,this.EUd(gb,hc,this.GF===N.Annotations.kwa));return Kc}return this.EUd(gb,
Mb,this.GF===N.Annotations.kwa)}EUd(gb,Mb,hc){gb=this.sec(gb,Mb);return hc?gb:Math.floor(gb)}}Object(m.a)(ab,"NumericAnnotationQueryStep",Xa,[]);class cb extends ab{constructor(gb){super(gb)}sec(gb,Mb){return gb+Mb}}Object(m.a)(cb,"AddAnnotationQueryStep",ab,[]);class ib extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){if(this.GF===N.Annotations.aFa&&this.Bb.query.H8===N.Annotations.aFa){let Vc;if(({result:Vc}=this.P_h(gb)).returnValue)return Vc}if(N.Annotations.zK(this.GF)){var hc=new ob.a(this.Bb.annotations,
N.Annotations.aFa);Mb=this.Bb.query.Gu(gb,Mb);if(N.Annotations.zK(this.Bb.query.H8)){if(gb.items.length!==Mb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Vc=0,od=gb.items.length;Vc<od;++Vc)Array.add(hc.items,this.vWc(Mb.items[Vc],gb.items[Vc]))}else for(var Kc of gb.items)Array.add(hc.items,this.vWc(Mb,Kc));return hc}Kc=this.Bb.query.Gu(gb,Mb);if(N.Annotations.zK(this.Bb.query.H8)){Mb=new ob.a(this.Bb.annotations,N.Annotations.aFa);for(hc of Kc.items)Array.add(Mb.items,
this.vWc(hc,gb));return Mb}return this.vWc(Kc,gb)}}Object(m.a)(ib,"BinaryBooleanAnnotationQueryStep",Xa,[]);class Ub extends ib{constructor(gb){super(gb)}P_h(gb){return{returnValue:!gb,result:!1}}vWc(gb,Mb){return gb&&Mb}}Object(m.a)(Ub,"AndAnnotationQueryStep",ib,[]);class lb{constructor(gb){gb&&(this.annotations=gb)}}Object(m.a)(lb,"AnnotationsOnlyQueryStepInit",null,[]);class Qb extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){Mb=this.Bb.query.Gu(gb,Mb);gb=gb.clone();N.Annotations.zK(this.Bb.query.H8)?
Array.addRange(gb.items,Mb.items):Array.add(gb.items,Mb);return gb}}Object(m.a)(Qb,"AppendAnnotationQueryStep",Xa,[]);class fc extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){if(this.GF===N.Annotations.HY)return this.$_c(gb,Mb);const hc=new ob.a(this.Bb.annotations,N.Annotations.HY);for(const Kc of gb.items)Array.add(hc.items,this.$_c(Kc,Mb));return hc}$_c(gb,Mb){const hc=new M.a(this.Bb.annotations);hc.j7a(gb);gb=new M.a(this.Bb.annotations);this.Bb.script.pVa(null,new wa("Input",hc,new wa("Output",
gb,Mb)));return gb}}Object(m.a)(fc,"ApplyAnnotationQueryStep",Xa,[]);class Fc extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){if(this.GF===N.Annotations.HY)return Mb=this.$_c(gb,Mb),Mb.xr(this.Bb.VRh).returnValue||new ob.a(this.Bb.annotations,N.Annotations.HY),Mb;const hc=new ob.a(this.Bb.annotations,N.Annotations.HY);for(const Kc of gb.items)if(gb=this.$_c(Kc,Mb),({value:gb}=gb.xr(this.Bb.VRh)).returnValue)for(const Vc of gb.items)Array.add(hc.items,Vc);return hc}$_c(gb,Mb){const hc=new M.a(this.Bb.annotations);
hc.j7a(gb);gb=new M.a(this.Bb.annotations);this.Bb.script.pVa(null,new wa("Input",hc,new wa("Output",gb,Mb)));return gb}}Object(m.a)(Fc,"ApplyExpandAnnotationQueryStep",Xa,[]);class nc{constructor(gb,Mb){gb&&(this.annotations=Mb.annotations,this.script=Mb.hPb(gb.J(0)),this.VRh=gb.J(1))}}Object(m.a)(nc,"ApplyExpandQueryStepInit",null,[]);class zb{constructor(gb,Mb){gb&&(this.annotations=Mb.annotations,this.script=Mb.hPb(gb.J(0)))}}Object(m.a)(zb,"ApplyQueryStepInit",null,[]);class Vb extends Xa{constructor(gb){super();
this.Bb=gb}load(gb){if(this.GF===N.Annotations.HY)return this.qie(gb);const Mb=new ob.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.wza));for(const hc of gb.items)Array.add(Mb.items,this.qie(hc));return Mb}store(gb,Mb,hc,Kc){if(this.GF===N.Annotations.HY){var Vc=Mb,od=({MOa:Kc}=this.A9a(Kc)).returnValue;od&&(Vc=od.store(N.Annotations.IW(this.qie(gb)),Mb,hc,Kc));gb.jA(this.Bb.wza,Vc)}else{var Od=Mb;if(Vc=({MOa:Kc}=this.A9a(Kc)).returnValue){Od=new ob.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.wza));
for(od of gb.items)Array.add(Od.items,this.qie(od));Od=Vc.store(Od,Mb,hc,Kc)}Mb=Od;if(Mb.items.length!==gb.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let Ld=0,Af=gb.items.length;Ld<Af;++Ld)hc=gb.items[Ld],hc.isReadOnly&&(hc=hc.clone(),gb.items[Ld]=hc),hc.jA(this.Bb.wza,Mb.items[Ld])}return gb}qie(gb){({value:gb}=gb.xr(this.Bb.wza)).returnValue||(gb=this.Bb.annotations.oim(this.Bb.wza));return gb}}Object(m.a)(Vb,"AttrAnnotationQueryStep",Xa,
[]);class rc{constructor(gb,Mb){gb&&(this.annotations=Mb,this.wza=gb.J(0))}}Object(m.a)(rc,"AttrQueryStepInit",null,[]);class pb extends Xa{constructor(gb){super();this.Bb=gb}load(gb){const Mb=new M.a(this.Bb.annotations);Mb.j7a(gb);return this.Bb.module.execute(Mb)}}Object(m.a)(pb,"CallModuleAnnotationQueryStep",Xa,[]);class bb{constructor(gb,Mb){gb&&(this.annotations=Mb.annotations,this.module=Mb.WLf(gb.J(0)))}}Object(m.a)(bb,"CallModuleQueryStepInit",null,[]);class Pb extends Xa{constructor(gb){super();
this.Bb=gb}load(gb,Mb){if(N.Annotations.zK(this.GF)){var hc=this.Bb.query.Gu(gb,Mb);Mb=new ob.a(this.Bb.annotations,N.Annotations.eda);let od="string"===typeof hc;for(var Kc of gb.items)if(od)Array.add(Mb.items,Kc+hc);else for(var Vc of hc.items)Array.add(Mb.items,Kc+Vc);return Mb}Kc=this.Bb.query.Gu(gb,Mb);if("string"===typeof Kc)return gb+Kc;Vc=new ob.a(this.Bb.annotations,N.Annotations.eda);for(hc of Kc.items)Array.add(Vc.items,gb+hc);return Vc}}Object(m.a)(Pb,"ConcatAnnotationQueryStep",Xa,[]);
class mb extends Xa{constructor(gb){super();this.Bb=gb}load(gb){return Oa.x4h(this.Bb.annotations,gb,this.GF,this.H8)}}Object(m.a)(mb,"ConvertAnnotationQueryStep",Xa,[]);class Ua extends Xa{constructor(){super()}load(gb){return gb.items.length}}Object(m.a)(Ua,"CountAnnotationQueryStep",Xa,[]);class vb extends ab{constructor(gb){super(gb)}sec(gb,Mb){return gb/Mb}}Object(m.a)(vb,"DivideAnnotationQueryStep",ab,[]);class Ia extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){Mb=new wa(this.Bb.lGe,
null,Mb);for(const hc of gb.items)if(Mb.sof(hc),this.Bb.query.Gu(hc,Mb))return!0;return!1}}Object(m.a)(Ia,"ExistsAnnotationQueryStep",Xa,[]);class Ma extends ab{constructor(gb){super(gb)}sec(gb,Mb){return Math.pow(gb,Mb)}}Object(m.a)(Ma,"ExpAnnotationQueryStep",ab,[]);class qb{constructor(gb,Mb){gb&&(this.wVa=Mb.kD(gb.J(0)))}}Object(m.a)(qb,"FeatureBundleNameQueryStepInit",null,[]);class Xb extends Xa{constructor(gb){super();this.Bb=gb}load(gb){if(N.Annotations.zK(this.GF)){const Mb=new ob.a(this.Bb.annotations,
this.Bb.annotations.IQb(N.Annotations.w9a(this.GF),this.Bb.yVa));for(const hc of gb.items)Array.add(Mb.items,hc.Lqb(this.Bb.yVa));return Mb}return gb.Lqb(this.Bb.yVa)}store(gb,Mb,hc,Kc){if(N.Annotations.zK(this.GF)){var Vc=Mb,od=({MOa:Kc}=this.A9a(Kc)).returnValue;if(od){Vc=new ob.a(this.Bb.annotations,this.Bb.annotations.IQb(N.Annotations.w9a(this.GF),this.Bb.yVa));for(var Od of gb.items)Array.add(Vc.items,Od.Lqb(this.Bb.yVa));Vc=od.store(Vc,Mb,hc,Kc)}Mb=Vc;if(Mb.items.length!==gb.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let Ld=0,Af=gb.items.length;Ld<Af;++Ld)hc=gb.items[Ld],hc.isReadOnly&&(hc=hc.clone(),gb.items[Ld]=hc),hc.Dzg(this.Bb.yVa,Mb.items[Ld])}else od=Mb,(Od=({MOa:Kc}=this.A9a(Kc)).returnValue)&&(od=Od.store(N.Annotations.IW(gb.Lqb(this.Bb.yVa)),Mb,hc,Kc)),gb.Dzg(this.Bb.yVa,od);return gb}}Object(m.a)(Xb,"FieldAnnotationQueryStep",Xa,[]);class Cc{constructor(gb,Mb){gb&&(this.annotations=Mb,this.yVa=gb.J(0))}}Object(m.a)(Cc,"FieldQueryStepInit",null,[]);class Ec extends Xa{constructor(gb){super();this.Bb=
gb}load(gb,Mb){for(const hc of gb.items)if(this.Bb.filter.isMatch(hc,Mb))return hc;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(gb,Mb,hc,Kc){let Vc=Mb,od=-1;for(let Ld=0,Af=gb.items.length;Ld<Af;Ld++)if(this.Bb.filter.isMatch(gb.items[Ld],hc)){od=Ld;break}if(0>od)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const Od=({MOa:Kc}=this.A9a(Kc)).returnValue;Od&&(Vc=Od.store(N.Annotations.IW(gb.items[od]),Mb,hc,Kc));
gb.items[od]=Vc;return gb}}Object(m.a)(Ec,"FirstItemMatchingAnnotationQueryStep",Xa,[]);class Wb extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){Mb=new wa(this.Bb.lGe,null,Mb);for(const hc of gb.items)if(Mb.sof(hc),!this.Bb.query.Gu(hc,Mb))return!1;return!0}}Object(m.a)(Wb,"ForAllAnnotationQueryStep",Xa,[]);class Hb extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){gb=Mb?Mb.M6d(this.Bb.wVa):null;if(!gb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.wVa+
'"');return gb}store(gb,Mb,hc,Kc){gb=hc?hc.M6d(this.Bb.wVa):null;if(!gb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.wVa+'"');let Vc=Mb;const od=({MOa:Kc}=this.A9a(Kc)).returnValue;od&&(Vc=od.store(gb,Mb,hc,Kc));gb!==Vc&&gb.j7a(Vc);return gb}}Object(m.a)(Hb,"GetAnnotationQueryStep",Xa,[]);class Sb{constructor(gb,Mb){this.fsk=gb;this.uJk=Mb}get S7h(){return this.fsk}get ivj(){return this.uJk}}Object(m.a)(Sb,"AnnotationQueryStoreContinuation",null,[1722]);class cc extends Xa{constructor(gb){super();
this.Bb=gb}load(gb,Mb){return this.Bb.ICe.Gu(gb,Mb)?this.Bb.s3j.Gu(gb,Mb):this.Bb.M2d?this.Bb.M2d.Gu(gb,Mb):gb}store(gb,Mb,hc,Kc){var Vc=this.Bb.ICe.Gu(gb,hc);this.next&&(Kc=new Sb(this.next,Kc));if(Vc)return this.Bb.s3j.Myc(gb,Mb,hc,Kc);if(this.Bb.M2d)return this.Bb.M2d.Myc(gb,Mb,hc,Kc);Vc=Mb;let od=null;Kc&&(od=Kc.S7h,Kc=Kc.ivj);od&&(Vc=od.store(N.Annotations.IW(gb),Mb,hc,Kc));return Vc}}Object(m.a)(cc,"IfAnnotationQueryStep",Xa,[]);class Gc{constructor(gb,Mb){gb&&(this.ICe=Mb.lN(gb.J(0)),this.s3j=
Mb.lN(gb.J(1)),this.M2d=gb.J(2)?Mb.lN(gb.J(2)):null)}}Object(m.a)(Gc,"IfQueryStepInit",null,[]);class Oc{constructor(gb,Mb){gb&&(this.F4m=Mb.lN(gb.J(0)),this.P4i=Mb.lN(gb.J(1)))}}Object(m.a)(Oc,"IndexAndItemQueryStepInit",null,[]);class Zc extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){const hc=this.Bb.F4m.Gu(gb,Mb);Mb=this.Bb.P4i.Gu(gb,Mb);gb=gb.clone();if(0>hc||hc>gb.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(N.Annotations.zK(this.Bb.P4i.H8))for(let Kc=
0;Kc<Mb.items.length;++Kc)Array.insert(gb.items,hc+Kc,Mb.items[Kc]);else Array.insert(gb.items,hc,Mb);return gb}}Object(m.a)(Zc,"InsertAtAnnotationQueryStep",Xa,[]);class kb extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){return!(!Mb||!Mb.M6d(this.Bb.wVa))}}Object(m.a)(kb,"IsDefinedAnnotationQueryStep",Xa,[]);class wd extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){Mb=this.DL(gb,Mb);return gb.items[Mb]}store(gb,Mb,hc,Kc){const Vc=this.DL(gb,hc);let od=Mb;const Od=({MOa:Kc}=this.A9a(Kc)).returnValue;
Od&&(od=Od.store(N.Annotations.IW(gb.items[Vc]),Mb,hc,Kc));gb.items[Vc]=od;return gb}DL(gb,Mb){Mb=this.Bb.query.Gu(gb,Mb);if(0>Mb||Mb>=gb.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Mb}}Object(m.a)(wd,"ItemAnnotationQueryStep",Xa,[]);class qe extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){const hc=new ob.a(this.Bb.annotations,N.Annotations.w9a(this.GF));for(const Kc of gb.items)this.Bb.filter.isMatch(Kc,Mb)&&Array.add(hc.items,Kc);return hc}}
Object(m.a)(qe,"ItemsMatchingAnnotationQueryStep",Xa,[]);class Qd extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){Mb=this.DL(gb,Mb);return gb.items[gb.items.length-Mb-1]}store(gb,Mb,hc,Kc){const Vc=this.DL(gb,hc);let od=Mb;const Od=({MOa:Kc}=this.A9a(Kc)).returnValue;Od&&(od=Od.store(N.Annotations.IW(gb.items[gb.items.length-Vc-1]),Mb,hc,Kc));gb.items[gb.items.length-Vc-1]=od;return gb}DL(gb,Mb){Mb=this.Bb.query?this.Bb.query.Gu(gb,Mb):0;if(0>Mb||Mb>=gb.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Mb}}Object(m.a)(Qd,"LastItemAnnotationQueryStep",Xa,[]);class me extends Xa{constructor(gb){super();this.Bb=gb}load(gb){if(N.Annotations.zK(this.GF)){const Mb=new ob.a(this.Bb.annotations,N.Annotations.uPa);for(const hc of gb.items)Array.add(Mb.items,hc.length);return Mb}return gb.length}}Object(m.a)(me,"LengthAnnotationQueryStep",Xa,[]);class Ne extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){if(N.Annotations.zK(this.GF)){const hc=new ob.a(this.Bb.annotations,N.Annotations.aFa);
for(const Kc of gb.items)Array.add(hc.items,this.Bb.filter.isMatch(Kc,Mb));return hc}return this.Bb.filter.isMatch(gb,Mb)}}Object(m.a)(Ne,"MatchesAnnotationQueryStep",Xa,[]);class Cd extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){return this.Bb.filter.isMatch(gb,Mb)}}Object(m.a)(Cd,"MatchesAsListAnnotationQueryStep",Xa,[]);class Pf extends ab{constructor(gb){super(gb)}sec(gb,Mb){return gb%Mb}}Object(m.a)(Pf,"ModuloAnnotationQueryStep",ab,[]);class cg extends ab{constructor(gb){super(gb)}sec(gb,
Mb){return gb*Mb}}Object(m.a)(cg,"MultiplyAnnotationQueryStep",ab,[]);class mg extends Xa{constructor(gb){super();this.Bb=gb}load(gb){if(N.Annotations.zK(this.GF)){const Mb=new ob.a(this.Bb.annotations,N.Annotations.aFa);for(const hc of gb.items)Array.add(Mb.items,!hc);return Mb}return!gb}}Object(m.a)(mg,"NotAnnotationQueryStep",Xa,[]);class ci extends ib{constructor(gb){super(gb)}P_h(gb){return{returnValue:gb,result:!0}}vWc(gb,Mb){return gb||Mb}}Object(m.a)(ci,"OrAnnotationQueryStep",ib,[]);class Dd extends Xa{constructor(gb){super();
this.Bb=gb}load(gb,Mb){const hc=this.Bb.BFg.Gu(gb,Mb);gb=this.Bb.oXc.Gu(gb,Mb);Mb=new ob.a(this.Bb.annotations,N.Annotations.uPa);for(let Kc=0;Kc<gb;++Kc)Array.add(Mb.items,hc+Kc);return Mb}}Object(m.a)(Dd,"RangeAnnotationQueryStep",Xa,[]);class Xc{constructor(gb,Mb){gb&&(this.annotations=Mb.annotations,this.filter=Mb.Jsa(gb.J(0)))}}Object(m.a)(Xc,"SingleFilterQueryStepInit",null,[]);class Jd{constructor(gb,Mb){gb&&(this.annotations=Mb.annotations,this.query=gb.J(0)?Mb.lN(gb.J(0)):null)}}Object(m.a)(Jd,
"SingleOptionalQueryQueryStepInit",null,[]);class pf{constructor(gb,Mb){gb&&(this.annotations=Mb.annotations,this.query=Mb.lN(gb.J(0)))}}Object(m.a)(pf,"SingleQueryQueryStepInit",null,[]);class Ce{constructor(gb,Mb){gb&&(this.annotations=Mb.annotations,this.BFg=Mb.lN(gb.J(0)),this.oXc=gb.J(1)?Mb.lN(gb.J(1)):null)}}Object(m.a)(Ce,"StartAndCountOrLengthQueryStepInit",null,[]);class pc extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){let hc;({startIndex:Mb,length:hc}=this.y9d(gb,Mb));const Kc=
new ob.a(this.Bb.annotations,gb.d8);for(let Vc=0;Vc<hc;++Vc)Array.add(Kc.items,gb.items[Mb+Vc]);return Kc}store(gb,Mb,hc,Kc){let Vc,od;({startIndex:Vc,length:od}=this.y9d(gb,hc));var Od=Mb;const Ld=({MOa:Kc}=this.A9a(Kc)).returnValue;if(Ld){Od=new ob.a(this.Bb.annotations,gb.d8);for(let Af=0;Af<od;++Af)Array.add(Od.items,gb.items[Vc+Af]);Od=Ld.store(Od,Mb,hc,Kc)}Mb=Od;for(hc=0;hc<od;++hc)Array.removeAt(gb.items,Vc);for(let Af=0,Tb=Mb.items.length;Af<Tb;++Af)Array.insert(gb.items,Vc+Af,Mb.items[Af]);
return gb}y9d(gb,Mb){let hc;hc=this.Bb.BFg.Gu(gb,Mb);if(0>hc)throw Error.invalidOperation("Invalid start index in Sublist() query step");Mb=this.Bb.oXc?this.Bb.oXc.Gu(gb,Mb):gb.items.length-hc;if(0>Mb||hc+Mb>gb.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:hc,length:Mb}}}Object(m.a)(pc,"SublistAnnotationQueryStep",Xa,[]);class $c extends Xa{constructor(gb){super();this.Bb=gb}load(gb,Mb){if(N.Annotations.zK(this.GF)){const hc=
new ob.a(this.Bb.annotations,N.Annotations.eda);for(let Kc=0,Vc=gb.items.length;Kc<Vc;++Kc)Array.add(hc.items,this.gIi(gb.items[Kc],Mb));return hc}return this.gIi(gb,Mb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}gIi(gb,Mb){let hc;({startIndex:Mb,length:hc}=this.y9d(gb,Mb));return gb.substr(Mb,hc)}y9d(gb,Mb){let hc;hc=this.Bb.BFg.Gu(gb,Mb);if(0>hc)throw Error.invalidOperation("Invalid start index in Substring() query step");Mb=this.Bb.oXc?this.Bb.oXc.Gu(gb,
Mb):gb.length-hc;if(0>Mb||hc+Mb>gb.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:hc,length:Mb}}}Object(m.a)($c,"SubstringAnnotationQueryStep",Xa,[]);class id extends ab{constructor(gb){super(gb)}sec(gb,Mb){return gb-Mb}}Object(m.a)(id,"SubtractAnnotationQueryStep",ab,[]);class de extends Xa{constructor(gb){super();this.Bb=gb}load(gb){const Mb=new ob.a(this.Bb.annotations,N.Annotations.eda);for(let hc=0;hc<gb.length;++hc)Array.add(Mb.items,
gb.charAt(hc).toString());return Mb}}Object(m.a)(de,"ToCharListAnnotationQueryStep",Xa,[]);class Ae extends Xa{constructor(gb){super();this.Bb=gb}load(gb){const Mb=new ob.a(this.Bb.annotations,this.GF);Array.add(Mb.items,gb);return Mb}}Object(m.a)(Ae,"ToListAnnotationQueryStep",Xa,[]);class gf extends Xa{constructor(gb){super();this.Bb=gb}load(){return this.Bb.value}}Object(m.a)(gf,"ValueAnnotationQueryStep",Xa,[]);class uf{constructor(gb,Mb){if(gb){var hc=gb.J(0),Kc=1;this.value=({Bla:Kc}=Mb.ZUa(hc,
gb,Kc,null,null,null)).returnValue;N.Annotations.QUb(this.value)}}}Object(m.a)(uf,"ValueQueryStepInit",null,[]);class Lf{constructor(gb,Mb){gb&&(this.lGe=Mb.kD(gb.J(0)),this.query=Mb.lN(gb.J(1)))}}Object(m.a)(Lf,"VarNameAndQueryQueryStepInit",null,[]);class hg{constructor(gb,Mb){this.xih=null;if(gb){this.annotations=Mb.annotations;var hc=0;this.GF=gb.J(hc);++hc;this.H8=gb.J(hc);++hc;this.OBe=1===gb.J(hc);++hc;this.Qde=1===gb.J(hc);++hc;var Kc=gb.J(hc);++hc;if(Kc){var Vc=hc,od=hc+Kc,Od=hc+2*Kc;hc+=
3*Kc;var Ld=gb.count-hc,Af=null;for(let Dg=0;Dg<Kc;++Dg){var Tb=hc+gb.J(Od+Dg);const Kh=(Dg===Kc-1?Ld:gb.J(Od+Dg+1))-gb.J(Od+Dg),rg=new rb.a;rg.cqb(gb,Tb,Kh);Tb=hg.bBm(gb.J(od+Dg),rg,Mb);Tb.GF=gb.J(Vc+Dg);Tb.H8=Dg===Kc-1?this.H8:gb.J(Vc+Dg+1);Af?Af.next=Tb:this.xih=Tb;Af=Tb}}}}get Api(){return this.xih}static bBm(gb,Mb,hc){switch(gb){case 1:return new Hb(new qb(Mb,hc));case 2:return new kb(new qb(Mb,hc));case 3:return new Vb(new rc(Mb,hc.annotations));case 4:return new Xb(new Cc(Mb,hc.annotations));
case 5:return new cc(new Gc(Mb,hc));case 6:return new Ne(new Xc(Mb,hc));case 43:return new Cd(new Xc(Mb,hc));case 45:return new fc(new zb(Mb,hc));case 49:return new Fc(new nc(Mb,hc));case 46:return new gf(new uf(Mb,hc.annotations));case 51:return new pb(new bb(Mb,hc));case 52:return new Dd(new Ce(Mb,hc));case 53:return new mb(new lb(hc.annotations));case 13:return new wd(new pf(Mb,hc));case 14:return new Qd(new Jd(Mb,hc));case 15:return new Ua;case 18:return new Ec(new Xc(Mb,hc));case 16:return new Wb(new Lf(Mb,
hc));case 17:return new Ia(new Lf(Mb,hc));case 22:return new Zc(new Oc(Mb,hc));case 24:return new Qb(new pf(Mb,hc));case 26:return new pc(new Ce(Mb,hc));case 27:return new qe(new Xc(Mb,hc));case 30:return new Ae(new lb(hc.annotations));case 31:return new $c(new Ce(Mb,hc));case 32:return new Pb(new pf(Mb,hc));case 47:return new me(new lb(hc.annotations));case 48:return new de(new lb(hc.annotations));case 34:return new cb(new pf(Mb,hc));case 35:return new id(new pf(Mb,hc));case 36:return new cg(new pf(Mb,
hc));case 37:return new vb(new pf(Mb,hc));case 38:return new Pf(new pf(Mb,hc));case 39:return new Ma(new pf(Mb,hc));case 40:return new Ub(new pf(Mb,hc));case 41:return new ci(new pf(Mb,hc));case 42:return new mg(new lb(hc.annotations));default:throw Error.argument("currStepInitData");}}}Object(m.a)(hg,"AnnotationQueryInit",null,[]);class Vf{constructor(gb){this.Bb=gb}execute(gb,Mb){this.pVa(gb,gb?new wa("root",gb,Mb):Mb)}pVa(gb,Mb){for(const hc of this.Bb.commands)Mb=hc.execute(gb,Mb)}}Object(m.a)(Vf,
"AnnotationScript",null,[1694]);class ic{constructor(gb){this.Bb=gb}execute(gb,Mb){const hc=this.Bb.h9m.Gu(gb,Mb),Kc=this.Bb.Q6n.Gu(gb,Mb);this.Bb.script.pVa(gb,new wa("Input",hc,new wa("Output",Kc,Mb)));return Mb}}Object(m.a)(ic,"ApplyAnnotationScriptCommand",null,[1711]);class yc{constructor(gb,Mb){gb&&(this.h9m=Mb.lN(gb.J(0)),this.Q6n=Mb.lN(gb.J(1)),this.script=Mb.hPb(gb.J(2)))}}Object(m.a)(yc,"ApplyScriptCommandInit",null,[]);class bd{constructor(gb){this.Bb=gb}execute(gb,Mb){const hc=this.Bb.Iwg.Gu(gb,
Mb);this.Bb.gje.Myc(gb,hc,Mb,null);return Mb}}Object(m.a)(bd,"AssignAnnotationScriptCommand",null,[1711]);class sd{constructor(gb){this.Bb=gb}execute(gb,Mb){const hc=this.Bb.gje.Gu(gb,Mb);gb=this.Bb.Iwg.Gu(gb,Mb);hc!==gb&&hc.j7a(gb);return Mb}}Object(m.a)(sd,"CopyAnnotationScriptCommand",null,[1711]);class ie{constructor(gb){this.Bb=gb}execute(gb,Mb){let hc=this.Bb.y4f.Gu(gb,Mb);if(this.Bb.y4f.OBe){hc=N.Annotations.IW(hc);var Kc=new wa(this.Bb.wVa,null,Mb);for(let od=0,Od=hc.items.length;od<Od;++od){var Vc=
this.gmi(gb,hc.items[od],Kc);if(0>this.Bb.wve)hc.items[od]=Vc;else if(({value:Vc}=Vc.xr(this.Bb.wve)).returnValue)hc.items[od]=Vc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Bb.y4f.Myc(gb,hc,Mb,null)}else{Kc=new wa(this.Bb.wVa,null,Mb);for(let od=0,Od=hc.items.length;od<Od;++od)this.gmi(gb,hc.items[od],Kc)}return Mb}gmi(gb,Mb,hc){let Kc;0>this.Bb.wve?Kc=N.Annotations.IW(Mb):(Kc=new M.a(this.Bb.annotations),Kc.jA(this.Bb.wve,Mb));hc.sof(Kc);
this.Bb.hdl.pVa(gb,hc);return Kc}}Object(m.a)(ie,"EnumerateAnnotationScriptCommand",null,[1711]);class We{constructor(gb,Mb){gb&&(this.annotations=Mb.annotations,this.wVa=Mb.kD(gb.J(0)),this.y4f=Mb.lN(gb.J(1)),this.hdl=Mb.hPb(gb.J(2)),this.wve=gb.J(3))}}Object(m.a)(We,"EnumerateScriptCommandInit",null,[]);class Pe{constructor(gb){this.Bb=gb}execute(gb,Mb){this.Bb.ICe.Gu(gb,Mb)?this.Bb.cop.pVa(gb,Mb):this.Bb.kni&&this.Bb.kni.pVa(gb,Mb);return Mb}}Object(m.a)(Pe,"IfAnnotationScriptCommand",null,[1711]);
class Re{constructor(gb,Mb){gb&&(this.ICe=Mb.lN(gb.J(0)),this.cop=Mb.hPb(gb.J(1)),this.kni=gb.J(2)?Mb.hPb(gb.J(2)):null)}}Object(m.a)(Re,"IfScriptCommandInit",null,[]);class Sf{constructor(gb,Mb){gb&&(this.annotations=Mb.annotations,this.gje=Mb.lN(gb.J(0)),this.Iwg=Mb.lN(gb.J(1)))}}Object(m.a)(Sf,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class vg{constructor(gb){this.Bb=gb}execute(gb,Mb){const hc=this.Bb.Iwg.Gu(this.Bb.gje.Gu(gb,Mb),Mb);this.Bb.gje.Myc(gb,hc,Mb,null);return Mb}}Object(m.a)(vg,
"ModifyAnnotationScriptCommand",null,[1711]);class Yg{constructor(gb){this.Bb=gb}execute(gb,Mb){const hc=new M.a(this.Bb.annotations);this.Bb.query&&hc.j7a(this.Bb.query.Gu(gb,Mb));return Mb=new wa(this.Bb.wVa,hc,Mb)}}Object(m.a)(Yg,"NewAnnotationScriptCommand",null,[1711]);class ph{constructor(gb,Mb){gb&&(this.annotations=Mb.annotations,this.wVa=Mb.kD(gb.J(0)),this.query=gb.J(1)?Mb.lN(gb.J(1)):null)}}Object(m.a)(ph,"NewScriptCommandInit",null,[]);class Di{constructor(gb){this.Bb=gb}execute(gb,Mb){gb=
this.Bb.query.Gu(gb,Mb);if(this.Bb.query.H8===N.Annotations.HY)gb.UZa(this.Bb.wza);else for(const hc of gb.items)hc.UZa(this.Bb.wza);return Mb}}Object(m.a)(Di,"RemoveAnnotationScriptCommand",null,[1711]);class bj{constructor(gb,Mb){gb&&(this.annotations=Mb.annotations,this.query=Mb.lN(gb.J(0)),this.wza=gb.J(1))}}Object(m.a)(bj,"RemoveScriptCommandInit",null,[]);class gi{constructor(gb,Mb){if(gb){var hc=0,Kc=gb.J(hc);++hc;if(Kc){var Vc=hc,od=hc+Kc;hc+=2*Kc;var Od=gb.count-hc;this.commands=Array(Kc);
for(let Ld=0;Ld<Kc;++Ld){const Af=hc+gb.J(od+Ld),Tb=(Ld===Kc-1?Od:gb.J(od+Ld+1))-gb.J(od+Ld),Dg=new rb.a;Dg.cqb(gb,Af,Tb);this.commands[Ld]=gi.SAm(gb.J(Vc+Ld),Dg,Mb)}}}}static SAm(gb,Mb,hc){switch(gb){case 1:return new bd(new Sf(Mb,hc));case 2:return new vg(new Sf(Mb,hc));case 3:return new Di(new bj(Mb,hc));case 6:return new Yg(new ph(Mb,hc));case 7:return new ie(new We(Mb,hc));case 8:return new Pe(new Re(Mb,hc));case 9:return new sd(new Sf(Mb,hc));case 10:return new ic(new yc(Mb,hc));default:throw Error.argument("initData");
}}}Object(m.a)(gi,"AnnotationScriptInit",null,[]);var Zg=d(1747);class Bb{constructor(gb){this.l5=gb;this.Dz=0}wca(){const gb=this.l5.hA(this.Dz,4);this.Dz+=4;return gb}get Lja(){return this.l5}get offset(){return this.Dz}set offset(gb){this.Dz=gb}}Object(m.a)(Bb,"ByteArrayReader",null,[]);class Nb{constructor(){this.WL=null;this.Ibj=this.Aga=0}J(gb){if(0>gb||gb>=this.Aga)throw Error.argumentOutOfRange("index");return this.WL.hA(this.Ibj+4*gb,4)}get count(){return this.Aga}static RFl(gb,Mb,hc){const Kc=
new Nb;Kc.WL=gb;Kc.Ibj=Mb;Kc.Aga=hc;return Kc}}Object(m.a)(Nb,"ReadOnlyListOverByteArray",null,[1689]);class Bc{constructor(gb,Mb){this.Bbj=this.Abj=!1;this.Gx=this.sYa=this.u7f=this.Ebj=null;try{this.Gx=Mb.annotations;const hc=Mb.yqb(gb.J(0)),Kc=new Bb(hc);if(-914743053!==Kc.wca())throw Error.argument("Input does not represent a flat lexicon");this.Abj=1===Kc.wca();this.Bbj=1===Kc.wca();const Vc=Kc.wca();Kc.offset+=Vc;const od=Kc.wca();this.u7f=Bc.i9n(Kc,od,this.Gx);const Od=Kc.wca();this.Ebj=Bc.z9n(Kc,
Od);const Ld=Kc.wca();this.sYa=new Zg.a(Kc.Lja,Kc.offset);Kc.offset+=Ld}catch(hc){throw Error.argument("initData");}}get trie(){return this.sYa}ukm(gb){return"i"===gb&&this.Bbj?"\u0130":gb.toUpperCase()}MXf(){return this.Abj}Ahm(gb){let Mb;Mb=new ob.a(this.Gx,N.Annotations.HY);if(1!==gb)if(0===gb)gb=new M.a(this.Gx),Array.add(Mb.items,gb);else if(gb&1073741824){gb=this.Ebj[gb&-1073741825];for(let Kc=0;Kc<gb.length;++Kc){var hc=gb[Kc];hc=0===hc?new M.a(this.Gx):this.u7f[hc-2];Array.add(Mb.items,hc)}}else Array.add(Mb.items,
this.u7f[gb-2]);return{returnValue:!0,Fyn:Mb}}static i9n(gb,Mb,hc){if(Mb%4)throw Error.argument("reader");const Kc=Nb.RFl(gb.Lja,gb.offset,Mb/4);gb.offset+=Mb;gb=[];for(Mb=0;Mb<Kc.count;){const Vc=({Bla:Mb}=hc.ZUa(N.Annotations.HY,Kc,Mb,null,null,null)).returnValue;Array.add(gb,Vc)}return gb}static z9n(gb,Mb){Mb=gb.offset+Mb;const hc=[];for(;gb.offset<Mb;){const Kc=gb.wca(),Vc=Array(Kc);for(let od=0;od<Kc;++od){const Od=gb.wca();Vc[od]=Od}Array.add(hc,Vc)}return hc}}Object(m.a)(Bc,"RawFlatLexicon",
null,[1693]);var td=d(1715),Je=d(1716);class Ef{constructor(gb){if(null==gb)throw Error.argumentNull("base64String");const Mb=gb.length;if(Mb%4)throw Error.argument("base64String's length must be a multiple of 4");this.Aga=.75*Mb;this.fVb=Array(Math.ceil(this.Aga/4));gb.endsWith("==")?this.Aga-=2:gb.endsWith("=")&&--this.Aga;let hc=0;for(let Kc=0;Kc<Mb;Kc+=4){const Vc=Ef.jwe[gb.charCodeAt(Kc)-43]<<18|Ef.jwe[gb.charCodeAt(Kc+1)-43]<<12|Ef.jwe[gb.charCodeAt(Kc+2)-43]<<6|Ef.jwe[gb.charCodeAt(Kc+3)-43];
let od=Vc>>16&255;this.fVb[Math.floor(hc/4)]|=od<<hc%4*8;++hc;od=Vc>>8&255;this.fVb[Math.floor(hc/4)]|=od<<hc%4*8;++hc;od=Vc&255;this.fVb[Math.floor(hc/4)]|=od<<hc%4*8;++hc}}get length(){return this.Aga}J(gb){if(0>gb||gb>=this.Aga)throw Error.argumentOutOfRange("i");return this.Hui(gb)}hA(gb,Mb){if(0>gb||0>Mb||gb+Mb>this.Aga)throw Error.argument("Bad range");let hc=0;for(let Kc=0;Kc<Mb;++Kc)hc|=this.Hui(gb+Kc)<<8*Kc;return hc}eoo(gb,Mb){let hc=0,Kc=0,Vc=Math.floor(gb/8);for(gb%=8;Kc<Mb;){const od=
8-gb>Mb-Kc?Mb-Kc:8-gb,Od=this.J(Vc);hc|=(Od>>gb&~(255<<od))<<Kc;Kc+=od;++Vc;gb=0}return hc}Hui(gb){return this.fVb[Math.floor(gb/4)]>>gb%4*8&255}}Ef.jwe=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(m.a)(Ef,"ByteArray",null,[]);class Ih{constructor(gb,Mb,hc){this.KF=gb;this.YGn=Mb;this.aHn=hc;this.Qbj=Array(gb.b?gb.b.length:
0);this.S7f=new td.a(new Je.a(this.yqb(this.KF.s)));this.Sba=Array(gb.t.length);this.ZE=new N.Annotations(this.sqb(0),this)}get annotations(){return this.ZE}get aYl(){return this.KF.d}lAm(){if(!(""in this.KF.m))throw Error.argument("name","Unrecognized module");return this.WLf(this.KF.m[""])}yqb(gb){if(0>gb||!this.KF.b||gb>=this.KF.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.Qbj[gb]||(this.Qbj[gb]=new Ef(this.KF.b[gb]))}kD(gb){if(1>gb||gb>=this.KF.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.KF.t[gb])throw Error.argument("blobID","Requested blob is not a string");if(null==this.Sba[gb]){const Mb=this.sqb(gb).J(0);this.Sba[gb]=this.S7f.kD(Mb)}return this.Sba[gb]}Ykc(gb){if(1>gb||gb>=this.KF.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.KF.t[gb])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.Sba[gb]){var Mb=this.sqb(gb);const hc=this.kD(Mb.J(0));Mb=1===Mb.J(1);this.Sba[gb]=new RegExp(hc,Mb?"i":"")}return this.Sba[gb]}jJm(gb){if(1>gb||
gb>=this.KF.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.KF.t[gb])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}WLf(gb){if(1>gb||gb>=this.KF.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.KF.t[gb])throw Error.argument("blobID","Requested blob is not an NL module");return this.Sba[gb]||(this.Sba[gb]=this.aHn.GAm(this.sqb(gb),this))}lN(gb){if(1>gb||gb>=this.KF.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.KF.t[gb])throw Error.argument("blobID",
"Requested blob is not an annotation query");return this.Sba[gb]||(this.Sba[gb]=new Oa(new hg(this.sqb(gb),this)))}hPb(gb){if(1>gb||gb>=this.KF.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.KF.t[gb])throw Error.argument("blobID","Requested blob is not an annotation script");return this.Sba[gb]||(this.Sba[gb]=new Vf(new gi(this.sqb(gb),this)))}Jsa(gb){if(1>gb||gb>=this.KF.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.KF.t[gb])throw Error.argument("blobID","Requested blob is not a filter");
return this.Sba[gb]||(this.Sba[gb]=this.YGn.Jsa(this.sqb(gb),this))}vHm(gb){if(1>gb||gb>=this.KF.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.KF.t[gb])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.Sba[gb]||(this.Sba[gb]=new Bc(this.sqb(gb),this))}sqb(gb){const Mb=this.KF.n[gb];gb=(gb<this.KF.t.length-1?this.KF.n[gb+1]:this.KF.n.length)-Mb;if(0>Mb||0>gb||Mb+gb>this.KF.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+
Mb+","+gb+")");const hc=new rb.a;hc.QFf(this.KF.n,Mb,gb);return hc}}Object(m.a)(Ih,"ObjectFetcher",null,[1660]);class tg{constructor(gb,Mb,hc){if(!gb)throw Error.argumentNull("prediction");if(!Mb)throw Error.argumentNull("fieldNames");if(!hc)throw Error.argumentNull("values");if(Mb.length!==hc.length)throw Error.argument("values","fieldNames and values do not have same length");this.jJk=gb;this.gVb=Mb;this.Lcd=hc}get prediction(){return this.jJk}get Mni(){return this.gVb.length}SJf(gb){return 0<=
gb&&gb<this.gVb.length?this.gVb[gb]:null}getValue(gb){return 0<=gb&&gb<this.Lcd.length?this.Lcd[gb]:null}}Object(m.a)(tg,"PredictionData",null,[]);class Dh{constructor(gb,Mb){if(!gb)throw Error.argumentNull("predictions");if(!Mb)throw Error.argumentNull("tokenAttributes");this.dHn=gb;this.hHn=Mb}dNf(){return this.dHn}wti(){return this.hHn}}Object(m.a)(Dh,"PredictionDataWithTokenAttributes",null,[]);class Jh{constructor(gb,Mb){this.prediction=null;this.score=0;this.prediction=gb;this.score=Mb}}Object(m.a)(Jh,
"PredictionWithScore",null,[]);class Xh{constructor(gb,Mb){if(!gb)throw Error.argumentNull("predictions");if(!Mb)throw Error.argumentNull("attributes");this.kJk=gb;this.sok=Mb}dNf(){return this.kJk}wti(){return this.sok}}Object(m.a)(Xh,"PredictionsWithTokenAttributes",null,[]);class Mf{constructor(gb,Mb,hc){if(!gb)throw Error.argumentNull("attributeName");if(!Mb)throw Error.argumentNull("fieldNames");if(!hc)throw Error.argumentNull("values");if(Mb.length!==hc.length)throw Error.argument("values",
"fieldNames and values do not have same length");this.rok=gb;this.gVb=Mb;this.Lcd=hc}get attributeName(){return this.rok}get Mni(){return this.gVb.length}SJf(gb){return 0<=gb&&gb<this.gVb.length?this.gVb[gb]:null}getValue(gb){return 0<=gb&&gb<this.Lcd.length?this.Lcd[gb]:null}}Object(m.a)(Mf,"TokenAttributes",null,[]);var Jg=d(104),ug=d(145);class ze{constructor(gb,Mb,hc,Kc,Vc){this.kvd=0;this.QPg=null;this.lvd=this.ZBc=0;this.uHe=this.t3b=this.zwa=this.$Bc=null;this.RPg=0;this.O1e=this.RD=null;this._state=
-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.FV=gb;this.Xck=this.adk=Mb;this.Wck=this.Zck=hc;this.ivd=this.Yck=Kc;this.jvd=this.$ck=Vc}bdk(){this.lvd=0;return this.OPg}OPg(){if(!(this.lvd<this.ivd))return this.PPg;this.$Bc=this.Xck.items[this.lvd+this.Wck];this.zwa=new M.a(this.FV.Bb.annotations);1!==this.ivd&&this.FV.Bb.T8c||this.zwa.j7a(this.$Bc);if(0<=this.FV.Bb.$ke){({value:this.t3b}=this.zwa.xr(this.FV.Bb.$ke)).returnValue?this.t3b=
this.t3b.IW():this.t3b=new ob.a(this.FV.Bb.annotations,N.Annotations.HY);this.uHe=this.jvd.items;this.RPg=this.uHe.length;for(this.kvd=0;this.kvd<this.RPg;++this.kvd)this.QPg=this.uHe[this.kvd],Array.add(this.t3b.items,this.QPg);this.zwa.jA(this.FV.Bb.$ke,this.t3b)}else 0<=this.FV.Bb.uEg?this.zwa.jA(this.FV.Bb.uEg,this.jvd.items[0]):0<=this.FV.Bb.plf?this.zwa.jA(this.FV.Bb.plf,!0):this.FV.Bb.v0i?this.jvd.items[0].w4d((gb,Mb)=>this.zwa.jA(gb,Mb)):(this.zwa.j7a(this.jvd.items[0]),1!==this.ivd&&this.FV.Bb.T8c||
(({value:this.ZBc}=this.$Bc.xr(this.FV.Bb.F6)).returnValue&&this.zwa.jA(this.FV.Bb.F6,this.ZBc),({value:this.ZBc}=this.$Bc.xr(this.FV.Bb.haa)).returnValue&&this.zwa.jA(this.FV.Bb.haa,this.ZBc),this.$Bc.xr(this.FV.Bb.zmb).returnValue&&this.zwa.jA(this.FV.Bb.zmb,this.ZBc)));this.RD=this.zwa;this._state=2;return this.ddk}PPg(){this._state=3}cdk(){this.lvd++;return this.OPg}ddk(){return 1<this.ivd&&this.FV.Bb.T8c?this.PPg:this.cdk}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):
(new ze(this.FV,this.adk,this.Zck,this.Yck,this.$ck)).getEnumerator()}[Symbol.iterator](){return Object(ug.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.O1e=this.bdk());for(;1===this._state;)this.O1e=this.O1e();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.RD}}Object(m.a)(ze,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",
null,[13,19,39]);class pi{constructor(gb,Mb,hc){this.Icd=this.Jbj=0;this.nrc=null;this.T7f=this.A7f=this.lrc=this.nje=this.D7f=0;this.oje=!1;this.N7f=gb;this.V7f=Mb;this.cHn=hc}OCi(){null===this.nrc&&({n0j:this.nrc,bQi:this.D7f,length:this.nje,z5l:gb}=this.N7f.DJi(this.V7f.items[this.Icd],this.cHn),this.oje=gb||this.oje);if(this.lrc<this.nje){var gb=this.nrc.charAt(this.D7f+this.lrc);++this.lrc;return{returnValue:!0,ch:gb}}if(this.Icd===this.V7f.items.length-1)return{returnValue:!1,ch:"\x00"};++this.Icd;
this.lrc=0;this.nrc=null;return{returnValue:!0,ch:" "}}Jrg(gb,Mb){this.lrc===this.nje&&this.nrc&&(this.T7f=Mb,this.A7f=this.Icd-this.Jbj+1)}WFo(gb){if(0>gb||gb>=this.V7f.items.length)throw Error.argumentOutOfRange("iToken");this.Icd=this.Jbj=gb;this.nrc=null;this.A7f=this.lrc=this.nje=this.D7f=0;this.T7f=-1;this.oje=!1}jzm(){return{hil:this.A7f,Ivn:this.T7f,y5l:this.oje}}}Object(m.a)(pi,"TriePrefixVisitor",null,[1710]);class og{constructor(gb){this.Bb=gb}execute(gb){if(!({value:hc}=gb.xr(this.Bb.aUa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Mb;({value:Mb}=gb.xr(this.Bb.n6a)).returnValue||(Mb=null);var hc=this.Ggm(hc,Mb);gb=N.Annotations.IW(gb);gb.jA(this.Bb.aUa,hc);return gb}Ggm(gb,Mb){let hc=null;const Kc=this.Bb.flatLexicon.trie,Vc=new pi(this,gb,Mb);let od=null;this.Bb.flatLexicon.MXf()&&(od=Object(Jg.a)(this.Bb.flatLexicon,this.Bb.flatLexicon.ukm,"getCaseInsensitiveForm"));let Od=0,Ld;var Af;let Tb;for(;Od<gb.items.length;){const Dg=gb.items[Od];Vc.WFo(Od);Kc.Rak(Vc,od);({hil:Ld,Ivn:Af,y5l:Tb}=Vc.jzm());if(0<Ld){({Fyn:Af}=this.Bb.flatLexicon.Ahm(Af));
for(let Kh of this.QHl(gb,Od,Ld,Af)){1<Ld&&this.Bb.T8c&&this.JIl(gb,Mb,Od,Dg,Ld,Tb,Kh);if(!hc)for(hc=new ob.a(this.Bb.annotations,N.Annotations.HY),Af=0;Af<Od;++Af)Array.add(hc.items,gb.items[Af]);Array.add(hc.items,Kh)}Od+=Ld}else hc&&Array.add(hc.items,Dg),++Od}return hc||gb}JIl(gb,Mb,hc,Kc,Vc,od,Od){if(od)od=!0;else if(this.Bb.c0i){od=!1;var Ld=-1;for(var Af=0;Af<Vc;Af++){var Tb=gb.items[hc+Af];let ai;var Dg=void 0;if(!({value:ai}=Tb.xr(this.Bb.F6)).returnValue||!({value:Dg}=Tb.xr(this.Bb.haa)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Af){if(ai>Ld+1){od=!0;break}if(0>Ld||null===Mb||Ld>=Mb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Mb.charAt(Ld)){od=!0;break}}Ld=ai+Dg}}else od=!1;if(od){Dg=new Sys.StringBuilder;for(od=0;od<Vc;++od)({n0j:Ld,bQi:Af,length:Tb}=this.DJi(gb.items[hc+od],Mb)),0<od&&Dg.append(" "),Dg.append(Ld.substr(Af,Tb));Od.jA(this.Bb.zmb,Dg.toString())}gb=gb.items[hc+Vc-1];let Kh,rg;({value:Kc}=Kc.xr(this.Bb.F6)).returnValue&&
({value:Kh}=gb.xr(this.Bb.F6)).returnValue&&({value:rg}=gb.xr(this.Bb.haa)).returnValue?(Od.jA(this.Bb.F6,Kc),Od.jA(this.Bb.haa,Kh+rg-Kc)):(Od.UZa(this.Bb.F6),Od.UZa(this.Bb.haa))}QHl(gb,Mb,hc,Kc){return new ze(this,gb,Mb,hc,Kc)}DJi(gb,Mb){let hc,Kc;if(({value:hc}=gb.xr(this.Bb.zmb)).returnValue)Kc=!0,Mb=0,gb=hc.length;else{Kc=!1;if(null===Mb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");hc=Mb;if(!({value:Mb}=gb.xr(this.Bb.F6)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:gb}=gb.xr(this.Bb.haa)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Mb||0>gb||Mb+gb>hc.length)throw Error.argument("Token start/length values out of range","token");}return{n0j:hc,bQi:Mb,length:gb,z5l:Kc}}}Object(m.a)(og,"FlatLexiconNLModule",null,[1691]);class Jk{constructor(gb,Mb){this.plf=this.$ke=this.uEg=this.zmb=this.haa=this.F6=this.n6a=this.aUa=0;this.v0i=this.c0i=this.T8c=!1;this.flatLexicon=null;this.annotations=Mb.annotations;
let hc=0;try{this.aUa=gb.J(hc),++hc,this.n6a=gb.J(hc),++hc,this.F6=gb.J(hc),++hc,this.haa=gb.J(hc),++hc,this.zmb=gb.J(hc),++hc,this.uEg=gb.J(hc),++hc,this.$ke=gb.J(hc),++hc,this.plf=gb.J(hc),++hc,this.T8c=1===gb.J(hc),++hc,this.c0i=1===gb.J(hc),++hc,this.v0i=1===gb.J(hc),++hc,this.flatLexicon=Mb.vHm(gb.J(hc))}catch(Kc){throw Error.argument("initData");}}}Object(m.a)(Jk,"FlatLexiconNLModuleInit",null,[]);class zk{constructor(){this.O6c=0;this.DDf=null;this.Vmd=0}}Object(m.a)(zk,"FeatureGenStackRec",
null,[]);class Xf{constructor(gb){this.uJg=Array(gb);this.eAc=Array(gb);this.$Fg=[];this.MYj=[]}}Object(m.a)(Xf,"TokenStringLattice",null,[]);const Gg=(gb,Mb,hc)=>{for(let Kc=0;Kc<gb.length;Kc++)hc=Mb(hc,gb[Kc]);return hc},Lg=(gb,Mb)=>{const hc=Array(gb.length);for(let Kc=0;Kc<gb.length;Kc++)hc[Kc]=Mb(gb[Kc]);return hc},ak=(gb,Mb)=>{Mb=Array(Math.min(Mb,gb.length));for(let hc=0;hc<Mb.length;hc++)Mb[hc]=gb[hc];return Mb},Rf=(gb,Mb)=>{const hc=[];for(const Kc of gb)Mb(Kc)&&Array.add(hc,Kc);return hc};
class Bg{constructor(gb,Mb){this.key=gb;this.value=Mb}}Object(m.a)(Bg,"KeyValuePair",null,[]);const bk=(gb,Mb)=>({returnValue:Mb in gb,value:gb[Mb]}),Kk=gb=>{const Mb=[];for(let hc in gb){const Kc=new Bg(hc,gb[hc]);Array.add(Mb,Kc)}return Mb};class Pi{constructor(gb){this.CJi=this.COm;this.Bb=gb;this.rje=this.K7f=this.L7f=0;for(const Mb of this.Bb.T2d)this.L7f=Math.max(this.L7f,Mb.Xlg),this.K7f=Math.max(this.K7f,Mb.Qlg),this.rje=Math.max(this.rje,Mb.Uyb.length)}get W7l(){return this.Bb.BDe.trie}execute(gb){if(!gb)throw Error.argumentNull("input");
let Mb,hc;({tokens:Mb,Uwn:hc}=this.DOm(gb));let Kc=null,Vc=null,od={};if(this.Bb.y9c){Mb=N.Annotations.IW(Mb);for(var Od=0;Od<Mb.items.length;++Od)Mb.items[Od]=N.Annotations.IW(Mb.items[Od])}else({sni:Vc,returnValue:Kc}=this.DDi(gb,od));Od=Array(this.rje);const Ld=Array(this.rje);for(var Af=0;Af<Ld.length;++Af)Ld[Af]=new zk;for(Af=-this.L7f;Af<Mb.items.length+this.K7f;++Af){let Tb=null;this.Bb.y9c&&(Tb=Mb.items[Af],od={},{sni:Vc,returnValue:Kc}=this.DDi(Tb,od));for(const Dg of this.Bb.T2d){if(0>Af&&
-Af>Dg.Xlg||Af>=Mb.items.length&&Af-Mb.items.length+1>Dg.Qlg)continue;let Kh=!0;for(let rg=0;rg<Dg.Uyb.length;++rg){const ai=Af+Dg.Uyb[rg];Od[rg]=ai;if(0>ai?0>this.Bb.Ylg:ai>=Mb.items.length?0>this.Bb.Rlg:!hc.eAc[ai]){Kh=!1;break}}Kh&&({bMl:Kc,cMl:Vc}=this.Van(Dg,hc,Kc,Vc,od,Ld,Od))}this.Bb.y9c&&(Tb.jA(this.Bb.eab?this.Bb.Fdc:this.Bb.Ddc,Kc),this.Bb.eab&&Tb.jA(this.Bb.Edc,Vc))}gb=N.Annotations.IW(gb);this.Bb.y9c?gb.jA(this.Bb.aUa,Mb):(gb.jA(this.Bb.eab?this.Bb.Fdc:this.Bb.Ddc,Kc),this.Bb.eab&&gb.jA(this.Bb.Edc,
Vc));return gb}DOm(gb){let Mb,hc;if(!gb||!({value:Mb}=gb.xr(this.Bb.aUa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Kc;({value:Kc}=gb.xr(this.Bb.n6a)).returnValue||(Kc="");hc=new Xf(Mb.items.length);const Vc=Rf(this.Bb.xJg,od=>!od.V7c||od.V7c.isMatch(gb,null));for(let od=0;od<Mb.items.length;++od){const Od=Mb.items[od];let Ld=null;hc.uJg[od]=hc.$Fg.length;let Af=hc.eAc[od]=0;for(const Tb of Vc)0<Tb.Ycd&&hc.eAc[od]+Af>=Tb.Ycd||Tb.hsd&&!Tb.hsd.isMatch(Od,
null)||({isd:Ld,CUc:Af}=Tb.apply(this,Od,od,hc,Kc,Ld,Af))}return{tokens:Mb,Uwn:hc}}Van(gb,Mb,hc,Kc,Vc,od,Od){let Ld=0;od[0].O6c=-1;for(od[0].DDf=gb.mIj;;){var Af=Od[Ld],Tb=0>Af||Af>=Mb.eAc.length?1:Mb.eAc[Af];let rg=!1;for(;od[Ld].O6c<Tb-1;){++od[Ld].O6c;var Dg=void 0,Kh=void 0;0>Af?(Dg=this.Bb.Ylg,Kh=1):Af>=Mb.uJg.length?(Dg=this.Bb.Rlg,Kh=1):(Kh=Mb.uJg[Af]+od[Ld].O6c,Dg=Mb.$Fg[Kh],Kh=Mb.MYj[Kh]);od[Ld].Vmd=Kh*(Ld?od[Ld-1].Vmd:gb.score);if(({value:Dg}=bk(od[Ld].DDf,Dg.toString())).returnValue){Ld===
gb.Uyb.length-1?(Af=Dg,od[Ld].Vmd&&(({value:Tb}=bk(Vc,Af.toString())).returnValue||(Tb=-1),0>Tb&&(hc=N.Annotations.IW(hc),Array.add(hc.items,Af)),this.Bb.eab&&(Kc=N.Annotations.IW(Kc),0>Tb?Array.add(Kc.items,od[Ld].Vmd):Kc.items[Tb]+=od[Ld].Vmd),0>Tb&&(this.Bb.X3i||this.Bb.eab)&&(Vc[Af.toString()]=hc.items.length-1))):(++Ld,od[Ld].O6c=-1,od[Ld].DDf=Dg);rg=!0;break}}if(!rg&&(--Ld,0>Ld))break}return{bMl:hc,cMl:Kc}}DDi(gb,Mb){let hc;if(({value:hc}=gb.xr(this.Bb.eab?this.Bb.Fdc:this.Bb.Ddc)).returnValue)for(let Kc=
0;Kc<hc.items.length;++Kc)Mb[hc.items[Kc].toString()]=Kc;else hc=new ob.a(this.Bb.annotations,N.Annotations.uPa);if(this.Bb.eab){if(({value:Mb}=gb.xr(this.Bb.Edc)).returnValue||(Mb=new ob.a(this.Bb.annotations,N.Annotations.kwa)),Mb.items.length!==hc.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Bb.annotations.bia(N.Annotations.HY,gb));}else Mb=null;return{returnValue:hc,sni:Mb}}get klp(){return this.Bb.BDe}COm(gb,
Mb){var hc;if(({value:hc}=Mb.xr(this.Bb.zmb)).returnValue)gb=hc;else{if(!({value:hc}=Mb.xr(this.Bb.F6)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Mb}=Mb.xr(this.Bb.haa)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>hc||0>Mb||hc+Mb>gb.length)throw Error.argument("Token indices are out of range");gb=gb.substr(hc,Mb)}return gb}}Object(m.a)(Pi,"NGramNLModule",null,[1691,1692]);class Uj{constructor(gb){this.Uyb=null;this.score=this.Qlg=this.Xlg=
0;this.mIj=null;if(gb){var Mb=0;try{if(gb.J(Mb)!==Uj.fLb)throw Error.argument("initData","Input does not represent a feature template");++Mb;const hc=gb.J(Mb);++Mb;this.Uyb=Array(hc);for(let Kc=0;Kc<hc;++Kc)this.Uyb[Kc]=gb.J(Mb),++Mb;this.Xlg=gb.J(Mb);++Mb;this.Qlg=gb.J(Mb);++Mb;this.score=gb.J(Mb);++Mb;this.mIj=({WPi:Mb}=Uj.Syj(gb,Mb)).returnValue}catch(hc){throw Error.argument("initData");}}}static Syj(gb,Mb){const hc=gb.J(Mb);++Mb;const Kc={};for(let Vc=0;Vc<hc;++Vc){const od=gb.J(Mb);++Mb;gb.J(Mb)?
Kc[od.toString()]=({WPi:Mb}=Uj.Syj(gb,Mb)).returnValue:(++Mb,Kc[od.toString()]=gb.J(Mb),++Mb)}return{returnValue:Kc,WPi:Mb}}}Uj.fLb=240803228;Object(m.a)(Uj,"FeatureTemplate",null,[1709]);var jk=d(1675);class Bj{constructor(gb,Mb){this.eab=this.X3i=this.y9c=!1;this.zmb=this.haa=this.F6=this.aUa=this.n6a=this.Edc=this.Fdc=this.Ddc=0;this.BDe=null;this.Rlg=this.Ylg=0;this.T2d=this.xJg=null;if(gb){this.annotations=Mb.annotations;var hc=0;try{this.y9c=1===gb.J(hc);++hc;this.X3i=1===gb.J(hc);++hc;this.eab=
1===gb.J(hc);++hc;this.Ddc=gb.J(hc);++hc;this.Fdc=gb.J(hc);++hc;this.Edc=gb.J(hc);++hc;this.n6a=gb.J(hc);++hc;this.aUa=gb.J(hc);++hc;this.F6=gb.J(hc);++hc;this.haa=gb.J(hc);++hc;this.zmb=gb.J(hc);++hc;this.BDe=this.V9n(Mb.yqb(gb.J(hc)));++hc;this.Ylg=gb.J(hc);++hc;this.Rlg=gb.J(hc);++hc;const Kc=gb.J(hc);++hc;this.xJg=Array(Kc);for(let od=0;od<Kc;++od){const Od=gb.J(hc);++hc;const Ld=this.BDe.trie,Af=new rb.a;Af.cqb(gb,hc,Od);this.xJg[od]=this.Z9n(Af,Mb,Ld);hc+=Od}const Vc=gb.J(hc);++hc;this.T2d=
Array(Vc);for(Mb=0;Mb<Vc;++Mb){const od=gb.J(hc);++hc;const Od=new rb.a;Od.cqb(gb,hc,od);this.T2d[Mb]=this.A9n(Od);hc+=od}}catch(Kc){throw Error.argument("initData");}}}V9n(gb){return new td.a(new Je.a(gb))}Z9n(gb,Mb,hc){return jk.a.create(gb,Mb,hc)}A9n(gb){return new Uj(gb)}}Object(m.a)(Bj,"NGramNLModuleInit",null,[]);class Vj{constructor(gb){this.Bb=gb}execute(gb){if(!gb)throw Error.argumentNull("input");gb=gb.clone();this.Bb.script.execute(gb,null);return gb}}Object(m.a)(Vj,"ScriptNLModule",null,
[1691]);class Cl{constructor(gb,Mb){gb&&(this.script=Mb.hPb(gb.J(0)))}}Object(m.a)(Cl,"ScriptNLModuleInit",null,[]);const ah=gb=>{gb=Lg(gb,Mb=>Mb*Mb);return Math.sqrt(Gg(gb,(Mb,hc)=>Mb+hc,0))},zh=gb=>Gg(gb,(Mb,hc)=>Mb>hc?Mb:hc,gb[0]);class Ql{constructor(gb){this.Bb=gb}execute(gb){if(!gb)throw Error.argumentNull("input");var Mb=[],hc=[];this.Aul(gb,Mb,hc);this.$2k(Mb,hc);const Kc={};for(let od=0;od<Mb.length;++od){var Vc=Mb[od];const Od=this.Bb.lUi.J(Vc);Vc=this.Bb.mUi.J(Vc);for(let Ld=0;Ld<Vc;++Ld){const Af=
this.Bb.uaa.J(this.Bb.C2h.J(Od+Ld)),Tb=this.Bb.D2h.J(Od+Ld);let Dg;({value:Dg}=bk(Kc,Af)).returnValue||(Dg=0);Kc[Af]=Dg+hc[od]*Tb}}hc=Kk(Kc);hc.sort((od,Od)=>{var Ld=od.value,Af=Od.value;(Ld=-(Ld>Af?1:Ld<Af?-1:0))||(Ld=od.key.localeCompare(Od.key));return Ld});Mb=new ob.a(this.Bb.annotations,N.Annotations.HY);for(const od of ak(hc,this.Bb.EJn))hc=new M.a(this.Bb.annotations),hc.jA(this.Bb.jal,od.key),hc.jA(this.Bb.lal,od.value),Array.add(Mb.items,hc);gb.jA(this.Bb.kal,Mb);return gb}Aul(gb,Mb,hc){if(({value:gb}=
gb.xr(this.Bb.ial)).returnValue){let Kc;if(({value:Kc}=gb.xr(this.Bb.Fdc)).returnValue){let Vc;if(!({value:Vc}=gb.xr(this.Bb.Edc)).returnValue||Kc.items.length!==Vc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.IWd(Kc,Vc,Mb,hc)}if(({value:Kc}=gb.xr(this.Bb.nal)).returnValue){let Vc;if(!({value:Vc}=gb.xr(this.Bb.oal)).returnValue||Kc.items.length!==Vc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.IWd(Kc,Vc,Mb,hc)}({value:Kc}=gb.xr(this.Bb.Ddc)).returnValue&&this.IWd(Kc,null,Mb,hc);({value:Kc}=gb.xr(this.Bb.mal)).returnValue&&this.IWd(Kc,null,Mb,hc)}}IWd(gb,Mb,hc,Kc){for(let od=0;od<gb.items.length;++od){var Vc=void 0;gb.d8===N.Annotations.eda?({value:Vc}=bk(this.Bb.Qii,gb.items[od])).returnValue||(Vc=-1):(Vc=gb.items[od],Vc=Vc>=this.Bb.u9f&&Vc<=this.Bb.hKn?this.Bb.scg?this.Bb.scg.J(Vc-this.Bb.u9f)-1:Vc-this.Bb.u9f:-1);if(0<=Vc){let Od;Od=Mb?Mb.items[od]:1;0<Od&&(Array.add(hc,Vc),Array.add(Kc,
Od))}}}$2k(gb,Mb){if(gb.length){switch(this.Bb.Fjo){case 0:break;case 1:for(var hc=0;hc<Mb.length;++hc)Mb[hc]=1+Math.log(Mb[hc]);break;case 2:hc=zh(Mb);for(let Kc=0;Kc<Mb.length;++Kc)Mb[Kc]=.5+Mb[Kc]/hc*.5;break;case 3:for(hc=0;hc<Mb.length;++hc)Mb[hc]=1;break;default:throw Error.notImplemented();}if(this.Bb.Kce)for(hc=0;hc<Mb.length;++hc)Mb[hc]*=this.Bb.Kce.J(gb[hc]);gb=ah(Mb);for(hc=0;hc<Mb.length;++hc)Mb[hc]/=gb}}}Object(m.a)(Ql,"TfIdfRankerNLModule",null,[1691]);class al{constructor(gb,Mb=0){if(!gb)throw Error.argumentNull("byteArray");
this.sje=Mb;if(604662927!==gb.hA(this.sje+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Jk=gb.hA(this.sje+4,4);this.sbj=gb.hA(this.sje+8,4);this.RGn=gb}J(gb){if(0>gb||gb>=this.count)throw Error.argumentOutOfRange("index");return this.RGn.eoo(8*this.sje+96+gb*this.sbj,this.sbj)}get count(){return this.Jk}}Object(m.a)(al,"CompactIntArray",null,[1689]);const ji=(gb,Mb)=>{Mb=Array(Mb);for(let od=0;od<Mb.length;od++){var hc=od,Kc=gb.wca(),Vc=1===(Kc>>31&1)?
-1:1;const Od=Kc&8388607;Kc=Kc>>23&255;256===Kc+1?Vc=Od?Number.NaN:1===Vc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Kc?(Kc-=127,Vc=Vc*kh(Od,1)*Math.pow(2,Kc)):Vc=Vc*kh(Od,0)*Math.pow(2,-126);Mb[hc]=Vc}return Mb},kh=(gb,Mb)=>{let hc=0;for(let Kc=0;23>Kc;Kc++)hc+=(gb>>22-Kc&1)/Math.pow(2,Kc+1);return Mb+hc};class bh{constructor(gb,Mb){this.scg=null;this.qij=0;this.mUi=this.lUi=this.Kce=null;this.pij=0;this.D2h=this.C2h=null;this.annotations=Mb.annotations;let hc=0;this.mal=gb.J(hc);++hc;this.Ddc=
gb.J(hc);++hc;this.nal=gb.J(hc);++hc;this.oal=gb.J(hc);++hc;this.Fdc=gb.J(hc);++hc;this.Edc=gb.J(hc);++hc;this.ial=gb.J(hc);++hc;this.kal=gb.J(hc);++hc;this.jal=gb.J(hc);++hc;this.lal=gb.J(hc);++hc;var Kc=gb.J(hc);++hc;var Vc=Array(Kc);for(var od=0;od<Kc;++od)Vc[od]=Mb.kD(gb.J(hc)),++hc;this.uaa=rb.a.uuf(Vc);this.EJn=gb.J(hc);++hc;this.Fjo=gb.J(hc);++hc;Kc=gb.J(hc);++hc;this.Qii={};for(Vc=0;Vc<Kc;++Vc){od=Mb.kD(gb.J(hc));++hc;const Od=gb.J(hc);++hc;this.Qii[od]=Od}this.u9f=gb.J(hc);++hc;this.hKn=
gb.J(hc);++hc;Kc=gb.J(hc);++hc;0<Kc&&(Kc=Mb.yqb(gb.J(hc)),++hc,this.scg=this.Vpe(new Bb(Kc)));++hc;gb=Mb.yqb(gb.J(hc));this.J9n(gb)}Vpe(gb){return new al(gb.Lja,gb.offset)}J9n(gb){try{const Mb=new Bb(gb);this.qij=Mb.wca();1===Mb.wca()?this.Kce=rb.a.uuf(ji(Mb,this.qij)):this.Kce=null;const hc=Mb.wca();this.lUi=this.Vpe(Mb);Mb.offset+=hc;const Kc=Mb.wca();this.mUi=this.Vpe(Mb);Mb.offset+=Kc;this.pij=Mb.wca();const Vc=Mb.wca();this.C2h=this.Vpe(Mb);Mb.offset+=Vc;this.D2h=rb.a.uuf(ji(Mb,this.pij))}catch(Mb){throw Error.argument("byteReader");
}}}Object(m.a)(bh,"TfIdfRankerNLModuleInit",null,[]);class hj{constructor(gb,Mb,hc,Kc){this.Qjg=gb;this.ppi=hc;this.tokens=Kc;this.Qra=Mb;this.Lwc=-1;this.axe=0}}Object(m.a)(hj,"TokenizerData",null,[]);class uj{constructor(gb){this.Bb=gb}execute(gb){if(!gb)throw Error.argumentNull("input");if(!({value:Kc}=gb.xr(this.Bb.n6a)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Mb;({value:Mb}=gb.xr(this.Bb.F6)).returnValue||(Mb=0);let hc;({value:hc}=
gb.xr(this.Bb.haa)).returnValue||(hc=Kc.length-Mb);if(0>Mb||Mb>Kc.length)throw Error.argument("input","Start index out of range");if(0>hc||hc>Kc.length)throw Error.argument("input","Length out of range");if(Mb+hc>Kc.length)throw Error.argument("input","Bad start-length range");var Kc=new hj(Kc,Mb,Mb+hc,new ob.a(this.Bb.annotations,N.Annotations.HY));this.llp(Kc);gb=gb.isReadOnly?gb.clone():gb;gb.jA(this.Bb.aUa,Kc.tokens);return gb}llp(gb){for(;gb.Qra<gb.ppi;){if(this.Bb.EQf){var Mb=this.Bb.EQf.Uaj(gb.Qjg,
gb.Qra,gb.ppi-gb.Qra,null);!Mb.succeeded&&Mb.dhj&&(Mb=Mb.dhj);if(Mb.succeeded){this.kmj(gb,Mb.length,this.Bb.WLi);gb.Qra+=Mb.length;continue}}Mb=gb.Qjg.substr(gb.Qra);let hc=-1,Kc=-1,Vc=-1;for(let od=0;od<this.Bb.Zve.length;++od){const Od=this.Bb.Zve[od].exec(Mb);Od&&0<Od[1].length&&(0>hc||Od[0].length>Kc)&&(hc=od,Kc=Od[0].length,Vc=Od[1].length)}0<=hc?(this.kmj(gb,Vc,this.Bb.Ewg[hc]),gb.Qra+=Vc):gb.Qra+=1}}kmj(gb,Mb,hc){if(this.Bb.k2i)hc!==uj.ril&&(0>gb.Lwc&&(gb.Lwc=gb.Qra),gb.axe=gb.Qra+Mb-gb.Lwc,
hc===uj.qil&&(0<=gb.Lwc&&0<gb.axe&&(Mb=new M.a(this.Bb.annotations),Mb.jA(this.Bb.F6,gb.Lwc),Mb.jA(this.Bb.haa,gb.axe),Mb.jA(this.Bb.dkf,uj.sil),Mb.jA(this.Bb.n6a,gb.Qjg),Array.add(gb.tokens.items,Mb)),gb.Lwc=-1,gb.axe=0));else{let Kc=new M.a(this.Bb.annotations);Kc.jA(this.Bb.F6,gb.Qra);Kc.jA(this.Bb.haa,Mb);Kc.jA(this.Bb.dkf,hc);Array.add(gb.tokens.items,Kc)}}}uj.ril="GAP";uj.qil="EOS_CHUNK";uj.sil="SENTENCE";Object(m.a)(uj,"TokenizerNLModule",null,[1691]);class wg{constructor(gb,Mb){this.haa=this.F6=
this.dkf=this.aUa=this.n6a=0;this.k2i=!1;this.Ewg=this.Zve=this.WLi=this.EQf=null;if(gb){this.annotations=Mb.annotations;var hc=0;try{this.n6a=gb.J(hc);++hc;this.aUa=gb.J(hc);++hc;this.dkf=gb.J(hc);++hc;this.F6=gb.J(hc);++hc;this.haa=gb.J(hc);++hc;this.k2i=1===gb.J(hc);++hc;var Kc=gb.J(hc);++hc;0<Kc&&(this.EQf=Mb.WLf(Kc).W7l);this.WLi=gb.J(hc)?Mb.kD(gb.J(hc)):"";++hc;const Vc=gb.J(hc);++hc;this.Zve=Array(Vc);this.Ewg=Array(Vc);for(Kc=0;Kc<Vc;++Kc)this.Zve[Kc]=new RegExp(Mb.kD(gb.J(hc))),++hc,this.Ewg[Kc]=
Mb.kD(gb.J(hc)),++hc}catch(Vc){throw Error.argument("initData");}}}}Object(m.a)(wg,"TokenizerNLModuleInit",null,[]);class Ni{constructor(gb){this.Bb=gb}execute(gb){if(!gb)throw Error.argumentNull("input");let Mb;if(!({value:Mb}=gb.xr(this.Bb.uVh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const hc of this.Bb.lFg)Mb=hc.apply(Mb);gb=N.Annotations.IW(gb);gb.jA(this.Bb.vVh,Mb);return gb}static pjf(gb,Mb){const hc=new Sys.StringBuilder;for(let Kc=
0;Kc<gb.length;++Kc)hc.append(Mb(gb.substr(Kc,1)));return hc.toString()}}Object(m.a)(Ni,"TransliteratorNLModule",null,[1691]);class Md{constructor(gb){gb&&(this.style=gb.J(0))}apply(gb){return Ni.pjf(gb,Mb=>Md.jnl(Mb,this.style))}static jnl(gb,Mb){switch(Mb){case 0:return gb.toLowerCase();case 1:return"I"===gb?"\u0131":gb.toLowerCase();case 2:return gb.toUpperCase();case 3:return"i"===gb?"\u0130":gb.toUpperCase();default:throw Error.invalidOperation();}}}Md.gLb=0;Object(m.a)(Md,"ChangeCaseTransliterationStage",
null,[1706]);class nf{apply(gb){return Ni.pjf(gb,nf.Nmp)}static Nmp(gb){const Mb=gb.charCodeAt(0);return 65281<=Mb&&65374>=Mb?String.fromCharCode(Mb-65248):gb}}nf.gLb=4;Object(m.a)(nf,"LatinFullWidthToHalfWidthTransliterationStage",null,[1706]);class bn{constructor(gb,Mb){gb&&(this.Yqg=Mb.Ykc(gb.J(0)),this.DDo=Mb.kD(gb.J(1)))}apply(gb){return gb.replace(this.Yqg,this.DDo)}}bn.gLb=1;Object(m.a)(bn,"RegexReplaceTransliterationStage",null,[1706]);class Wi{constructor(gb,Mb){if(gb){var hc=gb.J(0),Kc=
Mb.kD(gb.J(1)),Vc=new al(Mb.yqb(gb.J(2)));gb=0>gb.J(3)?null:new al(Mb.yqb(gb.J(3)));this.tGg={};for(Mb=0;Mb<hc;++Mb)this.tGg[Kc.charAt(Mb).toString()]=Kc.substr(Vc.J(Mb),gb?gb.J(Mb):1)}}apply(gb){return Ni.pjf(gb,Mb=>Mb in this.tGg?this.tGg[Mb]:Mb)}}Wi.gLb=2;Object(m.a)(Wi,"SingleCharSubstitutionsTransliterationStage",null,[1706]);class ee{constructor(gb,Mb){this.vVh=this.uVh=0;this.lFg=null;if(gb){this.annotations=Mb.annotations;var hc=0;try{this.uVh=gb.J(hc);++hc;this.vVh=gb.J(hc);++hc;const Kc=
gb.J(hc);++hc;this.lFg=Array(Kc);for(let Vc=0;Vc<Kc;++Vc){const od=gb.J(hc);++hc;const Od=gb.J(hc);++hc;const Ld=new rb.a;Ld.cqb(gb,hc,Od);hc+=Od;this.lFg[Vc]=this.U9n(od,Ld,Mb)}}catch(Kc){throw Error.argument("initData");}}}U9n(gb,Mb,hc){switch(gb){case Md.gLb:return new Md(Mb);case bn.gLb:return new bn(Mb,hc);case Wi.gLb:return new Wi(Mb,hc);case nf.gLb:return new nf;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(m.a)(ee,"TransliteratorNLModuleInit",
null,[]);class qd{GAm(gb,Mb){const hc=gb.J(0),Kc=new rb.a;Kc.cqb(gb,1,gb.count-1);switch(hc){case 0:return new Vj(new Cl(Kc,Mb));case 2:return new uj(new wg(Kc,Mb));case 3:return new Pi(new Bj(Kc,Mb));case 5:return new og(new Jk(Kc,Mb));case 9:return new Ni(new ee(Kc,Mb));case 10:return new Ql(new bh(Kc,Mb));default:throw Error.notImplemented();}}}Object(m.a)(qd,"NLModuleFactory",null,[1661]);class Il{constructor(gb){this.oil=";";if(!gb)throw Error.argumentNull("resource");this.tma=new Ih(gb,new tb,
new qd);this.N7f=this.tma.lAm();this.rbj=this.tma.annotations.c2c("Text.Text");this.pbj=this.tma.annotations.c2c("Classification.Predictions");this.y7f=this.tma.annotations.c2c("Classification.PredictionString");this.qbj=this.tma.annotations.c2c("Classification.Probability");this.QGn=this.tma.annotations.c2c("NLMod.Tokens");if(0>this.rbj||0>this.pbj||0>this.y7f||0>this.qbj)throw Error.argument("resourceObj","Resource does not represent a ranker");}Mim(){const gb=[];this.jCf(void 0,this.hui(gb),null);
return gb}Oim(gb,Mb){const hc=[],Kc=[];this.jCf(gb,this.hui(hc),(Vc,od)=>{const Od=this.tma.annotations.Vti(Vc),Ld=[],Af=[];Mb&&Mb.length&&-1===Array.indexOf(Mb,Od)||(Vc=this.tma.annotations.getAttributeType(Vc),this.cuj(Vc,od,Ld,Af),od=new Mf(Od,Ld,Af),Array.add(Kc,od))});return new Xh(hc,Kc)}Nim(gb){const Mb=[];this.jCf(gb,hc=>{let Kc;if(({value:Kc}=hc.xr(this.y7f)).returnValue){let Vc;({value:Vc}=hc.xr(this.qbj)).returnValue&&Array.add(Mb,new Jh(Kc,Vc))}},null);return Mb}jCf(gb,Mb,hc){var Kc=new M.a(this.tma.annotations);
Kc.jA(this.rbj,gb);gb=this.N7f.execute(Kc);if(({value:Kc}=gb.xr(this.pbj)).returnValue)for(const Vc of Kc.items)Mb(Vc);if(hc&&({value:Mb}=gb.xr(this.QGn)).returnValue)for(const Vc of Mb.items)Vc.w4d(hc)}cuj(gb,Mb,hc,Kc){if(N.Annotations.zK(gb))for(var Vc of Mb.items)this.cuj(Mb.d8,Vc,hc,Kc);else if(N.Annotations.P4j(gb)){Vc=this.tma.annotations.kDi(gb);for(let od=0;od<Vc;od++)Array.add(hc,this.tma.annotations.WHi(gb,od)),Array.add(Kc,this.tma.annotations.bia(this.tma.annotations.IQb(gb,od),Mb.Lqb(od)))}else Array.add(hc,
"VALUE"),Array.add(Kc,this.tma.annotations.bia(gb,Mb))}hui(gb){return Mb=>{let hc;({value:hc}=Mb.xr(this.y7f)).returnValue&&Array.add(gb,this.XFm(hc))}}XFm(gb){const Mb=gb.indexOf(this.oil);return 0>Mb?gb:gb.substring(0,Mb)}}Object(m.a)(Il,"Ranker",null,[]);var Vg=d(1614),oi=d(1627),Ah=d(2);class ag{constructor(gb,Mb){this.tsh="";this.T5e=null;this.U5e=!1;this.Ewa=null;this.uok=["TellMe.TellMeParamCollection"];this.kc=gb;this.e4a=Mb;this.kc.uKb&&(this.Ewa=null)}get Cse(){if(!this.T5e&&!this.U5e){let gb=
null;try{gb=window.TellMeModel}catch(Mb){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("QueryRanker","TellMeModel not found. Exception: "+Mb)}if(gb){try{this.T5e=new Il(gb)}catch(Mb){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Mb)}this.U5e=!0}else if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("QueryRanker","Classifier model not found")}return this.T5e}sN(){return"Command"}kX(){return 0===
this.kc.hw?0:1===this.kc.hw?1:2}hK(gb,Mb,hc=!1,Kc=f.a.su,Vc=null){const od=new v.a(gb);if((!Vc||Array.contains(Vc,0))&&!x.a.EU(gb)){if(!this.Cse&&this.U5e){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.kc.uKb&&this.Ewa&&this.Ewa.initialize();if(Vg.CommandResultsUtility.SXf(gb.Yg)&&(Vc=Vg.CommandResultsUtility.Ovi(gb.Yg),0<Vc.results.length)){Vc.displayName=
"Classifier Debug";od.aw(Vc);Mb.Ot(od);return}Vc=gb?this.tsh=gb.Yg:this.tsh;if(Ah.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Vc=this.ZFm(Vc);var Od=this.S5d(Vc.dNf());Vc=Vc.wti()}else Vc=this.YFm(Vc),Od=this.bmm(Vc),Vc=[];Vg.CommandResultsUtility.Fie(Od,!1,"Classifier","TFIDF");Od=Vg.CommandResultsUtility.z4c(gb,Od,this.kc,this.Ewa,this.e4a,Vc,0,1);0<Od.results.length&&Kc!==f.a.contextMenu&&(Od.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);hc||Od.results.length||this.kc.v3||
this.kc.Feb||(gb=new w.a("lookupNoResults",14,gb.Yg,null,1),Od.hy(gb));0<Od.results.length&&od.aw(Od);od.attributes=Vc}Mb.Ot(od)}dNf(){let gb=[];try{gb=this.Cse.Mim()}catch(Mb){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("GetPredictions","Exception: "+Mb)}return gb}YFm(gb){let Mb=[];try{Mb=this.Cse.Nim(gb)}catch(hc){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("GetPredictionsWithScore","Exception: "+hc)}return Mb}ZFm(gb){try{return this.Cse.Oim(gb,this.uok)}catch(Mb){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("GetPredictionsWithTokenAttributes",
"Exception: "+Mb)}return new Xh([],[])}S5d(gb){const Mb=[];if(gb)for(const hc of gb)Mb.push(new oi.a(hc,-99999));return Mb}bmm(gb){const Mb=[];if(gb)for(const hc of gb)Mb.push(new oi.a(hc.prediction,hc.score));return Mb}}Object(m.a)(ag,"CommandResultsProvider",null,[1003]);var Cg=d(1841);class Sg{constructor(gb){this.kc=gb}sN(){return"Feedback"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:2}hK(gb,Mb,hc,Kc,Vc=null){gb=new v.a(gb);if(!Vc||Array.contains(Vc,21))Vc=[],Vc.push(appChrome.actions.setControlLabel("TellMeFeedback",
CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Vc),Vc=new y.a(22),Vc.displayName="",Vc.hy(new w.a("TellMeFeedback",23,null,null,1)),gb.aw(Vc);Mb.Ot(gb)}}Object(m.a)(Sg,"FeedbackResultsProvider",null,[1003]);class ui{constructor(gb,Mb,hc,Kc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=gb;this.CommandId=Mb;this.CommandValueId=hc;this.InputText=Kc}}Object(m.a)(ui,"FindInDocumentProp",null,[]);var ck=d(19);class Zf{constructor(gb){this.K0e=2;this.TFb=[];
this.Njb=[];this.kc=gb;Zf.mKa=gb.MDf;Zf.Koi="FindInDocumentSuggestion";Zf.htj="FindInDocumentSuggestion3";this.J_e=Object.assign(new z.a,{landingTab:"Indoc",data:null});this.aNk=this.kc.Jyb||!!Ah.AFrameworkApplication.ua&&Ah.AFrameworkApplication.ua.Ib.Jyb}sN(){return"FindInDocument"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:3===this.kc.hw?this.kc.aWj?2:3:2}hK(gb,Mb,hc=!1,Kc,Vc=null){const od=new v.a(gb);if(Vc&&!Array.contains(Vc,2))Mb.Ot(od);else if(Array.clear(this.TFb),x.a.EU(gb)){if(hc&&this.rTj()){hc=
new y.a(2);hc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Vc=1;Kc="";if(0<this.Njb.length&&!this.kc.Nxc)for(var Od of this.Njb)if(""!==Od.Label.toLowerCase()){if(Vc>=this.K0e)break;this.V8j(hc,Od.Label,Od.CommandValueId,Zf.Koi+Vc,Od.InputText);Vc++}Od="";this.kc.uS?(od.aw(hc),hc=new y.a(3),Od=this.kc.vmb?x.a.tqb(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):Od=CommonUIStrings.l_TellMeOpenFindPaneText;Kc=this.Nvi("");this.V8j(hc,Od,Kc,
Zf.htj,"");od.aw(hc)}Mb.Ot(od)}else Od="",hc&&(hc=this.Nvi(gb.Yg),Kc=[],this.kc.Pab?(this.kc.Dze&&Kc.push(appChrome.actions.setControlIconSet(Zf.mKa,{"default":"FindInDocument_20"})),Od=this.kc.h1f?x.a.pKf(gb.Yg,CommonUIStrings.l_FindInDocumentScopedButtonText):gb.Yg+CommonUIStrings.l_FindInDocumentScopedButtonText):this.kc.uS?(Od=this.kc.vmb?x.a.tqb(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,gb.Yg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,gb.Yg),
Kc.push(appChrome.actions.setControlIconSet(Zf.mKa,{"default":"FindInDocument_20"}))):Od=this.kc.Nxc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,gb.Yg),this.kc.KBa?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Zf.mKa,Od)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Zf.mKa,hc))):(Kc.push(appChrome.actions.setControlLabel(Zf.mKa,Od)),Kc.push(appChrome.actions.setButtonCommandValueId(Zf.mKa,hc)),
appChrome.api.dispatch(Kc)),this.OOj(Od,Zf.mKa,hc,gb.Yg)),this.kc.aWj?(Od=new w.a(Zf.mKa,8,gb.Yg),hc=new y.a(2),hc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,hc.hy(Od),od.aw(hc),Mb.Ot(od)):this.kc.R6d(gb.Yg).then(Ld=>{const Af=new w.a(Zf.mKa,8,gb.Yg,null,1);Af.count=Ld;Ld=new y.a(2);Ld.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Ld.hy(Af);od.aw(Ld);Mb.Ot(od)},Ld=>{u.TellMeActor.instance.Ye.onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+
Ld);Ld=new w.a(Zf.mKa,8,gb.Yg,null,1);const Af=new y.a(2);Af.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Af.hy(Ld);od.aw(Af);Mb.Ot(od)})}rTj(){return!!this.kc&&this.kc.vze}V8j(gb,Mb,hc,Kc,Vc=null){const od=[];Mb&&od.push(appChrome.actions.setControlLabel(Kc,Mb));this.kc.uS&&od.push(appChrome.actions.setControlIconSet(Kc,{"default":"FindInDocument_20"}));od.push(appChrome.actions.setButtonCommandValueId(Kc,hc));appChrome.api.dispatch(od);this.OOj(Mb,Kc,hc,"");gb.hy(new w.a(Kc,8,Vc,null,
1,-99999))}Nvi(gb){return this.aNk?x.a.OUa(gb,15,this.J_e):ck.a.Hf(gb)}OOj(gb,Mb,hc,Kc){this.rTj()&&this.TFb.length<this.K0e&&(gb=new ui(gb,Mb,hc,Kc),Array.add(this.TFb,gb))}vVo(gb){for(let Mb=0;Mb<this.TFb.length;Mb++)if(this.TFb[Mb].CommandId===gb){const hc=this.TFb[Mb].Label;let Kc=!1;if(0<this.Njb.length){let Vc=0;for(const od of this.Njb){if(od.Label===hc){Array.removeAt(this.Njb,Vc);Kc=!0;break}Vc++}}!Kc&&this.Njb.length>=this.K0e-1&&Array.removeAt(this.Njb,1);Array.insert(this.Njb,0,this.TFb[Mb])}}}
Zf.mKa=null;Zf.Koi=null;Zf.htj=null;Object(m.a)(Zf,"FindInDocumentResultsProvider",null,[1003]);var ij=d(1839);class mj{constructor(gb){this.kc=gb}sN(){return"Insights"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:2}hK(gb,Mb,hc=!1,Kc,Vc=null){Kc=new v.a(gb);if(!Vc||Array.contains(Vc,13))if(this.X3o()||!x.a.EU(gb)){Vc=new y.a(13);var od=""===gb.Yg.trim(),Od=od?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",Ld=new w.a(Od,10,gb.Yg,null,1);hc&&(hc=null,x.a.Vta()?od?od=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:
(od=this.kc.Nxc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,gb.Yg),hc=x.a.OUa(gb.Yg,1)):(od=String.format(CommonUIStrings.l_InsightsButtonText,gb.Yg),hc=x.a.JMb(gb.Yg)),this.kc.KBa?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Od,od)),hc&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",hc))):(gb=[],gb.push(appChrome.actions.setControlLabel(Od,od)),
hc&&gb.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",hc)),appChrome.api.dispatch(gb)),Ld.label=od);Vc.hy(Ld);Kc.aw(Vc)}Mb.Ot(Kc)}X3o(){return x.a.Vta()&&this.kc.bip&&!this.kc.Hka}}Object(m.a)(mj,"InsightsResultsProvider",null,[1003]);var Jl=d(1837);class Xi{constructor(gb){this.kc=gb}sN(){return"Learning"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:2}hK(gb,Mb,hc,Kc,Vc=null){hc=new v.a(gb);Vc&&!Array.contains(Vc,21)||!x.a.EU(gb)||(Vc=[],Kc=this.kc.jyn,Vc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",
Kc)),Kc=Xi.Etm(Kc),Vc.push(appChrome.actions.setControlLabel("LearningForSearch",Kc)),appChrome.api.dispatch(Vc),gb=new w.a("LearningForSearch",22,gb.Yg,null,1),Vc=new y.a(21),Vc.hy(gb),hc.aw(Vc));Mb.Ot(hc)}static Etm(gb){const Mb=[];Array.add(Mb,new Jl.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Mb,new Jl.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(Mb,new Jl.a(600,gb));Array.add(Mb,new Jl.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));gb={};gb.parts=
Mb;return JSON.stringify(gb)}}Object(m.a)(Xi,"LearningProvider",null,[1003]);var Sh=d(652);class Vk{constructor(gb,Mb){this.F8b=this.Dbc=this.okb=this.tHd=null;this.Ny=!1;this.r9b=gb;this.Jsk=Mb;gb&&this.Umi(gb)}hEe(){this.r9b.hEe()&&this.Umi(this.r9b)}getSuggestions(gb){let Mb=[];var hc=[];gb=Vk.kRn(gb);var Kc="";Array.clear(hc);for(let Vc=0;Vc<gb.length;Vc++){const od=gb.charAt(Vc);-1!==" ".indexOf(od)?(Kc.length&&Array.add(hc,Kc),Kc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(od)?(Kc.length&&
Array.add(hc,Kc),Kc=od,Array.add(hc,Kc),Kc=""):Kc+=od}Kc.length&&Array.add(hc,Kc);for(gb=0;gb<hc.length;gb++)Kc=this.amm(hc[gb]),Kc=this.ABl(Kc),Mb=Vk.gLn(Mb,Kc);return Mb=this.zYk(Mb)}o_f(){this.Ny||this.hEe();return this.Ny}UZd(gb){return this.tHd[gb.toString()]}zYk(gb){for(let Mb=0;Mb<gb.length;Mb++){const hc=this.okb[Mb];if(gb[Mb].commandId!==this.UZd(hc[0]))throw Error.create("Incorrect Tcid orders with Priors data");let Kc;(Kc=gb[Mb]).score=Kc.score+hc[1]}return gb}ABl(gb){const Mb=[];for(var hc=
0;hc<this.okb.length;hc++)Mb.push(new oi.a(this.UZd(this.okb[hc][0]),-5));hc=new Sh.a;for(var Kc=0;Kc<gb.length;Kc++)hc.add(this.UZd(gb[Kc][0]));for(Kc=0;Kc<Mb.length;Kc++){const od=Mb[Kc];for(let Od=0;Od<gb.length;Od++){var Vc=gb[Od];const Ld=this.UZd(Vc[0]);Vc=Vc[1];if(Ld===od.commandId){od.score=Vc;hc.remove(Ld);break}}if(!hc.count)break}return Mb}amm(gb){const Mb=1>gb.length;for(let Od=0;2>=Od;Od++){const Ld=this.F8b;for(const Af in Ld){var hc=Ld[Af],Kc=gb,Vc=Af;const Tb=Vc.length+1,Dg=Array((Kc.length+
1)*Tb);for(var od=0;od<=Kc.length;od++)Dg[od*Tb]=od;for(od=0;od<=Vc.length;od++)Dg[od]=od;for(od=0;od<Vc.length;od++)for(let Kh=0;Kh<Kc.length;Kh++)Dg[(Kh+1)*Tb+(od+1)]=Kc.charAt(Kh)===Vc.charAt(od)?Dg[Kh*Tb+od]:Math.min(Math.min(Dg[Kh*Tb+(od+1)]+1,Dg[(Kh+1)*Tb+od]+1),Dg[Kh*Tb+od]+1);Kc=Dg[Kc.length*Tb+Vc.length];if((!Kc||!Mb)&&Kc<=Od)return hc}}return this.Dbc}Umi(gb){this.tHd=gb.VLf();this.okb=gb.IGm();this.Dbc=gb.IPm();this.F8b=gb.kxm();if(this.Ny=!!this.tHd&&!!this.okb&&!!this.F8b&&!!this.Dbc)this.Ny=
0<this.okb.length&&Vk.AXf(this.okb);this.Ny&&(this.Ny=0<this.Dbc.length&&Vk.AXf(this.Dbc));this.Ny&&(this.F8b=Vk.xQm(this.F8b));this.Ny||(this.F8b=this.Dbc=this.okb=this.tHd=null)}POm(gb){gb=this.getSuggestions(gb);return this.J7l(gb,this.Jsk)}J7l(gb,Mb){let hc=[];for(let Kc=0;Kc<gb.length;Kc++)gb[Kc].score>=Mb&&hc.push(gb[Kc]);hc.sort((Kc,Vc)=>Kc.score<Vc.score?1:Kc.score>Vc.score?-1:0);0<hc.length-10&&(hc=hc.slice(0,10));return hc}static gLn(gb,Mb){if(!gb.length)return Mb;if(gb.length!==Mb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");
for(let hc=0;hc<gb.length;hc++){if(gb[hc].commandId!==Mb[hc].commandId)throw Error.create("Incorrect CommandId");let Kc;(Kc=gb[hc]).score=Kc.score+Mb[hc].score}return gb}static kRn(gb){return ck.a.xh(gb)}static AXf(gb){for(let Mb=0;Mb<gb.length;Mb++)if(2!==gb[Mb].length)return!1;return!0}static xQm(gb){const Mb={};for(const Vc in gb){var hc=Vc,Kc=gb[Vc];const od=Kc;od.length&&Vk.AXf(od)&&(Mb[hc]=Kc)}return Mb}}Object(m.a)(Vk,"NaiveBayesClassifierModel",null,[]);class nj{constructor(gb,Mb){this.Ewa=
null;this.kc=gb;this.PLc=new Vk(Mb,gb.HAm);this.kc.uKb&&(this.Ewa=null)}sN(){return"NBCommand"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:2}hK(gb,Mb,hc=!1,Kc=f.a.su,Vc=null){const od=new v.a(gb);if((!Vc||Array.contains(Vc,0))&&!x.a.EU(gb)){if(Vg.CommandResultsUtility.SXf(gb.Yg)&&(Vc=Vg.CommandResultsUtility.Ovi(gb.Yg),0<Vc.results.length)){Vc.displayName="Classifier Debug";od.aw(Vc);Mb.Ot(od);return}if(!this.PLc.o_f()){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");
throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.kc.uKb&&this.Ewa&&this.Ewa.initialize();Vc=this.PLc.POm(gb.Yg);Vg.CommandResultsUtility.Fie(Vc,!1,"Classifier","NaiveBayesian");Vc=Vg.CommandResultsUtility.z4c(gb,Vc,this.kc,this.Ewa,null,null,0,1);0<Vc.results.length&&Kc!==f.a.contextMenu&&(Vc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);hc||Vc.results.length||this.kc.v3||this.kc.Feb||(gb=new w.a("lookupNoResults",14,gb.Yg,null,1),Vc.hy(gb));0<Vc.results.length&&
od.aw(Vc)}Mb.Ot(od)}}Object(m.a)(nj,"NaiveBayesCommandProvider",null,[1003]);class dk{constructor(){this.QFb=null;this.Ny=!1;this.hEe()}hEe(){this.Ny||(this.QFb=window.NBCRM)&&4===this.QFb.length&&(this.Ny=!0);return this.Ny}IGm(){return this.Ny?this.QFb[1]:null}IPm(){return this.Ny?this.QFb[2]:null}kxm(){return this.Ny?this.QFb[3][0]:null}VLf(){return this.Ny?this.QFb[0][0]:null}}Object(m.a)(dk,"NaiveBayesModelAdapter",null,[1612]);var mm=d(139);class Ai{constructor(gb){this.kc=gb}sN(){return"OfficeScript"}kX(){return 0===
this.kc.hw?0:1===this.kc.hw?1:2}hK(gb,Mb){const hc=new v.a(gb);if(!x.a.EU(gb)){gb=mm.d(gb.Yg);var Kc=new y.a(28);Kc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Kc=this.FOh(gb,Ai.Jrp,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Kc);Kc=this.FOh(gb,Ai.Mdm,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Kc);hc.aw(Kc)}Mb.Ot(hc)}FOh(gb,Mb,hc,Kc,Vc,od){const Od=[];for(const Ld of Mb)if(mm.a(gb,Ld)){this.kc.KBa?
(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(hc,Vc)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(hc,Kc))):(Od.push(appChrome.actions.setControlLabel(hc,Vc)),Od.push(appChrome.actions.setButtonCommandValueId(hc,Kc)),appChrome.api.dispatch(Od));od.hy(new w.a(hc,28,null,null,1));break}return od}}Ai.Jrp="unhide row rows col cols column columns".split(" ");Ai.Mdm=["freeze","selection","pane","panes"];Object(m.a)(Ai,"OfficeScriptsSamplesProvider",
null,[1003]);var nm=d(77),rm=d(372),qi=d(1640),Yi=d(1601),Zl=d(1639),Qi=d(34),Oh=d(123),hb=d(29);class wc{constructor(gb){this.nT=null;this.A5=-1;this.G8f=14;this.I8f=12;this.attributes=this.acf=this.query=null;this.Zoc=!1;this.G$b=[];this.Af=Ah.AFrameworkApplication.Be;Ah.AFrameworkApplication.K&&(this.G8f=Ah.AFrameworkApplication.K.ic("TellMeMaxTermedResults",this.G8f),this.I8f=Ah.AFrameworkApplication.K.ic("TellMeMaxZeroTermResults",this.I8f));this.TU=gb}get $o(){return this.G$b}get LEe(){return this.acf}aw(gb){let Mb=
!1;for(let hc=0;hc<this.$o.length;hc++)if(30!==this.$o[hc].groupType&&this.$o[hc].groupType===gb.groupType){this.Dff(this.$o[hc],gb);Mb=!0;break}Mb||this.$o.push(gb)}Dff(gb,Mb){for(let hc=0;hc<Mb.results.length;hc++)gb.hy(Mb.results[hc])}YCj(gb){const Mb=[];for(const hc of this.$o)hc.groupType!==gb&&Mb.push(hc);this.$o.length!==Mb.length&&(this.G$b=Mb)}Myo(gb){let Mb=null,hc=null,Kc=null;for(let Vc=0;Vc<gb.length;Vc++){const od=gb[Vc];if(od&&od.$o&&od.$o.length)for(const Od of od.$o)if(17===Od.groupType||
18===Od.groupType)Mb=Od;else if(0===Od.groupType||16===Od.groupType)hc=Od,Kc=od}Mb&&hc&&0<hc.results.length&&(17===Mb.groupType&&({Wef:hc,Tff:Mb}=Vg.CommandResultsUtility.YWk(hc,Mb,this.TU.yR()?this.TU.yR().vlm:-.6)),Kc.YCj(hc.groupType))}q$o(){this.TU&&(new nm.a,this.nqd(this.TU.Xbj))}cad(gb,Mb){return this.query.Yg.length>this.TU.yR().qHm&&this.Oon(gb,Mb)||this.query.Yg.length>this.TU.yR().rHm&&this.Nrn(gb,Mb)?!0:!1}Nrn(gb,Mb){return gb&&gb.length&&Mb&&Mb.length?-1===Mb.toLowerCase().indexOf(gb.toLowerCase())?
!1:!0:!1}Oon(gb,Mb){return gb&&gb.length&&Mb&&Mb.length?Mb.toLowerCase().startsWith(gb.toLowerCase()):!1}U7l(gb){const Mb=[];for(const hc of this.TU.yR().uS?this.LEe:this.$o)gb.contains(hc.groupType)||Mb.push(hc);this.TU.yR().uS?this.acf=Mb:this.G$b=Mb}ezp(gb,Mb){const hc=[];for(const Kc of this.$o){const Vc=Kc;if(13!==Vc.groupType||24!==Vc.groupType){const od=gb[Yi.a[Vc.groupType].toLowerCase()];let Od="False";od<Mb&&(Od="True");Vc.displayName=Vc.displayName+" ("+Od+": "+od+")"}hc.push(Vc)}this.G$b=
hc}nqd(gb,Mb=!1,hc=null){if(this.TU.yR().uS){if(!Mb)for(this.acf=Array(this.$o.length),Mb=0;Mb<this.$o.length;Mb++)this.LEe[Mb]=this.$o[Mb];this.TU.ccj.nqd(this.$o,this.LEe,this.query,gb,hc)}else{for(hc=new nm.a;this.$o.length;){Mb=this.$o.pop();const Kc=Yi.a[Mb.groupType].toLowerCase(),Vc=gb[Kc];if(hb.c(Vc))throw Error.create("GroupId "+Kc+" missed from group SortingOrder");hc.add(new rm.a(Vc,Mb))}hc.Sc((Kc,Vc)=>Kc.key<Vc.key?-1:1);for(gb=0;gb<hc.count;gb++)Mb=hc.J(gb).value,this.$o.push(Mb)}}r$o(){var gb=
!1;let Mb=!1,hc=!1;for(let Vc=0;Vc<this.$o.length;Vc++){var Kc=this.$o[Vc];const od=Kc.groupType;if(8===od||15===od||14===od){Kc=Kc.results;for(let Od=0;Od<Kc.length;Od++){if(8===od&&this.cad(this.query.Yg,Kc[Od].label)){gb=!0;break}if(15===od&&this.cad(this.query.Yg,Kc[Od].label)){Mb=!0;break}if(14===od){if(this.cad(this.query.Yg,Kc[Od].label)||this.cad(this.query.Yg,Kc[Od].description)){hc=!0;break}const Ld=Kc[Od].label.split(" ");for(const Af of Ld)if(this.cad(this.query.Yg,Af)){hc=!0;break}}}}}gb=
this.TU.eJm(gb,Mb,hc);this.nqd(gb)}SWb(gb,Mb,hc,Kc,Vc,od){if(Vc===this.nT){var Od=gb.data.De;Vc=null;try{Vc=Qi.b(Od)}catch(Fe){u.TellMeActor.instance.Ye.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Fe);return}if("RankerResults"in Vc&&Vc.RankerResults){this.VIa();var Ld=Vc.RankerResults,Af=new nm.a,Tb=new nm.a;Od=0;for(var Dg of Ld){Ld=Dg.ProviderId;var Kh=Dg.Score;Od+=Kh;Af.add(new rm.a(Ld,Kh))}Af.Sc((vh,te)=>vh.value>te.value?-1:1);Kh=od?od.jHi:1E-6;
Dg={};Ld={};let Fe=0;for(var rg=0;rg<Af.count;rg++){const vh=parseInt(Af.J(rg).key),te=Af.J(rg).value/Od;1===vh&&(Ld.answer=Fe++,Ld.entity=Fe++,Ld.definition=Fe++,Ld.wolframanswer=Fe++,te<Kh&&(Tb.add(9),Tb.add(11),Tb.add(10),Tb.add(12)),Dg.answer=te,Dg.entity=te,Dg.definition=te,Dg.wolframanswer=te);2===vh&&(Ld.assistance=Fe++,te<Kh&&Tb.add(8),Dg.assistance=te);3===vh&&(Ld.classifier=Fe++,Ld.serviceclassifier=Fe++,te<Kh&&(Tb.add(0),Tb.add(17)),Dg.classifier=te,Dg.serviceclassifier=te);4===vh&&(Ld.people=
Fe++,te<Kh&&Tb.add(14),Dg.people=te);5===vh&&(Ld.document=Fe++,te<Kh&&Tb.add(15),Dg.document=te);6===vh&&(Ld.findindocument=Fe++,te<Kh&&Tb.add(2),Dg.findindocument=te);7===vh&&(Ld.notes=Fe++,te<Kh&&Tb.add(20),Dg.notes=te);8===vh&&(Ld.image=Fe++,te<Kh&&Tb.add(19),Dg.image=te)}Af=new nm.a;Af.add("classifier");Af.add("serviceclassifier");Af.add("appsforoffice");Af.add("addin");Af.add("findindocument");Af.add("assistance");Af.add("document");Af.add("people");Af.add("answer");Af.add("wolframanswer");Af.add("definition");
Af.add("entity");Af.add("image");Af.add("template");Af.add("officescript");for(rg=0;rg<Af.count;rg++)Af.J(rg)in Ld||(Ld[Af.J(rg)]=Fe++);Ld.learning=Fe++;Ld.insights=Fe++;Ld.actionai=Fe++;Ld.actionaicommand=Fe++;Ld.feedback=Fe++;od&&od.H_i&&this.ezp(Dg,Kh);od&&od.I_i&&this.U7l(Tb);Tb={};for(var ai in Dg)Tb[ai]=Dg[ai]*Od;this.nqd(Ld,!0,Tb)}if(od.jge&&"Intents"in Vc&&Vc.Intents){ai=Vc.Intents;for(var kl of ai)if(this.T1f(kl)&&"Serplet"===kl.GroupType&&kl.ConfidenceScore>kl.ConfidenceThreshold){ai=!1;
Vc=0;if(od.kge){Od=new w.a("",32);for(Tb=0;Tb<this.$o.length;Tb++)if((Af=this.$o[Tb].results)&&0<Af.length){Vc=Tb;Od=Af[0];break}2===Od.groupType&&(ai=!0)}Od=new y.a(13);ai&&od.kge&&(Od=new y.a(13,CommonUIStrings.l_TellMeWebTitle));Tb=new w.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Yg,null,0);Af=[];Dg=null;Dg=x.a.Vta()?x.a.OUa(this.query.Yg,1):x.a.JMb(this.query.Yg);Af.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Dg));Dg=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,
this.query.Yg);Af.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Dg));appChrome.api.dispatch(Af);Od.hy(Tb);Tb=[];if(ai&&od.kge)for(Tb.push(this.$o[Vc]),Tb.push(Od),ai=Vc+1;ai<this.$o.length;ai++)(Vc=this.$o[ai].results)&&0<Vc.length&&Tb.push(this.$o[ai]);else for(Tb.push(Od),ai=0;ai<this.$o.length;ai++)(Vc=this.$o[ai].results)&&0<Vc.length&&Tb.push(this.$o[ai]);this.G$b=Tb}}if(od.nad&&!od.uS){kl=ai=-1;for(Vc=0;Vc<this.$o.length;Vc++)switch(this.$o[Vc].groupType){case 23:ai=
Vc;break;case 0:case 17:case 2:-1===kl&&(kl=Vc)}if(-1!==ai){kl=-1===kl?0:ai>kl?kl+1:kl;ai=this.$o[ai];Vc=Array(this.$o.length);Od=0;for(Tb=0;Tb<Vc.length;Tb++)Tb===kl?Vc[Tb]=ai:(23===this.$o[Od].groupType&&Od++,Vc[Tb]=this.$o[Od],Od++);this.G$b=Vc}}Kc.Ot(this);Kc=u.TellMeActor.instance.Ye;Kc.aca(Mb.length,"RankerInference",gb.data.He.toString(),Math.round(window.performance.now()-hc),Zl.a.X_j,!0,qi.a.OWa);this.Zoc&&Kc&&(gb=this.query.Swb,Mb=Kc.xzd,od.Dge&&gb>Mb&&!od.uS&&(Kc.N6f(this.query.Yg),Kc.tzg(gb)))}}T1f(gb){if("GroupType"in
gb&&gb.GroupType&&"ConfidenceScore"in gb&&"ConfidenceThreshold"in gb)return!0;u.TellMeActor.instance.Ye.onError("IsValidIntentGroup","Invalid intents found");return!1}zWb(gb,Mb,hc,Kc,Vc){Kc===this.nT&&(this.VIa(),u.TellMeActor.instance.Ye.aca(Mb.length,"RankerInference",gb.data.He.toString(),Math.round(window.performance.now()-hc),Zl.a.X_j,!1,qi.a.OWa));Vc.Ot(this)}VIa(){-1!==this.A5&&(window.clearTimeout(this.A5),this.A5=-1)}s$o(gb){let Mb;Mb=this.TU.yR().uS?u.TellMeActor.instance.Ye.BOf(this.LEe,
this.query.Yg):u.TellMeActor.instance.Ye.BOf(this.$o,this.query.Yg);var hc=this.TU.yR().iHi;""!==hc&&(hc="_"+hc);let Kc="";this.TU.yR().nfe&&(Kc="RankerInference"+hc+",");this.TU.yR().jge&&(Kc+="SerpletClassifier");","===Kc.charAt(Kc.length-1)&&(Kc=Kc.substring(0,Kc.length-1));hc=u.TellMeActor.instance.Ye.YIi(Kc);const Vc=this.nT=Oh.a.create().toString();hc["Client-Request-Id"]=Vc;const od=window.performance.now(),Od=this.TU.yR()?this.TU.yR().kHi:600;this.VIa();this.A5=window.setTimeout(()=>{if(Vc===
this.nT){this.nT="";this.A5=-1;gb.Ot(this);const Ld={};Ld[a.a.provider]="Ranker";Ld[a.a.rYb]=this.query.Swb;u.TellMeActor.instance.Ye.gC(l.a.XIg,Od,Ld)}},Od);this.Af.Ij(u.TellMeActor.instance.Ye.ZIi(),2,Mb,hc,!1,0,Ld=>{this.SWb(Ld,this.query.Yg,od,gb,Vc,this.TU.yR())},Ld=>{this.zWb(Ld,this.query.Yg,od,Vc,gb)},null,null,!1,4E3,6E3)}Rnp(){var gb=0,Mb=new nm.a,hc=this.TU.Vbj,Kc=this.TU.Wbj;for(var Vc=0;Vc<this.$o.length;Vc++){var od=this.$o[Vc],Od=Yi.a[od.groupType].toLowerCase(),Ld=hc[Od];gb+=od.results.length;
od.results.length>Ld&&(Od=Kc[Od],hb.c(Od)||Mb.add(new rm.a(Od,od)))}Kc=!this.query||""===this.query.Yg.trim();Vc=gb-(Kc?this.I8f:this.G8f);if(!(0>=Vc)){Kc=window.performance.now();gb=gb.toString()+" total,"+Vc.toString()+" to remove.";if(0<Mb.count)for(Mb.Sc((Af,Tb)=>Af.key>Tb.key?-1:1),od=0;od<Mb.count&&0<Vc;od++){Od=Mb.J(od).value;Ld=Yi.a[Od.groupType].toLowerCase();let Af=Od.results.length-hc[Ld];Af>Vc&&(Af=Vc);0<Af&&(Od.Gsg(Af),gb+=Ld+": "+Af.toString()+" results removed.",Vc-=Af)}if(0<Vc){gb+=
Vc.toString()+" results left after trimming.";Mb=new nm.a;hc=this.TU.$bj;for(od=0;od<this.$o.length;od++)Od=this.$o[od],Ld=hc[Yi.a[Od.groupType].toLowerCase()],hb.c(Ld)||Mb.add(new rm.a(Ld,Od));Mb.Sc((Af,Tb)=>Af.key<Tb.key?-1:1);for(hc=0;0<Vc;)od=Mb.J(hc++).value,Vc>=od.results.length?(Array.remove(this.$o,od),gb+=Yi.a[od.groupType]+": "+od.results.length.toString()+" results force removed.",Vc-=od.results.length):(od.Gsg(Vc),gb+=Yi.a[od.groupType]+": "+Vc.toString()+" results force removed.",Vc=
0)}u.TellMeActor.instance.Ye&&(Mb={},Mb[a.a.message]=gb,u.TellMeActor.instance.Ye.gC("ShowOptimal",window.performance.now()-Kc,Mb))}}}Object(m.a)(wc,"CombineResultsUpdatedEventArgs",null,[1572]);class cd{constructor(gb,Mb,hc,Kc=!1,Vc=""){this.p4e=this.c7e=!1;this.tw=gb;this.FHb=[];this.WAh=Mb.length;this.kc=u.TellMeActor.instance.yR();this.AFd=Kc;this.rja=Vc;this.Yac={};for(gb=0;gb<Mb.length;++gb)this.Yac[gb.toString()]=hc?0:Mb[gb].kX()}tXo(gb,Mb){Mb&&Mb.query&&Mb.query.Swb<u.TellMeActor.instance.mya||
(this.FHb[gb]=Mb,this.p4e?this.c7e=!0:(!this.kc||3!==this.kc.hw||3!==this.Yac[gb.toString()]||this.ngi())&&this.BSb())}F$n(){this.p4e=!0}bsp(){this.p4e=!1;this.c7e&&(this.c7e=!1,this.BSb())}ngi(){if(this.FHb.length<this.WAh)return!1;for(let gb=0;gb<this.WAh;++gb)if(!this.FHb[gb])return!1;return!0}BSb(){var gb=this.ngi();const Mb=window.performance.now(),hc=new wc(u.TellMeActor.instance.ukh);hc.Myo(this.FHb);for(var Kc=0;Kc<this.FHb.length;++Kc){var Vc=this.FHb[Kc];if(Vc&&Vc.$o&&Vc.$o.length&&(hc.query=
Vc.query,Vc.attributes&&0<Vc.attributes.length&&(hc.attributes=Vc.attributes),Vc&&Vc.$o&&(gb||this.Lpl(Kc,this.FHb))))for(const od of Vc.$o)hc.aw(od)}hc.$o&&hc.$o.length&&(hc.Zoc=gb,this.kc&&this.kc.UDe&&hc.Rnp(),this.kc&&this.kc.fqn&&hc.query.Yg&&0<hc.query.Yg.length?hc.r$o():hc.q$o(),this.kc&&(this.kc.nfe||this.kc.jge)&&this.AFd&&hc.query.Yg&&0<hc.query.Yg.length&&hc.Zoc&&this.rja!==f.a.contextMenu?(3===this.kc.hw&&gb||this.tw.Ot(hc),hc.s$o(this.tw)):this.tw.Ot(hc),gb=u.TellMeActor.instance.Ye,
hc.Zoc&&gb&&(Kc=hc.query.Swb,Vc=gb.xzd,hc.query.Yg&&0<hc.query.Yg.length&&this.AFd&&this.kc.Dge&&this.rja!==f.a.contextMenu&&Kc>Vc&&!this.kc.nfe&&!this.kc.uS&&(gb.N6f(hc.query.Yg),gb.tzg(Kc)),gb.gC(l.a.oHo,window.performance.now()-Mb)))}Lpl(gb,Mb){if(!(this.Yac&&gb.toString()in this.Yac)||Mb.length<=gb||!Mb[gb])return!1;if(!Mb[gb].$o.length)return!0;const hc=this.Yac[gb.toString()];if(0===hc)return!0;const Kc=this.Yac;for(const od in Kc){var Vc=Kc[od];const Od=Number.parseInvariant(od);if(Od!==gb&&
Vc===hc&&!(Mb.length>Od&&Mb[Od]))return!1}return!0}}Object(m.a)(cd,"ResultsAggregator",null,[]);var Rd=d(1880);class cf{constructor(){this.Yzc=this.Zzc=this.Xzc=this.icd=this.hrc=this.rnc=0}FWk(gb,Mb){switch(gb){case 1:this.rnc=Mb;break;case 3:this.hrc=Mb;break;case 2:this.icd=Mb;break;case 5:this.Xzc=Mb;break;case 4:this.Zzc=Mb;break;case 6:this.Yzc=Mb}}}Object(m.a)(cf,"CommandFeatures",null,[]);class Ge{constructor(gb){this.Khh=0;this.YGa=gb;this.Vqk={}}get modelId(){return this.YGa}get e6l(){return this.Khh}get YVc(){return this.Vqk}AVk(gb,
Mb,hc){0===Mb?this.Khh=hc:(this.YVc[gb]||(this.YVc[gb]=new cf),this.YVc[gb].FWk(Mb,hc))}}Object(m.a)(Ge,"CoefficientsModel",null,[]);const Wg=(gb,Mb)=>Math.pow(10,-Mb/(60*Math.LN10/Math.LN2*gb));class ge{constructor(gb,Mb){this.Jk=1;this.oBd=new cf;this.features.icd=1+Math.log(this.count)/Math.LN2;this.features.rnc=gb?1/gb:0;this.features.hrc=2/Math.pow(2,gb);this.features.Xzc=Wg(10,Mb);this.features.Zzc=Wg(2,Mb);this.features.Yzc=Wg(1,Mb)}get count(){return this.Jk}get features(){return this.oBd}hRi(){this.Jk=
this.count+1;this.features.icd=1+Math.log(this.count)/Math.LN2}Uyp(gb){const Mb=2/Math.pow(2,gb);this.features.rnc=Math.max(this.features.rnc,gb?1/gb:0);this.features.hrc=Math.max(this.features.hrc,Mb)}qAp(gb){const Mb=Wg(10,gb),hc=Wg(2,gb);gb=Wg(1,gb);this.features.Xzc=Math.max(this.features.Xzc,Mb);this.features.Zzc=Math.max(this.features.Zzc,hc);this.features.Yzc=Math.max(this.features.Yzc,gb)}}Object(m.a)(ge,"CommandModel",null,[]);class oj{constructor(gb){this.NEc=null;if(!gb&&u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("PredictionEngine",
"IModelAdapter can't be null");this.r9b=gb;this.sHd=this.H5f()}H5f(){const gb=this.r9b.cAm(),Mb=this.r9b.VLf();if(void 0===gb||null===gb||void 0===Mb||null===Mb)return!1;try{window.performance.now();this.NEc={};for(let hc=0;hc<gb.length;hc++){const Kc=gb[hc],Vc=Mb[Kc[0].toString()].trim(),od=Kc[1],Od=0!==od?Mb[Kc[2].toString()].trim():"",Ld=Kc[3];Vc in this.NEc||(this.NEc[Vc]=new Ge(Vc));this.NEc[Vc].AVk(Od,od,Ld)}}catch(hc){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("LoadModelData",
"Error Loading Suggestions Model: "+hc);return!1}return!0}Nem(){const gb=this.r9b.zwm(),Mb={};if(!gb)return Mb;let hc=1;for(let Kc=0;Kc<gb.length;Kc++){const Vc=gb[Kc];Vc.Id in Mb?(Mb[Vc.Id].hRi(),Mb[Vc.Id].Uyp(hc),Mb[Vc.Id].qAp(Vc.TimeElapsedSinceClick)):Mb[Vc.Id]=new ge(hc,Vc.TimeElapsedSinceClick);hc++}return Mb}o_f(){this.sHd||(this.sHd=this.H5f());return this.sHd}WFm(){let gb=[];if(!this.sHd){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("GetPredictedCommands","IModelAdapter returned no data");
return gb}const Mb=this.Nem(),hc=this.NEc;for(const Vc in hc){const od=hc[Vc],Od=od.modelId;let Ld=0;for(const Af in Mb){var Kc=Af;const Tb=Mb[Af].features;(Kc=Kc in od.YVc?od.YVc[Kc]:null)&&(Ld+=Tb.rnc*Kc.rnc+Tb.hrc*Kc.hrc+Tb.icd*Kc.icd+Tb.Xzc*Kc.Xzc+Tb.Zzc*Kc.Zzc+Tb.Yzc*Kc.Yzc)}Ld+=od.e6l;gb.push(new oi.a(Od,Ld))}gb.sort((Vc,od)=>Vc.score<od.score?1:Vc.score>od.score?-1:0);0<gb.length-10&&(gb=gb.slice(0,10));return gb}}Object(m.a)(oj,"PredictionEngine",null,[]);class uh{constructor(){this.eEh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}S5d(gb,Mb){return Mb&&"word"===Mb.application.toLowerCase()&&
gb in this.eEh?this.eEh[gb]:[]}}Object(m.a)(uh,"SuggestionResultsUtility",null,[]);class Pj{constructor(gb,Mb,hc){this.kc=Mb;this.PLc=new oj(gb);this.a6=hc;this.XGh=new uh}sN(){return"Suggestion"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:2}hK(gb,Mb,hc,Kc=f.a.su,Vc=null){hc=new v.a(gb);u.TellMeActor.instance.hud=!1;if((!Vc||Array.contains(Vc,16))&&x.a.EU(gb)){if(!this.PLc.o_f()){if(u.TellMeActor.instance.Ye)u.TellMeActor.instance.Ye.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.cge()&&0<this.XGh.S5d(u.TellMeActor.instance.EZd,this.kc).length){const Od=this.XGh.S5d(u.TellMeActor.instance.EZd,this.kc);Vc=[];for(var od of Od)this.kc.vze&&"Find"===od||Vc.push(new oi.a(od,0));u.TellMeActor.instance.hud=!0}else Vc=this.PLc.WFm();Vg.CommandResultsUtility.Fie(Vc,!0,"Recommended","LRE");od=[];for(const Od of Vc)this.a6&&this.a6.Hrf(Od.commandId)||od.push(Od);gb=Vg.CommandResultsUtility.z4c(gb,
od,this.kc,null,null,null,16,1);0<gb.results.length&&Kc!==f.a.contextMenu&&(gb.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<gb.results.length&&hc.aw(gb)}Mb.Ot(hc)}cge(){return!!this.kc&&(this.kc.cge||this.kc.Cun)}}Object(m.a)(Pj,"SuggestionResultsProvider",null,[1003]);class eh{zwm(){return u.TellMeActor.instance.MNe}cAm(){return window.TellMeSuggestionModel}VLf(){return window.CoefficientModelIdMap}}Object(m.a)(eh,"SuggestionsModelAdapter",null,[1611]);var xf=d(1888),gh=d(1840);d.d(J,"AggregatorResultsProvider",
function(){return Ue});class Ue{constructor(gb=!1){this.t$b={};this.t$b[f.a.su]=[];this.t$b[f.a.contextMenu]=[];this.AFd=gb}O4i(gb,Mb,hc,Kc,Vc=null){let od;var Od=!1;switch(Kc){case f.a.contextMenu:od=this.t$b[f.a.contextMenu];Od=!0;break;default:od=this.t$b[f.a.su]}Mb=new cd(Mb,od,Od,this.AFd,Kc);Mb.F$n();for(let Ld=0;Ld<od.length;++Ld){const Af=window.performance.now(),Tb=new F(Mb,Ld);(Od=u.TellMeActor.instance.yR())&&Od.Ael?window.setTimeout(()=>{od[Ld].hK(gb,Tb,hc,Kc,Vc);if(u.TellMeActor.instance.Ye){const Dg=
{};Dg[a.a.provider]=od[Ld].sN();Dg[a.a.rYb]=gb.Swb;u.TellMeActor.instance.Ye.gC(l.a.hK,window.performance.now()-Af,Dg)}},0):(od[Ld].hK(gb,Tb,hc,Kc,Vc),u.TellMeActor.instance.Ye&&(Od={},Od[a.a.provider]=od[Ld].sN(),Od[a.a.rYb]=gb.Swb,u.TellMeActor.instance.Ye.gC(l.a.hK,window.performance.now()-Af,Od)))}Mb.bsp()}sN(){return"Aggregator"}kX(){return 0}hK(gb,Mb,hc=!1,Kc=f.a.su,Vc=null){if(u.TellMeActor.instance.cNn)this.O4i(gb,Mb,hc,Kc,Vc);else{const od=window.performance.now();u.TellMeActor.instance.XEp.then(()=>
{u.TellMeActor.instance.Ye&&u.TellMeActor.instance.Ye.gC(l.a.dNn,window.performance.now()-od);this.O4i(gb,Mb,hc,Kc,Vc);return!0})}}DG(gb,Mb){this.t$b[Mb].push(gb)}xXk(gb){switch(gb){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Mb=this.t$b[f.a.su];for(const hc of Mb)if("FindInDocument"===hc.sN()){hc.vVo(gb);break}}}static createInstance(gb,Mb,hc,Kc){const Vc=Mb.Hka;var od=Kc&&x.a.iCg(Mb),Od=od&&Mb.eig&&!Vc;const Ld=Mb.A1f&&!x.a.vpc()&&!Vc,Af=Mb.F_f&&
!Vc,Tb=new Ue(od);if(Mb.Y3o&&!Vc){var Dg=new Xi(Mb);Tb.DG(Dg,f.a.su)}Dg=Mb.Hs?Ah.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):Ah.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const Kh=!Dg&&Ah.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");Tb.DG(new Cg.a(gb,Mb.Zpp,Kh,!1),f.a.su);Dg&&!Vc&&Tb.DG(new Pj(new eh,Mb,gb),f.a.su);gb=Ah.AFrameworkApplication.ua.Ib.p3i?new nj(Mb,new dk):new ag(Mb,hc);Tb.DG(gb,f.a.contextMenu);(od&&Mb.fig||Od)&&Tb.DG(xf.a.Abi(Mb,
!0),f.a.su);Tb.DG(gb,f.a.su);!Mb.Foi||Vc||"Word"===Mb.application&&Mb.w3d||Tb.DG(new Zf(Mb),f.a.su);Mb.uKb&&!Vc&&(Od=new I(Mb),Tb.DG(Od,f.a.su),Tb.DG(Od,f.a.contextMenu));!Mb.wKb||Mb.opd||Mb.npd||Vc||Tb.DG(new H.a(Mb),f.a.su);Kc&&(Mb.v3||x.a.Vta())&&(Od=new mj(Mb),Tb.DG(Od,f.a.su),Tb.DG(Od,f.a.contextMenu));od&&Tb.DG(xf.a.Abi(Mb,!1),f.a.su);Kc&&!Mb.vGg&&x.a.hCg(Mb)&&!Vc&&(Tb.DG(new Rd.a(Mb),f.a.su),Mb.gZj&&Tb.DG(new Rd.a(Mb),f.a.contextMenu));Ld&&Tb.DG(new Sg(Mb),f.a.su);!Mb.Rxc&&!Mb.uS||Vc||Tb.DG(new ij.a(Mb),
f.a.su);Mb.nad&&!Vc&&Tb.DG(new gh.a(Mb),f.a.su);Mb.qXf&&(od=new A(Mb),Tb.DG(od,f.a.su),Tb.DG(od,f.a.contextMenu));Kc&&Mb.lde&&!Vc&&Tb.DG(new D.AddinResultsProvider(Mb),f.a.su);Af&&"Excel"===Mb.application&&!Vc&&Tb.DG(new Ai(Mb),f.a.su);return Tb}}Object(m.a)(Ue,"AggregatorResultsProvider",null,[1003])},1876:function(G,J,d){G=d(0);var m=d(63),f=d(16),a=d(5),l=d(192),w=d(233),y=d(381);d(54);var v=d(84);d(1021);d(939);var u=d(582);d(505);var x=d(1829),z=d(1830),A=d(1826),D=d(1828),F=d(1827);d(1020);
d(938);class I{constructor(X,aa,ia){this.eem=X;this.Ibl=aa;this.Cnl=ia}}Object(G.a)(I,"BacktraceAndMakeUpdateHintsInput",null,[]);var H=d(1625),N;(function(X){X[X.tMp=0]="EOP";X[X.character=1]="character";X[X.UYp=2]="embeddedMarker"})(N||(N={}));Object(G.b)("LCSBlockType",N);class M{toString(){return String.format("[Type: {0}]",N[this.type])}}Object(G.a)(M,"ALCSBlock",null,[]);class U extends M{constructor(X,aa){super();this.TMe=aa;this.$3e=X}get type(){return 1}get character(){return this.TMe}get mZa(){return this.$3e}$B(X){return 1===
X.type&&H.a.pUh(X.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(G.a)(U,"CharacterLCSBlock",M,[]);class O extends M{constructor(X,aa,ia){super();this.$3e=X;this.wdf=aa;this.yJ=ia}get type(){return 0}get Yc(){return this.wdf}get length(){return this.yJ}get mZa(){return this.$3e}$B(X){return 0!==X.type?!1:X.mZa===this.mZa&&X.Yc===this.Yc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),
this.mZa.toString(),this.Yc,this.length)}}Object(G.a)(O,"EOPLCSBlock",M,[]);class V extends U{constructor(X,aa,ia){super(X,"\ufffc");this.mEk=aa;this.dCd=ia}get type(){return 2}get ve(){return this.mEk}get Dk(){return this.dCd}$B(X){return 2!==X.type?!1:X.ve===this.ve&&this.Dk.equals(X.Dk)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),this.ve,this.Dk)}}Object(G.a)(V,"EmbeddedMarkerLCSBlock",U,[]);class Y{constructor(X,aa){this.x=X;this.y=aa}equals(X){return X.x===
this.x&&X.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(G.a)(Y,"IntPair",null,[1071]);var Q=d(1666),S=d(1645),P=d(1668),T=d(1825);d.d(J,"a",function(){return Z});class Z{constructor(X,aa){this.vg=X;this.Zd=aa}Kbi(X,aa,ia,wa,ma,na,Fa){return this.YKl(X,aa,ia,wa,ma,na,Fa)}YKl(X,aa,ia,wa,ma,na,Fa){let Qa;Qa=null;({returnValue:X}=this.F7d(X,aa));if(!X)return l.a.instance.Ua(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.Zd.logger.NX("GetLCSBlocksFromObject"),{returnValue:!1,
AK:Qa};({returnValue:ia}=this.F7d(ia,wa));if(!ia)return l.a.instance.Ua(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.Zd.logger.NX("GetLCSBlocksFromObject"),{returnValue:!1,AK:Qa};this.Zd.logger.NX("GetLCSBlocksFromObject");Qa=this.XKl(X,ia,ma,na,Fa);return Qa?{returnValue:!0,AK:Qa}:(l.a.instance.Ua(575706451,1,2,"Failed to Create UpdateHints"),{returnValue:!1,AK:Qa})}uoi(X,aa,ia,wa){({returnValue:X}=this.F7d(X,aa));if(!X)return-1;({returnValue:ia}=this.F7d(ia,wa));if(!ia)return-1;
({Uvf:ia}=this.yoi(X,ia));return ia}F7d(X,aa){let ia;const wa=new w.a;ia=new w.a;if(!X.length)return l.a.instance.Ua(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.Zd.logger.Oi(Object.assign(new Q.a,{$j:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,OBf:ia};for(let Fa=0;Fa<X.length;Fa++)if(this.Zd.runtime.dJ("GetLCSBlocksFromObject: paraObjs#"+Fa),X.J(Fa).yc===m.a.paragraphNode){const Qa=this.vg.getPropertyString(X.J(Fa),f.a.Un),ya=this.vg.getPropertyUint32(X.J(Fa),
a.a.Yc);if(null==ya)return l.a.instance.Ua(594124835,1,2,"Abandoning LCS due to missing WordId"),this.Zd.logger.Oi(Object.assign(new Q.a,{$j:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,OBf:ia};let ta=this.vg.getPropertyUint32s(X.J(Fa),f.a.zn);ta=S.a.zPj(ta,Qa.length);const Aa=this.vg.getPropertyObjectIds(X.J(Fa),f.a.Vn);let oa;for(oa=0;oa<ta.length-1;oa++){var ma=aa(Aa.sg(oa)),na=void 0;na=ma?(na=this.vg.getPropertyBool(ma,f.a.ada))?na:!1:!1;if(na)wa.add(this.mFl(X.J(Fa).id,ma));
else for(ma=ta.sg(oa);ma<ta.sg(oa+1);ma++)wa.add(new U(X.J(Fa).id,H.a.charAt(Qa,ma)))}wa.add(new O(X.J(Fa).id,ya,ta.J(oa)));ia.add(wa.length-1)}else return l.a.instance.Ua(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",X.J(Fa).yc),this.Zd.logger.Oi(Object.assign(new Q.a,{$j:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,OBf:ia};this.Zd.runtime.dJ("LCS: GetLCSBlocks for base");return{returnValue:wa,OBf:ia}}mFl(X,aa){const ia=null==this.vg.getPropertyInt32(aa,
a.a.mt)?0:this.vg.getPropertyInt32(aa,a.a.mt);return new V(X,ia,aa.id)}XKl(X,aa,ia,wa,ma){wa=({Uvf:ia}=this.yoi(X,aa,ia,wa,ma)).returnValue;this.Zd.logger.NX("FindFurthestPaths");X=new I(wa,X,aa);X=new T.a(this.xbl(X,ia),1);this.Zd.logger.NX("BacktraceAndMakeUpdateHints");return X}yoi(X,aa,ia=-1,wa=-1,ma=-1){let na;if(-1===ia||-1===wa||-1===ma)ma=wa=ia=-1;na=-1;const Fa=new y.a;Fa.Z(new Y(-1,1),new Y(0,-1));if(-1!==ia){Fa.Z(new Y(0,0),new Y(ia,ia));var Qa=1}else Qa=0,wa=X.length,ma=aa.length;for(ia=
0;Qa<=X.length+aa.length;Qa++){let ya=!1;for(let ta=-Qa;ta<=Qa;ta+=2){let Aa,oa;ta===-Qa?(Aa=Fa.J(new Y(Qa-1,ta+1)).x,oa=Fa.J(new Y(Qa-1,ta+1)).y+1):ta===Qa?(Aa=Fa.J(new Y(Qa-1,ta-1)).x+1,oa=Fa.J(new Y(Qa-1,ta-1)).y):Fa.J(new Y(Qa-1,ta-1)).x>=Fa.J(new Y(Qa-1,ta+1)).x?(Aa=Fa.J(new Y(Qa-1,ta-1)).x+1,oa=Fa.J(new Y(Qa-1,ta-1)).y):(Aa=Fa.J(new Y(Qa-1,ta+1)).x,oa=Fa.J(new Y(Qa-1,ta+1)).y+1);for(;Aa<wa&&oa<ma&&X.J(Aa).$B(aa.J(oa));)Aa++,oa++;Fa.Z(new Y(Qa,ta),new Y(Aa,oa));if(Aa===wa&&oa===ma){ya=!0;na=
Qa;ia=ta;break}}if(ya)break;this.Zd.runtime.dJ("LCS FindFurthestPaths")}if(ia!==wa-ma)return{returnValue:null,Uvf:na};Fa.Z(new Y(na,ia),new Y(wa+1,ma+1));l.a.instance.Ua(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",X.length,aa.length,na);return{returnValue:Fa,Uvf:na}}xbl(X,aa){const ia=X.eem,wa=X.Ibl;X=X.Cnl;const ma=new w.a;let na=wa.length,Fa=X.length;for(;0<na||0<Fa;){var Qa=na-1,ya=Fa-1;if(this.E$n(ia,aa,na,Fa)){Qa=X.J(ya);if(1===Qa.type||
2===Qa.type)this.Ban(ma,na,Qa);else if(0===Qa.type)this.W$m(ma,na,Qa);else return l.a.instance.Ua(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",Qa.type),this.Zd.logger.Oi(Object.assign(new P.a,{$j:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Fa--;aa--}else if(this.D$n(ia,aa,na,Fa)){ya=wa.J(Qa);if(1===ya.type||2===ya.type)this.VQl(ma,Qa,ya);else if(0===ya.type)this.BQl(ma,Qa,ya);else return l.a.instance.Ua(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",
ya.type),this.Zd.logger.Oi(Object.assign(new P.a,{$j:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;na--;aa--}else if(na&&Fa&&wa.J(Qa).$B(X.J(ya)))na--,Fa--;else return l.a.instance.Ua(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.Zd.logger.Oi(Object.assign(new P.a,{$j:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.Zd.runtime.dJ("LCS: CreateUpdateHintsFromLCSBlocks");return ma}D$n(X,aa,ia,wa){aa=new Y(aa-1,ia-wa-1);return X.mb(aa)&&X.J(aa).x===ia-1&&
X.J(aa).y===wa}E$n(X,aa,ia,wa){aa=new Y(aa-1,ia-wa+1);return X.mb(aa)&&X.J(aa).x===ia&&X.J(aa).y===wa-1}W$m(X,aa,ia){ia=new A.a(ia.mZa,ia.Yc);let wa=!1;if(0<X.length&&11===X.sg(X.length-1).type){const ma=X.sg(X.length-1);ma.cp===aa&&(wa=!0,ma.s3.add(ia))}wa||(aa=new F.a(aa),aa.s3.add(ia),X.add(aa))}Ban(X,aa,ia){var wa=!1;if(0<X.length&&11===X.sg(X.length-1).type){const ma=X.sg(X.length-1);ma.cp===aa&&((wa=Object(v.a)(D.a,ma.s3.J(ma.s3.length-1)))?wa.text=ia.character.toString()+wa.text:ma.s3.add(new D.a(ia.mZa,
ia.character.toString())),wa=!0)}wa||(aa=new F.a(aa),aa.s3.add(new D.a(ia.mZa,ia.character.toString())),X.add(aa))}BQl(X,aa,ia){aa=new x.a(aa,ia.mZa,ia.Yc);X.add(aa)}SYc(X,aa){let ia=!1;if(0<X.AK.length&&2===X.AK.sg(X.AK.length-1).type){const wa=X.AK.sg(X.AK.length-1);wa.Rg.equals(aa.mZa)&&wa.cp===aa.Jpe&&(wa.cp=aa.Jpe-1,wa.text=(void 0).character.toString()+wa.text,ia=!0)}ia||X.AK.add(new u.DeleteTextUpdateHint(aa.mZa,aa.Jpe-1,(void 0).character.toString()));--aa.Jpe}VQl(X,aa,ia){let wa=!1;if(0<
X.length&&8===X.sg(X.length-1).type){const ma=X.sg(X.length-1);ma.cp===aa+1&&(ma.text=ia.character.toString()+ma.text,--ma.cp,wa=!0)}wa||X.add(new z.a(aa,ia.character.toString()))}}Object(G.a)(Z,"LCSUpdateHintGenerator",null,[])},1880:function(G,J,d){G=d(0);var m=d(1567),f=d(1704),a=d(1626),l=d(1587),w=d(1812),y=d(1640);class v{constructor(Z,X){this.DimensionValue=this.DimensionName=null;this.DimensionName=Z;this.DimensionValue=X}}Object(G.a)(v,"Dimension",null,[]);class u{constructor(Z,X,aa,ia,wa){this.Query=
this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=Z;this.Query=X;this.From=aa;this.Size=ia;wa&&(this.Filter=wa)}}Object(G.a)(u,"EntityRequest",null,[]);class x{constructor(Z){this.QueryString=null;this.QueryString=Z}}Object(G.a)(x,"Query",null,[]);var z=d(1569);class A{constructor(Z,X){this.Dimensions=this.Name=null;this.Name=Z;this.Dimensions=X}}Object(G.a)(A,"Scenario",null,[]);var D=d(1572),F=d(1571);class I{constructor(Z,X,aa,ia){this.Scenario=this.Cvid=this.TimeZone=
this.EntityRequests=null;this.EntityRequests=Z;this.TimeZone=X;this.Cvid=aa;this.Scenario=ia}}Object(G.a)(I,"SubstrateBody",null,[]);var H=d(1639),N=d(1565),M=d(1563),U=d(2),O=d(1806),V=d(1805),Y=d(1611),Q=d(34),S=d(19),P=d(123);d.d(J,"a",function(){return T});class T{constructor(Z){this.UMc=this.Mkb=this.QHd=this.AHc=this.FNc=0;this.rwh=this.Ozh=this.nT=null;this.z_e=0;this.A5=-1;this.zQc="";this.FTe=!1;this.Af=U.AFrameworkApplication.Be;this.kc=Z;this.MNd=this.COf();this.THb=new f.a;this.Juh=this.kc.UDe?
3:2;this.vaf=this.kc.UDe&&this.kc.OUj?5:3;this.Kdf=this.kc.vze?2:3;this.yLh=1;this.WGd=this.kc.nDi;this.VFh=this.kc.srn;this.HOc=Z.zHi;U.AFrameworkApplication.K&&(this.Ozh=U.AFrameworkApplication.K.kb("AppCatalogUrl")+U.AFrameworkApplication.K.kb("SearchPersonaPhotoBaseUrl"),this.FTe=this.kc.Qhc||this.kc.Hka||this.kc.m1d);this.kc.Hka&&(this.Kdf=this.vaf=5)}sN(){return"Substrate"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:3}hK(Z,X,aa,ia=m.a.su,wa=null){const ma=new F.a(Z);if(!wa||Array.contains(wa,
14)||Array.contains(wa,15)||Array.contains(wa,20))if(!this.z_e||window.performance.now()-this.z_e>=M.a.jfb)if(aa=this.THb.eIi())this.z_e=window.performance.now(),aa.then(na=>{na&&""!==na?(this.zQc=na,""!==this.nT&&this.dIi(Z,ia,this.zQc,X,wa)):(N.TellMeActor.instance.Ye.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),X.Ot(ma))},na=>{N.TellMeActor.instance.Ye.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+na);X.Ot(ma)});else{if(N.TellMeActor.instance.Ye)N.TellMeActor.instance.Ye.onError("SubstrateResultsProvider:IssueQuery",
"undefined token promise");X.Ot(ma)}else this.zQc&&""!==this.zQc?this.dIi(Z,ia,this.zQc,X,wa):(X.Ot(ma),N.TellMeActor.instance.Ye.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else X.Ot(ma)}bEa(){this.Mkb=this.UMc=this.QHd=this.AHc=this.FNc=0}dIi(Z,X,aa,ia,wa){this.bEa();const ma=new F.a(Z),na=this.nT=P.a.create().toString();this.VIa();this.A5=window.setTimeout(()=>{if(na===this.nT){this.nT="";this.A5=-1;ia.Ot(ma);const ya={};ya[a.a.provider]=this.sN();ya[a.a.rYb]=Z.Swb;
N.TellMeActor.instance.Ye.gC(l.a.XIg,this.HOc,ya)}},this.HOc);const Fa={"Content-Type":"application/json",Accept:"application/json"};Fa.Authorization="Bearer "+aa;Fa["X-Office-Version"]=U.AFrameworkApplication.buildVersion;Fa["X-Office-Application"]=U.AFrameworkApplication.K.kb("Application");Fa["X-Office-Platform"]="WAC";Fa["X-TellMe-SessionId"]=N.TellMeActor.instance.U9d();Fa["X-TellMe-Culture"]=U.AFrameworkApplication.uiCulture;Fa["X-TellMe-ProcessSessionId"]=U.AFrameworkApplication.userSessionId;
Fa["Client-Request-Id"]=na;const Qa=window.performance.now();this.Af.Ij(this.jMm(),2,this.kMm(Z.Yg,this.kc.application,N.TellMeActor.instance.U9d(),M.a.EU(Z)),Fa,!1,0,ya=>{this.SWb(ya,Z,ia,na,Qa,X,wa)},ya=>{this.zWb(ya,Z,ia,na,Qa)},null,null,!1,4E3,6E3)}VIa(){-1!==this.A5&&(window.clearTimeout(this.A5),this.A5=-1)}SWb(Z,X,aa,ia,wa,ma,na){N.TellMeActor.instance.Ye.aca(X.Yg.length,this.MNd.join(","),Z.data.He.toString(),Math.round(window.performance.now()-wa),H.a.fZj,!0,y.a.OWa);const Fa=M.a.EU(X),
Qa=new F.a(X);if(ia===this.nT){this.VIa();Z=Q.b(Z.data.De);if(Z.Groups){Z=Z.Groups;for(const ya of Z)"People"===ya.Type&&this.kc.Crd&&(na?Array.contains(na,14):1)?(Z=this.BEi(ya.Suggestions,Fa,ma),0<Z.results.length&&Qa.aw(Z)):"File"===ya.Type&&this.kc.Ard&&(na?Array.contains(na,15):1)?(Z=this.WJf(ya.Suggestions,Fa,ma),0<Z.results.length&&(this.Bee()&&(ia=new z.a("GenerateSlidesFromTellMe",30,"",null,1),Z.hy(ia)),Qa.aw(Z))):"Notes"===ya.Type&&this.kc.Ptb&&ma!==m.a.contextMenu&&(na?Array.contains(na,
20):1)&&(Z=this.jDi(ya.Suggestions,Fa,X),0<Z.results.length&&Qa.aw(Z))}aa.Ot(Qa);N.TellMeActor.instance.Ye.aca(X.Yg.length,this.MNd.join(","),"",Math.round(window.performance.now()-wa),"",!0,y.a.provider)}else aa.Ot(Qa)}jDi(Z,X,aa){const ia=new D.a(20);ia.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const wa of Z)this.Itn(wa)&&(Z=wa.NotesType,Z=S.a.xh(Z),Z=this.$Bm(Z,wa.LastModifiedTime,wa.BodyPreview,wa.Subject,X,aa,wa))&&(Z.groupType=20,ia.hy(Z));return ia}BEi(Z,X,aa){const ia=new D.a(14);
ia.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const ma of Z)if(this.Jtn(ma)){var wa=ma.Id.split("@")[0];Z=ma.EmailAddresses[0];let na=ma.Type;if(void 0===na||null===na)na="User";if(wa=this.pFm(na,ma.DisplayName,ma.JobTitle,Z,wa,aa,X))wa.description=Z,Z=ma.JobTitle,"Department"in ma&&"CompanyName"in ma&&(Z+="@"+ma.Department+"@"+ma.CompanyName),wa.eL=Z,ia.hy(wa)}return ia}WJf(Z,X,aa){const ia=new D.a(15);ia.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const ya of Z)if(this.ztn(ya)){var wa=
ya.FileName;Z=ya.FileExtension;var ma=wa;wa.length>Z.length&&ma.endsWith(Z)&&(ma=wa.substr(0,wa.length-Z.length-1));var na=void 0,Fa=0;"DateCreated"in ya&&ya.DateCreated?(Fa=M.a.mPf(ya.DateCreated),na=M.a.vJi(ya.DateCreated),na=String.format(CommonUIStrings.l_CreatedTimeFormatString,ya.Author,na)):na=ya.Author;var Qa=ya.AccessUrl+"?web=1";const ta=S.a.vmc(Qa);wa=String.format('<a href="{0}">{1}</a>',ta,S.a.e0(wa));if(aa!==m.a.contextMenu||S.a.IX(Qa))if(ma=this.Xrm(ma,aa===m.a.contextMenu?wa:Qa,na,
ya.FileExtension,ya.Text,X))ma.description=ya.Author,ma.mSd=Fa,ia.hy(ma),this.FTe&&(Fa=ya.AccessUrl,wa=M.a.Q6d(Z),na=ya.DateModified?ya.DateModified:ya.DateCreated,Qa=ya.Size?ya.Size:ya.FileSize,this.T2o()&&(Fa=Fa.replace(RegExp("%20","g")," "),wa=M.a.gLm(Z)),Z=new w.a(wa,Fa,ya.SPWebUrl,ya.Id,Qa,na),N.TellMeActor.instance.cMg(!1,ma.value,Z))}return ia}zWb(Z,X,aa,ia,wa){ia===this.nT&&(this.VIa(),N.TellMeActor.instance.Ye.aca(X.Yg.length,this.MNd.join(","),Z.data.He.toString(),Math.round(window.performance.now()-
wa),H.a.fZj,!1,y.a.OWa));Z=new F.a(X);aa.Ot(Z)}pFm(Z,X,aa,ia,wa,ma,na){na=na?this.yLh:this.Juh;if(!window.LPC&&!M.a.wYf()||this.FNc===na)return null;this.FNc+=1;na="PeopleSuggestion"+this.FNc.toString();var Fa=this.Ozh+"?size=1&accountName="+ia;Z=Object.assign(new O.a,{PersonaType:Z,Smtp:ia,ProfilePictureUrl:Fa,AadObjectId:wa});const Qa=Object.assign(new V.a,{identifiers:Z,displayName:X});Z=ma===m.a.contextMenu;this.kc.KBa?(N.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(na,
Qa,X,aa)),ma===m.a.contextMenu&&(aa=M.a.hbi(X,ia,wa),N.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(na,aa))),N.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(na,Z))):(Fa=[],Fa.push(appChrome.actions.setPersonaButtonCoauthor(na,Qa,X,aa)),ma===m.a.contextMenu&&(aa=M.a.hbi(X,ia,wa),Fa.push(appChrome.actions.setButtonCommandValueId(na,aa))),Fa.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(na,Z)),appChrome.api.dispatch(Fa));
return new z.a(na,11,X,ia,0)}$Bm(Z,X,aa,ia,wa,ma,na){if(wa&&!this.kc.t3i||this.QHd===this.WGd||this.UMc===this.WGd||this.Mkb===this.WGd)return null;var Fa=null;this.QHd+=1;wa="";const Qa=[],ya={};na.type="Notes";this.rwh=Object.assign(new Y.a,{landingTab:"Notes",data:na});ma=M.a.OUa(ma.Yg,33,this.rwh);if("onenotepagepreviews"===Z){if(!("ClickthroughUrl"in na&&na.ClickthroughUrl)||""===na.ClickthroughUrl)return null;this.UMc+=1;wa="OnenoteNotesSuggestion"+this.UMc.toString();ya["default"]="SaveAsonetoc2_20";
Fa=na.ClickthroughUrl;Qa.push(appChrome.actions.setControlIconSet(wa,ya));Qa.push(appChrome.actions.setCompoundButtonCommandValueId(wa,Fa));Fa=new z.a(wa,19,null,null,0)}else if("stickynote"===Z){if(!this.VFh)return null;this.Mkb+=1;wa="NotesSuggestion"+this.Mkb.toString();ya["default"]="ShowAllNotes_20";Qa.push(appChrome.actions.setControlIconSet(wa,ya));Qa.push(appChrome.actions.setCompoundButtonCommandValueId(wa,ma));Fa=new z.a(wa,21,null,null,0)}else if("samsung"===Z){if(!this.VFh)return null;
this.Mkb+=1;wa="NotesSuggestion"+this.Mkb.toString();ya["default"]="CategoryCollapsed_20";Qa.push(appChrome.actions.setControlIconSet(wa,ya));Qa.push(appChrome.actions.setCompoundButtonCommandValueId(wa,ma));Fa=new z.a(wa,20,null,null,0)}""!==wa&&(Z=M.a.vJi(X),Z=String.format(CommonUIStrings.l_LastModifiedString,Z),Fa.label=ia,Fa.mSd=M.a.mPf(X),Qa.push(appChrome.actions.setControlLabel(wa,ia)),Qa.push(appChrome.actions.updateCompoundButtonDescription(wa,Z)),Qa.push(appChrome.actions.setControlCustomTooltip(wa,
aa)),appChrome.api.dispatch(Qa));return Fa}Xrm(Z,X,aa,ia,wa,ma){if(this.AHc===(ma?this.Kdf:this.vaf)||this.FTe&&"Word"!==M.a.Q6d(ia))return null;this.AHc+=1;ma="FileSuggestion"+this.AHc.toString();const na=[],Fa={};Fa["default"]=M.a.tvm(ia);this.kc.KBa?(N.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ma,Z)),N.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(ma,Fa)),N.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ma,aa)),
N.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ma,X)),N.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(ma,wa)),this.kc.Qhc&&N.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonSecondaryButtonId(ma,"QuickActionOnFile"))):(na.push(appChrome.actions.setControlLabel(ma,Z)),na.push(appChrome.actions.setControlIconSet(ma,Fa)),na.push(appChrome.actions.updateCompoundButtonDescription(ma,aa)),na.push(appChrome.actions.setCompoundButtonCommandValueId(ma,
X)),na.push(appChrome.actions.setControlCustomTooltip(ma,wa)),this.kc.Qhc&&na.push(appChrome.actions.setCompoundButtonSecondaryButtonId(ma,"QuickActionOnFile")),appChrome.api.dispatch(na));return new z.a(ma,6,Z,aa,0)}COf(){const Z=[];this.kc.Crd&&Array.add(Z,"People");this.kc.Ard&&Array.add(Z,"File");this.kc.Ptb&&Array.add(Z,"Notes");return Z}kMm(Z,X,aa,ia){var wa=new x(Z);Z=new u("File",wa,0,ia?this.Kdf:this.vaf,null);ia=new u("People",wa,0,ia?this.yLh:this.Juh,M.a.S$n);wa=new u("Notes",wa,0,this.WGd,
null);(this.kc.Qhc||this.kc.m1d)&&"powerpoint"===X.toLowerCase()&&(X="word");X=new v("app",X.toLowerCase());var ma=[];Array.add(ma,X);X=new A("tellmesearch",ma);ma=[];this.kc.Ard&&Array.add(ma,Z);this.kc.Crd&&Array.add(ma,ia);this.kc.Ptb&&Array.add(ma,wa);aa=new I(ma,"UTC",aa,X);return Q.c(aa)}jMm(){let Z=this.kc.Cep;this.kc.Ptb&&(Z+="?&setflight=NotesFrom3S");""!==this.kc.fIi&&(Z=Z+"&"+this.kc.fIi);return Z}Jtn(Z){return"DisplayName"in Z&&"Id"in Z&&"EmailAddresses"in Z&&!!Z.Id&&!!Z.EmailAddresses}ztn(Z){return"FileExtension"in
Z&&!!Z.FileExtension&&"FileName"in Z&&!!Z.FileName&&""!==Z.FileName&&"AccessUrl"in Z&&!!Z.AccessUrl&&""!==Z.AccessUrl}Itn(Z){return"Id"in Z&&!!Z.Id&&"NotesType"in Z&&!!Z.NotesType&&"Subject"in Z&&!!Z.Subject&&""!==Z.Subject}Bee(){return!!U.AFrameworkApplication.K&&U.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}T2o(){return!!U.AFrameworkApplication.K&&U.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",
!0)}}Object(G.a)(T,"SubstrateResultsProvider",null,[1003])},1881:function(G,J,d){d.r(J);G=d(0);var m=d(63),f=d(16),a=d(5),l=d(192),w=d(381),y=d(651),v=d(233),u=d(54),x=d(104),z=d(1612);class A extends z.a{constructor(){super()}get tfa(){return"ChildNodeListMerge"}}Object(G.a)(A,"ChildNodeListMergeFailureDetail",z.a,[]);class D{cAb(T,Z,X){return Z.l3(T,X.J(T))}O3j(T,Z,X,aa){let ia;return({value:ia}=Z.Dc(T)).returnValue||({value:ia}=X.Dc(T)).returnValue?ia:aa.J(T)}}Object(G.a)(D,"ChildNodeListMergeUtils",
null,[1082]);var F=d(1667),I=d(1894),H=d(1713);class N{constructor(T,Z){this.classId=T;this.Aqp=Z}}Object(G.a)(N,"NodeChildrenTransformation",null,[]);var M=d(864),U=d(1631);class O{constructor(T,Z,X){this.YM=T;this.cFa=X;this.vsa=Z}Gre(T){let Z,X;return({Cwj:Z}=this.T3j(this.cFa,T)).returnValue&&Z.B3||({Cwj:X}=this.T3j(this.vsa,T)).returnValue&&X.B3}T3j(T,Z){let X;return{returnValue:({value:X}=(new U.a(this.YM,T)).yNa.Dc(M.a.yb(Z))).returnValue,Cwj:X}}}Object(G.a)(O,"NodeTriplet",null,[]);var V=
d(1823);class Y{constructor(T,Z,X){this.Zd=T;this.vg=Z;this.P$=X;this.TGh=!0}get lu(){return this.Zd}get gf(){return this.vg}get nFa(){return this.P$}get success(){return this.TGh}aFm(){l.a.instance.Ua(4220310,1,5,"Evaluating ParentObjects");const T=new w.a;this.Fmf(T,Z=>this.lu.runtime.In.J(Z));this.Fmf(T,Z=>this.nFa.cAb(Z,this.lu.runtime.NA,this.lu.runtime.In));this.Fmf(T,Z=>this.nFa.cAb(Z,this.lu.runtime.sv,this.lu.runtime.In));return T}Fmf(T,Z){const X=Z(d(1881).ChildNodeListMerge.upe);this.gf.getPropertyObjectIds(X,
f.a.wg).forEach(aa=>{this.gf.getPropertyObjectIds(Z(aa),f.a.wg).forEach(ia=>{T.mb(ia)&&!aa.equals(T.J(ia))&&(this.TGh=!1,l.a.instance.Ua(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",ia,aa,T.J(ia)));T.Z(ia,aa);return!0});return!0})}}Object(G.a)(Y,"OutlineGroupParentFinder",null,[]);var Q=d(1613),S=d(1832);d.d(J,"ChildNodeListMerge",function(){return P});class P{constructor(T,Z=null,X=null,aa=null,ia=null){this.vg=T;this.Q8n=Z||I.a.n4j;this.Ble=X||this.IBm();
this.nFa=aa||new D;this.Ydj=ia||this.Izm()}get gf(){return this.vg}IBm(){return[new N(m.a.Sh,Object(x.a)(this,this.u7n,"pageContentNodeThreewayChildMerge")),new N(m.a.xoa,Object(x.a)(this,this.eJp,"wordSectionNodeThreewayChildMerge")),new N(m.a.iH,Object(x.a)(this,this.lpe,"outlineElementContainerThreewayChildMerge")),new N(m.a.Yca,Object(x.a)(this,this.kgp,"tableCellThreewayChildMerge")),new N(m.a.Waa,Object(x.a)(this,this.lpe,"outlineElementContainerThreewayChildMerge")),new N(m.a.k6c,Object(x.a)(this,
this.lpe,"outlineElementContainerThreewayChildMerge")),new N(m.a.lL,Object(x.a)(this,this.lpe,"outlineElementContainerThreewayChildMerge"))]}Izm(){return[Object(x.a)(this,this.Deo,"prepareObjectGroupings"),Object(x.a)(this,this.NVm,"handleInterOutlineGroupMerge"),Object(x.a)(this,this.jao,"performThreewayChildMerge")]}fLn(T){let Z=0;for(;Z<this.Ydj.length;Z++)if(!(0,this.Ydj[Z])(T))return l.a.instance.Ua(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",Z),T.logger.Qie("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",
Z),!1;return!0}Deo(T){const Z=new w.a,X=new w.a,aa=new y.a;T.runtime.NA.forEach((ia,wa)=>P.hsj(wa,Z));T.runtime.sv.forEach((ia,wa)=>P.hsj(wa,X));for(let ia=0;ia<this.Ble.length;ia++){const wa=this.Ble[ia].classId;T.runtime.kvb.Z(wa,new w.a);Z.mb(wa)&&Z.J(wa).forEach(ma=>{var na=T.runtime.In.J(ma.id);na&&(na=new O(na,ma,T.runtime.sv.l3(ma.id,na)),T.runtime.kvb.J(wa).add(ma.id,na),aa.add(ma.id));return!0});X.mb(wa)&&X.J(wa).forEach(ma=>{if(aa.contains(ma.id))return!0;const na=T.runtime.In.J(ma.id);
na&&T.runtime.kvb.J(wa).add(ma.id,new O(na,na,ma));return!0})}T.runtime.dJ("PrepareObjectGroupings");T.logger.qbb("PrepareObjectGroupings");return!0}jao(T){let Z=!0;for(let X=0;Z&&X<this.Ble.length;X++){const aa=this.Ble[X];T.runtime.dJ("Before function#"+X);const ia=aa.classId;T.runtime.kvb.J(ia).forEach((wa,ma)=>{T.runtime.oUa.contains(ma.YM.id)||(Z=aa.Aqp(T,ma)&&Z);Z||(l.a.instance.Ua(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",ia,ma.YM.id),T.logger.Oi(Object.assign(new A,
{$j:"PerformThreewayChildMerge",eventId:"aqtsr"})));return Z});T.runtime.dJ("PerformThreewayChildMerge"+X)}T.logger.qbb("PerformThreewayChildMerge");return Z}u7n(T,Z){if(Z.Gre(f.a.wg)){var X=this.gf.getPropertyObjectIds(Z.YM,f.a.wg);const aa=this.gf.getPropertyObjectIds(Z.vsa,f.a.wg);Z=this.gf.getPropertyObjectIds(Z.cFa,f.a.wg);X=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",X.length,aa.length,Z.length,T.input.source);l.a.instance.Ua(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",
X);T.logger.Oi(Object.assign(new A,{$j:"PageContentNodeThreewayChildMerge",eventId:"apybx",info:X}));return!1}return!0}eJp(T,Z){if(Z.Gre(f.a.wg)){const Fa=new y.a,Qa=new y.a,ya=new y.a,ta=new y.a;var X=this.gf.getPropertyObjectIds(Z.YM,f.a.wg),aa=X.BS(),ia,wa=({h9h:ia}=this.zak(Z.vsa,aa,Fa,"Favored")).returnValue,ma=({h9h:na}=this.zak(Z.cFa,aa,Qa,"Unfavored")).returnValue;if(!wa||!ma)return X=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",
aa.count,Fa.count,Qa.count,ia,na),T.logger.Oi(Object.assign(new A,{$j:"WordSectionNodeThreewayChildMerge",info:X})),!1;X.forEach(Aa=>{Fa.contains(Aa)||ya.add(Aa);Qa.contains(Aa)||ta.add(Aa);return!0});Z=Z.YM.WO();aa=new v.a;for(ia=0;ia<X.length;ia++){var na=X.sg(ia);if(ya.contains(na)||ta.contains(na)){if(T.runtime.oUa.add(na),aa.length&&(wa=aa.sg(aa.length-1),wa=T.runtime.kvb.J(m.a.iH).J(wa),ma=T.runtime.kvb.J(m.a.iH).J(na),wa&&ma))ya.contains(na)?ta.contains(na)||(wa.YM=wa.YM.WO(),wa.cFa=wa.cFa.WO(),
this.ISd(wa.YM,ma.YM),this.ISd(wa.cFa,ma.cFa)):(wa.YM=wa.YM.WO(),wa.vsa=wa.vsa.WO(),this.ISd(wa.YM,ma.YM),this.ISd(wa.vsa,ma.vsa))}else aa.add(na)}this.gf.setPropertyObjectIds(Z,f.a.wg,aa);X=new Q.a(Z);X.XM(f.a.wg);T.runtime.Yq.Z(Z.id,X)}return!0}ISd(T,Z){const X=this.gf.getPropertyObjectIds(T,f.a.wg);Z=this.gf.getPropertyObjectIds(Z,f.a.wg);const aa=X.wOa();Z.forEach(ia=>{aa.add(ia);return!0});this.gf.setPropertyObjectIds(T,f.a.wg,aa)}zak(T,Z,X,aa){let ia=0,wa=!0;this.gf.getPropertyObjectIds(T,f.a.wg).forEach(ma=>
{Z.contains(ma)?X.add(ma):(wa=!1,l.a.instance.Ua(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",aa,ma),ia++);return!0});return{returnValue:wa,h9h:ia}}NVm(T){let Z=!0;T.runtime.kvb.J(m.a.iH).forEach((X,aa)=>{if(this.hln(aa)){l.a.instance.Ua(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",aa.YM.id);let ia;const wa=new Y(T,this.gf,this.nFa);if(({tqj:X,rck:ia}=this.Kop(T,wa.aFm(),aa)).returnValue)return l.a.instance.Ua(4220303,1,4,"Merging WordSection {0} as a unit.",
ia),Z=wa.success&&this.ZLn(T,ia,X)&&Z,Z||(l.a.instance.Ua(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",aa.YM.id,wa.success),T.logger.Oi(Object.assign(new A,{$j:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",wa.success)}))),Z}return!0});return Z}hln(T){if(!T.Gre(f.a.wg))return!1;const Z=this.gf.getPropertyObjectIds(T.YM,f.a.wg).J(0),X=this.gf.getPropertyObjectIds(T.vsa,f.a.wg);
T=this.gf.getPropertyObjectIds(T.cFa,f.a.wg);return!X.contains(Z,(aa,ia)=>aa.equals(ia))||!T.contains(Z,(aa,ia)=>aa.equals(ia))}Kop(T,Z,X){Z=Z.J(X.YM.id);l.a.instance.Ua(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",X.YM.id,Z);if(T.runtime.oUa.contains(Z))return l.a.instance.Ua(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",
Z),{returnValue:!1,tqj:null,rck:Z};const aa=new V.a;X=T.runtime.In.J(Z);this.gf.getPropertyObjectIds(X,f.a.wg).forEach(ia=>{aa.HSd(ia);return!0});X=this.nFa.cAb(Z,T.runtime.NA,T.runtime.In);this.gf.getPropertyObjectIds(X,f.a.wg).forEach(ia=>{aa.JSd(ia);return!0});T=this.nFa.cAb(Z,T.runtime.sv,T.runtime.In);this.gf.getPropertyObjectIds(T,f.a.wg).forEach(ia=>{aa.NSd(ia);return!0});return{returnValue:!0,tqj:aa,rck:Z}}qmg(T,Z,X,aa,ia){let wa=!0;T.forEach(ma=>{const na=Z(ma);this.gf.getPropertyObjectIds(na,
f.a.wg).forEach(Fa=>{X.add(Fa);if(aa.mb(Fa))return(wa=aa.J(Fa).equals(ma)&&wa)||l.a.instance.Ua(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",ia,Fa,ma,aa.J(Fa)),wa;aa.Z(Fa,ma);return!0});return!0});return wa}mDm(T,Z){let X,aa,ia,wa;X=new v.a;aa=new v.a;ia=new v.a;wa=new w.a;const ma=T.runtime.In;return this.qmg(Z.AKb,na=>ma.J(na),X,wa,"Base")&&this.qmg(Z.bDf,na=>this.nFa.cAb(na,T.runtime.NA,ma),aa,wa,"Favored")&&this.qmg(Z.hAb,
na=>this.nFa.cAb(na,T.runtime.sv,ma),ia,wa,"Unfavored")?{returnValue:!0,ZVh:X,mni:aa,j5j:ia,Eij:wa}:{returnValue:!1,ZVh:X,mni:aa,j5j:ia,Eij:wa}}j$l(T,Z,X,aa){let ia=!0;const wa=T.runtime.In,ma=T.runtime.NA,na=T.runtime.sv,Fa=T.runtime.Yq,Qa=new v.a,ya=new w.a;X.forEach(ta=>{const Aa=aa.J(ta);if(!Aa)return l.a.instance.Ua(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",ta),T.logger.Oi(Object.assign(new A,{$j:"FinishInterOutlineGroupMerge",eventId:"aqgws"})),
ia=!1;Aa.equals(Qa.last())||(Qa.add(Aa),ya.add(Aa,new v.a));ya.J(Aa).add(ta);T.runtime.oUa.add(ta);return!0});if(!ia)return!1;ya.forEach((ta,Aa)=>{const oa=this.nFa.O3j(ta,ma,na,wa).WO();this.gf.setPropertyObjectIds(oa,f.a.wg,Aa);Fa.Z(ta,new Q.a(oa));Fa.J(ta).XM(f.a.wg);T.runtime.oUa.add(ta);return ia});X=this.nFa.O3j(Z,ma,na,wa).WO();this.gf.setPropertyObjectIds(X,f.a.wg,Qa);Fa.Z(Z,new Q.a(X));Fa.J(Z).XM(f.a.wg);T.runtime.oUa.add(Z);return ia}ZLn(T,Z,X){let aa,ia;if(!({ZVh:wa,mni:aa,j5j:ia,Eij:X}=
this.mDm(T,X)).returnValue)return!1;var wa=F.b(wa,aa,ia);wa=this.oqj(T,wa);return!!wa&&this.j$l(T,Z,wa,X)}lpe(T,Z){return this.pqj(T,Z)}pqj(T,Z){if(Z.Gre(f.a.wg)){var X=this.iDm(Z);X=this.oqj(T,X);if(!X)return l.a.instance.Ua(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",Z.YM.id),T.logger.Oi(Object.assign(new A,{$j:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),
H.a(Z.YM,"OutlineElementContainerThreewayChildMerge_Base",1),H.a(Z.vsa,"OutlineElementContainerThreewayChildMerge_Favored",1),H.a(Z.cFa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var aa=this.gf.getPropertyObjectIds(Z.YM,f.a.wg);const ia=X.BS();aa.forEach(wa=>{ia.contains(wa)||(wa=this.gf.getPropertyObjectIds(Z.YM,f.a.$H),0<wa.length&&T.runtime.vjg.add(wa.J(0)));return!0});aa=Z.vsa.WO();this.gf.setPropertyObjectIds(aa,f.a.wg,X);T.runtime.Yq.Z(aa.id,new Q.a(aa));T.runtime.Yq.J(aa.id).XM(f.a.wg)}return!0}kgp(T,
Z){let X=Z.vsa.hasProperty(f.a.wg),aa=Z.cFa.hasProperty(f.a.wg);X&&(X=!!this.gf.getPropertyObjectIds(Z.vsa,f.a.wg).length);aa&&(aa=!!this.gf.getPropertyObjectIds(Z.cFa,f.a.wg).length);if(X!==aa)if(this.hsn(T.runtime.rc))T.logger.i$i(Object.assign(new S.a,{info:"TableCell OE missing children, ghost cell likely touched"}));else return T.logger.Oi(Object.assign(new S.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.pqj(T,Z)}iDm(T){let Z,X;({Jbl:T,Y5l:Z,Brp:X}=this.Hqm(T));
return F.b(T,Z,X)}oqj(T,Z){l.a.instance.Ua(4220309,1,5,"Considering {0} OutlineElement collections for merge.",Z.length);const X=new v.a;let aa=!0;Z.forEach(ia=>{if(!ia)return l.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),T.logger.Oi(Object.assign(new A,{$j:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),aa=!1;if(1===ia.QMn&&1===ia.Mub){const oa=ia.AKb.J(0),za=ia.bDf.J(0),ja=ia.hAb.J(0);if(oa&&oa.equals(za)&&oa.equals(ja))return X.add(oa),!0;if(1!==Z.length)return l.a.instance.shipAssertTag(4030554,
1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",oa,za,ja,Z.length),T.logger.Oi(Object.assign(new A,{$j:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),aa=!1}const wa=new w.a,ma=new v.a,na=new v.a,Fa=new v.a,Qa=new v.a,ya=new v.a,ta=new v.a,Aa=T.runtime.In;ia.AKb.forEach(oa=>aa=this.qng(T,oa,za=>Aa.J(za),ma,Qa,wa,"Base"));if(!aa)return l.a.instance.Ua(4285026,
1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),T.logger.Oi(Object.assign(new A,{$j:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;ia.bDf.forEach(oa=>aa=this.qng(T,oa,za=>this.nFa.cAb(za,T.runtime.NA,Aa),na,ya,wa,"Favored"));if(!aa)return l.a.instance.Ua(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),T.logger.Oi(Object.assign(new A,{$j:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),
!1;ia.hAb.forEach(oa=>aa=this.qng(T,oa,za=>this.nFa.cAb(za,T.runtime.sv,Aa),Fa,ta,wa,"Unfavored"));if(!aa)return l.a.instance.Ua(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),T.logger.Oi(Object.assign(new A,{$j:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;T.runtime.rc&&T.runtime.rc.yrb(1000005)&&(ya.length&&this.X5l(ya,T.runtime.NA)?(this.ePh(ya,T,X,wa),this.FRd(T,wa,ta)):this.ePh(ta,T,X,wa));if(ma.length){ia=null;if(!({Yq:ia}=
this.Q8n(T,ma,na,Fa,ia)).returnValue||!ia)return aa=!1;ia.forEach(oa=>{0<oa.rbc.count&&T.runtime.Yq.Z(oa.Fm.id,oa);X.add(wa.J(oa.Fm.id));return!0})}return!0});return aa?X:null}X5l(T,Z){for(let X=0;X<T.length;X++)if(Z.get(T.sg(X).id))return!0;return!1}FRd(T,Z,X){X.length&&(X.forEach(aa=>{T.runtime.syc.add(aa.id);T.runtime.syc.add(Z.J(aa.id));return!0}),I.a.FRd(T,this.gf,X.J(0)))}ePh(T,Z,X,aa){T.forEach(ia=>{const wa=new Q.a(ia.WO());Z.runtime.Yq.Z(ia.id,wa);X.add(aa.J(ia.id));return!0})}qng(T,Z,X,
aa,ia,wa,ma){var na=X(Z);if(!na)return l.a.instance.Ua(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",ma,Z),T.logger.Oi(Object.assign(new A,{$j:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",ma)})),!1;const Fa=this.gf.getPropertyObjectIds(na,f.a.$H);if(!Fa||!Fa.length)return l.a.instance.Ua(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",ma,Z),T.logger.Oi(Object.assign(new A,
{$j:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",ma)})),H.a(na,"ProcessOutlineElement_"+ma,1),!1;na=Fa.sg(0);X=X(na);if(!X)return l.a.instance.Ua(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",ma,na,Z),T.logger.Oi(Object.assign(new A,{$j:"ProcessOutlineElement",eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",
ma)})),!1;if((ma=this.gf.getPropertyString(X,a.a.gQ))&&""!==ma&&T.runtime.rc&&(T.runtime.rc.I$d(1000005),T.runtime.rc.yrb(1000005)))return ia.add(X),wa.add(na,Z),T.runtime.oUa.add(na),!0;aa.add(X);wa.add(na,Z);T.runtime.oUa.add(na);return!0}Hqm(T){let Z,X;Z=this.gf.getPropertyObjectIds(T.YM,f.a.wg);X=this.gf.getPropertyObjectIds(T.vsa,f.a.wg);T=this.gf.getPropertyObjectIds(T.cFa,f.a.wg);return{Jbl:Z,Y5l:X,Brp:T}}hsn(T){if(!T)return l.a.instance.Ua(51422868,1,2,"Feature Helper is null"),!1;T.JF(102);
return T.isFeatureEnabled(102)}static hsj(T,Z){Z.mb(T.yc)||Z.Z(T.yc,new v.a);Z.J(T.yc).add(T);return!0}}P.upe=u.a.Cf("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(G.a)(P,"ChildNodeListMerge",null,[996])},1883:function(G,J,d){G=d(0);var m=d(63),f=d(43),a=d(5),l=d(16),w=d(192),y=d(92),v=d(196),u=d(233),x=d(651),z=d(54),A=d(381),D=d(2),F=d(1511),I=d(1037),H=d(1509);class N{constructor(wa,ma=0){this.Htf=null;this.akg=0;this.XL=wa;this.a9f=ma}}Object(G.a)(N,"GraphMergerResponse",null,[]);var M=d(104),
U=d(1),O=d(105),V=d(769),Y=d(1612),Q=d(1665);class S extends Q.a{constructor(){super();this.lXj=null;this.zbk=!1}get tfa(){return"Crash"}HPb(){this.detail.Z("Type",this.tfa);this.detail.Z("Trace",this.dop(this.lXj));this.detail.Z("Continue",this.zbk);return this.detail}dop(wa){wa=wa.split("\n");const ma=4<wa.length?4:wa.length,na=new Sys.StringBuilder;for(let Fa=0;Fa<ma;Fa++)Fa===ma-1?na.append(String.format("{0}...",wa[Fa])):na.append(String.format("{0}\n",wa[Fa]));return na.toString()}}Object(G.a)(S,
"CrashMergeFailureDetail",Q.a,[]);var P=d(2090),T=d(1631),Z=d(1743),X=d(1613);class aa{constructor(){this.udl=new A.a;this.rwl=new A.a;this.Lzl=new A.a}}Object(G.a)(aa,"RangeMarkers",null,[]);d.d(J,"a",function(){return ia});class ia{constructor(){this.H$d=0;this.nkh=this.Cib=this.p9b=this.vg=this.PCh=this.J$b=null;this.Huh=0;this.prh=50;this.Jhh=this.jbh=null}get Ddb(){return this.J$b}get lIo(){return this.PCh}get gf(){return this.vg}get Pub(){return this.p9b}get NLi(){return this.Cib}get fTm(){return this.nkh}get yrc(){return this.Huh}get t2h(){return this.jbh}get o0c(){return this.Jhh}zVb(wa,
ma,na,Fa,Qa,ya,ta){na=this.wHl(wa,ma,Fa,Qa,ya,ta,this.o0c);Fa=0;const Aa=na.runtime.Aze;let oa=null;try{this.mEn(Aa,na,ta,wa,ma,Qa,ya);let za=H.a.success;for(;Fa<this.Pub.length;Fa++)if(!(0,this.Pub[Fa])(na)){za=H.a.Zj;na.logger.Qie("GraphMerger.GetMergeFunctions()",Fa);break}return oa=new N(na.output.XL,za)}catch(za){const ja=!na.output.timeout;na.output.fAa=ja;const fa=this.J6d(za),Ca=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",ja?"Crashed":"Timed Out",
na.input.BVb,!!na.output.XL,fa);ja?(w.a.instance.Ua(4051608,1,1,"MergeChanges Crash. [Error: {0}]",Ca),na.logger.Oi(Object.assign(new S,{lXj:fa,zbk:!!na.output.XL}))):w.a.instance.Ua(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",Ca);if(na.output.XL)return oa=new N(na.output.XL,H.a.Zj);throw za;}finally{na.output.succeeded?this.jEn(Aa,na,Fa):na.output.timeout?this.lEn(na,Fa):na.output.fAa?na.output.XL?this.kEn(na,Fa):this.iEn(na,Fa):this.hEn(na,Fa);na.logger.gEn();w.a.instance.foa(42350232,1,na.output.succeeded?
4:2,"MergeLogger",na.logger.Kzm());na.logger.Vcd.MNi()&&w.a.instance.foa(559015903,1,2,"MarkerInfo",na.logger.Vcd.toString());if(na.runtime.rc&&na.runtime.rc.isFeatureEnabled(69))try{this.DBn(na)}catch(za){w.a.instance.Ua(571619421,1,4,"Error logging references: {0}",za.toString())}this.SEn(na);oa.akg|=(na.output.succeeded?2:1)<<2*(ta-1);if(oa)try{oa.Htf=this.jeo(na)}catch(za){w.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",za)}}}SEn(wa){if(!wa.output.succeeded){wa=wa.output.timeout?
"Timeout":wa.logger.Nwj?wa.logger.Nwj.tfa:"Unknown";const ma=new O.a;y.Health.instance.recordQosError(wa,["MergeFailure"],!0,!0,!1,!1,ma)}}DBn(wa){const ma=Qa=>{const ya=this.GKa()-wa.input.X_a>this.yrc;if(0<this.yrc&&ya)throw w.a.instance.Ua(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Qa),v.a.invalidOperation(Qa);};let na=wa.runtime.NA.keys,Fa=Qa=>wa.runtime.NA.J(Qa);this.e6f(wa,ma,na,Fa,"Favored");na=wa.runtime.sv.keys;Fa=Qa=>wa.runtime.sv.J(Qa);this.e6f(wa,ma,na,Fa,
"Unfavored");na=wa.runtime.Yq.keys;Fa=Qa=>{const ya=wa.runtime.Yq.J(Qa);return ya?ya.Fm:wa.runtime.NA.J(Qa)};this.e6f(wa,ma,na,Fa,"Merged")}e6f(wa,ma,na,Fa,Qa){var ya=new u.a;const ta=new u.a;for(let Aa=0;Aa<na.length;Aa++){ma("LogAddedAndDeletedNodes");const oa=Fa(na.J(Aa));if(oa.yc===m.a.owa)continue;const za=wa.runtime.In.J(oa.id);za&&this.EBn(ya,ta,oa,za)}this.caj(ta,Aa=>wa.runtime.In.J(Aa),ma);this.caj(ya,Fa,ma);ma=new Sys.StringBuilder;for(na=0;na<ya.length;na++)ma.append(ya.J(na).toString()+
",");ya=new Sys.StringBuilder;for(na=0;na<ta.length;na++)ya.append(ta.J(na).toString()+",");w.a.instance.foa(571619423,1,4,Qa+" revision: Added references",ma.toString());w.a.instance.foa(571619424,1,4,Qa+" revision: Deleted references",ya.toString())}EBn(wa,ma,na,Fa){const Qa=na.fk();for(let ta=0;ta<Qa.length;ta++){const Aa=Qa[ta];if(this.FVi(Aa)){var ya=this.gf.getPropertyObjectIds(na,Aa);this.rDn(wa,ma,Fa,Aa,ya)}else this.j0i(Aa)&&(ya=this.gf.getPropertyObjectId(na,Aa),this.qDn(wa,ma,Fa,Aa,ya))}}caj(wa,
ma,na){na("LogNestedReferences");na=new u.a;const Fa=new x.a;for(let Qa=0;Qa<wa.length;Qa++){const ya=wa.J(Qa);this.J6f(ya,na,Fa,ma)}for(ma=0;ma<na.length;ma++)wa.add(na.J(ma))}J6f(wa,ma,na,Fa){const Qa=Fa(wa);if(Qa){const ta=Qa.fk();for(let Aa=0;Aa<ta.length;Aa++){var ya=ta[Aa];if(this.FVi(ya)){ya=this.gf.getPropertyObjectIds(Qa,ya);for(let oa=0;oa<ya.length;oa++)na.contains(ya.J(oa))||(ma.add(ya.J(oa)),na.add(ya.J(oa)),this.J6f(ya.J(oa),ma,na,Fa))}else this.j0i(ya)&&(ya=this.gf.getPropertyObjectId(Qa,
ya),na.contains(ya)||(ma.add(ya),na.add(ya),this.J6f(wa,ma,na,Fa)))}}}rDn(wa,ma,na,Fa,Qa){if(this.gf.hasProperty(na,Fa)){na=this.gf.getPropertyObjectIds(na,Fa);const ya=na.BS();Fa=Qa.BS();for(let ta=0;ta<Qa.length;ta++)ya.contains(Qa.J(ta))||wa.add(Qa.J(ta));for(wa=0;wa<na.length;wa++)Fa.contains(na.J(wa))||ma.add(na.J(wa))}else for(ma=0;ma<Qa.length;ma++)wa.add(Qa.J(ma))}qDn(wa,ma,na,Fa,Qa){Qa&&(this.gf.hasProperty(na,Fa)?(na=this.gf.getPropertyObjectId(na,Fa),Qa.equals(na)||(wa.add(Qa),ma.add(na))):
wa.add(Qa))}fEn(wa){w.a.instance.Ua(4535064,1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",wa.input.BVb,wa.output.fAa,wa.output.timeout)}mEn(wa,ma,na,Fa,Qa,ya,ta){if(wa){wa=Fa.length?Fa.sg(Fa.length-1):null;var Aa=Qa.length?Qa.sg(Qa.length-1):null;na=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",
ma.input.BVb,Fa.length,wa?wa.id:z.a.nil,wa?wa.KJ?wa.KJ.id:z.a.nil:z.a.nil,Qa.length,Aa?Aa.id:z.a.nil,Aa?Aa.KJ?Aa.KJ.id:z.a.nil:z.a.nil,ya,ta,this.yrc,na);switch(ma.input.source){case 5:w.a.instance.Ua(51663493,1,4,na);break;default:w.a.instance.Ua(4051606,1,4,na)}}}jEn(wa,ma,na){if(wa)switch(wa=this.Y2c(ma,na,"Succeeded"),ma.input.source){case 5:w.a.instance.Ua(51663494,1,4,wa);break;default:w.a.instance.Ua(4059162,1,4,wa)}}lEn(wa,ma){ma=this.Y2c(wa,ma,"Timeout");switch(wa.input.source){case 5:w.a.instance.Ua(51663495,
1,4,ma);break;default:w.a.instance.Ua(4059163,1,2,ma)}}hEn(wa,ma){ma=this.Y2c(wa,ma,"Rejection");switch(wa.input.source){case 5:w.a.instance.Ua(51663496,1,4,ma);break;default:w.a.instance.Ua(4059164,1,2,ma)}}kEn(wa,ma){ma=this.Y2c(wa,ma,"Crash - Rejection");switch(wa.input.source){case 5:w.a.instance.Ua(51663497,1,4,ma);break;default:w.a.instance.Ua(4059165,1,2,ma)}}iEn(wa,ma){ma=this.Y2c(wa,ma,"Crash - Failed");switch(wa.input.source){case 5:w.a.instance.Ua(51663498,1,4,ma);break;default:w.a.instance.Ua(4059166,
1,2,ma)}}Y2c(wa,ma,na){const Fa=wa.output.XL,Qa=Fa&&Fa.length?Fa.sg(Fa.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",wa.input.BVb,na,this.GKa()-wa.input.X_a,ma,Fa?Fa.length:0,Qa?Qa.id:z.a.nil,Qa?Qa.KJ?Qa.KJ.id:z.a.nil:z.a.nil,wa.input.source)}wHl(wa,ma,na,Fa,Qa,ya,ta){const Aa=new P.a,oa=Aa.input;oa.cda=wa;oa.k1a=ma;oa.pl=na;oa.xma=Fa;oa.LRb=Qa;oa.source=
ya;oa.o0c=ta;oa.X_a=this.GKa();Aa.logger.xYo(oa.X_a);wa=Aa.runtime;wa.zpd=w.a.instance.A4(1,5);wa.Aze=w.a.instance.A4(1,4);let za="";wa.dJ=ja=>{if(this.yrc){var fa=this.GKa()-oa.X_a,Ca=fa>this.yrc;za+=String.format(" ({0}: {1})",ja,fa);Ca&&(Aa.output.timeout=!0,ja=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",oa.BVb,this.yrc,ja,fa,za),w.a.instance.Ua(528061012,1,2,ja),this.Ajp(ja))}};return Aa}P3c(){return[Object(M.a)(this,
this.k6n,"otherAuthorsHaveChangesToMerge"),Object(M.a)(this,this.Zkn,"isInputValid"),Object(M.a)(this,this.B7m,"initializeOutputMergeState"),Object(M.a)(this,this.Zbe,"initializeRuntimeMergeState"),Z.a.Mdo,Object(M.a)(this.t2h,this.t2h.fLn,"mergeChildNodeLists"),Object(M.a)(this,this.Npp,"tryObjectMerge"),Z.a.kdo,Object(M.a)(this,this.$7l,"finalizeObjectMerge"),Object(M.a)(this,this.mDp,"validateMarkers"),Object(M.a)(this,this.AXk,"addMergeResultsToOutput")]}k6n(wa){const ma=wa.input.cda;wa=wa.output;
return ma?ma.length?!0:(w.a.instance.Ua(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),wa.XL=ma,wa.succeeded=!0,!1):(w.a.instance.Ua(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),wa.XL=ma,wa.succeeded=!0,!1)}Zkn(wa){var ma=wa.input;const na=ma.cda,Fa=ma.k1a,Qa=ma.pl,ya=ma.xma;ma=ma.LRb;wa=wa.output;if(!Fa||!Fa.length)return w.a.instance.Ua(42350233,1,5,"IsInputValid: No local changes to merge."),wa.XL=na,wa.succeeded=
!0,!1;let ta=!0;if(2!==ya&&1!==ya)return wa.XL=na,!1;Qa&&Qa!==z.a.nil||(ta=!1);na.length<(ma?2:1)&&(w.a.instance.Ua(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",ma),ta=!1);ta||(wa.XL=2===ya?na:Fa);return ta}Zbe(wa){var ma=wa.input,na=ma.cda,Fa=ma.k1a,Qa=ma.xma,ya;let ta;({KIg:ya,MPg:ta,dJa:ma}=this.mLf(wa,na,Fa,ma.LRb));if(!ma)return w.a.instance.Ua(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",
ya.id,ta.id),wa.logger.Oi(Object.assign(new Y.a,{$j:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.uaj(ya,na.length,"TheirChanges"),this.uaj(ta,Fa.length,"YourChanges"),wa.output.XL=2===Qa?na:Fa,!1;wa.runtime.dJa=ma;({Crp:na,Z5l:Fa}=this.RSl(Qa,ya,ta));({Drp:ma,$5l:Qa,Mbl:ya}=this.hAm(wa,na,Fa,ma));wa.runtime.In=ya;wa.runtime.sv=ma;wa.runtime.NA=Qa;wa.runtime.Yq=new A.a;wa.runtime.O2d=Fa.id;wa.runtime.GEe=na.id;wa.runtime.kvb=new A.a;wa.runtime.oUa=
new x.a;wa.runtime.Awf=new A.a;wa.runtime.Axl=new A.a;wa.runtime.tgp=new A.a;wa.runtime.Bte=new aa;wa.runtime.fke=new u.a;wa.runtime.vjg=new x.a;wa.runtime.syc=new u.a;wa.runtime.rc=wa.input.o0c(wa);wa.runtime.rc.ISc(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",f.a.qip);wa.runtime.rc.ISc(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",f.a.Ekp);wa.runtime.rc.ISc(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",
f.a.F5l);wa.runtime.rc.ISc(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",f.a.$xo);wa.runtime.rc.ISc(1000010,"Microsoft.Office.WordOnline.MergeLcsInfLoopFix","79ee6190;i588c310",f.a.vLn);wa.runtime.sSi=!0;D.AFrameworkApplication.K&&(this.prh=D.AFrameworkApplication.K.ic("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}uaj(wa,ma,na){const Fa=new u.a;for(;wa;)Fa.add(wa),wa=wa.KJ;const Qa=new Sys.StringBuilder;Qa.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",
na,ma,Fa.length));let ya=Fa.length,ta=0;Fa.forEach(Aa=>({aQi:ya,Qaj:ta}=this.pZk(Qa,Aa,Fa,ya,ta)).returnValue);w.a.instance.Ua(4273302,1,4,Qa.toString())}pZk(wa,ma,na,Fa,Qa){wa.append(String.format(" [{0} {1} {2}]",Fa,ma.dma?"S":"B",ma.id));Fa--;Qa++;return 50<Qa&&na.length!==Qa?(wa.append(" ...Truncated."),{returnValue:!1,aQi:Fa,Qaj:Qa}):{returnValue:!0,aQi:Fa,Qaj:Qa}}mLf(wa,ma,na,Fa){ma=ma.sg(ma.length-1-(Fa?1:0));na=na.sg(na.length-1);Fa=ma.PVa(na);wa.runtime.dJ("GetCommonBase");wa.logger.qbb("GetCommonBase");
return{KIg:ma,MPg:na,dJa:Fa}}hAm(wa,ma,na,Fa){let Qa,ya;({result:Qa}=ma.CVb(Fa));wa.runtime.dJ("GetUnfavoredChanges");wa.logger.qbb("GetUnfavoredChanges");({result:ya}=na.CVb(Fa));5===wa.input.source&&(wa.runtime.c6l=V.a.$Fi(na),wa.runtime.Frp=V.a.$Fi(ma));wa.runtime.dJ("GetFavoredChanges");wa.logger.qbb("GetFavoredChanges");ma=new F.a(Object(M.a)(Fa,Fa.QKa,"getMergeableObject"));wa.runtime.dJ("GetModifiedObjects");wa.logger.qbb("GetModifiedObjects");return{Drp:Qa,$5l:ya,Mbl:ma}}RSl(wa,ma,na){2===
wa?(wa=ma,ma=na):wa=na;return{Crp:ma,Z5l:wa}}B7m(wa){const ma=wa.input,na=ma.cda,Fa=ma.k1a;wa.output.XL=(2===ma.xma?na:Fa).wOa();wa.runtime.dJ("InitializeOutputMergeState");wa.logger.qbb("InitializeOutputMergeState");return!0}AXk(wa){var ma=wa.input.pl;const na=wa.runtime.Yq,Fa=wa.output.XL;ma=this.xHl(wa,Fa.sg(Fa.length-1),ma,z.a.create());this.y7l(wa,ma,na);Fa.add(ma);return wa.output.succeeded=!0}xHl(wa,ma,na,Fa){wa.runtime.Aze&&w.a.instance.Ua(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",
na,Fa);wa=this.lIo(Fa);wa.kWh(ma,na);return wa}y7l(wa,ma,na){wa.runtime.Aze&&w.a.instance.Ua(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",na.count);na.forEach((Fa,Qa)=>{ma.xRd(Qa.Fm);return!0})}Npp(wa){return this.j4j(wa,!1)}$7l(wa){return this.j4j(wa,!0)}j4j(wa,ma){const na=wa.runtime,Fa=na.In,Qa=na.NA,ya=ma?na.Awf:na.sv,ta=na.Yq;let Aa=!0;const oa=wa.runtime.zpd;let za=0,ja=0,fa=0;ya.forEach((Ca,xa)=>{oa&&w.a.instance.Ua(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",
Ca,xa.yc,ma);ja++;this.prh===ja&&(za++,wa.runtime.dJ(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",za,fa,ma)),ja=0);if(wa.runtime.rc&&wa.runtime.rc.yrb(1000005)&&wa.runtime.syc.contains(xa.id,(Ea,Ja)=>Ea.equals(Ja))||this.x9o(xa.yc))return!0;if(!ma&&this.qPl(xa.yc,wa.runtime.rc))return na.Awf.Z(Ca,xa),!0;var ua=Qa.get(Ca);if(!ua)return ta.mb(Ca)?ta.J(Ca).gej(xa):ta.Z(Ca,new X.a(xa,!1)),!0;if(!Fa.J(Ca)&&!this.YLn(ua.yc)){var sa=!!wa.input.cda&&!!wa.input.cda.last()&&
wa.input.cda.last().J3(Ca);const Ea=!!wa.input.k1a&&!!wa.input.k1a.last()&&wa.input.k1a.last().J3(Ca),Ja=new T.a(ua,xa);if(!Ja.B3)return ta.Z(Ca,new X.a(ua,!1)),!0;w.a.instance.Ua(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",Ca,xa.yc,ma,sa,Ea,!Ja.B3,wa.input.source);wa.logger.Oi(Object.assign(new Y.a,{$j:"GraphMerger.TryObjectMerge",
eventId:"ap3k8"}));return Aa=!1}sa=ta.l3(Ca,new X.a(Fa.J(Ca)));({Rl:ua,returnValue:Aa}=this.fTm.merge(wa,this.NLi,this.gf,sa,ua,xa));fa++;Aa&&(wa.runtime.dJ(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",Ca,xa.yc,fa,za,ma)),ua&&(ta.mb(ua.Fm.id)?ta.J(ua.Fm.id).gej(ua.Fm):ta.Z(ua.Fm.id,ua)));return Aa});wa.logger.qbb("ObjectMerge");oa&&w.a.instance.Ua(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",ya.count,
fa,ma);return Aa}mDp(wa){try{for(let ma=0;ma<wa.runtime.fke.length;ma++){const na=wa.runtime.fke.J(ma);if(wa.runtime.Yq.J(na)){if(!this.nmn(wa,na))return!1}else w.a.instance.Ua(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");wa.runtime.dJ("Validate markers taking too long")}}catch(ma){w.a.instance.Ua(559535579,1,2,"ValidateMerge threw an exception: {0}",ma)}return wa.logger.Vcd.MNi()?!1:!0}o4o(wa){return 38===wa||39===wa||40===wa||41===wa||44===wa||45===wa||33===wa||34===wa?!1:
!0}uzm(wa){switch(wa){case 38:case 39:case 40:case 41:return a.a.pe;case 44:case 45:return a.a.TTd;case 33:case 34:return a.a.nk}return I.CommonProperties.nil}lDp(wa,ma){const na=this.gf.getPropertyUint32(wa,a.a.mt);if(!na||this.o4o(na))return!0;wa=this.gf.getPropertyObjectId(wa,this.uzm(na));return ia.fkc(ma,wa)?!0:(ma.logger.Vcd.Oce=na,!1)}nmn(wa,ma){if(wa.runtime.vjg.contains(ma))return!1;if(ma=ia.fkc(wa,ma)){ma=this.gf.getPropertyObjectIds(ma,l.a.Vn);for(let na=0;na<ma.length;na++){const Fa=ia.fkc(wa,
ma.sg(na));if(Fa&&!this.lDp(Fa,wa))return!1}}return!0}x9o(wa){switch(wa){case m.a.tIa:case m.a.ldc:case m.a.mKb:case m.a.idc:case m.a.DPa:case m.a.owa:return!0}return!1}qPl(wa,ma){let na=!1;if(wa===m.a.Ud)return!0;ma&&ma.JF(119);ma&&ma.isFeatureEnabled(119)&&wa===m.a.Kmb&&(na=!0);return na}YLn(wa){switch(wa){case m.a.zzc:return!0}return!1}MJl(wa,ma){const na=new u.a,Fa=new u.a,Qa=new u.a;var ya=wa.runtime.dJa;const ta=ya?ya.id:z.a.nil;this.z4f(ya).forEach(Aa=>{na.add(ma(Aa));return!0});ya=wa.input.cda.sg(wa.input.cda.length-
1);this.z4f(ya,ta).forEach(Aa=>{Fa.add(ma(Aa));return!0});wa=wa.input.k1a.sg(wa.input.k1a.length-1);this.z4f(wa,ta).forEach(Aa=>{Qa.add(ma(Aa));return!0});return{Lbl:na,$ip:Fa,ZJp:Qa}}z4f(wa,ma=null){const na=new u.a;ma||(ma=z.a.nil);for(;wa&&!ma.equals(wa.id);)na.add(wa),wa=wa.KJ;na.reverse();return na}Zep(wa){const ma=3===this.H$d;let na=!1;!wa.output.succeeded&&(2===this.H$d||wa.output.fAa&&1===this.H$d)&&(na=!0);let Fa=!1;wa.input.cda&&0<wa.input.cda.length&&(ma||na)&&wa.runtime.NA&&wa.runtime.In&&
wa.runtime.rc&&(Fa=wa.runtime.rc.isFeatureEnabled(48));return Fa}FVi(wa){return 9===U.a.lrb(U.a.TFf(wa))}j0i(wa){return 8===U.a.lrb(U.a.TFf(wa))}static Wtm(wa){return wa.output.fAa?2:wa.output.succeeded?3:1}static fkc(wa,ma){if(!ma||ma===z.a.nil)return null;const na=wa.runtime.Yq.J(ma);return na?na.Fm:wa.runtime.In.J(ma)}}ia.F$d=z.a.Cf("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");Object(G.a)(ia,"GraphMergerBase",null,[995])},1888:function(G,J,d){G=d(0);var m=d(77),f=d(1567),a=d(1704),l=d(1626),w=
d(1587),y=d(1640),v=d(1569),u=d(1572),x=d(1571),z=d(1565),A=d(1563);class D{constructor(P){this.kc=P;this.MNd=this.COf()}sN(){return"Add-ins"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:3}hK(P,T){P=new x.a(P);T.Ot(P)}Grb(P,T,Z){let X;X=this.kc.uS?new u.a(29):new u.a(27);X.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;Z&&this.e8o(P.Yg,T,X)}e8o(P,T,Z){const X=[];let aa;aa=this.kc.pdn?this.kc.uS&&this.kc.vmb?A.a.tqb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,
P)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,P):this.kc.qdn?this.kc.uS&&this.kc.vmb?A.a.tqb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,P)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,P):this.kc.uS&&this.kc.vmb?A.a.tqb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,P)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,P);this.kc.KBa?(z.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",
aa)),z.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",P))):(X.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",aa)),X.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",P)),appChrome.api.dispatch(X));Z.hy(new v.a("LaunchAddinDialogFromTellMe",29));T.aw(Z)}COf(){const P=[];this.kc.lde&&Array.add(P,"Addin");return P}}Object(G.a)(D,"AddinStoreResultsProvider",null,[1003]);var F=d(1838),I=d(1614),
H=d(1627),N=d(1839),M=d(1880),U=d(1840),O=d(1639),V=d(2),Y=d(34),Q=d(123);d.d(J,"a",function(){return S});class S{constructor(P,T,Z){this.blb=this.SPc=this.TPc=this.SMd=!1;this.nT=null;this.A5=-1;this.g5a=this.OQc=this.rja=this.CIb=null;this.Gsh=this.Psh=0;this.kc=P;const X=A.a.Vta();this.fib=T||[];this.Af=V.AFrameworkApplication.Be;this.qFh=P.fig;this.UPc=P.eig;this.QMd=X&&this.B0b();this.RMd=X&&this.C0b();this.sFh=X&&this.D0b();this.UMd=this.E0b();this.e9e=this.Rxc();if((T=P.vGg&&A.a.hCg(P))||P.Hka)this.CIb=
new M.a(P),this.SMd=P.Ard;T&&(this.TPc=P.Crd,this.SPc=P.Ptb,this.blb=this.SMd&&this.Ay("File")||this.TPc&&this.Ay("People")||this.SPc&&this.Ay("Notes"));this.PMd=this.L3o();this.WPc=P.igd;this.TMd=this.e4o();this.d9e=this.K3o();this.wac=this.uze();this.sda=this.RNm();this.H9g=new F.a(P);this.ezk=new N.a(P);this.dQk=new U.a(P);this.Vmk=new D(P);this.HOc=Z;this.THb=new a.a;this.WPc&&(this.H9g=new F.a(P));P.Hka&&(this.d9e=this.TMd=this.WPc=this.blb=this.SPc=this.TPc=this.e9e=this.UMd=this.sFh=this.RMd=
this.QMd=this.UPc=!1,V.AFrameworkApplication.K&&this.Ay("File")&&this.HTj()||this.wac)&&(P=this.THb.pPf("Search",V.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")),this.q0c(P,"TellMeService",!0),P=this.THb.pPf("SmartLookup",V.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")),this.q0c(P,"Shredder",!1));V.AFrameworkApplication.K&&this.blb&&this.Ay("File")&&this.HTj()&&(P=this.THb.pPf("Search",V.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")),this.q0c(P,
"TellMeService",!0))}Ay(P){return Array.contains(this.fib,P)?!0:!1}sN(){return"TellMeService"}kX(){return 0===this.kc.hw?0:1===this.kc.hw?1:this.Ay("Command")||this.Ay("Recommended")?2:3}ONm(P){let T="";if(!P&&this.Ay("Command")&&this.kc.q_f){T+="CommandSearch_DLIS,";var Z=this.kc.a0j;0<Z.length&&(T+=Z+",")}P&&this.Ay("Recommended")&&this.UPc&&(Z=this.VRm(),0<Z.length&&(T+=Z+","));!P&&this.Ay("Help")&&(P=this.kc.$_j,0<P.length&&(T+=P+","));this.kc.Hka&&this.g5a&&0<this.g5a.length&&(T+="IsRecallEnabled_true,");
(this.kc.Qhc||this.kc.m1d||this.kc.Hka)&&this.blb&&(T+="IsGenerateSlidesEnabled_true,");0<T.length&&(T=T.substr(0,T.length-1));return T}q0c(P,T,Z){const X=Z?this.Psh:this.Gsh;if(!X||window.performance.now()-X>=A.a.jfb)if(P)Z?this.Psh=window.performance.now():this.Gsh=window.performance.now(),P.then(aa=>{Z?this.OQc=aa:(this.g5a=aa,z.TellMeActor.instance.jEg=aa)},aa=>{z.TellMeActor.instance.Ye.onError("TellMeServiceProvider:FetchTokenForService_"+T,"tellMeServiceToken promise rejected: "+aa)});else if(z.TellMeActor.instance.Ye)z.TellMeActor.instance.Ye.onError("TellMeServiceProvider:FetchTokenForService_"+
T,"undefined token promise")}hK(P,T,Z,X=f.a.su,aa=null){const ia=new x.a(P);Z=A.a.EU(P);this.Ay("File")&&(this.blb||this.kc.Hka)&&this.q0c(this.THb.SNm(),"TellMeService",!0);(this.Ay("File")&&this.kc.Hka||this.Ay("ActionAI")&&this.wac)&&this.q0c(this.THb.UKm(),"Shredder",!1);var wa=this.blb&&!!this.OQc;const ma=this.kc.Hka&&!!this.g5a;var na=wa||ma||Z&&this.Ay("Recommended")&&this.UPc;wa=wa||ma||!Z&&(this.qFh&&this.Ay("Command")||this.QMd&&this.Ay("Answer")||this.RMd&&this.Ay("Definition")||this.e9e&&
this.Ay("Image")||this.WPc&&this.Ay("Help")||this.UMd&&this.Ay("WolframAnswer")||this.TMd&&this.Ay("Template")||this.d9e&&this.Ay("Addin"));if(na||wa)if(this.rja=X,X={"Content-Type":"application/json",Accept:"application/json"},X["X-Office-Version"]=V.AFrameworkApplication.buildVersion,X["X-Office-Application"]=V.AFrameworkApplication.K.kb("Application"),X["X-Office-Platform"]="WAC",X["X-TellMe-SqmUserId"]=V.AFrameworkApplication.K.kb("LoggableUserId")||"",X["X-TellMe-SessionId"]=z.TellMeActor.instance.U9d(),
this.OQc&&(X.Authorization="Bearer "+this.OQc),this.g5a&&0<this.g5a.length&&(X["X-TellMe-ShredderToken"]="Bearer "+this.g5a),na=this.ONm(Z),0<na.length&&(X["X-TellMe-Flights"]=na),na=[],!Z&&this.Ay("Answer")&&this.QMd&&(aa?Array.contains(aa,9):1)&&Array.add(na,"Answer"),!Z&&this.Ay("Command")&&this.qFh&&!I.CommandResultsUtility.SXf(P.Yg)&&(aa?Array.contains(aa,17):1)&&Array.add(na,"Command"),!Z&&this.Ay("Definition")&&this.RMd&&(aa?Array.contains(aa,10):1)&&Array.add(na,"Definition"),!Z&&this.Ay("Help")&&
this.WPc&&(aa?Array.contains(aa,8):1)&&Array.add(na,"Help"),!Z&&this.Ay("WolframAnswer")&&this.UMd&&(aa?Array.contains(aa,12):1)&&Array.add(na,"WolframAnswer"),Z&&this.Ay("Recommended")&&this.UPc&&!z.TellMeActor.instance.hud&&(aa?Array.contains(aa,18):1)&&Array.add(na,"Recommended"),!Z&&this.Ay("Image")&&this.e9e&&(aa?Array.contains(aa,19):1)&&Array.add(na,"Image"),this.OQc&&this.blb&&(aa?Array.contains(aa,14)||Array.contains(aa,15)||Array.contains(aa,20):1)&&(this.CIb.bEa(),this.SMd&&this.Ay("File")&&
Array.add(na,"File"),this.TPc&&this.Ay("People")&&Array.add(na,"People"),this.SPc&&this.Ay("Notes")&&Array.add(na,"Notes")),this.g5a&&0<this.g5a.length&&this.kc.Hka&&(aa?Array.contains(aa,15):1)&&(this.CIb.bEa(),this.Ay("File")&&Array.add(na,"File")),!Z&&this.Ay("Template")&&this.TMd&&(aa?Array.contains(aa,23):1)&&Array.add(na,"Template"),!Z&&this.Ay("Addin")&&this.d9e&&(aa?Array.contains(aa,27):1)&&Array.add(na,"Addin"),!Z&&this.Ay("ActionAI")&&this.wac&&(aa?Array.contains(aa,25):1)&&Array.add(na,
"ActionAI"),na.length){X["X-TellMe-SuggestionTypes"]=na.join(",");X["X-TellMe-Culture"]=V.AFrameworkApplication.uiCulture;X["X-TellMe-ProcessSessionId"]=V.AFrameworkApplication.userSessionId;var Fa=this.nT=Q.a.create().toString();X["Client-Request-Id"]=Fa;var Qa=window.performance.now();this.VIa();this.A5=window.setTimeout(()=>{if(Fa===this.nT){this.nT="";this.A5=-1;T.Ot(ia);const ya={};ya[l.a.provider]=this.sN();ya[l.a.rYb]=P.Swb;z.TellMeActor.instance.Ye.gC(w.a.XIg,this.HOc,ya)}},this.HOc);this.Af.Ij(this.sda,
2,this.QNm(P.Yg),X,!1,0,ya=>{this.SWb(ya,P,T,Fa,Qa,aa)},ya=>{this.zWb(ya,P,T,Fa,Qa)},null,null,!1,4E3,this.wac?3E4:6E3)}else z.TellMeActor.instance.Ye.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),T.Ot(ia);else T.Ot(ia)}VIa(){-1!==this.A5&&(window.clearTimeout(this.A5),this.A5=-1)}SWb(P,T,Z,X,aa,ia){const wa=new x.a(T);if(X===this.nT){this.VIa();z.TellMeActor.instance.Ye.aca(T.Yg.length,this.fib.join(","),P.data.He.toString(),Math.round(window.performance.now()-aa),
O.a.su,!0,y.a.OWa);X=P.data.De;P=null;try{P=Y.b(X)}catch(ta){z.TellMeActor.instance.Ye.onError("OnSuccessCallBack","Exception occured while deserializing response:"+ta);return}X=A.a.EU(T);if("Groups"in P&&P.Groups){var ma=P.Groups;for(var na of ma)if("GroupType"in na&&"Suggestions"in na&&na.Suggestions)if("Commands"===na.GroupType&&(ia?Array.contains(ia,17):1)||"Recommended"===na.GroupType&&(ia?Array.contains(ia,18):1)){var Fa=(ma="Recommended"===na.GroupType)?"DLIS":"NaiveBayes";"Source"in na&&na.Source&&
(Fa=na.Source);var Qa=na.Suggestions;new m.a;var ya=[];for(const ta of Qa)this.stn(ta)&&(Qa=ta.Type,("Command"===Qa||ma&&"Recommended"===Qa)&&ya.push(new H.a(ta.CommandId,ta.Score)));I.CommandResultsUtility.Fie(ya,!T.Yg.trim().length,na.GroupType,Fa);Fa=z.TellMeActor.instance.a6;Qa=[];for(const ta of ya)ma&&Fa&&Fa.Hrf(ta.commandId)||Qa.push(ta);ya=I.CommandResultsUtility.z4c(T,Qa,this.kc,null,null,null,ma?18:17,0);0<ya.results.length&&(this.rja!==f.a.contextMenu&&(ya.displayName=ma?CommonUIStrings.l_TellMeTryCommandTitle:
CommonUIStrings.l_TellMeCommandProviderTitle),wa.aw(ya))}else if("Answer"===na.GroupType){Qa=na.Suggestions;ma=null;ya=2147483647;Fa="";for(const ta of Qa)if(this.qtn(ta))if(Fa=ta.Type,Qa=this.Z8d(Fa),"Answer"===Fa&&this.QMd){ma=this.Xai(Fa,ta,T.Yg);break}else Qa&&Qa<ya&&(ya=Qa,ma=this.Xai(Fa,ta,T.Yg));ya=A.a.nHo(T.Yg,Fa);ma&&(ia?Array.contains(ia,ma.type):1)&&(Fa=[],this.PMd?this.kc.KBa?(z.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ma.value,ma.DE)),z.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ma.value,
ma.description)),z.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ma.value,ya))):(Fa.push(appChrome.actions.setControlLabel(ma.value,ma.DE)),Fa.push(appChrome.actions.updateCompoundButtonDescription(ma.value,ma.description)),Fa.push(appChrome.actions.setCompoundButtonCommandValueId(ma.value,ya)),appChrome.api.dispatch(Fa)):this.kc.KBa?(z.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ma.value,ma.DE+" - "+ma.description)),z.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ma.value,
ya))):(Fa.push(appChrome.actions.setControlLabel(ma.value,ma.DE+" - "+ma.description)),Fa.push(appChrome.actions.setButtonCommandValueId(ma.value,ya)),appChrome.api.dispatch(Fa)),ya=this.UJl(ma.type),ya.hy(ma),wa.aw(ya))}else"Help"===na.GroupType&&na.Suggestions.length&&(ia?Array.contains(ia,8):1)?this.WPc&&(ma=this.H9g.Grb(T,na.Suggestions))&&0<ma.results.length&&wa.aw(ma):"Template"===na.GroupType&&(ia?Array.contains(ia,23):1)?(ma=na.Suggestions)&&0<ma.length&&this.dQk.Grb(T,wa,ma):"Addin"===na.GroupType&&
(ia?Array.contains(ia,27):1)?(ma=na.Suggestions)&&0<ma.length&&this.Vmk.Grb(T,wa,ma):"ActionAI"===na.GroupType&&(ia?Array.contains(ia,25):1)?(ya=na.Suggestions,ma=[],new u.a(25),ya&&1===ya.length&&(Fa=ya[0])&&Fa.CommandId&&(ya=Fa.CommandId,ma.push(new H.a(ya,"Score"in Fa?Fa.Score:0)),ma=I.CommandResultsUtility.z4c(T,ma,this.kc,null,null,null,25,0),ma.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,wa.aw(ma))):"Substrate"===na.GroupType&&this.blb&&"Type"in na?"File"===na.Type&&this.SMd&&
(ia?Array.contains(ia,15):1)?(ma=this.CIb.WJf(na.Suggestions,X,this.rja))&&0<ma.results.length&&(this.Bee()&&(ya=new v.a("GenerateSlidesFromTellMe",30,"",null,1),ma.hy(ya)),wa.aw(ma)):"People"===na.Type&&this.TPc&&(ia?Array.contains(ia,14):1)?(ma=this.CIb.BEi(na.Suggestions,X,this.rja))&&0<ma.results.length&&wa.aw(ma):"Notes"===na.Type&&this.SPc&&(ia?Array.contains(ia,14):1)&&(ma=this.CIb.jDi(na.Suggestions,X,T))&&0<ma.results.length&&wa.aw(ma):"Recall"===na.GroupType&&this.kc.Hka&&"Type"in na&&"IntentService"===
na.Type&&(ia?Array.contains(ia,15):1)&&(ma=this.CIb.WJf(na.Suggestions,X,this.rja))&&0<ma.results.length&&(this.Bee()&&(ya=new v.a("GenerateSlidesFromTellMe",30,"",null,1),ma.hy(ya)),wa.aw(ma));else z.TellMeActor.instance.Ye.onError("OnSuccessCallBack","GroupType"in na?"Invalid group suggestions found for "+na.GroupType:"Invalid group found")}if(P.Intents){na=P.Intents;for(const ta of na)this.T1f(ta)&&("Image"===ta.GroupType&&ta.ConfidenceScore>ta.ConfidenceThreshold&&(ia?Array.contains(ia,19):1)?
this.ezk.Grb(T,wa,0,ta):"Commands"===ta.GroupType&&ta.ConfidenceScore<ta.ConfidenceThreshold&&(ia?Array.contains(ia,17):1)&&(na=new u.a(17),wa.aw(na)))}Z.Ot(wa);z.TellMeActor.instance.Ye.aca(T.Yg.length,this.fib.join(","),"",Math.round(window.performance.now()-aa),"",!0,y.a.provider)}}zWb(P,T,Z,X,aa){const ia=new x.a(T);X===this.nT&&(this.VIa(),z.TellMeActor.instance.Ye.aca(T.Yg.length,this.fib.join(","),P.data.He.toString(),Math.round(window.performance.now()-aa),O.a.su,!1,y.a.OWa));Z.Ot(ia)}Z8d(P){switch(P){case "Entity":return this.sFh?
3:0;case "Definition":return this.RMd?5:0;case "WolframAnswer":return this.UMd?2:0;default:return 0}}Xai(P,T,Z){switch(P){case "Answer":return new v.a(this.PMd?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===T.Title?Z:T.Title,T.Description,0);case "Entity":return new v.a(this.PMd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===T.Title?Z:T.Title,T.Description,0);case "Definition":return new v.a(this.PMd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===T.Title?Z:T.Title,T.Description,
0);case "WolframAnswer":return new v.a("WolframForSearch",3,""===T.Title?Z:T.Title,T.Description,0);default:return null}}UJl(P){switch(P){case 0:return new u.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new u.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new u.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new u.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new u.a(19,this.kc.Nxc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);
default:return null}}qtn(P){return"Type"in P&&!!P.Type&&""!==P.Type&&"Description"in P&&!!P.Description&&""!==P.Description}stn(P){return"Type"in P&&!!P.Type&&""!==P.Type&&"CommandId"in P&&!!P.CommandId&&""!==P.CommandId&&"Score"in P&&!!P.Score}T1f(P){if("GroupType"in P&&P.GroupType&&"ConfidenceScore"in P&&"ConfidenceThreshold"in P)return!0;z.TellMeActor.instance.Ye.onError("IsValidIntentGroup","Invalid intents found");return!1}QNm(P){const T=A.a.H2i(P),Z={};Z.Query=P;T&&this.UPc&&(this.Tmn()?Z.UserActionEvents=
z.TellMeActor.instance.eKh:(Z.CommandClickedEvents=z.TellMeActor.instance.MNe,Z.CommandActionEvents=z.TellMeActor.instance.Xbh),Z.TellMeCommandClickMruEvents=z.TellMeActor.instance.Evh,Z.ContentType=z.TellMeActor.instance.EZd);this.TMd&&(P={},P.Application=this.kc.application,Z.TemplateInfo=P);return Y.c(Z)}B0b(){return!!this.kc&&this.kc.B0b||!!V.AFrameworkApplication.ua&&V.AFrameworkApplication.ua.Ib.B0b}C0b(){return!!this.kc&&this.kc.C0b||!!V.AFrameworkApplication.ua&&V.AFrameworkApplication.ua.Ib.C0b}D0b(){return!!this.kc&&
this.kc.D0b||!!V.AFrameworkApplication.ua&&V.AFrameworkApplication.ua.Ib.D0b}E0b(){return!!this.kc&&this.kc.E0b||!!V.AFrameworkApplication.ua&&V.AFrameworkApplication.ua.Ib.E0b}Rxc(){return!!this.kc&&(this.kc.Rxc||this.kc.uS)}L3o(){return!!this.kc&&!this.kc.Pab}e4o(){return!!this.kc&&this.kc.nad}K3o(){return!!this.kc&&this.kc.rdn&&this.kc.odn}uze(){return!!this.kc&&this.kc.uze}q3i(){return!!V.AFrameworkApplication.K&&V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",
!1)}r3i(){return!!V.AFrameworkApplication.K&&V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}Tmn(){return!!V.AFrameworkApplication.K&&V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}Bee(){return!!V.AFrameworkApplication.K&&V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}HTj(){return!!V.AFrameworkApplication.K&&
V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}VRm(){return V.AFrameworkApplication.K?V.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}RNm(){if(!V.AFrameworkApplication.K)return"";if(this.r3i())return V.AFrameworkApplication.K.kb("TellMeServiceProdEndpointForSearch");if(this.q3i())return V.AFrameworkApplication.K.kb("TellMeServiceEdogEndpointForSearch");if(A.a.wYf())return V.AFrameworkApplication.K.kb("TellMeServiceIntEndpointForSearch");
let P=V.AFrameworkApplication.K.kb("TellMeServiceSearchEndpoint");P&&""!==P||(P=V.AFrameworkApplication.Z_j);return P}static Abi(P,T){if(T)return new S(P,["Command","Recommended"],P.Grm);T=A.a.Vta()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new S(P,T,P.zHi)}}Object(G.a)(S,"TellMeServiceProvider",null,[1003])},1893:function(G,J,d){G=d(0);var m=d(233),f=d(1712),a=
d(196),l=d(1625);class w extends f.a{constructor(v,u,x,z,A,D,F,I,H,N,M,U,O,V){super(v,3,u,x,z,A,D,I,H,N,M,U,O,V);this.TMe=F}get character(){return this.TMe}get text(){return this.character.toString()}Yod(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}Bjc(){return"CharRun"}clone(){return new w(this.WSc,this.source,this.wk,this.Rg,this.runId,this.yL,this.character,this.gvb,this.JXa,this.Rfa,this.cLa,this.zZa,this.iA,this.Xu)}$B(v,u,x,z=!1){return super.$B(v,u,
x,z)?v.character===this.character?!0:l.a.pUh(v.character,this.character):!1}}Object(G.a)(w,"CharRunMergeBlock",f.a,[]);d.d(J,"a",function(){return y});class y extends f.a{constructor(v,u,x,z,A,D,F,I,H,N,M,U,O,V,Y){super(v,1,u,x,z,A,D,I,N,M,U,O,V,Y);this._text=F;this.N$e=H}get text(){return this._text}Yod(v){this._text=v}get Reb(){return this.N$e&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",super.toString(),this.N$e)}Bjc(){return"TextRun"}clone(){return new y(this.WSc,
this.source,this.wk,this.Rg,this.runId,this.yL,this._text,this.gvb,this.N$e,this.JXa,this.Rfa,this.cLa,this.zZa,this.iA,this.Xu)}$B(v,u,x,z=!1){return super.$B(v,u,x,z)?l.a.oUh(this._text,v._text):!1}wqd(){const v=new m.a;for(let x=0;x<this.text.length;x++){var u=l.a.charAt(this._text,x);if(l.a.asn(l.a.qkp(u))){let z="";z+=u;u=l.a.charAt(this._text,++x);z+=u;u=new y(this.WSc,this.source,this.wk,this.Rg,this.runId,this.yL,z,this.gvb,!1,this.JXa,this.Rfa,this.cLa,this.zZa,this.iA,this.Xu);v.add(u)}else u=
new w(this.WSc,this.source,this.wk,this.Rg,this.runId,this.yL,u,this.gvb,this.JXa,this.Rfa,this.cLa,this.zZa,this.iA,this.Xu),v.add(u)}return v}}Object(G.a)(y,"TextRunMergeBlock",f.a,[])},1894:function(G,J,d){G=d(0);var m=d(286),f=d(43),a=d(16),l=d(5),w=d(125),y=d(864),v=d(192),u=d(233),x=d(381),z=d(1559);class A{constructor(I,H,N){this.position=I;this.leader=H;this.val=N}equals(I){return this.position===I.position&&this.leader===I.leader&&this.val===I.val}toString(){return this.position.toString()}}
Object(G.a)(A,"TabStop",null,[]);var D=d(2009);d.d(J,"a",function(){return F});class F extends z.a{constructor(){super();this.ePd=null}get Eo(){return 20}get emp(){return this.ePd?this.ePd:this.ePd=new Set([y.a.yb(f.a.dXa),y.a.yb(f.a.YUa),y.a.yb(f.a.z0a)])}get NB(){return 0}Yk(){const I=super.Yk();I.Z(y.a.yb(a.a.Un),1);I.Z(y.a.yb(a.a.Vn),1);I.Z(y.a.yb(a.a.zn),1);I.Z(y.a.yb(l.a.Nt),1);I.Z(y.a.yb(l.a.Kq),1);I.Z(y.a.yb(l.a.Yc),1);I.Z(y.a.yb(a.a.Yyb),1);I.Z(y.a.yb(l.a.uWa),1);I.Z(y.a.yb(l.a.xNa),1);I.Z(y.a.yb(a.a.dDa),
1);I.Z(y.a.yb(l.a.xLa),1);I.Z(y.a.yb(l.a.wka),1);I.Z(y.a.yb(l.a.yLa),1);I.Z(y.a.yb(l.a.KJa),1);I.Z(y.a.yb(l.a.zLa),1);I.Z(y.a.yb(l.a.LJa),1);I.Z(y.a.yb(l.a.wNa),1);I.Z(y.a.yb(l.a.lPa),1);I.Z(y.a.yb(l.a.mPa),1);I.Z(y.a.yb(l.a.ZEa),1);I.Z(y.a.yb(l.a.Fw),1);I.Z(y.a.yb(f.a.dXa),1);I.Z(y.a.yb(f.a.YUa),1);I.Z(y.a.yb(f.a.z0a),1);I.Z(y.a.yb(l.a.bB),1);I.Z(y.a.yb(l.a.cB),1);I.Z(y.a.yb(l.a.Jx),1);I.Z(y.a.yb(w.a.kna),6);I.Z(y.a.yb(w.a.lK),6);I.Z(y.a.yb(w.a.f1a),6);I.Z(y.a.yb(l.a.HLb),7);I.Z(y.a.yb(w.a.lK),6);
I.Z(y.a.yb(l.a.gWj),2);I.Z(y.a.yb(w.a.ozl),2);I.Z(y.a.yb(w.a.y8n),2);I.Z(y.a.yb(l.a.rAc),2);I.Z(y.a.yb(l.a.ysd),2);I.Z(y.a.yb(l.a.Z1b),2);I.Z(y.a.yb(l.a.pfb),2);I.Z(y.a.yb(l.a.zsd),2);I.Z(y.a.yb(l.a.Asd),2);I.Z(y.a.yb(l.a.$5f),2);I.Z(y.a.yb(l.a.listID),3);I.Z(y.a.yb(l.a.listLevel),3);return I}OD(I,H){var N=I.lu.runtime.rc,M=N.isFeatureEnabled(113);if(H===y.a.yb(a.a.Un)||H===y.a.yb(a.a.Vn)||H===y.a.yb(a.a.zn)||H===y.a.yb(l.a.Nt)||H===y.a.yb(l.a.Kq)||H===y.a.yb(l.a.Yc)||H===y.a.yb(a.a.Yyb)||H===y.a.yb(l.a.uWa)||
H===y.a.yb(l.a.xNa)||H===y.a.yb(a.a.dDa)||H===y.a.yb(l.a.xLa)||H===y.a.yb(l.a.wka)||H===y.a.yb(l.a.yLa)||H===y.a.yb(l.a.KJa)||H===y.a.yb(l.a.zLa)||H===y.a.yb(l.a.LJa)||H===y.a.yb(l.a.wNa)||H===y.a.yb(l.a.lPa)||H===y.a.yb(l.a.mPa)||H===y.a.yb(l.a.ZEa)||H===y.a.yb(l.a.Fw)||H===y.a.yb(l.a.gQ)||this.QLn(H,M)){var U=I.Wo.value.Ov;M=I.Wo.value.Jf;H=I.jh.value.Jf;if(I.lu.runtime.oUa.contains(U.id))return v.a.instance.Ua(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",
U.id),!0;if(N.yrb(1000005)&&this.F9o(I,H,M))return I.Rl=H.WO(),F.UNh(I),F.FRd(I.lu,I.gf,M),!0;N=new u.a;N.add(U);U=new u.a;U.add(M);M=new u.a;M.add(H);if(!({Yq:H}=F.n4j(I.lu,N,M,U)).returnValue)return I.OOg=!0,I.Rl=null,!1;F.UNh(I);I.Rl=H.sg(0).Fm;return!0}return H===y.a.yb(l.a.bB)||H===y.a.yb(l.a.cB)||H===y.a.yb(l.a.Jx)?(this.vop(I),I.Xg.add(y.a.yb(l.a.bB)),I.Xg.add(y.a.yb(l.a.cB)),I.Xg.add(y.a.yb(l.a.Jx)),!0):!1}F9o(I,H,N){H=I.gf.getPropertyString(H,l.a.gQ);I=I.gf.getPropertyString(N,l.a.gQ);return H||
I?!0:!1}vop(I){const H=I.gf,N=I.Rl;var M=I.Wo.value.Jf,U=I.jh.value.Jf;I=this.cJf(I.Wo.value.Ov,H);U=this.cJf(U,H);M=this.cJf(M,H);({bMn:M,cMn:I,dMn:U}=this.Ozm(I,U,M));M.length?(H.setPropertyUint32s(N,l.a.Jx,M),H.setPropertyUint32s(N,l.a.bB,I),H.setPropertyUint32s(N,l.a.cB,U)):this.Mxo(N)}cJf(I,H){const N=H.getPropertyUint32s(I,l.a.Jx),M=H.getPropertyUint32s(I,l.a.bB);I=H.getPropertyUint32s(I,l.a.cB);H=new u.a;if(!N)return H;for(let U=0;U<N.length;++U)H.add(new A(N.J(U),M.J(U),I.J(U)));return H}Ozm(I,
H,N){({jqj:H,kqj:V,lqj:O}=this.axi(I,H));let M,U;({jqj:N,kqj:M,lqj:U}=this.axi(I,N));I=this.NUm(I,V,O,M,U);var O=this.MUm(I,H,N);I=new u.a;H=new u.a;var V=new u.a;for(N=0;N<O.length;++N)I.add(O.J(N).position),H.add(O.J(N).leader),V.add(O.J(N).val);return{bMn:I,cMn:H,dMn:V}}axi(I,H){let N,M,U;N=new u.a;M=new x.a;U=new x.a;let O,V;for(O=V=0;O<I.length&&V<H.length;)I.J(O).position===H.J(V).position?(I.J(O).equals(H.J(V))||U.Z(I.J(O).position,H.J(V)),++O,++V):I.J(O).position<H.J(V).position?(M.Z(I.J(O).position,
I.J(O)),++O):(N.add(H.J(V)),++V);for(;O<I.length;)M.Z(I.J(O).position,I.J(O)),++O;for(;V<H.length;)N.add(H.J(V)),++V;return{jqj:N,kqj:M,lqj:U}}NUm(I,H,N,M,U){const O=new u.a;for(let V=0;V<I.length;++V){const Y=I.J(V).position;H.mb(Y)||(N.mb(Y)?O.add(N.J(Y)):M.mb(Y)||(U.mb(Y)?O.add(U.J(Y)):O.add(I.J(V))))}return O}MUm(I,H,N){H=this.eej(H,N);return this.eej(I,H)}eej(I,H){const N=new u.a;let M,U;for(M=U=0;M<I.length&&U<H.length;)I.J(M).position<=H.J(U).position?(N.add(I.J(M)),I.J(M).position===H.J(U).position&&
++U,++M):N.add(H.J(U++));for(;M<I.length;)N.add(I.J(M++));for(;U<H.length;)N.add(H.J(U++));return N}Mxo(I){I.removeProperty(l.a.Jx);I.removeProperty(l.a.bB);I.removeProperty(l.a.cB)}static Eh(){return new F}static get instance(){return F.ih.value}static UNh(I){I.Xg.add(y.a.yb(a.a.Un));I.Xg.add(y.a.yb(a.a.Vn));I.Xg.add(y.a.yb(a.a.zn));I.Xg.add(y.a.yb(l.a.Nt));I.Xg.add(y.a.yb(l.a.Kq));I.Xg.add(y.a.yb(l.a.Yc));I.Xg.add(y.a.yb(a.a.Yyb));I.Xg.add(y.a.yb(l.a.uWa));I.Xg.add(y.a.yb(l.a.xNa));I.Xg.add(y.a.yb(a.a.dDa));
I.Xg.add(y.a.yb(l.a.xLa));I.Xg.add(y.a.yb(l.a.wka));I.Xg.add(y.a.yb(l.a.yLa));I.Xg.add(y.a.yb(l.a.KJa));I.Xg.add(y.a.yb(l.a.zLa));I.Xg.add(y.a.yb(l.a.LJa));I.Xg.add(y.a.yb(l.a.wNa));I.Xg.add(y.a.yb(l.a.lPa));I.Xg.add(y.a.yb(l.a.mPa));I.Xg.add(y.a.yb(l.a.ZEa));I.Xg.add(y.a.yb(l.a.Fw));I.Xg.add(y.a.yb(l.a.gQ))}static n4j(I,H,N,M){return(new D.a(I,H,N,M)).DAc()}static FRd(I,H,N){N=H.getPropertyObjectIds(N,a.a.Vn);for(let U=0;U<N.length;U++){var M=I.runtime.sv.J(N.sg(U));if(M&&(M=H.getPropertyObjectId(M,
l.a.pe))){I.runtime.syc.add(M);break}}}QLn(I,H){return H?this.emp.has(I)?!0:!1:!1}}F.ih=new m.a(F.Eh);Object(G.a)(F,"ParagraphNodeComplexMerge",z.a,[])},2008:function(G,J,d){d.r(J);d.d(J,"MarkerValidation",function(){return a});G=d(0);var m=d(381),f=d(1824);class a{constructor(){this.Oce=this.zUi=this.yUi=this.xUi=0}txi(){const l=new m.a(0);l.Z("InvalidBookmarks",this.xUi);l.Z("InvalidComments",this.yUi);l.Z("InvalidContentControls",this.zUi);0!==this.Oce&&l.Z("InvalidMarkerType",this.Oce);return l}MNi(){return 0<
this.xUi||0<this.yUi||0<this.zUi||0!==this.Oce?!0:!1}toString(){return JSON.stringify(f.a.i1a(this.txi()))}}Object(G.a)(a,"MarkerValidation",null,[])},2009:function(G,J,d){d.d(J,"a",function(){return y});G=d(0);var m=d(192),f=d(1134),a=d(257),l=d(1743),w=d(1645);class y{constructor(v,u,x,z,A=null,D=null,F=null,I=null){this.Zd=v;this.wH=u;this.vGa=x;this.UHa=z;this.NEk=A;this.lvk=D;this.wRk=F;this.nxa=I||this.rtf()}rtf(){return v=>!!this.Zd.runtime.rc&&this.Zd.runtime.rc.isFeatureEnabled(v)}BFl(){return()=>
this.Zd.runtime.rc}kzf(){return!!this.Zd.runtime.In.J(a.a.$N)}zWj(){let v;if(1===this.Zd.input.source||2===this.Zd.input.source)v=76;else if(4===this.Zd.input.source||3===this.Zd.input.source)v=36;else if(5===this.Zd.input.source)v=114;else return!1;return this.kzf()&&this.nxa(v)}IYj(v,...u){return String.format.apply(null,[v].concat(u))}x8d(v){const {ParagraphMerge:u}=d(2091);let x=this.Zd,z=this.vGa,A=this.UHa;v||(x=this.NEk||this.Zd,z=this.lvk||z,A=this.wRk||A);var D=w.a.RLf(this.wH);const F=w.a.RLf(z),
I=w.a.RLf(A);D=this.IYj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",x.input.source,x.runtime.dJa.id,x.runtime.O2d,x.runtime.GEe,D.Yr(),F.Yr(),I.Yr());return v?{returnValue:new l.a(x,this.wH,z,A,this.rtf(),new f.a),Yr:D}:{returnValue:new u(x,this.wH,z,A,this.rtf(),this.BFl(),new f.a),Yr:D}}DAc(){this.Zd.logger.rWo();var v=this.zWj();var u=({Yr:z}=this.x8d(v)).returnValue;m.a.instance.Ua(18994389,
1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",v,z);this.Zd.logger.NX("ParagraphMergeSelector initialization");v?this.Zd.logger.hye(1):this.Zd.logger.hye(2);let x=({Yq:u}=u.DAc()).returnValue;this.Zd.logger.lAg();var z=!x;v=!!this.Zd.runtime.In.J(a.a.$N)&&(v&&!x||!v);z&&({Yr:z,returnValue:u}=this.x8d(!1),{Yq:u,returnValue:x}=u.DAc(),m.a.instance.Ua(18994390,1,x?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",x,z));v&&(z=new f.a,w.a.bGo(this.Zd,z));this.Zd.logger.NX("ParagraphMergeSelector finalization");
return{returnValue:x,Yq:u}}utd(v,u){let x,z,A;const D=this.zWj()&&this.nxa(115);let F=({Yr:A}=this.x8d(D)).returnValue,I=({ydb:x,qva:z}=F.utd(v,u)).returnValue;m.a.instance.Ua(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",D,A);D&&!I&&F.Nvg&&({Yr:A,returnValue:F}=this.x8d(!1),{ydb:x,qva:z,returnValue:I}=F.utd(v,u),m.a.instance.Ua(18994392,1,I?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",I,A));return{returnValue:I,
ydb:x,qva:z}}}Object(G.a)(y,"ParagraphMergeSelector",null,[994])},2010:function(G,J,d){d.r(J);d.d(J,"SurfaceStringTokenStringGenerator",function(){return f});G=d(0);var m=d(1675);class f extends m.a{constructor(a){super(a);this.Bb=a}apply(a,l,w,y,v,u,x){null==u&&(u=a.CJi(v,l));x=m.a.fPh(a,u,this.Bb.score,w,y,x);return{isd:u,CUc:x}}}f.DUc=0;Object(G.a)(f,"SurfaceStringTokenStringGenerator",m.a,[])},2011:function(G,J,d){d.r(J);d.d(J,"QueryTokenStringGenerator",function(){return a});G=d(0);var m=d(1675),
f=d(1560);class a extends m.a{constructor(l){super(l);this.Bb=l}apply(l,w,y,v,u,x,z){w=this.Bb.query.load(w,null);u=0;let A=null;this.Bb.query.H8===f.Annotations.aFa?w&&(A=this.Bb.name):((A=this.Bb.name)&&(A+="_"),A+=this.Bb.annotations.bia(this.Bb.query.H8,w));null!=A&&(u=m.a.fPh(l,A,this.Bb.score,y,v,u));return{isd:x,CUc:z+u}}}a.DUc=1;Object(G.a)(a,"QueryTokenStringGenerator",m.a,[])},2012:function(G,J,d){d.r(J);d.d(J,"FuzzyMatchTokenStringGenerator",function(){return f});G=d(0);var m=d(1675);class f extends m.a{constructor(a){super(a);
this.Bb=a}apply(a,l,w,y,v,u,x){null==u&&(u=a.CJi(v,l));a=this.Bb.Jli.xGn(u);if(this.Bb.zpj)for(var z of a)if(!z.lR&&z.R3d)return{isd:u,CUc:x};z=0;for(const A of a)if(A.lR&&!({Wmf:z}=this.fUh(A,!0,w,y,z)).returnValue)return{isd:u,CUc:x};if(this.Bb.bRi)for(const A of a)if(!({Wmf:z}=this.fUh(A,!1,w,y,z)).returnValue)break;return{isd:u,CUc:x}}fUh(a,l,w,y,v){let u;l?(l=0,u=a.R3d?1:0):(l=a.R3d?1:0,u=a.count-l);for(let x=0;x<u;++x)if(m.a.gPh(a.Qpb+l+x,this.Bb.score,w,y),++v,0<this.Bb.F8f&&v>=this.Bb.F8f)return{returnValue:!1,
Wmf:v};return{returnValue:!0,Wmf:v}}}f.DUc=2;Object(G.a)(f,"FuzzyMatchTokenStringGenerator",m.a,[])},2082:function(G,J,d){G=d(0);var m=d(63),f=d(5),a=d(46),l=d(286),w=d(1559);class y extends w.a{constructor(){super()}get Eo(){return 2}get NB(){return 7}static Eh(){return new y}static get instance(){return y.ih.value}}y.ih=new l.a(y.Eh);Object(G.a)(y,"AppBindingNodeComplexMerge",w.a,[]);var v=d(16),u=d(864),x=d(192),z=d(1613);class A extends w.a{constructor(){super()}get Eo(){return 3}get NB(){return 7}Yk(){const qb=
super.Yk();qb.Z(u.a.yb(v.a.NU),1);return qb}OD(qb,Xb){if(Xb===u.a.yb(v.a.NU)){const Ec=qb.Rl;var Cc=qb.gf;x.a.instance.Ua(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ec.id,Ec.yc,Xb);Xb=Cc.getPropertyMilliseconds(qb.jh.value.Jf,v.a.NU);Cc=Cc.getPropertyMilliseconds(qb.Wo.value.Jf,v.a.NU);Xb<Cc&&this.Hmm(qb);qb.Xg.add(u.a.yb(v.a.NU));return!0}x.a.instance.Ua(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
qb.jh.value.Jf.id,Xb);return!1}Hmm(qb){this.ZCo(qb.Wo.value.Jf,qb.Rl);this.rIf(qb,f.a.ESd);this.rIf(qb,f.a.uif);this.rIf(qb,f.a.lif)}rIf(qb,Xb){var Cc=qb.gf,Ec=qb.Rl;if(Cc.hasProperty(Ec,Xb)&&(Xb=Cc.getPropertyObjectIds(Ec,Xb))&&Xb.length)for(Cc=qb.lu.runtime.sv,qb=qb.lu.runtime.Yq,Ec=0;Ec<Xb.length;Ec++){const Wb=Xb.J(Ec);if(!Cc.mb(Wb))continue;const Hb=Cc.J(Wb).WO();qb.add(Wb,new z.a(Hb,!1))}}static Eh(){return new A}static get instance(){return A.ih.value}}A.ih=new l.a(A.Eh);Object(G.a)(A,"AppNodeComplexMerge",
w.a,[]);class D extends w.a{constructor(){super()}get Eo(){return 4}get NB(){return 7}static Eh(){return new D}static get instance(){return D.ih.value}}D.ih=new l.a(D.Eh);Object(G.a)(D,"AppPropNodeComplexMerge",w.a,[]);class F extends w.a{constructor(){super()}get Eo(){return 5}get NB(){return 7}static Eh(){return new F}static get instance(){return F.ih.value}}F.ih=new l.a(F.Eh);Object(G.a)(F,"AppRefNodeComplexMerge",w.a,[]);var I=d(381),H=d(651),N=d(233),M=d(19);class U{constructor(qb,Xb){this.id=
qb;this.lbp=Xb}}Object(G.a)(U,"IdAndTime",null,[]);class O extends w.a{constructor(){super()}get Eo(){return 6}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.VTa),1);return qb}OD(qb,Xb){if(Xb===u.a.yb(f.a.VTa)){const Cc=qb.Rl,Ec=qb.gf;x.a.instance.Ua(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Cc.id,Cc.yc,Xb);Xb=Ec.getPropertyObjectIds(qb.jh.value.Ov,f.a.VTa);const Wb=Ec.getPropertyObjectIds(qb.jh.value.Jf,f.a.VTa),Hb=Ec.getPropertyObjectIds(qb.Wo.value.Jf,
f.a.VTa);Xb=this.WKn(qb,Xb,Wb,Hb);0<Xb.length?Ec.setPropertyObjectIds(Cc,f.a.VTa,Xb):Cc.removeProperty(f.a.VTa);qb.Xg.add(u.a.yb(f.a.VTa));return!0}x.a.instance.Ua(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",qb.jh.value.Jf.id,Xb);return!1}WKn(qb,Xb,Cc,Ec){const Wb=this.AMa(Xb,Cc,Ec),Hb=Xb.BS(),Sb=Cc.BS(),cc=Ec.BS();Xb=w.a.filter(Wb,Zc=>!Hb.contains(Zc)&&Sb.contains(Zc));Cc=w.a.filter(Wb,Zc=>!Hb.contains(Zc)&&cc.contains(Zc));
if(!Xb.length||!Cc.length)return Wb;const Gc=new I.a;Xb.forEach(Zc=>{const kb=new U(Zc,this.Sti(qb,Zc,!1));this.Oti(qb,Zc,!1).forEach(wd=>{Gc.add(wd,kb);return!0});return!0});const Oc=new H.a;Cc.forEach(Zc=>{const kb=this.Sti(qb,Zc,!0);this.Oti(qb,Zc,!0).forEach(wd=>Gc.mb(wd)?(Oc.add(Gc.J(wd).lbp>=kb?Zc:Gc.J(wd).id),!1):!0);return!0});return w.a.filter(Wb,Zc=>!Oc.contains(Zc))}Sti(qb,Xb,Cc){return(Xb=this.pla(qb,Xb,Cc))?qb.gf.getPropertyMilliseconds(Xb,v.a.NU):0}pla(qb,Xb,Cc){qb=Cc?qb.lu.runtime.sv:
qb.lu.runtime.NA;return qb.mb(Xb)?qb.J(Xb):null}Oti(qb,Xb,Cc){const Ec=new N.a,Wb=new H.a,Hb=qb.gf;Xb=this.pla(qb,Xb,Cc);var Sb=this.RFi(Hb,Xb);if(Sb)for(Ec.add(Sb),Wb.add(Sb),Xb=Hb.getPropertyObjectIds(Xb,f.a.ESd),Sb=0;Xb&&Sb<Xb.length;Sb++){const cc=this.RFi(Hb,this.pla(qb,Xb.J(Sb),Cc));if(!cc)break;Wb.contains(cc)||(Ec.add(cc),Wb.add(cc))}return Ec}RFi(qb,Xb){if(!qb.hasProperty(Xb,f.a.WTa)||!qb.hasProperty(Xb,f.a.omb)||!qb.hasProperty(Xb,f.a.nKb))return null;const Cc=qb.getPropertyString(Xb,f.a.WTa),
Ec=qb.getPropertyString(Xb,f.a.omb);qb=qb.getPropertyString(Xb,f.a.nKb);return M.a.sC(Cc+";"+Ec+";"+qb)}static Eh(){return new O}static get instance(){return O.ih.value}}O.ih=new l.a(O.Eh);Object(G.a)(O,"AppsNodeComplexMerge",w.a,[]);class V extends w.a{constructor(){super()}get Eo(){return 36}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.bMg),1);qb.Z(u.a.yb(f.a.yAg),1);return qb}OD(qb,Xb){x.a.instance.Ua(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",Xb);if(Xb===u.a.yb(f.a.bMg)||
Xb===u.a.yb(f.a.yAg)){const Hb=u.a.J_(Xb);var Cc=qb.jh.value.Jf,Ec=qb.Wo.value.Jf;const Sb=qb.Rl;var Wb=qb.gf.getPropertyStrings(qb.jh.value.Ov,Hb);Cc=qb.gf.getPropertyStrings(Cc,Hb);Ec=qb.gf.getPropertyStrings(Ec,Hb);Wb=this.AMa(Wb,Cc,Ec);qb.gf.setPropertyStrings(Sb,Hb,Wb);qb.Xg.add(Xb);return!0}return!1}static Eh(){return new V}static get instance(){return V.ih.value}}V.ih=new l.a(V.Eh);Object(G.a)(V,"AutoSaveParametersNodeComplexMerge",w.a,[]);class Y extends w.a{constructor(){super()}get Eo(){return 44}Yk(){const qb=
super.Yk();qb.Z(u.a.yb(v.a.wg),1);return qb}OD(qb,Xb){const Cc=qb.lu.runtime.rc;if(Xb===u.a.yb(v.a.wg))return x.a.instance.Ua(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",qb.Rl.id,qb.Rl.yc,Xb),Cc.JF(119),Cc.isFeatureEnabled(119)?this.ZKn(qb,Xb):this.wLn(qb,Xb),!0;x.a.instance.Ua(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",
qb.jh.value.Jf.id,Xb);return!1}ZKn(qb,Xb){const Cc=u.a.J_(Xb),Ec=qb.gf;var Wb=Ec.getPropertyObjectIds(qb.jh.value.Ov,Cc),Hb=Ec.getPropertyObjectIds(qb.jh.value.Jf,Cc),Sb=Ec.getPropertyObjectIds(qb.Wo.value.Jf,Cc);Sb=Y.GPm(qb,Hb,Sb);Wb=this.AMa(Wb,Hb,Sb);Hb=qb.Rl;0<Wb.length?Ec.setPropertyObjectIds(Hb,Cc,Wb):Hb.removeProperty(Cc);qb.Xg.add(Xb)}static Eh(){return new Y}static get instance(){return Y.ih.value}static GPm(qb,Xb,Cc){const Ec=new N.a,Wb=new I.a;Xb.forEach(Hb=>{const Sb=qb.lu.runtime.NA.J(Hb);
Sb&&Wb.add(Sb.qI(f.a.yu).toString(),Hb);return!0});Cc.forEach(Hb=>{var Sb=qb.lu.runtime.sv.J(Hb);Sb?(Sb=Sb.qI(f.a.yu).toString(),Wb.mb(Sb)&&Wb.get(Sb)!==Hb?x.a.instance.Ua(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):Ec.add(Hb)):Ec.add(Hb);return!0});return Ec}}Y.ih=new l.a(Y.Eh);Object(G.a)(Y,"BookmarkContainerNodeComplexMerge",w.a,[]);class Q extends w.a{constructor(){super()}get Eo(){return 41}Yk(){const qb=super.Yk();
qb.Z(u.a.yb(f.a.IKb),1);qb.Z(u.a.yb(f.a.yu),1);return qb}OD(qb,Xb){return Xb===u.a.yb(f.a.IKb)?(qb.Xg.add(u.a.yb(f.a.IKb)),!0):Xb===u.a.yb(f.a.yu)?(qb.Xg.add(u.a.yb(f.a.yu)),!0):!1}Tf(qb){return qb&&qb.length?!1:!0}static Eh(){return new Q}static get instance(){return Q.ih.value}}Q.ih=new l.a(Q.Eh);Object(G.a)(Q,"BookmarkNodeComplexMerge",w.a,[]);class S extends w.a{constructor(){super();this.Fde=!1}get Eo(){return 7}Yk(){const qb=super.Yk();qb.Z(u.a.yb(v.a.wg),1);return qb}OD(qb,Xb){if(Xb===u.a.yb(v.a.wg)){const Wb=
qb.Rl,Hb=qb.gf;var Cc=qb.lu.runtime.rc;Cc&&(this.Fde=Cc.isFeatureEnabled(70));x.a.instance.Ua(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Wb.id,Wb.yc,Xb);Xb=Hb.getPropertyObjectIds(qb.jh.value.Ov,v.a.wg);Cc=Hb.getPropertyObjectIds(qb.jh.value.Jf,v.a.wg);var Ec=Hb.getPropertyObjectIds(qb.Wo.value.Jf,v.a.wg);Xb=this.hLn(Xb,Cc,Ec);if(this.Fde&&0<Xb.length){Cc=new Sys.StringBuilder;for(Ec=0;Ec<Xb.length;Ec++)Cc.append(Xb.J(Ec).toString()+
",");x.a.instance.Ua(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",Wb.id,Cc.toString())}0<Xb.length?Hb.setPropertyObjectIds(Wb,v.a.wg,Xb):Wb.removeProperty(v.a.wg);qb.Xg.add(u.a.yb(v.a.wg));return!0}x.a.instance.Ua(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",qb.jh.value.Jf.id,Xb);return!1}hLn(qb,Xb,Cc){const Ec=new N.a,Wb=new I.a(0);this.w7l(qb,Cc,Ec,Wb);return this.GSl(Xb,Wb,Ec)}w7l(qb,Xb,
Cc,Ec){qb=qb||new N.a;Xb=Xb||new N.a;qb.forEach(Wb=>{Ec.Z(Wb,1);return!0});Xb.forEach(Wb=>{Ec.Dc(Wb).returnValue?Ec.Z(Wb,2):(Ec.Z(Wb,0),Cc.add(Wb));return!0})}GSl(qb,Xb,Cc){qb=qb||new N.a;const Ec=new N.a,Wb=new N.a,Hb=new N.a;qb.forEach(Sb=>{let cc=!0,Gc;({value:Gc}=Xb.Dc(Sb)).returnValue&&(0===Gc?Xb.Z(Sb,2):1===Gc&&(cc=!1));cc?Ec.add(Sb):this.Fde&&Wb.add(Sb);return!0});Cc.forEach(Sb=>{let cc=!1,Gc;({value:Gc}=Xb.Dc(Sb)).returnValue?0===Gc&&(cc=!0,Xb.Z(Sb,2)):x.a.instance.Ua(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",
Sb);cc?Ec.add(Sb):this.Fde&&Hb.add(Sb);return!0});this.raj(Wb,"Favored");this.raj(Hb,"Unfavored");return Ec}raj(qb,Xb){if(qb.length){var Cc=new Sys.StringBuilder;for(let Ec=0;Ec<qb.length;Ec++)Cc.append(qb.J(Ec).toString()+",");x.a.instance.Ua(561637572,1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",Xb,Cc.toString())}}static Eh(){return new S}static get instance(){return S.ih.value}}S.ih=new l.a(S.Eh);Object(G.a)(S,"CommentContentNodeComplexMerge",w.a,[]);var P=d(84),T=d(34);
class Z extends w.a{constructor(){super();this.cHh=[1];this.$5e=new I.a}get Eo(){return 8}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.Rea),3);qb.Z(u.a.yb(f.a.MG),3);qb.Z(u.a.yb(f.a.hfc),2);qb.Z(u.a.yb(f.a.commentId),2);qb.Z(u.a.yb(f.a.Eqf),2);qb.Z(u.a.yb(f.a.aJa),2);qb.Z(u.a.yb(f.a.AUa),1);qb.Z(u.a.yb(f.a.Prb),1);qb.Z(u.a.yb(f.a.Usb),1);qb.Z(u.a.yb(f.a.WT),1);qb.Z(u.a.yb(f.a.yI),1);qb.Z(u.a.yb(f.a.jWc),2);qb.Z(u.a.yb(f.a.PWd),2);qb.Z(u.a.yb(f.a.PLb),2);qb.Z(u.a.yb(f.a.Gqf),2);qb.Z(u.a.yb(f.a.XO),1);
qb.Z(u.a.yb(v.a.wg),0);qb.Z(u.a.yb(f.a.NJ),0);return qb}OD(qb,Xb){if(Xb===u.a.yb(f.a.XO)){var Cc=qb.gf.getPropertyString(qb.Wo.value.Jf,f.a.XO);this.Tf(Cc)?qb.Rl.removeProperty(f.a.XO):qb.Rl.heb(f.a.XO,Cc);return!0}if(Xb!==u.a.yb(f.a.AUa)&&Xb!==u.a.yb(f.a.Prb)&&Xb!==u.a.yb(f.a.Usb)&&Xb!==u.a.yb(f.a.yI)&&Xb!==u.a.yb(f.a.WT))return!1;var Ec=qb.jh.value.Ov;const Wb=qb.jh.value.Jf;var Hb=qb.Wo.value.Jf;Cc=qb.Rl;if(Xb===u.a.yb(f.a.AUa)){Ec=qb.gf.getPropertyString(Wb,f.a.AUa);Hb=qb.gf.getPropertyString(Hb,
f.a.AUa);Hb=this.Tf(Ec)?Hb:this.Tf(Hb)?Ec:null;if(this.Tf(Hb))return!0;qb.gf.setPropertyString(Cc,f.a.AUa,Hb);qb.Xg.add(u.a.yb(f.a.AUa));return!0}if(Xb===u.a.yb(f.a.Usb))return Ec=qb.gf.getPropertyBool(Wb,f.a.Usb),Hb=qb.gf.getPropertyBool(Hb,f.a.Usb),Ec=null!=Ec?Ec:!1,Ec=(null!=Hb?Hb:!1)||Ec,qb.gf.setPropertyBool(Cc,f.a.Usb,Ec),qb.Xg.add(u.a.yb(f.a.Usb)),!0;if(Xb===u.a.yb(f.a.Prb)){Ec=qb.gf.getPropertyBool(Wb,f.a.Prb);Hb=qb.gf.getPropertyBool(Hb,f.a.Prb);if(Ec===Hb)return!0;Ec=null!=Ec?Ec:!1;Ec=(null!=
Hb?Hb:!1)||Ec;qb.gf.setPropertyBool(Cc,f.a.Prb,Ec);return!0}if(Xb===u.a.yb(f.a.yI)){Ec=qb.gf.getPropertyBool(Wb,f.a.yI);Hb=qb.gf.getPropertyBool(Hb,f.a.yI);if(Ec===Hb)return!0;Ec=null!=Ec?Ec:!1;Ec=(null!=Hb?Hb:!1)||Ec;qb.gf.setPropertyBool(Cc,f.a.yI,Ec);qb.Xg.add(u.a.yb(f.a.yI));return!0}if(Xb===u.a.yb(f.a.WT)){Xb=qb.lu.runtime.rc;Xb.JF(11);if(Xb.isFeatureEnabled(11))return this.vwl(qb,Ec,Wb,Hb,Cc);Ec=qb.gf.getPropertyString(Wb,f.a.WT);Hb=qb.gf.getPropertyString(Hb,f.a.WT);if(Ec===Hb)return!0;qb.gf.setPropertyString(Cc,
f.a.WT,Hb||Ec);qb.Xg.add(u.a.yb(f.a.WT));return!0}return!1}vwl(qb,Xb,Cc,Ec,Wb){Cc=qb.gf.getPropertyString(Cc,f.a.WT);Ec=qb.gf.getPropertyString(Ec,f.a.WT);if(Cc===Ec)return!0;Xb=qb.gf.getPropertyString(Xb,f.a.WT);const Hb={};for(let cc=0;cc<this.cHh.length;cc++){const Gc=this.cHh[cc];var Sb=this.oNf(Xb,Gc,0);const Oc=this.oNf(Cc,Gc,1),Zc=this.oNf(Ec,Gc,2);Sb=this.ELn(Sb,Oc,Zc);Hb[Gc.toString()]=Sb.toArray()}qb.gf.setPropertyString(Wb,f.a.WT,this.TPo(Hb));qb.Xg.add(u.a.yb(f.a.WT));return!0}ELn(qb,
Xb,Cc){const Ec=new I.a,Wb=new I.a(0);for(var Hb=0;Hb<Xb.length;Hb++){const cc=Xb[Hb].UserId;Ec.add(cc,Xb[Hb]);Wb.add(cc,0)}for(Xb=0;Xb<Cc.length;Xb++)Hb=Cc[Xb].UserId,Wb.mb(Hb)?Wb.Z(Hb,2):(Ec.add(Hb,Cc[Xb]),Wb.add(Hb,0));for(Cc=0;Cc<qb.length;Cc++)Xb=qb[Cc].UserId,Wb.mb(Xb)&&2!==Wb.J(Xb)&&Wb.Z(Xb,1);const Sb=new N.a;Wb.forEach((cc,Gc)=>{if(1===Gc)return!0;Sb.add(Ec.J(cc));return!0});return Sb}oNf(qb,Xb,Cc){qb=Object(P.a)(Object,this.BHm(qb,Cc));return Xb.toString()in qb?Array.isArray(qb[Xb.toString()])?
qb[Xb.toString()]:null:[]}BHm(qb,Xb){if(this.$5e.mb(Xb))return Object(P.a)(Object,this.$5e.J(Xb));qb=Object(P.a)(Object,this.qRl(qb));this.$5e.add(Xb,qb);return qb}qRl(qb){return Object(P.a)(Object,T.b(qb))}TPo(qb){return T.c(qb)}Tf(qb){return qb&&qb.length?!1:!0}static Eh(){return new Z}static get instance(){return Z.ih.value}}Z.ih=new l.a(Z.Eh);Object(G.a)(Z,"CommentNodeComplexMerge",w.a,[]);class X extends w.a{constructor(){super()}get Eo(){return 46}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.Ud),
1);qb.Z(u.a.yb(v.a.lastModifiedTime),0);qb.Z(u.a.yb(f.a.OWc),2);return qb}OD(qb,Xb){if(Xb===u.a.yb(f.a.Ud))return x.a.instance.Ua(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",qb.Rl.id,qb.Rl.yc,Xb),w.a.W8f(qb,this,f.a.Ud);x.a.instance.Ua(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",qb.jh.value.Jf.id,
Xb);return!1}static Eh(){return new X}static get instance(){return X.ih.value}}X.ih=new l.a(X.Eh);Object(G.a)(X,"ContentControlContainerNodeComplexMerge",w.a,[]);var aa=d(43),ia=d(54),wa=d(1883);class ma extends w.a{constructor(){super()}get Eo(){return 37}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.yaa),1);qb.Z(u.a.yb(f.a.Qzb),1);qb.Z(u.a.yb(f.a.HXd),2);qb.Z(u.a.yb(f.a.dMb),2);qb.Z(u.a.yb(f.a.Ud),1);qb.Z(u.a.yb(f.a.xba),1);qb.Z(u.a.yb(f.a.hka),1);qb.Z(u.a.yb(f.a.Dfc),1);qb.Z(u.a.yb(f.a.Nnb),1);qb.Z(u.a.yb(f.a.Knb),
1);qb.Z(u.a.yb(f.a.Jnb),1);qb.Z(u.a.yb(f.a.HUa),2);qb.Z(u.a.yb(f.a.fMb),1);qb.Z(u.a.yb(f.a.IXd),1);qb.Z(u.a.yb(f.a.xaa),1);this.rc.isFeatureEnabled(26)&&(qb.Z(u.a.yb(f.a.xN),2),qb.Z(u.a.yb(f.a.xAa),2),qb.Z(u.a.yb(f.a.Xra),2),qb.Z(u.a.yb(f.a.H3),1),qb.Z(u.a.yb(f.a.vta),1),qb.Z(u.a.yb(f.a.wta),1));this.rc.isFeatureEnabled(16)&&(qb.Z(u.a.yb(aa.a.Yrf),2),qb.Z(u.a.yb(aa.a.r7h),2),qb.Z(u.a.yb(aa.a.q7h),2),qb.Z(u.a.yb(aa.a.z7h),2),qb.Z(u.a.yb(aa.a.y7h),2));return qb}OD(qb,Xb){var Cc=qb.jh.value.Jf,Ec=qb.Wo.value.Jf;
const Wb=qb.Rl;if(Xb===u.a.yb(f.a.Ud))return w.a.W8f(qb,this,f.a.Ud);if(Xb===u.a.yb(f.a.xba)){Xb=qb.gf.getPropertyBool(Cc,f.a.xba);Ec=qb.gf.getPropertyBool(Ec,f.a.xba);if(null!=Xb&&Xb||null!=Ec&&Ec)qb.gf.setPropertyBool(Wb,f.a.xba,!0),qb.Xg.add(u.a.yb(f.a.xba));return!0}if(Xb===u.a.yb(f.a.hka))return Xb=qb.gf.getPropertyBool(Cc,f.a.hka),Ec=qb.gf.getPropertyBool(Ec,f.a.hka),qb.gf.setPropertyBool(Wb,f.a.hka,null!=Xb&&!!Xb&&null!=Ec&&!!Ec),qb.Xg.add(u.a.yb(f.a.hka)),!0;if(Xb===u.a.yb(f.a.Dfc))return Xb=
qb.gf.getPropertyUint32(Ec,f.a.Dfc),null!=Xb&&(qb.gf.setPropertyUint32(Wb,f.a.Dfc,Xb),qb.Xg.add(u.a.yb(f.a.Dfc))),!0;if(Xb===u.a.yb(f.a.Nnb)||Xb===u.a.yb(f.a.Knb)||Xb===u.a.yb(f.a.Jnb))return(Ec=qb.gf.getPropertyString(Ec,u.a.J_(Xb)))&&0<Ec.length&&(qb.gf.setPropertyString(Wb,u.a.J_(Xb),Ec),qb.Xg.add(Xb)),!0;if(Xb===u.a.yb(f.a.fMb)||Xb===u.a.yb(f.a.IXd)){Cc=qb.gf.getPropertyObjectId(Cc,u.a.J_(Xb));if(wa.a.fkc(qb.lu,Cc))return!0;if((Ec=qb.gf.getPropertyObjectId(Ec,u.a.J_(Xb)))&&Ec!==ia.a.nil)return qb.gf.setPropertyObjectId(Wb,
u.a.J_(Xb),Ec),qb.Xg.add(Xb),!0;Wb.removeProperty(u.a.J_(Xb));qb.Xg.add(Xb);return!0}if(Xb===u.a.yb(f.a.xaa)){Cc=qb.gf.getPropertyObjectId(Cc,f.a.xaa);if((Cc=wa.a.fkc(qb.lu,Cc))&&qb.gf.getPropertyObjectIds(Cc,f.a.Ud).BS().contains(qb.Rl.id))return!0;Ec=qb.gf.getPropertyObjectId(Ec,f.a.xaa);return(Cc=wa.a.fkc(qb.lu,Ec))&&qb.gf.getPropertyObjectIds(Cc,f.a.Ud).BS().contains(qb.Rl.id)?(qb.gf.setPropertyObjectId(Wb,f.a.xaa,Ec),qb.Xg.add(Xb),!0):!1}if(Xb===u.a.yb(f.a.yaa))return Xb=qb.gf.getPropertyBool(Ec,
f.a.yaa),null==Xb||Xb||(qb.gf.setPropertyBool(Wb,f.a.yaa,!1),qb.Xg.add(u.a.yb(f.a.yaa))),!0;if(Xb===u.a.yb(f.a.Qzb)){Xb=qb.gf.getPropertyObjectId(Cc,f.a.Qzb);Ec=qb.gf.getPropertyObjectId(Ec,f.a.Qzb);if(Xb&&!Xb.equals(Ec))return!1;if(Xb=Xb||Ec)qb.gf.setPropertyObjectId(Wb,f.a.Qzb,Xb),qb.Xg.add(u.a.yb(f.a.Qzb));return!0}!this.rc.isFeatureEnabled(26)||Xb!==u.a.yb(f.a.H3)&&Xb!==u.a.yb(f.a.vta)&&Xb!==u.a.yb(f.a.wta)||x.a.instance.Ua(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",
Xb);return!1}static Eh(){return new ma}static get instance(){return ma.ih.value}}ma.ih=new l.a(ma.Eh);Object(G.a)(ma,"ContentControlNodeComplexMerge",w.a,[]);class na extends w.a{constructor(){super()}get Eo(){return 10}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.eR),1);return qb}OD(qb,Xb){if(Xb===u.a.yb(f.a.eR)){Xb=qb.Rl;const Ec=qb.gf;var Cc=Ec.getPropertyObjectIds(qb.jh.value.Ov,f.a.eR);const Wb=Ec.getPropertyObjectIds(qb.jh.value.Jf,f.a.eR),Hb=Ec.getPropertyObjectIds(qb.Wo.value.Jf,f.a.eR);Cc=this.lLn(Cc,
Wb,Hb);0<Cc.length?Ec.setPropertyObjectIds(Xb,f.a.eR,Cc):Xb.removeProperty(f.a.eR);qb.Xg.add(u.a.yb(f.a.eR));return!0}return!1}lLn(qb,Xb,Cc){return this.AMa(qb,Xb,Cc)}static Eh(){return new na}static get instance(){return na.ih.value}}na.ih=new l.a(na.Eh);Object(G.a)(na,"CustomXmlPartContainerNodeComplexMerge",w.a,[]);class Fa extends w.a{constructor(){super()}get Eo(){return 9}get NB(){return 0}static Eh(){return new Fa}static get instance(){return Fa.ih.value}}Fa.ih=new l.a(Fa.Eh);Object(G.a)(Fa,
"CustomXmlPartNodeComplexMerge",w.a,[]);class Qa extends w.a{constructor(){super()}get Eo(){return 29}get NB(){return 3}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.Gka),1);return qb}OD(qb,Xb){if(Xb===u.a.yb(f.a.Gka)){Xb=qb.gf;var Cc=Xb.getPropertyObjectIds(qb.jh.value.Ov,f.a.Gka),Ec=Xb.getPropertyObjectIds(qb.jh.value.Jf,f.a.Gka);const Wb=Xb.getPropertyObjectIds(qb.Wo.value.Jf,f.a.Gka);Cc=this.AMa(Cc,Ec,Wb);Ec=qb.Rl;0<Cc.length?Xb.setPropertyObjectIds(Ec,f.a.Gka,Cc):Ec.removeProperty(f.a.Gka);qb.Xg.add(u.a.yb(f.a.Gka));
return!0}return!1}static Eh(){return new Qa}static get instance(){return Qa.ih.value}}Qa.ih=new l.a(Qa.Eh);Object(G.a)(Qa,"EmbeddedFontContainerNodeComplexMerge",w.a,[]);class ya extends w.a{constructor(){super()}get Eo(){return 30}get NB(){return 3}static Eh(){return new ya}static get instance(){return ya.ih.value}}ya.ih=new l.a(ya.Eh);Object(G.a)(ya,"EmbeddedFontNodeComplexMerge",w.a,[]);class ta extends w.a{constructor(){super()}get Eo(){return 11}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.n7),4);
qb.Z(u.a.yb(f.a.vKa),1);return qb}OD(qb,Xb){if(Xb===u.a.yb(f.a.vKa)){const Cc=qb.Rl,Ec=qb.gf;x.a.instance.Ua(4063307,1,4,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Cc.id,Cc.yc,Xb);Xb=Ec.getPropertyObjectIds(qb.jh.value.Ov,f.a.vKa);const Wb=Ec.getPropertyObjectIds(qb.jh.value.Jf,f.a.vKa),Hb=Ec.getPropertyObjectIds(qb.Wo.value.Jf,f.a.vKa);Xb=this.cej(Xb,Wb,Hb,(Sb,cc)=>Sb.equals(cc));0<Xb.length?Ec.setPropertyObjectIds(Cc,f.a.vKa,
Xb):Cc.removeProperty(f.a.vKa);qb.Xg.add(u.a.yb(f.a.vKa));return!0}x.a.instance.Ua(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",qb.jh.value.Jf.id,Xb);return!1}static Eh(){return new ta}static get instance(){return ta.ih.value}}ta.ih=new l.a(ta.Eh);Object(G.a)(ta,"FootnoteEndnoteContainerNodeComplexMerge",w.a,[]);class Aa extends w.a{constructor(){super()}get Eo(){return 12}get NB(){return 3}Yk(){const qb=
super.Yk();qb.Z(u.a.yb(f.a.Asa),1);return qb}OD(qb,Xb){const Cc=qb.Rl,Ec=qb.gf;if(Xb===u.a.yb(f.a.Asa)){let Wb=-1;x.a.instance.Ua(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Cc.id,Cc.yc,Xb);const Hb=Ec.getPropertyInt32(qb.jh.value.Jf,f.a.Asa),Sb=Ec.getPropertyInt32(qb.Wo.value.Jf,f.a.Asa);null!=Hb&&-1!==Hb?Wb=Hb:null!=Sb&&(Wb=Sb);Ec.setPropertyInt32(Cc,f.a.Asa,Wb);qb.Xg.add(Xb);return!0}x.a.instance.Ua(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
qb.jh.value.Ov.id,Xb);return!1}static Eh(){return new Aa}static get instance(){x.a.instance.Ua(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");return Aa.ih.value}}Aa.ih=new l.a(Aa.Eh);Object(G.a)(Aa,"FootnoteEndnoteNodeComplexMerge",w.a,[]);class oa extends w.a{constructor(){super()}get Eo(){return 47}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.sWa),1);return qb}OD(qb,Xb){return Xb===u.a.yb(f.a.sWa)?(x.a.instance.Ua(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
qb.Rl.id,qb.Rl.yc,Xb),w.a.W8f(qb,this,f.a.sWa)):!1}static Eh(){return new oa}static get instance(){return oa.ih.value}}oa.ih=new l.a(oa.Eh);Object(G.a)(oa,"GlossaryPageManifestNodeComplexMerge",w.a,[]);class za extends w.a{constructor(){super()}get Eo(){return 13}get NB(){return 3}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.yna),4);return qb}static Eh(){return new za}static get instance(){return za.ih.value}}za.ih=new l.a(za.Eh);Object(G.a)(za,"HeaderFooterContainerNodeComplexMerge",w.a,[]);class ja extends w.a{constructor(){super()}get Eo(){return 14}get NB(){return 3}Yk(){const qb=
super.Yk();qb.Z(u.a.yb(f.a.runId),3);qb.Z(u.a.yb(f.a.Yc),3);qb.Z(u.a.yb(f.a.tVi),3);qb.Z(u.a.yb(f.a.uX),1);qb.Z(u.a.yb(a.a.h0),1);qb.Z(u.a.yb(v.a.imageAltText),1);qb.Z(u.a.yb(f.a.f0),1);qb.Z(u.a.yb(v.a.pca),1);qb.Z(u.a.yb(a.a.Xfb),1);qb.Z(u.a.yb(f.a.TTa),1);return qb}OD(qb,Xb){if(Xb===u.a.yb(v.a.imageAltText)||Xb===u.a.yb(f.a.f0)||Xb===u.a.yb(f.a.uX)||Xb===u.a.yb(f.a.g0)||Xb===u.a.yb(v.a.csb)||Xb===u.a.yb(v.a.pca)||Xb===u.a.yb(a.a.h0)||Xb===u.a.yb(a.a.Xfb)||Xb===u.a.yb(f.a.TTa)){const Ec=qb.Rl;var Cc=
qb.gf;x.a.instance.Ua(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ec.id,Ec.yc,Xb);const Wb=Cc.getPropertyInt32(qb.jh.value.Jf,a.a.h0);Cc=Cc.getPropertyInt32(qb.Wo.value.Jf,a.a.h0);if(null!=Wb&&(0===Wb||2===Wb))return!0;if(null!=Cc&&(0===Cc||2===Cc))return Xb=qb.Wo.value.Jf,this.Vnb(Xb,Ec,v.a.imageAltText),this.Vnb(Xb,Ec,f.a.f0),this.Vnb(Xb,Ec,f.a.g0),Xb.hasProperty(f.a.uX)&&this.Vnb(Xb,Ec,f.a.uX),this.Vnb(Xb,Ec,v.a.csb),this.Vnb(Xb,
Ec,v.a.pca),this.Vnb(Xb,Ec,a.a.h0),this.Vnb(Xb,Ec,a.a.Xfb),qb.Xg.add(u.a.yb(v.a.imageAltText)),qb.Xg.add(u.a.yb(f.a.f0)),qb.Xg.add(u.a.yb(f.a.g0)),qb.Xg.add(u.a.yb(f.a.uX)),qb.Xg.add(u.a.yb(v.a.csb)),qb.Xg.add(u.a.yb(v.a.pca)),qb.Xg.add(u.a.yb(a.a.h0)),qb.Xg.add(u.a.yb(a.a.Xfb)),qb.Xg.add(u.a.yb(f.a.TTa)),!0}x.a.instance.Ua(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",qb.jh.value.Ov.id,Xb);return!1}static Eh(){return new ja}static get instance(){return ja.ih.value}}
ja.ih=new l.a(ja.Eh);Object(G.a)(ja,"ImageNodeComplexMerge",w.a,[]);class fa extends w.a{constructor(){super()}get Eo(){return 40}get NB(){return 0}static Eh(){return new fa}static get instance(){return fa.ih.value}}fa.ih=new l.a(fa.Eh);Object(G.a)(fa,"IntelligenceAnnotationNodeComplexMerge",w.a,[]);class Ca extends w.a{constructor(){super()}get Eo(){return 32}get NB(){return 0}static Eh(){return new Ca}static get instance(){return Ca.ih.value}}Ca.ih=new l.a(Ca.Eh);Object(G.a)(Ca,"IntelligenceContentLocatorNodeComplexMerge",
w.a,[]);class xa extends w.a{constructor(){super()}get Eo(){return 34}get NB(){return 0}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.fXa),1);return qb}OD(qb,Xb){const Cc=qb.Rl,Ec=qb.gf;if(Xb===u.a.yb(f.a.fXa)){Xb=Ec.getPropertyObjectIds(qb.jh.value.Ov,f.a.fXa);const Wb=Ec.getPropertyObjectIds(qb.jh.value.Jf,f.a.fXa),Hb=Ec.getPropertyObjectIds(qb.Wo.value.Jf,f.a.fXa);Xb=this.AMa(Xb,Wb,Hb);Ec.setPropertyObjectIds(Cc,f.a.fXa,Xb);qb.Xg.add(u.a.yb(f.a.fXa));return!0}return!1}static Eh(){return new xa}static get instance(){return xa.ih.value}}
xa.ih=new l.a(xa.Eh);Object(G.a)(xa,"IntelligenceRegionNodeComplexMerge",w.a,[]);class ua extends w.a{constructor(){super()}get Eo(){return 35}get NB(){return 0}static Eh(){return new ua}static get instance(){return ua.ih.value}}ua.ih=new l.a(ua.Eh);Object(G.a)(ua,"IntelligenceRejectionNodeComplexMerge",w.a,[]);class sa extends w.a{constructor(){super()}get Eo(){return 39}get NB(){return 0}static Eh(){return new sa}static get instance(){return sa.ih.value}}sa.ih=new l.a(sa.Eh);Object(G.a)(sa,"IntelligenceReviewedNodeComplexMerge",
w.a,[]);class Ea extends w.a{constructor(){super()}get Eo(){return 33}get NB(){return 0}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.lnc),1);qb.Z(u.a.yb(f.a.knc),1);qb.Z(u.a.yb(f.a.Bce),1);qb.Z(u.a.yb(f.a.Dce),1);return qb}OD(qb,Xb){const Cc=qb.Rl,Ec=qb.gf;if(Xb===u.a.yb(f.a.lnc)||Xb===u.a.yb(f.a.knc)||Xb===u.a.yb(f.a.Bce)||Xb===u.a.yb(f.a.Dce)){Xb=Xb===u.a.yb(f.a.lnc)?f.a.lnc:f.a.knc;var Wb=Ec.getPropertyObjectIds(qb.jh.value.Ov,Xb);const Hb=Ec.getPropertyObjectIds(qb.jh.value.Jf,Xb),Sb=Ec.getPropertyObjectIds(qb.Wo.value.Jf,
Xb);Wb=this.AMa(Wb,Hb,Sb);Ec.setPropertyObjectIds(Cc,Xb,Wb);qb.Xg.add(u.a.yb(Xb));return!0}return!1}static Eh(){return new Ea}static get instance(){return Ea.ih.value}}Ea.ih=new l.a(Ea.Eh);Object(G.a)(Ea,"IntelligenceRootNodeComplexMerge",w.a,[]);class Ja extends w.a{constructor(){super()}get Eo(){return 42}get NB(){return 0}static Eh(){return new Ja}static get instance(){return Ja.ih.value}}Ja.ih=new l.a(Ja.Eh);Object(G.a)(Ja,"IntelligenceSettingNodeComplexMerge",w.a,[]);class nb extends w.a{constructor(){super()}get Eo(){return 45}get NB(){return 0}static Eh(){return new nb}static get instance(){return nb.ih.value}}
nb.ih=new l.a(nb.Eh);Object(G.a)(nb,"IntelligenceWorkflowNodeComplexMerge",w.a,[]);class ub extends w.a{constructor(){super()}get Eo(){return 15}get NB(){return 3}static Eh(){return new ub}static get instance(){return ub.ih.value}}ub.ih=new l.a(ub.Eh);Object(G.a)(ub,"NumberListNodeComplexMerge",w.a,[]);var Yb=d(125);class yb extends w.a{constructor(){super()}get Eo(){return 16}get NB(){return 0}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.tKb),1);qb.Z(u.a.yb(Yb.a.Oqf),7);qb.Z(u.a.yb(Yb.a.Mqf),7);return qb}OD(qb,
Xb){const Cc=qb.Rl,Ec=qb.gf;if(Xb===u.a.yb(f.a.tKb))return this.E2f(Ec,qb.jh.value.Jf,qb.Wo.value.Jf,Cc,f.a.tKb),qb.Xg.add(Xb),!0;x.a.instance.Ua(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",qb.jh.value.Ov.id,Xb);return!1}static Eh(){return new yb}static get instance(){return yb.ih.value}}yb.ih=new l.a(yb.Eh);Object(G.a)(yb,"OutlineElementNodeComplexMerge",w.a,[]);class Za extends w.a{constructor(){super()}get Eo(){return 17}Yk(){const qb=
super.Yk();qb.Z(u.a.yb(f.a.tKb),1);qb.Z(u.a.yb(f.a.zka),1);qb.Z(u.a.yb(Yb.a.WJ),1);qb.Z(u.a.yb(Yb.a.nqc),1);qb.Z(u.a.yb(Yb.a.Lma),8);return qb}OD(qb,Xb){const Cc=qb.Rl,Ec=qb.gf;if(Xb===u.a.yb(f.a.tKb))return this.E2f(Ec,qb.jh.value.Jf,qb.Wo.value.Jf,Cc,f.a.tKb),qb.Xg.add(Xb),!0;if(Xb===u.a.yb(f.a.zka)){var Wb=Ec.getPropertyBool(qb.jh.value.Jf,f.a.zka),Hb=Ec.getPropertyBool(qb.Wo.value.Jf,f.a.zka);Ec.setPropertyBool(Cc,f.a.zka,null==Wb?!1:Wb&&null==Hb?!1:Hb);qb.Xg.add(Xb);return!0}if(Xb===u.a.yb(Yb.a.nqc))return this.E2f(Ec,
qb.jh.value.Jf,qb.Wo.value.Jf,Cc,Yb.a.nqc),qb.Xg.add(Xb),!0;if(Xb===u.a.yb(Yb.a.WJ))return Wb=Ec.getPropertyBool(qb.jh.value.Jf,Yb.a.WJ),Hb=Ec.getPropertyBool(qb.Wo.value.Jf,Yb.a.WJ),Ec.setPropertyBool(Cc,Yb.a.WJ,null==Wb?!0:Wb||null==Hb?!0:Hb),qb.Xg.add(Xb),!0;x.a.instance.Ua(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",qb.jh.value.Ov.id,Xb);return!1}static Eh(){return new Za}static get instance(){return Za.ih.value}}
Za.ih=new l.a(Za.Eh);Object(G.a)(Za,"OutlineGroupNodeComplexMerge",w.a,[]);var Ya=d(104);class Pa extends w.a{constructor(){super()}get Eo(){return 18}get NB(){return 2}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.mae),3);qb.Z(u.a.yb(v.a.kS),this.NB);qb.Z(u.a.yb(f.a.ft),1);qb.Z(u.a.yb(f.a.t8),1);qb.Z(u.a.yb(f.a.Xq),1);qb.Z(u.a.yb(aa.a.eH),1);qb.Z(u.a.yb(aa.a.OYa),1);return qb}OD(qb,Xb){const Cc=qb.gf;if(qb.lu.runtime.rc.isFeatureEnabled(67)){if(Xb===u.a.yb(f.a.ft)||Xb===u.a.yb(f.a.t8)||Xb===u.a.yb(aa.a.OYa)||
Xb===u.a.yb(f.a.Xq)||Xb===u.a.yb(aa.a.eH))return this.tqp(Cc,qb)}else if(Xb===u.a.yb(f.a.ft)||Xb===u.a.yb(f.a.Xq)){let Ec,Wb;({yWc:Xb,$$a:Ec,Q$a:Wb}=this.Mof(Object(Ya.a)(Cc,Cc.getPropertyUint32s,"getPropertyUint32s"),qb.jh.value.Ov,qb.jh.value.Jf,qb.Wo.value.Jf,f.a.ft,null));if(!Wb&&!Ec)return x.a.instance.Ua(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",qb.jh.value.Jf.id,u.a.yb(f.a.ft)),!0;let Hb,Sb,cc;({yWc:Hb,
$$a:Sb,Q$a:cc}=this.Mof(Object(Ya.a)(Cc,Cc.getPropertyObjectIds,"getPropertyObjectIds"),qb.jh.value.Ov,qb.jh.value.Jf,qb.Wo.value.Jf,f.a.Xq,null));if(!Sb&&!cc)return x.a.instance.Ua(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",qb.jh.value.Jf.id,u.a.yb(f.a.Xq)),!0;const Gc=Sb&&!cc;if((Ec&&!Wb)!==Gc)return x.a.instance.Ua(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
qb.jh.value.Jf.id,u.a.yb(f.a.ft),u.a.yb(f.a.Xq)),!1;Gc&&(Cc.setPropertyObjectIds(qb.Rl,f.a.Xq,Hb),Cc.setPropertyUint32s(qb.Rl,f.a.ft,Xb));x.a.instance.Ua(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",qb.jh.value.Jf.id,u.a.yb(f.a.ft),Ec,Wb,u.a.yb(f.a.Xq),Sb,cc);qb.Xg.add(u.a.yb(f.a.Xq));qb.Xg.add(u.a.yb(f.a.ft));
return!0}x.a.instance.Ua(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",qb.jh.value.Jf.id,Xb);return!1}qOi(qb,Xb,Cc,Ec){let Wb;({yWc:Xb,$$a:Ec,Q$a:Wb}=this.Mof(Xb,Cc.jh.value.Ov,Cc.jh.value.Jf,Cc.Wo.value.Jf,qb,Ec));return Wb||Ec?{returnValue:!0,orf:Xb,$$a:Ec,Q$a:Wb}:(x.a.instance.Ua(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
Cc.jh.value.Jf.id.toString(),u.a.yb(qb)),{returnValue:!1,orf:Xb,$$a:Ec,Q$a:Wb})}rNi(qb,Xb,Cc,Ec,Wb){let Hb;let Sb,cc,Gc,Oc;({orf:Hb,$$a:Zc,Q$a:Sb,returnValue:Gc}=this.qOi(qb,Object(Ya.a)(Cc,Cc.getPropertyUint32s,"getPropertyUint32s"),Ec,null));({orf:Cc,$$a:Wb,Q$a:cc,returnValue:Oc}=this.qOi(Xb,Object(Ya.a)(Cc,Cc.getPropertyObjectIds,"getPropertyObjectIds"),Ec,Wb));var Zc=Zc&&!Sb;return Gc&&Oc?Zc!==(Wb&&!cc)?(x.a.instance.Ua(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Ec.jh.value.Jf.id.toString(),u.a.yb(qb),u.a.yb(Xb)),{returnValue:2,tXd:Hb,sXd:Cc,qCe:Zc}):{returnValue:0,tXd:Hb,sXd:Cc,qCe:Zc}:{returnValue:1,tXd:Hb,sXd:Cc,qCe:Zc}}OYf(qb){let Xb=!0;qb.forEach(Cc=>Cc!==ia.a.nil?Xb=!1:!0);return Xb}wrm(qb,Xb,Cc){return this.OYf(qb)&&this.OYf(Xb)&&this.OYf(Cc)?!0:!1}tqp(qb,Xb){let Cc,Ec,Wb,Hb,Sb,cc;var Gc=({tXd:Hb,sXd:Sb,qCe:Ec}=this.rNi(aa.a.OYa,f.a.Xq,qb,Xb,null)).returnValue;if(2===Gc||1===Gc)return!0;({tXd:Wb,sXd:cc,qCe:Cc,returnValue:Gc}=this.rNi(f.a.ft,f.a.t8,
qb,Xb,Object(Ya.a)(this,this.wrm,"getExtendedGuidEquivalence")));if(2===Gc||1===Gc)return!0;let Oc;({yWc:Gc,$$a:Zc,Q$a:Oc}=this.Aol(Object(Ya.a)(qb,qb.getPropertyDictionary,"getPropertyDictionary"),Xb.jh.value.Ov,Xb.jh.value.Jf,Xb.Wo.value.Jf,aa.a.eH));if(!Oc&&!Zc)return x.a.instance.Ua(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Xb.jh.value.Jf.id.toString(),u.a.yb(aa.a.eH)),!0;var Zc=Zc&&!Oc;if(Cc!==Ec||Cc!==
Zc)return x.a.instance.Ua(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",Xb.jh.value.Jf.id.toString(),u.a.yb(f.a.ft),u.a.yb(aa.a.OYa),u.a.yb(aa.a.eH),Ec,Cc,Zc),!0;Cc&&(qb.setPropertyObjectIds(Xb.Rl,f.a.Xq,Sb),qb.setPropertyUint32s(Xb.Rl,aa.a.OYa,Hb),qb.setPropertyObjectIds(Xb.Rl,
f.a.t8,cc),qb.setPropertyUint32s(Xb.Rl,f.a.ft,Wb),qb.setPropertyDictionary(Xb.Rl,aa.a.eH,Gc));x.a.instance.Ua(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",Xb.jh.value.Jf.id.toString(),Ec,Cc,Zc);Xb.Xg.add(u.a.yb(aa.a.OYa));Xb.Xg.add(u.a.yb(f.a.Xq));Xb.Xg.add(u.a.yb(f.a.ft));Xb.Xg.add(u.a.yb(f.a.t8));Xb.Xg.add(u.a.yb(aa.a.eH));return!0}static Eh(){return new Pa}static get instance(){return Pa.ih.value}}
Pa.ih=new l.a(Pa.Eh);Object(G.a)(Pa,"PageContentNodeComplexMerge",w.a,[]);class rb extends w.a{constructor(){super()}get Eo(){return 19}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.zEa),1);qb.Z(u.a.yb(f.a.YTa),2);qb.Z(u.a.yb(f.a.tka),2);qb.Z(u.a.yb(f.a.F7),1);return qb}OD(qb,Xb){const Cc=qb.gf;if(Xb===u.a.yb(f.a.zEa)){var Ec=Cc.getPropertyObjectIds(qb.jh.value.Ov,f.a.zEa),Wb=Cc.getPropertyObjectIds(qb.jh.value.Jf,f.a.zEa),Hb=Cc.getPropertyObjectIds(qb.Wo.value.Jf,f.a.zEa);if((Ec=this.DLn(Ec,Wb,Hb,(Sb,
cc)=>Sb.equals(cc),Sb=>{let cc;({value:cc}=qb.lu.runtime.sv.Dc(Sb)).returnValue?qb.lu.runtime.Yq.Z(Sb,new z.a(cc,!1)):x.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},qb.lu))&&0<Ec.length)return Cc.setPropertyObjectIds(qb.Rl,f.a.zEa,Ec),qb.Xg.add(u.a.yb(f.a.zEa)),!0}if(Xb===u.a.yb(f.a.F7))return Ec=Cc.getPropertyObjectIds(qb.jh.value.Ov,f.a.F7),Wb=Cc.getPropertyObjectIds(qb.jh.value.Jf,f.a.F7),Hb=Cc.getPropertyObjectIds(qb.Wo.value.Jf,
f.a.F7),Ec=this.AMa(Ec,Wb,Hb),Cc.setPropertyObjectIds(qb.Rl,f.a.F7,Ec),qb.Xg.add(Xb),!0;x.a.instance.Ua(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",qb.jh.value.Jf.id,Xb);return!1}static Eh(){return new rb}static get instance(){return rb.ih.value}}rb.ih=new l.a(rb.Eh);Object(G.a)(rb,"PageManifestNodeComplexMerge",w.a,[]);class tb extends w.a{constructor(){super()}get Eo(){return 43}Yk(){const qb=super.Yk();
qb.Z(u.a.yb(f.a.Sqa),0);qb.Z(u.a.yb(f.a.GXb),0);qb.Z(u.a.yb(f.a.CTb),0);qb.Z(u.a.yb(f.a.dta),1);qb.Z(u.a.yb(f.a.sessionId),3);qb.Z(u.a.yb(f.a.buildVersion),3);qb.Z(u.a.yb(f.a.IU),1);qb.Z(u.a.yb(f.a.TYi),1);qb.Z(u.a.yb(f.a.nw),1);return qb}OD(qb,Xb){if(Xb===u.a.yb(f.a.IU)||Xb===u.a.yb(f.a.TYi)||Xb===u.a.yb(f.a.nw)){var Cc=qb.Wo.value.Jf,Ec=qb.jh.value.Jf,Wb=u.a.J_(Xb);Ec=qb.gf.getPropertyBool(Ec,Wb);Cc=qb.gf.getPropertyBool(Cc,Wb);qb.gf.setPropertyBool(qb.Rl,Wb,null==Ec?!1:Ec&&null==Cc?!1:Cc);qb.Xg.add(Xb);
return!0}if(Xb===u.a.yb(f.a.dta)){Xb=qb.gf;Cc=qb.jh.value.Ov;Ec=qb.Wo.value.Jf;Wb=qb.jh.value.Jf;Cc=Cc?Xb.getPropertyObjectId(Cc,f.a.dta):null;Ec=Ec?Xb.getPropertyObjectId(Ec,f.a.dta):null;Wb=Wb?Xb.getPropertyObjectId(Wb,f.a.dta):null;x.a.instance.Ua(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",Cc?Cc.toString():"NULL",Ec?Ec.toString():"NULL",Wb?Wb.toString():"NULL");if(Ec){if(Wb&&Ec.equals(Wb))return qb.Xg.add(u.a.yb(f.a.dta)),Xb.setPropertyObjectId(qb.Rl,
f.a.dta,Ec),!0;if(wa.a.F$d.equals(Ec))return qb.Xg.add(u.a.yb(f.a.dta)),Xb.setPropertyObjectId(qb.Rl,f.a.dta,wa.a.F$d),!0}if(Wb&&wa.a.F$d.equals(Wb))return qb.Xg.add(u.a.yb(f.a.dta)),Xb.setPropertyObjectId(qb.Rl,f.a.dta,wa.a.F$d),!0;x.a.instance.Ua(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",Cc?Cc.toString():"NULL",Ec?Ec.toString():"NULL",Wb?Wb.toString():"NULL")}return!1}static Eh(){return new tb}static get instance(){return tb.ih.value}}tb.ih=new l.a(tb.Eh);
Object(G.a)(tb,"PageMetadataNodeComplexMerge",w.a,[]);var ob=d(1894),Oa=d(187);class Xa extends w.a{constructor(){super()}get Eo(){return 31}Yk(){const qb=super.Yk();qb.Z(u.a.yb(Oa.a.cC),1);qb.Z(u.a.yb(f.a.listID),3);qb.Z(u.a.yb(f.a.listLevel),1);qb.Z(u.a.yb(f.a.Qe),3);qb.Z(u.a.yb(f.a.Rdc),3);qb.Z(u.a.yb(f.a.runId),3);qb.Z(u.a.yb(f.a.V1d),3);qb.Z(u.a.yb(v.a.fontColor),3);qb.Z(u.a.yb(f.a.x6h),3);qb.Z(u.a.yb(f.a.Yc),1);qb.Z(u.a.yb(Oa.a.Ade),3);qb.Z(u.a.yb(Oa.a.r2f),3);qb.Z(u.a.yb(Oa.a.S9c),3);qb.Z(u.a.yb(f.a.Xbm),
3);qb.Z(u.a.yb(Yb.a.N5j),3);for(let Xb=0;Xb<Xa.gbb.length;Xb++)qb.Z(Xa.gbb[Xb],1);return qb}OD(qb,Xb){var Cc=qb.gf;const Ec=qb.Rl;u.a.J_(Xb);if(Xb===u.a.yb(f.a.Yc)){Cc=qb.gf.getPropertyInt32(qb.Wo.value.Jf,f.a.Yc);if(null==Cc||!Cc)return!0;qb.gf.setPropertyInt32(Ec,f.a.Yc,Cc);qb.Xg.add(Xb);return!0}if(Xb===u.a.yb(Oa.a.cC)){const Wb=Cc.getPropertyUint32(qb.jh.value.Jf,Oa.a.cC),Hb=Cc.getPropertyUint32(qb.Wo.value.Jf,Oa.a.cC);if(null!=Wb&&null!=Hb&&Wb===Hb)return Cc.setPropertyUint32(Ec,Oa.a.cC,Wb),
qb.Xg.add(Xb),!0;if(null==Wb&&null==Hb)return Ec.removeProperty(Oa.a.cC),qb.Xg.add(u.a.yb(Oa.a.cC)),!0;if(null!=Wb&&null==Hb)return Cc.setPropertyUint32(Ec,Oa.a.cC,Wb),qb.Xg.add(Xb),!0;if(null==Wb&&null!=Hb)return Cc.setPropertyUint32(Ec,Oa.a.cC,Hb),qb.Xg.add(Xb),!0}else{if(Xb===u.a.yb(f.a.listLevel))return this.Hpp(Cc,qb);if(Array.contains(Xa.gbb,Xb))return this.Gpp(qb)}return!1}Gpp(qb){let Xb=!0,Cc=!0,Ec,Wb;({Ein:Xb,Jfn:Cc,b6l:Ec,oyl:Wb}=this.Bol(qb));x.a.instance.Ua(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",
qb.jh.value.Jf.id.toString(),Xb,Cc);return Xb&&!Cc?(this.Pej(Wb,qb),!0):Xb?!1:(this.Pej(Ec,qb),!0)}Bol(qb){let Xb,Cc,Ec,Wb;const Hb=qb.Wo.value;let Sb;const cc=qb.jh.value;let Gc;Cc=Xb=!0;Ec=new I.a;Wb=new I.a;for(let Oc=0;Oc<Xa.gbb.length;Oc++){const Zc=Xa.gbb[Oc],kb=({value:Sb}=Hb.yNa.Dc(Zc)).returnValue;({value:Gc}=cc.yNa.Dc(Zc)).returnValue&&(Xb=this.S3j(qb.jh,Ec,Gc,Zc)&&Xb);kb&&(Cc=this.S3j(qb.Wo,Wb,Sb,Zc)&&Cc)}return{Ein:Xb,Jfn:Cc,b6l:Ec,oyl:Wb}}S3j(qb,Xb,Cc,Ec){const Wb=u.a.J_(Ec);qb=qb.value.Jf;
Xb.Z(Ec,qb.hasProperty(Wb)?qb.qI(Wb):null);return!Cc.B3}Pej(qb,Xb){const Cc=Xb.Rl;for(let Wb=0;Wb<Xa.gbb.length;Wb++){var Ec=Xa.gbb[Wb];const Hb=u.a.J_(Ec);(Ec=qb.J(Ec))?Cc.heb(Hb,Ec):Cc.removeProperty(Hb)}for(qb=0;qb<Xa.gbb.length;qb++)Xb.Xg.add(Xa.gbb[qb]);x.a.instance.Ua(578932994,1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",Xb.jh.value.Jf.id.toString())}Hpp(qb,Xb){const Cc=Xb.Rl,Ec=qb.getPropertyInt32(Xb.jh.value.Jf,f.a.listLevel),Wb=qb.getPropertyInt32(Xb.Wo.value.Jf,
f.a.listLevel);return null!=Ec&&null!=Wb&&Ec===Wb?(qb.setPropertyInt32(Cc,f.a.listLevel,Ec),Xb.Xg.add(u.a.yb(f.a.listLevel)),!0):null==Ec&&null==Wb?(Cc.removeProperty(f.a.listLevel),Xb.Xg.add(u.a.yb(f.a.listLevel)),!0):null!=Ec&&null==Wb?(qb.setPropertyInt32(Cc,f.a.listLevel,Ec),Xb.Xg.add(u.a.yb(f.a.listLevel)),!0):null==Ec&&null!=Wb?(qb.setPropertyInt32(Cc,f.a.listLevel,Wb),Xb.Xg.add(u.a.yb(f.a.listLevel)),!0):!1}static Eh(){return new Xa}static get instance(){return Xa.ih.value}}Xa.ih=new l.a(Xa.Eh);
Xa.gbb=[u.a.yb(f.a.fe),u.a.yb(f.a.mu),u.a.yb(v.a.g8),u.a.yb(f.a.wga),u.a.yb(f.a.Tw),u.a.yb(f.a.gt),u.a.yb(v.a.PU),u.a.yb(f.a.Gkf),u.a.yb(v.a.font),u.a.yb(Yb.a.Aub),u.a.yb(a.a.Yw)];Object(G.a)(Xa,"PersistablePropertySetComplexMerge",w.a,[]);class ab extends w.a{constructor(){super()}get Eo(){return 21}get NB(){return 0}static Eh(){return new ab}static get instance(){return ab.ih.value}}ab.ih=new l.a(ab.Eh);Object(G.a)(ab,"RevisionMetadataNodeComplexMerge",w.a,[]);class cb extends w.a{constructor(){super()}get Eo(){return 48}Yk(){const qb=
super.Yk();qb.Z(u.a.yb(f.a.nvj),3);return qb}static Eh(){return new cb}static get instance(){return cb.ih.value}}cb.ih=new l.a(cb.Eh);Object(G.a)(cb,"ShadowNumberListNodeComplexMerge",w.a,[]);class ib extends w.a{constructor(){super()}get Eo(){return 22}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.Xab),7);qb.Z(u.a.yb(f.a.x$c),2);return qb}static Eh(){return new ib}static get instance(){return ib.ih.value}}ib.ih=new l.a(ib.Eh);Object(G.a)(ib,"SharedPersistablePropertySetComplexMerge",w.a,[]);class Ub extends w.a{constructor(){super()}get Eo(){return 38}get NB(){return 3}static Eh(){return new Ub}static get instance(){return Ub.ih.value}}
Ub.ih=new l.a(Ub.Eh);Object(G.a)(Ub,"StylePropertySetComplexMerge",w.a,[]);class lb extends w.a{constructor(){super()}get Eo(){return 23}get NB(){return 0}Yk(){const qb=super.Yk();qb.Z(u.a.yb(v.a.wg),4);qb.Z(u.a.yb(f.a.rowSpan),1);qb.Z(u.a.yb(f.a.colSpan),1);qb.Z(u.a.yb(f.a.ghostCell),1);qb.Z(u.a.yb(aa.a.vMerge),1);qb.Z(u.a.yb(aa.a.gridSpan),1);qb.Z(u.a.yb(f.a.qfb),2);qb.Z(u.a.yb(f.a.Yzb),2);qb.Z(u.a.yb(f.a.UOa),2);return qb}LCa(qb){if(!qb)return x.a.instance.Ua(540120285,1,2,"Feature helper is null"),
!1;qb.JF(103);return qb.isFeatureEnabled(103)}OD(qb,Xb){qb.lu.runtime.dJ("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+Xb);let Cc=Xb===u.a.yb(f.a.rowSpan)||Xb===u.a.yb(f.a.colSpan)||Xb===u.a.yb(f.a.ghostCell);this.LCa(qb.lu.runtime.rc)&&(Cc=Cc||Xb===u.a.yb(aa.a.vMerge)||Xb===u.a.yb(aa.a.gridSpan));return!Cc}static Eh(){return new lb}static get instance(){return lb.ih.value}}lb.ih=new l.a(lb.Eh);Object(G.a)(lb,"TableCellNodeComplexMerge",w.a,[]);var Qb=d(1832);class fc extends w.a{constructor(){super()}get Eo(){return 24}get NB(){return 0}Yk(){const qb=
super.Yk();qb.Z(u.a.yb(v.a.wg),1);qb.Z(u.a.yb(v.a.Wna),1);qb.Z(u.a.yb(v.a.NEa),1);qb.Z(u.a.yb(f.a.izc),1);qb.Z(u.a.yb(f.a.$ca),1);qb.Z(u.a.yb(f.a.qfb),2);qb.Z(u.a.yb(f.a.Yzb),2);qb.Z(u.a.yb(f.a.UOa),2);return qb}OD(qb,Xb){qb.lu.runtime.dJ("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+Xb);if(Xb===u.a.yb(v.a.wg)||Xb===u.a.yb(v.a.Wna)||Xb===u.a.yb(f.a.izc)||Xb===u.a.yb(f.a.$ca)||Xb===u.a.yb(v.a.NEa)){const Ec=qb.Rl,Wb=qb.gf;x.a.instance.Ua(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Ec.id,Ec.yc,Xb);if(this.gWl(qb))return!1;var Cc=Wb.getPropertyObjectIds(qb.jh.value.Ov,v.a.wg);const Hb=Wb.getPropertyObjectIds(qb.jh.value.Jf,v.a.wg),Sb=Wb.getPropertyObjectIds(qb.Wo.value.Jf,v.a.wg);Cc=this.cej(Cc,Hb,Sb,(cc,Gc)=>cc.equals(Gc));if(0<Cc.length)return Wb.setPropertyObjectIds(Ec,v.a.wg,Cc),Wb.setPropertyInt32(Ec,v.a.NEa,Cc.length),qb.Xg.add(u.a.yb(v.a.wg)),qb.Xg.add(u.a.yb(v.a.Wna)),qb.Xg.add(u.a.yb(v.a.NEa)),qb.Xg.add(u.a.yb(f.a.izc)),qb.Xg.add(u.a.yb(f.a.$ca)),!0}x.a.instance.Ua(4018189,
1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",qb.jh.value.Jf.id,Xb);return!1}gWl(qb){const Xb=qb.Wo.value,Cc=qb.jh.value;let Ec,Wb;({value:Ec}=Xb.yNa.Dc(u.a.yb(v.a.Wna)));({value:Wb}=Cc.yNa.Dc(u.a.yb(v.a.Wna)));return Ec.B3||Wb.B3?Ec.B3&&Wb.B3?(x.a.instance.Ua(4273304,1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",Ec.oldValue,Wb.newValue,Ec.newValue),
qb.lu.logger.Oi(Object.assign(new Qb.a,{$j:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):fc.qhi(qb.lu,Ec,Cc,"BaseConflict")||fc.qhi(qb.lu,Wb,Xb,"BaseFavored")?!0:!1:!1}static Eh(){return new fc}static get instance(){return fc.ih.value}static qhi(qb,Xb,Cc,Ec){return Xb.B3&&({value:Xb}=Cc.yNa.Dc(u.a.yb(v.a.wg)),Xb.B3)?(x.a.instance.Ua(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",Ec),qb.logger.Oi(Object.assign(new Qb.a,
{$j:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}fc.ih=new l.a(fc.Eh);Object(G.a)(fc,"TableNodeComplexMerge",w.a,[]);class Fc extends w.a{constructor(){super()}get Eo(){return 25}get NB(){return 0}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.Yc),3);qb.Z(u.a.yb(v.a.wg),4);qb.Z(u.a.yb(f.a.qfb),2);qb.Z(u.a.yb(f.a.Yzb),2);qb.Z(u.a.yb(f.a.UOa),2);qb.Z(u.a.yb(aa.a.zHg),2);qb.Z(u.a.yb(aa.a.yHg),2);return qb}static Eh(){return new Fc}static get instance(){return Fc.ih.value}}Fc.ih=new l.a(Fc.Eh);Object(G.a)(Fc,
"TableRowNodeComplexMerge",w.a,[]);class nc extends w.a{constructor(){super()}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.Fhp),2);qb.Z(u.a.yb(v.a.wg),1);return qb}OD(qb,Xb){if(Xb===u.a.yb(v.a.wg)){const Ec=qb.Rl,Wb=qb.gf;x.a.instance.Ua(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ec.id,Ec.yc,Xb);var Cc=Wb.getPropertyObjectIds(qb.jh.value.Ov,v.a.wg);const Hb=Wb.getPropertyObjectIds(qb.jh.value.Jf,v.a.wg),Sb=Wb.getPropertyObjectIds(qb.Wo.value.Jf,
v.a.wg);if(Cc=this.OLn(Cc,Hb,Sb))return 0<Cc.length?Wb.setPropertyObjectIds(Ec,v.a.wg,Cc):Ec.removeProperty(v.a.wg),qb.Xg.add(u.a.yb(v.a.wg)),!0}x.a.instance.Ua(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",qb.jh.value.Jf.id,Xb);return!1}OLn(qb,Xb,Cc){const Ec=new I.a(0);qb.forEach(Hb=>{Ec.Z(Hb,0);return!0});Xb.forEach(Hb=>{Ec.mb(Hb)?Ec.Z(Hb,1):Ec.Z(Hb,3);return!0});Cc.forEach(Hb=>{let Sb;({value:Sb}=Ec.Dc(Hb)).returnValue?
1===Sb?Ec.Z(Hb,5):3===Sb?(x.a.instance.Ua(42754253,1,2,"TaskNode was found added by both sides of merge"),Ec.Z(Hb,3)):Ec.Z(Hb,2):Ec.Z(Hb,4);return!0});const Wb=new N.a;Ec.forEach((Hb,Sb)=>{0!==Sb&&2!==Sb&&1!==Sb&&Wb.add(Hb);return!0});return Wb}static Eh(){return new nc}static get instance(){return nc.ih.value}}nc.ih=new l.a(nc.Eh);Object(G.a)(nc,"TaskContentNodeComplexMerge",w.a,[]);class zb{equals(qb,Xb){return qb&&Xb?qb.UserId===Xb.UserId&&qb.Provider===Xb.Provider&&qb.DisplayName===Xb.DisplayName&&
qb.Email===Xb.Email:!qb&&!Xb}pN(){return 0}}Object(G.a)(zb,"CommentTaskPersonComparer",null,[15]);class Vb{equals(qb,Xb){return qb&&Xb?qb.startDate?qb.endDate?qb.startDate.getTime()===Xb.startDate.getTime()&&qb.endDate.getTime()===Xb.endDate.getTime():!Xb.endDate:!Xb.startDate:!qb&&!Xb}pN(){return 0}}Object(G.a)(Vb,"CommentTaskScheduleEqualityComparer",null,[15]);class rc{equals(qb,Xb){if(!qb||!Xb)return!qb&&!Xb;if(!qb.extensions&&!Xb.extensions)return!0;if(!qb.extensions||!Xb.extensions||qb.extensions.count!==
Xb.extensions.count)return!1;let Cc=!0;qb.extensions.forEach((Ec,Wb)=>{let Hb;return({value:Hb}=Xb.extensions.Dc(Ec)).returnValue&&Wb===Hb?!0:Cc=!1});return Cc}pN(){return 0}}Object(G.a)(rc,"ExtensionListEqualityComparer",null,[15]);class pb{B2l(qb,Xb){return qb&&Xb?qb.recordId===Xb.recordId&&pb.jch.equals(qb.user,Xb.user)&&pb.jch.equals(qb.assignee,Xb.assignee)&&qb.type===Xb.type&&qb.title===Xb.title&&qb.priority===Xb.priority&&qb.isLossy===Xb.isLossy&&qb.completion===Xb.completion&&qb.commentId===
Xb.commentId&&qb.time===Xb.time&&pb.hrk.equals(qb.schedule,Xb.schedule):!qb&&!Xb}equals(qb,Xb){return this.B2l(qb,Xb)}pN(){return 0}}pb.jch=new zb;pb.hrk=new Vb;new rc;Object(G.a)(pb,"HistoryRecordEqualityComparer",null,[15]);var bb=d(2229),Pb=d(1631);class mb extends w.a{constructor(qb){super();this.rTa=qb}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.y1b),5);qb.Z(u.a.yb(f.a.taskId),2);qb.Z(u.a.yb(f.a.qhp),2);qb.Z(u.a.yb(f.a.vhp),2);qb.Z(u.a.yb(f.a.QEa),1);return qb}IKg(qb){if(!qb.Wo.value.Ov&&!qb.jh.value.Ov){const Xb=
qb.jh.value.Jf.WO();Xb.removeProperty(f.a.QEa);const Cc=qb.jh.value.Jf,Ec=qb.Wo.value.Jf;qb.jh=new l.a(()=>new Pb.a(Xb,Cc));qb.Wo=new l.a(()=>new Pb.a(Xb,Ec))}return super.IKg(qb)}OD(qb,Xb){if(Xb!==u.a.yb(f.a.QEa))return x.a.instance.Ua(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",qb.jh.value.Jf.id,Xb),!1;const Cc=qb.Rl,Ec=qb.gf;x.a.instance.Ua(42754255,1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Cc.id,Cc.yc,Xb);Xb=Ec.getPropertyString(qb.jh.value.Ov,f.a.QEa);const Wb=Ec.getPropertyString(qb.jh.value.Jf,f.a.QEa),Hb=Ec.getPropertyString(qb.Wo.value.Jf,f.a.QEa);Xb=this.NLn(Xb,Wb,Hb);if(!Xb)return!1;0<Xb.length?Ec.setPropertyString(Cc,f.a.QEa,Xb):Cc.removeProperty(f.a.QEa);qb.Xg.add(u.a.yb(f.a.QEa));return!0}NLn(qb,Xb,Cc){qb=this.rTa.Tgc(qb);Xb=this.rTa.Tgc(Xb);Cc=this.rTa.Tgc(Cc);if(!mb.b1i(qb,Xb))return x.a.instance.Ua(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),
null;if(!mb.b1i(qb,Cc))return x.a.instance.Ua(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;Cc=mb.jvl(qb.length,Xb,Cc);return this.rTa.Fyg(Cc)}static Eh(){const qb=new bb.a;return new mb(qb)}static get instance(){return mb.ih.value}static jvl(qb,Xb,Cc){const Ec=new N.a;for(let Wb=0;Wb<Xb.length;Wb++)Ec.add(Xb.J(Wb));for(;qb<Cc.length;qb++)Ec.add(Cc.J(qb));return Ec}static b1i(qb,Xb){const Cc=qb.length;if(Cc>Xb.length)return!1;for(let Ec=0;Ec<Cc;Ec++)if(!mb.uyk.equals(Xb.J(Ec),
qb.J(Ec)))return Xb.J(Ec).recordId===qb.J(Ec).recordId&&x.a.instance.Ua(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}mb.ih=new l.a(mb.Eh);mb.uyk=new pb;Object(G.a)(mb,"TaskSingleNodeComplexMerge",w.a,[]);class Ua extends w.a{constructor(){super()}get Eo(){return 26}Yk(){const qb=super.Yk();qb.Z(u.a.yb(v.a.wg),1);return qb}OD(qb,Xb){const Cc=v.a.wg;if(Xb===u.a.yb(Cc)){Xb=qb.Rl;const Wb=qb.gf;var Ec=Wb.getPropertyObjectIds(qb.jh.value.Ov,
Cc);const Hb=Wb.getPropertyObjectIds(qb.jh.value.Jf,Cc),Sb=Wb.getPropertyObjectIds(qb.Wo.value.Jf,Cc);Ec=this.VLn(Ec,Hb,Sb);Wb.setPropertyObjectIds(Xb,Cc,Ec);qb.Xg.add(u.a.yb(Cc));return!0}return!1}VLn(qb,Xb,Cc){return this.AMa(qb,Xb,Cc)}static Eh(){return new Ua}static get instance(){return Ua.ih.value}}Ua.ih=new l.a(Ua.Eh);Object(G.a)(Ua,"VectorClockContainerNodeComplexMerge",w.a,[]);class vb extends w.a{constructor(){super()}get Eo(){return 27}Yk(){const qb=super.Yk();qb.Z(u.a.yb(f.a.g1),1);return qb}OD(qb,
Xb){const Cc=f.a.g1;if(Xb===u.a.yb(Cc)){Xb=qb.Rl;const Ec=qb.gf,Wb=Ec.getPropertyUint32(qb.jh.value.Jf,Cc)||0,Hb=Ec.getPropertyUint32(qb.Wo.value.Jf,Cc)||0;Ec.setPropertyUint32(Xb,Cc,this.Azm(Wb,Hb));qb.Xg.add(u.a.yb(Cc));return!0}return!1}Azm(qb,Xb){return qb>Xb?qb:Xb}static Eh(){return new vb}static get instance(){return vb.ih.value}}vb.ih=new l.a(vb.Eh);Object(G.a)(vb,"VectorClockNodeComplexMerge",w.a,[]);class Ia extends w.a{constructor(){super()}get Eo(){return 28}get NB(){return 0}Yk(){const qb=
super.Yk();qb.Z(u.a.yb(f.a.Vyf),3);qb.Z(u.a.yb(f.a.Yc),3);qb.Z(u.a.yb(f.a.Lhi),5);qb.Z(u.a.yb(f.a.i9f),5);qb.Z(u.a.yb(f.a.yna),5);return qb}static Eh(){return new Ia}static get instance(){return Ia.ih.value}}Ia.ih=new l.a(Ia.Eh);Object(G.a)(Ia,"WordSectionNodeComplexMerge",w.a,[]);d.d(J,"a",function(){return Ma});class Ma{H$h(qb,Xb){switch(qb.yc){case m.a.Vma:return qb.hasProperty(f.a.imageType)||qb.hasProperty(a.a.h0)?this.Zp(ja.instance,Xb):this.Zp(Xa.instance,Xb);case m.a.idc:return this.Zp(y.instance,
Xb);case m.a.tIa:return this.Zp(A.instance,Xb);case m.a.mKb:return this.Zp(D.instance,Xb);case m.a.ldc:return this.Zp(F.instance,Xb);case m.a.YTa:return this.Zp(O.instance,Xb);case m.a.BIa:return this.Zp(V.instance,Xb);case m.a.Aza:return this.Zp(Y.instance,Xb);case m.a.Kmb:return this.Zp(Q.instance,Xb);case m.a.bka:return this.Zp(S.instance,Xb);case m.a.lL:return this.Zp(Z.instance,Xb);case m.a.Ud:return this.Zp(ma.instance,Xb);case m.a.Cra:return this.Zp(X.instance,Xb);case m.a.tka:return this.Zp(na.instance,
Xb);case m.a.eR:return this.Zp(Fa.instance,Xb);case m.a.$Ja:return this.Zp(Qa.instance,Xb);case m.a.Gka:return this.Zp(ya.instance,Xb);case m.a.uKa:return this.Zp(ta.instance,Xb);case m.a.Waa:return this.Zp(Aa.instance,Xb);case m.a.HWa:return this.Zp(za.instance,Xb);case m.a.TWa:return this.Zp(ja.instance,Xb);case m.a.tI:return this.Zp(ja.instance,Xb);case m.a.BWf:return this.Zp(fa.instance,Xb);case m.a.CWf:return this.Zp(Ca.instance,Xb);case m.a.Ace:return this.Zp(xa.instance,Xb);case m.a.DWf:return this.Zp(ua.instance,
Xb);case m.a.EWf:return this.Zp(sa.instance,Xb);case m.a.F7:return this.Zp(Ea.instance,Xb);case m.a.$bb:return this.Zp(ub.instance,Xb);case m.a.$X:return this.Zp(yb.instance,Xb);case m.a.iH:return this.Zp(Za.instance,Xb);case m.a.Sh:return this.Zp(Pa.instance,Xb);case m.a.fXb:return this.Zp(tb.instance,Xb);case m.a.ADa:return this.Zp(rb.instance,Xb);case m.a.paragraphNode:return this.Zp(ob.a.instance,Xb);case m.a.Zvc:return this.Zp(ab.instance,Xb);case m.a.H_a:return this.Zp(ib.instance,Xb);case m.a.hzb:return this.Zp(Ub.instance,
Xb);case m.a.Yca:return this.Zp(lb.instance,Xb);case m.a.xp:return this.Zp(fc.instance,Xb);case m.a.Yna:return this.Zp(Fc.instance,Xb);case m.a.a3b:return this.Zp(Ua.instance,Xb);case m.a.XOa:return this.Zp(nc.instance,Xb);case m.a.zzc:return this.Zp(mb.instance,Xb);case m.a.nGe:return this.Zp(vb.instance,Xb);case m.a.xoa:return this.Zp(Ia.instance,Xb);case m.a.JWf:return this.Zp(nb.instance,Xb);case m.a.GWf:return this.Zp(Ja.instance,Xb);case m.a.FBa:return this.Zp(oa.instance,Xb);case m.a.apd:return this.Zp(cb.instance,
Xb)}return this.Zp(w.a.instance,Xb)}Zp(qb,Xb){qb.rc=Xb?Xb():null;return qb}}Object(G.a)(Ma,"GraphNodeComplexMergeFactory",null,[998])},2087:function(G,J,d){d.r(J);G=d(0);var m=d(1601),f=d(77),a=d(372),l=d(84),w=d(1572);class y{constructor(H,N,M,U=0){this.eMi=H;this.groupType=N;this.ERf=U;this.emd=M}}Object(G.a)(y,"SortingGroup",null,[]);class v{constructor(H,N,M,U){this.order=H;this.mba=N;this.ETm=M;this.groupType=U}}Object(G.a)(v,"SortingProp",null,[]);var u=d(1565),x=d(1567),z=d(1563),A=d(29);class D{constructor(H,
N){this.Zbj={};this.Ybj={};this.Ubj=this.fcj=1;this.sYh(H,N)}t$o(H,N,M){var U=z.a.EU(M)?this.Zbj:this.Ybj;M=new f.a;for(var O of N)N=Object(l.a)(v,U[m.a[O.groupType].toLowerCase()]),A.c(N)||M.add(new a.a(N,O));M.Sc((Y,Q)=>Y.key.order<Q.key.order?-1:1);Array.clear(H);O=u.TellMeActor.instance.m2;for(N=0;N<M.count;){U=M.J(N).key.mba;var V=M.J(N).value;const Y=new w.a(M.J(N).key.groupType);A.c(O)||O.Location===x.a.contextMenu||(Y.displayName=M.J(N).key.ETm);for(const Q of V.results)Y.hy(Q);for(V=++N;V<
M.count&&M.J(V).key.mba===U;)this.Dff(Y,M.J(V).value),V=++N;H.push(Y)}}Fzp(H,N){this.Ubj=this.fcj=1;this.sYh(H,N)}sYh(H,N){this.vWj(H);for(var M=0;M<H.length;M++){const U=H[M];for(const O of U.emd)this.WWk(O,M,U.eMi,U.groupType)}this.vWj(N);for(H=0;H<N.length;H++){M=N[H];for(const U of M.emd)this.VWk(U,H,M.eMi,M.groupType)}}vWj(H){H.sort((N,M)=>Object(l.a)(y,N).ERf>Object(l.a)(y,M).ERf?-1:1)}WWk(H,N,M,U){this.Zbj[m.a[H].toLowerCase()]=new v(this.fcj++,N,M,U)}VWk(H,N,M,U){this.Ybj[m.a[H].toLowerCase()]=
new v(this.Ubj++,N,M,U)}Dff(H,N){for(let M=0;M<N.results.length;M++)H.hy(N.results[M])}}Object(G.a)(D,"BaseGroupingSorter",null,[]);class F{constructor(){this.yje=[new y("",26,[26]),new y("",24,[24]),new y(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new y(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new y("",13,[13]),new y("",22,[22])];this.tje=[new y("",25,[25]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,
31,[17,0,1,8,28]),new y(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new y(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new y("",13,[13]),new y("",22,[22])];this.Fbj=new D(this.yje,this.tje)}nqd(H,N,M,U=null,O=null){let V=!1;if(U){for(const Y of z.a.EU(M)?this.yje:this.tje)this.hno(Y,U);V=!0}if(O){for(const Y of z.a.EU(M)?this.yje:this.tje)this.Gzp(N,Y,O);V=!0}V&&this.Fbj.Fzp(this.yje,this.tje);this.Fbj.t$o(H,N,M)}hno(H,N){const M=new f.a;
for(var U of H.emd){const O=N[m.a[U].toLowerCase()];M.add(new a.a(A.c(O)?Number.MAX_VALUE:O,U))}if(M.count){M.Sc((O,V)=>O.key<V.key?-1:1);N=Array(M.count);for(U=0;U<M.count;U++)N[U]=M.J(U).value;H.emd=N}}Gzp(H,N,M){let U=0;for(const O of N.emd)if(m.a[O].toLowerCase()in M&&M[m.a[O].toLowerCase()])for(const V of H)if(V.groupType===O){U+=M[m.a[O].toLowerCase()];break}N.ERf=U}}Object(G.a)(F,"SimplifiedGroupingSorter",null,[]);d.d(J,"GroupsPlacementInfo",function(){return I});class I{constructor(H){this.Xbj=
{};this.Vbj={};this.Wbj={};this.$bj={};this.Q7f={};this.acj=this.jHn=this.eHn=this.gHn=1;this.ccj=null;this.Hx=H;this.jhl();this.Cco();this.Ygl();this.cgl();H.uS&&(this.ccj=new F)}BG(H){this.Xbj[m.a[H].toLowerCase()]=this.gHn++}HJ(H,N){this.Vbj[m.a[H].toLowerCase()]=N}ITa(H){this.Wbj[m.a[H].toLowerCase()]=this.eHn++}x6(H){this.$bj[m.a[H].toLowerCase()]=this.jHn++}nF(H){this.Q7f[m.a[H].toLowerCase()]=this.acj++}jhl(){const H=!!this.Hx&&this.Hx.Pab,N=!!this.Hx&&this.Hx.igd,M=!!this.Hx&&this.Hx.Ptb,
U=!!this.Hx&&this.Hx.A1f&&!z.a.vpc(),O=!!this.Hx&&this.Hx.nad,V=!!this.Hx&&this.Hx.lde,Y=!!this.Hx&&this.Hx.F_f,Q=!!this.Hx&&this.Hx.qXf;this.Hx&&(this.Hx.Qhc||this.Hx.Hka||this.Hx.m1d)&&this.BG(26);Q&&this.BG(24);this.BG(4);this.BG(18);this.BG(16);this.BG(7);this.BG(17);this.BG(0);this.BG(1);Y&&this.BG(28);O&&this.BG(23);H||this.BG(2);H&&!N||this.BG(8);this.BG(15);M&&this.BG(20);this.BG(14);this.BG(9);this.BG(12);this.BG(10);this.BG(11);H&&this.BG(2);H&&!N&&this.BG(8);this.BG(19);V&&this.BG(27);
this.BG(21);this.BG(13);U&&this.BG(22);this.BG(30)}Cco(){this.HJ(21,1);this.HJ(4,3);this.HJ(18,3);this.HJ(16,3);this.HJ(7,3);this.HJ(17,5);this.HJ(0,5);this.HJ(1,1);this.HJ(28,2);this.HJ(2,1);this.HJ(8,2);this.HJ(15,3);this.HJ(14,2);this.HJ(27,3);this.HJ(9,1);this.HJ(12,1);this.HJ(10,1);this.HJ(11,1);this.HJ(19,1);this.HJ(23,1);this.HJ(13,1);this.HJ(24,1);this.HJ(25,1);this.HJ(20,2);this.HJ(22,1);this.HJ(26,1)}Ygl(){this.ITa(4);this.ITa(0);this.ITa(17);this.ITa(7);this.ITa(16);this.ITa(18);this.ITa(15);
this.ITa(20);this.ITa(8);this.ITa(14)}cgl(){this.x6(14);this.x6(10);this.x6(12);this.x6(9);this.x6(11);this.x6(20);this.x6(15);this.x6(8);this.x6(2);this.x6(1);this.x6(27);this.x6(7);this.x6(18);this.x6(16);this.x6(17);this.x6(0);this.x6(4)}TFo(){this.Q7f={};this.acj=1}eJm(H,N,M){this.TFo();const U=!!this.Hx&&this.Hx.Pab,O=!!this.Hx&&this.Hx.igd,V=!!this.Hx&&this.Hx.Ptb,Y=!!this.Hx&&this.Hx.A1f&&!z.a.vpc(),Q=!!this.Hx&&this.Hx.nad,S=!!this.Hx&&this.Hx.lde,P=!!this.Hx&&this.Hx.F_f,T=!!this.Hx&&this.Hx.uze;
H=H&&O;T&&this.nF(25);this.nF(4);this.nF(18);this.nF(16);this.nF(7);this.nF(17);this.nF(0);this.nF(1);P&&this.nF(28);Q&&this.nF(23);U&&!O||!H||this.nF(8);N&&this.nF(15);U||this.nF(2);S&&this.nF(27);M&&this.nF(14);U&&!O||H||this.nF(8);N||this.nF(15);V&&this.nF(20);M||this.nF(14);this.nF(9);this.nF(12);this.nF(10);this.nF(11);U&&this.nF(2);U&&!O&&this.nF(8);this.nF(19);this.nF(21);this.nF(13);Y&&this.nF(22);return this.Q7f}yR(){return this.Hx}}Object(G.a)(I,"GroupsPlacementInfo",null,[])},2089:function(G,
J,d){d.r(J);G=d(0);var m=d(1748),f=d(1640),a=d(1601),l=d(1888),w=d(1639);class y{constructor(I="",H="",N="",M=-99999,U=-1,O=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=I?I:"";this.Description=H?H:"";this.Type=N?N:"";this.Score=M;this.Age=U;this.Count=O}}Object(G.a)(y,"Suggestion",null,[]);class v{constructor(I,H){this.GroupType=this.Suggestions=null;this.Suggestions=I;this.GroupType=H}}Object(G.a)(v,"SuggestionGroup",null,[]);class u{}u.emc="help";u.G5k=
"answer";u.commands="commands";u.aQo="servicecommands";u.template="template";Object(G.a)(u,"SuggestionGroupType",null,[]);var x=d(1565),z=d(1563),A=d(2),D=d(34);d.d(J,"InteractionLogger",function(){return F});class F{constructor(I,H,N){this.nRe=0;this.saf=this.HKc=null;this.Kc=I;this.A9e=this.BOe=this.hWe=!1;this.ksk=H;this.Af=A.AFrameworkApplication.Be;this.kc=N;this.xzd=this.f4e=0}get fva(){return this.Kc.fva}tye(I){this.Kc.tye(I)}saj(){if(this.HKc){var I=0;for(const H of this.HKc)this.Kc.bFn(H,
I++);this.HKc=null}}beginQuery(I,H,N){this.Kc.TEn(I,H,N)}Jvb(I,H){this.Kc.ccl(I,H);this.hWe=!0;this.A9e=!1}lDa(){this.hWe=!1;this.BOe||(this.saj(),this.Kc.fki(this.nRe))}UEn(I,H){this.Kc.VEn(I,H)}TVn(I,H,N,M,U){for(const O of this.ksk)if(I.startsWith(O)){this.A9e=!0;break}this.Kc.jCn(I,H,N,M,U)}vWn(I){this.BOe=!1;this.nRe=I;this.hWe||this.A9e||(this.saj(),this.Kc.fki(this.nRe,!1))}uWn(I,H){this.Kc.pCn(I,H);this.BOe=!0}nGf(I,H){if(!I.count)return"";let N="";const M=Date.now();for(const U of I)I=(M-
U.timeStamp)/1E3,I=z.a.YDe(I),0<N.length&&(N+=";"),N+=H?U.commandId:U.controlId,N+=":",N+=I.toString();return N}ecb(){var I=this.nGf(m.a.instance.x2c(),!1);0<I.length&&this.Kc.hCn(I);I=this.nGf(m.a.instance.iqb(),!0);0<I.length&&this.Kc.zBn(I);I=this.nGf(m.a.instance.BHc,!0);0<I.length&&this.Kc.bDn(I);I=x.TellMeActor.instance.Fvh;0<I.length&&this.Kc.REn(D.c(I))}mFn(I){this.Kc.OBn(I)}aca(I,H,N,M,U,O,V,Y=null){this.Kc.WDn(I,H,N,M,U,O,V,Y)}L6f(I,H,N,M){this.Kc.L6f(I,H,N,M)}gC(I,H,N=null){this.Kc.FI(I,
H,N)}onError(I,H,N=null){this.Kc.oua(I,H,N)}OUo(I){this.HKc=I}oMm(I){const H=[];if(!I)return H;for(let N=0;N<I.length;N++){const M=a.a[I[N].groupType].toLowerCase(),U=[],O=I[N].results;if(O){for(let V=0;V<O.length;V++)"findindocument"===M?Array.add(U,new y("","",M,O[V].score,O[V].mSd,O[V].count)):Array.add(U,new y(O[V].label,O[V].description,M,O[V].score,O[V].mSd,O[V].count));"answer"===M||"definition"===M||"wolframanswer"===M||"entity"===M?Array.add(H,new v(U,u.G5k)):"classifier"===M||"appsforoffice"===
M?Array.add(H,new v(U,u.commands)):"serviceclassifier"===M?Array.add(H,new v(U,u.aQo)):"assistance"===M?Array.add(H,new v(U,u.emc)):("document"===M||"people"===M||"findindocument"===M||"notes"===M||"image"===M||"template"===M)&&Array.add(H,new v(U,M))}}return H}BOf(I,H){const N={};N.Query=H;N.SuggestionGroups=D.c(this.oMm(I));return D.c(N)}YIi(I){const H={"Content-Type":"application/json",Accept:"application/json"};H["X-Office-Version"]=A.AFrameworkApplication.buildVersion;H["X-Office-Application"]=
A.AFrameworkApplication.K.kb("Application");H["X-Office-Platform"]="WAC";H["X-TellMe-SqmUserId"]=A.AFrameworkApplication.K.kb("LoggableUserId")||"";H["X-TellMe-SessionId"]=this.Kc.fva.xta;H["X-TellMe-SuggestionTypes"]="Ranker";H["X-TellMe-Culture"]=A.AFrameworkApplication.uiCulture;H["X-TellMe-ProcessSessionId"]=A.AFrameworkApplication.userSessionId;H["X-TellMe-Flights"]=I;H["X-TellMe-PartialQueryIndex"]=this.f4e;return H}SWb(I,H,N){this.aca(H.length,"RankerLogging",I.data.He.toString(),Math.round(window.performance.now()-
N),w.a.Y_j,!0,f.a.OWa)}zWb(I,H,N){this.aca(H.length,"RankerLogging",I.data.He.toString(),Math.round(window.performance.now()-N),w.a.Y_j,!1,f.a.OWa)}ZIi(){this.saf||(this.saf=new l.a(this.kc,null,6E3));return this.saf.sda}N6f(I){const H=this.BOf(this.HKc,I),N=this.YIi("RankerLogging"),M=window.performance.now();this.Af.Ij(this.ZIi(),2,H,N,!1,0,U=>{this.SWb(U,I,M)},U=>{this.zWb(U,I,M)},null,null,!1,4E3,6E3);this.f4e++}IFo(){this.f4e=0}tzg(I){this.xzd=I}}Object(G.a)(F,"InteractionLogger",null,[])},2090:function(G,
J,d){G=d(0);var m=d(1824),f=d(54);class a{constructor(){this.source=0;this.pl=this.k1a=this.cda=null;this.xma=0;this.LRb=!1;this.mode=this.X_a=0;this.o0c=null;this.BVb=f.a.create()}}Object(G.a)(a,"InputState",null,[]);class l{constructor(){this.timeout=this.succeeded=this.fAa=!1;this.XL=null}}Object(G.a)(l,"OutputState",null,[]);class w{constructor(){this.sSi=this.Aze=this.zpd=!1;this.rc=this.fke=this.vjg=this.Bte=this.tgp=this.Axl=this.oUa=this.dJ=this.kvb=this.syc=this.Frp=this.c6l=this.Yq=this.Awf=
this.sv=this.NA=this.In=this.GEe=this.O2d=this.dJa=null}}Object(G.a)(w,"RuntimeState",null,[]);d.d(J,"a",function(){return y});class y{constructor(){this.input=new a;this.runtime=new w;this.output=new l;this.logger=new m.a(this)}}Object(G.a)(y,"MergeState",null,[])},2091:function(G,J,d){d.r(J);G=d(0);var m=d(651),f=d(233),a=d(192),l=d(122),w=d(1712),y=d(1831),v=d(1876),u=d(5),x=d(2082);class z{constructor(M,U){this.start=M;this.end=U}}Object(G.a)(z,"MergeDiffIdx",null,[]);class A{constructor(M,U,
O,V=!1,Y=null,Q=null,S=!0){this.fAd=this.eAd=this.ifh=this.FLc=0;this.Fbc=this.LLe=null;this.Cib=Y||new x.a;this.vg=O;this.Kwa=M.wOa();this.PRk=U.wOa();this.WS=new z(0,0);this.tW=new z(0,0);this.JVe=V;this.VIc=S;this.oxa=Q;this.ijl();this.CVo()}get ZM(){return this.Kwa}get uM(){return this.PRk}get $A(){return this.FLc}get OB(){return this.ifh}get AAa(){return this.eAd}get $ra(){return this.fAd}get ITl(){const M=new f.a;for(let U=this.LLe.start;U<this.LLe.end;U++)M.add(this.ZM.sg(U));return M}get Txf(){const M=
new f.a;for(let U=this.Fbc.start;U<this.Fbc.end;U++)M.add(this.uM.sg(U));return M}jzf(M){if(this.OB<M.OB){if(this.OB+this.AAa>M.OB)return!0}else if(this.OB>M.OB){if(M.OB+M.AAa>this.OB)return!0}else if(2===this.$A&&3===M.$A||3===this.$A&&2===M.$A||2===this.$A&&2===M.$A||3===this.$A&&3===M.$A)return!0;return!1}SEj(M,U,O,V){M.dI(U);M.pD(U,O);return V+=O.length-1}TWj(M,U,O,V,Y){let Q=this.ZM.sg(M),S=this.uM.sg(U);if(!Q||!S||!Q.Reb&&!S.Reb)return{returnValue:!1,CIa:V,CPa:Y};let P=new f.a,T=new f.a;Q.Reb&&
(P=Q.wqd(),Q=P.sg(O?0:P.length-1));S.Reb&&(T=S.wqd(),S=T.sg(O?0:T.length-1));if(!Q.$B(S,this.Cib,this.oxa,this.JVe,this.VIc))return{returnValue:!1,CIa:V,CPa:Y};P.length&&(V=this.SEj(this.ZM,M,P,V));T.length&&(Y=this.SEj(this.uM,U,T,Y));return{returnValue:!0,CIa:V,CPa:Y}}O8l(M,U,O,V,Y,Q){for(;Y<=O&&Q<=V;){const S=M.sg(Y),P=U.sg(Q);if(!S.$B(P,this.Cib,this.oxa,this.JVe,this.VIc))break;this.WS.start+=S.length;this.tW.start+=P.length;Y++;Q++}return{Fkf:Y,VLg:Q}}M8l(M,U,O,V,Y,Q){for(;Y>=O&&Q>=V;){const S=
M.sg(Y),P=U.sg(Q);if(!S.$B(P,this.Cib,this.oxa,this.JVe,this.VIc))return{returnValue:!0,CIa:Y,CPa:Q};Y--;Q--}return{returnValue:!1,CIa:Y,CPa:Q}}N8l(M,U,O,V){let Y=!1;do({Fkf:M,VLg:U}=this.O8l(this.ZM,this.uM,O,V,M,U)),{CIa:O,CPa:V,returnValue:Y}=this.TWj(M,U,!0,O,V);while(Y);return{Fkf:M,VLg:U,CIa:O,CPa:V}}L8l(M,U,O,V){let Y=!1;do{if(!({CIa:O,CPa:V}=this.M8l(this.ZM,this.uM,M,U,O,V)).returnValue)break;({CIa:O,CPa:V,returnValue:Y}=this.TWj(O,V,!1,O,V))}while(Y);return{CIa:O,CPa:V}}ijl(){var M=0,U=
0,O=this.ZM.length-1,V=this.uM.length-1;0<=O&&this.ZM.sg(O);0<=V&&this.uM.sg(V);({Fkf:M,VLg:U,CIa:O,CPa:V}=this.N8l(M,U,O,V));if(M<O||U<V)({CIa:O,CPa:V}=this.L8l(M,U,O,V));O++;V++;this.LLe=new z(M,O);this.Fbc=new z(U,V);this.WS.end=this.WS.start;this.tW.end=this.tW.start;for(var Y=M;Y<O;Y++){var Q=this.ZM.sg(Y);this.WS.end+=Q.length}for(Y=U;Y<V;Y++)Q=this.uM.sg(Y),this.tW.end+=Q.length;a.a.instance.Ua(3993809,1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",
M,O,U,V);a.a.instance.Ua(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.WS.start,this.WS.end,this.tW.start,this.tW.end);this.WS.start<=this.WS.end&&this.tW.start<=this.tW.end&&(M=this.ZM.sg(M),U=this.uM.sg(U),Y=this.ZM.sg(O),Q=this.uM.sg(V),O=this.ZM.sg(O-1),V=this.uM.sg(V-1),a.a.instance.Ua(3993811,1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",
M,Y,U,Q,O,V))}CVo(){this.ifh=this.WS.start;this.eAd=this.fAd=0;this.WS.start===this.WS.end&&this.tW.start===this.tW.end?this.FLc=0:this.WS.start===this.WS.end&&this.tW.start<this.tW.end?(this.FLc=1,this.fAd=this.tW.end-this.tW.start):this.tW.start===this.tW.end&&this.WS.start<this.WS.end?(this.FLc=2,this.eAd=this.WS.end-this.WS.start):(this.FLc=3,this.eAd=this.WS.end-this.WS.start,this.fAd=this.tW.end-this.tW.start);a.a.instance.Ua(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",
this.$A,this.OB,this.AAa,this.$ra)}qmn(M,U){return M.V7()&&U.V7()?M.runId===U.runId&&M.Rg===U.Rg:!1}Trn(M){if(!M.V7()||"\ufffc"!==M.text)return!1;M=M.WOb;return M?M.hasProperty(u.a.nk)||M.hasProperty(u.a.TTd)||M.hasProperty(u.a.Mzf)||M.hasProperty(u.a.n7)||M.hasProperty(u.a.imageType)||M.hasProperty(u.a.QXa)||M.hasProperty(u.a.FTb)||M.hasProperty(u.a.mt)&&(M=this.vg.getPropertyInt32(M,u.a.mt))&&(36===M||35===M||24===M||23===M||33===M||34===M||44===M||45===M||42===M||43===M)?!0:!1:!1}$9c(M){return M.V7()&&
!this.Trn(M)}Mkl(){if(2===this.$A)return!1;var M=this.Fbc.start;if(!M)return!1;let U=null;for(var O=this.Fbc.start;O<this.Fbc.end;O++){const V=this.uM.sg(O);if(this.$9c(V)){U=V;break}}if(!U)return!1;--M;for(O=this.uM.sg(M);O&&!this.$9c(O);)M--,O=this.uM.sg(M);return O&&this.qmn(O,U)?!0:!1}lzi(M){const U=new f.a;for(let O=0;O<M.length;O++)M.J(O).Reb?U.pD(U.length,M.J(O).wqd()):U.insert(U.length,M.J(O));return U}smn(){if(3!==this.$A||this.AAa!==this.$ra)return!1;const M=this.lzi(this.ITl),U=this.lzi(this.Txf);
if(M.length!==U.length)return!1;for(let O=0;O<M.length;O++)if(!M.J(O).$B(U.J(O),this.Cib,this.oxa,!0,this.VIc))return!1;return!0}rmn(){if(0!==this.$A&&3!==this.$A||this.ZM.length!==this.uM.length)return!1;let M=!1;for(let U=0;U<this.ZM.length;U++){if(!this.ZM.J(U).$B(this.uM.J(U),this.Cib,this.oxa,!0,this.VIc))return!1;if(3===this.ZM.J(U).type||1===this.ZM.J(U).type){const O=this.ZM.J(U),V=this.uM.J(U);M=O.runId!==V.runId||O.Rg!==V.Rg||M}}return M}}Object(G.a)(A,"MergeBlockDiff",null,[]);var D=d(1666);
class F{constructor(M,U){this.id=M;this.index=U}}Object(G.a)(F,"ParagraphStartIndex",null,[]);var I=d(1743),H=d(1645);d.d(J,"ParagraphMerge",function(){return N});class N{constructor(M,U,O,V,Y,Q,S){this.H$b=this.HGb=this.Sp=this.Jy=null;this.ui=!1;this.qJh=this.Ghh=this.i$g=this.Qya=this.lRa=this.Kwa=null;this.Zd=M;this.wH=U;this.UHa=V;this.vGa=O;this.nxa=Y;this.oxa=Q;this.vg=S}ZFi(M){const U=new m.a;M.ZM.forEach(O=>{2===O.type&&U.add(O.wk);return!0});M.uM.forEach(O=>{2===O.type&&U.remove(O.wk);return!0});
return U}uCi(M){const U=new f.a;M.uM.forEach(O=>{2===O.type&&U.add(O.wk);return!0});return U}g6h(M){const U=new f.a;let O=0,V=0;M.uM.forEach(Y=>{2===Y.type&&(U.add(new F(Y.wk,O<M.OB?O:O<M.OB+M.$ra?M.OB:O-M.$ra+M.AAa)),O=V);V+=Y.length;return!0});return U}Oxl(M,U){var O=this.g6h(M);const V=this.g6h(U);M=this.ZFi(M);const Y=this.ZFi(U);U=new f.a;const Q=new m.a;let S=0;for(let P=0;P<O.length;P++){const T=O.J(P);if(S<V.length){let Z=V.J(S);for(;S<V.length&&Z.index<=T.index;){if(Z.id.equals(T.id)){S++;
break}M.contains(Z.id)||Q.contains(Z.id)||(U.add(Z.id),Q.add(Z.id));S++;Z=V.J(S)}}Y.contains(T.id)||(U.add(T.id),Q.add(T.id))}for(;S<V.length;)O=V.J(S),M.contains(O.id)||Q.contains(O.id)||(U.add(O.id),Q.add(O.id)),S++;return U}initialize(){if(this.ui){const M=!!this.Jy&&!!this.Sp;this.Zd.logger.Oi(Object.assign(new D.a,{$j:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return M}this.ui=!0;if(!({ZM:this.Kwa,n0c:this.lRa,itd:this.Qya,CTd:this.i$g,P2d:this.Ghh,HEe:this.qJh}=
H.a.gai(this.Zd,this.vg,this.wH,this.vGa,this.UHa,this.nxa,!1,!1)).returnValue)return!1;this.Jy=new A(this.Kwa,this.lRa,this.vg,void 0,void 0,this.oxa);this.Sp=new A(this.Kwa,this.Qya,this.vg,void 0,void 0,this.oxa);a.a.instance.Ua(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",this.Jy.AAa,this.Jy.$ra,this.Sp.AAa,this.Sp.$ra));return!0}nPa(){a.a.instance.Ua(593826836,1,4,"Attempting to merge with LCS");let M=!1;
const U=new v.a(this.vg,this.Zd);let O=null,V=null;var Y=null;const Q=P=>this.Zd.runtime.In.J(P),S=P=>this.Zd.runtime.sv.J(P)||this.Zd.runtime.In.J(P);this.Jy=new A(this.Kwa,this.lRa,this.vg,void 0,void 0,this.oxa,!1);this.Sp=new A(this.Kwa,this.Qya,this.vg,void 0,void 0,this.oxa,!1);({AK:O}=U.Kbi(this.wH,Q,this.vGa,P=>this.Zd.runtime.NA.J(P)||this.Zd.runtime.In.J(P),this.Jy.OB,this.Jy.OB+this.Jy.AAa,this.Jy.OB+this.Jy.$ra)).returnValue&&({AK:V}=U.Kbi(this.wH,Q,this.UHa,S,this.Sp.OB,this.Sp.OB+this.Sp.AAa,
this.Sp.OB+this.Sp.$ra)).returnValue&&(M=!0);M||(a.a.instance.Ua(593826835,1,2,"Failed to create update hints with LCS"),M=!1);M&&(Y=new I.a(this.Zd,this.wH,this.vGa,this.UHa,P=>this.Zd.runtime.rc?this.Zd.runtime.rc.isFeatureEnabled(P):!1,this.vg,null,O,V),({Yq:Y}=Y.DAc()).returnValue||(a.a.instance.Ua(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),this.Zd.logger.Oi(Object.assign(new D.a,{$j:"TryLCSMerge",eventId:"9zrqs"})),M=!1));a.a.instance.Ua(593826833,1,M?4:2,"TryLCSMerge: [Success: {0}]",
M);return{returnValue:M,Yq:Y}}DAc(){let M;M=null;if(!this.initialize())return this.Zd.logger.NX("ParagraphMerge Initialize"),this.nbb(),{returnValue:!1,Yq:M};this.Zd.logger.NX("ParagraphMerge Initialize");let U;this.Zd.logger.hye(2);let O=({nPa:U}=this.uWl()).returnValue;O=O&&({Yq:M,nPa:U}=this.Q3c(this.Zd,this.vg,this.nxa,this.H$b,this.HGb)).returnValue;this.Zd.logger.lAg();if(!O){this.Zd.logger.NX("ParagraphMerge DoMergeInteral");if(U){this.Zd.logger.hye(3);({Yq:M,returnValue:O}=this.nPa());this.Zd.logger.lAg();
if(O)return{returnValue:!0,Yq:M};this.nbb();return{returnValue:!1,Yq:M}}this.nbb();return{returnValue:!1,Yq:M}}if(!({Yq:M,nPa:U}=this.Q3c(this.Zd,this.vg,this.nxa,this.H$b,this.HGb)).returnValue)return this.Zd.logger.NX("ParagraphMerge DoMergeInteral"),this.nbb(),{returnValue:!1,Yq:M};this.Zd.logger.NX("ParagraphMerge DoMergeInteral");return{returnValue:!0,Yq:M}}Q3c(){let M;if(!({bqe:M}=H.a.Q3c(this.Zd,this.vg,this.nxa,this.H$b,this.HGb)).returnValue)return this.Zd.logger.NX("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),
this.nbb(),{returnValue:!1,Yq:M,nPa:!0};this.Zd.logger.NX("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,Yq:M,nPa:!1}}nbb(M=!1){a.a.instance.foa(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+M+"] BaseRevisionMergeBlocksList: {0}",this.i$g);a.a.instance.foa(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",this.Ghh);a.a.instance.foa(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.qJh);M=new f.a;H.a.brc(this.vg,"BaseObjects_",this.wH,M);H.a.brc(this.vg,"FavoredObjects_",
this.vGa,M);H.a.brc(this.vg,"ConflictObjects_",this.UHa,M);H.a.RCn(this.Zd,M)}VZh(M){let U,O;O=U=0;if(0===this.Jy.$A)U=this.Sp.OB;else if(1===this.Jy.$A)U=this.Sp.OB<this.Jy.OB?this.Sp.OB:this.Sp.OB===this.Jy.OB?M||1!==this.Sp.$A?this.Sp.OB+this.Jy.$ra:this.Sp.OB:this.Sp.OB+this.Jy.$ra;else if(2===this.Jy.$A||3===this.Jy.$A)U=this.Sp.OB<=this.Jy.OB?this.Sp.OB:this.Sp.OB+(this.Jy.$ra-this.Jy.AAa);if(2===this.Sp.$A||3===this.Sp.$A)O=U+this.Sp.AAa;return{JLi:U,TSm:O}}Noi(M,U){let O;O=0;if(!U)return{returnValue:!0,
ved:O};let V=0,Y=0;for(;V<M.length;){let Q;for(let S=V;S<M.length;S++){V=S;Q=M.J(S);const P=Q.length;Y+=P;if(!(Y<U)){if(Y>U)if(Q.Reb)M.dI(V),M.pD(V,Q.wqd()),Y-=P;else return a.a.instance.Ua(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",U),this.Zd.logger.Oi(Object.assign(new D.a,{$j:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,ved:O};break}}if(Y===U)return V++,
O=V,{returnValue:!0,ved:O}}a.a.instance.Ua(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",U);this.Zd.logger.Oi(Object.assign(new D.a,{$j:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,ved:O}}W8k(M,U,O){let V=0;var Y=0,Q=!1;const S=this.Sp.Txf.wOa();if(this.Sp.Mkl())for(--U;0<=U;U--){let P=M.J(U);if(this.Sp.$9c(P)){Y=M.J(U);V=Y.runId;Y=Y.Rg;Q=!0;break}}Q||((Y=M.J(O))&&this.Sp.$9c(Y)?
(V=Y.runId,Y=Y.Rg):Y=V=0);for(M=0;M<S.length;M++)O=S.J(M),O.V7()&&(Q=O,this.Sp.$9c(O)?(Q.runId=V,Q.Rg=Y):(Q.runId=0,Q.Rg=0));return S}m0i(M){if(2===M.length){const U=1===M.J(0).type?M.J(0):null;M=2===M.J(1).type;if(U&&M&&""===U.text)return!0}return!1}uWl(){const M=this.Jy.rmn();if(!M&&0===this.Jy.$A)return this.H$b=this.Sp.uM.wOa(),this.HGb=this.uCi(this.Sp),{returnValue:!0,nPa:!1};if(0===this.Sp.$A)return this.H$b=this.Jy.uM.wOa(),this.HGb=this.uCi(this.Jy),{returnValue:!0,nPa:!1};(this.m0i(this.Jy.uM)||
this.m0i(this.Sp.uM))&&this.Zd.logger.i$i(Object.assign(new D.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!M){var U=this.Jy.jzf(this.Sp);U&&this.nxa(51)&&(a.a.instance.Ua(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.Jy=new A(this.Kwa,this.lRa,this.vg,!0,void 0,this.oxa),this.Sp=new A(this.Kwa,this.Qya,this.vg,!0,void 0,this.oxa),U=this.Jy.jzf(this.Sp));if(U)return a.a.instance.Ua(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),
this.Zd.logger.Oi(Object.assign(new y.a,{$j:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,nPa:!0}}var O;U=0;this.HGb=this.Oxl(this.Jy,this.Sp);({JLi:O,TSm:Y}=this.VZh(!1));const V=this.Jy.uM.wOa();if(!({ved:O}=this.Noi(V,O)).returnValue||(2===this.Sp.$A||3===this.Sp.$A)&&!({ved:U}=this.Noi(V,Y)).returnValue)return{returnValue:!1,nPa:!1};if(2===this.Sp.$A||3===this.Sp.$A){this.Swc(V,U);this.Swc(V,O-1);var Y=null;for(var Q=U-1;Q>=O;Q--)2===V.J(Q).type&&(Y=V.J(Q)),V.dI(Q);0<V.length&&(Q=V.J(V.length-
1),2!==Q.type&&4!==Q.type&&Y&&(this.Zd.runtime.rc.JF(72),this.Zd.runtime.rc.isFeatureEnabled(72)&&(V.add(Y),this.HGb.add(Y.wk))));a.a.instance.Ua(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",U-O-1,O)}if(1===this.Sp.$A||3===this.Sp.$A)Y=this.Sp.Txf,M&&(Y=this.W8k(V,O,U)),this.Swc(V,O-1),this.Swc(V,O),this.Swc(Y,0),this.Swc(Y,Y.length-1),V.pD(O,Y),a.a.instance.Ua(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",
O,M,Y.Yr());this.H$b=V;return{returnValue:!0,nPa:!1}}Swc(M,U){0>U||U>=M.length||(M=M.J(U),Object(l.a)(w.a,M)&&(M.JXa=!0))}utd(M,U){let O;O=U;if(!this.initialize())return{returnValue:!1,ydb:M,qva:O};if(this.Sp.jzf(this.Jy))return this.nbb(!0),this.Zd.logger.Oi(Object.assign(new y.a,{$j:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,ydb:M,qva:O};if(0===this.Sp.$A||3===this.Sp.$A&&this.Sp.smn())return{returnValue:!0,ydb:M,qva:U};let V;({JLi:V}=this.VZh(!0));U<V||U===V&&(1!==this.Sp.$A||1===
this.Sp.$A&&1===this.Jy.$A&&U===this.Jy.OB+this.Jy.$ra)?O=U:(O=U+this.Sp.$ra-this.Sp.AAa,O<V&&(O=V));return{returnValue:!0,ydb:M,qva:O}}}Object(G.a)(N,"ParagraphMerge",null,[994])},2093:function(G,J,d){d.r(J);G=d(0);var m=d(16),f=d(5),a=d(43),l=d(192),w=d(233),y=d(54),v=d(1822),u=d(1711),x=d(1664),z=d(1645);class A{constructor(H,N,M=null,U=null){this.author=H;this.Hdd=N;this.Cmg=M||y.a.nil;this.BMa=U}$B(H){return H?this.author===H.author&&this.Hdd===H.Hdd&&this.Cmg===H.Cmg&&this.BMa===H.BMa:!1}}Object(G.a)(A,
"RunMergeBlockTrackedChangeAttribute",null,[]);class D{constructor(H,N,M){this.Dsb=H||D.AAf;this.vob=N||D.AAf;this.$ua=M||D.AAf}get TYm(){return 0<this.Dsb.author.length}get vYm(){return 0<this.vob.author.length}get yZm(){return 0<this.$ua.author.length}$B(H){return H?this.Dsb.$B(H.Dsb)&&this.vob.$B(H.vob)&&this.$ua.$B(H.$ua):!1}}D.AAf=new A("",0);Object(G.a)(D,"RunMergeBlockTrackedChangeInfo",null,[]);var F=d(1893);d.d(J,"ParagraphMergeBlockCreator",function(){return I});class I extends u.a{constructor(H,
N,M,U,O,V,Y,Q){super();this.maxValue=Number.MAX_VALUE;this.Xt=new v.a;this.$4b=null;this.rG=0;this.Poh=!1;this.ELc="";this.GKe=H;this.Pq=N;this.wv=M;this.oOk=U;this.ZBd=O;this.Znh=V;this.y8b=Q;this.vg=Y;if(this.vg.hasProperty(this.Pq,m.a.Un))if(this.vg.hasProperty(this.Pq,f.a.Yc))if(this.vg.hasProperty(this.Pq,f.a.Kq))if(this.vg.hasProperty(this.Pq,f.a.Nt))if(this.vg.hasProperty(this.Pq,m.a.Vn))if(this.b6=this.vg.getPropertyString(this.Pq,m.a.Un),this.wdf=this.vg.getPropertyUint32(this.Pq,f.a.Yc),
this.At=this.vg.getPropertyUint32s(this.Pq,f.a.Kq),this.cJd=this.vg.getPropertyUint32s(this.Pq,f.a.Nt),this.qTe=this.vg.getPropertyObjectIds(this.Pq,m.a.Vn),this.b6||""===this.b6)if(this.b6.length||1!==this.qTe.length||(this.At.length||(this.At.add(0),l.a.instance.Ua(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),this.cJd.length||(this.cJd.add(0),l.a.instance.Ua(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),
this.yFk=this.t5d(this.Pq,f.a.ccg,this.At.length),this.BNc=this.t5d(this.Pq,m.a.dDa,this.At.length),this.oqa=this.t5d(this.Pq,m.a.Yyb,this.At.length),this.ypa=this.t5d(this.Pq,f.a.uWa,this.At.length),this.$pa=this.APm(this.Pq,f.a.xNa,this.At.length),this.N5m(),H=this.vg.hasProperty(this.Pq,m.a.zn)?this.vg.getPropertyUint32s(this.Pq,m.a.zn):new w.a,this.MLd=z.a.zPj(H,this.b6.length),this.At.length!==this.cJd.length)l.a.instance.Ua(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",
N.id);else if(this.At.length!==this.qTe.length)l.a.instance.Ua(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",N.id);else{this.Znh&&(this.vg.hasProperty(this.Pq,f.a.Fw)?this.$4b=this.vg.getPropertyObjectIds(this.Pq,f.a.Fw):(l.a.instance.Ua(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",N.id),this.$4b=this.U2(this.At.length,y.a.nil)),this.At.length!==this.$4b.length&&(l.a.instance.Ua(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",
N.id,this.At.length,this.$4b.length),this.$4b=this.U2(this.At.length,y.a.nil)));if(this.At.length!==this.BNc.length||this.At.length!==this.oqa.length||this.At.length!==this.ypa.length||this.At.length!==this.$pa.length)this.At.length===this.BNc.length||this.ZBd||l.a.instance.Ua(8266445,1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",N.id,this.At.length,this.BNc.length),this.At.length===this.oqa.length||
this.ZBd||l.a.instance.Ua(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",N.id,this.At.length,this.oqa.length),this.At.length===this.ypa.length||this.ZBd||l.a.instance.Ua(20742792,1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",N.id,this.At.length,this.ypa.length),this.At.length===this.$pa.length||
this.ZBd||l.a.instance.Ua(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",N.id,this.At.length,this.$pa.length),H=this.vg.getPropertyBool(this.Pq,m.a.Orf),l.a.instance.Ua(17877020,1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",N.id,O,null==H?!1:H),this.BNc=this.U2(this.At.length,!0),this.oqa=this.U2(this.At.length,!1),this.ypa=this.U2(this.At.length,
!1),this.$pa=this.U2(this.At.length,0),this.vg.setPropertyBool(this.Pq,m.a.Orf,!1);this.Xt.xDp(this.At.length)?(this.MLd.length!==this.At.length+1&&l.a.instance.Ua(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",N.id,this.At.length,this.MLd.length),this.yCk=!0):l.a.instance.Ua(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",N.id)}else l.a.instance.Ua(4322133,
1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",N.id);else l.a.instance.Ua(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",N.id);else l.a.instance.Ua(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",N.id);else l.a.instance.Ua(3993796,1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",N.id);else l.a.instance.Ua(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",N.id);else l.a.instance.Ua(3993794,1,
1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",N.id)}N5m(){this.vg.hasProperty(this.Pq,f.a.xLa)?this.Xt.Bsb=this.vg.getPropertyBools(this.Pq,f.a.xLa):this.Xt.Bsb=this.U2(this.At.length,!1);this.vg.hasProperty(this.Pq,f.a.wka)?this.Xt.uob=this.vg.getPropertyBools(this.Pq,f.a.wka):this.Xt.uob=this.U2(this.At.length,!1);this.vg.hasProperty(this.Pq,f.a.yLa)?this.Xt.Asb=this.vg.getPropertyStrings(this.Pq,f.a.yLa):this.Xt.Asb=this.U2(this.At.length,"");this.vg.hasProperty(this.Pq,
f.a.KJa)?this.Xt.tob=this.vg.getPropertyStrings(this.Pq,f.a.KJa):this.Xt.tob=this.U2(this.At.length,"");this.vg.hasProperty(this.Pq,f.a.zLa)?this.Xt.Csb=this.vg.getPropertyListOfMilliseconds(this.Pq,f.a.zLa):this.Xt.Csb=this.U2(this.At.length,0);this.y8b&&this.vg.hasProperty(this.Pq,a.a.dXa)?this.Xt.cXa=this.vg.iNf(this.Pq,a.a.dXa):this.Xt.cXa=null;this.vg.hasProperty(this.Pq,f.a.LJa)?this.Xt.L7a=this.vg.getPropertyListOfMilliseconds(this.Pq,f.a.LJa):this.Xt.L7a=this.U2(this.At.length,0);this.y8b&&
this.vg.hasProperty(this.Pq,a.a.YUa)?this.Xt.oNb=this.vg.iNf(this.Pq,a.a.YUa):this.Xt.oNb=null;this.vg.hasProperty(this.Pq,f.a.wNa)?this.Xt.Ocb=this.vg.getPropertyBools(this.Pq,f.a.wNa):this.Xt.Ocb=this.U2(this.At.length,!1);this.vg.hasProperty(this.Pq,f.a.lPa)?this.Xt.Lwb=this.vg.getPropertyStrings(this.Pq,f.a.lPa):this.Xt.Lwb=this.U2(this.At.length,"");this.vg.hasProperty(this.Pq,f.a.mPa)?this.Xt.Nwb=this.vg.getPropertyListOfMilliseconds(this.Pq,f.a.mPa):this.Xt.Nwb=this.U2(this.At.length,0);this.y8b&&
this.vg.hasProperty(this.Pq,a.a.z0a)?this.Xt.WXb=this.vg.iNf(this.Pq,a.a.z0a):this.Xt.WXb=null;this.vg.hasProperty(this.Pq,f.a.ZEa)?this.Xt.Mwb=this.vg.getPropertyObjectIds(this.Pq,f.a.ZEa):this.Xt.Mwb=this.U2(this.At.length,y.a.nil)}t5d(H,N,M){return this.vg.hasProperty(H,N)?this.vg.getPropertyBools(H,N):this.U2(M,!1)}APm(H,N,M){return this.vg.hasProperty(H,N)?this.vg.getPropertyUint32s(H,N):this.U2(M,0)}U2(H,N){const M=new w.a;for(let U=0;U<H;U++)M.add(N);return M}YNm(H){const N=this.MLd.sg(H);
H=this.MLd.sg(H+1);return this.b6.substring(N,H)}NCi(){if(this.Poh)return null;var H=this.rG<this.At.length?this.At.sg(this.rG):this.maxValue;if(H===this.maxValue||this.oOk&&!this.b6.length)return this.Poh=!0,H=new x.a(this.wv,this.Pq.id,this.wdf),this.ELc=this.Aif(this.ELc,H.toString()),H;const N=this.cJd.sg(this.rG),M=this.qTe.sg(this.rG),U=this.yFk.sg(this.rG),O=this.BNc.sg(this.rG),V=this.oqa.sg(this.rG),Y=this.ypa.sg(this.rG),Q=this.$pa.sg(this.rG),S=this.Znh?this.$4b.sg(this.rG):null;var P=
null;this.Xt.Bsb.sg(this.rG)&&(P=new A(this.Xt.Asb.sg(this.rG)||"",this.Xt.Csb.sg(this.rG)));if(this.y8b&&null!=P){var T=this.Xt.cXa.length<this.rG?this.Xt.cXa[this.rG]:null;null!=T&&null!=T.kda&&(P.BMa=this.vg.gJf(new Date(T.kda)))}T=null;this.Xt.uob.sg(this.rG)&&(T=new A(this.Xt.tob.sg(this.rG)||"",this.Xt.L7a.sg(this.rG)));if(this.y8b&&null!=T){var Z=this.Xt.oNb.length<this.rG?this.Xt.oNb[this.rG]:null;null!=Z&&null!=Z.kda&&(T.BMa=this.vg.gJf(new Date(Z.kda)))}Z=null;this.Xt.Ocb.sg(this.rG)&&(Z=
new A(this.Xt.Lwb.sg(this.rG)||"",this.Xt.Nwb.sg(this.rG),this.Xt.Mwb.sg(this.rG)));if(this.y8b&&null!=Z){const X=this.Xt.WXb.length<this.rG?this.Xt.WXb[this.rG]:null;null!=X&&null!=X.kda&&(Z.BMa=this.vg.gJf(new Date(X.kda)))}P=new D(P,T,Z);T=this.YNm(this.rG);this.rG++;Z=T.startsWith("\ufddfHYPERLINK ");H=new F.a(this.GKe,this.wv,this.Pq.id,N,H,M,T,U,!Z,O,V,Y,Q,P,S);this.ELc=this.Aif(this.ELc,H.toString());return H}sCi(){let H;H=null;var N="";if(!this.yCk)return{V8f:H,Ebb:N};if(N=this.NCi())H=new w.a,
H.add(N);for(;N=this.NCi();)H.add(N);N=this.ELc;return{V8f:H,Ebb:N}}}Object(G.a)(I,"ParagraphMergeBlockCreator",u.a,[])},2098:function(G,J,d){d.r(J);G=d(0);var m=d(233),f=d(1711),a=d(1663);class l extends a.a{constructor(y,v){super(4,y,v)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.wk)}Bjc(){return"Table"}clone(){return new l(this.source,this.wk)}$B(y,v,u,x=!1){return super.$B(y,v,u,x)?this.wk.equals(y.wk):!1}get length(){return 1}}Object(G.a)(l,"TableMergeBlock",
a.a,[]);d.d(J,"TableMergeBlockCreator",function(){return w});class w extends f.a{constructor(y,v){super();this.t$g=new l(v,y.id)}sCi(){let y;y=new m.a;y.add(this.t$g);return{V8f:y,Ebb:this.Aif("",this.t$g.toString())}}}Object(G.a)(w,"TableMergeBlockCreator",f.a,[])},2194:function(G,J,d){function m(a){var l=!0,w=[];a.forEach(function(y){var v,u=y.classification;if(u===f.a.DQg.FSg||u===f.a.DQg.Mfk){u=(v={},v.name=y.name,v.bool=null,v.string=null,v["double"]=null,v.int64=null,v.date=null,v.contract=
null,v);switch(y.dataType){case f.a.Dvd.Boolean:u.bool=y.value;break;case f.a.Dvd.Double:u["double"]=y.value;break;case f.a.Dvd.Int64:u.int64=y.value;break;case f.a.Dvd.String:u.string=y.value;break;default:return}w.push(u)}else l=!1});return l?w:[]}d.d(J,"a",function(){return m});var f=d(1538)},2211:function(G,J,d){d.r(J);var m=d(2),f=d(0),a=d(182),l=d(832);class w extends a.a{constructor(K,pa){super(!1,!1,!0);this.bmd=(Ta,jb)=>{1===Ta&&(this.yFa.QTf=jb.tooltipPersistenceEnabled,m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",
!1)&&(Ta=jb.textSelectionChangeEnabled,this.yFa.Lzc!==Ta&&this.nQk.raiseEvent(l.a.Soj),this.yFa.Lzc=Ta))};this.yFa=K;this.nQk=pa}start(){const K={["tooltipPersistenceEnabled"]:this.yFa.QTf};m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(K.textSelectionChangeEnabled=this.yFa.Lzc);this.pi("",this.bmd,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:K})}}Object(f.a)(w,"AccessibilitySettingsDialog",a.a,[]);var y=d(75),v=d(12);
class u{constructor(K,pa){this.n5o=()=>{(new w(this.yFa,l.a.instance())).start();return 32};this.ga=K;this.yFa=pa}Wb(){this.ga.ra(v.a.m5o,y.a.frame,this.n5o)}}Object(f.a)(u,"AccessibilitySettingsDialogActor",null,[1150]);var x=d(356);const z=K=>{const pa=new x.a;m.AFrameworkApplication.Be.Ij(D(K),1,null,null,!0,2,Ta=>{200===Ta.data.He?pa.gg("true"===Ta.data.De.toLowerCase()):pa.gg(!1)},()=>{pa.gg(!1)},null,void 0,void 0,void 0,void 0,"7");return pa.task},A=(K,pa)=>{m.AFrameworkApplication.Be.Ij(D(K),
2,pa.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},D=K=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",m.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",K,m.AFrameworkApplication.jm);var F=d(142);class I{constructor(){this.gbc=this.D7b=null}get QTf(){return!!this.D7b}set QTf(K){K!==this.D7b&&(this.D7b=K,F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(K),this.Wfe()&&A("saveHoverableRibbonTooltipIsEnabled",
K))}get Lzc(){return!!this.gbc}set Lzc(K){K!==this.gbc&&(this.gbc=K,this.Wfe()&&A("saveTextSelectionHighlightChangeIsEnabled",K))}pAn(){const K=new x.a;if(this.D7b)K.gg(this.D7b);else if(this.Wfe()){const pa=z("getHoverableRibbonTooltipIsEnabled");pa.continueWith(()=>{this.D7b=pa.result;F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(pa.result);K.gg(pa.result)},8)}else K.gg(!1)}UAn(){const K=new x.a;if(this.gbc)K.gg(this.gbc);else if(this.Wfe()){const pa=z("getTextSelectionHighlightChangeIsEnabled");
pa.continueWith(()=>{this.gbc=pa.result;K.gg(pa.result)},8)}else K.gg(!1)}Wfe(){const K=m.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),pa=m.AFrameworkApplication.K.$("IsAnonymousUser");return K&&!pa}}Object(f.a)(I,"AccessibilitySettingsInfo",null,[1149]);var H=d(193),N=d(26);class M{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}wc(K){this.W=K;this.W.register(I,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Rd(()=>
new I).ha();this.W.register(u,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Rd(()=>new u(m.AFrameworkApplication.va,this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ha()}init(){const K=this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),pa=this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");K&&pa?(pa.Wb(),K.pAn(),K.UAn(),N.b(508827098,
200,50,"Text Selection Highlight Change Setting value on boot: {0}",K.Lzc)):N.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){H.a.instance.Jc(new M)}}Object(f.a)(M,"AccessibilitySettingsPackage",null,[0,1]);var U=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",
Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},O=d(104),V=d(89);class Y extends Sys.EventArgs{constructor(K,pa){super();this.ZCe=K;this.actualValue=pa}}Object(f.a)(Y,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);class Q{constructor(){this.E5b=[];this.hdh=this.QOe=0;this.jj=null;this.sa=new V.a;this.VCl=(K,pa)=>{N.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.HYd(pa.ZCe,
pa.actualValue))}}init(K,pa,Ta){this.jj=K;this.QOe=pa;this.hdh=Ta;this.jj.wgf(Object(O.a)(this,this.Eme,"onCpuMeterFrameAvailable"));this.I0k(this.VCl)}Eme(K,pa){pa.Rgj&&(Array.enqueue(this.E5b,pa.Rgj.CP),this.E5b.length>this.hdh&&(Array.dequeue(this.E5b),this.bol()))}bol(){var K=this.E5b.length;let pa=0;for(let Ta=0;Ta<K;Ta++){const jb=Array.dequeue(this.E5b);pa+=jb;Array.enqueue(this.E5b,jb)}K=pa/K;K>this.QOe&&this.sa.raiseEvent("CPTTE",new Y(this.QOe,K))}I0k(K){this.sa.addHandler("CPTTE",K)}HYd(K,
pa){const Ta={};Ta.ThresholdValue=K;Ta.ActualValue=pa;return Ta}}Object(f.a)(Q,"CpuMeterMonitor",null,[1154]);class S{constructor(){this.S=this.T=this.M=this.C=0}}Object(f.a)(S,"ProfileInformation",null,[]);var P=d(10),T=d(42),Z=d(250),X=d(90);class aa{constructor(K=0,pa=0){this.kEb=!1;this.KDb={};this.NGd=K;this.cHd=pa;this.Xbf=0;T.a.addHandler(window.self,P.a.qRh,()=>{this.kEb=!0});T.a.addHandler(window.self,P.a.rRh,()=>{this.kEb=!1})}tRh(K,pa,Ta){const jb=aa.generateKey(pa,Ta);jb in this.KDb?pa=
this.KDb[jb]:(pa=new S,pa.S=Ta?1:0,this.KDb[jb]=pa,this.Xbf++);pa.C++;pa.M=K>pa.M?K:pa.M;pa.T+=K}rIa(K,pa){this.tRh(K,pa,!1);this.kEb&&this.tRh(K,pa,!0)}getData(){if(0<this.cHd&&this.Xbf>this.cHd)return this.hom();const K=0<this.NGd,pa={},Ta=this.KDb;for(const bc in Ta){var jb=bc;const Ic=Ta[bc];this.uIj(Ic);K&&Ic.T>=this.NGd&&(pa[jb]=Ic)}return K?X.a.Tf(pa)?null:pa:this.KDb}hom(){var K=0<this.NGd,pa=[];const Ta=this.KDb;for(const jb in Ta){const bc={key:jb,value:Ta[jb]},Ic=bc.value;(!K||Ic.T>=this.NGd)&&
Array.add(pa,bc)}if(pa.length>this.cHd)pa.sort((jb,bc)=>bc.value.T-jb.value.T),pa=pa.slice(0,this.cHd);else if(!pa.length)return null;K={};for(const jb of pa)pa=jb.value,this.uIj(pa),K[jb.key]=pa;return K}uIj(K){K.M=Z.a.YP(K.M,0);K.T=Z.a.YP(K.T,0)}reset(){this.KDb={};this.Xbf=0}static generateKey(K,pa){return pa?K+" [it]":K}}Object(f.a)(aa,"FunctionCallAggregator",null,[1021]);var ia=d(966);class wa{}Object(f.a)(wa,"CpuMeterFrame",null,[]);class ma extends Sys.EventArgs{constructor(K){super();this.Rgj=
K}}Object(f.a)(ma,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class na{}Object(f.a)(na,"MiniTaskItemInfo",null,[]);class Fa{}Object(f.a)(Fa,"TaskItemInfo",null,[]);var Qa=d(1132),ya=d(1458),ta=d(202);class Aa{constructor(K,pa,Ta,jb,bc){this.wIb=0;this.b2=null;this.PLd=this.tGh=0;this.oya=!1;this.U6b=0;this.PJc=!1;this.Yxa=null;this.gEd=0;this.B2e=new V.a;this.pOd=[];this.sB=K;this.x0e=pa;this.xTe=Ta;this.ouh=jb;m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&
this.aqc();this.Wuk=bc;this.yTe=new aa(100);this.hEk=Qa.a.UG(1,5,new ya.a)}wgf(K){this.B2e.addHandler("OnCpuMeterFrameAvailable",K)}ODj(K){this.B2e.removeHandler("OnCpuMeterFrameAvailable",K)}Owb(K,pa,Ta,jb=null){Ta=jb?jb.priority:7;const bc=this.sB();this.start(pa,Ta);try{K()}finally{this.stop(pa,jb),K=this.sB()-bc,this.ouh.track(K,pa)}}Yd(K,pa){const Ta=this.sB();try{K()}finally{K=this.sB()-Ta,this.xTe.rIa(K,pa),0<this.wIb&&this.yTe.rIa(K,pa),this.ouh.track(K,pa)}}shg(K){const pa=new Fa;pa.TN=K.i7f;
pa.TP=K.priority;this.myj(1,pa)}urc(K){this.gEd|=K}start(K,pa){if(!this.wIb){this.yTe.reset();const Ta=this.g4i(K);Ta&&this.Gje(1);this.b2=new Fa;this.b2.TN=K;this.b2.TP=pa;this.b2.ST=(new Date).toISOString();this.b2.STS=Z.a.YP(this.sB(),2);Ta?this.b2.UI=1:this.Amn(K)?this.b2.UI=2:this.b2.UI=0}this.wIb++}Gje(K){this.U6b|=K}ZVd(K=!0,pa=0){this.U6b=K?0:this.U6b&~pa}stop(K,pa=null){let Ta;this.wIb--;0>=this.wIb&&this.b2&&(Ta=this.sB()-this.b2.STS,this.PLd+=Ta,this.x0e.rIa(Ta,K),this.g4i(K)&&this.ZVd(!1,
1),this.b2.TRT=Z.a.YP(Ta,2),pa&&(this.b2.TQT=Z.a.YP(pa.xlo,2),this.b2.TDT=Z.a.YP(pa.B5i,2)),this.Wuk&&(this.myj(0,this.b2),this.fEo()),this.wIb=0);0<=K.indexOf(ia.a.Jqp)&&this.urc(2);0<=K.indexOf(ia.a.$Ej)&&this.urc(4);1===(this.U6b&1)&&this.urc(1);2===(this.U6b&2)&&this.urc(8)}fEo(){var K=this.b2.TRT;if(750<K){let Ta=this.yTe.getData();if(Ta){const jb={};for(const bc in Ta){var pa=Ta[bc];const Ic=bc;Ic.startsWith("SiOp_")||Ic.endsWith("[it]")||(jb[Ic]=Math.round(100*pa.T/K))}Ta=jb}K=Object.assign(new na,
{B:this.b2.STS,T:K,S:Ta});this.hEk.track(K,this.b2.TN)}}g$o(){var K=this.sB()-this.tGh,pa=Z.a.YP(this.PLd/K*100,2);K=new wa;K.CP=pa;K.II=this.gEd;pa=this.x0e.getData();X.a.count(pa)&&(K.LRT=pa);pa=this.xTe.getData();X.a.count(pa)&&(K.FP=pa);this.B2e.raiseEvent("OnCpuMeterFrameAvailable",new ma(K));this.uXj()}uXj(){this.x0e.reset();this.xTe.reset();this.PLd=this.wIb=0;this.tGh=this.sB();this.gEd=0;this.b2=null}run(){this.oya?this.g$o():(this.uXj(),this.oya=!0);this.Yxa?this.Yxa(Object(O.a)(this,this.run,
"run"),1E3):window.setTimeout(Object(O.a)(this,this.run,"run"),1E3)}cRd(K,pa,Ta){const jb=Array(2);jb[0]=pa;jb[1]=Ta;this.pOd[K]||(this.pOd[K]=[]);this.pOd[K].push(jb)}myj(K,pa){K=this.pOd[K];if(!ta.a.Tf(K))for(let jb=0;jb<K.length;jb++){var Ta=K[jb];const bc=Ta[0];Ta=Ta[1];bc&&!bc(pa)||Ta(pa)}}aqc(){if(!this.PJc){const K=window.setTimeout;this.Yxa=(pa,Ta)=>K(pa,Ta);this.PJc=!0}}g4i(K){return K.startsWith("key")||K.startsWith("input")}Amn(K){return K.startsWith("click")||K.startsWith("mouse")||K.startsWith("pointer")}}
Object(f.a)(Aa,"CpuMeter",null,[162]);class oa{constructor(K){this.rFc=null;this.Sq=new x.a;this.sB=K}initialize(K,pa,Ta,jb=!1){this.rFc||(this.rFc=new Aa(this.sB,K,pa,Ta,jb),this.Sq.gg(this.rFc));return this.rFc}}Object(f.a)(oa,"CpuMeterProvider",null,[1151]);var za=d(168);class ja{constructor(K=1){this.lF=[];this.Yzd=[];this.Jk=K}Y8l(){let K=0;for(let pa=0;pa<this.lF.length;pa++)this.lF[pa]<this.lF[K]&&(K=pa);return K}rIa(K,pa){K=Z.a.YP(K,2);if(this.lF.length<this.Jk)Array.add(this.lF,K),Array.add(this.Yzd,
pa);else{var Ta=this.Y8l();K>this.lF[Ta]&&(this.lF[Ta]=K,this.Yzd[Ta]=pa)}}getData(){return this.lF.length?{["Vals"]:this.lF,["Desc"]:this.Yzd}:null}reset(){this.lF=[];this.Yzd=[]}}Object(f.a)(ja,"MaxDataAggregator",null,[1021]);var fa=d(41),Ca=d(21);class xa{get name(){return"Common.App.CpuMeter"}wc(K){K.register(oa,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").ha().Rd(()=>new oa(fa.a.Ee));K.register(Q,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").ha().Rd(()=>
new Q)}init(){const K=m.AFrameworkApplication.K;if(K.$("CpuMeterIsEnabled")){const pa=Ca.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");za.a.instance.pif.continueWith(()=>{xa.C6m(K,pa)})}}dispose(){}static C6m(K,pa){const Ta=Qa.a.UG(10,5,new aa(K.ic("TaskManagerLoggingThreshold",0),K.ic("CpuMeterMaximumEntriesToLog",0)));pa=pa.initialize(new ja(5),new aa,Ta,K.$("CPUMeterExposeTaskDetailsIsEnabled"));K.$("WordEditorInteractivePerfDisableCpuMeterFrames")||(pa.run(),K.$("CpuMeterMonitorIsEnabled")&&
Ca.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(pa,K.oN("CpuMeterAverageCpuPercentThreshold",80),K.ic("CpuMeterRollingAverageFramesCount",15)));N.b(16827671,306,50,"Initializing CpuMeter")}static main(){H.a.instance.Jc(new xa)}}Object(f.a)(xa,"CpuMeterPackage",null,[0,1]);var ua=d(7),sa=d(92),Ea=d(1164),Ja=d(1141),nb=d(20),ub=d(1459);class Yb{constructor(){this.cya=this.nDc=null;this.Tbc=!0;this.ZJc=!1}wc(K){m.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&K.register(1139,
"Common.IEventTimingMeter").ha().Rd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var K=new Ja.a(m.AFrameworkApplication.K.ic("EventTimingMeterEventSamplingPercent",0)/100);K=new Ea.a(Object(O.a)(K,K.p0b,"shouldBeInSample"));const pa=Qa.a.UG(16,1,K);this.cya=new ub.a("TypingDuration-SlowPercentileAtValue","Percentile",m.AFrameworkApplication.K.oN("AshaVetoForTypingThresholdInMS",150),m.AFrameworkApplication.K.oN("AshaVetoForTypingThresholdPercentile",
95),this.Tbc);(this.ZJc=!nb.a.Fab)&&m.AFrameworkApplication.aJ(()=>{this.Rof()});this.nDc=Ta=>{Ta=Ta.rawEvent.detail;for(const jb of Ta)pa.track(jb,"EventTimingData"),"false"!==jb.metadata.altPressed.toString()||"false"!==jb.metadata.ctrlPressed.toString()||"false"!==jb.metadata.repeat.toString()||"CharacterKey"!==jb.metadata.key.toString()&&"Space"!==jb.metadata.key.toString()||!this.ZJc||this.cya.ODa(jb.timeToRequestAnimationFrameMs)};T.a.addHandler(window.self,P.a.pRh,this.nDc)}dispose(){this.nDc&&
(T.a.removeHandler(window.self,P.a.pRh,this.nDc),this.nDc=null)}Rof(){this.cya.JZa();this.cya.vqj&&(ua.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),sa.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){H.a.instance.Jc(new Yb)}}Object(f.a)(Yb,"EventTimingMeterPackage",null,[0,1]);var yb=d(77),Za=d(84),Ya=d(34);class Pa{constructor(K,pa,Ta,jb=null,bc=null){this.zQb=Ic=>{let Uc=!1,kd=null;try{if(0<
Ic.data.De.length){const pd=Object(Za.a)(Object,Ya.a(Ic.data.De)),Fd=pd?pd[this.tO.rif]:null;Fd&&(kd=Object(Za.a)(Object,Ya.a(Fd.toString())))}Uc=!0}catch(pd){this.J9a(null)}Uc&&this.kIc&&this.kIc(Ic.data,kd)};this.J9a=Ic=>{this.eIc&&this.eIc(Ic?Ic.data:null)};this.ndo=Ic=>{this.cAh&&this.cAh(Ic?Ic.data:null)};this.Jcb=Ic=>{this.QNc&&this.QNc(Ic?Ic.data:null)};this.tO=K;this.kIc=pa;this.eIc=Ta;this.cAh=jb;this.QNc=bc}pCf(K){const pa=new Sys.StringBuilder(this.tO.tmd);pa.append("RoamingServiceHandler.ashx?action=");
pa.append("getFirstRunExperienceSettings");pa.append("&");pa.append(this.lNf(K));pa.append("&");pa.append(m.AFrameworkApplication.jm);m.AFrameworkApplication.Be.Ij(pa.toString(),1,null,null,!0,2,this.zQb,this.J9a,null)}r2d(K){var pa=new Sys.StringBuilder(this.tO.tmd);pa.append("RoamingServiceHandler.ashx?action=");pa.append("saveFirstRunExperienceSettings");pa.append("&");pa.append(m.AFrameworkApplication.jm);pa=pa.toString();K=Ya.c(K);m.AFrameworkApplication.Be.Ij(pa,2,K,null,!0,4,this.ndo,this.Jcb,
null)}lNf(K){const pa=new Sys.StringBuilder("requestedsettings=");for(let Ta=0;Ta<K.count;Ta++)pa.append(K.J(Ta)),Ta<K.count-1&&pa.append(";");return pa.toString()}}Object(f.a)(Pa,"FirstRunExperienceRequestHandler",null,[]);var rb=d(268);class tb{constructor(){this.NHc=this.LBd=this.tO=null;this.zQb=(K,pa)=>{K=K?+K.YO-+K.bH:-1;K>this.tO.fIj?ua.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
K,this.tO.fIj):pa?this.k5o(pa)?(ua.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.tO.zej),this.yDg()):(this.syf(!1),ua.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(ua.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.yDg())};this.J9a=K=>
{this.syf(!1);ua.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",K?K.He:-1)};this.Jcb=K=>{ua.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",K?K.He:-1)};this.OXn=K=>{if(K){var pa=K.detail;K=K.type;var Ta=this.tO&&this.tO.x_h?this.tO.x_h.split("-")[0]:null;if("FRELaunchedEvent"===K||Ta&&pa&&pa.id&&-1!==pa.id.indexOf(Ta)){if("FRELaunchedEvent"===K||pa&&pa.success)ua.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.jJj(this.tO.currentVersion);window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.NHc,!0),window.removeEventListener("FRELaunchedEvent",this.NHc,!0))}}}}v6o(K){K?(this.tO=K,this.vmn()&&(ua.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),K=new yb.a,K.add(this.tO.rif),this.LBd=new Pa(this.tO,this.zQb,this.J9a,null,this.Jcb),this.LBd.pCf(K)),
(this.tO.v3i||m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.yDg()):ua.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}vmn(){try{if(this.tO.v3i)return!0;if(!m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||m.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;if(this.tO.Qgn||this.tO.Epc||m.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const K=
m.AFrameworkApplication.K.kb("FlightId");return-1!==(K?K.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(K){ua.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",K?K.toString():null)}return!1}jJj(K){const pa={},Ta={};Ta.FREDisplayedDate=(new Date).toUTCString();Ta.VersionDisplayed=K;Ta.RemindMeLater=!1;pa[this.tO.rif]=Ya.c(Ta);ua.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.LBd&&this.LBd.r2d(pa)}yDg(){this.syf(!0);
var K=Ca.a.instance.Oa("Common.ISystemInitiatedFeedback");K?this.kUj(K):(ua.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((K=Ca.a.instance.Qa("Common.ISystemInitiatedFeedback"))?K.execute(pa=>{this.kUj(pa)}):ua.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}kUj(K){if(K){var pa=this.tO.Dam;pa&&m.AFrameworkApplication.yga(pa);
ua.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",pa);K.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.NHc=this.OXn,window.addEventListener("FGWebSurfaceEvent",this.NHc,!0),window.addEventListener("FRELaunchedEvent",this.NHc,!0)):(ua.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.jJj(this.tO.currentVersion))}else ua.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}k5o(K){if("RemindMeLater"in
K&&"FREDisplayedDate"in K){if("true"===K.RemindMeLater.toString()&&(+new Date-+new Date(K.FREDisplayedDate.toString()))/36E5>this.tO.zej)return!0}else if(m.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in K&&K.VersionDisplayed<this.tO.currentVersion)return ua.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}syf(K){m.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
rb.a.dispatch("FREDecisionEvent",{["show"]:K})}}Object(f.a)(tb,"FirstRunExperienceLauncher",null,[1141]);class ob{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}wc(K){this.W=K;this.W.register(1141,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ha().Rd(()=>new tb)}init(){}dispose(){}static main(){H.a.instance.Jc(new ob)}}Object(f.a)(ob,"FirstRunExperienceLauncherPackage",null,[0,1]);class Oa{constructor(){this.y=this.x=0}}Object(f.a)(Oa,"HammerPoint",
null,[]);class Xa{constructor(K,pa,Ta,jb,bc){this.ush=this.c3a=this.UDd=1;this.uPd=this.rRc=this.E5a=0;this.Q1e=this.AQa=null;this.mBb=this.NSe=this.mKd=!1;this.Vj=K;this.fTa=pa;this.Rkb=Ta;this.ga=jb;bc&&(this.mKd=bc.$("PromoteLayerPinchToZoomIsEnabled"),this.NSe=bc.$("FinalizeWithInitialPinchScaleIsEnabled"),this.mBb=bc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get RN(){return this.fTa}get oxg(){return this.Rkb}Hjn(){return!!this.Vj.instance}kYn(K){this.ga&&this.ga.Ob(v.a.KXj,2);const pa=this.Vj.instance;
this.mKd&&pa.fyj();this.c3a=pa.Aj;this.UDd=K.N1c.scale;this.ush=1;this.Q1e=this.$Zh();this.AQa=this.fTa.getBounds();if(!this.AQa)return ua.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;K=this.OEi(K);this.mBb?this.ZOj(this.fTa.scrollWidth,this.AQa.width,K,this.c3a,pa):this.E5a=this.fTa.scrollWidth>this.AQa.width?this.HUc(this.Rkb.scrollLeft,K.x,this.c3a):null;this.uPd=this.fTa.scrollHeight>this.AQa.height?this.HUc(this.Rkb.scrollTop,K.y,this.c3a):null;return!0}bvg(){this.E5a=null;this.rRc=
0}ZOj(K,pa,Ta,jb,bc){K>pa?this.E5a?(K=bc.a4f,K!==this.rRc&&(this.E5a-=this.rRc-K,this.rRc=K)):(this.E5a=this.HUc(this.Rkb.scrollLeft,Ta.x,jb),this.rRc=bc.a4f):this.bvg()}jYn(K){const pa=this.OEi(K);if(!pa)return ua.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;K=this.dTo(K.N1c.scale/this.UDd)*this.c3a;this.rzp(pa,K);this.szp(pa,K);return!0}rzp(K,pa){const Ta=this.fTa.scrollWidth,jb=this.AQa.width;this.mBb?this.ZOj(Ta,jb,K,pa,this.Vj.instance):!this.E5a&&Ta>jb&&(this.E5a=this.HUc(this.Rkb.scrollLeft,
K.x,pa));if(K=this.i_h(K.x,this.E5a,Ta,jb,pa))this.Rkb.scrollLeft=K}szp(K,pa){const Ta=this.fTa.scrollHeight,jb=this.AQa.height;!this.uPd&&Ta>jb&&(this.uPd=this.HUc(this.Rkb.scrollTop,K.y,pa));if(K=this.i_h(K.y,this.uPd,Ta,jb,pa))this.Rkb.scrollTop=K}i_h(K,pa,Ta,jb,bc){return Ta<=jb||!pa||!jb?null:Math.max(0,Math.min(pa*bc-K,Ta-jb))}HUc(K,pa,Ta){return(K+pa)/Ta}iYn(K){K=K.N1c.scale;this.NSe&&(K/=this.UDd);this.koi(K);this.mKd&&this.Vj.instance.Upg();this.ga&&this.ga.Ob(v.a.WAf,2);this.mBb&&this.bvg()}hYn(K){K=
K.N1c.scale;this.NSe&&(K/=this.UDd);this.koi(K,!0);this.mKd&&this.Vj.instance.Upg();this.ga&&this.ga.Ob(v.a.WAf,2);this.mBb&&this.bvg()}dTo(K){const pa=this.Vj.instance,Ta=new Date>=this.Q1e;Ta&&(this.Q1e=this.$Zh());Math.abs(K-this.ush)>=.01*K&&pa.c_o(K*this.c3a,Ta);return pa.Aj/this.c3a}koi(K,pa=!1){K*=this.c3a;this.Vj.instance.sBg(K,!1);const Ta={};Ta.initialScale=this.c3a;Ta.finalScale=K;Ta.cancelled=pa;ua.ULS.sendTraceTag(42821150,353,50,"Pinch zoom ended: {0}",Ta)}OEi(K){return(K=K.N1c.center)&&
this.AQa?Object.assign(new Oa,{x:K.x-this.AQa.x,y:K.y-this.AQa.y}):null}$Zh(){const K=(new Date).getTime();return new Date(K+1E3)}}Object(f.a)(Xa,"PinchZoomAdapter",null,[1188]);class ab{constructor(K){this._element=K}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(f.a)(ab,"ScrollContainerElement",null,[1187]);var cb=d(140);class ib{constructor(K,pa,Ta,jb,bc,Ic){this.r$e=this.zib=
null;this.W=K;this.Vd=pa;this.dFd=Ta;this.hqh=jb;this.KBk=bc;this.v7b=Ic;this.Jyd=new yb.a}register(K,pa){this.dFd&&(4===m.AFrameworkApplication.ua.Ib.Tk&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?cb.a.get_instance().Lk(8,()=>{this.KGj(K,pa)}):this.KGj(K,pa))}KGj(K,pa){this.W.Qa("Common.IGestureInputManager").execute(Ta=>{this.acp();this.zib=Ta;this.Jyd.add(K);if(this.hqh){if(this.KBk&&0!==Ta.Stm()){this.rYj();return}var jb=this.W.Qa("Common.IZoomManager");
this.W.resolve("Common.IAppSettingsManager");const bc=new ab(K);jb=new Xa(jb,bc,pa,m.AFrameworkApplication.va,m.AFrameworkApplication.K);Ta.Sto(K,jb)}this.rYj()})}unregister(){if(this.zib&&this.Jyd){if(this.hqh){for(const K of this.Jyd)this.zib.rsp(K);this.Jyd.clear()}this.zib=null}}acp(){this.v7b&&(this.Vd?this.r$e=this.Vd.Vf("Task","Register"):ua.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}rYj(){this.v7b&&(this.r$e?this.r$e.stop():ua.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}
Object(f.a)(ib,"GestureInputRegistrar",null,[1140]);class Ub{constructor(){this.W=null;this.ui=!1}get name(){return"Common.App.GestureInput"}init(){this.ui||(this.W.resolve("Common.IGestureInputRegistrar"),this.ui=!0)}dispose(){}wc(K){this.W=K;K.register(1140,"Common.IGestureInputRegistrar").ha().Rd(()=>new ib(K,m.AFrameworkApplication.ua.hs,m.AFrameworkApplication.f$c(),m.AFrameworkApplication.X0i(),!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!m.AFrameworkApplication.K&&
m.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){H.a.instance.Jc(new Ub)}}Object(f.a)(Ub,"GestureInputPackage",null,[0,1]);var lb=d(443),Qb=d(95);class fc{constructor(){this.Wwb=this.Wsi=null}}Object(f.a)(fc,"GestureAdapterInfo",null,[]);var Fc=d(639),nc=d(310);class zb{constructor(){this.KCb=null}B5f(){if(!this.KCb){var K="hammer.min.js";m.AFrameworkApplication.K.jy("IsServerFlavorDebug")&&(K=m.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");
K=m.AFrameworkApplication.lC(String.format("{0}",K),5);K=nc.a.create(K,null,null);Fc.a.D_(K);this.KCb=K.jbb}return this.KCb}static get instance(){zb._instance||(zb._instance=new zb);return zb._instance}}zb._instance=null;Object(f.a)(zb,"HammerJsDependencyLoader",null,[1190]);const Vb=(K,pa,Ta=null)=>{if(void 0===pa||null===pa)throw ua.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let jb=null;switch(K){case P.a.vqe:jb=new Hammer.Pinch(Ta);
break;case P.a.pan:jb=new Hammer.Pan(Ta)}jb&&(jb.manager=pa);return jb};var rc;(function(K){K[K.none=-1]="none";K[K.vqe=0]="pinch";K[K.pan=1]="pan";K[K.XGg=2]="swipe"})(rc||(rc={}));Object(f.b)("GestureEvent",rc);var pb=d(78);class bb extends pb.a{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd){super(K,Ta,jb,Ic);this.HEc=pa;this.e5a=Uc;this.Zwa=kd;this.xwk=bc}get shiftKey(){return this.e5a}get ctrlKey(){return this.Zwa}get clientPoint(){return this.HEc}get N1c(){return this.xwk}static create(K,pa,Ta,jb,bc,Ic){if(Ta.rawEvent)if(Ic){var Uc=
Ta.rawEvent;Uc=new Sys.UI.Point(Uc.clientX,Uc.clientY)}else Uc=pb.a.I5d(Ta);else Uc=new Sys.UI.Point(Ta.clientX,Ta.clientY);return new bb(K,Uc,pa,Ta,jb,bc,Ta.shiftKey,Ta.ctrlKey,Ic)}}Object(f.a)(bb,"GestureEventArgs",pb.a,[]);class Pb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;
this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(f.a)(Pb,"GestureManagerData",null,[]);class mb{}mb.Xik=2;mb.Yik=4;mb.Zik=8;mb.$ik=8;Object(f.a)(mb,"HammerConstants",null,[]);var Ua=d(106),vb=d(131),Ia=d(19),Ma=d(114);class qb extends T.a{constructor(K,pa){super();this.QRa=lb.a.Hfm;this.M4e=!!window.PointerEvent;this.GIh=window.hasOwnProperty("ontouchstart");this.ODb=this.IMc=null;this.CRa=!1;this.Zpa=new Qb.a;this.NNc=
new Qb.a;this.Ejh=new yb.a;this.Ghb=null;this.R4b=this.v7b=this.Zah=this.YMe=this.o0e=this.pCh=this.pbh=this.yRc=!1;this.zLc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.s$e=null;this.Vvb=(Ta,jb,bc)=>{Ta=this.FAi(Ta);jb=this.ywm(bc);Hammer.inputHandler(this,Ta,jb);this.CRa&&bc.preventDefault();return this.CRa};this.Qne=(Ta,jb,bc)=>{var Ic=bc.rawEvent.pointerType.toString();const Uc=bc.rawEvent.pointerId.toString();if("touch"!==Ic)return!1;Ta=this.FAi(Ta);if(1!==Ta&&!this.Zpa.mb(Uc))return!1;
this.pbh&&1===Ta&&bc.rawEvent.isPrimary&&this.Zpa.count&&(ua.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.WUd());this.yRc?this.aYk(Uc,jb,bc):this.Zpa.Z(Uc,bc);this.o0e&&2===Ta&&(!this.YMe||this.YMe&&"function"===typeof bc.rawEvent.getCoalescedEvents)&&(jb=bc.rawEvent.getCoalescedEvents())&&this.kNi()&&(this.zLc=Math.max(this.zLc,jb.length));this.pCh&&(this.CRa=!1);Ic=this.xwm(this.Zpa,bc,Ic);Hammer.inputHandler(this,Ta,Ic);if(4===Ta||8===Ta)this.yRc?this.TCj(Uc):this.Zpa.remove(Uc),
this.Zpa.count||(this.session=null,this.o0e&&-1!==this.zLc&&(ua.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.zLc),this.zLc=-1));this.CRa&&bc.preventDefault();return this.CRa};this.Bne=()=>!1;this.Eg=Ua.EventHandlerManager.instance;this.M4e?(ua.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.IMc=this.Qne,this.ODb=P.a.Jfm):this.GIh?(ua.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.IMc=this.Vvb,this.ODb=P.a.lAc):(ua.ULS.sendTraceTag(593893139,
310,50,"Using mouse events"),this.IMc=this.Bne,this.ODb=P.a.Ifm);this.Vd=pa;this.G5=K;m.AFrameworkApplication.K&&(this.yRc=m.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.pbh=m.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.pCh=m.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.o0e=m.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),this.YMe=m.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.Zah=m.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),
this.v7b=m.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.R4b=this.yRc&&m.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&m.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}Stm(){return this.M4e?0:this.GIh?1:2}kw(K){super.kw(K);this.Eg.sLa(this.ODb,K,0,this.IMc)}gw(K){super.gw(K);this.Eg.J7a(K,this.ODb)}Sto(K,pa){m.AFrameworkApplication.f$c()?zb.instance.B5f().continueWith(Ta=>{this.$bp();if(Ta.ij||Ta.qp)ua.ULS.sendTraceTag(591192778,
310,10,"Hammer did not download correctly: {0}",Ta.status);else{ua.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Ta.status);if(this.Zah){Ta=window.Hammer;if("undefined"===typeof Ta){ua.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.mBe();return}if("undefined"===typeof Ta.inputHandler){ua.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.mBe();return}}if(!K)throw this.mBe(),Error.argumentNull("source element can not be null");Ta=vb.a.Eb(K,
this.QRa);if(void 0===Ta||null===Ta)Ta=new Qb.a,vb.a.Hm(K,this.QRa,Ta),this.Tto(K);if(!Ta.mb(rc[0])){var jb=Object.assign(new fc,{Wwb:Vb(rc[0],this,null),Wsi:pa});Ta.add(rc[0],jb)}}this.mBe()}):ua.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}$bp(){this.v7b&&(this.Vd?this.s$e=this.Vd.Vf("Task","RegisterGestureAdapterAfterLoad"):ua.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}mBe(){this.v7b&&(this.s$e?this.s$e.stop():ua.ULS.sendTraceTag(590387075,
310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}rsp(K){ua.ULS.sendTraceTag(42256223,310,K?100:10,"source element {0} ",K.id);const pa=vb.a.Eb(K,this.QRa);void 0!==pa&&null!==pa&&(pa.remove(rc[0]),pa.count||(vb.a.mY(K,this.QRa),this.curRecognizer=null,this.ssp(K)))}Tto(K){this.Ejh.add(K);this.Eg.sLa(this.ODb,K,0,this.IMc)}ssp(K){this.Ejh.remove(K);this.Eg.J7a(K,this.ODb)}recognize(K){var pa=Array(K.pointers.length);for(var Ta=0;Ta<K.pointers.length;Ta++)pa[Ta]=K.pointers[Ta].target;
Ta=null;for(this.Ghb=this.lzm(pa);void 0!==this.Ghb&&null!==this.Ghb&&(Ta=vb.a.Eb(this.Ghb,this.QRa),void 0===Ta||null===Ta);this.Ghb=this.Ghb.parentNode);if(void 0!==Ta&&null!==Ta){this.curRecognizer&&this.curRecognizer.state===mb.$ik&&(this.curRecognizer=null);pa=Ta.keys;for(const jb of pa){pa=Ta.J(jb);void 0!==pa&&null!==pa&&void 0!==pa.Wwb&&null!==pa.Wwb&&(void 0===this.curRecognizer||null===this.curRecognizer||pa.Wwb===this.curRecognizer||pa.Wwb.canRecognizeWith(this.curRecognizer))&&pa.Wwb.recognize(K);
const bc=pa.Wwb.state;this.curRecognizer||mb.Xik!==bc&&mb.Yik!==bc&&mb.Zik!==bc||(this.curRecognizer=pa.Wwb)}}}emit(K,pa){if("hammer.input"!==K){this.CRa=!1;pa=bb.create(K,this.Ghb,pa.srcEvent,pa,3,this.M4e);var Ta=vb.a.Eb(this.Ghb,this.QRa);if(this.yon(K))var jb=0;else if(this.Unn(K))jb=1;else if(this.dsn(K))jb=2;else{ua.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:Ta}=Ta.Dc(rc[jb]));void 0!==Ta&&null!==Ta&&((Ta=Ta.Wsi,Ta.Hjn())?K.endsWith("start")?
this.CRa=Ta.kYn(pa):K.endsWith("end")?(Ta.iYn(pa),this.CRa=!0):K.endsWith("cancel")?(Ta.hYn(pa),this.CRa=!0):K.endsWith("move")&&(this.CRa=Ta.jYn(pa)):ua.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",K))}}get(K){return Object(Za.a)(Hammer.Recognizer,K)}lzm(K){if(1>K.length)return null;if(1===K.length)return K[0];var pa=K[0],Ta=!0;for(let jb=1;jb<K.length;jb++){if(!K[jb])return null;if(pa!==K[jb]){Ta=!1;break}}if(Ta)return pa;pa=this.Ati(K[0]);Ta=0;for(const jb of K){K=
this.Ati(jb);if(pa.J(pa.count-1)!==K.J(K.count-1))return null;for(let bc=pa.count-2,Ic=K.count-2;bc>=Ta&&0<=Ic;bc--,Ic--)if(pa.J(bc)!==K.J(Ic)){Ta=bc+1;break}}return pa.J(Ta)}Ati(K){const pa=new yb.a;for(;void 0!==K&&null!==K;K=K.parentNode)pa.add(K);return pa}FAi(K){switch(K){case P.a.ES:case P.a.XKb:return 1;case P.a.CS:case P.a.pmf:return 2;case P.a.rM:case P.a.YKb:return 4;case P.a.HDe:case P.a.omf:return 8}return 0}kNi(){return 1<this.Zpa.count}WUd(){ua.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");
if(this.yRc)for(const K of this.Zpa)this.TCj(K.key);else this.Zpa=new Qb.a;this.session=null}aYk(K,pa,Ta){ua.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",K);if(!this.NNc.mb(K)){try{pa.setPointerCapture(K)}catch(jb){ua.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",jb)}this.NNc.add(K,pa)}this.Zpa.Z(K,Ta);this.R4b&&1<this.Zpa.count&&this.G5&&!this.G5.UUc&&(this.G5.UUc=!0)}TCj(K){ua.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",K);
if(this.NNc.mb(K)){try{this.NNc.J(K).releasePointerCapture(K)}catch(pa){ua.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",pa)}this.NNc.remove(K)}else ua.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",K);this.Zpa.remove(K);this.R4b&&1>=this.Zpa.count&&this.G5&&this.G5.UUc&&(this.G5.UUc=!1)}ywm(K){const pa=new Pb;var Ta=K.rawEvent;const jb=Ta.touches;Ta=Ta.changedTouches;pa.pointers=Array.clone(jb);pa.pointers=Array.clone(0<jb.length?jb:Ta);pa.changedPointers=
Array.clone(Ta);pa.srcEvent=K;pa.pointerType="touch";return pa}xwm(K,pa,Ta){const jb=new Pb;jb.pointers=Ma.toArray(K.values);jb.changedPointers=[pa];jb.pointerType=Ta;jb.srcEvent=pa;return jb}yon(K){return Ia.a.startsWith(K,P.a.vqe)}Unn(K){return Ia.a.startsWith(K,P.a.pan)}dsn(K){return Ia.a.startsWith(K,P.a.XGg)}}Object(f.a)(qb,"GestureInputManager",T.a,[1152,1153]);var Xb=d(316);class Cc{constructor(){this.W=null;this.ui=!1}get name(){return"Common.App.GestureInputManager"}wc(K){K.register(qb,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").ha().Rd(()=>
new qb(Xb.a.instance,m.AFrameworkApplication.ua.hs));this.W=K}init(){this.ui||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),this.ui=!0)}dispose(){}static main(){H.a.instance.Jc(new Cc)}}Object(f.a)(Cc,"GestureInputManagerPackage",null,[0,1]);var Ec=d(286),Wb=d(49),Hb=d(1634);class Sb{constructor(K,pa,Ta){this.T8e=this.S8e=null;this.tac=new x.a;this.$fd=jb=>{let bc=null;bc&&bc.length||!jb||!jb.data||(bc=jb.data.De);if(bc&&bc.length)try{const Ic=Ya.a(bc);this.S8e=Ic.NavBarDataJson;
ua.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.S8e?({Zu:this.T8e}=Ya.d(Ic.NavBarDataJson)).returnValue?(this.sEn(this.T8e),this.tac.gg(this.T8e)):(ua.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Hb.a.Isd(this.S8e)}),this.tac.qha()):(ua.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.tac.qha())}catch(Ic){ua.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.tac.qha()}else ua.ULS.sendTraceTag(6362369,
215,10,"Response from O365ShellServiceProxy is null.")};this.nfd=()=>{this.tac.qha();ua.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.Af=K;this.AMc=Ta;this.Jqa=pa.appSettings[Sb.rFp]||""}get F0o(){return this.tac.task}get RT(){return this.Af.value}LEo(){const K={};K[Sb.XXm]=m.AFrameworkApplication.jm;K["Content-Type"]="application/json; charset=utf-8";ua.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const pa=Wb.a.lp(this.Jqa+
Sb.G0o,Sb.kTn,m.AFrameworkApplication.ua.Ib.Tk.toString());this.RT.Ij(pa,1,"",K,!0,2,this.$fd,this.nfd,null,void 0,void 0,void 0,void 0,"20")}sEn(K){try{const pa={};pa.FlightName=K.FlightName;pa.SessionID=K.SessionID;ua.ULS.sendTraceTag(594883776,215,50,Ya.c(pa))}catch(pa){ua.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}static get instance(){return Sb._instance||(Sb._instance=Sb.fPb())}static fPb(){return new Sb(new Ec.a(()=>m.AFrameworkApplication.Be),m.AFrameworkApplication.K,
m.AFrameworkApplication.ua.Ib.Tk)}}Sb.XXm="X-qs";Sb.kTn="at";Sb.G0o="O365ShellServiceProxy.ashx";Sb._instance=null;Sb.rFp="ShellWebServiceBase";Object(f.a)(Sb,"O365ShellActor",null,[1148]);class cc{constructor(){this.W=null;this.pz=()=>{m.AFrameworkApplication.BNg&&m.AFrameworkApplication.ua.Ib.BN&&this.W.resolve("Common.App.O365Shell.O365ShellActor").LEo()}}get name(){return"Common.App.O365Shell"}wc(K){this.W=K;this.W.register(Sb,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ha().Rd(()=>
new Sb(new Ec.a(()=>m.AFrameworkApplication.Be),m.AFrameworkApplication.K,m.AFrameworkApplication.ua.Ib.Tk))}init(){m.AFrameworkApplication.K.Rn(this.pz)}dispose(){}static main(){H.a.instance.Jc(new cc)}}Object(f.a)(cc,"PackageManager",null,[0,1]);class Gc{kYa(){}init(){}dispose(){}}Object(f.a)(Gc,"NoOpOfflineLogger",null,[1214,13]);var Oc=d(853);class Zc{}Zc.CSd=0;Object(f.a)(Zc,"OfflineLoggerConstants",null,[]);var kb=d(96),wd=d(270),qe=d(322);class Qd{constructor(K,pa,Ta,jb,bc,Ic){this.l3a=!1;
this.t$=null;this.FFc=this.L8b=this.wCb=0;this.ZK=this.Ajb=this.qT=null;this.hm=!1;this.Khg=(Uc,kd)=>{if(void 0!==kd&&null!==kd&&void 0!==kd.args&&null!==kd.args){Uc=!1;if(!this.Ajb.mb(kd.args.tag)){if(!this.Ajb.mb(Zc.CSd))return;Uc=!0}this.Ajb.remove(Uc?Zc.CSd:kd.args.tag);this.ZK.mb(kd.uploadId)||this.ZK.Z(kd.uploadId,new yb.a);this.ZK.J(kd.uploadId).add(kd.args)}};this.Mhg=(Uc,kd)=>{this.ZK.remove(kd.uploadId);this.nFb&&(this.nFb=!1,this.W2h())};this.Lhg=(Uc,kd)=>{this.nFb=!0;if(void 0!==kd&&null!==
kd&&this.ZK.mb(kd.uploadId)){Uc=!0;var pd=this.ZK.J(kd.uploadId);for(const Fd of pd)pd=Qd.serialize(Fd,this.GHa),this.Tsd(this.vUc(this.FFc++),pd)||(Uc=!1);Uc&&this.ZK.remove(kd.uploadId)}};this.Kdg=()=>{this.dispose()};this.dHa=Ta;this.SHa=jb;this.GHa=bc;this.Af=pa;this.Gb=K;this.l2a=Ic;this.nFb=!1;this.C0e="OfflineLoggerManifest|"+this.l2a;this.ZDk="OfflineLog|"+this.l2a+"|"}init(){this.EBg();this.vAn();this.l3a=!1;this.Af.V5a(this);this.qT=new kb.a(3,2,2500,Object(O.a)(this,this.Wwe,"sendOfflineLogs"),
104);this.Gb.Zb(this.qT)}vUc(K){return this.ZDk+K}vAn(){const K=this.dHa.getItem(this.C0e);void 0!==K&&null!==K&&0<K.length&&(this.t$=Qd.Ssd(K));this.t$||(this.t$={});if(void 0===this.t$.end||null===this.t$.end)this.t$.end=0;if(void 0===this.t$.offset||null===this.t$.offset)this.t$.offset=0;this.wCb=this.t$.offset;isFinite(this.wCb)||(this.wCb=0);this.L8b=this.t$.end;isFinite(this.L8b)||(this.L8b=0);this.FFc=this.L8b}EBg(){this.Ajb=new qe.a;this.ZK=new wd.a;this.SHa.RPh(this.Khg);this.SHa.uQh(this.Mhg);
this.SHa.tQh(this.Lhg);this.SHa.HPh(this.Kdg)}Tsd(K,pa){try{return this.dHa.setItem(K,pa),!0}catch(Ta){return!1}}Wwe(){if(!this.l3a){for(var K=this.wCb,pa=new yb.a,Ta=null;K<this.L8b&&5>=pa.count;++K){var jb=this.vUc(K);const bc=this.dHa.getItem(jb);this.dHa.removeItem(jb);if(void 0===bc||null===bc)continue;const Ic=({sessionId:jb}=Qd.deserialize(bc)).returnValue;if(Ic){if(!Ta)Ta=jb;else if(jb!==Ta)break;pa.add(Ic)}else ua.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",
bc)}0<pa.count&&this.SHa.lGj(this,Ma.toArray(pa),Ta);this.wCb=K;K>=this.L8b&&this.bOb()}}W2h(){this.bOb();this.qT=new kb.a(3,2,2500,Object(O.a)(this,this.Wwe,"sendOfflineLogs"),104);this.Gb.Zb(this.qT)}kYa(K,pa,Ta){!this.hm&&ua.ULS.A4(pa,Ta)&&this.Ajb.Z(K,!0)}dispose(){if(!this.hm){this.qT&&this.Gb.vf(this.qT);var K=Ma.toArray(this.ZK.keys);K.sort();for(const pa of K){K=this.ZK.J(pa);for(const Ta of K)K=Qd.serialize(Ta,this.GHa),this.Tsd(this.vUc(this.FFc++),K)}this.wCb<this.FFc?(this.t$.end=this.FFc,
this.t$.offset=this.wCb,this.Tsd(this.C0e,JSON.stringify(this.t$))):this.dHa.removeItem(this.C0e)}this.hm=!0}$Ca(){this.l3a=!0}GYa(){this.l3a=!1;this.W2h()}bOb(){this.qT&&(this.Gb.vf(this.qT),this.qT=null)}static serialize(K,pa){const Ta={};Ta.t=K.tag;Ta.c=K.category;Ta.l=K.level;Ta.m=K.message;Ta.lt=K.logType;Ta.s=pa;Ta.ts=K.timestamp;Ta.o=K.isMinified;Ta.a=K.args;return JSON.stringify(Ta)}static deserialize(K){return(K=Qd.Ssd(K))?{returnValue:new Oc.a(K.ts,K.c,K.t,K.l,K.m,K.lt,K.o,K.a),sessionId:K.s}:
{returnValue:null,sessionId:null}}static Ssd(K){try{return JSON.parse(K)}catch(pa){ua.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",pa.message)}return null}}Object(f.a)(Qd,"OfflineLoggerImpl",null,[1214,13,300]);class me{constructor(K,pa,Ta,jb){this.sessionId=K;this.version=pa;this.sTd=Ta;this.yig=jb;this.aVb=new yb.a}}Object(f.a)(me,"CachedLogUpload",null,[]);class Ne{constructor(K){K.name&&(this.n=K.name);K.stack&&(this.s=K.stack);K.message&&(this.m=
K.message);K.file&&(this.f=K.file);null!=K.line&&(this.l=K.line);null!=K.column&&(this.c=K.column)}}Object(f.a)(Ne,"LoggingExceptionArgsLocalStorage",null,[]);class Cd{constructor(K){this.t=K.tag;this.c=K.category;this.l=K.level;this.m=K.message;this.lt=K.logType;this.ts=K.timestamp;this.o=K.isMinified;this.a=K.args;K.exceptionArgs&&(this.e=new Ne(K.exceptionArgs))}}Object(f.a)(Cd,"LoggingArgsLocalStorage",null,[]);var Pf=d(517);class cg{constructor(K,pa,Ta,jb,bc,Ic,Uc){this.t=K;this.m=pa;this.s=
Ta;this.v=jb;this.i=bc;this.a=Ic;this.d=Uc;this.op="Log"}}Object(f.a)(cg,"LoggingKeyLocalStorage",null,[]);var mg=d(123);const ci=(K,pa,Ta,jb)=>!(void 0===K||null===K)&&!(void 0===K.i||null===K.i)&&!(void 0===K.t||null===K.t)&&!(void 0===K.s||null===K.s)&&"Log"===K.op&&K.t===pa&&isFinite(K.t)&&mg.a.isValid(K.s)&&(void 0===K.m||null===K.m||K.m===Ta)&&(void 0===K.d||null===K.d||K.d===jb);class Dd{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd,pd,Fd,le,jf){this.l3a=this.cuh=this.Sth=this.Tth=!1;this.ZK=this.Ajb=
this.t$=this.qT=null;this.hm=!1;this.ESl=()=>{this.Jfi(!0)};this.FSl=()=>{this.Jfi(!1)};this.o$o=of=>of.s!==of.s?of.s.localeCompare(of.s):of.i-of.i;this.l$o=of=>of.s!==of.s?of.s.localeCompare(of.s):of.i-of.i;this.Khg=(of,tf)=>{if(void 0!==tf&&null!==tf&&void 0!==tf.args&&null!==tf.args){if(this.Xbd.mb(tf.args.tag))this.Xbd.remove(tf.args.tag);else if(this.Xbd.mb(Zc.CSd))this.Xbd.remove(Zc.CSd);else if(!(this.ODk&&50>tf.args.level))return;({value:of}=this.mMa.Dc(tf.uploadId)).returnValue||(of=new me(tf.sessionId,
tf.version,tf.sTd,tf.yig),this.mMa.Z(tf.uploadId,of));this.mMa.J(tf.uploadId).aVb.add(tf.args)}};this.Mhg=(of,tf)=>{this.mMa.remove(tf.uploadId);this.nFb&&(this.nFb=!1,this.X2h())};this.Lhg=(of,tf)=>{this.nFb=!0;void 0!==tf&&null!==tf&&this.mMa.mb(tf.uploadId)&&this.Xej(tf.uploadId)&&!this.cuh&&(this.cuh=!0)};this.Kdg=()=>{this.dispose()};this.XEb=[];this.E8b=[];this.dHa=Ta;this.SHa=jb;this.GHa=bc;this.Af=pa;this.Gb=K;this.AMc=Ic;this.n2e=Uc;this.BCh=kd;this.G3a=pd;this.ODk=Fd;this.UYe=le;this.l2a=
jf;this.nFb=!1}get manifest(){return this.t$}get Xbd(){return this.Ajb}get mMa(){return this.ZK}init(){this.EBg();this.l3a=!1;this.Af.V5a(this);this.qT=new kb.a(3,1,2500,this.ESl,103);this.Gb.Zb(this.qT)}Jfi(K){this.bOb();this.XEb=[];K&&(this.E8b=[]);for(var pa=0;pa<this.dHa.length;pa++){const Ta=this.dHa.key(pa),jb=Dd.o4j(Ta,!1);ci(jb,this.AMc,this.n2e,this.l2a)&&(jb.s===this.GHa?Array.add(this.XEb,Ta):K&&Array.add(this.E8b,Ta))}if(this.XEb.length||K&&this.E8b.length)if(pa=this.UYe?this.l$o:this.o$o,
this.XEb.sort(pa),K&&this.E8b.sort(pa),0<this.XEb.length||0<this.E8b.length)this.qT=new kb.a(3,2,2500,Object(O.a)(this,this.Wwe,"sendOfflineLogs"),105),this.Gb.Zb(this.qT)}vUc(K,pa,Ta,jb){K=new cg(this.AMc,this.n2e,pa,Ta,K,jb,this.l2a);return JSON.stringify(K)}EBg(){this.Ajb=new qe.a;this.ZK=new wd.a;this.SHa.RPh(this.Khg);this.SHa.uQh(this.Mhg);this.SHa.tQh(this.Lhg);this.SHa.HPh(this.Kdg)}Xej(K){let pa=!1;if(({value:jb}=this.mMa.Dc(K)).returnValue&&jb&&0<jb.aVb.count){if(jb.sTd>=this.G3a)return this.mMa.remove(K),
!1;var Ta=jb.aVb;const bc=Array(Ta.count);for(let Ic=0,Uc=Ta.count;Ic<Uc;++Ic)bc[Ic]=new Cd(Ta.J(Ic));Ta=Dd.serialize(bc);var jb=this.vUc(jb.yig,jb.sessionId,jb.version,jb.sTd);this.Tsd(jb,Ta)&&(this.mMa.remove(K),pa=!0)}return pa}Tsd(K,pa){try{return this.dHa.setItem(K,pa),!0}catch(Ta){return!1}}Wwe(){if(!this.l3a){var K=0<this.XEb.length?this.XEb:this.E8b,pa=K.length;if(pa)for(;0<pa;){pa--;var Ta=this.UYe?K.pop():K[0];this.UYe||Array.removeAt(K,0);const Ic=Dd.o4j(Ta,!0);if(ci(Ic,this.AMc,this.n2e,
this.l2a)){var jb=this.dHa.getItem(Ta);this.dHa.removeItem(Ta);if(void 0!==jb&&null!==jb)if(Ic.a>this.G3a)ua.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",Ic.a,this.G3a);else if(Ta=Dd.Ssd(jb,!0),void 0!==Ta&&null!==Ta&&isFinite(Ta.length))if(Ta.length){jb=Ta[Ta.length-1];var bc=(new Date).getTime()-jb.ts;if(bc<-Dd.T0j)ua.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",jb.ts);else if(bc>
this.BCh*Dd.T0j)ua.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.BCh,jb.ts);else{Ic.s===this.GHa?this.Tth||(this.Tth=!0,ua.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.Sth||(this.Sth=!0,ua.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",Ic.s));pa=Array(Ta.length);for(jb=0;jb<Ta.length;jb++){K=jb;a:{bc=Ta[jb];if(void 0===bc||null===bc){bc=null;break a}let Uc=
null;bc.e&&(Uc=new Pf.a(null),Uc.name=bc.e.n,Uc.stack=bc.e.s,Uc.message=bc.e.m,Uc.file=bc.e.f,Uc.line=bc.e.l,Uc.column=bc.e.c);bc=new Oc.a(bc.ts,bc.c,bc.t,bc.l,bc.m,bc.lt,bc.o,bc.a,Uc)}pa[K]=bc}this.SHa.lGj(this,pa,Ic.s,Ic.v,Ic.a+1,Ic.i);break}}else ua.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",jb);else ua.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",jb)}}else this.bOb()}}X2h(){this.bOb();this.qT=new kb.a(3,1,2500,this.FSl,
102);this.Gb.Zb(this.qT)}kYa(K,pa,Ta){!this.hm&&ua.ULS.A4(pa,Ta)&&this.Xbd.Z(K,!0)}dispose(){if(!this.hm){this.qT&&this.Gb.vf(this.qT);var K=Ma.toArray(this.mMa.keys);for(const pa of K)this.Xej(pa)}this.hm=!0}$Ca(){this.l3a=!0;this.bOb()}GYa(){this.l3a=!1;this.X2h()}bOb(){this.qT&&(this.Gb.vf(this.qT),this.qT=null)}static serialize(K){return JSON.stringify(K)}static o4j(K,pa){(K=Dd.Ssd(K,pa))&&void 0===K.d&&(K=new cg(K.t,K.m,K.s,K.v,K.i,K.a,0));return K}static Ssd(K,pa){try{return JSON.parse(K)}catch(Ta){pa&&
ua.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",Ta.message)}return null}}Dd.T0j=864E5;Object(f.a)(Dd,"OfflineLoggerImplV2",null,[1214,13,300]);class Xc{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(K){return this.handleError("Length",K),-1}}key(K){try{return localStorage.key(K)}catch(pa){return this.handleError("Key",pa),null}}getItem(K){try{return localStorage.getItem(K)}catch(pa){return this.handleError("GetItem",
pa),null}}setItem(K,pa){try{return localStorage.setItem(K,pa)}catch(Ta){return this.handleError("SetItem",Ta),null}}removeItem(K){try{localStorage.removeItem(K)}catch(pa){this.handleError("RemoveItem",pa)}}clear(){try{localStorage.clear()}catch(K){this.handleError("Clear",K)}}handleError(){}}Object(f.a)(Xc,"OfflineStorage",null,[1211]);class Jd{create(K){var pa=null;try{void 0!==localStorage&&null!==localStorage&&(pa=new Xc)}catch(jb){ua.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",
jb.message)}Object.getType(ua.ULS.host).implementsInterface(1183)&&pa||(ua.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",pa?"supported":"not supported",Object.getType(ua.ULS.host).implementsInterface(1183)?"supported":"not supported"),K=0);const Ta=m.AFrameworkApplication.K;1===K?pa=new Qd(m.AFrameworkApplication.mc,m.AFrameworkApplication.Be,pa,ua.ULS.host,m.AFrameworkApplication.userSessionId,m.AFrameworkApplication.Vci):2===K?(K=
m.AFrameworkApplication.ua.Ib,pa=new Dd(m.AFrameworkApplication.mc,m.AFrameworkApplication.Be,pa,ua.ULS.host,m.AFrameworkApplication.userSessionId,K.Tk,K.Dma,Ta.ic("OfflineLoggerRetentionInDays",30),Ta.ic("OfflineLoggerMaxAttempts",5),Ta.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),Ta.$("SendOfflineLogsV2ImprovementIsEnabled"),m.AFrameworkApplication.Vci)):pa=new Gc;pa.init();return pa}}Object(f.a)(Jd,"OfflineLoggerFactory",null,[]);class pf{wc(){}get name(){return"Common.App.OfflineLogger"}init(){const K=
m.AFrameworkApplication.K;let pa=0;K.$("OneNoteOfflineLoggerIsEnabled")?pa=1:K.$("OfflineLoggerV2IsEnabled")&&(pa=2);0!==pa&&(m.AFrameworkApplication.NCe=(new Jd).create(pa))}dispose(){}}Object(f.a)(pf,"OfflineLoggerPackage",null,[0,1]);var Ce=d(47),pc=d(1425);class $c{constructor(K){this.Sbj=null;this.KLm=()=>{ua.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")};this.MLm=pa=>{ua.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");
pa=Ya.a(pa.data.De).state+"";pc.a.instance.setItem("AccountLinkedStatusCache",pa)};ua.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.Kcd=m.AFrameworkApplication.K.kb("PhoneLinkServiceEndpoint");(this.Tba=K)||ua.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.Kcd&&this.Kcd.length||ua.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}G6l(K){K&&(this.Kcd="https://dcg-df.microsoft.com/",ua.ULS.sendTraceTag(526697302,
306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.F6l()}F6l(){ua.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.Sbj)ua.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.Sbj=new Date;var K=new Date;this.Tba.wV("BayBridge",this.Kcd).then(pa=>{const Ta=+new Date-+K;pa.IsSuccess?(ua.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",
Ta),this.u6l(pa.Token,this.Whm())):ua.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",Ta,pa.ErrorCode,pa.ErrorMessage)}).catch(pa=>{ua.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",pa,+new Date-+K)})}}u6l(K,pa){const Ta={};Ta.Authorization="Bearer "+K;Ta["Authorization-Type"]="AAD";Ta.Accept="application/json";Ta["DCG-SessionId"]=
m.AFrameworkApplication.userSessionId;m.AFrameworkApplication.Be.Ij(pa,1,null,Ta,!1,2,this.MLm,this.KLm,null,void 0,void 0,void 0,void 0,"39");Ce.a("FetchAccountLinkedStatus")}jkm(){const K=pc.a.instance.getItem("AccountLinkedStatusCache");return K&&K.length?"true"===K.toLowerCase()?!0:!1:!1}Whm(){return this.Kcd+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}}Object(f.a)($c,"PhoneLinkManager",null,[1138]);class id{constructor(){this.W=null}get name(){return"Common.App.PhoneLink"}wc(K){this.W=
K;this.W.register(1138,"Common.App.PhoneLink.IPhoneLinkManager").ha().Rd(()=>new $c(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){m.AFrameworkApplication.K.Rn(()=>{this.w$a()})}w$a(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){H.a.instance.Jc(new id)}}Object(f.a)(id,"PhoneLinkPackage",null,[0,1]);const de=K=>{try{return Ya.a(K)}catch(pa){}return null};class Ae{constructor(K,pa,Ta,jb,bc,Ic){this.O1=!1;this.Kl=null;this.w4e=!1;this.tkf=Uc=>{const kd=
Uc.SPb();kd.continueWith(()=>{this.Kl=kd.result;this.w4e&&(this.Kl.nC(2,null,!0),this.w4e=!1);this.Kl.JO((pd,Fd)=>{2===Fd.type&&this.Sb.Ob(v.a.xOb,2)});this.Kl.b_((pd,Fd)=>{2===Fd.newState&&this.Sb.Ob(v.a.xOb,2)});2===this.Kl.connectionState&&this.Sb.Ob(v.a.xOb,2)})};this.Psc=Uc=>{this.O1=!1;const kd=de(Uc.data.De);Uc.data.state.BE(kd,this.dth.value)};this.g1n=Uc=>{5!==Uc.data.status||this.O1?this.snj(Uc):(this.O1=!0,this.qmi(Uc.data.state,!1))};this.snj=Uc=>{Uc.data.state.onFailure(-1)};this.Ufd=
Uc=>{this.O1=!1;const kd=de(Uc.data.De);Uc.data.state.BE(kd,this.dth.value);this.Zhj()};this.l1n=Uc=>{5!==Uc.data.status||this.O1?this.unj(Uc):(this.O1=!0,this.smi(Uc.data.state,!1))};this.unj=Uc=>{Uc.data.state.onFailure(-1)};this.ga=K;this.Af=pa;this.gm=Ta;this.dth=jb;this.Ga=bc;this.sDk=Ic}init(K,pa){pa&&K.Qa("Common.Interface.IRtcBasicProvider").execute(this.tkf)}qVa(K){this.qmi(K,!0)}qmi(K,pa){const Ta=this.Qgl(K.YVj),jb={};jb[Ae.I7h]=Ae.J7h;this.ZFj.Ij(Ta,2,"",jb,!1,2,this.Psc,pa?this.g1n:this.snj,
K)}jOb(K){this.smi(K,!0)}smi(K,pa){const Ta=this.Rgl(),jb={};jb[Ae.I7h]=Ae.J7h;jb[Ae.VXm]=Ia.a.ej(K.fGj);jb[Ae.TXm]=this.sDk.value.Wtl;this.ZFj.Ij(Ta,2,"",jb,!1,2,this.Ufd,pa?this.l1n:this.unj,K)}Rgl(){return this.rYh()}Qgl(K){let pa=this.rYh();return pa=Wb.a.lp(pa,Ae.ZXm,K?"2":"1")}rYh(){let K=(this.Ga.value.appSettings.RenameWebServiceBase||"")+Ae.UXm;K=Wb.a.lp(K,Ae.WXm,Ia.a.ej(m.AFrameworkApplication.jm));this.Om&&this.Om.aZf&&(K=Wb.a.lp(K,Ae.YXm,"1"));return K}Zhj(){this.Kl?this.Kl.nC(2,null,
!0):this.w4e=!0}get Sb(){return this.ga.value}get ZFj(){return this.Af.value}get Om(){return this.gm.value}static get instance(){return Ae._instance||(Ae._instance=Ae.fPb())}static fPb(){return new Ae(new Ec.a(()=>m.AFrameworkApplication.va),new Ec.a(()=>m.AFrameworkApplication.Be),new Ec.a(()=>m.AFrameworkApplication.Om),new Ec.a(()=>Ca.a.instance.resolve("Postmessage.IHostPostmessenger")),new Ec.a(()=>m.AFrameworkApplication.K),new Ec.a(()=>Ca.a.instance.resolve("Common.IRenameProps")))}}Ae.I7h=
"Content-Type";Ae.J7h="application/json; charset=utf-8";Ae.UXm="renamehandler.ashx";Ae.WXm="qs";Ae.VXm="n";Ae.YXm="sl";Ae.TXm="X-CoauthLockId";Ae.ZXm="u";Ae._instance=null;Object(f.a)(Ae,"ExecuteRenameFileHandler",null,[]);class gf{constructor(){this.onFailure=this.BE=null;this.YVj=!1}}Object(f.a)(gf,"ExecuteRefreshFilenameData",null,[]);class uf{constructor(){this.onFailure=this.BE=this.fGj=null}}Object(f.a)(uf,"ExecuteRenameFileData",null,[]);class Lf{constructor(){this.W=null;this.kSe=Ae.instance;
this.pz=()=>{m.AFrameworkApplication.M$c()&&(Ae.instance.init(this.W,m.AFrameworkApplication.eld),m.AFrameworkApplication.jOb=Object(O.a)(this,this.jOb,"executeRenameFile"),m.AFrameworkApplication.qVa=Object(O.a)(this,this.qVa,"executeRefreshFilename"),m.AFrameworkApplication.xnd=Object(O.a)(this,this.xnd,"sendFileNameAndLocationUpdateNotification"))}}get name(){return"Common.App.RenameFile.RenameExecutor"}wc(K){this.W=K}init(){m.AFrameworkApplication.K.Rn(this.pz)}jOb(K,pa,Ta){const jb=new uf;jb.fGj=
K;jb.BE=pa;jb.onFailure=Ta;this.kSe.jOb(jb)}qVa(K,pa,Ta){const jb=new gf;jb.BE=K;jb.onFailure=pa;jb.YVj=Ta;this.kSe.qVa(jb)}xnd(){this.kSe.Zhj()}dispose(){}}Object(f.a)(Lf,"PackageManager",null,[0,1]);var hg=d(188);class Vf{constructor(K,pa,Ta){this.NDg=this.ODg=this.PDg=!1;this.dEg=!K&&!pa;this.eEg=!K&&!Ta;this.dEg||this.eEg||(this.PDg=!K,this.ODg=!pa,this.NDg=!Ta)}}Object(f.a)(Vf,"RenameDisabledDialogInfo",null,[]);class ic extends hg.StandardDialog{constructor(K,pa,Ta,jb,bc){super();this.sIg=[];
this.Kia=new Vf(K,pa,Ta);this.Jlb=jb;this.mjb=bc;this.Qg="RenameDisabledDialog";this.Gd=0;this.Pe(1,CommonUIStrings.l_DialogClose);this.bZo();this.oCo()}bZo(){this.Kia.dEg?this.Vpd(this.Jlb?this.mjb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.Kia.eEg?this.Vpd(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.wXk();this.WQd(this.sIg)}Vpd(K){Array.add(this.sIg,
K)}wXk(){const K=[];this.Kia.PDg||Array.add(K,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.Kia.ODg||Array.add(K,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.Kia.NDg||Array.add(K,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<K.length&&Array.add(this.sIg,K)}}Object(f.a)(ic,"ReactRenameDisabledDialogBase",hg.StandardDialog,[]);class yc extends ic{constructor(K,pa,Ta,jb,bc){super(K,pa,Ta,jb,bc)}oCo(){this.Qub(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,
null,null)}}Object(f.a)(yc,"ReactRenameDisabledDialog",ic,[]);class bd{static get kh(){return a.a.az(bd.Mn,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}bd.Mn="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(f.a)(bd,"RenameDisabledDialogHtml",null,[]);class sd extends a.a{constructor(K,pa,Ta,jb,bc){super();this.Kia=new Vf(K,pa,Ta);this.Jlb=jb;this.mjb=bc;this.Qg="RenameDisabledDialog";this.Gd=0;this.Pe(1,CommonUIStrings.l_DialogClose);this.kh=bd.kh;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.L8("RenameRow")}Zba(){if(this.Kia.dEg){let K;K=this.Jlb?this.mjb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;sd.Vpd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),K)}else this.Kia.eEg?sd.Vpd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.w0m()}w0m(){this.Kia.PDg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.Kia.ODg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.Kia.NDg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static Vpd(K,pa,Ta){K.style.display="none";pa.innerText=Ta}}Object(f.a)(sd,"RenameDisabledDialog",a.a,[]);class ie{constructor(K,pa){this.LFb=0;this.Pqf=(Ta,jb,bc,Ic,Uc)=>{if(1===bc)return this.ga.Ob(v.a.lva,1);Ta=Ia.a.BL(this.WQa.FA);Uc=(0,Uc.getNewDocumentTitle)();Uc.length>this.LFb&&(Uc=Uc.substr(0,this.LFb));if(32!==this.ga.Pb(v.a.lva,2,Uc))return this.gBc(Ta),8;this.gBc(Uc);return 32};this.ga=
K;this.WQa=pa}initialize(K){if(!this.ga||!this.WQa)return!1;this.LFb=K;this.Wb();return!0}Wb(){this.ga.ra(v.a.Pqf,y.a.frame,this.Pqf)}gBc(K){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(K))}static Qm(){return new ie(m.AFrameworkApplication.va,m.AFrameworkApplication.It)}}Object(f.a)(ie,"ReactRenameUIHandler",null,[1073]);var We=d(255),Pe=d(1153),Re=d(575),Sf=d(112),vg=d(173),Yg=d(33);class ph{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd,pd,Fd,le,jf){this._initialized=!1;this._element=null;this.LFb=
0;this.r8e=this.LVe=!1;this.ga=K;this.Hoa=pa;this.ne=Ta;this.ox=jb;this.WQa=bc;this.FDh=Ic;this.eMd=Uc;this.tNe=kd;this.Iib=pd;this.Yph=Fd;this.Zi=le;this.tXe=jf}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(K,pa,Ta){if(!(this.ga&&this.WQa&&this.FDh&&this.eMd&&this.tNe&&pa)||0>=K)return!1;this._element=pa;this._element.title=Ta;this._element.setAttribute(Yg.a.Ph,Yg.a.eaa);this._element.setAttribute("Unselectable","on");this.LFb=K;this.LE();return this._initialized=
!0}LE(){this.Hoa&&(this.Hoa.nb(P.a.blur,this._element,Object(O.a)(this,this.onBlur,"onBlur")),this.Hoa.nb(P.a.paste,this._element,Object(O.a)(this,this.Jfd,"onPaste")));this.ne.nb(P.a.Ti,this._element,Object(O.a)(this,this.onKeyDown,"onKeyDown"));this.ox.nb(P.a.nt,this._element,Object(O.a)(this,this.zE,"onPointerDown"));this.ox.nb(P.a.LP,this._element,Object(O.a)(this,this.pDa,"onPointerUp"))}onBlur(){this.isActive&&!this.LVe&&(this.Yph||this.tNe(this._element),this.F5h(),this.gwf(!1));return this.LVe=
!1}Jfd(){ua.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(K){return this.isActive?this.sZn(K):this.tZn(K)}sZn(K){let pa=!1;switch(K.Kb.keyCode){case Sys.UI.Key.enter:this.F5h();this.gwf(this.Zi||this.tXe);pa=!0;break;case Sys.UI.Key.tab:this.Yph&&this.tNe(this._element);break;case Sys.UI.Key.esc:this.vvg(),this.gwf(this.Zi||this.tXe),pa=!0}return pa}tZn(K){let pa=!1;switch(K.Kb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.t3j(this.tXe),
this.isActive&&this.eMd(this._element),pa=!0}return pa}zE(){this.isActive||(this.t3j(!1),this.isActive&&(this._element.focus(),this.eMd(this._element),this.r8e=!0));return!1}pDa(){return this.r8e?(this.eMd(this._element),this.r8e=!1,!0):!1}dpc(){return 32===this.ga.Ob(v.a.lva,1)}F5h(){const K=Ia.a.BL(this.WQa.FA);let pa=this._element.innerText.trim();pa.length>this.LFb&&(pa=pa.substr(0,this.LFb));pa!==K&&""!==pa?32!==this.ga.Pb(v.a.lva,2,pa)?this.vvg():this.gBc(pa):this.vvg()}vvg(){this.gBc(Ia.a.BL(this.WQa.FA))}gBc(K){this._initialized&&
(this._element.innerText=K,this.FDh())}t3j(K){this.dpc()?this.isActive||(K&&(this.LVe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Yg.a.Ph,Yg.a.SUh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,We.a.Yii),this.Iib&&this.Iib.execute(pa=>{pa.hyj(!0)}),K&&this._element.focus(),ua.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.Ob(v.a.jyc,2)}gwf(K){this._element.removeAttribute("contentEditable");
this._element.setAttribute("Unselectable","on");this._element.setAttribute(Yg.a.Ph,Yg.a.eaa);Sys.UI.DomElement.removeCssClass(this._element,We.a.Yii);this.Iib&&this.Iib.execute(pa=>{pa.hyj(!1)});K&&(this._element.blur(),this._element.focus())}static jEa(){Pe.a.jEa(m.AFrameworkApplication.isRtl)}static Qm(){return new ph(m.AFrameworkApplication.va,Re.a.instance,Sf.KeyInputManager.instance,vg.a.instance,m.AFrameworkApplication.It,ph.jEa,fa.a.NMo,fa.a.w3h,Ca.a.instance.Qa("Common.App.Header.HeaderEventSource"),
nb.a.R7,nb.a.Di,nb.a.uj)}}Object(f.a)(ph,"RenameUIHandler",null,[1073]);class Di{static get instance(){return m.AFrameworkApplication.ua.Ib.BN?Di._instance||(Di._instance=ie.Qm()):Di._instance||(Di._instance=ph.Qm())}}Di._instance=null;Object(f.a)(Di,"RenameUIHandlerFactory",null,[]);var bj=d(156);class gi{constructor(){this.Lbg=this.UPn=this.eMl=null}}Object(f.a)(gi,"RenameMruEntryProperties",null,[]);var Zg=d(175),Bb=d(97),Nb=d(1633),Bc;(function(K){K[K.unknown=-1]="unknown";K[K.success=0]="success";
K[K.xhq=1]="renameInvalidFileName";K[K.whq=2]="renameInCoauthNotSupported";K[K.yhq=3]="renameNotSupportedInViewMode";K[K.oao=4]="permissionDenied";K[K.Xjq=5]="serverCommunicationFailure";K[K.O_p=6]="fileNameTooLong"})(Bc||(Bc={}));Object(f.b)("CommonOperationResult",Bc);class td{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd,pd,Fd,le,jf){this.Zmc=()=>Di.instance.initialize(m.AFrameworkApplication.j3d,m.AFrameworkApplication.Yhi,m.AFrameworkApplication.jEj||CommonUIStrings.l_RenameFileTooltip)?32:8;this.jyc=()=>
{const of=this.aCp(),tf=this.dSk();ua.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.rFb,tf,of,this.Jlb);m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.cH&&m.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new yc(this.rFb,!tf,!of,this.Jlb,this.mjb()):new sd(this.rFb,!tf,!of,this.Jlb,this.mjb());return 32};this.lva=(of,
tf,Se,ye,Uf)=>{if(1===Se)return this.dpc();if(!m.AFrameworkApplication.jOb)return 8;if(8===this.dpc())return this.Sb.Ob(v.a.jyc,2),8;ua.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");m.AFrameworkApplication.jOb(Uf,Object(O.a)(this,this.Ufd,"onRenameFileSuccess"),this.k1n);m.AFrameworkApplication.iEj=!0;return 32};this.k1n=of=>{const tf=new hg.StandardDialog;tf.Gd=0;switch(of){case 1:ua.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");tf.Nna(CommonUIStrings.l_RenameFileInvalidNameTitle,
CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:ua.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");tf.Nna(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:ua.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:of}),tf.Nna(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}m.AFrameworkApplication.IR().execute(Se=>{Se.sendMessage(Bb.a.m7l,{["FailureMessage"]:Bc[of]})});
this.ZGj()};this.Sro=(of,tf,Se)=>{if(1===Se)return this.dpc();if(!m.AFrameworkApplication.qVa)return 8;m.AFrameworkApplication.qVa(Object(O.a)(this,this.Psc,"onRefreshFilenameSuccess"),Object(O.a)(this,this.Tne,"onRefreshFilenameFailure"),!1);return 32};this.Rke=(of,tf,Se,ye,Uf)=>{if(1===Se)return m.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.dpc():8;if(2===Se){if(!m.AFrameworkApplication.xnd)return sa.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",
!1,!1,null),8;if(!Uf)return sa.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Uf[Zg.a.xgn])if(Uf[Zg.a.X9j])if(of=Uf[Zg.a.X9j].toLowerCase(),tf=m.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),Se=m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),tf&&m.AFrameworkApplication.Rtb&&Se){const sh={};sh[Zg.a.cvc]="1";sh[Zg.a.documentUrl]=of;sh[Zg.a.reason]=Nb.a.Pwg;sa.Health.instance.recordKpiSuccess("MoveToFolder",
null);m.AFrameworkApplication.IR().execute(Tf=>{Tf.sendMessage(Bb.a.BNb,sh)})}else if(!m.AFrameworkApplication.Rtb&&Se)sa.Health.instance.recordKpiSuccess("MoveToFolder",null),fa.a.yn(of,fa.a.wwa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return sa.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else sa.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else m.AFrameworkApplication.qVa(Object(O.a)(this,this.Psc,"onRefreshFilenameSuccess"),
Object(O.a)(this,this.Tne,"onRefreshFilenameFailure"),!1),m.AFrameworkApplication.xnd(),sa.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};this.rqh=K;this.ga=pa;this.gm=Ta;this.mO=jb;this.rFb=bc;this.dSk=Ic;this.Jlb=Uc;this.HJh=kd;this.JKk=pd;this.mjb=Fd;this.Ga=le;this.IKk=jf}Wb(){m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.BN||this.Sb.ra(v.a.Zmc,y.a.frame,this.Zmc);this.Sb.ra(v.a.jyc,y.a.frame,this.jyc);this.Sb.ra(v.a.lva,y.a.frame,this.lva);this.Sb.fb(v.a.xOb,y.a.frame,
this.Sro,64);this.Sb.fb(v.a.Rke,y.a.frame,this.Rke,64);this.Sb.ra(v.a.JVb,y.a.frame,Object(O.a)(this,this.JVb,"moveToFolder"));(m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||m.AFrameworkApplication.ua&&(m.AFrameworkApplication.K.$("PostMessageEmbedded")||m.AFrameworkApplication.K.$("IsJsApi"))&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0))&&m.AFrameworkApplication.IR().execute(K=>
{K.Aw(Bb.a.tfj);K.BD(Bb.a.tfj,td.roo);K.Aw(Bb.a.sDf);K.BD(Bb.a.sDf,td.qoo)})}dpc(){return 0===this.IKk.aGi()?32:8}aCp(){return this.Om?this.Jlb?this.Om.gii:this.Om.qqb:!0}Ufd(K,pa){K?0!==K.OperationResult?this.yMi(K.OperationResult):(this.EOo(pa,K.NewName),this.Ptp(K,Object(O.a)(m.AFrameworkApplication.ua.Ib,m.AFrameworkApplication.ua.Ib.n8j,"updateOpenInClientDocumentUrl")),m.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&m.AFrameworkApplication.ua.Ie(),this.JKk.W5j()):this.yMi(5)}EOo(K,
pa){const Ta={};Ta[Zg.a.n7l]=pa;K.sendMessage(Bb.a.sDf,Ta)}Ptp(K,pa){this.cup(K);m.AFrameworkApplication.P_d=K.DirectInvokeDavUrl;pa=pa(K.EditDocInClientUrl);const Ta=new gi;Ta.Lbg=this.mO.FA;Ta.eMl=pa;Ta.UPn=K.EditDocInClientUrl;this.Sb.Pb(v.a.kEj,2,Ta)}yMi(K){switch(K){case 1:K=new hg.StandardDialog,K.Gd=0,K.yY(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.ZGj()}}cup(K){this.mO.FA=td.A6k(this.mO.FA,K.NewName);K.BreadcrumbFolderName&&(this.mO.breadcrumbFolderName=
K.BreadcrumbFolderName);K.BreadcrumbFolderUrl&&(this.mO.breadcrumbFolderUrl=K.BreadcrumbFolderUrl);this.HJh(K.NewName)}JVb(K,pa,Ta,jb,bc){if(1===Ta)return m.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===Ta){const Ic={};K=m.AFrameworkApplication.Rtb;pa=m.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");K=(!K||K&&pa)&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Ic[Zg.a.Lep]=K;bc&&bc.MoveButtonClickedTime&&(Ic[Zg.a.FNn]=
bc.MoveButtonClickedTime.getTime());m.AFrameworkApplication.IR().execute(Uc=>{Uc.sendMessage(Bb.a.JVb,Ic)});if(bc&&bc.MoveButtonClickedTime){if(K=bj.a.KG())bc=(new Date).getTime()-bc.MoveButtonClickedTime.getTime(),K.set("MovePostDuration",bc.toString());sa.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",K)}return 32}return 8}N4o(K,pa){return K&&pa?K!==this.mO.breadcrumbFolderName||pa!==this.mO.breadcrumbFolderUrl:!1}Psc(K,pa){K&&(K.NewName!==Ia.a.BL(this.mO.FA)||this.N4o(K.BreadcrumbFolderName,
K.BreadcrumbFolderUrl))&&this.Ufd(K,pa)}Tne(){}ZGj(){this.HJh(Ia.a.BL(this.mO.FA))}get Sb(){return this.ga.value}get Om(){return this.gm.value}static get instance(){return td._instance||(td._instance=td.fPb())}static fPb(){return new td(m.AFrameworkApplication.M$c,new Ec.a(()=>m.AFrameworkApplication.va),new Ec.a(()=>m.AFrameworkApplication.Om),m.AFrameworkApplication.It,m.AFrameworkApplication.iua,()=>m.AFrameworkApplication.KNg,m.AFrameworkApplication.eld,Object(O.a)(Di.instance,Di.instance.gBc,
"updateTitle"),Ca.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>m.AFrameworkApplication.nw,m.AFrameworkApplication.K,Ca.a.instance.resolve("Common.IRenameProps"))}static A6k(K,pa){K=Ia.a.fla(K);return pa+K}static roo(K){const pa=K.Values[Zg.a.Cmn];ua.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",pa);pa?m.AFrameworkApplication.va.Pb(v.a.Rke,2,K.Values):sa.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static qoo(K){m.AFrameworkApplication.va.Pb(v.a.lva,
2,K.Values.NewName)}}td._instance=null;Object(f.a)(td,"RenameActor",null,[]);var Je=d(200),Ef=d(1434),Ih=d(617),tg=d(417);class Dh{constructor(K,pa){this.ga=K;this.nGc=pa}Wb(){this.ga.ra(v.a.ZDg,y.a.frame,Object(O.a)(this,this.L7o,"showRenameDialogAction"))}L7o(K,pa,Ta){K=32;if(1===Ta)return tg.SessionStatusManager.instance.Gk||m.AFrameworkApplication.Lta?8:32;2===Ta&&(32!==this.ga.Ob(v.a.lva,1)?(this.ga.Ob(v.a.jyc,2),Je.a.instance.$b(Ef.a.usa,{["Reason"]:Ih.a.xBo}),K=8):32===this.ga.Ob(v.a.kyc,1)?
this.ga.Ob(v.a.kyc,2):this.nGc.value.create().L_a());return K}}Object(f.a)(Dh,"RenameDialogActor",null,[1066]);class Jh{constructor(K,pa,Ta){this.dialog=null;this.ga=K;this.mO=pa;this.qib=Ta}WHm(){const K={};K.nameInputProps={["type"]:"AppInputProps",["id"]:Jh.mhc,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Ia.a.BL(this.mO.FA),["maxLength"]:this.qib};return K}L_a(){const K={["id"]:"RenameDialog",["bodyControls"]:this.WHm()};this.dialog=new a.a(!1,!1,!0);this.dialog.Gd=1;this.dialog.Qg=
"RenameDialog";this.dialog.pi(CommonUIStrings.l_RenameDialogTitle,Object(O.a)(this,this.ztg,"renameDialogHandler"),K)}ztg(K,pa){if(pa&&1===K){if(pa[Jh.mhc]&&(K=Ia.a.BL(this.mO.FA),pa=(pa[Jh.mhc]||"").trim(),pa!==K&&""!==pa)){this.ga.Pb(v.a.lva,2,pa);return}Je.a.instance.$b(Ef.a.jhc,{["Reason"]:Ih.a.Xni})}}}Jh.mhc="txtDocumentName";Object(f.a)(Jh,"ReactRenameDialog",null,[1074]);class Xh{static get kh(){return a.a.az(Xh.Mn,CommonUIStrings.l_RenameDialogLabel)}}Xh.Mn="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(Xh,"RenameDialogHtml",null,[]);class Mf extends a.a{constructor(K,pa,Ta){super();this.ga=K;this.mO=pa;this.qib=Ta;this.Qg="RenameDialog";this.kh=Xh.kh}L_a(){var K={["txtDocumentName"]:Ia.a.BL(this.mO.FA)};this.pi(CommonUIStrings.l_RenameDialogTitle,Object(O.a)(this,this.ztg,"renameDialogHandler"),K);K=document.getElementById(Mf.mhc);0<this.qib&&(K.maxLength=this.qib);K.focus()}ztg(K,pa){if(1===K&&(K=Ia.a.BL(this.mO.FA),pa=(pa[Mf.mhc]||"").trim(),pa!==K&&""!==pa)){this.ga.Pb(v.a.lva,2,
pa);return}Je.a.instance.$b(Ef.a.jhc,{["Reason"]:Ih.a.Xni})}}Mf.mhc="txtDocumentName";Object(f.a)(Mf,"RenameDialog",a.a,[1074]);class Jg{constructor(K){this.WQa=null;this.qib=0;this.ga=K;this._initialized=!1}initialize(K,pa){this.WQa=K;this.qib=pa;this._initialized=!0}create(){return this._initialized?m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.cH&&m.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new Jh(this.ga,this.WQa,this.qib):new Mf(this.ga,this.WQa,this.qib):null}}Object(f.a)(Jg,
"RenameDialogFactory",null,[1065]);var ug=d(184),ze=d(119);class pi{constructor(K,pa){this.ga=K;this.Yb=pa}Wb(){this.ga.ra(v.a.kyc,y.a.frame,Object(O.a)(this,this.M7o,"showRenameFlyoutAction"))}lll(){return F.d("setDocumentTitleFlyoutOpened")&&m.AFrameworkApplication.ua.Ib.BN}M7o(K,pa,Ta){if(1===Ta)return this.lll()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}mZk(){pi.jrn&&m.AFrameworkApplication.BI&&ze.a.instance.Zb(new kb.a(5,1,5E3,()=>{32===this.ga.Ob(v.a.kyc,
1)&&this.Yb&&this.Yb.currentScope.name===ug.AFrame.Ho&&(Ce.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.Ob(v.a.kyc,2))}))}static get jrn(){pi.vFd&&null!=pi.vFd||(m.AFrameworkApplication.Ld("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),pi.vFd=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return pi.vFd}}pi.vFd=null;Object(f.a)(pi,"RenameFlyoutActor",null,[1064]);
class og{constructor(K,pa,Ta,jb,bc){this.Wtl=null;this.gm=bc;this.sqh=Ta;this.rqh=jb;this.fSk=K;this.mjb=pa}get Om(){return this.gm.value}aGi(){if(!this.rqh())return 5;if(this.mjb())return 1;if(this.Om){if(this.sqh&&!this.Om.gii)return 3;if(!this.sqh&&!this.Om.qqb)return 4}return this.fSk()?0:2}}Object(f.a)(og,"RenameProps",null,[1063]);class Jk{constructor(K,pa,Ta,jb,bc,Ic){this.Qs=!1;this.r_e=new Qb.a;this.u6b=pa;this.sB=Ta;this.o5b=jb;this.Ga=bc;this.mja=Ic}enable(){this.Qs||(this.W5j(),this.DFg(),
this.Qs=!0)}generateKey(K,pa,Ta){return String.format("{0}/{1}/{2}",Ta,K,pa)}fxm(){const K=Ia.a.BL(this.u6b().FA);return this.generateKey(this.u6b().breadcrumbFolderName,this.u6b().breadcrumbFolderUrl,K)}gxm(K,pa,Ta){return K&&pa?this.generateKey(K,pa,Ta):Ta}HTl(K,pa,Ta){return K&&K!==this.u6b().breadcrumbFolderName||pa&&pa!==this.u6b().breadcrumbFolderUrl?!0:Ta!==Ia.a.BL(this.u6b().FA)}W5j(){const K=this.fxm();this.r_e.Z(K,new Date)}Jkg(K){this.U2o(K)&&this.gMh(K)}U2o(K){const pa=this.o5b();return pa?
this.mja&&this.mja.Ko||!pa.aZf||!m.AFrameworkApplication.qVa?(this.vYj(K),this.Qs=!1):!0:!1}woj(K,pa,Ta,jb){const bc=this.HTl(K,pa,Ta);K=this.gxm(K,pa,Ta);pa=this.r_e.Dc(K).returnValue;bc&&!pa&&(this.AMi(jb),ua.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.H6f));bc||this.r_e.Z(K,this.sB())}}Object(f.a)(Jk,"ARenamedFileChecker",null,[1029]);class zk extends Jk{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd){super(K,pa,Ta,jb,bc,Ic);this.XMi=(pd,Fd)=>{Fd&&Fd.TVb&&Fd.Zij&&(Fd.OXa("BreadcrumbDocName")||
Fd.OXa("BreadcrumbFolderName")||Fd.OXa("BreadcrumbFolderUrl")||Fd.OXa("DirectInvokeDAVUrl")||Fd.OXa("EditDocInClientUrl"))&&(ua.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.H6f),this.Jkg(Fd))};this.xO=bc;this.HKk=Uc;this.mVe=kd}get H6f(){return"RenamedFileCheckerUsingSettingsRefresh"}DFg(){this.xO.NSc(this.XMi)}vYj(){this.xO.itg(this.XMi)}gMh(K){if(K&&K.TVb){const pa=K.TVb;this.woj(pa.kb("BreadcrumbFolderName"),pa.kb("BreadcrumbFolderUrl"),pa.kb("BreadcrumbDocName"),K)}}AMi(K){const pa=
{OperationResult:0,classId:1};K=K.TVb;pa.BreadcrumbFolderName=K.kb("BreadcrumbFolderName");pa.BreadcrumbFolderUrl=K.kb("BreadcrumbFolderUrl");pa.DirectInvokeDavUrl=K.kb("DirectInvokeDAVUrl");pa.EditDocInClientUrl=K.kb("EditDocInClientUrl");K=K.kb("BreadcrumbDocName");pa.NewName=m.AFrameworkApplication.q0d?K:Ia.a.BL(K);this.mVe.execute(Ta=>{this.Hcn(pa,Ta)})}Hcn(K,pa){this.HKk().Ufd(K,pa)}}Object(f.a)(zk,"RenamedFileCheckerUsingSettingsRefresh",Jk,[]);class Xf extends Jk{constructor(K,pa,Ta,jb,bc,
Ic,Uc,kd,pd,Fd){super(K,Ta,jb,bc,Ic,pd);this.yOc=this.uk=null;this.RIk=pa;this.ga=Uc;this.Gb=kd;Fd&&Fd.execute(le=>{this.two(le)})}get H6f(){return"RenamedFileCheckerUsingTask"}two(K){this.uk=K;this.uk.nIa(Object(O.a)(this,this.U_,"handleVisibilityChange"))}U_(K,pa){!this.Qs||0!==pa.newState&&1!==pa.newState||this.yOc||(this.DFg(),this.Jkg(this.yOc))}DFg(){this.yOc=new kb.a(3,2,this.RIk(),Object(O.a)(this,this.Jkg,"performRenameFileCheckTick"),89);this.Gb.Zb(this.yOc)}vYj(K){this.Gb.vf(K)}gMh(K){this.uk&&
2===this.uk.zA?this.nyo(K):m.AFrameworkApplication.qVa(Object(O.a)(this,this.Psc,"onRefreshFilenameSuccess"),Object(O.a)(this,this.Tne,"onRefreshFilenameFailure"),!0)}nyo(K){this.Gb.vf(K);this.yOc=null}Psc(K){K&&this.woj(K.BreadcrumbFolderName,K.BreadcrumbFolderUrl,K.NewName,null)}AMi(){this.ga.Ob(v.a.xOb,2)}Tne(){}}Object(f.a)(Xf,"RenamedFileCheckerUsingTask",Jk,[]);var Gg=d(73);class Lg{constructor(){this.Ga=this.W=null;this.pz=()=>{const K=m.AFrameworkApplication.ua.Ib.BN;m.AFrameworkApplication.M$c()&&
Di.instance.initialize(m.AFrameworkApplication.j3d,K?null:m.AFrameworkApplication.Yhi,K?null:m.AFrameworkApplication.jEj||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(og,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Rd(()=>new og(()=>m.AFrameworkApplication.KNg,()=>m.AFrameworkApplication.nw,m.AFrameworkApplication.eld,m.AFrameworkApplication.M$c,new Ec.a(()=>m.AFrameworkApplication.Om))).ha(),td.instance.Wb(),this.Ga.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(m.AFrameworkApplication.It,
m.AFrameworkApplication.j3d),this.W.resolve("Common.App.Rename.IRenameDialogActor").Wb()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Wb(),m.AFrameworkApplication.eld&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").mZk())}}get name(){return"Common.App.RenameFile"}wc(K){this.W=K;this.Ga=m.AFrameworkApplication.K;this.W.register(Dh,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Rd(()=>
new Dh(m.AFrameworkApplication.va,this.W.rf("Common.App.Rename.IRenameDialogFactory"))).ha();this.W.register(Jg,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Rd(()=>new Jg(m.AFrameworkApplication.va)).ha();this.W.register(1029,"Common.App.Rename.IRenamedFileChecker").Rd(()=>this.cJl()).ha();this.W.register(pi,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Rd(()=>new pi(m.AFrameworkApplication.va,Gg.FocusManager.instance())).ha()}cJl(){if(this.Ga.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const K=
this.W.Oa("Common.IRefreshableAppSettings");if(K&&K.F1i)return new zk(()=>K.ic("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>m.AFrameworkApplication.It,()=>new Date,()=>m.AFrameworkApplication.Om,K,this.W.Oa("Common.ISessionStatus"),()=>td.instance,this.W.Qa("Postmessage.IHostPostmessenger"))}return new Xf(()=>this.Ga.ic("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Ga.ic("RenamedFileCheckerPingIntervalInMs",12E4),()=>m.AFrameworkApplication.It,()=>new Date,()=>m.AFrameworkApplication.Om,m.AFrameworkApplication.K,
m.AFrameworkApplication.va,m.AFrameworkApplication.mc,this.W.Oa("Common.ISessionStatus"),this.W.Qa("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Ga.Rn(this.pz)}dispose(){}}Object(f.a)(Lg,"PackageManager",null,[0,1]);class ak extends a.a{constructor(K,pa,Ta){super(!1,!1,!0);this.bmd=(jb,bc)=>{if(1===jb){jb=bc.ribbonLayoutChoice;const Ic=bc.showRibbonChoice;bc.checkedNewLookToggle!==this.Tph&&appChrome.api.getToggleVNextLookHandler()();if(this.VCh!==jb)appChrome.onRibbonModeToggle();
this.FFh!==Ic&&("AlwaysShow"===Ic?appChrome.api.getAlwaysShowCommandHandler():appChrome.api.getHideCommandHandler())()}};this.Tph=K;this.VCh=pa;this.FFh=Ta}start(){this.pi("",this.bmd,{["id"]:"RibbonSettingsDialog",["bodyControls"]:{["checkedNewLookToggle"]:this.Tph,["ribbonLayoutChoice"]:this.VCh,["showRibbonChoice"]:this.FFh}})}}Object(f.a)(ak,"RibbonSettingsDialog",a.a,[]);class Rf{constructor(K){this.ga=K}Wb(){this.ga.ra(v.a.Q7o,y.a.frame,this.R7o)}R7o(){let K="SingleLineRibbon";const pa=m.AFrameworkApplication.K.$("Fluent2StyleIsEnabled");
"Multiline"===appChrome.selectors.getRibbonMode()&&(K="ClassicRibbon");const Ta=appChrome.selectors.getShyState().isActive?"AutomaticallyHide":"AlwaysShow";(new ak(pa,K,Ta)).start();return 32}}Object(f.a)(Rf,"RibbonSettingsDialogActor",null,[1031]);class Bg{constructor(){this.W=null}get name(){return"Common.App.RibbonSettings"}wc(K){this.W=K;this.W.register(Rf,"Common.App.RibbonSettings.RibbonSettingsDialogActor").as("Common.App.RibbonSettings.IRibbonSettingsDialogActor").Rd(()=>new Rf(m.AFrameworkApplication.va)).ha()}init(){const K=
this.W.Oa("Common.App.RibbonSettings.IRibbonSettingsDialogActor");K?K.Wb():N.b(508436678,200,15,"Failed to resolve IRibbonSettingsDialogActor. Ribbon dialog feature is not enabled.")}dispose(){}static main(){H.a.instance.Jc(new Bg)}}Object(f.a)(Bg,"RibbonSettingsPackage",null,[0,1]);class bk{static get kh(){return a.a.az(bk.Mn,CommonUIStrings.l_SaveACopyFileName)}}bk.Mn="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(bk,"FileNameDialogHtml",null,[]);class Kk extends a.a{constructor(K,pa,Ta,jb){super();this.TBd=this.sRa=null;this.ga=K;this.Gwa=pa;this.Mbc=Ta;this.Pe(1,CommonUIStrings.l_SaveButtonLabel);this.kh=bk.kh;this.Qg="FileNameDialog-SaveACopy";this.zh=jb}SJa(K,pa,Ta){this.TBd=K;this.sRa=Ta;K={["txtFileName"]:Ia.a.BL(m.AFrameworkApplication.It.FA),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,pa)};this.pi(CommonUIStrings.l_SaveToOneDrive,Object(O.a)(this,this.i3d,"fileNameDialogHandler"),
K);ua.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}i3d(K,pa){1!==K?ua.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(K=pa.txtFileName.trim(),ua.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),pa=Ia.a.fla(m.AFrameworkApplication.fileName),K&&""!==K&&""!==pa&&(K+=pa),this.Mbc.HEa(this.TBd,this.sRa,K,this.zh))}}Object(f.a)(Kk,"FileNameDialog",
a.a,[1049]);class Pi{constructor(K,pa,Ta){this.ga=K;this.Gwa=pa;this.Mbc=Ta}create(K){return new Kk(this.ga,this.Gwa,this.Mbc,K)}}Object(f.a)(Pi,"FileNameDialogFactory",null,[1032]);class Uj extends hg.StandardDialog{constructor(K){super();this.Lvg=pa=>{1===pa?(ua.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.Ob(v.a.Ldb,2)):ua.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};this.Gd=1;this.Pe(1,CommonUIStrings.l_RetryButtonLabel);this.Pe(0,CommonUIStrings.l_DialogClose);
this.ga=K}jR(K){ua.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",K);this.Gy(K,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,this.Lvg)}}Object(f.a)(Uj,"RetryDialog",hg.StandardDialog,[1030]);var jk=d(1297);class Bj{}Bj.Nxb="SaveToCloudStorage";Bj.Ldb="SaveACopy";Object(f.a)(Bj,"SaveToCloudStorageConstants",null,[]);class Vj{constructor(K,pa,Ta,jb){this.pLd=null;this.cMk=K;this.Ga=Ta;this.Xxh=pa;this.wth=new x.a;this.Vd=jb}Epc(){return this.Ga.$("SaveToCloudStorageUIIsEnabled")}jqb(){return v.a.Nxb}FUd(){Fc.a.Rte(Object(O.a)(this,
this.wJj,"saveToCloudActionDispatcher"));Fc.a.y_c([new jk.a(v.a.Nxb,y.a.frame,0)],this.Xxh.Gkc())}Wb(){const K=this.Xxh.Gkc();K?(K.w2(()=>{this.wth.gg(!0)}),this.FUd()):ua.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}rzj(){ua.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}wJj(K,pa,Ta,jb,bc){jb="";switch(K){case v.a.Nxb:jb=Bj.Nxb;break;case v.a.Ldb:jb=Bj.Ldb;break;default:ua.ULS.sendTraceTag(508372377,216,50,
"SaveToCloudStorageActor Entry Point other than SaveToCloudStorage or SaveACopy")}return pa.contextId!==y.a.frame||K!==this.jqb()?2:this.Epc()?1===Ta?tg.SessionStatusManager.instance.Gk||m.AFrameworkApplication.Lta?8:32:2===Ta?(this.rzj(),bc&&m.AFrameworkApplication.K.$("EntryPoint_SaveToCloudStorage")&&(bc.SaveEntryPoint=jb),bc&&bc.FileDownloadUrl&&ua.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Vd&&(this.pLd=this.Vd.Vf("DialogShown","SaveToOneDriveReponseTime")),
this.wth.task.continueWith(()=>{this.pLd&&(this.pLd.stop(),this.pLd=null);this.cMk.start(bc)}),32):8:8}}Object(f.a)(Vj,"SaveToCloudStorageActor",null,[1037]);class Cl extends Vj{constructor(K,pa,Ta,jb){super(K,pa,Ta,jb);this.tHk=pa}Epc(){return this.Ga.$("SaveACopyBrsIsEnabled")}jqb(){return v.a.Ldb}FUd(){Fc.a.Rte(Object(O.a)(this,this.wJj,"saveToCloudActionDispatcher"));Fc.a.y_c([new jk.a(v.a.Ldb,y.a.frame,0)],this.tHk.Gkc())}rzj(){m.AFrameworkApplication.Ld("CreateCopy_cf;CreateCopy_tf");ua.ULS.sendTraceTag(7205456,
216,50,"User clicked on SaveAs button from the backstage.")}}Object(f.a)(Cl,"SaveACopyActor",Vj,[]);class ah{}ah.default=0;Object(f.a)(ah,"SaveToCloudErrorCodes",null,[]);class zh{constructor(K,pa,Ta,jb,bc,Ic){this.zh=null;this.ZNk=K;this.xya=pa;this.Mbc=Ta;this.Ga=jb;this.u4b=bc;this.vJ=Ic}start(K){this.zh=K;var pa=null!==this.zh&&this.zh.hasOwnProperty("SaveEntryPoint")&&this.zh.SaveEntryPoint.toString()===Bj.Nxb;if("SharePointOnlineConsumer"===this.Ga.kb("FileSource")){const Ta=Ca.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");
if(Ta){Ta.start(null,K);return}}this.xya.I8c?(K=Object(Za.a)(String,m.AFrameworkApplication.sessionStartInfoSettings.Host),m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Tk&&pa&&("Open From URL"===K||m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveToOneDriveSkipFilePicker",!1))?(ua.ULS.sendTraceTag(508852051,216,15,"User is signed in. We will initiate a save for this file to user's root OneDrive location"),this.Mbc.HEa("root",
"https://onedrive.live.com",null,this.zh)):(ua.ULS.sendTraceTag(6590559,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Tk?15:50,"User is signed in. We will show file picker."),this.nkl())):(ua.ULS.sendTraceTag(6590560,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Tk?15:50,"User is not signed in. We will show sign in dialog."),this.Y7o())}Y7o(){this.ZNk.create().SJa()}qq(){this.vJ().jR(ah.default)}nkl(){try{ua.ULS.sendTraceTag(6590561,
216,50,"Initializing OneDrive API");let K={["client_id"]:this.Ga.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.u4b||2===this.u4b)K={["client_id"]:this.Ga.appSettings.UploadToSkyDriveClientId};WL.init(K);ua.ULS.sendTraceTag(6590562,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Tk?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(O.a)(this,this.BE,"onSuccess"),
Object(O.a)(this,this.onFailure,"onFailure"))}catch(K){ua.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",K,K.stack),this.qq()}}BE(K){ua.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");K&&K.data&&K.data.folders&&this.Mbc.HEa(K.data.folders[0].id,K.data.folders[0].urls.viewInBrowser,null,this.zh)}onFailure(K){if(K&&K.error){if("user_canceled"===K.error.code){ua.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");
return}ua.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",K.error.code,K.error.message)}else ua.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.qq()}}Object(f.a)(zh,"SaveToCloudManager",null,[1038]);class Ql extends zh{constructor(K,pa,Ta,jb,bc,Ic,Uc){super(pa,Ta,jb,bc,Ic,Uc);this.tvk=K}BE(K){K&&K.data&&K.data.folders?(ua.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.tvk.create(this.zh).SJa(K.data.folders[0].id,
K.data.folders[0].name,K.data.folders[0].urls.viewInBrowser)):(ua.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.qq())}onFailure(K){K&&K.error&&"user_canceled"===K.error.code&&ua.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(K)}qq(){ua.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.qq()}}Object(f.a)(Ql,"SaveACopyManager",zh,[]);var al=d(194);class ji{constructor(K,pa,Ta,jb,bc){this.sRa=
this.kl=this.nEc=null;this.O1=!1;this.zh=this.H5a=null;this.wcf=K;this.s4a=pa;this.vJ=Ta;this.yj=jb;this.Vd=bc}Beb(){this.yj&&1===this.yj.state||(this.kl=this.s4a(),this.kl.message=CommonUIStrings.l_CommentProgressTooltip,this.kl.Gd=5,this.kl.Du=!1,this.kl.lM(CommonUIStrings.l_DefaultDialogTitle,null,null))}bsa(){this.kl&&(this.kl.close(),this.kl=null)}U8(){1!==m.AFrameworkApplication.ua.state&&this.vJ().jR(ah.default)}$Yb(){ua.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");fa.a.yn(this.sRa,
fa.a.wwa(3),void 0,"UploadToCloudManager.RedirectToFolder")}ZYb(K){var pa=null!==this.zh&&this.zh.hasOwnProperty("SaveEntryPoint")&&this.zh.SaveEntryPoint.toString()===Bj.Nxb;m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Tk&&pa&&(K+="&wdsvodm=true");let Ta=pa=!1;m.AFrameworkApplication.K&&(pa=m.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),Ta=m.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ua.ULS.sendTraceTag(6654163,216,m.AFrameworkApplication.ua&&
m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Tk?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",K,pa);if(pa&&Ta){ua.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const jb={};jb[Zg.a.cvc]="1";jb[Zg.a.documentUrl]=K;m.AFrameworkApplication.IR().execute(bc=>{bc.sendMessage(Bb.a.BNb,jb)})}else fa.a.yn(K,fa.a.wwa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}HEa(K,pa,Ta=null,jb=null){ua.ULS.sendTraceTag(7143886,
216,50,"Starting to upload file");this.Vd&&(this.H5a=this.Vd.Vf("DialogShown","SaveToOneDriveUploadTime"));this.Beb();this.sRa=pa;this.nEc=this.wcf.create(K,Ta,jb);this.zh=jb;this.Oka()}Oka(){ua.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.nEc.execute(Object(O.a)(this,this.f2n,"onSaveToCloudUploadFinished"),Object(O.a)(this,this.e2n,"onSaveToCloudUploadFailed"))}f2n(K){this.bsa();this.O1=!1;if(K&&K.data&&K.data.De){var pa;if(({Zu:pa}=Ya.d(K.data.De)).returnValue)if(K=pa,
K.StatusCode!==al.a.zz&&K.StatusCode!==al.a.jgc)ua.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.U8();else{ua.ULS.sendTraceTag(6590603,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Tk?15:50,"UploadToCloudManager upload success.");try{K.NewDocumentUrl&&""!==K.NewDocumentUrl?this.ZYb(K.NewDocumentUrl):this.$Yb()}catch(Ta){ua.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",
Ta.toString())}this.rhd()}else ua.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Hb.a.Isd(K.data.De)}),this.U8()}else ua.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.U8()}e2n(K){5!==K.data.status&&12!==K.data.status||this.O1?(ua.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",K.data.status),this.bsa(),this.U8(),this.rhd()):(ua.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),
this.O1=!0,this.Oka())}rhd(){this.H5a&&(this.H5a.stop(),this.H5a=null)}}Object(f.a)(ji,"UploadToCloudManager",null,[1026]);class kh extends ji{constructor(K,pa,Ta,jb,bc,Ic){super(pa,Ta,jb,bc,Ic);this.ga=K}K0f(){return!!this.zh&&!!this.zh.SaveEntryPoint&&"VersionHistory"===this.zh.SaveEntryPoint.toString()}U8(){ua.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.K0f()&&this.ga.Pb(v.a.dve,2,{["FailureReason"]:"Unknown"});super.U8()}$Yb(){ua.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");
this.K0f()&&this.ga.Ob(v.a.Fld,2);super.$Yb()}ZYb(K){ua.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",K);this.K0f()&&this.ga.Ob(v.a.Fld,2);super.ZYb(K)}Oka(){this.zh&&"true"===this.zh.SkipSaveToHost?super.Oka():32!==this.ga.Ob(v.a.i_b,1)?(ua.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.Oka()):this.ga.Pb(v.a.i_b,2,[()=>{ua.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");
ji.prototype.Oka.call(this)},()=>{ua.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.U8()}])}}Object(f.a)(kh,"SaveACopyUploadToCloudManager",ji,[]);var bh=d(815),hj=d(1294);class uj{constructor(){this.W=null;this.pz=()=>{m.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&this.W.resolve("Common.App.SaveACopy.SaveACopyActor").Wb()}}get name(){return"Common.App.SaveACopy"}init(){m.AFrameworkApplication.K.Rn(this.pz)}dispose(){}wc(K){this.W=
K;this.W.register(kh,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Rd(()=>new kh(m.AFrameworkApplication.va,K.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new hj.a).create(),()=>new Uj(m.AFrameworkApplication.va),m.AFrameworkApplication.ua,m.AFrameworkApplication.ua.hs)).ha();this.W.register(Pi,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Rd(()=>new Pi(m.AFrameworkApplication.va,m.AFrameworkApplication.ua.Ib,K.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ha();
this.W.register(Cl,"Common.App.SaveACopy.SaveACopyActor").Rd(()=>new Cl(K.resolve("Common.App.SaveACopy.SaveACopyManager"),K.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),m.AFrameworkApplication.K,m.AFrameworkApplication.ua.hs)).ha();this.W.register(Ql,"Common.App.SaveACopy.SaveACopyManager").Rd(()=>new Ql(K.resolve("Common.App.SaveACopy.FileNameDialogFactory"),K.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),bh.a.instance,K.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),
m.AFrameworkApplication.K,m.AFrameworkApplication.Paa,()=>new Uj(m.AFrameworkApplication.va))).ha()}static main(){H.a.instance.Jc(new uj)}}Object(f.a)(uj,"PackageManager",null,[0,1]);var wg=d(50);class Ni extends hg.StandardDialog{constructor(K,pa){super();this.N9b=!1;this.yQ=null;this.Lvg=Ta=>{1===Ta?(ua.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.yQ?this.ga.Pb(v.a.Pmd,2,[this.yQ,this.N9b]):this.ga.Ob(v.a.Pmd,2)):ua.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")};
this.ga=K;this.pHc=pa;this.BOa=!1}jR(K,pa,Ta){this.yQ=pa;this.N9b=Ta;ua.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",K,Ta);K=this.Jof(K);0===K?(this.Gd=6,this.Pe(0,CommonUIStrings.l_DialogClose)):(this.Gd=0,this.Pe(1,CommonUIStrings.l_DialogClose));0===K&&ua.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Gy(wg.a.sKo,this.Apm(K),this.zpm(K,pa),this.Lvg,!0)}Jof(K){return 0>K||6<K?(ua.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",
K),0):K}zpm(K,pa){K=this.Jof(K);return this.pHc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,pa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][K]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,pa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][K]}Apm(K){K=this.Jof(K);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][K]}}Object(f.a)(Ni,"ErrorRetryDialog",hg.StandardDialog,[1052]);class Md{constructor(K,pa){this.Ga=
K;this.ga=pa;this.pHc=this.Ga.$("SaveToHostWithExtraCharsInFileName")}create(){return new Ni(this.ga,this.pHc)}}Object(f.a)(Md,"ErrorRetryDialogFactory",null,[1035]);class nf extends a.a{constructor(K,pa,Ta,jb,bc,Ic,Uc=null){super();this.Y9=null;this.ga=pa;this.Gwa=jb;this.I5a=Ic;this.Ga=K;this.vJ=bc;this.yj=Ta;this.pHc=this.Ga.$("SaveToHostWithExtraCharsInFileName");this.zh=Uc;this.Pe(1,CommonUIStrings.l_SaveButtonLabel)}get ua(){return this.yj}Egi(K,pa){this.Bva(1,!!K&&K!==pa);this.Y9=document.getElementById(nf.Wni);
T.a.addHandler(this.Y9,"change",Object(O.a)(this,this.Wme,"onFileNameChange"));T.a.addHandler(this.Y9,"input",Object(O.a)(this,this.Wme,"onFileNameChange"));this.Y9.focus()}Vni(K){return this.pHc?(new RegExp("["+this.Kli('\\/:*?"<>|')+"]")).test(K):(new RegExp("["+this.Kli('\\/:*?"<>|#{}%~&')+"]")).test(K)}Kli(K){return K.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}ORf(){const K=Ia.a.BL(m.AFrameworkApplication.It.FA);this.Bva(1,!!this.Y9&&""!==this.Y9.value&&this.Y9.value!==K)}Wme(){this.Y9&&
window.setTimeout(()=>{this.ORf()},0)}i3d(K,pa){if(1!==K)ua.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{K=pa[nf.Wni];pa=nf.Dqj in pa?pa[nf.Dqj]:!1;ua.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Ia.a.Qzj(K),pa);const Ta=Ia.a.fla(m.AFrameworkApplication.fileName);(K=K?K.trim():null)&&""!==K&&""!==Ta||1===this.ua.state?this.Vni(K)?this.vJ.create().jR(1,K,pa):this.I5a.HEa(K+
Ta,pa,this.zh):this.vJ.create().jR(2,K,pa)}}dispose(){this.Y9&&(T.a.removeHandler(this.Y9,"change",Object(O.a)(this,this.Wme,"onFileNameChange")),T.a.removeHandler(this.Y9,"input",Object(O.a)(this,this.Wme,"onFileNameChange")),this.Y9=null);super.dispose()}}nf.Wni="txtFileName";nf.Dqj="chkOverwrite";Object(f.a)(nf,"FileNameDialogBase",a.a,[]);class bn{static get kh(){return a.a.az(bn.Mn,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}bn.Mn="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(f.a)(bn,"FileNameDialogHtml",null,[]);class Wi extends nf{constructor(K,pa,Ta,jb,bc,Ic){super(K,pa,Ta,jb,bc,Ic);this.kh=bn.kh;this.Qg="FileNameDialog-SaveAsToHost"}SJa(K,pa){const Ta=Ia.a.BL(m.AFrameworkApplication.It.FA);pa={["txtFileName"]:K||Ta,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:pa};this.pi(CommonUIStrings.L_SaveAs,Object(O.a)(this,this.i3d,"fileNameDialogHandler"),pa);this.Egi(K,Ta)}}Object(f.a)(Wi,"FileNameDialog",nf,[1051]);class ee{constructor(K,pa,
Ta,jb,bc,Ic){this.ga=pa;this.Ga=K;this.Gwa=jb;this.I5a=Ic;this.vJ=bc;this.yj=Ta}create(){return new Wi(this.Ga,this.ga,this.yj,this.Gwa,this.vJ,this.I5a)}}Object(f.a)(ee,"FileNameDialogFactory",null,[1034]);class qd{constructor(K,pa,Ta){this.dJj=(jb,bc,Ic,Uc,kd)=>bc.contextId!==y.a.frame||jb!==v.a.Pmd?2:this.Ga.$("SaveAsToHostBrsIsEnabled")?1===Ic?tg.SessionStatusManager.instance.Gk||m.AFrameworkApplication.Lta?8:32:2===Ic?(ua.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),
jb=this.KSe.create(),kd&&Object.getType(kd)===Array&&2===kd.length?jb.SJa(kd[0],!!kd[1]):jb.SJa(null,!1),32):8:8;this.I5a=Ta;this.KSe=pa;this.Ga=K}Wb(){2===m.AFrameworkApplication.ua.Ib.Tk?m.AFrameworkApplication.va.fb(v.a.Pmd,y.a.frame,this.dJj,4):m.AFrameworkApplication.va.ra(v.a.Pmd,y.a.frame,this.dJj)}}Object(f.a)(qd,"SaveAsToHostActor",null,[]);class Il{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd){this.kl=null;this.N9b=this.O1=!1;this.H5a=this.zh=this.yQ=null;this.Ga=pa;this.Jqa=this.Ga.appSettings.SaveAsToHostWebServiceBase;
this.Snh=jb;this.s4a=bc;this.Af=Ta;this.vJ=Ic;this.Vd=kd;this.yj=Uc;this.ga=K;this.V2a=pa.kb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Beb(){1!==this.yj.state&&(this.kl=this.s4a(),this.kl.message=CommonUIStrings.l_CommentProgressTooltip,this.kl.Gd=5,this.kl.Du=!1,this.kl.lM(CommonUIStrings.l_DefaultDialogTitle,null,null))}U8(K=0){1!==this.yj.state&&this.vJ.create().jR(K,Ia.a.BL(this.yQ),this.N9b)}$Yb(){const K=this.Ga.appSettings.BreadcrumbFolderUrl;ua.ULS.sendTraceTag(8194016,216,50,
"Redirecting to OneDrive for business Folder.");fa.a.yn(K,fa.a.wwa(3),void 0,"UploadToHostManager.RedirectToFolder")}ZYb(K){let pa=!1,Ta=!1;this.Ga&&(pa=this.Ga.$("SaveACopyIsEnabledForUiHost"),Ta=this.Ga.$("UiHostSupportsDocRebootFeatures"));ua.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",K,pa,Ta);if(pa&&Ta){ua.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const jb=
{};jb[Zg.a.cvc]="1";jb[Zg.a.documentUrl]=K;jb[Zg.a.reason]=Nb.a.Pwg;m.AFrameworkApplication.IR().execute(bc=>{bc.sendMessage(Bb.a.BNb,jb)})}else pa&&!Ta&&m.AFrameworkApplication.uP?fa.a.yn(K,fa.a.wwa(4),void 0,"UploadToHostManager.RedirectToEditUrl"):fa.a.yn(K,fa.a.wwa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}HEa(K,pa,Ta=null){ua.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.Snh&&!this.Snh()&&this.Af&&(this.Vd&&(this.H5a=this.Vd.Vf("DialogShown","SaveAsToHostUploadTime")),
this.Beb(),this.N9b=pa,this.yQ=K,(this.zh=Ta)&&"true"===this.zh.SkipSaveToHost?this.m2d():this.Oka())}Oka(){32!==this.ga.Ob(v.a.i_b,1)?(ua.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.m2d()):this.ga.Pb(v.a.i_b,2,[()=>{ua.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.m2d()},(K,pa)=>{ua.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.U8(pa)}])}f4n(K){this.bsa();this.O1=!1;if(K&&K.data&&K.data.De)if(({Zu:pa}=Ya.d(K.data.De)).returnValue)if(K=pa,K.StatusCode!==al.a.zz&&K.StatusCode!==al.a.jgc){ua.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var pa={};pa.FailureReason=K.StatusCode.toString();pa.ExtraInfo=K.ExtraInfo;this.c_a(pa);this.U8(parseInt(K.ExtraInfo))}else{ua.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.rug();try{K.NewDocumentUrl&&""!==K.NewDocumentUrl?
this.ZYb(K.NewDocumentUrl):this.$Yb()}catch(Ta){ua.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",Ta.toString())}this.rhd()}else ua.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Hb.a.Isd(K.data.De)}),this.c_a({["FailureReason"]:"Failed to deserialize response"}),this.U8();else ua.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),this.c_a({["FailureReason"]:"null response"}),this.U8()}e4n(K){5!==K.data.status&&
12!==K.data.status||this.O1?(ua.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:K.data.status,["HttpStatus"]:K.data.He}),this.c_a({["FailureReason"]:K.data.He.toString()}),this.bsa(),this.U8(),this.rhd()):(ua.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.O1=!0,this.zh&&"true"===this.zh.SkipSaveToHost?this.m2d():this.Oka())}bsa(){this.kl&&(this.kl.close(),this.kl=null)}rhd(){this.H5a&&(this.H5a.stop(),this.H5a=
null)}rug(){this.zh&&"VersionHistory"===this.zh.SaveEntryPoint&&this.ga.Ob(v.a.Fld,2)}c_a(K){this.zh&&"VersionHistory"===this.zh.SaveEntryPoint&&this.ga.Pb(v.a.dve,2,K)}m2d(){let K=this.Jqa+this.V2a;K=Wb.a.lp(K,"qs",Ia.a.ej(m.AFrameworkApplication.jm));K=Wb.a.lp(K,"n",Ia.a.ej((new Date).getTime().toString()));K=Wb.a.lp(K,"ov",Ia.a.ej(this.N9b.toString()));K=Wb.a.lp(K,"fn",Ia.a.ej(this.yQ));this.zh&&this.zh.FileDownloadUrl&&(K=Wb.a.lp(K,"furl",Ia.a.ej(this.zh.FileDownloadUrl)));this.Af.Ij(K,1,"",{"Content-Type":"application/json; charset=utf-8"},
!1,2,Object(O.a)(this,this.f4n,"onUploadFinished"),Object(O.a)(this,this.e4n,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(f.a)(Il,"UploadToHostManager",null,[1033]);class Vg{constructor(){this.W=null;this.pz=()=>{m.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Wb()}}get name(){return"Common.App.SaveAsToHost"}init(){m.AFrameworkApplication.K.Rn(this.pz)}wc(K){this.W=K;this.W.register(Md,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Rd(()=>
new Md(m.AFrameworkApplication.K,m.AFrameworkApplication.va)).ha();this.W.register(Il,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Rd(()=>new Il(m.AFrameworkApplication.va,m.AFrameworkApplication.K,m.AFrameworkApplication.Be,()=>m.AFrameworkApplication.ol,()=>(new hj.a).create(),K.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),m.AFrameworkApplication.ua,m.AFrameworkApplication.ua.hs)).ha();this.W.register(ee,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Rd(()=>
new ee(m.AFrameworkApplication.K,m.AFrameworkApplication.va,m.AFrameworkApplication.ua,m.AFrameworkApplication.ua.Ib,K.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),K.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha();this.W.register(qd,"Common.App.SaveAsToHost.SaveAsToHostActor").Rd(()=>new qd(m.AFrameworkApplication.K,K.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),K.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha()}dispose(){}static main(){H.a.instance.Jc(new Vg)}}
Object(f.a)(Vg,"SaveAsToHostPackage",null,[0,1]);class oi extends hg.StandardDialog{constructor(){super();this.Gd=0;this.Pe(1,CommonUIStrings.l_DialogClose)}jR(K){this.Gy(K,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(f.a)(oi,"ErrorDialog",hg.StandardDialog,[1030]);var Ah=d(205);class ag extends hg.StandardDialog{constructor(K,pa,Ta){super();this.d9m=jb=>{0===jb?(ua.ULS.sendTraceTag(6590598,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&
1===m.AFrameworkApplication.ua.Ib.Tk?15:50,"User dismissed SignIn Dialog."),this.hide()):this.qqe()};this.toj=()=>{this.ema&&this.hide();ua.ULS.sendTraceTag(7143885,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Tk?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.Ob(v.a.Nxb,2)};this.ga=K;this.xya=pa;this.Gwa=Ta;this.Lda=!1;this.Gd=1;this.uY(1);this.Pe(1,CommonUIStrings.l_SignIn);this.Pe(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}SJa(){this.xya.tPh(this.toj);
this.Ix(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,this.d9m)}Vnl(){let K="2";if(this.Gwa)switch(this.Gwa.Tk){case 3:K="0";break;case 2:K="3";break;case 1:K="1"}return K}hide(){this.xya.kAo(this.toj);super.hide()}qqe(){var K=m.AFrameworkApplication.K.$("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";K=new Ah.QueryStringBuilder(K);K.ze("prompt","1");K.ze("cbcxt",this.Vnl());m.AFrameworkApplication.Aja(K);fa.a.yn(K.toString(),"LoginWindow",
void 0,"SignInDialog")}}Object(f.a)(ag,"SignInDialog",hg.StandardDialog,[1054]);class Cg{constructor(K,pa,Ta){this.ga=K;this.xya=pa;this.Gwa=Ta}create(){return new ag(this.ga,this.xya,this.Gwa)}}Object(f.a)(Cg,"SignInDialogFactory",null,[1039]);class Sg{constructor(K,pa,Ta,jb,bc,Ic,Uc){this.Jqa=K;this.yQ=pa;this.$6b=Ta;this.TBd=jb;this.L5e=bc;this.V2a=Ic;this.zh=Uc}execute(K,pa){if(!m.AFrameworkApplication.ol&&m.AFrameworkApplication.Be){var Ta=this.Jqa+this.V2a;Ta=Wb.a.lp(Ta,"fo",Ia.a.ej(this.TBd));
Ta=Wb.a.lp(Ta,"fn",Ia.a.ej(this.yQ));Ta=Wb.a.lp(Ta,"qs",Ia.a.ej(this.L5e));Ta=Wb.a.lp(Ta,"n",Ia.a.ej((new Date).getTime().toString()));this.zh&&this.zh.FileDownloadUrl&&(Ta=Wb.a.lp(Ta,"furl",Ia.a.ej(this.zh.FileDownloadUrl)));this.$6b&&(Ta=Wb.a.lp(Ta,"fnn",Ia.a.ej(this.$6b)));m.AFrameworkApplication.Be.Ij(Ta,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,K,pa,null)}}}Object(f.a)(Sg,"SkyDriveUploadCaller",null,[1053]);class ui{constructor(K){this.Ga=K;this.BJb=K.appSettings.SkyDriveUploadWebServiceBase;
this.yQ=K.appSettings.FileName;this.V2a=K.kb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(K,pa,Ta){return new Sg(this.BJb,this.yQ,pa,K,m.AFrameworkApplication.jm,this.V2a,Ta)}}Object(f.a)(ui,"SkydriveUploadCallerFactory",null,[1036]);class ck{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){m.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Wb()}dispose(){}wc(K){this.W=
K;this.W.register(Cg,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Rd(()=>new Cg(m.AFrameworkApplication.va,bh.a.instance,m.AFrameworkApplication.ua.Ib)).ha();this.W.register(ui,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Rd(()=>new ui(m.AFrameworkApplication.K)).ha();this.W.register(Vj,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Rd(()=>new Vj(K.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),
K.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),m.AFrameworkApplication.K,m.AFrameworkApplication.ua.hs)).ha();this.W.register(ji,"Common.App.SaveToCloudStorage.UploadToCloudManager").Rd(()=>new ji(K.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new hj.a).create(),()=>new oi,m.AFrameworkApplication.ua,m.AFrameworkApplication.ua.hs)).ha();this.W.register(zh,"Common.App.SaveToCloudStorage.SaveToCloudManager").Rd(()=>new zh(K.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),
bh.a.instance,K.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),m.AFrameworkApplication.K,m.AFrameworkApplication.Paa,()=>new oi)).ha()}static main(){H.a.instance.Jc(new ck)}}Object(f.a)(ck,"PackageManager",null,[0,1]);class Zf extends hg.StandardDialog{constructor(){super();this.Gd=0;this.Pe(1,CommonUIStrings.l_DialogClose)}jR(K,pa){this.bhi(K,pa,wg.a.uKo)}bhi(K,pa,Ta){ua.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Ta);this.Gy(Ta,K,pa,null)}Cyf(K,
pa){ua.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Gy(wg.a.wKo,K,pa,null,!0)}}Object(f.a)(Zf,"ErrorDialog",hg.StandardDialog,[1090]);class ij{static get kh(){return a.a.az(ij.Mn,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}ij.Mn="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(f.a)(ij,"FileNameDialogHtml",null,[]);var mj=d(91);class Jl extends nf{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd){super(K,pa,Ta,jb,bc,Ic,kd);this.Uib=this.T7e=this.tT=null;this.bil=CommonUIStrings.l_SaveToAnotherFolder;this.kh=ij.kh;this.Qg="FileNameDialog-SaveToSharePoint";this.hPc=Uc;this.GHk=kd}SJa(K){const pa=Ia.a.BL(m.AFrameworkApplication.It.FA),Ta=m.AFrameworkApplication.breadcrumbFolderName,jb=m.AFrameworkApplication.breadcrumbBrandName,bc={["txtFileName"]:K||pa};let Ic=CommonUIStrings.L_SaveAs;
2===m.AFrameworkApplication.ua.Ib.Tk&&(Ic=CommonUIStrings.L_SaveACopy);this.pi(Ic,Object(O.a)(this,this.i3d,"fileNameDialogHandler"),bc);this.Egi(K,pa);this.yxf.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");m.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.tT=document.getElementById("anotherFolder"),K=document.getElementById("folderLocation"),this.T7e=Yg.a.zSh(K,this.tT,"anotherFolderDescribedBy"),this.tT.className=
"WACButton WACDialogButtonNormal",K=!1,Ta&&Ta.length?(this.aNh(this.tT,this.T7e,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,jb,Ta)),K=this.hVk(jb,Ta)):this.aNh(this.tT,this.T7e,CommonUIStrings.l_CurrentOnlineFolder),this.dXk(this.tT),this.jVk(this.tT),K?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.tT,"SaveToAnotherLocationTwo"),ua.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.tT,
"SaveToAnotherLocationOne"),T.a.addHandler(this.tT,P.a.click,Object(O.a)(this,this.ehg,"onSaveToAnotherLocationClick")),T.a.addHandler(this.tT,P.a.Ti,Object(O.a)(this,this.Ynj,"onSaveToAnotherLocationKeyDown")))}hVk(K,pa){let Ta;Ta=!1;const jb=document.getElementById("currentLocation");jb.innerText="";const bc=this.ICi(jb,K),Ic=this.ICi(jb,pa);let Uc=255,kd=255;255<bc+Ic&&(Uc=Math.max(238,408-bc),kd=Math.max(170,408-Ic),Ta=!0);this.qZk(jb,K,kd,pa,Uc);return Ta}ICi(K,pa){const Ta=document.createElement("div");
Ta.innerText=pa;Ta.style.visibility="hidden";K.appendChild(Ta);pa=Ta.clientWidth;K.removeChild(Ta);return pa}qZk(K,pa,Ta,jb,bc){pa&&(this.$Mh(K,pa,Ta),this.hZk(K));jb&&this.$Mh(K,jb,bc)}$Mh(K,pa,Ta){const jb=document.createElement("div");jb.innerText=pa;jb.title=pa;jb.className="SaveToAnotherFolderBreadcrumb";jb.style.maxWidth=Ta.toString()+"px";K.appendChild(jb)}hZk(K){const pa=document.createElement("span");pa.id="FolderSeparator";const Ta=document.createElementNS("http://www.w3.org/2000/svg","svg");
Ta.setAttribute("class","SeparatorCaret");const jb=document.createElementNS("http://www.w3.org/2000/svg","polygon");jb.setAttribute("points","1 4 1 11 5 7.5");Ta.appendChild(jb);pa.appendChild(Ta);K.appendChild(pa)}aNh(K,pa,Ta){Ta=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Ta);pa&&(pa.innerText=Ta);K.tabIndex=0;K.setAttribute(Yg.a.Ph,Yg.a.eaa)}jVk(K){const pa=document.createElement("span");pa.id="anotherFolderText";pa.innerText=this.bil;pa.className="AnotherFolderTextSpan";
K.appendChild(pa)}dXk(K){const pa=document.createElement("span");pa.className="cui-img-cont-float cui-img-16by16 ";this.Uib=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Uib.setAttribute("class","FolderIconSVG");const Ta=document.createElementNS("http://www.w3.org/2000/svg","path");Ta.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.Uib.appendChild(Ta);pa.appendChild(this.Uib);K.appendChild(pa)}Ynj(K){!K||
K.keyCode!==mj.a.Mu&&K.keyCode!==mj.a.oud||this.ehg(K)}ehg(){if(this.Y9){const K=Ia.a.fla(m.AFrameworkApplication.fileName);let pa=this.Y9.value;this.hide();pa&&""!==pa&&""!==K||1===this.ua.state?(""!==K&&(pa+=K),this.Vni(pa)?this.vJ.create().jR(1,pa,!1):this.hPc.start(pa,this.GHk)):this.vJ.create().jR(2,pa,!1)}}znl(K){this.tT&&this.Uib&&(K?(this.tT.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.tT,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Uib,"DisabledFolderIconSVG")):(this.tT.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.tT,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Uib,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.tT,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Uib,"DisabledFolderIconSVG"))))}ORf(){super.ORf();this.znl(!!this.Y9&&""!==this.Y9.value)}dispose(){this.tT&&(T.a.removeHandler(this.tT,P.a.click,Object(O.a)(this,this.ehg,"onSaveToAnotherLocationClick")),T.a.removeHandler(this.tT,P.a.Ti,Object(O.a)(this,this.Ynj,
"onSaveToAnotherLocationKeyDown")),this.tT=null);super.dispose()}}Object(f.a)(Jl,"FileNameDialog",nf,[1122]);var Xi=d(543),Sh=d(298),Vk=d(1630),nj=d(1777);class dk{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(f.a)(dk,"SaveAsDialogInput",null,[]);class mm{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(f.a)(mm,"SaveLocation",null,[]);var Ai=d(105);class nm{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd,pd){this.O_e=
null;this.yQ="";this.ypm=()=>{const Fd=new yb.a;Fd.add(this.som());const le=this.NKm();le&&Fd.addRange(le);return Object.assign(new dk,{enableMoreLocations:!m.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.yQ,extension:Ia.a.fla(this.mO.FA),saveLocations:Fd.toArray(),scenario:"SaveToSharePoint"})};this.hPc=K;this.vJ=pa;this.zh=pd;this.I5a=Ta;this.yj=bc;this.mO=jb;this.lJb=Uc;this.sac=kd;Ic&&(this.O_e=new Ec.a(()=>new Vk.a(Ic.value,null)))}som(){const K=new Xi.a(Sh.a.th());
K.Z("type","currentHost");return Object.assign(new mm,{folderName:this.mO.breadcrumbFolderName,friendlyPath:this.mO.breadcrumbBrandName,properties:K})}grn(K){return!!K&&"ClassicMru"===K.type&&!!K.service_info&&!!K.service_info.service_id&&-1!==K.service_info.service_id.indexOf("SHAREPOINT")}NKm(){if(!this.O_e||!this.lJb)return null;var K=this.O_e.value.HR("SaveAsToSharePointDialog",!1);if(!K||3!==K.state||!K.Cfj)return null;K=K.Cfj;const pa=new yb.a;let Ta=0,jb=0;for(var bc=0;bc<K.length;bc++){var Ic=
K[bc];if(!this.grn(Ic))continue;Ta++;if(!Ic.sharepoint_info)continue;const Uc=Ic.url,kd=Ic.sharepoint_info.site_url,pd=Ic.title;Ic=nj.b(Ic,m.AFrameworkApplication.isRtl);if(!(Uc&&kd&&pd&&Ic))continue;jb++;const Fd=new Xi.a(Sh.a.th());Fd.Z("type","SharePoint");Fd.Z("siteUrl",kd);Fd.Z("folderUrl",Uc);jb++;pa.add(Object.assign(new mm,{folderName:pd,friendlyPath:Ic,properties:Fd}))}bc=new Map;bc.set("NumPlaces",K.length.toString());bc.set("NumSharepointPlaces",Ta.toString());bc.set("placesWithMetadata",
jb.toString());sa.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",bc);0<Ta&&(jb?.5>1*jb/Ta&&sa.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):sa.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return pa}oJf(){const K={};K.inputPropsCallback=this.ypm;return K}SJa(K){this.yQ=K;this.yQ||(this.yQ=String.format(CommonUIStrings.l_SaveACopy_Filename,Ia.a.BL(this.mO.FA)));
K={["id"]:"SaveAsDialog",["bodyControls"]:this.oJf()};let pa=CommonUIStrings.L_SaveAs;2===this.yj.Ib.Tk&&(pa=CommonUIStrings.L_SaveACopy);const Ta=new a.a(!1,!1,!0);Ta.Gd=1;Ta.Qg="SaveAsDialog";Ta.Pe(1,CommonUIStrings.l_SaveButtonLabel);Ta.pi(pa,Object(O.a)(this,this.qKo,"saveAsDialogHandler"),K)}h7o(K,pa){K&&""!==K&&""!==pa||1===this.yj.state?this.frn()?this.JAn(K,pa):(""!==pa&&(K+=pa),this.hPc.start(K,this.zh)):(ua.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),
this.vJ.create().jR(2,K,!1))}JAn(K,pa){sa.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const Ta=this.sac.Gtf(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.sac.P6d(Ta).then(jb=>{if(jb&&0<jb.length){const bc=jb[0][Zg.a.Kao];jb=jb[0][Zg.a.Lao];if(""!==bc&&""!==jb)this.lJb.HEa(jb,K+pa,bc,this.zh),sa.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.vJ.create().jR(0,K,!1);const Ic=bj.a.KG();Ic&&(Ic.set("SiteUrlAvailable",
""===bc?"false":"true"),Ic.set("FolderUrlAvailable",""===jb?"false":"true"));sa.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Ai.a,{extendedProperties:Ic}))}}else this.vJ.create().jR(0,K,!1),sa.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(jb=>{"Canceled"===jb?((jb=bj.a.KG())&&jb.set("IsCanceled","true"),sa.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Ai.a,{extendedProperties:jb}))):
sa.Health.instance.recordKpiFailure("SaveACopySFP",jb,!1,!1,null)})}frn(){return this.sac?this.sac.T0f():(ua.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}qKo(K,pa){if(pa&&1===K){K=pa.fileName;var Ta=Ia.a.fla(this.mO.FA);pa.moreLocationsSelected&&this.h7o(K,Ta);if(pa.locationCallback){var jb=pa.locationCallback();jb?jb.properties&&"currentHost"===jb.properties.J("type")?this.I5a.HEa(K+Ta,!1,this.zh):jb.properties&&"SharePoint"===jb.properties.J("type")?(pa=jb.properties.J("siteUrl"),
jb=jb.properties.J("folderUrl"),this.lJb.HEa(jb,K+Ta,pa,this.zh)):ua.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):ua.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else ua.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(f.a)(nm,"ReactSaveAsDialog",null,[1122]);class rm{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd=null,pd=null,Fd=null){this.ga=pa;this.Ga=K;this.Gwa=jb;this.I5a=Ic;this.vJ=bc;this.yj=Ta;this.DDh=Uc;this.kDk=kd;this.lJb=pd;this.sac=
Fd}create(K){return this.yj&&this.yj.Ib.cH?new nm(this.DDh,this.vJ,this.I5a,m.AFrameworkApplication.It,this.yj,this.kDk,this.lJb,this.sac,K):new Jl(this.Ga,this.ga,this.yj,this.Gwa,this.vJ,this.I5a,this.DDh,K)}}Object(f.a)(rm,"FileNameDialogFactory",null,[1089]);class qi{constructor(K,pa,Ta,jb){this.hx=this.SMc=null;this.gQb=bc=>{this.hx||3!==bc.state||(this.hx=bc)};this.wDb=K;this.yj=Ta;this.QIk=jb;this.S2a=new Ec.a(()=>new Vk.a(pa.value,this.gQb))}get tpj(){this.SMc||(this.S2a.value.HR("Save As",
!0),this.hx&&this.hx.Wga&&this.hx.Wga.length&&(this.SMc=this.DCm(this.hx.Wga)));return this.SMc}start(K){if(!this.tpj)if(m.AFrameworkApplication.breadcrumbFolderUrl&&m.AFrameworkApplication.breadcrumbFolderUrl.length)this.SMc=m.AFrameworkApplication.breadcrumbFolderUrl;else return ua.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.hx),!1;const pa=this.QIk();pa.v7o();const Ta=
pa.xFm();if(!Ta)return ua.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.wDb.start((jb,bc)=>{pa.hide();K(jb,bc)},()=>{this.onCancel(pa)},Ta,this.SMc);return!0}onCancel(K){K.hide();ua.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}DCm(K){K=K.toLowerCase();K.endsWith("/")||(K+="/");const pa=K.indexOf("/documents/");return-1!==pa?K.substring(0,pa+1)+"_layouts/15/onedrive.aspx":""}}Object(f.a)(qi,"OneDriveFilePickerHelper",null,
[1088]);class Yi extends a.a{constructor(){super()}v7o(){this.OFc="FilePickerDialog";this.kh="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Qg="PickerDialog-MsoSp";this.showDialog("",null)}xFm(){return document.getElementById("FilePickerDiv")}WN(){}$ga(){}}Object(f.a)(Yi,"PickerDialog",a.a,[1087]);class Zl{constructor(K,pa,Ta,jb,bc,Ic,Uc){this.Ga=K;this.KSe=Ta;this.ga=pa;this.hPc=jb;this.wDb=bc;this.RMc=Ic;this.bqk=Uc}Wb(){const K=this.wDb.Gkc();K?nb.a.Ita||this.Ga.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.fb(v.a.owc,y.a.frame,Object(O.a)(this,this.zJj,"saveToSharePointActionDispatcher"),64):(K.jbb.continueWith(pa=>{pa.ij&&this.wDb.Vfg(pa)}),this.FUd()):ua.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}FUd(){Fc.a.Rte(Object(O.a)(this,this.zJj,"saveToSharePointActionDispatcher"));Fc.a.y_c([new jk.a(v.a.owc,y.a.frame,0)],this.wDb.Gkc())}get Epc(){return this.Ga.$("SaveToAnotherFolderBrsIsEnabled")}get T_h(){return this.Ga.$("UserCanWriteRelative")}zJj(K,
pa,Ta,jb,bc){return pa.contextId!==y.a.frame||K!==v.a.owc?2:this.Epc&&(this.RMc.tpj||this.T_h)?1===Ta?tg.SessionStatusManager.instance.Gk||m.AFrameworkApplication.Lta?8:this.bqk()?32:8:2===Ta?(ua.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(bc&&bc.SaveEntryPoint&&"VersionHistory"===bc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.T_h?(ua.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.KSe.create(bc).SJa(null)):(ua.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.hPc.start(null,bc)),32):8:8}}Object(f.a)(Zl,"SaveToSharePointActor",null,[]);class Qi{constructor(K,pa,Ta,jb){this.zh=this.Xvh=null;this.lJb=K;this.vJ=pa;this.RMc=Ta;this.yj=jb}start(K,pa){ua.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Xvh=K;this.zh=pa;this.RMc.start((Ta,jb)=>{this.processResponse(Ta,jb)})||this.UDg()}processResponse(K,pa){if(K)this.BE(pa);else this.onFailure(pa)}UDg(){1!==
this.yj.state&&this.vJ().Cyf(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}BE(K){ua.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(K&&K.data&&K.data.value&&K.data.value.length&&K.data.value[0].sharePoint){const pa=K.data.value[0].sharePoint.url;K=K.data.value[0].sharePoint.listUrl;let Ta=null;if(pa&&(Ta=K?this.$Km(K):this.ZKm(pa))){this.lJb.HEa(pa,this.Xvh,Ta,this.zh);return}ua.ULS.sendTraceTag(25180164,
216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!pa,!Ta)}ua.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.UDg()}ZKm(K){K.endsWith("/")||(K+="/");let pa=0;for(let Ta=0;Ta<K.length;Ta++)if("/"===K.charAt(Ta)&&5===++pa)return K.substr(0,Ta);return null}$Km(K){K.endsWith("/")&&(K=K.substring(0,K.length-1));const pa=K.lastIndexOf("/");return-1!==pa?K.substring(0,pa):null}onFailure(K){ua.ULS.sendTraceTag(23881888,216,
10,"Picker failure Callback called.");K&&K.error?ua.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",K.error.errorCode,K.error.message):ua.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.UDg()}}Object(f.a)(Qi,"SaveToSharePointManager",null,[1084]);class Oh{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd){this.Jqa=K;this.yQ=pa;this.$6b=jb;this.L5e=Ic;this.sRa=Ta;this.lOk=bc;this.V2a=Uc;this.zh=kd}execute(K,pa){if(!m.AFrameworkApplication.ol&&
m.AFrameworkApplication.Be){var Ta=this.Jqa+this.V2a;Ta=Wb.a.lp(Ta,"fu",Ia.a.ej(this.sRa));Ta=Wb.a.lp(Ta,"su",Ia.a.ej(this.lOk));Ta=Wb.a.lp(Ta,"fn",Ia.a.ej(this.yQ));Ta=Wb.a.lp(Ta,"n",Ia.a.ej((new Date).getTime().toString()));this.zh&&this.zh.FileDownloadUrl&&(Ta=Wb.a.lp(Ta,"furl",Ia.a.ej(this.zh.FileDownloadUrl)));Ta=Ta+"&"+this.L5e;this.$6b&&this.$6b.length?Ta=Wb.a.lp(Ta,"fnn",Ia.a.ej(this.$6b)):ua.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");ua.ULS.sendTraceTag(23881920,216,
50,"Trying send SharePointSaveAsHandler.ashx request.");m.AFrameworkApplication.Be.Ij(Ta,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,K,pa,null,void 0,void 0,void 0,void 0,"9")}}}Object(f.a)(Oh,"SharePointSaveAsCaller",null,[1121]);class hb{constructor(K){this.BJb=K.appSettings.SaveAsToHostWebServiceBase;this.yQ=K.appSettings.FileName;this.V2a=K.kb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(K,pa,Ta,jb){return new Oh(this.BJb,this.yQ,K,pa,Ta,m.AFrameworkApplication.jm,
this.V2a,jb)}}Object(f.a)(hb,"SharePointUploadCallerFactory",null,[1085]);var wc=d(1429);class cd{constructor(K,pa,Ta,jb,bc){this.kl=this.nEc=null;this.KKe=!1;this.N7e=this.sRa=null;this.wcf=pa;this.s4a=Ta;this.vJ=jb;this.yj=bc;this.ga=K}HEa(K,pa,Ta,jb){this.KKe=!1;ua.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.Beb();this.sRa=K;jb&&jb.SaveEntryPoint&&(this.N7e=jb.SaveEntryPoint);this.nEc=this.wcf.create(K,pa,Ta,jb);jb&&"true"===jb.SkipSaveToHost?
this.Oka():this.Dcm()}Dcm(){const K=()=>{ua.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.Oka()};32!==this.ga.Pb(v.a.i_b,2,[()=>{ua.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.Oka()},K])&&K()}Oka(){ua.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.nEc.execute(Object(O.a)(this,this.h2n,"onSaveToSharePointUploadFinished"),Object(O.a)(this,this.g2n,
"onSaveToSharePointUploadFailed"))}h2n(K){if(K&&K.data&&K.data.De){var pa;if(({Zu:pa}=Ya.d(K.data.De)).returnValue)if(pa.StatusCode!==al.a.zz&&pa.StatusCode!==al.a.jgc)ua.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",K.data.status,pa.StatusCode),pa.StatusCode!==al.a.wug&&this.Ihi(K.data.status)||(this.c_a(pa.StatusCode.toString()),this.n6o(pa.StatusCode));else{ua.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.rug();try{pa.NewDocumentUrl?this.ZYb(pa.NewDocumentUrl):this.$Yb()}catch(Ta){ua.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",Ta.toString())}}else ua.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Hb.a.Isd(K.data.De)}),this.k0d()||(this.c_a("Failed to deserialize response"),this.aqd())}else ua.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.k0d()||(this.c_a("Unknown"),this.aqd())}g2n(K){K&&K.data?this.Ihi(K.data.status)||
(ua.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.c_a(wc.a[K.data.status]),this.aqd()):(ua.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.k0d()||(this.c_a("Unknown"),this.aqd()))}k0d(){if(!this.KKe)return ua.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.KKe=!0,this.Oka(),!0;ua.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}Ihi(K){ua.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",
K);return this.k0d()}$Yb(){ua.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");fa.a.yn(this.sRa,fa.a.wwa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}ZYb(K){let pa=!1,Ta=!1;m.AFrameworkApplication.K&&(pa=m.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),Ta=m.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ua.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",K,pa);if(pa&&Ta){ua.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const jb={};jb[Zg.a.cvc]="1";jb[Zg.a.documentUrl]=K;jb[Zg.a.reason]=Nb.a.Pwg;m.AFrameworkApplication.IR().execute(bc=>{bc.sendMessage(Bb.a.BNb,jb)})}else fa.a.yn(K,fa.a.wwa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Beb(){this.yj&&1===this.yj.state||(this.kl=this.s4a(),this.kl.message=CommonUIStrings.l_CommentProgressTooltip,this.kl.Gd=5,this.kl.Du=!1,this.kl.lM(CommonUIStrings.l_DefaultDialogTitle,null,null))}bsa(){this.kl&&(this.kl.close(),this.kl=null)}aqd(){this.qq(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)}i7o(){this.qq(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}t6o(){const K=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.qq(CommonUIStrings.l_SaveAsFileTooLargeTitle,K,wg.a.rKo)}qq(K,pa,Ta=wg.a.vKo){ua.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",K,pa);this.bsa();1!==this.yj.state&&this.vJ().bhi(K,pa,Ta)}n6o(K){ua.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
K);switch(K){case al.a.zEe:this.i7o();break;case al.a.wug:this.t6o();break;default:this.aqd()}}rug(){"VersionHistory"===this.N7e&&this.ga.Ob(v.a.Fld,2)}c_a(K){"VersionHistory"===this.N7e&&this.ga.Pb(v.a.dve,2,{["FailureReason"]:K})}}Object(f.a)(cd,"UploadToSharePointManager",null,[1083]);var Rd=d(577),cf=d(143);class Ge{constructor(){this.Zkb=this.x1e=this.o1e=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}wc(K){this.W=K;this.o1e=Rd.a.$p(K.Qa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));
this.x1e=Rd.a.$p(K.Qa("Common.IEventEmitter<Common.IMruResult>"));this.Zkb=Rd.a.$p(K.Qa("Common.App.SharedFilePicker.ISharedFilePicker"));cf.Task.WAA.call(null,this.o1e,this.x1e,this.Zkb).continueWith(()=>{this.qso()})}qso(){this.W.register(hb,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Rd(()=>new hb(m.AFrameworkApplication.K)).ha();this.W.register(cd,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Rd(()=>
new cd(m.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new hj.a).create(),()=>new Zf,m.AFrameworkApplication.ua)).ha();this.W.register(Qi,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Rd(()=>new Qi(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Zf,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),m.AFrameworkApplication.ua)).ha();
this.W.register(qi,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Rd(()=>new qi(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Ec.a(()=>this.o1e.result),m.AFrameworkApplication.ua,()=>new Yi)).ha();this.W.register(rm,"Common.App.SaveToSharePoint.FileNameDialogFactory").Rd(()=>new rm(m.AFrameworkApplication.K,m.AFrameworkApplication.va,m.AFrameworkApplication.ua,m.AFrameworkApplication.ua.Ib,
this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new Ec.a(()=>this.x1e.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Zkb?this.Zkb.result:null)).ha();this.W.register(Zl,"Common.App.SaveToSharePoint.SaveToSharePointActor").Rd(()=>new Zl(m.AFrameworkApplication.K,m.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>m.AFrameworkApplication.ua.ull)).ha();m.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Wb()}static main(){H.a.instance.Jc(new Ge)}}Object(f.a)(Ge,"PackageManager",null,[0,1]);class Wg{}Object(f.a)(Wg,
"StringDifference",null,[1023]);class ge{constructor(K,pa){this.charCode=K;this.description=pa}}Object(f.a)(ge,"UBTableEntry",null,[]);class oj{}new ge(8,"C0 Controls 1");new ge(9,"Horizontal tab (HT)");new ge(10,"Line feed (LF)");new ge(12,"C0 Controls 2");new ge(13,"Carriage return (CR)");new ge(31,"C0 Controls 3");new ge(32,"Space");new ge(47,"ASCII Punctuation and Symbols 1");new ge(57,"ASCII Digits");new ge(64,"ASCII Punctuation and Symbols 2");new ge(90,"Uppercase Latin Alphabet");new ge(96,
"ASCII Punctuation and Symbols 3");new ge(122,"Lowercase Latin Alphabet");new ge(127,"U+0000..U+007F Basic Latin");new ge(159,"C1 Controls");new ge(160,"NB Space");new ge(191,"Latin-1 Punctuation and Symbols");new ge(255,"U+0080..U+00FF Latin-1 Supplement");new ge(383,"U+0100..U+017F Latin Extended-A");new ge(591,"U+0180..U+024F Latin Extended-B");new ge(687,"U+0250..U+02AF IPA Extensions");new ge(767,"U+02B0..U+02FF Spacing Modifier Letters");new ge(879,"U+0300..U+036F Combining Diacritical Marks");
new ge(1023,"U+0370..U+03FF Greek and Coptic");new ge(1279,"U+0400..U+04FF Cyrillic");new ge(1327,"U+0500..U+052F Cyrillic Supplement");new ge(1423,"U+0530..U+058F Armenian");new ge(1535,"U+0590..U+05FF Hebrew");new ge(1791,"U+0600..U+06FF Arabic");new ge(1871,"U+0700..U+074F Syriac");new ge(1919,"U+0750..U+077F Arabic Supplement");new ge(1983,"U+0780..U+07BF Thaana");new ge(2047,"U+07C0..U+07FF NKo");new ge(2111,"U+0800..U+083F Samaritan");new ge(2143,"U+0840..U+085F Mandaic");new ge(2303,"U+08A0..U+08FF Arabic Extended-A");
new ge(2431,"U+0900..U+097F Devanagari");new ge(2559,"U+0980..U+09FF Bengali");new ge(2687,"U+0A00..U+0A7F Gurmukhi");new ge(2815,"U+0A80..U+0AFF Gujarati");new ge(2943,"U+0B00..U+0B7F Oriya");new ge(3071,"U+0B80..U+0BFF Tamil");new ge(3199,"U+0C00..U+0C7F Telugu");new ge(3327,"U+0C80..U+0CFF Kannada");new ge(3455,"U+0D00..U+0D7F Malayalam");new ge(3583,"U+0D80..U+0DFF Sinhala");new ge(3711,"U+0E00..U+0E7F Thai");new ge(3839,"U+0E80..U+0EFF Lao");new ge(4095,"U+0F00..U+0FFF Tibetan");new ge(4255,
"U+1000..U+109F Myanmar");new ge(4351,"U+10A0..U+10FF Georgian");new ge(4607,"U+1100..U+11FF Hangul Jamo");new ge(4991,"U+1200..U+137F Ethiopic");new ge(5023,"U+1380..U+139F Ethiopic Supplement");new ge(5119,"U+13A0..U+13FF Cherokee");new ge(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new ge(5791,"U+1680..U+169F Ogham");new ge(5887,"U+16A0..U+16FF Runic");new ge(5919,"U+1700..U+171F Tagalog");new ge(5951,"U+1720..U+173F Hanunoo");new ge(5983,"U+1740..U+175F Buhid");new ge(6015,"U+1760..U+177F Tagbanwa");
new ge(6143,"U+1780..U+17FF Khmer");new ge(6319,"U+1800..U+18AF Mongolian");new ge(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new ge(6479,"U+1900..U+194F Limbu");new ge(6527,"U+1950..U+197F Tai Le");new ge(6623,"U+1980..U+19DF New Tai Lue");new ge(6655,"U+19E0..U+19FF Khmer Symbols");new ge(6687,"U+1A00..U+1A1F Buginese");new ge(6831,"U+1A20..U+1AAF Tai Tham");new ge(7039,"U+1B00..U+1B7F Balinese");new ge(7103,"U+1B80..U+1BBF Sundanese");new ge(7167,"U+1BC0..U+1BFF Batak");
new ge(7247,"U+1C00..U+1C4F Lepcha");new ge(7295,"U+1C50..U+1C7F Ol Chiki");new ge(7375,"U+1CC0..U+1CCF Sundanese Supplement");new ge(7423,"U+1CD0..U+1CFF Vedic Extensions");new ge(7551,"U+1D00..U+1D7F Phonetic Extensions");new ge(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new ge(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new ge(7935,"U+1E00..U+1EFF Latin Extended Additional");new ge(8191,"U+1F00..U+1FFF Greek Extended");new ge(8303,"U+2000..U+206F General Punctuation");
new ge(8351,"U+2070..U+209F Superscripts and Subscripts");new ge(8399,"U+20A0..U+20CF Currency Symbols");new ge(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new ge(8527,"U+2100..U+214F Letterlike Symbols");new ge(8591,"U+2150..U+218F Number Forms");new ge(8703,"U+2190..U+21FF Arrows");new ge(8959,"U+2200..U+22FF Mathematical Operators");new ge(9215,"U+2300..U+23FF Miscellaneous Technical");new ge(9279,"U+2400..U+243F Control Pictures");new ge(9311,"U+2440..U+245F Optical Character Recognition");
new ge(9471,"U+2460..U+24FF Enclosed Alphanumerics");new ge(9599,"U+2500..U+257F Box Drawing");new ge(9631,"U+2580..U+259F Block Elements");new ge(9727,"U+25A0..U+25FF Geometric Shapes");new ge(9983,"U+2600..U+26FF Miscellaneous Symbols");new ge(10175,"U+2700..U+27BF Dingbats");new ge(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new ge(10239,"U+27F0..U+27FF Supplemental Arrows-A");new ge(10495,"U+2800..U+28FF Braille Patterns");new ge(10623,"U+2900..U+297F Supplemental Arrows-B");
new ge(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new ge(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new ge(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new ge(11359,"U+2C00..U+2C5F Glagolitic");new ge(11391,"U+2C60..U+2C7F Latin Extended-C");new ge(11519,"U+2C80..U+2CFF Coptic");new ge(11567,"U+2D00..U+2D2F Georgian Supplement");new ge(11647,"U+2D30..U+2D7F Tifinagh");new ge(11743,"U+2D80..U+2DDF Ethiopic Extended");new ge(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new ge(11903,"U+2E00..U+2E7F Supplemental Punctuation");new ge(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new ge(12255,"U+2F00..U+2FDF Kangxi Radicals");new ge(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new ge(12351,"U+3000..U+303F CJK Symbols and Punctuation");new ge(12447,"U+3040..U+309F Hiragana");new ge(12543,"U+30A0..U+30FF Katakana");new ge(12591,"U+3100..U+312F Bopomofo");new ge(12687,"U+3130..U+318F Hangul Compatibility Jamo");new ge(12703,"U+3190..U+319F Kanbun");new ge(12735,
"U+31A0..U+31BF Bopomofo Extended");new ge(12783,"U+31C0..U+31EF CJK Strokes");new ge(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new ge(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new ge(13311,"U+3300..U+33FF CJK Compatibility");new ge(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new ge(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new ge(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new ge(42127,"U+A000..U+A48F Yi Syllables");new ge(42191,"U+A490..U+A4CF Yi Radicals");
new ge(42239,"U+A4D0..U+A4FF Lisu");new ge(42559,"U+A500..U+A63F Vai");new ge(42655,"U+A640..U+A69F Cyrillic Extended-B");new ge(42751,"U+A6A0..U+A6FF Bamum");new ge(42783,"U+A700..U+A71F Modifier Tone Letters");new ge(43007,"U+A720..U+A7FF Latin Extended-D");new ge(43055,"U+A800..U+A82F Syloti Nagri");new ge(43071,"U+A830..U+A83F Common Indic Number Forms");new ge(43135,"U+A840..U+A87F Phags-pa");new ge(43231,"U+A880..U+A8DF Saurashtra");new ge(43263,"U+A8E0..U+A8FF Devanagari Extended");new ge(43311,
"U+A900..U+A92F Kayah Li");new ge(43359,"U+A930..U+A95F Rejang");new ge(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new ge(43487,"U+A980..U+A9DF Javanese");new ge(43615,"U+AA00..U+AA5F Cham");new ge(43647,"U+AA60..U+AA7F Myanmar Extended-A");new ge(43743,"U+AA80..U+AADF Tai Viet");new ge(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new ge(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new ge(44031,"U+ABC0..U+ABFF Meetei Mayek");new ge(55215,"U+AC00..U+D7AF Hangul Syllables");new ge(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new ge(56191,"U+D800..U+DB7F High Surrogates");new ge(56319,"U+DB80..U+DBFF High Private Use Surrogates");new ge(57343,"U+DC00..U+DFFF Low Surrogates");new ge(63743,"U+E000..U+F8FF Private Use Area");new ge(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new ge(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new ge(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new ge(65039,"U+FE00..U+FE0F Variation Selectors");new ge(65055,"U+FE10..U+FE1F Vertical Forms");new ge(65071,"U+FE20..U+FE2F Combining Half Marks");
new ge(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new ge(65135,"U+FE50..U+FE6F Small Form Variants");new ge(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new ge(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new ge(65535,"U+FFF0..U+FFFF Specials");new ge(65663,"U+10000..U+1007F Linear B Syllabary");new ge(65791,"U+10080..U+100FF Linear B Ideograms");new ge(65855,"U+10100..U+1013F Aegean Numbers");new ge(65935,"U+10140..U+1018F Ancient Greek Numbers");new ge(65999,"U+10190..U+101CF Ancient Symbols");
new ge(66047,"U+101D0..U+101FF Phaistos Disc");new ge(66207,"U+10280..U+1029F Lycian");new ge(66271,"U+102A0..U+102DF Carian");new ge(66351,"U+10300..U+1032F Old Italic");new ge(66383,"U+10330..U+1034F Gothic");new ge(66463,"U+10380..U+1039F Ugaritic");new ge(66527,"U+103A0..U+103DF Old Persian");new ge(66639,"U+10400..U+1044F Deseret");new ge(66687,"U+10450..U+1047F Shavian");new ge(66735,"U+10480..U+104AF Osmanya");new ge(67647,"U+10800..U+1083F Cypriot Syllabary");new ge(67679,"U+10840..U+1085F Imperial Aramaic");
new ge(67871,"U+10900..U+1091F Phoenician");new ge(67903,"U+10920..U+1093F Lydian");new ge(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new ge(68095,"U+109A0..U+109FF Meoritic Cursive");new ge(68191,"U+10A00..U+10A5F Kharoshthi");new ge(68223,"U+10A60..U+10A7F Old South Arabian");new ge(68415,"U+10B00..U+10B3F Avestan");new ge(68447,"U+10B40..U+10B5F Inscriptional Parthian");new ge(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new ge(68687,"U+10C00..U+10C4F Old Turkic");new ge(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new ge(69759,"U+11000..U+1107F Brahmi");new ge(69839,"U+11080..U+110CF Kaithi");new ge(69887,"U+110D0..U+110FF Sora Sompeng");new ge(69967,"U+11100..U+1114F Chakma");new ge(70111,"U+11180..U+111DF Sharada");new ge(71375,"U+11680..U+116CF Takri");new ge(74751,"U+12000..U+123FF Cuneiform");new ge(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new ge(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new ge(92735,"U+16800..U+16A3F Bamum Supplement");new ge(94111,"U+16F00..U+16F9F Miao");new ge(110847,
"U+1B000..U+1B0FF Kana Supplement");new ge(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new ge(119295,"U+1D100..U+1D1FF Musical Symbols");new ge(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new ge(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new ge(119679,"U+1D360..U+1D37F Counting Rod Numerals");new ge(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new ge(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new ge(127023,"U+1F000..U+1F02F Mahjong Tiles");
new ge(127135,"U+1F030..U+1F09F Domino Tiles");new ge(127231,"U+1F0A0..U+1F0FF Playing Cards");new ge(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new ge(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new ge(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new ge(128591,"U+1F600..U+1F64F Emoticons");new ge(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new ge(128895,"U+1F700..U+1F77F Alchemical Symbols");new ge(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new ge(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new ge(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new ge(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new ge(917631,"U+E0000..U+E007F Tags");new ge(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new ge(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new ge(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(f.a)(oj,"UnicodeBlocks",null,[1024]);class uh{constructor(){this.W=
null}wc(K){this.W=K;this.W.register(Wg,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").ha();this.W.register(oj,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").ha()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){H.a.instance.Jc(new uh)}}Object(f.a)(uh,
"SensitiveLoggingPackage",null,[0,1]);var Pj;(function(K){K[K.kcq=0]="myFiles";K[K.recent=1]="recent";K[K.MWp=2]="currentFolder";K[K.zqq=3]="yourPhone"})(Pj||(Pj={}));Object(f.b)("SharedFilePickerLandingLocation",Pj);class eh{constructor(K){this.DRb=this.wuc=null;this._initialized=!1;this.JTf=K}kpb(K){this._initialized||(K.Aw(Bb.a.Zyj),K.BD(Bb.a.Zyj,Object(O.a)(this,this.b1n,"onReceivedPickerResponse")),this._initialized=!0)}P6d(K){return this.DRb=new Promise((pa,Ta)=>{const jb={};jb[Zg.a.Jao]=K;
this.wuc=(bc,Ic)=>{""===Ic?(ua.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),pa(bc)):("Canceled"===Ic?ua.ULS.sendTraceTag(572548164,306,50,Ic):ua.ULS.sendTraceTag(556901065,306,10,Ic),Ta(Ic))};this.JTf.execute(bc=>{this.kpb(bc);bc.sendMessage(Bb.a.H5n,jb)})})}b1n(K){this.wuc(K.Values[Zg.a.oNo],void 0===K.Values[Zg.a.Nkg]||null===K.Values[Zg.a.Nkg]?"":K.Values[Zg.a.Nkg])}T0f(){return m.AFrameworkApplication.K.$("UiHostCommonFilePicker")}Gtf(K,pa,Ta,jb,bc,Ic,Uc,kd,pd=null){const Fd=
{};Fd[Zg.a.PMo]=K;Fd[Zg.a.titleText]=pa;Fd[Zg.a.E4k]=Ta;Fd[Zg.a.F4k]=jb;Fd[Zg.a.H4k]=bc;Fd[Zg.a.wVl]=!0;Fd[Zg.a.s7l]=Ic;Fd[Zg.a.Nao]=Uc;Fd[Zg.a.Mao]=Pj[kd];F.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Fd[Zg.a.Oao]="Dark");pd&&(null!=pd.adc&&(Fd[Zg.a.adc]=pd.adc),null!=pd.Omc&&(Fd[Zg.a.Omc]=pd.Omc));return Fd}}Object(f.a)(eh,"SharedFilePickerManager",null,[1020]);class xf{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}wc(K){this.W=K;K.register(eh,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ha().Rd(()=>
new eh(K.Qa("Postmessage.IHostPostmessenger")))}init(){m.AFrameworkApplication.K.Rn(()=>{this.w$a()})}w$a(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){H.a.instance.Jc(new xf)}}Object(f.a)(xf,"SharedFilePickerPackage",null,[0,1]);class gh extends Sys.EventArgs{constructor(){super()}}Object(f.a)(gh,"TypingSpeedMeterChangedEventArgs",Sys.EventArgs,[]);class Ue{}Object(f.a)(Ue,"TypingSpeedMeterWindow",null,[]);class gb{constructor(K,pa){new V.a;this.Eme=()=>
{};this.sB=K;this.jj=pa;this.jj.wgf(this.Eme)}dispose(){this.jj.ODj(this.Eme)}}Object(f.a)(gb,"TypingSpeedMeter",null,[1047]);class Mb{constructor(K){this.nPd=null;this.Sq=new x.a;this.sB=K}initialize(K,pa,Ta,jb){this.nPd||(this.nPd=new gb(this.sB,K,pa,Ta,jb),this.Sq.gg(this.nPd));return this.nPd}}Object(f.a)(Mb,"TypingSpeedMeterProvider",null,[1016]);class hc{constructor(){this.Rbf=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(m.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const K=
Ca.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),pa=Rd.a.$p(Ca.a.instance.Qa("Common.ICpuMeterProvider"));pa.continueWith(()=>{const Ta=pa.result.Sq.task;var jb=new Ja.a(m.AFrameworkApplication.K.ic("TypingSpeedMeterWindowSamplingPercent",0)/100);jb=new Ea.a(Object(O.a)(jb,jb.p0b,"shouldBeInSample"));const bc=Qa.a.UG(12,1,jb),Ic=m.AFrameworkApplication.K.ic("TypingSpeedMeterWindowTimeoutMs",5E3),Uc=m.AFrameworkApplication.K.ic("TypingSpeedMeterMaxKeystrokesPerWindow",
5);Ta.CWR(()=>this.Rbf=K.initialize(Ta.result,bc,Ic,Uc))})}}dispose(){this.Rbf&&this.Rbf.dispose()}wc(K){K.register(Mb,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").ha().Rd(()=>new Mb(fa.a.Ee))}static main(){H.a.instance.Jc(new hc)}}Object(f.a)(hc,"TypingSpeedMeterPackage",null,[0,1]);class Kc{constructor(){this.events=[];this.tug=!1}static L2f(K){return K.ctrlKey&&"Control"!==K.key||K.altKey&&"Alt"!==K.key||!!Kc.Evn[K.key]}static sgl(K,pa){let Ta;
Ta=Kc.L2f(K)?K.key:" "===K.key?"Space":"CharacterKey";return null!=pa?(pa.altPressed=(!!K.altKey).toString(),pa.ctrlPressed=(!!K.ctrlKey).toString(),pa.key=Ta,pa.repeat=(!!K.repeat).toString(),pa.shiftPressed=(!!K.shiftKey).toString(),pa):{["altPressed"]:(!!K.altKey).toString(),["ctrlPressed"]:(!!K.ctrlKey).toString(),["key"]:Ta,["repeat"]:(!!K.repeat).toString(),["shiftPressed"]:(!!K.shiftKey).toString()}}static U0i(K){return window.performance&&window.performance.now&&K.timeStamp<performance.now()}static Wli(K){return!!K&&
Kc.U0i(K)&&Kc.L2f(K)}static Xli(K){return!!K&&Kc.U0i(K)&&!Kc.L2f(K)}keyPressedEventHandlerStart(K,pa){Kc.Xli(K)&&this.SXj(K,pa)}keyPressedEventHandlerEnd(K){Kc.Xli(K)&&this.zYj(K)}keyDownEventHandlerStart(K,pa){Kc.Wli(K)&&this.SXj(K,pa)}keyDownEventHandlerEnd(K){Kc.Wli(K)&&this.zYj(K)}SXj(K,pa){K={["metadata"]:Kc.sgl(K,pa),["timeStamp"]:this.CAc(K.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.CAc(performance.now()-K.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};
this.events.push(K);this.Bvo()}zYj(K){if(0!==this.events.length){var pa=this.CAc(K.timeStamp);for(let Ta=this.events.length-1;0<=Ta;--Ta){const jb=this.events[Ta];if(jb.timeStamp===pa){jb.timeToHandlerFinishMs=this.CAc(performance.now()-K.timeStamp);jb.eventDurationMs=this.CAc(jb.timeToHandlerFinishMs-jb.timeToHandlerStartMs);break}}}}CAc(K){return Number(K.toFixed(2))}Bvo(){if(!this.tug){const K=document.createEvent("CustomEvent");K.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(K);
requestAnimationFrame(()=>{this.tug=!1;const pa=performance.now();this.events.forEach(jb=>{jb.timeToRequestAnimationFrameMs=this.CAc(pa-jb.timeStamp)});var Ta=document.createEvent("CustomEvent");Ta.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(Ta);this.events=[];Ta=document.createEvent("CustomEvent");Ta.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(Ta)});this.tug=!0}}}Kc.Evn={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,
["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class Vc{constructor(){this.eve=this.Dbb=this.eYa=this.xrc=null;this.Itb=!1;this.Cvc=null;this.x1c=[];this.Dtd=()=>{Vc.Snn()&&null==this.Dbb?(this.eYa=null,this.Dbb=requestAnimationFrame(this.mdd)):null!=this.Dbb&&(cancelAnimationFrame(this.Dbb),this.Dbb=null)};this.mdd=K=>{if(null!=this.eYa){const pa=K-this.eYa;if(null==this.xrc||this.xrc<pa)this.xrc=pa;for(let Ta=0;Ta<Vc.ranges.length;++Ta)if(pa<
Vc.ranges[Ta]){++this.x1c[Ta];break}}this.eYa=K;this.Dbb=requestAnimationFrame(this.mdd)};this.vFj=()=>{if(null!=this.xrc){var K={};for(var pa=0;pa<Vc.ranges.length;++pa)K[Vc.ranges[pa]]=this.x1c[pa],this.x1c[pa]=0;pa=performance.now();K={["intervalStart"]:this.Cvc,["intervalEnd"]:pa,["maxFrameLengthMs"]:this.xrc,["frameData"]:K};var Ta=document.createEvent("CustomEvent");Ta.initCustomEvent("reportframetiming",!1,!1,K);dispatchEvent(Ta);this.xrc=null;this.Cvc=pa}}}static W_f(){return!!window.performance&&
!!window.performance.now}start(K){!this.Itb&&Vc.W_f()&&(this.z_o(),this.eve=setInterval(this.vFj,1E3*K),this.Cvc=performance.now(),this.Dtd(),document.addEventListener("visibilitychange",this.Dtd),this.Itb=!0)}stop(){this.Itb&&(document.removeEventListener("visibilitychange",this.Dtd),null!=this.eve&&(clearInterval(this.eve),this.eve=null),null!=this.Dbb&&(cancelAnimationFrame(this.Dbb),this.Dbb=null),this.vFj(),this.Itb=!1)}get Eab(){return this.Itb}z_o(){this.x1c=[];for(let K=0;K<Vc.ranges.length;++K)this.x1c.push(0)}}
Vc.Snn=()=>"visible"===document.visibilityState;Vc.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];class od{create(K){return new Ja.a(K)}}Object(f.a)(od,"RandomSamplerFactory",null,[1443]);var Od=d(23),Ld=d(94);class Af{constructor(K,pa,Ta,jb,bc){K.ORd(()=>{jb.xld()});K.rQh((Ic,Uc)=>{jb.vld(Uc.revisionId,Uc.Zbb)});K.RRd((Ic,Uc)=>{jb.V3m(Uc.FHj,Uc.Zbb,Uc.X0j)});K.h1k(()=>{jb.hug()});pa.J1k((Ic,Uc)=>{jb.Rjp(Uc.fFj,Uc.ZCe,Uc.actualValue)});pa.s0k((Ic,Uc)=>{jb.Qjp(Uc.fFj,
Uc.ZCe,Uc.actualValue)});bc.MSc(()=>{jb.gtd()});Ta.JO((Ic,Uc)=>{6===Uc.type&&jb.iwc(Uc.nA)})}}Object(f.a)(Af,"EventForwarder",null,[]);class Tb{constructor(K,pa,Ta){this.TFk=K;this.rQ=Ta;this.hbc=pa}create(K,pa){return new Af(this.TFk,this.hbc,K,pa,this.rQ)}}Object(f.a)(Tb,"EventForwarderFactory",null,[]);var Dg=d(363);class Kh{}Kh.Lqp="TypingToOutboundReplicationStart";Kh.t6n="OutboundReplicationStartToOutboundReplicationEnd";Kh.AIj="RtcNotificationToInboundReplicationEnd";Kh.S4j="TypingToInboundReplicationEnd";
Object(f.a)(Kh,"PerfTrackerPhases",null,[]);class rg{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd,pd=null){this.Rth=!1;this.i2e=5;this.hvh=50;this.N0e=20;this.v_e=this.w0e=this.BFa=null;this.CFc=this.qFc=0;this.d$e=this.laf=!1;this.oOd=Array(7);this.RCc=null;this.Nkh=!1;this.$Me=null;this.Uma={};this.ODd=K;this.i2a=pa;this.sEk=Ta;this.Mmh=jb.create(Kh.AIj,bc,Ic,20,!1);this.oPd=jb.create(Kh.S4j,Uc,kd,20,!0);if(this.Ga=m.AFrameworkApplication.K)this.Rth=this.Ga.$("LogSteppedInboundFrameIsEnabled"),this.N0e=this.Ga.ic("InboundFrameMaxNumberOfLongRunningTasks",
20),this.hvh=this.Ga.ic("InboundFrameMinLengthForLongRunningTasksInMs",50),this.i2e=this.Ga.ic("InboundFrameNumberOfLastShortTasks",5);this.dCb=pd}get gpl(){null==this.$Me&&(this.$Me=!!this.Ga&&this.Ga.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));return this.$Me}initialize(K){this.BFa=K}KDo(K,pa,Ta=null){this.K2h();ua.ULS.shipAssertTag(8229761,324,0<K.length);let jb=!1;for(const Ic of K){const Uc=Ic.toString();if(Uc in this.Uma){var bc=this.Uma[Uc];if(!bc.Pwc){bc.iMj(K,pa,Ta);
if(jb)this.zaj(Ic.toString(),bc,null,null,this.oOd,null);else{const kd=this.u5l(),pd=this.xfm(this.RCc);jb=!0;this.zaj(Ic.toString(),bc,kd,this.v_e,this.oOd,pd)}delete this.Uma[Uc]}}else bc=this.ODd.create(this.Mmh,this.oPd),bc.iMj(K,pa),this.Uma[Uc]=bc}this.d$e=!1}iwc(K){ua.ULS.shipAssertTag(8257930,304,K.p4i,"Expected data not sent on the wire");if(K.p4i){if(K.Ive in this.Uma){var pa=this.Uma[K.Ive];pa.Wve||(pa.iwc(K.revisionId,K.mqj,K.lTj,K.Zbb),delete this.Uma[K.Ive])}else pa=this.ODd.create(this.Mmh,
this.oPd),pa.iwc(K.revisionId,K.mqj,K.lTj,K.Zbb),this.Uma[K.Ive]=pa;this.K2h()}}K5m(){this.laf||(this.w0e=Array(this.N0e),this.v_e=Array(this.i2e),this.CFc=this.qFc=0,this.oOd=[0,0,0,0,0,0,0,0],this.RCc=Array(3),this.RCc[1]=[0,0],this.RCc[2]=[0,0],this.laf=!0)}z3o(K){return!K.TP&&K.TN===ia.a.$Ej&&(K=Dg.a(this.Uma))&&K[0]?!0:!1}BWn(K){this.laf=!1;const pa=Dg.a(this.Uma);pa&&pa[0]&&(K.TRT>=this.hvh&&this.qFc<this.N0e?this.w0e[this.qFc++]=K:(this.v_e[this.CFc]=K,this.CFc=this.CFc<this.i2e-1?this.CFc+
1:0),this.zFn(K),this.OFn(K))}AWn(){this.K5m();this.d$e=!0}zFn(K){this.oOd[K.TP]++}OFn(K){if(K&&K.UI){const pa=this.RCc[K.UI];pa[0]+=1;pa[1]+=K.TRT}}xfm(K){const pa={};K&&(K[1]&&(pa.Typing=K[1]),K[2]&&(pa.Clicking=K[2]));return pa}u5l(){return this.qFc?this.w0e.slice(0,this.qFc-1):null}K2h(){var K=Dg.a(this.Uma);if(K&&(this.Nkh||this.jGn(K),K.length>this.sEk))for(const pa of K){K=this.Uma[pa];const Ta=K.createdTime,jb=this.i2a();6E4<jb-Ta&&(N.b(8438528,304,50,"{0}",{["Not Received"]:K.Pwc?"RtcNotification":
"ServerRevision",["Duration"]:jb-Ta}),K.Pwc||N.b(42075798,304,15,"{0}",{["RevisionId"]:pa,["Duration"]:jb-Ta}),delete this.Uma[pa])}}jGn(K){if(this.gpl&&this.dCb)for(const pa of K)if(K=this.Uma[pa],K.Wve&&!K.Pwc&&(K=K.createdTime,2E3<this.i2a()-K)){let Ta=null;Od.StaticActiveAppFrame.za()&&Od.StaticActiveAppFrame.za().ib&&Od.StaticActiveAppFrame.za().ib.$c&&(Ta=Od.StaticActiveAppFrame.za().ib.$c.yg);this.dCb.execute(jb=>{jb.flush(Ta,1)});this.Nkh=!0}}zaj(K,pa,Ta,jb,bc,Ic){this.Rth&&(pa=pa.jfm())&&
(pa.RevisionId=K,pa.LRTWR=Ta,pa.LSTWR=jb,pa.TSD=bc,pa.UIWR=Ic,this.BFa&&this.BFa.track(pa))}}Object(f.a)(rg,"InboundMonitor",null,[1130]);class ai{constructor(K,pa,Ta,jb){this.dF=pa;this.ODd=Ta;this.FQk=jb}create(K,pa,Ta,jb,bc=null){return new rg(this.ODd,this.dF,50,this.FQk,K,pa,Ta,jb,bc)}}Object(f.a)(ai,"InboundMonitorFactory",null,[1107]);var kl=d(400);class Fe{}Fe.VFe="UserCount";Fe.jIo="RevisionChainLength";Object(f.a)(Fe,"PerfTrackerPivotNames",null,[]);class vh{}Object(f.a)(vh,"PerfTrackingContext",
null,[]);const te=K=>5>=K?"5AndFewer":10>=K?"6To10":15>=K?"11To15":20>=K?"15To20":25>=K?"21To25":30>=K?"26To30":"31AndAbove";class jj{}Object(f.a)(jj,"SteppedInboundFrame",null,[]);class ek{constructor(K,pa,Ta,jb,bc){this.fkb=this.QDd=null;this.Hmh=500;this.PDd=this.Fxa=this.lEb=this.L7b=this.qwd=-1;this.vTg=null;this.tEh=this.oDh=!1;this.RCh=null;this.Byh=this.tSa=0;this.d$b=K;this.createdTime=pa();this.NMd=!1;this.v3e=0;this.dGb=Ta;this.qzk=jb;this.oPd=bc;m.AFrameworkApplication.K&&(this.Hmh=m.AFrameworkApplication.K.ic("InboundFrameSamplingMinimalTotalTimeMs",
500))}get Wve(){return this.oDh}get Pwc(){return this.tEh}get GHj(){return this.RCh}get Zbb(){return this.tSa}get s6n(){return this.Byh}get NNb(){return this.dGb()}iwc(K,pa,Ta,jb){this.Wve||(this.NMd=Ta,this.v3e=pa,this.qwd=Z.a.YP(fa.a.Ee(),2),this.vTg=(new Date).toISOString(),this.fkb=K,this.Byh=jb,this.oDh=!0,this.Pwc?this.vki():(this.TXj(),za.a.instance.xA(K.toString()+"Start"),kl.a.instance.Gje(2)))}iMj(K,pa,Ta=null){this.Pwc||(this.tSa=pa,this.tEh=!0,this.RCh=K,this.PDd=Z.a.YP(fa.a.Ee(),2),this.Wve&&
(za.a.instance.xA(this.fkb.toString()+"End"),Ta&&(this.L7b=Ta.jGj,this.lEb=Ta.PNa,this.Fxa=Ta.eFj),kl.a.instance.ZVd(),this.vki()))}jfm(){if(!(0<this.qwd&&0<this.L7b&&0<this.lEb&&0<this.Fxa&&0<this.PDd))return null;const K=new jj;K.TT=Z.a.YP(this.PDd-this.qwd,2);if(K.TT<this.Hmh)return null;K.ST=this.vTg;K.UC=this.NNb;K.RS=Z.a.YP(this.L7b-this.qwd,2);K.SR=Z.a.YP(this.lEb-this.L7b,2);K.RRS=Z.a.YP(this.Fxa-this.lEb,2);K.RP=Z.a.YP(this.PDd-this.Fxa,2);K.ResponseLanded=Z.a.YP(this.lEb,2);0<K.RS?(za.a.instance.B0("RTCToRequestSent",
this.fkb.toString()+"Start","RequestInvoked"+this.L7b),za.a.instance.B0("RequestSentToResponseReceived","RequestInvoked"+this.L7b,"RequestCompleted"+this.lEb),za.a.instance.B0("ResponseReceivedToReplicationStart","RequestCompleted"+this.lEb,"ReplicationStart"+this.Fxa)):za.a.instance.B0("RTCToReplicationStart",this.fkb.toString()+"Start","ReplicationStart"+this.Fxa);za.a.instance.B0("Replication","ReplicationStart"+this.Fxa,this.fkb.toString()+"End");return K}TXj(){this.QDd=this.d$b.create();this.QDd.start(Kh.AIj,
Kh.S4j)}vki(){this.QDd||this.TXj();const K=this.QDd.end(this.NMd,this.FIl());this.qzk.cve(K);this.oPd.cve(K+this.v3e)}FIl(){const K={};K[Fe.VFe]=te(this.NNb);var pa=this.GHj.length;K[Fe.jIo]=9>=pa?pa.toString():"10AndAbove";return Object.assign(new vh,{P:K,FC:this.Zbb,CFC:this.s6n+this.Zbb,ID:this.fkb.toString(),CD:this.v3e,UC:this.NNb,RCL:this.GHj.length})}}Object(f.a)(ek,"InboundOperation",null,[1127]);class pg{constructor(K,pa,Ta){this.jRa=K;this.i2a=pa;this.dGb=Ta}create(K,pa){return new ek(this.jRa,
this.i2a,this.dGb,K,pa)}}Object(f.a)(pg,"InboundOperationFactory",null,[1106]);class Ak{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd,pd){this.OMd=!0;this.Hzh=this.zJd=null;this.nC=Fd=>{this.Yh.nC(6,Fd)};this.u3e=K;this.Euk=pa;this.PIk=Ta;this.Yh=jb;this.Sbf=bc.create("TypingToOutboundReplicationStart",Ic,Uc,20,!1);this.E6e=bc.create("OutboundReplicationStartToOutboundReplicationEnd",kd,pd,20,!1)}get vkg(){return this.zJd}get jqe(){return this.Hzh}gtd(){!this.vkg&&this.OMd&&(this.OMd=this.Euk())&&(this.zJd=
this.u3e.create(this.nC,this.PIk(),this.Sbf,this.E6e),this.vkg.gtd())}xld(){this.OMd=!0;this.Hzh=this.vkg;this.jqe&&(this.zJd=null,this.jqe.xld())}hug(){this.zJd=null}vld(K,pa){this.jqe&&this.jqe.vld(K,pa)}}Object(f.a)(Ak,"OutboundMonitor",null,[]);class Ri{constructor(K,pa){this.u3e=K;this.LHk=pa}create(K,pa,Ta,jb,bc,Ic,Uc){return new Ak(this.u3e,K,pa,Ta,this.LHk,jb,bc,Ic,Uc)}}Object(f.a)(Ri,"OutboundMonitorFactory",null,[]);var wi=d(54);class Bk{constructor(K){this.ukb=K}get mno(){return this.ukb}mb(K){return!!this.ukb&&
K in this.ukb}get p4i(){return this.mb(Bk.S0d)&&this.mb(Bk.SZb)&&this.mb(Bk.LCg)}get revisionId(){if(this.mb(Bk.SZb))return wi.a.Cf(this.ukb[Bk.SZb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");}get Ive(){if(this.mb(Bk.SZb))return this.ukb[Bk.SZb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get mqj(){if(this.mb(Bk.S0d))return Number.parseInvariant(this.ukb[Bk.S0d]);throw Error.create("Unable to parse DurationKey key from dictionary into int");
}get lTj(){if(this.mb(Bk.SZb))return Boolean.parse(this.ukb[Bk.LCg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get Zbb(){if(this.mb(Bk.Wcg))return Number.parseInvariant(this.ukb[Bk.Wcg]);throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static TFl(K){return new Bk(K)}static YFl(K,pa,Ta,jb){const bc={};bc[Bk.S0d]=K.toString();bc[Bk.SZb]=pa.toString();bc[Bk.LCg]=Ta.toString();bc[Bk.Wcg]=jb.toString();return new Bk(bc)}}
Bk.SZb="RevisionID";Bk.S0d="Duration";Bk.LCg="ShouldSample";Bk.Wcg="NumSequentialFailures";Object(f.a)(Bk,"ReplicationNotificationMessage",null,[1126]);class Ph{constructor(K,pa,Ta,jb,bc,Ic,Uc){this.xt=this.ji=0;this.wGb=this.nRc=null;this.jKe=[];this.FAh=null;this.fBd={};this.tSa=0;this.d$b=K;this.yMk=pa;this.i2a=Ta;this.dGb=jb;this.nFh=bc;this.fkb=null;this.fBd.TypingStartStage=null;this.fBd.ReplicationStartStage="TypingStartStage";this.fBd.ReplicationEndStage="ReplicationStartStage";this.YJh=1<
this.NNb;this.Sbf=Ic;this.E6e=Uc}get NNb(){return this.dGb()}gtd(){this.Hof("TypingStartStage")&&(this.Kqg("TypingStartStage"),ua.ULS.shipAssertTag(8257931,324,!this.wGb&&!this.xt,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),this.ji=this.i2a(),this.nRc=this.d$b.create(),this.JXj(this.nRc,Kh.Lqp))}xld(){if(this.Hof("ReplicationStartStage")){this.Kqg("ReplicationStartStage");ua.ULS.shipAssertTag(8257932,324,!!this.nRc,"TypingStart not called");if(this.nRc){const K=this.pki(this.nRc,
this.fkb);this.Sbf.cve(K)}this.wGb=this.d$b.create();this.JXj(this.wGb,Kh.t6n)}}vld(K,pa){this.Hof("ReplicationEndStage")&&(this.Kqg("ReplicationEndStage"),this.xt=this.i2a(),this.tSa=pa,ua.ULS.shipAssertTag(8257933,324,!!this.wGb,"ReplicationStart not called"),this.wGb&&(ua.ULS.shipAssertTag(8193425,324,!!this.wGb,"ReplicationStart not called"),pa=this.pki(this.wGb,K),this.E6e.cve(pa)),ua.ULS.shipAssertTag(8257934,324,!!this.ji,"StartTime not set. No message sent to other editors."),this.ji&&(K=
Bk.YFl(this.xt-this.ji,K,this.nFh,this.tSa),this.yMk(K.mno)))}Hof(K){if(this.fBd[K]===this.FAh)return!0;ua.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.DUk()});return!1}DUk(){const K=new Sys.StringBuilder;K.append("Actual Phase:");for(let pa=0;pa<this.jKe.length;pa++)K.append(" "+this.jKe[pa]);return K.toString()}Kqg(K){this.jKe.push(K);this.FAh=K}JXj(K,pa){this.YJh&&K.start(pa)}pki(K,pa){if(!this.YJh)return-1;const Ta={};Ta[Fe.VFe]=te(this.NNb);pa=Object.assign(new vh,
{P:Ta,FC:this.tSa,CFC:0,ID:pa?pa.toString():"",CD:0,UC:this.NNb,RCL:0});return K.end(this.nFh,pa)}}Object(f.a)(Ph,"OutboundOperation",null,[1128]);class po{constructor(K,pa,Ta){this.d$b=K;this.i2a=pa;this.dGb=Ta}create(K,pa,Ta,jb){return new Ph(this.d$b,K,this.i2a,this.dGb,pa,Ta,jb)}}Object(f.a)(po,"OutboundOperationFactory",null,[1105]);class Lh{constructor(K,pa){this.rch=this._name=this.l6=null;this.Vd=K;this.BFa=pa}start(K,pa=null){this.l6=this.Vd.Vf("UserAction",K);this._name=K;this.rch=pa}end(K,
pa){let Ta=-1;K&&(Ta=this.l6.Fi,pa.D=Ta,pa.CN=this.rch,pa.CD+=Ta,this.BFa.track(pa,this._name));return Ta}}Object(f.a)(Lh,"PerfTracker",null,[1125]);class qa{constructor(K,pa){this.Vd=K;this.BFa=pa}create(){return new Lh(this.Vd,this.BFa)}}Object(f.a)(qa,"PerfTrackerFactory",null,[1104]);class Jb{constructor(K,pa,Ta){this.aNc=null;this.KHk=K;this.Lmh=pa;this.dBh=Ta}init(K,pa,Ta,jb,bc,Ic,Uc){pa=this.dBh.create(pa/100);Ta=this.dBh.create(Ta/100);this.aNc=this.KHk.create(Object(O.a)(pa,pa.p0b,"shouldBeInSample"),
Object(O.a)(Ta,Ta.p0b,"shouldBeInSample"),K,jb,bc,Ic,Uc)}gtd(){this.aNc.gtd()}xld(){this.aNc.xld()}hug(){this.aNc.hug()}vld(K,pa){this.aNc.vld(K,pa)}V3m(K,pa,Ta=null){this.Lmh.KDo(K,pa,Ta)}iwc(K){K=Bk.TFl(K);this.Lmh.iwc(K);za.a.instance.xA(K.revisionId+"Start")}Rjp(K,pa,Ta){N.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.HYd(K,pa,Ta))}Qjp(K,pa,Ta){N.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.HYd(K,pa,Ta))}HYd(K,pa,Ta){const jb=
{};jb.PhaseName=K;jb.ThresholdValue=pa;jb.ActualValue=Ta;return jb}}Object(f.a)(Jb,"ReplicationTelemetryManager",null,[]);var Rb=d(1022);class Tc extends Rb.a{constructor(K,pa){super(K,pa);this.Jk=this.NNd=0}ODa(K){this.NNd+=K;this.Jk++}getValue(){return this.Jk?this.NNd/this.Jk:0}g_a(){this.Jk=this.NNd=0}}Object(f.a)(Tc,"AverageMetric",Rb.a,[]);class vd extends Rb.a{constructor(K,pa){super(K,pa);this.w$=0}ODa(K){K>this.w$&&(this.w$=K)}getValue(){return this.w$}g_a(){this.w$=0}}Object(f.a)(vd,"MaxMetric",
Rb.a,[]);var Td=d(2013);class Ed extends Rb.a{constructor(K,pa,Ta=100){super(K,pa);this.YGd=this.B9b=this.Uac=0;this.ALd=Ta;this.v7e=new Td.a(this.ALd)}ODa(K){if(this.B9b===this.ALd){const pa=this.v7e.dequeue();this.Uac-=pa;this.B9b--}this.v7e.enqueue(K);this.Uac+=K;this.B9b++;K=this.Uac/this.B9b;K>this.YGd&&this.B9b===this.ALd&&(this.YGd=K)}getValue(){return this.YGd}g_a(){this.YGd=0;this.v7e=new Td.a(this.ALd);this.B9b=this.Uac=0}}Object(f.a)(Ed,"MaxRollingAverageMetric",Rb.a,[]);class lf extends Rb.a{constructor(K,
pa){super(K,pa);this.Jk=0}ODa(){this.Jk++}getValue(){return this.Jk}g_a(){this.Jk=0}}Object(f.a)(lf,"CounterMetric",Rb.a,[]);class Bf{constructor(K,pa){this.Tbc=pa;this.ALe=new Tc(K+"-AverageValue","Milliseconds");this.L0e=new vd(K+"-MaxValue","Milliseconds");this.Q0e=new Ed(K+"-MaxRollingAverageValue","Milliseconds");this.OOe=new lf(K+"-NumberOfEvents","Count");this.cya=new ub.a(K+"-SlowPercentileAtValue","Percentile",m.AFrameworkApplication.K.oN("CoAuthLatencySlowTargetValue",3E3),m.AFrameworkApplication.K.oN("CoAuthLatencySlowThresholdPercentile",
95),this.Tbc);this.A4e=new ub.a(K+"-BrokenSlowPercentileAtValue","Percentile",m.AFrameworkApplication.K.oN("CoAuthLatencyBrokenSlowTargetValue",5E3),m.AFrameworkApplication.K.oN("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.Tbc)}n4(K){this.ALe.ODa(K);this.L0e.ODa(K);this.Q0e.ODa(K);this.OOe.ODa(K);this.cya.ODa(K);this.A4e.ODa(K)}Gte(){this.ALe.JZa();this.L0e.JZa();this.Q0e.JZa();this.OOe.JZa();this.cya.JZa();this.A4e.JZa();this.ALe.g_a();this.L0e.g_a();this.Q0e.g_a();this.OOe.g_a();this.cya.g_a();
this.A4e.g_a()}}Object(f.a)(Bf,"ReplicationLatencyMetrics",null,[]);class vf{constructor(){this.I_e=new Qb.a}Gzj(K,pa,Ta){if(!(0>pa)){if(!({value:jb}=this.I_e.Dc(K,jb)).returnValue){var jb=new Bf(K,Ta);this.I_e.Z(K,jb)}jb.n4(pa)}}Gte(){for(const K of this.I_e.values)K.Gte()}}Object(f.a)(vf,"ReplicationTelemetryMetricsManager",null,[1103]);class fd{Gzj(){}Gte(){}}Object(f.a)(fd,"ReplicationTelemetryMetricsManagerStub",null,[1103]);class Wc{constructor(K,pa,Ta,jb,bc,Ic,Uc){this.w5a=this.$Od=0;this.SEk=
K;this.E4e=Ta;this.bIh=jb;this.e$g=bc;this.hbc=pa;this.TEk=Ic;this.Tbc=Uc}cve(K){this.SEk.Gzj(this.E4e,K,this.Tbc);K>this.bIh&&this.hbc.ujp(this.E4e,this.bIh,K);this.$Od+=K;this.w5a++;this.$Od/this.w5a>this.e$g&&this.w5a>this.TEk&&this.hbc.nbl(this.E4e,this.e$g,this.$Od/this.w5a)}}Object(f.a)(Wc,"TimeSpanVerifier",null,[1124]);class sg{constructor(K,pa){this.aLk=K;this.hbc=pa}create(K,pa,Ta,jb,bc){return new Wc(this.aLk,this.hbc,K,pa,Ta,jb,bc)}}Object(f.a)(sg,"TimeSpanVerifierFactory",null,[1101]);
class Jf extends Sys.EventArgs{constructor(K,pa,Ta){super();this.fFj=K;this.ZCe=pa;this.actualValue=Ta}}Object(f.a)(Jf,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class Qk{constructor(){this.sa=new V.a}ujp(K,pa,Ta){this.sa.raiseEvent("TSVTE",new Jf(K,pa,Ta))}nbl(K,pa,Ta){this.sa.raiseEvent("TSVATE",new Jf(K,pa,Ta))}J1k(K){this.sa.addHandler("TSVTE",K)}s0k(K){this.sa.addHandler("TSVATE",K)}}Object(f.a)(Qk,"TimeSpanVerifierNotifier",null,[1102]);var $e=d(1448);class Ei{constructor(){this.W=this.Ga=
null}get name(){return"Box4.ReplicationTelemetry"}wc(K){this.Ga=K.resolve("Common.IAppSettingsManager");this.W=K;if(this.Ga.$("Box4ReplicationTelemetryIsEnabled")){K.ia("ReplicationTelemetry.IPerfTrackerFactory",()=>new qa(Od.StaticActiveAppFrame.za().hs,Qa.a.UG(20,1,new ya.a))).ha();K.ia("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new Qk).ha();this.Ga.$("Box4ReplicationTelemetryMetricsIsEnabled")?K.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new vf).ha():K.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",
()=>new fd).ha();K.ia("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new sg(K.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),K.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).ha();K.ia("ReplicationTelemetry.OutboundOperationFactory",()=>new po(K.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Ei.Mxi)).ha();K.ia("ReplicationTelemetry.OutboundMonitorFactory",()=>new Ri(K.resolve("ReplicationTelemetry.OutboundOperationFactory"),K.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).ha();
K.ia("ReplicationTelemetry.InboundOperationFactory",()=>new pg(K.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Ei.Mxi)).ha();var pa=new ai(K.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),K.resolve("ReplicationTelemetry.InboundOperationFactory"),K.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),Ta=this.Ga.$("ComponentStateLoggingPackageIsEnabled")?this.W.Qa("Common.IComponentStateLogManager"):null;K.ia("ReplicationTelemetry.IInboundMonitor",
()=>pa.create(this.Ga.ic("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Ga.ic("Box4ReplicationTelemetryInboundOperationAverageThreshold",0),this.Ga.ic("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Ga.ic("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),Ta)).ha();K.ia("Common.IRandomSamplerFactory",()=>new od).ha();K.ia("ReplicationTelemetry.ReplicationTelemetryManager",()=>new Jb(K.resolve("ReplicationTelemetry.OutboundMonitorFactory"),K.resolve("ReplicationTelemetry.IInboundMonitor"),
K.resolve("Common.IRandomSamplerFactory"))).ha();K.ia("ReplicationTelemetry.EventForwarderFactory",()=>new Tb($e.a.instance,K.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),K.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Ga.$("Box4ReplicationTelemetryIsEnabled")){var K=this.Ga.ic("Box4ReplicationTelemetrySamplePercent",0),pa=this.Ga.ic("Box4ReplicationTelemetryPhaseSamplePercent",0),Ta=this.Ga.ic("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),jb=this.Ga.ic("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",
0),bc=this.Ga.ic("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",0),Ic=this.Ga.ic("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Uc=this;this.W.Qa("Box4.Presence.IRtcProxyProvider").execute(pd=>{pd.gD().continueWith(()=>{const Fd=pd.gD().result,le=Uc.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");le.init(Fd,K,pa,Ta,jb,bc,Ic);Uc.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(Fd,le);if(Uc.Ga.$("LogSteppedInboundFrameIsEnabled")){const jf=
Rd.a.$p(Uc.W.Qa("Common.ICpuMeterProvider"));jf.continueWith(()=>{const of=Uc.W.resolve("ReplicationTelemetry.IInboundMonitor");var tf=new Ea.a(()=>!0);tf=Qa.a.UG(19,1,tf);of.initialize(tf);const Se=jf.result.Sq.task;Se.continueWith(()=>{Se.result.cRd(0,()=>of.d$e,ye=>{of.BWn(ye)});Se.result.cRd(1,ye=>of.z3o(ye),()=>{of.AWn()})})})}ua.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var kd=this;m.AFrameworkApplication.aJ(()=>{kd.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").Gte()})}}dispose(){}static Mxi(){const K=
Ld.StaticTheCoauthManager.ud();return K?K.fji:0}}Object(f.a)(Ei,"ReplicationTelemetryPackage",null,[0,1]);var ve=d(1025),Ad=d(11),re=d(135),ea=d(3),eb=d(88),Ob=d(67),Zb=d(17),mc=d(25),Yc=d(172),ld=d(8),oe=d(2192);class Vd{static get kh(){return a.a.az(Vd.Mn,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Vd.Mn="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(f.a)(Vd,"InsertSymbolsDialogHtml",null,[]);class ce extends oe.a{constructor(K,pa,Ta){super();this.J8b=this.qTa=this.rlb=null;this.AWe=0;this.man=jb=>{1===jb?(this.Kfg("symbol_d_"+ce.CKc),this.Yb.NN(this.kN,!0),this.Yb.gu().Mk.mA(this.oJ),this.oJ.focus()):this.hide()};this.OZj=jb=>{if(jb.target!==this.J8b){const bc=this.Yb.gu();bc&&bc.Mk&&(bc.Mk.mA(jb.target),this.J8b=jb.target)}this.v2n(jb.target.id)};this.Ffp=jb=>{const bc=jb.Nf;if("a"!==bc.tagName.toLowerCase())return!1;jb.eventName===P.a.$C&&
this.Kfg(bc.id);this.Yb.NN(this.kN,!0);this.Yb.gu().Mk.mA(bc);bc.focus();return!0};this.Hfp=jb=>{var bc=jb.Nf;if("a"!==bc.tagName.toLowerCase())return!1;const Ic=parseInt(bc.id.substr(bc.id.lastIndexOf("_")+1));if(jb.Kb.ctrlKey||jb.Kb.altKey||jb.Kb.keyCode>=mj.a.S3b&&jb.Kb.keyCode<=mj.a.T3b)return!1;if(jb.eventName===P.a.Ti){jb=jb.Kb.keyCode;let Uc=-1;jb===Sys.UI.Key.enter?(this.Kfg(bc.id),this.Yb.NN(this.kN,!0),this.Yb.gu().Mk.mA(bc),bc.focus()):jb===Sys.UI.Key.up?Uc=Ic-15:jb===Sys.UI.Key.down?Uc=
Ic+15:jb===Sys.UI.Key.left?Uc=m.AFrameworkApplication.isRtl?Ic+1:Ic-1:jb===Sys.UI.Key.right&&(Uc=m.AFrameworkApplication.isRtl?Ic-1:Ic+1);0<=Uc&&(bc=this.FOf("symbol_d_"+Uc))&&bc.focus()}return!0};this.ga=K;this.Yb=pa;this.slb=Ta;this.Pe(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Pe(0,CommonUIStrings.l_DialogClose);this.Lda=!1;this.kh=Vd.kh;this.Qg="InsertSymbolsDialog"}dispose(){0<ce.qbf&&ua.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.AWe,ce.qbf);ce.Qeh++;ua.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",ce.Qeh);this.ga=this.slb=null;super.dispose()}L_a(){this.pi(Box4Intl.Box4Strings.L_SymbolSingle,this.man,null);this.AWe=0;ce.Weh++;ua.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",ce.Weh);const K=this.FOf("symbol_d_"+ce.CKc);K&&K.focus()}hide(){var K=document.getElementById("symbolsContainer");if(K&&(K=K.getElementsByTagName("a")))for(let pa=0;pa<K.length;pa++)T.a.removeHandler(K[pa],
P.a.focus,this.OZj);super.hide()}get jub(){return ce.GKc}set jub(K){ce.GKc=K}get dub(){return ce.wKc}set dub(K){ce.wKc=K}Zba(){super.Zba();var K=document.getElementById("symbolsContainer");if(K&&(K.innerHTML=this.slb.Zfl(),K=K.getElementsByTagName("a")))for(let pa=0;pa<K.length;pa++)T.a.addHandler(K[pa],P.a.focus,this.OZj)}cra(){const K=document.getElementById("symbolsContainer");K&&(this.rlb||(this.rlb=this.Ffp,this.Cr.nb(P.a.click,K,this.rlb),this.Cr.nb(P.a.$C,K,this.rlb)),this.qTa||(this.qTa=this.Hfp,
this.ne.nb(P.a.Ti,K,this.qTa),this.ne.nb(P.a.jv,K,this.qTa),this.ne.nb(P.a.oi,K,this.qTa)));super.cra()}Aob(){const K=document.getElementById("symbolsContainer");K&&(this.rlb&&(this.Cr.xc(P.a.click,K,this.rlb),this.Cr.xc(P.a.$C,K,this.rlb),this.rlb=null),this.qTa&&(this.ne.xc(P.a.Ti,K,this.qTa),this.ne.xc(P.a.jv,K,this.qTa),this.ne.xc(P.a.oi,K,this.qTa),this.qTa=null));super.Aob()}get LSf(){return!0}v2n(K){this.XPj("symbol_d_"+ce.CKc,!1);ce.CKc=parseInt(K.substr(K.lastIndexOf("_")+1));this.XPj(K,
!0);if(K=document.getElementById("SymbolNameValueLabel")){const pa=this.I9d(ce.CKc);K.innerText=pa.altText}}I9d(K){const pa=this.slb.XBe.bHg.value,Ta=Dg.a(pa);return pa[Ta[K]]}Kfg(K){this.AWe++;ce.qbf++;K=parseInt(K.substr(K.lastIndexOf("_")+1));const pa=this.I9d(K),Ta={};Ta.SourceControlId="symbol_"+K+"_"+pa.VBe;this.ga.Pb(ea.a.zsb,2,Ta);ua.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",K)}FOf(K){const pa=document.getElementById("symbolsContainer");return pa?pa.querySelector("#"+
K):null}XPj(K,pa){if(K=this.FOf(K))pa?(K.setAttribute("selected","true"),K.setAttribute("aria-selected","true"),K.tabIndex=0):(K.removeAttribute("selected"),K.setAttribute("aria-selected","false"),K.tabIndex=-1)}}ce.CKc=0;ce.GKc=null;ce.wKc=null;ce.Weh=0;ce.Qeh=0;ce.qbf=0;Object(f.a)(ce,"InsertSymbolsDialog",oe.a,[]);class pe{constructor(K,pa,Ta,jb,bc,Ic,Uc){this.zMm=()=>this.slb.Pgl();this.uxj=(kd,pd,Fd,le,jf)=>{if(1===Fd)return 32;kd=this.slb.bsj(jf);kd=String.format(this.slb.Gfp,kd.character);
jf[ve.a.InnerHTML]=kd;jf[ve.a.On]=!1;return 32};this.bXa=(kd,pd,Fd,le,jf)=>{if(({me:kd,selected:Fd,bXa:Se}=this.CYc(pd,Fd)).returnValue)return Se;var of=Zb.SelectionEditor.mf(Fd);let tf=!0;Fd=8;var Se=this.Pc.Mc(15);Se.Ab(kd.jd);of||(Fd=this.ga.lg(pd,ea.a.Wra,2,!0,le,null),pd=32===Fd,ua.ULS.shipAssertTag(6407387,348,pd,"DeleteForReplace did not succeed. Response is {0}",Fd),tf=pd);tf&&(pd=kd.lb.Og,of=Zb.SelectionEditor.mf(pd),ua.ULS.shipAssertTag(6407388,348,of,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
pd.contextId),Fd=8,of&&(Fd=this.ga.lg(pd,ea.a.zsb,2,!1,le,jf),ua.ULS.shipAssertTag(6407389,348,32===Fd,"Insertion at IP context did not succeed. Response is {0}",Fd),32===Fd&&Gg.FocusManager.instance().Bg(kd.xL)));Se.dispose();return Fd};this.lan=(kd,pd,Fd,le,jf)=>{if(1===Fd)return 32;if(Zb.SelectionEditor.P$a(pd))return 2;kd=this.slb.bsj(jf);le.Gt=kd.index;le=this.Zc.jg(pd.node);Fd=le.zb(11);ua.ULS.shipAssertTag(6379466,324,Fd,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",
re.a[pd.node.type]);Fd=this.Pc.Mc(15);Fd.qu(le);pe.rg.Ne(pd,kd.character,!0,!1);pd=mc.SelectionFactory.se(le.currentNode,pd.cpBegin+1);this.hb.Ic(pd);Fd.dispose();return 32};this.OXb=(kd,pd,Fd,le,jf)=>{if(1===Fd)return 32;jf.MenuItems=this.pPk.value;return 32};this.PZj=(kd,pd,Fd)=>{({bXa:kd}=this.CYc(pd,Fd));return kd};this.CUj=(kd,pd,Fd)=>{2===Fd&&(new ce(this.ga,Gg.FocusManager.instance(),Ca.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).L_a();return 32};this.Nog=()=>32;this.ga=K;this.Zc=
pa;this.pPk=new Ec.a(this.zMm);this.Pc=Ta;this.slb=jb;this.ul=bc;this.hb=Ic;this.Xn=Uc}Wb(){this.ga.fb(ea.a.Nog,Ad.a.application,this.Nog,96);this.ga.ra(ea.a.OXb,Ad.a.view,this.OXb);this.ga.ra(ea.a.WBe,Ad.a.view,this.PZj);this.ga.ra(ea.a.Nse,Ad.a.view,this.uxj);this.ga.ra(ea.a.zsb,Ad.a.view,this.bXa);this.ga.ra(ea.a.OXb,Ad.a.Xc,this.OXb);this.ga.ra(ea.a.WBe,Ad.a.Xc,this.PZj);this.ga.ra(ea.a.Nse,Ad.a.Xc,this.uxj);this.ga.ra(ea.a.zsb,Ad.a.Xc,this.lan);this.ga.Rc(ea.a.OXb,1124);this.ga.Rc(ea.a.WBe,1036);
this.ga.Rc(ea.a.Nse,1124);this.ga.Rc(ea.a.zsb,1036);m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&(this.ga.ra(ea.a.e8c,Ad.a.view,this.CUj),this.ga.ra(ea.a.e8c,Ad.a.Xc,this.CUj),this.ga.Rc(ea.a.e8c,1124))}CYc(K,pa){let Ta,jb=null;K.view.te&&(jb=K.view);Ta=null;if(!jb||!jb.lb)return N.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",K.toString()),{returnValue:!0,me:jb,selected:Ta,
bXa:8};Ta=jb.lb.Og;if(!Ta)return{returnValue:!0,me:jb,selected:Ta,bXa:2};if(this.ul.Q2(Ta)||this.ul.Vla(Ta))return{returnValue:!0,me:jb,selected:Ta,bXa:8};if(jb.lb.gb.QL||this.Xn&&this.Xn.instance&&this.Xn.instance.DX(Ta)||Zb.SelectionEditor.P$a(K.Hk))return{returnValue:!0,me:jb,selected:Ta,bXa:2};if(Object(Yc.a)().pFa(ld.ParagraphReader.BX,Ta))return K=8,pe.Ec.$b(eb.a.Te,{["Reason"]:Ob.a.WQ}),{returnValue:!0,me:jb,selected:Ta,bXa:K};K=32;return 1===pa?{returnValue:!0,me:jb,selected:Ta,bXa:K}:{returnValue:!1,
me:jb,selected:Ta,bXa:K}}static get rg(){return pe.Qd||(pe.Qd=Ca.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set rg(K){pe.Qd=K}static get Ec(){return Je.a.instance}}pe.Qd=null;Object(f.a)(pe,"SymbolsActor",null,[986]);class Sd{constructor(K,pa){this.VBe=K;this.altText=pa}}Object(f.a)(Sd,"Symbol",null,[]);class Oe{constructor(){this.W$e=null;this.lHh=new Ec.a(Oe.Huf)}get bHg(){return this.lHh}eBi(K){this.W$e||(this.W$e=Dg.a(this.lHh.value));return Array.indexOf(this.W$e,K)}static Huf(){const K=
{};K["\u2022"]=new Sd("\u2022",Box4Intl.Box4Strings.L_Bullet);K["\u20ac"]=new Sd("\u20ac",Box4Intl.Box4Strings.L_EuroSign);K["\u00a3"]=new Sd("\u00a3",Box4Intl.Box4Strings.L_PoundSign);K["\u00a5"]=new Sd("\u00a5",Box4Intl.Box4Strings.L_YenSign);K["\u00a9"]=new Sd("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);K["\u00ae"]=new Sd("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);K["\u2122"]=new Sd("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);K["\u00b1"]=new Sd("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);
K["\u2260"]=new Sd("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);K["\u2264"]=new Sd("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);K["\u2265"]=new Sd("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);K["\u00f7"]=new Sd("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);K["\u00d7"]=new Sd("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);K["\u221e"]=new Sd("\u221e",Box4Intl.Box4Strings.L_Infinity);K["\u00b5"]=new Sd("\u00b5",Box4Intl.Box4Strings.L_MicroSign);K["\u03b1"]=new Sd("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);
K["\u03b2"]=new Sd("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);K["\u03c0"]=new Sd("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);K["\u03a9"]=new Sd("\u03a9",Box4Intl.Box4Strings.L_OhmSign);K["\u03a3"]=new Sd("\u03a3",Box4Intl.Box4Strings.L_NArySummation);K["\u00b0"]=new Sd("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);K["\u0394"]=new Sd("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);K["\u263a"]=new Sd("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);K["\u2665"]=new Sd("\u2665",
Box4Intl.Box4Strings.L_BlackHeartSuit);K["\u20b9"]=new Sd("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);K["\u00bf"]=new Sd("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);K["\u00a1"]=new Sd("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);K["\u2014"]=new Sd("\u2014",Box4Intl.Box4Strings.L_EmDash);K["\u2026"]=new Sd("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);K["\u00c0"]=new Sd("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);K["\u00c1"]=new Sd("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);
K["\u00c2"]=new Sd("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);K["\u00c3"]=new Sd("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);K["\u00c4"]=new Sd("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);K["\u00c5"]=new Sd("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);K["\u00c6"]=new Sd("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);K["\u00c7"]=new Sd("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);K["\u00c8"]=
new Sd("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);K["\u00c9"]=new Sd("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);K["\u00ca"]=new Sd("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);K["\u00cb"]=new Sd("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);K["\u00cc"]=new Sd("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);K["\u00cd"]=new Sd("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);K["\u00ce"]=new Sd("\u00ce",
Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);K["\u00cf"]=new Sd("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);K["\u00d1"]=new Sd("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);K["\u00d2"]=new Sd("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);K["\u00d3"]=new Sd("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);K["\u00d4"]=new Sd("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);K["\u00d5"]=new Sd("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);
K["\u00d6"]=new Sd("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);K["\u00d9"]=new Sd("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);K["\u00da"]=new Sd("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);K["\u00db"]=new Sd("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);K["\u00dc"]=new Sd("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);K["\u00df"]=new Sd("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);K["\u00e0"]=
new Sd("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);K["\u00e1"]=new Sd("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);K["\u00e2"]=new Sd("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);K["\u00e3"]=new Sd("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);K["\u00e4"]=new Sd("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);K["\u00e5"]=new Sd("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);K["\u00e6"]=new Sd("\u00e6",
Box4Intl.Box4Strings.L_LatinSmallLetterAe);K["\u00e7"]=new Sd("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);K["\u00e8"]=new Sd("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);K["\u00e9"]=new Sd("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);K["\u00ea"]=new Sd("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);K["\u00eb"]=new Sd("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);K["\u00ec"]=new Sd("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);
K["\u00ed"]=new Sd("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);K["\u00ee"]=new Sd("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);K["\u00ef"]=new Sd("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);K["\u00f1"]=new Sd("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);K["\u00f2"]=new Sd("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);K["\u00f3"]=new Sd("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);K["\u00f4"]=new Sd("\u00f4",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);K["\u00f5"]=new Sd("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);K["\u00f6"]=new Sd("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);K["\u00f9"]=new Sd("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);K["\u00fa"]=new Sd("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);K["\u00fb"]=new Sd("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);K["\u00fc"]=new Sd("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);
K["\u00ff"]=new Sd("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);K["\u011e"]=new Sd("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);K["\u011f"]=new Sd("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);K["\u0130"]=new Sd("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);K["\u0131"]=new Sd("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);K["\u0152"]=new Sd("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);K["\u0153"]=new Sd("\u0153",
Box4Intl.Box4Strings.L_LatinSmallLigatureOe);K["\u015e"]=new Sd("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);K["\u015f"]=new Sd("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);K["\u0178"]=new Sd("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return K}}Object(f.a)(Oe,"SymbolsLoader",null,[985]);var ef=d(439),Nd=d(366),wb=d(218),ki=d(683),cj=d(1530),Pd=d(240),Me=d(101);class Eg{constructor(K){this.XBe=K}get Gfp(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}bsj(K){K=
K.SourceControlId.split("_");const pa={};2===K.length?(pa.character=K[1],pa.index=this.XBe.eBi(pa.character)):(pa.character=K[2],pa.index=parseInt(K[1]));return pa}Pgl(){return this.nIi()}build(){return this.AMm()}Zfl(){const K=new Sys.StringBuilder;K.append('<table class="moreSymbolsTable">');const pa=this.XBe.bHg.value,Ta=Dg.a(pa);let jb=0;for(;jb<Ta.length;){jb%15||K.append('<tr role="presentation">');const bc=pa[Ta[jb]];K.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+jb,Ia.a.e0(bc.VBe),Ia.a.e0(bc.altText)));jb++;jb%15&&jb!==Ta.length||K.append("</tr>")}K.append("</table>");return K.toString()}AMm(){const K=this.nIi();return Pd.o(K)}nIi(){const K=Object.assign(new ef.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});K.MenuSectionList.push(this.CZk());m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&K.MenuSectionList.push(this.IXk());return K}IXk(){const K=Object.assign(new Nd.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),pa=Object.assign(new wb.a,{Id:"btnMoreSymbols",Command:ea.a.e8c.toString(),LabelText:Ia.a.Hf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:Ia.a.Hf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:m.AFrameworkApplication.Ys,Image16by16Class:Me.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});K.ControlList.push(pa);return K}CZk(){const K=Object.assign(new Nd.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
pa=Object.assign(new ki.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Ta=this.XBe.bHg.value,jb=Dg.a(Ta),bc=Math.min(25,jb.length);for(let Uc=0;Uc<bc;Uc++){var Ic=Ta[jb[Uc]];Ic=Object.assign(new cj.a,{Id:String.format("{0}{1}_{2}","symbol_",Uc,Ic.VBe),Character:Ic.VBe,Command:ea.a.zsb.toString(),QueryCommand:ea.a.Nse.toString(),Alt:Ia.a.Hf(Ic.altText)});pa.GalleryItems.push(Ic)}K.ControlList.push(pa);
return K}}Object(f.a)(Eg,"SymbolsUiBuilder",null,[984]);var Hj=d(52),Ui=d(256),Wj=d(590),dj=d(362);class kk{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){m.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&this.W.resolve("Box4.Symbols.ISymbolsActor").Wb()}dispose(){}wc(K){this.W=K;this.W.register(Oe,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ha();this.W.ia("Box4.Symbols.SymbolsUiBuilder",()=>new Eg(this.W.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").ha();
this.W.ia("Box4.Symbols.SymbolsActor",()=>new pe(m.AFrameworkApplication.va,new Wj.a,new dj.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),Ui.a.instance,Hj.a.instance,this.W.Qa("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").ha()}static main(){H.a.instance.Jc(new kk)}}Object(f.a)(kk,"Box4SymbolsPackage",null,[0,1]);var Gb=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",
Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},Pc=d(1710),xd=d(1663),He=d(1645),af=d(2082),mf=d(249),dg=d(438);class $f{constructor(){this.XPa=null}wc(K){this.container=K}init(){this.XPa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.XPa&&this.XPa.dispose()}}Object(f.a)($f,"ALiveBooksAccessibilityCheckPackageManager",null,[0,
1]);class ih{get dAl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get eAl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get fAl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get p6n(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get ytc(){return CommonUIStrings.l_AccCheckerPaneTitle}get d$n(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(f.a)(ih,"AccessibilityCheckStringsProvider",null,[1364]);
class bi{constructor(){this.EIj=this.contentId=null}}Object(f.a)(bi,"ResultIds",null,[]);class Hg{constructor(K,pa){this._element=null;this.Pg=pa;this.ne=K}get element(){this._element||(this._element=this.gFl(),this.eB());return this._element}uBg(K){this._element=K}dispose(){this.element&&(this.fda(),this.uBg(null))}eB(){this.Pg&&this.ne?(this.Pg.nb(P.a.click,this.element,Object(O.a)(this,this.onClick,"onClick")),this.ne.nb(P.a.Ti,this.element,Object(O.a)(this,this.LI,"onKeyPress"))):ua.ULS.shipAssertTag(19789026,
334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}fda(){this.Pg&&this.ne&&(this.Pg.xc(P.a.click,this.element,Object(O.a)(this,this.onClick,"onClick")),this.ne.xc(P.a.Ti,this.element,Object(O.a)(this,this.LI,"onKeyPress")))}onClick(){this.Dlj();return!0}LI(K){return this.zln(K.Kb.keyCode)?(this.Dlj(),!0):!1}zln(K){return K===mj.a.oud||K===mj.a.Mu}}Object(f.a)(Hg,"AInteractivePaneElement",null,[1395,13]);var Og=d(483),
zd=d(60);class Zd extends Hg{constructor(K,pa,Ta){super(K,pa);this.D2e=Ta}hide(){this.element.removeAttribute(Yg.a.Ph);Yg.a.Ls(this.element,Yg.a.JB,Yg.a.hq);this.element.style.display="none"}show(){Yg.a.Ls(this.element,Yg.a.JB,Yg.a.PO);Yg.a.Ls(this.element,Yg.a.Ph,Yg.a.Djf);this.element.style.display="block"}gFl(){const K=Og.b("div",this.Qhj,"AccCheckerNotification");Yg.a.Ls(K,Yg.a.AUh,Yg.a.hq);Yg.a.Ls(K,Yg.a.Kja,this.Fcg);K.tabIndex=0;const pa=Og.b("span",this.Phj,"AccCheckerNotificationIcon");var Ta=
Me.createClusteredImage(16,16,"Info_16x16x32","",!0,"");pa.appendChild(Ta);Ta=Og.b("span",this.Fcg,"AccCheckerNotificationText");zd.a.Ox(Ta,this.Rhj);K.appendChild(pa);K.appendChild(Ta);return K}Dlj(){this.D2e()}}Object(f.a)(Zd,"APopupNotification",Hg,[1421,1395,13]);class df extends Zd{constructor(K,pa,Ta,jb){super(K,pa,Ta);this.Dya=jb}get Qhj(){return"AccCheckerOutOfSyncNotificationId"}get Phj(){return"AccCheckerOutOfSyncNotificationIconId"}get Fcg(){return"AccCheckerOutOfSyncNotificationTextId"}get Rhj(){return this.Dya.p6n}}
Object(f.a)(df,"OutOfSyncNotification",Zd,[]);class An extends Zd{constructor(K,pa,Ta,jb){super(K,pa,Ta);this.Dya=jb}get Qhj(){return"AccCheckerPartialResultNotificationId"}get Phj(){return"AccCheckerPartialResultNotificationIconId"}get Fcg(){return"AccCheckerPartialResultNotificationTextId"}get Rhj(){return this.Dya.d$n}}Object(f.a)(An,"PartialResultNotification",Zd,[]);var Fg=d(198),ym=d(35),dm=d(167);class zm{constructor(K,pa,Ta,jb=null,bc=null,Ic=null,Uc=null){this.yCh=this.zO=this.ne=this.XPa=
null;this.dua=jb;this.Pg=K;this.Yb=pa;this.aq=Ta;this.Dya=Uc||new ih;this.s3e=bc||new df(this.dua,this.Pg,Object(O.a)(this,this.UTl,"dimissOutOfSyncNotification"),this.Dya);this.h4e=Ic||new An(this.dua,this.Pg,Object(O.a)(this,this.VTl,"dimissPartialResultNotification"),this.Dya)}show(){}hide(){}get dua(){return this.ne||(this.ne=m.AFrameworkApplication.ua.VE)}set dua(K){this.ne=K}X9h(){}fta(){}dispose(){}Bfb(){}Ccn(K){var pa=this.yCh[K];K=pa.contentId;if((pa=pa.EIj+"")&&pa.length){const Ta=[];Array.add(Ta,
Object.assign(new ym.a,{name:"RuleID",string:pa}));Fg.a.sendTelemetryEvent(Object.assign(new dm.a,{name:String.format("{0}.{1}",zm.$Hg,"ViolationSelected"),dataFields:Ta}))}this.tPn(K)}tPn(K){K&&this.XPa.jTo(K)||(this.Yb.NN(ug.AFrame.JLh,!1),this.N5o())}UTl(){this.Mpd(!1)}VTl(){this.uUj(!1)}N5o(){const K=Object.assign(new hg.StandardDialog(!0),{Du:m.AFrameworkApplication.gga,Gd:1,BOa:!1});K.uY(1);K.Pe(1,this.Dya.dAl);K.Pe(0,CommonUIStrings.l_DialogCancel);K.yY(this.Dya.fAl,this.Dya.eAl,pa=>{1===pa&&
this.lXf()})}Ugl(K){let pa=null;if(K.Results&&0<K.Results.length){pa={};let Ta=0;for(const jb of K.Results)jb.ResultId=zm.yTk+ ++Ta,K=new bi,K.contentId=jb.ContentId,K.EIj=jb.RuleId,pa[jb.ResultId]=K}return pa}qFn(){Fg.a.addNamespaceMapping(zm.$Hg,zm.Zhp);Fg.a.sendTelemetryEvent(Object.assign(new dm.a,{name:String.format("{0}.{1}",zm.$Hg,"ShowTaskpane")}))}}zm.yTk="AccCheckResult";zm.$Hg="Office.UX.AccChecker";zm.Zhp="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(f.a)(zm,
"BaseAccessibilityCheckPane",null,[1366,13]);class Mh{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(f.a)(Mh,"AccCheckerTaskPaneProps",null,[]);var hi=d(1447),Lc=d(1456),wh=d(1139),lg=d(189);class ii extends zm{constructor(K,pa,Ta,jb,bc=null,Ic=null,Uc,kd=null,pd=null){super(pa,
Ta,jb,Ic,void 0,void 0,kd);this.n8g=null;this.iBh=this.g4e=this.MId=this.ULd=this.qLd=!1;this.qcf=null;this.oaf=!!m.AFrameworkApplication.ua&&!!m.AFrameworkApplication.ua.Ib&&m.AFrameworkApplication.ua.Ib.z1f;this.MHc=this.z9=null;this.xIc=0;this.ZCd=null;this.o1=bc;pd&&(this.z9=pd.KQd,this.MHc=pd.b0p,this.xIc=pd.E2p);this.KC=new Lc.a}get isVisible(){return this.iBh}G_a(K){this.iBh=K}Ayf(K){K&&(this.n8g=K,K.IsSuccess&&(this.yCh=this.Ugl(K),K.IsPartialResult&&this.uUj(!0)),this.qLd=!0,this.ULd=!1,
this.Cn())}Mpd(K){this.isVisible&&K!==this.MId&&(this.MId=K,this.Cn())}uUj(K){this.g4e=K;this.Cn()}tS(){this.ULd||lg.UISurfaces.Hv().then(K=>{za.a.instance.xA(ii.cBb+":PaneOpen:Start");K.showTaskPane(ii.cBb,this.MB());this.lXf();return null});this.isVisible?lg.UISurfaces.Hv().then(K=>{K.setSelectedTaskPane(ii.cBb);return null}):this.qFn()}Cn(){lg.UISurfaces.Hv().then(K=>{K.updateTaskPane(ii.cBb,this.MB());return null})}MB(){var K=new Mh;this.KC.tyb(K);K=Object.assign(new wh.a,{title:this.Dya.ytc,
hideHeader:!1,width:320,location:2,contentProps:K,onOpen:()=>{this.Ica();this.G_a(!0);m.AFrameworkApplication.ua.Ie()},onClose:()=>{this.sha();this.G_a(!1);this.ULd=this.qLd=!1;this.Cn();m.AFrameworkApplication.ua.Ie()},isModernPane:!0});this.oaf&&(K.enableResize=!0,K.minResizeWidth=268,K.maxResizeWidth=920);return K}initialize(K){const pa=this.Yb.ge(ii.cBb);pa.parent=ug.AFrame.mq;pa.iK=!0;this.XPa=K;this.HUk()}dispose(){this.Bfb();this.s3e&&(this.s3e.dispose(),this.s3e=null);this.h4e&&(this.h4e.dispose(),
this.h4e=null);super.dispose()}HUk(){this.KC.ON(this.onRecheckExecute());this.KC.ON(this.Sfm());this.KC.ON(this.oIm());this.KC.ON(this.onInvokeNavigateExecute());this.KC.ON(this.Vum());this.KC.ON(this.gDm());this.KC.ON(this.cFm());this.KC.ON(this.updateLastScanTime());this.KC.ON(this.showHelpPane())}onRecheckExecute(){return K=>{K.onRecheckExecute=()=>{this.lXf()}}}Sfm(){return K=>{K.accessibilityCheckResultCollection=this.n8g}}oIm(){return K=>{K.resultsReady=this.qLd}}onInvokeNavigateExecute(){return K=>
{K.onInvokeNavigateExecute=pa=>{this.Ccn(pa)}}}Vum(){return K=>{K.helpLink=this.W4l}}gDm(){return K=>{K.outOfSync=this.MId}}cFm(){return K=>{K.partialResult=this.g4e}}updateLastScanTime(){return K=>{K.updateLastScanTime=pa=>{this.qcf=pa}}}showHelpPane(){return K=>{K.showHelpPane=()=>{m.AFrameworkApplication.K&&m.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?m.AFrameworkApplication.rL||this.iUh()?this.ZCd?this.ZCd():this.z9.value&&this.MHc&&
this.xIc&&this.z9.value.Pb(this.xIc,2,this.MHc):this.tVj():this.iUh()?this.ZCd?this.ZCd():this.z9.value&&this.MHc&&this.xIc&&this.z9.value.Pb(this.xIc,2,this.MHc):this.tVj()}}}iUh(){return!this.o1||!this.o1.value}tVj(){const K=this.o1.value;if(K){var pa={};pa.query=ii.bKk+ii.nyk;pa=Object.assign(new hi.a,{gS:pa});K.B4(ii.UUe,pa)}}lXf(){this.g4e=this.MId=this.qLd=!1;this.qcf&&this.qcf();this.Cn();this.ULd=!0;this.XPa.GVn()}Ica(){this.Yb.Bg(ii.cBb)}sha(){this.Oab()&&this.Yb.Bg(this.Yb.RW)}Oab(){return!!this.Yb.currentScope&&
this.Yb.currentScope.name===ii.cBb}}ii.cBb="AccessibilityCheckerPane";ii.nyk="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";ii.UUe="FA000000012";ii.bKk="AssetID=";Object(f.a)(ii,"ReactAccessibilityCheckPane",zm,[]);class Qh extends ii{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd,pd=null){super(K,pa,Ta,jb,bc,Ic,void 0,pd);this.Zuk=kd;this.q6=Uc}get W4l(){return this.Zuk}tS(){this.q6.NUa();super.tS()}}Object(f.a)(Qh,"ReactLiveBooksAccessibilityCheckPane",ii,[]);var fk=d(1232),bl=d(144),Ji=d(111),yl=d(66),ej=d(22),ch=
d(748),gk=d(546),ri;(function(K){K[K.error=0]="error";K[K.ut=1]="warning";K[K.Hnq=2]="tip";K[K.x4p=3]="intelligentService"})(ri||(ri={}));Object(f.b)("AccessibilityRuleCategory",ri);class Hf{constructor(K,pa,Ta=null){this.KJe=null;this.yph=this.goh=!1;this.HTa=K;this.xwd=pa;this.ga=Ta;this.Sb.ra(v.a.otl,y.a.frame,Object(O.a)(this,this.Wpf,"closePane"))}get Sb(){return this.ga||(this.ga=m.AFrameworkApplication.va)}set Sb(K){this.ga=K}O0l(){this.goh||(this.HTa.initialize(this),this.xwd.initialize(this),
this.goh=!0)}GVn(){N.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.xwd.vJo()}tS(K,pa,Ta){if(1===Ta)return tg.SessionStatusManager.instance.Gk?8:32;this.HTa.isVisible||this.O0l();this.u7o();return 32}Wpf(K,pa,Ta){1!==Ta&&this.HTa.fta();return 32}H1n(){this.HTa.Mpd(!0)}Ayf(K){if(K){if(K.AccessibilityRules&&Object.keys(K.AccessibilityRules).length){const Ta=K.AccessibilityRules;for(const jb in Ta){var pa=jb;const bc=Ta[jb].RuleId+"";pa!==bc&&N.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
pa,bc)}this.KJe=Ta}else!this.KJe&&K.Results&&0<K.Results.length?(N.b(18993251,200,15,"No accessibility rule definitions available"),K.IsSuccess=!1):K.AccessibilityRules=this.KJe;K.IsSuccess||N.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.Fyo(K);this.gFn(K);this.HTa.Ayf(K)}}Fyo(K){const pa=K.AccessibilityRules;if(K=K.Results)for(let Ta=K.length-1;0<=Ta;Ta--){const jb=K[Ta];let bc="";const Ic=jb.RuleId;jb.ContentName||(bc+="Result does not have content name. ");Ic in pa||(bc+=String.format("No accessibility check rule exists for ID {0}.",
Ic));0<bc.length&&(N.b(36214999,200,15,"Omitting invalid accessibility check result: "+bc),Array.removeAt(K,Ta))}}tJm(){return m.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):Ca.a.instance.resolve("Common.IDynamicScriptLoaderProvider").xC.loadScript("accessibility-checker-pane-strings")}u7o(){this.yph?this.HTa.tS():this.tJm().then(()=>{this.yph=!0;this.HTa.tS()}).catch(K=>ua.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
K))}gFn(K){var pa={};const Ta={};var jb=K.Results,bc=[];Array.add(bc,Object.assign(new ym.a,{name:"FinalViolationCount",int64:0}));Array.add(bc,Object.assign(new ym.a,{name:"FinalErrorCount",string:"0"}));Array.add(bc,Object.assign(new ym.a,{name:"FinalWarningCount",string:"0"}));Array.add(bc,Object.assign(new ym.a,{name:"FinalTipCount",string:"0"}));Array.add(bc,Object.assign(new ym.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(jb){for(const kd of jb)if(K.AccessibilityRules){var Ic=K.AccessibilityRules[kd.RuleId];
if(Ic){if(pa[ri[Ic.Category]]){let pd=pa[ri[Ic.Category]];pa[ri[Ic.Category]]=++pd}else pa[ri[Ic.Category]]=1;Ta[kd.RuleId]?(Ic=Ta[kd.RuleId],Ta[kd.RuleId]=++Ic):Ta[kd.RuleId]=1}}bc[0].int64=jb.length;for(var Uc in pa)switch(K=pa[Uc],jb=Uc,jb="Final"+jb.charAt(0).toUpperCase()+jb.substring(1,jb.length)+"Count",jb){case "FinalErrorCount":bc[1].string=K.toString();break;case "FinalWarningCount":bc[2].string=K.toString();break;case "FinalTipCount":bc[3].string=K.toString();break;case "FinalIntelligentServiceCount":bc[4].string=
K.toString()}}Fg.a.sendTelemetryEvent(Object.assign(new dm.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:bc}));for(const kd in Ta)pa=kd,bc=Ta[kd],Uc=[],Array.add(Uc,Object.assign(new ym.a,{name:"RuleID",string:pa})),Array.add(Uc,Object.assign(new ym.a,{name:"FinalViolationCount",string:bc.toString()})),Fg.a.sendTelemetryEvent(Object.assign(new dm.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Uc}))}dispose(){this.HTa&&
this.HTa.dispose();this.xwd&&this.xwd.dispose()}}Object(f.a)(Hf,"AAccessibilityCheckManager",null,[31,13]);var lk=d(327);const fi=[12,14,22,19,30,43,44];class Ab extends Hf{constructor(K,pa,Ta,jb,bc,Ic){super(pa,Ta,K);this.Sb.ra(v.a.hDg,y.a.frame,this.tS.bind(this));this.Sb.fb(v.a.flo,y.a.frame,this.wxj.bind(this),96);this.Qfa=bc;this.iFk=jb;this.ABk=Ic;this.Wsc=()=>{this.H1n()};this.bvo()}wxj(K,pa,Ta,jb,bc){if(1===Ta)return 32;bc[lk.a.On]=this.HTa.isVisible;return 32}jTo(K){if(this.ABk)return ua.ULS.sendTraceTag(20713608,
334,15,"ODT file. Disable content navigation."),!0;ua.ULS.shipAssertTag(20272215,334,!!K);return this.iFk.nPn(K)}bvo(){for(const K of fi){const pa=this.Qfa.Ve(K);pa.fo(this.Wsc);pa.Zt(this.Wsc);pa.Bw(this.Wsc)}}Dsp(){for(const K of fi){const pa=this.Qfa.Ve(K);pa.QN(this.Wsc);pa.jV(this.Wsc);pa.hha(this.Wsc)}}dispose(){super.dispose();this.Dsp()}}Object(f.a)(Ab,"WordAccessibilityCheckManager",Hf,[]);var jc=d(87),Jc=d(28),yd=d(108),Be=d(13),we=d(178),wf=d(5),rf=d(15),xg=d(508);class Nh{constructor(K,
pa,Ta,jb,bc,Ic,Uc){this.ao=null;this.TMb=0;this.Zc=pa;this.pG=Ta;this.hb=jb;this.ga=bc;this.nd=Ic;this.Sy=K;this.yd=Uc}get FS(){if(!this.ao){const K=this.Zc.jg(this.Sy.$c);this.pG.KKg(K);if(K.zb(7)||K.ld(7))this.ao=jc.a.Ft(K,K.origin)}return this.ao}nPn(K){if(!K||!K.Rg||0>=K.Rg.length)return ua.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var pa=Array(K.Rg.length);let Ta=7,jb=null;for(let Ic=0;Ic<K.Rg.length;Ic++)if(jb=this.j9l(K.Rg[Ic])){if(7===Ta)Ta=this.TMb;else if(Ta!==
this.TMb)return ua.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var bc=this.yd.lZa(jb.characterData,jb.qa);const Uc=K.cpBegin?this.yd.pMb(bc,K.cpBegin):-1;bc=K.cpEnd?this.yd.pMb(bc,K.cpEnd):-1;if(-1>Uc||-1>bc)return ua.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;pa[Ic]=Jc.a.bU(Uc,bc,!1,jb);switch(K.contentType){case 5:if(!yd.a.Y5c(pa[Ic],!1))return!1;break;case 6:if(!Be.ImageReader.M7(pa[Ic]))return!1;
break;case 7:pa[Ic]=Jc.a.bU(-1,-1,!1,jb)}}else return!1;pa=new we.Selection(pa,!1);return this.gYo(jb,pa,K.contentType)}j9l(K){if(this.FS)for(this.FS.reset(),this.TMb=7;this.FS.moveNext();){var pa=this.FS.currentNode.type;if(38===pa||36===pa||23===pa)this.TMb=pa;else if(12===pa){pa=this.FS.currentNode;const Ta=pa.ja(wf.a.Yc,0);if(K===Ta)return pa}}return null}ZGg(K){this.ga.Ob(rf.a.VW,2);this.ga.Ob(rf.a.Z6,2);let pa=2;switch(this.TMb){case 23:pa=32;break;case 38:pa=this.ga.Pb(rf.a.lcb,2,new xg.a(K));
break;case 36:pa=this.ga.Pb(rf.a.kub,2,new xg.a(K));break;default:ua.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.TMb)}if(32===pa)return!0;ua.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.TMb);return!1}gYo(K,pa,Ta){if(this.ZGg(K)){K=this.Sy.Vu;const jb=this.hb.gb.currentSelection;jb&&jb.equals(pa)&&this.nd.zha(K,null);this.nd.zha(K,pa);switch(Ta){case 0:case 1:this.ga.Ob(ea.a.q_b,2);break;case 2:this.ga.Ob(ea.a.hnd,2);break;case 3:this.ga.Ob(ea.a.nEa,
2)}return!0}return!1}}Object(f.a)(Nh,"WordAccessibilityCheckNavigateManager",null,[1108]);class Rj{constructor(K){this.XPa=null;this.Kjh=K}get fileId(){return this.Kjh?this.Kjh():null}initialize(K){this.XPa=K}Vjj(K){this.XPa.Ayf(K)}}Object(f.a)(Rj,"AAccessibilityCheckService",null,[1365,13]);class Ig{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(K){K=Sys.Serialization.JavaScriptSerializer.deserialize(K);const pa=K.AccessibilityRules,
Ta={};if(pa)for(let jb=0;jb<pa.length;++jb){const bc=pa[jb];Ta[bc.Key]=bc.Value}K.AccessibilityRules=Ta;return K}}Object(f.a)(Ig,"AccessibilityCheckResultCollection",null,[]);class ll extends Rj{constructor(K){super(K);this.onFailure=(pa,Ta)=>{ua.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",Ta);pa=Object.assign(new Ig,{IsSuccess:!1});this.Vjj(pa)};this.BE=pa=>{pa=ll.mIm(pa);let Ta=null;if(pa)try{Ta=this.mRl(pa)}catch(jb){ua.ULS.shipAssertTag(20730843,334,!1,"AccChecker response data is invalid. [{0}]",
jb.message),Ta=Object.assign(new Ig,{IsSuccess:!1})}else ua.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),Ta=Object.assign(new Ig,{IsSuccess:!1});this.Vjj(Ta)}}dispose(){}static mIm(K){let pa=null;K&&K.gk&&(pa=K.gk[0]);return pa?pa.Body:null}}Object(f.a)(ll,"ALiveBooksAccessibilityCheckService",Rj,[]);var mk=d(906),Bh=d(1101),rp=d(1519),Ck=d(273),$l=d(477);class sn extends Ck.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}lm(){return $l.a.xTk}static construct(K,
pa){const Ta=new sn;Ta.FileId=K;Ta.IsCoauthorable=pa;return Ta}}Object(f.a)(sn,"WordAccessibilityCheckRequest",Ck.a,[]);class sk{}Object(f.a)(sk,"AccessibilityCheckRule",null,[]);var Bp=d(196);class Hc{static parse(K){switch(Ia.a.xh(K)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw K=String.format("Invalid Accessibility result category: {0}",K),Bp.a.argument(K);}}}Object(f.a)(Hc,"AccessibilityRuleCategoryParser",null,[]);class Dk{constructor(){this.Category=
this.Text=this.Id=null}static mkp(K){const pa=new sk;pa.RuleId=K.Id;pa.RuleName=K.Text;pa.Category=Hc.parse(K.Category);return pa}}Object(f.a)(Dk,"WordAccessibilityCheckRule",null,[]);class Tq{}Object(f.a)(Tq,"AccessibilityCheckResult",null,[]);class oc{constructor(){this.cpEnd=this.cpBegin=this.Rg=null;this.contentType=0}}Object(f.a)(oc,"WordAccessibilityCheckContentId",null,[]);const vc=K=>{switch(Ia.a.xh(K)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;
case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var Jo=d(1678);class Pm{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static kkp(K){const pa=new Tq;pa.RuleId=K.RuleId;pa.ContentName=K.Label;const Ta=new oc;Ta.Rg=K.ParaId;Ta.cpBegin=Jo.b(K.OS);Ta.cpEnd=Jo.b(K.OE);Ta.contentType=vc(K.ContentType);pa.ContentId=Ta;return pa}}Object(f.a)(Pm,"WordAccessibilityViolation",null,
[]);class Co{constructor(){this.Violations=this.Rules=null}static lkp(K){const pa=new Ig;try{var Ta={};if(K.Rules){for(let jb=0;jb<K.Rules.length;++jb){const bc=Dk.mkp(K.Rules[jb]);Ta[bc.RuleId]=bc}pa.AccessibilityRules=Ta}if(K.Violations){const jb=Array(K.Violations.length);for(Ta=0;Ta<K.Violations.length;++Ta)jb[Ta]=Pm.kkp(K.Violations[Ta]);pa.Results=jb}pa.IsPartialResult=!1;pa.IsSuccess=!0}catch(jb){ua.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",
jb.message),pa.IsSuccess=!1}return pa}}Object(f.a)(Co,"WordAccessibilityCheckResult",null,[]);class jl extends ll{constructor(K,pa,Ta){super(K);this.HDb=pa;this.cjb=Ta}vJo(){const K=Object.assign(new mk.a,{ar:sn.construct(this.fileId,this.cjb),status:Bh.a.nH,GE:"AccessibilityCheck"});this.HDb(rp.a.zTk,!1,this.BE,this.onFailure,K,null,K)}mRl(K){K=Ya.b(K);return Co.lkp(K)}}Object(f.a)(jl,"WordAccessibilityCheckService",ll,[]);class Kl extends $f{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}wc(K){super.wc(K);
K.ia("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new Qh(m.AFrameworkApplication.va,mf.a.instance,Gg.FocusManager.instance(),dg.a.instance,K.rf("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Sf.KeyInputManager.instance,fk.a.instance,m.AFrameworkApplication.K.kb("AccessibilityCheckerHelpUrl"))).ha();K.ia("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new jl(()=>m.AFrameworkApplication.rootQuerySignature,gk.a.mU,bl.PageReader.instance.z7d(Od.StaticActiveAppFrame.za().ib.$c))).ha();
K.ia("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new Nh(Od.StaticActiveAppFrame.za().ib,K.resolve("Box4.Graph.IGraphIteratorFactory"),Object(Ji.a)(),K.resolve("Box4.ISelectionManager"),m.AFrameworkApplication.va,Object(yl.a)(),K.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).ha();K.ia("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new Ab(m.AFrameworkApplication.va,K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),
K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),K.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),ej.App.jf.Il,ch.a.j$c)).ha()}init(){this.container.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{$f.prototype.init.call(this)})}}Object(f.a)(Kl,"WordAccCheckerPackageManager",$f,[]);var fo;(function(K){K[K.c2p=0]="graphSpaceReplicatorNotSendingContent";K[K.U3p=1]="inboundRequestTakesTooLongToSendAfterRTC";K[K.pYp=2]="docxSaveMonitorKickoutElapsed"})(fo||
(fo={}));Object(f.b)("ComponentLoggingScenario",fo);var cn=d(1512);class Uq{flush(K,pa){const Ta=this.wpm(K);Ta.LoggingScenario=fo[pa];Dg.a(Ta).length?ua.ULS.sendTraceTag(594571986,3013,15,"{0}",Ta):ua.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",cn.a[K.a7a])}wpm(K){const pa={};if(!K)return pa;const Ta=new Td.a;for(Ta.enqueue(K);!Ta.isEmpty;){K=Ta.dequeue();const jb=cn.a[K.a7a];try{pa[jb]=K.eD()}catch(bc){ua.ULS.sendTraceTag(594571985,
3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",jb.toString(),{["Kind"]:"Exception",["Stack"]:bc.stack,["Message"]:bc.message,["FileName"]:bc.fileName,["LineNumber"]:bc.lineNumber})}if((K=K.mXd)&&K.length)for(const bc of K)!bc||cn.a[bc.a7a]in pa||Ta.enqueue(bc)}return pa}}Object(f.a)(Uq,"ComponentStateLogManager",null,[983]);class To{flush(){}}Object(f.a)(To,"NoOpComponentStateLogManager",null,[983]);class sm{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}wc(K){this.W=
K;m.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?K.ia("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new Uq).as("Common.IComponentStateLogManager").ha():K.ia("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new To).as("Common.IComponentStateLogManager").ha()}static main(){H.a.instance.Jc(new sm)}}Object(f.a)(sm,"WordEditorComponentStateLoggingPackage",null,[0,1]);var go=d(1301),ml=d(689),ul=d(843),Ko=d(844),Dl=d(72);class $g{constructor(K,
pa=null,Ta=-1,jb=null){this.p2=K;this.FKh=jb||(()=>pa);this.Tzd=Ta}Ij(K,pa,Ta,jb,bc,Ic,Uc,kd,pd,Fd=null,le=!1,jf=null,of=null){const tf=new XMLHttpRequest;let Se="";Ic="";2===pa?(Se="POST",Ta&&(Ic=Ta)):Se="GET";pa={};this.p2&&(K=go.a.SWk(pa,K,Dl.a.YFe,m.AFrameworkApplication.yAb,this.p2));tf.open(Se,K,!0);this.Tgl(pa,K);if(jb)for(const Uf in jb)tf.setRequestHeader(Uf,Ia.a.qP(jb[Uf]));for(const Uf in pa)tf.setRequestHeader(Uf,pa[Uf]);K=jf||this.Tzd;0<K&&(tf.timeout=K);K=[];Array.add(K,Dl.a.S2);jb=
new Sys.Net.WebRequest;const ye=new ul.a(1,2,jb,K,bc,Uc,kd,pd,le,Fd,of);tf.onreadystatechange=()=>{this.Z0n(tf,ye)};try{tf.send(Ic)}catch(Uf){ua.ULS.sendTraceTag(24938643,205,15,"Invoke failed in SimpleClientRequestSender")}return 1}$kc(){return 1}Z0n(K,pa){if(this.xpl(K,pa)&&4===K.readyState)if(K.getResponseHeader(Dl.a.tki)&&m.AFrameworkApplication.u_c)m.AFrameworkApplication.u_c();else{var Ta=K.getResponseHeader(Dl.a.Onf);go.a.WEe(Ta);this.azp(K,pa);K.status===al.a.zz?(pa.status=2,pa.xK(new Ko.a(pa))):
(pa.status=K.status&&K.status!==al.a.rxb?K.status===al.a.A8?5:3:7,pa.l7(new ml.a(pa)))}}Tgl(K,pa){K["X-xhr"]=1;m.AFrameworkApplication.DXa&&(K[Dl.a.L$i]=1);m.AFrameworkApplication.buildVersion&&(K[Dl.a.msc]=Ia.a.qP(m.AFrameworkApplication.buildVersion));let Ta=null;this.FKh&&(Ta=this.FKh());Ta&&(K[Dl.a.FOg]=Ta);m.AFrameworkApplication.bN&&(K[Dl.a.rLb]=Ia.a.qP(m.AFrameworkApplication.bN),m.AFrameworkApplication.Yqc&&ua.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",K[Dl.a.rLb]));m.AFrameworkApplication.accessToken&&
(go.a.e2h(pa,m.AFrameworkApplication.r2)||(K[Dl.a.cMh]=Ia.a.qP(m.AFrameworkApplication.accessToken)),go.a.e2h(pa,m.AFrameworkApplication.xja)||(K[Dl.a.dMh]=m.AFrameworkApplication.GTa.toString()));m.AFrameworkApplication.userType&&(K[Dl.a.I$j]=Ia.a.qP(m.AFrameworkApplication.userType))}azp(K,pa){pa.He=K.status?K.status:al.a.rxb;try{pa.De=K.responseText;if(void 0!==pa.j_a&&null!==pa.j_a){pa.vi={};for(let Ta=0;Ta<pa.j_a.length;++Ta){const jb=pa.j_a[Ta];pa.vi[jb]=K.getResponseHeader(jb)}}pa.tze&&(pa.rna=
K.responseText&&K.responseText.length?K.responseXML:null)}catch(Ta){ua.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",pa.id,pa.request.get_url(),4===K.readyState)}}xpl(K,pa){return K?pa?!0:(ua.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),!1):(ua.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),
!1)}static create(K,pa,Ta){return new $g(K,null,Ta,pa)}}Object(f.a)($g,"SimpleClientRequestSender",null,[1426]);class ep{constructor(K,pa,Ta){this.Af=K;this.dNd=pa;this.gBh=Ta}Ij(K,pa,Ta,jb,bc,Ic,Uc,kd,pd,Fd=null,le=!1,jf=null,of=null,tf=null,Se=null,ye=!1){return this.gBh?this.dNd.Ij(K,pa,Ta,jb,bc,Ic,Uc,kd,pd,Fd,le,of,tf):this.Af.Ij(K,pa,Ta,jb,bc,Ic,Uc,kd,pd,Fd,le,jf,of,tf,Se,ye)}$kc(K){return this.gBh?this.dNd.$kc():this.Af.$kc(K)}}Object(f.a)(ep,"ClientRequestAdapter",null,[1490]);var Lk=d(231),
Kf=d(258),Yh=d(245),ng=d(1455),kj=d(1465),tk=d(1521),Mm=d(51),ka=d(794),$a=d(640),Db=d(102),ec=d(621),sc=d(652),ad;(function(K){K[K.none=0]="none";K[K.Zui=1]="getCells";K[K.Vae=2]="hotStoreStatus";K[K.kJj=3]="saveMonitor";K[K.Viq=4]="saveMonitor_LineageTombstone";K[K.Ytb=5]="kickoutExecutor"})(ad||(ad={}));Object(f.b)("MostRecentRevisionIdOrigin",ad);class Xd extends Sys.EventArgs{constructor(K,pa,Ta,jb){super();this.abb=K;this.httpStatusCode=Ta;this.oK=jb}}Object(f.a)(Xd,"UpdatedLastRevisionSaveIdEventArgs",
Sys.EventArgs,[]);class ue{constructor(){this.G$=0}get isEmpty(){return!this.G$}FSc(K){this.G$|=K}N$c(K){return!!(this.G$&K)}clear(){this.G$=0}RUc(){return!1}}Object(f.a)(ue,"DocxSaveMonitorRetryAttemptOnce",null,[]);class ae{constructor(K,pa=3){this.G$=0;this.tLd=new Map;this.yEk=K;this.xLk=pa}get isEmpty(){return!this.G$}FSc(K){this.G$|=K;let pa=this.tLd.get(K)||0;this.tLd.set(K,++pa)}N$c(K){return!!(this.G$&K)}clear(){this.G$=0;this.tLd.clear()}RUc(K){return this.xLk&K?(this.tLd.get(K)||0)<this.yEk:
!1}}Object(f.a)(ae,"DocxSaveMonitorRetryAttemptMany",null,[]);class Te{static create(K=!1,pa=3,Ta=0){return K?new ae(pa,Ta):new ue}}Object(f.a)(Te,"DocxSaveMonitorRetryAttemptFactory",null,[]);class sf extends Ck.a{constructor(){super();this.CellId=this.FileId=null}lm(){return $l.a.oLf}static construct(K){const pa=new sf;pa.FileId=K.Jj().kq;pa.CellId=Db.a(K.Lc.id);return pa}}Object(f.a)(sf,"LastSavedRevisionRequest",Ck.a,[]);var kg;(function(K){K[K.Ncq=-1]="noResultYet";K[K.Woq=0]="upToDate";K[K.dkq=
1]="sessionLost";K[K.lpq=2]="userSignedOut";K[K.sgq=3]="previousRequestPending";K[K.fve=4]="requestFailed";K[K.Qkq=5]="shuttingDown";K[K.sdq=6]="nullResponseData";K[K.S4p=7]="invalidResponseData";K[K.l_p=8]="failedRevisionLookup";K[K.fjq=9]="savedWithinThreshold";K[K.$cq=10]="notSavedWarning";K[K.x5p=11]="kickoutThreshold";K[K.roq=12]="unknownRevision";K[K.eWp=13]="contentNotYetLoaded";K[K.eQo=14]="sessionExpired";K[K.Fll=15]="canaryError";K[K.timeout=16]="timeout";K[K.y5p=17]="kickoutThreshold_Offline";
K[K.BYp=18]="dssSessionDeleted";K[K.CYp=19]="dssSessionExpired";K[K.Cpq=20]="waitingForSessionTokenRefresh";K[K.DYp=21]="dssSessionNotFound"})(kg||(kg={}));Object(f.b)("SaveMonitorResult",kg);class qf{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd,pd,Fd,le,jf,of,tf,Se,ye,Uf,sh,Tf,hf,zi,El,Yk,lj,In,Gm=null,Wm){this.QLc=0;this.o8b=!1;this.GOc=null;this.vKc=this.FZ=-1;this.i5e=null;this.VJd=0;this.WJd=!1;this.kGb=null;this.FMc=0;this.U7e=this.nIh=null;this.PV=this.Dsh=this.JGc=0;this.D_e=null;this.Bph=!1;this.uk=
null;this.JCh=this.eNd=0;this.iFh=!1;this.q$l=()=>{var Ve;ua.ULS.sendTraceTag(524871194,qf.Sn,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.JU,["AppVisibilityState"]:ng.a[null===(Ve=this.uk)||void 0===Ve?void 0:Ve.zA]});try{if(this.dIc){var Yj=this.dIc();ua.ULS.sendTraceTag(509367249,qf.Sn,50,"Additional Details: {0}",Yj)}}catch(Zj){Ve=Ya.c({["Kind"]:"Exception",["Stack"]:Zj.stack,["Message"]:Zj.message,["FileName"]:Zj.fileName,["LineNumber"]:Zj.lineNumber}),ua.ULS.sendTraceTag(509367062,qf.Sn,
15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Ve)}Ve=this.lFb;this.lFb=this.sB();if(this.Tda())this.yB.event(5),this.stop("session has shut down");else if(this.bjb===qf.rHj&&this.hFa(this.rDb),Yj=this.t7b())if(this.JU)this.yB.event(0);else if(this.t8b())this.yB.event(1),this.stop("session is lost"),m.AFrameworkApplication.Ld("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.Bph&&!this.Aln()&&(ua.ULS.sendTraceTag(554726995,qf.Sn,10,"DocxSaveMonitor: Session lost but not kicked out"),
this.jK(Mm.a.dii));else if(this.Aqh())20!==this.yB.currentState?(this.yB.event(20),this.nIh=this.sB(),ua.ULS.sendTraceTag(593510691,qf.Sn,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.pIh)):this.sB().getTime()-this.nIh.getTime()>this.pIh&&(this.yB.event(14),this.qhe(20,Mm.a.A0d,"TokenExpired"));else if(this.wCk())if(this.lFb=Ve,this.o8b)this.yB.event(3),this.sB().getTime()-this.GOc.getTime()>this.RZe&&(Ve=this.xNe.$kc(this.FZ),
ua.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.FZ,wc.a[Ve]),this.eLd&&this.eLd.log(),this.stop("stuck on previousRequestPending"),this.jK());else if(Ve=$a.b(sf.construct(Yj)),this.o8b=!0,this.GOc=this.fLk(),this.FZ=this.xNe.Ij(qf.serviceUrl,2,Ve,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.Apl,this.zpl,null,void 0,void 0,this.P5e,this.DPc,void 0,void 0,!0),0>=this.FZ)this.o8b=!1,ua.ULS.sendTraceTag(19161611,205,50,
"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.FZ.toString());else{Ve=this.xNe.$kc(this.FZ);Yj=100;if(Ve&&1!==Ve||this.Smh)Yj=50;ua.ULS.sendTraceTag(19161612,qf.Sn,Yj,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.FZ,["Status"]:wc.a[Ve]});this.eLd&&this.eLd.start(this.FZ)}else this.yB.event(2);else this.yB.event(13)};this.zpl=Ve=>{this.PV=this.vXd+1;let Yj=this.o8b=!1,Zj=!1;Ve=Ve.data;nb.a.$l&&m.AFrameworkApplication.yga("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");
Ve?(ua.ULS.sendTraceTag(22552773,qf.Sn,15,"Request failed {0}",{["Status"]:Ve.status,["HttpStatus"]:Ve.He,["Correlation"]:Ve.vi?Ve.vi[Dl.a.S2]:"",["Id"]:Ve.id,["ConsecutiveErrors"]:this.vXd,["Request.InvokedTime"]:Ve.bH,["Request.EnqueueTime"]:Ve.nsa,["Request.CompletedTime"]:Ve.YO}),Zj=7===Ve.status||13===Ve.status,this.RUc(2)&&Zj?(this.c2a.FSc(2),Yj=!0,this.vKc=Ve.He,this.yB.event(16)):this.RUc(1)&&5===Ve.status?(this.c2a.FSc(1),Yj=!0,this.vKc=Ve.He,this.yB.event(15)):(this.yB.event(4),this.vKc=
Ve.He)):(this.yB.event(4),ua.ULS.sendTraceTag(23425240,qf.Sn,15,"RequestFailed and event data is null"));if(!Yj&&(this.c2a.clear(),Zj?this.qhe(17,Mm.a.IXl,"while offline"):this.qhe(11,Mm.a.izf,"while online")))return;this.hFa(Yj?this.xim(Zj):this.rDb)};this.Apl=Ve=>{this.PV=this.vXd+1;this.o8b=!1;var Yj={};this.c2a.clear();if(Ve=Ve.data){var Zj=Ve.vi?Ve.vi[Dl.a.S2]:"";Yj.HttpStatus=Ve.He;Yj.Correlation=Zj;Yj.Id=Ve.id;ua.ULS.sendTraceTag(23425242,qf.Sn,this.Smh?50:100,"Request succeeded at the HTTP level {0}",
Yj);this.vKc=Ve.He}else ua.ULS.sendTraceTag(23425241,qf.Sn,15,"Request succeeded with null response data");if(this.Tda()||!this.B0d)this.yB.event(5),this.stop("session has shut down");else if(!this.Xqn())if(Ve&&Ve.De)if(Ve=this.yAa(Ve.De))if(this.DH.FPa(Ve),Ve.StatusCode)this.Q2f(Ve,Yj)||this.yB.event(8,Yj);else{this.PV=0;this.lFb=this.sB();this.f7e.clear();Yj={["LastSavedRevisionId"]:Ve.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:Ve.RevisionSequenceNumber};Ve=Db.b(Ve.LastSavedRevisionId);
this.oyb(Ve,3);var pl=this.HIf().m_a.Z4c(Ve);if(pl){Ve=null;Zj=this.Hqb();pl=(pl=pl.PVa(Zj))?pl.id:wi.a.nil;let qh=Zj;for(;qh&&!qh.id.equals(pl);)Ve=qh,qh=qh.EA;this.GWm(Ve,Yj,Zj)||this.yB.event(9)}else this.lVm()||this.yB.event(12,Yj);this.hFa(this.Tac)&&ua.ULS.sendTraceTag(22552774,qf.Sn,50,"Received response from server -- going back to normal interval")}else this.yB.event(7),this.R2f("invalid response",Yj);else this.yB.event(6),this.R2f("null response",Yj)};this.mHo=(Ve,Yj)=>{Ve={};Ve.DocxSaveMonitorState=
kg[Yj.newState];Ve.PreviousState=kg[Yj.Fmg];Ve.PreviousStateHits=Yj.Gmg;Ve.PreviousStateTransitionTime=Yj.Hmg.toISOString();Ve.LastHttpStatus=this.vKc;Ve.LastSuccessTime=this.lFb.toISOString();this.GOc&&(Ve.LastRequestStartTime=this.GOc.toISOString());Ve.LastSavedRevisionID=this.Ake.toString();Ve.LastSavedRevisionIdOrigin=this.QLc;Ve.LastSavedRevisionIdSetTime=this.U7e?this.U7e.toISOString():null;Ve.IsViable=this.tf.NCa;Ve.IsNetworkConnected=this.tf.ZA;Ve.IsExpired=this.tf.Aba;Ve.HasEmergencyViewModeBeenDeployed=
this.tf.Gk;Ve["Navigator.Online"]=window.navigator.onLine;const Zj=Yj.wcp;Zj&&qf.aej(Ve,Zj);Yj=Yj.newState;switch(Yj){case 13:ua.ULS.sendTraceTag(5830086,qf.Sn,50,"{0}",Ve);break;case 1:ua.ULS.sendTraceTag(5884125,qf.Sn,50,"{0}",Ve);break;case 0:ua.ULS.sendTraceTag(5830087,qf.Sn,50,"{0}",Ve);break;case 2:ua.ULS.sendTraceTag(5830088,qf.Sn,50,"{0}",Ve);break;case 3:ua.ULS.sendTraceTag(5830089,qf.Sn,50,"{0}",Ve);break;case 4:ua.ULS.sendTraceTag(5884126,qf.Sn,50,"{0}",Ve);break;case 5:ua.ULS.sendTraceTag(5884127,
qf.Sn,50,"{0}",Ve);break;case 6:ua.ULS.shipAssertTag(5830090,qf.Sn,!1,"{0}",Ve);break;case 7:ua.ULS.shipAssertTag(5830091,qf.Sn,!1,"{0}",Ve);break;case 8:ua.ULS.sendTraceTag(5830092,qf.Sn,15,"{0}",Ve);break;case 10:ua.ULS.sendTraceTag(5830094,qf.Sn,15,"{0}",Ve);break;case 9:ua.ULS.sendTraceTag(5884128,qf.Sn,50,"{0}",Ve);break;case 11:ua.ULS.sendTraceTag(5830096,qf.Sn,15,"{0}",Ve);break;case 17:ua.ULS.sendTraceTag(37835678,qf.Sn,15,"{0}",Ve);break;case 12:ua.ULS.sendTraceTag(5830095,qf.Sn,15,"{0}",
Ve);break;case 18:ua.ULS.sendTraceTag(38122832,qf.Sn,15,"{0}",Ve);break;case 19:ua.ULS.sendTraceTag(38122833,qf.Sn,15,"{0}",Ve);break;case 21:ua.ULS.sendTraceTag(0,qf.Sn,15,"{0}",Ve);break;case 14:ua.ULS.sendTraceTag(6575508,qf.Sn,15,"{0}",Ve);break;case 15:ua.ULS.sendTraceTag(36739287,qf.Sn,50,"{0}",Ve);break;case 16:ua.ULS.sendTraceTag(36767649,qf.Sn,15,"{0}",Ve);break;case 20:ua.ULS.sendTraceTag(593510690,qf.Sn,15,"{0}",Ve);break;default:ua.ULS.shipAssertTag(5884129,qf.Sn,!1,"Bad state:{0} logInfo:{1}",
Yj,Ve)}};this.Tac=K;this.rDb=pa;this.bjb=K;this.OKh=Ta;this.yNk=jb;this.P5e=Ic;this.DPc=Uc;this.E9b=kd;this.Ffh=pd;this.xNe=Fd;this.W1=le;this.DH=jf;this.t7b=of;this.wCk=tf;this.t8b=Se;this.Aqh=ye;this.Tda=Uf;this.sB=sh;this.fLk=Tf;this.Bph=In;this.c2a=Te.create(Wm.isEnabled,Wm.maxRetries,El.G$);this.f7e=new sc.a;this.dIc=Yk;this.yB=new kj.a(-1);this.tf=Gm;this.yB.Tgf(this.mHo);this.eLd=hf;this.lFb=sh();this.Smh=zi;this.onk=Wm.isEnabled?null:El;this.dCb=lj;this.pIh=this.OKh;this.q1e=wi.a.nil;this.sa=
new V.a;Ca.a.instance.Qa("Common.App.VisibilityManagement.IVisibilityManager").execute(Ve=>{this.uk=Ve;this.uk.nIa((Yj,Zj)=>{this.U_(Yj,Zj)});this.t5e=Ve.zA});this.tf&&this.tf.eKb((Ve,Yj)=>{this.Hga(Ve,Yj)});this.RZe=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",bc):bc;this.JCh=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",
this.rDb):this.rDb;this.iFh=m.AFrameworkApplication.K?m.AFrameworkApplication.K.$("StopDocxSaveMonitorKickoutIsEnabled"):!0;this.zLk=Wm}Hga(K,pa){ua.ULS.sendTraceTag(528577692,qf.Sn,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",tk.a[pa.qsc],tk.a[pa.Obb]);1!==pa.Obb&&3!==pa.Obb&&(ua.ULS.sendTraceTag(528566343,qf.Sn,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.c2a.N$c(1),this.c2a.N$c(2)),
this.c2a.clear())}get B0d(){return this.JGc}get Ake(){return this.q1e}get JU(){const K=!this.Hqb()||this.Ake.equals(this.Hqb().id);K||ua.ULS.sendTraceTag(521413851,qf.Sn,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.Hqb().id.toString(),this.Ake.toString());return K}get XZi(){return this.sB().getTime()-this.lFb.getTime()>this.RZe}get vXd(){return this.PV}get a7a(){return 3}get mXd(){let K=null;Od.StaticActiveAppFrame.za()&&Od.StaticActiveAppFrame.za().ib&&
Od.StaticActiveAppFrame.za().ib.$c&&(K=Od.StaticActiveAppFrame.za().ib.$c.yg);return[K,ch.a.d1]}U_(K,pa){var Ta,jb,bc;K={["VisibilityState"]:ng.a[this.uk.zA],["IsVisible"]:this.uk.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.o8b,["KickoutIntervalElapsed"]:this.XZi,["LastSuccessfulIterationTime"]:null!==(Ta=this.lFb)&&void 0!==Ta?Ta:"null",["RequestStartTime"]:null!==(jb=this.GOc)&&void 0!==jb?jb:"null",["SkippedKickouts"]:this.eNd,["LastSkippedKickoutAt"]:null!==(bc=this.Ish)&&void 0!==
bc?bc:"null"},["IsViable"]:this.tf.NCa,["IsNetworkConnected"]:this.tf.ZA,["IsExpired"]:this.tf.Aba,["HasEmergencyViewModeBeenDeployed"]:this.tf.Gk,["Navigator.Online"]:window.navigator.onLine};ua.ULS.sendTraceTag(539874775,qf.Sn,50,Ya.c(K));this.t5e!=this.uk.zA&&(0==pa.oldState||1==pa.oldState||0!==pa.newState&&1!==pa.newState||this.hFa(this.JCh),0===this.uk.zA?Ce.c(rf.a.Nel,void 0,void 0,void 0,void 0,void 0,K):0===this.t5e&&Ce.c(rf.a.Oel,void 0,void 0,void 0,void 0,void 0,K),this.t5e=this.uk.zA)}start(){this.JGc=
this.Ffh.eob(this.q$l,this.bjb)}hFa(K){if(!this.B0d||this.bjb===K)return!1;const pa=this.bjb;this.bjb=K;this.stop("changing save monitor interval from "+pa+"ms to "+K+"ms");this.start();return!0}oyb(K,pa){if(pa>=this.QLc&&K&&!wi.a.nil.equals(K)){var Ta=!this.q1e.equals(K);this.QLc=pa;this.q1e=K;const jb=this.sB();this.U7e=jb;const bc=this.JU;Ta&&(pa={["Id"]:K.toString(),["IsUpToDate"]:bc,["Origin"]:ad[pa]},this.D_e&&(pa.LastUpToDateTime=this.D_e.toISOString()),(Ta=this.HIf())&&Ta.m_a&&(K=Ta.m_a.Z4c(K))&&
(pa.LastSavedCreationTime=K.creationTime.toISOString()),ua.ULS.sendTraceTag(557320151,qf.Sn,50,"Updating Last Saved Revision: {0}",pa));bc&&(this.D_e=jb)}else pa<this.QLc?ua.ULS.sendTraceTag(572051800,qf.Sn,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.QLc,pa):ua.ULS.sendTraceTag(572051801,qf.Sn,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',pa)}stop(K){this.vf(K)}vf(K){this.B0d&&(ua.ULS.sendTraceTag(5830084,qf.Sn,50,"Stopping DocxSaveMonitor because {0}!",K),this.Ffh.vf(this.B0d),
this.JGc=0)}lVm(){if(0>=this.E9b)return!1;var K=this.vCm();if(!K)return this.i5e=null,this.VJd=0,this.WJd=!1;this.kGb=K.EOb;this.kGb===this.i5e?this.VJd++:(this.i5e=this.kGb,this.VJd=1,this.WJd=!1);if(this.VJd<qf.LMn)return!1;this.FMc=+this.sB()-+this.kGb;if(this.FMc<=this.E9b)return!1;if(!this.WJd)return this.WJd=!0,this.iyj(),!1;if(this.dCb)this.dCb.execute(pa=>{pa.flush(this,0)});else{K="";try{this.dIc&&(K=this.dIc())}catch(pa){K=Ya.c({["Kind"]:"Exception",["Stack"]:pa.stack,["Message"]:pa.message,
["FileName"]:pa.fileName,["LineNumber"]:pa.lineNumber}),ua.ULS.sendTraceTag(50426817,qf.Sn,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",K)}ua.ULS.sendTraceTag(50426818,qf.Sn,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.kGb.toISOString(),this.FMc,this.E9b,K)}this.E9b=-1;this.stop("Exceeded oldest allowed local revision");this.jK(Mm.a.JXl);return!0}vCm(){let K=null,pa=
this.Hqb();for(;pa&&!pa.dma;)K=pa,pa=pa.EA;return K}Xqn(){return this.t8b()?(this.yB.event(1),this.stop("session is lost"),!0):this.Aqh()?(this.yB.event(14),ua.ULS.sendTraceTag(20029718,qf.Sn,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.jK(Mm.a.A0d),!0):!1}HIf(){const K=this.t7b();return K?K.Lc:null}Hqb(){const K=this.HIf();return K?K.Bm:null}RUc(K){return this.zLk.isEnabled?this.c2a.RUc(K):this.onk.N$c(K)&&!this.c2a.N$c(K)}xim(K){return K?qf.ckp:qf.rHj}qhe(K,pa,Ta){if(this.XZi)if(this.uk&&
!this.uk.isVisible)ua.ULS.sendTraceTag(540669727,qf.Sn,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),this.eNd+=1,this.Ish=this.sB();else return this.yB.event(K,{}),this.stop("request failed after kickout interval "+Ta),this.dCb&&this.dCb.execute(jb=>{jb.flush(this,2)}),this.jK(pa),!0;return!1}Q2f(K,pa){const Ta=K.StatusCode;return 88===Ta||89===Ta||236===Ta?(pa.KickoutDiagnostics=this.dIc(),88===Ta?(pa.Result="deleted DSS session",this.yB.event(18,
pa),this.stop("deleted DSS session"),this.jK(Mm.a.Q5f)):89===Ta?(pa.Result="expired DSS session",this.yB.event(19,pa),this.stop("expired DSS session"),this.jK(Mm.a.MUb)):(m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(K=Db.b(K.LastSavedRevisionId),this.oyb(K,4)),pa.Result="DSS session not found",this.yB.event(21,pa),this.stop("DSS session not found"),this.jK(Mm.a.tie)),!0):14===Ta?(this.stop("DSS returned an unspecified failure"),
this.jK(Mm.a.eBn),!0):104===Ta?(this.stop("this operation is disabled on the server"),!0):this.R2f("unrecognized OperationResult: "+Ta,pa)}R2f(K,pa){if(!this.f7e.contains(K))this.f7e.add(K);else if(this.qhe(11,Mm.a.izf,K))return pa.ConsecutiveErrors=this.vXd,pa.Reason=K,ua.ULS.sendTraceTag(41997899,qf.Sn,15,"DocxSaveMonitor kickout. {0}",pa),!0;this.hFa(this.rDb);return!1}GWm(K,pa,Ta){let jb=!1;if(K){const bc=this.sB().getTime()-K.creationTime.getTime();bc>=this.OKh&&(jb=!0,qf.aej(pa,this.wIm(K,bc,
Ta)),bc>=this.RZe&&10===this.yB.currentState?(this.yB.event(11,pa),this.stop("didn't save in time"),this.jK()):(this.yB.event(10,pa),this.iyj(),this.vFf()))}return jb}o1k(K){this.sa.addHandler(qf.tuj,K)}O0k(K){this.sa.addHandler(qf.CFf,K)}UDj(K){this.sa.removeHandler(qf.CFf,K)}iyj(){this.sa.raiseEvent(qf.tuj)}yAa(K){let pa;return({group:pa}=ec.a.R4(K)).returnValue?pa.Responses[0]:null}wIm(K,pa,Ta){const jb={};jb.FirstUnsavedRevisionId=K.id.toString();jb.FirstUnsavedRevisionLengthToRoot=K.uD;jb.UnsavedTimeInMs=
pa;jb.CurrentRevisionId=Ta.id.toString();jb.CurrentRevisionLengthToRoot=Ta.uD;return jb}vFf(){gk.a.wFf(rp.a.kJj)}jK(K=Mm.a.izf){this.yNk?this.iFh?(ua.ULS.sendTraceTag(509146274,qf.Sn,15,"DocxSaveMonitor would have kicked out due to: {0}. Diagnostic Log: {1}.",K,this.vxi()),0==this.JGc&&this.start()):this.uk&&!this.uk.isVisible?(ua.ULS.sendTraceTag(509146273,qf.Sn,15,"DocxSaveMonitor did not kick out because the session is not visible. Error code: {0}. Diagnostic Log: {1}",K,this.vxi()),0==this.JGc&&
this.start()):(this.stop(qf.Zvn),K===Mm.a.A0d?this.W1.value.jK(K,Object.assign(new ka.a,{Uja:4,i_:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,L6:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.W1.value.jK(K,new ka.a)):ua.ULS.sendTraceTag(19247383,qf.Sn,50,"Kickout disabled")}vxi(){const K={};var pa=Ca.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager");K.HasDataloss=!pa.JU;K.UnSavedRevisionsCount=pa.F0a;K.OldestUnsavedRevisionCreationTime=pa.JU?
"":pa.Rjc().toString();K.RevisionsWithOutServerRevisionSequenceNumbers=pa.Ofc();K.RevisionsWithServerRevisionSequenceNumbers=pa.uYd();K.RSNManager_Diagnostics=pa.eD();if(pa=Ca.a.instance?Ca.a.instance.Oa("WordEditor.RunawayDataLossMonitor"):null)K.RunawayDataLossMonitor_Diagnostics=pa.VIj;K.DocxSaveMonitor_Diagnostics=this.eD();(pa=Ca.a.instance?Ca.a.instance.Oa("WordEditor.ILastSavedToHostDetailsManager"):null)&&(K.LastSavedToHostDetailsManager_Diagnostics=pa.eD());this.uk&&(K.VisibilityState=ng.a[this.uk.zA]);
return K}eD(){const K={};this.kGb&&(K.ORT=this.kGb.toISOString());0<this.FMc&&(K.AA=this.FMc);0<this.E9b&&(K.MAA=this.E9b);0<this.eNd&&(K.LSKO=this.Ish.toISOString());this.yB&&0<=this.yB.currentState&&(K.SMS=kg[this.yB.currentState]);const pa={};m.AFrameworkApplication.fma&&(pa.S=1);ej.App.SU&&(pa.LS=1);this.tf&&(this.tf.Ko&&(pa.KO=1),this.tf.Aba&&(pa.TE=1));this.uk&&(pa.VS=ng.a[this.uk.zA]);window.navigator&&(pa.NW=!window.navigator.onLine);K.AMD=pa;return K}Dum(){const K={"Content-Type":"application/json; charset=utf-8",
"X-Requested-With":"Fetch"};m.AFrameworkApplication.buildVersion&&(K["X-OfficeVersion"]=Ia.a.qP(m.AFrameworkApplication.buildVersion));m.AFrameworkApplication.accessToken&&(K["X-AccessToken"]=Ia.a.qP(m.AFrameworkApplication.accessToken),K["X-AccessTokenTtl"]=m.AFrameworkApplication.GTa.toString());m.AFrameworkApplication.bN&&(K["X-Key"]=Ia.a.qP(m.AFrameworkApplication.bN));m.AFrameworkApplication.userType&&(K["X-UserType"]=Ia.a.qP(m.AFrameworkApplication.userType));const pa=m.AFrameworkApplication.Be.i1;
pa&&(K["X-WacCluster"]=Ia.a.qP(pa));m.AFrameworkApplication.userSessionId&&(K["X-UserSessionId"]=Ia.a.qP(m.AFrameworkApplication.userSessionId));return K}Mcm(){var K=this.tf?this.tf.networkState:null;if(1===K||3===K)ua.ULS.sendTraceTag(558158790,qf.Sn,15,"Not sending request because we dont have network.");else if(K=this.t7b()){var pa=new Sys.Net.WebRequest;pa.set_httpVerb("POST");pa.set_url(qf.serviceUrl);var Ta={};Ta.body=$a.b(sf.construct(K));Ta.headers=this.Dum();Ta.method=pa.get_httpVerb();try{"function"===
typeof window.fetch?window.fetch(pa.getResolvedUrl(),Ta).then(jb=>{ua.ULS.sendTraceTag(561551382,qf.Sn,50,"Request succeeded at the HTTP level {0}",jb.statusText);this.Dsh=jb.status;return jb.json()},jb=>{ua.ULS.sendTraceTag(561551383,qf.Sn,15,"Request failed at the HTTP level {0}",jb);return null}).then(jb=>{jb=JSON.stringify(jb);this.opl(jb,this.Dsh);return jb},()=>{ua.ULS.sendTraceTag(561551385,qf.Sn,15,"Request succeeded with null response data");return""}):ua.ULS.sendTraceTag(561002076,qf.Sn,
15,"Browser does not support Fetch.")}catch(jb){ua.ULS.sendTraceTag(561551386,qf.Sn,15,String.format("Exception when attempting to get last revision save id : {0}",jb))}}else ua.ULS.sendTraceTag(540079457,qf.Sn,15,"Target node is null, not sending last saved revision request.")}opl(K,pa){let Ta=wi.a.nil,jb=!1,bc=-1;pa===al.a.zz&&((K=this.yAa(K))?(Ta=Db.b(K.LastSavedRevisionId),K.StatusCode||(jb=!0,bc=K.StatusCode)):ua.ULS.sendTraceTag(561002077,qf.Sn,50,"Response is null when attempting to get last revision save id"));
this.sa.raiseEvent(qf.CFf,new Xd(Ta,jb,pa,bc))}static aej(K,pa){for(const Ta in pa)K[Ta]=pa[Ta]}Aln(){return tg.SessionStatusManager.instance.Ko}}qf.rHj=0;qf.serviceUrl=ej.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";qf.Zvn="kickout";qf.tuj="PS";qf.CFf="FLSR";qf.Sn=343;qf.LMn=5;qf.ckp=5E4;Object(f.a)(qf,"DocxSaveMonitor",null,[988,133]);class fh{eob(K,pa){return window.setInterval(K,pa)}vf(K){window.clearInterval(K)}}fh.instance=new fh;Object(f.a)(fh,"DocxSaveMonitorTaskManager",
null,[987]);class Fi{constructor(K){this.FZ=0;this.Cya=K}start(K){this.Cya&&(this.FZ=K,this.Cya.reset())}log(){if(this.Cya){var K={};K.RequstId=this.FZ;K.InvokeCount=this.Cya.z8c;K.InvokeFailedCount=this.Cya.A8c;K.NoOpenConnectionCount=this.Cya.ned;K.SynchronousNotificationCount=this.Cya.nrd;K.ResponseNotAvailable=this.Cya.Yld;ua.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",K)}}}Object(f.a)(Fi,"RequestLifeCycleTelemetryManager",null,[982]);class Nj{constructor(){this.W=
this.Q7e=null;this.CJl=()=>{var K=m.AFrameworkApplication.K;if(!K.$("DocxSaveMonitorEnabled"))return null;var pa=K.$("DocxSaveMonitorKickoutEnabled");const Ta=K.ic("DocxSaveMonitorIntervalMs",6E4),jb=K.ic("DocxSaveMonitorFailureIntervalMs",5E3),bc=K.ic("DocxSaveMonitorWarningTimeMs",12E4),Ic=K.ic("DocxSaveMonitorKickoutTimeMs",6E5),Uc=K.ic("DocxSaveMonitorQueueTimeoutMs",6E4),kd=K.ic("DocxSaveMonitorSentTimeoutMs",12E4),pd=K.ic("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var Fd=K.$("DocxSaveMonitorTelemetryInfoEnabled");
const le=K.$("DocxSaveMonitorInfoRequestLoggingEnabled");var jf=m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),of=K.$("DocxSaveMonitorRawWebRequestsEnabled")||jf;jf=K.$("ComponentStateLoggingPackageIsEnabled");K=K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);var tf=m.AFrameworkApplication.Be,Se=of?new $g(m.AFrameworkApplication.userSessionId,tf.i1,tf.a_d):null;
Se=new ep(tf,Se,of);Fd=Fd&&tf&&!of?new Fi(tf.bJ):null;of=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;tf=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const ye=Te.create(of,tf);ye.FSc(1);ye.FSc(2);jf=jf?this.W.Qa("Common.IComponentStateLogManager"):null;pa=new qf(Ta,jb,bc,pa,Ic,Uc,kd,pd,fh.instance,
Se,Ca.a.instance.rf("Wonca.KickoutExecutor"),Kf.a.instance,this.plc,()=>!m.AFrameworkApplication.lle||bh.a.instance.I8c,()=>ej.App.SU,Object(O.a)(Lk.a.instance,Lk.a.instance.QIa,"checkAndTriggerSessionHasExpired"),()=>m.AFrameworkApplication.ol,()=>new Date,()=>new Date,Fd,le,ye,this.Agm,jf,K,Ca.a.instance.Oa("Common.ISessionStatus")||tg.SessionStatusManager.instance,{isEnabled:of,maxRetries:tf});pa.start();ua.ULS.sendTraceTag(5884131,qf.Sn,50,"SaveMonitor initialized");return pa};this.plc=()=>{const K=
Od.StaticActiveAppFrame.za().ib.sc;return K?K.jd:null};this.Agm=()=>{const K={};m.AFrameworkApplication.mc&&(K.TM=m.AFrameworkApplication.mc.eD());Yh.WoncaApp.ZF&&(K.RS=Yh.WoncaApp.ZF.eD());ch.a.d1&&(K.CRS=ch.a.d1.eD());Od.StaticActiveAppFrame.za()&&Od.StaticActiveAppFrame.za().ib&&Od.StaticActiveAppFrame.za().ib.$c&&Od.StaticActiveAppFrame.za().ib.$c.yg&&(K.GSR=Od.StaticActiveAppFrame.za().ib.$c.yg.eD());m.AFrameworkApplication.fma&&(K.S=1);ej.App.SU&&(K.LS=1);Ld.StaticTheCoauthManager.ud()&&Ld.StaticTheCoauthManager.ud().qC.Ko&&
(K.KO=1);K.RVS=window.document.visibilityState;return Sys.Serialization.JavaScriptSerializer.serialize(K)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(ej.App.Et||ej.App.pn)this.Q7e=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.Q7e&&this.Q7e.stop("WordEditorDocxSaveMonitorPackage is being disposed")}wc(K){this.W=K;(ej.App.Et||ej.App.pn)&&K.ia("WordEditor.DocxSaveMonitor.DocxSaveMonitor",this.CJl).as("Wonca.IDocxSaveMonitor").ha()}static main(){H.a.instance.Jc(new Nj)}}
Object(f.a)(Nj,"WordEditorDocxSaveMonitorPackage",null,[0,1]);var Zh=d(933);class hk{constructor(K,pa){this.ro=K;this.QLo=Object(Zh.c)(pa)}async loadChunk(K){return this.ro.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk(K):(await this.QLo).xC.loadScript(K)}}Object(f.a)(hk,"WordOnlineChunksLoader",null,[]);class km{constructor(){this.name="WordEditor.EditorAi.Entry"}wc(K){K.ia("WordEditor.EditorAi.WordOnlineChunksLoader",()=>new hk(m.AFrameworkApplication.K,K.Qa("Common.IDynamicScriptLoaderProvider")))}init(){}dispose(){}static main(){H.a.instance.Jc(new km)}}
Object(f.a)(km,"EditorAiEntryPackage",null,[0,1]);class lm{constructor(K,pa,Ta,jb,bc,Ic,Uc){this.z0d=K;this.BQi=pa;this.n3m=Ta;this.Nig=jb;this.hzf=bc;this.Sb=Ic;this.JJ=Uc;this.MZn=(kd,pd,Fd)=>{2===Fd&&this.Nig.S0l().catch(le=>{ua.ULS.$w(508965832,3041,10,le,"Failed to initialize Copilot integration package")});return 32};this.bpj=(kd,pd)=>{pd.z4&&(Object(Ce.a)("AiMakerInitializationTriggered"),this.z0d.pna(this.bpj),this.z0d.Pd(),this.hzf.Xbp(),this.JJ.Lk(19,()=>{this.hzf.Q_h&&this.c6o()}))};this.P3n=
async(kd,pd)=>{pd.z4&&this.n3m.execute(Fd=>{Fd.findImageAndRegisterHandler()})}}initialize(){this.z0d.aaa(this.bpj);this.z0d.initialize();this.BQi.aaa(this.P3n);this.BQi.initialize();this.Sb.fb(rf.a.z5f,Ad.a.application,this.MZn,1028)}c6o(){this.hzf.show().catch(K=>{ua.ULS.$w(508965831,3041,10,K,"Failed to show document wizard")})}}Object(f.a)(lm,"AiMakerInitializer",null,[]);var Rl=d(1843),Oj=d(1014);class Fn extends Oj.a{constructor(K){var pa;super("BooleanFeatureGateConditionId");this.Tm=K.Tm;
this.Dpb=K.Dpb;this.defaultValue=null!==(pa=K.defaultValue)&&void 0!==pa?pa:!1}initialize(){super.initialize();const K=m.AFrameworkApplication.K;K.Rn(()=>{const pa=K.getBooleanFeatureGate(this.Dpb,this.defaultValue);this.Jg(pa)})}Jg(K){super.Jg(K);ua.ULS.sendTraceTag(512369937,3028,50,this.aR(this.Tm,K,`featureGate=${this.Dpb}`))}}Object(f.a)(Fn,"BooleanFeatureGateCondition",Oj.a,[]);var em=d(759);class dn extends Oj.a{constructor(K){super(K.Xxl);this.Fug=K}initialize(){super.initialize();m.AFrameworkApplication.K.Rn(()=>
{var K,pa,Ta,jb,bc;const Ic=null!==(pa=null===(K=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===K?void 0:K.WACDatacenter)&&void 0!==pa?pa:"unknown";K=null!==(jb=null===(Ta=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===Ta?void 0:Ta.Ring)&&void 0!==jb?jb:"unknown";Ta=null===(bc=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===bc?void 0:bc.Host;bc=this.F8c(Ic,K,Ta);this.Jg(bc);ua.ULS.sendTraceTag(509747520,3028,50,this.aR(this.Fug.Tm,bc,`datacenter=${Ic}`))})}F8c(K,
pa,Ta){if("1"===pa||"unknown"===K||this.Fug.m3l.includes(Ta))return!0;const jb=K.toUpperCase();return!this.Fug.CUl.some(bc=>jb.includes(bc))}}Object(f.a)(dn,"EditorAiDatacenterCondition",Oj.a,[]);class Lo extends Oj.a{constructor(K,pa,Ta){super("AiMakerConsentGroupConditionId");this.Tm=K;this.Dea=pa;this.defaultValue=Ta}initialize(){super.initialize();this.Dea.execute(K=>{var pa;K.isFeatureEnabled("AiMaker",null!==(pa=this.defaultValue)&&void 0!==pa?pa:!1).then(Ta=>{this.Jg(Ta);return null})})}Jg(K){super.Jg(K);
ua.ULS.sendTraceTag(509752010,3028,50,this.aR(this.Tm,K))}}Object(f.a)(Lo,"AiMakerConsentGroupCondition",Oj.a,[]);class Gi extends Oj.a{constructor(K){super("RegionComposerEnabledConditionId");this.Tm=K.Tm}initialize(){super.initialize();this.Jg(ch.a.dck.q0)}Jg(K){super.Jg(K);ua.ULS.sendTraceTag(508965830,3028,50,this.aR(this.Tm,K))}}Object(f.a)(Gi,"RegionComposerEnabledCondition",Oj.a,[]);var en=d(1017),uk;(function(K){K[K.SYh=0]="bypass";K[K.f$n=1]="passed";K[K.Ihj=2]="notPassed";K[K.mfq=3]="overridenWithNoPass"})(uk||
(uk={}));Object(f.b)("LicenseConditionResult",uk);class pj extends Oj.a{constructor(K,pa,Ta){super("LicenseConditionId");this.appSettings=pa;this.Fif=Ta;this.Tm=K.Tm;this.iYa=K.iYa;this.lec=K.lec}initialize(){super.initialize();this.appSettings.Rn(()=>{this.Vup().catch(K=>{ua.ULS.$w(508875776,3028,10,K,"Failed to update license condition for {0}",this.iYa)})})}async Vup(){const K=await this.CLb();this.Jg(K!==uk.Ihj);this.YNo(K)}async CLb(){return this.Anf()?uk.SYh:await this.$5c()?uk.f$n:uk.Ihj}Anf(){return this.lec?
this.appSettings.getBooleanFeatureGate(this.lec,!1):!1}async $5c(){var K=await Object(Zh.c)(this.Fif);const pa=en.b.Vva();K=await K.isFeatureEnabled(this.iYa,!1);ua.ULS.sendTraceTag(508875286,3028,50,"License check for {0} trigger took: {1}ms",this.Tm,pa.c_c);return K}YNo(K){K=Object.entries({iYa:this.iYa,CUp:K===uk.SYh}).map(([pa,Ta])=>`${pa}=${Ta}`).join(", ");ua.ULS.sendTraceTag(508875285,3028,50,this.aR(this.Tm,this.cma,K))}}Object(f.a)(pj,"LicenseCondition",Oj.a,[]);class Jj extends pj{constructor(K,
pa,Ta){super({Tm:K,iYa:"Copilot",lec:"Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped"},pa,Ta)}}Object(f.a)(Jj,"CopilotLicenseCondition",pj,[]);const Uo="CH DE FR EU UK NO SE NL PIE".split(" ");class Sn extends em.a{constructor(K,pa,Ta){const jb=new Fn({Tm:16,Dpb:"Microsoft.Office.WordOnline.IsAiMakerEnabled"});K=new Rl.a(16,K,pa,{h_b:!0,MR:!1,Qmc:!1,Pmc:!1,LR:!1});pa=new dn({Xxl:"AiMakerDocumentWizardDatacenterConditionId",Tm:16,CUl:Uo,m3l:["Exchange Online Consumer","OneDriveWOPI"]});const bc=
new Lo(16,Ta),Ic=new Gi({Tm:16});Ta=new Jj(16,m.AFrameworkApplication.K,Ta);super(16,new yb.a([jb,K,pa,bc,Ic,Ta]),null,3028,"AiMakerDocumentWizardTriggered")}}Object(f.a)(Sn,"AiMakerDocumentWizardTriggerModel",em.a,[]);var Vo=d(1015);class Tn extends Oj.a{constructor(K){super("AiImageInsertedConditionId");this.j_=K;this.isInitialized=!1;this.ojj=()=>{this.Jg(!0)}}initialize(){this.isInitialized||(super.initialize(),this.isInitialized=!0,this.j_.execute(K=>{var pa;null===(pa=K.add_onImageWasInsertedHandler)||
void 0===pa?void 0:pa.call(K,this.ojj)}))}Pd(){this.isInitialized&&(this.j_.execute(K=>{var pa;null===(pa=K.remove_onImageWasInsertedHandler)||void 0===pa?void 0:pa.call(K,this.ojj)}),this.isInitialized=!1,super.Pd())}}Object(f.a)(Tn,"AiImageInsertedCondition",Oj.a,[]);class Qm extends em.a{constructor(K,pa){const Ta=new Fn({Tm:19,Dpb:"Microsoft.Office.WordOnline.IsAiImageRemakeEnabled"}),jb=new Tn(K),bc=new Jj(19,m.AFrameworkApplication.K,pa);super(19,new yb.a([Ta,jb,bc]),null,3028,"OnTriggerAiImageRemakeEventKey");
this.j_=K;this.Dea=pa;this.SRi=!1;this.mXk()}$9a(K){super.$9a(K);super.qSd()&&super.Erb("AiImageInsertedConditionId");"AiImageInsertedConditionId"!==K||this.SRi||(this.Byo(),this.SRi=!0)}mXk(){m.AFrameworkApplication.va.fb(rf.a.Hsf,Ad.a.view,()=>8,1028)}Byo(){m.AFrameworkApplication.va.Zw(rf.a.Hsf,Ad.a.view,()=>8)}}Object(f.a)(Qm,"AiImageRemakeTriggerModel",em.a,[]);class Bn{constructor(K){this.vfd=async()=>{const pa=await this.N7i.value;await this.M7c(pa);return pa};this.i7n=H.a.instance;this.N7i=
new Ec.a(K);this.r7m=new Ec.a(this.vfd)}async e7(){await this.N7i.value}async kpb(){return await this.r7m.value}async M7c(K){H.a.instance.Jc(K);return new Promise(pa=>{this.i7n.registerOnPackageInit(K.name,pa)})}}Object(f.a)(Bn,"LazyLoadedPackage",null,[]);class Am{constructor(){this.bii=new Bn(()=>Promise.all([d.e(5),d.e(2),d.e(11)]).then(d.bind(null,2220)).then(K=>K.instance));this.WBl=new Bn(()=>Promise.all([d.e(5),d.e(2),d.e(33)]).then(d.bind(null,2228)).then(K=>K.instance))}async U0l(){await this.bii.kpb()}async S0l(){await this.bii.kpb();
await this.WBl.kpb()}}Object(f.a)(Am,"AiMakerPackageManager",null,[]);var Mo=d(311),lr={get EXl(){var K=null===aiMakerDocumentWizardUx||void 0===aiMakerDocumentWizardUx?void 0:aiMakerDocumentWizardUx.interop;if(!K)throw Error("aiMakerDocumentWizardUx chunk is accessed before loading");return K}};class Gn{constructor(K){this.container=K}getDocumentContentGenerator(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentContentGenerator")}getCanvasService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService")}getFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardFocusManager")}getDocumentLayoutHtmlHelper(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentLayoutHtmlHelper")}getTelemetryLogger(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerTelemetryLogger")}getSurveysManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardSurveysManager")}getStylesService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerStylesService")}getImageRemakeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService")}getImageRemakeSizeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeSizeService")}getImageRemakeFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeFocusManager")}getPromptSuggestionProvider(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerPromptSuggestionProvider")}getResumeBioInfoEnricher(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerResumeBioInfoEnricher")}}
Object(f.a)(Gn,"AiMakerDocumentWizardDependenciesImpl",null,[]);class vn{constructor(K,pa,Ta,jb){this.pPg=K;this.Nig=pa;this.Dg=Ta;this.sc=jb;this.m_i=!1;this.$Yn=async()=>{this.m_i=!0;await Promise.all([this.Nig.U0l(),this.pPg.loadChunk("aiMakerDocumentWizardUx")]);return lr.EXl};this.L$j=new Ec.a(this.$Yn)}get Q_h(){return this.Dg.Fea(this.sc.jd,{MR:!1,$fa:!1,nta:!1,LR:!1})}Xbp(){this.m_i||this.L$j.value.catch(K=>{ua.ULS.$w(508965829,3041,10,K,"Failed to load document wizard UX interop")})}async show(){const K=
await this.L$j.value;this.Q_h?(this.mSh||(this.mSh=this.yNn(K)),this.mSh.open()):ua.ULS.sendTraceTag(508965828,3041,50,"Document wizard show attempt prevented")}yNn(K){return this.mountApp(K)}mountApp(K){const pa=Object(Mo.a)("EditorContainer");return K.mountApp(pa,new Gn(Ca.a.instance))}}Object(f.a)(vn,"AiMakerDocumentWizardUx",null,[]);class Vq extends Vo.a{get name(){return"WordEditor.AiMaker.Entry"}ifa(K){this.container=K;K.ia("WordEditor.AiMaker.AiMakerPackageManager",()=>new Am).ha();K.ia("WordEditor.AiMaker.AiMakerDocumentWizardUx",
()=>new vn(K.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"),K.resolve("WordEditor.AiMaker.AiMakerPackageManager"),K.resolve("Box4.IParagraphReader"),Od.StaticActiveAppFrame.za().ib.sc)).ha()}kfa(){(new lm(new Sn(this.container.resolve("Box4.IParagraphReader"),Od.StaticActiveAppFrame.za().ib.sc,this.container.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),new Qm(this.container.Qa("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService"),this.container.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),
this.container.Qa("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService"),this.container.resolve("WordEditor.AiMaker.AiMakerPackageManager"),this.container.resolve("WordEditor.AiMaker.AiMakerDocumentWizardUx"),m.AFrameworkApplication.va,cb.a.get_instance())).initialize()}jfa(){}static main(){H.a.instance.Jc(new Vq)}}Object(f.a)(Vq,"AiMakerEntryPackage",Vo.a,[]);var ho={get interop(){var K=aiInserterUx.interop;if(!K)throw Error("aiInserterUx chunk is accessed before loading");return K}};class Er{constructor(K,
pa){this.spe=K;this.Xmd=pa;this.Xvb=async(Ta,jb)=>{jb.z4&&(Object(Ce.a)("AiInserterInitializationTriggered"),this.spe.pna(this.Xvb),this.spe.Pd(),[,Ta]=await Promise.all([this.K5f(),Promise.all([d.e(5),d.e(2),d.e(28)]).then(d.bind(null,2221))]),Ta.main(ho.interop))}}initialize(){this.spe.aaa(this.Xvb);this.spe.initialize()}async K5f(){return m.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiInserterUx"):(await Object(Zh.c)(this.Xmd)).xC.loadScript("aiInserterUx")}}
Object(f.a)(Er,"AiInserterInitializer",null,[]);class Ki extends Oj.a{constructor(K,pa){super("AiInserterConsentGroupConditionId");this.Dea=K;this.defaultValue=pa}initialize(){super.initialize();this.Dea.execute(K=>{K.isFeatureEnabled("AiInserter",!!this.defaultValue).then(pa=>{this.Jg(pa);return null})})}Jg(K){super.Jg(K)}}Object(f.a)(Ki,"AiInserterConsentGroupCondition",Oj.a,[]);const Bs="CH DE FR EU UK NO SE NL PIE".split(" ");class Wo extends Oj.a{constructor(){super("AiInserterDatacenterConditionId")}initialize(){super.initialize();
m.AFrameworkApplication.K.Rn(()=>{var K,pa,Ta,jb;const bc=null!==(pa=null===(K=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===K?void 0:K.WACDatacenter)&&void 0!==pa?pa:"unknown";K=null!==(jb=null===(Ta=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===Ta?void 0:Ta.Ring)&&void 0!==jb?jb:"unknown";Ta=this.F8c(bc,K);this.Jg(Ta)})}F8c(K,pa){if("1"===pa||"unknown"===K)return!0;const Ta=K.toUpperCase();return!Bs.some(jb=>Ta.includes(jb))}}Object(f.a)(Wo,"AiInserterDatacenterCondition",
Oj.a,[]);class If extends em.a{constructor(K){const pa=new Fn({Tm:17,Dpb:"Microsoft.Office.WordOnline.IsAiInserterEnabled"}),Ta=new Ki(K),jb=new Wo;K=new Jj(17,m.AFrameworkApplication.K,K);super(17,new yb.a([pa,Ta,jb,K]),null,3028,"AiInserterAppTriggered")}}Object(f.a)(If,"AiInserterTriggerModel",em.a,[]);class Wq extends Vo.a{get name(){return"WordEditor.AiInserter.Entry"}ifa(K){this.container=K}kfa(){(new Er(new If(this.container.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),
this.container.Qa("Common.IDynamicScriptLoaderProvider"))).initialize()}jfa(){}static main(){H.a.instance.Jc(new Wq)}}Object(f.a)(Wq,"AiInserterEntryPackage",Vo.a,[]);var Mn;(function(K){K[K.NDp=0]="version0";K[K.version1=1]="version1"})(Mn||(Mn={}));Object(f.b)("FirstRunExperienceVersion",Mn);class Rk{get rif(){return"Word"}get x_h(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return Mn.NDp}get currentVersion(){return Mn.version1}get Qgn(){return Rk.isEnabled()&&m.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get Epc(){return Rk.isEnabled()&&
m.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get v3i(){return m.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get Dam(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get zej(){return 24}get fIj(){return 4E3}get tmd(){return""}static isEnabled(){const K=m.AFrameworkApplication.sessionStartInfoSettings?m.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==K&&"Automation"!==K}}
Object(f.a)(Rk,"FirstRunExperienceLauncherSettings",null,[1109]);class qo{constructor(K){this.vih=K}u6o(K){void 0==m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CEBlockPopupEnabled",void 0)&&this.vih&&this.vih.v6o(K)}}Object(f.a)(qo,"FirstRunExperienceManager",null,[1011]);class vj{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}wc(K){this.W=K;this.W.ia("WordEditor.FirstRunExperience.IFirstRunExperienceManager",()=>new qo(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).ha()}init(){const K=
this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");K&&K.u6o(new Rk)}dispose(){}}Object(f.a)(vj,"WordEditorFirstRunExperiencePackageManager",null,[0,1]);class Cp{constructor(K,pa){this.AOa=(Ta,jb,bc,Ic,Uc)=>{var kd,pd;if(1===bc)return Uc=null===(pd=null===(kd=jb.view.lb)||void 0===kd?void 0:kd.gb)||void 0===pd?void 0:pd.currentSelection,(null===Uc||void 0===Uc?0:Uc.PL)||Ta===rf.a.Lpd&&(null===Uc||void 0===Uc?0:Uc.qXa)?32:8;if(2===bc){kd=this.Sib.Nj.isVisible;this.Sib.lA(!0,
1===Uc);pd=0;switch(Ta){case rf.a.pUj:Uc=1;break;case rf.a.qUj:Uc=2;break;case rf.a.Oze:Uc=2;pd=1;break;case rf.a.Pze:Uc=1;pd=2;break;case rf.a.Lpd:Uc=1;pd=3;break;case rf.a.rDe:Uc=this.Sib.xgc;break;default:pd=Uc=0}kd&&Ta===rf.a.AOa||this.Sib.FTo(Uc,pd);return 32}return 8};this.Hae=(Ta,jb,bc,Ic,Uc)=>{this.toggleButton(Uc,!1);return this.Btl(bc)};this.rDe=(Ta,jb,bc,Ic,Uc)=>this.Sib.Nj.isVisible?this.Hae(Ta,jb,bc,Ic,Uc):this.AOa(Ta,jb,bc,Ic,Uc);this.ga=K;this.Sib=pa}dispose(){this.Sib&&this.Sib.dispose()}Wb(){this.ga.ra(rf.a.rDe,
Ad.a.view,this.rDe);this.ga.fb(rf.a.AOa,Ad.a.view,this.AOa,4);this.ga.ra(rf.a.Hae,Ad.a.view,this.Hae);this.ga.fb(rf.a.Oze,Ad.a.view,this.AOa,4);this.ga.ra(rf.a.Pze,Ad.a.view,this.AOa);this.ga.ra(rf.a.Lpd,Ad.a.view,this.AOa)}Btl(K){if(1===K)return 32;this.Sib.lA(!1);return 32}toggleButton(K,pa){K&&(K[lk.a.On]=pa)}}Object(f.a)(Cp,"FormatPictureActor",null,[13]);class fp{constructor(K){this.PIb=!1;this.Nj=K}get xgc(){return this.Nj.hMl}FTo(K,pa){switch(K){case 0:case 1:this.Nj.w7o(pa);break;case 2:this.Nj.I7o(pa)}}lA(K,
pa=!1){this.PIb||this.EVf();K?this.Nj.tS(pa):this.Nj.fta()}dispose(){this.Nj.dispose()}EVf(){this.PIb||(this.Nj.initialize(),this.PIb=!0)}}Object(f.a)(fp,"FormatPictureManager",null,[991,13]);var Zp=d(345),Bm=d(187),$p=d(147);class lh{}lh.wS=$p.a.L4d;lh.xtc=1;lh.ytc=WordEditorIntl.WordEditorStrings.L_FormatPicture;lh.uAa="FormatPictureTaskPaneData";Object(f.a)(lh,"FormatPicturePaneConstants",null,[]);class Fr{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=
this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(f.a)(Fr,"FormatPictureTaskPaneProps",null,[]);class Zi{constructor(K,pa,Ta,jb){this.f8e=0;this.jGc=this.Eqa=null;this.FLd=this.wLd=this.xGd=this.Exd=this.YOd=0;this.Wt=this.o6b=!1;this.cPe=0;this.D2n=()=>{this.RNj()};this.wn=()=>{let bc=!1;bc=this.Xjo()||bc;bc=
this.Ycb()||bc;bc=this.Xcb()||bc;bc=this.Duc()||bc;(bc=this.Tjo()||bc)&&this.Cn()};this.q6=K;this.gDk=pa;this.M_e=Ta;this.Pg=jb}initialize(){this.H2();this.Ina()}get isVisible(){return this.Wt}tS(K){this.Upd(K)}fta(){this.sha();this.m0m()}w7o(K){this.YPj(K,1)}I7o(K){this.YPj(K,2)}YPj(K,pa){this.cPe=pa;this.f8e=K}get hMl(){return this.cPe}dispose(){}H2(){this.q6.NUa();this.f8e=this.cPe=0}get focusManager(){return this.gDk.value}get Sb(){return this.M_e.value}Oab(){return!!this.focusManager.currentScope&&
this.focusManager.currentScope.name===lh.wS}RNj(){this.focusManager.Bg(lh.wS)}Ina(){const K=this.focusManager.ge(lh.wS);K.parent=ug.AFrame.mq;K.Bja(this.D2n)}sha(){this.Oab()&&this.focusManager.Bg(this.focusManager.RW)}Upd(K){lg.UISurfaces.Hv().then(pa=>{pa.showTaskPane(lh.wS,this.MB(K));this.isVisible&&K&&this.focusManager.Bg(lh.wS);return null})}Cn(){lg.UISurfaces.Hv().then(K=>{K.updateTaskPane(lh.wS,this.MB(!1));return null})}m0m(){lg.UISurfaces.Hv().then(K=>{K.hideTaskPane(lh.wS,2);return null})}MB(){const K=
new Fr;this.T_o(K);return Object.assign(new wh.a,{title:lh.ytc,hideHeader:!1,width:320,location:2,contentProps:K,onOpen:pa=>{this.Wt=!0;Od.StaticActiveAppFrame.za().$5a(this.wn);Od.StaticActiveAppFrame.za().Ie();this.RNj();this.Pg.vcc(lh.wS,pa)},onClose:()=>{this.sha();this.Wt=!1;Od.StaticActiveAppFrame.za().vvc(this.wn);Od.StaticActiveAppFrame.za().Ie()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}T_o(K){const pa=F.e().numberFormatInfo;K.section=this.f8e;K.numberFormatInfo=
"object"===typeof pa?pa:null;K.title=this.Eqa;K.description=this.jGc;K.topCrop=this.YOd;K.bottomCrop=this.Exd;K.leftCrop=this.xGd;K.rightCrop=this.wLd;K.rotationAngle=this.FLd;K.onTitleChange=this.onTitleChange();K.onDescriptionChange=this.onDescriptionChange();K.onCropSpinButtonChange=this.onCropSpinButtonChange();K.onRotationSpinButtonChange=this.onRotationSpinButtonChange();K.disabled=this.o6b}onTitleChange(){return K=>{if(K!==this.Eqa){this.Eqa=K;var pa=new Zp.DictionaryPropertySet;pa.setValue(Bm.a.fsb,
K);this.Sb.Pb(ea.a.Znd,2,pa);this.Cn()}}}onDescriptionChange(){return K=>{if(K!==this.jGc){var pa=new Zp.DictionaryPropertySet;pa.setValue(Bm.a.f0,K);this.jGc=K;this.Sb.Pb(ea.a.I_b,2,pa);this.Cn()}}}onCropSpinButtonChange(){return(K,pa)=>{const Ta=new Zp.DictionaryPropertySet;switch(pa){case 0:this.YOd=K;Ta.setValue(Bm.a.ksb,K);this.Sb.Pb(rf.a.f7c,2,Ta);break;case 1:this.Exd=K;Ta.setValue(Bm.a.hsb,K);this.Sb.Pb(rf.a.Z6c,2,Ta);break;case 2:this.xGd=K;Ta.setValue(Bm.a.isb,K);this.Sb.Pb(rf.a.$6c,2,Ta);
break;case 3:this.wLd=K,Ta.setValue(Bm.a.jsb,K),this.Sb.Pb(rf.a.a7c,2,Ta)}this.Cn()}}onRotationSpinButtonChange(){return K=>{this.FLd=K;const pa=new Zp.DictionaryPropertySet;pa.setValue(Bm.a.n7c,0);pa.setValue(Bm.a.vX,K);this.Sb.Pb(ea.a.qba,2,pa);this.Cn()}}Xjo(){const K=2===this.Sb.Pb(ea.a.Znd,1,null),pa=K!==this.o6b;this.o6b=K;return pa}Ycb(){var K=new Zp.DictionaryPropertySet;this.Sb.Pb(ea.a.Ycb,2,K);K=K.ja(Bm.a.fsb,"");const pa=K!==this.Eqa;this.Eqa=K;return pa}Xcb(){var K=new Zp.DictionaryPropertySet;
this.Sb.Pb(ea.a.Xcb,2,K);K=K.ja(Bm.a.f0,"");const pa=K!==this.jGc;this.jGc=K;return pa}Duc(){var K=new Zp.DictionaryPropertySet;this.Sb.Pb(rf.a.Uid,2,K);const pa=K.ja(Bm.a.ksb,0),Ta=K.ja(Bm.a.hsb,0),jb=K.ja(Bm.a.isb,0);K=K.ja(Bm.a.jsb,0);const bc=pa!==this.YOd||Ta!==this.Exd||jb!==this.xGd||K!==this.wLd;this.YOd=pa;this.Exd=Ta;this.xGd=jb;this.wLd=K;return bc}Tjo(){var K=new Zp.DictionaryPropertySet;this.Sb.Pb(ea.a.uYb,2,K);K=K.ja(Bm.a.vX,0);const pa=K!==this.FLd;this.FLd=K;return pa}}Object(f.a)(Zi,
"ReactFormatPicturePane",null,[981,13]);class Xj{constructor(){this.aCd=this.W=null}get name(){return"WordEditor.FormatPicture"}wc(K){this.W=K;this.W.ia("WordEditor.FormatPicture.IFormatPictureManager",()=>new fp(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"))).ha();this.W.ia("WordEditor.FormatPicture.IFormatPicturePane",()=>new Zi(fk.a.instance,new Ec.a(()=>Gg.FocusManager.instance()),new Ec.a(()=>m.AFrameworkApplication.va),mf.a.instance)).ha();this.W.ia("WordEditor.FormatPicture.FormatPictureActor",
()=>new Cp(m.AFrameworkApplication.va,this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"))).ha()}init(){if(ch.a.iPg||ch.a.cck)this.aCd=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.aCd.Wb(),Od.StaticActiveAppFrame.za().Ie()}dispose(){this.aCd&&this.aCd.dispose()}static main(){H.a.instance.Jc(new Xj)}}Object(f.a)(Xj,"WordEditorFormatPicturePackage",null,[0,1]);var Us=d(1548),Si=d(555),Un=d(1290);class mr extends Ck.a{constructor(){super();this.Prompt=0;this.FileId=
null}lm(){return $l.a.YSm}static construct(K,pa){const Ta=new mr;Ta.FileId=K;Ta.Prompt=pa;return Ta}}Object(f.a)(mr,"GraphMergeConsentChangedRequest",Ck.a,[]);var fn=d(540);class aq extends fn.a{constructor(){super();this.Location=this.FileId=null}lm(){return $l.a.sbo}static construct(K,pa){const Ta=new aq;Ta.FileId=K;Ta.Location=pa;return Ta}}Object(f.a)(aq,"PlayGraphMergeReplayRequest",fn.a,[]);class Hq{constructor(K,pa,Ta,jb,bc,Ic=null,Uc=null){this.hm=!1;this.BQ=null;this.mEh=this.uZe=!1;this.urf=
()=>{if(this.JFa.rae)this.uZe=!0;else if(this.uZe=!1,!this.EPo){this.mEh=!0;var kd=this.yQa.IDa;ua.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",kd===Un.a.vrf);if(kd===Un.a.BWc||kd===Un.a.vrf)kd=mr.construct(this.gT(),kd),this.pu(kd)}};this.NMi=(kd,pd)=>{pd&&pd.$8f&&pd.$8f.Htf&&!this.JFa.z3i&&(this.JFa.V5j(),this.JFa.rae=!0,this.pu(pd.$8f.Htf))};this.LMi=(kd,pd)=>{pd&&pd.Iud&&this.JFa.V5j()};this.MMi=(kd,pd)=>{pd&&(pd.ShowMergePrompt&&this.yQa.VFj(this.urf),m.AFrameworkApplication.Ug&&
(m.AFrameworkApplication.Ug.SessionMergeInfo|=pd.PartMergeInfo))};this.gT=K;this.oQd=Ta;this.JFa=jb;this.yQa=bc;this.oQd&&this.oQd.T0k(this.NMi);this.DH=Ic||Kf.a.instance;if(!Uc){const kd=new Si.a;Uc=pd=>kd.Yaa(0,pd)}this.Zok=Uc}get cun(){return this.uZe}get EPo(){return this.mEh}pu(K){const pa=new mk.a;pa.ar=K;pa.status=Bh.a.nH;pa.GE="GraphMerge";const Ta=this.Zok(()=>{this.Xld(pa,K.lm()===$l.a.G$h)});Ta.CG(pa);Ta.w_()}Xld(K,pa){this.hm||(pa&&(this.JFa.rae=!1),2===K.statusCode&&!ta.a.lTb(K.gk)&&
1===K.gk.length&&K.gk[0]?(K=K.gk[0],K.StatusCode?this.JFa.wAg():pa&&this.yQa.VFj(this.urf),this.DH.FPa(K),this.cun&&this.urf()):this.JFa.wAg())}Gvb(K){this.BQ=K;this.BQ.dKb(this.LMi);this.BQ.Occ(this.MMi)}dispose(){this.hm||(this.oQd&&this.oQd.KAo(this.NMi),this.BQ&&(this.BQ.tZb(this.LMi),this.BQ.$kd(this.MMi)),this.hm=!0)}}Object(f.a)(Hq,"GraphMergeBackupManager",null,[1008,13]);class cl{constructor(K,pa=null,Ta=null,jb=null){this.HLe=0;this.nYe=!1;this.Mrh=new Date(0);this.rae=!1;this.yQa=K;this.sB=
pa||(()=>new Date);Ta||(Ta=m.AFrameworkApplication.K?m.AFrameworkApplication.K.ic("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.UEk=Ta;jb||(jb=m.AFrameworkApplication.K?m.AFrameworkApplication.K.ic("WordEditorGraphMergeMaxBackups",1):1);this.zuh=jb}get Jsn(){return+this.sB()-+this.Mrh<this.UEk}get z3i(){return this.yQa.IDa===Un.a.automatic?!1:this.yQa.IDa===Un.a.BWc?!0:this.nYe||this.rae||this.Jsn}V5j(){this.Mrh=this.sB();this.HLe++;this.HLe>=this.zuh&&this.wAg()}wAg(){this.nYe||(this.nYe=
!0,ua.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.HLe,this.zuh))}}Object(f.a)(cl,"GraphMergeBackupThrottler",null,[1007]);class Iq{constructor(K,pa,Ta=null){this.Hkh=!1;this.H9=K;this.ovk=pa;null==Ta&&(Ta=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.z5e=Ta?Un.a.automatic:Un.a.yre}get IDa(){return this.z5e}VFj(K){if(!this.Hkh&&this.IDa===Un.a.yre){var pa=
this.ovk.value;pa&&pa.isFeatureEnabled(48)&&(this.Hkh=!0,this.H9.execute(Ta=>{Ta.G6o(()=>{this.zyl(K)},()=>{this.BWc(K)})}))}}BWc(K){this.IDa===Un.a.yre&&(ua.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.z5e=Un.a.BWc,K());this.nCj()}zyl(K){this.IDa===Un.a.yre&&(ua.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.z5e=Un.a.vrf,K());this.nCj()}nCj(){this.H9.execute(K=>{K.g0m()})}}Object(f.a)(Iq,"GraphMergeCollectionConsentManager",
null,[1006]);class pq extends Sys.EventArgs{constructor(K){super();this.$8f=K}}Object(f.a)(pq,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var Xq=d(769),Dp=d(1134),io=d(660),dl;(function(K){K[K.none=0]="none";K[K.Zj=1]="failure";K[K.fAa=2]="crash";K[K.success=3]="success"})(dl||(dl={}));Object(f.b)("GraphMergeReplayReason",dl);var Nn=d(1883),sj=d(1881),ig=d(63),om=d(233),xh=d(192);class sl{constructor(K,pa,Ta,jb,bc,Ic){this.Wng=this.Xg=null;this.dad=this.OOg=!1;this.Rl=null;this.zpd=K.runtime.zpd;
this.lu=K;this.gf=pa;this.jh=Ta;this.Wo=jb;this.nyl=bc;this.MLi=Ic}}Object(f.a)(sl,"GraphNodeComplexMergeState",null,[]);var zg=d(1631),Gr=d(1613);class yh{constructor(K,pa=null){this.vg=K;this.p9b=pa||this.P3c()}get Pub(){return this.p9b}get gf(){return this.vg}P3c(){return[Object(O.a)(this,this.j9o,"simpleMerge"),Object(O.a)(this,this.yxl,"complexMerge")]}$_o(K,pa,Ta,jb,bc,Ic){pa=new sl(K,Ta,new Ec.a(()=>new zg.a(jb?jb.Fm:null,bc)),new Ec.a(()=>new zg.a(jb?jb.Fm:null,Ic)),new Ec.a(()=>new zg.a(Ic,
bc)),pa.H$h(bc,()=>K.runtime.rc));pa.Xg=jb.rbc;pa.Wng=new om.a;return pa}merge(K,pa,Ta,jb,bc,Ic){pa=this.$_o(K,pa,Ta,jb,bc,Ic);Ta=!0;for(jb=0;jb<this.Pub.length&&Ta;jb++)(Ta=(0,this.Pub[jb])(pa))||K.logger.Qie("GraphNodeMerge.GetMergeFunctions()",jb);if(K=pa.dad&&pa.Rl?new Gr.a(pa.Rl,!1):null)switch(K.oZo(pa.Xg),(K?K.Fm:bc).yc){case ig.a.Ud:pa.lu.runtime.Bte.Lzl.Z(K.Fm.id,K.Fm);break;case ig.a.Kmb:pa.lu.runtime.Bte.udl.Z(K.Fm.id,K.Fm);break;case ig.a.lL:pa.lu.runtime.Bte.rwl.Z(K.Fm.id,K.Fm);break;
case ig.a.paragraphNode:pa.lu.runtime.fke.add(K.Fm.id)}return{returnValue:pa.dad,Rl:K}}j9o(K){if(K.lu.runtime.rc&&K.lu.runtime.rc.yrb(1000005)&&0<K.Xg.count)return!0;var pa=K.MLi.Hre;return K.Wo.value.h9c(pa)&&K.nyl.value.h9c(pa)?K.jh.value.h9c(pa)?!0:(pa=K.Wo.value.Jf,K.dad=!0,K.Rl=pa.WO(),!1):(K.dad=!0,!1)}yxl(K){const pa=K.Wo.value.Jf;K.zpd&&xh.a.instance.Ua(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",pa.id,pa.yc);const Ta=K.MLi.IKg(K);K.dad=Ta;xh.a.instance.Ua(4018184,1,Ta?5:4,
"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",Ta?"Succeeded":"Failed",pa.id,pa.yc,!!K.Rl);return Ta}}Object(f.a)(yh,"GraphNodeMerge",null,[997]);var qq;(function(K){K[K.none=0]="none";K[K.DWp=1]="crashesOnly";K[K.jhq=2]="rejectionsAndCrashes";K[K.VSp=3]="allMerges"})(qq||(qq={}));Object(f.b)("GraphMergeBackupCases",qq);var fm=d(1508),nl=d(1453);class kn extends Ck.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=
this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=fm.a.none;this.RequestId=this.ObjectSpaceId=null;this.Source=nl.a.none;this.Reason=dl.none;this.Prompt=0}lm(){return $l.a.G$h}static construct(K,pa,Ta,jb,bc,Ic,Uc,kd,pd,Fd,le){const jf=new kn;jf.FileId=K;jf.BaseRevisions=pa;jf.TheirRevisions=Ta;jf.YourRevisions=jb;jf.IgnoreConflictsInLastServerRevision=bc;jf.MergeHint=Ic;jf.ObjectSpaceId=Uc?Db.a(Uc):null;jf.RequestId=kd?Db.a(kd):null;jf.Source=pd;jf.Reason=Fd;jf.Prompt=le;
return jf}}Object(f.a)(kn,"CreateGraphMergeReplayRequest",Ck.a,[]);var fs=d(872),vk=d(257),ok=d(16),ln=d(2009),mn=d(2090);class On{constructor(K,pa=null,Ta=null){this.DWl=(jb,bc)=>{let Ic=jb;var Uc=bc,kd=this.Ljb.get(jb);if(!kd)return{VNa:Ic,MZb:Uc};Uc=new om.a;Uc.add(kd);var pd=this.RFb.get(jb)||this.wH.J(jb);kd=new om.a;kd.add(pd);pd=new om.a;pd.add(this.wH.J(jb));ua.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",
this.AJ.xQf,this.AJ.xma,this.$Bi(kd),this.$Bi(Uc));var Fd=this.wCi(this.AJ.xma);this.aam(Fd,jb,Uc);kd=new ln.a(Fd,pd,Fd.input.xma===fm.a.YBc?kd:Uc,Fd.input.xma===fm.a.YBc?Uc:kd,this.wCi(fm.a.YBc),kd,Uc);Uc=new om.a;for(pd=0;pd<bc.length;pd++){this.AJ.dJ("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const le=({ydb:Ic,qva:Fd}=kd.utd(jb,bc.J(pd))).returnValue;Uc.add(Fd);le?ua.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",
jb,bc.J(pd),Ic,Fd):ua.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",jb)}return{VNa:Ic,MZb:Uc}};this.AJ=K;this.wH=K.In;this.Ljb=K.ajp;this.RFb=K.$Jp;this.RDk=K.dBn;this.vg=pa||new Dp.a;this.wIk=Ta||this.DWl}DZc(K){const pa=new om.a;for(let Ta=0;Ta<K.length;Ta++){const jb=this.vWl(K.J(Ta));pa.add(jb)}return pa}CZc(K,pa,Ta){const jb=K.pv===K.MA&&K.startCp===K.endCp;pa&&({VNa:K.pv,qva:K.startCp}=
this.M0a(K.pv,K.startCp,K.pv),jb&&(K.MA=K.pv,K.endCp=K.startCp));Ta&&!jb&&({VNa:K.MA,qva:K.endCp}=this.M0a(K.MA,K.endCp,K.MA));return K}vWl(K){if(K.pv===K.MA){var pa=new om.a;pa.add(K.startCp);pa.add(K.endCp);({VNa:K,MZb:pa}=this.SMg(K.pv,pa));return new fs.a(K,pa.J(0),K,pa.J(1))}pa=new om.a;var Ta=new om.a;let jb;pa.add(K.startCp);({VNa:pa,MZb:jb}=this.SMg(K.pv,pa));Ta.add(K.endCp);({VNa:K,MZb:Ta}=this.SMg(K.MA,Ta));return new fs.a(pa,jb.J(0),K,Ta.J(0))}SMg(K,pa){let Ta=K,jb=pa;if(!this.wH.J(K))return ua.ULS.sendTraceTag(4339675,
318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",K),{VNa:Ta,MZb:jb};if(this.Ljb.get(K))({VNa:Ta,MZb:jb}=this.wIk(K,pa,Ta,jb));else if(this.AJ.OUf&&!this.AJ.OUf.J(this.AJ.OUf.length-1).J3(K)){jb=new om.a;for(let bc=0;bc<pa.length;bc++){let Ic;({VNa:Ta,qva:Ic}=this.M0a(K,pa.J(bc),Ta));jb.add(Ic)}}return{VNa:Ta,MZb:jb}}$Bi(K){let pa="";K.forEach(Ta=>{pa+=Ta.bAc();pa+=" ";return!0});return pa}wCi(K){const pa=Ca.a.instance.Oa("Box4.IFeatureHelper"),
Ta=new mn.a;Ta.input.source=this.AJ.xQf;Ta.input.xma=this.AJ.xma;Ta.input.o0c=()=>pa;Ta.runtime.In=this.wH;Ta.runtime.dJa=this.AJ.Uwl;K===fm.a.YBc?(Ta.runtime.NA=this.RFb,Ta.runtime.sv=this.Ljb,Ta.runtime.O2d=this.AJ.F5i,Ta.runtime.GEe=this.AJ.b6i):K===fm.a.SCe&&(Ta.runtime.NA=this.Ljb,Ta.runtime.sv=this.RFb,Ta.runtime.O2d=this.AJ.b6i,Ta.runtime.GEe=this.AJ.F5i);Ta.runtime.rc=pa;return Ta}aam(K,pa,Ta){if(K.runtime.NA.mb(vk.a.$N)){var jb=K.runtime.NA.J(vk.a.$N);jb=this.vg.getPropertyObjectIds(jb,wf.a.W4);
if(1===jb.length&&(jb=jb.J(0),K.runtime.NA.mb(jb)&&(jb=K.runtime.NA.J(jb),3===this.vg.getPropertyInt32(jb,wf.a.nAb)))){const bc=this.vg.getPropertyString(jb,wf.a.loa),Ic=this.vg.getPropertyString(jb,wf.a.t2b);pa.toString()===bc&&bc===Ic&&(pa=this.vg.getPropertyObjectId(jb,wf.a.ytd),K.runtime.NA.mb(pa)&&Ta.add(K.runtime.NA.J(pa)))}}}pEm(K,pa){let Ta=0;for(let jb=0;jb<K.length;jb++)if(pa.equals(K.J(jb)))return Ta=jb,{returnValue:!0,idx:Ta};return{returnValue:!1,idx:Ta}}M0a(K,pa){const Ta=this.RDk&&
!!this.RFb.J(K)&&!this.wH.J(K);let jb=K,bc=pa,Ic=!1,Uc=!1;(Ta?this.RFb:this.Ljb).forEach((kd,pd)=>{this.AJ.dJ("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");if(this.L_f(pd.yc)&&this.wH.J(kd)){pd=null;if(Ta){pd=this.k4c(le=>this.RFb.J(le)||this.wH.J(le),kd);var Fd=this.sfe(pd,K)}else Fd=this.k4c(le=>this.wH.J(le),kd),Fd=this.sfe(Fd,K);if(Fd&&(Uc=!0,pd||(pd=this.k4c(le=>this.RFb.J(le)||this.wH.J(le),kd)),kd=this.k4c(le=>this.Ljb.J(le)||this.wH.J(le),kd),Fd=0,({idx:Fd}=
this.pEm(pd,K)).returnValue)){for(let le=Fd+1;le<pd.length;le++)if(this.sfe(kd,pd.J(le)))return bc=0,jb=pd.J(le),Ic=!0,!1;for(--Fd;0<=Fd;Fd--)if(this.sfe(kd,pd.J(Fd)))return bc=Number.MAX_VALUE,jb=pd.J(Fd),Ic=!0,!1}}return!0});Ic||(ua.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",K,pa,Ta,Uc),this.AJ.xQf===nl.a.undo&&(ua.ULS.sendTraceTag(17340240,
318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",jb),({spi:pa}=this.Fsm()).returnValue?(jb=pa,bc=0,ua.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",jb)):ua.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",
jb)));return{VNa:jb,qva:bc}}Fsm(){let K=wi.a.nil,pa=new om.a;this.Ljb.forEach((Ta,jb)=>{this.AJ.dJ("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");return this.L_f(jb.yc)?(pa=this.k4c(bc=>this.Ljb.J(bc)||this.wH.J(bc),Ta),!1):!0});return 0<pa.length?(K=pa.J(0),{returnValue:!0,spi:K}):{returnValue:!1,spi:K}}L_f(K){return K===ig.a.iH||K===ig.a.xp||K===ig.a.Yna||K===ig.a.Yca}k4c(K,pa){var Ta=K(pa);pa=new om.a;if(!this.L_f(Ta.yc))return pa;Ta=this.vg.getPropertyObjectIds(Ta,
ok.a.wg);for(let jb=0;jb<Ta.length;jb++){const bc=new om.a;this.LMf(K,Ta.J(jb),bc);pa.pD(pa.length,bc)}return pa}LMf(K,pa,Ta){var jb=K(pa);if(jb)if(jb.yc===ig.a.paragraphNode)Ta.add(pa);else if(jb.yc===ig.a.$X)pa=this.vg.getPropertyObjectIds(jb,ok.a.$H).sg(0),this.LMf(K,pa,Ta);else if(jb.yc===ig.a.xp||jb.yc===ig.a.Yna||jb.yc===ig.a.Yca)for(pa=this.vg.getPropertyObjectIds(jb,ok.a.wg),jb=0;jb<pa.length;jb++)this.LMf(K,pa.J(jb),Ta)}sfe(K,pa){for(let Ta=0;Ta<K.length;Ta++)if(pa.equals(K.J(Ta)))return!0;
return!1}}Object(f.a)(On,"GraphMergeSelectionRecordUpdater",null,[]);var Vn=d(693);class gp extends Nn.a{constructor(K=null,pa=null,Ta=null,jb=null,bc=null,Ic=null,Uc=null,kd=null,pd=null,Fd=null,le=null){var jf;super();this.ibi=of=>{const tf=of.KJ,Se=Od.StaticActiveAppFrame.za().ib.$c;return Object(Vn.b)({GD:of,zm:tf,fileId:Se.fileId,dha:Se.dha,contextId:Se.contextId,w2d:tf?tf.id:wi.a.nil,Ddb:this.Ddb,ree:!1,Hbe:!0,cellId:Se.Lc.id},!0,Se.Lc.store)};this.gT=K||(()=>m.AFrameworkApplication.rootQuerySignature);
pa||(pa=of=>new Xq.a(of));this.PCh=pa;this.vg=Ta||new Dp.a;this.jbh=Uc||new sj.ChildNodeListMerge(this.gf);this.J$b=kd;this.Ddb||(this.J$b=(of,tf,Se)=>new io.a(of,tf,Se));this.p9b=jb||this.P3c();this.Cib=bc||new af.a;this.nkh=Ic||new yh(this.gf);this.Huh=(null===(jf=m.AFrameworkApplication.K)||void 0===jf?void 0:jf.ic("WordEditorGraphMergeMaxBrowserTimeInMs",750))||750;this.JFa=pd;this.yQa=Fd;this.H$d=this.xSl(le);this.Jhh=()=>Ca.a.instance.Oa("Box4.IFeatureHelper")}xSl(K){K||(K=qq.none,K=m.AFrameworkApplication.K?
m.AFrameworkApplication.K.ic("WordEditorGraphMergeBackupCasesBrowser",K):K);return K}GKa(){return(new Date).getTime()}IYj(K,...pa){return String.format.apply(null,[K].concat(pa))}Ajp(K){throw Bp.a.invalidOperation(K);}J6d(K){return String.format("Name: {0}, Message: {1}, Stack: {2}",K.name,K.message,K.stack)}jeo(K){if(this.JFa&&this.JFa.z3i||!this.Zep(K))return null;this.fEn(K);let pa;({Lbl:jb,$ip:bc,ZJp:pa}=this.MJl(K,this.ibi));const Ta=Nn.a.Wtm(K);var jb=kn.construct(this.gT(),jb.WEa(),bc.WEa(),
pa.WEa(),K.input.LRb,K.input.xma,K.input.pl,K.input.BVb,K.input.source,Ta,this.yQa.IDa);var bc=K.output.XL;Ta===dl.success&&0<bc.length&&(jb.MergedRevision=this.ibi(K.output.XL.last()));return jb}DZc(K,pa){return(new On(K)).DZc(pa)}CZc(K,pa,Ta,jb){return(new On(K)).CZc(pa,Ta,jb)}}Object(f.a)(gp,"GraphMerger",Nn.a,[]);class Sl extends gp{constructor(K,pa=null,Ta=null){super(K,void 0,void 0,void 0,void 0,void 0,void 0,void 0,pa,Ta);this.sa=new V.a}get IDa(){return this.yQa?this.yQa.IDa:Un.a.unknown}get mNb(){return null}set mNb(K){}T0k(K){this.sa.addHandler(Sl.wQf,
K)}KAo(K){this.sa.removeHandler(Sl.wQf,K)}yCg(){return!1}zVb(K,pa,Ta,jb,bc,Ic,Uc){(K=super.zVb(K,pa,Ta,jb,bc,Ic,Uc))&&this.sa.raiseEvent(Sl.wQf,new pq(K));return K}}Sl.wQf="GMC";Object(f.a)(Sl,"WordEditorGraphMerger",gp,[1004,1005,995]);class No{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}wc(K){this.W=K;this.W.ia("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new Iq(this.W.Qa("WordEditor.IBusinessBarController"),new Ec.a(()=>K.Oa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").ha();
this.W.ia("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new cl(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").ha();this.W.ia("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new Sl(()=>m.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").ha();this.W.ia("WordEditor.GraphMerge.GraphMergeBackupManager",
()=>new Hq(()=>m.AFrameworkApplication.rootQuerySignature,m.AFrameworkApplication.va,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").ha()}init(){ej.App.zS||(ej.App.zS=Us.a.Daa());const K=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");ej.App.zS.Dcl(K);this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let K=
this.W.Oa("Box4.IGraphMergeBackupManager");K&&K.dispose()}}Object(f.a)(No,"GraphMergePackage",null,[0,1]);var hp=d(303);class ro{constructor(K){this.ONe="FontPicker";this.SXe=null;this.sOb=pa=>{this.SXe=pa.isEnabled;pa=appChrome.actions.updateFontPickerLicenseState(this.ONe,pa.isEnabled);appChrome.api.dispatch(pa)};this.Fgb=K;this.mBd=this.Fgb.hva(hp.a.yUb,this.sOb);this.Fgb.isFeatureEnabled(hp.a.yUb,!1).then(pa=>{this.SXe=pa})}get isLicensed(){return this.SXe}dispose(){this.Fgb.rZb(hp.a.yUb,this.mBd)}}
Object(f.a)(ro,"ModernFontPickerFeatureHelper",null,[1565,13]);var el=d(512),tm=d(684),Wk=d(1771);class nr{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(f.a)(nr,"FontInfoTaskPaneProps",null,[]);class ip{constructor(K,pa,Ta,jb=null){this.Jbf=this.jZ=this.mBd=null;this._state=this.K8b=0;this.onOpen=()=>{this._state=2;this.ZN()};this.onShow=bc=>{0!==this._state&&(this._state=2,
1===bc&&(this.K8b=bc),this.ZN())};this.onClose=()=>{this.K8b=this._state=0;this.blur()};this.onHide=()=>{this._state=1;this.K8b=0};this.onUpsellButtonClicked=()=>{this.Fgb.launchUpsellExperience(Wk.a.experienceId)};this.M_e=K;this.Fgb=pa;this.Xok=Ta;this.Yb=jb}get Sb(){return this.M_e.value}initialize(){this.Sb.ra(v.a.xug,y.a.frame,Object(O.a)(this,this.xug,"requestFontInfo"));this.mBd=this.Fgb.hva(hp.a.yUb,Object(O.a)(this,this.sOb,"featureStateChangeCallback"));this.Ina()}tS(K=!1){const pa=lg.UISurfaces.Hv(),
Ta=this.Fgb.isFeatureEnabled(hp.a.yUb,!1),jb=[];jb.push(pa);jb.push(Ta);Promise.all(jb).then(bc=>{bc[0].showTaskPane(Wk.a.SOb,this.MB(bc[1]));K&&this.ZN()})}wyp(K){lg.UISurfaces.Hv().then(pa=>{pa.updateTaskPane(Wk.a.SOb,this.MB(K));return null})}sOb(K){this.wyp(K.isEnabled)}xug(K,pa,Ta,jb,bc){this.jZ=bc.CommandValueId;this.Jbf=bc.Trigger;this.K8b=bc.InputMethod;this.tS(2===this._state&&1===this.K8b);return 32}MB(K){const pa=new nr;pa.onUpsellButtonClicked=this.onUpsellButtonClicked;pa.fontName=this.jZ;
pa.isLicensed=K;pa.trigger=this.Jbf;pa.helpArticleUrl=this.Lyl();pa.paneId=Wk.a.SOb;K=this.L5m();K.contentProps=pa;return K}L5m(){return Object.assign(new wh.a,{title:Wk.a.ytc,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:this.onOpen,onClose:this.onClose,onShow:this.onShow,onHide:this.onHide})}Ina(){if(this.Yb){var K=this.Yb.ge(Wk.a.SOb);K.parent=ug.AFrame.mq;K.iK=!0}}ZN(){this.Yb&&1===this.K8b&&this.Yb.Bg(Wk.a.SOb)}blur(){this.Yb&&
this.Yb.currentScope&&this.Yb.currentScope.name===Wk.a.SOb&&this.Yb.Bg(this.Yb.RW)}dispose(){this.Fgb.rZb(hp.a.yUb,this.mBd)}Lyl(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.Xok,this.Uum(),"WDWAENDUSER",m.AFrameworkApplication.lcid)}Uum(){switch(this.Jbf){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return ip.kfl(this.jZ)}static kfl(K){let pa=
"hlpFontInfo";for(let Ta=0;Ta<K.length;++Ta){const jb=Ia.a.charAt(K,Ta);if(255<K.charCodeAt(Ta)||Ia.a.G8c(jb))pa+=jb}return pa}}Object(f.a)(ip,"FontInfoPane",null,[1523,13]);class Mk extends ip{constructor(K,pa,Ta,jb,bc){super(K,pa,jb.kb("FontInfoHelpBaseUrl"),bc);this.q6=Ta}tS(K){this.H2();super.tS(K)}sOb(K){super.sOb(K);Od.StaticActiveAppFrame.za().Ie()}H2(){this.q6.NUa()}}Object(f.a)(Mk,"WordEditorFontInfoPane",ip,[]);class or{constructor(){this.i7b=this.mHd=this.RHc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}wc(K){this.W=
K;K.ia("Common.ModernFontPicker.IModernFontPickerFeatureHelper",()=>new ro(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();K.ia("Common.ModernFontPicker.IFontInfoPane",()=>new Mk(new Ec.a(()=>m.AFrameworkApplication.va),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),fk.a.instance,m.AFrameworkApplication.K,Gg.FocusManager.instance())).ha()}init(){this.mHd=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");
this.RHc=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");this.RHc.initialize();m.AFrameworkApplication.K.$("IsAnonymousUser")||((this.i7b=this.W.Oa(tm.a))?this.i7b.initialize():ua.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));Od.StaticActiveAppFrame.za().Ie()}dispose(){this.RHc&&(this.RHc.dispose(),this.RHc=null);this.mHd&&(this.mHd.dispose(),this.mHd=null);this.i7b&&(this.i7b.Jza(),this.i7b=null)}static main(){Object(el.a)()&&H.a.instance.Jc(new or)}}
Object(f.a)(or,"ModernFontPickerPackage",null,[0,1]);var rq=d(71),Rm=d(6),gm=d(242),so=d(37),Xo=d(1221);class Tl{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd,pd,Fd,le,jf=null){this.p1=Ta;this.Zc=K;this.Pc=pa;this.Oh=bc;this.iQa=Ic;this.VY=Uc;this.Oah=kd;this.Nah=pd;this.Bz=Fd;this.qsk=jf||Tl.zx}get vh(){return this.Bz?this.Bz.vh:!1}NSi(K){return this.vLa(K,0)}o9m(K){return this.vLa(K,1)}vLa(K,pa){let Ta=null;if(this.vh&&this.VY&&(this.Nah.instance&&this.Nah.instance.pPa(K),pa?1===pa&&(Ta=this.VY.dCi(K.node)):
Ta=this.VY.EIf(K.node,K.cpBegin,K.Fb),Ta&&!Ta.ja(wf.a.xba,!1)))return ua.ULS.shipAssertTag(24749379,368,!1,"Try to insert page break to inconvertible inline content control"),2;const jb=Rm.GraphIterator.eX(this.Zc.Ql());jb.set(K.node);jb.zb(10);const bc=this.Pc.Mc(15);bc.qu(jb);pa?so.OutlineElementNavigator.he(jb):(this.U_a(jb,K),this.p1.LAc(K.node,mj.a.Mu));K=ld.ParagraphReader.Zl(jb.currentNode);this.O$m(jb);this.vh&&Ta&&this.Oah&&(pa=new yb.a,pa.add(jb.currentNode),this.Oah.XMh(pa,Ta.id));this.BUo(K);
bc.dispose();return 32}BUo(K){K=mc.SelectionFactory.se(K,0);Hj.a.instance.Ic(K)}O$m(K){this.Oh.$z(K,!0,!0,null,!1,!1);K=so.OutlineElementNavigator.Le(K);this.q9m(K)}U_a(K,pa){const Ta=so.OutlineElementNavigator.he(K);if(pa.cpBegin||this.vh&&(!this.vh||-1!==pa.Fb)){Ld.StaticTheCoauthManager.ud().Jo&&pa.cpBegin!==ld.ParagraphReader.textLength(pa.node)&&Ld.StaticTheCoauthManager.ud().Ak.yG(pa.node);this.Oh.$z(K,!1,!0,null,!1,!0);var jb=Rm.GraphIterator.eX(this.Zc.Ql());jb.set(Ta);this.Oh.Tca(jb,K,pa,
!0,!0,!0)}}q9m(K){K=this.qsk(K);this.iQa.lTi(K)}static LG(){return new Tl(new Wj.a,new dj.a,Ca.a.instance.resolve("Box4.IAutoCorrectScheduler"),Xo.a.instance,Ca.a.instance.resolve("Box4.IOutlineElementEditor"),Ca.a.instance.resolve("Box4.IBlobEditor"),Ca.a.instance.Oa("Box4.IContentControlReader"),Ca.a.instance.Oa("Box4.IContentControlEditor"),Ca.a.instance.Qa("Box4.IContentControlConverter"),Ca.a.instance.Oa("Box4.ContentControlConfigSettings"),Ca.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=
Tl.n_g?Tl.n_g:Tl.n_g=Tl.LG()}static zx(K){return Jc.a.zx(K)}}Object(f.a)(Tl,"PageBreakInserter",null,[1041]);class Tg{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd){this.R$m=(pd,Fd,le,jf)=>{var of=Fd.view,tf=of.lb.Og;if(!tf)return 2;if(!this.Eof(Fd))return 8;if(1===le)return 32;let Se=!0;le=8;const ye=this.SYe(tf);tf=this.Pc.Mc(15);tf.Ab(of.jd);tf.yi=pd;ye||(le=this.ga.lg(Fd,ea.a.Wra,2,!0,jf,null),pd=32===le,ua.ULS.shipAssertTag(4208012,314,pd),Se=pd);Se&&(of=of.lb.Og,pd=this.SYe(of),ua.ULS.shipAssertTag(4208013,
314,pd,"{0}",{["ContextId"]:Fd.contextId}),le=8,pd&&(le=this.BWe.NSi(of),ua.ULS.shipAssertTag(4208014,314,32===le)));tf.dispose();32===le&&this.Wd.$t(10);return le};this.Q$m=(pd,Fd,le)=>{if(!Fd||Fd.contextId!==Ad.a.Xc)return 8;if(1===le)return Fd.contextId===Ad.a.Xc?32:8;if(2===le){if(!this.Eof(Fd))return 8;pd=this.BWe.NSi(Fd);32===pd&&this.Wd.$t(10);return pd}return 32};this.P$m=(pd,Fd,le)=>{if(!Fd||Fd.contextId!==Ad.a.table)return 8;if(1===le)return 32;if(2===le){if(!this.Eof(Fd))return 8;pd=this.BWe.o9m(Fd);
32===pd&&this.Wd.$t(10);return pd}return 32};this.ga=K;this.BWe=pa;this.Pc=Ta;this.Xn=jb;this.SYe=bc;this.ul=Ic;this.qBk=Uc;this.Wd=kd}Wb(){this.ga.ra(rf.a.vLa,Ad.a.view,this.R$m);this.ga.ra(rf.a.vLa,Ad.a.Xc,this.Q$m);this.ga.ra(rf.a.vLa,Ad.a.table,this.P$m);this.ga.Rc(rf.a.vLa,4)}E8(){const K=Gg.FocusManager.instance().ge(rq.a.zF);ug.AFrame.gj(K,Sf.KeyInputManager.lc(mj.a.Mu,Sf.KeyInputManager.li),rf.a.vLa)}tln(K){return this.yy(K.iterator)}ipn(K){K=K.J(0);const pa=Zb.SelectionEditor.Wj(K,!0,!1);
if(this.yy(pa.Ra.iterator))return!0;K=Zb.SelectionEditor.Wj(K,!1,!1);return this.yy(K.Ra.iterator)}yy(K){return K.zb(14)}Eof(K){let pa=null,Ta=K;if(Ta.contextId===Ad.a.view){pa=Ta.view;if(!pa.features.KGg)return!1;Ta=pa.lb.Og;if(!Ta)return!1}else{const jb=Rm.GraphIterator.eb(Ta.node);if(jb.zb(36)||jb.zb(38)||jb.zb(40)||jb.zb(14))return!1}return gm.a.Sla(K)?!1:Ta.contextId===Ad.a.table?this.ul.eln(Ta.node):!this.ul.cln(Ta)||this.Xn&&this.Xn.instance&&this.Xn.instance.DX(Ta)?!1:((K=this.SYe(Ta))?this.tln(Ta):
this.ipn(pa.lb.gb))||K&&this.qBk(Ta,!0)?!1:!0}static LG(){return new Tg(m.AFrameworkApplication.va,Tl.instance,new dj.a,Ca.a.instance.Qa("Box4.IExternalSelectionManager"),Zb.SelectionEditor.mf,Ui.a.instance,yd.a.uCa,Ca.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=Tg.eZg?Tg.eZg:Tg.eZg=Tg.LG()}}Object(f.a)(Tg,"PageBreakActor",null,[1E3]);class um{constructor(){this.F3e=this.W=null}get name(){return"WordEditor.PageBreak"}wc(K){this.W=
K}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo()})}Mo(){this.F3e=Tg.instance;this.F3e.Wb();this.F3e.E8();Od.StaticActiveAppFrame.za().Ie()}dispose(){}}Object(f.a)(um,"PackageManager",null,[0,1]);var Cm=d(1549),pr=d(1550),jp=d(291),wn=d(185),Ep=d(241),Ul=d(295),to=d(437);class vm{constructor(K,pa,Ta,jb,bc,Ic,Uc){this.RGb=null;this.sa=new V.a;this.gPe=1;this.cGd=-1;this.c4a=null;this.Jua=()=>{this.inf()};this.hb=pa;this.Gb=Ta;this.pAd=jb;this.YK=bc;this.wC=Ic;this.k6=Uc;
this.enable()}get BZd(){return this.gPe}QQj(K){this.gPe!==K&&(this.gPe=K,this.sa.raiseEvent("X"),this.Dfe&&this.BMg())}get Dfe(){const K=Ca.a.instance.Oa("WordEditor.Pagination.IPageEndMarkers");return K?K.Dfe:!0}get ql(){return this.YK.value}get Wk(){return kl.a.instance}a0k(K){this.sa.addHandler("X",K)}BMg(){this.Wk.Yd(()=>{this.k6.nS(to.a.Jqj)},"CPC:UPN")}enable(){this.hb.Cw(this.Jua);this.inf()}inf(){if(!this.c4a||1>=this.c4a.count)this.QQj(1);else{var K=this.hb.gb.currentSelection;if(K){var pa=
K.isForward?K.Uc:K.Ra;!pa||0>pa.cpBegin||(K=pa.node)&&ld.ParagraphReader.Xb(K)&&this.Nkn(K)&&(this.RGb&&(this.Gb.vf(this.RGb),this.RGb=null),this.RGb=new kb.a(2,1,400,Ta=>{this.t8l(Ta,pa)},62),this.Gb.Zb(this.RGb))}}}Nkn(K){K=Rm.GraphIterator.eb(K);return K.zb(35)||K.zb(37)||K.zb(39)?!1:!0}x8j(K){this.c4a=K;this.R6j()}R6j(){if(-1!==this.cGd){var K=this.u8l(this.cGd);-1!==K&&this.QQj(K)}}t8l(K,pa){this.RGb===K&&(this.RGb=null,this.cGd=this.Mfm(pa),-1!==this.cGd&&this.R6j())}u8l(K){if(!this.c4a)return-1;
for(let pa=0;pa<this.c4a.count;pa++){const Ta=this.c4a.J(pa);if(K>Ta.ILh&&K<Ta.ILh+Ta.height)return Ta.lh}return-1}Mfm(K){var pa=this.JEm(K);if(!pa||!pa.htmlElement)return-1;const Ta=pa.getBounds();K=this.Lnm(K,pa);if(!K)return-1;pa=fa.a.lWa(this.pAd.ucb,pa.htmlElement).y;return K.y+Math.floor(K.height/2)-Ta.y+pa}JEm(K){return K.node.ue(this.ql.oc)}Lnm(K,pa){K=this.wC?this.wC.aAa(K,!0):K.cpBegin;return Ul.a.Jr(pa,K)}disable(){this.hb.nY(this.Jua)}}Object(f.a)(vm,"CurrentPageCalculator",null,[1119,
1115]);class bq{constructor(K){bq.E1=K}get zvf(){return bq.E1}get BZd(){return this.zvf.BZd}F_l(){this.zvf.enable()}aUl(){this.zvf.disable()}}bq.E1=null;Object(f.a)(bq,"WebViewCurrentPageManager",null,[1120]);var uo=d(125);class ca extends Sys.EventArgs{constructor(K,pa){super();this.Ogj=pa}}Object(f.a)(ca,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class ra extends Sys.EventArgs{constructor(K,pa,Ta){super();this.delta=K;this.Ogj=Ta}}Object(f.a)(ra,"PageContentSizeChangeEventArgs",Sys.EventArgs,
[]);class Eb{constructor(K,pa,Ta){this.yAh=this.eKd=-1;this.eNc=null;this.sa=new V.a;this.K1e=!1;this.crj=(jb,bc)=>{this.K1e=this.Dol();bc.bwb||this.tHc.value.measure(this.wol)};this.wol=()=>{const jb=this.ucb.clientHeight;this.uol(jb);this.Gol(jb)};this.Fig=(jb,bc)=>{bc.property===uo.a.WJ&&(jb=bc.node)&&jb.ja(uo.a.WJ,!1)&&(jb=jb.ue(this.ql.oc))&&(jb=jb.htmlElement)&&this.Y3a.add(jb)};this.YK=K;this.tHc=pa;this.Y3a=new yb.a;this.xTf();this.Iga=this.Iga.bind(this);Ta.fKb(this.Iga);0===Ta.Ax&&this.QI()}QI(){this.ql.KPh(this.crj)}eFa(){this.ql.JDj(this.crj)}get ql(){return this.YK.value}Iga(K,
pa){this.eNc=null;0===pa.Nbb?this.QI():this.eFa()}get ucb(){this.eNc||(this.eNc=this.ql.jd.ue(this.ql.oc).ucb,ua.ULS.shipAssertTag(34136386,336,!!this.eNc));return this.eNc}i1k(K){this.sa.addHandler("OnPageContentSizeChangeKey",K)}uol(K){K!==this.yAh&&(this.sa.raiseEvent("OnDocumentBottomChangeKey",new ca(K,this.K1e)),this.yAh=K)}Gol(K){K!==this.eKd&&(-1!==this.eKd&&this.sa.raiseEvent("OnPageContentSizeChangeKey",new ra(K-this.eKd,K,this.K1e)),this.eKd=this.ucb.clientHeight)}Dol(){let K=!1;for(let pa=
this.Y3a.count-1;0<=pa;pa--)this.Y3a.J(pa).hasChildNodes()&&(this.Y3a.removeAt(pa),K=!0);return K}xTf(){ej.App.jf.Il.Ve(23).fo(this.Fig)}}Object(f.a)(Eb,"DocumentSizeManager",null,[]);var kc=d(57),zc=d(243);class ed{constructor(K){this.YK=K}get ql(){const K=this.YK.value;ua.ULS.shipAssertTag(37820298,336,K.nj,"OutlineManager.PageView is not a PageView.");return K}mye(K,pa){const Ta=kc.a.qj(ed.Xf.jD(K),1);pa+=Ta;K.ue(this.ql.oc).htmlElement.firstChild.style.minHeight=pa+"px"}Nyi(){const K=Rm.GraphIterator.eb(this.ql.jd);
K.tq();K.Xd();ua.ULS.shipAssertTag(37820299,336,10===K.io.type);return K.io}qBi(){const K=Rm.GraphIterator.eb(this.ql.jd);K.tq();K.S_();ua.ULS.shipAssertTag(37820300,336,10===K.io.type);return K.io}EGm(K){const pa=Rm.GraphIterator.eb(this.ql.jd);pa.tq();pa.Xd();let Ta=pa.io,jb=null;for(;K!==Ta&&pa.Fk();)jb=Ta,Ta=pa.io;ua.ULS.shipAssertTag(37820301,336,10===pa.io.type);return jb}static get Xf(){return zc.a.instance}}Object(f.a)(ed,"OutlineManager",null,[1118]);class rd{constructor(K){this.WGa=0;this.o5=
null;this.kDg=pa=>{for(const Ta of pa.Yl)this.jDg(Ta)};this.Gb=K}Ooe(){this.o5||(this.o5=this.RXc())}vWd(){this.o5&&0<rd.f2c(this.o5).length&&this.Gb.Zb(this.o5);this.o5=null}RXc(){return Object.assign(new kb.a(3,1,250,this.kDg,166),{Yl:[]})}kAg(K){this.WGa=K}Hpd(K){if(K){K.style.width=this.WGa+"px";if(this.o5)var pa=this.o5;else pa=this.RXc(),this.Gb.Zb(pa);rd.f2c(pa).push(K)}}r6c(K){K&&(K.style.width="0px",this.fTf(K))}mtd(K,pa){pa?this.Hpd(K):this.r6c(K)}jDg(K){K.style.width===this.WGa+"px"&&(this.u2c(K).style.visibility=
"visible")}fTf(K){K&&(this.u2c(K).style.visibility="hidden")}u2c(K){K=K.childNodes;ua.ULS.shipAssertTag(24958351,336,1===K.length,"Expected 1 child div in the page adornment, found "+K.length);return K[0]}static f2c(K){return K.Yl}}Object(f.a)(rd,"PageAdornmentAnimationManager",null,[1117]);class Wd{constructor(K){this.Ym=K;this.Zda=new wd.a;this.$da=new wd.a}gJa(K){K=Rm.GraphIterator.eb(K);if(K.tq()&&K.Dq()){K.Xd();do 10===K.lf&&this.Alg(K.currentNode),K.Cu();while(8!==K.lf)}}u0b(K){const pa=K.lh;
var Ta=this.EQb(K.S1b);if(!this.Zda.mb(Ta))return ua.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+Ta),!1;K=this.Zda.J(Ta);ua.ULS.shipAssertTag(24958353,336,this.$da.mb(Ta),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");Ta=this.$da.J(Ta);return this.$Sf(K,pa,Ta)}t0b(K){const pa=K.lh;var Ta=this.EQb(K.S1b);if(!this.Zda.mb(Ta))return ua.ULS.sendTraceTag(24958354,
336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+Ta),!1;K=this.Zda.J(Ta);ua.ULS.shipAssertTag(24958355,336,this.$da.mb(Ta),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");Ta=this.$da.J(Ta);return this.hFf(K,pa,Ta)}UOf(K){if(!K)return ua.ULS.sendTraceTag(24979136,336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var pa=K.dUd;if(!pa)return ua.ULS.sendTraceTag(24979137,
336,10,String.format("Container of page number {0} has a null EndSectionNode.",K.lh)),0;pa=this.Ym.LPb(pa);if(!pa)return ua.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;pa=this.Ym.tla(pa);const Ta=1===K.lh;K=!(K.lh%2);return 1===pa?1:2===pa?Ta?2:1:3===pa?K?3:4:Ta?2:K?3:4}Alg(K){if(10===K.type){var pa=new wd.a,Ta=this.Ym.LPb(K);ua.ULS.shipAssertTag(24958356,336,!!Ta,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");
var jb=this.Ym.tla(Ta);K=this.EQb(K);this.QMg(K,jb);this.PMg(K,pa);Ta=Rm.GraphIterator.eb(Ta);if(Ta.Dq()){Ta.Xd();do K=Ta.currentNode,jb=this.Ym.w3c(K),K=this.Ym.GOi(K),pa.add(jb,K),Ta.Cu();while(36===Ta.lf)}}}QMg(K,pa){this.$da.mb(K)?this.$da.Z(K,pa):this.$da.add(K,pa)}PMg(K,pa){this.Zda.mb(K)?this.Zda.Z(K,pa):this.Zda.add(K,pa)}EQb(K){ua.ULS.shipAssertTag(24958358,336,10===K.type,"Expected node of type Outline but received node of type "+K.type);return K.ja(wf.a.yna,0)}$Sf(K,pa,Ta){const jb=1===
pa;pa=!(pa%2);switch(Ta){case 2:if(jb){if(K.mb(2))return K.J(2)}else if(K.mb(0))return K.J(0);break;case 3:if(pa){if(K.mb(1))return K.J(1)}else if(K.mb(0))return K.J(0);break;case 4:if(jb){if(K.mb(2))return K.J(2)}else if(pa){if(K.mb(1))return K.J(1)}else if(K.mb(0))return K.J(0);break;case 1:if(K.mb(0))return K.J(0)}return!1}hFf(K,pa,Ta){const jb=1===pa;pa=!(pa%2);switch(Ta){case 2:if(jb){if(K.mb(5))return K.J(5)}else if(K.mb(3))return K.J(3);break;case 3:if(pa){if(K.mb(4))return K.J(4)}else if(K.mb(3))return K.J(3);
break;case 4:if(jb){if(K.mb(5))return K.J(5)}else if(pa){if(K.mb(4))return K.J(4)}else if(K.mb(3))return K.J(3);break;case 1:if(K.mb(3))return K.J(3)}return!1}}Object(f.a)(Wd,"PageAdornmentContentManager",null,[1116]);var Ze=d(1247);class jg{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd,pd){this.ZNg(K,pa,Ta,Ic,Uc,kd,pd);this.lh=K;this.Ir=pa;this.Ps=Ta;this.S1b=jb;this.dUd=bc;this.Hnb=Ic;this.dmc=Uc;this.Wic=kd;this.Tqj=pd}get top(){return this.Ir}get height(){return this.Ps}Ood(K){this.Ir!==K&&(this.Hnb.style.top=
K+"px",this.Ir=K)}Nzg(K){this.height!==K&&(this.Hnb.style.height=K+"px",this.Ps=K)}ZNg(K,pa,Ta,jb,bc,Ic,Uc){ua.ULS.shipAssertTag(37244961,336,0<K,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",K);ua.ULS.shipAssertTag(37244962,336,0<=pa,"PageAdornmentContainer: top parameter value {0} is unexpected value.",pa);ua.ULS.shipAssertTag(37244963,336,0<=Ta,"PageAdornmentContainer: height parameter value {0} is unexpected value.",Ta,pa);ua.ULS.shipAssertTag(37244992,336,!!jb,
"PageAdornmentContainer: containerDomElement parameter is null.");ua.ULS.shipAssertTag(37244993,336,!!bc,"PageAdornmentContainer: headerLabelDomElement parameter is null.");ua.ULS.shipAssertTag(37244994,336,!!Ic,"PageAdornmentContainer: footerLabelDomElement parameter is null.");ua.ULS.shipAssertTag(37244995,336,!!Uc,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}Object(f.a)(jg,"PageAdornmentContainer",null,[1137]);class Ag{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd,pd,Fd,le,jf){this.flh=
"headerFooterTab";this.uOd=null;this.Wt=!0;this.OUe=0;this.c_e=null;this.f$a=!1;this.CWb=of=>{this.RTn(of.iy);return!0};this.zD=()=>!0;this.qRb=()=>{this.Qsf()&&(this.f$a=!1,this.Etp(),this.c_e=new Date)};this.HWb=of=>{this.f$a||this.RY.Hpd(of.iy);return!0};this.GWb=of=>{this.f$a||(of=of.iy,this.QCg(of)||this.RY.r6c(of));return!0};this.kto=()=>{let of=Array.dequeue(this.q6e);for(;of;)this.QI(of),of=Array.dequeue(this.q6e);this.uOd=null};this.YK=K;this.Pg=pa;this.gG=Ta;this.Hoa=jb;this.ga=bc;this.Wl=
Ic;this.RY=Uc;this.ZFa=kd;this.FRa=pd;this.Gb=Fd;this.Ga=le;this.q6e=[];this.j5=new Map;this.My=jf;this.FRa.NRd(this.qRb);this.Zx=!!m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.q0;if(this.EEd=(this.OWe=!!this.Ga&&this.Ga.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&!!this.Ga&&this.Ga.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===Od.StaticActiveAppFrame.za().cL.getLayoutBreakpoint()&&(this.Wt=!1),Od.StaticActiveAppFrame.za().cL.registerLayoutBreakpointChanged(this.flh,
of=>{switch(of){case "Small":this.cPi();break;default:this.SUj()}})}get ql(){return this.YK.value}SUj(){try{this.p7o()}catch(K){ua.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",K.message,K.stack)}}cPi(){try{this.j0m()}catch(K){ua.ULS.shipAssertTag(37244998,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",K.message,K.stack)}}czo(){for(const K of this.j5.keys())this.jue(K)}gJa(){try{this.Jxl()}catch(K){ua.ULS.shipAssertTag(37244999,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",K.message,K.stack)}}x8j(K){try{this.pyp(K)}catch(pa){ua.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",pa.message)}}dispose(){try{this.esp(),this.Jsp(),this.FRa&&this.FRa.RDj(this.qRb)}catch(K){ua.ULS.shipAssertTag(37245001,336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",K.message,K.stack)}}RTn(K){const pa=this.C9c(K),Ta=this.awi(K);Ta?(Ce.b("OpenHeaderFooterFromWebViewAdornment"),
K=this.ZFa.UOf(Ta),this.ga.Pb(pa?rf.a.vGe:rf.a.yud,2,K),this.f$a=!0):(ua.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+K.id),this.ga.Ob(rf.a.jce,2))}esp(){this.j5.forEach(K=>{this.eFa(K)})}Jsp(){this.Zx&&(this.EEd&&(Od.StaticActiveAppFrame.za().cL.unregisterLayoutBreakpointChanged(this.flh),this.EEd=!1),this.Zx=!1)}eFa(K){if(K){var pa=K.dmc;K=K.Wic;zd.a.cua(pa)&&zd.a.cua(K)?(this.Wl.xc(P.a.QX,pa,this.HWb),this.Wl.xc(P.a.QX,K,this.HWb),this.Wl.xc(P.a.yP,
pa,this.GWb),this.Wl.xc(P.a.yP,K,this.GWb),this.Pg.xc(P.a.click,pa,this.CWb),this.Pg.xc(P.a.click,K,this.CWb),this.gG.xc(pa,Ag.tWb),this.gG.xc(K,Ag.tWb),this.Hoa.xc(P.a.nz,pa,this.zD),this.Hoa.xc(P.a.nz,K,this.zD)):ua.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}olo(K){this.q6e.push(K);this.uOd||(this.uOd=new kb.a(2,1,50,this.kto),this.Gb.Zb(this.uOd))}QI(K){if(K){var pa=K.dmc;K=K.Wic;zd.a.cua(pa)&&zd.a.cua(K)?(this.Wl.nb(P.a.QX,
pa,this.HWb),this.Wl.nb(P.a.QX,K,this.HWb),this.Wl.nb(P.a.yP,pa,this.GWb),this.Wl.nb(P.a.yP,K,this.GWb),this.Pg.nb(P.a.click,pa,this.CWb),this.Pg.nb(P.a.click,K,this.CWb),this.gG.nb(pa,Ag.tWb),this.gG.nb(K,Ag.tWb),this.Hoa.nb(P.a.nz,pa,this.zD),this.Hoa.nb(P.a.nz,K,this.zD)):ua.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}p7o(){if(!this.Wt){for(const K of this.j5.values())K.Hnb.style.display="block";this.Wt=!0}}j0m(){this.Wt&&
(this.j5.forEach(K=>{K.Hnb.style.display="none"}),this.Wt=!1)}Jxl(){this.ZFa.gJa(this.ql.jd)}pyp(K){this.RY.Ooe();var pa=0;const Ta=new yb.a;this.gJa();const jb=this.vxm();for(var bc of K)K=bc.lh,this.q7n(bc)||this.jue(bc.lh),this.j5.has(K)?this.Wup(bc):this.sEl(bc),pa=K,Ta.add(K);for(bc=1;bc<=pa;bc++)Ta.contains(bc)||this.jue(bc);for(pa+=1;pa<=jb;pa++)this.jue(pa);this.RY.vWd()}q7n(K){return this.j5.has(K.lh)?this.j5.get(K.lh).S1b.id===K.S1b.id:!1}vxm(){let K=0;this.j5.forEach((pa,Ta)=>{Ta>K&&(K=
Ta)});return K}sEl(K){const pa=K.S1b.ue(this.ql.oc);if(pa){var Ta=K.lh;K=this.yXc(Ta,K.top,K.height,pa.gfa,K.S1b,K.dUd);this.olo(K);this.JLg(K);this.gNg(K);this.EEd&&!this.Wt&&(K.Hnb.style.display="none");this.j5.set(Ta,K)}}yXc(K,pa,Ta,jb,bc,Ic){const Uc=Og.b("div","","PageAdornmentContainer");Uc.style.top=pa+"px";Uc.style.height=Ta+"px";jb.appendChild(Uc);this.knf(Uc,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);jb=this.nuf(K);Uc.appendChild(jb);const kd=this.Ktf(K);
Uc.appendChild(kd);const pd=this.Atf(K);Uc.appendChild(pd);m.AFrameworkApplication.isRtl&&(Uc.classList.add("Rtl"),kd.classList.add("Rtl"),pd.classList.add("Rtl"));return new jg(K,pa,Ta,bc,Ic,Uc,kd,pd,jb)}Ktf(K){K=Og.b("div","h"+K,this.My?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.My?K.classList.add("PageAdornmentHeaderFooterBorderThemed"):K.style.borderColor=Ze.a.QGe;const pa=Og.b("span","","");pa.innerText=WordEditorIntl.WordEditorStrings.l_Header;pa.style.whiteSpace="nowrap";
K.appendChild(pa);return K}Atf(K){K=Og.b("div","f"+K,this.My?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.My?K.classList.add("PageAdornmentHeaderFooterBorderThemed"):K.style.borderColor=Ze.a.QGe;const pa=Og.b("span","","");pa.innerText=WordEditorIntl.WordEditorStrings.l_Footer;pa.style.whiteSpace="nowrap";K.appendChild(pa);return K}nuf(K){const pa=Og.b("div","","PageAdornmentNumberLabel");pa.innerText=K.toString();return pa}knf(K,pa,Ta){if(!this.OUe){const jb=Og.b("p","","");
jb.innerText=pa;jb.style.whiteSpace="nowrap";jb.style.visibility="hidden";K.appendChild(jb);pa=Og.b("p","","");pa.innerText=Ta;pa.style.whiteSpace="nowrap";pa.style.visibility="hidden";K.appendChild(pa);this.OUe=K.clientWidth;this.RY.kAg(this.OUe);K.removeChild(jb);K.removeChild(pa)}}jue(K){if(this.j5.has(K)){var pa=this.j5.get(K);this.eFa(pa);zd.a.Dy(pa.Hnb);this.j5.delete(K)}}Wup(K){if(this.j5.has(K.lh)){var pa=this.j5.get(K.lh);pa.Ood(K.top);pa.Nzg(K.height);this.JLg(pa);this.gNg(pa)}else ua.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}Etp(){this.RY.Ooe();this.gJa();this.j5.forEach(K=>{this.JLg(K);this.gNg(K)});this.RY.vWd()}JLg(K){const pa=K.dmc,Ta=K.Wic,jb=this.ZFa.u0b(K),bc=this.ZFa.t0b(K);this.yAp(K,jb,bc);this.RY.mtd(pa,jb);this.RY.mtd(Ta,bc)}yAp(K,pa=!0,Ta=!0){const jb=K.dmc;K=K.Wic;3!==m.AFrameworkApplication.va.mode?(jb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,K.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(jb.title=
pa?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,K.title=Ta?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}QCg(K){const pa=this.awi(K);return pa?this.C9c(K)?this.ZFa.u0b(pa):this.ZFa.t0b(pa):(ua.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}awi(K){K=K.id;K=K.substring(1,K.length);K=Number.parseInvariant(K);return this.j5.has(K)?this.j5.get(K):(ua.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+K),null)}C9c(K){return K.id.length?"h"===K.id.substring(0,1):(ua.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}gNg(K){const pa=K.height;pa<Ag.VMn?(K.dmc.classList.add(Ag.Trb),K.Wic.classList.add(Ag.Trb)):(K.dmc.classList.remove(Ag.Trb),K.Wic.classList.remove(Ag.Trb));pa<Ag.WMn?(K.Tqj.classList.add(Ag.Trb),K.Hnb.classList.add(Ag.Trb)):(K.Tqj.classList.remove(Ag.Trb),K.Hnb.classList.remove(Ag.Trb))}Qsf(){return!this.c_e||
Z.a.QSf(this.c_e,500)}static tWb(){return!0}}Ag.Trb="Hidden";Ag.VMn=120;Ag.WMn=50;Object(f.a)(Ag,"PageAdornmentManager",null,[1114,13,1115]);class Eh{constructor(K,pa){this.vpe=new yb.a;this.vpe.add(K);this.vpe.add(pa)}}Object(f.a)(Eh,"PageElementManagerList",null,[]);var Dc=d(58);class yg{constructor(K,pa){this.eo=K;this.P9b=[];this.OM=pa}HBj(){for(let K=0,pa=this.P9b.length;K<pa;K++)zd.a.Dy(this.P9b[K]);Array.clear(this.P9b)}Hxi(K,pa,Ta,jb,bc,Ic){let Uc=Math.min(jb.x-Ic.x,bc.x-Ic.x);jb=Math.min(Ic.x+
Ic.width-(jb.x+jb.width),Ic.x+Ic.width-(bc.x+bc.width));pa+=bc.y-Ic.y;({Nma:pa,Mba:Uc,una:jb}=this.q3k(pa,Uc,jb));K=this.HDm(K,Uc,jb,Uc,jb,Ta);K.style.top=pa+"px";K.style.zIndex="0";this.P9b.push(K);Dc.d(K,!0);return K}s8d(K){return K?K.querySelector(".PageBreakBorderSpan"):null}HDm(K,pa,Ta,jb,bc,Ic){return K?this.hNm(pa,Ta,jb,bc,Ic):this.aEm(jb,bc,Ic)}q3k(K,pa,Ta){pa/=this.eo.instance.Aj;Ta/=this.eo.instance.Aj;K/=this.eo.instance.Aj;return{Nma:K,Mba:pa,una:Ta}}Vjn(K){return this.l4i(K)&&this.Pqj(K)?
(K=this.sQb(K))&&K.offsetParent?!1:!0:!1}Ujn(K){return!this.l4i(K)||this.Pqj(K)?!1:!0}QU(){}sQb(K){if(!K.Pjg)return null;let pa=null;K.dtb&&!K.oga?(K=this.s8d(K.Pjg))&&(pa=K):pa=K.Pjg;return pa}l4i(K){return K.dtb&&!K.oga&&K.paragraphNode?!0:!1}Pqj(K){K=K.paragraphNode;return!!K&&!!K.anchor}g_h(K,pa){K=fa.a.CKa(K);pa=fa.a.CKa(pa);return(K-pa)/this.eo.instance.Aj}pnf(K,pa){K=fa.a.CKa(K);pa=fa.a.CKa(pa);return(K-pa)/this.eo.instance.Aj}Ocd(){this.z8j(!1)}Ncd(){this.z8j(!0)}z8j(K){for(let pa=0,Ta=this.P9b.length;pa<
Ta;pa++){const jb=this.P9b[pa];"PageEndMarker.Para"===jb.id?yg.D8j(jb,K):"PageEndMarker.Table"===jb.id&&yg.y9j(jb,K)}}aEm(K,pa,Ta){if(!yg.Kbc){yg.Kbc=Og.b("div","PageEndMarker.Para","PageEndMarker");var jb=Og.b("div","","Current FullWidth");jb.style.borderTopColor=this.OM.sBa();yg.Kbc.appendChild(jb);jb=Og.b("div","","Stale LeftWing");const bc=Og.b("div","","Stale RightWing");jb.style.borderTopColor=this.OM.sBa();bc.style.borderTopColor=this.OM.sBa();yg.Kbc.appendChild(jb);yg.Kbc.appendChild(bc)}jb=
yg.Kbc.cloneNode(!0);jb.childNodes[1].style.width=K-10+"px";jb.childNodes[2].style.width=pa-10+"px";yg.D8j(jb,Ta);return jb}hNm(K,pa,Ta,jb,bc){if(!yg.kJb){yg.kJb=Og.b("div","PageEndMarker.Table","PageEndMarker");var Ic=Og.b("div","","Current LeftWing"),Uc=Og.b("div","","Current RightWing");Ic.style.borderTopColor=this.OM.sBa();Uc.style.borderTopColor=this.OM.sBa();yg.kJb.appendChild(Ic);yg.kJb.appendChild(Uc);Ic=Og.b("div","","Stale LeftWing");Uc=Og.b("div","","Stale RightWing");Ic.style.borderTopColor=
this.OM.sBa();Uc.style.borderTopColor=this.OM.sBa();yg.kJb.appendChild(Ic);yg.kJb.appendChild(Uc)}Ic=yg.kJb.cloneNode(!0);Ic.childNodes[0].style.width=K+"px";Ic.childNodes[1].style.width=pa+"px";Ic.childNodes[2].style.width=Ta-10+"px";Ic.childNodes[3].style.width=jb-10+"px";yg.y9j(Ic,bc);return Ic}static D8j(K,pa){pa?yg.KHn(K):yg.LHn(K)}static LHn(K){K.childNodes[0].style.display="none";K.childNodes[1].style.display="block";K.childNodes[2].style.display="block"}static KHn(K){K.childNodes[0].style.display=
"block";K.childNodes[1].style.display="none";K.childNodes[2].style.display="none"}static y9j(K,pa){pa?yg.QHn(K):yg.RHn(K)}static RHn(K){K.childNodes[0].style.display="none";K.childNodes[1].style.display="none";K.childNodes[2].style.display="block";K.childNodes[3].style.display="block"}static QHn(K){K.childNodes[0].style.display="block";K.childNodes[1].style.display="block";K.childNodes[2].style.display="none";K.childNodes[3].style.display="none"}}yg.Kbc=null;yg.kJb=null;Object(f.a)(yg,"PageEndDOMHelper",
null,[]);class qj{constructor(K,pa){this.cHb=this.EAh=null;this.eo=K;this.jj=pa}TFg(K,pa){try{this.Adp(K,pa)}catch(Ta){ua.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",Ta.message)}}fxl(K,pa,Ta,jb,bc,Ic){this.jj.Yd(()=>{try{this.gxl(K,pa,Ta,jb,bc,Ic)}catch(Uc){ua.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",Uc.message)}},"PEMPC:CP")}Adp(K,pa){this.EAh=K;
this.cHb=pa}gxl(K,pa,Ta,jb,bc,Ic){var Uc=this.EAh;if(Uc&&K){var kd=Uc.count,pd=K.count;if(kd&&pd){var Fd=this.X8l(Uc,K);if(Fd.count){var le=this.eo.Aj,jf=this.rfc(Fd)/le,of=this.i6h(Fd)/le;K=this.J3d(Uc,K);if(K.count){Uc=this.rfc(K)/le;le=this.i6h(K)/le;var tf=!0;for(var Se=0;Se<Fd.count;Se++)if(Fd.J(Se)){tf=!1;break}var ye=Se=0;this.cHb&&pa&&(Se=this.Til(this.cHb,pa),ye=pa.count-this.cHb.count);ua.ULS.sendTraceTag(35005343,336,50,"{0}",{["HardPageBreakExists"]:jb,["EstimatedPageCount"]:kd,["CalculatedPageCount"]:pd,
["InOrderAverageDelta"]:jf,["InOrderStandardDeviation"]:of,["ShortestAverageDelta"]:Uc,["ShortestStandardDeviation"]:le,["PositionsShouldBeUpdated"]:Ta,["DocumentHeightChanged"]:bc,["DeltasAllZero"]:tf,["HeaderFooterOpenSinceLastResponse"]:Ic,["DeltaInViewport"]:Se,["ChangeInViewportMarkerCount"]:ye});bc||Ic||tf||(ua.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),pa=Fd.toArray().toString(),Ta=K.toArray().toString(),
ua.ULS.sendTraceTag(35726603,336,50,"{0} {1}",pa,Ta))}}}}else ua.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}Til(K,pa){const Ta=new yb.a;for(const jb of K)Ta.add(jb.top);if(!Ta.count)return-1;K=new yb.a;for(const jb of pa)K.add(jb.top);if(!K.count)return-1;pa=this.J3d(Ta,K);return this.rfc(pa)/this.eo.Aj}rfc(K){if(!K.count)return 0;let pa=0;for(let Ta=0;Ta<K.count;Ta++)pa+=K.J(Ta);return pa/K.count}i6h(K){if(!K.count)return 0;
const pa=this.rfc(K);let Ta=0;for(let jb=0;jb<K.count;jb++){const bc=K.J(jb)-pa;Ta+=bc*bc}return Math.sqrt(Ta/K.count)}X8l(K,pa){const Ta=new yb.a;if(!K.count||!pa.count)return Ta;K.Sc((bc,Ic)=>bc-Ic);pa.Sc((bc,Ic)=>bc-Ic);const jb=Math.min(K.count,pa.count);for(let bc=0;bc<jb;bc++){const Ic=Math.abs(K.J(bc)-pa.J(bc));Ta.add(Ic)}return Ta}J3d(K,pa){const Ta=new yb.a;if(!K.count||!pa.count)return Ta;var jb=K.count<=pa.count;const bc=jb?K:pa;K=jb?pa:K;for(pa=0;pa<bc.count;pa++){jb=bc.J(pa);let Uc=Math.abs(jb-
K.J(0)),kd=0;for(let pd=1;pd<K.count;pd++){var Ic=K.J(pd);Ic=Math.abs(jb-Ic);Ic<Uc&&(Uc=Ic,kd=pd)}Ta.add(Uc);K.removeAt(kd)}return Ta}}Object(f.a)(qj,"PageEndMarkerPositionComparer",null,[1113]);var Mi=d(426),jh=d(636);class mi{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd,pd,Fd){this.Ir=K;this._pageNumber=pa;this.dtb=Ta;this.oga=jb;this.Pjg=bc;this.OF=Ic;this.iH=Uc;this.Fyh=kd;this.paragraphNode=pd;this.cY=Fd}get top(){return this.Ir}get lh(){return this._pageNumber}get I6n(){return this.Fyh}Ood(K){this.Ir=
K}nye(K){this._pageNumber=K}aPj(K){this.Fyh=K}}Object(f.a)(mi,"PageEndMarker",null,[]);class Sj{constructor(){this.Df=null;this.Wgj=0}}Object(f.a)(Sj,"PageEndMarkerToRestore",null,[]);class wj{constructor(K,pa,Ta,jb,bc,Ic,Uc){this.Fig=(kd,pd)=>{pd.property===uo.a.WJ&&(kd=pd.node)&&kd.ja(uo.a.WJ,!1)&&this.$Pd.contains(kd.id)&&(pd=kd.ue(this.ql.oc))&&(pd=pd.htmlElement)&&(this.$Pd.remove(kd.id),this.Y3a.add(pd))};this.YK=K;this.eo=pa;this.ASa=Ta;this.Gz=jb;this.J3e=bc;this.Z1=Ic;this.Oq=Uc;this.uu=
new yb.a;this.Q9b=new yb.a;this.jJb=new wd.a;this.$Pd=new jh.a(new Mi.a);this.Y3a=new yb.a;this.T9b=!!bc;this.xTf()}get ql(){const K=this.YK.value;ua.ULS.shipAssertTag(37052750,336,K.nj,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return K}aBc(K){try{this.Pxp(K)}catch(pa){this.Gz.QU(pa.message+" "+pa.stack),ua.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",pa.message)}}JYk(K){try{this.KYk(K)}catch(pa){this.Gz.QU(pa.message+
" "+pa.stack),ua.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",pa.message)}}Tjl(K){try{return this.Ujl(K)}catch(pa){this.Gz.QU(pa.message+" "+pa.stack),ua.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",pa.message)}return!1}fHo(){try{this.gHo()}catch(K){this.Gz.QU(K.message+" "+K.stack),ua.ULS.sendTraceTag(37052753,336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",
K.message)}}x4c(){try{return this.ZHm()}catch(K){return this.Gz.QU(K.message+" "+K.stack),ua.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",K.message),null}}OMg(){try{this.tzp()}catch(K){this.Gz.QU(K.message+" "+K.stack),ua.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",K.message)}}Vof(){try{return this.gql()}catch(K){return this.Gz.QU(K.message+
" "+K.stack),ua.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",K.message),!1}}G$m(K){try{this.H$m(K)}catch(pa){this.Gz.QU(pa.message+" "+pa.stack),ua.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",pa.message)}}Pxp(K){if(K){this.Vrl();for(let pa=0;pa<K.length;pa++){const Ta=pa+1,jb=this.Uyl(K[pa],Ta);this.uu.add(jb);this.jJb.add(Ta,jb)}}}H$m(K){let pa=
!1;for(const Ta of K)if(Ta)if(0<Ta.Xw)for(const jb of Ta.tWf)pa=this.sRd(jb,Ta.iH)||pa;else if(0>Ta.Xw){pa=!0;for(const jb of Ta.x_d)this.AQl(jb.lh)}pa&&this.Utg()}KYk(K){const pa=this.ewi(K.paragraphNode);this.sRd(K,pa)&&this.Utg()}AQl(K){const pa=K-1;0>pa||this.uu.count<=pa||(this.uu.removeAt(pa),this.jJb.mb(K)&&this.jJb.remove(K))}ZHm(){const K=new yb.a;for(const pa of this.uu)this.Soc(pa)&&K.add(pa);return K}sRd(K,pa){if(!K)return ua.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),
!1;pa=this.Syl(K,pa);K=K.jfn?-1:K.lh;let Ta=!1,jb;this.jJb.mb(K)?(jb=this.jJb.J(K).lh,pa.nye(jb),this.uu.Z(jb-1,pa),this.jJb.remove(K)):(jb=pa.lh,this.uu.insert(jb-1,pa),Ta=!0);return Ta}Uyl(K,pa){return new mi(0,pa,K.HardBreak,!1,null,null,null,0,null,null)}Syl(K,pa){const Ta=K.gwb,jb=K.lh,bc=K.cY,Ic=!!bc&&bc.HardBreak,Uc=K.oga,kd=K.paragraphNode,pd=this.JDi(pa),Fd=K.OF;var le=this.CMf(Fd);if(!le)return ua.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),
null;let jf=null;Ic&&(jf=this.Gz.s8d(K.gwb));K=this.Gz.g_h(jf||Ta,pd);le=this.Gz.pnf(jf||Ta,le);return new mi(le,jb,Ic,Uc,Ta,Fd,pa,K,kd,bc)}Ujl(K){this.Q9b=new yb.a;this.T9b&&this.J3e.reset();this.Txo();this.p$o();this.r3k();this.Hjl(K);return 0<this.Q9b.count}Txo(){for(let K=0;K<this.uu.count;K++){const pa=this.uu.J(K);this.Gz.Vjn(pa)?this.fGn(pa):(this.Gz.Ujn(pa)||this.Soc(pa)&&!this.CMf(pa.OF))&&this.NCj(pa)}}r3k(){let K=0,pa=null;var Ta=0;let jb=0;for(let bc=0;bc<this.uu.count;bc++){const Ic=
this.uu.J(bc);this.Soc(Ic)&&(Ic.dtb&&(jb+=this.c_h(Ic,Ta,jb)),pa&&pa.id===Ic.OF.id||(pa=Ic.OF,jb=K=0),Ic.dtb&&!Ic.oga&&(K=this.Fjl(Ic)),Ta=Ic.top+K+jb,Ic.Ood(Ta))}this.c_h(null,Ta,jb);this.Lxo()}c_h(K,pa,Ta){let jb=null;this.T9b&&(jb=this.J3e.Ijl(K,pa,Ta));return jb?jb.delta:0}gHo(){if(this.Q9b){for(let K=0;K<this.Q9b.count;K++){const pa=this.Q9b.J(K);zd.a.GSo(pa.Df,pa.Wgj)}this.T9b&&this.J3e.cHo()}}tzp(){if(!this.T9b){var K=this.ASa.qBi();if(this.uu.count){var pa=this.ASa.Nyi();for(let bc=0;bc<this.uu.count;bc++){var Ta=
this.uu.J(bc);if(this.Soc(Ta)&&Ta.oga){Ta=this.ASa.EGm(Ta.OF);var jb=0<bc?this.uu.J(bc-1).OF:pa;jb=bc&&Ta.id===jb.id?this.uu.J(bc-1).top:0;this.ASa.mye(Ta,jb)}}pa=this.uu.J(this.uu.count-1);pa.oga?this.ASa.mye(K,0):this.ASa.mye(K,pa.top)}else this.ASa.mye(K,0)}}p$o(){this.uu.Sc((K,pa)=>K.lh-pa.lh)}Utg(){for(let K=0;K<this.uu.count;K++)this.uu.J(K).nye(K+1)}Fjl(K){return K?this.f_h(K)-K.top:(ua.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}Rjl(K){if(!K)return 0;
const pa=this.JDi(K.iH);return pa?this.Gz.g_h(this.Gz.sQb(K),pa):0}f_h(K){if(!K)return 0;const pa=this.Gz.sQb(K);K=this.CMf(K.OF);return K?this.Gz.pnf(pa,K):(ua.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),0)}Lxo(){let K=0,pa=!1,Ta=null,jb=!1;for(let bc=this.uu.count-1;0<=bc;bc--){const Ic=this.uu.J(bc);this.Soc(Ic)&&(Ta&&Ta.id===Ic.OF.id||(pa=!Ta,Ta=Ic.OF,K=this.qDm(Ta)),Ic.dtb?(pa=!1,K=Ic.top):this.T9b&&
pa||!(Ic.top>K)||(this.NCj(Ic),zd.a.Dy(this.Gz.sQb(Ic)),jb=!0))}jb&&this.Utg()}NCj(K){this.uu.contains(K)&&(this.T9b&&this.Z1.dzo(K),this.uu.remove(K))}Soc(K){return K?(K=this.Gz.sQb(K))&&K.offsetParent?!0:!1:(ua.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),!1)}gql(){let K=!1;for(let pa=this.Y3a.count-1;0<=pa;pa--)this.Y3a.J(pa).hasChildNodes()&&(this.Y3a.removeAt(pa),K=!0);return K}fGn(K){(K=this.ewi(K.paragraphNode))&&(this.$Pd.contains(K.id)||this.$Pd.add(K.id))}xTf(){this.Oq&&
this.Oq.Ve(23).fo(this.Fig)}Hjl(K){for(let pa=this.uu.count-1;0<=pa;pa--){const Ta=this.uu.J(pa);this.Soc(Ta)&&this.Gjl(Ta,K)}}Gjl(K,pa){const Ta=this.f_h(K),jb=this.Rjl(K);K.dtb?(K.Ood(Ta),K.aPj(jb)):(pa=pa?Ta-K.top:jb-K.I6n,K.Ood(Ta-pa),K.aPj(jb-pa),1<Math.abs(pa)&&this.sXo(this.Gz.sQb(K),pa))}CMf(K){if(!K)return null;K=K.ue(this.ql.oc);return K?K.htmlElement:(ua.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}JDi(K){return K?(K=K.ue(this.ql.oc))?
K.htmlElement:null:null}ewi(K){K=Rm.GraphIterator.eb(K);return K.zb(23)?K.ld(23):null}pDm(K){if(!K)return null;K=K.ue(this.ql.oc);return K?fa.a.getElementBounds(K.htmlElement):(ua.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}qDm(K){return(K=this.pDm(K))?K.height/this.eo.Aj:0}sXo(K,pa){pa=(zd.a.Iqm(K)-pa)*this.eo.Aj;this.Q9b.add(Object.assign(new Sj,{Df:K,Wgj:pa}))}Vrl(){this.uu=new yb.a;this.jJb=new wd.a}}Object(f.a)(wj,"PageEndMarkerPositionUpdater",
null,[1112]);var pm=d(381),jo=d(197),Oi=d(32),Fp=d(379),Ek=d(18),Yq;(function(K){K[K.jwb=0]="para";K[K.Ygp=1]="tableSplit";K[K.Lmq=2]="tableRowSplit"})(Yq||(Yq={}));Object(f.b)("PageEndType",Yq);class vo{constructor(K,pa,Ta,jb,bc,Ic,Uc=!1,kd=!1,pd=!1,Fd=!1,le=!1){this.ZNg(pa,Ta,jb,bc,Ic,pd,le);this.position=K;this.lh=pa;this.paragraphNode=Ta;this.cY=jb;this.gwb=bc;this.OF=Ic;this.pab=Uc;this.G3i=kd;this.jfn=pd;this.oga=Fd;this.Jfe=le}nye(K){this.lh=K}ZNg(K,pa,Ta,jb,bc,Ic,Uc){Uc||(ua.ULS.shipAssertTag(38326881,
336,!!bc,"PageEndDetails: outlineNode parameter value is null."),ua.ULS.shipAssertTag(24126528,336,0<=K,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",K),ua.ULS.shipAssertTag(24126529,336,!!pa||Ic,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),ua.ULS.shipAssertTag(24126530,336,!!Ta||Ic,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),ua.ULS.shipAssertTag(24126531,336,!!jb||Ic,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static FGl(K,
pa){return vo.itf(0,K,null,pa,!0,!1)}static GGl(K){return vo.itf(0,0,null,K,!1,!0)}static itf(K,pa,Ta,jb,bc,Ic){return new vo(K,pa,null,null,Ta,jb,bc,Ic,!0)}static $fc(K,pa){return new vo(0,K,null,pa,null,null,void 0,void 0,void 0,void 0,!0)}}Object(f.a)(vo,"PageEndDetails",null,[]);class xn{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd,pd,Fd,le,jf,of,tf,Se,ye,Uf,sh,Tf,hf){this.aya=!0;this.LOe=0;this.aJd=this.PUe=this.QUe=this.NQe=this.H3e=this.yUe=!1;this.UKd=this.yHb=null;this.iYe=!0;this.sWb=()=>{this.Ocd()};
this.xfg=()=>{this.QUe=!1};this.yfg=()=>{this.PUe=this.QUe=!0};this.M_n=(zi,El)=>{1>=Math.abs(El.delta)||(this.NQe=!0,this.y8j(!El.Ogj))};this.zro=zi=>{zi===this.yHb&&(this.yHb=null);if(this.aya){var El=zi.Yl;if(zi=this.Z3a.get(El.id))for(this.Z3a.Z(El.id,new yb.a),ua.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",zi.count,El.id),this.aea&&this.aea.gJa(),El=0;El<zi.count;El++){const Yk=zi.J(El),lj=Yk.cY;lj.HardBreak||(zd.a.Dy(Yk.gwb),
this.Gtg(lj))}}};this.yro=()=>{this.UKd=null;this.aya&&this.Oma&&0<this.Oma.count&&(ua.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.aBc(this.Oma.toArray(),this.aya))};this.YK=K;this.Ei=pa;this.aea=Ta;this.FQ=jb;this.Oyh=bc;this.bkb=Ic;xn.Gz=kd;this.Yjh=pd;this.$K=Fd;this.Gb=le;this.Wwk=jf;this.Vd=tf;this.Z1=ye;this.L3e=Uf;this.V9b=sh;this.E1=Tf;this.y9b=new pm.a;this.R9b=new yb.a;this.Oma=new yb.a;this.Z3a=new pm.a;this.rQ=of;this.EH=hf;this.Cpe=this.Cpe.bind(this);
this.Epe=this.Epe.bind(this);this.dkd=this.dkd.bind(this);this.Iga=this.Iga.bind(this);this.rQ.MSc(this.sWb);this.I3e=!1;Se&&(Se.nQh(this.yfg),Se.NRd(this.xfg));Uc&&Uc.i1k(this.M_n);this.EH.fKb(this.Iga)}get Dfe(){return this.iYe}get ql(){return this.YK.value}get Ej(){return this.Ei.value}aBc(K,pa){const Ta=this.Vd.Vf("Task","UpdateMarkers");this.ydp();this.aya=pa;xn.Gz.HBj();this.y9b=new pm.a;this.R9b.clear();this.Oma.clear();this.Z3a=new pm.a;this.iYe=this.yUe=!1;this.FQ&&this.FQ.aBc(K);this.I1l();
this.LOe=K.length;this.Z1&&this.Z1.reset(K);this.aea&&this.aea.gJa();for(const jb of K)this.Oma.add(jb),this.Gtg(jb);pa&&this.FQ&&this.L3e&&this.L3e.isEnabled&&(K=this.FQ.x4c(),this.L3e.HIa(K));this.exl();this.NQe=this.H3e=!1;this.PUe=this.QUe;Object(jo.a)()&&xn.sUf&&this.FQ.OMg();this.bkb.nyp(this.FQ.x4c(),this.Oma.count);this.iYe=!0;this.E1.BMg();Ta.stop();ua.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:Ta.Fi,["RenderedLineCount"]:this.LOe,["AvgDurationPerPageInMs"]:Ta.Fi/
this.QDi()})}SDi(){const K=this.FQ.x4c();if(!K)return null;const pa=zd.a.nX(),Ta=new yb.a;for(const jb of K)this.Qnn(jb,pa)&&Ta.add(jb);return Ta}Qnn(K,pa){if(!K)return!1;K=xn.Gz.sQb(K);if(!K)return!1;K=fa.a.CKa(K);return 0<=K&&K<=pa}ati(){const K=new yb.a;if(!this.Z3a)return ua.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),K;const pa=this.Z3a.keys;for(let bc=0;bc<pa.length;bc++){var Ta=pa.J(bc);if(Ta=this.Z3a.J(Ta))for(let Ic=
0;Ic<Ta.count;Ic++){var jb=Ta.J(Ic);jb.cY.HardBreak||jb.gwb.classList.contains("Hidden")||(jb=fa.a.CKa(jb.gwb),K.add(jb))}}return K}ydp(){const K=this.ati(),pa=this.SDi();this.Oyh.TFg(K,pa);this.V9b&&this.V9b.isEnabled&&this.V9b.TFg(pa)}exl(){if(!(25<this.QDi())){var K=this.ati(),pa=this.SDi();this.Oyh.fxl(K,pa,this.H3e,this.yUe,this.NQe,this.PUe);this.V9b&&this.V9b.isEnabled&&this.V9b.HIa(pa)}}Iga(){this.aea.czo();this.Efi()}Efi(){this.aJd&&(this.ql.JDj(this.Cpe),this.ql.eBo(this.Epe),this.ql.LAo(this.dkd),
this.aJd=!1)}I1l(){this.aJd||(this.ql.KPh(this.Cpe),this.ql.R1k(this.Epe),this.ql.iQh(this.dkd),this.aJd=!0)}Gtg(K){if(this.I3e)return!0;K=this.hCo(K);if(!K)return!1;this.Z1&&this.Z1.oWm(K);this.FQ&&(this.FQ.JYk(K),this.bkb.v8j(this.FQ.x4c()),Object(jo.a)()&&xn.sUf&&this.FQ.OMg());return!0}hCo(K){let pa=this.lP(K.ParaId);if(!pa)return null;if(!pa.anchor||!pa.pk)return this.dPh(K,pa),null;let Ta,jb;if(K.HardBreak){var bc=ld.ParagraphReader.zg(pa,!0,!0,!0);this.z8n(bc)&&(pa=bc);if(!({Nma:bc,iH:Ta,ewb:jb}=
this.Yop(K,pa)).returnValue)return null;this.yUe=!0}else if(!({wpe:bc,iH:Ta,ewb:jb}=this.iCo(K,pa)).returnValue)return null;return this.sRd(pa,K,bc,Ta,jb)}z8n(K){return K?(K=K.ue(this.ql.oc))?!!xn.Gz.s8d(K.htmlElement):!1:!1}iCo(K,pa){var Ta=K.PageEndType;let jb,bc=0,Ic=null;if(!Ta){if(!({Nma:K,ycb:jb}=this.TDi(K,pa)).returnValue)return{returnValue:!1,wpe:bc,iH:Ic,ewb:null}}else if(!({Nma:K,mCe:jb}=this.IDm(K,pa)).returnValue)return{returnValue:!1,wpe:bc,iH:Ic,ewb:null};var Uc=Rm.GraphIterator.eb(pa);
Uc.Jd();Ic=Uc.ld(23);pa=Ic.ue(this.ql.oc).getBounds();Uc=Uc.Bdb().ue(this.ql.oc);if(!Uc)return ua.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.ql.oc),{returnValue:!1,wpe:bc,iH:Ic,ewb:null};const kd=Uc.getBounds();bc=K-pa.y;Ta=xn.Gz.Hxi(Ta,bc,this.aya,jb,pa,kd);Uc.gfa.appendChild(Ta);return{returnValue:!0,wpe:bc,iH:Ic,ewb:Ta}}Yop(K,pa){let Ta=null;const jb=pa.ue(this.ql.oc);var bc=0;let Ic=null;if(this.fhe(K,jb,pa))return{returnValue:!1,Nma:bc,iH:Ta,ewb:Ic};
Ta=xn.tgj(pa);const Uc=Ta.ue(this.ql.oc);if(!Uc)return ua.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.ql.oc),{returnValue:!1,Nma:bc,iH:Ta,ewb:Ic};bc=Uc.getBounds();bc=Ul.a.Jr(jb,K.CP).y-bc.y;Ic=this.rum(pa);return{returnValue:!0,Nma:bc,iH:Ta,ewb:Ic}}rum(K){return K.ue(this.ql.oc).htmlElement}lP(K){const pa=this.$K.brb(K);if(pa!==wi.a.nil){const Ta=this.Ej.Eb(pa);if(Ta)return Ta}ua.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",
K,pa);return null}TDi(K,pa){const Ta=K.CP;let jb=0,bc=null;const Ic=pa.ue(this.ql.oc);if(this.fhe(K,Ic,pa))return{returnValue:!1,Nma:jb,ycb:bc};bc=Ic.getBounds();jb=Ta?this.Yjh(Object(Za.a)(88,Ic),Ta):bc.y-this.Wwk(Ic);return{returnValue:!0,Nma:jb,ycb:bc}}IDm(K,pa){let Ta=null,jb=0;var bc=K.PageEndType;let Ic=Rm.GraphIterator.eb(pa);Ic.Jd();if(!Oi.TableReader.yy(Ic))return ua.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",
K.ParaId),{returnValue:({Nma:jb,ycb:Ta}=this.TDi(K,pa)).returnValue,Nma:jb,mCe:Ta};if(bc===Yq.Ygp){Ek.returnToContainingRow(Ic);bc=Ic.currentNode.ue(this.ql.oc);if(this.fhe(K,bc,pa))return{returnValue:!1,Nma:jb,mCe:Ta};jb=bc.getBounds().y}else{bc=pa.ue(this.ql.oc);if(this.fhe(K,bc,pa))return{returnValue:!1,Nma:jb,mCe:Ta};jb=this.Yjh(Object(Za.a)(88,bc),K.CP)}--jb;pa=null;do K=pa,pa=Ic.ld(14);while(pa);Ic=Rm.GraphIterator.eb(K);Ic.Jd();Ek.moveToFirstRow(Ic);Ta=Ic.currentNode.ue(this.ql.oc).getBounds();
return{returnValue:!0,Nma:jb,mCe:Ta}}fhe(K,pa,Ta){if(!pa||pa.zma(16))return this.dPh(K,Ta),!0;pa=pa.getBounds();return pa.width||pa.height?!1:(this.lOh(K),!0)}lOh(K){this.R9b.contains(K)||this.R9b.add(K)}dPh(K,pa){pa=pa.id;let Ta;({value:Ta}=this.y9b.Dc(pa)).returnValue||(Ta=new yb.a,this.y9b.Z(pa,Ta));Ta.add(K)}Cpe(){const K=new yb.a;for(let pa=this.R9b.count-1;0<=pa;pa--){const Ta=this.R9b.J(pa);this.Gtg(Ta)||K.add(Ta)}this.R9b=K;this.Vof()}Vof(){this.FQ&&this.FQ.Vof()&&this.y8j(!1)}y8j(K){this.FQ&&
(this.FQ.Tjl(K)&&(this.H3e=!0),this.FQ.fHo(),this.bkb.v8j(this.FQ.x4c()),Object(jo.a)()&&xn.sUf&&this.FQ.OMg())}Epe(K,pa){try{const Ta=pa.id;if(this.y9b.mb(Ta)){const jb=this.y9b.J(Ta);for(K=0;K<jb.count;K++)this.lOh(jb.J(K));this.y9b.remove(Ta)}}catch(Ta){}}Ocd(){this.aya&&(this.aya=!1,xn.Gz.Ocd())}Ncd(){this.aya||(this.aya=!0,xn.Gz.Ncd())}TUj(){this.I3e=!1;this.Oma&&this.aBc(this.Oma.toArray(),this.aya);this.aea&&this.aea.SUj()}dPi(){this.I3e=!0;xn.Gz.HBj();this.aea&&this.aea.cPi();this.Z1&&this.Z1.k0m()}sRd(K,
pa,Ta,jb,bc){const Ic=this.Oma.indexOf(pa)+1;if(0>Ic)return null;const Uc=Ep.WordSectionNavigator.instance.FN(K),kd=this.oga(pa,K);K=new vo(Ta,Ic,K,pa,bc,Uc,!K||!pa||!bc,!1,!1,kd);this.Z3a.mb(jb.id)||this.Z3a.Z(jb.id,new yb.a);this.Z3a.J(jb.id).add(K);return K}oga(K,pa){if(!K||!K.HardBreak)return!1;K=Rm.GraphIterator.eb(pa);K.zb(7);if(K.bK())return!1;K.ld(23);return K.bK()?!1:!0}Pqg(K){this.aya&&(K.anchor&&K.pk?!(K=xn.tgj(K))||this.yHb&&this.yHb.Yl&&this.yHb.Yl.id===K.id||(this.yHb=Object.assign(new kb.a(3,
1,500,this.zro),{Yl:K}),this.Gb.Zb(this.yHb)):ua.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}dkd(){this.aya&&!this.UKd&&this.Oma&&0<this.Oma.count&&(this.UKd=new kb.a(3,1,500,this.yro),this.Gb.Zb(this.UKd))}dispose(){this.ql&&this.Efi();this.EH.ftg(this.Iga);this.rQ.Aue(this.sWb)}static get sUf(){null==xn.TVe&&(xn.TVe=m.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return xn.TVe}static num(K){let pa=0;try{const Ta=
K.htmlElement,jb=zd.a.KP(Ta.firstChild.style.marginTop);K=0;const bc=xn.hNf(Ta.parentNode);if(bc){const Ic=bc.firstChild;Ic&&Ic.classList.contains("ParaWrappingDiv")&&(K=zd.a.KP(Ic.firstChild.style.marginBottom))}pa=Math.max(jb,K)/2}catch(Ta){}return pa}static hNf(K){let pa=K.previousSibling;if(!pa){var Ta=K.parentNode;zd.a.d_f(Ta)&&(Ta=Ta.parentNode)&&(pa=Ta.previousSibling)}if(!pa&&(K=K.parentNode,K.classList.contains("OutlineGroup")||ua.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",
K.tagName,K.className),(K=K.previousSibling)&&K.hasChildNodes())){pa=K.lastChild;do{if(pa.classList.contains("OutlineElement")||zd.a.d_f(pa)&&pa.classList.contains(Fp.a.Jqc))break;pa=pa.previousSibling}while(pa)}if(pa){if(pa.classList.contains(Fp.a.Jqc))return pa.lastChild.lastChild;if(zd.a.d_f(pa))return pa.lastChild}return pa}static tgj(K){K=Rm.GraphIterator.eb(K);return K.zb(23)?K.ld(23):null}QDi(){return this.LOe+1}}xn.Gz=null;xn.TVe=null;Object(f.a)(xn,"PageEndMarkers",null,[1009,1010,13]);var qr=
d(150);class gn{constructor(K,pa,Ta){this.F6n=".Outline";this.YK=K;this.eo=pa;this.Gz=Ta}get ql(){const K=this.YK.value;ua.ULS.shipAssertTag(38416594,336,K.nj,"Invalid PageView.");return K}Mjc(K){return(K=K.OF)?this.HDi(K):(ua.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),null)}HDi(K){let pa,Ta;return(pa=K.ue(this.ql.oc))&&(Ta=pa.htmlElement)?Ta.querySelector(this.F6n):(ua.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}dwi(K){K=so.OutlineElementNavigator.nm(K.paragraphNode);
let pa;return K&&(pa=K.ue(this.ql.oc))?pa.htmlElement:(ua.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}TZh(K,pa){const Ta=this.qRm(K);return this.Mjl(K,pa)-Ta}Dxi(K){return this.MDi(K.OF,K.lh)}MDi(K,pa){if(!K)return-1;var Ta=K.ja(wf.a.qw,-1);Ta=kc.a.qj(Ta,1);var jb=K.ja(wf.a.marginTop,-1);jb=kc.a.qj(jb,1);K=K.ja(wf.a.marginBottom,-1);K=kc.a.qj(K,1);return 1===pa?Ta-K:Ta-(jb+K)}yQl(K){K&&zd.a.Dy(K.gwb)}cNf(K){if(K.G3i||K.oga)return 0;if(K.pab)return K=this.Mjc(K),
fa.a.getElementBounds(K).height/this.eo.Aj;const pa=this.Mjc(K);return this.Gz.pnf(this.RDi(K),pa)}dEl(K,pa,Ta){Ta=Ta.ue(this.ql.oc).getBounds();K=K.ue(this.ql.oc);const jb=K.getBounds();Ta.y=jb.y;pa=this.Gz.Hxi(Yq.jwb,pa*this.eo.Aj,!1,Ta,Ta,jb);K.gfa.appendChild(pa);return pa}DTi(K,pa){if(K&&!K.Jfe)if(K.pab){if(K=this.Mjc(K))K.style.paddingBottom=pa+"px"}else if(K.cY&&K.cY.HardBreak)if(K.oga){if(K=this.mFi(K))K.style.paddingBottom=pa+"px"}else{if(K=this.dwi(K))K.style.paddingTop=pa+"px"}else ua.ULS.shipAssertTag(39077394,
336,!1,"Applying blank space on a page which is not hard break or last page.")}fRh(K,pa){pa=this.Mjc(pa);K=this.Mjc(K);return fa.a.CKa(pa)-fa.a.CKa(K)}nFi(K){K=Rm.GraphIterator.eb(K.OF);K.zb(7);return K.bK()}z0i(K){if(!K||K.Jfe)return!1;if(K.pab||K.G3i)return!0;K=this.RDi(K);return!!K&&zd.a.mfa(K)}QU(K){this.Gz.QU(K)}mFi(K){return(K=this.nFi(K))?(K=K.nl(this.ql.oc).htmlElement,K?K:(ua.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}RDi(K){return K.cY&&K.cY.HardBreak&&!K.oga?
this.Gz.s8d(K.gwb):K.gwb}qRm(K){if(K.pab){K=this.Mjc(K);if(!K)return ua.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;K=qr.a.WB(K);return zd.a.nla(K.paddingBottom)}if(K.cY&&K.cY.HardBreak){if(K.oga)return(K=this.mFi(K))?zd.a.nla(K.style.paddingBottom):-1;K=this.dwi(K);return K?zd.a.nla(K.style.paddingTop):(ua.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}Mjl(K,pa){return this.cNf(K)-pa}}Object(f.a)(gn,"PageFullHeightDOMHelper",null,[]);
class Cs{constructor(){this.delta=this.ubk=this.Xw=0;this.Mma=null;this.sVa=this.bvj=0;this.iH=null;this.jJa=0;this.tWf=new yb.a;this.x_d=new yb.a;this.cQn=new yb.a}}Object(f.a)(Cs,"PageFullHeightInfo",null,[]);class Hi{constructor(K,pa){this.kHa=K;this.Hz=pa}d_h(K,pa){try{return this.Jjl(K,pa)}catch(Ta){return this.Hz.QU(Ta.message+" "+Ta.stack),ua.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",Ta.message),null}}Jjl(K,pa){ua.ULS.shipAssertTag(38416596,
336,K.pab||K.cY.HardBreak);const Ta=this.Hz.cNf(K),jb=this.Hz.TZh(K,pa),bc=this.kHa.PZh(K,jb);K=Object.assign(new Cs,{jJa:jb,sVa:bc,Mma:K});this.Xwp(K);K.ubk=K.sVa-K.jJa;K.delta=pa+bc+K.delta-Ta;return K}Xwp(K){K.jJa>K.sVa?this.Ywp(K):0>K.jJa&&this.pMg(K)}pMg(K){let pa=K.Mma.lh;for(;0>K.jJa;)K.Xw--,K.delta-=this.kHa.$2c(pa),K.jJa+=this.kHa.$2c(pa-1),pa--;K.sVa=this.kHa.$2c(pa)}Ywp(K){const pa=this.Hz.Dxi(K.Mma);K.Xw=Math.floor((K.jJa-K.sVa)/pa)+1;K.delta=K.Xw*pa;K.jJa-=K.sVa+(K.Xw-1)*pa;K.sVa=pa}}
Object(f.a)(Hi,"PageFullHeightInfoCalculator",null,[]);class Tm{constructor(K,pa,Ta,jb){this.x5a=0;this.BTa=null;this.kHa=K;this.DGb=pa;this.XZ=Ta;this.Hz=jb;this.SBh=new yb.a}get S0(){return this.SBh}oWm(K){try{this.WRf(K)}catch(pa){this.Hz.QU(pa.message+" "+pa.stack),ua.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",pa.message)}}reset(K){try{this.wFo(K)}catch(pa){this.Hz.QU(pa.message+" "+pa.stack),ua.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",
pa.message)}}k0m(){try{this.l0m()}catch(K){this.Hz.QU(K.message+" "+K.stack),ua.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",K.message)}}I$m(K){try{this.J$m(K)}catch(pa){this.Hz.QU(pa.message+" "+pa.stack),ua.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",pa.message)}}dzo(K){try{this.ezo(K)}catch(pa){this.Hz.QU("Pagination: "+pa.message+" "+pa.stack),ua.ULS.sendTraceTag(39387716,
336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",pa.message)}}S6m(){var K=this.XZ.bKf(),pa=this.XZ.kBi();K=vo.GGl(K);pa=vo.FGl(this.x5a,pa);this.S0.Z(0,K);this.WRf(pa)}AFo(){var K=Ep.WordSectionNavigator.instance.kBi();(K=this.Hz.HDi(K).parentNode)&&""!==K.style.minHeight&&(K.style.minHeight="")}S7m(K){this.SBh=new yb.a;this.S0.add(null);for(let pa=0;pa<K.length;pa++){const Ta=vo.$fc(pa+1,K[pa]);this.S0.add(Ta)}this.S0.add(vo.$fc(K.length+1,null))}C7m(K){this.kHa.GFo(K)}fGo(){if(this.S0)for(const K of this.S0)K&&
this.fZi(K)&&this.Hz.DTi(K,0)}WRf(K){const pa=this.yGm(K);if(this.Hz.z0i(pa)){let Ta=this.Hz.cNf(pa);K.OF!==pa.OF&&(Ta+=this.Hz.fRh(K,pa));this.Ril(K,Ta);this.fZi(K)&&this.Htg(K,Ta)}else this.BTa.add(K),20<this.BTa.count&&ua.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.BTa.count);this.S0.Z(K.lh,K);this.cWm(K)}l0m(){this.fGo()}wFo(K){this.x5a=K.length+1;this.BTa=new yb.a;this.S7m(K);this.C7m(this.x5a);this.S6m();this.AFo()}J$m(K){this.kHa.ryp(K);for(const pa of K){if(!pa){ua.ULS.sendTraceTag(38916955,
336,10,"info is null.");return}if(0<pa.Xw){K=pa.Mma.lh;for(const Ta of pa.tWf)this.S0.insert(K,Ta),K++}else if(0>pa.Xw)for(const Ta of pa.x_d)this.S0.remove(Ta),this.BTa.contains(Ta)&&this.BTa.remove(Ta)}this.NEj()}ezo(K){K=K.lh;this.kHa.fzo(K);this.S0.removeAt(K);for(const pa of this.BTa)pa.lh===K&&this.BTa.remove(pa);this.NEj()}Ril(K,pa){pa=this.Hz.TZh(K,pa);this.kHa.PZh(K,pa)}Htg(K,pa){K.cY&&K.cY.HardBreak||this.DGb.Htg(K,pa)}cWm(K){K=K.lh+1;for(const pa of this.BTa)if(pa&&pa.lh===K){this.WRf(pa);
this.BTa.remove(pa);break}}NEj(){for(let K=0;K<this.S0.count;K++){const pa=this.S0.J(K);pa&&pa.nye(K)}}fZi(K){K=this.CDm(K);return 2===K||1===K}yGm(K){return this.S0.J(K.lh-1)}CDm(K){return K.pab?2:K.cY&&K.cY.HardBreak?1:0}}Object(f.a)(Tm,"PageFullHeightManager",null,[1136]);class gs{constructor(K,pa,Ta,jb){this.DGb=K;this.kHa=pa;this.XZ=Ta;this.Hz=jb}create(){return new Tm(this.kHa,this.DGb,this.XZ,this.Hz)}}Object(f.a)(gs,"PageFullHeightManagerFactory",null,[]);var pk=d(1186),Yo=d(760);class Hr{constructor(K,
pa,Ta,jb,bc){this.S9b=null;this.Z1=K;this.FQ=pa;this.gNc=Ta;this.DGb=jb;this.Hz=bc}reset(){this.S9b=new yb.a}Ijl(K,pa,Ta){try{return this.Kjl(K,pa,Ta)}catch(jb){return ua.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",jb.message),null}}cHo(){try{this.dHo()}catch(K){ua.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",K.message)}}Kjl(K,pa,Ta){if(!this.Z1.S0.count)return null;
const jb=this.GDm(K,!K);if(!jb||jb.Jfe)return ua.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(jb.cY&&jb.cY.HardBreak)return null;var bc=this.Z1.S0.J(jb.lh-1);return this.Hz.z0i(bc)&&(pa-=Ta,jb.OF!==bc.OF&&(pa+=this.Hz.fRh(jb,bc)),(bc=this.gNc.d_h(jb,pa))&&1<Math.abs(bc.delta))?(bc.bvj=pa,bc.iH=this.nDm(K,jb),this.S9b.add(bc),this.pMg(bc),bc):null}nDm(K,pa){return pa&&pa.pab?(K=Object(Za.a)(Yo.a,ld.ParagraphReader.hD(pa.OF)),K=Rm.GraphIterator.eb(K),
K.tq(),Object(Za.a)(pk.a,K.ld(23))):K&&K.dtb?K.iH:null}dHo(){this.S9b.Sc((K,pa)=>pa.Mma.lh-K.Mma.lh);for(const K of this.S9b)this.DGb.AEj(K);this.vyp()}vyp(){this.FQ.value.G$m(this.S9b);this.Z1.I$m(this.S9b)}GDm(K,pa){return pa?this.Z1.S0.J(this.Z1.S0.count-1):this.Z1.S0.J(K.lh)}pMg(K){let pa=K.Mma.lh;const Ta=-K.Xw;for(let jb=0;jb<Ta;jb++)pa--,K.x_d.add(this.Z1.S0.J(pa))}}Object(f.a)(Hr,"PageFullHeightPositionUpdater",null,[1135]);class Wn{constructor(K,pa,Ta,jb,bc){this.Z1=K;this.FQ=pa;this.gNc=
Ta;this.DGb=jb;this.Hz=bc}create(){return new Hr(this.Z1,this.FQ,this.gNc,this.DGb,this.Hz)}}Object(f.a)(Wn,"PageFullHeightPositionUpdaterFactory",null,[]);class Fq{constructor(K,pa){this.Hz=K;this.gNc=pa}Htg(K,pa){try{this.lCo(K,pa)}catch(Ta){this.Hz.QU(Ta.message+" "+Ta.stack),ua.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",Ta.message)}}AEj(K){try{this.kCo(K)}catch(pa){this.Hz.QU(pa.message+" "+pa.stack),ua.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",
pa.message)}}lCo(K,pa){ua.ULS.shipAssertTag(38285913,336,K.pab||K.cY.HardBreak);K=this.gNc.d_h(K,pa);this.AEj(K)}kCo(K){this.jCo(K);this.bCo(K)}bCo(K){0<K.Xw?this.S$m(K):0>K.Xw&&this.zQl(K)}jCo(K){this.Hz.DTi(K.Mma,K.ubk)}S$m(K){let pa=K.bvj+K.sVa;for(let jb=0;jb<K.Xw;jb++){var Ta=K.Mma.lh+jb;const bc=K.Mma.oga?this.Hz.nFi(K.Mma):K.Mma.OF;Ta=this.cEl(bc,K.iH,pa,Ta);K.tWf.add(Ta);K.cQn.add(pa);pa+=K.sVa}}zQl(K){for(const pa of K.x_d)this.Hz.yQl(pa)}cEl(K,pa,Ta,jb){pa=this.Hz.dEl(K,Ta,pa);return vo.itf(Ta,
jb,pa,K,!1,!1)}}Object(f.a)(Fq,"PageFullHeightRenderer",null,[]);class Vs{constructor(K){this.dqg=K}}Object(f.a)(Vs,"PageHeightDeltaResult",null,[1133]);class kp{constructor(K,pa,Ta){this.Xp=null;this.Hz=K;this.jj=pa;Ta.execute(jb=>{jb.register(this)})}get Gdd(){return"PageHeightDelta"}get result(){return this.Xp}get ucg(){return 1}get hxg(){return 500}get isEnabled(){return!0}Icg(){this.Xp=null}HIa(K){this.jj.Yd(()=>{try{this.IUc(K)}catch(pa){ua.ULS.sendTraceTag(39188045,324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",
pa.message)}},"PHDM:C")}IUc(K){this.Xp=null;K=this.JUc(K);-1!==K&&(this.Xp=new Vs(K))}JUc(K){if(!K.count)return-1;let pa=0,Ta=0;for(const jb of K)K=this.Ljl(jb),-1!==K&&(pa+=K,Ta++);return Ta?pa/Ta:-1}Ljl(K){if(!K.yin)return-1;const pa=this.Hz.MDi(K.dUd,K.lh);return-1===pa?-1:Math.abs(K.height-pa)}}Object(f.a)(kp,"PageHeightDeltaMetric",null,[1110]);class xl{constructor(K){this.I2a=null;this.Hz=K}$2c(K){return this.I2a.J(K-1)}GFo(K){this.I2a=new yb.a;for(let pa=0;pa<K;pa++)this.I2a.add(-1)}PZh(K,
pa){if(this.Rnn(K))return this.I2a.J(K.lh-1);pa=this.ljl(K,pa);this.zdp(K,pa);return pa}ryp(K){for(const pa of K)this.qyp(pa)}zdp(K,pa){this.I2a.Z(K.lh-1,pa)}fzo(K){this.I2a.removeAt(K-1)}qyp(K){if(K)if(0<K.Xw){var pa=K.Mma.lh;for(var Ta=0;Ta<K.Xw;Ta++)this.I2a.insert(pa,K.sVa)}else if(0>K.Xw)for(pa=-K.Xw,K=K.Mma.lh-pa,Ta=0;Ta<pa;Ta++)this.I2a.removeAt(K)}Rnn(K){return-1!==this.I2a.J(K.lh-1)}ljl(K,pa){if(K.pab||K.cY.HardBreak)K=this.Hz.Dxi(K),pa=pa<K?K:pa;return pa}}Object(f.a)(xl,"PageHeightStorage",
null,[]);var Um=d(122);class Ga{constructor(K){this.dqg=K}}Object(f.a)(Ga,"PageLevelDeltaResult",null,[1133]);class Ib{constructor(K,pa,Ta,jb){this.Xp=null;this.YK=K;this.Kya=pa;this.jj=Ta;jb.execute(bc=>{bc.register(this)})}get ql(){const K=this.YK.value;ua.ULS.shipAssertTag(39081438,336,K.nj,"PageLevelDeltaMetric.PageView is not a PageView.");return K}get Gdd(){return"PageLevelDelta"}get result(){return this.Xp}get ucg(){return 0}get hxg(){return 60}get isEnabled(){return!0}Icg(){this.Xp=null}HIa(K){this.jj.Yd(()=>
{try{this.IUc(K)}catch(pa){ua.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",pa.message)}},"PLDM:C")}IUc(K){this.Xp=null;K=this.JUc(K);-1!==K&&(this.Xp=new Ga(K))}JUc(K){if(!K.count)return-1;let pa=0,Ta=0;for(const jb of K)K=this.Njl(jb),-1!==K&&(pa+=K,Ta++);return Ta?pa/Ta:-1}Njl(K){if(K.dtb)return-1;var pa=K.cY.CP;K=K.paragraphNode;ua.ULS.shipAssertTag(39081441,336,!!K);K=K.ue(this.ql.oc);ua.ULS.shipAssertTag(39081442,324,Object(Um.a)(88,K));
let Ta;({j9h:pa,S6i:K,WHj:Ta}=this.Ajl(K,zd.a.Vz(K.htmlElement).length,pa));return K&&Ta?Math.min(pa.x-K.x,Ta.x-pa.x):(ua.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}Ajl(K,pa,Ta){let jb,bc,Ic,Uc=bc=Ta,kd=Ic=jb=null;if(Ta>pa)return ua.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{j9h:kd,nyn:Uc,S6i:Ic,MIo:bc,WHj:jb};kd=this.Kya.Jr(K,
Ta);for(var pd=0,Fd=Ta;pd<=Fd;){const le=Math.floor((pd+Fd)/2),jf=this.Kya.Jr(K,le);if(pd===Fd){Uc=le;Ic=jf;break}jf.y+jf.height<=kd.y?pd=le+1:Fd=le}for(;Ta<=pa;){pd=Math.ceil((Ta+pa)/2);Fd=this.Kya.Jr(K,pd);if(Ta===pa){bc=pd;jb=Fd;break}Fd.y>=kd.y+kd.height?pa=pd-1:Ta=pd}return{j9h:kd,nyn:Uc,S6i:Ic,MIo:bc,WHj:jb}}}Object(f.a)(Ib,"PageLevelDeltaMetric",null,[1110]);class lc{constructor(K,pa,Ta,jb,bc,Ic,Uc){this.lh=K;this.top=pa;this.ILh=Ta;this.height=jb;this.S1b=bc;this.dUd=Ic;this.yin=Uc}}Object(f.a)(lc,
"Page",null,[]);class Mc{constructor(K,pa,Ta,jb,bc){this.M9b=null;this.kHh=0;this.YK=K;this.pAd=pa;this.Nyh=Ta;this.ASa=jb;this.Pyh=bc;this.c4a=new yb.a}get ql(){const K=this.YK.value;ua.ULS.shipAssertTag(37007393,336,K.nj,"PageManager.PageView is not a PageView.");return K}get zl(){return this.c4a}v8j(K){K=this.dzj(K);this.w8j(K)}nyp(K,pa){this.kHh=pa;K=this.dzj(K);this.w8j(K);this.Pyh.isEnabled&&this.Pyh.HIa(K)}dzj(K){this.c4a=new yb.a;this.M9b=new pm.a(0);const pa=new yb.a;if(!K)return this.zl;
var Ta=0,jb=null;for(let bc=0;bc<K.count;bc++){const Ic=K.J(bc);Ta=Ic.lh;jb=this.WYd(Ta,jb,Ic);this.zl.add(jb);!Mc.I1e&&0>jb.height&&pa.add(jb);jb=Ic}K=this.WYd(Ta+1,jb,null);this.zl.add(K);!Mc.I1e&&0>K.height&&pa.add(K);for(const bc of pa)Mc.I1e=!0,ua.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+bc.lh);return this.zl}WYd(K,pa,Ta){const jb=pa?pa.OF:this.ASa.Nyi(),bc=Ta?Ta.OF:this.ASa.qBi();var Ic=this.NDi(jb);const Uc=this.NDi(bc),kd=pa?this.a_h(pa):0;Ic=
kd+Ic;const pd=Ta?this.a_h(Ta):this.pAd.ucb.clientHeight-Uc;return new lc(K,kd,Ic,jb.id===bc.id?pd-kd:pd+Uc-Ic,jb,bc,(Ta?Ta.lh:this.kHh+1)===(pa?pa.lh:0)+1)}a_h(K){return K.oga?0:K.top}w8j(K){if(this.Nyh.vpe)for(const pa of this.Nyh.vpe)pa&&pa.x8j(K)}NDi(K){this.M9b||(this.M9b=new pm.a(0));if(this.M9b.mb(K.id))return this.M9b.J(K.id);var pa=K.ue(this.ql.oc);if(!pa)return ua.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;pa=fa.a.lWa(this.pAd.ucb,pa.htmlElement).y;
this.M9b.Z(K.id,pa);return pa}}Mc.I1e=!1;Object(f.a)(Mc,"PageManager",null,[1111]);var Bd=d(663);class Ie{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd){this.MVj=kd;this.NNg=this.vcb=!1;this.lme=(pd,Fd)=>{0!==Fd.Nbb||this.NNg?this.Bgi():this.Wji()};this.ga=K;this.k6=pa;this.VKh=Ta;this.uu=jb;this.yj=bc;this.Syh=Ic;this.EQ=Uc;kd||(this.vcb=0===this.EQ.Ax,this.EQ.LRd(this.lme))}Wb(){this.ga.fb(rf.a.rjd,Ad.a.application,this.rjd.bind(this),96);this.ga.fb(rf.a.Use,Ad.a.application,this.Use.bind(this),96);this.ga.fb(rf.a.wDe,
Ad.a.application,this.wDe.bind(this),96);this.ga.fb(rf.a.tDe,Ad.a.application,this.tDe.bind(this),8)}wDe(K,pa,Ta){return 1===Ta?32:this.ga.Ob(rf.a.t0a,2)}tDe(K,pa,Ta,jb){if(1===Ta)return this.MVj?8:0===this.EQ.Ax?32:8;this.vcb?(this.Bgi(),this.NNg=!0):(this.Wji(),this.NNg=!1);this.yj.Ie();jb.Gt=this.vcb?1:0;return 32}rjd(K,pa,Ta,jb,bc){if(1===Ta)return 32;K=this.Syh.getTotalPageCount();-1===K?K="":this.vcb||1===this.EQ.Ax||2===this.EQ.Ax?(pa=this.Syh.wom(),pa>K&&(K=pa),K=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,
pa,K)):K=1===K?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,K):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,K);bc[Bd.a.Visible]=!0;bc[Bd.a.LabelText]=K;return 32}Use(K,pa,Ta,jb,bc){if(1===Ta)return 32;bc[lk.a.On]=this.vcb;return 32}Wji(){this.vcb||this.MVj||(this.VKh.F_l(),this.uu.TUj(),this.vcb=!0)}Bgi(){this.vcb&&(this.VKh.aUl(),this.uu.dPi(),this.vcb=!1)}}Object(f.a)(Ie,"PaginationActor",null,[]);class zf{constructor(K){this.dqg=K}}Object(f.a)(zf,"PaginationDeltaResult",
null,[1133]);class Qe{constructor(K,pa){this.cHb=this.rBd=null;this.jj=K;pa.execute(Ta=>{Ta.register(this)})}get Gdd(){return"PaginationDelta"}get result(){return this.rBd}get ucg(){return 1}get hxg(){return 200}get isEnabled(){return!0}Icg(){this.rBd=null}HIa(K){this.jj.Yd(()=>{try{this.IUc(K)}catch(pa){ua.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",pa.message)}},"PDM:C")}TFg(K){this.cHb=K}IUc(K){this.rBd=null;K=this.JUc(this.cHb,K);-1!==
K&&(this.rBd=new zf(K))}JUc(K,pa){if(!(K&&pa&&K.count&&pa.count))return-1;const Ta=new yb.a;for(const jb of K)Ta.add(jb.top);K=new yb.a;for(const jb of pa)K.add(jb.top);pa=this.J3d(Ta,K);return this.rfc(pa)}rfc(K){if(!K.count)return 0;let pa=0;for(let Ta=0;Ta<K.count;Ta++)pa+=K.J(Ta);return pa/K.count}J3d(K,pa){const Ta=new yb.a;if(!K.count||!pa.count)return Ta;var jb=K.count<=pa.count;const bc=jb?K:pa;K=jb?pa:K;for(pa=0;pa<bc.count;pa++){jb=bc.J(pa);let Uc=Math.abs(jb-K.J(0)),kd=0;for(let pd=1;pd<
K.count;pd++){var Ic=K.J(pd);Ic=Math.abs(jb-Ic);Ic<Uc&&(Uc=Ic,kd=pd)}Ta.add(Uc);K.removeAt(kd)}return Ta}}Object(f.a)(Qe,"PaginationDeltaMetric",null,[1110]);var bg=d(496),Rg=d(1457),di=d(2177);class mh extends bg.a{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd=null){super();this.BQ=null;this.KOe=0;this.x5a=-1;this.WDb=!1;this.$U=()=>{ua.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.Dgi()};this.ufg=()=>{if(0==this.EH.Ax){var pd=this.BQ.Is;wi.a.Bt(pd,this.S8b)||
(this.S8b=pd,this.zZn(this.x3a,this.S8b))}};this.EH=K;this.Iga=this.Iga.bind(this);this.EH.fKb(this.Iga);this.ga=pa;this.uu=Ta;this.E1=jb;this.eqa=bc;this.S_e=kd||Kf.a.instance;this.S8b=this.x3a=wi.a.nil;this.eDk=Uc;Ic.CWR(()=>Ic.result.qC.hza(this.$U));this.Zgc();this.Zk=new Rg.a(1E3);this.Zk.G7a();this.eqa.register(this)}get yma(){return"Pagination"}get czf(){return this.eDk.value}get gPa(){return this.x5a}r_o(K){this.x5a!==K&&(this.x5a=K,this.E1.BMg())}Iga(){this.x3a=this.S8b=wi.a.nil;this.Zgc()}Gvb(K){this.BQ=
K;this.BQ.dKb(this.ufg);this.xcc(this.BQ.node)}zZn(K,pa){wi.a.Bt(K,pa)?(this.uu.Ncd(),this.Zgc()):(this.uu.Ocd(),this.dcp())}O_l(){this.enabled=2}Zgc(){this.enabled=0}dcp(){this.KOe=0;this.O_l();this.dD(null,null,null)}NBa(){return ej.App.SU||Ld.StaticTheCoauthManager.ud().qC.Ko?!1:!!(this.enabled&2)&&this.Zk.W_()}dD(){this.Zk.wKa();this.eqa.pY()}CF(){}nba(){return 0===this.enabled?!1:this.ie&&this.ie.status===Bh.a.rS?!0:this.NBa()}ONa(){if(1===this._state)this.ie.ar=di.a.Xea(m.AFrameworkApplication.rootQuerySignature,
this.x3a),this.ie.GE="Pagination",this.ie.status=Bh.a.nH,this._state=3;else if(3===this._state&&this.ie&&this.ie.status===Bh.a.rS)if(m.AFrameworkApplication.ol)this._state=4;else if(this.Zk.X4(),this.Zk.sba(),this._state=1,this.KOe++,2!==this.ie.statusCode)this.$gc();else if(1!==(this.ie.gk?this.ie.gk.length:0))this.$gc();else{var K=this.ie.gk[0];this.S_e.FPa(K);104===K.StatusCode?this.Dgi():101===K.StatusCode?this.$gc():3===K.StatusCode?this.$gc():K.StatusCode?this.$gc():K.PageEnds?(this.r_o(K.PageEnds.length+
1),this.x3a=Db.b(K.LastKnownPaginationRevision),ua.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.x5a,this.x3a),this.uu.aBc(K.PageEnds,wi.a.Bt(this.x3a,this.S8b)),this.czf.Oma=K.PageEnds,this.E1.inf(),ua.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.x5a,this.x3a),
this.jUl()):this.$gc()}}Dgi(){this.BQ&&this.BQ.tZb(this.ufg);this.Zgc()}$gc(){60<this.KOe&&this.Zgc()}jUl(){wi.a.Bt(this.x3a,this.S8b)&&this.Zgc()}dispose(){this.BQ&&(this.BQ.tZb(this.ufg),this.BQ.node&&this.Lkd(this.BQ.node),this.BQ=null);this.EH.ftg(this.Iga)}xcc(K){K&&(K.addListener(this),this.WDb=!0)}Lkd(K){this.WDb&&K&&(K.removeListener(this),this.WDb=!1)}BWb(K){this.Lkd(K)}QMa(){}acb(K){(K=K.td.Bm)&&this.qWn(this.x3a,K.id)}qWn(K,pa){wi.a.Bt(K,pa)&&this.uu.Ncd()}}Object(f.a)(mh,"PaginationReplicator",
bg.a,[1001,13,104]);class Fk{get Dfe(){return!0}aBc(){}Ocd(){}Ncd(){}TUj(){}dPi(){}dispose(){}Pqg(){}dkd(){}}Object(f.a)(Fk,"PageEndMarkersNoOp",null,[1009,1010,13]);class Cj{dispose(){}Gvb(){}get gPa(){return-1}}Object(f.a)(Cj,"PaginationReplicatorNoOp",null,[1001,13]);class Na{constructor(){this.aea=this.uu=this.E1=this.hPe=this.zJ=null;this.Pxa=!1;this.h6k=()=>{this.hSh()}}get name(){return"WordEditor.Pagination"}wc(K){this.W=K;this.xd=this.W.resolve("Box4.IFeatureHelper");this.W.ia("WordEditor.Pagination.PageElementManagerList",
()=>new Eh(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).ha();this.W.ia("WordEditor.Pagination.OutlineManager",()=>new ed(new Ec.a(()=>Od.StaticActiveAppFrame.za().ib.sc))).as("WordEditor.Pagination.IOutlineManager").ha();this.W.ia("WordEditor.Pagination.PageManager",()=>new Mc(new Ec.a(()=>Od.StaticActiveAppFrame.za().ib.sc),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageElementManagerList"),
this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").ha();this.W.ia("WordEditor.IPaginationReplicator",()=>this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Vra?new Cj:new mh(this.W.resolve("WordEditor.IMainViewModeManager"),m.AFrameworkApplication.va,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),ch.a.d1,
Ld.StaticTheCoauthManager.bta(),new Ec.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).ha();this.W.ia("WordEditor.IWebViewCurrentPageManager",()=>new bq(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).ha();this.W.ia("WordEditor.Pagination.PageLevelDeltaMetric",()=>new Ib(new Ec.a(()=>Od.StaticActiveAppFrame.za().ib.sc),this.W.resolve("Box4.ITextMetricsAdapter"),kl.a.instance,this.W.Qa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PageHeightDeltaMetric",
()=>new kp(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),kl.a.instance,this.W.Qa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PaginationDeltaMetric",()=>new Qe(kl.a.instance,this.W.Qa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PageHeightStorage",()=>new xl(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightDOMHelper",
()=>new gn(new Ec.a(()=>Od.StaticActiveAppFrame.za().ib.sc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightInfoCalculator",()=>new Hi(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightRenderer",()=>new Fq(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).ha();
this.W.ia("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new Wn(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),this.W.rf("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).ha();
this.W.ia("WordEditor.Pagination.PageEndMarkerPositionUpdater",()=>new wj(new Ec.a(()=>Od.StaticActiveAppFrame.za().ib.sc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),ej.App.jf.Il)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").ha();this.W.ia("WordEditor.Pagination.PageFullHeightManagerFactory",
()=>new gs(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageHeightStorage"),Ep.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).ha();this.W.ia("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new qj(this.W.resolve("Common.IZoomManager"),kl.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").ha();
this.W.ia("WordEditor.Pagination.PaginationActor",()=>new Ie(m.AFrameworkApplication.va,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.IWebViewCurrentPageManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),m.AFrameworkApplication.ua,this.W.resolve("WordEditor.IPageNumberFinder"),this.W.resolve("WordEditor.IMainViewModeManager"),this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Vra)).ha();this.W.ia("WordEditor.Pagination.DocumentSizeManager",
()=>new Eb(new Ec.a(()=>Od.StaticActiveAppFrame.za().ib.sc),Cm.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).ha();this.W.ia("WordEditor.Pagination.CurrentPageCalculator",()=>new vm(m.AFrameworkApplication.va,Hj.a.instance,ze.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new Ec.a(()=>Od.StaticActiveAppFrame.za().ib.sc),this.W.Oa("Box4.CpConversionManagerImpl"),this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").ha();this.W.ia("WordEditor.Pagination.IPageEndMarkers",
()=>{this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Vra?this.uu=new Fk:this.uu=new xn(new Ec.a(()=>Od.StaticActiveAppFrame.za().ib.sc),new Ec.a(()=>Od.StaticActiveAppFrame.za().ib.$c.td),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),
this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),Ul.a.e4c,this.W.resolve("WordEditor.ParagraphWordIdMapping"),ze.a.instance,xn.num,this.W.resolve("Box4.ContentEditableViewEventSource"),new pr.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.W.resolve("Common.ICurrentPageCalculator"),this.W.resolve("WordEditor.IMainViewModeManager"));
return this.uu}).as("Box4.IPaginationRefreshHelper").ha();this.W.ia("WordEditor.Pagination.PageEndDOMHelper",()=>new yg(this.W.Qa("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"))).ha();this.W.ia("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new rd(m.AFrameworkApplication.mc)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").ha();this.W.ia("WordEditor.Pagination.PageAdornmentContentManager",()=>new Wd(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").ha();
this.W.ia("WordEditor.Pagination.PageAdornmentManager",()=>this.aea=new Ag(new Ec.a(()=>Od.StaticActiveAppFrame.za().ib.sc),mf.a.instance,jp.a.instance,Re.a.instance,m.AFrameworkApplication.va,wn.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),ze.a.instance,m.AFrameworkApplication.K,!!ej.App.instance&&ej.App.instance.Qta)).as("WordEditor.Pagination.IPageAdornmentManager").ha()}init(){this.xd.Ds.continueWith(()=>
{this.Mo()})}Mo(){const K=Od.StaticActiveAppFrame.za().ib;K.lCa?this.hSh():K.Eja(this.h6k)}hSh(){this.Pxa||(this.Pxa=!0,this.hPe=Ca.a.instance.resolve("WordEditor.IWebViewCurrentPageManager"),this.E1=Ca.a.instance.resolve("Common.ICurrentPageCalculator"),this.zJ=Ca.a.instance.resolve("WordEditor.IPaginationReplicator"),Ca.a.instance.resolve("WordEditor.Pagination.PaginationActor").Wb())}dispose(){this.aea&&(this.aea.dispose(),this.aea=null);this.uu&&(this.uu.dispose(),this.uu=null);this.zJ&&(this.zJ.dispose(),
this.zJ=null);this.E1&&(this.E1.disable(),this.E1=null);this.hPe&&(this.hPe=null)}}Object(f.a)(Na,"PackageManager",null,[0,1]);class Wa{constructor(){this.W=null}wc(K){this.W=K||Ca.a.instance}dispose(){}}Object(f.a)(Wa,"TellMePackage",null,[0,1]);var Fb=d(1565),uc=d(1567),Sc=d(372),hd=d(1563),Gd=d(1441);class ke{constructor(K=null,pa=null,Ta=null,jb,bc=null){this.rKe=null;this.M8g=!1;this.kih=this.w4b=null;this.PNk=this.eFh=this.Vnk=this.lih=!1;this.Yyd=null;this.lok=null==pa?m.AFrameworkApplication.wKb:
pa;this.Mzk=null==Ta?m.AFrameworkApplication.v3:Ta;this.uOk=null==bc?m.AFrameworkApplication.Feb:bc;this.pyk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.gQk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.p_o(!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.YPk=!!m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.mad;this.ZPk=!hd.a.Ita()&&!!m.AFrameworkApplication.K&&
m.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");this.XPk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.rvk=!!m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.v0b;this.$Pk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.vNk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.xHk=this.opd||this.npd;this.vHk=!!m.AFrameworkApplication.K&&
m.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");this.wHk=this.q_f;this.dCk=!!m.AFrameworkApplication.K&&this.l0a&&m.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.Nwk=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.sxk=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;
this.Bwk=m.AFrameworkApplication.K?parseFloat(m.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.$Bk=!!m.AFrameworkApplication.K&&(m.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.FBk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",
!1);this.zCk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",!1);this.kAk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1)&&(this.tun||this.Knn);this.wac=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.dPk=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl",
"https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.vxk=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.wNk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.hOk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.LNk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||this.uS;this.oCk=!!m.AFrameworkApplication.K&&(m.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.BBk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);
this.TBk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===m.AFrameworkApplication.uiCulture;this.lCk=!!m.AFrameworkApplication.K&&(m.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.BCk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.Ynk=this.l0a&&
!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.Wxk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.nOk=!!m.AFrameworkApplication.K&&(m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==m.AFrameworkApplication.K.kb("Application"));
this.upk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.YRk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMePerformanceMarkerEnabled");this.mAk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.qAk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.rxk=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.nCk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.xsn;this.oAk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.pAk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.nAk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.yuk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.zuk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.xuk=!!m.AFrameworkApplication.K&&
m.AFrameworkApplication.B8h&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);this.aQk=this.s3i&&(this.eig||this.fig||this.igd||this.l0a&&hd.a.Vta()&&!!m.AFrameworkApplication.K&&(this.Rxc||this.B0b||this.C0b||this.D0b||this.E0b||m.AFrameworkApplication.K.$("ShowAnswerSearchResults")||m.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||m.AFrameworkApplication.K.$("ShowEntitySearchResults")||m.AFrameworkApplication.K.$("ShowWolframSearchResults")));
this.Tmk=!!m.AFrameworkApplication.K&&!m.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&m.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&m.AFrameworkApplication.i6a;this.Umk=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled");this.B6m(K||{});this.c8e="2918242107";this.b8e="1454393937";this.LGb={};this.zlb=[];this.NAl=[hd.a.lEe]}get application(){return this.w4b}get wKb(){return this.lok}get lMo(){return this.c8e}get kMo(){return this.b8e}get MDf(){return this.kih}get Foi(){return this.lih}get v3(){return this.Mzk}get Feb(){return this.uOk}get uKb(){return this.Vnk}get U_m(){return this.pyk}get oip(){return this.gQk}get s3i(){return!0}get dip(){return this.aQk}get s2o(){return this.eFh}p_o(K){this.eFh=
K}get l0a(){return this.YPk}get Crd(){return this.ZPk}get Ard(){return this.XPk}get Q6l(){return this.rvk}get bip(){return this.$Pk}get UDe(){return!1}get igd(){return this.xHk}get eig(){return this.vHk}get fig(){return this.wHk}get Pab(){return!1}get Dge(){return!1}get h1f(){return this.dCk}get Dze(){return this.PNk}get Rxc(){return!1}get Y3o(){return!1}get jyn(){return""}get PLf(){return 2}get qHm(){return 4}get rHm(){return 5}get iHi(){return""}get Grm(){return this.Nwk}get zHi(){return this.sxk}get kHi(){return 1E3}get jHi(){return 1E-6}get Cep(){return this.dPk}get vGg(){return!1}get gZj(){return!1}get fqn(){return this.TBk}get jge(){return!1}get kge(){return!1}get I_i(){return!1}get H_i(){return!1}get xsn(){return!1}get t3i(){return!1}get w3d(){return!1}get Jyb(){return!1}get B0b(){return!1}get C0b(){return!1}get D0b(){return!1}get E0b(){return!1}get opd(){return this.vNk}get Nxc(){return this.wNk}get npd(){return!1}get LIf(){return null}get cge(){return!1}get vze(){return this.LNk}get nDi(){return 0}get vlm(){return this.Bwk}get fIi(){return this.vxk}get srn(){return this.$Bk}get qXf(){return this.kAk}get uze(){return this.wac}get HAm(){return-3.9}get uS(){return this.hOk}get nad(){return this.oCk}get F_f(){return this.BBk}get A1f(){return this.lCk}get vmb(){return this.Ynk}get Cun(){return this.BCk}get KBa(){return this.Wxk}get aWj(){return this.nOk}get Ael(){return this.upk}get QFe(){return this.YRk}get lde(){return this.mAk}get rdn(){return this.qAk}get hw(){return this.rxk}get Ptb(){return this.nCk}get pdn(){return this.oAk}get qdn(){return this.pAk}get odn(){return this.nAk}get M2k(){return this.Tmk}get N2k(){return this.Umk}get Hka(){return this.yuk}get m1d(){return this.zuk}get Qhc(){return this.xuk}get tun(){return this.zCk}get Knn(){return this.FBk}get BTb(){return!!m.AFrameworkApplication.ua&&
m.AFrameworkApplication.ua.Ib.Hs}get Hs(){return!!m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.Hs}get Dmn(){return!!m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.Pxc}get DQn(){return Me.getImageClass("OfficeAssistant_32x32x32")}R6d(){return Promise.reject("GetFindMatchCount method is not overridden")}Wge(K){return Array.contains(appChrome.selectors.getVisibleControlIds(),K)}Tde(){return!1}get nfe(){return!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeModelRankerEnabled")}get $_j(){return m.AFrameworkApplication.K?
m.AFrameworkApplication.K.kb("TellMeServiceHelpClassifierModelName"):""}get q_f(){return!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("TellMeMultiLingualCommandModelEnabled")}get pRb(){return"NoOpHeaderUi"}get GAl(){return this.Yyd}get parameterData(){return this.LGb}get Zpp(){return this.zlb}k2l(){if(this.rKe&&!this.M8g&&(this.M8g=!0,this.Byb(this.rKe),this.Hs)){var K=Ca.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");K=(new Gd.a(K)).a5d(this.rKe.eJ);appChrome.api.dispatch(K)}}Byb(){}PSl(K){const pa=
[];for(let Ta=0;Ta<K.length;++Ta)K[Ta].X4o?pa.push(new Sc.a(K[Ta].Hn,hd.a.q4j+Ta.toString())):pa.push(new Sc.a(K[Ta].standard,hd.a.lEe+Ta.toString()));return pa}B6m(K){const pa={};for(const Ta in K){const jb=Ta,bc=K[Ta];for(const Ic in bc){const Uc=Ic,kd=bc[Ic];(pa[Uc]||(pa[Uc]={}))[jb]=kd}}this.Yyd=pa}get a0j(){return""}get OUj(){return!1}}Object(f.a)(ke,"TellMeApplicationData",null,[1570]);class Ye{constructor(K,pa=null,Ta=!1){this.standard=K;this.Hn=pa;this.X4o=Ta}}Object(f.a)(Ye,"TryQuerySet",
null,[]);class Nf{constructor(){this.uvh=this.vvh=null}get wNn(){return this.uvh}pka(K){this.vvh=K;return this.euf(K)}SRn(){this.uvh=this.vvh}G7d(K){return 8===K.type?String.format(CommonUIStrings.l_FindInDocumentText,K.DE):K.DE}kIf(K){return K.DE}}Object(f.a)(Nf,"ParameterizedCommand",null,[]);class Bi extends Nf{constructor(K){super();this.Y$c=K}get commandId(){return this.Y$c?"DefinitionsParameterized":"DefinitionButton"}get Mjg(){return"Definition"}euf(K){const pa=Ia.a.Hf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
K.DE));return Pd.a(hd.a.Uuf(K.value),v.a.uwf.toString(),pa,hd.a.xWf,null,Ia.a.Hf(hd.a.JMb(K.DE)),pa,null,null)}G7d(K){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,K.DE)}kIf(K){return hd.a.JMb(K.DE)}}Object(f.a)(Bi,"DefinitionsParameterizedCommand",Nf,[]);class Sk extends Nf{constructor(K){super();this.Y$c=K}get commandId(){return this.Y$c?m.AFrameworkApplication.ua.Ib.Pin?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get Mjg(){return"Find"}euf(K){const pa=
Ia.a.Hf(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,K.DE));return Pd.a(hd.a.Uuf(K.value),v.a.Hic.toString(),pa,"Find_16x16x32",null,Ia.a.Hf(K.DE),pa,null,null)}G7d(K){return String.format(CommonUIStrings.l_TextWithQuotation,K.DE)}}Object(f.a)(Sk,"FindParameterizedCommand",Nf,[]);class Ff extends Nf{constructor(K){super();this.Y$c=K}get commandId(){return this.Y$c?"SynonymsParameterized":"SynonymButton"}get Mjg(){return"Synonym"}euf(K){const pa=Ia.a.Hf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,
K.DE));return Pd.a(hd.a.Uuf(K.value),v.a.uwf.toString(),pa,hd.a.xWf,null,Ia.a.Hf(hd.a.JMb(K.DE)),pa,null,null)}G7d(K){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,K.DE)}kIf(K){return hd.a.JMb(K.DE)}}Object(f.a)(Ff,"SynonymsParameterizedCommand",Nf,[]);var Th=d(2193),Tk=d(2084),Nk=d(2231),Of=d(2181),bf=d(2182),Cf=d(1660);class Pg extends Th.a{constructor(){super(...arguments);this.rT=null;this.r5a=Tk.FindManager.createInstance(this,Nk.a.instance,Cf.a.instance,
!0,!0)}static get instance(){return Pg._instance}Fic(){this.rT(this.r5a.zk.doa);this.r5a.F6a(!0)}R6d(K){const pa=new Promise((Ta,jb)=>{this.rT=Ta;setTimeout(()=>{jb("Find manager execution timed out");this.r5a.F6a(!0)},500)});K=Of.a.createQuery(K,bf.a.none);this.r5a.find(K);return pa}}Pg._instance=new Pg;Object(f.a)(Pg,"TellMeFindStatusSpy",Th.a,[]);class Ug extends ke{constructor(K){super({});this.w4b="Word";this.$wk=K;m.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.lih=!0,this.kih=
this.w3d?"FindWithMatchesParameterized":"FindParameterized");K=new Bi(this.BTb);const pa=new Ff(this.BTb);this.parameterData[K.commandId]=K;this.parameterData[pa.commandId]=pa;K=new Sk(this.BTb);this.parameterData[K.commandId]=K;m.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&(K=[new Ye(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new Ye(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new Ye(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new Ye(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,
"",!1),new Ye(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.zlb=this.PSl(K))}R6d(K){return Pg.instance.R6d(K)}get Gdb(){return rq.a.tva}get pRb(){return rq.a.IWa}Byb(K){var pa=m.AFrameworkApplication.K;K=K.eJ;K.WordCountFlyout=!this.$wk();K.SelectAllButton=!pa.$("TellMeSelectAllResultIsEnabled");const Ta=pa.$("TellMeDesktopUpSellIsEnabled");let jb=m.AFrameworkApplication.Ege;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!jb));jb=!1;K.TextBoxUpSellButton=
!Ta||jb;K.TableOfContentsUpSellButton=!Ta||jb;K.SmartArtUpSellButton=!Ta||jb;K.WordArtUpSellButton=!Ta||jb;K.MultiColumnLayoutUpSellButton=!Ta||jb;K.InsertEquationUpSellButton=!Ta||jb;K.TrackChangesUpSellButton=!Ta||jb;K.ShapesUpSellButton=!Ta||jb;K.LabelsUpSellButton=!Ta||jb;K.InsertCitationUpSellButton=!Ta||jb;K.TextBoxUpSellButtonEnterprise=!Ta||!jb;K.TableOfContentsUpSellButtonEnterprise=!Ta||!jb;K.SmartArtUpSellButtonEnterprise=!Ta||!jb;K.WordArtUpSellButtonEnterprise=!Ta||!jb;K.MultiColumnLayoutUpSellButtonEnterprise=
!Ta||!jb;K.InsertEquationUpSellButtonEnterprise=!Ta||!jb;K.TrackChangesUpSellButtonEnterprise=!Ta||!jb;K.ShapesUpSellButtonEnterprise=!Ta||!jb;K.LabelsUpSellButtonEnterprise=!Ta||!jb;K.InsertCitationUpSellButtonEnterprise=!Ta||!jb;pa=!pa.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!m.AFrameworkApplication.v3;K.SynonymButton=pa;K.DefinitionButton=pa}get a0j(){return m.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName","")}get vGg(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",
!1)}get $_j(){return m.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get Rxc(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get q_f(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",!1)}get PLf(){return m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get OUj(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",
!1)}get Dge(){return m.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get nfe(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",!1)}get jge(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get kge(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",
!1)}get kHi(){return m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get jHi(){return 1E-6*m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",1)}get I_i(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get H_i(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",
!1)}get iHi(){return m.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get t3i(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get nDi(){return m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get s3i(){return m.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get UDe(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",
!1)}get Pab(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get Dze(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",!1)}get gZj(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get cge(){return m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",
!1)}get B0b(){return m.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get C0b(){return m.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get D0b(){return m.AFrameworkApplication.K.$("ShowEntitySearchResults")}get E0b(){return m.AFrameworkApplication.K.$("ShowWolframSearchResults")}get LIf(){return m.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(f.a)(Ug,"WordEditorTellMeApplicationData",ke,[]);var Gk=d(1611),$i;
(function(K){K[K.none=0]="none";K[K.IOg=1]="waitAll";K[K.Gmq=2]="synchronizeFast";K[K.Pfp=3]="synchronizeSlow"})($i||($i={}));Object(f.b)("ProviderSynchronizationType",$i);var ol;(function(K){K[K.immediate=0]="immediate";K[K.IOg=1]="waitAll";K[K.Emq=2]="synchronizeAndWaitAll";K[K.Fmq=3]="synchronizeAndWaitForRanker"})(ol||(ol={}));Object(f.b)("MenuUpdatePolicy",ol);var wm=d(1571),Ll=d(1569),Ir=d(1717),$t=d(1572),wu=d(1601),Bv=d(129),xu=d(309);class Op extends Th.a{constructor(K){super();this.VSk=
K}Fic(){this.VSk.update()}}Object(f.a)(Op,"TellMeFindStatusManager",Th.a,[]);class rr{constructor(K){this.vlb=this.iah=null;this.ji=0;this.hEd="TellMeWAC.";const pa=K.MDf;this.kc=K;this.ABd=pa;this.J_e=Object.assign(new Gk.a,{landingTab:"Indoc",data:null});K=new Op(this);this.r5a=Tk.FindManager.createInstance(K,Nk.a.instance,Cf.a.instance,!0,!0)}sN(){return"WordFindInDocument"}kX(){return this.kc.PLf?this.kc.PLf===ol.IOg?$i.IOg:$i.Pfp:$i.none}hK(K,pa){this.Ktn(K)?(this.vlb=K,this.iah=pa,K=Of.a.createQuery(K.Yg,
bf.a.none),this.ji=window.performance.now(),this.r5a.find(K)):pa.Ot(new wm.a(K))}update(){this.kPo(Math.round(window.performance.now()-this.ji));var K=String.format(CommonUIStrings.l_TextWithQuotation,this.vlb.Yg);var pa=m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.Jyb?hd.a.OUa(this.vlb.Yg,15,this.J_e):Ia.a.Hf(this.vlb.Yg);const Ta=[];Ta.push(appChrome.actions.setControlLabel(this.ABd,K));Ta.push(appChrome.actions.setCompoundButtonCommandValueId(this.ABd,pa));Ta.push(appChrome.actions.updateCompoundButtonDescription(this.ABd,
this.tPf()));appChrome.api.dispatch(Ta);K=new Ll.a(this.ABd,Ir.a.VHe,this.vlb.Yg,this.r5a.zk.doa.toString());pa=new $t.a(wu.a.VHe);pa.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;pa.hy(K);const jb=new wm.a(this.vlb);jb.aw(pa);window.requestAnimationFrame(()=>{this.iah.Ot(jb)});this.r5a.F6a(!0);this.lPo(Math.round(window.performance.now()-this.ji))}tPf(){const K=this.r5a.zk.doa.toString();return"1"===K?String.format(CommonUIStrings.l_SearchResultText,K):String.format(CommonUIStrings.l_SearchResultsText,
K)}Ktn(K){return!!K&&!!K.Yg&&""!==K.Yg.trim()}kPo(K){const pa={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.vlb.Yg.length};this.sendActivityEvent(pa,K)}lPo(K){const pa={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.vlb.Yg.length};this.sendActivityEvent(pa,K)}sendActivityEvent(K,pa){K=
Bv.a.fI(K);Fg.a.jOa(Object.assign(new xu.a,{name:"Latency",dataFields:K,durationMs:pa}),this.hEd)}}Object(f.a)(rr,"WordFindInDocumentWithMatchesProvider",null,[1003]);class Jr{constructor(K,pa){this.Sb=K;this.Gce=pa}F$a(K,pa,Ta){return this.Gce.F$a(0,K,pa,Ta)}insertHtmlText(K){return K?32===this.XVf(K):!1}XVf(K){return this.executeCommand(ea.a.Yqa,K)}executeCommand(K,pa){const Ta=new Zp.DictionaryPropertySet;Ta.setValue(Bm.a.mS,pa);Ta.setValue(Bm.a.zna,!1);pa=this.Sb.Ob(K,1);32===pa&&(pa=this.Sb.Pb(K,
2,Ta));return pa}}Object(f.a)(Jr,"WordInsertContentHandler",null,[1002]);class sp extends Wa{constructor(){super();this.pz=()=>{if(m.AFrameworkApplication.fIg){var K=Od.StaticActiveAppFrame.za().Ib.gOf(v.a.su);K.k9c?this.Htj():K.w2(this.RLo);var pa=new Ug(()=>!1);Fb.TellMeActor.instance.initialize(pa,null,null,null,null,null,Object(O.a)(Od.StaticActiveAppFrame.za(),Od.StaticActiveAppFrame.za().I4d,"forceUpdateRibbonControls"),m.AFrameworkApplication.K,this.W.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.W.Qa("Common.IActionContextProvider"),this.W.Qa("Common.ISystemInitiatedFeedback"));Fb.TellMeActor.instance.hso(K);Fb.TellMeActor.instance.suo(new Jr(m.AFrameworkApplication.va,this.W.Oa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));pa.Foi&&pa.w3d&&Fb.TellMeActor.instance.DG(new rr(pa),uc.a.su)}};this.RLo=()=>{this.Htj()}}get name(){return"WordEditor.TellMe"}init(){m.AFrameworkApplication.K.Rn(this.pz)}Htj(){Od.StaticActiveAppFrame.za().Ie()}}Object(f.a)(sp,"WordEditorTellMePackage",
Wa,[]);class Ws{constructor(){this.W=null;this.c0j=(K,pa,Ta)=>{2===Ta&&(K=new hg.StandardDialog,K.Gd=0,K.Nna(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo()})}dispose(){}Mo(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(122)){m.AFrameworkApplication.va.fb(rf.a.xck,Ad.a.view,this.c0j,96);
var K=Gg.FocusManager.instance().ge(rq.a.zF);ug.AFrame.gj(K,Sf.KeyInputManager.lc(mj.a.ogb,5|Sf.KeyInputManager.li),rf.a.xck)}}wc(K){this.W=K}static main(){H.a.instance.Jc(new Ws)}}Object(f.a)(Ws,"WordEditorTestFeaturePackage",null,[0,1]);var yw=d(1535),Kr=d(117);class Et{constructor(K,pa){this.BIj=K;this.Sb=pa;this.Zwe=(Ta,jb,bc,Ic,Uc)=>{if(1===bc)return 32;this.BIj.nC(9,Uc,!1);return 32};this.iS=(Ta,jb)=>{if(9===jb.type){var bc;(Ta=jb.nA)?("string"===typeof Ta?bc=Ta:"data"===Ta.type&&(bc=Kr.a.jbi(Ta.hfo,
Ta.newState,Ta.t_o)),bc&&Et.DSc(bc)):ua.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.gkd()}gkd(){this.Sb.ra(rf.a.Zwe,y.a.frame,this.Zwe);this.BIj.JO(this.iS)}dispose(){}static DSc(K){K=Od.StaticActiveAppFrame.za().nK.nka(K,!1);K.image=5;K.Cla="CoAuth_AuthorStatus_16x16x32";Od.StaticActiveAppFrame.za().nK.Uy(K)}}Object(f.a)(Et,"TrackChangeNotificationActor",null,[]);class rx{constructor(){this.Yh=this.Dbf=this.W=null;this.Xfd=()=>{if(this.Yh=yw.a.f5c().result)this.W.ia("WordEditor.TrackChange.TrackChangeNotificationActor",
()=>new Et(this.Yh,m.AFrameworkApplication.va)).ha(),this.Dbf=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}wc(K){this.W=K}init(){this.W.resolve("Box4.IFeatureHelper").Ds.continueWith(()=>{this.Mo()})}Mo(){yw.a.f5c().continueWith(this.Xfd)}dispose(){this.Dbf&&this.Dbf.dispose()}}Object(f.a)(rx,"WordEditorTrackChangeNotificationActorPackageManager",null,[0,1]);var nt=d(110),zw=d(1545),yi=d(2175);class Vm{}Vm.zLg="UnsavedChanges";
Vm.ALg="UnsavedChangesThemed";Vm.eLo="SavedChanges";Vm.B5j="UnsavedChangesOpenPipe";Vm.atp="UnsavedChangesOpenPipeCssClassNameThemed";Vm.A5j="UnsavedChangesClosePipe";Vm.Ysp="UnsavedChangesClosePipeThemed";Vm.Zsp="UnsavedChanges";Vm.$sp="UnsavedChangesThemed";Vm.BLg="UnsavedChangesIndicatorPositionRef";Object(f.a)(Vm,"UnsavedChangesHighlightUtils",null,[]);class Xk extends zw.a{constructor(K,pa){super();this.Gia=K;this.My=pa;this.P5=[this.My?new yi.a(Vm.ALg,Vm.$sp):new yi.a(Vm.zLg,Vm.Zsp)]}get Ufa(){return!0}get Yrb(){return 4}get k$a(){return this.P5}bNa(K,
pa){if(this.Gia){var Ta=this.Gia.B9f;if(Ta&&Ta.count&&Ta.contains(K.id))for(K=pa.BNa("span"),pa=0;pa<K.length;pa++)Ta=K[pa],pa||Ta.classList.add(this.My?Vm.atp:Vm.B5j),pa===K.length-1&&Ta.classList.add(this.My?Vm.Ysp:Vm.A5j),Ta.classList.add(this.My?Vm.ALg:Vm.zLg)}}E9a(){}}Object(f.a)(Xk,"UnsavedChangesHighlightActor",zw.a,[]);var Ds=d(1131);class Cv{constructor(K){this.jPe=null;this.Gia=K;this.NXe=!1}get key(){return"UnsavedChangesHighlight"}get Av(){return"UnsavedChanges"}reset(K){if(this.Gia){K=
K.node;if(ld.ParagraphReader.Xb(K)){const pa=this.Gia.B9f;if(pa&&pa.contains(K.id)){this.NXe=!0;this.jPe=K.id;return}}this.NXe=!1;this.jPe=wi.a.nil}}$Ea(){let K=null;return this.NXe?(K=Object.assign(new Ds.a,{UF:this.key,contentObject:this.jPe,description:null}),{returnValue:!0,zG:K}):{returnValue:!1,zG:K}}}Object(f.a)(Cv,"UnsavedChangesHighlightCpContentDetailsProvider",null,[405,406]);class Jq{constructor(K,pa,Ta,jb,bc,Ic,Uc){this.svh=null;this.K9=K;this.tf=pa;this.JZ=Ta;this.m$=jb;this.BIh=bc;
this.iqa=Ic;this.My=Uc;this.tf.hza(this.$U.bind(this))}get B9f(){return this.svh}M0m(){if(this.K9){if(1===this.K9.nqf){if(0===this.K9.i3f&&this.K9.ypj()){this.svh=this.K9.yke;const K=this.K9.ktd;this.K9.fLo.forEach(this.QTl.bind(this));K.forEach(this.N0m.bind(this));0<K.length&&this.EVl(this.JZ);return 0}return this.doo(this.K9.i3f)}return 2}return 1}doo(K){switch(K){case 0:return this.K9.mOi()?5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}kPi(K,pa,Ta){if(pa)if(Ta){Ta=pa.querySelectorAll("span");
for(let jb=0;jb<Ta.length;jb++){const bc=Ta[jb];jb||bc.classList.add(Vm.B5j);jb===Ta.length-1&&bc.classList.add(Vm.A5j);bc.classList.add(this.My?Vm.ALg:Vm.zLg)}pa.classList.add(Vm.BLg);K&&this.m$.YAc(K)}else pa.classList.add(Vm.eLo)}imc(K,pa){const Ta=this.HOm(K);if(K&&(K=K.ue(Od.StaticActiveAppFrame.za().ib.sc.oc)))if(K.$f&&K.$f.mj&&0!==K.$f.mj.count)for(const jb of K.$f.mj)this.kPi(Ta,jb,pa);else this.kPi(Ta,K.htmlElement,pa)}HOm(K){return this.BIh&&(K=this.BIh.OQb(K))&&K&&(K=K.ue(Od.StaticActiveAppFrame.za().ib.sc.oc))?
K:null}N0m(K){this.imc(K,!0);return!0}QTl(K){this.imc(K,!1);return!0}EVl(K){K&&K.continueWith(()=>{K.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}$U(K,pa){pa===Sys.EventArgs.Empty?ua.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):pa&&pa.errorCode?this.iqa.JU||(K=this.M0m(),ua.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",K),sa.Health.instance.recordKpiUsage("UnsavedChangesHighlight",
0,"wwrelfc",null),0!==K&&4!==K&&this.vmp(K)):ua.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",pa?"Error Code":"Kickout Event Args")}vmp(K){let pa;const Ta=new Ai.a;Ta.extendedProperties=new Map;Ta.extendedProperties.set("HighlightUnsavedChangesResult",K.toString());Ta.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(K){case 1:case 2:case 6:pa="HighlightInternalError";break;case 5:pa="ChangeOutsideCanvas"}6!==K&&5!==K||Ta.extendedProperties.set("UnsavedChangesCollectionResult",
this.K9.i3f.toString());pa&&(sa.Health.instance.recordQosError(pa,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,Ta),sa.Health.instance.recordKpiFailure("UnsavedChangesHighlight",pa,!0,!0,Ta))}dispose(){this.tf.uZb(this.$U.bind(this))}}Object(f.a)(Jq,"UnsavedChangesHighlighter",null,[13]);var Es=d(929),yu=d(753),Hn=d(1543);class Xs extends Hn.a{constructor(K,pa){super();this.Gia=K;this.My=pa}qeb(K){if(!this.Gia)return!1;const pa=this.Gia.B9f;return pa?pa.contains(K.Cb.id)||K.htmlElement.querySelector(".UnsavedChanges")?
!0:!1:!1}yjl(K,pa){pa=K.aCa?K.aCa[pa]?K.aCa[pa].style?K.aCa[pa].style.marginLeft:null:null:null;var Ta=K.Mba;K=1440<=Ta?-(Ta/1440*96):K.D6a(0,96,this.zoom);Ta=0;pa&&(pa=pa.match(/^(\d+)px/))&&pa[1]&&(Ta=Number(pa[1]));return K-Ta}gkl(K,pa,Ta){return Sys.UI.DomElement.getBounds(K).y-Ta.E7[pa].y}ojl(K){return Sys.UI.DomElement.getBounds(K).height}Bai(K,pa,Ta,jb){let bc;bc=this.yjl(Ta,pa);pa=this.gkl(K,pa,Ta);K=this.ojl(K);jb=Es.a.createElement(jb,yu.a.div);jb.className=this.My?"UnsavedChangesIndicatorThemed":
"UnsavedChangesIndicator";jb.style.left=bc+"px";jb.style.top=pa+"px";jb.style.height=K+"px";return jb}Q$h(K,pa,Ta,jb){const bc=[],Ic=K.querySelectorAll("."+Vm.BLg);if(0===Ic.length&&K.classList.contains(Vm.BLg))Ta=this.Bai(K,pa,Ta,jb),Ta.fka=pa,bc.push(Ta);else for(K=0;K<Ic.length;K++){const Uc=this.Bai(Ic[K],pa,Ta,jb);Uc.fka=pa;bc.push(Uc)}return bc}t7a(K){let pa=[];var Ta=K.s8;const jb=Ta.uh.ownerDocument;if(Ta.Kj){let bc=0;for(const Ic of Ta.$f.mj)(Ta=this.Q$h(Ic,bc,K,jb))&&(pa=pa.concat(Ta)),
bc+=1}else pa=this.Q$h(Ta.htmlElement,0,K,jb);return pa}}Object(f.a)(Xs,"UnsavedChangesIndicatorActor",Hn.a,[]);class Pn{constructor(){this.mZ=this.Ly=this.vRa=this.m$=this.TDd=this.Gia=null}get name(){return"WordEditor.UnsavedChangesHighlight"}wc(){}init(){this.m$=Ca.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;this.Gia=new Jq(Ca.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),tg.SessionStatusManager.instance,Rd.a.$p(Ca.a.instance.Qa("Common.ISystemInitiatedFeedbackWithTimeLapse")),
this.m$,Ca.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),Ca.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!ej.App.instance&&ej.App.instance.Qta);this.vRa=Ca.a.instance.Qa("Box4.Accessibility.IAccessibilityContextManager");this.mZ=Ca.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;this.TDd=new Xs(this.Gia,!!ej.App.instance&&ej.App.instance.Qta);this.m$.QZa(this.TDd);this.vRa&&this.vRa.execute(K=>{K.kY(new Cv(this.Gia))});this.Ly=
new Xk(this.Gia,!!ej.App.instance&&ej.App.instance.Qta);this.mZ.idb(this.Ly)}dispose(){this.m$&&this.TDd&&this.m$.NEe(this.TDd);this.mZ&&this.Ly&&this.mZ.qLg(this.Ly);nt.a.JD(this.Gia)}static main(){H.a.instance.Jc(new Pn)}}Object(f.a)(Pn,"WordEditorUnsavedChangesHighlightPackage",null,[0,1,13]);var Oo=d(127);class am{constructor(K,pa,Ta){this.ga=K;this.eo=pa;this.Ga=Ta}Wb(){this.Ga.$("ZoomPopupDialogIsEnabled")&&(this.ga.ra(v.a.nyc,y.a.frame,Object(O.a)(this.eo,this.eo.nyc,"showZoomDialog")),this.ga.fb(v.a.klo,
y.a.frame,Object(O.a)(this.eo,this.eo.lnj,"onQueryZoomText"),96),this.ga.ra(v.a.evd,y.a.frame,Object(O.a)(this.eo,this.eo.Sck,"zoomDialogTabFocusHandler")),this.ga.ra(v.a.dvd,y.a.frame,Object(O.a)(this.eo,this.eo.Sck,"zoomDialogTabFocusHandler")));this.Ga.$("ZoomSliderIsEnabled")&&(this.ga.fb(v.a.Exj,y.a.frame,Object(O.a)(this.eo,this.eo.S0n,"onQueryZoomPercentage"),96),this.ga.fb(v.a.Uck,y.a.frame,Object(O.a)(this.eo,this.eo.A4n,"onZoomToPercentage"),96),this.ga.ra(v.a.pKp,y.a.frame,Oo.ActionManager.Zf))}}
Object(f.a)(am,"CommonZoomActor",null,[1519]);class sq extends am{constructor(K,pa,Ta){super(K,pa,Ta);this.vja=pa}Wb(){super.Wb();this.Ga.$("ZoomPopupDialogIsEnabled")&&(this.ga.ra(rf.a.NPg,y.a.frame,Oo.ActionManager.Zf),this.ga.ra(rf.a.tHe,y.a.frame,Object(O.a)(this.vja,this.vja.oKp,"zoomTo100")));this.ga.ra(rf.a.s3b,y.a.frame,Object(O.a)(this.vja,this.vja.s3b,"zoomToPageWidth"));this.ga.ra(v.a.osb,y.a.frame,Object(O.a)(this.vja,this.vja.osb,"increaseZoom"));this.ga.ra(v.a.rob,y.a.frame,Object(O.a)(this.vja,
this.vja.rob,"decreaseZoom"));this.ga.ra(rf.a.Hxg,y.a.frame,Object(O.a)(this.vja,this.vja.d_o,"setZoomLevelFromRibbon"));this.ga.fb(rf.a.Rwb,y.a.frame,Object(O.a)(this.vja,this.vja.lnj,"onQueryZoomText"),96);this.ga.fb(rf.a.ate,Ad.a.application,Object(O.a)(this.vja,this.vja.R0n,"onQueryZoomLevelLabelText"),96);this.ga.ra(ea.a.jci,y.a.frame,Oo.ActionManager.Zf);this.ga.ra(ea.a.ici,y.a.frame,Oo.ActionManager.Zf);this.ga.ra(ea.a.nci,y.a.frame,Oo.ActionManager.Zf);this.ga.ra(ea.a.kci,y.a.frame,Oo.ActionManager.Zf);
this.ga.ra(rf.a.noa,y.a.frame,Oo.ActionManager.Zf)}}Object(f.a)(sq,"WordEditorZoomActor",am,[]);class au{constructor(K,pa){this.zoom=K;this.K4k=pa}}Object(f.a)(au,"SetCustomZoomArgs",null,[]);var Pp=d(1239);class sr{constructor(K,pa){this.WNl=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.XNl=[sr.Cxf,sr.M_d,"200","150","100","75","50"];this.Sra=3;this.uQ=0;this.delta=.1;this.a4f=0;this.ed=new V.a;this.zi=null;this.K=K;this.Sb=pa;this.SQj(1)}get Aj(){return this.uQ}SQj(K){this.uQ=
K}get pYc(){return Math.round(100*this.Aj)}get qQn(){return Math.floor(this.pYc/10)/10+this.delta}get pQn(){return Math.ceil(this.pYc/10)/10-this.delta}get ga(){return m.AFrameworkApplication.va}y2k(K){this.ed.addHandler("ZoomChanged",K)}rBo(K){this.ed.removeHandler("ZoomChanged",K)}Q0(K){this.y2k(K)}YZa(K){this.rBo(K)}bBj(){}SCj(){}aBj(){}RCj(){}fvd(K){this.Tck(K,this.Aj)}Tck(K,pa){null!==K&&qr.a.BPj(K,pa)}sBg(K,pa=!0){let Ta=K*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(Ta=new au(K,
pa));this.wNj(Ta)}c_o(K,pa=!1){this.noa(K,3|(pa?0:4))}y4n(K,pa,Ta){if(1===K)return 32;K=Ta/100;K<this.Kdd?K=this.Kdd:K>this.kdd&&(K=this.kdd);this.noa(K,1);pa&&(pa.Gt=Math.floor(100*K));return 32}lnj(K,pa,Ta,jb,bc){if(1===Ta)return 32;K=Ia.a.xKa(this.pYc,6,m.AFrameworkApplication.numberFormat);bc.Value=K;bc.LabelText=K;return 32}A4n(K,pa,Ta,jb,bc){return 1===Ta?32:this.y4n(Ta,jb,bc.value)}S0n(K,pa,Ta,jb,bc){bc.MinValue=100*this.Kdd;bc.MaxValue=100*this.kdd;bc.value=this.pYc;return 32}PKi(){return this.WNl}QKi(){return this.XNl}Com(){let K=
Math.floor(100*this.Aj).toString();1===this.Sra?K=sr.Cxf:2===this.Sra&&(K=sr.M_d);return K}osb(K,pa,Ta){if(1===Ta)return 32;this.xcd(this.Sb?this.Sb.iE:0,"IncreaseZoom");this.Sra=0;this.noa(this.qQn);return 32}rob(K,pa,Ta){if(1===Ta)return 32;this.xcd(this.Sb?this.Sb.iE:0,"DecreaseZoom");this.Sra=0;this.noa(this.pQn);return 32}d_o(K,pa,Ta,jb,bc){if(1===Ta)return 32;this.xcd(this.Sb?this.Sb.iE:0,"SetZoomLevelFromRibbon");K=bc.Value;if(K.toLowerCase().startsWith("fit"))return K=new kb.a(0,1,0,()=>{this.s3b(0,
null,2,null,null)},138,void 0,!0),ze.a.instance.Zb(K),32;K=parseInt(K)/100;if(isNaN(K))return 2;this.Sra=0;this.noa(K);return 32}xcd(K,pa){ua.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",K,pa,m.AFrameworkApplication.ua.Ib.Hs)}nyc(K,pa,Ta){if(1===Ta)return 32;ua.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const K=this.Com();this.zi=new Pp.a(this.PKi(),this.QKi(),Object(O.a)(this,
this.RXm,"handleZoomDialogResult"),Gg.FocusManager.instance(),!0);this.zi.nyc(CommonUIStrings.l_ZoomDialogTitle,K)}ihn(K){return K.toLowerCase()===sr.Cxf.toLowerCase()}jhn(K){return K.toLowerCase()===sr.M_d.toLowerCase()}RXm(K){if(K){if(this.ihn(K)){this.Sra=1;var pa=32}else if(this.jhn(K))this.Sra=2,pa=this.s3b(0,null,2,null,null);else if(pa=Number.parseInvariant(K)){this.Sra=0;let Ta=pa;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(Ta=new au(pa,!0));pa=this.wNj(Ta)}else pa=8;32===pa?
ua.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:K}):ua.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:K})}else ua.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:K})}cno(){this.ed.raiseEvent("ZoomChanged",null)}fyj(){}Upg(){}Sck(K){if(!this.zi)return 2;var pa=this.zi.focusManager.gu().Mk.Ora;if(pa===this.zi.qB&&K===v.a.evd||pa===this.zi.oJ&&K===v.a.dvd)this.zi.PJb||this.zi.WMo(),this.zi.focusManager.gu().Mk.mA(this.zi.PJb);
else if(pa.id.startsWith(this.zi.wjd)||pa.className.startsWith(this.zi.Mxj))pa=null,K===v.a.evd?pa=this.zi.oJ:K===v.a.dvd&&(pa=this.zi.qB),this.zi.focusManager.gu().Mk.mA(pa),Sys.UI.DomElement.removeCssClass(this.zi.PJb.parentNode,this.zi.Dpg);else if(K===v.a.evd)this.zi.focusManager.gu().Mrc();else if(K===v.a.dvd)this.zi.focusManager.gu().Krc();else return 2;return 32}}sr.Cxf="FullPage";sr.M_d="PageWidth";Object(f.a)(sr,"ZoomManager",null,[17]);var Nm;(function(K){K[K.ucj=0]="manual";K[K.e0p=1]=
"fitToFullPage";K[K.Cpi=2]="fitWidth";K[K.neg=3]="onBoot"})(Nm||(Nm={}));Object(f.b)("ZoomStatus",Nm);d(1156);var Lr;(function(K){K[K.normal=0]="normal";K[K.Alo=1]="quiet";K[K.Fgi=2]="disableScrollUpdate";K[K.qUl=4]="disableUiControlUpdate"})(Lr||(Lr={}));Object(f.b)("ZoomUpdateFlags",Lr);var Dv=d(267),lp=d(355),Aw=d(1295);class Df extends sr{constructor(K,pa,Ta,jb,bc,Ic,Uc){super(K,pa);this.BGp=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.CGp=[sr.M_d,"200","150","125",
"100","75","50"];this.vcf=this.HGj=!1;this.Y9g="AutoFitForAdaptiveLayout";this.Nvk="FitPageWidthFailure";this.NRk="UpdateZoomFailure";this.gTk="wwf";this.Ldf=null;this.aAj=()=>{this.Sra===Nm.Cpi&&this.uEf()};this.YLl=kd=>{if(kd.ctrlKey){m.AFrameworkApplication.va.Ob(ea.a.kci,2);kd=kd.xFp;if(!kd)return!1;this.noa(this.Aj-(0<kd?.1:-.1));this.xcd(6,"CtrlScroll");return!0}return!1};this.z4n=()=>{ua.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.XZ=
Ta;this.Wl=jb;this.Yb=bc;this.Pg=Ic;this.fIc=Uc;this.urh=K.$("KeepViewAfterZoomIsEnabled");this.hTk=K.$("ZoomShortCutIsEnabled");this.bSk=K.$("DoNotAutoScrollAfterPinchIsEnabled");this.xAk=(this.OWe=K.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&K.$("AutoFitForSmallScreenModeIsEnabled");this.Rtk=K.$("DoNotProcessUpdateZoomActionIsEnabled");this.iTk=K.$("ZoomSliderIsEnabled");this.eB()}get appName(){return"WordEditor"}get kdd(){return 4}get Kdd(){return.1}get ZLl(){return wacBoot.CtrlWheelMetrics}Y1k(K){this.ed.addHandler("PinchStart",
K)}hBo(K){this.ed.removeHandler("PinchStart",K)}X1k(K){this.ed.addHandler("PinchEnd",K)}gBo(K){this.ed.removeHandler("PinchEnd",K)}get tH(){return null!=this.z4g?this.z4g:this.z4g=Ca.a.instance.Oa("WordEditor.IStatusBarUser")}N9j(K){K=!(K&Lr.qUl);const pa=cb.a.get_instance().isCompleted(7);return K&&pa?(K={SelectZoomOption:"ComboBoxModel"},Od.StaticActiveAppFrame.za()&&Od.StaticActiveAppFrame.za().hJ(K),this.PAp(),!0):!1}noa(K,pa=Lr.normal){let Ta=!0;this.Rtk||m.AFrameworkApplication.va.Ob(rf.a.noa,
2);if(this.Aj===K)return this.vcf||(this.vcf=this.N9j(pa)),Ta;K>this.kdd?K=this.kdd:K<this.Kdd&&(K=this.Kdd);var jb=!!(pa&Lr.Alo);1===K||jb||m.AFrameworkApplication.va.Ob(rf.a.NPg,2);try{jb=null;Od.StaticActiveAppFrame.za()&&Object(Um.a)(Aw.MainView,Od.StaticActiveAppFrame.za().ib.sc)&&(jb=Od.StaticActiveAppFrame.za().ib.sc);let bc=-1,Ic=-1,Uc=-1;const kd=!(pa&Lr.Fgi);this.urh&&kd&&(bc=Zb.SelectionEditor.MQm(Hj.a.instance.gb.currentSelection,jb),Ic=jb.RN.scrollLeft,Uc=jb.RN.scrollTop);const pd=this.Aj;
this.SQj(K);this.cno();this.vcf=this.N9j(pa);kd&&this.qzp(jb,bc,Ic,Uc,pd)}catch(bc){Ta=!1,ua.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",bc)}return Ta}qzp(K,pa,Ta,jb,bc){K&&K.isActive?this.urh?0<=pa&&100>=pa?K.jr.V0(100-pa,!0,!0):K.jr.wvn(Ta,jb,bc,this.Aj):K.jr.V0():ua.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}oKp(K,pa,Ta){2===Ta&&(this.xcd(this.Sb?this.Sb.iE:0,"ZoomTo100"),this.Sra=Nm.ucj,this.noa(1));return 32}wNj(K){this.Sra=Nm.ucj;let pa,
Ta=!0;if(this.bSk){if(!Object(Um.a)(au,K))return ua.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;pa=K.zoom/100;Ta=K.K4k}else pa=Number.parseInvariant(String.format("{0}",K))/100;ua.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",pa);K=Lr.normal;Ta||(K=Lr.Fgi);this.noa(pa,K);return 32}s3b(K,pa,Ta){if(1===Ta)return 32;ua.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(Ce.a)("ZoomToPageWidth",!0);this.Sra=Nm.Cpi;
this.R1l();return this.uEf()}R0n(K,pa,Ta,jb,bc){if(1===Ta)return 32;K=Ia.a.xKa(this.pYc,6,m.AFrameworkApplication.numberFormat);bc[Dv.a.labelText]=K;return 32}PKi(){return this.BGp}QKi(){return this.CGp}R1l(){this.HGj||(Od.StaticActiveAppFrame.za()?(Od.StaticActiveAppFrame.za().z2(this.aAj),this.HGj=!0):ua.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}uEf(){var K=this.XZ.bKf();if(!K)return 8;for(var pa=0;K;)pa=Math.max(pa,zc.a.instance.ev(K)),
K=this.XZ.V3c(K);K=kc.a.qj(pa,0);(pa=this.fIc())&&pa.cze()&&(K+=wacBoot.ShiftUtils.getFloatingObjectsContainerWidth());K+=2*lp.a.qPg;K=Od.StaticActiveAppFrame.za().aG.offsetWidth/K;this.noa(K);return 32}PAp(){this.tH&&(this.iTk?(this.tH.nS(to.a.jKp),this.tH.nS(to.a.lKp)):this.tH.nS(to.a.mKp))}Ucp(K){K||(K=window.self.CtrlWheelMetrics);if(K){var pa=K.ctrlWheelOccurred;if("boolean"!==typeof pa)ua.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");else{ua.ULS.sendTraceTag(594346947,
353,50,"ctrlWheelOccurred: {0}",pa);try{K.stop()}catch(Ta){ua.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",Ta)}}}else ua.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}eB(){this.Ucp(this.ZLl);if(this.Wl){var K=document.getElementById(rq.a.v0d);K&&this.Wl.nb(P.a.Vub,K,this.YLl)}this.Yb&&(K=this.Yb.ge(rq.a.zF),this.hTk&&(K.bindAction(Sf.KeyInputManager.lc(mj.a.qBc,Sf.KeyInputManager.li),v.a.osb),K.bindAction(Sf.KeyInputManager.lc(mj.a.mud,Sf.KeyInputManager.li),v.a.osb),
K.bindAction(Sf.KeyInputManager.lc(mj.a.rBc,Sf.KeyInputManager.li),v.a.rob),K.bindAction(Sf.KeyInputManager.lc(mj.a.tBc,Sf.KeyInputManager.li),v.a.rob),K.bindAction(Sf.KeyInputManager.lc(mj.a.hwd,Sf.KeyInputManager.li),rf.a.tHe)));this.Pg&&(this.Ldf=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.Pg.nb(P.a.click,this.Ldf,this.z4n);this.xAk&&(Od.StaticActiveAppFrame.za().cL.registerLayoutBreakpointChanged("canvas",pa=>{this.mkf(pa)}),Od.StaticActiveAppFrame.za().cL.registerBoundingWindowRectsChanged("canvas",
()=>{this.mkf(Od.StaticActiveAppFrame.za().cL.getLayoutBreakpoint())}))}mkf(K){let pa=!0,Ta="";if(this.Sra!==Nm.neg)return pa;sa.Health.instance.recordKpiUsage(this.Y9g,0,this.gTk,null);switch(K){case "Small":8===this.uEf()&&(Ta=this.Nvk,pa=!1);break;default:1===this.Aj||this.noa(1)||(Ta=this.NRk,pa=!1)}pa||sa.Health.instance.recordKpiFailure(this.Y9g,Ta,!0,!0,null);return pa}bBj(K){this.Y1k(K)}SCj(K){this.hBo(K)}aBj(K){this.X1k(K)}RCj(K){this.gBo(K)}fyj(){this.ed.raiseEvent("PinchStart",null)}Upg(){this.ed.raiseEvent("PinchEnd",
null)}}Object(f.a)(Df,"WordEditorZoomManager",sr,[980,17]);class bm{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(m.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const K=this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),pa=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");K.Wb();Sys.UI.DomElement.overrideGetBounds=!0;m.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&m.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&
pa&&cb.a.get_instance().Lk(4,()=>{pa.mkf(Od.StaticActiveAppFrame.za().cL.getLayoutBreakpoint())||ua.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}wc(K){this.W=K;m.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&(this.W.ia("WordEditor.Zoom.WordEditorZoomManager",()=>new Df(m.AFrameworkApplication.K,m.AFrameworkApplication.va,Ep.WordSectionNavigator.instance,wn.a.instance,Gg.FocusManager.instance(),mf.a.instance,()=>K.Oa("Box4.IFloatingObjectUpdater"))).ha().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),
this.W.ia("WordEditor.Zoom.WordEditorZoomActor",()=>new sq(m.AFrameworkApplication.va,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),m.AFrameworkApplication.K)).ha())}static main(){H.a.instance.Jc(new bm)}}Object(f.a)(bm,"ZoomPackage",null,[0,1]);var Ev=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",
ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",
IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",
MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",
IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},
children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",
attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",
attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",
attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]},Gf;(function(K){K[K.fNp=0]="Healthy";K[K.qOp=1]="MissedScan";K[K.COp=2]="NeedsReset";K[K.MLp=3]="CriticalUnresponsive";K[K.RNp=4]="KickoutComponent"})(Gf||(Gf={}));Object(f.b)("TimerBasedWatchDogStatus",
Gf);class Cn{constructor(K,pa,Ta){this.TLd=this.Srh=this.Vsh=this.J5b=this.XGa=0;this.Kej=3;this.$Zd=3E4;this.kbc=K;this.cCb=pa;this.FLi=Ta}bEa(){this.XGa=0}async sNn(){const K=Date.now(),pa=this.kbc.pqc;this.TLd++;if(this.Srh==pa&&this.r4o(K,this.Vsh))return{["WatchDogScanTime"]:K,["LastComponentScanTime"]:pa,["ComponentStatus"]:Gf[this.J5b],["ActionTaken"]:"None. Skipping to Match Interval"};this.Srh=pa;this.Vsh=K;this.cCb=this.kbc.sci;this.J5b=this.Zvi(K,pa);3===this.J5b&&(await this.frp(),this.J5b=
this.Zvi(K,this.kbc.pqc));return this.c5k(this.J5b,K,pa)}eun(){return 0===this.J5b}Zvi(K,pa){let Ta=0;K>pa+Math.max(this.cCb,this.$Zd)+this.FLi&&(Ta=0===this.XGa?1:this.XGa<this.Kej?2:this.XGa===this.Kej?3:4);return Ta}c5k(K,pa,Ta){const jb={};jb.WatchDogScanNumber=this.TLd;jb.WatchDogScanTime=pa;jb.LastComponentScanTime=Ta;jb.ComponentStatus=Gf[K];jb.ExpectedComponentScanInterval=this.cCb;jb.GraceTimeInMS=this.FLi;jb.ActualTimeBetweenWatchDogAndComponentScans=pa-Ta;switch(K){case 0:jb.ActionTaken=
"None";this.XGa=0;break;case 1:this.XGa++;jb.ActionTaken="Missed Scan, Wait to Restart component";break;case 2:this.XGa++;jb.ActionTaken="Component restarted";ua.ULS.sendTraceTag(509686347,3037,20,"Restarting Component with interval {0}",this.cCb);this.kbc.jYj();this.kbc.qXj(Math.min(this.cCb,this.$Zd/2));break;case 3:this.XGa++;jb["ActionTaken?"]="Attempted Synchronous run: "+Gf[K];break;case 4:ua.ULS.sendTraceTag(512570578,3037,15,"Component is not Responding. WatchDog would kickout now"),jb["ActionTaken?"]=
"Kickout",jb.ShouldKickout=!0,this.XGa++}jb.NextExpectedComponentScanTimeInMs=Ta+(this.XGa+1)*this.cCb;jb.MissedScans=this.XGa;return jb}async frp(){return this.kbc.hri()}r4o(K,pa){return pa+this.cCb>K}}Object(f.a)(Cn,"TimerBasedWatchDog",null,[1745]);class tn{constructor(K,pa,Ta,jb,bc,Ic,Uc,kd){this.gZ=null;this.GNc=this.aja=0;this.iFb=new Date(Date.UTC(0,1,1,0,0));this.NK={};this.bPc=this.aPc=0;this.h2h=async()=>{var pd;ua.ULS.sendTraceTag(509372107,3038,50,"Running RunawayDataLossMonitor task. Run count: {0}",
this.aPc++);if(this.tf.Ko)this.Qld(),this.stop(),ua.ULS.sendTraceTag(522818053,3038,50,"The application kicked out. RSNManager was tracking {0} unsavedRevision(s) ",this.ay.F0a);else{this.iFb=new Date;var Fd={};Fd.DocxSaveMonitor_IsUpToDate=null===(pd=this.gZ)||void 0===pd?void 0:pd.JU;Fd.RSNManager_IsUpToDate=this.ay.JU;Fd.RSNManager_CountRevisionsWithOutServerRevisionSequenceNumbers=this.ay.Ofc();Fd.RSNManager_CountRevisionsWithServerRevisionSequenceNumbers=this.ay.uYd();ua.ULS.sendTraceTag(521413850,
3038,50,"Logging IsUpToDate state for RSNManager and DocxSaveMonitor : {0}",Fd);if(this.uk&&!this.uk.isVisible)ua.ULS.sendTraceTag(524154191,3038,50,"App is hidden. RSNManager is tracking {0} unsavedRevision(s)",this.ay.F0a),this.heo();else if(pd=this.ay.pXc(this.QLd),0<pd){pd=this.Qti(pd);ua.ULS.sendTraceTag(526192649,3038,15,JSON.stringify(pd));this.USl&&ua.ULS.sendTraceTag(524158796,3038,15,"Diagnostic Log :{0}",this.eD());if(0==this.aja)this.GNc=this.pqc;else if(1<this.aja){ua.ULS.sendTraceTag(524137233,
3038,15,"StaleRevision(s) persist for more than {0} scans and {1} ms",this.aja,this.pqc-this.GNc);if(this.afn&&(!await this.ay.lae(this.tYm)||0===this.ay.pXc(this.QLd))){this.Qld();return}this.Acj(pd,this.pqc);this.NK.ShouldKickout&&(ua.ULS.sendTraceTag(523547595,3038,50,JSON.stringify(this.NK)),this.W1.$Tb(this.jxm()))}this.aja++}else this.Qld(),this.vpl()}};this.i2h=async()=>{await this.h2h();this.xXj()};this.ay=K;this.tf=pa;this.W1=Uc;this.EMk=kd;this.yDh=jb;this.QLd=bc;this.ZLk=Ic;this.gZ=Ca.a.instance.Oa("Wonca.IDocxSaveMonitor");
this.NK.ShouldKickout=!1;this.Lkg=this.Bao;this.itj=this.Cao;Ta.execute(pd=>{this.uk=pd});this.tf.hza(this.$U.bind(this))}get pqc(){return this.iFb.getTime()}Qti(K){return{["NumberOfStaleRevisions"]:K,["BrowserIsOnline"]:tk.a[this.tf.networkState],["NavigatorOnLine"]:window.navigator.onLine,["IsKickedOut"]:this.tf.Ko,["IsSessionExpired"]:this.tf.Aba,["IsSessionLost"]:this.tf.Hoc,["HasEmergencyViewDeployed"]:this.tf.Gk,["IsVisible"]:window.document.visibilityState,["HasFocus"]:document.hasFocus(),
["VisibilityManager_AppVisibilityState"]:this.uk?ng.a[this.uk.zA]:"undefined"}}$U(K,pa){if(pa){K=Date.now();var Ta=this.ay.pXc(this.QLd);0<Ta&&(Ta=this.Qti(Ta),this.Acj(Ta,K));this.HJo();this.VDn(pa.errorCode)}this.stop();this.gZ=Ca.a.instance.Oa("Wonca.IDocxSaveMonitor")}vpl(){this.ay.wae(this.ZLk)&&this.ktp()}ktp(){ua.ULS.sendTraceTag(520663501,3038,15,"Cancelling all blocked operations in server replication scheduler.");this.EMk.Rnf();gk.a.wFf(rp.a.xJo)}jxm(){return this.Yqn?Mm.a.CHp:this.tf.Aba?
Mm.a.ock:Mm.a.BHp}stop(){0!==this.bPc&&(window.clearInterval(this.bPc),this.bPc=0);ua.ULS.sendTraceTag(509215701,3038,50,"Stopping RDLM task")}async hri(){this.kSp&&this.stop();this.i2h();ua.ULS.sendTraceTag(509101133,3038,50,"RDLM running Synchronously")}Nbp(K){this.bPc=window.setTimeout(this.i2h,K);ua.ULS.sendTraceTag(509162245,3038,50,"Running RDLM Once");this.Qld()}xXj(){this.bPc=window.setInterval(this.h2h,this.yDh);ua.ULS.sendTraceTag(509215700,3038,50,"Starting RDLM task");this.Qld()}HJo(){this.esi(this.NK);
ua.ULS.sendTraceTag(523114659,3038,50,JSON.stringify(this.NK))}get VIj(){const K=Object.assign({},this.NK);this.esi(K);return K}esi(K){K.shouldKickout||(0==this.ay.pXc(this.QLd)?(K.NoKickoutReason="No Stale Revisions",K.OldestRevisionCreationTime=this.ay.Rjc()):this.uk&&!this.uk.isVisible?(K.NoKickoutReason="Session not active",K.VisibilityManager_AppVisibilityState=this.uk.zA):this.n2i&&this.aja<=this.itj?(K.NoKickoutReason="Persistent Runaway dataloss does not exceed minimum threshold",K.ScansWithPersistentRunawayDataLoss=
this.aja):this.aja<=this.Lkg?(K.NoKickoutReason="Persistent Runaway dataloss does not exceed maximum threshold",K.ScansWithPersistentRunawayDataLoss=this.aja):K.NoKickoutReason="undefined");K.LastScanTime=this.iFb.toISOString();K.RunCounter=this.aPc}eD(){const K={};this.gZ&&(K.DSM=this.gZ.eD());this.ay&&(K.RSN=this.ay.eD());return K}Qld(){ua.ULS.sendTraceTag(509215699,3038,50,"Resetting RDLM scans and timer. Previous persistent runaway dataloss scan count: {0}, Previous runaway dataloss timer: {1}",
this.aja,this.GNc);this.GNc=this.aja=0}heo(){this.aja=Math.min(this.Lkg-1,this.aja);this.GNc=Date.now()}n2i(){return 0===this.uk.zA&&this.tf.ZA&&!this.tf.Hoc&&!this.tf.Aba&&!this.tf.Gk}Acj(K,pa){this.aja>this.itj&&this.n2i()?this.NK.ShouldKickout||(this.NK.ShouldKickout=!0,this.fsi("Persistent RunawayDataLoss detected in active session",pa,K)):this.aja>this.Lkg&&!this.NK.ShouldKickout&&(this.NK.ShouldKickout=!0,this.fsi("Runaway DataLoss persists for more than 3 minutes.",pa,K))}fsi(K,pa,Ta){this.NK.KickoutTime=
(new Date(pa)).toISOString();this.NK.KickoutReason=K;this.NK.DSM_isUpToDate=this.gZ?this.gZ.JU:"Undefined";this.NK.SessionInfo=Ta}VDn(K){const pa=this.NK.ShouldKickout;sa.Health.instance.recordKpiUsage(tn.vIe,1,tn.R2d,null);const Ta=new Map;K&&Ta.set("ErrorCode",K.toString());pa?(Ta.set("ShouldKickout","true"),Ta.set("KickoutTime",this.NK.KickoutTime),Ta.set("Reason",this.NK.KickoutReason),sa.Health.instance.recordKpiSuccess(tn.vIe,Object.assign(new Ai.a,{extendedProperties:Ta}))):(Ta.set("ShouldKickout",
"false"),K=this.NK.NoKickoutReason,Ta.set("Reason",K),sa.Health.instance.recordKpiFailure(tn.vIe,K,!1,!1,Object.assign(new Ai.a,{extendedProperties:Ta})))}jYj(){ua.ULS.sendTraceTag(509686349,3037,50,"RunawayDataLossMonitor stopped");this.stop()}qXj(K){ua.ULS.sendTraceTag(509686348,3037,50,"RunawayDataLossMonitor started with interval {0}",K);this.Nbp(K)}get USl(){return null!=this.DVg?this.DVg:this.DVg=m.AFrameworkApplication.K&&m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DiagnosticLoggingForRunawayDatalossMonitorIsEnabled",
!0)}get tYm(){return null!=this.vYg?this.vYg:this.vYg=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RDLMHasDataLossTimeOutInMs",3E3):3E3}get afn(){return null!=this.R_g?this.R_g:this.R_g=m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForHasDataLossIsEnabled",!0)}get Cao(){return null!=this.k3g?this.k3g:this.k3g=m.AFrameworkApplication.K.ic("RunawayDataLossMinimumScansBeforeKickout",1)}get Bao(){return null!=this.j3g?
this.j3g:this.j3g=m.AFrameworkApplication.K.ic("RunawayDataLossMaximumScansBeforeKickout",5)}get Yqn(){return 1===this.tf.networkState||3===this.tf.networkState}get sci(){return this.yDh}}tn.vIe="RunAwayDataLossKickout";tn.R2d="wwrelfc";Object(f.a)(tn,"RunawayDataLossMonitor",null,[977,978]);class Kq{constructor(){this.oeh=3E4;this.Xsk=24E4;this.Ysk=12E4;this.W=this.RLd=null}get name(){return"WordEditor.RunawayDataLossMonitor"}init(){if(ej.App.Et||ej.App.pn)this.RLd=this.W.resolve(this.name),this.RLd.xXj(),
this.W.resolve("WordEditor.RunawayDataLossMonitorWatchDog"),0==m.AFrameworkApplication.Ug.RunawayDatalossSystemStartedAt&&m.AFrameworkApplication.Ug.Kcj()}BJl(){return new tn(this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.W.resolve("Common.ISessionStatus")||tg.SessionStatusManager.instance,this.W.Qa("Common.App.VisibilityManagement.IVisibilityManager"),m.AFrameworkApplication.K.ic("RunawayDataLossScanIntervalInMs",this.oeh),this.VJo,this.Ysk,Ca.a.instance.Oa("Box4.IKickoutExecutor"),
Yh.WoncaApp.ZF)}wc(K){if(ej.App.Et||ej.App.pn)this.W=K,K.ia(this.name,this.BJl.bind(this)).as("WordEditor.IRunawayDataLossMonitor").ha(),this.Nrg()}dispose(){this.RLd&&this.RLd.stop()}static main(){H.a.instance.Jc(new Kq)}Nrg(){this.W.ia("WordEditor.RunawayDataLossMonitorWatchDog",()=>new Cn(this.W.resolve(this.name),m.AFrameworkApplication.K.ic("RunawayDataLossScanIntervalInMs",this.oeh),m.AFrameworkApplication.K.ic("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}get VJo(){return m.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossKickoutIntervalInMs",
this.WJo)}get WJo(){return m.AFrameworkApplication.K.ic("RunawayDataLossKickoutIntervalInMs",this.Xsk)}}Object(f.a)(Kq,"WordEditorRunawayDataLossMonitorPackage",null,[0,1]);class Do{constructor(K,pa){this.DLk=K;this.ELk=pa}}Object(f.a)(Do,"LastSavedToHostDetailsEventArgs",null,[999]);class Mr{constructor(K,pa,Ta,jb,bc,Ic,Uc){this.JQk=5E4;this.Vaf=0;this.iFb=new Date(Date.UTC(0,1,1,0,0));this.Csk=6E4;this.aPc=this.P8b=0;this.sa=new V.a;this.YOo=()=>{ua.ULS.sendTraceTag(509372108,3037,50,"Running LastSavedToHostDetailsManager task.  Run count: {0}",
this.aPc++);this.tf.Ko||this.ajc().then(kd=>{this.sa.raiseEvent(Mr.V5i,kd);this.Lsh=new Date;kd=this.Tac;this.uk&&!this.uk.isVisible&&(kd=this.ePk);this.hFa(kd)}).catch(kd=>{this.hFa(this.sOm(kd))})};this.dNd=K;this.tf=Ta;this.DH=bc;this.ay=Ic;this.Tac=pa.ic("LastSavedToHostDetailsIntervalMs",6E4);this.rDb=pa.ic("LastSavedToHostDetailsFailureIntervalMs",5E3);this.ePk=pa.ic("LastSavedToHostDetailsSuccessIntervalOnHidden",this.Tac);this.DPc=pa.ic("LastSavedToHostDetailsSentTimeoutMs",12E4);this.P5e=
pa.ic("Microsoft.Office.WordOnline.LastSavedToHostDetailsQueueTimeoutMs",3E4);this.Lsh=new Date;jb.execute(kd=>{this.uk=kd;this.uk.nIa((pd,Fd)=>{this.U_(Fd)})});this.Af=Uc;0==m.AFrameworkApplication.Ug.RunawayDatalossSystemStartedAt&&m.AFrameworkApplication.Ug.Kcj();this.hFa(this.Tac)}U_(K){0!==K.newState&&1!==K.newState||0===K.oldState||1===K.oldState||this.tf.Ko||(this.hFa(this.Vaf),ua.ULS.sendTraceTag(521412808,3037,50,"LastSavedToHostDetails Pending since {0}, The next tick of LastSavedToHostDetails will be in {1} ms",
this.Lsh,this.Vaf))}Nta(){return 1==this.tf.networkState}ajc(){this.iFb=new Date;return new Promise((K,pa)=>{if(this.Nta())ua.ULS.sendTraceTag(525214230,3037,15,"Network is offline. Not Attempting to send request."),pa(0);else if(this.tf.Aba)ua.ULS.sendTraceTag(524154146,3037,15,"Waiting for token to refresh. Not attempting to send request."),pa(2);else if(this.ay.JU)ua.ULS.sendTraceTag(509641685,3037,50,"Session is up to date. Not attempting to send request."),pa(3);else{var Ta=$a.b(sf.construct(this.plc())),
jb={"Content-Type":"application/json; charset=utf-8"};ua.ULS.sendTraceTag(524154147,3037,50,"Sending LastSavedToHostDetails Request");if(this.y4o)ej.App.Pzc.pu({url:Mr.serviceUrl,method:"POST",body:Ta,headers:jb,Mwc:this.DPc,hYf:!0}).then(Ic=>{this.bho(Ic,K,pa)}).catch(()=>{pa(0)});else if(this.z4o){var bc=0;bc=this.Af.Ij(Mr.serviceUrl,2,Ta,jb,!1,0,Ic=>this.W5i(Ic,K,pa),Ic=>this.X5i(Ic,pa),null,null,!1,this.P5e,this.DPc,null,null,!0);0>=bc&&(ua.ULS.sendTraceTag(525214231,3037,15,"Invalid request id returned "+
bc.toString()),pa(0))}else bc=0,bc=this.dNd.Ij(Mr.serviceUrl,2,Ta,jb,!1,0,Ic=>this.W5i(Ic,K,pa),Ic=>this.X5i(Ic,pa),null,null,!0,this.DPc),0>=bc&&(ua.ULS.sendTraceTag(508650827,3037,15,"Invalid request id returned "+bc.toString()),pa(0))}})}bho(K,pa,Ta){const jb={},bc=K.headers.get(Dl.a.S2);jb.HttpStatus=K.status;jb.Correlation=bc;ua.ULS.sendTraceTag(508650831,3037,50,"LastSavedRevisionID Response Summary: {0}",jb);K.ok?K.text().then(Ic=>{Ic=this.yAa(Ic);Ic||(ua.ULS.sendTraceTag(508650829,3037,15,
"LastSavedRevisionResponse is null"),Ta(2));this.DH.FPa(Ic);pa(new Do(Ic.LastSavedRevisionId,Ic.RevisionSequenceNumber))}).catch(Ic=>{ua.ULS.sendTraceTag(508650828,3037,15,"Failed to parse LastSavedRevisionResponse. Exception: {0}",Ic.toString());Ta(2)}):(ua.ULS.sendTraceTag(508650830,3037,15,"LastSavedRevisionResponse failed with status code: {0}",K.status),K.status===al.a.A8?Ta(1):K.status===al.a.rxb?Ta(0):Ta(2))}X5i(K,pa){let Ta=2;if(K=K.data){if(5===K.status)Ta=1;else if(7===K.status||13===K.status)Ta=
this.r1o?0:1;ua.ULS.sendTraceTag(525214232,3037,15,String.format("Request Failed with status {0}. Failed getting LastSavedToHostDetails",K.status))}else ua.ULS.sendTraceTag(525214233,3037,15,"Failed to get LastSavedToHostDetails");pa(Ta)}W5i(K,pa,Ta){if(K=K.data){var jb={},bc=K.vi?K.vi[Dl.a.S2]:"";jb.HttpStatus=K.He;jb.Correlation=bc;jb.Id=K.id;ua.ULS.sendTraceTag(525214235,3037,50,"LastSavedRevisionID Response Summary: {0}",jb);(K=this.yAa(K.De))?(this.DH.FPa(K),pa(new Do(K.LastSavedRevisionId,K.RevisionSequenceNumber))):
(ua.ULS.sendTraceTag(525214237,3037,15,"Deserialized response is null"),Ta(2))}else ua.ULS.sendTraceTag(525214234,3037,15,"Request succeeded with null item."),Ta(2)}hFa(K){0!==this.P8b&&window.clearTimeout(this.P8b);this.P8b=window.setTimeout(this.YOo,K);ua.ULS.sendTraceTag(525100416,3037,50,"LastSavedToHostDetails request queued with timeout "+K)}plc(){const K=Od.StaticActiveAppFrame.za().ib.sc;return K?K.jd:null}sOm(K){return 1===K?this.Vaf:0===K?this.JQk:3===K?this.Tac:this.rDb}yAa(K){let pa;return({group:pa}=
ec.a.R4(K)).returnValue?pa.Responses[0]:null}u2k(K){this.sa.addHandler(Mr.V5i,K)}async hri(){const K=new Promise((pa,Ta)=>{window.setTimeout(Ta,3E3)});await Promise.race([K,this.ajc()]).then(()=>{ua.ULS.sendTraceTag(509100305,3038,50,"LSTHDM ran Synchronously: Success")}).catch(()=>{ua.ULS.sendTraceTag(509100304,3038,15,"LSTHDM ran Synchronously: Failure")})}jYj(){0!==this.P8b&&(ua.ULS.sendTraceTag(509215702,3037,50,"LastSavedToHostDetails Stopped"),window.clearTimeout(this.P8b),this.P8b=0)}qXj(K){ua.ULS.sendTraceTag(509686350,
3037,50,"LastSavedToHostDetails started with interval {0}",K);this.hFa(K)}get pqc(){return this.iFb.getTime()}get sci(){return this.Csk}eD(){const K={};K.LastScanTime=this.iFb.toISOString();K.RunCounter=this.aPc;return K}get r1o(){return null!=this.b4g?this.b4g:this.b4g=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldDelayOnTimeout",!1):!1}get y4o(){return null!=this.g4g?this.g4g:this.g4g=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseCRMV2",
!1):!1}get z4o(){return null!=this.h4g?this.h4g:this.h4g=m.AFrameworkApplication.K?m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchToClientRequestManager",!1):!1}}Mr.V5i="ULSTHD";Mr.serviceUrl=ej.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedToHostDetailsRequest";Object(f.a)(Mr,"LastSavedToHostDetailsManager",null,[979,978]);class zu{constructor(K,pa,Ta){this.sZm=K;this.gEa=pa;this.Jwn=Ta;this.qkg=()=>{const jb=this.sZm();return 32!==jb?jb:!this.gEa||this.gEa.JU?
32:8};this.qxp=(jb,bc,Ic,Uc,kd)=>{this.Jwn.hFa(parseInt(kd.toString()));return 32}}Wb(K){K.ra(rf.a.qkg,Ad.a.view,this.qkg);K.ra(rf.a.a7j,Ad.a.view,this.qxp);K.Rc(rf.a.a7j,101)}}Object(f.a)(zu,"LastSavedToHostDetailsManagerActor",null,[]);class Au{constructor(){this.W=null}get name(){return"WordEditor.LastSavedToHost"}wc(K){const pa=m.AFrameworkApplication.K;this.W=K;const Ta=new $g(m.AFrameworkApplication.userSessionId,m.AFrameworkApplication.Be.i1,m.AFrameworkApplication.Be.a_d);this.W.ia("WordEditor.ILastSavedToHostDetailsManager",
()=>new Mr(Ta,pa,this.W.Oa("Common.ISessionStatus")||tg.SessionStatusManager.instance,this.W.Qa("Common.App.VisibilityManagement.IVisibilityManager"),Kf.a.instance,this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),m.AFrameworkApplication.Be)).ha();this.Nrg()}init(){(new zu(()=>Yh.WoncaApp.ZF.ZNi(),this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"))).Wb(m.AFrameworkApplication.va);this.W.resolve("WordEditor.ILastSavedToHostDetailsManager");
this.W.resolve("WordEditor.LastSavedToHostDetailsManagerWatchDog")}dispose(){}static main(){H.a.instance.Jc(new Au)}Nrg(){this.W.ia("WordEditor.LastSavedToHostDetailsManagerWatchDog",()=>new Cn(this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"),m.AFrameworkApplication.K.ic("LastSavedToHostDetailsIntervalMs",6E4),m.AFrameworkApplication.K.ic("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}}Object(f.a)(Au,"LastSavedToHostDetailsPackage",null,[0,1]);class Fv{constructor(K,pa,Ta,jb,bc){this.RBl=
K;this.UBl=pa;this.Tnb=Ta;this.QBl=jb;this.appSettings=bc;this.Sol=async()=>{const Ic=en.b.Vva(),Uc=Promise.race([this.pZn(),new Promise(kd=>setTimeout(()=>kd(!1),5E3))]);ua.ULS.sendTraceTag(508863558,3048,50,"Copilot Compose feature condition check took: {0}ms",Ic.c_c);return Uc};this.pZn=async()=>{if(!this.Jin||!this.Hen)return!1;await this.JOg();return await this.QBl.CLb()&&this.RBl.CLb()&&await this.UBl.CLb()?!0:!1};this.fin=new Ec.a(this.Sol)}async isEnabled(){return this.fin.value}get Jin(){const K=
this.Tnb.isInsertActionEnabled,pa=this.Tnb.isRewriteActionEnabled;return this.Tnb.isStartActionEnabled||K||pa}get Hen(){return nb.a.uj?this.Tnb.isFirefoxAllowed:!0}async JOg(){return new Promise(K=>{this.appSettings.Rn(()=>{K(!0)})})}}Object(f.a)(Fv,"CopilotComposeFeatureCondition",null,[]);var Ft=d(2233),mp=d(2194);const Zo=new Bn(()=>Promise.all([d.e(5),d.e(2),d.e(13)]).then(d.bind(null,2217)).then(K=>K.instance));class Bw{constructor(K,pa){this.pPg=K;this.logger=pa;this.vfd=async()=>{await this.logger.measureActivityPerformanceAsync(this.Myf,
{name:"Initialize",dataFields:[...Object(mp.a)(Ft.a.getFields({featureName:"CopilotCompose",VUc:Ft.a.eCc.Hek,Cpb:Ft.a.igb.IsEnabled,isUserInitiated:!1}))]})};this.Myf=async()=>{await Promise.all([Zo.e7(),this.pPg.loadChunk("copilotComposeUx")]);await Zo.kpb()}}initialize(){this.vfd().catch(K=>{ua.ULS.$w(508913495,3048,10,K,"Failed to initialize CopilotCompose")})}}Object(f.a)(Bw,"CopilotComposeInitializer",null,[]);const Nr="CH DE FR EU UK NO SE NL PIE".split(" "),sx=["Exchange Online Consumer","OneDriveWOPI"];
class Bu{constructor(K){this.Tnb=K}CLb(){var K,pa,Ta,jb,bc;if(this.Tnb.isBypassDatacenterConditionEnabled)return!0;const Ic=null!==(pa=null===(K=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===K?void 0:K.WACDatacenter)&&void 0!==pa?pa:"unknown";K=null!==(jb=null===(Ta=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===Ta?void 0:Ta.Ring)&&void 0!==jb?jb:"unknown";Ta=null===(bc=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===bc?void 0:bc.Host;return this.F8c(Ic,K,Ta)}F8c(K,
pa,Ta){if("1"===pa||"unknown"===K||sx.includes(Ta))return!0;const jb=K.toUpperCase();return!Nr.some(bc=>jb.includes(bc))}}Object(f.a)(Bu,"CopilotComposeDatacenterCondition",null,[]);class Zu{constructor(K,pa){this.appSettings=K;this.Fif=pa;this.iYa="Copilot";this.lec="Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped";this.$6n="Microsoft.Office.WordOnline.CopilotLicensePaywallNoPassOverrideEnabled"}async CLb(){const K=await this.qpl();ua.ULS.sendTraceTag(508859584,3048,50,"License check result: {0}",
K);return 1===K||0===K}async qpl(){if(this.Anf())return 0;const K=en.b.Vva(),pa=await this.$5c();ua.ULS.sendTraceTag(508863556,3048,50,"License check took: {0}ms",K.c_c);return pa?this.R2o()?3:1:2}Anf(){return this.appSettings.getBooleanFeatureGate(this.lec,!1)}R2o(){return this.appSettings.getBooleanFeatureGate(this.$6n,!1)}async $5c(){return(await Object(Zh.c)(this.Fif)).isFeatureEnabled(this.iYa,!1)}}Object(f.a)(Zu,"CopilotComposeLicenseCondition",null,[]);class Gv{constructor(K){this.appSettings=
K}get isStartActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsStartActionEnabled",!1)}get isInsertActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsInsertActionEnabled",!1)}get isRewriteActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsRewriteActionEnabled",!1)}get isStreamingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsStreamingEnabled",
!1)}get isAutoOpenOnStartEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsAutoOpenOnStartEnabled",!1)}get isCiqEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotComposeCiqEnabled",!1)}get isCiqMultilingualEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsCiqMultilingualEnabled",!1)}get isVivaSalesCiqEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isVivaSalesCiqEnabled",
!1)}get isTableRenderingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.AugLoop.CopilotCompose.isTableRenderingEnabled",!1)}get isStylizedTableRenderingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isStylizedTableRenderingEnabled",!1)}get isGranularStreamingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsGranularStreamingEnabled",!1)}get isFirefoxAllowed(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsFirefoxAllowed",
!1)}get streamingChunkGenerationTimeoutMs(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.StreamingChunkGenerationTimeoutMs",2E4)}get isAdminControlEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotAdminControlEnabled",!1)}get isBypassDatacenterConditionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.BypassDatacenterCondition",!1)}get isFeedbackSdkEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.FeedbackSdkEnabled",
!1)}get isSupportedLanguagesLinkEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsSupportedLanguagesLinkEnabled",!1)}get isAutoAcceptFixEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsAutoAcceptFixEnabled",!1)}get isMultiTurnEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsMultiTurnEnabled",!1)}get isProactiveSurveysEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsProactiveSurveysEnabled",
!1)}get isRewriteV2Enabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsRewriteStreamingWorkflowEnabled",!1)}get isMultiTurnExpandedInputEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsMultiTurnExpandedInputEnabled",!1)}get isSetParagraphLanguageEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsSetParagraphLanguageEnabled",!1)}get isDynamicAnchoringEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsDynamicAnchoringEnabled",
!1)}}Object(f.a)(Gv,"CopilotComposeFeatureGatesImpl",null,[]);class tr{constructor(K,pa){this.WVc=K;this.Tnb=pa}async CLb(){if(!this.Tnb.isAdminControlEnabled)return!0;const K=en.b.Vva();try{return!await (await Object(Zh.c)(this.WVc)).AL("CopilotContentGeneration",!0)}finally{ua.ULS.sendTraceTag(508651538,3048,50,"Admin policy check took: {0}ms",K.c_c)}}}Object(f.a)(tr,"CopilotComposeAdminPolicyCondition",null,[]);class Cu extends Vo.a{constructor(){super(...arguments);this.name="WordEditor.Copilot.ComposeEntry"}ifa(K){K.ia("WordEditor.Copilot.Compose.EditorAiTelemetryLogger",
()=>new en.a(K.resolve("Wac.Common.Utils.IOtelWrapper"),"CopilotCompose")).ha()}kfa(){const K=Ca.a.instance;(new Bw(K.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"),K.resolve("WordEditor.Copilot.Compose.EditorAiTelemetryLogger"))).initialize()}jfa(){}static main(){Cu.Dnm().isEnabled().then(K=>{K&&H.a.instance.Jc(new Cu)}).catch(()=>{ua.ULS.sendTraceTag(508859807,3048,10,"Feature condition check for Copilot Compose failed with error")})}static Dnm(){const K=Ca.a.instance;K.ia("WordEditor.Copilot.Compose.CopilotComposeDatacenterCondition",
()=>new Bu(K.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureGates"))).ha();K.ia("WordEditor.Copilot.Compose.CopilotComposeFeatureGates",()=>new Gv(m.AFrameworkApplication.K)).ha();K.ia("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition",()=>new Zu(m.AFrameworkApplication.K,K.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();K.ia("WordEditor.Copilot.Compose.CopilotComposeAdminPolicyCondition",()=>new tr(K.Qa("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),
K.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureGates"))).ha();K.ia("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition",()=>new Fv(K.resolve("WordEditor.Copilot.Compose.CopilotComposeDatacenterCondition"),K.resolve("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition"),K.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureGates"),K.resolve("WordEditor.Copilot.Compose.CopilotComposeAdminPolicyCondition"),m.AFrameworkApplication.K)).ha();return K.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition")}}
Object(f.a)(Cu,"CopilotComposeEntryPackage",Vo.a,[]);class Qn extends Oj.a{constructor(K){var pa;super("DocumentOwnerConditionId");this.Tm=K.Tm;this.ZBg=null!==(pa=K.ZBg)&&void 0!==pa?pa:!0}initialize(){super.initialize();const K=m.AFrameworkApplication.K;K.Rn(()=>{const pa=K.$("IsDocumentOwner");this.Jg(pa===this.ZBg)})}Jg(K){super.Jg(K);ua.ULS.sendTraceTag(508958623,3028,50,this.aR(this.Tm,K))}}Object(f.a)(Qn,"DocumentOwnerCondition",Oj.a,[]);var Da=d(278);class Sa extends Da.a{constructor(K,pa,
Ta){super("LicensePaywallCondition");this.wbc=K.Tm;this.pvk=K.f6l;this.Ga=pa;this.tu=Ta}initialize(){super.initialize();this.XBl()}Pd(){super.Pd()}XBl(){this.Ga.Rn(()=>{!this.Ga.$("IsAnonymousUser")&&this.tu?this.tu.execute(K=>{this.H_e=Date.now();K.isFeatureEnabled(this.pvk,!1).then(pa=>{this.H_e=Date.now()-this.H_e;this.Jg(pa)})}):this.Jg(!1)})}Jg(K){super.Jg(K);ua.ULS.sendTraceTag(508884163,3028,50,this.aR(this.wbc,K,"Latency for license check: "+this.H_e.toString()+"ms"))}}Object(f.a)(Sa,"LicensePaywallCondition",
Da.a,[]);var Ha=d(1844);class Ba extends em.a{constructor(K){super(23,K,null,3028,"SkittleInitializationTriggered")}}Object(f.a)(Ba,"SkittleInitializationTriggerModel",em.a,[]);var Va=d(566);class xb{constructor(){this.Mga=(K,pa)=>{pa.succeeded||ua.ULS.sendTraceTag(508618435,3049,10,"Async loading of skittle module failed")}}Y7m(K){const pa=Va.a.Instance().mQb().irb("WordEditor.Skittles");pa.Coc()||this.KAn(K).then(()=>{pa.Rqc(this.Mga)}).catch(()=>{ua.ULS.sendTraceTag(508618436,3049,10,"Async loading of skittle ux chunk failed")})}async KAn(K){return m.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("copilotSummarySkittleUx"):(await Object(Zh.c)(K)).xC.loadScript("copilotSummarySkittleUx")}}Object(f.a)(xb,"SkittlesProxyConsumerImpl",null,[1040]);class ac{static dLm(){return new xb}}Object(f.a)(ac,"SkittlesProxyConsumerFactory",null,[]);class qc{constructor(K,pa){this.hWj=K;this.Xmd=pa;this.JWi=!1;this.Xvb=async(Ta,jb)=>{if(jb.z4){Object(Ce.a)("SkittleInitializationTriggered");for(const bc of this.hWj)bc.pna(this.Xvb),bc.Pd();this.JWi||(this.JWi=!0,ac.dLm().Y7m(this.Xmd))}}}initialize(){ua.ULS.sendTraceTag(508621533,
3049,50,"SkittleInitializer has begun initializing skittle trigger models");for(const K of this.hWj)K.aaa(this.Xvb),K.initialize()}}Object(f.a)(qc,"SkittleInitializer",null,[]);class Qc extends Vo.a{get name(){return"WordEditor.SkittleEntryPackage"}ifa(K){this.container=K}kfa(){const K=new yb.a;if(m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSummarySkittle",!1)){var pa=K.push,Ta=this.container,jb=Ta.resolve("WordEditor.WordCount.IWordCountManagerFactory");Ta=
Ta.Qa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");var bc=new Fn({Tm:24,Dpb:"Microsoft.Office.WordOnline.CopilotSummarySkittle"});const Ic=new Fn({Tm:24,Dpb:"Microsoft.Office.WordOnline.CopilotPaneEnabled"}),Uc=new Qn({Tm:24,ZBg:!1});bc=new yb.a([bc,Ic,Uc]);m.AFrameworkApplication.Ld("fbc73697;a29b4114");m.AFrameworkApplication.K&&!m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",!1)&&(Ta=new Sa({Tm:24,f6l:"Copilot"},m.AFrameworkApplication.K,
Ta),bc.add(Ta));m.AFrameworkApplication.Ld("f5gia801;0f27g313");m.AFrameworkApplication.K&&!m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSkittleSummaryGenerationSkipped",!1)&&(jb=new Ha.a({Tm:24},jb),bc.add(jb));pa.call(K,new Ba(bc))}0!==K.count&&(new qc(K,this.container.Qa("Common.IDynamicScriptLoaderProvider"))).initialize()}jfa(){}static main(){H.a.instance.Jc(new Qc)}}Object(f.a)(Qc,"SkittleEntryPackage",Vo.a,[]);Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");
Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");
Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");kk.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");U;Type.registerNamespace("CACPU");xa.main();Type.registerNamespace("CAEventTimingMeter");Yb.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");
ob.main();Type.registerNamespace("Common.App.GestureInput");Ub.main();Type.registerNamespace("Common.App.GestureManager");Cc.main();Type.registerNamespace("Common.ModernFontPicker");null==m.AFrameworkApplication.K||m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableOfflineLogger",!1)||(Type.registerNamespace("Common.App.OfflineLogger"),H.a.instance.Jc(new pf));Type.registerNamespace("Common.App.O365Shell");cc.main();Type.registerNamespace("Common.App.PhoneLink");id.main();
Type.registerNamespace("Common.App.SensitiveLogging");uh.main();Type.registerNamespace("Common.App.Rename");H.a.instance.Jc(new Lg,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");H.a.instance.Jc(new Lf);Type.registerNamespace("Common.App.SaveAsToHost");Vg.main();Type.registerNamespace("Common.App.SaveToCloudStorage");ck.main();Type.registerNamespace("Common.App.SaveACopy");uj.main();Type.registerNamespace("Common.App.SaveToSharePoint");Ge.main();Type.registerNamespace("Common.App.SharedFilePicker");
xf.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");hc.main();Gb;H.a.instance.Jc(new Na);Nj.main();Ev;Xj.main();H.a.instance.Jc(new vj);or.main();Pc.a.prototype.toString=xd.a.prototype.toString;He.a.NLi=new af.a;H.a.instance.Jc(new No);bm.main();H.a.instance.Jc(new Kl);H.a.instance.Jc(new um);H.a.instance.Jc(new sp);
Ws.main();sm.main();Pn.main();Type.registerNamespace("NLRT");H.a.instance.Jc(new Ei);Type.registerNamespace("Common.App.AccessibilitySettings");M.main();Type.registerNamespace("Common.App.RibbonSettings");Bg.main();H.a.instance.Jc(new rx);km.main();Vq.main();Wq.main();Qc.main();Cu.main();Kq.main();Au.main();window.EventTiming={EventTimingMeter:Kc,FrameTimingMeter:Vc}},2233:function(G,J,d){function m(l,w,y){return f(l,0,w,y)}function f(l,w,y,v){return{name:l,dataType:w,value:y,classification:v?v:4}}
d.d(J,"a",function(){return a});var a;(function(l){(function(w){w.IsEnabled="IsEnabled";w.IsSeen="IsSeen";w.IsTried="IsTried";w.IsKept="IsKept";w.IsRejected="IsRejected"})(l.igb||(l.igb={}));(function(w){w.ContentGeneration="Content Generation";w.Commanding="Commanding";w.QAandSummaries="QA and Summaries";w.Collaboration="Collaboration";w.Suggestions="Suggestions"})(l.eCc||(l.eCc={}));l.getFields=function(w){var y=[];void 0!==w.Cpb&&y.push(m("".concat("Copilot",".FeatureActionType"),w.Cpb));if(void 0!==
w.isUserInitiated){var v=y.push;var u="".concat("Copilot",".IsUserInitiated");u=f(u,1,w.isUserInitiated,void 0);v.call(y,u)}void 0!==w.featureName&&y.push(m("".concat("Copilot",".FeatureName"),w.featureName));void 0!==w.VUc&&y.push(m("".concat("Copilot",".Capability"),w.VUc));void 0!==w.qad&&(v=y.push,u="".concat("Copilot",".IsThumbsUp"),w=f(u,1,w.qad,void 0),v.call(y,w));y.push(m("zC.".concat("Copilot"),"Office.System.Copilot"));return y}})(a||(a={}))}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/22137596/wdjs/WordEditorDS.box4.dll2.js.map